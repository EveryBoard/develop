(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{4590:(Ru,V0,Ss)=>{"use strict";function En(r){return"function"==typeof r}function Ps(r){const t=r(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const n3=Ps(r=>function(t){r(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,i)=>`${i+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function r3(r,e){if(r){const t=r.indexOf(e);0<=t&&r.splice(t,1)}}class Sn{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const o of t)o.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(En(n))try{n()}catch(o){e=o instanceof n3?o.errors:[o]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const o of i)try{o3(o)}catch(s){e=e??[],s instanceof n3?e=[...e,...s.errors]:e.push(s)}}if(e)throw new n3(e)}}add(e){var t;if(e&&e!==this)if(this.closed)o3(e);else{if(e instanceof Sn){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&r3(t,e)}remove(e){const{_finalizers:t}=this;t&&r3(t,e),e instanceof Sn&&e._removeParent(this)}}Sn.EMPTY=(()=>{const r=new Sn;return r.closed=!0,r})();const Gl=Sn.EMPTY;function i3(r){return r instanceof Sn||r&&"closed"in r&&En(r.remove)&&En(r.add)&&En(r.unsubscribe)}function o3(r){En(r)?r():r.unsubscribe()}const Qa={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},y4={setTimeout(r,e,...t){const{delegate:n}=y4;return n?.setTimeout?n.setTimeout(r,e,...t):setTimeout(r,e,...t)},clearTimeout(r){const{delegate:e}=y4;return(e?.clearTimeout||clearTimeout)(r)},delegate:void 0};function Ul(r){y4.setTimeout(()=>{const{onUnhandledError:e}=Qa;if(!e)throw r;e(r)})}function Eo(){}const Ts=Wl("C",void 0,void 0);function Wl(r,e,t){return{kind:r,value:e,error:t}}let aa=null;function ht(r){if(Qa.useDeprecatedSynchronousErrorHandling){const e=!aa;if(e&&(aa={errorThrown:!1,error:null}),r(),e){const{errorThrown:t,error:n}=aa;if(aa=null,t)throw n}}else r()}class zt extends Sn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,i3(e)&&e.add(this)):this.destination=Hu}static create(e,t,n){return new Ci(e,t,n)}next(e){this.isStopped?Du(function zu(r){return Wl("N",r,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Du(function F0(r){return Wl("E",void 0,r)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Du(Ts,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ln=Function.prototype.bind;function Ar(r,e){return Ln.call(r,e)}class s3{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){j2(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){j2(n)}else j2(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){j2(t)}}}class Ci extends zt{constructor(e,t,n){let i;if(super(),En(e)||!e)i={next:e??void 0,error:t??void 0,complete:n??void 0};else{let o;this&&Qa.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Ar(e.next,o),error:e.error&&Ar(e.error,o),complete:e.complete&&Ar(e.complete,o)}):i=e}this.destination=new s3(i)}}function j2(r){Qa.useDeprecatedSynchronousErrorHandling?function ot(r){Qa.useDeprecatedSynchronousErrorHandling&&aa&&(aa.errorThrown=!0,aa.error=r)}(r):Ul(r)}function Du(r,e){const{onStoppedNotification:t}=Qa;t&&y4.setTimeout(()=>t(r,e))}const Hu={closed:!0,next:Eo,error:function ql(r){throw r},complete:Eo},Vu="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ja(r){return r}function oh(r){return 0===r.length?Ja:1===r.length?r[0]:function(t){return r.reduce((n,i)=>i(n),t)}}let T1=(()=>{class r{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new r;return n.source=this,n.operator=t,n}subscribe(t,n,i){const o=function ry(r){return r&&r instanceof zt||function ny(r){return r&&En(r.next)&&En(r.error)&&En(r.complete)}(r)&&i3(r)}(t)?t:new Ci(t,n,i);return ht(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=sh(n))((i,o)=>{const s=new Ci({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[Vu](){return this}pipe(...t){return oh(t)(this)}toPromise(t){return new(t=sh(t))((n,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>n(o))})}}return r.create=e=>new r(e),r})();function sh(r){var e;return null!==(e=r??Qa.Promise)&&void 0!==e?e:Promise}const iy=Ps(r=>function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let So=(()=>{class r extends T1{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new ah(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new iy}next(t){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:i,observers:o}=this;return n||i?Gl:(this.currentObservers=null,o.push(t),new Sn(()=>{this.currentObservers=null,r3(o,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:i,isStopped:o}=this;n?t.error(i):o&&t.complete()}asObservable(){const t=new T1;return t.source=this,t}}return r.create=(e,t)=>new ah(e,t),r})();class ah extends So{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Gl}}class Yi extends So{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}function ch(r){return En(r?.lift)}function jr(r){return e=>{if(ch(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function pr(r,e,t,n,i){return new oy(r,e,t,n,i)}class oy extends zt{constructor(e,t,n,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Wn(r,e){return jr((t,n)=>{let i=0;t.subscribe(pr(n,o=>{n.next(r.call(e,o,i++))}))})}function $u(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]])}return t}function Wo(r){return this instanceof Wo?(this.v=r,this):new Wo(r)}function Zl(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=r[Symbol.asyncIterator];return e?e.call(r):(r=function Jn(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(r),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=r[o]&&function(s){return new Promise(function(a,c){!function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}(a,c,(s=r[o](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const IR=r=>r&&"number"==typeof r.length&&"function"!=typeof r;function kR(r){return En(r?.then)}function xR(r){return En(r[Vu])}function LR(r){return Symbol.asyncIterator&&En(r?.[Symbol.asyncIterator])}function RR(r){return new TypeError(`You provided ${null!==r&&"object"==typeof r?"an invalid object":`'${r}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const zR=function r4e(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function DR(r){return En(r?.[zR])}function HR(r){return function B0(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=t.apply(r,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(m){n[m]&&(i[m]=function(E){return new Promise(function(w,L){o.push([m,E,w,L])>1||a(m,E)})})}function a(m,E){try{!function c(m){m.value instanceof Wo?Promise.resolve(m.value.v).then(l,f):d(o[0][2],m)}(n[m](E))}catch(w){d(o[0][3],w)}}function l(m){a("next",m)}function f(m){a("throw",m)}function d(m,E){m(E),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,function*(){const t=r.getReader();try{for(;;){const{value:n,done:i}=yield Wo(t.read());if(i)return yield Wo(void 0);yield yield Wo(n)}}finally{t.releaseLock()}})}function VR(r){return En(r?.getReader)}function jo(r){if(r instanceof T1)return r;if(null!=r){if(xR(r))return function i4e(r){return new T1(e=>{const t=r[Vu]();if(En(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(r);if(IR(r))return function o4e(r){return new T1(e=>{for(let t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}(r);if(kR(r))return function s4e(r){return new T1(e=>{r.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Ul)})}(r);if(LR(r))return FR(r);if(DR(r))return function a4e(r){return new T1(e=>{for(const t of r)if(e.next(t),e.closed)return;e.complete()})}(r);if(VR(r))return function c4e(r){return FR(HR(r))}(r)}throw RR(r)}function FR(r){return new T1(e=>{(function l4e(r,e){var t,n,i,o;return function Se(r,e,t,n){return new(t||(t=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(d){s(d)}}function c(f){try{l(n.throw(f))}catch(d){s(d)}}function l(f){f.done?o(f.value):function i(o){return o instanceof t?o:new t(function(s){s(o)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Zl(r);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(s){i={error:s}}finally{try{n&&!n.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})})(r,e).catch(t=>e.error(t))})}function a3(r,e,t,n=0,i=!1){const o=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(o),!i)return o}function Z2(r,e,t=1/0){return En(e)?Z2((n,i)=>Wn((o,s)=>e(n,o,i,s))(jo(r(n,i))),t):("number"==typeof e&&(t=e),jr((n,i)=>function u4e(r,e,t,n,i,o,s,a){const c=[];let l=0,f=0,d=!1;const m=()=>{d&&!c.length&&!l&&e.complete()},E=L=>l<n?w(L):c.push(L),w=L=>{o&&e.next(L),l++;let z=!1;jo(t(L,f++)).subscribe(pr(e,$=>{i?.($),o?E($):e.next($)},()=>{z=!0},void 0,()=>{if(z)try{for(l--;c.length&&l<n;){const $=c.shift();s?a3(e,s,()=>w($)):w($)}m()}catch($){e.error($)}}))};return r.subscribe(pr(e,E,()=>{d=!0,m()})),()=>{a?.()}}(n,i,r,t)))}function G0(r=1/0){return Z2(Ja,r)}const ec=new T1(r=>r.complete());function fy(r){return r[r.length-1]}function $R(r){return En(fy(r))?r.pop():void 0}function Gu(r){return function d4e(r){return r&&En(r.schedule)}(fy(r))?r.pop():void 0}function uh(r,e=0){return jr((t,n)=>{t.subscribe(pr(n,i=>a3(n,r,()=>n.next(i),e),()=>a3(n,r,()=>n.complete(),e),i=>a3(n,r,()=>n.error(i),e)))})}function fh(r,e=0){return jr((t,n)=>{n.add(r.schedule(()=>t.subscribe(n),e))})}function BR(r,e){if(!r)throw new Error("Iterable cannot be null");return new T1(t=>{a3(t,e,()=>{const n=r[Symbol.asyncIterator]();a3(t,e,()=>{n.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function r2(r,e){return e?function C4e(r,e){if(null!=r){if(xR(r))return function p4e(r,e){return jo(r).pipe(fh(e),uh(e))}(r,e);if(IR(r))return function m4e(r,e){return new T1(t=>{let n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}(r,e);if(kR(r))return function g4e(r,e){return jo(r).pipe(fh(e),uh(e))}(r,e);if(LR(r))return BR(r,e);if(DR(r))return function _4e(r,e){return new T1(t=>{let n;return a3(t,e,()=>{n=r[zR](),a3(t,e,()=>{let i,o;try{({value:i,done:o}=n.next())}catch(s){return void t.error(s)}o?t.complete():t.next(i)},0,!0)}),()=>En(n?.return)&&n.return()})}(r,e);if(VR(r))return function v4e(r,e){return BR(HR(r),e)}(r,e)}throw RR(r)}(r,e):jo(r)}function Dt(...r){return r2(r,Gu(r))}function GR(r={}){const{connector:e=(()=>new So),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:i=!0}=r;return o=>{let s,a,c,l=0,f=!1,d=!1;const m=()=>{a?.unsubscribe(),a=void 0},E=()=>{m(),s=c=void 0,f=d=!1},w=()=>{const L=s;E(),L?.unsubscribe()};return jr((L,z)=>{l++,!d&&!f&&m();const $=c=c??e();z.add(()=>{l--,0===l&&!d&&!f&&(a=dy(w,i))}),$.subscribe(z),!s&&l>0&&(s=new Ci({next:B=>$.next(B),error:B=>{d=!0,m(),a=dy(E,t,B),$.error(B)},complete:()=>{f=!0,m(),a=dy(E,n),$.complete()}}),jo(L).subscribe(s))})(o)}}function dy(r,e,...t){if(!0===e)return void r();if(!1===e)return;const n=new Ci({next:()=>{n.unsubscribe(),r()}});return jo(e(...t)).subscribe(n)}function ca(r,e){return jr((t,n)=>{let i=null,o=0,s=!1;const a=()=>s&&!i&&n.complete();t.subscribe(pr(n,c=>{i?.unsubscribe();let l=0;const f=o++;jo(r(c,f)).subscribe(i=pr(n,d=>n.next(e?e(c,d,f,l++):d),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function E4e(r,e){return r===e}function i1(r){for(let e in r)if(r[e]===i1)return e;throw Error("Could not find renamed property on target object.")}function dh(r,e){for(const t in e)e.hasOwnProperty(t)&&!r.hasOwnProperty(t)&&(r[t]=e[t])}function o2(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(o2).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const e=r.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function hy(r,e){return null==r||""===r?null===e?"":e:null==e||""===e?r:r+" "+e}const S4e=i1({__forward_ref__:i1});function O1(r){return r.__forward_ref__=O1,r.toString=function(){return o2(this())},r}function $t(r){return py(r)?r():r}function py(r){return"function"==typeof r&&r.hasOwnProperty(S4e)&&r.__forward_ref__===O1}function gy(r){return r&&!!r.\u0275providers}const UR="https://g.co/ng/security#xss";class ge extends Error{constructor(e,t){super(function hh(r,e){return`NG0${Math.abs(r)}${e?": "+e:""}`}(e,t)),this.code=e}}function jt(r){return"string"==typeof r?r:null==r?"":String(r)}function my(r,e){throw new ge(-201,!1)}function Ht(r,e,t,n){throw new Error(`ASSERTION ERROR: ${r}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}function He(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function Y2(r){return{providers:r.providers||[],imports:r.imports||[]}}function ph(r){return WR(r,mh)||WR(r,qR)}function WR(r,e){return r.hasOwnProperty(e)?r[e]:null}function gh(r){return r&&(r.hasOwnProperty(_y)||r.hasOwnProperty(I4e))?r[_y]:null}const mh=i1({\u0275prov:i1}),_y=i1({\u0275inj:i1}),qR=i1({ngInjectableDef:i1}),I4e=i1({ngInjectorDef:i1});var cn=function(r){return r[r.Default=0]="Default",r[r.Host=1]="Host",r[r.Self=2]="Self",r[r.SkipSelf=4]="SkipSelf",r[r.Optional=8]="Optional",r}(cn||{});let vy;function Po(r){const e=vy;return vy=r,e}function ZR(r,e,t){const n=ph(r);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&cn.Optional?null:void 0!==e?e:void my(o2(r))}const m1=globalThis,Uu={},Sy="__NG_DI_FLAG__",_h="ngTempTokenPath",L4e=/\n/gm,KR="__source";let U0;function E4(r){const e=U0;return U0=r,e}function D4e(r,e=cn.Default){if(void 0===U0)throw new ge(-203,!1);return null===U0?ZR(r,void 0,e):U0.get(r,e&cn.Optional?null:void 0,e)}function Pe(r,e=cn.Default){return(function jR(){return vy}()||D4e)($t(r),e)}function rt(r,e=cn.Default){return Pe(r,vh(e))}function vh(r){return typeof r>"u"||"number"==typeof r?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function Py(r){const e=[];for(let t=0;t<r.length;t++){const n=$t(r[t]);if(Array.isArray(n)){if(0===n.length)throw new ge(900,!1);let i,o=cn.Default;for(let s=0;s<n.length;s++){const a=n[s],c=H4e(a);"number"==typeof c?-1===c?i=a.token:o|=c:i=a}e.push(Pe(i,o))}else e.push(Pe(n))}return e}function Wu(r,e){return r[Sy]=e,r.prototype[Sy]=e,r}function H4e(r){return r[Sy]}function c3(r){return{toString:r}.toString()}var Ch=function(r){return r[r.OnPush=0]="OnPush",r[r.Default=1]="Default",r}(Ch||{}),bs=function(r){return r[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",r}(bs||{});const tc={},qn=[],yh=i1({\u0275cmp:i1}),Ty=i1({\u0275dir:i1}),Oy=i1({\u0275pipe:i1}),QR=i1({\u0275mod:i1}),l3=i1({\u0275fac:i1}),qu=i1({__NG_ELEMENT_ID__:i1}),JR=i1({__NG_ENV_ID__:i1});function ez(r,e,t){let n=r.length;for(;;){const i=r.indexOf(e,t);if(-1===i)return i;if(0===i||r.charCodeAt(i-1)<=32){const o=e.length;if(i+o===n||r.charCodeAt(i+o)<=32)return i}t=i+1}}function by(r,e,t){let n=0;for(;n<t.length;){const i=t[n];if("number"==typeof i){if(0!==i)break;n++;const o=t[n++],s=t[n++],a=t[n++];r.setAttribute(e,s,a,o)}else{const o=i,s=t[++n];nz(o)?r.setProperty(e,o,s):r.setAttribute(e,o,s),n++}}return n}function tz(r){return 3===r||4===r||6===r}function nz(r){return 64===r.charCodeAt(0)}function ju(r,e){if(null!==e&&0!==e.length)if(null===r||0===r.length)r=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const i=e[n];"number"==typeof i?t=i:0===t||rz(r,t,i,null,-1===t||2===t?e[++n]:null)}}return r}function rz(r,e,t,n,i){let o=0,s=r.length;if(-1===e)s=-1;else for(;o<r.length;){const a=r[o++];if("number"==typeof a){if(a===e){s=-1;break}if(a>e){s=o-1;break}}}for(;o<r.length;){const a=r[o];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==i&&(r[o+1]=i));if(n===r[o+1])return void(r[o+2]=i)}o++,null!==n&&o++,null!==i&&o++}-1!==s&&(r.splice(s,0,e),o=s+1),r.splice(o++,0,t),null!==n&&r.splice(o++,0,n),null!==i&&r.splice(o++,0,i)}const iz="ng-template";function $4e(r,e,t){let n=0,i=!0;for(;n<r.length;){let o=r[n++];if("string"==typeof o&&i){const s=r[n++];if(t&&"class"===o&&-1!==ez(s.toLowerCase(),e,0))return!0}else{if(1===o){for(;n<r.length&&"string"==typeof(o=r[n++]);)if(o.toLowerCase()===e)return!0;return!1}"number"==typeof o&&(i=!1)}}return!1}function oz(r){return 4===r.type&&r.value!==iz}function B4e(r,e,t){return e===(4!==r.type||t?r.value:iz)}function G4e(r,e,t){let n=4;const i=r.attrs||[],o=function q4e(r){for(let e=0;e<r.length;e++)if(tz(r[e]))return e;return r.length}(i);let s=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!s)if(4&n){if(n=2|1&n,""!==c&&!B4e(r,c,t)||""===c&&1===e.length){if(la(n))return!1;s=!0}}else{const l=8&n?c:e[++a];if(8&n&&null!==r.attrs){if(!$4e(r.attrs,l,t)){if(la(n))return!1;s=!0}continue}const d=U4e(8&n?"class":c,i,oz(r),t);if(-1===d){if(la(n))return!1;s=!0;continue}if(""!==l){let m;m=d>o?"":i[d+1].toLowerCase();const E=8&n?m:null;if(E&&-1!==ez(E,l,0)||2&n&&l!==m){if(la(n))return!1;s=!0}}}}else{if(!s&&!la(n)&&!la(c))return!1;if(s&&la(c))continue;s=!1,n=c|1&n}}return la(n)||s}function la(r){return 0==(1&r)}function U4e(r,e,t,n){if(null===e)return-1;let i=0;if(n||!t){let o=!1;for(;i<e.length;){const s=e[i];if(s===r)return i;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===s)break;if(0===s){i+=4;continue}}i+=o?1:2}return-1}return function j4e(r,e){let t=r.indexOf(4);if(t>-1)for(t++;t<r.length;){const n=r[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,r)}function sz(r,e,t=!1){for(let n=0;n<e.length;n++)if(G4e(r,e[n],t))return!0;return!1}function Z4e(r,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(r.length===n.length){for(let i=0;i<r.length;i++)if(r[i]!==n[i])continue e;return!0}}return!1}function az(r,e){return r?":not("+e.trim()+")":e}function Y4e(r){let e=r[0],t=1,n=2,i="",o=!1;for(;t<r.length;){let s=r[t];if("string"==typeof s)if(2&n){const a=r[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?i+="."+s:4&n&&(i+=" "+s);else""!==i&&!la(s)&&(e+=az(o,i),i=""),n=s,o=o||!la(n);t++}return""!==i&&(e+=az(o,i)),e}function je(r){return c3(()=>{const e=lz(r),t={...e,decls:r.decls,vars:r.vars,template:r.template,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,onPush:r.changeDetection===Ch.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&r.dependencies||null,getStandaloneInjector:null,signals:r.signals??!1,data:r.data||{},encapsulation:r.encapsulation||bs.Emulated,styles:r.styles||qn,_:null,schemas:r.schemas||null,tView:null,id:""};uz(t);const n=r.dependencies;return t.directiveDefs=Mh(n,!1),t.pipeDefs=Mh(n,!0),t.id=function nle(r){let e=0;const t=[r.selectors,r.ngContentSelectors,r.hostVars,r.hostAttrs,r.consts,r.vars,r.decls,r.encapsulation,r.standalone,r.signals,r.exportAs,JSON.stringify(r.inputs),JSON.stringify(r.outputs),Object.getOwnPropertyNames(r.type.prototype),!!r.contentQueries,!!r.viewQuery].join("|");for(const i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function wy(r,e,t){const n=r.\u0275cmp;n.directiveDefs=Mh(e,!1),n.pipeDefs=Mh(t,!0)}function Q4e(r){return Rn(r)||K2(r)}function J4e(r){return null!==r}function yi(r){return c3(()=>({type:r.type,bootstrap:r.bootstrap||qn,declarations:r.declarations||qn,imports:r.imports||qn,exports:r.exports||qn,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function cz(r,e){if(null==r)return tc;const t={};for(const n in r)if(r.hasOwnProperty(n)){let i=r[n],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),t[i]=n,e&&(e[i]=o)}return t}function Rt(r){return c3(()=>{const e=lz(r);return uz(e),e})}function Mi(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function Rn(r){return r[yh]||null}function K2(r){return r[Ty]||null}function Ki(r){return r[Oy]||null}function Yo(r,e){const t=r[QR]||null;if(!t&&!0===e)throw new Error(`Type ${o2(r)} does not have '\u0275mod' property.`);return t}function lz(r){const e={};return{type:r.type,providersResolver:null,factory:null,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:r.inputs||tc,exportAs:r.exportAs||null,standalone:!0===r.standalone,signals:!0===r.signals,selectors:r.selectors||qn,viewQuery:r.viewQuery||null,features:r.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:cz(r.inputs,e),outputs:cz(r.outputs)}}function uz(r){r.features?.forEach(e=>e(r))}function Mh(r,e){if(!r)return null;const t=e?Ki:Q4e;return()=>("function"==typeof r?r():r).map(n=>t(n)).filter(J4e)}const Ir=0,et=1,Kt=2,Z1=3,ua=4,Zu=5,Ei=6,q0=7,kr=8,S4=9,j0=10,Zt=11,Yu=12,fz=13,Z0=14,xr=15,Ku=16,Y0=17,nc=18,Xu=19,dz=20,P4=21,u3=22,Eh=23,Sh=24,mn=25,Ny=1,hz=2,rc=7,K0=9,X2=11;function To(r){return Array.isArray(r)&&"object"==typeof r[Ny]}function Oo(r){return Array.isArray(r)&&!0===r[Ny]}function Ay(r){return 0!=(4&r.flags)}function Xl(r){return r.componentOffset>-1}function Th(r){return 1==(1&r.flags)}function fa(r){return!!r.template}function Iy(r){return 0!=(512&r[Kt])}function Ql(r,e){return r.hasOwnProperty(l3)?r[l3]:null}let cle=m1.WeakRef??class ale{constructor(e){this.ref=e}deref(){return this.ref}},ule=0,ic=null,Oh=!1;function S2(r){const e=ic;return ic=r,e}class vz{constructor(){this.id=ule++,this.ref=function lle(r){return new cle(r)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[e,t]of this.producers){const n=t.producerNode.deref();if(null!=n&&t.atTrackingVersion===this.trackingVersion){if(n.producerPollStatus(t.seenValueVersion))return!0}else this.producers.delete(e),n?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const e=Oh;Oh=!0;try{for(const[t,n]of this.consumers){const i=n.consumerNode.deref();null!=i&&i.trackingVersion===n.atTrackingVersion?i.onConsumerDependencyMayHaveChanged():(this.consumers.delete(t),i?.producers.delete(this.id))}}finally{Oh=e}}producerAccessed(){if(Oh)throw new Error("");if(null===ic)return;let e=ic.producers.get(this.id);void 0===e?(e={consumerNode:ic.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:ic.trackingVersion},ic.producers.set(this.id,e),this.consumers.set(ic.id,e)):(e.seenValueVersion=this.valueVersion,e.atTrackingVersion=ic.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==ic?.consumerAllowSignalWrites}producerPollStatus(e){return this.valueVersion!==e||(this.onProducerUpdateValueVersion(),this.valueVersion!==e)}}let Cz=null;const Mz=()=>{};class ple extends vz{constructor(e,t,n){super(),this.watch=e,this.schedule=t,this.dirty=!1,this.cleanupFn=Mz,this.registerOnCleanup=i=>{this.cleanupFn=i},this.consumerAllowSignalWrites=n}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const e=S2(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=Mz,this.watch(this.registerOnCleanup)}finally{S2(e)}}cleanup(){this.cleanupFn()}}class gle{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function Xi(){return Ez}function Ez(r){return r.type.prototype.ngOnChanges&&(r.setInput=_le),mle}function mle(){const r=Pz(this),e=r?.current;if(e){const t=r.previous;if(t===tc)r.previous=e;else for(let n in e)t[n]=e[n];r.current=null,this.ngOnChanges(e)}}function _le(r,e,t,n){const i=this.declaredInputs[t],o=Pz(r)||function vle(r,e){return r[Sz]=e}(r,{previous:tc,current:null}),s=o.current||(o.current={}),a=o.previous,c=a[i];s[i]=new gle(c&&c.currentValue,e,a===tc),r[n]=e}Xi.ngInherit=!0;const Sz="__ngSimpleChanges__";function Pz(r){return r[Sz]||null}const oc=function(r,e,t){},Tz="svg";function b1(r){for(;Array.isArray(r);)r=r[Ir];return r}function Nh(r,e){return b1(e[r])}function bo(r,e){return b1(e[r.index])}function bz(r,e){return r.data[e]}function X0(r,e){return r[e]}function Ko(r,e){const t=e[r];return To(t)?t:t[Ir]}function T4(r,e){return null==e?null:r[e]}function wz(r){r[Y0]=0}function Tle(r){1024&r[Kt]||(r[Kt]|=1024,Az(r,1))}function Nz(r){1024&r[Kt]&&(r[Kt]&=-1025,Az(r,-1))}function Az(r,e){let t=r[Z1];if(null===t)return;t[Zu]+=e;let n=t;for(t=t[Z1];null!==t&&(1===e&&1===n[Zu]||-1===e&&0===n[Zu]);)t[Zu]+=e,n=t,t=t[Z1]}const Vt={lFrame:$z(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function xz(){return Vt.bindingsEnabled}function Q0(){return null!==Vt.skipHydrationRootTNode}function Ee(){return Vt.lFrame.lView}function zn(){return Vt.lFrame.tView}function te(r){return Vt.lFrame.contextLView=r,r[kr]}function ne(r){return Vt.lFrame.contextLView=null,r}function Q2(){let r=Lz();for(;null!==r&&64===r.type;)r=r.parent;return r}function Lz(){return Vt.lFrame.currentTNode}function Ju(){const r=Vt.lFrame,e=r.currentTNode;return r.isParent?e:e.parent}function sc(r,e){const t=Vt.lFrame;t.currentTNode=r,t.isParent=e}function Dy(){return Vt.lFrame.isParent}function Hy(){Vt.lFrame.isParent=!1}function Qi(){const r=Vt.lFrame;let e=r.bindingRootIndex;return-1===e&&(e=r.bindingRootIndex=r.tView.bindingStartIndex),e}function f3(){return Vt.lFrame.bindingIndex}function J0(){return Vt.lFrame.bindingIndex++}function d3(r){const e=Vt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+r,t}function Dz(r){Vt.lFrame.inI18n=r}function Dle(r,e){const t=Vt.lFrame;t.bindingIndex=t.bindingRootIndex=r,Vy(e)}function Vy(r){Vt.lFrame.currentDirectiveIndex=r}function Hz(){return Vt.lFrame.currentQueryIndex}function $y(r){Vt.lFrame.currentQueryIndex=r}function Vle(r){const e=r[et];return 2===e.type?e.declTNode:1===e.type?r[Ei]:null}function Vz(r,e,t){if(t&cn.SkipSelf){let i=e,o=r;for(;!(i=i.parent,null!==i||t&cn.Host||(i=Vle(o),null===i||(o=o[Z0],10&i.type))););if(null===i)return!1;e=i,r=o}const n=Vt.lFrame=Fz();return n.currentTNode=e,n.lView=r,!0}function By(r){const e=Fz(),t=r[et];Vt.lFrame=e,e.currentTNode=t.firstChild,e.lView=r,e.tView=t,e.contextLView=r,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Fz(){const r=Vt.lFrame,e=null===r?null:r.child;return null===e?$z(r):e}function $z(r){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=e),e}function Bz(){const r=Vt.lFrame;return Vt.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const Gz=Bz;function Gy(){const r=Bz();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function Ji(){return Vt.lFrame.selectedIndex}function Jl(r){Vt.lFrame.selectedIndex=r}function rr(){const r=Vt.lFrame;return bz(r.tView,r.selectedIndex)}function A(){Vt.lFrame.currentNamespace=Tz}let Wz=!0;function Ah(){return Wz}function O4(r){Wz=r}function Ih(r,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const o=r.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:f}=o;s&&(r.contentHooks??=[]).push(-t,s),a&&((r.contentHooks??=[]).push(t,a),(r.contentCheckHooks??=[]).push(t,a)),c&&(r.viewHooks??=[]).push(-t,c),l&&((r.viewHooks??=[]).push(t,l),(r.viewCheckHooks??=[]).push(t,l)),null!=f&&(r.destroyHooks??=[]).push(t,f)}}function kh(r,e,t){qz(r,e,3,t)}function xh(r,e,t,n){(3&r[Kt])===t&&qz(r,e,t,n)}function Uy(r,e){let t=r[Kt];(3&t)===e&&(t&=8191,t+=1,r[Kt]=t)}function qz(r,e,t,n){const o=n??-1,s=e.length-1;let a=0;for(let c=void 0!==n?65535&r[Y0]:0;c<s;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=n&&a>=n)break}else e[c]<0&&(r[Y0]+=65536),(a<o||-1==o)&&(qle(r,t,e,c),r[Y0]=(4294901760&r[Y0])+c+2),c++}function jz(r,e){oc(4,r,e);const t=S2(null);try{e.call(r)}finally{S2(t),oc(5,r,e)}}function qle(r,e,t,n){const i=t[n]<0,o=t[n+1],a=r[i?-t[n]:t[n]];i?r[Kt]>>13<r[Y0]>>16&&(3&r[Kt])===e&&(r[Kt]+=8192,jz(a,o)):jz(a,o)}const e8=-1;class e7{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function qy(r){return r!==e8}function t7(r){return 32767&r}function n7(r,e){let t=function Kle(r){return r>>16}(r),n=e;for(;t>0;)n=n[Z0],t--;return n}let jy=!0;function Lh(r){const e=jy;return jy=r,e}const Zz=255,Yz=5;let Xle=0;const ac={};function Rh(r,e){const t=Kz(r,e);if(-1!==t)return t;const n=e[et];n.firstCreatePass&&(r.injectorIndex=e.length,Zy(n.data,r),Zy(e,null),Zy(n.blueprint,null));const i=zh(r,e),o=r.injectorIndex;if(qy(i)){const s=t7(i),a=n7(i,e),c=a[et].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|c[s+l]}return e[o+8]=i,o}function Zy(r,e){r.push(0,0,0,0,0,0,0,0,e)}function Kz(r,e){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===e[r.injectorIndex+8]?-1:r.injectorIndex}function zh(r,e){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let t=0,n=null,i=e;for(;null!==i;){if(n=rD(i),null===n)return e8;if(t++,i=i[Z0],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return e8}function Yy(r,e,t){!function Qle(r,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(qu)&&(n=t[qu]),null==n&&(n=t[qu]=Xle++);const i=n&Zz;e.data[r+(i>>Yz)]|=1<<i}(r,e,t)}function Xz(r,e,t){if(t&cn.Optional||void 0!==r)return r;my()}function Qz(r,e,t,n){if(t&cn.Optional&&void 0===n&&(n=null),!(t&(cn.Self|cn.Host))){const i=r[S4],o=Po(void 0);try{return i?i.get(e,n,t&cn.Optional):ZR(e,n,t&cn.Optional)}finally{Po(o)}}return Xz(n,0,t)}function Jz(r,e,t,n=cn.Default,i){if(null!==r){if(2048&e[Kt]&&!(n&cn.Self)){const s=function i6e(r,e,t,n,i){let o=r,s=e;for(;null!==o&&null!==s&&2048&s[Kt]&&!(512&s[Kt]);){const a=eD(o,s,t,n|cn.Self,ac);if(a!==ac)return a;let c=o.parent;if(!c){const l=s[dz];if(l){const f=l.get(t,ac,n);if(f!==ac)return f}c=rD(s),s=s[Z0]}o=c}return i}(r,e,t,n,ac);if(s!==ac)return s}const o=eD(r,e,t,n,ac);if(o!==ac)return o}return Qz(e,t,n,i)}function eD(r,e,t,n,i){const o=function t6e(r){if("string"==typeof r)return r.charCodeAt(0)||0;const e=r.hasOwnProperty(qu)?r[qu]:void 0;return"number"==typeof e?e>=0?e&Zz:r6e:e}(t);if("function"==typeof o){if(!Vz(e,r,n))return n&cn.Host?Xz(i,0,n):Qz(e,t,n,i);try{let s;if(s=o(n),null!=s||n&cn.Optional)return s;my()}finally{Gz()}}else if("number"==typeof o){let s=null,a=Kz(r,e),c=e8,l=n&cn.Host?e[xr][Ei]:null;for((-1===a||n&cn.SkipSelf)&&(c=-1===a?zh(r,e):e[a+8],c!==e8&&nD(n,!1)?(s=e[et],a=t7(c),e=n7(c,e)):a=-1);-1!==a;){const f=e[et];if(tD(o,a,f.data)){const d=e6e(a,e,t,s,n,l);if(d!==ac)return d}c=e[a+8],c!==e8&&nD(n,e[et].data[a+8]===l)&&tD(o,a,e)?(s=f,a=t7(c),e=n7(c,e)):a=-1}}return i}function e6e(r,e,t,n,i,o){const s=e[et],a=s.data[r+8],f=Dh(a,s,t,null==n?Xl(a)&&jy:n!=s&&0!=(3&a.type),i&cn.Host&&o===a);return null!==f?e6(e,s,f,a):ac}function Dh(r,e,t,n,i){const o=r.providerIndexes,s=e.data,a=1048575&o,c=r.directiveStart,f=o>>20,m=i?a+f:r.directiveEnd;for(let E=n?a:a+f;E<m;E++){const w=s[E];if(E<c&&t===w||E>=c&&w.type===t)return E}if(i){const E=s[c];if(E&&fa(E)&&E.type===t)return c}return null}function e6(r,e,t,n){let i=r[t];const o=e.data;if(function jle(r){return r instanceof e7}(i)){const s=i;s.resolving&&function P4e(r,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${r}`:"";throw new ge(-200,`Circular dependency in DI detected for ${r}${t}`)}(function t1(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():jt(r)}(o[t]));const a=Lh(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?Po(s.injectImpl):null;Vz(r,n,cn.Default);try{i=r[t]=s.factory(void 0,o,r,n),e.firstCreatePass&&t>=n.directiveStart&&function Wle(r,e,t){const{ngOnChanges:n,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(n){const s=Ez(e);(t.preOrderHooks??=[]).push(r,s),(t.preOrderCheckHooks??=[]).push(r,s)}i&&(t.preOrderHooks??=[]).push(0-r,i),o&&((t.preOrderHooks??=[]).push(r,o),(t.preOrderCheckHooks??=[]).push(r,o))}(t,o[t],e)}finally{null!==l&&Po(l),Lh(a),s.resolving=!1,Gz()}}return i}function tD(r,e,t){return!!(t[e+(r>>Yz)]&1<<r)}function nD(r,e){return!(r&cn.Self||r&cn.Host&&e)}class eo{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return Jz(this._tNode,this._lView,e,vh(n),t)}}function r6e(){return new eo(Q2(),Ee())}function ir(r){return c3(()=>{const e=r.prototype.constructor,t=e[l3]||Ky(e),n=Object.prototype;let i=Object.getPrototypeOf(r.prototype).constructor;for(;i&&i!==n;){const o=i[l3]||Ky(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Ky(r){return py(r)?()=>{const e=Ky($t(r));return e&&e()}:Ql(r)}function rD(r){const e=r[et],t=e.type;return 2===t?e.declTNode:1===t?r[Ei]:null}const n8="__parameters__";function i8(r,e,t){return c3(()=>{const n=function Xy(r){return function(...t){if(r){const n=r(...t);for(const i in n)this[i]=n[i]}}}(e);function i(...o){if(this instanceof i)return n.apply(this,o),this;const s=new i(...o);return a.annotation=s,a;function a(c,l,f){const d=c.hasOwnProperty(n8)?c[n8]:Object.defineProperty(c,n8,{value:[]})[n8];for(;d.length<=f;)d.push(null);return(d[f]=d[f]||[]).push(s),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=r,i.annotationCls=i,i})}function s8(r,e){r.forEach(t=>Array.isArray(t)?s8(t,e):e(t))}function oD(r,e,t){e>=r.length?r.push(t):r.splice(e,0,t)}function Vh(r,e){return e>=r.length-1?r.pop():r.splice(e,1)[0]}function o7(r,e){const t=[];for(let n=0;n<r;n++)t.push(e);return t}function Xo(r,e,t){let n=a8(r,e);return n>=0?r[1|n]=t:(n=~n,function f6e(r,e,t,n){let i=r.length;if(i==e)r.push(t,n);else if(1===i)r.push(n,r[0]),r[0]=t;else{for(i--,r.push(r[i-1],r[i]);i>e;)r[i]=r[i-2],i--;r[e]=t,r[e+1]=n}}(r,n,e,t)),n}function Qy(r,e){const t=a8(r,e);if(t>=0)return r[1|t]}function a8(r,e){return function sD(r,e,t){let n=0,i=r.length>>t;for(;i!==n;){const o=n+(i-n>>1),s=r[o<<t];if(e===s)return o<<t;s>e?i=o:n=o+1}return~(i<<t)}(r,e,1)}const to=Wu(i8("Optional"),8),$h=Wu(i8("SkipSelf"),4);function qh(r){return 128==(128&r.flags)}var b4=function(r){return r[r.Important=1]="Important",r[r.DashCase=2]="DashCase",r}(b4||{});const k6e=/^>|^->|<!--|-->|--!>|<!-$/g,x6e=/(<|>)/,L6e="\u200b$1\u200b";const rM=new Map;let R6e=0;const oM="__ngContext__";function Si(r,e){To(e)?(r[oM]=e[Xu],function D6e(r){rM.set(r[Xu],r)}(e)):r[oM]=e}let sM;function aM(r,e){return sM(r,e)}function c7(r){const e=r[Z1];return Oo(e)?e[Z1]:e}function OD(r){return wD(r[Yu])}function bD(r){return wD(r[ua])}function wD(r){for(;null!==r&&!Oo(r);)r=r[ua];return r}function u8(r,e,t,n,i){if(null!=n){let o,s=!1;Oo(n)?o=n:To(n)&&(s=!0,n=n[Ir]);const a=b1(n);0===r&&null!==t?null==i?kD(e,t,a):t6(e,t,a,i||null,!0):1===r&&null!==t?t6(e,t,a,i||null,!0):2===r?Jh(e,a,s):3===r&&e.destroyNode(a),null!=o&&function o0e(r,e,t,n,i){const o=t[rc];o!==b1(t)&&u8(e,r,n,o,i);for(let a=X2;a<t.length;a++){const c=t[a];u7(c[et],c,r,e,n,o)}}(e,r,o,t,i)}}function Zh(r,e){return r.createText(e)}function ND(r,e,t){r.setValue(e,t)}function cM(r,e){return r.createComment(function vD(r){return r.replace(k6e,e=>e.replace(x6e,L6e))}(e))}function Yh(r,e,t){return r.createElement(e,t)}function AD(r,e){const t=r[K0],n=t.indexOf(e);Nz(e),t.splice(n,1)}function Kh(r,e){if(r.length<=X2)return;const t=X2+e,n=r[t];if(n){const i=n[Ku];null!==i&&i!==r&&AD(i,n),e>0&&(r[t-1][ua]=n[ua]);const o=Vh(r,X2+e);!function Z6e(r,e){u7(r,e,e[Zt],2,null,null),e[Ir]=null,e[Ei]=null}(n[et],n);const s=o[nc];null!==s&&s.detachView(o[et]),n[Z1]=null,n[ua]=null,n[Kt]&=-129}return n}function lM(r,e){if(!(256&e[Kt])){const t=e[Zt];e[Eh]?.destroy(),e[Sh]?.destroy(),t.destroyNode&&u7(r,e,t,3,null,null),function X6e(r){let e=r[Yu];if(!e)return uM(r[et],r);for(;e;){let t=null;if(To(e))t=e[Yu];else{const n=e[X2];n&&(t=n)}if(!t){for(;e&&!e[ua]&&e!==r;)To(e)&&uM(e[et],e),e=e[Z1];null===e&&(e=r),To(e)&&uM(e[et],e),t=e&&e[ua]}e=t}}(e)}}function uM(r,e){if(!(256&e[Kt])){e[Kt]&=-129,e[Kt]|=256,function t0e(r,e){let t;if(null!=r&&null!=(t=r.destroyHooks))for(let n=0;n<t.length;n+=2){const i=e[t[n]];if(!(i instanceof e7)){const o=t[n+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=i[o[s]],c=o[s+1];oc(4,a,c);try{c.call(a)}finally{oc(5,a,c)}}else{oc(4,i,o);try{o.call(i)}finally{oc(5,i,o)}}}}}(r,e),function e0e(r,e){const t=r.cleanup,n=e[q0];if(null!==t)for(let o=0;o<t.length-1;o+=2)if("string"==typeof t[o]){const s=t[o+3];s>=0?n[s]():n[-s].unsubscribe(),o+=2}else t[o].call(n[t[o+1]]);null!==n&&(e[q0]=null);const i=e[P4];if(null!==i){e[P4]=null;for(let o=0;o<i.length;o++)(0,i[o])()}}(r,e),1===e[et].type&&e[Zt].destroy();const t=e[Ku];if(null!==t&&Oo(e[Z1])){t!==e[Z1]&&AD(t,e);const n=e[nc];null!==n&&n.detachView(r)}!function H6e(r){rM.delete(r[Xu])}(e)}}function fM(r,e,t){return ID(r,e.parent,t)}function ID(r,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[Ir];{const{componentOffset:i}=n;if(i>-1){const{encapsulation:o}=r.data[n.directiveStart+i];if(o===bs.None||o===bs.Emulated)return null}return bo(n,t)}}function t6(r,e,t,n,i){r.insertBefore(e,t,n,i)}function kD(r,e,t){r.appendChild(e,t)}function xD(r,e,t,n,i){null!==n?t6(r,e,t,n,i):kD(r,e,t)}function Xh(r,e){return r.parentNode(e)}function LD(r,e,t){return zD(r,e,t)}function RD(r,e,t){return 40&r.type?bo(r,t):null}let dM,ep,mM,tp,zD=RD;function DD(r,e){zD=r,dM=e}function Qh(r,e,t,n){const i=fM(r,n,e),o=e[Zt],a=LD(n.parent||e[Ei],n,e);if(null!=i)if(Array.isArray(t))for(let c=0;c<t.length;c++)xD(o,i,t[c],a,!1);else xD(o,i,t,a,!1);void 0!==dM&&dM(o,n,e,t,i)}function l7(r,e){if(null!==e){const t=e.type;if(3&t)return bo(e,r);if(4&t)return hM(-1,r[e.index]);if(8&t){const n=e.child;if(null!==n)return l7(r,n);{const i=r[e.index];return Oo(i)?hM(-1,i):b1(i)}}if(32&t)return aM(e,r)()||b1(r[e.index]);{const n=HD(r,e);return null!==n?Array.isArray(n)?n[0]:l7(c7(r[xr]),n):l7(r,e.next)}}return null}function HD(r,e){return null!==e?r[xr][Ei].projection[e.projection]:null}function hM(r,e){const t=X2+r+1;if(t<e.length){const n=e[t],i=n[et].firstChild;if(null!==i)return l7(n,i)}return e[rc]}function Jh(r,e,t){const n=Xh(r,e);n&&function n0e(r,e,t,n){r.removeChild(e,t,n)}(r,n,e,t)}function pM(r,e,t,n,i,o,s){for(;null!=t;){const a=n[t.index],c=t.type;if(s&&0===e&&(a&&Si(b1(a),n),t.flags|=2),32!=(32&t.flags))if(8&c)pM(r,e,t.child,n,i,o,!1),u8(e,r,i,a,o);else if(32&c){const l=aM(t,n);let f;for(;f=l();)u8(e,r,i,f,o);u8(e,r,i,a,o)}else 16&c?FD(r,e,n,t,i,o):u8(e,r,i,a,o);t=s?t.projectionNext:t.next}}function u7(r,e,t,n,i,o){pM(t,n,r.firstChild,e,i,o,!1)}function FD(r,e,t,n,i,o){const s=t[xr],c=s[Ei].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)u8(e,r,i,c[l],o);else{let l=c;const f=s[Z1];qh(n)&&(l.flags|=128),pM(r,e,l,f,i,o,!0)}}function $D(r,e,t){""===t?r.removeAttribute(e,"class"):r.setAttribute(e,"class",t)}function BD(r,e,t){const{mergedAttrs:n,classes:i,styles:o}=t;null!==n&&by(r,e,n),null!==i&&$D(r,e,i),null!==o&&function a0e(r,e,t){r.setAttribute(e,"style",t)}(r,e,o)}function f8(r){return function gM(){if(void 0===ep&&(ep=null,m1.trustedTypes))try{ep=m1.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return ep}()?.createHTML(r)||r}function d8(){if(void 0!==mM)return mM;if(typeof document<"u")return document;throw new ge(210,!1)}function _M(){if(void 0===tp&&(tp=null,m1.trustedTypes))try{tp=m1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return tp}function GD(r){return _M()?.createHTML(r)||r}function WD(r){return _M()?.createScriptURL(r)||r}class n6{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${UR})`}}class d0e extends n6{getTypeName(){return"HTML"}}class h0e extends n6{getTypeName(){return"Style"}}class p0e extends n6{getTypeName(){return"Script"}}class g0e extends n6{getTypeName(){return"URL"}}class m0e extends n6{getTypeName(){return"ResourceURL"}}function Qo(r){return r instanceof n6?r.changingThisBreaksApplicationSecurity:r}function cc(r,e){const t=function _0e(r){return r instanceof n6&&r.getTypeName()||null}(r);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${UR})`)}return t===e}function qD(r){const e=new P0e(r);return function T0e(){try{return!!(new window.DOMParser).parseFromString(f8(""),"text/html")}catch{return!1}}()?new S0e(e):e}class S0e{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(f8(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class P0e{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=f8(e),t}}const O0e=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function np(r){return(r=String(r)).match(O0e)?r:"unsafe:"+r}function h3(r){const e={};for(const t of r.split(","))e[t]=!0;return e}function f7(...r){const e={};for(const t of r)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const jD=h3("area,br,col,hr,img,wbr"),ZD=h3("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),YD=h3("rp,rt"),vM=f7(jD,f7(ZD,h3("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),f7(YD,h3("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),f7(YD,ZD)),CM=h3("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),KD=f7(CM,h3("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),h3("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),b0e=h3("script,style,template");class w0e{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!vM.hasOwnProperty(t))return this.sanitizedSomething=!0,!b0e.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let i=0;i<n.length;i++){const o=n.item(i),s=o.name,a=s.toLowerCase();if(!KD.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=o.value;CM[a]&&(c=np(c)),this.buf.push(" ",s,'="',XD(c),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();vM.hasOwnProperty(t)&&!jD.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(XD(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const N0e=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,A0e=/([^\#-~ |!])/g;function XD(r){return r.replace(/&/g,"&amp;").replace(N0e,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(A0e,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let rp;function QD(r,e){let t=null;try{rp=rp||qD(r);let n=e?String(e):"";t=rp.getInertBodyElement(n);let i=5,o=n;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,n=o,o=t.innerHTML,t=rp.getInertBodyElement(n)}while(n!==o);return f8((new w0e).sanitizeChildren(yM(t)||t))}finally{if(t){const n=yM(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function yM(r){return"content"in r&&function I0e(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var Ns=function(r){return r[r.NONE=0]="NONE",r[r.HTML=1]="HTML",r[r.STYLE=2]="STYLE",r[r.SCRIPT=3]="SCRIPT",r[r.URL=4]="URL",r[r.RESOURCE_URL=5]="RESOURCE_URL",r}(Ns||{});function d7(r){const e=h7();return e?GD(e.sanitize(Ns.HTML,r)||""):cc(r,"HTML")?GD(Qo(r)):QD(d8(),jt(r))}function ip(r){const e=h7();return e?e.sanitize(Ns.URL,r)||"":cc(r,"URL")?Qo(r):np(jt(r))}function JD(r){const e=h7();if(e)return WD(e.sanitize(Ns.RESOURCE_URL,r)||"");if(cc(r,"ResourceURL"))return WD(Qo(r));throw new ge(904,!1)}function h7(){const r=Ee();return r&&r[j0].sanitizer}class tt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=He({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const p7=new tt("ENVIRONMENT_INITIALIZER"),tH=new tt("INJECTOR",-1),nH=new tt("INJECTOR_DEF_TYPES");class MM{get(e,t=Uu){if(t===Uu){const n=new Error(`NullInjectorError: No provider for ${o2(e)}!`);throw n.name="NullInjectorError",n}return t}}function D0e(...r){return{\u0275providers:rH(0,r),\u0275fromNgModule:!0}}function rH(r,...e){const t=[],n=new Set;let i;const o=s=>{t.push(s)};return s8(e,s=>{const a=s;op(a,o,[],n)&&(i||=[],i.push(a))}),void 0!==i&&iH(i,o),t}function iH(r,e){for(let t=0;t<r.length;t++){const{ngModule:n,providers:i}=r[t];SM(i,o=>{e(o,n)})}}function op(r,e,t,n){if(!(r=$t(r)))return!1;let i=null,o=gh(r);const s=!o&&Rn(r);if(o||s){if(s&&!s.standalone)return!1;i=r}else{const c=r.ngModule;if(o=gh(c),!o)return!1;i=c}const a=n.has(i);if(s){if(a)return!1;if(n.add(i),s.dependencies){const c="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const l of c)op(l,e,t,n)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let l;n.add(i);try{s8(o.imports,f=>{op(f,e,t,n)&&(l||=[],l.push(f))})}finally{}void 0!==l&&iH(l,e)}if(!a){const l=Ql(i)||(()=>new i);e({provide:i,useFactory:l,deps:qn},i),e({provide:nH,useValue:i,multi:!0},i),e({provide:p7,useValue:()=>Pe(i),multi:!0},i)}const c=o.providers;if(null!=c&&!a){const l=r;SM(c,f=>{e(f,l)})}}}return i!==r&&void 0!==r.providers}function SM(r,e){for(let t of r)gy(t)&&(t=t.\u0275providers),Array.isArray(t)?SM(t,e):e(t)}const H0e=i1({provide:String,useValue:i1});function PM(r){return null!==r&&"object"==typeof r&&H0e in r}function r6(r){return"function"==typeof r}const TM=new tt("Set Injector scope."),sp={},F0e={};let OM;function ap(){return void 0===OM&&(OM=new MM),OM}class Jo{}class cp extends Jo{get destroyed(){return this._destroyed}constructor(e,t,n,i){super(),this.parent=t,this.source=n,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,wM(e,s=>this.processProvider(s)),this.records.set(tH,h8(void 0,this)),i.has("environment")&&this.records.set(Jo,h8(void 0,this));const o=this.records.get(TM);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(nH.multi,qn,cn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=E4(this),n=Po(void 0);try{return e()}finally{E4(t),Po(n)}}get(e,t=Uu,n=cn.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(JR))return e[JR](this);n=vh(n);const o=E4(this),s=Po(void 0);try{if(!(n&cn.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function W0e(r){return"function"==typeof r||"object"==typeof r&&r instanceof tt}(e)&&ph(e);c=l&&this.injectableDefInScope(l)?h8(bM(e),sp):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(n&cn.Self?ap():this.parent).get(e,t=n&cn.Optional&&t===Uu?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[_h]=a[_h]||[]).unshift(o2(e)),o)throw a;return function V4e(r,e,t,n){const i=r[_h];throw e[KR]&&i.unshift(e[KR]),r.message=function F4e(r,e,t,n=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.slice(2):r;let i=o2(e);if(Array.isArray(e))i=e.map(o2).join(" -> ");else if("object"==typeof e){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):o2(a)))}i=`{${o.join(", ")}}`}return`${t}${n?"("+n+")":""}[${i}]: ${r.replace(L4e,"\n  ")}`}("\n"+r.message,i,t,n),r.ngTokenPath=i,r[_h]=null,r}(a,e,"R3InjectorError",this.source)}throw a}finally{Po(s),E4(o)}}resolveInjectorInitializers(){const e=E4(this),t=Po(void 0);try{const i=this.get(p7.multi,qn,cn.Self);for(const o of i)o()}finally{E4(e),Po(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(o2(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ge(205,!1)}processProvider(e){let t=r6(e=$t(e))?e:$t(e&&e.provide);const n=function B0e(r){return PM(r)?h8(void 0,r.useValue):h8(aH(r),sp)}(e);if(r6(e)||!0!==e.multi)this.records.get(t);else{let i=this.records.get(t);i||(i=h8(void 0,sp,!0),i.factory=()=>Py(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===sp&&(t.value=F0e,t.value=t.factory()),"object"==typeof t.value&&t.value&&function U0e(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=$t(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function bM(r){const e=ph(r),t=null!==e?e.factory:Ql(r);if(null!==t)return t;if(r instanceof tt)throw new ge(204,!1);if(r instanceof Function)return function $0e(r){const e=r.length;if(e>0)throw o7(e,"?"),new ge(204,!1);const t=function A4e(r){return r&&(r[mh]||r[qR])||null}(r);return null!==t?()=>t.factory(r):()=>new r}(r);throw new ge(204,!1)}function aH(r,e,t){let n;if(r6(r)){const i=$t(r);return Ql(i)||bM(i)}if(PM(r))n=()=>$t(r.useValue);else if(function sH(r){return!(!r||!r.useFactory)}(r))n=()=>r.useFactory(...Py(r.deps||[]));else if(function oH(r){return!(!r||!r.useExisting)}(r))n=()=>Pe($t(r.useExisting));else{const i=$t(r&&(r.useClass||r.provide));if(!function G0e(r){return!!r.deps}(r))return Ql(i)||bM(i);n=()=>new i(...Py(r.deps))}return n}function h8(r,e,t=!1){return{factory:r,value:e,multi:t?[]:void 0}}function wM(r,e){for(const t of r)Array.isArray(t)?wM(t,e):t&&gy(t)?wM(t.\u0275providers,e):e(t)}const lp=new tt("AppId",{providedIn:"root",factory:()=>q0e}),q0e="ng",cH=new tt("Platform Initializer"),p3=new tt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),lH=new tt("AnimationModuleType"),uH=new tt("CSP nonce",{providedIn:"root",factory:()=>d8().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let dH=(r,e,t)=>null;function RM(r,e,t=!1){return dH(r,e,t)}class n8e{}class gH{}class i8e{resolveComponentFactory(e){throw function r8e(r){const e=Error(`No component factory found for ${o2(r)}.`);return e.ngComponent=r,e}(e)}}let gp=(()=>{class e{}return e.NULL=new i8e,e})();function o8e(){return g8(Q2(),Ee())}function g8(r,e){return new Pi(bo(r,e))}let Pi=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=o8e,e})();function s8e(r){return r instanceof Pi?r.nativeElement:r}class v7{}let lc=(()=>{class e{constructor(){this.destroyNode=null}}return e.__NG_ELEMENT_ID__=()=>function a8e(){const r=Ee(),t=Ko(Q2().index,r);return(To(t)?t:r)[Zt]}(),e})(),c8e=(()=>{var r;class e{}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:()=>null}),e})();class m8{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const _H=new m8("16.2.0"),HM={};function MH(r,e=null,t=null,n){const i=EH(r,e,t,n);return i.resolveInjectorInitializers(),i}function EH(r,e=null,t=null,n,i=new Set){const o=[t||qn,D0e(r)];return n=n||("object"==typeof r?void 0:o2(r)),new cp(o,e||ap(),n||null,i)}let J2=(()=>{var r;class e{static create(n,i){if(Array.isArray(n))return MH({name:""},i,n,"");{const o=n.name??"";return MH({name:o},n.parent,n.providers,o)}}}return(r=e).THROW_IF_NOT_FOUND=Uu,r.NULL=new MM,r.\u0275prov=He({token:r,providedIn:"any",factory:()=>Pe(tH)}),r.__NG_ELEMENT_ID__=-1,e})();function g3(r){return r instanceof Function?r():r}let $M=(()=>{var r;class e{constructor(){this.callbacks=new Set,this.deferredCallbacks=new Set,this.renderDepth=0,this.runningCallbacks=!1}begin(){if(this.runningCallbacks)throw new ge(102,!1);this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth)try{this.runningCallbacks=!0;for(const n of this.callbacks)n.invoke()}finally{this.runningCallbacks=!1;for(const n of this.deferredCallbacks)this.callbacks.add(n);this.deferredCallbacks.clear()}}register(n){(this.runningCallbacks?this.deferredCallbacks:this.callbacks).add(n)}unregister(n){this.callbacks.delete(n),this.deferredCallbacks.delete(n)}ngOnDestroy(){this.callbacks.clear(),this.deferredCallbacks.clear()}}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:()=>new r}),e})();function C7(r){for(;r;){r[Kt]|=64;const e=c7(r);if(Iy(r)&&!e)return r;r=e}return null}function BM(r){return r.ngOriginalError}class i6{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&BM(e);for(;t&&BM(t);)t=BM(t);return t||null}}const bH=new tt("",{providedIn:"root",factory:()=>!1});class IH extends vz{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(e){this._lView=e}onConsumerDependencyMayHaveChanged(){C7(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(e,t,n){const i=S2(this);this.trackingVersion++;try{e(t,n)}finally{S2(i)}}destroy(){this.trackingVersion++}}let _p=null;function kH(){return _p??=new IH,_p}function xH(r,e){return r[e]??kH()}function LH(r,e){const t=kH();t.hasReadASignal&&(r[e]=_p,t.lView=r,_p=new IH)}const Xt={};function _(r){RH(zn(),Ee(),Ji()+r,!1)}function RH(r,e,t,n){if(!n)if(3==(3&e[Kt])){const o=r.preOrderCheckHooks;null!==o&&kh(e,o,t)}else{const o=r.preOrderHooks;null!==o&&xh(e,o,0,t)}Jl(t)}function G(r,e=cn.Default){const t=Ee();return null===t?Pe(r,e):Jz(Q2(),t,$t(r),e)}function vp(r,e,t,n,i,o,s,a,c,l,f){const d=e.blueprint.slice();return d[Ir]=i,d[Kt]=140|n,(null!==l||r&&2048&r[Kt])&&(d[Kt]|=2048),wz(d),d[Z1]=d[Z0]=r,d[kr]=t,d[j0]=s||r&&r[j0],d[Zt]=a||r&&r[Zt],d[S4]=c||r&&r[S4]||null,d[Ei]=o,d[Xu]=function z6e(){return R6e++}(),d[u3]=f,d[dz]=l,d[xr]=2==e.type?r[xr]:d,d}function C8(r,e,t,n,i){let o=r.data[e];if(null===o)o=GM(r,e,t,n,i),function zle(){return Vt.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=t,o.value=n,o.attrs=i;const s=Ju();o.injectorIndex=null===s?-1:s.injectorIndex}return sc(o,!0),o}function GM(r,e,t,n,i){const o=Lz(),s=Dy(),c=r.data[e]=function I8e(r,e,t,n,i,o){let s=e?e.injectorIndex:-1,a=0;return Q0()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,t,e,n,i);return null===r.firstChild&&(r.firstChild=c),null!==o&&(s?null==o.child&&null!==c.parent&&(o.child=c):null===o.next&&(o.next=c,c.prev=o)),c}function y7(r,e,t,n){if(0===t)return-1;const i=e.length;for(let o=0;o<t;o++)e.push(n),r.blueprint.push(n),r.data.push(null);return i}function DH(r,e,t,n,i){const o=xH(e,Eh),s=Ji(),a=2&n;try{if(Jl(-1),a&&e.length>mn&&RH(r,e,mn,!1),oc(a?2:0,i),a)o.runInContext(t,n,i);else{const l=S2(null);try{t(n,i)}finally{S2(l)}}}finally{a&&null===e[Eh]&&LH(e,Eh),Jl(s),oc(a?3:1,i)}}function UM(r,e,t){if(Ay(e)){const n=S2(null);try{const o=e.directiveEnd;for(let s=e.directiveStart;s<o;s++){const a=r.data[s];a.contentQueries&&a.contentQueries(1,t[s],s)}}finally{S2(n)}}}function WM(r,e,t){xz()&&(function H8e(r,e,t,n){const i=t.directiveStart,o=t.directiveEnd;Xl(t)&&function W8e(r,e,t){const n=bo(e,r),i=HH(t);let s=16;t.signals?s=4096:t.onPush&&(s=64);const a=Cp(r,vp(r,i,null,s,n,e,null,r[j0].rendererFactory.createRenderer(n,t),null,null,null));r[e.index]=a}(e,t,r.data[i+t.componentOffset]),r.firstCreatePass||Rh(t,e),Si(n,e);const s=t.initialInputs;for(let a=i;a<o;a++){const c=r.data[a],l=e6(e,r,a,t);Si(l,e),null!==s&&q8e(0,a-i,l,c,0,s),fa(c)&&(Ko(t.index,e)[kr]=e6(e,r,a,t))}}(r,e,t,bo(t,e)),64==(64&t.flags)&&GH(r,e,t))}function qM(r,e,t=bo){const n=e.localNames;if(null!==n){let i=e.index+1;for(let o=0;o<n.length;o+=2){const s=n[o+1],a=-1===s?t(e,r):r[s];r[i++]=a}}}function HH(r){const e=r.tView;return null===e||e.incompleteFirstPass?r.tView=jM(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts,r.id):e}function jM(r,e,t,n,i,o,s,a,c,l,f){const d=mn+n,m=d+i,E=function T8e(r,e){const t=[];for(let n=0;n<e;n++)t.push(n<r?null:Xt);return t}(d,m),w="function"==typeof l?l():l;return E[et]={type:r,blueprint:E,template:t,queries:null,viewQuery:a,declTNode:e,data:E.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:f}}let VH=r=>null;function FH(r,e,t,n){for(let i in r)if(r.hasOwnProperty(i)){t=null===t?{}:t;const o=r[i];null===n?$H(t,e,i,o):n.hasOwnProperty(i)&&$H(t,e,n[i],o)}return t}function $H(r,e,t,n){r.hasOwnProperty(t)?r[t].push(e,n):r[t]=[e,n]}function es(r,e,t,n,i,o,s,a){const c=bo(e,t);let f,l=e.inputs;!a&&null!=l&&(f=l[n])?(QM(r,t,f,n,i),Xl(e)&&function L8e(r,e){const t=Ko(e,r);16&t[Kt]||(t[Kt]|=64)}(t,e.index)):3&e.type&&(n=function x8e(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(n),i=null!=s?s(i,e.value||"",n):i,o.setProperty(c,n,i))}function ZM(r,e,t,n){if(xz()){const i=null===n?null:{"":-1},o=function F8e(r,e){const t=r.directiveRegistry;let n=null,i=null;if(t)for(let o=0;o<t.length;o++){const s=t[o];if(sz(e,s.selectors,!1))if(n||(n=[]),fa(s))if(null!==s.findHostDirectiveDefs){const a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),n.unshift(...a,s),YM(r,e,a.length)}else n.unshift(s),YM(r,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,n,i),n.push(s)}return null===n?null:[n,i]}(r,t);let s,a;null===o?s=a=null:[s,a]=o,null!==s&&BH(r,e,t,s,i,a),i&&function $8e(r,e,t){if(e){const n=r.localNames=[];for(let i=0;i<e.length;i+=2){const o=t[e[i+1]];if(null==o)throw new ge(-301,!1);n.push(e[i],o)}}}(t,n,i)}t.mergedAttrs=ju(t.mergedAttrs,t.attrs)}function BH(r,e,t,n,i,o){for(let l=0;l<n.length;l++)Yy(Rh(t,e),r,n[l].type);!function G8e(r,e,t){r.flags|=1,r.directiveStart=e,r.directiveEnd=e+t,r.providerIndexes=e}(t,r.data.length,n.length);for(let l=0;l<n.length;l++){const f=n[l];f.providersResolver&&f.providersResolver(f)}let s=!1,a=!1,c=y7(r,e,n.length,null);for(let l=0;l<n.length;l++){const f=n[l];t.mergedAttrs=ju(t.mergedAttrs,f.hostAttrs),U8e(r,t,e,c,f),B8e(c,f,i),null!==f.contentQueries&&(t.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=64);const d=f.type.prototype;!s&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((r.preOrderHooks??=[]).push(t.index),s=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((r.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function k8e(r,e,t){const i=e.directiveEnd,o=r.data,s=e.attrs,a=[];let c=null,l=null;for(let f=e.directiveStart;f<i;f++){const d=o[f],m=t?t.get(d):null,w=m?m.outputs:null;c=FH(d.inputs,f,c,m?m.inputs:null),l=FH(d.outputs,f,l,w);const L=null===c||null===s||oz(e)?null:j8e(c,f,s);a.push(L)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(r,t,o)}function GH(r,e,t){const n=t.directiveStart,i=t.directiveEnd,o=t.index,s=function Hle(){return Vt.lFrame.currentDirectiveIndex}();try{Jl(o);for(let a=n;a<i;a++){const c=r.data[a],l=e[a];Vy(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&V8e(c,l)}}finally{Jl(-1),Vy(s)}}function V8e(r,e){null!==r.hostBindings&&r.hostBindings(1,e)}function YM(r,e,t){e.componentOffset=t,(r.components??=[]).push(e.index)}function B8e(r,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=r;fa(e)&&(t[""]=r)}}function U8e(r,e,t,n,i){r.data[n]=i;const o=i.factory||(i.factory=Ql(i.type)),s=new e7(o,fa(i),G);r.blueprint[n]=s,t[n]=s,function z8e(r,e,t,n,i){const o=i.hostBindings;if(o){let s=r.hostBindingOpCodes;null===s&&(s=r.hostBindingOpCodes=[]);const a=~e.index;(function D8e(r){let e=r.length;for(;e>0;){const t=r[--e];if("number"==typeof t&&t<0)return t}return 0})(s)!=a&&s.push(a),s.push(t,n,o)}}(r,e,n,y7(r,t,i.hostVars,Xt),i)}function uc(r,e,t,n,i,o){const s=bo(r,e);KM(e[Zt],s,o,r.value,t,n,i)}function KM(r,e,t,n,i,o,s){if(null==o)r.removeAttribute(e,i,t);else{const a=null==s?jt(o):s(o,n||"",i);r.setAttribute(e,i,a,t)}}function q8e(r,e,t,n,i,o){const s=o[e];if(null!==s)for(let a=0;a<s.length;)UH(n,t,s[a++],s[a++],s[a++])}function UH(r,e,t,n,i){const o=S2(null);try{const s=r.inputTransforms;null!==s&&s.hasOwnProperty(n)&&(i=s[n].call(e,i)),null!==r.setInput?r.setInput(e,i,t,n):e[n]=i}finally{S2(o)}}function j8e(r,e,t){let n=null,i=0;for(;i<t.length;){const o=t[i];if(0!==o)if(5!==o){if("number"==typeof o)break;if(r.hasOwnProperty(o)){null===n&&(n=[]);const s=r[o];for(let a=0;a<s.length;a+=2)if(s[a]===e){n.push(o,s[a+1],t[i+1]);break}}i+=2}else i+=2;else i+=4}return n}function WH(r,e,t,n){return[r,!0,!1,e,null,0,n,t,null,null,null]}function qH(r,e){const t=r.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const o=t[n+1];if(-1!==o){const s=r.data[o];$y(t[n]),s.contentQueries(2,e[o],o)}}}function Cp(r,e){return r[Yu]?r[fz][ua]=e:r[Yu]=e,r[fz]=e,e}function XM(r,e,t){$y(0);const n=S2(null);try{e(r,t)}finally{S2(n)}}function jH(r){return r[q0]||(r[q0]=[])}function ZH(r){return r.cleanup||(r.cleanup=[])}function KH(r,e){const t=r[S4],n=t?t.get(i6,null):null;n&&n.handleError(e)}function QM(r,e,t,n,i){for(let o=0;o<t.length;){const s=t[o++],a=t[o++];UH(r.data[s],e[s],n,a,i)}}function m3(r,e,t){const n=Nh(e,r);ND(r[Zt],n,t)}function Z8e(r,e){const t=Ko(e,r),n=t[et];!function Y8e(r,e){for(let t=e.length;t<r.blueprint.length;t++)e.push(r.blueprint[t])}(n,t);const i=t[Ir];null!==i&&null===t[u3]&&(t[u3]=RM(i,t[S4])),JM(n,t,t[kr])}function JM(r,e,t){By(e);try{const n=r.viewQuery;null!==n&&XM(1,n,t);const i=r.template;null!==i&&DH(r,e,i,1,t),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&qH(r,e),r.staticViewQueries&&XM(2,r.viewQuery,t);const o=r.components;null!==o&&function K8e(r,e){for(let t=0;t<e.length;t++)Z8e(r,e[t])}(e,o)}catch(n){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),n}finally{e[Kt]&=-5,Gy()}}let XH=(()=>{var r;class e{constructor(){this.all=new Set,this.queue=new Map}create(n,i,o){const s=typeof Zone>"u"?null:Zone.current,a=new ple(n,f=>{this.all.has(f)&&this.queue.set(f,s)},o);let c;this.all.add(a),a.notify();const l=()=>{a.cleanup(),c?.(),this.all.delete(a),this.queue.delete(a)};return c=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[n,i]of this.queue)this.queue.delete(n),i?i.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:()=>new r}),e})();function yp(r,e,t){let n=t?r.styles:null,i=t?r.classes:null,o=0;if(null!==e)for(let s=0;s<e.length;s++){const a=e[s];"number"==typeof a?o=a:1==o?i=hy(i,a):2==o&&(n=hy(n,a+": "+e[++s]+";"))}t?r.styles=n:r.stylesWithoutHost=n,t?r.classes=i:r.classesWithoutHost=i}function M7(r,e,t,n,i=!1){for(;null!==t;){const o=e[t.index];if(null!==o&&n.push(b1(o)),Oo(o)){for(let a=X2;a<o.length;a++){const c=o[a],l=c[et].firstChild;null!==l&&M7(c[et],c,l,n)}o[rc]!==o[Ir]&&n.push(o[rc])}const s=t.type;if(8&s)M7(r,e,t.child,n);else if(32&s){const a=aM(t,e);let c;for(;c=a();)n.push(c)}else if(16&s){const a=HD(e,t);if(Array.isArray(a))n.push(...a);else{const c=c7(e[xr]);M7(c[et],c,a,n,!0)}}t=i?t.projectionNext:t.next}return n}function Mp(r,e,t,n=!0){const i=e[j0],o=i.rendererFactory,s=i.afterRenderEventManager;o.begin?.(),s?.begin();try{QH(r,e,r.template,t)}catch(c){throw n&&KH(e,c),c}finally{o.end?.(),i.effectManager?.flush(),s?.end()}}function QH(r,e,t,n){const i=e[Kt];if(256!=(256&i)){e[j0].effectManager?.flush(),By(e);try{wz(e),function zz(r){return Vt.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==t&&DH(r,e,t,2,n);const s=3==(3&i);if(s){const l=r.preOrderCheckHooks;null!==l&&kh(e,l,null)}else{const l=r.preOrderHooks;null!==l&&xh(e,l,0,null),Uy(e,0)}if(function J8e(r){for(let e=OD(r);null!==e;e=bD(e)){if(!e[hz])continue;const t=e[K0];for(let n=0;n<t.length;n++){Tle(t[n])}}}(e),JH(e,2),null!==r.contentQueries&&qH(r,e),s){const l=r.contentCheckHooks;null!==l&&kh(e,l)}else{const l=r.contentHooks;null!==l&&xh(e,l,1),Uy(e,1)}!function P8e(r,e){const t=r.hostBindingOpCodes;if(null===t)return;const n=xH(e,Sh);try{for(let i=0;i<t.length;i++){const o=t[i];if(o<0)Jl(~o);else{const s=o,a=t[++i],c=t[++i];Dle(a,s),n.runInContext(c,2,e[s])}}}finally{null===e[Sh]&&LH(e,Sh),Jl(-1)}}(r,e);const a=r.components;null!==a&&tV(e,a,0);const c=r.viewQuery;if(null!==c&&XM(2,c,n),s){const l=r.viewCheckHooks;null!==l&&kh(e,l)}else{const l=r.viewHooks;null!==l&&xh(e,l,2),Uy(e,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),e[Kt]&=-73,Nz(e)}finally{Gy()}}}function JH(r,e){for(let t=OD(r);null!==t;t=bD(t))for(let n=X2;n<t.length;n++)eV(t[n],e)}function e5e(r,e,t){eV(Ko(e,r),t)}function eV(r,e){if(!function Sle(r){return 128==(128&r[Kt])}(r))return;const t=r[et];if(80&r[Kt]&&0===e||1024&r[Kt]||2===e)QH(t,r,t.template,r[kr]);else if(r[Zu]>0){JH(r,1);const i=r[et].components;null!==i&&tV(r,i,1)}}function tV(r,e,t){for(let n=0;n<e.length;n++)e5e(r,e[n],t)}class E7{get rootNodes(){const e=this._lView,t=e[et];return M7(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[kr]}set context(e){this._lView[kr]=e}get destroyed(){return 256==(256&this._lView[Kt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Z1];if(Oo(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(Kh(e,n),Vh(t,n))}this._attachedToViewContainer=!1}lM(this._lView[et],this._lView)}onDestroy(e){!function Iz(r,e){if(256==(256&r[Kt]))throw new ge(911,!1);null===r[P4]&&(r[P4]=[]),r[P4].push(e)}(this._lView,e)}markForCheck(){C7(this._cdRefInjectingView||this._lView)}detach(){this._lView[Kt]&=-129}reattach(){this._lView[Kt]|=128}detectChanges(){Mp(this._lView[et],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ge(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function K6e(r,e){u7(r,e,e[Zt],2,null,null)}(this._lView[et],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ge(902,!1);this._appRef=e}}class t5e extends E7{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Mp(e[et],e,e[kr],!1)}checkNoChanges(){}get context(){return null}}class nV extends gp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Rn(e);return new S7(t,this.ngModule)}}function rV(r){const e=[];for(let t in r)r.hasOwnProperty(t)&&e.push({propName:r[t],templateName:t});return e}class r5e{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=vh(n);const i=this.injector.get(e,HM,n);return i!==HM||t===HM?i:this.parentInjector.get(e,t,n)}}class S7 extends gH{get inputs(){const e=this.componentDef,t=e.inputTransforms,n=rV(e.inputs);if(null!==t)for(const i of n)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return n}get outputs(){return rV(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function K4e(r){return r.map(Y4e).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,i){let o=(i=i||this.ngModule)instanceof Jo?i:i?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const s=o?new r5e(e,o):e,a=s.get(v7,null);if(null===a)throw new ge(407,!1);const d={rendererFactory:a,sanitizer:s.get(c8e,null),effectManager:s.get(XH,null),afterRenderEventManager:s.get($M,null)},m=a.createRenderer(null,this.componentDef),E=this.componentDef.selectors[0][0]||"div",w=n?function O8e(r,e,t,n){const o=n.get(bH,!1)||t===bs.ShadowDom,s=r.selectRootElement(e,o);return function b8e(r){VH(r)}(s),s}(m,n,this.componentDef.encapsulation,s):Yh(m,E,function n5e(r){const e=r.toLowerCase();return"svg"===e?Tz:"math"===e?"math":null}(E)),$=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let B=null;null!==w&&(B=RM(w,s,!0));const de=jM(0,null,null,1,0,null,null,null,null,null,null),_e=vp(null,de,null,$,null,null,d,m,s,null,B);let xe,nt;By(_e);try{const gt=this.componentDef;let Mn,Et=null;gt.findHostDirectiveDefs?(Mn=[],Et=new Map,gt.findHostDirectiveDefs(gt,Mn,Et),Mn.push(gt)):Mn=[gt];const q2=function o5e(r,e){const t=r[et],n=mn;return r[n]=e,C8(t,n,2,"#host",null)}(_e,w),D0=function s5e(r,e,t,n,i,o,s){const a=i[et];!function a5e(r,e,t,n){for(const i of r)e.mergedAttrs=ju(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(yp(e,e.mergedAttrs,!0),null!==t&&BD(n,t,e))}(n,r,e,s);let c=null;null!==e&&(c=RM(e,i[S4]));const l=o.rendererFactory.createRenderer(e,t);let f=16;t.signals?f=4096:t.onPush&&(f=64);const d=vp(i,HH(t),null,f,i[r.index],r,o,l,null,null,c);return a.firstCreatePass&&YM(a,r,n.length-1),Cp(i,d),i[r.index]=d}(q2,w,gt,Mn,_e,d,m);nt=bz(de,mn),w&&function l5e(r,e,t,n){if(n)by(r,t,["ng-version",_H.full]);else{const{attrs:i,classes:o}=function X4e(r){const e=[],t=[];let n=1,i=2;for(;n<r.length;){let o=r[n];if("string"==typeof o)2===i?""!==o&&e.push(o,r[++n]):8===i&&t.push(o);else{if(!la(i))break;i=o}n++}return{attrs:e,classes:t}}(e.selectors[0]);i&&by(r,t,i),o&&o.length>0&&$D(r,t,o.join(" "))}}(m,gt,w,n),void 0!==t&&function u5e(r,e,t){const n=r.projection=[];for(let i=0;i<e.length;i++){const o=t[i];n.push(null!=o?Array.from(o):null)}}(nt,this.ngContentSelectors,t),xe=function c5e(r,e,t,n,i,o){const s=Q2(),a=i[et],c=bo(s,i);BH(a,i,s,t,null,n);for(let f=0;f<t.length;f++)Si(e6(i,a,s.directiveStart+f,s),i);GH(a,i,s),c&&Si(c,i);const l=e6(i,a,s.directiveStart+s.componentOffset,s);if(r[kr]=i[kr]=l,null!==o)for(const f of o)f(l,e);return UM(a,s,r),l}(D0,gt,Mn,Et,_e,[f5e]),JM(de,_e,null)}finally{Gy()}return new i5e(this.componentType,xe,g8(nt,_e),_e,nt)}}class i5e extends n8e{constructor(e,t,n,i,o){super(),this.location=n,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new t5e(i),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let i;if(null!==n&&(i=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const o=this._rootLView;QM(o[et],o,i,e,t),this.previousInputValues.set(e,t),C7(Ko(this._tNode.index,o))}}get injector(){return new eo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function f5e(){const r=Q2();Ih(Ee()[et],r)}function Qe(r){let e=function iV(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),t=!0;const n=[r];for(;e;){let i;if(fa(r))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ge(903,!1);i=e.\u0275dir}if(i){if(t){n.push(i);const s=r;s.inputs=Ep(r.inputs),s.inputTransforms=Ep(r.inputTransforms),s.declaredInputs=Ep(r.declaredInputs),s.outputs=Ep(r.outputs);const a=i.hostBindings;a&&g5e(r,a);const c=i.viewQuery,l=i.contentQueries;if(c&&h5e(r,c),l&&p5e(r,l),dh(r.inputs,i.inputs),dh(r.declaredInputs,i.declaredInputs),dh(r.outputs,i.outputs),null!==i.inputTransforms&&(null===s.inputTransforms&&(s.inputTransforms={}),dh(s.inputTransforms,i.inputTransforms)),fa(i)&&i.data.animation){const f=r.data;f.animation=(f.animation||[]).concat(i.data.animation)}}const o=i.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(r),a===Qe&&(t=!1)}}e=Object.getPrototypeOf(e)}!function d5e(r){let e=0,t=null;for(let n=r.length-1;n>=0;n--){const i=r[n];i.hostVars=e+=i.hostVars,i.hostAttrs=ju(i.hostAttrs,t=ju(t,i.hostAttrs))}}(n)}function Ep(r){return r===tc?{}:r===qn?[]:r}function h5e(r,e){const t=r.viewQuery;r.viewQuery=t?(n,i)=>{e(n,i),t(n,i)}:e}function p5e(r,e){const t=r.contentQueries;r.contentQueries=t?(n,i,o)=>{e(n,i,o),t(n,i,o)}:e}function g5e(r,e){const t=r.hostBindings;r.hostBindings=t?(n,i)=>{e(n,i),t(n,i)}:e}function cV(r){const e=r.inputConfig,t={};for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];Array.isArray(i)&&i[2]&&(t[n]=i[2])}r.inputTransforms=t}function Sp(r){return!!eE(r)&&(Array.isArray(r)||!(r instanceof Map)&&Symbol.iterator in r)}function eE(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function fc(r,e,t){return r[e]=t}function Ti(r,e,t){return!Object.is(r[e],t)&&(r[e]=t,!0)}function o6(r,e,t,n){const i=Ti(r,e,t);return Ti(r,e+1,n)||i}function k(r,e,t,n){const i=Ee();return Ti(i,J0(),e)&&(zn(),uc(rr(),i,r,e,t,n)),k}function M8(r,e,t,n){return Ti(r,J0(),t)?e+jt(t)+n:Xt}function E8(r,e,t,n,i,o){const a=o6(r,f3(),t,i);return d3(2),a?e+jt(t)+n+jt(i)+o:Xt}function S8(r,e,t,n,i,o,s,a){const l=function Pp(r,e,t,n,i){const o=o6(r,e,t,n);return Ti(r,e+2,i)||o}(r,f3(),t,i,s);return d3(3),l?e+jt(t)+n+jt(i)+o+jt(s)+a:Xt}function s6(r,e,t,n,i,o){const s=Ee(),a=M8(s,e,t,n);return a!==Xt&&uc(rr(),s,r,a,i,o),s6}function T(r,e,t,n,i,o,s,a){const c=Ee(),l=zn(),f=r+mn,d=l.firstCreatePass?function F5e(r,e,t,n,i,o,s,a,c){const l=e.consts,f=C8(e,r,4,s||null,T4(l,a));ZM(e,t,f,T4(l,c)),Ih(e,f);const d=f.tView=jM(2,f,n,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,f),d.queries=e.queries.embeddedTView(f)),f}(f,l,c,e,t,n,i,o,s):l.data[f];sc(d,!1);const m=yV(l,c,d,r);Ah()&&Qh(l,c,m,d),Si(m,c),Cp(c,c[f]=WH(m,c,m,d)),Th(d)&&WM(l,c,d),null!=s&&qM(c,d,a)}let yV=function MV(r,e,t,n){return O4(!0),e[Zt].createComment("")};function ln(r){return X0(function Rle(){return Vt.lFrame.contextLView}(),mn+r)}function y(r,e,t){const n=Ee();return Ti(n,J0(),e)&&es(zn(),rr(),n,r,e,n[Zt],t,!1),y}function sE(r,e,t,n,i){const s=i?"class":"style";QM(r,t,e.inputs[s],s,n)}function S(r,e,t,n){const i=Ee(),o=zn(),s=mn+r,a=i[Zt],c=o.firstCreatePass?function U5e(r,e,t,n,i,o){const s=e.consts,c=C8(e,r,2,n,T4(s,i));return ZM(e,t,c,T4(s,o)),null!==c.attrs&&yp(c,c.attrs,!1),null!==c.mergedAttrs&&yp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(s,o,i,e,t,n):o.data[s],l=EV(o,i,c,a,e,r);i[s]=l;const f=Th(c);return sc(c,!0),BD(a,l,c),32!=(32&c.flags)&&Ah()&&Qh(o,i,l,c),0===function ble(){return Vt.lFrame.elementDepthCount}()&&Si(l,i),function wle(){Vt.lFrame.elementDepthCount++}(),f&&(WM(o,i,c),UM(o,c,i)),null!==n&&qM(i,c),S}function P(){let r=Q2();Dy()?Hy():(r=r.parent,sc(r,!1));const e=r;(function Ale(r){return Vt.skipHydrationRootTNode===r})(e)&&function Lle(){Vt.skipHydrationRootTNode=null}(),function Nle(){Vt.lFrame.elementDepthCount--}();const t=zn();return t.firstCreatePass&&(Ih(t,r),Ay(r)&&t.queries.elementEnd(r)),null!=e.classesWithoutHost&&function Zle(r){return 0!=(8&r.flags)}(e)&&sE(t,e,Ee(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function Yle(r){return 0!=(16&r.flags)}(e)&&sE(t,e,Ee(),e.stylesWithoutHost,!1),P}function F(r,e,t,n){return S(r,e,t,n),P(),F}let EV=(r,e,t,n,i,o)=>(O4(!0),Yh(n,i,function Uz(){return Vt.lFrame.currentNamespace}()));function Bt(r,e,t){const n=Ee(),i=zn(),o=r+mn,s=i.firstCreatePass?function j5e(r,e,t,n,i){const o=e.consts,s=T4(o,n),a=C8(e,r,8,"ng-container",s);return null!==s&&yp(a,s,!0),ZM(e,t,a,T4(o,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(o,i,n,e,t):i.data[o];sc(s,!0);const a=PV(i,n,s,r);return n[o]=a,Ah()&&Qh(i,n,a,s),Si(a,n),Th(s)&&(WM(i,n,s),UM(i,s,n)),null!=t&&qM(n,s),Bt}function Gt(){let r=Q2();const e=zn();return Dy()?Hy():(r=r.parent,sc(r,!1)),e.firstCreatePass&&(Ih(e,r),Ay(r)&&e.queries.elementEnd(r)),Gt}let PV=(r,e,t,n)=>(O4(!0),cM(e[Zt],""));function pe(){return Ee()}function w7(r){return!!r&&"function"==typeof r.then}function TV(r){return!!r&&"function"==typeof r.subscribe}function U(r,e,t,n){const i=Ee(),o=zn(),s=Q2();return function bV(r,e,t,n,i,o,s){const a=Th(n),l=r.firstCreatePass&&ZH(r),f=e[kr],d=jH(e);let m=!0;if(3&n.type||s){const L=bo(n,e),z=s?s(L):L,$=d.length,B=s?_e=>s(b1(_e[n.index])):n.index;let de=null;if(!s&&a&&(de=function K5e(r,e,t,n){const i=r.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const s=i[o];if(s===t&&i[o+1]===n){const a=e[q0],c=i[o+2];return a.length>c?a[c]:null}"string"==typeof s&&(o+=2)}return null}(r,e,i,n.index)),null!==de)(de.__ngLastListenerFn__||de).__ngNextListenerFn__=o,de.__ngLastListenerFn__=o,m=!1;else{o=NV(n,e,f,o,!1);const _e=t.listen(z,i,o);d.push(o,_e),l&&l.push(i,B,$,$+1)}}else o=NV(n,e,f,o,!1);const E=n.outputs;let w;if(m&&null!==E&&(w=E[i])){const L=w.length;if(L)for(let z=0;z<L;z+=2){const xe=e[w[z]][w[z+1]].subscribe(o),nt=d.length;d.push(o,xe),l&&l.push(i,n.index,nt,-(nt+1))}}}(o,i,i[Zt],s,r,e,n),U}function wV(r,e,t,n){try{return oc(6,e,t),!1!==t(n)}catch(i){return KH(r,i),!1}finally{oc(7,e,t)}}function NV(r,e,t,n,i){return function o(s){if(s===Function)return n;C7(r.componentOffset>-1?Ko(r.index,e):e);let c=wV(e,t,n,s),l=o.__ngNextListenerFn__;for(;l;)c=wV(e,t,l,s)&&c,l=l.__ngNextListenerFn__;return i&&!1===c&&s.preventDefault(),c}}function p(r=1){return function Fle(r){return(Vt.lFrame.contextLView=function $le(r,e){for(;r>0;)e=e[Z0],r--;return e}(r,Vt.lFrame.contextLView))[kr]}(r)}function X5e(r,e){let t=null;const n=function W4e(r){const e=r.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(r);for(let i=0;i<e.length;i++){const o=e[i];if("*"!==o){if(null===n?sz(r,o,!0):Z4e(n,o))return i}else t=i}return t}function Dn(r,e,t,n,i){const o=Ee(),s=M8(o,e,t,n);return s!==Xt&&es(zn(),rr(),o,r,s,o[Zt],i,!1),Dn}function ye(r,e,t,n,i,o,s){const a=Ee(),c=E8(a,e,t,n,i,o);return c!==Xt&&es(zn(),rr(),a,r,c,a[Zt],s,!1),ye}function Oi(r,e,t,n,i,o,s,a,c){const l=Ee(),f=S8(l,e,t,n,i,o,s,a);return f!==Xt&&es(zn(),rr(),l,r,f,l[Zt],c,!1),Oi}function wp(r,e){return r<<17|e<<2}function w4(r){return r>>17&32767}function aE(r){return 2|r}function a6(r){return(131068&r)>>2}function cE(r,e){return-131069&r|e<<2}function lE(r){return 1|r}function VV(r,e,t,n,i){const o=r[t+1],s=null===e;let a=n?w4(o):a6(o),c=!1;for(;0!==a&&(!1===c||s);){const f=r[a+1];rue(r[a],e)&&(c=!0,r[a+1]=n?lE(f):aE(f)),a=n?w4(f):a6(f)}c&&(r[t+1]=n?aE(o):lE(o))}function rue(r,e){return null===r||null==e||(Array.isArray(r)?r[1]:r)===e||!(!Array.isArray(r)||"string"!=typeof e)&&a8(r,e)>=0}const a2={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function FV(r){return r.substring(a2.key,a2.keyEnd)}function iue(r){return r.substring(a2.value,a2.valueEnd)}function BV(r,e){const t=a2.textEnd;let n=a2.key=N8(r,e,t);return t===n?-1:(n=a2.keyEnd=function cue(r,e,t){let n;for(;e<t&&(45===(n=r.charCodeAt(e))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)e++;return e}(r,n,t),n=UV(r,n,t),n=a2.value=N8(r,n,t),n=a2.valueEnd=function lue(r,e,t){let n=-1,i=-1,o=-1,s=e,a=s;for(;s<t;){const c=r.charCodeAt(s++);if(59===c)return a;34===c||39===c?a=s=WV(r,c,s,t):e===s-4&&85===o&&82===i&&76===n&&40===c?a=s=WV(r,41,s,t):c>32&&(a=s),o=i,i=n,n=-33&c}return a}(r,n,t),UV(r,n,t))}function N8(r,e,t){for(;e<t&&r.charCodeAt(e)<=32;)e++;return e}function UV(r,e,t,n){return(e=N8(r,e,t))<t&&e++,e}function WV(r,e,t,n){let i=-1,o=t;for(;o<n;){const s=r.charCodeAt(o++);if(s==e&&92!==i)return o;i=92==s&&92===i?0:s}throw new Error}function Np(r,e){return function da(r,e,t,n){const i=Ee(),o=zn(),s=d3(2);o.firstUpdatePass&&ZV(o,r,s,n),e!==Xt&&Ti(i,s,e)&&KV(o,o.data[Ji()],i,i[Zt],r,i[s+1]=function Cue(r,e){return null==r||""===r||("string"==typeof e?r+=e:"object"==typeof r&&(r=o2(Qo(r)))),r}(e,t),n,s)}(r,e,null,!0),Np}function ei(r){!function ha(r,e,t,n){const i=zn(),o=d3(2);i.firstUpdatePass&&ZV(i,null,o,n);const s=Ee();if(t!==Xt&&Ti(s,o,t)){const a=i.data[Ji()];if(QV(a,n)&&!jV(i,o)){let c=n?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(t=hy(c,t||"")),sE(i,a,s,t,n)}else!function vue(r,e,t,n,i,o,s,a){i===Xt&&(i=qn);let c=0,l=0,f=0<i.length?i[0]:null,d=0<o.length?o[0]:null;for(;null!==f||null!==d;){const m=c<i.length?i[c+1]:void 0,E=l<o.length?o[l+1]:void 0;let L,w=null;f===d?(c+=2,l+=2,m!==E&&(w=d,L=E)):null===d||null!==f&&f<d?(c+=2,w=f):(l+=2,w=d,L=E),null!==w&&KV(r,e,t,n,w,L,s,a),f=c<i.length?i[c]:null,d=l<o.length?o[l]:null}}(i,a,s,s[Zt],s[o+1],s[o+1]=function mue(r,e,t){if(null==t||""===t)return qn;const n=[],i=Qo(t);if(Array.isArray(i))for(let o=0;o<i.length;o++)r(n,i[o],!0);else if("object"==typeof i)for(const o in i)i.hasOwnProperty(o)&&r(n,o,i[o]);else"string"==typeof i&&e(n,i);return n}(r,e,t),n,o)}}(YV,uue,r,!1)}function uue(r,e){for(let t=function sue(r){return function GV(r){a2.key=0,a2.keyEnd=0,a2.value=0,a2.valueEnd=0,a2.textEnd=r.length}(r),BV(r,N8(r,0,a2.textEnd))}(e);t>=0;t=BV(e,t))YV(r,FV(e),iue(e))}function jV(r,e){return e>=r.expandoStartIndex}function ZV(r,e,t,n){const i=r.data;if(null===i[t+1]){const o=i[Ji()],s=jV(r,t);QV(o,n)&&null===e&&!s&&(e=!1),e=function due(r,e,t,n){const i=function Fy(r){const e=Vt.lFrame.currentDirectiveIndex;return-1===e?null:r[e]}(r);let o=n?e.residualClasses:e.residualStyles;if(null===i)0===(n?e.classBindings:e.styleBindings)&&(t=N7(t=uE(null,r,e,t,n),e.attrs,n),o=null);else{const s=e.directiveStylingLast;if(-1===s||r[s]!==i)if(t=uE(i,r,e,t,n),null===o){let c=function hue(r,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==a6(n))return r[w4(n)]}(r,e,n);void 0!==c&&Array.isArray(c)&&(c=uE(null,r,e,c[1],n),c=N7(c,e.attrs,n),function pue(r,e,t,n){r[w4(t?e.classBindings:e.styleBindings)]=n}(r,e,n,c))}else o=function gue(r,e,t){let n;const i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++)n=N7(n,r[o].hostAttrs,t);return N7(n,e.attrs,t)}(r,e,n)}return void 0!==o&&(n?e.residualClasses=o:e.residualStyles=o),t}(i,o,e,n),function tue(r,e,t,n,i,o){let s=o?e.classBindings:e.styleBindings,a=w4(s),c=a6(s);r[n]=t;let f,l=!1;if(Array.isArray(t)?(f=t[1],(null===f||a8(t,f)>0)&&(l=!0)):f=t,i)if(0!==c){const m=w4(r[a+1]);r[n+1]=wp(m,a),0!==m&&(r[m+1]=cE(r[m+1],n)),r[a+1]=function J5e(r,e){return 131071&r|e<<17}(r[a+1],n)}else r[n+1]=wp(a,0),0!==a&&(r[a+1]=cE(r[a+1],n)),a=n;else r[n+1]=wp(c,0),0===a?a=n:r[c+1]=cE(r[c+1],n),c=n;l&&(r[n+1]=aE(r[n+1])),VV(r,f,n,!0),VV(r,f,n,!1),function nue(r,e,t,n,i){const o=i?r.residualClasses:r.residualStyles;null!=o&&"string"==typeof e&&a8(o,e)>=0&&(t[n+1]=lE(t[n+1]))}(e,f,r,n,o),s=wp(a,c),o?e.classBindings=s:e.styleBindings=s}(i,o,e,t,s,n)}}function uE(r,e,t,n,i){let o=null;const s=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<s&&(o=e[a],n=N7(n,o.hostAttrs,i),o!==r);)a++;return null!==r&&(t.directiveStylingLast=a),n}function N7(r,e,t){const n=t?1:2;let i=-1;if(null!==e)for(let o=0;o<e.length;o++){const s=e[o];"number"==typeof s?i=s:i===n&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),Xo(r,s,!!t||e[++o]))}return void 0===r?null:r}function YV(r,e,t){Xo(r,e,Qo(t))}function KV(r,e,t,n,i,o,s,a){if(!(3&e.type))return;const c=r.data,l=c[a+1],f=function eue(r){return 1==(1&r)}(l)?XV(c,e,t,i,a6(l),s):void 0;Ap(f)||(Ap(o)||function Q5e(r){return 2==(2&r)}(l)&&(o=XV(c,null,t,i,a,s)),function s0e(r,e,t,n,i){if(e)i?r.addClass(t,n):r.removeClass(t,n);else{let o=-1===n.indexOf("-")?void 0:b4.DashCase;null==i?r.removeStyle(t,n,o):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=b4.Important),r.setStyle(t,n,i,o))}}(n,s,Nh(Ji(),t),i,o))}function XV(r,e,t,n,i,o){const s=null===e;let a;for(;i>0;){const c=r[i],l=Array.isArray(c),f=l?c[1]:c,d=null===f;let m=t[i+1];m===Xt&&(m=d?qn:void 0);let E=d?Qy(m,n):f===n?m:void 0;if(l&&!Ap(E)&&(E=Qy(c,n)),Ap(E)&&(a=E,s))return a;const w=r[i+1];i=s?w4(w):a6(w)}if(null!==e){let c=o?e.residualClasses:e.residualStyles;null!=c&&(a=Qy(c,n))}return a}function Ap(r){return void 0!==r}function QV(r,e){return 0!=(r.flags&(e?8:16))}function lt(r,e=""){const t=Ee(),n=zn(),i=r+mn,o=n.firstCreatePass?C8(n,i,1,e,null):n.data[i],s=JV(n,t,o,e,r);t[i]=s,Ah()&&Qh(n,t,s,o),sc(o,!1)}let JV=(r,e,t,n,i)=>(O4(!0),Zh(e[Zt],n));function An(r){return P2("",r,""),An}function P2(r,e,t){const n=Ee(),i=M8(n,r,e,t);return i!==Xt&&m3(n,Ji(),i),P2}function fE(r,e,t,n,i){const o=Ee(),s=E8(o,r,e,t,n,i);return s!==Xt&&m3(o,Ji(),s),fE}function dE(r,e,t,n,i,o,s){const a=Ee(),c=S8(a,r,e,t,n,i,o,s);return c!==Xt&&m3(a,Ji(),c),dE}function hE(r,e,t){const n=Ee();return Ti(n,J0(),e)&&es(zn(),rr(),n,r,e,n[Zt],t,!0),hE}const c6=void 0;var $ue=["en",[["a","p"],["AM","PM"],c6],[["AM","PM"],c6,c6],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],c6,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],c6,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",c6,"{1} 'at' {0}",c6],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Fue(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let A8={};function no(r){const e=function Gue(r){return r.toLowerCase().replace(/_/g,"-")}(r);let t=_F(e);if(t)return t;const n=e.split("-")[0];if(t=_F(n),t)return t;if("en"===n)return $ue;throw new ge(701,!1)}function _F(r){return r in A8||(A8[r]=m1.ng&&m1.ng.common&&m1.ng.common.locales&&m1.ng.common.locales[r]),A8[r]}var w1=function(r){return r[r.LocaleId=0]="LocaleId",r[r.DayPeriodsFormat=1]="DayPeriodsFormat",r[r.DayPeriodsStandalone=2]="DayPeriodsStandalone",r[r.DaysFormat=3]="DaysFormat",r[r.DaysStandalone=4]="DaysStandalone",r[r.MonthsFormat=5]="MonthsFormat",r[r.MonthsStandalone=6]="MonthsStandalone",r[r.Eras=7]="Eras",r[r.FirstDayOfWeek=8]="FirstDayOfWeek",r[r.WeekendRange=9]="WeekendRange",r[r.DateFormat=10]="DateFormat",r[r.TimeFormat=11]="TimeFormat",r[r.DateTimeFormat=12]="DateTimeFormat",r[r.NumberSymbols=13]="NumberSymbols",r[r.NumberFormats=14]="NumberFormats",r[r.CurrencyCode=15]="CurrencyCode",r[r.CurrencySymbol=16]="CurrencySymbol",r[r.CurrencyName=17]="CurrencyName",r[r.Currencies=18]="Currencies",r[r.Directionality=19]="Directionality",r[r.PluralCase=20]="PluralCase",r[r.ExtraData=21]="ExtraData",r}(w1||{});const Uue=["zero","one","two","few","many"],I8="en-US",Ip={marker:"element"},kp={marker:"ICU"};var No=function(r){return r[r.SHIFT=2]="SHIFT",r[r.APPEND_EAGERLY=1]="APPEND_EAGERLY",r[r.COMMENT=2]="COMMENT",r}(No||{});let vF=I8;function CF(r){(function Os(r,e){null==r&&Ht(e,r,null,"!=")})(r,"Expected localeId to be defined"),"string"==typeof r&&(vF=r.toLowerCase().replace(/_/g,"-"))}function yF(r,e,t){const n=e.insertBeforeIndex,i=Array.isArray(n)?n[0]:n;return null===i?RD(r,0,t):b1(t[i])}function MF(r,e,t,n,i){const o=e.insertBeforeIndex;if(Array.isArray(o)){let s=n,a=null;if(3&e.type||(a=s,s=i),null!==s&&-1===e.componentOffset)for(let c=1;c<o.length;c++)t6(r,s,t[o[c]],a,!1)}}function EF(r,e){if(r.push(e),r.length>1)for(let t=r.length-2;t>=0;t--){const n=r[t];SF(n)||Zue(n,e)&&null===Yue(n)&&Kue(n,e.index)}}function SF(r){return!(64&r.type)}function Zue(r,e){return SF(e)||r.index>e.index}function Yue(r){const e=r.insertBeforeIndex;return Array.isArray(e)?e[0]:e}function Kue(r,e){const t=r.insertBeforeIndex;Array.isArray(t)?t[0]=e:(DD(yF,MF),r.insertBeforeIndex=e)}function A7(r,e){const t=r.data[e];return null===t||"string"==typeof t?null:t.hasOwnProperty("currentCaseLViewIndex")?t:t.value}function Jue(r,e,t){const n=GM(r,t,64,null,null);return EF(e,n),n}function xp(r,e){const t=e[r.currentCaseLViewIndex];return null===t?t:t<0?~t:t}function PF(r){return r>>>17}function TF(r){return(131070&r)>>>1}let I7=0,k7=0;function bF(r,e,t,n){const i=t[Zt];let s,o=null;for(let a=0;a<e.length;a++){const c=e[a];if("string"==typeof c){const l=e[++a];null===t[l]&&(t[l]=Zh(i,c))}else if("number"==typeof c)switch(1&c){case 0:const l=PF(c);let f,d;if(null===o&&(o=l,s=Xh(i,n)),l===o?(f=n,d=s):(f=null,d=b1(t[l])),null!==d){const L=TF(c);t6(i,d,t[L],f,!1);const $=A7(r,L);if(null!==$&&"object"==typeof $){const B=xp($,t);null!==B&&bF(r,$.create[B],t,t[$.anchorIdx])}}break;case 1:const E=e[++a],w=e[++a];KM(i,Nh(c>>>1,t),null,null,E,w,null)}else switch(c){case kp:const l=e[++a],f=e[++a];null===t[f]&&Si(t[f]=cM(i,l),t);break;case Ip:const d=e[++a],m=e[++a];null===t[m]&&Si(t[m]=Yh(i,d,null),t)}}}function wF(r,e,t,n,i){for(let o=0;o<t.length;o++){const s=t[o],a=t[++o];if(s&i){let c="";for(let l=o+1;l<=o+a;l++){const f=t[l];if("string"==typeof f)c+=f;else if("number"==typeof f)if(f<0)c+=jt(e[n-f]);else{const d=f>>>2;switch(3&f){case 1:const m=t[++l],E=t[++l],w=r.data[d];"string"==typeof w?KM(e[Zt],e[d],null,w,m,c,E):es(r,w,e,m,c,e[Zt],E,!1);break;case 0:const L=e[d];null!==L&&ND(e[Zt],L,c);break;case 2:i7e(r,A7(r,d),e,c);break;case 3:NF(r,A7(r,d),n,e)}}}}else{const c=t[o+1];if(c>0&&3==(3&c)){const f=A7(r,c>>>2);e[f.currentCaseLViewIndex]<0&&NF(r,f,n,e)}}o+=a}}function NF(r,e,t,n){let i=n[e.currentCaseLViewIndex];if(null!==i){let o=I7;i<0&&(i=n[e.currentCaseLViewIndex]=~i,o=-1),wF(r,n,e.update[i],t,o)}}function i7e(r,e,t,n){const i=function o7e(r,e){let t=r.cases.indexOf(e);if(-1===t)switch(r.type){case 1:{const n=function Wue(r,e){const t=function mF(r){return no(r)[w1.PluralCase]}(e)(parseInt(r,10)),n=Uue[t];return void 0!==n?n:"other"}(e,function jue(){return vF}());t=r.cases.indexOf(n),-1===t&&"other"!==n&&(t=r.cases.indexOf("other"));break}case 0:t=r.cases.indexOf("other")}return-1===t?null:t}(e,n);if(xp(e,t)!==i&&(AF(r,e,t),t[e.currentCaseLViewIndex]=null===i?null:~i,null!==i)){const s=t[e.anchorIdx];s&&bF(r,e.create[i],t,s)}}function AF(r,e,t){let n=xp(e,t);if(null!==n){const i=e.remove[n];for(let o=0;o<i.length;o++){const s=i[o];if(s>0){const a=Nh(s,t);null!==a&&Jh(t[Zt],a)}else AF(r,A7(r,~s),t)}}}function s7e(){const r=[];let t,n,e=-1;function o(a,c){e=0;const l=xp(a,c);n=null!==l?a.remove[l]:qn}function s(){if(e<n.length){const a=n[e++];return a>0?t[a]:(r.push(e,n),o(t[et].data[~a],t),s())}return 0===r.length?null:(n=r.pop(),e=r.pop(),s())}return function i(a,c){for(t=c;r.length;)r.pop();return o(a.value,c),s}}const Lp=/\ufffd(\d+):?\d*\ufffd/gi,c7e=/\ufffd(\d+)\ufffd/,kF=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,x7="\ufffd",l7e=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,u7e=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,f7e=/\uE500/g;function xF(r,e,t,n,i,o,s){const a=y7(r,n,1,null);let c=a<<No.SHIFT,l=Ju();e===l&&(l=null),null===l&&(c|=No.APPEND_EAGERLY),s&&(c|=No.COMMENT,function W6e(r){void 0===sM&&(sM=r())}(s7e)),i.push(c,null===o?"":o);const f=GM(r,a,s?32:1,null===o?"":o,null);EF(t,f);const d=f.index;return sc(f,!1),null!==l&&e!==l&&function Que(r,e){let t=r.insertBeforeIndex;null===t?(DD(yF,MF),t=r.insertBeforeIndex=[null,e]):(function Kl(r,e,t){r!=e&&Ht(t,r,e,"==")}(Array.isArray(t),!0,"Expecting array here"),t.push(e))}(l,d),f}function p7e(r,e,t,n,i,o,s){const a=s.match(Lp),c=xF(r,e,t,o,n,a?null:s,!1);a&&L7(i,s,c.index,null,0,null)}function L7(r,e,t,n,i,o){const s=r.length,a=s+1;r.push(null,null);const c=s+2,l=e.split(Lp);let f=0;for(let d=0;d<l.length;d++){const m=l[d];if(1&d){const E=i+parseInt(m,10);r.push(-1-E),f|=LF(E)}else""!==m&&r.push(m)}return r.push(t<<2|(n?1:0)),n&&r.push(n,o),r[s]=f,r[a]=r.length-c,f}function LF(r){return 1<<Math.min(r,31)}function RF(r){let e,o,t="",n=0,i=!1;for(;null!==(e=l7e.exec(r));)i?e[0]===`${x7}/*${o}${x7}`&&(n=e.index,i=!1):(t+=r.substring(n,e.index+e[0].length),o=e[1],i=!0);return t+=r.slice(n),t}function zF(r,e,t,n,i,o){let s=0;const a={type:i.type,currentCaseLViewIndex:y7(r,e,1,null),anchorIdx:o,cases:[],create:[],remove:[],update:[]};(function E7e(r,e,t){r.push(LF(e.mainBinding),2,-1-e.mainBinding,t<<2|2)})(t,i,o),function Xue(r,e,t){const n=r.data[e];null===n?r.data[e]=t:n.value=t}(r,o,a);const c=i.values;for(let l=0;l<c.length;l++){const f=c[l],d=[];for(let m=0;m<f.length;m++){const E=f[m];if("string"!=typeof E){const w=d.push(E)-1;f[m]=`\x3c!--\ufffd${w}\ufffd--\x3e`}}s=y7e(r,a,e,t,n,i.cases[l],f.join(""),d)|s}s&&function S7e(r,e,t){r.push(e,1,t<<2|3)}(t,s,o)}function C7e(r){const e=[],t=[];let n=1,i=0;const o=pE(r=r.replace(kF,function(s,a,c){return n="select"===c?0:1,i=parseInt(a.slice(1),10),""}));for(let s=0;s<o.length;){let a=o[s++].trim();1===n&&(a=a.replace(/\s*(?:=)?(\w+)\s*/,"$1")),a.length&&e.push(a);const c=pE(o[s++]);e.length>t.length&&t.push(c)}return{type:n,mainBinding:i,cases:e,values:t}}function pE(r){if(!r)return[];let e=0;const t=[],n=[],i=/[{}]/g;let o;for(i.lastIndex=0;o=i.exec(r);){const a=o.index;if("}"==o[0]){if(t.pop(),0==t.length){const c=r.substring(e,a);kF.test(c)?n.push(C7e(c)):n.push(c),e=a+1}}else{if(0==t.length){const c=r.substring(e,a);n.push(c),e=a+1}t.push("{")}}const s=r.substring(e);return n.push(s),n}function y7e(r,e,t,n,i,o,s,a){const c=[],l=[],f=[];e.cases.push(o),e.create.push(c),e.remove.push(l),e.update.push(f);const m=qD(d8()).getInertBodyElement(s),E=yM(m)||m;return E?DF(r,e,t,n,c,l,f,E,i,a,0):0}function DF(r,e,t,n,i,o,s,a,c,l,f){let d=0,m=a.firstChild;for(;m;){const E=y7(r,t,1,null);switch(m.nodeType){case Node.ELEMENT_NODE:const w=m,L=w.tagName.toLowerCase();if(vM.hasOwnProperty(L)){gE(i,Ip,L,c,E),r.data[E]=L;const de=w.attributes;for(let _e=0;_e<de.length;_e++){const xe=de.item(_e),nt=xe.name.toLowerCase();xe.value.match(Lp)?KD.hasOwnProperty(nt)&&L7(s,xe.value,E,xe.name,0,CM[nt]?np:null):P7e(i,E,xe)}d=DF(r,e,t,n,i,o,s,m,E,l,f+1)|d,HF(o,E,f)}break;case Node.TEXT_NODE:const z=m.textContent||"",$=z.match(Lp);gE(i,null,$?"":z,c,E),HF(o,E,f),$&&(d=L7(s,z,E,null,0,null)|d);break;case Node.COMMENT_NODE:const B=c7e.exec(m.textContent||"");if(B){const _e=l[parseInt(B[1],10)];gE(i,kp,"",c,E),zF(r,t,n,c,_e,E),M7e(o,E,f)}}m=m.nextSibling}return d}function HF(r,e,t){0===t&&r.push(e)}function M7e(r,e,t){0===t&&(r.push(~e),r.push(e))}function gE(r,e,t,n,i){null!==e&&r.push(e),r.push(t,i,function e7e(r,e,t){return r|e<<17|t<<1}(0,n,i))}function P7e(r,e,t){r.push(e<<1|1,t.name,t.value)}function Ao(r,e,t=-1){const n=zn(),i=Ee(),o=mn+r,s=T4(n.consts,e),a=Ju();n.firstCreatePass&&function h7e(r,e,t,n,i,o){const s=Ju(),a=[],c=[],l=[[]];i=function v7e(r,e){if(function _7e(r){return-1===r}(e))return RF(r);{const t=r.indexOf(`:${e}${x7}`)+2+e.toString().length,n=r.search(new RegExp(`${x7}\\/\\*\\d+:${e}${x7}`));return RF(r.substring(t,n))}}(i,o);const f=function d7e(r){return r.replace(f7e," ")}(i).split(u7e);for(let d=0;d<f.length;d++){let m=f[d];if(1&d){const E=47===m.charCodeAt(0),L=(m.charCodeAt(E?1:0),mn+Number.parseInt(m.substring(E?2:1)));if(E)l.shift(),sc(Ju(),!1);else{const z=Jue(r,l[0],L);l.unshift([]),sc(z,!0)}}else{const E=pE(m);for(let w=0;w<E.length;w++){let L=E[w];if(1&w){const z=L;if("object"!=typeof z)throw new Error(`Unable to parse ICU expression in "${i}" message.`);zF(r,t,c,e,z,xF(r,s,l[0],t,a,"",!0).index)}else""!==L&&p7e(r,s,l[0],a,c,t,L)}}}r.data[n]={create:a,update:c}}(n,null===a?0:a.index,i,o,s,t),2===n.type?i[xr][Kt]|=32:i[Kt]|=32;const c=n.data[o],f=ID(n,a===i[Ei]?null:a,i);(function r7e(r,e,t,n){const i=r[Zt];for(let o=0;o<e.length;o++){const s=e[o++],a=e[o],l=(s&No.APPEND_EAGERLY)===No.APPEND_EAGERLY,f=s>>>No.SHIFT;let d=r[f];null===d&&(d=r[f]=(s&No.COMMENT)===No.COMMENT?i.createComment(a):Zh(i,a)),l&&null!==t&&t6(i,t,d,n,!1)}})(i,c.create,f,a&&8&a.type?i[a.index]:null),Dz(!0)}function Io(){Dz(!1)}function se(r,e,t){Ao(r,e,t),Io()}function Bn(r){return function t7e(r){r&&(I7|=1<<Math.min(k7,31)),k7++}(Ti(Ee(),J0(),r)),Bn}function jn(r){!function n7e(r,e,t){if(k7>0){const n=r.data[t];wF(r,e,Array.isArray(n)?n:n.update,f3()-k7-1,I7)}I7=0,k7=0}(zn(),Ee(),r+mn)}function mE(r,e,t,n,i){if(r=$t(r),Array.isArray(r))for(let o=0;o<r.length;o++)mE(r[o],e,t,n,i);else{const o=zn(),s=Ee(),a=Q2();let c=r6(r)?r:$t(r.provide);const l=aH(r),f=1048575&a.providerIndexes,d=a.directiveStart,m=a.providerIndexes>>20;if(r6(r)||!r.multi){const E=new e7(l,i,G),w=vE(c,e,i?f:f+m,d);-1===w?(Yy(Rh(a,s),o,c),_E(o,r,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(E),s.push(E)):(t[w]=E,s[w]=E)}else{const E=vE(c,e,f+m,d),w=vE(c,e,f,f+m),z=w>=0&&t[w];if(i&&!z||!i&&!(E>=0&&t[E])){Yy(Rh(a,s),o,c);const $=function V7e(r,e,t,n,i){const o=new e7(r,t,G);return o.multi=[],o.index=e,o.componentProviders=0,FF(o,i,n&&!t),o}(i?H7e:D7e,t.length,i,n,l);!i&&z&&(t[w].providerFactory=$),_E(o,r,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push($),s.push($)}else _E(o,r,E>-1?E:w,FF(t[i?w:E],l,!i&&n));!i&&n&&z&&t[w].componentProviders++}}}function _E(r,e,t,n){const i=r6(e),o=function V0e(r){return!!r.useClass}(e);if(i||o){const c=(o?$t(e.useClass):e).prototype.ngOnDestroy;if(c){const l=r.destroyHooks||(r.destroyHooks=[]);if(!i&&e.multi){const f=l.indexOf(t);-1===f?l.push(t,[n,c]):l[f+1].push(n,c)}else l.push(t,c)}}}function FF(r,e,t){return t&&r.componentProviders++,r.multi.push(e)-1}function vE(r,e,t,n){for(let i=t;i<n;i++)if(e[i]===r)return i;return-1}function D7e(r,e,t,n){return CE(this.multi,[])}function H7e(r,e,t,n){const i=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=e6(t,t[et],this.providerFactory.index,n);o=a.slice(0,s),CE(i,o);for(let c=s;c<a.length;c++)o.push(a[c])}else o=[],CE(i,o);return o}function CE(r,e){for(let t=0;t<r.length;t++)e.push((0,r[t])());return e}function Y1(r,e=[]){return t=>{t.providersResolver=(n,i)=>function z7e(r,e,t){const n=zn();if(n.firstCreatePass){const i=fa(r);mE(t,n.data,n.blueprint,i,!0),mE(e,n.data,n.blueprint,i,!1)}}(n,i?i(r):r,e)}}class l6{}class $F{}class yE extends l6{constructor(e,t,n){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new nV(this);const i=Yo(e);this._bootstrapComponents=g3(i.bootstrap),this._r3Injector=EH(e,t,[{provide:l6,useValue:this},{provide:gp,useValue:this.componentFactoryResolver},...n],o2(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class ME extends $F{constructor(e){super(),this.moduleType=e}create(e){return new yE(this.moduleType,e,[])}}class BF extends l6{constructor(e){super(),this.componentFactoryResolver=new nV(this),this.instance=null;const t=new cp([...e.providers,{provide:l6,useValue:this},{provide:gp,useValue:this.componentFactoryResolver}],e.parent||ap(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function EE(r,e,t=null){return new BF({providers:r,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let B7e=(()=>{var r;class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const i=rH(0,n.type),o=i.length>0?EE([i],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,o)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}}return(r=e).\u0275prov=He({token:r,providedIn:"environment",factory:()=>new r(Pe(Jo))}),e})();function GF(r){r.getStandaloneInjector=e=>e.get(B7e).getOrCreateStandaloneInjector(r)}function _1(r,e,t){const n=Qi()+r,i=Ee();return i[n]===Xt?fc(i,n,t?e.call(t):e()):function P7(r,e){return r[e]}(i,n)}function pa(r,e,t,n){return KF(Ee(),Qi(),r,e,t,n)}function R7(r,e){const t=r[e];return t===Xt?void 0:t}function KF(r,e,t,n,i,o){const s=e+t;return Ti(r,s,i)?fc(r,s+1,o?n.call(o,i):n(i)):R7(r,s+1)}function ga(r,e){const t=zn();let n;const i=r+mn;t.firstCreatePass?(n=function ofe(r,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(r===n.name)return n}}(e,t.pipeRegistry),t.data[i]=n,n.onDestroy&&(t.destroyHooks??=[]).push(i,n.onDestroy)):n=t.data[i];const o=n.factory||(n.factory=Ql(n.type)),a=Po(G);try{const c=Lh(!1),l=o();return Lh(c),function G5e(r,e,t,n){t>=r.data.length&&(r.data[t]=null,r.blueprint[t]=null),e[t]=n}(t,Ee(),i,l),l}finally{Po(a)}}function hc(r,e,t){const n=r+mn,i=Ee(),o=X0(i,n);return z7(i,n)?KF(i,Qi(),e,o.transform,t,o):o.transform(t)}function t$(r,e,t,n){const i=r+mn,o=Ee(),s=X0(o,i);return z7(o,i)?function XF(r,e,t,n,i,o,s){const a=e+t;return o6(r,a,i,o)?fc(r,a+2,s?n.call(s,i,o):n(i,o)):R7(r,a+2)}(o,Qi(),e,s.transform,t,n,s):s.transform(t,n)}function z7(r,e){return r[et].data[e].pure}function PE(r){return e=>{setTimeout(r,void 0,e)}}const N1=class lfe extends So{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let i=e,o=t||(()=>null),s=n;if(e&&"object"==typeof e){const c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=PE(o),i&&(i=PE(i)),s&&(s=PE(s)));const a=super.subscribe({next:i,error:o,complete:s});return e instanceof Sn&&e.add(a),a}};function ufe(){return this._results[Symbol.iterator]()}class TE{get changes(){return this._changes||(this._changes=new N1)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=TE.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=ufe)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const i=function ws(r){return r.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function l6e(r,e,t){if(r.length!==e.length)return!1;for(let n=0;n<r.length;n++){let i=r[n],o=e[n];if(t&&(i=t(i),o=t(o)),o!==i)return!1}return!0}(n._results,i,t))&&(n._results=i,n.length=i.length,n.last=i[this.length-1],n.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function dfe(r,e,t,n=!0){const i=e[et];if(function Q6e(r,e,t,n){const i=X2+n,o=t.length;n>0&&(t[i-1][ua]=e),n<o-X2?(e[ua]=t[i],oD(t,X2+n,e)):(t.push(e),e[ua]=null),e[Z1]=t;const s=e[Ku];null!==s&&t!==s&&function J6e(r,e){const t=r[K0];e[xr]!==e[Z1][Z1][xr]&&(r[hz]=!0),null===t?r[K0]=[e]:t.push(e)}(s,e);const a=e[nc];null!==a&&a.insertView(r),e[Kt]|=128}(i,e,r,t),n){const o=hM(t,r),s=e[Zt],a=Xh(s,r[rc]);null!==a&&function Y6e(r,e,t,n,i,o){n[Ir]=i,n[Ei]=e,u7(r,n,t,1,i,o)}(i,r[Ei],s,e,a,o)}}let _3=(()=>{class e{}return e.__NG_ELEMENT_ID__=gfe,e})();const hfe=_3,pfe=class extends hfe{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){const i=function ffe(r,e,t,n){const i=e.tView,a=vp(r,i,t,4096&r[Kt]?4096:16,null,e,null,null,null,n?.injector??null,n?.hydrationInfo??null);a[Ku]=r[e.index];const l=r[nc];return null!==l&&(a[nc]=l.createEmbeddedView(i)),JM(i,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:n});return new E7(i)}};function gfe(){return Rp(Q2(),Ee())}function Rp(r,e){return 4&r.type?new pfe(e,r,g8(r,e)):null}let ts=(()=>{class e{}return e.__NG_ELEMENT_ID__=Mfe,e})();function Mfe(){return c$(Q2(),Ee())}const Efe=ts,s$=class extends Efe{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return g8(this._hostTNode,this._hostLView)}get injector(){return new eo(this._hostTNode,this._hostLView)}get parentInjector(){const e=zh(this._hostTNode,this._hostLView);if(qy(e)){const t=n7(e,this._hostLView),n=t7(e);return new eo(t[et].data[n+8],t)}return new eo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=a$(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-X2}createEmbeddedView(e,t,n){let i,o;"number"==typeof n?i=n:null!=n&&(i=n.index,o=n.injector);const a=e.createEmbeddedViewImpl(t||{},o,null);return this.insertImpl(a,i,false),a}createComponent(e,t,n,i,o){const s=e&&!function i7(r){return"function"==typeof r}(e);let a;if(s)a=t;else{const L=t||{};a=L.index,n=L.injector,i=L.projectableNodes,o=L.environmentInjector||L.ngModuleRef}const c=s?e:new S7(Rn(e)),l=n||this.parentInjector;if(!o&&null==c.ngModule){const z=(s?l:this.parentInjector).get(Jo,null);z&&(o=z)}Rn(c.componentType??{});const E=c.create(l,i,null,o);return this.insertImpl(E.hostView,a,false),E}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,n){const i=e._lView;if(function Ple(r){return Oo(r[Z1])}(i)){const c=this.indexOf(e);if(-1!==c)this.detach(c);else{const l=i[Z1],f=new s$(l,l[Ei],l[Z1]);f.detach(f.indexOf(e))}}const s=this._adjustIndex(t),a=this._lContainer;return dfe(a,i,s,!n),e.attachToViewContainerRef(),oD(OE(a),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=a$(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=Kh(this._lContainer,t);n&&(Vh(OE(this._lContainer),t),lM(n[et],n))}detach(e){const t=this._adjustIndex(e,-1),n=Kh(this._lContainer,t);return n&&null!=Vh(OE(this._lContainer),t)?new E7(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function a$(r){return r[8]}function OE(r){return r[8]||(r[8]=[])}function c$(r,e){let t;const n=e[r.index];return Oo(n)?t=n:(t=WH(n,e,null,r),e[r.index]=t,Cp(e,t)),l$(t,e,r,n),new s$(t,r,e)}let l$=function u$(r,e,t,n){if(r[rc])return;let i;i=8&t.type?b1(n):function Sfe(r,e){const t=r[Zt],n=t.createComment(""),i=bo(e,r);return t6(t,Xh(t,i),n,function r0e(r,e){return r.nextSibling(e)}(t,i),!1),n}(e,t),r[rc]=i};class bE{constructor(e){this.queryList=e,this.matches=null}clone(){return new bE(this.queryList)}setDirty(){this.queryList.setDirty()}}class wE{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let o=0;o<n;o++){const s=t.getByIndex(o);i.push(this.queries[s.indexInDeclarationView].clone())}return new wE(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==m$(e,t).matches&&this.queries[t].setDirty()}}class f${constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class NE{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const i=null!==t?t.length:0,o=this.getByIndex(n).embeddedTView(e,i);o&&(o.indexInDeclarationView=n,null!==t?t.push(o):t=[o])}return null!==t?new NE(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class AE{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new AE(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const o=n[i];this.matchTNodeWithReadOption(e,t,Ofe(t,o)),this.matchTNodeWithReadOption(e,t,Dh(t,e,o,!1,!1))}else n===_3?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Dh(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===Pi||i===ts||i===_3&&4&t.type)this.addMatch(t.index,-2);else{const o=Dh(t,e,i,!1,!1);null!==o&&this.addMatch(t.index,o)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Ofe(r,e){const t=r.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function wfe(r,e,t,n){return-1===t?function bfe(r,e){return 11&r.type?g8(r,e):4&r.type?Rp(r,e):null}(e,r):-2===t?function Nfe(r,e,t){return t===Pi?g8(e,r):t===_3?Rp(e,r):t===ts?c$(e,r):void 0}(r,e,n):e6(r,r[et],t,e)}function d$(r,e,t,n){const i=e[nc].queries[n];if(null===i.matches){const o=r.data,s=t.matches,a=[];for(let c=0;c<s.length;c+=2){const l=s[c];a.push(l<0?null:wfe(e,o[l],s[c+1],t.metadata.read))}i.matches=a}return i.matches}function IE(r,e,t,n){const i=r.queries.getByIndex(t),o=i.matches;if(null!==o){const s=d$(r,e,i,t);for(let a=0;a<o.length;a+=2){const c=o[a];if(c>0)n.push(s[a/2]);else{const l=o[a+1],f=e[-c];for(let d=X2;d<f.length;d++){const m=f[d];m[Ku]===m[Z1]&&IE(m[et],m,l,n)}if(null!==f[K0]){const d=f[K0];for(let m=0;m<d.length;m++){const E=d[m];IE(E[et],E,l,n)}}}}}return n}function v3(r){const e=Ee(),t=zn(),n=Hz();$y(n+1);const i=m$(t,n);if(r.dirty&&function Ele(r){return 4==(4&r[Kt])}(e)===(2==(2&i.metadata.flags))){if(null===i.matches)r.reset([]);else{const o=i.crossesNgTemplate?IE(t,e,n,[]):d$(t,e,i,n);r.reset(o,s8e),r.notifyOnChanges()}return!0}return!1}function N4(r,e,t){const n=zn();n.firstCreatePass&&(function g$(r,e,t){null===r.queries&&(r.queries=new NE),r.queries.track(new AE(e,t))}(n,new f$(r,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),function p$(r,e,t){const n=new TE(4==(4&t));(function A8e(r,e,t,n){const i=jH(e);i.push(t),r.firstCreatePass&&ZH(r).push(n,i.length-1)})(r,e,n,n.destroy),null===e[nc]&&(e[nc]=new wE),e[nc].queries.push(new bE(n))}(n,Ee(),e)}function C3(){return function Afe(r,e){return r[nc].queries[e].queryList}(Ee(),Hz())}function m$(r,e){return r.queries.getByIndex(e)}function dn(r,e){return Rp(r,e)}const DE=new tt("Application Initializer");let HE=(()=>{var r;class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,i)=>{this.resolve=n,this.reject=i}),this.appInits=rt(DE,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const o of this.appInits){const s=o();if(w7(s))n.push(s);else if(TV(s)){const a=new Promise((c,l)=>{s.subscribe({complete:c,error:l})});n.push(a)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{i()}).catch(o=>{this.reject(o)}),0===n.length&&i(),this.initialized=!0}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),x$=(()=>{var r;class e{log(n){console.log(n)}warn(n){console.warn(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();const pc=new tt("LocaleId",{providedIn:"root",factory:()=>rt(pc,cn.Optional|cn.SkipSelf)||function Qfe(){return typeof $localize<"u"&&$localize.locale||I8}()});let Hp=(()=>{var r;class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Yi(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class t9e{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let L$=(()=>{var r;class e{compileModuleSync(n){return new ME(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),s=g3(Yo(n).declarations).reduce((a,c)=>{const l=Rn(c);return l&&a.push(new S7(l)),a},[]);return new t9e(i,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function H$(...r){}class o1{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new N1(!1),this.onMicrotaskEmpty=new N1(!1),this.onStable=new N1(!1),this.onError=new N1(!1),typeof Zone>"u")throw new ge(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&t,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function M9e(){const r="function"==typeof m1.requestAnimationFrame;let e=m1[r?"requestAnimationFrame":"setTimeout"],t=m1[r?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function P9e(r){const e=()=>{!function S9e(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(m1,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,BE(r),r.isCheckStableRunning=!0,$E(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),BE(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,i,o,s,a)=>{try{return V$(r),t.invokeTask(i,o,s,a)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||r.shouldCoalesceRunChangeDetection)&&e(),F$(r)}},onInvoke:(t,n,i,o,s,a,c)=>{try{return V$(r),t.invoke(i,o,s,a,c)}finally{r.shouldCoalesceRunChangeDetection&&e(),F$(r)}},onHasTask:(t,n,i,o)=>{t.hasTask(i,o),n===i&&("microTask"==o.change?(r._hasPendingMicrotasks=o.microTask,BE(r),$E(r)):"macroTask"==o.change&&(r.hasPendingMacrotasks=o.macroTask))},onHandleError:(t,n,i,o)=>(t.handleError(i,o),r.runOutsideAngular(()=>r.onError.emit(o)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!o1.isInAngularZone())throw new ge(909,!1)}static assertNotInAngularZone(){if(o1.isInAngularZone())throw new ge(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,i){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,E9e,H$,H$);try{return o.runTask(s,t,n)}finally{o.cancelTask(s)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const E9e={};function $E(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function BE(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function V$(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function F$(r){r._nesting--,$E(r)}class T9e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new N1,this.onMicrotaskEmpty=new N1,this.onStable=new N1,this.onError=new N1}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,i){return e.apply(t,n)}}const $$=new tt("",{providedIn:"root",factory:B$});function B$(){const r=rt(o1);let e=!0;return function y4e(...r){const e=Gu(r),t=function h4e(r,e){return"number"==typeof fy(r)?r.pop():e}(r,1/0),n=r;return n.length?1===n.length?jo(n[0]):G0(t)(r2(n,e)):ec}(new T1(i=>{e=r.isStable&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks,r.runOutsideAngular(()=>{i.next(e),i.complete()})}),new T1(i=>{let o;r.runOutsideAngular(()=>{o=r.onStable.subscribe(()=>{o1.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const s=r.onUnstable.subscribe(()=>{o1.assertInAngularZone(),e&&(e=!1,r.runOutsideAngular(()=>{i.next(!1)}))});return()=>{o.unsubscribe(),s.unsubscribe()}}).pipe(GR()))}const G$=new tt(""),Fp=new tt("");let WE,GE=(()=>{var r;class e{constructor(n,i,o){this._ngZone=n,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,WE||(function O9e(r){WE=r}(o),o.addToWindow(i)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{o1.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,o){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==s),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:o})}whenStable(n,i,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,i,o){return[]}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(o1),Pe(UE),Pe(Fp))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})(),UE=(()=>{var r;class e{constructor(){this._applications=new Map}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return WE?.findTestabilityInTree(this,n,i)??null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})(),A4=null;const U$=new tt("AllowMultipleToken"),qE=new tt("PlatformDestroyListeners"),jE=new tt("appBootstrapListener");class q${constructor(e,t){this.name=e,this.token=t}}function Z$(r,e,t=[]){const n=`Platform: ${e}`,i=new tt(n);return(o=[])=>{let s=ZE();if(!s||s.injector.get(U$,!1)){const a=[...t,...o,{provide:i,useValue:!0}];r?r(a):function N9e(r){if(A4&&!A4.get(U$,!1))throw new ge(400,!1);(function W$(){!function dle(r){Cz=r}(()=>{throw new ge(600,!1)})})(),A4=r;const e=r.get(K$);(function j$(r){r.get(cH,null)?.forEach(t=>t())})(r)}(function Y$(r=[],e){return J2.create({name:e,providers:[{provide:TM,useValue:"platform"},{provide:qE,useValue:new Set([()=>A4=null])},...r]})}(a,n))}return function I9e(r){const e=ZE();if(!e)throw new ge(401,!1);return e}()}}function ZE(){return A4?.get(K$)??null}let K$=(()=>{var r;class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const o=function k9e(r="zone.js",e){return"noop"===r?new T9e:"zone.js"===r?new o1(e):r}(i?.ngZone,function X$(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:r?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:r?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return o.run(()=>{const s=function $7e(r,e,t){return new yE(r,e,t)}(n.moduleType,this.injector,function nB(r){return[{provide:o1,useFactory:r},{provide:p7,multi:!0,useFactory:()=>{const e=rt(L9e,{optional:!0});return()=>e.initialize()}},{provide:tB,useFactory:x9e},{provide:$$,useFactory:B$}]}(()=>o)),a=s.injector.get(i6,null);return o.runOutsideAngular(()=>{const c=o.onError.subscribe({next:l=>{a.handleError(l)}});s.onDestroy(()=>{$p(this._modules,s),c.unsubscribe()})}),function Q$(r,e,t){try{const n=t();return w7(n)?n.catch(i=>{throw e.runOutsideAngular(()=>r.handleError(i)),i}):n}catch(n){throw e.runOutsideAngular(()=>r.handleError(n)),n}}(a,o,()=>{const c=s.injector.get(HE);return c.runInitializers(),c.donePromise.then(()=>(CF(s.injector.get(pc,I8)||I8),this._moduleDoBootstrap(s),s))})})}bootstrapModule(n,i=[]){const o=J$({},i);return function b9e(r,e,t){const n=new ME(t);return Promise.resolve(n)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,o))}_moduleDoBootstrap(n){const i=n.injector.get(u6);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(o=>i.bootstrap(o));else{if(!n.instance.ngDoBootstrap)throw new ge(-403,!1);n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ge(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const n=this._injector.get(qE,null);n&&(n.forEach(i=>i()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(J2))},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();function J$(r,e){return Array.isArray(e)?e.reduce(J$,r):{...r,...e}}let u6=(()=>{var r;class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=rt(tB),this.zoneIsStable=rt($$),this.componentTypes=[],this.components=[],this.isStable=rt(Hp).hasPendingTasks.pipe(ca(n=>n?Dt(!1):this.zoneIsStable),function M4e(r,e=Ja){return r=r??E4e,jr((t,n)=>{let i,o=!0;t.subscribe(pr(n,s=>{const a=e(s);(o||!r(i,a))&&(o=!1,i=a,n.next(s))}))})}(),GR()),this._injector=rt(Jo)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,i){const o=n instanceof gH;if(!this._injector.get(HE).done)throw!o&&function W0(r){const e=Rn(r)||K2(r)||Ki(r);return null!==e&&e.standalone}(n),new ge(405,!1);let a;a=o?n:this._injector.get(gp).resolveComponentFactory(n),this.componentTypes.push(a.componentType);const c=function w9e(r){return r.isBoundToModule}(a)?void 0:this._injector.get(l6),f=a.create(J2.NULL,[],i||a.selector,c),d=f.location.nativeElement,m=f.injector.get(G$,null);return m?.registerApplication(d),f.onDestroy(()=>{this.detachView(f.hostView),$p(this.components,f),m?.unregisterApplication(d)}),this._loadComponent(f),f}tick(){if(this._runningTick)throw new ge(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;$p(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const i=this._injector.get(jE,[]);i.push(...this._bootstrapListeners),i.forEach(o=>o(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>$p(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new ge(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function $p(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}const tB=new tt("",{providedIn:"root",factory:()=>rt(i6).handleError.bind(void 0)});function x9e(){const r=rt(o1),e=rt(i6);return t=>r.runOutsideAngular(()=>e.handleError(t))}let L9e=(()=>{var r;class e{constructor(){this.zone=rt(o1),this.applicationRef=rt(u6)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();let y3=(()=>{class e{}return e.__NG_ELEMENT_ID__=z9e,e})();function z9e(r){return function D9e(r,e,t){if(Xl(r)&&!t){const n=Ko(r.index,e);return new E7(n,n)}return 47&r.type?new E7(e[xr],e):null}(Q2(),Ee(),16==(16&r))}class sB{constructor(){}supports(e){return Sp(e)}create(e){return new G9e(e)}}const B9e=(r,e)=>e;class G9e{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||B9e}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,i=0,o=null;for(;t||n;){const s=!n||t&&t.currentIndex<cB(n,i,o)?t:n,a=cB(s,i,o),c=s.currentIndex;if(s===n)i--,n=n._nextRemoved;else if(t=t._next,null==s.previousIndex)i++;else{o||(o=[]);const l=a-i,f=c-i;if(l!=f){for(let m=0;m<l;m++){const E=m<o.length?o[m]:o[m]=0,w=E+m;f<=w&&w<l&&(o[m]=E+1)}o[s.previousIndex]=f-l}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Sp(e))throw new ge(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,o,s,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),null!==t&&Object.is(t.trackById,s)?(n&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)):(t=this._mismatch(t,o,s,a),n=!0),t=t._next}else i=0,function E5e(r,e){if(Array.isArray(r))for(let t=0;t<r.length;t++)e(r[t]);else{const t=r[Symbol.iterator]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{s=this._trackByFn(i,a),null!==t&&Object.is(t.trackById,s)?(n&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,s,i),n=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,i){let o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new U9e(t,n),o,i),e}_verifyReinsertion(e,t,n,i){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==o?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,o=e._nextRemoved;return null===i?this._removalsHead=o:i._nextRemoved=o,null===o?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new aB),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new aB),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class U9e{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class W9e{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class aB{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new W9e,this.map.set(t,n)),n.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function cB(r,e,t){const n=r.previousIndex;if(null===n)return n;let i=0;return t&&n<t.length&&(i=t[n]),n+e+i}class lB{constructor(){}supports(e){return e instanceof Map||eE(e)}create(){return new q9e}}class q9e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||eE(e)))throw new ge(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{const o=this._getOrCreateRecordForKey(i,n);t=this._insertBeforeOrAppend(t,o)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const o=i._prev,s=i._next;return o&&(o._next=s),s&&(s._prev=o),i._next=null,i._prev=null,i}const n=new j9e(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class j9e{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function uB(){return new Up([new sB])}let Up=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(null!=i){const o=i.factories.slice();n=n.concat(o)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||uB()),deps:[[e,new $h,new to]]}}find(n){const i=this.factories.find(o=>o.supports(n));if(null!=i)return i;throw new ge(901,!1)}}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:uB}),e})();function fB(){return new V7([new lB])}let V7=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(i){const o=i.factories.slice();n=n.concat(o)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||fB()),deps:[[e,new $h,new to]]}}find(n){const i=this.factories.find(o=>o.supports(n));if(i)return i;throw new ge(901,!1)}}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:fB}),e})();const K9e=Z$(null,"core",[]);let X9e=(()=>{var r;class e{constructor(n){}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(u6))},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({}),e})();function L8(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}let eS=null;function I4(){return eS}class fde{}const T2=new tt("DocumentToken");let tS=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return rt(hde)},providedIn:"platform"}),e})();const dde=new tt("Location Initialized");let hde=(()=>{var r;class e extends tS{constructor(){super(),this._doc=rt(T2),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return I4().getBaseHref(this._doc)}onPopState(n){const i=I4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=I4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,i,o){this._history.pushState(n,i,o)}replaceState(n,i,o){this._history.replaceState(n,i,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return new r},providedIn:"platform"}),e})();function nS(r,e){if(0==r.length)return e;if(0==e.length)return r;let t=0;return r.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?r+e.substring(1):1==t?r+e:r+"/"+e}function CB(r){const e=r.match(/#|\?|$/),t=e&&e.index||r.length;return r.slice(0,t-("/"===r[t-1]?1:0))+r.slice(t)}function M3(r){return r&&"?"!==r[0]?"?"+r:r}let d6=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return rt(MB)},providedIn:"root"}),e})();const yB=new tt("appBaseHref");let MB=(()=>{var r;class e extends d6{constructor(n,i){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??rt(T2).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return nS(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+M3(this._platformLocation.search),o=this._platformLocation.hash;return o&&n?`${i}${o}`:i}pushState(n,i,o,s){const a=this.prepareExternalUrl(o+M3(s));this._platformLocation.pushState(n,i,a)}replaceState(n,i,o,s){const a=this.prepareExternalUrl(o+M3(s));this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(tS),Pe(yB,8))},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),pde=(()=>{var r;class e extends d6{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=nS(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,o,s){let a=this.prepareExternalUrl(o+M3(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(n,i,a)}replaceState(n,i,o,s){let a=this.prepareExternalUrl(o+M3(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(tS),Pe(yB,8))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})(),rS=(()=>{var r;class e{constructor(n){this._subject=new N1,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const i=this._locationStrategy.getBaseHref();this._basePath=function _de(r){if(new RegExp("^(https?:)?//").test(r)){const[,t]=r.split(/\/\/[^\/]+/);return t}return r}(CB(EB(i))),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+M3(i))}normalize(n){return e.stripTrailingSlash(function mde(r,e){if(!r||!e.startsWith(r))return e;const t=e.substring(r.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,EB(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,i="",o=null){this._locationStrategy.pushState(o,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+M3(i)),o)}replaceState(n,i="",o=null){this._locationStrategy.replaceState(o,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+M3(i)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(o=>o(n,i))}subscribe(n,i,o){return this._subject.subscribe({next:n,error:i,complete:o})}}return(r=e).normalizeQueryParams=M3,r.joinWithSlash=nS,r.stripTrailingSlash=CB,r.\u0275fac=function(n){return new(n||r)(Pe(d6))},r.\u0275prov=He({token:r,factory:function(){return function gde(){return new rS(Pe(d6))}()},providedIn:"root"}),e})();function EB(r){return r.replace(/\/index.html$/,"")}var qp=function(r){return r[r.Decimal=0]="Decimal",r[r.Percent=1]="Percent",r[r.Currency=2]="Currency",r[r.Scientific=3]="Scientific",r}(qp||{}),io=function(r){return r[r.Format=0]="Format",r[r.Standalone=1]="Standalone",r}(io||{}),v1=function(r){return r[r.Narrow=0]="Narrow",r[r.Abbreviated=1]="Abbreviated",r[r.Wide=2]="Wide",r[r.Short=3]="Short",r}(v1||{}),ns=function(r){return r[r.Short=0]="Short",r[r.Medium=1]="Medium",r[r.Long=2]="Long",r[r.Full=3]="Full",r}(ns||{}),Lr=function(r){return r[r.Decimal=0]="Decimal",r[r.Group=1]="Group",r[r.List=2]="List",r[r.PercentSign=3]="PercentSign",r[r.PlusSign=4]="PlusSign",r[r.MinusSign=5]="MinusSign",r[r.Exponential=6]="Exponential",r[r.SuperscriptingExponent=7]="SuperscriptingExponent",r[r.PerMille=8]="PerMille",r[r.Infinity=9]="Infinity",r[r.NaN=10]="NaN",r[r.TimeSeparator=11]="TimeSeparator",r[r.CurrencyDecimal=12]="CurrencyDecimal",r[r.CurrencyGroup=13]="CurrencyGroup",r}(Lr||{});function jp(r,e){return ks(no(r)[w1.DateFormat],e)}function Zp(r,e){return ks(no(r)[w1.TimeFormat],e)}function Yp(r,e){return ks(no(r)[w1.DateTimeFormat],e)}function Is(r,e){const t=no(r),n=t[w1.NumberSymbols][e];if(typeof n>"u"){if(e===Lr.CurrencyDecimal)return t[w1.NumberSymbols][Lr.Decimal];if(e===Lr.CurrencyGroup)return t[w1.NumberSymbols][Lr.Group]}return n}function PB(r){if(!r[w1.ExtraData])throw new Error(`Missing extra locale data for the locale "${r[w1.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function ks(r,e){for(let t=e;t>-1;t--)if(typeof r[t]<"u")return r[t];throw new Error("Locale data API: locale data undefined")}function oS(r){const[e,t]=r.split(":");return{hours:+e,minutes:+t}}const Ide=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,F7={},kde=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var E3=function(r){return r[r.Short=0]="Short",r[r.ShortGMT=1]="ShortGMT",r[r.Long=2]="Long",r[r.Extended=3]="Extended",r}(E3||{}),Kn=function(r){return r[r.FullYear=0]="FullYear",r[r.Month=1]="Month",r[r.Date=2]="Date",r[r.Hours=3]="Hours",r[r.Minutes=4]="Minutes",r[r.Seconds=5]="Seconds",r[r.FractionalSeconds=6]="FractionalSeconds",r[r.Day=7]="Day",r}(Kn||{}),Xn=function(r){return r[r.DayPeriods=0]="DayPeriods",r[r.Days=1]="Days",r[r.Months=2]="Months",r[r.Eras=3]="Eras",r}(Xn||{});function TB(r,e,t,n){let i=function $de(r){if(wB(r))return r;if("number"==typeof r&&!isNaN(r))return new Date(r);if("string"==typeof r){if(r=r.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(r)){const[i,o=1,s=1]=r.split("-").map(a=>+a);return Kp(i,o-1,s)}const t=parseFloat(r);if(!isNaN(r-t))return new Date(t);let n;if(n=r.match(Ide))return function Bde(r){const e=new Date(0);let t=0,n=0;const i=r[8]?e.setUTCFullYear:e.setFullYear,o=r[8]?e.setUTCHours:e.setHours;r[9]&&(t=Number(r[9]+r[10]),n=Number(r[9]+r[11])),i.call(e,Number(r[1]),Number(r[2])-1,Number(r[3]));const s=Number(r[4]||0)-t,a=Number(r[5]||0)-n,c=Number(r[6]||0),l=Math.floor(1e3*parseFloat("0."+(r[7]||0)));return o.call(e,s,a,c,l),e}(n)}const e=new Date(r);if(!wB(e))throw new Error(`Unable to convert "${r}" into a date`);return e}(r);e=S3(t,e)||e;let a,s=[];for(;e;){if(a=kde.exec(e),!a){s.push(e);break}{s=s.concat(a.slice(1));const f=s.pop();if(!f)break;e=f}}let c=i.getTimezoneOffset();n&&(c=bB(n,c),i=function Fde(r,e,t){const n=t?-1:1,i=r.getTimezoneOffset();return function Vde(r,e){return(r=new Date(r.getTime())).setMinutes(r.getMinutes()+e),r}(r,n*(bB(e,i)-i))}(i,n,!0));let l="";return s.forEach(f=>{const d=function Hde(r){if(aS[r])return aS[r];let e;switch(r){case"G":case"GG":case"GGG":e=A1(Xn.Eras,v1.Abbreviated);break;case"GGGG":e=A1(Xn.Eras,v1.Wide);break;case"GGGGG":e=A1(Xn.Eras,v1.Narrow);break;case"y":e=Yr(Kn.FullYear,1,0,!1,!0);break;case"yy":e=Yr(Kn.FullYear,2,0,!0,!0);break;case"yyy":e=Yr(Kn.FullYear,3,0,!1,!0);break;case"yyyy":e=Yr(Kn.FullYear,4,0,!1,!0);break;case"Y":e=eg(1);break;case"YY":e=eg(2,!0);break;case"YYY":e=eg(3);break;case"YYYY":e=eg(4);break;case"M":case"L":e=Yr(Kn.Month,1,1);break;case"MM":case"LL":e=Yr(Kn.Month,2,1);break;case"MMM":e=A1(Xn.Months,v1.Abbreviated);break;case"MMMM":e=A1(Xn.Months,v1.Wide);break;case"MMMMM":e=A1(Xn.Months,v1.Narrow);break;case"LLL":e=A1(Xn.Months,v1.Abbreviated,io.Standalone);break;case"LLLL":e=A1(Xn.Months,v1.Wide,io.Standalone);break;case"LLLLL":e=A1(Xn.Months,v1.Narrow,io.Standalone);break;case"w":e=sS(1);break;case"ww":e=sS(2);break;case"W":e=sS(1,!0);break;case"d":e=Yr(Kn.Date,1);break;case"dd":e=Yr(Kn.Date,2);break;case"c":case"cc":e=Yr(Kn.Day,1);break;case"ccc":e=A1(Xn.Days,v1.Abbreviated,io.Standalone);break;case"cccc":e=A1(Xn.Days,v1.Wide,io.Standalone);break;case"ccccc":e=A1(Xn.Days,v1.Narrow,io.Standalone);break;case"cccccc":e=A1(Xn.Days,v1.Short,io.Standalone);break;case"E":case"EE":case"EEE":e=A1(Xn.Days,v1.Abbreviated);break;case"EEEE":e=A1(Xn.Days,v1.Wide);break;case"EEEEE":e=A1(Xn.Days,v1.Narrow);break;case"EEEEEE":e=A1(Xn.Days,v1.Short);break;case"a":case"aa":case"aaa":e=A1(Xn.DayPeriods,v1.Abbreviated);break;case"aaaa":e=A1(Xn.DayPeriods,v1.Wide);break;case"aaaaa":e=A1(Xn.DayPeriods,v1.Narrow);break;case"b":case"bb":case"bbb":e=A1(Xn.DayPeriods,v1.Abbreviated,io.Standalone,!0);break;case"bbbb":e=A1(Xn.DayPeriods,v1.Wide,io.Standalone,!0);break;case"bbbbb":e=A1(Xn.DayPeriods,v1.Narrow,io.Standalone,!0);break;case"B":case"BB":case"BBB":e=A1(Xn.DayPeriods,v1.Abbreviated,io.Format,!0);break;case"BBBB":e=A1(Xn.DayPeriods,v1.Wide,io.Format,!0);break;case"BBBBB":e=A1(Xn.DayPeriods,v1.Narrow,io.Format,!0);break;case"h":e=Yr(Kn.Hours,1,-12);break;case"hh":e=Yr(Kn.Hours,2,-12);break;case"H":e=Yr(Kn.Hours,1);break;case"HH":e=Yr(Kn.Hours,2);break;case"m":e=Yr(Kn.Minutes,1);break;case"mm":e=Yr(Kn.Minutes,2);break;case"s":e=Yr(Kn.Seconds,1);break;case"ss":e=Yr(Kn.Seconds,2);break;case"S":e=Yr(Kn.FractionalSeconds,1);break;case"SS":e=Yr(Kn.FractionalSeconds,2);break;case"SSS":e=Yr(Kn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Qp(E3.Short);break;case"ZZZZZ":e=Qp(E3.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Qp(E3.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Qp(E3.Long);break;default:return null}return aS[r]=e,e}(f);l+=d?d(i,t,c):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function Kp(r,e,t){const n=new Date(0);return n.setFullYear(r,e,t),n.setHours(0,0,0),n}function S3(r,e){const t=function Cde(r){return no(r)[w1.LocaleId]}(r);if(F7[t]=F7[t]||{},F7[t][e])return F7[t][e];let n="";switch(e){case"shortDate":n=jp(r,ns.Short);break;case"mediumDate":n=jp(r,ns.Medium);break;case"longDate":n=jp(r,ns.Long);break;case"fullDate":n=jp(r,ns.Full);break;case"shortTime":n=Zp(r,ns.Short);break;case"mediumTime":n=Zp(r,ns.Medium);break;case"longTime":n=Zp(r,ns.Long);break;case"fullTime":n=Zp(r,ns.Full);break;case"short":const i=S3(r,"shortTime"),o=S3(r,"shortDate");n=Xp(Yp(r,ns.Short),[i,o]);break;case"medium":const s=S3(r,"mediumTime"),a=S3(r,"mediumDate");n=Xp(Yp(r,ns.Medium),[s,a]);break;case"long":const c=S3(r,"longTime"),l=S3(r,"longDate");n=Xp(Yp(r,ns.Long),[c,l]);break;case"full":const f=S3(r,"fullTime"),d=S3(r,"fullDate");n=Xp(Yp(r,ns.Full),[f,d])}return n&&(F7[t][e]=n),n}function Xp(r,e){return e&&(r=r.replace(/\{([^}]+)}/g,function(t,n){return null!=e&&n in e?e[n]:t})),r}function ma(r,e,t="-",n,i){let o="";(r<0||i&&r<=0)&&(i?r=1-r:(r=-r,o=t));let s=String(r);for(;s.length<e;)s="0"+s;return n&&(s=s.slice(s.length-e)),o+s}function Yr(r,e,t=0,n=!1,i=!1){return function(o,s){let a=function Lde(r,e){switch(r){case Kn.FullYear:return e.getFullYear();case Kn.Month:return e.getMonth();case Kn.Date:return e.getDate();case Kn.Hours:return e.getHours();case Kn.Minutes:return e.getMinutes();case Kn.Seconds:return e.getSeconds();case Kn.FractionalSeconds:return e.getMilliseconds();case Kn.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${r}".`)}}(r,o);if((t>0||a>-t)&&(a+=t),r===Kn.Hours)0===a&&-12===t&&(a=12);else if(r===Kn.FractionalSeconds)return function xde(r,e){return ma(r,3).substring(0,e)}(a,e);const c=Is(s,Lr.MinusSign);return ma(a,e,c,n,i)}}function A1(r,e,t=io.Format,n=!1){return function(i,o){return function Rde(r,e,t,n,i,o){switch(t){case Xn.Months:return function Ede(r,e,t){const n=no(r),o=ks([n[w1.MonthsFormat],n[w1.MonthsStandalone]],e);return ks(o,t)}(e,i,n)[r.getMonth()];case Xn.Days:return function Mde(r,e,t){const n=no(r),o=ks([n[w1.DaysFormat],n[w1.DaysStandalone]],e);return ks(o,t)}(e,i,n)[r.getDay()];case Xn.DayPeriods:const s=r.getHours(),a=r.getMinutes();if(o){const l=function Ode(r){const e=no(r);return PB(e),(e[w1.ExtraData][2]||[]).map(n=>"string"==typeof n?oS(n):[oS(n[0]),oS(n[1])])}(e),f=function bde(r,e,t){const n=no(r);PB(n);const o=ks([n[w1.ExtraData][0],n[w1.ExtraData][1]],e)||[];return ks(o,t)||[]}(e,i,n),d=l.findIndex(m=>{if(Array.isArray(m)){const[E,w]=m,L=s>=E.hours&&a>=E.minutes,z=s<w.hours||s===w.hours&&a<w.minutes;if(E.hours<w.hours){if(L&&z)return!0}else if(L||z)return!0}else if(m.hours===s&&m.minutes===a)return!0;return!1});if(-1!==d)return f[d]}return function yde(r,e,t){const n=no(r),o=ks([n[w1.DayPeriodsFormat],n[w1.DayPeriodsStandalone]],e);return ks(o,t)}(e,i,n)[s<12?0:1];case Xn.Eras:return function Sde(r,e){return ks(no(r)[w1.Eras],e)}(e,n)[r.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(i,o,r,e,t,n)}}function Qp(r){return function(e,t,n){const i=-1*n,o=Is(t,Lr.MinusSign),s=i>0?Math.floor(i/60):Math.ceil(i/60);switch(r){case E3.Short:return(i>=0?"+":"")+ma(s,2,o)+ma(Math.abs(i%60),2,o);case E3.ShortGMT:return"GMT"+(i>=0?"+":"")+ma(s,1,o);case E3.Long:return"GMT"+(i>=0?"+":"")+ma(s,2,o)+":"+ma(Math.abs(i%60),2,o);case E3.Extended:return 0===n?"Z":(i>=0?"+":"")+ma(s,2,o)+":"+ma(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${r}"`)}}}const zde=0,Jp=4;function OB(r){return Kp(r.getFullYear(),r.getMonth(),r.getDate()+(Jp-r.getDay()))}function sS(r,e=!1){return function(t,n){let i;if(e){const o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();i=1+Math.floor((s+o)/7)}else{const o=OB(t),s=function Dde(r){const e=Kp(r,zde,1).getDay();return Kp(r,0,1+(e<=Jp?Jp:Jp+7)-e)}(o.getFullYear()),a=o.getTime()-s.getTime();i=1+Math.round(a/6048e5)}return ma(i,r,Is(n,Lr.MinusSign))}}function eg(r,e=!1){return function(t,n){return ma(OB(t).getFullYear(),r,Is(n,Lr.MinusSign),e)}}const aS={};function bB(r,e){r=r.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+r)/6e4;return isNaN(t)?e:t}function wB(r){return r instanceof Date&&!isNaN(r.valueOf())}const Gde=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function fS(r){const e=parseInt(r);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+r);return e}function kB(r,e){e=encodeURIComponent(e);for(const t of r.split(";")){const n=t.indexOf("="),[i,o]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}const hS=/\s+/,xB=[];let Ft=(()=>{var r;class e{constructor(n,i,o,s){this._iterableDiffers=n,this._keyValueDiffers=i,this._ngEl=o,this._renderer=s,this.initialClasses=xB,this.stateMap=new Map}set klass(n){this.initialClasses=null!=n?n.trim().split(hS):xB}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split(hS):n}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const i of n)this._updateState(i,!0);else if(null!=n)for(const i of Object.keys(n))this._updateState(i,!!n[i]);this._applyStateDiff()}_updateState(n,i){const o=this.stateMap.get(n);void 0!==o?(o.enabled!==i&&(o.changed=!0,o.enabled=i),o.touched=!0):this.stateMap.set(n,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const i=n[0],o=n[1];o.changed?(this._toggleClass(i,o.enabled),o.changed=!1):o.touched||(o.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),o.touched=!1}}_toggleClass(n,i){(n=n.trim()).length>0&&n.split(hS).forEach(o=>{i?this._renderer.addClass(this._ngEl.nativeElement,o):this._renderer.removeClass(this._ngEl.nativeElement,o)})}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Up),G(V7),G(Pi),G(lc))},r.\u0275dir=Rt({type:r,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),e})();class nhe{constructor(e,t,n,i){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Wt=(()=>{var r;class e{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,i,o){this._viewContainer=n,this._template=i,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((o,s,a)=>{if(null==o.previousIndex)i.createEmbeddedView(this._template,new nhe(o.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)i.remove(null===s?void 0:s);else if(null!==s){const c=i.get(s);i.move(c,a),RB(c,o)}});for(let o=0,s=i.length;o<s;o++){const c=i.get(o).context;c.index=o,c.count=s,c.ngForOf=this._ngForOf}n.forEachIdentityChange(o=>{RB(i.get(o.currentIndex),o)})}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(G(ts),G(_3),G(Up))},r.\u0275dir=Rt({type:r,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),e})();function RB(r,e){r.context.$implicit=e.item}let Nt=(()=>{var r;class e{constructor(n,i){this._viewContainer=n,this._context=new rhe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){zB("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){zB("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(G(ts),G(_3))},r.\u0275dir=Rt({type:r,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),e})();class rhe{constructor(){this.$implicit=null,this.ngIf=null}}function zB(r,e){if(e&&!e.createEmbeddedView)throw new Error(`${r} must be a TemplateRef, but received '${o2(e)}'.`)}let VB=(()=>{var r;class e{constructor(n){this._locale=n}transform(n,i,o){if(!function mS(r){return!(null==r||""===r||r!=r)}(n))return null;o=o||this._locale;try{return function Yde(r,e,t){return function lS(r,e,t,n,i,o,s=!1){let a="",c=!1;if(isFinite(r)){let l=function Xde(r){let n,i,o,s,a,e=Math.abs(r)+"",t=0;for((i=e.indexOf("."))>-1&&(e=e.replace(".","")),(o=e.search(/e/i))>0?(i<0&&(i=o),i+=+e.slice(o+1),e=e.substring(0,o)):i<0&&(i=e.length),o=0;"0"===e.charAt(o);o++);if(o===(a=e.length))n=[0],i=1;else{for(a--;"0"===e.charAt(a);)a--;for(i-=o,n=[],s=0;o<=a;o++,s++)n[s]=Number(e.charAt(o))}return i>22&&(n=n.splice(0,21),t=i-1,i=1),{digits:n,exponent:t,integerLen:i}}(r);s&&(l=function Kde(r){if(0===r.digits[0])return r;const e=r.digits.length-r.integerLen;return r.exponent?r.exponent+=2:(0===e?r.digits.push(0,0):1===e&&r.digits.push(0),r.integerLen+=2),r}(l));let f=e.minInt,d=e.minFrac,m=e.maxFrac;if(o){const B=o.match(Gde);if(null===B)throw new Error(`${o} is not a valid digit info`);const de=B[1],_e=B[3],xe=B[5];null!=de&&(f=fS(de)),null!=_e&&(d=fS(_e)),null!=xe?m=fS(xe):null!=_e&&d>m&&(m=d)}!function Qde(r,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let n=r.digits,i=n.length-r.integerLen;const o=Math.min(Math.max(e,i),t);let s=o+r.integerLen,a=n[s];if(s>0){n.splice(Math.max(r.integerLen,s));for(let d=s;d<n.length;d++)n[d]=0}else{i=Math.max(0,i),r.integerLen=1,n.length=Math.max(1,s=o+1),n[0]=0;for(let d=1;d<s;d++)n[d]=0}if(a>=5)if(s-1<0){for(let d=0;d>s;d--)n.unshift(0),r.integerLen++;n.unshift(1),r.integerLen++}else n[s-1]++;for(;i<Math.max(0,o);i++)n.push(0);let c=0!==o;const l=e+r.integerLen,f=n.reduceRight(function(d,m,E,w){return w[E]=(m+=d)<10?m:m-10,c&&(0===w[E]&&E>=l?w.pop():c=!1),m>=10?1:0},0);f&&(n.unshift(f),r.integerLen++)}(l,d,m);let E=l.digits,w=l.integerLen;const L=l.exponent;let z=[];for(c=E.every(B=>!B);w<f;w++)E.unshift(0);for(;w<0;w++)E.unshift(0);w>0?z=E.splice(w,E.length):(z=E,E=[0]);const $=[];for(E.length>=e.lgSize&&$.unshift(E.splice(-e.lgSize,E.length).join(""));E.length>e.gSize;)$.unshift(E.splice(-e.gSize,E.length).join(""));E.length&&$.unshift(E.join("")),a=$.join(Is(t,n)),z.length&&(a+=Is(t,i)+z.join("")),L&&(a+=Is(t,Lr.Exponential)+"+"+L)}else a=Is(t,Lr.Infinity);return a=r<0&&!c?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(r,function uS(r,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=r.split(";"),i=n[0],o=n[1],s=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],a=s[0],c=s[1]||"";t.posPre=a.substring(0,a.indexOf("#"));for(let f=0;f<c.length;f++){const d=c.charAt(f);"0"===d?t.minFrac=t.maxFrac=f+1:"#"===d?t.maxFrac=f+1:t.posSuf+=d}const l=a.split(",");if(t.gSize=l[1]?l[1].length:0,t.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,o){const f=i.length-t.posPre.length-t.posSuf.length,d=o.indexOf("#");t.negPre=o.substring(0,d).replace(/'/g,""),t.negSuf=o.slice(d+f).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function iS(r,e){return no(r)[w1.NumberFormats][e]}(e,qp.Decimal),Is(e,Lr.MinusSign)),e,Lr.Group,Lr.Decimal,t)}(function _S(r){if("string"==typeof r&&!isNaN(Number(r)-parseFloat(r)))return Number(r);if("number"!=typeof r)throw new Error(`${r} is not a number`);return r}(n),o,i)}catch(s){throw function _a(r,e){return new ge(2100,!1)}()}}}return(r=e).\u0275fac=function(n){return new(n||r)(G(pc,16))},r.\u0275pipe=Mi({name:"number",type:r,pure:!0,standalone:!0}),e})();let bhe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({}),e})();function $B(r){return"server"===r}let Ihe=(()=>{var r;class e{}return(r=e).\u0275prov=He({token:r,providedIn:"root",factory:()=>new khe(Pe(T2),window)}),e})();class khe{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function xhe(r,e){const t=r.getElementById(e)||r.getElementsByName(e)[0];if(t)return t;if("function"==typeof r.createTreeWalker&&r.body&&"function"==typeof r.body.attachShadow){const n=r.createTreeWalker(r.body,NodeFilter.SHOW_ELEMENT);let i=n.currentNode;for(;i;){const o=i.shadowRoot;if(o){const s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}i=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(n-o[0],i-o[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class BB{}class npe extends fde{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class yS extends npe{static makeCurrent(){!function ude(r){eS||(eS=r)}(new yS)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function rpe(){return G7=G7||document.querySelector("base"),G7?G7.getAttribute("href"):null}();return null==t?null:function ipe(r){ig=ig||document.createElement("a"),ig.setAttribute("href",r);const e=ig.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){G7=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return kB(document.cookie,e)}}let ig,G7=null,spe=(()=>{var r;class e{build(){return new XMLHttpRequest}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const MS=new tt("EventManagerPlugins");let jB=(()=>{var r;class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(o=>{o.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,o){return this._findPluginFor(i).addEventListener(n,i,o)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(s=>s.supports(n)),!i)throw new ge(5101,!1);return this._eventNameToPlugin.set(n,i),i}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(MS),Pe(o1))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();class ZB{constructor(e){this._doc=e}}const ES="ng-app-id";let YB=(()=>{var r;class e{constructor(n,i,o,s={}){this.doc=n,this.appId=i,this.nonce=o,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=$B(s),this.resetHostNodes()}addStyles(n){for(const i of n)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(n){for(const i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){const i=this.styleRef;i.get(n)?.elements?.forEach(o=>o.remove()),i.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${ES}="${this.appId}"]`);if(n?.length){const i=new Map;return n.forEach(o=>{null!=o.textContent&&i.set(o.textContent,o)}),i}return null}changeUsageCount(n,i){const o=this.styleRef;if(o.has(n)){const s=o.get(n);return s.usage+=i,s.usage}return o.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){const o=this.styleNodesInDOM,s=o?.get(i);if(s?.parentNode===n)return o.delete(i),s.removeAttribute(ES),s;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(ES,this.appId),a}}addStyleToHost(n,i){const o=this.getStyleElement(n,i);n.appendChild(o);const s=this.styleRef,a=s.get(i)?.elements;a?a.push(o):s.set(i,{elements:[o],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(T2),Pe(lp),Pe(uH,8),Pe(p3))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const SS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},PS=/%COMP%/g,upe=new tt("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function XB(r,e){return e.map(t=>t.replace(PS,r))}let TS=(()=>{var r;class e{constructor(n,i,o,s,a,c,l,f=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=o,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=$B(c),this.defaultRenderer=new OS(n,a,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===bs.ShadowDom&&(i={...i,encapsulation:bs.Emulated});const o=this.getOrCreateRenderer(n,i);return o instanceof JB?o.applyToHost(n):o instanceof bS&&o.applyStyles(),o}getOrCreateRenderer(n,i){const o=this.rendererByCompId;let s=o.get(i.id);if(!s){const a=this.doc,c=this.ngZone,l=this.eventManager,f=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case bs.Emulated:s=new JB(l,f,i,this.appId,d,a,c,m);break;case bs.ShadowDom:return new ppe(l,f,n,i,a,c,this.nonce,m);default:s=new bS(l,f,i,d,a,c,m)}o.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(jB),Pe(YB),Pe(lp),Pe(upe),Pe(T2),Pe(p3),Pe(o1),Pe(uH))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();class OS{constructor(e,t,n,i){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(SS[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(QB(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(QB(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?this.doc.querySelector(e):e;if(!n)throw new ge(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;const o=SS[i];o?e.setAttributeNS(o,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const i=SS[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(b4.DashCase|b4.Important)?e.style.setProperty(t,n,i&b4.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&b4.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){if("string"==typeof e&&!(e=I4().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function QB(r){return"TEMPLATE"===r.tagName&&void 0!==r.content}class ppe extends OS{constructor(e,t,n,i,o,s,a,c){super(e,o,s,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=XB(i.id,i.styles);for(const f of l){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=f,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class bS extends OS{constructor(e,t,n,i,o,s,a,c){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?XB(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class JB extends bS{constructor(e,t,n,i,o,s,a,c){const l=i+"-"+n.id;super(e,t,n,o,s,a,c,l),this.contentAttr=function fpe(r){return"_ngcontent-%COMP%".replace(PS,r)}(l),this.hostAttr=function dpe(r){return"_nghost-%COMP%".replace(PS,r)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}let gpe=(()=>{var r;class e extends ZB{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,o){return n.addEventListener(i,o,!1),()=>this.removeEventListener(n,i,o)}removeEventListener(n,i,o){return n.removeEventListener(i,o)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(T2))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const eG=["alt","control","meta","shift"],mpe={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_pe={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey};let vpe=(()=>{var r;class e extends ZB{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,i,o){const s=e.parseEventName(i),a=e.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>I4().onAndCancel(n,s.domEventName,a))}static parseEventName(n){const i=n.toLowerCase().split("."),o=i.shift();if(0===i.length||"keydown"!==o&&"keyup"!==o)return null;const s=e._normalizeKey(i.pop());let a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),eG.forEach(f=>{const d=i.indexOf(f);d>-1&&(i.splice(d,1),a+=f+".")}),a+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=o,l.fullKey=a,l}static matchEventFullKeyCode(n,i){let o=mpe[n.key]||n.key,s="";return i.indexOf("code.")>-1&&(o=n.code,s="code."),!(null==o||!o)&&(o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),eG.forEach(a=>{a!==o&&(0,_pe[a])(n)&&(s+=a+".")}),s+=o,s===i)}static eventCallback(n,i,o){return s=>{e.matchEventFullKeyCode(s,n)&&o.runGuarded(()=>i(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(T2))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const nG=[{provide:p3,useValue:"browser"},{provide:cH,useValue:function Cpe(){yS.makeCurrent()},multi:!0},{provide:T2,useFactory:function Mpe(){return function f0e(r){mM=r}(document),document},deps:[]}],Epe=Z$(K9e,"browser",nG),Spe=new tt(""),rG=[{provide:Fp,useClass:class ope{addToWindow(e){m1.getAngularTestability=(n,i=!0)=>{const o=e.findTestabilityInTree(n,i);if(null==o)throw new ge(5103,!1);return o},m1.getAllAngularTestabilities=()=>e.getAllTestabilities(),m1.getAllAngularRootElements=()=>e.getAllRootElements(),m1.frameworkStabilizers||(m1.frameworkStabilizers=[]),m1.frameworkStabilizers.push(n=>{const i=m1.getAllAngularTestabilities();let o=i.length,s=!1;const a=function(c){s=s||c,o--,0==o&&n(s)};i.forEach(c=>{c.whenStable(a)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?I4().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:G$,useClass:GE,deps:[o1,UE,Fp]},{provide:GE,useClass:GE,deps:[o1,UE,Fp]}],iG=[{provide:TM,useValue:"root"},{provide:i6,useFactory:function ype(){return new i6},deps:[]},{provide:MS,useClass:gpe,multi:!0,deps:[T2,o1,p3]},{provide:MS,useClass:vpe,multi:!0,deps:[T2]},TS,YB,jB,{provide:v7,useExisting:TS},{provide:BB,useClass:spe,deps:[]},[]];let oG=(()=>{var r;class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:lp,useValue:n.appId}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(Spe,12))},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({providers:[...iG,...rG],imports:[bhe,X9e]}),e})(),sG=(()=>{var r;class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(T2))},r.\u0275prov=He({token:r,factory:function(n){let i=null;return i=n?new n:function Tpe(){return new sG(Pe(T2))}(),i},providedIn:"root"}),e})();typeof window<"u"&&window;let lG=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(n){let i=null;return i=n?new(n||r):Pe(uG),i},providedIn:"root"}),e})(),uG=(()=>{var r;class e extends lG{constructor(n){super(),this._doc=n}sanitize(n,i){if(null==i)return null;switch(n){case Ns.NONE:return i;case Ns.HTML:return cc(i,"HTML")?Qo(i):QD(this._doc,String(i)).toString();case Ns.STYLE:return cc(i,"Style")?Qo(i):i;case Ns.SCRIPT:if(cc(i,"Script"))return Qo(i);throw new ge(5200,!1);case Ns.URL:return cc(i,"URL")?Qo(i):np(String(i));case Ns.RESOURCE_URL:if(cc(i,"ResourceURL"))return Qo(i);throw new ge(5201,!1);default:throw new ge(5202,!1)}}bypassSecurityTrustHtml(n){return function v0e(r){return new d0e(r)}(n)}bypassSecurityTrustStyle(n){return function C0e(r){return new h0e(r)}(n)}bypassSecurityTrustScript(n){return function y0e(r){return new p0e(r)}(n)}bypassSecurityTrustUrl(n){return function M0e(r){return new g0e(r)}(n)}bypassSecurityTrustResourceUrl(n){return function E0e(r){return new m0e(r)}(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(T2))},r.\u0275prov=He({token:r,factory:function(n){let i=null;return i=n?new n:function Npe(r){return new uG(r.get(T2))}(Pe(J2)),i},providedIn:"root"}),e})();function U7(r){return(U7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function u(r,e,t){return(e=function Ipe(r){var e=function Ape(r,e){if("object"!==U7(r)||null===r)return r;var t=r[Symbol.toPrimitive];if(void 0!==t){var n=t.call(r,e||"default");if("object"!==U7(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(r)}(r,"string");return"symbol"===U7(e)?e:String(e)}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}const{isArray:kpe}=Array,{getPrototypeOf:xpe,prototype:Lpe,keys:Rpe}=Object;function dG(r){if(1===r.length){const e=r[0];if(kpe(e))return{args:e,keys:null};if(function zpe(r){return r&&"object"==typeof r&&xpe(r)===Lpe}(e)){const t=Rpe(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:r,keys:null}}const{isArray:Dpe}=Array;function hG(r){return Wn(e=>function Hpe(r,e){return Dpe(e)?r(...e):r(e)}(r,e))}function pG(r,e){return r.reduce((t,n,i)=>(t[n]=e[i],t),{})}let gG=(()=>{var r;class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return(r=e).\u0275fac=function(n){return new(n||r)(G(lc),G(Pi))},r.\u0275dir=Rt({type:r}),e})(),h6=(()=>{var r;class e extends gG{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,features:[Qe]}),e})();const gc=new tt("NgValueAccessor"),Fpe={provide:gc,useExisting:O1(()=>NS),multi:!0};let NS=(()=>{var r;class e extends h6{writeValue(n){this.setProperty("checked",n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,i){1&n&&U("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},features:[Y1([Fpe]),Qe]}),e})();const $pe={provide:gc,useExisting:O1(()=>mc),multi:!0},Gpe=new tt("CompositionEventMode");let mc=(()=>{var r;class e extends gG{constructor(n,i,o){super(n,i),this._compositionMode=o,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Bpe(){const r=I4()?I4().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(G(lc),G(Pi),G(Gpe,8))},r.\u0275dir=Rt({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){1&n&&U("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[Y1([$pe]),Qe]}),e})();function x4(r){return null==r||("string"==typeof r||Array.isArray(r))&&0===r.length}function mG(r){return null!=r&&"number"==typeof r.length}const bi=new tt("NgValidators"),L4=new tt("NgAsyncValidators"),Upe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class W7{static min(e){return function _G(r){return e=>{if(x4(e.value)||x4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<r?{min:{min:r,actual:e.value}}:null}}(e)}static max(e){return function vG(r){return e=>{if(x4(e.value)||x4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>r?{max:{max:r,actual:e.value}}:null}}(e)}static required(e){return CG(e)}static requiredTrue(e){return function yG(r){return!0===r.value?null:{required:!0}}(e)}static email(e){return function MG(r){return x4(r.value)||Upe.test(r.value)?null:{email:!0}}(e)}static minLength(e){return function EG(r){return e=>x4(e.value)||!mG(e.value)?null:e.value.length<r?{minlength:{requiredLength:r,actualLength:e.value.length}}:null}(e)}static maxLength(e){return SG(e)}static pattern(e){return function PG(r){if(!r)return og;let e,t;return"string"==typeof r?(t="","^"!==r.charAt(0)&&(t+="^"),t+=r,"$"!==r.charAt(r.length-1)&&(t+="$"),e=new RegExp(t)):(t=r.toString(),e=r),n=>{if(x4(n.value))return null;const i=n.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return AG(e)}static composeAsync(e){return IG(e)}}function CG(r){return x4(r.value)?{required:!0}:null}function SG(r){return e=>mG(e.value)&&e.value.length>r?{maxlength:{requiredLength:r,actualLength:e.value.length}}:null}function og(r){return null}function TG(r){return null!=r}function OG(r){return w7(r)?r2(r):r}function bG(r){let e={};return r.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function wG(r,e){return e.map(t=>t(r))}function NG(r){return r.map(e=>function Wpe(r){return!r.validate}(e)?e:t=>e.validate(t))}function AG(r){if(!r)return null;const e=r.filter(TG);return 0==e.length?null:function(t){return bG(wG(t,e))}}function AS(r){return null!=r?AG(NG(r)):null}function IG(r){if(!r)return null;const e=r.filter(TG);return 0==e.length?null:function(t){return function Vpe(...r){const e=$R(r),{args:t,keys:n}=dG(r),i=new T1(o=>{const{length:s}=t;if(!s)return void o.complete();const a=new Array(s);let c=s,l=s;for(let f=0;f<s;f++){let d=!1;jo(t[f]).subscribe(pr(o,m=>{d||(d=!0,l--),a[f]=m},()=>c--,void 0,()=>{(!c||!d)&&(l||o.next(n?pG(n,a):a),o.complete())}))}});return e?i.pipe(hG(e)):i}(wG(t,e).map(OG)).pipe(Wn(bG))}}function IS(r){return null!=r?IG(NG(r)):null}function kG(r,e){return null===r?[e]:Array.isArray(r)?[...r,e]:[r,e]}function xG(r){return r._rawValidators}function LG(r){return r._rawAsyncValidators}function kS(r){return r?Array.isArray(r)?r:[r]:[]}function sg(r,e){return Array.isArray(r)?r.includes(e):r===e}function RG(r,e){const t=kS(e);return kS(r).forEach(i=>{sg(t,i)||t.push(i)}),t}function zG(r,e){return kS(e).filter(t=>!sg(r,t))}class DG{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=AS(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=IS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class oo extends DG{get formDirective(){return null}get path(){return null}}class R4 extends DG{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class HG{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let P3=(()=>{var r;class e extends HG{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(G(R4,2))},r.\u0275dir=Rt({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){2&n&&Np("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Qe]}),e})(),p6=(()=>{var r;class e extends HG{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(G(oo,10))},r.\u0275dir=Rt({type:r,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,i){2&n&&Np("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Qe]}),e})();const q7="VALID",cg="INVALID",z8="PENDING",j7="DISABLED";function RS(r){return(lg(r)?r.validators:r)||null}function zS(r,e){return(lg(e)?e.asyncValidators:r)||null}function lg(r){return null!=r&&!Array.isArray(r)&&"object"==typeof r}function FG(r,e,t){const n=r.controls;if(!(e?Object.keys(n):n).length)throw new ge(1e3,"");if(!n[t])throw new ge(1001,"")}function $G(r,e,t){r._forEachChild((n,i)=>{if(void 0===t[i])throw new ge(1002,"")})}class ug{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===q7}get invalid(){return this.status===cg}get pending(){return this.status==z8}get disabled(){return this.status===j7}get enabled(){return this.status!==j7}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(RG(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(RG(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(zG(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(zG(e,this._rawAsyncValidators))}hasValidator(e){return sg(this._rawValidators,e)}hasAsyncValidator(e){return sg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=z8,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=j7,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=q7,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===q7||this.status===z8)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?j7:q7}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=z8,this._hasOwnPendingAsyncValidator=!0;const t=OG(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,i)=>n&&n._find(i),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new N1,this.statusChanges=new N1}_calculateStatus(){return this._allControlsDisabled()?j7:this.errors?cg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(z8)?z8:this._anyControlsHaveStatus(cg)?cg:q7}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){lg(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function Ype(r){return Array.isArray(r)?AS(r):r||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function Kpe(r){return Array.isArray(r)?IS(r):r||null}(this._rawAsyncValidators)}}class z4 extends ug{constructor(e,t,n){super(RS(t),zS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){$G(this,0,e),Object.keys(e).forEach(n=>{FG(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{const i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>!!n._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((i,o)=>{n=t(n,i,o)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class BG extends z4{}const g6=new tt("CallSetDisabledState",{providedIn:"root",factory:()=>Z7}),Z7="always";function fg(r,e){return[...e.path,r]}function Y7(r,e,t=Z7){DS(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(r.disabled),function Qpe(r,e){e.valueAccessor.registerOnChange(t=>{r._pendingValue=t,r._pendingChange=!0,r._pendingDirty=!0,"change"===r.updateOn&&GG(r,e)})}(r,e),function ege(r,e){const t=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};r.registerOnChange(t),e._registerOnDestroy(()=>{r._unregisterOnChange(t)})}(r,e),function Jpe(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,"blur"===r.updateOn&&r._pendingChange&&GG(r,e),"submit"!==r.updateOn&&r.markAsTouched()})}(r,e),function Xpe(r,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};r.registerOnDisabledChange(t),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(t)})}}(r,e)}function dg(r,e,t=!0){const n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),pg(r,e),r&&(e._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function hg(r,e){r.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function DS(r,e){const t=xG(r);null!==e.validator?r.setValidators(kG(t,e.validator)):"function"==typeof t&&r.setValidators([t]);const n=LG(r);null!==e.asyncValidator?r.setAsyncValidators(kG(n,e.asyncValidator)):"function"==typeof n&&r.setAsyncValidators([n]);const i=()=>r.updateValueAndValidity();hg(e._rawValidators,i),hg(e._rawAsyncValidators,i)}function pg(r,e){let t=!1;if(null!==r){if(null!==e.validator){const i=xG(r);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==e.validator);o.length!==i.length&&(t=!0,r.setValidators(o))}}if(null!==e.asyncValidator){const i=LG(r);if(Array.isArray(i)&&i.length>0){const o=i.filter(s=>s!==e.asyncValidator);o.length!==i.length&&(t=!0,r.setAsyncValidators(o))}}}const n=()=>{};return hg(e._rawValidators,n),hg(e._rawAsyncValidators,n),t}function GG(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function UG(r,e){DS(r,e)}function VS(r,e){if(!r.hasOwnProperty("model"))return!1;const t=r.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function WG(r,e){r._syncPendingControls(),e.forEach(t=>{const n=t.control;"submit"===n.updateOn&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function FS(r,e){if(!e)return null;let t,n,i;return Array.isArray(e),e.forEach(o=>{o.constructor===mc?t=o:function rge(r){return Object.getPrototypeOf(r.constructor)===h6}(o)?n=o:i=o}),i||n||t||null}const oge={provide:oo,useExisting:O1(()=>X7)},K7=(()=>Promise.resolve())();let X7=(()=>{var r;class e extends oo{constructor(n,i,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._directives=new Set,this.ngSubmit=new N1,this.form=new z4({},AS(n),IS(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){K7.then(()=>{const i=this._findContainer(n.path);n.control=i.registerControl(n.name,n.control),Y7(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){K7.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){K7.then(()=>{const i=this._findContainer(n.path),o=new z4({});UG(o,n),i.registerControl(n.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){K7.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,i){K7.then(()=>{this.form.get(n.path).setValue(i)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,WG(this.form,this._directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}}return(r=e).\u0275fac=function(n){return new(n||r)(G(bi,10),G(L4,10),G(g6,8))},r.\u0275dir=Rt({type:r,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,i){1&n&&U("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Y1([oge]),Qe]}),e})();function qG(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}function jG(r){return"object"==typeof r&&null!==r&&2===Object.keys(r).length&&"value"in r&&"disabled"in r}const rs=class extends ug{constructor(e=null,t,n){super(RS(t),zS(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),lg(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=jG(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){qG(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){qG(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){jG(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},cge={provide:R4,useExisting:O1(()=>Q7)},KG=(()=>Promise.resolve())();let Q7=(()=>{var r;class e extends R4{constructor(n,i,o,s,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new rs,this._registered=!1,this.name="",this.update=new N1,this._parent=n,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=FS(0,s)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),VS(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Y7(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){KG.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const i=n.isDisabled.currentValue,o=0!==i&&L8(i);KG.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?fg(n,this._parent):[n]}}return(r=e).\u0275fac=function(n){return new(n||r)(G(oo,9),G(bi,10),G(L4,10),G(gc,10),G(y3,8),G(g6,8))},r.\u0275dir=Rt({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Y1([cge]),Qe,Xi]}),e})(),m6=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})(),QG=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({}),e})();const dge={provide:gc,useExisting:O1(()=>gg),multi:!0};let gg=(()=>{var r;class e extends h6{writeValue(n){this.setProperty("value",parseFloat(n))}registerOnChange(n){this.onChange=i=>{n(""==i?null:parseFloat(i))}}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,i){1&n&&U("change",function(s){return i.onChange(s.target.value)})("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[Y1([dge]),Qe]}),e})();const $S=new tt("NgModelWithFormControlWarning"),hge={provide:R4,useExisting:O1(()=>BS)};let BS=(()=>{var r;class e extends R4{set isDisabled(n){}constructor(n,i,o,s,a){super(),this._ngModelWarningConfig=s,this.callSetDisabledState=a,this.update=new N1,this._ngModelWarningSent=!1,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=FS(0,o)}ngOnChanges(n){if(this._isControlChanged(n)){const i=n.form.previousValue;i&&dg(i,this,!1),Y7(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}VS(n,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&dg(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_isControlChanged(n){return n.hasOwnProperty("form")}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(G(bi,10),G(L4,10),G(gc,10),G($S,8),G(g6,8))},r.\u0275dir=Rt({type:r,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Y1([hge]),Qe,Xi]}),e})();const pge={provide:oo,useExisting:O1(()=>_6)};let _6=(()=>{var r;class e extends oo{constructor(n,i,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new N1,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(pg(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){const i=this.form.get(n.path);return Y7(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){dg(n.control||null,n,!1),function ige(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,WG(this.form,this.directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{const i=n.control,o=this.form.get(n.path);i!==o&&(dg(i||null,n),(r=>r instanceof rs)(o)&&(Y7(o,n,this.callSetDisabledState),n.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){const i=this.form.get(n.path);UG(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){const i=this.form.get(n.path);i&&function tge(r,e){return pg(r,e)}(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){DS(this.form,this),this._oldForm&&pg(this._oldForm,this)}_checkFormPresent(){}}return(r=e).\u0275fac=function(n){return new(n||r)(G(bi,10),G(L4,10),G(g6,8))},r.\u0275dir=Rt({type:r,selectors:[["","formGroup",""]],hostBindings:function(n,i){1&n&&U("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Y1([pge]),Qe,Xi]}),e})();const _ge={provide:R4,useExisting:O1(()=>D8)};let D8=(()=>{var r;class e extends R4{set isDisabled(n){}constructor(n,i,o,s,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new N1,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=FS(0,s)}ngOnChanges(n){this._added||this._setUpControl(),VS(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return fg(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(G(oo,13),G(bi,10),G(L4,10),G(gc,10),G($S,8))},r.\u0275dir=Rt({type:r,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Y1([_ge]),Qe,Xi]}),e})();const vge={provide:gc,useExisting:O1(()=>mg),multi:!0};function tU(r,e){return null==r?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let mg=(()=>{var r;class e extends h6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;const o=tU(this._getOptionId(n),n);this.setProperty("value",o)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){const i=function Cge(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i):n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){1&n&&U("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Y1([vge]),Qe]}),e})(),J7=(()=>{var r;class e{constructor(n,i,o){this._element=n,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(tU(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Pi),G(lc),G(mg,9))},r.\u0275dir=Rt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const yge={provide:gc,useExisting:O1(()=>WS),multi:!0};function nU(r,e){return null==r?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let WS=(()=>{var r;class e extends h6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){let i;if(this.value=n,Array.isArray(n)){const o=n.map(s=>this._getOptionId(s));i=(s,a)=>{s._setSelected(o.indexOf(a.toString())>-1)}}else i=(o,s)=>{o._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{const o=[],s=i.selectedOptions;if(void 0!==s){const a=s;for(let c=0;c<a.length;c++){const f=this._getOptionValue(a[c].value);o.push(f)}}else{const a=i.options;for(let c=0;c<a.length;c++){const l=a[c];if(l.selected){const f=this._getOptionValue(l.value);o.push(f)}}}this.value=o,n(o)}}_registerOption(n){const i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){const i=function Mge(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){1&n&&U("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Y1([yge]),Qe]}),e})(),ef=(()=>{var r;class e{constructor(n,i,o){this._element=n,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(nU(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(nU(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Pi),G(lc),G(WS,9))},r.\u0275dir=Rt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();let v6=(()=>{var r;class e{constructor(){this._validator=og}ngOnChanges(n){if(this.inputName in n){const i=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):og,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return null!=n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,features:[Xi]}),e})();const Pge={provide:bi,useExisting:O1(()=>C6),multi:!0};let C6=(()=>{var r;class e extends v6{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=L8,this.createValidator=n=>CG}enabled(n){return n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,i){2&n&&k("required",i._enabled?"":null)},inputs:{required:"required"},features:[Y1([Pge]),Qe]}),e})();const wge={provide:bi,useExisting:O1(()=>qS),multi:!0};let qS=(()=>{var r;class e extends v6{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=n=>function rU(r){return"number"==typeof r?r:parseInt(r,10)}(n),this.createValidator=n=>SG(n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(n,i){2&n&&k("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Y1([wge]),Qe]}),e})(),fU=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({imports:[QG]}),e})();class dU extends ug{constructor(e,t,n){super(RS(t),zS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){$G(this,0,e),e.forEach((n,i)=>{FG(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,n)=>!!n._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function hU(r){return!!r&&(void 0!==r.asyncValidators||void 0!==r.validators||void 0!==r.updateOn)}let Age=(()=>{var r;class e{constructor(){this.useNonNullable=!1}get nonNullable(){const n=new e;return n.useNonNullable=!0,n}group(n,i=null){const o=this._reduceControls(n);let s={};return hU(i)?s=i:null!==i&&(s.validators=i.validator,s.asyncValidators=i.asyncValidator),new z4(o,s)}record(n,i=null){const o=this._reduceControls(n);return new BG(o,i)}control(n,i,o){let s={};return this.useNonNullable?(hU(i)?s=i:(s.validators=i,s.asyncValidators=o),new rs(n,{...s,nonNullable:!0})):new rs(n,i,o)}array(n,i,o){const s=n.map(a=>this._createControl(a));return new dU(s,i,o)}_reduceControls(n){const i={};return Object.keys(n).forEach(o=>{i[o]=this._createControl(n[o])}),i}_createControl(n){return n instanceof rs||n instanceof ug?n:Array.isArray(n)?this.control(n[0],n.length>1?n[1]:null,n.length>2?n[2]:null):this.control(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Ige=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:g6,useValue:n.callSetDisabledState??Z7}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({imports:[fU]}),e})(),kge=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:$S,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:g6,useValue:n.callSetDisabledState??Z7}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({imports:[fU]}),e})();function H8(r,e){return En(e)?Z2(r,e,1):Z2(r,1)}function T3(r,e){return jr((t,n)=>{let i=0;t.subscribe(pr(n,o=>r.call(e,o,i++)&&n.next(o)))})}function tf(r){return jr((e,t)=>{try{e.subscribe(t)}finally{t.add(r)}})}class _g{}class vg{}class _c{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const i=t.slice(0,n),o=i.toLowerCase(),s=t.slice(n+1).trim();this.maybeSetNormalizedName(i,o),this.headers.has(o)?this.headers.get(o).push(s):this.headers.set(o,[s])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof _c?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new _c;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof _c?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":const o=e.value;if(o){let s=this.headers.get(t);if(!s)return;s=s.filter(a=>-1===o.indexOf(a)),0===s.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const n=(Array.isArray(t)?t:[t]).map(o=>o.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class xge{encodeKey(e){return pU(e)}encodeValue(e){return pU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Rge=/%(\d[a-f0-9])/gi,zge={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function pU(r){return encodeURIComponent(r).replace(Rge,(e,t)=>zge[t]??e)}function Cg(r){return`${r}`}class D4{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new xge,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Lge(r,e){const t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{const o=i.indexOf("="),[s,a]=-1==o?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,o)),e.decodeValue(i.slice(o+1))],c=t.get(s)||[];c.push(a),t.set(s,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],i=Array.isArray(n)?n.map(Cg):[Cg(n)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const i=e[n];Array.isArray(i)?i.forEach(o=>{t.push({param:n,value:o,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new D4({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Cg(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const i=n.indexOf(Cg(e.value));-1!==i&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Dge{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function gU(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function mU(r){return typeof Blob<"u"&&r instanceof Blob}function _U(r){return typeof FormData<"u"&&r instanceof FormData}class nf{constructor(e,t,n,i){let o;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Hge(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,o=i):o=n,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params)),this.headers||(this.headers=new _c),this.context||(this.context=new Dge),this.params){const s=this.params.toString();if(0===s.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+s}}else this.params=new D4,this.urlWithParams=t}serializeBody(){return null===this.body?null:gU(this.body)||mU(this.body)||_U(this.body)||function Vge(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof D4?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||_U(this.body)?null:mU(this.body)?this.body.type||null:gU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof D4?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,s=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,l=e.params||this.params;const f=e.context??this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((d,m)=>d.set(m,e.setHeaders[m]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((d,m)=>d.set(m,e.setParams[m]),l)),new nf(t,n,o,{params:l,headers:c,context:f,reportProgress:a,responseType:i,withCredentials:s})}}var V8=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(V8||{});class jS{constructor(e,t=200,n="OK"){this.headers=e.headers||new _c,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class ZS extends jS{constructor(e={}){super(e),this.type=V8.ResponseHeader}clone(e={}){return new ZS({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class F8 extends jS{constructor(e={}){super(e),this.type=V8.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new F8({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class vU extends jS{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function YS(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials}}let Fge=(()=>{var r;class e{constructor(n){this.handler=n}request(n,i,o={}){let s;if(n instanceof nf)s=n;else{let l,f;l=o.headers instanceof _c?o.headers:new _c(o.headers),o.params&&(f=o.params instanceof D4?o.params:new D4({fromObject:o.params})),s=new nf(n,i,void 0!==o.body?o.body:null,{headers:l,context:o.context,params:f,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials})}const a=Dt(s).pipe(H8(l=>this.handler.handle(l)));if(n instanceof nf||"events"===o.observe)return a;const c=a.pipe(T3(l=>l instanceof F8));switch(o.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return c.pipe(Wn(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(Wn(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(Wn(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return c.pipe(Wn(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:(new D4).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,o={}){return this.request("PATCH",n,YS(o,i))}post(n,i,o={}){return this.request("POST",n,YS(o,i))}put(n,i,o={}){return this.request("PUT",n,YS(o,i))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(_g))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();function MU(r,e){return e(r)}function Bge(r,e){return(t,n)=>e.intercept(t,{handle:i=>r(i,n)})}const Uge=new tt(""),rf=new tt(""),EU=new tt("");function Wge(){let r=null;return(e,t)=>{null===r&&(r=(rt(Uge,{optional:!0})??[]).reduceRight(Bge,MU));const n=rt(Hp),i=n.add();return r(e,t).pipe(tf(()=>n.remove(i)))}}let SU=(()=>{var r;class e extends _g{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=rt(Hp)}handle(n){if(null===this.chain){const o=Array.from(new Set([...this.injector.get(rf),...this.injector.get(EU,[])]));this.chain=o.reduceRight((s,a)=>function Gge(r,e,t){return(n,i)=>t.runInContext(()=>e(n,o=>r(o,i)))}(s,a,this.injector),MU)}const i=this.pendingTasks.add();return this.chain(n,o=>this.backend.handle(o)).pipe(tf(()=>this.pendingTasks.remove(i)))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(vg),Pe(Jo))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const Yge=/^\)\]\}',?\n/;let TU=(()=>{var r;class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new ge(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?r2(i.\u0275loadImpl()):Dt(null)).pipe(ca(()=>new T1(s=>{const a=i.build();if(a.open(n.method,n.urlWithParams),n.withCredentials&&(a.withCredentials=!0),n.headers.forEach((z,$)=>a.setRequestHeader(z,$.join(","))),n.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const z=n.detectContentTypeHeader();null!==z&&a.setRequestHeader("Content-Type",z)}if(n.responseType){const z=n.responseType.toLowerCase();a.responseType="json"!==z?z:"text"}const c=n.serializeBody();let l=null;const f=()=>{if(null!==l)return l;const z=a.statusText||"OK",$=new _c(a.getAllResponseHeaders()),B=function Kge(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}(a)||n.url;return l=new ZS({headers:$,status:a.status,statusText:z,url:B}),l},d=()=>{let{headers:z,status:$,statusText:B,url:de}=f(),_e=null;204!==$&&(_e=typeof a.response>"u"?a.responseText:a.response),0===$&&($=_e?200:0);let xe=$>=200&&$<300;if("json"===n.responseType&&"string"==typeof _e){const nt=_e;_e=_e.replace(Yge,"");try{_e=""!==_e?JSON.parse(_e):null}catch(gt){_e=nt,xe&&(xe=!1,_e={error:gt,text:_e})}}xe?(s.next(new F8({body:_e,headers:z,status:$,statusText:B,url:de||void 0})),s.complete()):s.error(new vU({error:_e,headers:z,status:$,statusText:B,url:de||void 0}))},m=z=>{const{url:$}=f(),B=new vU({error:z,status:a.status||0,statusText:a.statusText||"Unknown Error",url:$||void 0});s.error(B)};let E=!1;const w=z=>{E||(s.next(f()),E=!0);let $={type:V8.DownloadProgress,loaded:z.loaded};z.lengthComputable&&($.total=z.total),"text"===n.responseType&&a.responseText&&($.partialText=a.responseText),s.next($)},L=z=>{let $={type:V8.UploadProgress,loaded:z.loaded};z.lengthComputable&&($.total=z.total),s.next($)};return a.addEventListener("load",d),a.addEventListener("error",m),a.addEventListener("timeout",m),a.addEventListener("abort",m),n.reportProgress&&(a.addEventListener("progress",w),null!==c&&a.upload&&a.upload.addEventListener("progress",L)),a.send(c),s.next({type:V8.Sent}),()=>{a.removeEventListener("error",m),a.removeEventListener("abort",m),a.removeEventListener("load",d),a.removeEventListener("timeout",m),n.reportProgress&&(a.removeEventListener("progress",w),null!==c&&a.upload&&a.upload.removeEventListener("progress",L)),a.readyState!==a.DONE&&a.abort()}})))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(BB))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const KS=new tt("XSRF_ENABLED"),OU=new tt("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),bU=new tt("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class wU{}let Jge=(()=>{var r;class e{constructor(n,i,o){this.doc=n,this.platform=i,this.cookieName=o,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=kB(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(T2),Pe(p3),Pe(OU))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();function eme(r,e){const t=r.url.toLowerCase();if(!rt(KS)||"GET"===r.method||"HEAD"===r.method||t.startsWith("http://")||t.startsWith("https://"))return e(r);const n=rt(wU).getToken(),i=rt(bU);return null!=n&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,n)})),e(r)}var H4=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}(H4||{});function y6(r,e){return{\u0275kind:r,\u0275providers:e}}function tme(...r){const e=[Fge,TU,SU,{provide:_g,useExisting:SU},{provide:vg,useExisting:TU},{provide:rf,useValue:eme,multi:!0},{provide:KS,useValue:!0},{provide:wU,useClass:Jge}];for(const t of r)e.push(...t.\u0275providers);return function EM(r){return{\u0275providers:r}}(e)}const NU=new tt("LEGACY_INTERCEPTOR_FN");let rme=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({providers:[tme(y6(H4.LegacyInterceptors,[{provide:NU,useFactory:Wge},{provide:rf,useExisting:NU,multi:!0}]))]}),e})();function XS(...r){const e=Gu(r),t=$R(r),{args:n,keys:i}=dG(r);if(0===n.length)return r2([],e);const o=new T1(function ume(r,e,t=Ja){return n=>{AU(e,()=>{const{length:i}=r,o=new Array(i);let s=i,a=i;for(let c=0;c<i;c++)AU(e,()=>{const l=r2(r[c],e);let f=!1;l.subscribe(pr(n,d=>{o[c]=d,f||(f=!0,a--),a||n.next(t(o.slice()))},()=>{--s||n.complete()}))},n)},n)}}(n,e,i?s=>pG(i,s):Ja));return t?o.pipe(hG(t)):o}function AU(r,e,t){r?a3(t,r,e):e()}const Mg=Ps(r=>function(){r(this),this.name="EmptyError",this.message="no elements in sequence"});function QS(...r){return function fme(){return G0(1)}()(r2(r,Gu(r)))}function IU(r){return new T1(e=>{jo(r()).subscribe(e)})}function sf(r,e){const t=En(r)?r:()=>r,n=i=>i.error(t());return new T1(e?i=>e.schedule(n,0,i):n)}function JS(){return jr((r,e)=>{let t=null;r._refCount++;const n=pr(e,void 0,void 0,void 0,()=>{if(!r||r._refCount<=0||0<--r._refCount)return void(t=null);const i=r._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});r.subscribe(n),n.closed||(t=r.connect())})}class kU extends T1{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,ch(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Sn;const t=this.getSubject();e.add(this.source.subscribe(pr(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Sn.EMPTY)}return e}refCount(){return JS()(this)}}function $8(r){return r<=0?()=>ec:jr((e,t)=>{let n=0;e.subscribe(pr(t,i=>{++n<=r&&(t.next(i),r<=n&&t.complete())}))})}function Eg(r){return jr((e,t)=>{let n=!1;e.subscribe(pr(t,i=>{n=!0,t.next(i)},()=>{n||t.next(r),t.complete()}))})}function xU(r=hme){return jr((e,t)=>{let n=!1;e.subscribe(pr(t,i=>{n=!0,t.next(i)},()=>n?t.complete():t.error(r())))})}function hme(){return new Mg}function M6(r,e){const t=arguments.length>=2;return n=>n.pipe(r?T3((i,o)=>r(i,o,n)):Ja,$8(1),t?Eg(e):xU(()=>new Mg))}function wi(r,e,t){const n=En(r)||e||t?{next:r,error:e,complete:t}:r;return n?jr((i,o)=>{var s;null===(s=n.subscribe)||void 0===s||s.call(n);let a=!0;i.subscribe(pr(o,c=>{var l;null===(l=n.next)||void 0===l||l.call(n,c),o.next(c)},()=>{var c;a=!1,null===(c=n.complete)||void 0===c||c.call(n),o.complete()},c=>{var l;a=!1,null===(l=n.error)||void 0===l||l.call(n,c),o.error(c)},()=>{var c,l;a&&(null===(c=n.unsubscribe)||void 0===c||c.call(n)),null===(l=n.finalize)||void 0===l||l.call(n)}))}):Ja}function E6(r){return jr((e,t)=>{let o,n=null,i=!1;n=e.subscribe(pr(t,void 0,void 0,s=>{o=jo(r(s,E6(r)(e))),n?(n.unsubscribe(),n=null,o.subscribe(t)):i=!0})),i&&(n.unsubscribe(),n=null,o.subscribe(t))})}function eP(r){return r<=0?()=>ec:jr((e,t)=>{let n=[];e.subscribe(pr(t,i=>{n.push(i),r<n.length&&n.shift()},()=>{for(const i of n)t.next(i);t.complete()},void 0,()=>{n=null}))})}const nn="primary",af=Symbol("RouteTitle");class vme{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function B8(r){return new vme(r)}function Cme(r,e,t){const n=t.path.split("/");if(n.length>r.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<r.length))return null;const i={};for(let o=0;o<n.length;o++){const s=n[o],a=r[o];if(s.startsWith(":"))i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function vc(r,e){const t=r?Object.keys(r):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!LU(r[i],e[i]))return!1;return!0}function LU(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;const t=[...r].sort(),n=[...e].sort();return t.every((i,o)=>n[o]===i)}return r===e}function RU(r){return r.length>0?r[r.length-1]:null}function V4(r){return function lme(r){return!!r&&(r instanceof T1||En(r.lift)&&En(r.subscribe))}(r)?r:w7(r)?r2(Promise.resolve(r)):Dt(r)}const Mme={exact:function HU(r,e,t){if(!S6(r.segments,e.segments)||!Sg(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!r.children[n]||!HU(r.children[n],e.children[n],t))return!1;return!0},subset:VU},zU={exact:function Eme(r,e){return vc(r,e)},subset:function Sme(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>LU(r[t],e[t]))},ignored:()=>!0};function DU(r,e,t){return Mme[t.paths](r.root,e.root,t.matrixParams)&&zU[t.queryParams](r.queryParams,e.queryParams)&&!("exact"===t.fragment&&r.fragment!==e.fragment)}function VU(r,e,t){return FU(r,e,e.segments,t)}function FU(r,e,t,n){if(r.segments.length>t.length){const i=r.segments.slice(0,t.length);return!(!S6(i,t)||e.hasChildren()||!Sg(i,t,n))}if(r.segments.length===t.length){if(!S6(r.segments,t)||!Sg(r.segments,t,n))return!1;for(const i in e.children)if(!r.children[i]||!VU(r.children[i],e.children[i],n))return!1;return!0}{const i=t.slice(0,r.segments.length),o=t.slice(r.segments.length);return!!(S6(r.segments,i)&&Sg(r.segments,i,n)&&r.children[nn])&&FU(r.children[nn],e,o,n)}}function Sg(r,e,t){return e.every((n,i)=>zU[t](r[i].parameters,n.parameters))}class G8{constructor(e=new s1([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=B8(this.queryParams)),this._queryParamMap}toString(){return Ome.serialize(this)}}class s1{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Pg(this)}}class cf{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=B8(this.parameters)),this._parameterMap}toString(){return GU(this)}}function S6(r,e){return r.length===e.length&&r.every((t,n)=>t.path===e[n].path)}let lf=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return new tP},providedIn:"root"}),e})();class tP{parse(e){const t=new Dme(e);return new G8(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${uf(e.root,!0)}`,n=function Nme(r){const e=Object.keys(r).map(t=>{const n=r[t];return Array.isArray(n)?n.map(i=>`${Tg(t)}=${Tg(i)}`).join("&"):`${Tg(t)}=${Tg(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function bme(r){return encodeURI(r)}(e.fragment)}`:""}`}}const Ome=new tP;function Pg(r){return r.segments.map(e=>GU(e)).join("/")}function uf(r,e){if(!r.hasChildren())return Pg(r);if(e){const t=r.children[nn]?uf(r.children[nn],!1):"",n=[];return Object.entries(r.children).forEach(([i,o])=>{i!==nn&&n.push(`${i}:${uf(o,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function Tme(r,e){let t=[];return Object.entries(r.children).forEach(([n,i])=>{n===nn&&(t=t.concat(e(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==nn&&(t=t.concat(e(i,n)))}),t}(r,(n,i)=>i===nn?[uf(r.children[nn],!1)]:[`${i}:${uf(n,!1)}`]);return 1===Object.keys(r.children).length&&null!=r.children[nn]?`${Pg(r)}/${t[0]}`:`${Pg(r)}/(${t.join("//")})`}}function $U(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Tg(r){return $U(r).replace(/%3B/gi,";")}function nP(r){return $U(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Og(r){return decodeURIComponent(r)}function BU(r){return Og(r.replace(/\+/g,"%20"))}function GU(r){return`${nP(r.path)}${function wme(r){return Object.keys(r).map(e=>`;${nP(e)}=${nP(r[e])}`).join("")}(r.parameters)}`}const Ame=/^[^\/()?;#]+/;function rP(r){const e=r.match(Ame);return e?e[0]:""}const Ime=/^[^\/()?;=#]+/,xme=/^[^=?&#]+/,Rme=/^[^&#]+/;class Dme{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new s1([],{}):new s1([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[nn]=new s1(e,t)),n}parseSegment(){const e=rP(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ge(4009,!1);return this.capture(e),new cf(Og(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function kme(r){const e=r.match(Ime);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const i=rP(this.remaining);i&&(n=i,this.capture(n))}e[Og(t)]=Og(n)}parseQueryParam(e){const t=function Lme(r){const e=r.match(xme);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const s=function zme(r){const e=r.match(Rme);return e?e[0]:""}(this.remaining);s&&(n=s,this.capture(n))}const i=BU(t),o=BU(n);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=rP(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new ge(4010,!1);let o;n.indexOf(":")>-1?(o=n.slice(0,n.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=nn);const s=this.parseChildren();t[o]=1===Object.keys(s).length?s[nn]:new s1([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ge(4011,!1)}}function UU(r){return r.segments.length>0?new s1([],{[nn]:r}):r}function WU(r){const e={};for(const n of Object.keys(r.children)){const o=WU(r.children[n]);if(n===nn&&0===o.segments.length&&o.hasChildren())for(const[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[n]=o)}return function Hme(r){if(1===r.numberOfChildren&&r.children[nn]){const e=r.children[nn];return new s1(r.segments.concat(e.segments),e.children)}return r}(new s1(r.segments,e))}function P6(r){return r instanceof G8}function qU(r){let e;const i=UU(function t(o){const s={};for(const c of o.children){const l=t(c);s[c.outlet]=l}const a=new s1(o.url,s);return o===r&&(e=a),a}(r.root));return e??i}function jU(r,e,t,n){let i=r;for(;i.parent;)i=i.parent;if(0===e.length)return iP(i,i,i,t,n);const o=function Fme(r){if("string"==typeof r[0]&&1===r.length&&"/"===r[0])return new YU(!0,0,r);let e=0,t=!1;const n=r.reduce((i,o,s)=>{if("object"==typeof o&&null!=o){if(o.outlets){const a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return"string"!=typeof o?[...i,o]:0===s?(o.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,o]},[]);return new YU(t,e,n)}(e);if(o.toRoot())return iP(i,i,new s1([],{}),t,n);const s=function $me(r,e,t){if(r.isAbsolute)return new wg(e,!0,0);if(!t)return new wg(e,!1,NaN);if(null===t.parent)return new wg(t,!0,0);const n=bg(r.commands[0])?0:1;return function Bme(r,e,t){let n=r,i=e,o=t;for(;o>i;){if(o-=i,n=n.parent,!n)throw new ge(4005,!1);i=n.segments.length}return new wg(n,!1,i-o)}(t,t.segments.length-1+n,r.numberOfDoubleDots)}(o,i,r),a=s.processChildren?df(s.segmentGroup,s.index,o.commands):KU(s.segmentGroup,s.index,o.commands);return iP(i,s.segmentGroup,a,t,n)}function bg(r){return"object"==typeof r&&null!=r&&!r.outlets&&!r.segmentPath}function ff(r){return"object"==typeof r&&null!=r&&r.outlets}function iP(r,e,t,n,i){let s,o={};n&&Object.entries(n).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`}),s=r===e?t:ZU(r,e,t);const a=UU(WU(s));return new G8(a,o,i)}function ZU(r,e,t){const n={};return Object.entries(r.children).forEach(([i,o])=>{n[i]=o===e?t:ZU(o,e,t)}),new s1(r.segments,n)}class YU{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&bg(n[0]))throw new ge(4003,!1);const i=n.find(ff);if(i&&i!==RU(n))throw new ge(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class wg{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function KU(r,e,t){if(r||(r=new s1([],{})),0===r.segments.length&&r.hasChildren())return df(r,e,t);const n=function Ume(r,e,t){let n=0,i=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return o;const s=r.segments[i],a=t[n];if(ff(a))break;const c=`${a}`,l=n<t.length-1?t[n+1]:null;if(i>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!QU(c,l,s))return o;n+=2}else{if(!QU(c,{},s))return o;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){const o=new s1(r.segments.slice(0,n.pathIndex),{});return o.children[nn]=new s1(r.segments.slice(n.pathIndex),r.children),df(o,0,i)}return n.match&&0===i.length?new s1(r.segments,{}):n.match&&!r.hasChildren()?oP(r,e,t):n.match?df(r,0,i):oP(r,e,t)}function df(r,e,t){if(0===t.length)return new s1(r.segments,{});{const n=function Gme(r){return ff(r[0])?r[0].outlets:{[nn]:r}}(t),i={};if(!n[nn]&&r.children[nn]&&1===r.numberOfChildren&&0===r.children[nn].segments.length){const o=df(r.children[nn],e,t);return new s1(r.segments,o.children)}return Object.entries(n).forEach(([o,s])=>{"string"==typeof s&&(s=[s]),null!==s&&(i[o]=KU(r.children[o],e,s))}),Object.entries(r.children).forEach(([o,s])=>{void 0===n[o]&&(i[o]=s)}),new s1(r.segments,i)}}function oP(r,e,t){const n=r.segments.slice(0,e);let i=0;for(;i<t.length;){const o=t[i];if(ff(o)){const c=Wme(o.outlets);return new s1(n,c)}if(0===i&&bg(t[0])){n.push(new cf(r.segments[e].path,XU(t[0]))),i++;continue}const s=ff(o)?o.outlets[nn]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&bg(a)?(n.push(new cf(s,XU(a))),i+=2):(n.push(new cf(s,{})),i++)}return new s1(n,{})}function Wme(r){const e={};return Object.entries(r).forEach(([t,n])=>{"string"==typeof n&&(n=[n]),null!==n&&(e[t]=oP(new s1([],{}),0,n))}),e}function XU(r){const e={};return Object.entries(r).forEach(([t,n])=>e[t]=`${n}`),e}function QU(r,e,t){return r==t.path&&vc(e,t.parameters)}const hf="imperative";class Cc{constructor(e,t){this.id=e,this.url=t}}class sP extends Cc{constructor(e,t,n="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class F4 extends Cc{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Ng extends Cc{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class pf extends Cc{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=16}}class aP extends Cc{constructor(e,t,n,i){super(e,t),this.error=n,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class qme extends Cc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class jme extends Cc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zme extends Cc{constructor(e,t,n,i,o){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=o,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Yme extends Cc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Kme extends Cc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xme{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Qme{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Jme{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class e_e{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class t_e{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class n_e{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class JU{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class r_e{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new gf,this.attachRef=null}}let gf=(()=>{var r;class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){const o=this.getOrCreateContext(n);o.outlet=i,this.contexts.set(n,o)}onChildOutletDestroyed(n){const i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new r_e,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class eW{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=cP(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=cP(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=lP(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return lP(e,this._root).map(t=>t.value)}}function cP(r,e){if(r===e.value)return e;for(const t of e.children){const n=cP(r,t);if(n)return n}return null}function lP(r,e){if(r===e.value)return[e];for(const t of e.children){const n=lP(r,t);if(n.length)return n.unshift(e),n}return[]}class O3{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function U8(r){const e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}class tW extends eW{constructor(e,t){super(e),this.snapshot=t,uP(this,e)}toString(){return this.snapshot.toString()}}function nW(r,e){const t=function i_e(r,e){const s=new Ag([],{},{},"",{},nn,e,null,{});return new iW("",new O3(s,[]))}(0,e),n=new Yi([new cf("",{})]),i=new Yi({}),o=new Yi({}),s=new Yi({}),a=new Yi(""),c=new xo(n,i,s,a,o,nn,e,t.root);return c.snapshot=t.root,new tW(new O3(c,[]),t)}class xo{constructor(e,t,n,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Wn(l=>l[af]))??Dt(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Wn(e=>B8(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Wn(e=>B8(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function rW(r,e="emptyOnly"){const t=r.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const i=t[n],o=t[n-1];if(i.routeConfig&&""===i.routeConfig.path)n--;else{if(o.component)break;n--}}return function o_e(r){return r.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class Ag{get title(){return this.data?.[af]}constructor(e,t,n,i,o,s,a,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=B8(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=B8(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class iW extends eW{constructor(e,t){super(t),this.url=e,uP(this,t)}toString(){return oW(this._root)}}function uP(r,e){e.value._routerState=r,e.children.forEach(t=>uP(r,t))}function oW(r){const e=r.children.length>0?` { ${r.children.map(oW).join(", ")} } `:"";return`${r.value}${e}`}function fP(r){if(r.snapshot){const e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,vc(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),vc(e.params,t.params)||r.paramsSubject.next(t.params),function yme(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!vc(r[t],e[t]))return!1;return!0}(e.url,t.url)||r.urlSubject.next(t.url),vc(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function dP(r,e){const t=vc(r.params,e.params)&&function Pme(r,e){return S6(r,e)&&r.every((t,n)=>vc(t.parameters,e[n].parameters))}(r.url,e.url);return t&&!(!r.parent!=!e.parent)&&(!r.parent||dP(r.parent,e.parent))}let hP=(()=>{var r;class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=nn,this.activateEvents=new N1,this.deactivateEvents=new N1,this.attachEvents=new N1,this.detachEvents=new N1,this.parentContexts=rt(gf),this.location=rt(ts),this.changeDetector=rt(y3),this.environmentInjector=rt(Jo),this.inputBinder=rt(Ig,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:i,previousValue:o}=n.name;if(i)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ge(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ge(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ge(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new ge(4013,!1);this._activatedRoute=n;const o=this.location,a=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new s_e(n,c,o.injector);this.activated=o.createComponent(a,{index:o.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Xi]}),e})();class s_e{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===xo?this.route:e===gf?this.childContexts:this.parent.get(e,t)}}const Ig=new tt("");let sW=(()=>{var r;class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:i}=n,o=XS([i.queryParams,i.params,i.data]).pipe(ca(([s,a,c],l)=>(c={...s,...a,...c},0===l?Dt(c):Promise.resolve(c)))).subscribe(s=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(n);const a=function lde(r){const e=Rn(r);if(!e)return null;const t=new S7(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(a)for(const{templateName:c}of a.inputs)n.activatedComponentRef.setInput(c,s[c]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,o)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();function mf(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const i=function c_e(r,e,t){return e.children.map(n=>{for(const i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return mf(r,n,i);return mf(r,n)})}(r,e,t);return new O3(n,i)}{if(r.shouldAttach(e.value)){const o=r.retrieve(e.value);if(null!==o){const s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>mf(r,a)),s}}const n=function l_e(r){return new xo(new Yi(r.url),new Yi(r.params),new Yi(r.queryParams),new Yi(r.fragment),new Yi(r.data),r.outlet,r.component,r)}(e.value),i=e.children.map(o=>mf(r,o));return new O3(n,i)}}const pP="ngNavigationCancelingError";function aW(r,e){const{redirectTo:t,navigationBehaviorOptions:n}=P6(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=cW(!1,0,e);return i.url=t,i.navigationBehaviorOptions=n,i}function cW(r,e,t){const n=new Error("NavigationCancelingError: "+(r||""));return n[pP]=!0,n.cancellationCode=e,t&&(n.url=t),n}function lW(r){return uW(r)&&P6(r.url)}function uW(r){return r&&r[pP]}let fW=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275cmp=je({type:r,selectors:[["ng-component"]],standalone:!0,features:[GF],decls:1,vars:0,template:function(n,i){1&n&&F(0,"router-outlet")},dependencies:[hP],encapsulation:2}),e})();function gP(r){const e=r.children&&r.children.map(gP),t=e?{...r,children:e}:{...r};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==nn&&(t.component=fW),t}function va(r){return r.outlet||nn}function _f(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class m_e{constructor(e,t,n,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),fP(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const i=U8(t);e.children.forEach(o=>{const s=o.value.outlet;this.deactivateRoutes(o,i[s],n),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,n)})}deactivateRoutes(e,t,n){const i=e.value,o=t?t.value:null;if(i===o)if(i.component){const s=n.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,n);else o&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,o=U8(e);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],i);if(n&&n.outlet){const s=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,o=U8(e);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){const i=U8(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],n),this.forwardEvent(new n_e(o.value.snapshot))}),e.children.length&&this.forwardEvent(new e_e(e.value.snapshot))}activateRoutes(e,t,n){const i=e.value,o=t?t.value:null;if(fP(i),i===o)if(i.component){const s=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,n);else if(i.component){const s=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),fP(a.route.value),this.activateChildRoutes(e,null,s.children)}else{const a=_f(i.snapshot);s.attachRef=null,s.route=i,s.injector=a,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}}else this.activateChildRoutes(e,null,n)}}class dW{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class kg{constructor(e,t){this.component=e,this.route=t}}function __e(r,e,t){const n=r._root;return vf(n,e?e._root:null,t,[n.value])}function W8(r,e){const t=Symbol(),n=e.get(r,t);return n===t?"function"!=typeof r||function N4e(r){return null!==ph(r)}(r)?e.get(r):r:n}function vf(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=U8(e);return r.children.forEach(s=>{(function C_e(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const o=r.value,s=e?e.value:null,a=t?t.getContext(r.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const c=function y_e(r,e,t){if("function"==typeof t)return t(r,e);switch(t){case"pathParamsChange":return!S6(r.url,e.url);case"pathParamsOrQueryParamsChange":return!S6(r.url,e.url)||!vc(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!dP(r,e)||!vc(r.queryParams,e.queryParams);default:return!dP(r,e)}}(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new dW(n)):(o.data=s.data,o._resolvedData=s._resolvedData),vf(r,e,o.component?a?a.children:null:t,n,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new kg(a.outlet.component,s))}else s&&Cf(e,a,i),i.canActivateChecks.push(new dW(n)),vf(r,null,o.component?a?a.children:null:t,n,i)})(s,o[s.value.outlet],t,n.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Cf(a,t.getContext(s),i)),i}function Cf(r,e,t){const n=U8(r),i=r.value;Object.entries(n).forEach(([o,s])=>{Cf(s,i.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new kg(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function yf(r){return"function"==typeof r}function hW(r){return r instanceof Mg||"EmptyError"===r?.name}const xg=Symbol("INITIAL_VALUE");function q8(){return ca(r=>XS(r.map(e=>e.pipe($8(1),function dme(...r){const e=Gu(r);return jr((t,n)=>{(e?QS(r,t,e):QS(r,t)).subscribe(n)})}(xg)))).pipe(Wn(e=>{for(const t of e)if(!0!==t){if(t===xg)return xg;if(!1===t||t instanceof G8)return t}return!0}),T3(e=>e!==xg),$8(1)))}function pW(r){return function ih(...r){return oh(r)}(wi(e=>{if(P6(e))throw aW(0,e)}),Wn(e=>!0===e))}class Lg{constructor(e){this.segmentGroup=e||null}}class gW{constructor(e){this.urlTree=e}}function j8(r){return sf(new Lg(r))}function mW(r){return sf(new gW(r))}class F_e{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new ge(4002,!1)}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return Dt(n);if(i.numberOfChildren>1||!i.children[nn])return sf(new ge(4e3,!1));i=i.children[nn]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,i){const o=this.createSegmentGroup(e,t.root,n,i);return new G8(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Object.entries(e).forEach(([i,o])=>{if("string"==typeof o&&o.startsWith(":")){const a=o.substring(1);n[i]=t[a]}else n[i]=o}),n}createSegmentGroup(e,t,n,i){const o=this.createSegments(e,t.segments,n,i);let s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,n,i)}),new s1(o,s)}createSegments(e,t,n,i){return t.map(o=>o.path.startsWith(":")?this.findPosParam(e,o,i):this.findOrReturn(o,n))}findPosParam(e,t,n){const i=n[t.path.substring(1)];if(!i)throw new ge(4001,!1);return i}findOrReturn(e,t){let n=0;for(const i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}}const mP={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function $_e(r,e,t,n,i){const o=_P(r,e,t);return o.matched?(n=function u_e(r,e){return r.providers&&!r._injector&&(r._injector=EE(r.providers,e,`Route: ${r.path}`)),r._injector??e}(e,n),function D_e(r,e,t,n){const i=e.canMatch;return i&&0!==i.length?Dt(i.map(s=>{const a=W8(s,r);return V4(function O_e(r){return r&&yf(r.canMatch)}(a)?a.canMatch(e,t):r.runInContext(()=>a(e,t)))})).pipe(q8(),pW()):Dt(!0)}(n,e,t).pipe(Wn(s=>!0===s?o:{...mP}))):Dt(o)}function _P(r,e,t){if(""===e.path)return"full"===e.pathMatch&&(r.hasChildren()||t.length>0)?{...mP}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||Cme)(t,r,e);if(!i)return{...mP};const o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});const s=i.consumed.length>0?{...o,...i.consumed[i.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function _W(r,e,t,n){return t.length>0&&function U_e(r,e,t){return t.some(n=>Rg(r,e,n)&&va(n)!==nn)}(r,t,n)?{segmentGroup:new s1(e,G_e(n,new s1(t,r.children))),slicedSegments:[]}:0===t.length&&function W_e(r,e,t){return t.some(n=>Rg(r,e,n))}(r,t,n)?{segmentGroup:new s1(r.segments,B_e(r,0,t,n,r.children)),slicedSegments:t}:{segmentGroup:new s1(r.segments,r.children),slicedSegments:t}}function B_e(r,e,t,n,i){const o={};for(const s of n)if(Rg(r,t,s)&&!i[va(s)]){const a=new s1([],{});o[va(s)]=a}return{...i,...o}}function G_e(r,e){const t={};t[nn]=e;for(const n of r)if(""===n.path&&va(n)!==nn){const i=new s1([],{});t[va(n)]=i}return t}function Rg(r,e,t){return(!(r.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class Y_e{constructor(e,t,n,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new F_e(this.urlSerializer,this.urlTree)}noMatchError(e){return new ge(4002,!1)}recognize(){const e=_W(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,nn).pipe(E6(t=>{if(t instanceof gW)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof Lg?this.noMatchError(t):t}),Wn(t=>{const n=new Ag([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},nn,this.rootComponentType,null,{}),i=new O3(n,t),o=new iW("",i),s=function Vme(r,e,t=null,n=null){return jU(qU(r),e,t,n)}(n,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),this.inheritParamsAndData(o._root),{state:o,tree:s}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,nn).pipe(E6(n=>{throw n instanceof Lg?this.noMatchError(n):n}))}inheritParamsAndData(e){const t=e.value,n=rW(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,i,!0)}processChildren(e,t,n){const i=[];for(const o of Object.keys(n.children))"primary"===o?i.unshift(o):i.push(o);return r2(i).pipe(H8(o=>{const s=n.children[o],a=function p_e(r,e){const t=r.filter(n=>va(n)===e);return t.push(...r.filter(n=>va(n)!==e)),t}(t,o);return this.processSegmentGroup(e,a,s,o)}),function gme(r,e){return jr(function pme(r,e,t,n,i){return(o,s)=>{let a=t,c=e,l=0;o.subscribe(pr(s,f=>{const d=l++;c=a?r(c,f,d):(a=!0,f),n&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}(r,e,arguments.length>=2,!0))}((o,s)=>(o.push(...s),o)),Eg(null),function mme(r,e){const t=arguments.length>=2;return n=>n.pipe(r?T3((i,o)=>r(i,o,n)):Ja,eP(1),t?Eg(e):xU(()=>new Mg))}(),Z2(o=>{if(null===o)return j8(n);const s=vW(o);return function K_e(r){r.sort((e,t)=>e.value.outlet===nn?-1:t.value.outlet===nn?1:e.value.outlet.localeCompare(t.value.outlet))}(s),Dt(s)}))}processSegment(e,t,n,i,o,s){return r2(t).pipe(H8(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,n,i,o,s).pipe(E6(c=>{if(c instanceof Lg)return Dt(null);throw c}))),M6(a=>!!a),E6(a=>{if(hW(a))return function j_e(r,e,t){return 0===e.length&&!r.children[t]}(n,i,o)?Dt([]):j8(n);throw a}))}processSegmentAgainstRoute(e,t,n,i,o,s,a){return function q_e(r,e,t,n){return!!(va(r)===n||n!==nn&&Rg(e,t,r))&&("**"===r.path||_P(e,r,t).matched)}(n,i,o,s)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,i,n,o,s,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,n,o,s):j8(i):j8(i)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,o,s){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,i,s):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,o,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,i){const o=this.applyRedirects.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?mW(o):this.applyRedirects.lineralizeSegments(n,o).pipe(Z2(s=>{const a=new s1(s,{});return this.processSegment(e,t,a,s,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,o,s){const{matched:a,consumedSegments:c,remainingSegments:l,positionalParamSegments:f}=_P(t,i,o);if(!a)return j8(t);const d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,f);return i.redirectTo.startsWith("/")?mW(d):this.applyRedirects.lineralizeSegments(i,d).pipe(Z2(m=>this.processSegment(e,n,t,m.concat(l),s,!1)))}matchSegmentAgainstRoute(e,t,n,i,o,s){let a;if("**"===n.path){const c=i.length>0?RU(i).parameters:{};a=Dt({snapshot:new Ag(i,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,CW(n),va(n),n.component??n._loadedComponent??null,n,yW(n)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=$_e(t,n,i,e).pipe(Wn(({matched:c,consumedSegments:l,remainingSegments:f,parameters:d})=>c?{snapshot:new Ag(l,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,CW(n),va(n),n.component??n._loadedComponent??null,n,yW(n)),consumedSegments:l,remainingSegments:f}:null));return a.pipe(ca(c=>null===c?j8(t):this.getChildConfig(e=n._injector??e,n,i).pipe(ca(({routes:l})=>{const f=n._loadedInjector??e,{snapshot:d,consumedSegments:m,remainingSegments:E}=c,{segmentGroup:w,slicedSegments:L}=_W(t,m,E,l);if(0===L.length&&w.hasChildren())return this.processChildren(f,l,w).pipe(Wn($=>null===$?null:[new O3(d,$)]));if(0===l.length&&0===L.length)return Dt([new O3(d,[])]);const z=va(n)===o;return this.processSegment(f,l,w,L,z?nn:o,!0).pipe(Wn($=>[new O3(d,$)]))}))))}getChildConfig(e,t,n){return t.children?Dt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Dt({routes:t._loadedRoutes,injector:t._loadedInjector}):function z_e(r,e,t,n){const i=e.canLoad;return void 0===i||0===i.length?Dt(!0):Dt(i.map(s=>{const a=W8(s,r);return V4(function E_e(r){return r&&yf(r.canLoad)}(a)?a.canLoad(e,t):r.runInContext(()=>a(e,t)))})).pipe(q8(),pW())}(e,t,n).pipe(Z2(i=>i?this.configLoader.loadChildren(e,t).pipe(wi(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):function V_e(r){return sf(cW(!1,3))}())):Dt({routes:[],injector:e})}}function X_e(r){const e=r.value.routeConfig;return e&&""===e.path}function vW(r){const e=[],t=new Set;for(const n of r){if(!X_e(n)){e.push(n);continue}const i=e.find(o=>n.value.routeConfig===o.value.routeConfig);void 0!==i?(i.children.push(...n.children),t.add(i)):e.push(n)}for(const n of t){const i=vW(n.children);e.push(new O3(n.value,i))}return e.filter(n=>!t.has(n))}function CW(r){return r.data||{}}function yW(r){return r.resolve||{}}function MW(r){return"string"==typeof r.title||null===r.title}function vP(r){return ca(e=>{const t=r(e);return t?r2(t).pipe(Wn(()=>e)):Dt(e)})}const Z8=new tt("ROUTES");let CP=(()=>{var r;class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=rt(L$)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Dt(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const i=V4(n.loadComponent()).pipe(Wn(EW),wi(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),tf(()=>{this.componentLoaders.delete(n)})),o=new kU(i,()=>new So).pipe(JS());return this.componentLoaders.set(n,o),o}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Dt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(Wn(c=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,f;return Array.isArray(c)?f=c:(l=c.create(n).injector,f=l.get(Z8,[],cn.Self|cn.Optional).flat()),{routes:f.map(gP),injector:l}}),tf(()=>{this.childrenLoaders.delete(i)})),a=new kU(s,()=>new So).pipe(JS());return this.childrenLoaders.set(i,a),a}loadModuleFactoryOrRoutes(n){return V4(n()).pipe(Wn(EW),Z2(i=>i instanceof $F||Array.isArray(i)?Dt(i):r2(this.compiler.compileModuleAsync(i))))}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function EW(r){return function ive(r){return r&&"object"==typeof r&&"default"in r}(r)?r.default:r}let zg=(()=>{var r;class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new So,this.configLoader=rt(CP),this.environmentInjector=rt(Jo),this.urlSerializer=rt(lf),this.rootContexts=rt(gf),this.inputBindingEnabled=null!==rt(Ig,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Dt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=o=>this.events.next(new Qme(o)),this.configLoader.onLoadStartListener=o=>this.events.next(new Xme(o))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:i})}setupNavigations(n){return this.transitions=new Yi({id:0,currentUrlTree:n.currentUrlTree,currentRawUrl:n.currentUrlTree,extractedUrl:n.urlHandlingStrategy.extract(n.currentUrlTree),urlAfterRedirects:n.urlHandlingStrategy.extract(n.currentUrlTree),rawUrl:n.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:hf,restoredState:null,currentSnapshot:n.routerState.snapshot,targetSnapshot:null,currentRouterState:n.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(T3(i=>0!==i.id),Wn(i=>({...i,extractedUrl:n.urlHandlingStrategy.extract(i.rawUrl)})),ca(i=>{let o=!1,s=!1;return Dt(i).pipe(wi(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ca(a=>{const c=n.browserUrlTree.toString(),l=!n.navigated||a.extractedUrl.toString()!==c||c!==n.currentUrlTree.toString();if(!l&&"reload"!==(a.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const d="";return this.events.next(new pf(a.id,n.serializeUrl(i.rawUrl),d,0)),n.rawUrlTree=a.rawUrl,a.resolve(null),ec}if(n.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return SW(a.source)&&(n.browserUrlTree=a.extractedUrl),Dt(a).pipe(ca(d=>{const m=this.transitions?.getValue();return this.events.next(new sP(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),m!==this.transitions?.getValue()?ec:Promise.resolve(d)}),function Q_e(r,e,t,n,i,o){return Z2(s=>function Z_e(r,e,t,n,i,o,s="emptyOnly"){return new Y_e(r,e,t,n,i,s,o).recognize()}(r,e,t,n,s.extractedUrl,i,o).pipe(Wn(({state:a,tree:c})=>({...s,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,n.paramsInheritanceStrategy),wi(d=>{if(i.targetSnapshot=d.targetSnapshot,i.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects},"eager"===n.urlUpdateStrategy){if(!d.extras.skipLocationChange){const E=n.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);n.setBrowserUrl(E,d)}n.browserUrlTree=d.urlAfterRedirects}const m=new qme(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(m)}));if(l&&n.urlHandlingStrategy.shouldProcessUrl(n.rawUrlTree)){const{id:d,extractedUrl:m,source:E,restoredState:w,extras:L}=a,z=new sP(d,this.urlSerializer.serialize(m),E,w);this.events.next(z);const $=nW(0,this.rootComponentType).snapshot;return Dt(i={...a,targetSnapshot:$,urlAfterRedirects:m,extras:{...L,skipLocationChange:!1,replaceUrl:!1}})}{const d="";return this.events.next(new pf(a.id,n.serializeUrl(i.extractedUrl),d,1)),n.rawUrlTree=a.rawUrl,a.resolve(null),ec}}),wi(a=>{const c=new jme(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),Wn(a=>i={...a,guards:__e(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function w_e(r,e){return Z2(t=>{const{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return 0===s.length&&0===o.length?Dt({...t,guardsResult:!0}):function N_e(r,e,t,n){return r2(r).pipe(Z2(i=>function R_e(r,e,t,n,i){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?Dt(o.map(a=>{const c=_f(e)??i,l=W8(a,c);return V4(function T_e(r){return r&&yf(r.canDeactivate)}(l)?l.canDeactivate(r,e,t,n):c.runInContext(()=>l(r,e,t,n))).pipe(M6())})).pipe(q8()):Dt(!0)}(i.component,i.route,t,e,n)),M6(i=>!0!==i,!0))}(s,n,i,r).pipe(Z2(a=>a&&function M_e(r){return"boolean"==typeof r}(a)?function A_e(r,e,t,n){return r2(e).pipe(H8(i=>QS(function k_e(r,e){return null!==r&&e&&e(new Jme(r)),Dt(!0)}(i.route.parent,n),function I_e(r,e){return null!==r&&e&&e(new t_e(r)),Dt(!0)}(i.route,n),function L_e(r,e,t){const n=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>function v_e(r){const e=r.routeConfig?r.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:r,guards:e}:null}(s)).filter(s=>null!==s).map(s=>IU(()=>Dt(s.guards.map(c=>{const l=_f(s.node)??t,f=W8(c,l);return V4(function P_e(r){return r&&yf(r.canActivateChild)}(f)?f.canActivateChild(n,r):l.runInContext(()=>f(n,r))).pipe(M6())})).pipe(q8())));return Dt(o).pipe(q8())}(r,i.path,t),function x_e(r,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Dt(!0);const i=n.map(o=>IU(()=>{const s=_f(e)??t,a=W8(o,s);return V4(function S_e(r){return r&&yf(r.canActivate)}(a)?a.canActivate(e,r):s.runInContext(()=>a(e,r))).pipe(M6())}));return Dt(i).pipe(q8())}(r,i.route,t))),M6(i=>!0!==i,!0))}(n,o,r,e):Dt(a)),Wn(a=>({...t,guardsResult:a})))})}(this.environmentInjector,a=>this.events.next(a)),wi(a=>{if(i.guardsResult=a.guardsResult,P6(a.guardsResult))throw aW(0,a.guardsResult);const c=new Zme(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.events.next(c)}),T3(a=>!!a.guardsResult||(n.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),vP(a=>{if(a.guards.canActivateChecks.length)return Dt(a).pipe(wi(c=>{const l=new Yme(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),ca(c=>{let l=!1;return Dt(c).pipe(function J_e(r,e){return Z2(t=>{const{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return Dt(t);let o=0;return r2(i).pipe(H8(s=>function eve(r,e,t,n){const i=r.routeConfig,o=r._resolve;return void 0!==i?.title&&!MW(i)&&(o[af]=i.title),function tve(r,e,t,n){const i=function nve(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}(r);if(0===i.length)return Dt({});const o={};return r2(i).pipe(Z2(s=>function rve(r,e,t,n){const i=_f(e)??n,o=W8(r,i);return V4(o.resolve?o.resolve(e,t):i.runInContext(()=>o(e,t)))}(r[s],e,t,n).pipe(M6(),wi(a=>{o[s]=a}))),eP(1),function _me(r){return Wn(()=>r)}(o),E6(s=>hW(s)?ec:sf(s)))}(o,r,e,n).pipe(Wn(s=>(r._resolvedData=s,r.data=rW(r,t).resolve,i&&MW(i)&&(r.data[af]=i.title),null)))}(s.route,n,r,e)),wi(()=>o++),eP(1),Z2(s=>o===i.length?Dt(t):ec))})}(n.paramsInheritanceStrategy,this.environmentInjector),wi({next:()=>l=!0,complete:()=>{l||(n.restoreHistory(c),this.cancelNavigationTransition(c,"",2))}}))}),wi(c=>{const l=new Kme(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}))}),vP(a=>{const c=l=>{const f=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(l.routeConfig).pipe(wi(d=>{l.component=d}),Wn(()=>{})));for(const d of l.children)f.push(...c(d));return f};return XS(c(a.targetSnapshot.root)).pipe(Eg(),$8(1))}),vP(()=>this.afterPreactivation()),Wn(a=>{const c=function a_e(r,e,t){const n=mf(r,e._root,t?t._root:void 0);return new tW(n,e)}(n.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return i={...a,targetRouterState:c}}),wi(a=>{n.currentUrlTree=a.urlAfterRedirects,n.rawUrlTree=n.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),n.routerState=a.targetRouterState,"deferred"===n.urlUpdateStrategy&&(a.extras.skipLocationChange||n.setBrowserUrl(n.rawUrlTree,a),n.browserUrlTree=a.urlAfterRedirects)}),((r,e,t,n)=>Wn(i=>(new m_e(e,i.targetRouterState,i.currentRouterState,t,n).activate(r),i)))(this.rootContexts,n.routeReuseStrategy,a=>this.events.next(a),this.inputBindingEnabled),$8(1),wi({next:a=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,n.navigated=!0,this.events.next(new F4(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(n.currentUrlTree))),n.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)},complete:()=>{o=!0}}),tf(()=>{o||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),E6(a=>{if(s=!0,uW(a)){lW(a)||(n.navigated=!0,n.restoreHistory(i,!0));const c=new Ng(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode);if(this.events.next(c),lW(a)){const l=n.urlHandlingStrategy.merge(a.url,n.rawUrlTree),f={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===n.urlUpdateStrategy||SW(i.source)};n.scheduleNavigation(l,hf,null,f,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{n.restoreHistory(i,!0);const c=new aP(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);this.events.next(c);try{i.resolve(n.errorHandler(a))}catch(l){i.reject(l)}}return ec}))}))}cancelNavigationTransition(n,i,o){const s=new Ng(n.id,this.urlSerializer.serialize(n.extractedUrl),i,o);this.events.next(s),n.resolve(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function SW(r){return r!==hf}let PW=(()=>{var r;class e{buildTitle(n){let i,o=n.root;for(;void 0!==o;)i=this.getResolvedTitleForRoute(o)??i,o=o.children.find(s=>s.outlet===nn);return i}getResolvedTitleForRoute(n){return n.data[af]}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return rt(ove)},providedIn:"root"}),e})(),ove=(()=>{var r;class e extends PW{constructor(n){super(),this.title=n}updateTitle(n){const i=this.buildTitle(n);void 0!==i&&this.title.setTitle(i)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(sG))},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),sve=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return rt(cve)},providedIn:"root"}),e})();class ave{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let cve=(()=>{var r;class e extends ave{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}(),r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const Dg=new tt("",{providedIn:"root",factory:()=>({})});let lve=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:function(){return rt(uve)},providedIn:"root"}),e})(),uve=(()=>{var r;class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();var Mf=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(Mf||{});function TW(r,e){r.events.pipe(T3(t=>t instanceof F4||t instanceof Ng||t instanceof aP||t instanceof pf),Wn(t=>t instanceof F4||t instanceof pf?Mf.COMPLETE:t instanceof Ng&&(0===t.code||1===t.code)?Mf.REDIRECTING:Mf.FAILED),T3(t=>t!==Mf.REDIRECTING),$8(1)).subscribe(()=>{e()})}function fve(r){throw r}function dve(r,e,t){return e.parse("/")}const hve={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},pve={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Gn=(()=>{var r;class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=rt(x$),this.isNgZoneEnabled=!1,this.options=rt(Dg,{optional:!0})||{},this.pendingTasks=rt(Hp),this.errorHandler=this.options.errorHandler||fve,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||dve,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=rt(lve),this.routeReuseStrategy=rt(sve),this.titleStrategy=rt(PW),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=rt(Z8,{optional:!0})?.flat()??[],this.navigationTransitions=rt(zg),this.urlSerializer=rt(lf),this.location=rt(rS),this.componentInputBindingEnabled=!!rt(Ig,{optional:!0}),this.isNgZoneEnabled=rt(o1)instanceof o1&&o1.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new G8,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=nW(0,null),this.navigationTransitions.setupNavigations(this).subscribe(n=>{this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId??0},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const n=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),hf,n)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i="popstate"===n.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(n.url,i,n.state)},0)}))}navigateToSyncWithBrowser(n,i,o){const s={replaceUrl:!0},a=o?.navigationId?o:null;if(o){const l={...o};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const c=this.parseUrl(n);this.scheduleNavigation(c,i,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(gP),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,i={}){const{relativeTo:o,queryParams:s,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,f=l?this.currentUrlTree.fragment:a;let m,d=null;switch(c){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}null!==d&&(d=this.removeEmptyProps(d));try{m=qU(o?o.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),m=this.currentUrlTree.root}return jU(m,n,d,f??null)}navigateByUrl(n,i={skipLocationChange:!1}){const o=P6(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(s,hf,null,i)}navigate(n,i={skipLocationChange:!1}){return function gve(r){for(let e=0;e<r.length;e++)if(null==r[e])throw new ge(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(o){i=this.malformedUriErrorHandler(o,this.urlSerializer,n)}return i}isActive(n,i){let o;if(o=!0===i?{...hve}:!1===i?{...pve}:i,P6(n))return DU(this.currentUrlTree,n,o);const s=this.parseUrl(n);return DU(this.currentUrlTree,s,o)}removeEmptyProps(n){return Object.keys(n).reduce((i,o)=>{const s=n[o];return null!=s&&(i[o]=s),i},{})}scheduleNavigation(n,i,o,s,a){if(this.disposed)return Promise.resolve(!1);let c,l,f;a?(c=a.resolve,l=a.reject,f=a.promise):f=new Promise((m,E)=>{c=m,l=E});const d=this.pendingTasks.add();return TW(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:s,resolve:c,reject:l,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(m=>Promise.reject(m))}setBrowserUrl(n,i){const o=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(o)||i.extras.replaceUrl){const a={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(o,"",a)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,(this.browserPageId??0)+1)};this.location.go(o,"",s)}}restoreHistory(n,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-(this.browserPageId??this.currentPageId);0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),yc=(()=>{var r;class e{constructor(n,i,o,s,a,c){this.router=n,this.route=i,this.tabIndexAttribute=o,this.renderer=s,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new So,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=n.events.subscribe(f=>{f instanceof F4&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,o,s,a){return!!(null===this.urlTree||this.isAnchorElement&&(0!==n||i||o||s||a||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const n=null===this.href?null:function eH(r,e,t){return function z0e(r,e){return"src"===e&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===e&&("base"===r||"link"===r)?JD:ip}(e,t)(r)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(n,i){const o=this.renderer,s=this.el.nativeElement;null!==i?o.setAttribute(s,n,i):o.removeAttribute(s,n)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Gn),G(xo),function Hh(r){return function Jle(r,e){if("class"===e)return r.classes;if("style"===e)return r.styles;const t=r.attrs;if(t){const n=t.length;let i=0;for(;i<n;){const o=t[i];if(tz(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<n&&"string"==typeof t[i];)i++;else{if(o===e)return t[i+1];i+=2}}}return null}(Q2(),r)}("tabindex"),G(lc),G(Pi),G(d6))},r.\u0275dir=Rt({type:r,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,i){1&n&&U("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&n&&k("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",L8],skipLocationChange:["skipLocationChange","skipLocationChange",L8],replaceUrl:["replaceUrl","replaceUrl",L8],routerLink:"routerLink"},standalone:!0,features:[cV,Xi]}),e})();class OW{}let vve=(()=>{var r;class e{constructor(n,i,o,s,a){this.router=n,this.injector=o,this.preloadingStrategy=s,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(T3(n=>n instanceof F4),H8(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const o=[];for(const s of i){s.providers&&!s._injector&&(s._injector=EE(s.providers,n,`Route: ${s.path}`));const a=s._injector??n,c=s._loadedInjector??a;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&o.push(this.preloadConfig(a,s)),(s.children||s._loadedRoutes)&&o.push(this.processRoutes(c,s.children??s._loadedRoutes))}return r2(o).pipe(G0())}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>{let o;o=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(n,i):Dt(null);const s=o.pipe(Z2(a=>null===a?Dt(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??n,a.routes))));return i.loadComponent&&!i._loadedComponent?r2([s,this.loader.loadComponent(i)]).pipe(G0()):s})}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(Gn),Pe(L$),Pe(Jo),Pe(OW),Pe(CP))},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const yP=new tt("");let bW=(()=>{var r;class e{constructor(n,i,o,s,a={}){this.urlSerializer=n,this.transitions=i,this.viewportScroller=o,this.zone=s,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof sP?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof F4?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof pf&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof JU&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new JU(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){!function zH(){throw new Error("invalid")}()},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();function b3(r,e){return{\u0275kind:r,\u0275providers:e}}function NW(){const r=rt(J2);return e=>{const t=r.get(u6);if(e!==t.components[0])return;const n=r.get(Gn),i=r.get(AW);1===r.get(MP)&&n.initialNavigation(),r.get(IW,null,cn.Optional)?.setUpPreloading(),r.get(yP,null,cn.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const AW=new tt("",{factory:()=>new So}),MP=new tt("",{providedIn:"root",factory:()=>1}),IW=new tt("");function Eve(r){return b3(0,[{provide:IW,useExisting:vve},{provide:OW,useExisting:r}])}const kW=new tt("ROUTER_FORROOT_GUARD"),Pve=[rS,{provide:lf,useClass:tP},Gn,gf,{provide:xo,useFactory:function wW(r){return r.routerState.root},deps:[Gn]},CP,[]];function Tve(){return new q$("Router",Gn)}let Ove=(()=>{var r;class e{constructor(n){}static forRoot(n,i){return{ngModule:e,providers:[Pve,[],{provide:Z8,multi:!0,useValue:n},{provide:kW,useFactory:Ave,deps:[[Gn,new to,new $h]]},{provide:Dg,useValue:i||{}},i?.useHash?{provide:d6,useClass:pde}:{provide:d6,useClass:MB},{provide:yP,useFactory:()=>{const r=rt(Ihe),e=rt(o1),t=rt(Dg),n=rt(zg),i=rt(lf);return t.scrollOffset&&r.setOffset(t.scrollOffset),new bW(i,n,r,e,t)}},i?.preloadingStrategy?Eve(i.preloadingStrategy).\u0275providers:[],{provide:q$,multi:!0,useFactory:Tve},i?.initialNavigation?Ive(i):[],i?.bindToComponentInputs?b3(8,[sW,{provide:Ig,useExisting:sW}]).\u0275providers:[],[{provide:xW,useFactory:NW},{provide:jE,multi:!0,useExisting:xW}]]}}static forChild(n){return{ngModule:e,providers:[{provide:Z8,multi:!0,useValue:n}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(kW,8))},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({}),e})();function Ave(r){return"guarded"}function Ive(r){return["disabled"===r.initialNavigation?b3(3,[{provide:DE,multi:!0,useFactory:()=>{const e=rt(Gn);return()=>{e.setUpLocationChangeListener()}}},{provide:MP,useValue:2}]).\u0275providers:[],"enabledBlocking"===r.initialNavigation?b3(2,[{provide:MP,useValue:0},{provide:DE,multi:!0,deps:[J2],useFactory:e=>{const t=e.get(dde,Promise.resolve());return()=>t.then(()=>new Promise(n=>{const i=e.get(Gn),o=e.get(AW);TW(i,()=>{n(!0)}),e.get(zg).afterPreactivation=()=>(n(!0),o.closed?Dt(void 0):o),i.initialNavigation()}))}}]).\u0275providers:[]]}const xW=new tt("");class LW{}class xve{}const w3="*";function RW(r,e=null){return{type:2,steps:r,options:e}}function zW(r){return{type:6,styles:r,offset:null}}class Ef{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class DW{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,i=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++t==o&&this._onFinish()}),s.onDestroy(()=>{++n==o&&this._onDestroy()}),s.onStart(()=>{++i==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const i=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(i)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function HW(r){return new ge(3e3,!1)}function $4(r){switch(r.length){case 0:return new Ef;case 1:return r[0];default:return new DW(r)}}function VW(r,e,t=new Map,n=new Map){const i=[],o=[];let s=-1,a=null;if(e.forEach(c=>{const l=c.get("offset"),f=l==s,d=f&&a||new Map;c.forEach((m,E)=>{let w=E,L=m;if("offset"!==E)switch(w=r.normalizePropertyName(w,i),L){case"!":L=t.get(E);break;case w3:L=n.get(E);break;default:L=r.normalizeStyleValue(E,w,L,i)}d.set(w,L)}),f||o.push(d),a=d,s=l}),i.length)throw function nCe(r){return new ge(3502,!1)}();return o}function SP(r,e,t,n){switch(e){case"start":r.onStart(()=>n(t&&PP(t,"start",r)));break;case"done":r.onDone(()=>n(t&&PP(t,"done",r)));break;case"destroy":r.onDestroy(()=>n(t&&PP(t,"destroy",r)))}}function PP(r,e,t){const o=TP(r.element,r.triggerName,r.fromState,r.toState,e||r.phaseName,t.totalTime??r.totalTime,!!t.disabled),s=r._data;return null!=s&&(o._data=s),o}function TP(r,e,t,n,i="",o=0,s){return{element:r,triggerName:e,fromState:t,toState:n,phaseName:i,totalTime:o,disabled:!!s}}function is(r,e,t){let n=r.get(e);return n||r.set(e,n=t),n}function FW(r){const e=r.indexOf(":");return[r.substring(1,e),r.slice(e+1)]}const pCe=(()=>typeof document>"u"?null:document.documentElement)();function OP(r){const e=r.parentNode||r.host||null;return e===pCe?null:e}let T6=null,$W=!1;function BW(r,e){for(;e;){if(e===r)return!0;e=OP(e)}return!1}function GW(r,e,t){if(t)return Array.from(r.querySelectorAll(e));const n=r.querySelector(e);return n?[n]:[]}let UW=(()=>{var r;class e{validateStyleProperty(n){return function mCe(r){T6||(T6=function _Ce(){return typeof document<"u"?document.body:null}()||{},$W=!!T6.style&&"WebkitAppearance"in T6.style);let e=!0;return T6.style&&!function gCe(r){return"ebkit"==r.substring(1,6)}(r)&&(e=r in T6.style,!e&&$W&&(e="Webkit"+r.charAt(0).toUpperCase()+r.slice(1)in T6.style)),e}(n)}matchesElement(n,i){return!1}containsElement(n,i){return BW(n,i)}getParentElement(n){return OP(n)}query(n,i,o){return GW(n,i,o)}computeStyle(n,i,o){return o||""}animate(n,i,o,s,a,c=[],l){return new Ef(o,s)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})(),bP=(()=>{class e{}return e.NOOP=new UW,e})();const vCe=1e3,wP="ng-enter",Hg="ng-leave",Vg="ng-trigger",Fg=".ng-trigger",qW="ng-animating",NP=".ng-animating";function N3(r){if("number"==typeof r)return r;const e=r.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:AP(parseFloat(e[1]),e[2])}function AP(r,e){return"s"===e?r*vCe:r}function $g(r,e,t){return r.hasOwnProperty("duration")?r:function yCe(r,e,t){let i,o=0,s="";if("string"==typeof r){const a=r.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(HW()),{duration:0,delay:0,easing:""};i=AP(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(o=AP(parseFloat(c),a[4]));const l=a[5];l&&(s=l)}else i=r;if(!t){let a=!1,c=e.length;i<0&&(e.push(function Lve(){return new ge(3100,!1)}()),a=!0),o<0&&(e.push(function Rve(){return new ge(3101,!1)}()),a=!0),a&&e.splice(c,0,HW())}return{duration:i,delay:o,easing:s}}(r,e,t)}function Sf(r,e={}){return Object.keys(r).forEach(t=>{e[t]=r[t]}),e}function jW(r){const e=new Map;return Object.keys(r).forEach(t=>{e.set(t,r[t])}),e}function B4(r,e=new Map,t){if(t)for(let[n,i]of t)e.set(n,i);for(let[n,i]of r)e.set(n,i);return e}function Mc(r,e,t){e.forEach((n,i)=>{const o=kP(i);t&&!t.has(i)&&t.set(i,r.style[o]),r.style[o]=n})}function O6(r,e){e.forEach((t,n)=>{const i=kP(n);r.style[i]=""})}function Pf(r){return Array.isArray(r)?1==r.length?r[0]:RW(r):r}const IP=new RegExp("{{\\s*(.+?)\\s*}}","g");function YW(r){let e=[];if("string"==typeof r){let t;for(;t=IP.exec(r);)e.push(t[1]);IP.lastIndex=0}return e}function Tf(r,e,t){const n=r.toString(),i=n.replace(IP,(o,s)=>{let a=e[s];return null==a&&(t.push(function Dve(r){return new ge(3003,!1)}()),a=""),a.toString()});return i==n?r:i}function Bg(r){const e=[];let t=r.next();for(;!t.done;)e.push(t.value),t=r.next();return e}const SCe=/-+([a-z0-9])/g;function kP(r){return r.replace(SCe,(...e)=>e[1].toUpperCase())}function os(r,e,t){switch(e.type){case 7:return r.visitTrigger(e,t);case 0:return r.visitState(e,t);case 1:return r.visitTransition(e,t);case 2:return r.visitSequence(e,t);case 3:return r.visitGroup(e,t);case 4:return r.visitAnimate(e,t);case 5:return r.visitKeyframes(e,t);case 6:return r.visitStyle(e,t);case 8:return r.visitReference(e,t);case 9:return r.visitAnimateChild(e,t);case 10:return r.visitAnimateRef(e,t);case 11:return r.visitQuery(e,t);case 12:return r.visitStagger(e,t);default:throw function Hve(r){return new ge(3004,!1)}()}}function KW(r,e){return window.getComputedStyle(r)[e]}const Gg="*";function OCe(r,e){const t=[];return"string"==typeof r?r.split(/\s*,\s*/).forEach(n=>function bCe(r,e,t){if(":"==r[0]){const c=function wCe(r,e){switch(r){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function Qve(r){return new ge(3016,!1)}()),"* => *"}}(r,t);if("function"==typeof c)return void e.push(c);r=c}const n=r.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function Xve(r){return new ge(3015,!1)}()),e;const i=n[1],o=n[2],s=n[3];e.push(XW(i,s));"<"==o[0]&&!(i==Gg&&s==Gg)&&e.push(XW(s,i))}(n,t,e)):t.push(r),t}const Ug=new Set(["true","1"]),Wg=new Set(["false","0"]);function XW(r,e){const t=Ug.has(r)||Wg.has(r),n=Ug.has(e)||Wg.has(e);return(i,o)=>{let s=r==Gg||r==i,a=e==Gg||e==o;return!s&&t&&"boolean"==typeof i&&(s=i?Ug.has(r):Wg.has(r)),!a&&n&&"boolean"==typeof o&&(a=o?Ug.has(e):Wg.has(e)),s&&a}}const NCe=new RegExp("s*:selfs*,?","g");function xP(r,e,t,n){return new ACe(r).build(e,t,n)}class ACe{constructor(e){this._driver=e}build(e,t,n){const i=new xCe(t);return this._resetContextStyleTimingState(i),os(this,Pf(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,i=t.depCount=0;const o=[],s=[];return"@"==e.name.charAt(0)&&t.errors.push(function Fve(){return new ge(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(f=>{c.name=f,o.push(this.visitState(c,t))}),c.name=l}else if(1==a.type){const c=this.visitTransition(a,t);n+=c.queryCount,i+=c.depCount,s.push(c)}else t.errors.push(function $ve(){return new ge(3007,!1)}())}),{type:7,name:e.name,states:o,transitions:s,queryCount:n,depCount:i,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){const o=new Set,s=i||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{YW(c).forEach(l=>{s.hasOwnProperty(l)||o.add(l)})})}),o.size&&(Bg(o.values()),t.errors.push(function Bve(r,e){return new ge(3008,!1)}()))}return{type:0,name:e.name,style:n,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=os(this,Pf(e.animation),t);return{type:1,matchers:OCe(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:b6(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>os(this,n,t)),options:b6(e.options)}}visitGroup(e,t){const n=t.currentTime;let i=0;const o=e.steps.map(s=>{t.currentTime=n;const a=os(this,s,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:o,options:b6(e.options)}}visitAnimate(e,t){const n=function RCe(r,e){if(r.hasOwnProperty("duration"))return r;if("number"==typeof r)return LP($g(r,e).duration,0,"");const t=r;if(t.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=LP(0,0,"");return o.dynamic=!0,o.strValue=t,o}const i=$g(t,e);return LP(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let i,o=e.styles?e.styles:zW({});if(5==o.type)i=this.visitKeyframes(o,t);else{let s=e.styles,a=!1;if(!s){a=!0;const l={};n.easing&&(l.easing=n.easing),s=zW(l)}t.currentTime+=n.duration+n.delay;const c=this.visitStyle(s,t);c.isEmptyStep=a,i=c}return t.currentAnimateTimings=null,{type:4,timings:n,style:i,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)"string"==typeof a?a===w3?n.push(a):t.errors.push(new ge(3002,!1)):n.push(jW(a));let o=!1,s=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let c of a.values())if(c.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:n,easing:s,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let i=t.currentTime,o=t.currentTime;n&&o>0&&(o-=n.duration+n.delay),e.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,c)=>{const l=t.collectedStyles.get(t.currentQuerySelector),f=l.get(c);let d=!0;f&&(o!=i&&o>=f.startTime&&i<=f.endTime&&(t.errors.push(function Uve(r,e,t,n,i){return new ge(3010,!1)}()),d=!1),o=f.startTime),d&&l.set(c,{startTime:o,endTime:i}),t.options&&function ECe(r,e,t){const n=e.params||{},i=YW(r);i.length&&i.forEach(o=>{n.hasOwnProperty(o)||t.push(function zve(r){return new ge(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Wve(){return new ge(3011,!1)}()),n;let o=0;const s=[];let a=!1,c=!1,l=0;const f=e.steps.map($=>{const B=this._makeStyleAst($,t);let de=null!=B.offset?B.offset:function LCe(r){if("string"==typeof r)return null;let e=null;if(Array.isArray(r))r.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(r instanceof Map&&r.has("offset")){const t=r;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(B.styles),_e=0;return null!=de&&(o++,_e=B.offset=de),c=c||_e<0||_e>1,a=a||_e<l,l=_e,s.push(_e),B});c&&t.errors.push(function qve(){return new ge(3012,!1)}()),a&&t.errors.push(function jve(){return new ge(3200,!1)}());const d=e.steps.length;let m=0;o>0&&o<d?t.errors.push(function Zve(){return new ge(3202,!1)}()):0==o&&(m=1/(d-1));const E=d-1,w=t.currentTime,L=t.currentAnimateTimings,z=L.duration;return f.forEach(($,B)=>{const de=m>0?B==E?1:m*B:s[B],_e=de*z;t.currentTime=w+L.delay+_e,L.duration=_e,this._validateStyleAst($,t),$.offset=de,n.styles.push($)}),n}visitReference(e,t){return{type:8,animation:os(this,Pf(e.animation),t),options:b6(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:b6(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:b6(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[o,s]=function ICe(r){const e=!!r.split(/\s*,\s*/).find(t=>":self"==t);return e&&(r=r.replace(NCe,"")),r=r.replace(/@\*/g,Fg).replace(/@\w+/g,t=>Fg+"-"+t.slice(1)).replace(/:animating/g,NP),[r,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+o:o,is(t.collectedStyles,t.currentQuerySelector,new Map);const a=os(this,Pf(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:s,animation:a,originalSelector:e.selector,options:b6(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function Yve(){return new ge(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:$g(e.timings,t.errors,!0);return{type:12,animation:os(this,Pf(e.animation),t),timings:n,options:null}}}class xCe{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function b6(r){return r?(r=Sf(r)).params&&(r.params=function kCe(r){return r?Sf(r):null}(r.params)):r={},r}function LP(r,e,t){return{duration:r,delay:e,easing:t}}function RP(r,e,t,n,i,o,s=null,a=!1){return{type:1,element:r,keyframes:e,preStyleProps:t,postStyleProps:n,duration:i,delay:o,totalTime:i+o,easing:s,subTimeline:a}}class qg{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const HCe=new RegExp(":enter","g"),FCe=new RegExp(":leave","g");function zP(r,e,t,n,i,o=new Map,s=new Map,a,c,l=[]){return(new $Ce).buildKeyframes(r,e,t,n,i,o,s,a,c,l)}class $Ce{buildKeyframes(e,t,n,i,o,s,a,c,l,f=[]){l=l||new qg;const d=new DP(e,t,l,i,o,f,[]);d.options=c;const m=c.delay?N3(c.delay):0;d.currentTimeline.delayNextStep(m),d.currentTimeline.setStyles([s],null,d.errors,c),os(this,n,d);const E=d.timelines.filter(w=>w.containsAnimation());if(E.length&&a.size){let w;for(let L=E.length-1;L>=0;L--){const z=E[L];if(z.element===t){w=z;break}}w&&!w.allowOnlyTimelineStyles()&&w.setStyles([a],null,d.errors,c)}return E.length?E.map(w=>w.buildKeyframes()):[RP(t,[],[],[],0,m,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const i=t.createSubContext(e.options),o=t.currentTimeline.currentTime,s=this._visitSubInstructions(n,i,i.options);o!=s&&t.transformIntoNewTimeline(s)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const i of e){const o=i?.delay;if(o){const s="number"==typeof o?o:N3(Tf(o,i?.params??{},t.errors));n.delayNextStep(s)}}}_visitSubInstructions(e,t,n){let o=t.currentTimeline.currentTime;const s=null!=n.duration?N3(n.duration):null,a=null!=n.delay?N3(n.delay):null;return 0!==s&&e.forEach(c=>{const l=t.appendInstructionToTimeline(c,s,a);o=Math.max(o,l.duration+l.delay)}),o}visitReference(e,t){t.updateOptions(e.options,!0),os(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let i=t;const o=e.options;if(o&&(o.params||o.delay)&&(i=t.createSubContext(o),i.transformIntoNewTimeline(),null!=o.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=jg);const s=N3(o.delay);i.delayNextStep(s)}e.steps.length&&(e.steps.forEach(s=>os(this,s,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let i=t.currentTimeline.currentTime;const o=e.options&&e.options.delay?N3(e.options.delay):0;e.steps.forEach(s=>{const a=t.createSubContext(e.options);o&&a.delayNextStep(o),os(this,s,a),i=Math.max(i,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(s=>t.currentTimeline.mergeTimelineCollectedStyles(s)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return $g(t.params?Tf(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());const o=e.style;5==o.type?this.visitKeyframes(o,t):(t.incrementTime(n.duration),this.visitStyle(o,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.hasCurrentStyleProperties()&&n.forwardFrame();const o=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(o):n.setStyles(e.styles,o,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,i=t.currentTimeline.duration,o=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(c=>{a.forwardTime((c.offset||0)*o),a.setStyles(c.styles,c.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+o),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,i=e.options||{},o=i.delay?N3(i.delay):0;o&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=jg);let s=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let c=null;a.forEach((l,f)=>{t.currentQueryIndex=f;const d=t.createSubContext(e.options,l);o&&d.delayNextStep(o),l===t.element&&(c=d.currentTimeline),os(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,d.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(s),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,i=t.currentTimeline,o=e.timings,s=Math.abs(o.duration),a=s*(t.currentQueryTotal-1);let c=s*t.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":c=a-c;break;case"full":c=n.currentStaggerTime}const f=t.currentTimeline;c&&f.delayNextStep(c);const d=f.currentTime;os(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-d+(i.startTime-n.currentTimeline.startTime)}}const jg={};class DP{constructor(e,t,n,i,o,s,a,c){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=jg,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new Zg(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let i=this.options;null!=n.duration&&(i.duration=N3(n.duration)),null!=n.delay&&(i.delay=N3(n.delay));const o=n.params;if(o){let s=i.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!t||!s.hasOwnProperty(a))&&(s[a]=Tf(o[a],s,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(i=>{n[i]=t[i]})}}return e}createSubContext(e=null,t,n){const i=t||this.element,o=new DP(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(e){return this.previousNode=jg,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},o=new BCe(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,i,o,s){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(HCe,"."+this._enterClassName)).replace(FCe,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=n);0!==n&&(l=n<0?l.slice(l.length+n,l.length):l.slice(0,n)),a.push(...l)}return!o&&0==a.length&&s.push(function Kve(r){return new ge(3014,!1)}()),a}}class Zg{constructor(e,t,n,i){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Zg(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||w3),this._currentKeyframe.set(t,w3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,i){t&&this._previousKeyframe.set("easing",t);const o=i&&i.params||{},s=function GCe(r,e){const t=new Map;let n;return r.forEach(i=>{if("*"===i){n=n||e.keys();for(let o of n)t.set(o,w3)}else B4(i,t)}),t}(e,this._globalTimelineStyles);for(let[a,c]of s){const l=Tf(c,o,n);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??w3),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const i=this._styleSummary.get(n);(!i||t.time>i.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,c)=>{const l=B4(a,new Map,this._backFill);l.forEach((f,d)=>{"!"===f?e.add(d):f===w3&&t.add(d)}),n||l.set("offset",c/this.duration),i.push(l)});const o=e.size?Bg(e.values()):[],s=t.size?Bg(t.values()):[];if(n){const a=i[0],c=new Map(a);a.set("offset",0),c.set("offset",1),i=[a,c]}return RP(this.element,i,o,s,this.duration,this.startTime,this.easing,!1)}}class BCe extends Zg{constructor(e,t,n,i,o,s,a=!1){super(e,t,s.delay),this.keyframes=n,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const o=[],s=n+t,a=t/s,c=B4(e[0]);c.set("offset",0),o.push(c);const l=B4(e[0]);l.set("offset",eq(a)),o.push(l);const f=e.length-1;for(let d=1;d<=f;d++){let m=B4(e[d]);const E=m.get("offset");m.set("offset",eq((t+E*n)/s)),o.push(m)}n=s,t=0,i="",e=o}return RP(this.element,e,this.preStyleProps,this.postStyleProps,n,t,i,!0)}}function eq(r,e=3){const t=Math.pow(10,e-1);return Math.round(r*t)/t}class HP{}const UCe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class WCe extends HP{normalizePropertyName(e,t){return kP(e)}normalizeStyleValue(e,t,n,i){let o="";const s=n.toString().trim();if(UCe.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)o="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function Vve(r,e){return new ge(3005,!1)}())}return s+o}}function tq(r,e,t,n,i,o,s,a,c,l,f,d,m){return{type:0,element:r,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:o,toState:n,toStyles:s,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:f,totalTime:d,errors:m}}const VP={};class nq{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,i){return function qCe(r,e,t,n,i){return r.some(o=>o(e,t,n,i))}(this.ast.matchers,e,t,n,i)}buildStyles(e,t,n){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,n):new Map}build(e,t,n,i,o,s,a,c,l,f){const d=[],m=this.ast.options&&this.ast.options.params||VP,w=this.buildStyles(n,a&&a.params||VP,d),L=c&&c.params||VP,z=this.buildStyles(i,L,d),$=new Set,B=new Map,de=new Map,_e="void"===i,xe={params:jCe(L,m),delay:this.ast.options?.delay},nt=f?[]:zP(e,t,this.ast.animation,o,s,w,z,xe,l,d);let gt=0;if(nt.forEach(Et=>{gt=Math.max(Et.duration+Et.delay,gt)}),d.length)return tq(t,this._triggerName,n,i,_e,w,z,[],[],B,de,gt,d);nt.forEach(Et=>{const q2=Et.element,D0=is(B,q2,new Set);Et.preStyleProps.forEach(e3=>D0.add(e3));const $l=is(de,q2,new Set);Et.postStyleProps.forEach(e3=>$l.add(e3)),q2!==t&&$.add(q2)});const Mn=Bg($.values());return tq(t,this._triggerName,n,i,_e,w,z,nt,Mn,B,de,gt)}}function jCe(r,e){const t=Sf(e);for(const n in r)r.hasOwnProperty(n)&&null!=r[n]&&(t[n]=r[n]);return t}class ZCe{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,i=Sf(this.defaultParams);return Object.keys(e).forEach(o=>{const s=e[o];null!==s&&(i[o]=s)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=Tf(s,i,t));const c=this.normalizer.normalizePropertyName(a,t);s=this.normalizer.normalizeStyleValue(a,c,s,t),n.set(a,s)})}),n}}class KCe{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(i=>{this.states.set(i.name,new ZCe(i.style,i.options&&i.options.params||{},n))}),rq(this.states,"true","1"),rq(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new nq(e,i,this.states))}),this.fallbackTransition=function XCe(r,e,t){return new nq(r,{type:1,animation:{type:2,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,i){return this.transitionFactories.find(s=>s.match(e,t,n,i))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function rq(r,e,t){r.has(e)?r.has(t)||r.set(t,r.get(e)):r.has(t)&&r.set(e,r.get(t))}const QCe=new qg;class JCe{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],o=xP(this._driver,t,n,[]);if(n.length)throw function rCe(r){return new ge(3503,!1)}();this._animations.set(e,o)}_buildPlayer(e,t,n){const i=e.element,o=VW(this._normalizer,e.keyframes,t,n);return this._driver.animate(i,o,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const i=[],o=this._animations.get(e);let s;const a=new Map;if(o?(s=zP(this._driver,t,o,wP,Hg,new Map,new Map,n,QCe,i),s.forEach(f=>{const d=is(a,f.element,new Map);f.postStyleProps.forEach(m=>d.set(m,null))})):(i.push(function iCe(){return new ge(3300,!1)}()),s=[]),i.length)throw function oCe(r){return new ge(3504,!1)}();a.forEach((f,d)=>{f.forEach((m,E)=>{f.set(E,this._driver.computeStyle(d,E,w3))})});const l=$4(s.map(f=>{const d=a.get(f.element);return this._buildPlayer(f,new Map,d)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function sCe(r){return new ge(3301,!1)}();return t}listen(e,t,n,i){const o=TP(t,"","","");return SP(this._getPlayer(e),n,o,i),()=>{}}command(e,t,n,i){if("register"==n)return void this.register(e,i[0]);if("create"==n)return void this.create(e,t,i[0]||{});const o=this._getPlayer(e);switch(n){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const iq="ng-animate-queued",FP="ng-animate-disabled",iye=[],oq={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},oye={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ca="__ng_removed";class $P{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function lye(r){return r??null}(n?e.value:e),n){const o=Sf(e);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(i=>{null==n[i]&&(n[i]=t[i])})}}}const Of="void",BP=new $P(Of);class sye{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,xs(t,this._hostClassName)}listen(e,t,n,i){if(!this._triggers.has(t))throw function aCe(r,e){return new ge(3302,!1)}();if(null==n||0==n.length)throw function cCe(r){return new ge(3303,!1)}();if(!function uye(r){return"start"==r||"done"==r}(n))throw function lCe(r,e){return new ge(3400,!1)}();const o=is(this._elementListeners,e,[]),s={name:t,phase:n,callback:i};o.push(s);const a=is(this._engine.statesByElement,e,new Map);return a.has(t)||(xs(e,Vg),xs(e,Vg+"-"+t),a.set(t,BP)),()=>{this._engine.afterFlush(()=>{const c=o.indexOf(s);c>=0&&o.splice(c,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function uCe(r){return new ge(3401,!1)}();return t}trigger(e,t,n,i=!0){const o=this._getTrigger(t),s=new GP(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(xs(e,Vg),xs(e,Vg+"-"+t),this._engine.statesByElement.set(e,a=new Map));let c=a.get(t);const l=new $P(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(t,l),c||(c=BP),l.value!==Of&&c.value===l.value){if(!function hye(r,e){const t=Object.keys(r),n=Object.keys(e);if(t.length!=n.length)return!1;for(let i=0;i<t.length;i++){const o=t[i];if(!e.hasOwnProperty(o)||r[o]!==e[o])return!1}return!0}(c.params,l.params)){const L=[],z=o.matchStyles(c.value,c.params,L),$=o.matchStyles(l.value,l.params,L);L.length?this._engine.reportError(L):this._engine.afterFlush(()=>{O6(e,z),Mc(e,$)})}return}const m=is(this._engine.playersByElement,e,[]);m.forEach(L=>{L.namespaceId==this.id&&L.triggerName==t&&L.queued&&L.destroy()});let E=o.matchTransition(c.value,l.value,e,l.params),w=!1;if(!E){if(!i)return;E=o.fallbackTransition,w=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:E,fromState:c,toState:l,player:s,isFallbackTransition:w}),w||(xs(e,iq),s.onStart(()=>{Y8(e,iq)})),s.onDone(()=>{let L=this.players.indexOf(s);L>=0&&this.players.splice(L,1);const z=this._engine.playersByElement.get(e);if(z){let $=z.indexOf(s);$>=0&&z.splice($,1)}}),this.players.push(s),m.push(s),s}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,Fg,!0);n.forEach(i=>{if(i[Ca])return;const o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(s=>s.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,n,i){const o=this._engine.statesByElement.get(e),s=new Map;if(o){const a=[];if(o.forEach((c,l)=>{if(s.set(l,c.value),this._triggers.has(l)){const f=this.trigger(e,l,Of,i);f&&a.push(f)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,s),n&&$4(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const i=new Set;t.forEach(o=>{const s=o.name;if(i.has(s))return;i.add(s);const c=this._triggers.get(s).fallbackTransition,l=n.get(s)||BP,f=new $P(Of),d=new GP(this.id,s,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:s,transition:c,fromState:l,toState:f,player:d,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(n.totalAnimations){const o=n.players.length?n.playersByQueriedElement.get(e):[];if(o&&o.length)i=!0;else{let s=e;for(;s=s.parentNode;)if(n.statesByElement.get(s)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)n.markElementAsRemoved(this.id,e,!1,t);else{const o=e[Ca];(!o||o===oq)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){xs(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const o=n.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==n.triggerName){const c=TP(o,n.triggerName,n.fromState.value,n.toState.value);c._data=e,SP(n.player,a.phase,c,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(n)}),this._queue=[],t.sort((n,i)=>{const o=n.transition.ast.depCount,s=i.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(n.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class aye{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,o)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new sye(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,i=this.namespacesByHostElement;if(n.length-1>=0){let s=!1,a=this.driver.getParentElement(t);for(;a;){const c=i.get(a);if(c){const l=n.indexOf(c);n.splice(l+1,0,e),s=!0;break}a=this.driver.getParentElement(a)}s||n.unshift(e)}else n.push(e);return i.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const n=this._fetchNamespace(e);this.namespacesByHostElement.delete(n.hostElement);const i=this._namespaceList.indexOf(n);i>=0&&this._namespaceList.splice(i,1),n.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let i of n.values())if(i.namespaceId){const o=this._fetchNamespace(i.namespaceId);o&&t.add(o)}return t}trigger(e,t,n,i){if(Yg(t)){const o=this._fetchNamespace(e);if(o)return o.trigger(t,n,i),!0}return!1}insertNode(e,t,n,i){if(!Yg(t))return;const o=t[Ca];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(t);s>=0&&this.collectedLeaveElements.splice(s,1)}if(e){const s=this._fetchNamespace(e);s&&s.insertNode(t,n)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),xs(e,FP)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Y8(e,FP))}removeNode(e,t,n){if(Yg(t)){const i=e?this._fetchNamespace(e):null;i?i.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n);const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,n)}else this._onRemovalComplete(t,n)}markElementAsRemoved(e,t,n,i,o){this.collectedLeaveElements.push(t),t[Ca]={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:o}}listen(e,t,n,i,o){return Yg(t)?this._fetchNamespace(e).listen(t,n,i,o):()=>{}}_buildInstruction(e,t,n,i,o){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,o)}destroyInnerAnimations(e){let t=this.driver.query(e,Fg,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,NP,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return $4(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Ca];if(t&&t.setForRemoval){if(e[Ca]=oq,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(FP)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,i)=>this._balanceNamespaceList(n,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)xs(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let i=0;i<n.length;i++)n[i]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?$4(t).onDone(()=>{n.forEach(i=>i())}):n.forEach(i=>i())}}reportError(e){throw function fCe(r){return new ge(3402,!1)}()}_flushAnimations(e,t){const n=new qg,i=[],o=new Map,s=[],a=new Map,c=new Map,l=new Map,f=new Set;this.disabledNodes.forEach(ft=>{f.add(ft);const Ot=this.driver.query(ft,".ng-animate-queued",!0);for(let xt=0;xt<Ot.length;xt++)f.add(Ot[xt])});const d=this.bodyNode,m=Array.from(this.statesByElement.keys()),E=cq(m,this.collectedEnterElements),w=new Map;let L=0;E.forEach((ft,Ot)=>{const xt=wP+L++;w.set(Ot,xt),ft.forEach(Nn=>xs(Nn,xt))});const z=[],$=new Set,B=new Set;for(let ft=0;ft<this.collectedLeaveElements.length;ft++){const Ot=this.collectedLeaveElements[ft],xt=Ot[Ca];xt&&xt.setForRemoval&&(z.push(Ot),$.add(Ot),xt.hasAnimation?this.driver.query(Ot,".ng-star-inserted",!0).forEach(Nn=>$.add(Nn)):B.add(Ot))}const de=new Map,_e=cq(m,Array.from($));_e.forEach((ft,Ot)=>{const xt=Hg+L++;de.set(Ot,xt),ft.forEach(Nn=>xs(Nn,xt))}),e.push(()=>{E.forEach((ft,Ot)=>{const xt=w.get(Ot);ft.forEach(Nn=>Y8(Nn,xt))}),_e.forEach((ft,Ot)=>{const xt=de.get(Ot);ft.forEach(Nn=>Y8(Nn,xt))}),z.forEach(ft=>{this.processLeaveNode(ft)})});const xe=[],nt=[];for(let ft=this._namespaceList.length-1;ft>=0;ft--)this._namespaceList[ft].drainQueuedTransitions(t).forEach(xt=>{const Nn=xt.player,wt=xt.element;if(xe.push(Nn),this.collectedEnterElements.length){const Zi=wt[Ca];if(Zi&&Zi.setForMove){if(Zi.previousTriggersValues&&Zi.previousTriggersValues.has(xt.triggerName)){const H0=Zi.previousTriggersValues.get(xt.triggerName),sa=this.statesByElement.get(xt.element);if(sa&&sa.has(xt.triggerName)){const ty=sa.get(xt.triggerName);ty.value=H0,sa.set(xt.triggerName,ty)}}return void Nn.destroy()}}const t3=!d||!this.driver.containsElement(d,wt),Es=de.get(wt),Bl=w.get(wt),hr=this._buildInstruction(xt,n,Bl,Es,t3);if(hr.errors&&hr.errors.length)return void nt.push(hr);if(t3)return Nn.onStart(()=>O6(wt,hr.fromStyles)),Nn.onDestroy(()=>Mc(wt,hr.toStyles)),void i.push(Nn);if(xt.isFallbackTransition)return Nn.onStart(()=>O6(wt,hr.fromStyles)),Nn.onDestroy(()=>Mc(wt,hr.toStyles)),void i.push(Nn);const X3e=[];hr.timelines.forEach(Zi=>{Zi.stretchStartingKeyframe=!0,this.disabledNodes.has(Zi.element)||X3e.push(Zi)}),hr.timelines=X3e,n.append(wt,hr.timelines),s.push({instruction:hr,player:Nn,element:wt}),hr.queriedElements.forEach(Zi=>is(a,Zi,[]).push(Nn)),hr.preStyleProps.forEach((Zi,H0)=>{if(Zi.size){let sa=c.get(H0);sa||c.set(H0,sa=new Set),Zi.forEach((ty,NR)=>sa.add(NR))}}),hr.postStyleProps.forEach((Zi,H0)=>{let sa=l.get(H0);sa||l.set(H0,sa=new Set),Zi.forEach((ty,NR)=>sa.add(NR))})});if(nt.length){const ft=[];nt.forEach(Ot=>{ft.push(function dCe(r,e){return new ge(3505,!1)}())}),xe.forEach(Ot=>Ot.destroy()),this.reportError(ft)}const gt=new Map,Mn=new Map;s.forEach(ft=>{const Ot=ft.element;n.has(Ot)&&(Mn.set(Ot,Ot),this._beforeAnimationBuild(ft.player.namespaceId,ft.instruction,gt))}),i.forEach(ft=>{const Ot=ft.element;this._getPreviousPlayers(Ot,!1,ft.namespaceId,ft.triggerName,null).forEach(Nn=>{is(gt,Ot,[]).push(Nn),Nn.destroy()})});const Et=z.filter(ft=>uq(ft,c,l)),q2=new Map;aq(q2,this.driver,B,l,w3).forEach(ft=>{uq(ft,c,l)&&Et.push(ft)});const $l=new Map;E.forEach((ft,Ot)=>{aq($l,this.driver,new Set(ft),c,"!")}),Et.forEach(ft=>{const Ot=q2.get(ft),xt=$l.get(ft);q2.set(ft,new Map([...Ot?.entries()??[],...xt?.entries()??[]]))});const e3=[],nh=[],rh={};s.forEach(ft=>{const{element:Ot,player:xt,instruction:Nn}=ft;if(n.has(Ot)){if(f.has(Ot))return xt.onDestroy(()=>Mc(Ot,Nn.toStyles)),xt.disabled=!0,xt.overrideTotalTime(Nn.totalTime),void i.push(xt);let wt=rh;if(Mn.size>1){let Es=Ot;const Bl=[];for(;Es=Es.parentNode;){const hr=Mn.get(Es);if(hr){wt=hr;break}Bl.push(Es)}Bl.forEach(hr=>Mn.set(hr,wt))}const t3=this._buildAnimation(xt.namespaceId,Nn,gt,o,$l,q2);if(xt.setRealPlayer(t3),wt===rh)e3.push(xt);else{const Es=this.playersByElement.get(wt);Es&&Es.length&&(xt.parentPlayer=$4(Es)),i.push(xt)}}else O6(Ot,Nn.fromStyles),xt.onDestroy(()=>Mc(Ot,Nn.toStyles)),nh.push(xt),f.has(Ot)&&i.push(xt)}),nh.forEach(ft=>{const Ot=o.get(ft.element);if(Ot&&Ot.length){const xt=$4(Ot);ft.setRealPlayer(xt)}}),i.forEach(ft=>{ft.parentPlayer?ft.syncPlayerEvents(ft.parentPlayer):ft.destroy()});for(let ft=0;ft<z.length;ft++){const Ot=z[ft],xt=Ot[Ca];if(Y8(Ot,Hg),xt&&xt.hasAnimation)continue;let Nn=[];if(a.size){let t3=a.get(Ot);t3&&t3.length&&Nn.push(...t3);let Es=this.driver.query(Ot,NP,!0);for(let Bl=0;Bl<Es.length;Bl++){let hr=a.get(Es[Bl]);hr&&hr.length&&Nn.push(...hr)}}const wt=Nn.filter(t3=>!t3.destroyed);wt.length?fye(this,Ot,wt):this.processLeaveNode(Ot)}return z.length=0,e3.forEach(ft=>{this.players.push(ft),ft.onDone(()=>{ft.destroy();const Ot=this.players.indexOf(ft);this.players.splice(Ot,1)}),ft.play()}),e3}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,i,o){let s=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(s=a)}else{const a=this.playersByElement.get(e);if(a){const c=!o||o==Of;a.forEach(l=>{l.queued||!c&&l.triggerName!=i||s.push(l)})}}return(n||i)&&(s=s.filter(a=>!(n&&n!=a.namespaceId||i&&i!=a.triggerName))),s}_beforeAnimationBuild(e,t,n){const o=t.element,s=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const c of t.timelines){const l=c.element,f=l!==o,d=is(n,l,[]);this._getPreviousPlayers(l,f,s,a,t.toState).forEach(E=>{const w=E.getRealPlayer();w.beforeDestroy&&w.beforeDestroy(),E.destroy(),d.push(E)})}O6(o,t.fromStyles)}_buildAnimation(e,t,n,i,o,s){const a=t.triggerName,c=t.element,l=[],f=new Set,d=new Set,m=t.timelines.map(w=>{const L=w.element;f.add(L);const z=L[Ca];if(z&&z.removedBeforeQueried)return new Ef(w.duration,w.delay);const $=L!==c,B=function dye(r){const e=[];return lq(r,e),e}((n.get(L)||iye).map(gt=>gt.getRealPlayer())).filter(gt=>!!gt.element&&gt.element===L),de=o.get(L),_e=s.get(L),xe=VW(this._normalizer,w.keyframes,de,_e),nt=this._buildPlayer(w,xe,B);if(w.subTimeline&&i&&d.add(L),$){const gt=new GP(e,a,L);gt.setRealPlayer(nt),l.push(gt)}return nt});l.forEach(w=>{is(this.playersByQueriedElement,w.element,[]).push(w),w.onDone(()=>function cye(r,e,t){let n=r.get(e);if(n){if(n.length){const i=n.indexOf(t);n.splice(i,1)}0==n.length&&r.delete(e)}return n}(this.playersByQueriedElement,w.element,w))}),f.forEach(w=>xs(w,qW));const E=$4(m);return E.onDestroy(()=>{f.forEach(w=>Y8(w,qW)),Mc(c,t.toStyles)}),d.forEach(w=>{is(i,w,[]).push(E)}),E}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new Ef(e.duration,e.delay)}}class GP{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new Ef,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(i=>SP(e,n,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){is(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Yg(r){return r&&1===r.nodeType}function sq(r,e){const t=r.style.display;return r.style.display=e??"none",t}function aq(r,e,t,n,i){const o=[];t.forEach(c=>o.push(sq(c)));const s=[];n.forEach((c,l)=>{const f=new Map;c.forEach(d=>{const m=e.computeStyle(l,d,i);f.set(d,m),(!m||0==m.length)&&(l[Ca]=oye,s.push(l))}),r.set(l,f)});let a=0;return t.forEach(c=>sq(c,o[a++])),s}function cq(r,e){const t=new Map;if(r.forEach(a=>t.set(a,[])),0==e.length)return t;const i=new Set(e),o=new Map;function s(a){if(!a)return 1;let c=o.get(a);if(c)return c;const l=a.parentNode;return c=t.has(l)?l:i.has(l)?1:s(l),o.set(a,c),c}return e.forEach(a=>{const c=s(a);1!==c&&t.get(c).push(a)}),t}function xs(r,e){r.classList?.add(e)}function Y8(r,e){r.classList?.remove(e)}function fye(r,e,t){$4(t).onDone(()=>r.processLeaveNode(e))}function lq(r,e){for(let t=0;t<r.length;t++){const n=r[t];n instanceof DW?lq(n.players,e):e.push(n)}}function uq(r,e,t){const n=t.get(r);if(!n)return!1;let i=e.get(r);return i?n.forEach(o=>i.add(o)):e.set(r,n),t.delete(r),!0}class Kg{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(i,o)=>{},this._transitionEngine=new aye(e,t,n),this._timelineEngine=new JCe(e,t,n),this._transitionEngine.onRemovalComplete=(i,o)=>this.onRemovalComplete(i,o)}registerTrigger(e,t,n,i,o){const s=e+"-"+i;let a=this._triggerCache[s];if(!a){const c=[],f=xP(this._driver,o,c,[]);if(c.length)throw function tCe(r,e){return new ge(3404,!1)}();a=function YCe(r,e,t){return new KCe(r,e,t)}(i,f,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}onRemove(e,t,n){this._transitionEngine.removeNode(e,t,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,i){if("@"==n.charAt(0)){const[o,s]=FW(n);this._timelineEngine.command(o,t,s,i)}else this._transitionEngine.trigger(e,t,n,i)}listen(e,t,n,i,o){if("@"==n.charAt(0)){const[s,a]=FW(n);return this._timelineEngine.listen(s,t,a,o)}return this._transitionEngine.listen(e,t,n,i,o)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let gye=(()=>{class e{constructor(n,i,o){this._element=n,this._startStyles=i,this._endStyles=o,this._state=0;let s=e.initialStylesByElement.get(n);s||e.initialStylesByElement.set(n,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Mc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Mc(this._element,this._initialStyles),this._endStyles&&(Mc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(O6(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(O6(this._element,this._endStyles),this._endStyles=null),Mc(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function UP(r){let e=null;return r.forEach((t,n)=>{(function mye(r){return"display"===r||"position"===r})(n)&&(e=e||new Map,e.set(n,t))}),e}class fq{constructor(e,t,n,i){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,i)=>{"offset"!==i&&e.set(i,this._finished?n:KW(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class _ye{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return BW(e,t)}getParentElement(e){return OP(e)}query(e,t,n){return GW(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,i,o,s=[]){const c={duration:n,delay:i,fill:0==i?"both":"forwards"};o&&(c.easing=o);const l=new Map,f=s.filter(E=>E instanceof fq);(function PCe(r,e){return 0===r||0===e})(n,i)&&f.forEach(E=>{E.currentSnapshot.forEach((w,L)=>l.set(L,w))});let d=function MCe(r){return r.length?r[0]instanceof Map?r:r.map(e=>jW(e)):[]}(t).map(E=>B4(E));d=function TCe(r,e,t){if(t.size&&e.length){let n=e[0],i=[];if(t.forEach((o,s)=>{n.has(s)||i.push(s),n.set(s,o)}),i.length)for(let o=1;o<e.length;o++){let s=e[o];i.forEach(a=>s.set(a,KW(r,a)))}}return e}(e,d,l);const m=function pye(r,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=UP(e[0]),e.length>1&&(n=UP(e[e.length-1]))):e instanceof Map&&(t=UP(e)),t||n?new gye(r,t,n):null}(e,d);return new fq(e,d,c,m)}}let vye=(()=>{var r;class e extends LW{constructor(n,i){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(i.body,{id:"0",encapsulation:bs.None,styles:[],data:{animation:[]}})}build(n){const i=this._nextAnimationId.toString();this._nextAnimationId++;const o=Array.isArray(n)?RW(n):n;return dq(this._renderer,null,i,"register",[o]),new Cye(i,this._renderer)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(v7),Pe(T2))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();class Cye extends xve{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new yye(this._id,e,t||{},this._renderer)}}class yye{constructor(e,t,n,i){this.id=e,this.element=t,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return dq(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function dq(r,e,t,n,i){return r.setProperty(e,`@@${t}:${n}`,i)}const hq="@.disabled";let Mye=(()=>{var r;class e{constructor(n,i,o){this.delegate=n,this.engine=i,this._zone=o,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(s,a)=>{const c=a?.parentNode(s);c&&a.removeChild(c,s)}}createRenderer(n,i){const s=this.delegate.createRenderer(n,i);if(!(n&&i&&i.data&&i.data.animation)){let d=this._rendererCache.get(s);return d||(d=new pq("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,d)),d}const a=i.id,c=i.id+"-"+this._currentId;this._currentId++,this.engine.register(c,n);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(a,c,n,d.name,d)};return i.data.animation.forEach(l),new Eye(this,c,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,i,o){n>=0&&n<this._microtaskId?this._zone.run(()=>i(o)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[a,c]=s;a(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,o]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(v7),Pe(Kg),Pe(o1))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();class pq{constructor(e,t,n,i){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,i=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==hq?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Eye extends pq{constructor(e,t,n,i,o){super(t,n,i,o),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==hq?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const i=function Sye(r){switch(r){case"body":return document.body;case"document":return document;case"window":return window;default:return r}}(e);let o=t.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function Pye(r){const e=r.indexOf(".");return[r.substring(0,e),r.slice(e+1)]}(o)),this.engine.listen(this.namespaceId,i,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let Tye=(()=>{var r;class e extends Kg{constructor(n,i,o,s){super(n.body,i,o)}ngOnDestroy(){this.flush()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(T2),Pe(bP),Pe(HP),Pe(u6))},r.\u0275prov=He({token:r,factory:r.\u0275fac}),e})();const gq=[{provide:LW,useClass:vye},{provide:HP,useFactory:function Oye(){return new WCe}},{provide:Kg,useClass:Tye},{provide:v7,useFactory:function bye(r,e,t){return new Mye(r,e,t)},deps:[TS,Kg,o1]}],WP=[{provide:bP,useFactory:()=>new _ye},{provide:lH,useValue:"BrowserAnimations"},...gq],mq=[{provide:bP,useClass:UW},{provide:lH,useValue:"NoopAnimations"},...gq];let wye=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?mq:WP}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({providers:WP,imports:[oG]}),e})();const Rr=void 0,Aye=["fr",[["AM","PM"],Rr,Rr],Rr,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Rr,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Rr,[["av. J.-C.","ap. J.-C."],Rr,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",Rr],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Rr,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Rr,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Rr,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Rr,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Rr,"\xa5"],KMF:[Rr,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Rr,"$C"],NZD:["$NZ","$"],PHP:[Rr,"\u20b1"],RHD:["$RH"],RON:[Rr,"L"],RWF:[Rr,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Rr,"$T"],TTD:["$TT","$"],TWD:[Rr,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Rr,"$"],XPF:["FCFP"],ZMW:[Rr,"Kw"]},"ltr",function Nye(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(r.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===t||1===t?1:0===i&&0!==t&&t%1e6==0&&0===n||!(i>=0&&i<=5)?4:5}];function _q(r,e,t,n,i,o,s){try{var a=r[o](s),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(n,i)}function M(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var o=r.apply(e,t);function s(c){_q(o,n,i,s,a,"next",c)}function a(c){_q(o,n,i,s,a,"throw",c)}s(void 0)})}}const vq=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=63&i|128):55296==(64512&i)&&n+1<r.length&&56320==(64512&r.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&r.charCodeAt(++n)),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=63&i|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=63&i|128)}return e},jP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const o=r[i],s=i+1<r.length,a=s?r[i+1]:0,c=i+2<r.length,l=c?r[i+2]:0;let m=(15&a)<<2|l>>6,E=63&l;c||(E=64,s||(m=64)),n.push(t[o>>2],t[(3&o)<<4|a>>4],t[m],t[E])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(vq(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const c=((7&i)<<18|(63&r[t++])<<12|(63&r[t++])<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(1023&c))}else{const o=r[t++],s=r[t++];e[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const o=t[r.charAt(i++)],a=i<r.length?t[r.charAt(i)]:0;++i;const l=i<r.length?t[r.charAt(i)]:64;++i;const d=i<r.length?t[r.charAt(i)]:64;if(++i,null==o||null==a||null==l||null==d)throw new Lye;n.push(o<<2|a>>4),64!==l&&(n.push(a<<4&240|l>>2),64!==d&&n.push(l<<6&192|d))}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class Lye extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Qg=function(r){return function(r){const e=vq(r);return jP.encodeByteArray(e,!0)}(r).replace(/\./g,"")},Jg=function(r){try{return jP.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},em=()=>{try{return function Dye(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const r=process.env.__FIREBASE_DEFAULTS__;return r?JSON.parse(r):void 0})()||(()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&Jg(r[1]);return e&&JSON.parse(e)})()}catch(r){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`)}},yq=r=>{var e,t;return null===(t=null===(e=em())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[r]},Mq=()=>{var r;return null===(r=em())||void 0===r?void 0:r.config},Eq=r=>{var e;return null===(e=em())||void 0===e?void 0:e[`_${r}`]};class tm{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function O2(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function ZP(){const r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}function w6(){try{return"object"==typeof indexedDB}catch{return!1}}function bf(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e((null===(o=i.error)||void 0===o?void 0:o.message)||"")}}catch(t){e(t)}})}function YP(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class Ls extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Ls.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ec.prototype.create)}}class Ec{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?function Zye(r,e){return r.replace(Yye,(t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`})}(o,n):"Error";return new Ls(i,`${this.serviceName}: ${s} (${i}).`,n)}}const Yye=/\{\$([^}]+)}/g;function rm(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const o=r[i],s=e[i];if(Pq(o)&&Pq(s)){if(!rm(o,s))return!1}else if(o!==s)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function Pq(r){return null!==r&&"object"==typeof r}function wf(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Nf(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,o]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Af(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}class Qye{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function Jye(r,e){if("object"!=typeof r||null===r)return!1;for(const t of e)if(t in r&&"function"==typeof r[t])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=KP),void 0===i.error&&(i.error=KP),void 0===i.complete&&(i.complete=KP);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function KP(){}const eMe=1e3,tMe=2,nMe=144e5,rMe=.5;function QP(r,e=eMe,t=tMe){const n=e*Math.pow(t,r),i=Math.round(rMe*n*(Math.random()-.5)*2);return Math.min(nMe,n+i)}function mr(r){return r&&r._delegate?r._delegate:r}class Ni{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const N6="[DEFAULT]";class oMe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new tm;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e?.identifier),i=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(i)return null;throw o}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function aMe(r){return"EAGER"===r.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:N6})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=N6){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return M(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=N6){return this.instances.has(e)}getOptions(e=N6){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,s]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(o)&&s.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),o=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;o.add(e),this.onInitCallbacks.set(i,o);const s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===N6?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=N6){return this.component?this.component.multipleInstances?e:N6:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class cMe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new oMe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const JP=[];var Un=function(r){return r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT",r}(Un||{});const Tq={debug:Un.DEBUG,verbose:Un.VERBOSE,info:Un.INFO,warn:Un.WARN,error:Un.ERROR,silent:Un.SILENT},lMe=Un.INFO,uMe={[Un.DEBUG]:"log",[Un.VERBOSE]:"log",[Un.INFO]:"info",[Un.WARN]:"warn",[Un.ERROR]:"error"},fMe=(r,e,...t)=>{if(e<r.logLevel)return;const n=(new Date).toISOString(),i=uMe[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${n}]  ${r.name}:`,...t)};class K8{constructor(e){this.name=e,this._logLevel=lMe,this._logHandler=fMe,this._userLogHandler=null,JP.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Un))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Tq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Un.DEBUG,...e),this._logHandler(this,Un.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Un.VERBOSE,...e),this._logHandler(this,Un.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Un.INFO,...e),this._logHandler(this,Un.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Un.WARN,...e),this._logHandler(this,Un.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Un.ERROR,...e),this._logHandler(this,Un.ERROR,...e)}}const dMe=(r,e)=>e.some(t=>r instanceof t);let Oq,bq;const wq=new WeakMap,eT=new WeakMap,Nq=new WeakMap,tT=new WeakMap,nT=new WeakMap;let rT={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return eT.get(r);if("objectStoreNames"===e)return r.objectStoreNames||Nq.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return G4(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function CMe(r){return"function"==typeof r?function vMe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function pMe(){return bq||(bq=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(iT(this),e),G4(wq.get(this))}:function(...e){return G4(r.apply(iT(this),e))}:function(e,...t){const n=r.call(iT(this),e,...t);return Nq.set(n,e.sort?e.sort():[e]),G4(n)}}(r):(r instanceof IDBTransaction&&function mMe(r){if(eT.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",s),r.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",s),r.addEventListener("abort",s)});eT.set(r,e)}(r),dMe(r,function hMe(){return Oq||(Oq=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,rT):r)}function G4(r){if(r instanceof IDBRequest)return function gMe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",s)},o=()=>{t(G4(r.result)),i()},s=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&wq.set(t,r)}).catch(()=>{}),nT.set(e,r),e}(r);if(tT.has(r))return tT.get(r);const e=CMe(r);return e!==r&&(tT.set(r,e),nT.set(e,r)),e}const iT=r=>nT.get(r),MMe=["get","getKey","getAll","getAllKeys","count"],EMe=["put","add","delete","clear"],oT=new Map;function Aq(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(oT.get(e))return oT.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=EMe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!MMe.includes(t))return;const o=function(){var s=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return s.apply(this,arguments)}}();return oT.set(e,o),o}!function _Me(r){rT=r(rT)}(r=>({...r,get:(e,t,n)=>Aq(e,t)||r.get(e,t,n),has:(e,t)=>!!Aq(e,t)||r.has(e,t)}));class SMe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function PMe(r){const e=r.getComponent();return"VERSION"===e?.type}(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}return null}).filter(t=>t).join(" ")}}const sT="@firebase/app",A6=new K8("@firebase/app"),im="[DEFAULT]",KMe={[sT]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},I6=new Map,om=new Map;function XMe(r,e){try{r.container.addComponent(e)}catch(t){A6.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function so(r){const e=r.name;if(om.has(e))return A6.debug(`There were multiple attempts to register component ${e}.`),!1;om.set(e,r);for(const t of I6.values())XMe(t,r);return!0}function X8(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}const A3=new Ec("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class JMe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ni("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw A3.create("app-deleted",{appName:this._name})}}const k6="9.23.0";function kq(r,e={}){let t=r;"object"!=typeof e&&(e={name:e});const n=Object.assign({name:im,automaticDataCollectionEnabled:!1},e),i=n.name;if("string"!=typeof i||!i)throw A3.create("bad-app-name",{appName:String(i)});if(t||(t=Mq()),!t)throw A3.create("no-options");const o=I6.get(i);if(o){if(rm(t,o.options)&&rm(n,o.config))return o;throw A3.create("duplicate-app",{appName:i})}const s=new cMe(i);for(const c of om.values())s.addComponent(c);const a=new JMe(t,n,s);return I6.set(i,a),a}function aT(r=im){const e=I6.get(r);if(!e&&r===im&&Mq())return kq();if(!e)throw A3.create("no-app",{appName:r});return e}function xq(){return Array.from(I6.values())}function _r(r,e,t){var n;let i=null!==(n=KMe[r])&&void 0!==n?n:r;t&&(i+=`-${t}`);const o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const a=[`Unable to register library "${i}" with version "${e}":`];return o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void A6.warn(a.join(" "))}so(new Ni(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const eEe="firebase-heartbeat-database",tEe=1,If="firebase-heartbeat-store";let lT=null;function Lq(){return lT||(lT=function yMe(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(r,e),a=G4(s);return n&&s.addEventListener("upgradeneeded",c=>{n(G4(s.result),c.oldVersion,c.newVersion,G4(s.transaction),c)}),t&&s.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}(eEe,tEe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(If)}}).catch(r=>{throw A3.create("idb-open",{originalErrorMessage:r.message})})),lT}function uT(){return(uT=M(function*(r){try{return yield(yield Lq()).transaction(If).objectStore(If).get(zq(r))}catch(e){if(e instanceof Ls)A6.warn(e.message);else{const t=A3.create("idb-get",{originalErrorMessage:e?.message});A6.warn(t.message)}}})).apply(this,arguments)}function Rq(r,e){return fT.apply(this,arguments)}function fT(){return(fT=M(function*(r,e){try{const n=(yield Lq()).transaction(If,"readwrite");yield n.objectStore(If).put(e,zq(r)),yield n.done}catch(t){if(t instanceof Ls)A6.warn(t.message);else{const n=A3.create("idb-set",{originalErrorMessage:t?.message});A6.warn(n.message)}}})).apply(this,arguments)}function zq(r){return`${r.name}!${r.options.appId}`}class oEe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new aEe(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){var e=this;return M(function*(){const n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Dq();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==i&&!e._heartbeatsCache.heartbeats.some(o=>o.date===i))return e._heartbeatsCache.heartbeats.push({date:i,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(o=>{const s=new Date(o.date).valueOf();return Date.now()-s<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return M(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const t=Dq(),{heartbeatsToSend:n,unsentEntries:i}=function sEe(r,e=1024){const t=[];let n=r.slice();for(const i of r){const o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),Hq(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Hq(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}(e._heartbeatsCache.heartbeats),o=Qg(JSON.stringify({version:2,heartbeats:n}));return e._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(e._heartbeatsCache.heartbeats=i,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),o})()}}function Dq(){return(new Date).toISOString().substring(0,10)}class aEe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return M(function*(){return!!w6()&&bf().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return M(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function nEe(r){return uT.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var t=this;return M(function*(){var n;if(yield t._canUseIndexedDBPromise){const o=yield t.read();return Rq(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return M(function*(){var n;if(yield t._canUseIndexedDBPromise){const o=yield t.read();return Rq(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}})()}}function Hq(r){return Qg(JSON.stringify({version:2,heartbeats:r})).length}!function cEe(r){so(new Ni("platform-logger",e=>new SMe(e),"PRIVATE")),so(new Ni("heartbeat",e=>new oEe(e),"PRIVATE")),_r(sT,"0.9.13",r),_r(sT,"0.9.13","esm2017"),_r("fire-js","")}("");var Je,lEe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ya={},dT=dT||{},Yt=lEe||self;function sm(r){var e=typeof r;return"array"==(e="object"!=e?e:r?Array.isArray(r)?"array":e:"null")||"object"==e&&"number"==typeof r.length}function kf(r){var e=typeof r;return"object"==e&&null!=r||"function"==e}var hT="closure_uid_"+(1e9*Math.random()>>>0),fEe=0;function dEe(r,e,t){return r.call.apply(r.bind,arguments)}function hEe(r,e,t){if(!r)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),r.apply(e,i)}}return function(){return r.apply(e,arguments)}}function Ai(r,e,t){return(Ai=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?dEe:hEe).apply(null,arguments)}function am(r,e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),r.apply(this,n)}}function b2(r,e){function t(){}t.prototype=e.prototype,r.$=e.prototype,r.prototype=new t,r.prototype.constructor=r,r.ac=function(n,i,o){for(var s=Array(arguments.length-2),a=2;a<arguments.length;a++)s[a-2]=arguments[a];return e.prototype[i].apply(n,s)}}function U4(){this.s=this.s,this.o=this.o}U4.prototype.s=!1,U4.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function uEe(r){Object.prototype.hasOwnProperty.call(r,hT)&&r[hT]||(r[hT]=++fEe)}(this)},U4.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Vq=Array.prototype.indexOf?function(r,e){return Array.prototype.indexOf.call(r,e,void 0)}:function(r,e){if("string"==typeof r)return"string"!=typeof e||1!=e.length?-1:r.indexOf(e,0);for(let t=0;t<r.length;t++)if(t in r&&r[t]===e)return t;return-1};function pT(r){const e=r.length;if(0<e){const t=Array(e);for(let n=0;n<e;n++)t[n]=r[n];return t}return[]}function Fq(r,e){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(sm(n)){const i=r.length||0,o=n.length||0;r.length=i+o;for(let s=0;s<o;s++)r[i+s]=n[s]}else r.push(n)}}function Ii(r,e){this.type=r,this.g=this.target=e,this.defaultPrevented=!1}Ii.prototype.h=function(){this.defaultPrevented=!0};var gEe=function(){if(!Yt.addEventListener||!Object.defineProperty)return!1;var r=!1,e=Object.defineProperty({},"passive",{get:function(){r=!0}});try{Yt.addEventListener("test",()=>{},e),Yt.removeEventListener("test",()=>{},e)}catch{}return r}();function xf(r){return/^[\s\xa0]*$/.test(r)}function cm(){var r=Yt.navigator;return r&&(r=r.userAgent)?r:""}function Sc(r){return-1!=cm().indexOf(r)}function gT(r){return gT[" "](r),r}gT[" "]=function(){};var _T,r,_Ee=Sc("Opera"),Q8=Sc("Trident")||Sc("MSIE"),$q=Sc("Edge"),mT=$q||Q8,Bq=Sc("Gecko")&&!(-1!=cm().toLowerCase().indexOf("webkit")&&!Sc("Edge"))&&!(Sc("Trident")||Sc("MSIE"))&&!Sc("Edge"),vEe=-1!=cm().toLowerCase().indexOf("webkit")&&!Sc("Edge");function Gq(){var r=Yt.document;return r?r.documentMode:void 0}e:{var vT="",CT=(r=cm(),Bq?/rv:([^\);]+)(\)|;)/.exec(r):$q?/Edge\/([\d\.]+)/.exec(r):Q8?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(r):vEe?/WebKit\/(\S+)/.exec(r):_Ee?/(?:Version)[ \/]?(\S+)/.exec(r):void 0);if(CT&&(vT=CT?CT[1]:""),Q8){var yT=Gq();if(null!=yT&&yT>parseFloat(vT)){_T=String(yT);break e}}_T=vT}var CEe=Yt.document&&Q8&&(Gq()||parseInt(_T,10))||void 0;function Lf(r,e){if(Ii.call(this,r?r.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,r){var t=this.type=r.type,n=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:null;if(this.target=r.target||r.srcElement,this.g=e,e=r.relatedTarget){if(Bq){e:{try{gT(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=r.fromElement:"mouseout"==t&&(e=r.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=r.button,this.key=r.key||"",this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.pointerId=r.pointerId||0,this.pointerType="string"==typeof r.pointerType?r.pointerType:yEe[r.pointerType]||"",this.state=r.state,this.i=r,r.defaultPrevented&&Lf.$.h.call(this)}}b2(Lf,Ii);var yEe={2:"touch",3:"pen",4:"mouse"};Lf.prototype.h=function(){Lf.$.h.call(this);var r=this.i;r.preventDefault?r.preventDefault():r.returnValue=!1};var Rf="closure_listenable_"+(1e6*Math.random()|0),MEe=0;function EEe(r,e,t,n,i){this.listener=r,this.proxy=null,this.src=e,this.type=t,this.capture=!!n,this.la=i,this.key=++MEe,this.fa=this.ia=!1}function lm(r){r.fa=!0,r.listener=null,r.proxy=null,r.src=null,r.la=null}function ET(r,e,t){for(const n in r)e.call(t,r[n],n,r)}function Wq(r){const e={};for(const t in r)e[t]=r[t];return e}const qq="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function jq(r,e){let t,n;for(let i=1;i<arguments.length;i++){for(t in n=arguments[i],n)r[t]=n[t];for(let o=0;o<qq.length;o++)t=qq[o],Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t])}}function um(r){this.src=r,this.g={},this.h=0}function ST(r,e){var t=e.type;if(t in r.g){var o,n=r.g[t],i=Vq(n,e);(o=0<=i)&&Array.prototype.splice.call(n,i,1),o&&(lm(e),0==r.g[t].length&&(delete r.g[t],r.h--))}}function PT(r,e,t,n){for(var i=0;i<r.length;++i){var o=r[i];if(!o.fa&&o.listener==e&&o.capture==!!t&&o.la==n)return i}return-1}um.prototype.add=function(r,e,t,n,i){var o=r.toString();(r=this.g[o])||(r=this.g[o]=[],this.h++);var s=PT(r,e,n,i);return-1<s?(e=r[s],t||(e.ia=!1)):((e=new EEe(e,this.src,o,!!n,i)).ia=t,r.push(e)),e};var TT="closure_lm_"+(1e6*Math.random()|0),OT={};function Zq(r,e,t,n,i){if(n&&n.once)return Kq(r,e,t,n,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Zq(r,e[o],t,n,i);return null}return t=AT(t),r&&r[Rf]?r.O(e,t,kf(n)?!!n.capture:!!n,i):Yq(r,e,t,!1,n,i)}function Yq(r,e,t,n,i,o){if(!e)throw Error("Invalid event type");var s=kf(i)?!!i.capture:!!i,a=wT(r);if(a||(r[TT]=a=new um(r)),(t=a.add(e,t,n,s,o)).proxy)return t;if(n=function PEe(){const e=TEe;return function r(t){return e.call(r.src,r.listener,t)}}(),t.proxy=n,n.src=r,n.listener=t,r.addEventListener)gEe||(i=s),void 0===i&&(i=!1),r.addEventListener(e.toString(),n,i);else if(r.attachEvent)r.attachEvent(Qq(e.toString()),n);else{if(!r.addListener||!r.removeListener)throw Error("addEventListener and attachEvent are unavailable.");r.addListener(n)}return t}function Kq(r,e,t,n,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Kq(r,e[o],t,n,i);return null}return t=AT(t),r&&r[Rf]?r.P(e,t,kf(n)?!!n.capture:!!n,i):Yq(r,e,t,!0,n,i)}function Xq(r,e,t,n,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Xq(r,e[o],t,n,i);else n=kf(n)?!!n.capture:!!n,t=AT(t),r&&r[Rf]?(r=r.i,(e=String(e).toString())in r.g&&-1<(t=PT(o=r.g[e],t,n,i))&&(lm(o[t]),Array.prototype.splice.call(o,t,1),0==o.length&&(delete r.g[e],r.h--))):r&&(r=wT(r))&&(e=r.g[e.toString()],r=-1,e&&(r=PT(e,t,n,i)),(t=-1<r?e[r]:null)&&bT(t))}function bT(r){if("number"!=typeof r&&r&&!r.fa){var e=r.src;if(e&&e[Rf])ST(e.i,r);else{var t=r.type,n=r.proxy;e.removeEventListener?e.removeEventListener(t,n,r.capture):e.detachEvent?e.detachEvent(Qq(t),n):e.addListener&&e.removeListener&&e.removeListener(n),(t=wT(e))?(ST(t,r),0==t.h&&(t.src=null,e[TT]=null)):lm(r)}}}function Qq(r){return r in OT?OT[r]:OT[r]="on"+r}function TEe(r,e){if(r.fa)r=!0;else{e=new Lf(e,this);var t=r.listener,n=r.la||r.src;r.ia&&bT(r),r=t.call(n,e)}return r}function wT(r){return(r=r[TT])instanceof um?r:null}var NT="__closure_events_fn_"+(1e9*Math.random()>>>0);function AT(r){return"function"==typeof r?r:(r[NT]||(r[NT]=function(e){return r.handleEvent(e)}),r[NT])}function w2(){U4.call(this),this.i=new um(this),this.S=this,this.J=null}function ti(r,e){var t,n=r.J;if(n)for(t=[];n;n=n.J)t.push(n);if(r=r.S,n=e.type||e,"string"==typeof e)e=new Ii(e,r);else if(e instanceof Ii)e.target=e.target||r;else{var i=e;jq(e=new Ii(n,r),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var s=e.g=t[o];i=fm(s,n,!0,e)&&i}if(i=fm(s=e.g=r,n,!0,e)&&i,i=fm(s,n,!1,e)&&i,t)for(o=0;o<t.length;o++)i=fm(s=e.g=t[o],n,!1,e)&&i}function fm(r,e,t,n){if(!(e=r.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.fa&&s.capture==t){var a=s.listener,c=s.la||s.src;s.ia&&ST(r.i,s),i=!1!==a.call(c,n)&&i}}return i&&!n.defaultPrevented}b2(w2,U4),w2.prototype[Rf]=!0,w2.prototype.removeEventListener=function(r,e,t,n){Xq(this,r,e,t,n)},w2.prototype.N=function(){if(w2.$.N.call(this),this.i){var e,r=this.i;for(e in r.g){for(var t=r.g[e],n=0;n<t.length;n++)lm(t[n]);delete r.g[e],r.h--}}this.J=null},w2.prototype.O=function(r,e,t,n){return this.i.add(String(r),e,!1,t,n)},w2.prototype.P=function(r,e,t,n){return this.i.add(String(r),e,!0,t,n)};var IT=Yt.JSON.stringify;function bEe(){var r=kT;let e=null;return r.g&&(e=r.g,r.g=r.g.next,r.g||(r.h=null),e.next=null),e}var Jq=new class OEe{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new NEe,r=>r.reset());class NEe{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function AEe(r){var e=1;r=r.split(":");const t=[];for(;0<e&&r.length;)t.push(r.shift()),e--;return r.length&&t.push(r.join(":")),t}function IEe(r){Yt.setTimeout(()=>{throw r},0)}let zf,Df=!1,kT=new class wEe{constructor(){this.h=this.g=null}add(e,t){const n=Jq.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},ej=()=>{const r=Yt.Promise.resolve(void 0);zf=()=>{r.then(kEe)}};var kEe=()=>{for(var r;r=bEe();){try{r.h.call(r.g)}catch(t){IEe(t)}var e=Jq;e.j(r),100>e.h&&(e.h++,r.next=e.g,e.g=r)}Df=!1};function dm(r,e){w2.call(this),this.h=r||1,this.g=e||Yt,this.j=Ai(this.qb,this),this.l=Date.now()}function xT(r){r.ga=!1,r.T&&(r.g.clearTimeout(r.T),r.T=null)}function LT(r,e,t){if("function"==typeof r)t&&(r=Ai(r,t));else{if(!r||"function"!=typeof r.handleEvent)throw Error("Invalid listener argument");r=Ai(r.handleEvent,r)}return 2147483647<Number(e)?-1:Yt.setTimeout(r,e||0)}function tj(r){r.g=LT(()=>{r.g=null,r.i&&(r.i=!1,tj(r))},r.j);const e=r.h;r.h=null,r.m.apply(null,e)}b2(dm,w2),(Je=dm.prototype).ga=!1,Je.T=null,Je.qb=function(){if(this.ga){var r=Date.now()-this.l;0<r&&r<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-r):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ti(this,"tick"),this.ga&&(xT(this),this.start()))}},Je.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Je.N=function(){dm.$.N.call(this),xT(this),delete this.g};class xEe extends U4{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:tj(this)}N(){super.N(),this.g&&(Yt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Hf(r){U4.call(this),this.h=r,this.g={}}b2(Hf,U4);var nj=[];function rj(r,e,t,n){Array.isArray(t)||(t&&(nj[0]=t.toString()),t=nj);for(var i=0;i<t.length;i++){var o=Zq(e,t[i],n||r.handleEvent,!1,r.h||r);if(!o)break;r.g[o.key]=o}}function ij(r){ET(r.g,function(e,t){this.g.hasOwnProperty(t)&&bT(e)},r),r.g={}}function hm(){this.g=!0}function J8(r,e,t,n){r.info(function(){return"XMLHTTP TEXT ("+e+"): "+function DEe(r,e){if(!r.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(r=0;r<t.length;r++)if(Array.isArray(t[r])){var n=t[r];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return IT(t)}catch{return e}}(r,t)+(n?" "+n:"")})}Hf.prototype.N=function(){Hf.$.N.call(this),ij(this)},Hf.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},hm.prototype.Ea=function(){this.g=!1},hm.prototype.info=function(){};var x6={},oj=null;function pm(){return oj=oj||new w2}function sj(r){Ii.call(this,x6.Ta,r)}function Vf(r){const e=pm();ti(e,new sj(e))}function aj(r,e){Ii.call(this,x6.STAT_EVENT,r),this.stat=e}function ao(r){const e=pm();ti(e,new aj(e,r))}function cj(r,e){Ii.call(this,x6.Ua,r),this.size=e}function Ff(r,e){if("function"!=typeof r)throw Error("Fn must not be null and must be a function");return Yt.setTimeout(function(){r()},e)}x6.Ta="serverreachability",b2(sj,Ii),x6.STAT_EVENT="statevent",b2(aj,Ii),x6.Ua="timingevent",b2(cj,Ii);var gm={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},lj={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function RT(){}function fj(){}RT.prototype.h=null;var HT,$f={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function zT(){Ii.call(this,"d")}function DT(){Ii.call(this,"c")}function mm(){}function Bf(r,e,t,n){this.l=r,this.j=e,this.m=t,this.W=n||1,this.U=new Hf(this),this.P=HEe,this.V=new dm(r=mT?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new dj}function dj(){this.i=null,this.g="",this.h=!1}b2(zT,Ii),b2(DT,Ii),b2(mm,RT),mm.prototype.g=function(){return new XMLHttpRequest},mm.prototype.i=function(){return{}},HT=new mm;var HEe=45e3,VT={},_m={};function FT(r,e,t){r.L=1,r.v=Mm(I3(e)),r.s=t,r.S=!0,hj(r,null)}function hj(r,e){r.G=Date.now(),Gf(r),r.A=I3(r.v);var t=r.A,n=r.W;Array.isArray(n)||(n=[String(n)]),Sj(t.i,"t",n),r.C=0,t=r.l.J,r.h=new dj,r.g=jj(r.l,t?e:null,!r.s),0<r.O&&(r.M=new xEe(Ai(r.Pa,r,r.g),r.O)),rj(r.U,r.g,"readystatechange",r.nb),e=r.I?Wq(r.I):{},r.s?(r.u||(r.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",r.g.ha(r.A,r.u,r.s,e)):(r.u="GET",r.g.ha(r.A,r.u,null,e)),Vf(),function LEe(r,e,t,n,i,o){r.info(function(){if(r.g)if(o)for(var s="",a=o.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var f=l[0];l=l[1];var d=f.split("_");s=2<=d.length&&"type"==d[1]?s+(f+"=")+l+"&":s+(f+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+e+"\n"+t+"\n"+s})}(r.j,r.u,r.A,r.m,r.W,r.s)}function pj(r){return!!r.g&&"GET"==r.u&&2!=r.L&&r.l.Ha}function gj(r,e,t){let i,n=!0;for(;!r.J&&r.C<t.length;){if(i=VEe(r,t),i==_m){4==e&&(r.o=4,ao(14),n=!1),J8(r.j,r.m,null,"[Incomplete Response]");break}if(i==VT){r.o=4,ao(15),J8(r.j,r.m,t,"[Invalid Chunk]"),n=!1;break}J8(r.j,r.m,i,null),$T(r,i)}pj(r)&&i!=_m&&i!=VT&&(r.h.g="",r.C=0),4!=e||0!=t.length||r.h.h||(r.o=1,ao(16),n=!1),r.i=r.i&&n,n?0<t.length&&!r.ba&&(r.ba=!0,(e=r.l).g==r&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),ZT(e),e.M=!0,ao(11))):(J8(r.j,r.m,t,"[Invalid Chunked Response]"),L6(r),Uf(r))}function VEe(r,e){var t=r.C,n=e.indexOf("\n",t);return-1==n?_m:(t=Number(e.substring(t,n)),isNaN(t)?VT:(n+=1)+t>e.length?_m:(e=e.slice(n,n+t),r.C=n+t,e))}function Gf(r){r.Y=Date.now()+r.P,mj(r,r.P)}function mj(r,e){if(null!=r.B)throw Error("WatchDog timer not null");r.B=Ff(Ai(r.lb,r),e)}function vm(r){r.B&&(Yt.clearTimeout(r.B),r.B=null)}function Uf(r){0==r.l.H||r.J||Gj(r.l,r)}function L6(r){vm(r);var e=r.M;e&&"function"==typeof e.sa&&e.sa(),r.M=null,xT(r.V),ij(r.U),r.g&&(e=r.g,r.g=null,e.abort(),e.sa())}function $T(r,e){try{var t=r.l;if(0!=t.H&&(t.g==r||BT(t.i,r)))if(!r.K&&BT(t.i,r)&&3==t.H){try{var n=t.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<r.G))break e;bm(t),Tm(t)}jT(t),ao(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=Ff(Ai(t.ib,t),6e3));if(1>=Oj(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else z6(t,11)}else if((r.K||t.g==r)&&bm(t),!xf(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(t.V=l[0],l=l[1],2==t.H)if("c"==l[0]){t.K=l[1],t.pa=l[2];const f=l[3];null!=f&&(t.ra=f,t.l.info("VER="+t.ra));const d=l[4];null!=d&&(t.Ga=d,t.l.info("SVER="+t.Ga));const m=l[5];null!=m&&"number"==typeof m&&0<m&&(t.L=n=1.5*m,t.l.info("backChannelRequestTimeoutMs_="+n)),n=t;const E=r.g;if(E){const w=E.g?E.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(w){var o=n.i;o.g||-1==w.indexOf("spdy")&&-1==w.indexOf("quic")&&-1==w.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(GT(o,o.h),o.h=null))}if(n.F){const L=E.g?E.g.getResponseHeader("X-HTTP-Session-Id"):null;L&&(n.Da=L,R1(n.I,n.F,L))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-r.G,t.l.info("Handshake RTT: "+t.S+"ms"));var s=r;if((n=t).wa=qj(n,n.J?n.pa:null,n.Y),s.K){bj(n.i,s);var a=s,c=n.L;c&&a.setTimeout(c),a.B&&(vm(a),Gf(a)),n.g=s}else $j(n);0<t.j.length&&Om(t)}else"stop"!=l[0]&&"close"!=l[0]||z6(t,7);else 3==t.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?z6(t,7):qT(t):"noop"!=l[0]&&t.h&&t.h.Aa(l),t.A=0)}Vf()}catch{}}function _j(r,e){if(r.forEach&&"function"==typeof r.forEach)r.forEach(e,void 0);else if(sm(r)||"string"==typeof r)Array.prototype.forEach.call(r,e,void 0);else for(var t=function $Ee(r){if(r.ta&&"function"==typeof r.ta)return r.ta();if(!r.Z||"function"!=typeof r.Z){if(typeof Map<"u"&&r instanceof Map)return Array.from(r.keys());if(!(typeof Set<"u"&&r instanceof Set)){if(sm(r)||"string"==typeof r){var e=[];r=r.length;for(var t=0;t<r;t++)e.push(t);return e}e=[],t=0;for(const n in r)e[t++]=n;return e}}}(r),n=function FEe(r){if(r.Z&&"function"==typeof r.Z)return r.Z();if(typeof Map<"u"&&r instanceof Map||typeof Set<"u"&&r instanceof Set)return Array.from(r.values());if("string"==typeof r)return r.split("");if(sm(r)){for(var e=[],t=r.length,n=0;n<t;n++)e.push(r[n]);return e}for(n in e=[],t=0,r)e[t++]=r[n];return e}(r),i=n.length,o=0;o<i;o++)e.call(void 0,n[o],t&&t[o],r)}(Je=Bf.prototype).setTimeout=function(r){this.P=r},Je.nb=function(r){r=r.target;const e=this.M;e&&3==Pc(r)?e.l():this.Pa(r)},Je.Pa=function(r){try{if(r==this.g)e:{const f=Pc(this.g);var e=this.g.Ia();if(this.g.da(),!(3>f)&&(3!=f||mT||this.g&&(this.h.h||this.g.ja()||Rj(this.g)))){this.J||4!=f||7==e||Vf(),vm(this);var t=this.g.da();this.ca=t;t:if(pj(this)){var n=Rj(this.g);r="";var i=n.length,o=4==Pc(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){L6(this),Uf(this);var s="";break t}this.h.i=new Yt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,r+=this.h.i.decode(n[e],{stream:o&&e==i-1});n.splice(0,i),this.h.g+=r,this.C=0,s=this.h.g}else s=this.g.ja();if(this.i=200==t,function REe(r,e,t,n,i,o,s){r.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+o+" "+s})}(this.j,this.u,this.A,this.m,this.W,f,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!xf(a)){var l=a;break t}}l=null}if(!(t=l)){this.i=!1,this.o=3,ao(12),L6(this),Uf(this);break e}J8(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$T(this,t)}this.S?(gj(this,f,s),mT&&this.i&&3==f&&(rj(this.U,this.V,"tick",this.mb),this.V.start())):(J8(this.j,this.m,s,null),$T(this,s)),4==f&&L6(this),this.i&&!this.J&&(4==f?Gj(this.l,this):(this.i=!1,Gf(this)))}else(function oSe(r){const e={};r=(r.g&&2<=Pc(r)&&r.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<r.length;n++){if(xf(r[n]))continue;var t=AEe(r[n]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const o=e[i]||[];e[i]=o,o.push(t)}!function SEe(r,e){for(const t in r)e.call(void 0,r[t],t,r)}(e,function(n){return n.join(", ")})})(this.g),400==t&&0<s.indexOf("Unknown SID")?(this.o=3,ao(12)):(this.o=0,ao(13)),L6(this),Uf(this)}}}catch{}},Je.mb=function(){if(this.g){var r=Pc(this.g),e=this.g.ja();this.C<e.length&&(vm(this),gj(this,r,e),this.i&&4!=r&&Gf(this))}},Je.cancel=function(){this.J=!0,L6(this)},Je.lb=function(){this.B=null;const r=Date.now();0<=r-this.Y?(function zEe(r,e){r.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(Vf(),ao(17)),L6(this),this.o=2,Uf(this)):mj(this,this.Y-r)};var vj=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function R6(r){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,r instanceof R6){this.h=r.h,Cm(this,r.j),this.s=r.s,this.g=r.g,ym(this,r.m),this.l=r.l;var e=r.i,t=new jf;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Cj(this,t),this.o=r.o}else r&&(e=String(r).match(vj))?(this.h=!1,Cm(this,e[1]||"",!0),this.s=Wf(e[2]||""),this.g=Wf(e[3]||"",!0),ym(this,e[4]),this.l=Wf(e[5]||"",!0),Cj(this,e[6]||"",!0),this.o=Wf(e[7]||"")):(this.h=!1,this.i=new jf(null,this.h))}function I3(r){return new R6(r)}function Cm(r,e,t){r.j=t?Wf(e,!0):e,r.j&&(r.j=r.j.replace(/:$/,""))}function ym(r,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);r.m=e}else r.m=null}function Cj(r,e,t){e instanceof jf?(r.i=e,function ZEe(r,e){e&&!r.j&&(W4(r),r.i=null,r.g.forEach(function(t,n){var i=n.toLowerCase();n!=i&&(Mj(this,n),Sj(this,i,t))},r)),r.j=e}(r.i,r.h)):(t||(e=qf(e,qEe)),r.i=new jf(e,r.h))}function R1(r,e,t){r.i.set(e,t)}function Mm(r){return R1(r,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),r}function Wf(r,e){return r?e?decodeURI(r.replace(/%25/g,"%2525")):decodeURIComponent(r):""}function qf(r,e,t){return"string"==typeof r?(r=encodeURI(r).replace(e,GEe),t&&(r=r.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r):null}function GEe(r){return"%"+((r=r.charCodeAt(0))>>4&15).toString(16)+(15&r).toString(16)}R6.prototype.toString=function(){var r=[],e=this.j;e&&r.push(qf(e,yj,!0),":");var t=this.g;return(t||"file"==e)&&(r.push("//"),(e=this.s)&&r.push(qf(e,yj,!0),"@"),r.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&r.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&r.push("/"),r.push(qf(t,"/"==t.charAt(0)?WEe:UEe,!0))),(t=this.i.toString())&&r.push("?",t),(t=this.o)&&r.push("#",qf(t,jEe)),r.join("")};var yj=/[#\/\?@]/g,UEe=/[#\?:]/g,WEe=/[#\?]/g,qEe=/[#\?@]/g,jEe=/#/g;function jf(r,e){this.h=this.g=null,this.i=r||null,this.j=!!e}function W4(r){r.g||(r.g=new Map,r.h=0,r.i&&function BEe(r,e){if(r){r=r.split("&");for(var t=0;t<r.length;t++){var n=r[t].indexOf("="),i=null;if(0<=n){var o=r[t].substring(0,n);i=r[t].substring(n+1)}else o=r[t];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(r.i,function(e,t){r.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Mj(r,e){W4(r),e=e5(r,e),r.g.has(e)&&(r.i=null,r.h-=r.g.get(e).length,r.g.delete(e))}function Ej(r,e){return W4(r),e=e5(r,e),r.g.has(e)}function Sj(r,e,t){Mj(r,e),0<t.length&&(r.i=null,r.g.set(e5(r,e),pT(t)),r.h+=t.length)}function e5(r,e){return e=String(e),r.j&&(e=e.toLowerCase()),e}function Pj(r){this.l=r||KEe,r=Yt.PerformanceNavigationTiming?0<(r=Yt.performance.getEntriesByType("navigation")).length&&("hq"==r[0].nextHopProtocol||"h2"==r[0].nextHopProtocol):!!(Yt.g&&Yt.g.Ka&&Yt.g.Ka()&&Yt.g.Ka().ec),this.j=r?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Je=jf.prototype).add=function(r,e){W4(this),this.i=null,r=e5(this,r);var t=this.g.get(r);return t||this.g.set(r,t=[]),t.push(e),this.h+=1,this},Je.forEach=function(r,e){W4(this),this.g.forEach(function(t,n){t.forEach(function(i){r.call(e,i,n,this)},this)},this)},Je.ta=function(){W4(this);const r=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let n=0;n<e.length;n++){const i=r[n];for(let o=0;o<i.length;o++)t.push(e[n])}return t},Je.Z=function(r){W4(this);let e=[];if("string"==typeof r)Ej(this,r)&&(e=e.concat(this.g.get(e5(this,r))));else{r=Array.from(this.g.values());for(let t=0;t<r.length;t++)e=e.concat(r[t])}return e},Je.set=function(r,e){return W4(this),this.i=null,Ej(this,r=e5(this,r))&&(this.h-=this.g.get(r).length),this.g.set(r,[e]),this.h+=1,this},Je.get=function(r,e){return r&&0<(r=this.Z(r)).length?String(r[0]):e},Je.toString=function(){if(this.i)return this.i;if(!this.g)return"";const r=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var n=e[t];const o=encodeURIComponent(String(n)),s=this.Z(n);for(n=0;n<s.length;n++){var i=o;""!==s[n]&&(i+="="+encodeURIComponent(String(s[n]))),r.push(i)}}return this.i=r.join("&")};var KEe=10;function Tj(r){return!!r.h||!!r.g&&r.g.size>=r.j}function Oj(r){return r.h?1:r.g?r.g.size:0}function BT(r,e){return r.h?r.h==e:!!r.g&&r.g.has(e)}function GT(r,e){r.g?r.g.add(e):r.h=e}function bj(r,e){r.h&&r.h==e?r.h=null:r.g&&r.g.has(e)&&r.g.delete(e)}function wj(r){if(null!=r.h)return r.i.concat(r.h.F);if(null!=r.g&&0!==r.g.size){let e=r.i;for(const t of r.g.values())e=e.concat(t.F);return e}return pT(r.i)}Pj.prototype.cancel=function(){if(this.i=wj(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const r of this.g.values())r.cancel();this.g.clear()}};var XEe=class{stringify(r){return Yt.JSON.stringify(r,void 0)}parse(r){return Yt.JSON.parse(r,void 0)}};function QEe(){this.g=new XEe}function JEe(r,e,t){const n=t||"";try{_j(r,function(i,o){let s=i;kf(i)&&(s=IT(i)),e.push(n+o+"="+encodeURIComponent(s))})}catch(i){throw e.push(n+"type="+encodeURIComponent("_badmap")),i}}function Em(r,e,t,n,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(n)}catch{}}function Zf(r){this.l=r.fc||null,this.j=r.ob||!1}function Sm(r,e){w2.call(this),this.F=r,this.u=e,this.m=void 0,this.readyState=UT,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}b2(Zf,RT),Zf.prototype.g=function(){return new Sm(this.l,this.j)},Zf.prototype.i=function(r){return function(){return r}}({}),b2(Sm,w2);var UT=0;function Nj(r){r.j.read().then(r.Xa.bind(r)).catch(r.ka.bind(r))}function Yf(r){r.readyState=4,r.l=null,r.j=null,r.A=null,Kf(r)}function Kf(r){r.onreadystatechange&&r.onreadystatechange.call(r)}(Je=Sm.prototype).open=function(r,e){if(this.readyState!=UT)throw this.abort(),Error("Error reopening a connection");this.C=r,this.B=e,this.readyState=1,Kf(this)},Je.send=function(r){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};r&&(e.body=r),(this.F||Yt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Je.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Yf(this)),this.readyState=UT},Je.$a=function(r){if(this.g&&(this.l=r,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=r.headers,this.readyState=2,Kf(this)),this.g&&(this.readyState=3,Kf(this),this.g)))if("arraybuffer"===this.responseType)r.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Yt.ReadableStream<"u"&&"body"in r){if(this.j=r.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Nj(this)}else r.text().then(this.Za.bind(this),this.ka.bind(this))},Je.Xa=function(r){if(this.g){if(this.u&&r.value)this.response.push(r.value);else if(!this.u){var e=r.value?r.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!r.done}))&&(this.response=this.responseText+=e)}r.done?Yf(this):Kf(this),3==this.readyState&&Nj(this)}},Je.Za=function(r){this.g&&(this.response=this.responseText=r,Yf(this))},Je.Ya=function(r){this.g&&(this.response=r,Yf(this))},Je.ka=function(){this.g&&Yf(this)},Je.setRequestHeader=function(r,e){this.v.append(r,e)},Je.getResponseHeader=function(r){return this.h&&this.h.get(r.toLowerCase())||""},Je.getAllResponseHeaders=function(){if(!this.h)return"";const r=[],e=this.h.entries();for(var t=e.next();!t.done;)r.push((t=t.value)[0]+": "+t[1]),t=e.next();return r.join("\r\n")},Object.defineProperty(Sm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(r){this.m=r?"include":"same-origin"}});var tSe=Yt.JSON.parse;function vr(r){w2.call(this),this.headers=new Map,this.u=r||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Aj,this.L=this.M=!1}b2(vr,w2);var Aj="",nSe=/^https?$/i,rSe=["POST","PUT"];function Ij(r,e){r.h=!1,r.g&&(r.l=!0,r.g.abort(),r.l=!1),r.j=e,r.m=5,kj(r),Pm(r)}function kj(r){r.F||(r.F=!0,ti(r,"complete"),ti(r,"error"))}function xj(r){if(r.h&&typeof dT<"u"&&(!r.C[1]||4!=Pc(r)||2!=r.da()))if(r.v&&4==Pc(r))LT(r.La,0,r);else if(ti(r,"readystatechange"),4==Pc(r)){r.h=!1;try{const s=r.da();e:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var n;if(n=0===s){var i=String(r.I).match(vj)[1]||null;!i&&Yt.self&&Yt.self.location&&(i=Yt.self.location.protocol.slice(0,-1)),n=!nSe.test(i?i.toLowerCase():"")}t=n}if(t)ti(r,"complete"),ti(r,"success");else{r.m=6;try{var o=2<Pc(r)?r.g.statusText:""}catch{o=""}r.j=o+" ["+r.da()+"]",kj(r)}}finally{Pm(r)}}}function Pm(r,e){if(r.g){Lj(r);const t=r.g,n=r.C[0]?()=>{}:null;r.g=null,r.C=null,e||ti(r,"ready");try{t.onreadystatechange=n}catch{}}}function Lj(r){r.g&&r.L&&(r.g.ontimeout=null),r.A&&(Yt.clearTimeout(r.A),r.A=null)}function Pc(r){return r.g?r.g.readyState:0}function Rj(r){try{if(!r.g)return null;if("response"in r.g)return r.g.response;switch(r.K){case Aj:case"text":return r.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in r.g)return r.g.mozResponseArrayBuffer}return null}catch{return null}}function zj(r){let e="";return ET(r,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function WT(r,e,t){e:{for(n in t){var n=!1;break e}n=!0}n||(t=zj(t),"string"==typeof r?null!=t&&encodeURIComponent(String(t)):R1(r,e,t))}function Xf(r,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[r]||e}function Dj(r){this.Ga=0,this.j=[],this.l=new hm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Xf("failFast",!1,r),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Xf("baseRetryDelayMs",5e3,r),this.hb=Xf("retryDelaySeedMs",1e4,r),this.eb=Xf("forwardChannelMaxRetries",2,r),this.xa=Xf("forwardChannelRequestTimeoutMs",2e4,r),this.va=r&&r.xmlHttpFactory||void 0,this.Ha=r&&r.dc||!1,this.L=void 0,this.J=r&&r.supportsCrossDomainXhr||!1,this.K="",this.i=new Pj(r&&r.concurrentRequestLimit),this.Ja=new QEe,this.P=r&&r.fastHandshake||!1,this.O=r&&r.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=r&&r.bc||!1,r&&r.Ea&&this.l.Ea(),r&&r.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&r&&r.detectBufferingProxy||!1,this.qa=void 0,r&&r.longPollingTimeout&&0<r.longPollingTimeout&&(this.qa=r.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function qT(r){if(Hj(r),3==r.H){var e=r.W++,t=I3(r.I);if(R1(t,"SID",r.K),R1(t,"RID",e),R1(t,"TYPE","terminate"),Qf(r,t),(e=new Bf(r,r.l,e)).L=2,e.v=Mm(I3(t)),t=!1,Yt.navigator&&Yt.navigator.sendBeacon)try{t=Yt.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&Yt.Image&&((new Image).src=e.v,t=!0),t||(e.g=jj(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Gf(e)}Wj(r)}function Tm(r){r.g&&(ZT(r),r.g.cancel(),r.g=null)}function Hj(r){Tm(r),r.u&&(Yt.clearTimeout(r.u),r.u=null),bm(r),r.i.cancel(),r.m&&("number"==typeof r.m&&Yt.clearTimeout(r.m),r.m=null)}function Om(r){if(!Tj(r.i)&&!r.m){r.m=!0;var e=r.Na;zf||ej(),Df||(zf(),Df=!0),kT.add(e,r),r.C=0}}function Vj(r,e){var t;t=e?e.m:r.W++;const n=I3(r.I);R1(n,"SID",r.K),R1(n,"RID",t),R1(n,"AID",r.V),Qf(r,n),r.o&&r.s&&WT(n,r.o,r.s),t=new Bf(r,r.l,t,r.C+1),null===r.o&&(t.I=r.s),e&&(r.j=e.F.concat(r.j)),e=Fj(r,t,1e3),t.setTimeout(Math.round(.5*r.xa)+Math.round(.5*r.xa*Math.random())),GT(r.i,t),FT(t,n,e)}function Qf(r,e){r.na&&ET(r.na,function(t,n){R1(e,n,t)}),r.h&&_j({},function(t,n){R1(e,n,t)})}function Fj(r,e,t){t=Math.min(r.j.length,t);var n=r.h?Ai(r.h.Va,r.h,r):null;e:{var i=r.j;let o=-1;for(;;){const s=["count="+t];-1==o?0<t?(o=i[0].g,s.push("ofs="+o)):o=0:s.push("ofs="+o);let a=!0;for(let c=0;c<t;c++){let l=i[c].g;const f=i[c].map;if(l-=o,0>l)o=Math.max(0,i[c].g-100),a=!1;else try{JEe(f,s,"req"+l+"_")}catch{n&&n(f)}}if(a){n=s.join("&");break e}}}return r=r.j.splice(0,t),e.F=r,n}function $j(r){if(!r.g&&!r.u){r.ba=1;var e=r.Ma;zf||ej(),Df||(zf(),Df=!0),kT.add(e,r),r.A=0}}function jT(r){return!(r.g||r.u||3<=r.A||(r.ba++,r.u=Ff(Ai(r.Ma,r),Uj(r,r.A)),r.A++,0))}function ZT(r){null!=r.B&&(Yt.clearTimeout(r.B),r.B=null)}function Bj(r){r.g=new Bf(r,r.l,"rpc",r.ba),null===r.o&&(r.g.I=r.s),r.g.O=0;var e=I3(r.wa);R1(e,"RID","rpc"),R1(e,"SID",r.K),R1(e,"AID",r.V),R1(e,"CI",r.G?"0":"1"),!r.G&&r.qa&&R1(e,"TO",r.qa),R1(e,"TYPE","xmlhttp"),Qf(r,e),r.o&&r.s&&WT(e,r.o,r.s),r.L&&r.g.setTimeout(r.L);var t=r.g;r=r.pa,t.L=1,t.v=Mm(I3(e)),t.s=null,t.S=!0,hj(t,r)}function bm(r){null!=r.v&&(Yt.clearTimeout(r.v),r.v=null)}function Gj(r,e){var t=null;if(r.g==e){bm(r),ZT(r),r.g=null;var n=2}else{if(!BT(r.i,e))return;t=e.F,bj(r.i,e),n=1}if(0!=r.H)if(e.i)if(1==n){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=r.C;ti(n=pm(),new cj(n,t)),Om(r)}else $j(r);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==n&&function sSe(r,e){return!(Oj(r.i)>=r.i.j-(r.m?1:0)||(r.m?(r.j=e.F.concat(r.j),0):1==r.H||2==r.H||r.C>=(r.cb?0:r.eb)||(r.m=Ff(Ai(r.Na,r,e),Uj(r,r.C)),r.C++,0)))}(r,e)||2==n&&jT(r)))switch(t&&0<t.length&&(e=r.i,e.i=e.i.concat(t)),i){case 1:z6(r,5);break;case 4:z6(r,10);break;case 3:z6(r,6);break;default:z6(r,2)}}function Uj(r,e){let t=r.ab+Math.floor(Math.random()*r.hb);return r.isActive()||(t*=2),t*e}function z6(r,e){if(r.l.info("Error code "+e),2==e){var t=null;r.h&&(t=null);var n=Ai(r.pb,r);t||(t=new R6("//www.google.com/images/cleardot.gif"),Yt.location&&"http"==Yt.location.protocol||Cm(t,"https"),Mm(t)),function eSe(r,e){const t=new hm;if(Yt.Image){const n=new Image;n.onload=am(Em,t,n,"TestLoadImage: loaded",!0,e),n.onerror=am(Em,t,n,"TestLoadImage: error",!1,e),n.onabort=am(Em,t,n,"TestLoadImage: abort",!1,e),n.ontimeout=am(Em,t,n,"TestLoadImage: timeout",!1,e),Yt.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=r}else e(!1)}(t.toString(),n)}else ao(2);r.H=0,r.h&&r.h.za(e),Wj(r),Hj(r)}function Wj(r){if(r.H=0,r.ma=[],r.h){const e=wj(r.i);(0!=e.length||0!=r.j.length)&&(Fq(r.ma,e),Fq(r.ma,r.j),r.i.i.length=0,pT(r.j),r.j.length=0),r.h.ya()}}function qj(r,e,t){var n=t instanceof R6?I3(t):new R6(t);if(""!=n.g)e&&(n.g=e+"."+n.g),ym(n,n.m);else{var i=Yt.location;n=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var o=new R6(null);n&&Cm(o,n),e&&(o.g=e),i&&ym(o,i),t&&(o.l=t),n=o}return e=r.Da,(t=r.F)&&e&&R1(n,t,e),R1(n,"VER",r.ra),Qf(r,n),n}function jj(r,e,t){if(e&&!r.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new vr(t&&r.Ha&&!r.va?new Zf({ob:!0}):r.va)).Oa(r.J),e}function Zj(){}function wm(){if(Q8&&!(10<=Number(CEe)))throw Error("Environmental error: no available transport.")}function ss(r,e){w2.call(this),this.g=new Dj(e),this.l=r,this.h=e&&e.messageUrlParams||null,r=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(r?r["X-Client-Protocol"]="webchannel":r={"X-Client-Protocol":"webchannel"}),this.g.s=r,r=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(r?r["X-WebChannel-Content-Type"]=e.messageContentType:r={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(r?r["X-WebChannel-Client-Profile"]=e.Ca:r={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=r,(r=e&&e.cc)&&!xf(r)&&(this.g.o=r),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!xf(e)&&(this.g.F=e,null!==(r=this.h)&&e in r&&e in(r=this.h)&&delete r[e]),this.j=new t5(this)}function Yj(r){zT.call(this),r.__headers__&&(this.headers=r.__headers__,this.statusCode=r.__status__,delete r.__headers__,delete r.__status__);var e=r.__sm__;if(e){e:{for(const t in e){r=t;break e}r=void 0}(this.i=r)&&(r=this.i,e=null!==e&&r in e?e[r]:void 0),this.data=e}else this.data=r}function Kj(){DT.call(this),this.status=1}function t5(r){this.g=r}function Ma(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function YT(r,e,t){t||(t=0);var n=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)n[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)n[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var o=r.g[3],s=(e=r.g[0])+(o^(t=r.g[1])&((i=r.g[2])^o))+n[0]+3614090360&4294967295;s=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=(t=(i=(o=(e=t+(s<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^t&(i^o))+n[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^t&(i^o))+n[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=e+(o^t&(i^o))+n[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^e&(t^i))+n[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(t^o&(e^t))+n[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=t+(e^i&(o^e))+n[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=e+(i^o&(t^i))+n[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=e+(i^o&(t^i))+n[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=e+(i^o&(t^i))+n[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=e+(i^o&(t^i))+n[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=o+(t^i&(e^t))+n[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(e^t&(o^e))+n[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=t+(o^e&(i^o))+n[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=e+(t^i^o)+n[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=e+(t^i^o)+n[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=e+(t^i^o)+n[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=e+(t^i^o)+n[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=o+(e^t^i)+n[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^e^t)+n[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=t+(i^o^e)+n[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=e+(i^(t|~o))+n[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(e^(o|~t))+n[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=t+(o^(i|~e))+n[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=e+(i^(t|~o))+n[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(e^(o|~t))+n[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=t+(o^(i|~e))+n[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=e+(i^(t|~o))+n[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(e^(o|~t))+n[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=t+(o^(i|~e))+n[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((o=(e=t+((s=e+(i^(t|~o))+n[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=o+(t^(e|~i))+n[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=o+((s=i+(e^(o|~t))+n[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~e))+n[9]+3951481745&4294967295,r.g[0]=r.g[0]+e&4294967295,r.g[1]=r.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,r.g[2]=r.g[2]+i&4294967295,r.g[3]=r.g[3]+o&4294967295}function a1(r,e){this.h=e;for(var t=[],n=!0,i=r.length-1;0<=i;i--){var o=0|r[i];n&&o==e||(t[i]=o,n=!1)}this.g=t}(Je=vr.prototype).Oa=function(r){this.M=r},Je.ha=function(r,e,t,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+r);e=e?e.toUpperCase():"GET",this.I=r,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():HT.g(),this.C=function uj(r){return r.h||(r.h=r.i())}(this.u?this.u:HT),this.g.onreadystatechange=Ai(this.La,this);try{this.G=!0,this.g.open(e,String(r),!0),this.G=!1}catch(o){return void Ij(this,o)}if(r=t||"",t=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)t.set(i,n[i]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const o of n.keys())t.set(o,n.get(o))}n=Array.from(t.keys()).find(o=>"content-type"==o.toLowerCase()),i=Yt.FormData&&r instanceof Yt.FormData,!(0<=Vq(rSe,e))||n||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,s]of t)this.g.setRequestHeader(o,s);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Lj(this),0<this.B&&((this.L=function iSe(r){return Q8&&"number"==typeof r.timeout&&void 0!==r.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ai(this.ua,this)):this.A=LT(this.ua,this.B,this)),this.v=!0,this.g.send(r),this.v=!1}catch(o){Ij(this,o)}},Je.ua=function(){typeof dT<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ti(this,"timeout"),this.abort(8))},Je.abort=function(r){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=r||7,ti(this,"complete"),ti(this,"abort"),Pm(this))},Je.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Pm(this,!0)),vr.$.N.call(this)},Je.La=function(){this.s||(this.G||this.v||this.l?xj(this):this.kb())},Je.kb=function(){xj(this)},Je.isActive=function(){return!!this.g},Je.da=function(){try{return 2<Pc(this)?this.g.status:-1}catch{return-1}},Je.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},Je.Wa=function(r){if(this.g){var e=this.g.responseText;return r&&0==e.indexOf(r)&&(e=e.substring(r.length)),tSe(e)}},Je.Ia=function(){return this.m},Je.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Je=Dj.prototype).ra=8,Je.H=1,Je.Na=function(r){if(this.m)if(this.m=null,1==this.H){if(!r){this.W=Math.floor(1e5*Math.random()),r=this.W++;const i=new Bf(this,this.l,r);let o=this.s;if(this.U&&(o?(o=Wq(o),jq(o,this.U)):o=this.U),null!==this.o||this.O||(i.I=o,o=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var n=this.j[t];if(void 0===(n="__data__"in n.map&&"string"==typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Fj(this,i,e),R1(t=I3(this.I),"RID",r),R1(t,"CVER",22),this.F&&R1(t,"X-HTTP-Session-Id",this.F),Qf(this,t),o&&(this.O?e="headers="+encodeURIComponent(String(zj(o)))+"&"+e:this.o&&WT(t,this.o,o)),GT(this.i,i),this.bb&&R1(t,"TYPE","init"),this.P?(R1(t,"$req",e),R1(t,"SID","null"),i.aa=!0,FT(i,t,null)):FT(i,t,e),this.H=2}}else 3==this.H&&(r?Vj(this,r):0==this.j.length||Tj(this.i)||Vj(this))},Je.Ma=function(){if(this.u=null,Bj(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var r=2*this.S;this.l.info("BP detection timer enabled: "+r),this.B=Ff(Ai(this.jb,this),r)}},Je.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,ao(10),Tm(this),Bj(this))},Je.ib=function(){null!=this.v&&(this.v=null,Tm(this),jT(this),ao(19))},Je.pb=function(r){r?(this.l.info("Successfully pinged google.com"),ao(2)):(this.l.info("Failed to ping google.com"),ao(1))},Je.isActive=function(){return!!this.h&&this.h.isActive(this)},(Je=Zj.prototype).Ba=function(){},Je.Aa=function(){},Je.za=function(){},Je.ya=function(){},Je.isActive=function(){return!0},Je.Va=function(){},wm.prototype.g=function(r,e){return new ss(r,e)},b2(ss,w2),ss.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var r=this.g,e=this.l,t=this.h||void 0;ao(0),r.Y=e,r.na=t||{},r.G=r.aa,r.I=qj(r,null,r.Y),Om(r)},ss.prototype.close=function(){qT(this.g)},ss.prototype.u=function(r){var e=this.g;if("string"==typeof r){var t={};t.__data__=r,r=t}else this.v&&((t={}).__data__=IT(r),r=t);e.j.push(new class{constructor(r,e){this.g=r,this.map=e}}(e.fb++,r)),3==e.H&&Om(e)},ss.prototype.N=function(){this.g.h=null,delete this.j,qT(this.g),delete this.g,ss.$.N.call(this)},b2(Yj,zT),b2(Kj,DT),b2(t5,Zj),t5.prototype.Ba=function(){ti(this.g,"a")},t5.prototype.Aa=function(r){ti(this.g,new Yj(r))},t5.prototype.za=function(r){ti(this.g,new Kj)},t5.prototype.ya=function(){ti(this.g,"b")},b2(Ma,function aSe(){this.blockSize=-1}),Ma.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ma.prototype.j=function(r,e){void 0===e&&(e=r.length);for(var t=e-this.blockSize,n=this.m,i=this.h,o=0;o<e;){if(0==i)for(;o<=t;)YT(this,r,o),o+=this.blockSize;if("string"==typeof r){for(;o<e;)if(n[i++]=r.charCodeAt(o++),i==this.blockSize){YT(this,n),i=0;break}}else for(;o<e;)if(n[i++]=r[o++],i==this.blockSize){YT(this,n),i=0;break}}this.h=i,this.i+=e},Ma.prototype.l=function(){var r=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);r[0]=128;for(var e=1;e<r.length-8;++e)r[e]=0;var t=8*this.i;for(e=r.length-8;e<r.length;++e)r[e]=255&t,t/=256;for(this.j(r),r=Array(16),e=t=0;4>e;++e)for(var n=0;32>n;n+=8)r[t++]=this.g[e]>>>n&255;return r};var cSe={};function KT(r){return-128<=r&&128>r?function mEe(r,e){var t=cSe;return Object.prototype.hasOwnProperty.call(t,r)?t[r]:t[r]=e(r)}(r,function(e){return new a1([0|e],0>e?-1:0)}):new a1([0|r],0>r?-1:0)}function Tc(r){if(isNaN(r)||!isFinite(r))return n5;if(0>r)return ni(Tc(-r));for(var e=[],t=1,n=0;r>=t;n++)e[n]=r/t|0,t*=XT;return new a1(e,0)}var XT=4294967296,n5=KT(0),QT=KT(1),Qj=KT(16777216);function k3(r){if(0!=r.h)return!1;for(var e=0;e<r.g.length;e++)if(0!=r.g[e])return!1;return!0}function Rs(r){return-1==r.h}function ni(r){for(var e=r.g.length,t=[],n=0;n<e;n++)t[n]=~r.g[n];return new a1(t,~r.h).add(QT)}function Nm(r,e){return r.add(ni(e))}function Am(r,e){for(;(65535&r[e])!=r[e];)r[e+1]+=r[e]>>>16,r[e]&=65535,e++}function Jf(r,e){this.g=r,this.h=e}function Im(r,e){if(k3(e))throw Error("division by zero");if(k3(r))return new Jf(n5,n5);if(Rs(r))return e=Im(ni(r),e),new Jf(ni(e.g),ni(e.h));if(Rs(e))return e=Im(r,ni(e)),new Jf(ni(e.g),e.h);if(30<r.g.length){if(Rs(r)||Rs(e))throw Error("slowDivide_ only works with positive integers.");for(var t=QT,n=e;0>=n.X(r);)t=Jj(t),n=Jj(n);var i=r5(t,1),o=r5(n,1);for(n=r5(n,2),t=r5(t,2);!k3(n);){var s=o.add(n);0>=s.X(r)&&(i=i.add(t),o=s),n=r5(n,1),t=r5(t,1)}return e=Nm(r,i.R(e)),new Jf(i,e)}for(i=n5;0<=r.X(e);){for(t=Math.max(1,Math.floor(r.ea()/e.ea())),n=48>=(n=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,n-48),s=(o=Tc(t)).R(e);Rs(s)||0<s.X(r);)s=(o=Tc(t-=n)).R(e);k3(o)&&(o=QT),i=i.add(o),r=Nm(r,s)}return new Jf(i,r)}function Jj(r){for(var e=r.g.length+1,t=[],n=0;n<e;n++)t[n]=r.D(n)<<1|r.D(n-1)>>>31;return new a1(t,r.h)}function r5(r,e){var t=e>>5;e%=32;for(var n=r.g.length-t,i=[],o=0;o<n;o++)i[o]=0<e?r.D(o+t)>>>e|r.D(o+t+1)<<32-e:r.D(o+t);return new a1(i,r.h)}(Je=a1.prototype).ea=function(){if(Rs(this))return-ni(this).ea();for(var r=0,e=1,t=0;t<this.g.length;t++){var n=this.D(t);r+=(0<=n?n:XT+n)*e,e*=XT}return r},Je.toString=function(r){if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if(k3(this))return"0";if(Rs(this))return"-"+ni(this).toString(r);for(var e=Tc(Math.pow(r,6)),t=this,n="";;){var i=Im(t,e).g,o=((0<(t=Nm(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(r);if(k3(t=i))return o+n;for(;6>o.length;)o="0"+o;n=o+n}},Je.D=function(r){return 0>r?0:r<this.g.length?this.g[r]:this.h},Je.X=function(r){return Rs(r=Nm(this,r))?-1:k3(r)?0:1},Je.abs=function(){return Rs(this)?ni(this):this},Je.add=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0,i=0;i<=e;i++){var o=n+(65535&this.D(i))+(65535&r.D(i)),s=(o>>>16)+(this.D(i)>>>16)+(r.D(i)>>>16);n=s>>>16,t[i]=(s&=65535)<<16|(o&=65535)}return new a1(t,-2147483648&t[t.length-1]?-1:0)},Je.R=function(r){if(k3(this)||k3(r))return n5;if(Rs(this))return Rs(r)?ni(this).R(ni(r)):ni(ni(this).R(r));if(Rs(r))return ni(this.R(ni(r)));if(0>this.X(Qj)&&0>r.X(Qj))return Tc(this.ea()*r.ea());for(var e=this.g.length+r.g.length,t=[],n=0;n<2*e;n++)t[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<r.g.length;i++){var o=this.D(n)>>>16,s=65535&this.D(n),a=r.D(i)>>>16,c=65535&r.D(i);t[2*n+2*i]+=s*c,Am(t,2*n+2*i),t[2*n+2*i+1]+=o*c,Am(t,2*n+2*i+1),t[2*n+2*i+1]+=s*a,Am(t,2*n+2*i+1),t[2*n+2*i+2]+=o*a,Am(t,2*n+2*i+2)}for(n=0;n<e;n++)t[n]=t[2*n+1]<<16|t[2*n];for(n=e;n<2*e;n++)t[n]=0;return new a1(t,0)},Je.gb=function(r){return Im(this,r).h},Je.and=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)&r.D(n);return new a1(t,this.h&r.h)},Je.or=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)|r.D(n);return new a1(t,this.h|r.h)},Je.xor=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)^r.D(n);return new a1(t,this.h^r.h)},wm.prototype.createWebChannel=wm.prototype.g,ss.prototype.send=ss.prototype.u,ss.prototype.open=ss.prototype.m,ss.prototype.close=ss.prototype.close,gm.NO_ERROR=0,gm.TIMEOUT=8,gm.HTTP_ERROR=6,lj.COMPLETE="complete",fj.EventType=$f,$f.OPEN="a",$f.CLOSE="b",$f.ERROR="c",$f.MESSAGE="d",w2.prototype.listen=w2.prototype.O,vr.prototype.listenOnce=vr.prototype.P,vr.prototype.getLastError=vr.prototype.Sa,vr.prototype.getLastErrorCode=vr.prototype.Ia,vr.prototype.getStatus=vr.prototype.da,vr.prototype.getResponseJson=vr.prototype.Wa,vr.prototype.getResponseText=vr.prototype.ja,vr.prototype.send=vr.prototype.ha,vr.prototype.setWithCredentials=vr.prototype.Oa,Ma.prototype.digest=Ma.prototype.l,Ma.prototype.reset=Ma.prototype.reset,Ma.prototype.update=Ma.prototype.j,a1.prototype.add=a1.prototype.add,a1.prototype.multiply=a1.prototype.R,a1.prototype.modulo=a1.prototype.gb,a1.prototype.compare=a1.prototype.X,a1.prototype.toNumber=a1.prototype.ea,a1.prototype.toString=a1.prototype.toString,a1.prototype.getBits=a1.prototype.D,a1.fromNumber=Tc,a1.fromString=function Xj(r,e){if(0==r.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==r.charAt(0))return ni(Xj(r.substring(1),e));if(0<=r.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Tc(Math.pow(e,8)),n=n5,i=0;i<r.length;i+=8){var o=Math.min(8,r.length-i),s=parseInt(r.substring(i,i+o),e);8>o?(o=Tc(Math.pow(e,o)),n=n.R(o).add(Tc(s))):n=(n=n.R(t)).add(Tc(s))}return n};var lSe=ya.createWebChannelTransport=function(){return new wm},uSe=ya.getStatEventTarget=function(){return pm()},JT=ya.ErrorCode=gm,fSe=ya.EventType=lj,dSe=ya.Event=x6,eZ=ya.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},hSe=ya.FetchXmlHttpFactory=Zf,km=ya.WebChannel=fj,pSe=ya.XhrIo=vr,gSe=ya.Md5=Ma,i5=ya.Integer=a1;const tZ="@firebase/firestore";class N2{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}N2.UNAUTHENTICATED=new N2(null),N2.GOOGLE_CREDENTIALS=new N2("google-credentials-uid"),N2.FIRST_PARTY=new N2("first-party-uid"),N2.MOCK_USER=new N2("mock-user");let o5="9.23.0";const q4=new K8("@firebase/firestore");function eO(){return q4.logLevel}function Oe(r,...e){if(q4.logLevel<=Un.DEBUG){const t=e.map(tO);q4.debug(`Firestore (${o5}): ${r}`,...t)}}function zr(r,...e){if(q4.logLevel<=Un.ERROR){const t=e.map(tO);q4.error(`Firestore (${o5}): ${r}`,...t)}}function Ea(r,...e){if(q4.logLevel<=Un.WARN){const t=e.map(tO);q4.warn(`Firestore (${o5}): ${r}`,...t)}}function tO(r){if("string"==typeof r)return r;try{return JSON.stringify(r)}catch{return r}}function at(r="Unexpected state"){const e=`FIRESTORE (${o5}) INTERNAL ASSERTION FAILED: `+r;throw zr(e),new Error(e)}function mt(r,e){r||at()}function Ze(r,e){return r}const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends Ls{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class c2{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class nZ{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mSe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(N2.UNAUTHENTICATED))}shutdown(){}}class _Se{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class vSe{constructor(e){this.t=e,this.currentUser=N2.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let i=this.i;const o=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let s=new c2;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new c2,e.enqueueRetryable(()=>o(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(M(function*(){yield l.promise,yield o(n.currentUser)}))},c=l=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new c2)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(mt("string"==typeof n.accessToken),new nZ(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return mt(null===e||"string"==typeof e),new N2(e)}}class CSe{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=N2.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class ySe{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new CSe(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(N2.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rZ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class MSe{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=o=>{null!=o.error&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.T;return this.T=o.token,Oe("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.I.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.I.getImmediate({optional:!0});o?i(o):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(mt("string"==typeof t.token),this.T=t.token,new rZ(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function ESe(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class iZ{static A(){const t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=ESe(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<t&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[o]%62))}return n}}function qt(r,e){return r<e?-1:r>e?1:0}function s5(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}class or{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return or.fromMillis(Date.now())}static fromDate(e){return or.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new or(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?qt(this.nanoseconds,e.nanoseconds):qt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ct{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new or(0,0))}static max(){return new Ct(new or(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class e9{constructor(e,t,n){void 0===t?t=0:t>e.length&&at(),void 0===n?n=e.length-t:n>e.length-t&&at(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===e9.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof e9?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const o=e.get(i),s=t.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Hn extends e9{construct(e,t,n){return new Hn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Te(fe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Hn(t)}static emptyPath(){return new Hn([])}}const SSe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Dr extends e9{construct(e,t,n){return new Dr(e,t,n)}static isValidIdentifier(e){return SSe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Dr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Dr(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const o=()=>{if(0===n.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new Te(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new Te(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(n+=a,i++):(o(),i++)}if(o(),s)throw new Te(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Dr(t)}static emptyPath(){return new Dr([])}}class Ue{constructor(e){this.path=e}static fromPath(e){return new Ue(Hn.fromString(e))}static fromName(e){return new Ue(Hn.fromString(e).popFirst(5))}static empty(){return new Ue(Hn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Hn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Hn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ue(new Hn(e.slice()))}}function aZ(r){return new as(r.readTime,r.key,-1)}class as{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new as(Ct.min(),Ue.empty(),-1)}static max(){return new as(Ct.max(),Ue.empty(),-1)}}function rO(r,e){let t=r.readTime.compareTo(e.readTime);return 0!==t?t:(t=Ue.comparator(r.documentKey,e.documentKey),0!==t?t:qt(r.largestBatchId,e.largestBatchId))}const cZ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class OSe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function j4(r){return iO.apply(this,arguments)}function iO(){return iO=M(function*(r){if(r.code!==fe.FAILED_PRECONDITION||r.message!==cZ)throw r;Oe("LocalStore","Unexpectedly lost primary lease")}),iO.apply(this,arguments)}class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&at(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.reject(t)}static resolve(e){return new ce((t,n)=>{t(e)})}static reject(e){return new ce((t,n)=>{n(e)})}static waitFor(e){return new ce((t,n)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>n(c))}),s=!0,o===i&&t()})}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next(i=>i?ce.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,o)=>{n.push(t.call(this,i,o))}),this.waitFor(n)}static mapArray(e,t){return new ce((n,i)=>{const o=e.length,s=new Array(o);let a=0;for(let c=0;c<o;c++){const l=c;t(e[l]).next(f=>{s[l]=f,++a,a===o&&n(s)},f=>i(f))}})}static doWhile(e,t){return new ce((n,i)=>{const o=()=>{!0===e()?t().next(()=>{o()},i):n()};o()})}}function Z4(r){return"IndexedDbTransactionError"===r.name}let cs=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>n.writeSequenceNumber(i))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return r.ct=-1,r})();function r9(r){return null==r}function i9(r){return 0===r&&1/r==-1/0}function _Z(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Y4(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function vZ(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class I1{constructor(e,t){this.comparator=e,this.root=t||ri.EMPTY}insert(e,t){return new I1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ri.BLACK,null,null))}remove(e){return new I1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ri.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dm(this.root,e,this.comparator,!0)}}class Dm{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(0===o){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ri{constructor(e,t,n,i,o){this.key=e,this.value=t,this.color=n??ri.RED,this.left=i??ri.EMPTY,this.right=o??ri.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,o){return new ri(e??this.key,t??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===o?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ri.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return ri.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ri.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ri.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw at();const e=this.left.check();if(e!==this.right.check())throw at();return e+(this.isRed()?0:1)}}ri.EMPTY=null,ri.RED=!0,ri.BLACK=!1,ri.EMPTY=new class{constructor(){this.size=0}get key(){throw at()}get value(){throw at()}get color(){throw at()}get left(){throw at()}get right(){throw at()}copy(r,e,t,n,i){return this}insert(r,e,t){return new ri(r,e)}remove(r,e){return this}isEmpty(){return!0}inorderTraversal(r){return!1}reverseTraversal(r){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class z1{constructor(e){this.comparator=e,this.data=new I1(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new CZ(this.data.getIterator())}getIteratorFrom(e){return new CZ(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof z1)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=n.getNext().key;if(0!==this.comparator(i,o))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new z1(this.comparator);return t.data=e,t}}class CZ{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Lo{constructor(e){this.fields=e,e.sort(Dr.comparator)}static empty(){return new Lo([])}unionWith(e){let t=new z1(Dr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Lo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return s5(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class yZ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class l2{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(n){try{return atob(n)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new yZ("Invalid base64 string: "+i):i}}(e);return new l2(t)}static fromUint8Array(e){const t=function(n){let i="";for(let o=0;o<n.length;++o)i+=String.fromCharCode(n[o]);return i}(e);return new l2(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}l2.EMPTY_BYTE_STRING=new l2("");const YSe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function K4(r){if(mt(!!r),"string"==typeof r){let e=0;const t=YSe.exec(r);if(mt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Cr(r.seconds),nanos:Cr(r.nanos)}}function Cr(r){return"number"==typeof r?r:"string"==typeof r?Number(r):0}function x3(r){return"string"==typeof r?l2.fromBase64String(r):l2.fromUint8Array(r)}function Hm(r){var e,t;return"server_timestamp"===(null===(t=((null===(e=r?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Vm(r){const e=r.mapValue.fields.__previous_value__;return Hm(e)?Vm(e):e}function o9(r){const e=K4(r.mapValue.fields.__local_write_time__.timestampValue);return new or(e.seconds,e.nanos)}class KSe{constructor(e,t,n,i,o,s,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class V6{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new V6("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof V6&&e.projectId===this.projectId&&e.database===this.database}}const X4={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Q4(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Hm(r)?4:PZ(r)?9007199254740991:10:at()}function bc(r,e){if(r===e)return!0;const t=Q4(r);if(t!==Q4(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return o9(r).isEqual(o9(e));case 3:return function(n,i){if("string"==typeof n.timestampValue&&"string"==typeof i.timestampValue&&n.timestampValue.length===i.timestampValue.length)return n.timestampValue===i.timestampValue;const o=K4(n.timestampValue),s=K4(i.timestampValue);return o.seconds===s.seconds&&o.nanos===s.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return i=e,x3(r.bytesValue).isEqual(x3(i.bytesValue));case 7:return r.referenceValue===e.referenceValue;case 8:return function(n,i){return Cr(n.geoPointValue.latitude)===Cr(i.geoPointValue.latitude)&&Cr(n.geoPointValue.longitude)===Cr(i.geoPointValue.longitude)}(r,e);case 2:return function(n,i){if("integerValue"in n&&"integerValue"in i)return Cr(n.integerValue)===Cr(i.integerValue);if("doubleValue"in n&&"doubleValue"in i){const o=Cr(n.doubleValue),s=Cr(i.doubleValue);return o===s?i9(o)===i9(s):isNaN(o)&&isNaN(s)}return!1}(r,e);case 9:return s5(r.arrayValue.values||[],e.arrayValue.values||[],bc);case 10:return function(n,i){const o=n.mapValue.fields||{},s=i.mapValue.fields||{};if(_Z(o)!==_Z(s))return!1;for(const a in o)if(o.hasOwnProperty(a)&&(void 0===s[a]||!bc(o[a],s[a])))return!1;return!0}(r,e);default:return at()}var i}function s9(r,e){return void 0!==(r.values||[]).find(t=>bc(t,e))}function J4(r,e){if(r===e)return 0;const t=Q4(r),n=Q4(e);if(t!==n)return qt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return qt(r.booleanValue,e.booleanValue);case 2:return function(i,o){const s=Cr(i.integerValue||i.doubleValue),a=Cr(o.integerValue||o.doubleValue);return s<a?-1:s>a?1:s===a?0:isNaN(s)?isNaN(a)?0:-1:1}(r,e);case 3:return MZ(r.timestampValue,e.timestampValue);case 4:return MZ(o9(r),o9(e));case 5:return qt(r.stringValue,e.stringValue);case 6:return function(i,o){const s=x3(i),a=x3(o);return s.compareTo(a)}(r.bytesValue,e.bytesValue);case 7:return function(i,o){const s=i.split("/"),a=o.split("/");for(let c=0;c<s.length&&c<a.length;c++){const l=qt(s[c],a[c]);if(0!==l)return l}return qt(s.length,a.length)}(r.referenceValue,e.referenceValue);case 8:return function(i,o){const s=qt(Cr(i.latitude),Cr(o.latitude));return 0!==s?s:qt(Cr(i.longitude),Cr(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return function(i,o){const s=i.values||[],a=o.values||[];for(let c=0;c<s.length&&c<a.length;++c){const l=J4(s[c],a[c]);if(l)return l}return qt(s.length,a.length)}(r.arrayValue,e.arrayValue);case 10:return function(i,o){if(i===X4.mapValue&&o===X4.mapValue)return 0;if(i===X4.mapValue)return 1;if(o===X4.mapValue)return-1;const s=i.fields||{},a=Object.keys(s),c=o.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let f=0;f<a.length&&f<l.length;++f){const d=qt(a[f],l[f]);if(0!==d)return d;const m=J4(s[a[f]],c[l[f]]);if(0!==m)return m}return qt(a.length,l.length)}(r.mapValue,e.mapValue);default:throw at()}}function MZ(r,e){if("string"==typeof r&&"string"==typeof e&&r.length===e.length)return qt(r,e);const t=K4(r),n=K4(e),i=qt(t.seconds,n.seconds);return 0!==i?i:qt(t.nanos,n.nanos)}function c5(r){return aO(r)}function aO(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(n){const i=K4(n);return`time(${i.seconds},${i.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?x3(r.bytesValue).toBase64():"referenceValue"in r?Ue.fromName(r.referenceValue).toString():"geoPointValue"in r?`geo(${(e=r.geoPointValue).latitude},${e.longitude})`:"arrayValue"in r?function(n){let i="[",o=!0;for(const s of n.values||[])o?o=!1:i+=",",i+=aO(s);return i+"]"}(r.arrayValue):"mapValue"in r?function(n){const i=Object.keys(n.fields||{}).sort();let o="{",s=!0;for(const a of i)s?s=!1:o+=",",o+=`${a}:${aO(n.fields[a])}`;return o+"}"}(r.mapValue):at();var e}function F6(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function cO(r){return!!r&&"integerValue"in r}function a9(r){return!!r&&"arrayValue"in r}function EZ(r){return!!r&&"nullValue"in r}function SZ(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Bm(r){return!!r&&"mapValue"in r}function c9(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&"object"==typeof r.timestampValue)return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return Y4(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=c9(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=c9(r.arrayValue.values[t]);return e}return Object.assign({},r)}function PZ(r){return"__max__"===(((r.mapValue||{}).fields||{}).__type__||{}).stringValue}class ii{constructor(e){this.value=e}static empty(){return new ii({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Bm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=c9(t)}setAll(e){let t=Dr.emptyPath(),n={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=a.popLast()}s?n[a.lastSegment()]=c9(s):i.push(a.lastSegment())});const o=this.getFieldsMap(t);this.applyChanges(o,n,i)}delete(e){const t=this.field(e.popLast());Bm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return bc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Bm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Y4(t,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new ii(c9(this.value))}}function bZ(r){const e=[];return Y4(r.fields,(t,n)=>{const i=new Dr([t]);if(Bm(n)){const o=bZ(n.mapValue).fields;if(0===o.length)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new Lo(e)}class D1{constructor(e,t,n,i,o,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new D1(e,0,Ct.min(),Ct.min(),Ct.min(),ii.empty(),0)}static newFoundDocument(e,t,n,i){return new D1(e,1,t,Ct.min(),n,i,0)}static newNoDocument(e,t){return new D1(e,2,t,Ct.min(),Ct.min(),ii.empty(),0)}static newUnknownDocument(e,t){return new D1(e,3,t,Ct.min(),Ct.min(),ii.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ct.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ii.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ii.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof D1&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new D1(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class el{constructor(e,t){this.position=e,this.inclusive=t}}function wZ(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const o=e[i],s=r.position[i];if(n=o.field.isKeyField()?Ue.comparator(Ue.fromName(s.referenceValue),t.key):J4(s,t.data.field(o.field)),"desc"===o.dir&&(n*=-1),0!==n)break}return n}function NZ(r,e){if(null===r)return null===e;if(null===e||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!bc(r.position[t],e.position[t]))return!1;return!0}class l5{constructor(e,t="asc"){this.field=e,this.dir=t}}function JSe(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class AZ{}class Pn extends AZ{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new ePe(e,t,n):"array-contains"===t?new rPe(e,n):"in"===t?new zZ(e,n):"not-in"===t?new iPe(e,n):"array-contains-any"===t?new oPe(e,n):new Pn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new tPe(e,n):new nPe(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(J4(t,this.value)):null!==t&&Q4(this.value)===Q4(t)&&this.matchesComparison(J4(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return at()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class c1 extends AZ{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new c1(e,t)}matches(e){return u5(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function u5(r){return"and"===r.op}function uO(r){return function IZ(r){for(const e of r.filters)if(e instanceof c1)return!1;return!0}(r)&&u5(r)}function fO(r){if(r instanceof Pn)return r.field.canonicalString()+r.op.toString()+c5(r.value);if(uO(r))return r.filters.map(e=>fO(e)).join(",");{const e=r.filters.map(t=>fO(t)).join(",");return`${r.op}(${e})`}}function kZ(r,e){return r instanceof Pn?(t=r,(n=e)instanceof Pn&&t.op===n.op&&t.field.isEqual(n.field)&&bc(t.value,n.value)):r instanceof c1?function(t,n){return n instanceof c1&&t.op===n.op&&t.filters.length===n.filters.length&&t.filters.reduce((i,o,s)=>i&&kZ(o,n.filters[s]),!0)}(r,e):void at();var t,n}function LZ(r){return r instanceof Pn?`${(e=r).field.canonicalString()} ${e.op} ${c5(e.value)}`:r instanceof c1?function(e){return e.op.toString()+" {"+e.getFilters().map(LZ).join(" ,")+"}"}(r):"Filter";var e}class ePe extends Pn{constructor(e,t,n){super(e,t,n),this.key=Ue.fromName(n.referenceValue)}matches(e){const t=Ue.comparator(e.key,this.key);return this.matchesComparison(t)}}class tPe extends Pn{constructor(e,t){super(e,"in",t),this.keys=RZ(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class nPe extends Pn{constructor(e,t){super(e,"not-in",t),this.keys=RZ(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function RZ(r,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(n=>Ue.fromName(n.referenceValue))}class rPe extends Pn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return a9(t)&&s9(t.arrayValue,this.value)}}class zZ extends Pn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&s9(this.value.arrayValue,t)}}class iPe extends Pn{constructor(e,t){super(e,"not-in",t)}matches(e){if(s9(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!s9(this.value.arrayValue,t)}}class oPe extends Pn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!a9(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>s9(this.value.arrayValue,n))}}class sPe{constructor(e,t=null,n=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.dt=null}}function dO(r,e=null,t=[],n=[],i=null,o=null,s=null){return new sPe(r,e,t,n,i,o,s)}function $6(r){const e=Ze(r);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>fO(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>{return(i=n).field.canonicalString()+i.dir;var i}).join(","),r9(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>c5(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>c5(n)).join(",")),e.dt=t}return e.dt}function l9(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!JSe(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!kZ(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!NZ(r.startAt,e.startAt)&&NZ(r.endAt,e.endAt)}function Gm(r){return Ue.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length}class L3{constructor(e,t=null,n=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.wt=null,this._t=null}}function f5(r){return new L3(r)}function FZ(r){return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())}function hO(r){return r.explicitOrderBy.length>0?r.explicitOrderBy[0].field:null}function Wm(r){for(const e of r.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function pO(r){return null!==r.collectionGroup}function B6(r){const e=Ze(r);if(null===e.wt){e.wt=[];const t=Wm(e),n=hO(e);if(null!==t&&null===n)t.isKeyField()||e.wt.push(new l5(t)),e.wt.push(new l5(Dr.keyField(),"asc"));else{let i=!1;for(const o of e.explicitOrderBy)e.wt.push(o),o.field.isKeyField()&&(i=!0);if(!i){const o=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new l5(Dr.keyField(),o))}}}return e.wt}function co(r){const e=Ze(r);if(!e._t)if("F"===e.limitType)e._t=dO(e.path,e.collectionGroup,B6(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const o of B6(e))t.push(new l5(o.field,"desc"===o.dir?"asc":"desc"));const n=e.endAt?new el(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new el(e.startAt.position,e.startAt.inclusive):null;e._t=dO(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e._t}function gO(r,e){e.getFirstInequalityField(),Wm(r);const t=r.filters.concat([e]);return new L3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function qm(r,e,t){return new L3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function u9(r,e){return l9(co(r),co(e))&&r.limitType===e.limitType}function $Z(r){return`${$6(co(r))}|lt:${r.limitType}`}function mO(r){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(n=>LZ(n)).join(", ")}]`),r9(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(n=>{return`${(i=n).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>c5(n)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>c5(n)).join(",")),`Target(${t})`}(co(r))}; limitType=${r.limitType})`}function f9(r,e){return e.isFoundDocument()&&function(t,n){const i=n.key.path;return null!==t.collectionGroup?n.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):Ue.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(r,e)&&function(t,n){for(const i of B6(t))if(!i.field.isKeyField()&&null===n.data.field(i.field))return!1;return!0}(r,e)&&function(t,n){for(const i of t.filters)if(!i.matches(n))return!1;return!0}(r,e)&&(n=e,!((t=r).startAt&&!function(i,o,s){const a=wZ(i,o,s);return i.inclusive?a<=0:a<0}(t.startAt,B6(t),n)||t.endAt&&!function(i,o,s){const a=wZ(i,o,s);return i.inclusive?a>=0:a>0}(t.endAt,B6(t),n)));var t,n}function GZ(r){return(e,t)=>{let n=!1;for(const i of B6(r)){const o=aPe(i,e,t);if(0!==o)return o;n=n||i.field.isKeyField()}return 0}}function aPe(r,e,t){const n=r.field.isKeyField()?Ue.comparator(e.key,t.key):function(i,o,s){const a=o.data.field(i),c=s.data.field(i);return null!==a&&null!==c?J4(a,c):at()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return at()}}class R3{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,o]of n)if(this.equalsFn(i,e))return o}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Y4(this.inner,(t,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return vZ(this.inner)}size(){return this.innerSize}}const cPe=new I1(Ue.comparator);function Ro(){return cPe}const UZ=new I1(Ue.comparator);function d9(...r){let e=UZ;for(const t of r)e=e.insert(t.key,t);return e}function WZ(r){let e=UZ;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function wc(){return h9()}function qZ(){return h9()}function h9(){return new R3(r=>r.toString(),(r,e)=>r.isEqual(e))}const lPe=new I1(Ue.comparator),uPe=new z1(Ue.comparator);function rn(...r){let e=uPe;for(const t of r)e=e.add(t);return e}const fPe=new z1(qt);function jZ(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:i9(e)?"-0":e}}function ZZ(r){return{integerValue:""+r}}function YZ(r,e){return function uZ(r){return"number"==typeof r&&Number.isInteger(r)&&!i9(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}(e)?ZZ(e):jZ(r,e)}class jm{constructor(){this._=void 0}}function dPe(r,e,t){return r instanceof d5?function(n,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return i&&Hm(i)&&(i=Vm(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):r instanceof G6?XZ(r,e):r instanceof U6?QZ(r,e):function(n,i){const o=KZ(n,i),s=JZ(o)+JZ(n.gt);return cO(o)&&cO(n.gt)?ZZ(s):jZ(n.serializer,s)}(r,e)}function hPe(r,e,t){return r instanceof G6?XZ(r,e):r instanceof U6?QZ(r,e):t}function KZ(r,e){return r instanceof h5?cO(t=e)||(n=t)&&"doubleValue"in n?e:{integerValue:0}:null;var n,t}class d5 extends jm{}class G6 extends jm{constructor(e){super(),this.elements=e}}function XZ(r,e){const t=eY(e);for(const n of r.elements)t.some(i=>bc(i,n))||t.push(n);return{arrayValue:{values:t}}}class U6 extends jm{constructor(e){super(),this.elements=e}}function QZ(r,e){let t=eY(e);for(const n of r.elements)t=t.filter(i=>!bc(i,n));return{arrayValue:{values:t}}}class h5 extends jm{constructor(e,t){super(),this.serializer=e,this.gt=t}}function JZ(r){return Cr(r.integerValue||r.doubleValue)}function eY(r){return a9(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class p9{constructor(e,t){this.field=e,this.transform=t}}class gPe{constructor(e,t){this.version=e,this.transformResults=t}}class K1{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new K1}static exists(e){return new K1(void 0,e)}static updateTime(e){return new K1(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zm(r,e){return void 0!==r.updateTime?e.isFoundDocument()&&e.version.isEqual(r.updateTime):void 0===r.exists||r.exists===e.isFoundDocument()}class Ym{}function tY(r,e){if(!r.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return r.isNoDocument()?new g5(r.key,K1.none()):new p5(r.key,r.data,K1.none());{const t=r.data,n=ii.empty();let i=new z1(Dr.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);null===s&&o.length>1&&(o=o.popLast(),s=t.field(o)),null===s?n.delete(o):n.set(o,s),i=i.add(o)}return new z3(r.key,n,new Lo(i.toArray()),K1.none())}}function mPe(r,e,t){r instanceof p5?function(n,i,o){const s=n.value.clone(),a=iY(n.fieldTransforms,i,o.transformResults);s.setAll(a),i.convertToFoundDocument(o.version,s).setHasCommittedMutations()}(r,e,t):r instanceof z3?function(n,i,o){if(!Zm(n.precondition,i))return void i.convertToUnknownDocument(o.version);const s=iY(n.fieldTransforms,i,o.transformResults),a=i.data;a.setAll(rY(n)),a.setAll(s),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(r,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function g9(r,e,t,n){return r instanceof p5?function(i,o,s,a){if(!Zm(i.precondition,o))return s;const c=i.value.clone(),l=oY(i.fieldTransforms,a,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(r,e,t,n):r instanceof z3?function(i,o,s,a){if(!Zm(i.precondition,o))return s;const c=oY(i.fieldTransforms,a,o),l=o.data;return l.setAll(rY(i)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null===s?null:s.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(r,e,t,n):(s=t,Zm(r.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):s);var o,s}function _Pe(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),o=KZ(n.transform,i||null);null!=o&&(null===t&&(t=ii.empty()),t.set(n.field,o))}return t||null}function nY(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&(n=e.fieldTransforms,!!(void 0===(t=r.fieldTransforms)&&void 0===n||t&&n&&s5(t,n,(i,o)=>function pPe(r,e){return r.field.isEqual(e.field)&&(n=e.transform,(t=r.transform)instanceof G6&&n instanceof G6||t instanceof U6&&n instanceof U6?s5(t.elements,n.elements,bc):t instanceof h5&&n instanceof h5?bc(t.gt,n.gt):t instanceof d5&&n instanceof d5);var t,n}(i,o))))&&(0===r.type?r.value.isEqual(e.value):1!==r.type||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask));var t,n}class p5 extends Ym{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class z3 extends Ym{constructor(e,t,n,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function rY(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function iY(r,e,t){const n=new Map;mt(r.length===t.length);for(let i=0;i<t.length;i++){const o=r[i],s=o.transform,a=e.data.field(o.field);n.set(o.field,hPe(s,a,t[i]))}return n}function oY(r,e,t){const n=new Map;for(const i of r){const o=i.transform,s=t.data.field(i.field);n.set(i.field,dPe(o,s,e))}return n}class g5 extends Ym{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vO extends Ym{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class CO{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&mPe(o,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=g9(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=g9(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=qZ();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;const c=tY(s,a);null!==c&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(Ct.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),rn())}isEqual(e){return this.batchId===e.batchId&&s5(this.mutations,e.mutations,(t,n)=>nY(t,n))&&s5(this.baseMutations,e.baseMutations,(t,n)=>nY(t,n))}}class yO{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){mt(e.mutations.length===n.length);let i=lPe;const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new yO(e,t,n,i)}}class MO{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class CPe{constructor(e,t){this.count=e,this.unchangedNames=t}}var Kr,Vn;function aY(r){if(void 0===r)return zr("GRPC error has no .code"),fe.UNKNOWN;switch(r){case Kr.OK:return fe.OK;case Kr.CANCELLED:return fe.CANCELLED;case Kr.UNKNOWN:return fe.UNKNOWN;case Kr.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case Kr.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case Kr.INTERNAL:return fe.INTERNAL;case Kr.UNAVAILABLE:return fe.UNAVAILABLE;case Kr.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case Kr.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case Kr.NOT_FOUND:return fe.NOT_FOUND;case Kr.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case Kr.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case Kr.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case Kr.ABORTED:return fe.ABORTED;case Kr.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case Kr.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case Kr.DATA_LOSS:return fe.DATA_LOSS;default:return at()}}(Vn=Kr||(Kr={}))[Vn.OK=0]="OK",Vn[Vn.CANCELLED=1]="CANCELLED",Vn[Vn.UNKNOWN=2]="UNKNOWN",Vn[Vn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vn[Vn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vn[Vn.NOT_FOUND=5]="NOT_FOUND",Vn[Vn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vn[Vn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vn[Vn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vn[Vn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vn[Vn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vn[Vn.ABORTED=10]="ABORTED",Vn[Vn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vn[Vn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vn[Vn.INTERNAL=13]="INTERNAL",Vn[Vn.UNAVAILABLE=14]="UNAVAILABLE",Vn[Vn.DATA_LOSS=15]="DATA_LOSS";class EO{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Km}static getOrCreateInstance(){return null===Km&&(Km=new EO),Km}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let Km=null;const yPe=new i5([4294967295,4294967295],0);function lY(r){const e=function cY(){return new TextEncoder}().encode(r),t=new gSe;return t.update(e),new Uint8Array(t.digest())}function uY(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new i5([t,n],0),new i5([i,o],0)]}class SO{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new m9(`Invalid padding: ${t}`);if(n<0)throw new m9(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new m9(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new m9(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=i5.fromNumber(this.It)}Et(e,t,n){let i=e.add(t.multiply(i5.fromNumber(n)));return 1===i.compare(yPe)&&(i=new i5([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=lY(e),[n,i]=uY(t);for(let o=0;o<this.hashCount;o++){const s=this.Et(n,i,o);if(!this.At(s))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new SO(o,i,t);return n.forEach(a=>s.insert(a)),s}insert(e){if(0===this.It)return;const t=lY(e),[n,i]=uY(t);for(let o=0;o<this.hashCount;o++){const s=this.Et(n,i,o);this.Rt(s)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class m9 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class _9{constructor(e,t,n,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,v9.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new _9(Ct.min(),i,new I1(qt),Ro(),rn())}}class v9{constructor(e,t,n,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new v9(n,t,rn(),rn(),rn())}}class Xm{constructor(e,t,n,i){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=i}}class fY{constructor(e,t){this.targetId=e,this.Vt=t}}class dY{constructor(e,t,n=l2.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class hY{constructor(){this.St=0,this.Dt=gY(),this.Ct=l2.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=rn(),t=rn(),n=rn();return this.Dt.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:at()}}),new v9(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=gY()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class MPe{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Ro(),this.zt=pY(),this.Wt=new I1(qt)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:at()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((n,i)=>{this.te(i)&&t(i)})}ne(e){var t;const n=e.targetId,i=e.Vt.count,o=this.se(n);if(o){const s=o.target;if(Gm(s))if(0===i){const a=new Ue(s.path);this.Yt(n,a,D1.newNoDocument(a,Ct.min()))}else mt(1===i);else{const a=this.ie(n);if(a!==i){const c=this.re(e,a);0!==c&&(this.ee(n),this.Wt=this.Wt.insert(n,2===c?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=EO.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(l,f,d){var m,E,w,L,z,$;const B={localCacheCount:f,existenceFilterCount:d.count},de=d.unchangedNames;return de&&(B.bloomFilter={applied:0===l,hashCount:null!==(m=de?.hashCount)&&void 0!==m?m:0,bitmapLength:null!==(L=null===(w=null===(E=de?.bits)||void 0===E?void 0:E.bitmap)||void 0===w?void 0:w.length)&&void 0!==L?L:0,padding:null!==($=null===(z=de?.bits)||void 0===z?void 0:z.padding)&&void 0!==$?$:0}),B}(c,a,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:i}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:o="",padding:s=0},hashCount:a=0}=n;let c,l;try{c=x3(o).toUint8Array()}catch(f){if(f instanceof yZ)return Ea("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw f}try{l=new SO(c,s,a)}catch(f){return Ea(f instanceof m9?"BloomFilter error: ":"Applying bloom filter failed: ",f),1}return 0===l.It?1:i!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let i=0;return n.forEach(o=>{const s=this.Gt.ue(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;t.vt(a)||(this.Yt(e,o,null),i++)}),i}ce(e){const t=new Map;this.Qt.forEach((o,s)=>{const a=this.se(s);if(a){if(o.current&&Gm(a.target)){const c=new Ue(a.target.path);null!==this.jt.get(c)||this.ae(s,c)||this.Yt(s,c,D1.newNoDocument(c,e))}o.Mt&&(t.set(s,o.Ot()),o.Ft())}});let n=rn();this.zt.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{const l=this.se(c);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(n=n.add(o))}),this.jt.forEach((o,s)=>s.setReadTime(e));const i=new _9(e,t,this.Wt,this.jt,n);return this.jt=Ro(),this.zt=pY(),this.Wt=new I1(qt),i}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new hY,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new z1(qt),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||Oe("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new hY),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function pY(){return new I1(Ue.comparator)}function gY(){return new I1(Ue.comparator)}const EPe={asc:"ASCENDING",desc:"DESCENDING"},SPe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},PPe={and:"AND",or:"OR"};class TPe{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function PO(r,e){return r.useProto3Json||r9(e)?e:{value:e}}function m5(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mY(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function OPe(r,e){return m5(r,e.toTimestamp())}function Hr(r){return mt(!!r),Ct.fromTimestamp(function(e){const t=K4(e);return new or(t.seconds,t.nanos)}(r))}function TO(r,e){return(t=r,new Hn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function _Y(r){const e=Hn.fromString(r);return mt(OY(e)),e}function C9(r,e){return TO(r.databaseId,e.path)}function Nc(r,e){const t=_Y(e);if(t.get(1)!==r.databaseId.projectId)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Ue(CY(t))}function OO(r,e){return TO(r.databaseId,e)}function y9(r){return new Hn(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function CY(r){return mt(r.length>4&&"documents"===r.get(4)),r.popFirst(5)}function yY(r,e,t){return{name:C9(r,e),fields:t.value.mapValue.fields}}function EY(r,e){return{documents:[OO(r,e.path)]}}function wO(r,e){const t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(t.parent=OO(r,n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=OO(r,n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);const i=function(c){if(0!==c.length)return TY(c1.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(0!==c.length)return c.map(l=>{return{field:tl((f=l).field),direction:IPe(f.dir)};var f})}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const s=PO(r,e.limit);var a,c;return null!==s&&(t.structuredQuery.limit=s),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt={before:!(c=e.endAt).inclusive,values:c.position}),t}function SY(r){let e=function vY(r){const e=_Y(r);return 4===e.length?Hn.emptyPath():CY(e)}(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){mt(1===n);const f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let o=[];t.where&&(o=function(f){const d=PY(f);return d instanceof c1&&uO(d)?d.getFilters():[d]}(t.where));let s=[];t.orderBy&&(s=t.orderBy.map(f=>{return new l5(_5((d=f).field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction));var d}));let a=null;t.limit&&(a=function(f){let d;return d="object"==typeof f?f.value:f,r9(d)?null:d}(t.limit));let c=null;var f;t.startAt&&(c=new el((f=t.startAt).values||[],!!f.before));let l=null;return t.endAt&&(l=function(f){return new el(f.values||[],!f.before)}(t.endAt)),function VZ(r,e,t,n,i,o,s,a){return new L3(r,e,t,n,i,o,s,a)}(e,i,s,o,a,"F",c,l)}function PY(r){return void 0!==r.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=_5(e.unaryFilter.field);return Pn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=_5(e.unaryFilter.field);return Pn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=_5(e.unaryFilter.field);return Pn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=_5(e.unaryFilter.field);return Pn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return at()}}(r):void 0!==r.fieldFilter?Pn.create(_5((e=r).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return at()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==r.compositeFilter?function(e){return c1.create(e.compositeFilter.filters.map(t=>PY(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return at()}}(e.compositeFilter.op))}(r):at();var e}function IPe(r){return EPe[r]}function kPe(r){return SPe[r]}function xPe(r){return PPe[r]}function tl(r){return{fieldPath:r.canonicalString()}}function _5(r){return Dr.fromServerFormat(r.fieldPath)}function TY(r){return r instanceof Pn?function(e){if("=="===e.op){if(SZ(e.value))return{unaryFilter:{field:tl(e.field),op:"IS_NAN"}};if(EZ(e.value))return{unaryFilter:{field:tl(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(SZ(e.value))return{unaryFilter:{field:tl(e.field),op:"IS_NOT_NAN"}};if(EZ(e.value))return{unaryFilter:{field:tl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:tl(e.field),op:kPe(e.op),value:e.value}}}(r):r instanceof c1?function(e){const t=e.getFilters().map(n=>TY(n));return 1===t.length?t[0]:{compositeFilter:{op:xPe(e.op),filters:t}}}(r):at()}function LPe(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function OY(r){return r.length>=4&&"projects"===r.get(0)&&"databases"===r.get(2)}class D3{constructor(e,t,n,i,o=Ct.min(),s=Ct.min(),a=l2.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new D3(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new D3(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new D3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new D3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class bY{constructor(e){this.fe=e}}function NO(r){const e=SY({parent:r.parent,structuredQuery:r.structuredQuery});return"LAST"===r.limitType?qm(e,e.limit,"L"):e}class Z6{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Cr(e.integerValue));else if("doubleValue"in e){const n=Cr(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),i9(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(x3(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?PZ(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):at()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const i of Object.keys(n))this.Te(i,t),this.me(n[i],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const i of n)this.me(i,t)}ve(e,t){this.ye(t,37),Ue.fromName(e).path.forEach(n=>{this.ye(t,60),this.be(n,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}Z6.Ve=new Z6;class GPe{constructor(){this.rn=new RO}addToCollectionParentIndex(e,t){return this.rn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(as.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(as.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class RO{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new z1(Hn.comparator),o=!i.has(n);return this.index[t]=i.add(n),o}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new z1(Hn.comparator)).toArray()}}new Uint8Array(0);class xi{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new xi(e,xi.DEFAULT_COLLECTION_PERCENTILE,xi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}xi.DEFAULT_COLLECTION_PERCENTILE=10,xi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xi.DEFAULT=new xi(41943040,xi.DEFAULT_COLLECTION_PERCENTILE,xi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xi.DISABLED=new xi(-1,0,0);class K6{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new K6(0)}static Mn(){return new K6(-1)}}class YPe{constructor(){this.changes=new R3(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,D1.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class QPe{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class JY{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==n&&g9(n.mutation,i,Lo.empty(),or.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,rn()).next(()=>n))}getLocalViewOfDocuments(e,t,n=rn()){const i=wc();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(o=>{let s=d9();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){const n=wc();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,rn()))}populateOverlays(e,t,n){const i=[];return n.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,n,i){let o=Ro();const s=h9(),a=h9();return t.forEach((c,l)=>{const f=n.get(l.key);i.has(l.key)&&(void 0===f||f.mutation instanceof z3)?o=o.insert(l.key,l):void 0!==f?(s.set(l.key,f.mutation.getFieldMask()),g9(f.mutation,l,f.mutation.getFieldMask(),or.now())):s.set(l.key,Lo.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((l,f)=>s.set(l,f)),t.forEach((l,f)=>{var d;return a.set(l,new QPe(f,null!==(d=s.get(l))&&void 0!==d?d:null))}),a))}recalculateAndSaveOverlays(e,t){const n=h9();let i=new I1((s,a)=>s-a),o=rn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(const a of s)a.keys().forEach(c=>{const l=t.get(c);if(null===l)return;let f=n.get(c)||Lo.empty();f=a.applyToLocalView(l,f),n.set(c,f);const d=(i.get(a.batchId)||rn()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{const s=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,f=c.value,d=qZ();f.forEach(m=>{if(!o.has(m)){const E=tY(t.get(m),n.get(m));null!==E&&d.set(m,E),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,d))}return ce.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n){return Ue.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):pO(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var i}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-o.size):ce.resolve(wc());let a=-1,c=o;return s.next(l=>ce.forEach(l,(f,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),o.get(f)?ce.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{c=c.insert(f,m)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,c,l,rn())).next(f=>({batchId:a,changes:WZ(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ue(t)).next(n=>{let i=d9();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let o=d9();return this.indexManager.getCollectionParents(e,i).next(s=>ce.forEach(s,a=>{const c=(l=t,f=a.child(i),new L3(f,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt));var l,f;return this.getDocumentsMatchingCollectionQuery(e,c,n).next(l=>{l.forEach((f,d)=>{o=o.insert(f,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i))).next(o=>{i.forEach((a,c)=>{const l=c.getKey();null===o.get(l)&&(o=o.insert(l,D1.newInvalidDocument(l)))});let s=d9();return o.forEach((a,c)=>{const l=i.get(a);void 0!==l&&g9(l.mutation,c,Lo.empty(),or.now()),f9(t,c)&&(s=s.insert(a,c))}),s})}}class JPe{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return ce.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Hr(n.createTime)}),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(n=t).name,query:NO(n.bundledQuery),readTime:Hr(n.readTime)}),ce.resolve();var n}}class eTe{constructor(){this.overlays=new I1(Ue.comparator),this.ls=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=wc();return ce.forEach(t,i=>this.getOverlay(e,i).next(o=>{null!==o&&n.set(i,o)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,o)=>{this.we(e,t,o)}),ce.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.ls.get(n);return void 0!==i&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.ls.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const i=wc(),o=t.length+1,s=new Ue(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return ce.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let o=new I1((l,f)=>l-f);const s=this.overlays.getIterator();for(;s.hasNext();){const l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let f=o.get(l.largestBatchId);null===f&&(f=wc(),o=o.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}const a=wc(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>a.set(l,f)),!(a.size()>=i)););return ce.resolve(a)}we(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const s=this.ls.get(i.largestBatchId).delete(n.key);this.ls.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new MO(t,n));let o=this.ls.get(t);void 0===o&&(o=rn(),this.ls.set(t,o)),this.ls.set(t,o.add(n.key))}}class zO{constructor(){this.fs=new z1(I2.ds),this.ws=new z1(I2._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new I2(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.ys(new I2(e,t))}ps(e,t){e.forEach(n=>this.removeReference(n,t))}Is(e){const t=new Ue(new Hn([])),n=new I2(t,e),i=new I2(t,e+1),o=[];return this.ws.forEachInRange([n,i],s=>{this.ys(s),o.push(s.key)}),o}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Ue(new Hn([])),n=new I2(t,e),i=new I2(t,e+1);let o=rn();return this.ws.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(e){const t=new I2(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class I2{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Ue.comparator(e.key,t.key)||qt(e.As,t.As)}static _s(e,t){return qt(e.As,t.As)||Ue.comparator(e.key,t.key)}}class tTe{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new z1(I2.ds)}checkEmpty(e){return ce.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const o=this.vs;this.vs++;const s=new CO(o,t,n,i);this.mutationQueue.push(s);for(const a of i)this.Rs=this.Rs.add(new I2(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ce.resolve(s)}lookupMutationBatch(e,t){return ce.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.bs(t+1),o=i<0?0:i;return ce.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new I2(t,0),i=new I2(t,Number.POSITIVE_INFINITY),o=[];return this.Rs.forEachInRange([n,i],s=>{const a=this.Ps(s.As);o.push(a)}),ce.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new z1(qt);return t.forEach(i=>{const o=new I2(i,0),s=new I2(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([o,s],a=>{n=n.add(a.As)})}),ce.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let o=n;Ue.isDocumentKey(o)||(o=o.child(""));const s=new I2(new Ue(o),0);let a=new z1(qt);return this.Rs.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.As)),!0)},s),ce.resolve(this.Vs(a))}Vs(e){const t=[];return e.forEach(n=>{const i=this.Ps(n);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){mt(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return ce.forEach(t.mutations,i=>{const o=new I2(i.key,t.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new I2(t,0),i=this.Rs.firstAfterOrEqual(n);return ce.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return ce.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class nTe{constructor(e){this.Ds=e,this.docs=new I1(Ue.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),o=i?i.size:0,s=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():D1.newInvalidDocument(t))}getEntries(e,t){let n=Ro();return t.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():D1.newInvalidDocument(i))}),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let o=Ro();const s=t.path,a=new Ue(s.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:f}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||rO(aZ(f),n)<=0||(i.has(f.key)||f9(t,f))&&(o=o.insert(f.key,f.mutableCopy()))}return ce.resolve(o)}getAllFromCollectionGroup(e,t,n,i){at()}Cs(e,t){return ce.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new rTe(this)}getSize(e){return ce.resolve(this.size)}}class rTe extends YPe{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(n)}),ce.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class iTe{constructor(e){this.persistence=e,this.xs=new R3(t=>$6(t),l9),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.Ns=0,this.ks=new zO,this.targetCount=0,this.Ms=K6.kn()}forEachTarget(e,t){return this.xs.forEach((n,i)=>t(i)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),ce.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new K6(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Fn(t),ce.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let i=0;const o=[];return this.xs.forEach((s,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.xs.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),ce.waitFor(o).next(()=>i)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),ce.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this.ks.containsKey(t))}}class DO{constructor(e,t){this.$s={},this.overlays={},this.Os=new cs(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new iTe(this),this.indexManager=new GPe,this.remoteDocumentCache=new nTe(n=>this.referenceDelegate.Ls(n)),this.serializer=new bY(t),this.qs=new JPe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new eTe,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new tTe(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){Oe("MemoryPersistence","Starting transaction:",e);const i=new oTe(this.Os.next());return this.referenceDelegate.Us(),n(i).next(o=>this.referenceDelegate.Ks(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Gs(e,t){return ce.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class oTe extends OSe{constructor(e){super(),this.currentSequenceNumber=e}}class s_{constructor(e){this.persistence=e,this.Qs=new zO,this.js=null}static zs(e){return new s_(e)}get Ws(){if(this.js)return this.js;throw at()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(i=>this.Ws.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Ws.add(o.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.Ws,n=>{const i=Ue.fromPath(n);return this.Hs(e,i).next(o=>{o||t.removeEntry(i,Ct.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(n=>{n?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return ce.or([()=>ce.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class $O{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=i}static Li(e,t){let n=rn(),i=rn();for(const o of t.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new $O(e,t.fromCache,n,i)}}class tK{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.Ki(e,t).next(o=>o||this.Gi(e,t,i,n)).next(o=>o||this.Qi(e,t))}Ki(e,t){if(FZ(t))return ce.resolve(null);let n=co(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=qm(t,null,"F"),n=co(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const s=rn(...o);return this.Ui.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.ji(t,a);return this.zi(t,l,s,c.readTime)?this.Ki(e,qm(t,null,"F")):this.Wi(e,l,t,c)}))})))}Gi(e,t,n,i){return FZ(t)||i.isEqual(Ct.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(o=>{const s=this.ji(t,o);return this.zi(t,s,n,i)?this.Qi(e,t):(eO()<=Un.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),mO(t)),this.Wi(e,s,t,function sZ(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=Ct.fromTimestamp(1e9===n?new or(t+1,0):new or(t,n));return new as(i,Ue.empty(),e)}(i,-1)))})}ji(e,t){let n=new z1(GZ(e));return t.forEach((i,o)=>{f9(e,o)&&(n=n.add(o))}),n}zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const o="F"===e.limitType?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Qi(e,t){return eO()<=Un.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",mO(t)),this.Ui.getDocumentsMatchingQuery(e,t,as.min())}Wi(e,t,n,i){return this.Ui.getDocumentsMatchingQuery(e,n,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}}class aTe{constructor(e,t,n,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new I1(qt),this.Yi=new R3(o=>$6(o),l9),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JY(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function rK(r,e){return BO.apply(this,arguments)}function BO(){return BO=M(function*(r,e){const t=Ze(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,t.tr(e),t.mutationQueue.getAllMutationBatches(n))).next(o=>{const s=[],a=[];let c=rn();for(const l of i){s.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}for(const l of o){a.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(n,c).next(l=>({er:l,removedBatchIds:s,addedBatchIds:a}))})})}),BO.apply(this,arguments)}function iK(r){const e=Ze(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function uTe(r,e){const t=Ze(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function M5(r,e,t){return GO.apply(this,arguments)}function GO(){return GO=M(function*(r,e,t){const n=Ze(r),i=n.Ji.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!Z4(s))throw s;Oe("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ji=n.Ji.remove(e),n.Yi.delete(i.target)}),GO.apply(this,arguments)}function l_(r,e,t){const n=Ze(r);let i=Ct.min(),o=rn();return n.persistence.runTransaction("Execute query","readonly",s=>function(a,c,l){const f=Ze(a),d=f.Yi.get(l);return void 0!==d?ce.resolve(f.Ji.get(d)):f.Bs.getTargetData(c,l)}(n,s,co(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Bs.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>n.Hi.getDocumentsMatchingQuery(s,e,t?i:Ct.min(),t?o:rn())).next(a=>(function cK(r,e,t){let n=r.Xi.get(e)||Ct.min();t.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),r.Xi.set(e,n)}(n,function BZ(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}(e),a),{documents:a,ir:o})))}class ZO{constructor(){this.activeTargetIds=function _O(){return fPe}()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fK{constructor(){this.Hr=new ZO,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new ZO,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class hTe{Yr(e){}shutdown(){}}class dK{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Oe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Oe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let d_=null;function KO(){return null===d_?d_=268435456+Math.round(2147483648*Math.random()):d_++,"0x"+d_.toString(16)}const pTe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gTe{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const Li="WebChannelConnection";class mTe extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,i,o){const s=KO(),a=this.To(e,t);Oe("RestConnection",`Sending RPC '${e}' ${s}:`,a,n);const c={};return this.Eo(c,i,o),this.Ao(e,a,c,n).then(l=>(Oe("RestConnection",`Received RPC '${e}' ${s}: `,l),l),l=>{throw Ea("RestConnection",`RPC '${e}' ${s} failed with error: `,l,"url: ",a,"request:",n),l})}vo(e,t,n,i,o,s){return this.Io(e,t,n,i,o)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+o5,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}To(e,t){return`${this.mo}/v1/${t}:${pTe[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,i){const o=KO();return new Promise((s,a)=>{const c=new pSe;c.setWithCredentials(!0),c.listenOnce(fSe.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case JT.NO_ERROR:const f=c.getResponseJson();Oe(Li,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),s(f);break;case JT.TIMEOUT:Oe(Li,`RPC '${e}' ${o} timed out`),a(new Te(fe.DEADLINE_EXCEEDED,"Request time out"));break;case JT.HTTP_ERROR:const d=c.getStatus();if(Oe(Li,`RPC '${e}' ${o} failed with status:`,d,"response text:",c.getResponseText()),d>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const E=m?.error;if(E&&E.status&&E.message){const w=function(L){const z=L.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(z)>=0?z:fe.UNKNOWN}(E.status);a(new Te(w,E.message))}else a(new Te(fe.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new Te(fe.UNAVAILABLE,"Connection failed."));break;default:at()}}finally{Oe(Li,`RPC '${e}' ${o} completed.`)}});const l=JSON.stringify(i);Oe(Li,`RPC '${e}' ${o} sending request:`,i),c.send(t,"POST",l,n,15)})}Ro(e,t,n){const i=KO(),o=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=lSe(),a=uSe(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new hSe({})),this.Eo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const f=o.join("");Oe(Li,`Creating RPC '${e}' stream ${i}: ${f}`,c);const d=s.createWebChannel(f,c);let m=!1,E=!1;const w=new gTe({ro:z=>{E?Oe(Li,`Not sending because RPC '${e}' stream ${i} is closed:`,z):(m||(Oe(Li,`Opening RPC '${e}' stream ${i} transport.`),d.open(),m=!0),Oe(Li,`RPC '${e}' stream ${i} sending:`,z),d.send(z))},oo:()=>d.close()}),L=(z,$,B)=>{z.listen($,de=>{try{B(de)}catch(_e){setTimeout(()=>{throw _e},0)}})};return L(d,km.EventType.OPEN,()=>{E||Oe(Li,`RPC '${e}' stream ${i} transport opened.`)}),L(d,km.EventType.CLOSE,()=>{E||(E=!0,Oe(Li,`RPC '${e}' stream ${i} transport closed`),w.wo())}),L(d,km.EventType.ERROR,z=>{E||(E=!0,Ea(Li,`RPC '${e}' stream ${i} transport errored:`,z),w.wo(new Te(fe.UNAVAILABLE,"The operation could not be completed")))}),L(d,km.EventType.MESSAGE,z=>{var $;if(!E){const B=z.data[0];mt(!!B);const _e=B.error||(null===($=B[0])||void 0===$?void 0:$.error);if(_e){Oe(Li,`RPC '${e}' stream ${i} received error:`,_e);const xe=_e.status;let nt=function(Mn){const Et=Kr[Mn];if(void 0!==Et)return aY(Et)}(xe),gt=_e.message;void 0===nt&&(nt=fe.INTERNAL,gt="Unknown error status: "+xe+" with message "+_e.message),E=!0,w.wo(new Te(nt,gt)),d.close()}else Oe(Li,`RPC '${e}' stream ${i} received:`,B),w._o(B)}}),L(a,dSe.STAT_EVENT,z=>{z.stat===eZ.PROXY?Oe(Li,`RPC '${e}' stream ${i} detected buffering proxy`):z.stat===eZ.NOPROXY&&Oe(Li,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}}function h_(){return typeof document<"u"?document:null}function A9(r){return new TPe(r,!0)}class XO{constructor(e,t,n=1e3,i=1.5,o=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=i,this.Vo=o,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-n);i>0&&Oe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class pK{constructor(e,t,n,i,o,s,a,c){this.ii=e,this.$o=n,this.Oo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new XO(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return M(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return M(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var n=this;return M(function*(){n.Ho(),n.Jo(),n.qo.cancel(),n.Fo++,4!==e?n.qo.reset():t&&t.code===fe.RESOURCE_EXHAUSTED?(zr(t.toString()),zr("Using maximum backoff delay to prevent overloading the backend."),n.qo.xo()):t&&t.code===fe.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Yo(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Fo===t&&this.Zo(n,i)},n=>{e(()=>{const i=new Te(fe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.tu(i)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{n(()=>this.tu(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}Go(){var e=this;this.state=5,this.qo.No(M(function*(){e.state=0,e.start()}))}tu(e){return Oe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(Oe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class _Te extends pK{constructor(e,t,n,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,s),this.serializer=o}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function wPe(r,e){let t;if("targetChange"in e){const n="NO_CHANGE"===(c=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===c?1:"REMOVE"===c?2:"CURRENT"===c?3:"RESET"===c?4:at(),i=e.targetChange.targetIds||[],o=function(c,l){return c.useProto3Json?(mt(void 0===l||"string"==typeof l),l2.fromBase64String(l||"")):(mt(void 0===l||l instanceof Uint8Array),l2.fromUint8Array(l||new Uint8Array))}(r,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(c){const l=void 0===c.code?fe.UNKNOWN:aY(c.code);return new Te(l,c.message||"")}(s);t=new dY(n,i,o,a||null)}else if("documentChange"in e){const n=e.documentChange,i=Nc(r,n.document.name),o=Hr(n.document.updateTime),s=n.document.createTime?Hr(n.document.createTime):Ct.min(),a=new ii({mapValue:{fields:n.document.fields}}),c=D1.newFoundDocument(i,o,s,a);t=new Xm(n.targetIds||[],n.removedTargetIds||[],c.key,c)}else if("documentDelete"in e){const n=e.documentDelete,i=Nc(r,n.document),o=n.readTime?Hr(n.readTime):Ct.min(),s=D1.newNoDocument(i,o);t=new Xm([],n.removedTargetIds||[],s.key,s)}else if("documentRemove"in e){const n=e.documentRemove,i=Nc(r,n.document);t=new Xm([],n.removedTargetIds||[],i,null)}else{if(!("filter"in e))return at();{const n=e.filter,{count:i=0,unchangedNames:o}=n,s=new CPe(i,o);t=new fY(n.targetId,s)}}var c;return t}(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ct.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Ct.min():o.readTime?Hr(o.readTime):Ct.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=y9(this.serializer),t.addTarget=function(i,o){let s;const a=o.target;if(s=Gm(a)?{documents:EY(i,a)}:{query:wO(i,a)},s.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){s.resumeToken=mY(i,o.resumeToken);const c=PO(i,o.expectedCount);null!==c&&(s.expectedCount=c)}else if(o.snapshotVersion.compareTo(Ct.min())>0){s.readTime=m5(i,o.snapshotVersion.toTimestamp());const c=PO(i,o.expectedCount);null!==c&&(s.expectedCount=c)}return s}(this.serializer,e);const n=function APe(r,e){const t=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return at()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=y9(this.serializer),t.removeTarget=e,this.Wo(t)}}class vTe extends pK{constructor(e,t,n,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,s),this.serializer=o,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(mt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function NPe(r,e){return r&&r.length>0?(mt(void 0!==e),r.map(t=>function(n,i){let o=Hr(n.updateTime?n.updateTime:i);return o.isEqual(Ct.min())&&(o=Hr(i)),new gPe(o,n.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=Hr(e.commitTime);return this.listener.cu(n,t)}return mt(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=y9(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>function M9(r,e){let t;if(e instanceof p5)t={update:yY(r,e.key,e.value)};else if(e instanceof g5)t={delete:C9(r,e.key)};else if(e instanceof z3)t={update:yY(r,e.key,e.data),updateMask:LPe(e.fieldMask)};else{if(!(e instanceof vO))return at();t={verify:C9(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const s=o.transform;if(s instanceof d5)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(s instanceof G6)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:s.elements}};if(s instanceof U6)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:s.elements}};if(s instanceof h5)return{fieldPath:o.field.canonicalString(),increment:s.gt};throw at()}(0,n))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:OPe(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:at()),t;var i}(this.serializer,n))};this.Wo(t)}}class CTe extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Io(e,t,n,i,o)).catch(i=>{throw"FirebaseError"===i.name?(i.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Te(fe.UNKNOWN,i.toString())})}vo(e,t,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.vo(e,t,n,o,s,i)).catch(o=>{throw"FirebaseError"===o.name?(o.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Te(fe.UNKNOWN,o.toString())})}terminate(){this.lu=!0}}class MTe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(zr(t),this.mu=!1):Oe("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class ETe{constructor(e,t,n,i,o){var s=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=o,this.Pu.Yr(a=>{n.enqueueAndForget(M(function*(){var c;ol(s)&&(Oe("RemoteStore","Restarting streams for network reachability change."),yield(c=M(function*(l){const f=Ze(l);f.vu.add(4),yield E5(f),f.bu.set("Unknown"),f.vu.delete(4),yield I9(f)}),function(l){return c.apply(this,arguments)})(s))}))}),this.bu=new MTe(n,i)}}function I9(r){return JO.apply(this,arguments)}function JO(){return JO=M(function*(r){if(ol(r))for(const e of r.Ru)yield e(!0)}),JO.apply(this,arguments)}function E5(r){return eb.apply(this,arguments)}function eb(){return eb=M(function*(r){for(const e of r.Ru)yield e(!1)}),eb.apply(this,arguments)}function p_(r,e){const t=Ze(r);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),rb(t)?nb(t):P5(t).Ko()&&tb(t,e))}function k9(r,e){const t=Ze(r),n=P5(t);t.Au.delete(e),n.Ko()&&gK(t,e),0===t.Au.size&&(n.Ko()?n.jo():ol(t)&&t.bu.set("Unknown"))}function tb(r,e){if(r.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ct.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}P5(r).su(e)}function gK(r,e){r.Vu.qt(e),P5(r).iu(e)}function nb(r){r.Vu=new MPe({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),le:e=>r.Au.get(e)||null,ue:()=>r.datastore.serializer.databaseId}),P5(r).start(),r.bu.gu()}function rb(r){return ol(r)&&!P5(r).Uo()&&r.Au.size>0}function ol(r){return 0===Ze(r).vu.size}function mK(r){r.Vu=void 0}function STe(r){return ib.apply(this,arguments)}function ib(){return ib=M(function*(r){r.Au.forEach((e,t)=>{tb(r,e)})}),ib.apply(this,arguments)}function PTe(r,e){return ob.apply(this,arguments)}function ob(){return ob=M(function*(r,e){mK(r),rb(r)?(r.bu.Iu(e),nb(r)):r.bu.set("Unknown")}),ob.apply(this,arguments)}function TTe(r,e,t){return sb.apply(this,arguments)}function sb(){return sb=M(function*(r,e,t){if(r.bu.set("Online"),e instanceof dY&&2===e.state&&e.cause)try{yield(n=M(function*(i,o){const s=o.cause;for(const a of o.targetIds)i.Au.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.Au.delete(a),i.Vu.removeTarget(a))}),function(i,o){return n.apply(this,arguments)})(r,e)}catch(n){Oe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield g_(r,n)}else if(e instanceof Xm?r.Vu.Ht(e):e instanceof fY?r.Vu.ne(e):r.Vu.Xt(e),!t.isEqual(Ct.min()))try{const n=yield iK(r.localStore);t.compareTo(n)>=0&&(yield function(i,o){const s=i.Vu.ce(o);return s.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=i.Au.get(c);l&&i.Au.set(c,l.withResumeToken(a.resumeToken,o))}}),s.targetMismatches.forEach((a,c)=>{const l=i.Au.get(a);if(!l)return;i.Au.set(a,l.withResumeToken(l2.EMPTY_BYTE_STRING,l.snapshotVersion)),gK(i,a);const f=new D3(l.target,a,c,l.sequenceNumber);tb(i,f)}),i.remoteSyncer.applyRemoteEvent(s)}(r,t))}catch(n){Oe("RemoteStore","Failed to raise snapshot:",n),yield g_(r,n)}var n}),sb.apply(this,arguments)}function g_(r,e,t){return ab.apply(this,arguments)}function ab(){return ab=M(function*(r,e,t){if(!Z4(e))throw e;r.vu.add(1),yield E5(r),r.bu.set("Offline"),t||(t=()=>iK(r.localStore)),r.asyncQueue.enqueueRetryable(M(function*(){Oe("RemoteStore","Retrying IndexedDB access"),yield t(),r.vu.delete(1),yield I9(r)}))}),ab.apply(this,arguments)}function _K(r,e){return e().catch(t=>g_(r,t,e))}function S5(r){return cb.apply(this,arguments)}function cb(){return cb=M(function*(r){const e=Ze(r),t=sl(e);let n=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;OTe(e);)try{const i=yield uTe(e.localStore,n);if(null===i){0===e.Eu.length&&t.jo();break}n=i.batchId,bTe(e,i)}catch(i){yield g_(e,i)}vK(e)&&CK(e)}),cb.apply(this,arguments)}function OTe(r){return ol(r)&&r.Eu.length<10}function bTe(r,e){r.Eu.push(e);const t=sl(r);t.Ko()&&t.ou&&t.uu(e.mutations)}function vK(r){return ol(r)&&!sl(r).Uo()&&r.Eu.length>0}function CK(r){sl(r).start()}function wTe(r){return lb.apply(this,arguments)}function lb(){return lb=M(function*(r){sl(r).hu()}),lb.apply(this,arguments)}function NTe(r){return ub.apply(this,arguments)}function ub(){return ub=M(function*(r){const e=sl(r);for(const t of r.Eu)e.uu(t.mutations)}),ub.apply(this,arguments)}function ATe(r,e,t){return fb.apply(this,arguments)}function fb(){return fb=M(function*(r,e,t){const n=r.Eu.shift(),i=yO.from(n,e,t);yield _K(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield S5(r)}),fb.apply(this,arguments)}function ITe(r,e){return db.apply(this,arguments)}function db(){return db=M(function*(r,e){var t;e&&sl(r).ou&&(yield(t=M(function*(n,i){if(function sY(r){switch(r){default:return at();case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0}}(o=i.code)&&o!==fe.ABORTED){const s=n.Eu.shift();sl(n).Qo(),yield _K(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield S5(n)}var o}),function(n,i){return t.apply(this,arguments)})(r,e)),vK(r)&&CK(r)}),db.apply(this,arguments)}function yK(r,e){return hb.apply(this,arguments)}function hb(){return hb=M(function*(r,e){const t=Ze(r);t.asyncQueue.verifyOperationInProgress(),Oe("RemoteStore","RemoteStore received new credentials");const n=ol(t);t.vu.add(3),yield E5(t),n&&t.bu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),yield I9(t)}),hb.apply(this,arguments)}function gb(){return gb=M(function*(r,e){const t=Ze(r);e?(t.vu.delete(2),yield I9(t)):e||(t.vu.add(2),yield E5(t),t.bu.set("Unknown"))}),gb.apply(this,arguments)}function P5(r){return r.Su||(r.Su=function(e,t,n){const i=Ze(e);return i.fu(),new _Te(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:STe.bind(null,r),ao:PTe.bind(null,r),nu:TTe.bind(null,r)}),r.Ru.push(function(){var e=M(function*(t){t?(r.Su.Qo(),rb(r)?nb(r):r.bu.set("Unknown")):(yield r.Su.stop(),mK(r))});return function(t){return e.apply(this,arguments)}}())),r.Su}function sl(r){return r.Du||(r.Du=function(e,t,n){const i=Ze(e);return i.fu(),new vTe(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:wTe.bind(null,r),ao:ITe.bind(null,r),au:NTe.bind(null,r),cu:ATe.bind(null,r)}),r.Ru.push(function(){var e=M(function*(t){t?(r.Du.Qo(),yield S5(r)):(yield r.Du.stop(),r.Eu.length>0&&(Oe("RemoteStore",`Stopping write stream with ${r.Eu.length} pending writes`),r.Eu=[]))});return function(t){return e.apply(this,arguments)}}())),r.Du}class mb{constructor(e,t,n,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new c2,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}static createAndSchedule(e,t,n,i,o){const s=Date.now()+n,a=new mb(e,t,s,i,o);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Te(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function T5(r,e){if(zr("AsyncQueue",`${e}: ${r}`),Z4(r))return new Te(fe.UNAVAILABLE,`${e}: ${r}`);throw r}class O5{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ue.comparator(t.key,n.key):(t,n)=>Ue.comparator(t.key,n.key),this.keyedMap=d9(),this.sortedSet=new I1(this.comparator)}static emptySet(e){return new O5(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof O5)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new O5;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class MK{constructor(){this.Cu=new I1(Ue.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):at():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class b5{constructor(e,t,n,i,o,s,a,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,o){const s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new b5(e,t,O5.emptySet(t),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&u9(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class kTe{constructor(){this.Nu=void 0,this.listeners=[]}}class xTe{constructor(){this.queries=new R3(e=>$Z(e),u9),this.onlineState="Unknown",this.ku=new Set}}function _b(r,e){return vb.apply(this,arguments)}function vb(){return vb=M(function*(r,e){const t=Ze(r),n=e.query;let i=!1,o=t.queries.get(n);if(o||(i=!0,o=new kTe),i)try{o.Nu=yield t.onListen(n)}catch(s){const a=T5(s,`Initialization of query '${mO(e.query)}' failed`);return void e.onError(a)}t.queries.set(n,o),o.listeners.push(e),e.Mu(t.onlineState),o.Nu&&e.$u(o.Nu)&&Mb(t)}),vb.apply(this,arguments)}function Cb(r,e){return yb.apply(this,arguments)}function yb(){return yb=M(function*(r,e){const t=Ze(r),n=e.query;let i=!1;const o=t.queries.get(n);if(o){const s=o.listeners.indexOf(e);s>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length)}if(i)return t.queries.delete(n),t.onUnlisten(n)}),yb.apply(this,arguments)}function LTe(r,e){const t=Ze(r);let n=!1;for(const i of e){const s=t.queries.get(i.query);if(s){for(const a of s.listeners)a.$u(i)&&(n=!0);s.Nu=i}}n&&Mb(t)}function RTe(r,e,t){const n=Ze(r),i=n.queries.get(e);if(i)for(const o of i.listeners)o.onError(t);n.queries.delete(e)}function Mb(r){r.ku.forEach(e=>{e.next()})}class Eb{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)3!==i.type&&n.push(i);e=new b5(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=b5.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class PK{constructor(e){this.key=e}}class TK{constructor(e){this.key=e}}class OK{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=rn(),this.mutatedKeys=rn(),this.tc=GZ(e),this.ec=new O5(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new MK,i=t?t.ec:this.ec;let o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1;const c="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,d)=>{const m=i.get(f),E=f9(this.query,d)?d:null,w=!!m&&this.mutatedKeys.has(m.key),L=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let z=!1;m&&E?m.data.isEqual(E.data)?w!==L&&(n.track({type:3,doc:E}),z=!0):this.rc(m,E)||(n.track({type:2,doc:E}),z=!0,(c&&this.tc(E,c)>0||l&&this.tc(E,l)<0)&&(a=!0)):!m&&E?(n.track({type:0,doc:E}),z=!0):m&&!E&&(n.track({type:1,doc:m}),z=!0,(c||l)&&(a=!0)),z&&(E?(s=s.add(E),o=L?o.add(f):o.delete(f)):(s=s.delete(f),o=o.delete(f)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const f="F"===this.query.limitType?s.last():s.first();s=s.delete(f.key),o=o.delete(f.key),n.track({type:1,doc:f})}return{ec:s,ic:n,zi:a,mutatedKeys:o}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const o=e.ic.xu();o.sort((l,f)=>function(d,m){const E=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return at()}};return E(d)-E(m)}(l.type,f.type)||this.tc(l.doc,f.doc)),this.oc(n);const s=t?this.uc():[],a=0===this.Zu.size&&this.current?1:0,c=a!==this.Xu;return this.Xu=a,0!==o.length||c?{snapshot:new b5(this.query,e.ec,i,o,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:s}:{cc:s}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new MK,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=rn(),this.ec.forEach(n=>{this.ac(n.key)&&(this.Zu=this.Zu.add(n.key))});const t=[];return e.forEach(n=>{this.Zu.has(n)||t.push(new TK(n))}),this.Zu.forEach(n=>{e.has(n)||t.push(new PK(n))}),t}hc(e){this.Yu=e.ir,this.Zu=rn();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return b5.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class HTe{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class VTe{constructor(e){this.key=e,this.fc=!1}}class FTe{constructor(e,t,n,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.dc={},this.wc=new R3(a=>$Z(a),u9),this._c=new Map,this.mc=new Set,this.gc=new I1(Ue.comparator),this.yc=new Map,this.Ic=new zO,this.Tc={},this.Ec=new Map,this.Ac=K6.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function $Te(r,e){return Sb.apply(this,arguments)}function Sb(){return Sb=M(function*(r,e){const t=function qb(r){const e=Ze(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=bK.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KTe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=UTe.bind(null,e),e.dc.nu=LTe.bind(null,e.eventManager),e.dc.Pc=RTe.bind(null,e.eventManager),e}(r);let n,i;const o=t.wc.get(e);if(o)n=o.targetId,t.sharedClientState.addLocalQueryTarget(n),i=o.view.lc();else{const s=yield function y5(r,e){const t=Ze(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Bs.getTargetData(n,e).next(o=>o?(i=o,ce.resolve(i)):t.Bs.allocateTargetId(n).next(s=>(i=new D3(e,s,"TargetPurposeListen",n.currentSequenceNumber),t.Bs.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ji.get(n.targetId);return(null===i||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(n.targetId,n),t.Yi.set(e,n.targetId)),n})}(t.localStore,co(e)),a=t.sharedClientState.addLocalQueryTarget(s.targetId);n=s.targetId,i=yield function Pb(r,e,t,n,i){return Tb.apply(this,arguments)}(t,e,n,"current"===a,s.resumeToken),t.isPrimaryClient&&p_(t.remoteStore,s)}return i}),Sb.apply(this,arguments)}function Tb(){return Tb=M(function*(r,e,t,n,i){r.Rc=(d,m,E)=>{return(w=M(function*(L,z,$,B){let de=z.view.sc($);de.zi&&(de=yield l_(L.localStore,z.query,!1).then(({documents:nt})=>z.view.sc(nt,de)));const _e=B&&B.targetChanges.get(z.targetId),xe=z.view.applyChanges(de,L.isPrimaryClient,_e);return Rb(L,z.targetId,xe.cc),xe.snapshot}),function(L,z,$,B){return w.apply(this,arguments)})(r,d,m,E);var w};const o=yield l_(r.localStore,e,!0),s=new OK(e,o.ir),a=s.sc(o.documents),c=v9.createSynthesizedTargetChangeForCurrentChange(t,n&&"Offline"!==r.onlineState,i),l=s.applyChanges(a,r.isPrimaryClient,c);Rb(r,t,l.cc);const f=new HTe(e,t,s);return r.wc.set(e,f),r._c.has(t)?r._c.get(t).push(e):r._c.set(t,[e]),l.snapshot}),Tb.apply(this,arguments)}function BTe(r,e){return Ob.apply(this,arguments)}function Ob(){return Ob=M(function*(r,e){const t=Ze(r),n=t.wc.get(e),i=t._c.get(n.targetId);if(i.length>1)return t._c.set(n.targetId,i.filter(o=>!u9(o,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)||(yield M5(t.localStore,n.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(n.targetId),k9(t.remoteStore,n.targetId),w5(t,n.targetId)}).catch(j4))):(w5(t,n.targetId),yield M5(t.localStore,n.targetId,!0))}),Ob.apply(this,arguments)}function bb(){return bb=M(function*(r,e,t){const n=function jb(r){const e=Ze(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=WTe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qTe.bind(null,e),e}(r);try{const i=yield function(o,s){const a=Ze(o),c=or.now(),l=s.reduce((m,E)=>m.add(E.key),rn());let f,d;return a.persistence.runTransaction("Locally write mutations","readwrite",m=>{let E=Ro(),w=rn();return a.Zi.getEntries(m,l).next(L=>{E=L,E.forEach((z,$)=>{$.isValidDocument()||(w=w.add(z))})}).next(()=>a.localDocuments.getOverlayedDocuments(m,E)).next(L=>{f=L;const z=[];for(const $ of s){const B=_Pe($,f.get($.key).overlayedDocument);null!=B&&z.push(new z3($.key,B,bZ(B.value.mapValue),K1.exists(!0)))}return a.mutationQueue.addMutationBatch(m,c,z,s)}).next(L=>{d=L;const z=L.applyToLocalDocumentSet(f,w);return a.documentOverlayCache.saveOverlays(m,L.batchId,z)})}).then(()=>({batchId:d.batchId,changes:WZ(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,s,a){let c=o.Tc[o.currentUser.toKey()];c||(c=new I1(qt)),c=c.insert(s,a),o.Tc[o.currentUser.toKey()]=c}(n,i.batchId,t),yield H3(n,i.changes),yield S5(n.remoteStore)}catch(i){const o=T5(i,"Failed to persist write");t.reject(o)}}),bb.apply(this,arguments)}function bK(r,e){return wb.apply(this,arguments)}function wb(){return wb=M(function*(r,e){const t=Ze(r);try{const n=yield function lTe(r,e){const t=Ze(r),n=e.snapshotVersion;let i=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=t.Zi.newChangeBuffer({trackRemovals:!0});i=t.Ji;const a=[];e.targetChanges.forEach((f,d)=>{const m=i.get(d);if(!m)return;a.push(t.Bs.removeMatchingKeys(o,f.removedDocuments,d).next(()=>t.Bs.addMatchingKeys(o,f.addedDocuments,d)));let E=m.withSequenceNumber(o.currentSequenceNumber);var w,L,z;null!==e.targetMismatches.get(d)?E=E.withResumeToken(l2.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):f.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(f.resumeToken,n)),i=i.insert(d,E),L=E,z=f,(0===(w=m).resumeToken.approximateByteSize()||L.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8||z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0)&&a.push(t.Bs.updateTargetData(o,E))});let c=Ro(),l=rn();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,f))}),a.push(function oK(r,e,t){let n=rn(),i=rn();return t.forEach(o=>n=n.add(o)),e.getEntries(r,n).next(o=>{let s=Ro();return t.forEach((a,c)=>{const l=o.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(Ct.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):Oe("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{nr:s,sr:i}})}(o,s,e.documentUpdates).next(f=>{c=f.nr,l=f.sr})),!n.isEqual(Ct.min())){const f=t.Bs.getLastRemoteSnapshotVersion(o).next(d=>t.Bs.setTargetsMetadata(o,o.currentSequenceNumber,n));a.push(f)}return ce.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,l)).next(()=>c)}).then(o=>(t.Ji=i,o))}(t.localStore,e);e.targetChanges.forEach((i,o)=>{const s=t.yc.get(o);s&&(mt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.fc=!0:i.modifiedDocuments.size>0?mt(s.fc):i.removedDocuments.size>0&&(mt(s.fc),s.fc=!1))}),yield H3(t,n,e)}catch(n){yield j4(n)}}),wb.apply(this,arguments)}function wK(r,e,t){const n=Ze(r);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const i=[];n.wc.forEach((o,s)=>{const a=s.view.Mu(e);a.snapshot&&i.push(a.snapshot)}),function(o,s){const a=Ze(o);a.onlineState=s;let c=!1;a.queries.forEach((l,f)=>{for(const d of f.listeners)d.Mu(s)&&(c=!0)}),c&&Mb(a)}(n.eventManager,e),i.length&&n.dc.nu(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function UTe(r,e,t){return Nb.apply(this,arguments)}function Nb(){return Nb=M(function*(r,e,t){const n=Ze(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.yc.get(e),o=i&&i.key;if(o){let s=new I1(Ue.comparator);s=s.insert(o,D1.newNoDocument(o,Ct.min()));const a=rn().add(o),c=new _9(Ct.min(),new Map,new I1(qt),s,a);yield bK(n,c),n.gc=n.gc.remove(o),n.yc.delete(e),zb(n)}else yield M5(n.localStore,e,!1).then(()=>w5(n,e,t)).catch(j4)}),Nb.apply(this,arguments)}function WTe(r,e){return Ab.apply(this,arguments)}function Ab(){return Ab=M(function*(r,e){const t=Ze(r),n=e.batch.batchId;try{const i=yield function cTe(r,e){const t=Ze(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=t.Zi.newChangeBuffer({trackRemovals:!0});return function(s,a,c,l){const f=c.batch,d=f.keys();let m=ce.resolve();return d.forEach(E=>{m=m.next(()=>l.getEntry(a,E)).next(w=>{const L=c.docVersions.get(E);mt(null!==L),w.version.compareTo(L)<0&&(f.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),l.addEntry(w)))})}),m.next(()=>s.mutationQueue.removeMutationBatch(a,f))}(t,n,e,o).next(()=>o.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(s){let a=rn();for(let c=0;c<s.mutationResults.length;++c)s.mutationResults[c].transformResults.length>0&&(a=a.add(s.batch.mutations[c].key));return a}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}(t.localStore,e);Lb(t,n,null),xb(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield H3(t,i)}catch(i){yield j4(i)}}),Ab.apply(this,arguments)}function qTe(r,e,t){return Ib.apply(this,arguments)}function Ib(){return Ib=M(function*(r,e,t){const n=Ze(r);try{const i=yield function(o,s){const a=Ze(o);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,s).next(f=>(mt(null!==f),l=f.keys(),a.mutationQueue.removeMutationBatch(c,f))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,s)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(n.localStore,e);Lb(n,e,t),xb(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield H3(n,i)}catch(i){yield j4(i)}}),Ib.apply(this,arguments)}function xb(r,e){(r.Ec.get(e)||[]).forEach(t=>{t.resolve()}),r.Ec.delete(e)}function Lb(r,e,t){const n=Ze(r);let i=n.Tc[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),n.Tc[n.currentUser.toKey()]=i}}function w5(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r._c.get(e))r.wc.delete(n),t&&r.dc.Pc(n,t);r._c.delete(e),r.isPrimaryClient&&r.Ic.Is(e).forEach(n=>{r.Ic.containsKey(n)||NK(r,n)})}function NK(r,e){r.mc.delete(e.path.canonicalString());const t=r.gc.get(e);null!==t&&(k9(r.remoteStore,t),r.gc=r.gc.remove(e),r.yc.delete(t),zb(r))}function Rb(r,e,t){for(const n of t)n instanceof PK?(r.Ic.addReference(n.key,e),ZTe(r,n)):n instanceof TK?(Oe("SyncEngine","Document no longer in limbo: "+n.key),r.Ic.removeReference(n.key,e),r.Ic.containsKey(n.key)||NK(r,n.key)):at()}function ZTe(r,e){const t=e.key,n=t.path.canonicalString();r.gc.get(t)||r.mc.has(n)||(Oe("SyncEngine","New document in limbo: "+t),r.mc.add(n),zb(r))}function zb(r){for(;r.mc.size>0&&r.gc.size<r.maxConcurrentLimboResolutions;){const e=r.mc.values().next().value;r.mc.delete(e);const t=new Ue(Hn.fromString(e)),n=r.Ac.next();r.yc.set(n,new VTe(t)),r.gc=r.gc.insert(t,n),p_(r.remoteStore,new D3(co(f5(t.path)),n,"TargetPurposeLimboResolution",cs.ct))}}function H3(r,e,t){return Db.apply(this,arguments)}function Db(){return Db=M(function*(r,e,t){const n=Ze(r),i=[],o=[],s=[];var a;n.wc.isEmpty()||(n.wc.forEach((a,c)=>{s.push(n.Rc(c,e,t).then(l=>{if((l||t)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const f=$O.Li(c.targetId,l);o.push(f)}}))}),yield Promise.all(s),n.dc.nu(i),yield(a=M(function*(c,l){const f=Ze(c);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ce.forEach(l,m=>ce.forEach(m.Fi,E=>f.persistence.referenceDelegate.addReference(d,m.targetId,E)).next(()=>ce.forEach(m.Bi,E=>f.persistence.referenceDelegate.removeReference(d,m.targetId,E)))))}catch(d){if(!Z4(d))throw d;Oe("LocalStore","Failed to update sequence numbers: "+d)}for(const d of l){const m=d.targetId;if(!d.fromCache){const E=f.Ji.get(m),L=E.withLastLimboFreeSnapshotVersion(E.snapshotVersion);f.Ji=f.Ji.insert(m,L)}}}),function(c,l){return a.apply(this,arguments)})(n.localStore,o))}),Db.apply(this,arguments)}function YTe(r,e){return Hb.apply(this,arguments)}function Hb(){return Hb=M(function*(r,e){const t=Ze(r);if(!t.currentUser.isEqual(e)){Oe("SyncEngine","User change. New user:",e.toKey());const n=yield rK(t.localStore,e);t.currentUser=e,(i=t).Ec.forEach(s=>{s.forEach(a=>{a.reject(new Te(fe.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.Ec.clear(),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield H3(t,n.er)}var i}),Hb.apply(this,arguments)}function KTe(r,e){const t=Ze(r),n=t.yc.get(e);if(n&&n.fc)return rn().add(n.key);{let i=rn();const o=t._c.get(e);if(!o)return i;for(const s of o){const a=t.wc.get(s);i=i.unionWith(a.view.nc)}return i}}class m_{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return M(function*(){t.serializer=A9(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function nK(r,e,t,n){return new aTe(r,e,t,n)}(this.persistence,new tK,e.initialUser,this.serializer)}createPersistence(e){return new DO(s_.zs,this.serializer)}createSharedClientState(e){return new fK}terminate(){var e=this;return M(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class N5{initialize(e,t){var n=this;return M(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=i=>wK(n.syncEngine,i,1),n.remoteStore.remoteSyncer.handleCredentialChange=YTe.bind(null,n.syncEngine),yield function pb(r,e){return gb.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new xTe}createDatastore(e){const t=A9(e.databaseInfo.databaseId),n=new mTe(e.databaseInfo);return new CTe(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,o=a=>wK(this.syncEngine,a,0),s=dK.D()?new dK:new hTe,new ETe(t,n,i,o,s);var t,n,i,o,s}createSyncEngine(e,t){return function(n,i,o,s,a,c,l){const f=new FTe(n,i,o,s,a,c);return l&&(f.vc=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=M(function*(t){const n=Ze(t);Oe("RemoteStore","RemoteStore shutting down."),n.vu.add(5),yield E5(n),n.Pu.shutdown(),n.bu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}class __{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):zr("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class lOe{constructor(e,t,n,i){var o=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=N2.UNAUTHENTICATED,this.clientId=iZ.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var s=M(function*(a){Oe("FirestoreClient","Received user=",a.uid),yield o.authCredentialListener(a),o.user=a});return function(a){return s.apply(this,arguments)}}()),this.appCheckCredentials.start(n,s=>(Oe("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}getConfiguration(){var e=this;return M(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new c2;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(M(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=T5(n,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function v_(r,e){return Zb.apply(this,arguments)}function Zb(){return Zb=M(function*(r,e){r.asyncQueue.verifyOperationInProgress(),Oe("FirestoreClient","Initializing OfflineComponentProvider");const t=yield r.getConfiguration();yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(function(){var i=M(function*(o){n.isEqual(o)||(yield rK(e.localStore,o),n=o)});return function(o){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}),Zb.apply(this,arguments)}function Yb(r,e){return Kb.apply(this,arguments)}function Kb(){return Kb=M(function*(r,e){r.asyncQueue.verifyOperationInProgress();const t=yield function Xb(r){return Qb.apply(this,arguments)}(r);Oe("FirestoreClient","Initializing OnlineComponentProvider");const n=yield r.getConfiguration();yield e.initialize(t,n),r.setCredentialChangeListener(i=>yK(e.remoteStore,i)),r.setAppCheckTokenChangeListener((i,o)=>yK(e.remoteStore,o)),r._onlineComponents=e}),Kb.apply(this,arguments)}function Qb(){return Qb=M(function*(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Oe("FirestoreClient","Using user provided OfflineComponentProvider");try{yield v_(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function RK(r){return"FirebaseError"===r.name?r.code===fe.FAILED_PRECONDITION||r.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code}(t))throw t;Ea("Error using user provided cache. Falling back to memory cache: "+t),yield v_(r,new m_)}}else Oe("FirestoreClient","Using default OfflineComponentProvider"),yield v_(r,new m_);return r._offlineComponents}),Qb.apply(this,arguments)}function C_(r){return Jb.apply(this,arguments)}function Jb(){return Jb=M(function*(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Oe("FirestoreClient","Using user provided OnlineComponentProvider"),yield Yb(r,r._uninitializedComponentsProvider._online)):(Oe("FirestoreClient","Using default OnlineComponentProvider"),yield Yb(r,new N5))),r._onlineComponents}),Jb.apply(this,arguments)}function A5(r){return tw.apply(this,arguments)}function tw(){return tw=M(function*(r){const e=yield C_(r),t=e.eventManager;return t.onListen=$Te.bind(null,e.syncEngine),t.onUnlisten=BTe.bind(null,e.syncEngine),t}),tw.apply(this,arguments)}function $K(r){const e={};return void 0!==r.timeoutSeconds&&(e.timeoutSeconds=r.timeoutSeconds),e}const BK=new Map;function nw(r,e,t){if(!t)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function GK(r){if(!Ue.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function UK(r){if(Ue.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function M_(r){if(void 0===r)return"undefined";if(null===r)return"null";if("string"==typeof r)return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if("number"==typeof r||"boolean"==typeof r)return""+r;if("object"==typeof r){if(r instanceof Array)return"an array";{const e=(t=r).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof r?"a function":at()}function In(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Te(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=M_(r);throw new Te(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}class qK{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Te(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Te(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function vOe(r,e,t,n){if(!0===e&&!0===n)throw new Te(fe.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=$K(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(i){if(void 0!==i.timeoutSeconds){if(isNaN(i.timeoutSeconds))throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class x9{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qK({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Te(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Te(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qK(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new mSe;switch(t.type){case"firstParty":return new ySe(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Te(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=BK.get(e);t&&(Oe("ComponentProvider","Removing Datastore"),BK.delete(e),t.terminate())}(this),Promise.resolve()}}function jK(r,e,t,n={}){var i;const o=(r=In(r,x9))._getSettings(),s=`${e}:${t}`;if("firestore.googleapis.com"!==o.host&&o.host!==s&&Ea("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),n.mockUserToken){let a,c;if("string"==typeof n.mockUserToken)a=n.mockUserToken,c=N2.MOCK_USER;else{a=function Bye(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=r.iat||0,o=r.sub||r.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Qg(JSON.stringify({alg:"none",type:"JWT"})),Qg(JSON.stringify(s)),""].join(".")}(n.mockUserToken,null===(i=r._app)||void 0===i?void 0:i.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Te(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new N2(l)}r._authCredentials=new _Se(new nZ(a,c))}}class Vr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ac(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vr(this.firestore,e,this._key)}}class oi{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new oi(this.firestore,e,this._query)}}class Ac extends oi{constructor(e,t,n){super(e,t,f5(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vr(this.firestore,null,new Ue(e))}withConverter(e){return new Ac(this.firestore,e,this._path)}}function COe(r,e,...t){if(r=mr(r),nw("collection","path",e),r instanceof x9){const n=Hn.fromString(e,...t);return UK(n),new Ac(r,null,n)}{if(!(r instanceof Vr||r instanceof Ac))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Hn.fromString(e,...t));return UK(n),new Ac(r.firestore,null,n)}}function ZK(r,e,...t){if(r=mr(r),1===arguments.length&&(e=iZ.A()),nw("doc","path",e),r instanceof x9){const n=Hn.fromString(e,...t);return GK(n),new Vr(r,null,new Ue(n))}{if(!(r instanceof Vr||r instanceof Ac))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Hn.fromString(e,...t));return GK(n),new Vr(r.firestore,r instanceof Ac?r.converter:null,new Ue(n))}}class yOe{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new XO(this,"async_queue_retry"),this.Xc=()=>{const t=h_();t&&Oe("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=h_();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=h_();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new c2;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return M(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!Z4(t))throw t;Oe("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(n=>{throw this.Wc=n,this.Hc=!1,zr("INTERNAL UNHANDLED ERROR: ",function(o){let s=o.message||"";return o.stack&&(s=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),s}(n)),n}).then(n=>(this.Hc=!1,n))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=mb.createAndSchedule(this,e,t,n,o=>this.na(o));return this.zc.push(i),i}Zc(){this.Wc&&at()}verifyOperationInProgress(){}sa(){var e=this;return M(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function rw(r){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const i of["next","error","complete"])if(i in n&&"function"==typeof n[i])return!0;return!1}(r)}class H1 extends x9{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new yOe,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||KK(this),this._firestoreClient.terminate()}}function EOe(r,e){const n="string"==typeof r?r:e||"(default)",i=X8("object"==typeof r?r:aT(),"firestore").getImmediate({identifier:n});if(!i._initialized){const o=(r=>{const e=yq("firestore");if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),n]:[e.substring(0,t),n]})();o&&jK(i,...o)}return i}function Xr(r){return r._firestoreClient||KK(r),r._firestoreClient.verifyNotTerminated(),r._firestoreClient}function KK(r){var e,t,n;const i=r._freezeSettings(),o=(a=(null===(e=r._app)||void 0===e?void 0:e.options.appId)||"",new KSe(r._databaseId,a,r._persistenceKey,(l=i).host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,$K(l.experimentalLongPollingOptions),l.useFetchStreams));var a,l;r._firestoreClient=new lOe(r._authCredentials,r._appCheckCredentials,r._queue,o),null!==(t=i.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(n=i.cache)&&void 0!==n&&n._onlineComponentProvider&&(r._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}class Q6{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Q6(l2.fromBase64String(e))}catch(t){throw new Te(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Q6(l2.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class I5{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Te(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class E_{constructor(e){this._methodName=e}}class iw{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Te(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Te(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qt(this._lat,e._lat)||qt(this._long,e._long)}}const POe=/^__.*__$/;class TOe{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new z3(e,this.data,this.fieldMask,t,this.fieldTransforms):new p5(e,this.data,t,this.fieldTransforms)}}class JK{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new z3(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function eX(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw at()}}class S_{constructor(e,t,n,i,o,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===o&&this.ua(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new S_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.fa(e),i}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return T_(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(eX(this.ca)&&POe.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class OOe{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||A9(e)}ya(e,t,n,i=!1){return new S_({ca:e,methodName:t,ga:n,path:Dr.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function k5(r){const e=r._freezeSettings(),t=A9(r._databaseId);return new OOe(r._databaseId,!!e.ignoreUndefinedProperties,t)}function ow(r,e,t,n,i,o={}){const s=r.ya(o.merge||o.mergeFields?2:0,e,t,i);aw("Data must be an object, but it was:",s,n);const a=oX(n,s);let c,l;if(o.merge)c=new Lo(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){const f=[];for(const d of o.mergeFields){const m=z9(e,d,t);if(!s.contains(m))throw new Te(fe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);aX(f,m)||f.push(m)}c=new Lo(f),l=s.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=s.fieldTransforms;return new TOe(new ii(a),c,l)}class R9 extends E_{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof R9}}class sw extends E_{_toFieldTransform(e){return new p9(e.path,new d5)}isEqual(e){return e instanceof sw}}function J6(r,e){if(sX(r=mr(r)))return aw("Unsupported field value:",e,r),oX(r,e);if(r instanceof E_)return function(t,n){if(!eX(n.ca))throw n._a(`${t._methodName}() can only be used with update() and set()`);if(!n.path)throw n._a(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(n);i&&n.fieldTransforms.push(i)}(r,e),null;if(void 0===r&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,n){const i=[];let o=0;for(const s of t){let a=J6(s,n.wa(o));null==a&&(a={nullValue:"NULL_VALUE"}),i.push(a),o++}return{arrayValue:{values:i}}}(r,e)}return function(t,n){if(null===(t=mr(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return YZ(n.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=or.fromDate(t);return{timestampValue:m5(n.serializer,i)}}if(t instanceof or){const i=new or(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:m5(n.serializer,i)}}if(t instanceof iw)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Q6)return{bytesValue:mY(n.serializer,t._byteString)};if(t instanceof Vr){const i=n.databaseId,o=t.firestore._databaseId;if(!o.isEqual(i))throw n._a(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:TO(t.firestore._databaseId||n.databaseId,t._key.path)}}throw n._a(`Unsupported field value: ${M_(t)}`)}(r,e)}function oX(r,e){const t={};return vZ(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Y4(r,(n,i)=>{const o=J6(i,e.ha(n));null!=o&&(t[n]=o)}),{mapValue:{fields:t}}}function sX(r){return!("object"!=typeof r||null===r||r instanceof Array||r instanceof Date||r instanceof or||r instanceof iw||r instanceof Q6||r instanceof Vr||r instanceof E_)}function aw(r,e,t){if(!sX(t)||"object"!=typeof(n=t)||null===n||Object.getPrototypeOf(n)!==Object.prototype&&null!==Object.getPrototypeOf(n)){const n=M_(t);throw e._a("an object"===n?r+" a custom object":r+" "+n)}var n}function z9(r,e,t){if((e=mr(e))instanceof I5)return e._internalPath;if("string"==typeof e)return P_(r,e);throw T_("Field path arguments must be of type string or ",r,!1,void 0,t)}const AOe=new RegExp("[~\\*/\\[\\]]");function P_(r,e,t){if(e.search(AOe)>=0)throw T_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new I5(...e.split("."))._internalPath}catch{throw T_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function T_(r,e,t,n,i){const o=n&&!n.isEmpty(),s=void 0!==i;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new Te(fe.INVALID_ARGUMENT,a+r+c)}function aX(r,e){return r.some(t=>t.isEqual(e))}class cw{constructor(e,t,n,i,o){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Vr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new IOe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(O_("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class IOe extends cw{data(){return super.data()}}function O_(r,e){return"string"==typeof e?P_(r,e):e instanceof I5?e._internalPath:e._delegate._internalPath}function cX(r){if("L"===r.limitType&&0===r.explicitOrderBy.length)throw new Te(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lw{}class uw extends lw{}function kOe(r,e,...t){let n=[];e instanceof lw&&n.push(e),n=n.concat(t),function(i){const o=i.filter(a=>a instanceof x5).length,s=i.filter(a=>a instanceof D9).length;if(o>1||o>0&&s>0)throw new Te(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class D9 extends uw{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new D9(e,t,n)}_apply(e){const t=this._parse(e);return dX(e._query,t),new oi(e.firestore,e.converter,gO(e._query,t))}_parse(e){const t=k5(e.firestore);return function(i,o,s,a,c,l,f){let d;if(c.isKeyField()){if("array-contains"===l||"array-contains-any"===l)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if("in"===l||"not-in"===l){fX(f,l);const m=[];for(const E of f)m.push(uX(a,i,E));d={arrayValue:{values:m}}}else d=uX(a,i,f)}else"in"!==l&&"not-in"!==l&&"array-contains-any"!==l||fX(f,l),d=function iX(r,e,t,n=!1){return J6(t,r.ya(n?4:3,e))}(s,"where",f,"in"===l||"not-in"===l);return Pn.create(c,l,d)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}function xOe(r,e,t){const n=e,i=O_("where",r);return D9._create(i,n,t)}class x5 extends lw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new x5(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return 1===t.length?t[0]:c1.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(n,i){let o=n;const s=i.getFlattenedFilters();for(const a of s)dX(o,a),o=gO(o,a)}(e._query,t),new oi(e.firestore,e.converter,gO(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class fw extends uw{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new fw(e,t)}_apply(e){const t=function(n,i,o){if(null!==n.startAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==n.endAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const s=new l5(i,o);return function(a,c){if(null===hO(a)){const l=Wm(a);null!==l&&hX(0,l,c.field)}}(n,s),s}(e._query,this._field,this._direction);return new oi(e.firestore,e.converter,function(n,i){const o=n.explicitOrderBy.concat([i]);return new L3(n.path,n.collectionGroup,o,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,t))}}function LOe(r,e="asc"){const t=e,n=O_("orderBy",r);return fw._create(n,t)}class b_ extends uw{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new b_(e,t,n)}_apply(e){return new oi(e.firestore,e.converter,qm(e._query,this._limit,this._limitType))}}function ROe(r){return function WK(r,e){if(e<=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}("limit",r),b_._create("limit",r,"F")}function uX(r,e,t){if("string"==typeof(t=mr(t))){if(""===t)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pO(e)&&-1!==t.indexOf("/"))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Hn.fromString(t));if(!Ue.isDocumentKey(n))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return F6(r,new Ue(n))}if(t instanceof Vr)return F6(r,t._key);throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${M_(t)}.`)}function fX(r,e){if(!Array.isArray(r)||0===r.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function dX(r,e){if(e.isInequality()){const n=Wm(r),i=e.field;if(null!==n&&!n.isEqual(i))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${i.toString()}'`);const o=hO(r);null!==o&&hX(0,i,o)}const t=function(n,i){for(const o of n)for(const s of o.getFlattenedFilters())if(i.indexOf(s.op)>=0)return s.op;return null}(r.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Te(fe.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function hX(r,e,t){if(!t.isEqual(e))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class zOe{convertValue(e,t="none"){switch(Q4(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Cr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(x3(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw at()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Y4(e,(i,o)=>{n[i]=this.convertValue(o,t)}),n}convertGeoPoint(e){return new iw(Cr(e.latitude),Cr(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Vm(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(o9(e));default:return null}}convertTimestamp(e){const t=K4(e);return new or(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Hn.fromString(e);mt(OY(n));const i=new V6(n.get(1),n.get(3)),o=new Ue(n.popFirst(5));return i.isEqual(t)||zr(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}function dw(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class e0{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class L5 extends cw{constructor(e,t,n,i,o,s){super(e,t,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new A_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(O_("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class A_ extends L5{data(e={}){return super.data(e)}}class R5{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new e0(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new A_(this._firestore,this._userDataWriter,n.key,n,new e0(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Te(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(n,i){if(n._snapshot.oldDocs.isEmpty()){let o=0;return n._snapshot.docChanges.map(s=>({type:"added",doc:new A_(n._firestore,n._userDataWriter,s.doc.key,s.doc,new e0(n._snapshot.mutatedKeys.has(s.doc.key),n._snapshot.fromCache),n.query.converter),oldIndex:-1,newIndex:o++}))}{let o=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(s=>i||3!==s.type).map(s=>{const a=new A_(n._firestore,n._userDataWriter,s.doc.key,s.doc,new e0(n._snapshot.mutatedKeys.has(s.doc.key),n._snapshot.fromCache),n.query.converter);let c=-1,l=-1;return 0!==s.type&&(c=o.indexOf(s.doc.key),o=o.delete(s.doc.key)),1!==s.type&&(o=o.add(s.doc),l=o.indexOf(s.doc.key)),{type:HOe(s.type),doc:a,oldIndex:c,newIndex:l}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function HOe(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return at()}}function VOe(r){r=In(r,Vr);const e=In(r.firestore,H1);return function VK(r,e,t={}){const n=new c2;return r.asyncQueue.enqueueAndForget(M(function*(){return function(i,o,s,a,c){const l=new __({next:d=>{o.enqueueAndForget(()=>Cb(i,f));const m=d.docs.has(s);!m&&d.fromCache?c.reject(new Te(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&a&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new Eb(f5(s.path),l,{includeMetadataChanges:!0,Ku:!0});return _b(i,f)}(yield A5(r),r.asyncQueue,e,t,n)})),n.promise}(Xr(e),r._key).then(t=>hw(e,r,t))}class al extends zOe{constructor(e){super(),this.firestore=e}convertBytes(e){return new Q6(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vr(this.firestore,null,t)}}function FOe(r){r=In(r,oi);const e=In(r.firestore,H1),t=Xr(e),n=new al(e);return cX(r._query),function FK(r,e,t={}){const n=new c2;return r.asyncQueue.enqueueAndForget(M(function*(){return function(i,o,s,a,c){const l=new __({next:d=>{o.enqueueAndForget(()=>Cb(i,f)),d.fromCache&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new Eb(s,l,{includeMetadataChanges:!0,Ku:!0});return _b(i,f)}(yield A5(r),r.asyncQueue,e,t,n)})),n.promise}(t,r._query).then(i=>new R5(e,n,r,i))}function $Oe(r,e,t){r=In(r,Vr);const n=In(r.firestore,H1),i=dw(r.converter,e,t);return H9(n,[ow(k5(n),"setDoc",r._key,i,null!==r.converter,t).toMutation(r._key,K1.none())])}function BOe(r,e,t,...n){r=In(r,Vr);const i=In(r.firestore,H1),o=k5(i);let s;return s="string"==typeof(e=mr(e))||e instanceof I5?function rX(r,e,t,n,i,o){const s=r.ya(1,e,t),a=[z9(e,n,t)],c=[i];if(o.length%2!=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<o.length;m+=2)a.push(z9(e,o[m])),c.push(o[m+1]);const l=[],f=ii.empty();for(let m=a.length-1;m>=0;--m)if(!aX(l,a[m])){const E=a[m];let w=c[m];w=mr(w);const L=s.da(E);if(w instanceof R9)l.push(E);else{const z=J6(w,L);null!=z&&(l.push(E),f.set(E,z))}}const d=new Lo(l);return new JK(f,d,s.fieldTransforms)}(o,"updateDoc",r._key,e,t,n):function nX(r,e,t,n){const i=r.ya(1,e,t);aw("Data must be an object, but it was:",i,n);const o=[],s=ii.empty();Y4(n,(c,l)=>{const f=P_(e,c,t);l=mr(l);const d=i.da(f);if(l instanceof R9)o.push(f);else{const m=J6(l,d);null!=m&&(o.push(f),s.set(f,m))}});const a=new Lo(o);return new JK(s,a,i.fieldTransforms)}(o,"updateDoc",r._key,e),H9(i,[s.toMutation(r._key,K1.exists(!0))])}function GOe(r){return H9(In(r.firestore,H1),[new g5(r._key,K1.none())])}function UOe(r,e){const t=In(r.firestore,H1),n=ZK(r),i=dw(r.converter,e);return H9(t,[ow(k5(r.firestore),"addDoc",n._key,i,null!==r.converter,{}).toMutation(n._key,K1.exists(!1))]).then(()=>n)}function WOe(r,...e){var t,n,i;r=mr(r);let o={includeMetadataChanges:!1},s=0;"object"!=typeof e[s]||rw(e[s])||(o=e[s],s++);const a={includeMetadataChanges:o.includeMetadataChanges};if(rw(e[s])){const d=e[s];e[s]=null===(t=d.next)||void 0===t?void 0:t.bind(d),e[s+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),e[s+2]=null===(i=d.complete)||void 0===i?void 0:i.bind(d)}let c,l,f;if(r instanceof Vr)l=In(r.firestore,H1),f=f5(r._key.path),c={next:d=>{e[s]&&e[s](hw(l,r,d))},error:e[s+1],complete:e[s+2]};else{const d=In(r,oi);l=In(d.firestore,H1),f=d._query;const m=new al(l);c={next:E=>{e[s]&&e[s](new R5(l,m,d,E))},error:e[s+1],complete:e[s+2]},cX(r._query)}return function(d,m,E,w){const L=new __(w),z=new Eb(m,L,E);return d.asyncQueue.enqueueAndForget(M(function*(){return _b(yield A5(d),z)})),()=>{L.Dc(),d.asyncQueue.enqueueAndForget(M(function*(){return Cb(yield A5(d),z)}))}}(Xr(l),f,a,c)}function H9(r,e){return function(t,n){const i=new c2;return t.asyncQueue.enqueueAndForget(M(function*(){return function GTe(r,e,t){return bb.apply(this,arguments)}(yield function ew(r){return C_(r).then(e=>e.syncEngine)}(t),n,i)})),i.promise}(Xr(r),e)}function hw(r,e,t){const n=t.docs.get(e._key),i=new al(r);return new L5(r,i,e._key,n,new e0(t.hasPendingWrites,t.fromCache),e.converter)}function Ic(){return new sw("serverTimestamp")}function mX(r,e){if(null!=r&&null!=e&&"object"==typeof r){if(null!=r.equals)return r.equals(e);{const t=r,n=e;for(const i of Object.keys(t)){if(!(i in n))return!1;if(!1===mX(t[i],n[i]))return!1}return!0}}return r===e}function pw(r){return null==r||function rbe(r){return"object"==typeof r&&null!=r&&null!=r.equals}(r)||function BLe(r){return"string"==typeof r||"number"==typeof r||"boolean"==typeof r||null===r}(r)||function ibe(r){if("object"==typeof r){for(const e in r)if(null!=r[e]&&!1===pw(r[e]))return!1;return null!=r&&r.constructor.prototype===Object.prototype}return!1}(r)}function zs(r,e){if(pw(r)&&pw(e))return mX(r,e);throw new Error(`Comparing non comparable objects: ${r.constructor.name} and ${e.constructor.name}`)}!function(r,e=!0){o5=k6,so(new Ni("firestore",(t,{instanceIdentifier:n,options:i})=>{const o=t.getProvider("app").getImmediate(),s=new H1(new vSe(t.getProvider("auth-internal")),new MSe(t.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new Te(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new V6(a.options.projectId,c)}(o,n),o);return i=Object.assign({useFetchStreams:e},i),s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),_r(tZ,"3.13.0",r),_r(tZ,"3.13.0","esm2017")}();class we{static fromFunctions(e,t){return new class extends we{encode(n){return e(n)}decode(n){return t(n)}}}static identity(){function e(t){return t}return we.fromFunctions(e,e)}static constant(e,t){return new class extends we{encode(n){return e}decode(n){return t}}}static tuple(e,t,n){return new class extends we{encode(i){const o=t(i),s={};return Object.keys(o).forEach(a=>{s[a]=e[a].encode(o[a])}),s}decode(i){const o={};return Object.keys(e).reverse().forEach(s=>{o[s]=e[s].decode(i[s])}),n(Object.values(o))}}}static disjunction(e,t){return q.assert(e.length===t.length,"typePredicates and encoders should have same length"),new class extends we{encode(n){let i=0;for(const o of e){if(!0===o(n))return{type:i,encoded:t[i].encode(n)};i++}}decode(n){const i=q.getNonNullable(n).type,o=q.getNonNullable(n).encoded;return t[i].decode(o)}}}static list(e){return new class extends we{encode(t){return t.map(n=>{const i=e.encode(n);return q.assert(!1===Array.isArray(i),"This encoder should not encode as array"),i})}decode(t){return t.map(e.decode)}}}}class g{static of(e){return new g(e)}static ofNullable(e){return null==e?g.empty():g.of(e)}static empty(){return new g(null)}static getEncoder(e){return new class extends we{encode(t){return t.isPresent()?e.encode(t.get()):null}decode(t){return null===t?g.empty():g.of(e.decode(t))}}}constructor(e){u(this,"value",void 0),this.value=e}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(e){return this.isPresent()?this.value:e}equals(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&zs(this.value,e.value)}equalsValue(e){return this.equals(g.of(e))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(e){return this.isPresent()?g.of(e(this.get())):g.empty()}}class ie{static success(e){return new obe(e)}static failure(e){return new sbe(e)}constructor(){}equals(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&zs(this.get(),e.get())}}class obe extends ie{constructor(e){super(),u(this,"value",void 0),u(this,"__nominal",void 0),this.value=e}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(e){return e}toOptional(){return g.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class sbe extends ie{constructor(e){super(),u(this,"reason",void 0),u(this,"__nominal",void 0),this.reason=e}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(e){return this.getReason()}toOptional(){return g.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return ie.failure(this.reason)}}var b;!function(r){r.SUCCESS=ie.success(void 0),r.ofFallible=function e(n){return n.isSuccess()?r.SUCCESS:r.failure(n.getReason())},r.failure=function t(n){return ie.failure(n)}}(b||(b={})),_r("firebase","9.23.0","app");const lbe=(r,e)=>e.some(t=>r instanceof t);let _X,vX;const CX=new WeakMap,gw=new WeakMap,yX=new WeakMap,mw=new WeakMap,_w=new WeakMap;let vw={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return gw.get(r);if("objectStoreNames"===e)return r.objectStoreNames||yX.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return cl(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function mbe(r){return"function"==typeof r?function gbe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function fbe(){return vX||(vX=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(Cw(this),e),cl(CX.get(this))}:function(...e){return cl(r.apply(Cw(this),e))}:function(e,...t){const n=r.call(Cw(this),e,...t);return yX.set(n,e.sort?e.sort():[e]),cl(n)}}(r):(r instanceof IDBTransaction&&function hbe(r){if(gw.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",s),r.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",s),r.addEventListener("abort",s)});gw.set(r,e)}(r),lbe(r,function ube(){return _X||(_X=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,vw):r)}function cl(r){if(r instanceof IDBRequest)return function dbe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",s)},o=()=>{t(cl(r.result)),i()},s=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&CX.set(t,r)}).catch(()=>{}),_w.set(e,r),e}(r);if(mw.has(r))return mw.get(r);const e=mbe(r);return e!==r&&(mw.set(r,e),_w.set(e,r)),e}const Cw=r=>_w.get(r),vbe=["get","getKey","getAll","getAllKeys","count"],Cbe=["put","add","delete","clear"],yw=new Map;function MX(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(yw.get(e))return yw.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=Cbe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!vbe.includes(t))return;const o=function(){var s=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return s.apply(this,arguments)}}();return yw.set(e,o),o}!function pbe(r){vw=r(vw)}(r=>({...r,get:(e,t,n)=>MX(e,t)||r.get(e,t,n),has:(e,t)=>!!MX(e,t)||r.has(e,t)}));const EX="@firebase/installations",Mw="0.6.4",SX=1e4,PX=`w:${Mw}`,TX="FIS_v2",ybe="https://firebaseinstallations.googleapis.com/v1",Mbe=36e5,V3=new Ec("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function OX(r){return r instanceof Ls&&r.code.includes("request-failed")}function Ew({projectId:r}){return`${ybe}/projects/${r}/installations`}function bX(r){return{token:r.token,requestStatus:2,expiresIn:Tbe(r.expiresIn),creationTime:Date.now()}}function Sw(r,e){return Pw.apply(this,arguments)}function Pw(){return Pw=M(function*(r,e){const n=(yield e.json()).error;return V3.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}),Pw.apply(this,arguments)}function wX({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function Tw(r){return Ow.apply(this,arguments)}function Ow(){return Ow=M(function*(r){const e=yield r();return e.status>=500&&e.status<600?r():e}),Ow.apply(this,arguments)}function Tbe(r){return Number(r.replace("s","000"))}function bw(){return bw=M(function*({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const n=Ew(r),i=wX(r),o=e.getImmediate({optional:!0});if(o){const l=yield o.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({fid:t,authVersion:TX,appId:r.appId,sdkVersion:PX})},c=yield Tw(()=>fetch(n,a));if(c.ok){const l=yield c.json();return{fid:l.fid||t,registrationStatus:2,refreshToken:l.refreshToken,authToken:bX(l.authToken)}}throw yield Sw("Create Installation",c)}),bw.apply(this,arguments)}function AX(r){return new Promise(e=>{setTimeout(e,r)})}const Nbe=/^[cdef][\w-]{21}$/,ww="";function Abe(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=function Ibe(r){return function wbe(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}(r).substr(0,22)}(r);return Nbe.test(t)?t:ww}catch{return ww}}function z5(r){return`${r.appName}!${r.appId}`}const D5=new Map;function IX(r,e){const t=z5(r);kX(t,e),function Lbe(r,e){const t=function xX(){return!t0&&"BroadcastChannel"in self&&(t0=new BroadcastChannel("[Firebase] FID Change"),t0.onmessage=r=>{kX(r.data.key,r.data.fid)}),t0}();t&&t.postMessage({key:r,fid:e}),function LX(){0===D5.size&&t0&&(t0.close(),t0=null)}()}(t,e)}function kX(r,e){const t=D5.get(r);if(t)for(const n of t)n(e)}let t0=null;const Rbe="firebase-installations-database",zbe=1,n0="firebase-installations-store";let Nw=null;function Aw(){return Nw||(Nw=function _be(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(r,e),a=cl(s);return n&&s.addEventListener("upgradeneeded",c=>{n(cl(s.result),c.oldVersion,c.newVersion,cl(s.transaction))}),t&&s.addEventListener("blocked",()=>t()),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}(Rbe,zbe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(n0)}})),Nw}function k_(r,e){return Iw.apply(this,arguments)}function Iw(){return Iw=M(function*(r,e){const t=z5(r),i=(yield Aw()).transaction(n0,"readwrite"),o=i.objectStore(n0),s=yield o.get(t);return yield o.put(e,t),yield i.done,(!s||s.fid!==e.fid)&&IX(r,e.fid),e}),Iw.apply(this,arguments)}function kw(r){return xw.apply(this,arguments)}function xw(){return xw=M(function*(r){const e=z5(r),n=(yield Aw()).transaction(n0,"readwrite");yield n.objectStore(n0).delete(e),yield n.done}),xw.apply(this,arguments)}function V9(r,e){return Lw.apply(this,arguments)}function Lw(){return Lw=M(function*(r,e){const t=z5(r),i=(yield Aw()).transaction(n0,"readwrite"),o=i.objectStore(n0),s=yield o.get(t),a=e(s);return void 0===a?yield o.delete(t):yield o.put(a,t),yield i.done,a&&(!s||s.fid!==a.fid)&&IX(r,a.fid),a}),Lw.apply(this,arguments)}function Rw(r){return zw.apply(this,arguments)}function zw(){return zw=M(function*(r){let e;const t=yield V9(r.appConfig,n=>{const i=function Dbe(r){return zX(r||{fid:Abe(),registrationStatus:0})}(n),o=function Hbe(r,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(V3.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=function Vbe(r,e){return Dw.apply(this,arguments)}(r,t);return{installationEntry:t,registrationPromise:n}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Fbe(r)}:{installationEntry:e}}(r,i);return e=o.registrationPromise,o.installationEntry});return t.fid===ww?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}}),zw.apply(this,arguments)}function Dw(){return Dw=M(function*(r,e){try{const t=yield function bbe(r,e){return bw.apply(this,arguments)}(r,e);return k_(r.appConfig,t)}catch(t){throw OX(t)&&409===t.customData.serverCode?yield kw(r.appConfig):yield k_(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}),Dw.apply(this,arguments)}function Fbe(r){return Hw.apply(this,arguments)}function Hw(){return Hw=M(function*(r){let e=yield RX(r.appConfig);for(;1===e.registrationStatus;)yield AX(100),e=yield RX(r.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:n}=yield Rw(r);return n||t}return e}),Hw.apply(this,arguments)}function RX(r){return V9(r,e=>{if(!e)throw V3.create("installation-not-found");return zX(e)})}function zX(r){return function $be(r){return 1===r.registrationStatus&&r.registrationTime+SX<Date.now()}(r)?{fid:r.fid,registrationStatus:0}:r}function Vw(){return Vw=M(function*({appConfig:r,heartbeatServiceProvider:e},t){const n=function Gbe(r,{fid:e}){return`${Ew(r)}/${e}/authTokens:generate`}(r,t),i=function NX(r,{refreshToken:e}){const t=wX(r);return t.append("Authorization",function Obe(r){return`${TX} ${r}`}(e)),t}(r,t),o=e.getImmediate({optional:!0});if(o){const l=yield o.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:PX,appId:r.appId}})},c=yield Tw(()=>fetch(n,a));if(c.ok)return bX(yield c.json());throw yield Sw("Generate Auth Token",c)}),Vw.apply(this,arguments)}function Fw(r){return $w.apply(this,arguments)}function $w(){return $w=M(function*(r,e=!1){let t;const n=yield V9(r.appConfig,o=>{if(!HX(o))throw V3.create("not-registered");const s=o.authToken;if(!e&&function qbe(r){return 2===r.requestStatus&&!function jbe(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+Mbe}(r)}(s))return o;if(1===s.requestStatus)return t=function Ube(r,e){return Bw.apply(this,arguments)}(r,e),o;{if(!navigator.onLine)throw V3.create("app-offline");const a=function Zbe(r){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},r),{authToken:e})}(o);return t=function Wbe(r,e){return Gw.apply(this,arguments)}(r,a),a}});return t?yield t:n.authToken}),$w.apply(this,arguments)}function Bw(){return Bw=M(function*(r,e){let t=yield DX(r.appConfig);for(;1===t.authToken.requestStatus;)yield AX(100),t=yield DX(r.appConfig);const n=t.authToken;return 0===n.requestStatus?Fw(r,e):n}),Bw.apply(this,arguments)}function DX(r){return V9(r,e=>{if(!HX(e))throw V3.create("not-registered");return function Ybe(r){return 1===r.requestStatus&&r.requestTime+SX<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function Gw(){return Gw=M(function*(r,e){try{const t=yield function Bbe(r,e){return Vw.apply(this,arguments)}(r,e),n=Object.assign(Object.assign({},e),{authToken:t});return yield k_(r.appConfig,n),t}catch(t){if(!OX(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield k_(r.appConfig,n)}else yield kw(r.appConfig);throw t}}),Gw.apply(this,arguments)}function HX(r){return void 0!==r&&2===r.registrationStatus}function Uw(){return Uw=M(function*(r){const e=r,{installationEntry:t,registrationPromise:n}=yield Rw(e);return n?n.catch(console.error):Fw(e).catch(console.error),t.fid}),Uw.apply(this,arguments)}function Ww(){return Ww=M(function*(r,e=!1){const t=r;return yield function Qbe(r){return qw.apply(this,arguments)}(t),(yield Fw(t,e)).token}),Ww.apply(this,arguments)}function qw(){return qw=M(function*(r){const{registrationPromise:e}=yield Rw(r);e&&(yield e)}),qw.apply(this,arguments)}function Yw(r){return V3.create("missing-app-config-values",{valueName:r})}const VX="installations",rwe=r=>{const e=r.getProvider("app").getImmediate(),t=function twe(r){if(!r||!r.options)throw Yw("App Configuration");if(!r.name)throw Yw("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw Yw(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:X8(e,"heartbeat"),_delete:()=>Promise.resolve()}},iwe=r=>{const t=X8(r.getProvider("app").getImmediate(),VX).getImmediate();return{getId:()=>function Kbe(r){return Uw.apply(this,arguments)}(t),getToken:i=>function Xbe(r){return Ww.apply(this,arguments)}(t,i)}};(function owe(){so(new Ni(VX,rwe,"PUBLIC")),so(new Ni("installations-internal",iwe,"PRIVATE"))})(),_r(EX,Mw),_r(EX,Mw,"esm2017");const Kw="@firebase/remote-config",zo=new Ec("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class mwe{constructor(e,t,n,i){this.client=e,this.storage=t,this.storageCache=n,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,i=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){var t=this;return M(function*(){const[n,i]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(i&&t.isCachedDataFresh(e.cacheMaxAgeMillis,n))return i;e.eTag=i&&i.eTag;const o=yield t.client.fetch(e),s=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===o.status&&s.push(t.storage.setLastSuccessfulFetchResponse(o)),yield Promise.all(s),o})()}}function _we(r=navigator){return r.languages&&r.languages[0]||r.language}class vwe{constructor(e,t,n,i,o,s){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=i,this.apiKey=o,this.appId=s}fetch(e){var t=this;return M(function*(){const[n,i]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),s=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},c={sdk_version:t.sdkVersion,app_instance_id:n,app_instance_id_token:i,app_id:t.appId,language_code:_we()},l={method:"POST",headers:a,body:JSON.stringify(c)},f=fetch(s,l),d=new Promise(($,B)=>{e.signal.addEventListener(()=>{const de=new Error("The operation was aborted.");de.name="AbortError",B(de)})});let m;try{yield Promise.race([f,d]),m=yield f}catch($){let B="fetch-client-network";throw"AbortError"===$?.name&&(B="fetch-timeout"),zo.create(B,{originalErrorMessage:$?.message})}let E=m.status;const w=m.headers.get("ETag")||void 0;let L,z;if(200===m.status){let $;try{$=yield m.json()}catch(B){throw zo.create("fetch-client-parse",{originalErrorMessage:B?.message})}L=$.entries,z=$.state}if("INSTANCE_STATE_UNSPECIFIED"===z?E=500:"NO_CHANGE"===z?E=304:("NO_TEMPLATE"===z||"EMPTY_CONFIG"===z)&&(L={}),304!==E&&200!==E)throw zo.create("fetch-status",{httpStatus:E});return{status:E,eTag:w,config:L}})()}}class Mwe{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return M(function*(){const n=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,n)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){var i=this;return M(function*(){yield function Cwe(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),o=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(o),n(zo.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(e.signal,t);try{const o=yield i.client.fetch(e);return yield i.storage.deleteThrottleMetadata(),o}catch(o){if(!function ywe(r){if(!(r instanceof Ls&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(o))throw o;const s={throttleEndTimeMillis:Date.now()+QP(n),backoffCount:n+1};return yield i.storage.setThrottleMetadata(s),i.attemptFetch(e,s)}})()}}class Pwe{constructor(e,t,n,i,o){this.app=e,this._client=t,this._storageCache=n,this._storage=i,this._logger=o,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function L_(r,e){const t=r.target.error||void 0;return zo.create(e,{originalErrorMessage:t&&t?.message})}const r0="app_namespace_store";class wwe{constructor(e,t,n,i=function bwe(){return new Promise((r,e)=>{try{const t=indexedDB.open("firebase_remote_config",1);t.onerror=n=>{e(L_(n,"storage-open"))},t.onsuccess=n=>{r(n.target.result)},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(r0,{keyPath:"compositeKey"})}}catch(t){e(zo.create("storage-open",{originalErrorMessage:t?.message}))}})}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return M(function*(){const n=yield t.openDbPromise;return new Promise((i,o)=>{const a=n.transaction([r0],"readonly").objectStore(r0),c=t.createCompositeKey(e);try{const l=a.get(c);l.onerror=f=>{o(L_(f,"storage-get"))},l.onsuccess=f=>{const d=f.target.result;i(d?d.value:void 0)}}catch(l){o(zo.create("storage-get",{originalErrorMessage:l?.message}))}})})()}set(e,t){var n=this;return M(function*(){const i=yield n.openDbPromise;return new Promise((o,s)=>{const c=i.transaction([r0],"readwrite").objectStore(r0),l=n.createCompositeKey(e);try{const f=c.put({compositeKey:l,value:t});f.onerror=d=>{s(L_(d,"storage-set"))},f.onsuccess=()=>{o()}}catch(f){s(zo.create("storage-set",{originalErrorMessage:f?.message}))}})})()}delete(e){var t=this;return M(function*(){const n=yield t.openDbPromise;return new Promise((i,o)=>{const a=n.transaction([r0],"readwrite").objectStore(r0),c=t.createCompositeKey(e);try{const l=a.delete(c);l.onerror=f=>{o(L_(f,"storage-delete"))},l.onsuccess=()=>{i()}}catch(l){o(zo.create("storage-delete",{originalErrorMessage:l?.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class Nwe{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return M(function*(){const t=e.storage.getLastFetchStatus(),n=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),o=yield t;o&&(e.lastFetchStatus=o);const s=yield n;s&&(e.lastSuccessfulFetchTimestampMillis=s);const a=yield i;a&&(e.activeConfig=a)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function Iwe(){return tN.apply(this,arguments)}function tN(){return(tN=M(function*(){if(!w6())return!1;try{return yield bf()}catch{return!1}})).apply(this,arguments)}!function Awe(){so(new Ni("remote-config",function r(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw zo.create("registration-window");if(!w6())throw zo.create("indexed-db-unavailable");const{projectId:o,apiKey:s,appId:a}=n.options;if(!o)throw zo.create("registration-project-id");if(!s)throw zo.create("registration-api-key");if(!a)throw zo.create("registration-app-id");const c=new wwe(a,n.name,t=t||"firebase"),l=new Nwe(c),f=new K8(Kw);f.logLevel=Un.ERROR;const d=new vwe(i,k6,t,o,s,a),m=new Mwe(d,c),E=new mwe(m,c,l,f),w=new Pwe(n,E,l,c,f);return function hwe(r){const e=mr(r);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(w),w},"PUBLIC").setMultipleInstances(!0)),_r(Kw,"0.4.4"),_r(Kw,"0.4.4","esm2017")}();const kwe=(r,e)=>e.some(t=>r instanceof t);let GX,UX;const WX=new WeakMap,nN=new WeakMap,qX=new WeakMap,rN=new WeakMap,iN=new WeakMap;let oN={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return nN.get(r);if("objectStoreNames"===e)return r.objectStoreNames||qX.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return F3(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function Vwe(r){return"function"==typeof r?function Hwe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Lwe(){return UX||(UX=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(sN(this),e),F3(WX.get(this))}:function(...e){return F3(r.apply(sN(this),e))}:function(e,...t){const n=r.call(sN(this),e,...t);return qX.set(n,e.sort?e.sort():[e]),F3(n)}}(r):(r instanceof IDBTransaction&&function zwe(r){if(nN.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",s),r.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",s),r.addEventListener("abort",s)});nN.set(r,e)}(r),kwe(r,function xwe(){return GX||(GX=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,oN):r)}function F3(r){if(r instanceof IDBRequest)return function Rwe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",s)},o=()=>{t(F3(r.result)),i()},s=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&WX.set(t,r)}).catch(()=>{}),iN.set(e,r),e}(r);if(rN.has(r))return rN.get(r);const e=Vwe(r);return e!==r&&(rN.set(r,e),iN.set(e,r)),e}const sN=r=>iN.get(r);function jX(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(r,e),a=F3(s);return n&&s.addEventListener("upgradeneeded",c=>{n(F3(s.result),c.oldVersion,c.newVersion,F3(s.transaction))}),t&&s.addEventListener("blocked",()=>t()),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}function aN(r,{blocked:e}={}){const t=indexedDB.deleteDatabase(r);return e&&t.addEventListener("blocked",()=>e()),F3(t).then(()=>{})}const Fwe=["get","getKey","getAll","getAllKeys","count"],$we=["put","add","delete","clear"],cN=new Map;function ZX(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(cN.get(e))return cN.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=$we.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!Fwe.includes(t))return;const o=function(){var s=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return s.apply(this,arguments)}}();return cN.set(e,o),o}!function Dwe(r){oN=r(oN)}(r=>({...r,get:(e,t,n)=>ZX(e,t)||r.get(e,t,n),has:(e,t)=>!!ZX(e,t)||r.has(e,t)}));const Bwe="/firebase-messaging-sw.js",Gwe="/firebase-cloud-messaging-push-scope",YX="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Uwe="https://fcmregistrations.googleapis.com/v1",KX="google.c.a.c_id",Wwe="google.c.a.c_l",qwe="google.c.a.ts";var R_=function(r){return r.PUSH_RECEIVED="push-received",r.NOTIFICATION_CLICKED="notification-clicked",r}(R_||{});function $3(r){const e=new Uint8Array(r);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ywe(r){const t=(r+"=".repeat((4-r.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),i=new Uint8Array(n.length);for(let o=0;o<n.length;++o)i[o]=n.charCodeAt(o);return i}const lN="fcm_token_details_db",Kwe=5,XX="fcm_token_object_Store";function uN(){return uN=M(function*(r){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(o=>o.name).includes(lN))return null;let e=null;return(yield jX(lN,Kwe,{upgrade:(n=M(function*(i,o,s,a){var c;if(o<2||!i.objectStoreNames.contains(XX))return;const l=a.objectStore(XX),f=yield l.index("fcmSenderId").get(r);if(yield l.clear(),f)if(2===o){const d=f;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:null!==(c=d.createTime)&&void 0!==c?c:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:"string"==typeof d.vapidKey?d.vapidKey:$3(d.vapidKey)}}}else if(3===o){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:$3(d.auth),p256dh:$3(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:$3(d.vapidKey)}}}else if(4===o){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:$3(d.auth),p256dh:$3(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:$3(d.vapidKey)}}}}),function(o,s,a,c){return n.apply(this,arguments)})})).close(),yield aN(lN),yield aN("fcm_vapid_details_db"),yield aN("undefined"),function Qwe(r){if(!r||!r.subscriptionOptions)return!1;const{subscriptionOptions:e}=r;return"number"==typeof r.createTime&&r.createTime>0&&"string"==typeof r.token&&r.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}(e)?e:null;var n}),uN.apply(this,arguments)}const Jwe="firebase-messaging-database",eNe=1,o0="firebase-messaging-store";let fN=null;function dN(){return fN||(fN=jX(Jwe,eNe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(o0)}})),fN}function QX(r){return hN.apply(this,arguments)}function hN(){return hN=M(function*(r){const e=_N(r),n=yield(yield dN()).transaction(o0).objectStore(o0).get(e);if(n)return n;{const i=yield function Xwe(r){return uN.apply(this,arguments)}(r.appConfig.senderId);if(i)return yield pN(r,i),i}}),hN.apply(this,arguments)}function pN(r,e){return gN.apply(this,arguments)}function gN(){return gN=M(function*(r,e){const t=_N(r),i=(yield dN()).transaction(o0,"readwrite");return yield i.objectStore(o0).put(e,t),yield i.done,e}),gN.apply(this,arguments)}function mN(){return mN=M(function*(r){const e=_N(r),n=(yield dN()).transaction(o0,"readwrite");yield n.objectStore(o0).delete(e),yield n.done}),mN.apply(this,arguments)}function _N({appConfig:r}){return r.appId}const si=new Ec("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function rNe(r,e){return vN.apply(this,arguments)}function vN(){return vN=M(function*(r,e){const t=yield EN(r),n=eQ(e),i={method:"POST",headers:t,body:JSON.stringify(n)};let o;try{o=yield(yield fetch(MN(r.appConfig),i)).json()}catch(s){throw si.create("token-subscribe-failed",{errorInfo:s?.toString()})}if(o.error)throw si.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw si.create("token-subscribe-no-token");return o.token}),vN.apply(this,arguments)}function CN(){return CN=M(function*(r,e){const t=yield EN(r),n=eQ(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(n)};let o;try{o=yield(yield fetch(`${MN(r.appConfig)}/${e.token}`,i)).json()}catch(s){throw si.create("token-update-failed",{errorInfo:s?.toString()})}if(o.error)throw si.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw si.create("token-update-no-token");return o.token}),CN.apply(this,arguments)}function JX(r,e){return yN.apply(this,arguments)}function yN(){return yN=M(function*(r,e){const n={method:"DELETE",headers:yield EN(r)};try{const o=yield(yield fetch(`${MN(r.appConfig)}/${e}`,n)).json();if(o.error)throw si.create("token-unsubscribe-failed",{errorInfo:o.error.message})}catch(i){throw si.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}}),yN.apply(this,arguments)}function MN({projectId:r}){return`${Uwe}/projects/${r}/registrations`}function EN(r){return SN.apply(this,arguments)}function SN(){return SN=M(function*({appConfig:r,installations:e}){const t=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}),SN.apply(this,arguments)}function eQ({p256dh:r,auth:e,endpoint:t,vapidKey:n}){const i={web:{endpoint:t,auth:e,p256dh:r}};return n!==YX&&(i.web.applicationPubKey=n),i}const oNe=6048e5;function PN(){return PN=M(function*(r){const e=yield function cNe(r,e){return wN.apply(this,arguments)}(r.swRegistration,r.vapidKey),t={vapidKey:r.vapidKey,swScope:r.swRegistration.scope,endpoint:e.endpoint,auth:$3(e.getKey("auth")),p256dh:$3(e.getKey("p256dh"))},n=yield QX(r.firebaseDependencies);if(n){if(function lNe(r,e){return e.vapidKey===r.vapidKey&&e.endpoint===r.endpoint&&e.auth===r.auth&&e.p256dh===r.p256dh}(n.subscriptionOptions,t))return Date.now()>=n.createTime+oNe?function aNe(r,e){return ON.apply(this,arguments)}(r,{token:n.token,createTime:Date.now(),subscriptionOptions:t}):n.token;try{yield JX(r.firebaseDependencies,n.token)}catch(i){console.warn(i)}return nQ(r.firebaseDependencies,t)}return nQ(r.firebaseDependencies,t)}),PN.apply(this,arguments)}function TN(){return TN=M(function*(r){const e=yield QX(r.firebaseDependencies);e&&(yield JX(r.firebaseDependencies,e.token),yield function tNe(r){return mN.apply(this,arguments)}(r.firebaseDependencies));const t=yield r.swRegistration.pushManager.getSubscription();return!t||t.unsubscribe()}),TN.apply(this,arguments)}function ON(){return ON=M(function*(r,e){try{const t=yield function iNe(r,e){return CN.apply(this,arguments)}(r.firebaseDependencies,e),n=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield pN(r.firebaseDependencies,n),t}catch(t){throw yield function tQ(r){return TN.apply(this,arguments)}(r),t}}),ON.apply(this,arguments)}function nQ(r,e){return bN.apply(this,arguments)}function bN(){return bN=M(function*(r,e){const n={token:yield rNe(r,e),createTime:Date.now(),subscriptionOptions:e};return yield pN(r,n),n.token}),bN.apply(this,arguments)}function wN(){return wN=M(function*(r,e){return(yield r.pushManager.getSubscription())||r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Ywe(e)})}),wN.apply(this,arguments)}function rQ(r){const e={from:r.from,collapseKey:r.collapse_key,messageId:r.fcmMessageId};return function uNe(r,e){if(!e.notification)return;r.notification={};const t=e.notification.title;t&&(r.notification.title=t);const n=e.notification.body;n&&(r.notification.body=n);const i=e.notification.image;i&&(r.notification.image=i);const o=e.notification.icon;o&&(r.notification.icon=o)}(e,r),function fNe(r,e){e.data&&(r.data=e.data)}(e,r),function dNe(r,e){var t,n,i,o,s;if(!(e.fcmOptions||null!==(t=e.notification)&&void 0!==t&&t.click_action))return;r.fcmOptions={};const a=null!==(i=null===(n=e.fcmOptions)||void 0===n?void 0:n.link)&&void 0!==i?i:null===(o=e.notification)||void 0===o?void 0:o.click_action;a&&(r.fcmOptions.link=a);const c=null===(s=e.fcmOptions)||void 0===s?void 0:s.analytics_label;c&&(r.fcmOptions.analyticsLabel=c)}(e,r),e}function iQ(r,e){const t=[];for(let n=0;n<r.length;n++)t.push(r.charAt(n)),n<e.length&&t.push(e.charAt(n));return t.join("")}function NN(r){return si.create("missing-app-config-values",{valueName:r})}iQ("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),iQ("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class gNe{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=function pNe(r){if(!r||!r.options)throw NN("App Configuration Object");if(!r.name)throw NN("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=r;for(const n of e)if(!t[n])throw NN(n);return{appName:r.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}function AN(){return AN=M(function*(r){try{r.swRegistration=yield navigator.serviceWorker.register(Bwe,{scope:Gwe}),r.swRegistration.update().catch(()=>{})}catch(e){throw si.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}),AN.apply(this,arguments)}function IN(){return IN=M(function*(r,e){if(!e&&!r.swRegistration&&(yield function oQ(r){return AN.apply(this,arguments)}(r)),e||!r.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw si.create("invalid-sw-registration");r.swRegistration=e}}),IN.apply(this,arguments)}function kN(){return kN=M(function*(r,e){e?r.vapidKey=e:r.vapidKey||(r.vapidKey=YX)}),kN.apply(this,arguments)}function xN(){return xN=M(function*(r,e){if(!navigator)throw si.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw si.create("permission-blocked");return yield function _Ne(r,e){return kN.apply(this,arguments)}(r,e?.vapidKey),yield function mNe(r,e){return IN.apply(this,arguments)}(r,e?.serviceWorkerRegistration),function sNe(r){return PN.apply(this,arguments)}(r)}),xN.apply(this,arguments)}function LN(){return LN=M(function*(r,e,t){const n=function CNe(r){switch(r){case R_.NOTIFICATION_CLICKED:return"notification_open";case R_.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(e);(yield r.firebaseDependencies.analyticsProvider.get()).logEvent(n,{message_id:t[KX],message_name:t[Wwe],message_time:t[qwe],message_device_time:Math.floor(Date.now()/1e3)})}),LN.apply(this,arguments)}function RN(){return RN=M(function*(r,e){const t=e.data;if(!t.isFirebaseMessaging)return;r.onMessageHandler&&t.messageType===R_.PUSH_RECEIVED&&("function"==typeof r.onMessageHandler?r.onMessageHandler(rQ(t)):r.onMessageHandler.next(rQ(t)));const n=t.data;(function hNe(r){return"object"==typeof r&&!!r&&KX in r})(n)&&"1"===n["google.c.a.e"]&&(yield function vNe(r,e,t){return LN.apply(this,arguments)}(r,t.messageType,n))}),RN.apply(this,arguments)}const aQ="@firebase/messaging",MNe=r=>{const e=new gNe(r.getProvider("app").getImmediate(),r.getProvider("installations-internal").getImmediate(),r.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function yNe(r,e){return RN.apply(this,arguments)}(e,t)),e},ENe=r=>{const e=r.getProvider("messaging").getImmediate();return{getToken:n=>function sQ(r,e){return xN.apply(this,arguments)}(e,n)}};function lQ(){return zN.apply(this,arguments)}function zN(){return(zN=M(function*(){try{yield bf()}catch{return!1}return typeof window<"u"&&w6()&&YP()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function SNe(){so(new Ni("messaging",MNe,"PUBLIC")),so(new Ni("messaging-internal",ENe,"PRIVATE")),_r(aQ,"0.12.4"),_r(aQ,"0.12.4","esm2017")}();const z_="analytics",ONe="firebase_id",bNe="origin",wNe=6e4,NNe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",VN="https://www.googletagmanager.com/gtag/js",k2=new K8("@firebase/analytics"),lo=new Ec("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function INe(r){if(!r.startsWith(VN)){const e=lo.create("invalid-gtag-resource",{gtagURL:r});return k2.warn(e.message),""}return r}function uQ(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function FN(){return FN=M(function*(r,e,t,n,i,o){const s=n[i];try{if(s)yield e[s];else{const c=(yield uQ(t)).find(l=>l.measurementId===i);c&&(yield e[c.appId])}}catch(a){k2.error(a)}r("config",i,o)}),FN.apply(this,arguments)}function $N(){return $N=M(function*(r,e,t,n,i){try{let o=[];if(i&&i.send_to){let s=i.send_to;Array.isArray(s)||(s=[s]);const a=yield uQ(t);for(const c of s){const l=a.find(d=>d.measurementId===c),f=l&&e[l.appId];if(!f){o=[];break}o.push(f)}}0===o.length&&(o=Object.values(e)),yield Promise.all(o),r("event",n,i||{})}catch(o){k2.error(o)}}),$N.apply(this,arguments)}const FNe=30,fQ=new class BNe{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function GNe(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}function BN(){return BN=M(function*(r){var e;const{appId:t,apiKey:n}=r,i={method:"GET",headers:GNe(n)},o=NNe.replace("{app-id}",t),s=yield fetch(o,i);if(200!==s.status&&304!==s.status){let a="";try{const c=yield s.json();null!==(e=c.error)&&void 0!==e&&e.message&&(a=c.error.message)}catch{}throw lo.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()}),BN.apply(this,arguments)}function GN(){return GN=M(function*(r,e=fQ,t){const{appId:n,apiKey:i,measurementId:o}=r.options;if(!n)throw lo.create("no-app-id");if(!i){if(o)return{measurementId:o,appId:n};throw lo.create("no-api-key")}const s=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new ZNe;return setTimeout(M(function*(){a.abort()}),void 0!==t?t:wNe),dQ({appId:n,apiKey:i,measurementId:o},s,a,e)}),GN.apply(this,arguments)}function dQ(r,e,t){return UN.apply(this,arguments)}function UN(){return UN=M(function*(r,{throttleEndTimeMillis:e,backoffCount:t},n,i=fQ){var o;const{appId:s,measurementId:a}=r;try{yield function qNe(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),o=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(o),n(lo.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(n,e)}catch(c){if(a)return k2.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:s,measurementId:a};throw c}try{const c=yield function UNe(r){return BN.apply(this,arguments)}(r);return i.deleteThrottleMetadata(s),c}catch(c){const l=c;if(!function jNe(r){if(!(r instanceof Ls&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l)){if(i.deleteThrottleMetadata(s),a)return k2.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l?.message}]`),{appId:s,measurementId:a};throw c}const f=503===Number(null===(o=l?.customData)||void 0===o?void 0:o.httpStatus)?QP(t,i.intervalMillis,FNe):QP(t,i.intervalMillis),d={throttleEndTimeMillis:Date.now()+f,backoffCount:t+1};return i.setThrottleMetadata(s,d),k2.debug(`Calling attemptFetch again in ${f} millis`),dQ(r,d,n,i)}}),UN.apply(this,arguments)}class ZNe{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let WN,QN;function qN(){return qN=M(function*(r,e,t,n,i){if(i&&i.global)r("event",t,n);else{const o=yield e;r("event",t,Object.assign(Object.assign({},n),{send_to:o}))}}),qN.apply(this,arguments)}function JN(){return JN=M(function*(){if(!w6())return k2.warn(lo.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield bf()}catch(r){return k2.warn(lo.create("indexeddb-unavailable",{errorInfo:r?.toString()}).message),!1}return!0}),JN.apply(this,arguments)}function eA(){return eA=M(function*(r,e,t,n,i,o,s){var a;const c=function WNe(r){return GN.apply(this,arguments)}(r);c.then(E=>{t[E.measurementId]=E.appId,r.options.measurementId&&E.measurementId!==r.options.measurementId&&k2.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${E.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(E=>k2.error(E)),e.push(c);const l=function tAe(){return JN.apply(this,arguments)}().then(E=>{if(E)return n.getId()}),[f,d]=yield Promise.all([c,l]);(function VNe(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(VN)&&t.src.includes(r))return t;return null})(o)||function xNe(r,e){const t=function kNe(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}("firebase-js-sdk-policy",{createScriptURL:INe}),n=document.createElement("script"),i=`${VN}?l=${r}&id=${e}`;n.src=t?t?.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}(o,f.measurementId),QN&&(i("consent","default",QN),function hQ(r){QN=r}(void 0)),i("js",new Date);const m=null!==(a=s?.config)&&void 0!==a?a:{};return m[bNe]="firebase",m.update=!0,null!=d&&(m[ONe]=d),i("config",f.measurementId,m),WN&&(i("set",WN),function pQ(r){WN=r}(void 0)),f.measurementId}),eA.apply(this,arguments)}class rAe{constructor(e){this.app=e}_delete(){return delete kc[this.app.options.appId],Promise.resolve()}}let kc={},gQ=[];const mQ={};let vQ,xc,D_="dataLayer",tA=!1;function oAe(r,e,t){!function iAe(){const r=[];if(ZP()&&r.push("This is a browser extension environment."),YP()||r.push("Cookies are not available."),r.length>0){const e=r.map((n,i)=>`(${i+1}) ${n}`).join(" "),t=lo.create("invalid-analytics-context",{errorInfo:e});k2.warn(t.message)}}();const n=r.options.appId;if(!n)throw lo.create("no-app-id");if(!r.options.apiKey){if(!r.options.measurementId)throw lo.create("no-api-key");k2.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=kc[n])throw lo.create("already-exists",{id:n});if(!tA){!function LNe(r){let e=[];Array.isArray(window[r])?e=window[r]:window[r]=e}(D_);const{wrappedGtag:o,gtagCore:s}=function HNe(r,e,t,n,i){let o=function(...s){window[n].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function DNe(r,e,t,n){function o(){return o=M(function*(s,...a){try{if("event"===s){const[c,l]=a;yield function zNe(r,e,t,n,i){return $N.apply(this,arguments)}(r,e,t,c,l)}else if("config"===s){const[c,l]=a;yield function RNe(r,e,t,n,i,o){return FN.apply(this,arguments)}(r,e,t,n,c,l)}else if("consent"===s){const[c]=a;r("consent","update",c)}else if("get"===s){const[c,l,f]=a;r("get",c,l,f)}else if("set"===s){const[c]=a;r("set",c)}else r(s,...a)}catch(c){k2.error(c)}}),o.apply(this,arguments)}return function i(s){return o.apply(this,arguments)}}(o,r,e,t),{gtagCore:o,wrappedGtag:window[i]}}(kc,gQ,mQ,D_,"gtag");xc=o,vQ=s,tA=!0}return kc[n]=function nAe(r,e,t,n,i,o,s){return eA.apply(this,arguments)}(r,gQ,mQ,e,vQ,D_,t),new rAe(r)}function aAe(){return nA.apply(this,arguments)}function nA(){return(nA=M(function*(){if(ZP()||!YP()||!w6())return!1;try{return yield bf()}catch{return!1}})).apply(this,arguments)}const CQ="@firebase/analytics";!function lAe(){so(new Ni(z_,(e,{options:t})=>oAe(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),so(new Ni("analytics-internal",function r(e){try{const t=e.getProvider(z_).getImmediate();return{logEvent:(n,i,o)=>function cAe(r,e,t,n){r=mr(r),function YNe(r,e,t,n,i){return qN.apply(this,arguments)}(xc,kc[r.app.options.appId],e,t,n).catch(i=>k2.error(i))}(t,n,i,o)}}catch(t){throw lo.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),_r(CQ,"0.10.0"),_r(CQ,"0.10.0","esm2017")}();class uAe extends Sn{constructor(e,t){super()}schedule(e,t=0){return this}}const H_={setInterval(r,e,...t){const{delegate:n}=H_;return n?.setInterval?n.setInterval(r,e,...t):setInterval(r,e,...t)},clearInterval(r){const{delegate:e}=H_;return(e?.clearInterval||clearInterval)(r)},delegate:void 0};class MQ extends uAe{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;const i=this.id,o=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,n=0){return H_.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&H_.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,n=!1;try{this.work(e)}catch(o){n=!0,i=o||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,r3(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const iA={now:()=>(iA.delegate||Date).now(),delegate:void 0};class F9{constructor(e,t=F9.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}F9.now=iA.now;class EQ extends F9{constructor(e,t=F9.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const hAe=new class dAe extends EQ{}(class fAe extends MQ{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!=n&&n>0||null==n&&this.delay>0?super.requestAsyncId(e,t,n):(e.flush(this),0)}}),pAe=new EQ(MQ),V_=new m8("7.6.1"),oA="__angularfire_symbol__analyticsIsSupportedValue",sA="__angularfire_symbol__analyticsIsSupported",aA="__angularfire_symbol__remoteConfigIsSupportedValue",cA="__angularfire_symbol__remoteConfigIsSupported",lA="__angularfire_symbol__messagingIsSupportedValue",uA="__angularfire_symbol__messagingIsSupported";function dA(r,e,t){if(e){if(1===e.length)return e[0];const o=e.filter(s=>s.app===t);if(1===o.length)return o[0]}return t.container.getProvider(r).getImmediate({optional:!0})}globalThis[sA]||(globalThis[sA]=aAe().then(r=>globalThis[oA]=r).catch(()=>globalThis[oA]=!1)),globalThis[uA]||(globalThis[uA]=lQ().then(r=>globalThis[lA]=r).catch(()=>globalThis[lA]=!1)),globalThis[cA]||(globalThis[cA]=Iwe().then(r=>globalThis[aA]=r).catch(()=>globalThis[aA]=!1));const hA=(r,e)=>{const t=e?[e]:xq(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(s=>{n.includes(s)||n.push(s)})}),n};function H5(){}class SQ{constructor(e,t=hAe){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){const i=this.zone;return this.delegate.schedule(function(s){i.runGuarded(()=>{e.apply(this,[s])})},t,n)}}class gAe{constructor(e){this.zone=e,this.task=null}call(e,t){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",H5,{},H5,H5)),t.pipe(wi({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let pA=(()=>{class r{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new SQ(Zone.current)),this.insideAngular=t.run(()=>new SQ(Zone.current,pAe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return r.\u0275fac=function(t){return new(t||r)(Pe(o1))},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function s0(){const r=globalThis.\u0275AngularFireScheduler;if(!r)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return r}function a0(r){return s0().ngZone.run(()=>r())}function _Ae(r){return s0(),function vAe(r){return function(t){return(t=t.lift(new gAe(r.ngZone))).pipe(fh(r.outsideAngular),uh(r.insideAngular))}}(s0())(r)}const CAe=(r,e)=>function(){const n=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),a0(()=>r.apply(void 0,n))},V1=(r,e)=>function(){let t;const n=arguments;for(let o=0;o<arguments.length;o++)"function"==typeof n[o]&&(e&&(t||(t=a0(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",H5,{},H5,H5)))),n[o]=CAe(n[o],t));const i=function mAe(r){return s0().ngZone.runOutsideAngular(()=>r())}(()=>r.apply(this,n));if(!e){if(i instanceof T1){const o=s0();return i.pipe(fh(o.outsideAngular),uh(o.insideAngular))}return a0(()=>i)}return i instanceof T1?i.pipe(_Ae):i instanceof Promise?a0(()=>new Promise((o,s)=>i.then(a=>a0(()=>o(a)),a=>a0(()=>s(a))))):"function"==typeof i&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),i.apply(this,arguments)}:a0(()=>i)};class V5{constructor(e){return e}}class gA{constructor(){return xq()}}const mA=new tt("angularfire2._apps"),MAe={provide:V5,useFactory:function yAe(r){return r&&1===r.length?r[0]:new V5(aT())},deps:[[new to,mA]]},EAe={provide:gA,deps:[[new to,mA]]};function SAe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new V5(n)}}let PAe=(()=>{class r{constructor(t){_r("angularfire",V_.full,"core"),_r("angularfire",V_.full,"app"),_r("angular",_H.full,t.toString())}}return r.\u0275fac=function(t){return new(t||r)(Pe(p3))},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({providers:[MAe,EAe]}),r})();const OAe=V1(kq,!0),_A=new Map,PQ={activated:!1,tokenObservers:[]},bAe={initialized:!1,enabled:!1};function yr(r){return _A.get(r)||Object.assign({},PQ)}function F_(){return bAe}const vA="https://content-firebaseappcheck.googleapis.com/v1",IAe="exchangeDebugToken",TQ={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class xAe{constructor(e,t,n,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return M(function*(){t.stop();try{t.pending=new tm,yield function LAe(r){return new Promise(e=>{setTimeout(e,r)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new tm,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(n){t.retryPolicy(n)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const ai=new Ec("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function CA(r){if(!yr(r).activated)throw ai.create("use-before-activation",{appName:r.name})}function G_(r,e){return MA.apply(this,arguments)}function MA(){return MA=M(function*({url:r,body:e},t){const n={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){const d=yield i.getHeartbeatsHeader();d&&(n["X-Firebase-Client"]=d)}const o={method:"POST",body:JSON.stringify(e),headers:n};let s,a;try{s=yield fetch(r,o)}catch(d){throw ai.create("fetch-network-error",{originalErrorMessage:d?.message})}if(200!==s.status)throw ai.create("fetch-status-error",{httpStatus:s.status});try{a=yield s.json()}catch(d){throw ai.create("fetch-parse-error",{originalErrorMessage:d?.message})}const c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw ai.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const l=1e3*Number(c[1]),f=Date.now();return{token:a.token,expireTimeMillis:f+l,issuedAtTimeMillis:f}}),MA.apply(this,arguments)}function OQ(r,e){const{projectId:t,appId:n,apiKey:i}=r.options;return{url:`${vA}/projects/${t}/apps/${n}:${IAe}?key=${i}`,body:{debug_token:e}}}const HAe="firebase-app-check-database",VAe=1,$9="firebase-app-check-store";let U_=null;function EA(){return EA=M(function*(r,e){const n=(yield function wQ(){return U_||(U_=new Promise((r,e)=>{try{const t=indexedDB.open(HAe,VAe);t.onsuccess=n=>{r(n.target.result)},t.onerror=n=>{var i;e(ai.create("storage-open",{originalErrorMessage:null===(i=n.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore($9,{keyPath:"compositeKey"})}}catch(t){e(ai.create("storage-open",{originalErrorMessage:t?.message}))}}),U_)}()).transaction($9,"readwrite"),o=n.objectStore($9).put({compositeKey:r,value:e});return new Promise((s,a)=>{o.onsuccess=c=>{s()},n.onerror=c=>{var l;a(ai.create("storage-set",{originalErrorMessage:null===(l=c.target.error)||void 0===l?void 0:l.message}))}})}),EA.apply(this,arguments)}const B9=new K8("@firebase/app-check");function TA(r,e){return w6()?function $Ae(r,e){return function NQ(r,e){return EA.apply(this,arguments)}(function IQ(r){return`${r.options.appId}-${r.name}`}(r),e)}(r,e).catch(t=>{B9.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function bA(){return F_().enabled}function wA(){return NA.apply(this,arguments)}function NA(){return NA=M(function*(){const r=F_();if(r.enabled&&r.token)return r.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),NA.apply(this,arguments)}const jAe={error:"UNKNOWN_ERROR"};function ZAe(r){return jP.encodeString(JSON.stringify(r),!1)}function W_(r){return AA.apply(this,arguments)}function AA(){return AA=M(function*(r,e=!1){const t=r.app;CA(t);const n=yr(t);let o,i=n.token;if(i&&!F5(i)&&(n.token=void 0,i=void 0),!i){const c=yield n.cachedTokenPromise;c&&(F5(c)?i=c:yield TA(t,void 0))}if(!e&&i&&F5(i))return{token:i.token};let a,s=!1;if(bA()){n.exchangeTokenPromise||(n.exchangeTokenPromise=G_(OQ(t,yield wA()),r.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),s=!0);const c=yield n.exchangeTokenPromise;return yield TA(t,c),n.token=c,{token:c.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),s=!0),i=yield yr(t).exchangeTokenPromise}catch(c){"appCheck/throttled"===c.code?B9.warn(c.message):B9.error(c),o=c}return i?o?a=F5(i)?{token:i.token,internalError:o}:RQ(o):(a={token:i.token},n.token=i,yield TA(t,i)):a=RQ(o),s&&function LQ(r,e){const t=yr(r).tokenObservers;for(const n of t)try{"EXTERNAL"===n.type&&null!=e.error?n.error(e.error):n.next(e)}catch{}}(t,a),a}),AA.apply(this,arguments)}function IA(){return IA=M(function*(r){const e=r.app;CA(e);const{provider:t}=yr(e);if(bA()){const n=yield wA(),{token:i}=yield G_(OQ(e,n),r.heartbeatServiceProvider);return{token:i}}{const{token:n}=yield t.getToken();return{token:n}}}),IA.apply(this,arguments)}function xA(r,e){const t=yr(r),n=t.tokenObservers.filter(i=>i.next!==e);0===n.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function xQ(r){const{app:e}=r,t=yr(e);let n=t.tokenRefresher;n||(n=function YAe(r){const{app:e}=r;return new xAe(M(function*(){let n;if(n=yr(e).token?yield W_(r,!0):yield W_(r),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{const t=yr(e);if(t.token){let n=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,t.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},TQ.RETRIAL_MIN_WAIT,TQ.RETRIAL_MAX_WAIT)}(r),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function F5(r){return r.expireTimeMillis-Date.now()>0}function RQ(r){return{token:ZAe(jAe),error:r}}class KAe{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=yr(this.app);for(const t of e)xA(this.app,t.next);return Promise.resolve()}}const GQ="app-check-internal";!function uIe(){so(new Ni("app-check",r=>function XAe(r,e){return new KAe(r,e)}(r.getProvider("app").getImmediate(),r.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,e,t)=>{r.getProvider(GQ).initialize()})),so(new Ni(GQ,r=>function QAe(r){return{getToken:e=>W_(r,e),getLimitedUseToken:()=>function kQ(r){return IA.apply(this,arguments)}(r),addTokenListener:e=>function kA(r,e,t,n){const{app:i}=r,o=yr(i);if(o.tokenObservers=[...o.tokenObservers,{next:t,error:n,type:e}],o.token&&F5(o.token)){const a=o.token;Promise.resolve().then(()=>{t({token:a.token}),xQ(r)}).catch(()=>{})}o.cachedTokenPromise.then(()=>xQ(r))}(r,"INTERNAL",e),removeTokenListener:e=>xA(r.app,e)}}(r.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),_r("@firebase/app-check","0.8.0")}();class DA{constructor(){return hA("app-check")}}typeof window<"u"&&window;const gIe=function WQ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},qQ=new Ec("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),j_=new K8("@firebase/auth");function Z_(r,...e){j_.logLevel<=Un.ERROR&&j_.error(`Auth (${k6}): ${r}`,...e)}function Do(r,...e){throw VA(r,...e)}function ls(r,...e){return VA(r,...e)}function jQ(r,e,t){const n=Object.assign(Object.assign({},gIe()),{[e]:t});return new Ec("auth","Firebase",n).create(e,{appName:r.name})}function VA(r,...e){if("string"!=typeof r){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return qQ.create(r,...e)}function Ve(r,e,...t){if(!r)throw VA(e,...t)}function Lc(r){const e="INTERNAL ASSERTION FAILED: "+r;throw Z_(e),new Error(e)}function B3(r,e){r||Lc(e)}function G9(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.href)||""}function ZQ(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.protocol)||null}class U9{constructor(e,t){this.shortDelay=e,this.longDelay=t,B3(t>e,"Short delay should be less than long delay!"),this.isMobile=function Gye(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(O2())}()||function Wye(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function _Ie(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function FA(){return"http:"===ZQ()||"https:"===ZQ()}()||ZP()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function $A(r,e){B3(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class YQ{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void Lc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void Lc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void Lc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const CIe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},yIe=new U9(3e4,6e4);function sr(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}function Mr(r,e,t,n){return BA.apply(this,arguments)}function BA(){return BA=M(function*(r,e,t,n,i={}){return KQ(r,i,M(function*(){let o={},s={};n&&("GET"===e?s=n:o={body:JSON.stringify(n)});const a=wf(Object.assign({key:r.config.apiKey},s)).slice(1),c=yield r._getAdditionalHeaders();return c["Content-Type"]="application/json",r.languageCode&&(c["X-Firebase-Locale"]=r.languageCode),YQ.fetch()(XQ(r,r.config.apiHost,t,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},o))}))}),BA.apply(this,arguments)}function KQ(r,e,t){return GA.apply(this,arguments)}function GA(){return GA=M(function*(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},CIe),e);try{const i=new MIe(r),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();const s=yield o.json();if("needConfirmation"in s)throw W9(r,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const a=o.ok?s.errorMessage:s.error.message,[c,l]=a.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===c)throw W9(r,"credential-already-in-use",s);if("EMAIL_EXISTS"===c)throw W9(r,"email-already-in-use",s);if("USER_DISABLED"===c)throw W9(r,"user-disabled",s);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw jQ(r,f,l);Do(r,f)}}catch(i){if(i instanceof Ls)throw i;Do(r,"network-request-failed",{message:String(i)})}}),GA.apply(this,arguments)}function G3(r,e,t,n){return UA.apply(this,arguments)}function UA(){return UA=M(function*(r,e,t,n,i={}){const o=yield Mr(r,e,t,n,i);return"mfaPendingCredential"in o&&Do(r,"multi-factor-auth-required",{_serverResponse:o}),o}),UA.apply(this,arguments)}function XQ(r,e,t,n){const i=`${e}${t}?${n}`;return r.config.emulator?$A(r.config,i):`${r.config.apiScheme}://${i}`}class MIe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(ls(this.auth,"network-request-failed")),yIe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function W9(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=ls(r,e,n);return i.customData._tokenResponse=t,i}function WA(){return WA=M(function*(r,e){return Mr(r,"POST","/v1/accounts:delete",e)}),WA.apply(this,arguments)}function jA(){return jA=M(function*(r,e){return Mr(r,"POST","/v1/accounts:lookup",e)}),jA.apply(this,arguments)}function q9(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function ZA(){return ZA=M(function*(r,e=!1){const t=mr(r),n=yield t.getIdToken(e),i=Y_(n);Ve(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o="object"==typeof i.firebase?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:n,authTime:q9(YA(i.auth_time)),issuedAtTime:q9(YA(i.iat)),expirationTime:q9(YA(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}),ZA.apply(this,arguments)}function YA(r){return 1e3*Number(r)}function Y_(r){const[e,t,n]=r.split(".");if(void 0===e||void 0===t||void 0===n)return Z_("JWT malformed, contained fewer than 3 sections"),null;try{const i=Jg(t);return i?JSON.parse(i):(Z_("Failed to decode base64 JWT payload"),null)}catch(i){return Z_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function U3(r,e){return KA.apply(this,arguments)}function KA(){return KA=M(function*(r,e,t=!1){if(t)return e;try{return yield e}catch(n){throw n instanceof Ls&&function bIe({code:r}){return"auth/user-disabled"===r||"auth/user-token-expired"===r}(n)&&r.auth.currentUser===r&&(yield r.auth.signOut()),n}}),KA.apply(this,arguments)}class wIe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}{this.errorBackoff=3e4;const i=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(M(function*(){yield t.iteration()}),n)}iteration(){var e=this;return M(function*(){try{yield e.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t?.code&&e.schedule(!0))}e.schedule()})()}}class QQ{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=q9(this.lastLoginAt),this.creationTime=q9(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function j9(r){return XA.apply(this,arguments)}function XA(){return XA=M(function*(r){var e;const t=r.auth,n=yield r.getIdToken(),i=yield U3(r,function PIe(r,e){return jA.apply(this,arguments)}(t,{idToken:n}));Ve(i?.users.length,t,"internal-error");const o=i.users[0];r._notifyReloadListener(o);const s=null!==(e=o.providerUserInfo)&&void 0!==e&&e.length?function IIe(r){return r.map(e=>{var{providerId:t}=e,n=$u(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}(o.providerUserInfo):[],a=function AIe(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}(r.providerData,s),f=!!r.isAnonymous&&!(r.email&&o.passwordHash||a?.length),d={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new QQ(o.createdAt,o.lastLoginAt),isAnonymous:f};Object.assign(r,d)}),XA.apply(this,arguments)}function QA(){return QA=M(function*(r){const e=mr(r);yield j9(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}),QA.apply(this,arguments)}function JA(){return JA=M(function*(r,e){const t=yield KQ(r,{},M(function*(){const n=wf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=r.config,s=XQ(r,i,"/v1/token",`key=${o}`),a=yield r._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",YQ.fetch()(s,{method:"POST",headers:a,body:n})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}),JA.apply(this,arguments)}class Z9{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):function OIe(r){const e=Y_(r);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){var n=this;return M(function*(){return Ve(!n.accessToken||n.refreshToken,e,"user-token-expired"),t||!n.accessToken||n.isExpired?n.refreshToken?(yield n.refresh(e,n.refreshToken),n.accessToken):null:n.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var n=this;return M(function*(){const{accessToken:i,refreshToken:o,expiresIn:s}=yield function kIe(r,e){return JA.apply(this,arguments)}(e,t);n.updateTokensAndExpiration(i,o,Number(s))})()}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:o}=t,s=new Z9;return n&&(Ve("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(Ve("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),o&&(Ve("number"==typeof o,"internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Z9,this.toJSON())}_performRefresh(){return Lc("not implemented")}}function ll(r,e){Ve("string"==typeof r||typeof r>"u","internal-error",{appName:e})}class c0{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,o=$u(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new wIe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new QQ(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){var t=this;return M(function*(){const n=yield U3(t,t.stsTokenManager.getToken(t.auth,e));return Ve(n,t.auth,"internal-error"),t.accessToken!==n&&(t.accessToken=n,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),n})()}getIdTokenResult(e){return function TIe(r){return ZA.apply(this,arguments)}(this,e)}reload(){return function NIe(r){return QA.apply(this,arguments)}(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new c0(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){var n=this;return M(function*(){let i=!1;e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield j9(n)),yield n.auth._persistUserIfCurrent(n),i&&n.auth._notifyListenersIfCurrent(n)})()}delete(){var e=this;return M(function*(){const t=yield e.getIdToken();return yield U3(e,function EIe(r,e){return WA.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,o,s,a,c,l,f;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,m=null!==(i=t.email)&&void 0!==i?i:void 0,E=null!==(o=t.phoneNumber)&&void 0!==o?o:void 0,w=null!==(s=t.photoURL)&&void 0!==s?s:void 0,L=null!==(a=t.tenantId)&&void 0!==a?a:void 0,z=null!==(c=t._redirectEventId)&&void 0!==c?c:void 0,$=null!==(l=t.createdAt)&&void 0!==l?l:void 0,B=null!==(f=t.lastLoginAt)&&void 0!==f?f:void 0,{uid:de,emailVerified:_e,isAnonymous:xe,providerData:nt,stsTokenManager:gt}=t;Ve(de&&gt,e,"internal-error");const Mn=Z9.fromJSON(this.name,gt);Ve("string"==typeof de,e,"internal-error"),ll(d,e.name),ll(m,e.name),Ve("boolean"==typeof _e,e,"internal-error"),Ve("boolean"==typeof xe,e,"internal-error"),ll(E,e.name),ll(w,e.name),ll(L,e.name),ll(z,e.name),ll($,e.name),ll(B,e.name);const Et=new c0({uid:de,auth:e,email:m,emailVerified:_e,displayName:d,isAnonymous:xe,photoURL:w,phoneNumber:E,tenantId:L,stsTokenManager:Mn,createdAt:$,lastLoginAt:B});return nt&&Array.isArray(nt)&&(Et.providerData=nt.map(q2=>Object.assign({},q2))),z&&(Et._redirectEventId=z),Et}static _fromIdTokenResponse(e,t,n=!1){return M(function*(){const i=new Z9;i.updateFromServerResponse(t);const o=new c0({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield j9(o),o})()}}const JQ=new Map;function W3(r){B3(r instanceof Function,"Expected a class definition");let e=JQ.get(r);return e?(B3(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,JQ.set(r,e),e)}const eJ=(()=>{class r{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return M(function*(){return!0})()}_set(t,n){var i=this;return M(function*(){i.storage[t]=n})()}_get(t){var n=this;return M(function*(){const i=n.storage[t];return void 0===i?null:i})()}_remove(t){var n=this;return M(function*(){delete n.storage[t]})()}_addListener(t,n){}_removeListener(t,n){}}return r.type="NONE",r})();function K_(r,e,t){return`firebase:${r}:${e}:${t}`}class B5{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=K_(this.userKey,i.apiKey,o),this.fullPersistenceKey=K_("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return M(function*(){const t=yield e.persistence._get(e.fullUserKey);return t?c0._fromJSON(e.auth,t):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return M(function*(){if(t.persistence===e)return;const n=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,n?t.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return M(function*(){if(!t.length)return new B5(W3(eJ),e,n);const i=(yield Promise.all(t.map(function(){var l=M(function*(f){if(yield f._isAvailable())return f});return function(f){return l.apply(this,arguments)}}()))).filter(l=>l);let o=i[0]||W3(eJ);const s=K_(n,e.config.apiKey,e.name);let a=null;for(const l of t)try{const f=yield l._get(s);if(f){const d=c0._fromJSON(e,f);l!==o&&(a=d),o=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return o._shouldAllowMigration&&c.length?(o=c[0],a&&(yield o._set(s,a.toJSON())),yield Promise.all(t.map(function(){var l=M(function*(f){if(f!==o)try{yield f._remove(s)}catch{}});return function(f){return l.apply(this,arguments)}}())),new B5(o,e,n)):new B5(o,e,n)})()}}function tJ(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(iJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(nJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sJ(e))return"Blackberry";if(aJ(e))return"Webos";if(eI(e))return"Safari";if((e.includes("chrome/")||rJ(e))&&!e.includes("edge/"))return"Chrome";if(oJ(e))return"Android";{const n=r.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===n?.length)return n[1]}return"Other"}function nJ(r=O2()){return/firefox\//i.test(r)}function eI(r=O2()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function rJ(r=O2()){return/crios\//i.test(r)}function iJ(r=O2()){return/iemobile/i.test(r)}function oJ(r=O2()){return/android/i.test(r)}function sJ(r=O2()){return/blackberry/i.test(r)}function aJ(r=O2()){return/webos/i.test(r)}function X_(r=O2()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function cJ(r=O2()){return X_(r)||oJ(r)||aJ(r)||sJ(r)||/windows phone/i.test(r)||iJ(r)}function lJ(r,e=[]){let t;switch(r){case"Browser":t=tJ(O2());break;case"Worker":t=`${tJ(O2())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${k6}/${n}`}function uJ(r,e){return nI.apply(this,arguments)}function nI(){return nI=M(function*(r,e){return Mr(r,"GET","/v2/recaptchaConfig",sr(r,e))}),nI.apply(this,arguments)}function dJ(r){return void 0!==r&&void 0!==r.enterprise}class hJ{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(t=>"EMAIL_PASSWORD_PROVIDER"===t.provider&&"OFF"!==t.enforcementState)}}function rI(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const o=ls("internal-error");o.customData=i,t(o)},n.type="text/javascript",n.charset="UTF-8",function DIe(){var r,e;return null!==(e=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==e?e:document}().appendChild(n)})}function pJ(r){return`__${r}${Math.floor(1e6*Math.random())}`}class gJ{constructor(e){this.type="recaptcha-enterprise",this.auth=x2(e)}verify(e="verify",t=!1){var n=this;return M(function*(){function o(){return o=M(function*(a){if(!t){if(null==a.tenantId&&null!=a._agentRecaptchaConfig)return a._agentRecaptchaConfig.siteKey;if(null!=a.tenantId&&void 0!==a._tenantRecaptchaConfigs[a.tenantId])return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(function(){var c=M(function*(l,f){uJ(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(void 0!==d.recaptchaKey){const m=new hJ(d);return null==a.tenantId?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,l(m.siteKey)}f(new Error("recaptcha Enterprise site key undefined"))}).catch(d=>{f(d)})});return function(l,f){return c.apply(this,arguments)}}())}),o.apply(this,arguments)}function s(a,c,l){const f=window.grecaptcha;dJ(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(d=>{c(d)}).catch(()=>{c("NO_RECAPTCHA")})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,c)=>{(function i(a){return o.apply(this,arguments)})(n.auth).then(l=>{if(!t&&dJ(window.grecaptcha))s(l,a,c);else{if(typeof window>"u")return void c(new Error("RecaptchaVerifier is only supported in browser"));rI("https://www.google.com/recaptcha/enterprise.js?render="+l).then(()=>{s(l,a,c)}).catch(f=>{c(f)})}}).catch(l=>{c(l)})})})()}}function ul(r,e,t){return iI.apply(this,arguments)}function iI(){return iI=M(function*(r,e,t,n=!1){const i=new gJ(r);let o;try{o=yield i.verify(t)}catch{o=yield i.verify(t,!0)}const s=Object.assign({},e);return Object.assign(s,n?{captchaResp:o}:{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}),iI.apply(this,arguments)}class $Ie{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=o=>new Promise((s,a)=>{try{s(e(o))}catch(c){a(c)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return M(function*(){if(t.auth.currentUser===e)return;const n=[];try{for(const i of t.queue)yield i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const o of n)try{o()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}class BIe{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new mJ(this),this.idTokenSubscription=new mJ(this),this.beforeStateQueue=new $Ie(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qQ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){var n=this;return t&&(this._popupRedirectResolver=W3(t)),this._initializationPromise=this.queue(M(function*(){var i,o;if(!n._deleted&&(n.persistenceManager=yield B5.create(n,e),!n._deleted)){if(null!==(i=n._popupRedirectResolver)&&void 0!==i&&i._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch{}yield n.initializeCurrentUser(t),n.lastNotifiedUid=(null===(o=n.currentUser)||void 0===o?void 0:o.uid)||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return M(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUser(e){var t=this;return M(function*(){var n;const i=yield t.assertedPersistence.getCurrentUser();let o=i,s=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const a=null===(n=t.redirectUser)||void 0===n?void 0:n._redirectEventId,c=o?._redirectEventId,l=yield t.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(o=l.user,s=!0)}if(!o)return t.directlySetCurrentUser(null);if(!o._redirectEventId){if(s)try{yield t.beforeStateQueue.runMiddleware(o)}catch(a){o=i,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(a))}return o?t.reloadAndSetCurrentUserOrClear(o):t.directlySetCurrentUser(null)}return Ve(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===o._redirectEventId?t.directlySetCurrentUser(o):t.reloadAndSetCurrentUserOrClear(o)})()}tryRedirectSignIn(e){var t=this;return M(function*(){let n=null;try{n=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(e){var t=this;return M(function*(){try{yield j9(e)}catch(n){if("auth/network-request-failed"!==n?.code)return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function vIe(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}()}_delete(){var e=this;return M(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return M(function*(){const n=e?mr(e):null;return n&&Ve(n.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(n&&n._clone(t))})()}_updateCurrentUser(e,t=!1){var n=this;return M(function*(){if(!n._deleted)return e&&Ve(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),t||(yield n.beforeStateQueue.runMiddleware(e)),n.queue(M(function*(){yield n.directlySetCurrentUser(e),n.notifyAuthListeners()}))})()}signOut(){var e=this;return M(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var t=this;return this.queue(M(function*(){yield t.assertedPersistence.setPersistence(W3(e))}))}initializeRecaptchaConfig(){var e=this;return M(function*(){const t=yield uJ(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new hJ(t);null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.emailPasswordEnabled&&new gJ(e).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ec("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){var n=this;return M(function*(){const i=yield n.getOrInitRedirectPersistenceManager(t);return null===e?i.removeCurrentUser():i.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return M(function*(){if(!t.redirectPersistenceManager){const n=e&&W3(e)||t._popupRedirectResolver;Ve(n,t,"argument-error"),t.redirectPersistenceManager=yield B5.create(t,[W3(n._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return M(function*(){var n,i;return t._isInitialized&&(yield t.queue(M(function*(){}))),(null===(n=t._currentUser)||void 0===n?void 0:n._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return M(function*(){if(e===t.currentUser)return t.queue(M(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const o="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return Ve(s,this,"internal-error"),s.then(()=>o(this.currentUser)),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}directlySetCurrentUser(e){var t=this;return M(function*(){t.currentUser&&t.currentUser!==e&&t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh(),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return M(function*(){var t;const n={"X-Client-Version":e.clientVersion};e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId);const i=yield null===(t=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();i&&(n["X-Firebase-Client"]=i);const o=yield e._getAppCheckToken();return o&&(n["X-Firebase-AppCheck"]=o),n})()}_getAppCheckToken(){var e=this;return M(function*(){var t;const n=yield null===(t=e.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();return n?.error&&function mIe(r,...e){j_.logLevel<=Un.WARN&&j_.warn(`Auth (${k6}): ${r}`,...e)}(`Error while retrieving App Check token: ${n.error}`),n?.token})()}}function x2(r){return mr(r)}class mJ{constructor(e){this.auth=e,this.observer=null,this.addObserver=function Xye(r,e){const t=new Qye(r,e);return t.subscribe.bind(t)}(t=>this.observer=t)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function _J(r,e,t){const n=x2(r);Ve(n._canInitEmulator,n,"emulator-config-failed"),Ve(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!!t?.disableWarnings,o=vJ(e),{host:s,port:a}=function WIe(r){const e=vJ(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:CJ(n.substr(o.length+1))}}{const[o,s]=n.split(":");return{host:o,port:CJ(s)}}}(e);n.config.emulator={url:`${o}//${s}${null===a?"":`:${a}`}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function qIe(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",r):r())}()}function vJ(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function CJ(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}class oI{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Lc("not implemented")}_getIdTokenResponse(e){return Lc("not implemented")}_linkToIdToken(e,t){return Lc("not implemented")}_getReauthenticationResolver(e){return Lc("not implemented")}}function aI(){return aI=M(function*(r,e){return Mr(r,"POST","/v1/accounts:update",e)}),aI.apply(this,arguments)}function lI(r,e){return uI.apply(this,arguments)}function uI(){return uI=M(function*(r,e){return G3(r,"POST","/v1/accounts:signInWithPassword",sr(r,e))}),uI.apply(this,arguments)}function Q_(r,e){return fI.apply(this,arguments)}function fI(){return fI=M(function*(r,e){return Mr(r,"POST","/v1/accounts:sendOobCode",sr(r,e))}),fI.apply(this,arguments)}function dI(){return dI=M(function*(r,e){return Q_(r,e)}),dI.apply(this,arguments)}function hI(r,e){return pI.apply(this,arguments)}function pI(){return pI=M(function*(r,e){return Q_(r,e)}),pI.apply(this,arguments)}function vI(){return vI=M(function*(r,e){return G3(r,"POST","/v1/accounts:signInWithEmailLink",sr(r,e))}),vI.apply(this,arguments)}function CI(){return CI=M(function*(r,e){return G3(r,"POST","/v1/accounts:signInWithEmailLink",sr(r,e))}),CI.apply(this,arguments)}class Y9 extends oI{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Y9(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Y9(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){var t=this;return M(function*(){var n;switch(t.signInMethod){case"password":const i={returnSecureToken:!0,email:t._email,password:t._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=e._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const o=yield ul(e,i,"signInWithPassword");return lI(e,o)}return lI(e,i).catch(function(){var o=M(function*(s){if("auth/missing-recaptcha-token"===s.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const a=yield ul(e,i,"signInWithPassword");return lI(e,a)}return Promise.reject(s)});return function(s){return o.apply(this,arguments)}}());case"emailLink":return function KIe(r,e){return vI.apply(this,arguments)}(e,{email:t._email,oobCode:t._password});default:Do(e,"internal-error")}})()}_linkToIdToken(e,t){var n=this;return M(function*(){switch(n.signInMethod){case"password":return function MJ(r,e){return aI.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password});case"emailLink":return function XIe(r,e){return CI.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password});default:Do(e,"internal-error")}})()}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}function q3(r,e){return yI.apply(this,arguments)}function yI(){return yI=M(function*(r,e){return G3(r,"POST","/v1/accounts:signInWithIdp",sr(r,e))}),yI.apply(this,arguments)}class G5 extends oI{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new G5(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Do("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,o=$u(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new G5(n,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){return q3(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,q3(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,q3(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=wf(t)}return e}}class X9{constructor(e){var t,n,i,o,s,a;const c=Nf(Af(e)),l=null!==(t=c.apiKey)&&void 0!==t?t:null,f=null!==(n=c.oobCode)&&void 0!==n?n:null,d=function ike(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);Ve(l&&f&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=f,this.continueUrl=null!==(o=c.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(s=c.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function oke(r){const e=Nf(Af(r)).link,t=e?Nf(Af(e)).deep_link_id:null,n=Nf(Af(r)).deep_link_id;return(n?Nf(Af(n)).link:null)||n||t||e||r}(e);try{return new X9(t)}catch{return null}}}let EJ=(()=>{class r{constructor(){this.providerId=r.PROVIDER_ID}static credential(t,n){return Y9._fromEmailAndPassword(t,n)}static credentialWithLink(t,n){const i=X9.parseLink(n);return Ve(i,"argument-error"),Y9._fromEmailAndCode(t,i.code,i.tenantId)}}return r.PROVIDER_ID="password",r.EMAIL_PASSWORD_SIGN_IN_METHOD="password",r.EMAIL_LINK_SIGN_IN_METHOD="emailLink",r})();class fl{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class SJ extends fl{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let ske=(()=>{class r extends SJ{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return G5._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return r.credentialFromTaggedObject(t)}static credentialFromError(t){return r.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return r.credential(n,i)}catch{return null}}}return r.GOOGLE_SIGN_IN_METHOD="google.com",r.PROVIDER_ID="google.com",r})();function ev(r,e){return OI.apply(this,arguments)}function OI(){return OI=M(function*(r,e){return G3(r,"POST","/v1/accounts:signUp",sr(r,e))}),OI.apply(this,arguments)}class Ds{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,i=!1){return M(function*(){const o=yield c0._fromIdTokenResponse(e,n,i),s=PJ(n);return new Ds({user:o,providerId:s,_tokenResponse:n,operationType:t})})()}static _forOperation(e,t,n){return M(function*(){yield e._updateTokensIfNecessary(n,!0);const i=PJ(n);return new Ds({user:e,providerId:i,_tokenResponse:n,operationType:t})})()}}function PJ(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}class tv extends Ls{constructor(e,t,n,i){var o;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,tv.prototype),this.customData={appName:e.name,tenantId:null!==(o=e.tenantId)&&void 0!==o?o:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new tv(e,t,n,i)}}function TJ(r,e,t,n){return("reauthenticate"===e?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(o=>{throw"auth/multi-factor-auth-required"===o.code?tv._fromErrorAndOperation(r,o,e,n):o})}function AI(){return AI=M(function*(r,e,t=!1){const n=yield U3(r,e._linkToIdToken(r.auth,yield r.getIdToken()),t);return Ds._forOperation(r,"link",n)}),AI.apply(this,arguments)}function kI(){return kI=M(function*(r,e,t=!1){const{auth:n}=r,i="reauthenticate";try{const o=yield U3(r,TJ(n,i,e,r),t);Ve(o.idToken,n,"internal-error");const s=Y_(o.idToken);Ve(s,n,"internal-error");const{sub:a}=s;return Ve(r.uid===a,n,"user-mismatch"),Ds._forOperation(r,i,o)}catch(o){throw"auth/user-not-found"===o?.code&&Do(n,"user-mismatch"),o}}),kI.apply(this,arguments)}function wJ(r,e){return xI.apply(this,arguments)}function xI(){return xI=M(function*(r,e,t=!1){const n="signIn",i=yield TJ(r,n,e),o=yield Ds._fromIdTokenResponse(r,n,i);return t||(yield r._updateCurrentUser(o.user)),o}),xI.apply(this,arguments)}function RI(){return RI=M(function*(r,e){return wJ(x2(r),e)}),RI.apply(this,arguments)}function U5(r,e,t){var n;Ve((null===(n=t.url)||void 0===n?void 0:n.length)>0,r,"invalid-continue-uri"),Ve(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Ve(t.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Ve(t.android.packageName.length>0,r,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function dke(r,e,t){return GI.apply(this,arguments)}function GI(){return GI=M(function*(r,e,t){var n;const i=x2(r),o={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const s=yield ul(i,o,"getOobCode",!0);t&&U5(i,s,t),yield hI(i,s)}else t&&U5(i,o,t),yield hI(i,o).catch(function(){var s=M(function*(a){if("auth/missing-recaptcha-token"!==a.code)return Promise.reject(a);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const c=yield ul(i,o,"getOobCode",!0);t&&U5(i,c,t),yield hI(i,c)}});return function(a){return s.apply(this,arguments)}}())}),GI.apply(this,arguments)}function pke(r,e,t){return ZI.apply(this,arguments)}function ZI(){return ZI=M(function*(r,e,t){var n;const i=x2(r),o={returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"};let s;if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const l=yield ul(i,o,"signUpPassword");s=ev(i,l)}else s=ev(i,o).catch(function(){var l=M(function*(f){if("auth/missing-recaptcha-token"===f.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const d=yield ul(i,o,"signUpPassword");return ev(i,d)}return Promise.reject(f)});return function(f){return l.apply(this,arguments)}}());const a=yield s.catch(l=>Promise.reject(l)),c=yield Ds._fromIdTokenResponse(i,"signIn",a);return yield i._updateCurrentUser(c.user),c}),ZI.apply(this,arguments)}function gke(r,e,t){return function LI(r,e){return RI.apply(this,arguments)}(mr(r),EJ.credential(e,t))}function _ke(r,e){return JI.apply(this,arguments)}function JI(){return JI=M(function*(r,e){const t=mr(r),i={requestType:"VERIFY_EMAIL",idToken:yield r.getIdToken()};e&&U5(t.auth,i,e);const{email:o}=yield function ZIe(r,e){return dI.apply(this,arguments)}(t.auth,i);o!==r.email&&(yield r.reload())}),JI.apply(this,arguments)}function tk(){return tk=M(function*(r,e){return Mr(r,"POST","/v1/accounts:update",e)}),tk.apply(this,arguments)}function Cke(r,e){return nk.apply(this,arguments)}function nk(){return nk=M(function*(r,{displayName:e,photoURL:t}){if(void 0===e&&void 0===t)return;const n=mr(r),o={idToken:yield n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},s=yield U3(n,function vke(r,e){return tk.apply(this,arguments)}(n.auth,o));n.displayName=s.displayName||null,n.photoURL=s.photoUrl||null;const a=n.providerData.find(({providerId:c})=>"password"===c);a&&(a.displayName=n.displayName,a.photoURL=n.photoURL),yield n._updateTokensIfNecessary(s)}),nk.apply(this,arguments)}function bke(r,e,t,n){return mr(r).onAuthStateChanged(e,t,n)}const rv="__sak";class AJ{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(rv,"1"),this.storage.removeItem(rv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Rke=(()=>{class r extends AJ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function kke(){const r=O2();return eI(r)||X_(r)}()&&function RIe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=cJ(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),o=this.localCache[n];i!==o&&t(n,o,i)}}onStorageEvent(t,n=!1){if(!t.key)return void this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});const i=t.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(i);if(t.newValue!==a)null!==t.newValue?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!n)return}const o=()=>{const a=this.storage.getItem(i);!n&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);!function LIe(){return function qye(){const r=O2();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}()&&10===document.documentMode}()||s===t.newValue||t.newValue===t.oldValue?o():setTimeout(o,10)}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const o of Array.from(i))o(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(t,n){var i=()=>super._set,o=this;return M(function*(){yield i().call(o,t,n),o.localCache[t]=JSON.stringify(n)})()}_get(t){var n=()=>super._get,i=this;return M(function*(){const o=yield n().call(i,t);return i.localCache[t]=JSON.stringify(o),o})()}_remove(t){var n=()=>super._remove,i=this;return M(function*(){yield n().call(i,t),delete i.localCache[t]})()}}return r.type="LOCAL",r})(),IJ=(()=>{class r extends AJ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}return r.type="SESSION",r})();let Dke=(()=>{class r{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(o=>o.isListeningto(t));if(n)return n;const i=new r(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){var n=this;return M(function*(){const i=t,{eventId:o,eventType:s,data:a}=i.data,c=n.handlersMap[s];if(!c?.size)return;i.ports[0].postMessage({status:"ack",eventId:o,eventType:s});const l=Array.from(c).map(function(){var d=M(function*(m){return m(i.origin,a)});return function(m){return d.apply(this,arguments)}}()),f=yield function zke(r){return Promise.all(r.map(function(){var e=M(function*(t){try{return{fulfilled:!0,value:yield t}}catch(n){return{fulfilled:!1,reason:n}}});return function(t){return e.apply(this,arguments)}}()))}(l);i.ports[0].postMessage({status:"done",eventId:o,eventType:s,response:f})})()}_subscribe(t,n){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||0===this.handlersMap[t].size)&&delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return r.receivers=[],r})();function iv(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(10*Math.random());return r+t}class Hke{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){var i=this;return M(function*(){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let s,a;return new Promise((c,l)=>{const f=iv("",20);o.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:o,onMessage(m){const E=m;if(E.data.eventId===f)switch(E.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(E.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"))}}},i.handlers.add(a),o.port1.addEventListener("message",a.onMessage),i.target.postMessage({eventType:e,eventId:f,data:t},[o.port2])}).finally(()=>{a&&i.removeMessageHandler(a)})})()}}function Qr(){return window}function lk(){return typeof Qr().WorkerGlobalScope<"u"&&"function"==typeof Qr().importScripts}function uk(){return(uk=M(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const kJ="firebaseLocalStorageDb",ov="firebaseLocalStorage",xJ="fbase_key";class J9{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function sv(r,e){return r.transaction([ov],e?"readwrite":"readonly").objectStore(ov)}function fk(){const r=indexedDB.open(kJ,1);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(ov,{keyPath:xJ})}catch(i){t(i)}}),r.addEventListener("success",M(function*(){const n=r.result;n.objectStoreNames.contains(ov)?e(n):(n.close(),yield function Uke(){const r=indexedDB.deleteDatabase(kJ);return new J9(r).toPromise()}(),e(yield fk()))}))})}function LJ(r,e,t){return dk.apply(this,arguments)}function dk(){return dk=M(function*(r,e,t){const n=sv(r,!0).put({[xJ]:e,value:t});return new J9(n).toPromise()}),dk.apply(this,arguments)}function hk(){return hk=M(function*(r,e){const t=sv(r,!1).get(e),n=yield new J9(t).toPromise();return void 0===n?null:n.value}),hk.apply(this,arguments)}function RJ(r,e){const t=sv(r,!0).delete(e);return new J9(t).toPromise()}const Zke=(()=>{class r{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var t=this;return M(function*(){return t.db||(t.db=yield fk()),t.db})()}_withRetries(t){var n=this;return M(function*(){let i=0;for(;;)try{const o=yield n._openDb();return yield t(o)}catch(o){if(i++>3)throw o;n.db&&(n.db.close(),n.db=void 0)}})()}initializeServiceWorkerMessaging(){var t=this;return M(function*(){return lk()?t.initializeReceiver():t.initializeSender()})()}initializeReceiver(){var t=this;return M(function*(){t.receiver=Dke._getInstance(function Bke(){return lk()?self:null}()),t.receiver._subscribe("keyChanged",function(){var n=M(function*(i,o){return{keyProcessed:(yield t._poll()).includes(o.key)}});return function(i,o){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var n=M(function*(i,o){return["keyChanged"]});return function(i,o){return n.apply(this,arguments)}}())})()}initializeSender(){var t=this;return M(function*(){var n,i;if(t.activeServiceWorker=yield function Fke(){return uk.apply(this,arguments)}(),!t.activeServiceWorker)return;t.sender=new Hke(t.activeServiceWorker);const o=yield t.sender._send("ping",{},800);o&&null!==(n=o[0])&&void 0!==n&&n.fulfilled&&null!==(i=o[0])&&void 0!==i&&i.value.includes("keyChanged")&&(t.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(t){var n=this;return M(function*(){if(n.sender&&n.activeServiceWorker&&function $ke(){var r;return(null===(r=navigator?.serviceWorker)||void 0===r?void 0:r.controller)||null}()===n.activeServiceWorker)try{yield n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return M(function*(){try{if(!indexedDB)return!1;const t=yield fk();return yield LJ(t,rv,"1"),yield RJ(t,rv),!0}catch{}return!1})()}_withPendingWrite(t){var n=this;return M(function*(){n.pendingWrites++;try{yield t()}finally{n.pendingWrites--}})()}_set(t,n){var i=this;return M(function*(){return i._withPendingWrite(M(function*(){return yield i._withRetries(o=>LJ(o,t,n)),i.localCache[t]=n,i.notifyServiceWorker(t)}))})()}_get(t){var n=this;return M(function*(){const i=yield n._withRetries(o=>function Wke(r,e){return hk.apply(this,arguments)}(o,t));return n.localCache[t]=i,i})()}_remove(t){var n=this;return M(function*(){return n._withPendingWrite(M(function*(){return yield n._withRetries(i=>RJ(i,t)),delete n.localCache[t],n.notifyServiceWorker(t)}))})()}_poll(){var t=this;return M(function*(){const n=yield t._withRetries(s=>{const a=sv(s,!1).getAll();return new J9(a).toPromise()});if(!n)return[];if(0!==t.pendingWrites)return[];const i=[],o=new Set;for(const{fbase_key:s,value:a}of n)o.add(s),JSON.stringify(t.localCache[s])!==JSON.stringify(a)&&(t.notifyListeners(s,a),i.push(s));for(const s of Object.keys(t.localCache))t.localCache[s]&&!o.has(s)&&(t.notifyListeners(s,null),i.push(s));return i})()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const o of Array.from(i))o(n)}startPolling(){var t=this;this.stopPolling(),this.pollTimer=setInterval(M(function*(){return t._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return r.type="LOCAL",r})();function u0(r,e){return e?W3(e):(Ve(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}pJ("rcb"),new U9(3e4,6e4);class Ek extends oI{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return q3(e,this._buildIdpRequest())}_linkToIdToken(e,t){return q3(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return q3(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function uxe(r){return wJ(r.auth,new Ek(r),r.bypassAuthState)}function fxe(r){const{auth:e,user:t}=r;return Ve(t,e,"internal-error"),function bJ(r,e){return kI.apply(this,arguments)}(t,new Ek(r),r.bypassAuthState)}function dxe(r){return Sk.apply(this,arguments)}function Sk(){return Sk=M(function*(r){const{auth:e,user:t}=r;return Ve(t,e,"internal-error"),function NI(r,e){return AI.apply(this,arguments)}(t,new Ek(r),r.bypassAuthState)}),Sk.apply(this,arguments)}class DJ{constructor(e,t,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=M(function*(n,i){e.pendingPromise={resolve:n,reject:i};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(o){e.reject(o)}});return function(n,i){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return M(function*(){const{urlResponse:n,sessionId:i,postBody:o,tenantId:s,error:a,type:c}=e;if(a)return void t.reject(a);const l={auth:t.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:o||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(c)(l))}catch(f){t.reject(f)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uxe;case"linkViaPopup":case"linkViaRedirect":return dxe;case"reauthViaPopup":case"reauthViaRedirect":return fxe;default:Do(this.auth,"internal-error")}}resolve(e){B3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){B3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const hxe=new U9(2e3,1e4);function pxe(r,e,t){return Pk.apply(this,arguments)}function Pk(){return Pk=M(function*(r,e,t){const n=x2(r);!function $5(r,e,t){if(!(e instanceof t))throw t.name!==e.constructor.name&&Do(r,"argument-error"),jQ(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(r,e,fl);const i=u0(n,t);return new bk(n,"signInViaPopup",e,i).executeNotNull()}),Pk.apply(this,arguments)}let bk=(()=>{class r extends DJ{constructor(t,n,i,o,s){super(t,n,o,s),this.provider=i,this.authWindow=null,this.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=this}executeNotNull(){var t=this;return M(function*(){const n=yield t.execute();return Ve(n,t.auth,"internal-error"),n})()}onExecution(){var t=this;return M(function*(){B3(1===t.filter.length,"Popup operations only handle one event");const n=iv();t.authWindow=yield t.resolver._openPopup(t.auth,t.provider,t.filter[0],n),t.authWindow.associatedEvent=n,t.resolver._originValidation(t.auth).catch(i=>{t.reject(i)}),t.resolver._isIframeWebStorageSupported(t.auth,i=>{i||t.reject(ls(t.auth,"web-storage-unsupported"))}),t.pollUserCancellation()})()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(ls(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,i;this.pollId=null!==(i=null===(n=this.authWindow)||void 0===n?void 0:n.window)&&void 0!==i&&i.closed?window.setTimeout(()=>{this.pollId=null,this.reject(ls(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(t,hxe.get())};t()}}return r.currentPopupAction=null,r})();const gxe="pendingRedirect",ed=new Map;class mxe extends DJ{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){var e=()=>super.execute,t=this;return M(function*(){let n=ed.get(t.auth._key());if(!n){try{const o=(yield function _xe(r,e){return wk.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;n=()=>Promise.resolve(o)}catch(i){n=()=>Promise.reject(i)}ed.set(t.auth._key(),n)}return t.bypassAuthState||ed.set(t.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,n=this;return M(function*(){if("signInViaRedirect"===e.type)return t().call(n,e);if("unknown"!==e.type){if(e.eventId){const i=yield n.auth._redirectUserForId(e.eventId);if(i)return n.user=i,t().call(n,e);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return M(function*(){})()}cleanUp(){}}function wk(){return wk=M(function*(r,e){const t=function VJ(r){return K_(gxe,r.config.apiKey,r.name)}(e),n=function HJ(r){return W3(r._redirectPersistence)}(r);if(!(yield n._isAvailable()))return!1;const i="true"===(yield n._get(t));return yield n._remove(t),i}),wk.apply(this,arguments)}function vxe(r,e){ed.set(r._key(),e)}function FJ(r,e){return Rk.apply(this,arguments)}function Rk(){return Rk=M(function*(r,e,t=!1){const n=x2(r),i=u0(n,e),s=yield new mxe(n,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,yield n._persistUserIfCurrent(s.user),yield n._setRedirectUser(null,e)),s}),Rk.apply(this,arguments)}class Sxe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function Pxe(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return GJ(r);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!GJ(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(ls(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(BJ(e))}saveEventToCache(e){this.cachedEventUids.add(BJ(e)),this.lastProcessedEventTime=Date.now()}}function BJ(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function GJ({type:r,error:e}){return"unknown"===r&&"auth/no-auth-event"===e?.code}function Dk(){return Dk=M(function*(r,e={}){return Mr(r,"GET","/v1/projects",e)}),Dk.apply(this,arguments)}const Oxe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,bxe=/^https?/;function Hk(){return Hk=M(function*(r){if(r.config.emulator)return;const{authorizedDomains:e}=yield function Txe(r){return Dk.apply(this,arguments)}(r);for(const t of e)try{if(Nxe(t))return}catch{}Do(r,"unauthorized-domain")}),Hk.apply(this,arguments)}function Nxe(r){const e=G9(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const s=new URL(r);return""===s.hostname&&""===n?"chrome-extension:"===t&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===t&&s.hostname===n}if(!bxe.test(t))return!1;if(Oxe.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const Axe=new U9(3e4,6e4);function UJ(){const r=Qr().___jsl;if(r?.H)for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}let cv=null;const xxe=new U9(5e3,15e3),Lxe="__/auth/iframe",Rxe="emulator/auth/iframe",zxe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Dxe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Hxe(r){const e=r.config;Ve(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?$A(e,Rxe):`https://${r.config.authDomain}/${Lxe}`,n={apiKey:e.apiKey,appName:r.name,v:k6},i=Dxe.get(r.config.apiHost);i&&(n.eid=i);const o=r._getFrameworks();return o.length&&(n.fw=o.join(",")),`${t}?${wf(n).slice(1)}`}function Vk(){return Vk=M(function*(r){const e=yield function kxe(r){return cv=cv||function Ixe(r){return new Promise((e,t)=>{var n,i,o;function s(){UJ(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{UJ(),t(ls(r,"network-request-failed"))},timeout:Axe.get()})}if(null!==(i=null===(n=Qr().gapi)||void 0===n?void 0:n.iframes)&&void 0!==i&&i.Iframe)e(gapi.iframes.getContext());else{if(null===(o=Qr().gapi)||void 0===o||!o.load){const a=pJ("iframefcb");return Qr()[a]=()=>{gapi.load?s():t(ls(r,"network-request-failed"))},rI(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>t(c))}s()}}).catch(e=>{throw cv=null,e})}(r),cv}(r),t=Qr().gapi;return Ve(t,r,"internal-error"),e.open({where:document.body,url:Hxe(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zxe,dontclear:!0},n=>new Promise(function(){var i=M(function*(o,s){yield n.restyle({setHideOnLeave:!1});const a=ls(r,"network-request-failed"),c=Qr().setTimeout(()=>{s(a)},xxe.get());function l(){Qr().clearTimeout(c),o(n)}n.ping(l).then(l,()=>{s(a)})});return function(o,s){return i.apply(this,arguments)}}()))}),Vk.apply(this,arguments)}const Fxe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class WJ{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const jxe="__/auth/handler",Zxe="emulator/auth/handler",Yxe=encodeURIComponent("fac");function qJ(r,e,t,n,i,o){return Fk.apply(this,arguments)}function Fk(){return Fk=M(function*(r,e,t,n,i,o){Ve(r.config.authDomain,r,"auth-domain-config-required"),Ve(r.config.apiKey,r,"invalid-api-key");const s={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:k6,eventId:i};if(e instanceof fl){e.setDefaultLanguage(r.languageCode),s.providerId=e.providerId||"",function Kye(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,d]of Object.entries(o||{}))s[f]=d}if(e instanceof SJ){const f=e.getScopes().filter(d=>""!==d);f.length>0&&(s.scopes=f.join(","))}r.tenantId&&(s.tid=r.tenantId);const a=s;for(const f of Object.keys(a))void 0===a[f]&&delete a[f];const c=yield r._getAppCheckToken(),l=c?`#${Yxe}=${encodeURIComponent(c)}`:"";return`${function Kxe({config:r}){return r.emulator?$A(r,Zxe):`https://${r.authDomain}/${jxe}`}(r)}?${wf(a).slice(1)}${l}`}),Fk.apply(this,arguments)}const $k="webStorageSupport",Qxe=class Xxe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=IJ,this._completeRedirectFn=FJ,this._overrideRedirectResult=vxe}_openPopup(e,t,n,i){var o=this;return M(function*(){var s;B3(null===(s=o.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");const a=yield qJ(e,t,n,G9(),i);return function Wxe(r,e,t,n=500,i=600){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Fxe),{width:n.toString(),height:i.toString(),top:o,left:s}),l=O2().toLowerCase();t&&(a=rJ(l)?"_blank":t),nJ(l)&&(e=e||"http://localhost",c.scrollbars="yes");const f=Object.entries(c).reduce((m,[E,w])=>`${m}${E}=${w},`,"");if(function xIe(r=O2()){var e;return X_(r)&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(l)&&"_self"!==a)return function qxe(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}(e||"",a),new WJ(null);const d=window.open(e||"",a,f);Ve(d,r,"popup-blocked");try{d.focus()}catch{}return new WJ(d)}(e,a,iv())})()}_openRedirect(e,t,n,i){var o=this;return M(function*(){return yield o._originValidation(e),function Vke(r){Qr().location.href=r}(yield qJ(e,t,n,G9(),i)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(B3(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){var t=this;return M(function*(){const n=yield function Vxe(r){return Vk.apply(this,arguments)}(e),i=new Sxe(e);return n.register("authEvent",o=>(Ve(o?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=n,i})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send($k,{type:$k},i=>{var o;const s=null===(o=i?.[0])||void 0===o?void 0:o[$k];void 0!==s&&t(!!s),Do(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function wxe(r){return Hk.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return cJ()||eI()||X_()}};var YJ="@firebase/auth";class Jxe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var t=this;return M(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const rLe=Eq("authIdTokenMaxAge")||300;let XJ=null;const iLe=r=>function(){var e=M(function*(t){const n=t&&(yield t.getIdTokenResult()),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>rLe)return;const o=n?.token;XJ!==o&&(XJ=o,yield fetch(r,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))});return function(t){return e.apply(this,arguments)}}();function oLe(r=aT()){const e=X8(r,"auth");if(e.isInitialized())return e.getImmediate();const t=function GIe(r,e){const t=X8(r,"auth");if(t.isInitialized()){const i=t.getImmediate();if(rm(t.getOptions(),e??{}))return i;Do(i,"already-initialized")}return t.initialize({options:e})}(r,{popupRedirectResolver:Qxe,persistence:[Zke,Rke,IJ]}),n=Eq("authTokenSyncURL");if(n){const o=iLe(n);(function Oke(r,e,t){mr(r).beforeAuthStateChanged(e,t)})(t,o,()=>o(t.currentUser)),function Tke(r,e,t,n){mr(r).onIdTokenChanged(e,t,n)}(t,s=>o(s))}const i=yq("auth");return i&&_J(t,`http://${i}`),t}!function tLe(r){so(new Ni("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=n.options;Ve(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:a,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lJ(r)},l=new BIe(n,i,o,c);return function UIe(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(W3);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),so(new Ni("auth-internal",e=>{const t=x2(e.getProvider("auth").getImmediate());return new Jxe(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),_r(YJ,"0.23.2",function eLe(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(r)),_r(YJ,"0.23.2","esm2017")}("Browser");class uv{constructor(e){return e}}class JJ{constructor(){return hA("auth")}}const Gk=new tt("angularfire2.auth-instances");function aLe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new uv(n)}}const cLe={provide:JJ,deps:[[new to,Gk]]},lLe={provide:uv,useFactory:function sLe(r,e){const t=dA("auth",r,e);return t&&new uv(t)},deps:[[new to,Gk],V5]};let uLe=(()=>{class r{constructor(){_r("angularfire",V_.full,"auth")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({providers:[lLe,cLe]}),r})();const hLe=V1(pke,!0),pLe=V1(oLe,!0),gLe=V1(bke,!0),mLe=V1(_ke,!0),_Le=V1(dke,!0),vLe=V1(gke,!0),CLe=V1(pxe,!0),yLe=V1(Cke,!0);class dl{constructor(e){return e}}const Uk=new tt("angularfire2.firestore-instances");function SLe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new dl(n)}}const PLe={provide:class MLe{constructor(){return hA("firestore")}},deps:[[new to,Uk]]},TLe={provide:dl,useFactory:function ELe(r,e){const t=dA("firestore",r,e);return t&&new dl(t)},deps:[[new to,Uk],V5]};let OLe=(()=>{class r{constructor(){_r("angularfire",V_.full,"fst")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({providers:[TLe,PLe]}),r})();const wLe=V1(UOe,!0),NLe=V1(COe,!0),ILe=V1(GOe,!0),td=V1(ZK,!0),kLe=V1(VOe,!0),xLe=V1(FOe,!0),LLe=V1(EOe,!0),RLe=V1(ROe,!0),tee=V1(WOe,!0),zLe=V1(LOe,!0),fv=V1(kOe,!0),DLe=V1($Oe,!0),HLe=V1(BOe,!0),VLe=V1(xOe,!0);class f0{constructor(e,t){u(this,"collectionName",void 0),u(this,"firestore",void 0),u(this,"collection",void 0),u(this,"subDAOs",{}),this.collectionName=e,this.firestore=t;this.collection=NLe(t,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var t=this;return M(function*(){return(yield wLe(t.collection,e)).id})()}read(e){var t=this;return M(function*(){const n=yield kLe(td(t.collection,e));return n.exists()?g.of(q.getNonNullable(n.data())):g.empty()})()}exists(e){var t=this;return M(function*(){return(yield t.read(e)).isPresent()})()}update(e,t){var n=this;return M(function*(){return HLe(td(n.collection,e),t)})()}delete(e){return ILe(td(this.collection,e))}set(e,t){return DLe(td(this.collection,e),t)}subscribeToChanges(e,t){return new Sn(tee(td(this.collection,e),n=>{t(g.ofNullable(n.data()))}))}findWhere(e,t,n){var i=this;return M(function*(){const o=i.constructQuery(e,t,n);return(yield xLe(o)).docs.map(a=>({id:a.id,data:a.data()}))})()}observingWhere(e,t,n){const i=this.constructQuery(e,n);return new Sn(tee(i,o=>{const s=[],a=[],c=[];o.docChanges().forEach(l=>{const f={id:l.doc.id,data:l.doc.data()};switch(l.type){case"added":s.push(f);break;case"modified":a.push(f);break;case"removed":c.push(f)}}),s.length>0&&(Ae.display("FirestoreDAO","subscription","firebase gave us "+s.length+" NEW "+this.collectionName),t.onDocumentCreated(s)),a.length>0&&(Ae.display("FirestoreDAO","subscription","firebase gave us "+a.length+" MODIFIED "+this.collectionName),t.onDocumentModified(a)),c.length>0&&(Ae.display("FirestoreDAO","subscription","firebase gave us "+c.length+" DELETED "+this.collectionName),t.onDocumentDeleted(c))}))}constructQuery(e,t,n){let i=fv(this.collection);null!=t&&(i=fv(i,zLe(t))),null!=n&&(i=fv(i,RLe(n)));for(const o of e)i=fv(i,VLe(o[0],o[1],o[2]));return i}subCollectionDAO(e,t){const n=`${this.collection.path}/${e}/${t}`;if(n in this.subDAOs)return this.subDAOs[n];{const i=new class extends f0{constructor(o){super(n,o)}}(this.firestore);return this.subDAOs[n]=i,i}}}let FLe=(()=>{var r;class e extends f0{constructor(n){super("errors",n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(dl))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var $Le=Ss(1);let Ut=(()=>{var r;class e{infoMessage(n){this.message(n,"is-info")}gameMessage(n){this.message(n,"is-warning")}criticalMessage(n){this.message(n,"is-danger")}message(n,i){const o=this.getDuration(n);this.toast(n,i,o)}toast(n,i,o){(0,$Le.toast)({message:n,duration:o,type:i,position:"top-center",closeOnClick:!0,dismissible:!0})}getDuration(n){const i=n.split(" ").length;return Math.max(60*i*1e3/150,3e3)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var dv,d0;class u2{static setSingletonInstance(e){u2.singleton=g.of(e)}static logErrorAndFail(e,t,n){throw u2.logError(e,t,n),new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`)}static logError(e,t,n){if(this.singleton.isAbsent())throw new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`);return this.singleton.get().logError(e,t,n),b.failure(e+": "+t)}constructor(e,t,n){u(this,"errorDAO",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),this.errorDAO=e,this.router=t,this.messageDisplayer=n,u2.setSingletonInstance(this)}findErrors(e,t,n,i){return this.errorDAO.findWhere(void 0===i?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",i]])}logError(e,t,n){var i=this;return M(function*(){i.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const o=i.router.url,s=yield i.findErrors(e,o,t,n);if(0===s.length){const a={component:e,route:o,message:t,firstEncounter:Ic(),lastEncounter:Ic(),occurences:1};null!=n&&(a.data=n),yield i.errorDAO.create(a)}else{const a=s[0].id,c=s[0].data;yield i.errorDAO.update(a,{lastEncounter:Ic(),occurences:c.occurences+1})}})()}}dv=u2,u(u2,"singleton",g.empty()),u(u2,"\u0275fac",function(e){return new(e||dv)(Pe(FLe),Pe(Gn),Pe(Ut))}),u(u2,"\u0275prov",He({token:dv,factory:dv.\u0275fac,providedIn:"root"}));class Ae{static enableLog(e,t,n){const i=localStorage.getItem("verbosity");let o={};null!=i&&(o=JSON.parse(i)),n?o[t+"."+n]=e:o[t]=e,localStorage.setItem("verbosity",JSON.stringify(o))}static isVerbose(e){const t=localStorage.getItem("verbosity");if(null==t)return[!1,!1];const n=JSON.parse(t);return null==n[e]?[!1,!1]:(q.assert(Array.isArray(n[e]),`malformed verbosity levels: ${n[e]}`),n[e])}static isMethodVerboseEntry(e,t){return Ae.isVerbose(e)[0]||Ae.isVerbose(e+"."+t)[0]}static isMethodVerboseExit(e,t){return Ae.isVerbose(e)[1]||Ae.isVerbose(e+"."+t)[1]}static display(e,t,n){Ae.isMethodVerboseEntry(e,t)&&console.log(`${e}.${t}: ${n}`)}static log(e){const t=e.name;for(const n of Object.getOwnPropertyNames(e.prototype)){const i=Object.getOwnPropertyDescriptor(e.prototype,n),o=q.getNonNullable(i);q.assert(o.value instanceof Function,"cannot add logging to properties that are not methods!");const a=o.value;o.value=function(...c){if(Ae.isMethodVerboseEntry(t,n)){const f=Array.from(c).map(d=>JSON.stringify(d)).join(", ");console.log(`> ${t}.${n}(${f})`)}const l=a.apply(this,c);return Ae.isMethodVerboseExit(t,n)&&console.log(`< ${t}.${n} -> ${JSON.stringify(l)}`),l},Object.defineProperty(e.prototype,n,o)}}}window.enableLog=Ae.enableLog;class q{static expectToBe(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error(`A default switch case did not observe the correct value, expected ${t}, but got ${e} instead.`)}static expectToBeMultiple(e,t){let n=!1;for(const i of t)if(e===i){n=!0;break}if(!1===n)throw new Error(`A default switch case did not observe the correct value, expected a value among ${t}, but got ${e} instead.`)}static getNonNullable(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}static assert(e,t){if(!1===e)throw u2.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}static identity(e){return e}}let Wk=(u(d0=class extends f0{constructor(e){super("chats",e)}},"\u0275fac",function(e){return new(e||d0)(Pe(dl))}),u(d0,"\u0275prov",He({token:d0,factory:d0.\u0275fac,providedIn:"root"})),d0);var h0;Wk=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],Wk);let nee=(()=>{class r{}return u(r,"CANNOT_SEND_MESSAGE",()=>$localize`You're not allowed to send a message here.`),u(r,"FORBIDDEN_MESSAGE",()=>$localize`This message is forbidden.`),r})(),W5=(h0=class{constructor(e){u(this,"chatDAO",void 0),this.chatDAO=e}addMessage(e,t){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(e,"messages").create(t)})()}getLastMessages(e,t){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t)})()}subscribeToMessages(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}deleteChat(e){var t=this;return M(function*(){return t.chatDAO.delete(e)})()}createNewChat(e){var t=this;return M(function*(){return t.chatDAO.set(e,{})})()}sendMessage(e,t,n,i){var o=this;return M(function*(){if(!1===o.userCanSendMessage(t.name,e))return b.failure(nee.CANNOT_SEND_MESSAGE());if(o.isForbiddenMessage(n))return b.failure(nee.FORBIDDEN_MESSAGE());const s={content:n,sender:t,postedTime:Ic(),currentTurn:i};return yield o.addMessage(e,s),b.SUCCESS})()}userCanSendMessage(e,t){return""!==e}isForbiddenMessage(e){return""===e}},u(h0,"\u0275fac",function(e){return new(e||h0)(Pe(Wk))}),u(h0,"\u0275prov",He({token:h0,factory:h0.\u0275fac,providedIn:"root"})),h0);function Fe(r,e,t){if(!1===r)throw void 0!==t&&console.log(t),u2.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}var j3,qk;W5=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],W5);let nd=(qk=j3=class extends f0{constructor(e){super(qk.COLLECTION_NAME,e)}},u(j3,"COLLECTION_NAME","users"),u(j3,"\u0275fac",function(e){return new(e||j3)(Pe(dl))}),u(j3,"\u0275prov",He({token:j3,factory:j3.\u0275fac,providedIn:"root"})),j3);nd=qk=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],nd);let q5=(()=>{var r;class e{constructor(n){u(this,"userDAO",void 0),this.userDAO=n}usernameIsAvailable(n){var i=this;return M(function*(){return 0===(yield i.userDAO.findWhere([["username","==",n]])).length})()}setUsername(n,i){var o=this;return M(function*(){yield o.userDAO.update(n,{username:i})})()}markAsVerified(n){var i=this;return M(function*(){yield i.userDAO.update(n,{verified:!0})})()}observeUserOnServer(n,i){return this.userDAO.subscribeToChanges(n,o=>{o.isPresent()&&null===o.get().lastUpdateTime||i(o)})}getUserLastUpdateTime(n){var i=this;return M(function*(){const o=yield i.userDAO.read(n);if(o.isAbsent())return g.empty();{const s=o.get().lastUpdateTime;return Fe(null!=s,"should not receive a lastUpdateTime equal to null"),g.of(s)}})()}updatePresenceToken(n){return this.userDAO.update(n,{lastUpdateTime:Ic()})}getServerTime(n){var i=this;return M(function*(){return new Promise(o=>{let s=!1;const c=i.userDAO.subscribeToChanges(n,l=>{null==l.get().lastUpdateTime?s=!0:s&&(c.unsubscribe(),o(l.get().lastUpdateTime))});i.updatePresenceToken(n)})})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(nd))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();class ree extends So{constructor(e=1/0,t=1/0,n=iA){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(n.push(e),!i&&n.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=n?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<n.length&&n.splice(0,n.length-o),!i){const s=t.now();let a=0;for(let c=1;c<n.length&&n[c]<=s;c+=2)a=c;a&&n.splice(0,a+1)}}}var p0;let rd=(()=>{class r{}return u(r,"YOU_ARE_ALREADY_PLAYING",()=>$localize`You are already playing in another game.`),u(r,"YOU_ARE_ALREADY_CREATING",()=>$localize`You are already the creator of another game.`),u(r,"YOU_ARE_ALREADY_CHOSEN_OPPONENT",()=>$localize`You are already the chosen opponent in another game.`),u(r,"YOU_ARE_ALREADY_CANDIDATE",()=>$localize`You are already candidate in another game.`),u(r,"YOU_ARE_ALREADY_OBSERVING",()=>$localize`You are already observing another game.`),r})();class hl{static createUserWithEmailAndPassword(e,t,n){return hLe(e,t,n)}static sendEmailVerification(e){return mLe(e)}static sendPasswordResetEmail(e,t){return _Le(e,t)}static signInWithEmailAndPassword(e,t,n){return M(function*(){return(yield vLe(e,t,n)).user})()}static signInWithPopup(e,t){return M(function*(){return(yield CLe(e,t)).user})()}static updateProfile(e,t){return yLe(e,t)}}class g0{constructor(e,t,n,i){u(this,"id",void 0),u(this,"email",void 0),u(this,"username",void 0),u(this,"verified",void 0),this.id=e,this.email=t,this.username=n,this.verified=i}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(e){return this.id===e.id&&this.email.equals(e.email)&&this.username.equals(e.username)&&this.verified===e.verified}}u(g0,"NOT_CONNECTED",new g0("",g.empty(),g.empty(),!1));let ar=(p0=class{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"auth",void 0),u(this,"authSubscription",void 0),u(this,"user",g.empty()),u(this,"userRS",void 0),u(this,"userObs",void 0),u(this,"userSubscription",new Sn),this.userDAO=e,this.userService=t,this.auth=n,this.userRS=new ree(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new Sn(gLe(this.auth,function(){var o=M(function*(s){null==s?(Ae.display("ConnectedUserService","subscription","User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(g0.NOT_CONNECTED),i.user=g.empty()):(Fe(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(s.uid,a=>{if(a.isPresent()){const c=a.get(),l=c.username;Ae.display("ConnectedUserService","subscription",`User ${l} is connected, and the verified status is ${i.emailVerified(s)}`);const f=!0===i.emailVerified(s)&&null!=l;if(!0===f&&!1===c.verified)return i.userService.markAsVerified(s.uid);const d=new g0(s.uid,g.ofNullable(s.email),g.ofNullable(l),f);!1===i.user.equalsValue(d)&&(i.user=g.of(d),i.userRS.next(d))}}))});return function(s){return o.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var t=this;return M(function*(){try{return yield hl.sendPasswordResetEmail(t.auth,e),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}doRegister(e,t,n){var i=this;return M(function*(){return(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,t,n):ie.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,t,n){var i=this;return M(function*(){try{const o=yield hl.createUserWithEmailAndPassword(i.auth,t,n);yield hl.signInWithEmailAndPassword(i.auth,t,n);const s=q.getNonNullable(o.user);return yield i.createUser(s.uid,e),ie.success(s)}catch(o){return ie.failure(i.mapFirebaseError(o))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return u2.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return M(function*(){const t=g.ofNullable(e.auth.currentUser);if(!t.isPresent())return u2.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(t.get()))return u2.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield hl.sendEmailVerification(t.get()),b.SUCCESS}catch(n){return b.failure(e.mapFirebaseError(n))}})()}doEmailLogin(e,t){var n=this;return M(function*(){try{return yield hl.signInWithEmailAndPassword(n.auth,e,t),b.SUCCESS}catch(i){return b.failure(n.mapFirebaseError(i))}})()}createUser(e,t){var n=this;return M(function*(){null==t?yield n.userDAO.set(e,{verified:!1,currentGame:null}):yield n.userDAO.set(e,{username:t,verified:!1,currentGame:null})})()}doGoogleLogin(){var e=this;return M(function*(){return b.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return M(function*(){try{const t=new ske;t.addScope("profile"),t.addScope("email");const n=yield hl.signInWithPopup(e.auth,t);return!1===(yield e.userDAO.exists(n.uid))&&(yield e.createUser(n.uid)),ie.success(n)}catch(t){return ie.failure(e.mapFirebaseError(t))}})()}disconnect(){var e=this;return M(function*(){return g.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),b.SUCCESS):b.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var t=this;return M(function*(){if(""===e)return b.failure($localize`Your username may not be empty.`);try{if(!1===(yield t.userService.usernameIsAvailable(e)))return b.failure($localize`This username is already in use, please select a different one.`);const i=q.getNonNullable(t.auth.currentUser);return yield hl.updateProfile(i,{displayName:e}),yield t.userService.setUsername(i.uid,e),yield t.userService.markAsVerified(i.uid),yield t.reloadUser(),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}setPicture(e){var t=this;return M(function*(){try{const n=q.getNonNullable(t.auth.currentUser);return yield hl.updateProfile(n,{photoURL:e}),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}reloadUser(){var e=this;return M(function*(){const t=q.getNonNullable(e.auth.currentUser);yield t.getIdToken(!0),yield t.reload()})()}sendPresenceToken(){return Fe(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}},u(p0,"\u0275fac",function(e){return new(e||p0)(Pe(nd),Pe(q5),Pe(uv))}),u(p0,"\u0275prov",He({token:p0,factory:p0.\u0275fac,providedIn:"root"})),p0);var Z3,pv,gv,id,j5,K,m0;ar=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],ar);class k1{constructor(e){u(this,"value",void 0),this.value=e}}u(k1,"HARD_DRAW",new(Z3=k1)(0)),u(k1,"RESIGN",new Z3(1)),u(k1,"ESCAPE",new Z3(2)),u(k1,"VICTORY",new Z3(3)),u(k1,"TIMEOUT",new Z3(4)),u(k1,"UNACHIEVED",new Z3(5)),u(k1,"AGREED_DRAW_BY_ZERO",new Z3(6)),u(k1,"AGREED_DRAW_BY_ONE",new Z3(7));class hv{constructor(e,t){u(this,"id",void 0),u(this,"data",void 0),this.id=e,this.data=t}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===k1.HARD_DRAW.value}isAgreedDraw(){return this.data.result===k1.AGREED_DRAW_BY_ZERO.value||this.data.result===k1.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===k1.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(Fe(this.data.result===k1.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),q.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===k1.VICTORY.value}isTimeout(){return this.data.result===k1.TIMEOUT.value}isResign(){return this.data.result===k1.RESIGN.value}getWinner(){return g.ofNullable(this.data.winner)}getLoser(){return g.ofNullable(this.data.loser)}setWinnerAndLoser(e,t){return new hv(this.id,{...this.data,winner:e,loser:t})}}class L2{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"CREATOR":return L2.CREATOR;case"RANDOM":return L2.RANDOM;default:return Fe("CHOSEN_PLAYER"===e,"Invalid value for FirstPlayer: "+e+"."),L2.CHOSEN_PLAYER}}}u(L2,"CREATOR",new(pv=L2)("CREATOR")),u(L2,"RANDOM",new pv("RANDOM")),u(L2,"CHOSEN_PLAYER",new pv("CHOSEN_PLAYER"));class cr{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"STANDARD":return cr.STANDARD;case"BLITZ":return cr.BLITZ;case"CUSTOM":return cr.CUSTOM;default:throw new Error("Invalid part type: "+e+".")}}}u(cr,"STANDARD",new(gv=cr)("STANDARD")),u(cr,"BLITZ",new gv("BLITZ")),u(cr,"CUSTOM",new gv("CUSTOM")),u(cr,"NORMAL_MOVE_DURATION",120),u(cr,"NORMAL_PART_DURATION",1800),u(cr,"BLITZ_MOVE_DURATION",30),u(cr,"BLITZ_PART_DURATION",900);class ci{constructor(e){u(this,"value",void 0),this.value=e}}u(ci,"PART_CREATED",new(id=ci)(0)),u(ci,"CONFIG_PROPOSED",new id(2)),u(ci,"PART_STARTED",new id(3)),u(ci,"PART_FINISHED",new id(4));class jk{constructor(){u(this,"value",2)}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(e){return this===e}}u(jk,"NONE",new jk);class I{static of(e){return 0===e?I.ZERO:(q.expectToBe(e,1),I.ONE)}static ofTurn(e){return e%2==0?I.ZERO:I.ONE}constructor(e){u(this,"value",void 0),this.value=e}isPlayer(){return!0}toString(){return this===I.ZERO?"PLAYER_ZERO":(q.expectToBe(this,I.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(e){return this===e}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===I.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===I.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===I.ZERO?I.ONE:(q.expectToBe(this,I.ONE),I.ZERO)}}j5=I,u(I,"encoder",we.tuple([we.identity()],r=>[r.value],r=>j5.of(r[0]))),u(I,"ZERO",new j5(0)),u(I,"ONE",new j5(1)),u(I,"PLAYERS",[j5.ZERO,j5.ONE]),function(r){r.ZERO=I.ZERO,r.ONE=I.ONE,r.NONE=jk.NONE,r.encoder=new class extends we{encode(e){return e.value}decode(e){return 2===e?r.NONE:(q.assert(0===e||1===e,"Invalid encoded player: "+e),I.of(e))}}}(K||(K={}));let od=(u(m0=class extends f0{constructor(e){super("parts",e)}},"\u0275fac",function(e){return new(e||m0)(Pe(dl))}),u(m0,"\u0275prov",He({token:m0,factory:m0.\u0275fac,providedIn:"root"})),m0);od=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],od);class mv{constructor(e,t,n){u(this,"onDocumentCreated",void 0),u(this,"onDocumentModified",void 0),u(this,"onDocumentDeleted",void 0),this.onDocumentCreated=e,this.onDocumentModified=t,this.onDocumentDeleted=n}}let Zk=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}eventsCollection(n){return this.partDAO.subCollectionDAO(n,"events")}addEvent(n,i){return this.eventsCollection(n).create(i)}addMove(n,i,o){return this.addEvent(n,{eventType:"Move",time:Ic(),player:i.value,move:o})}addRequest(n,i,o){return this.addEvent(n,{eventType:"Request",time:Ic(),player:i.value,requestType:o})}addReply(n,i,o,s,a=null){return this.addEvent(n,{eventType:"Reply",time:Ic(),player:i.value,reply:o,requestType:s,data:a})}startGame(n,i){return this.addAction(n,i,"StartGame")}addAction(n,i,o){return this.addEvent(n,{eventType:"Action",time:Ic(),player:i.value,action:o})}subscribeToEvents(n,i){const o=new mv(s=>{const a=s.map(c=>c.data).filter(c=>null!=c.time);a.length>0&&i(a)},s=>{i(s.map(a=>a.data))},()=>{});return this.eventsCollection(n).observingWhere([],o,"time")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(od))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var _0;let Yk=(u(_0=class extends f0{constructor(e){super("config-room",e)}},"\u0275fac",function(e){return new(e||_0)(Pe(dl))}),u(_0,"\u0275prov",He({token:_0,factory:_0.\u0275fac,providedIn:"root"})),_0);var Y3,Kk;Yk=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],Yk);let sd=(Y3=class{constructor(e,t){u(this,"configRoomDAO",void 0),u(this,"connectedUserService",void 0),this.configRoomDAO=e,this.connectedUserService=t}addCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}removeCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}subscribeToChanges(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}subscribeToCandidates(e,t){let n=[];const i=new mv(s=>{for(const a of s)n.push(a.data);t(n)},s=>{for(const a of s)n=n.map(c=>c.id===a.data.id?a.data:c);t(n)},s=>{for(const a of s)n=n.filter(c=>c.id!==a.data.id);t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser();return t.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:L2.RANDOM.value,partType:cr.STANDARD.value,partStatus:ci.PART_CREATED.value,maximalMoveDuration:cr.NORMAL_MOVE_DURATION,totalPartDuration:cr.NORMAL_PART_DURATION,creator:n})})()}joinGame(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);return i.isAbsent()?b.failure(Kk.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==n.id&&(yield t.addCandidate(e,n)),b.SUCCESS)})()}cancelJoining(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);if(!i.isAbsent()){const o=i.get(),s=[t.removeCandidate(e,n)];o.chosenOpponent?.id===n.id&&s.push(t.configRoomDAO.update(e,{chosenOpponent:null,partStatus:ci.PART_CREATED.value})),yield Promise.all(s)}})()}deleteConfigRoom(e,t){var n=this;return M(function*(){yield Promise.all(t.map(i=>n.removeCandidate(e,i))),yield n.configRoomDAO.delete(e)})()}proposeConfig(e,t,n,i,o,s){var a=this;return M(function*(){return a.configRoomDAO.update(e,{partStatus:ci.CONFIG_PROPOSED.value,chosenOpponent:t,partType:n.value,maximalMoveDuration:i,totalPartDuration:s,firstPlayer:o.value})})()}setChosenOpponent(e,t){return this.configRoomDAO.update(e,{chosenOpponent:t})}reviewConfig(e){var t=this;return M(function*(){return t.configRoomDAO.update(e,{partStatus:ci.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var t=this;return M(function*(){return t.configRoomDAO.update(e,{partStatus:ci.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return this.configRoomDAO.update(e,{partStatus:ci.PART_STARTED.value})}createConfigRoom(e,t){var n=this;return M(function*(){return n.configRoomDAO.set(e,t)})()}readConfigRoomById(e){var t=this;return M(function*(){return(yield t.configRoomDAO.read(e)).get()})()}},Kk=Y3,u(Y3,"GAME_DOES_NOT_EXIST",()=>$localize`Game does not exist`),u(Y3,"\u0275fac",function(e){return new(e||Y3)(Pe(Yk),Pe(ar))}),u(Y3,"\u0275prov",He({token:Y3,factory:Y3.\u0275fac,providedIn:"root"})),Y3);var v0;sd=Kk=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],sd);let Z5=(v0=class{constructor(e,t,n,i,o){u(this,"partDAO",void 0),u(this,"gameEventService",void 0),u(this,"connectedUserService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),this.partDAO=e,this.gameEventService=t,this.connectedUserService=n,this.configRoomService=i,this.chatService=o}update(e,t){var n=this;return M(function*(){return n.partDAO.update(e,t)})()}getPartValidity(e,t){var n=this;return M(function*(){const i=yield n.partDAO.read(e);return i.isAbsent()?b.failure("NONEXISTENT_PART"):i.get().typeGame===t?b.SUCCESS:b.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){const t=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({typeGame:e,playerZero:t,turn:-1,result:k1.UNACHIEVED.value})}createChat(e){return this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var t=this;return M(function*(){const n=yield t.createUnstartedPart(e);return yield t.configRoomService.createInitialConfigRoom(n),yield t.createChat(n),n})()}getStartingConfig(e){let n,i,t=L2.of(e.firstPlayer);return t===L2.RANDOM&&(t=Math.random()<.5?L2.CREATOR:L2.CHOSEN_PLAYER),t===L2.CREATOR?(n=e.creator,i=q.getNonNullable(e.chosenOpponent)):(n=q.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:n,playerOne:i,turn:0,beginning:Ic()}}deletePart(e){return this.partDAO.delete(e)}acceptConfig(e,t){var n=this;return M(function*(){yield n.configRoomService.acceptConfig(e);const i=n.getStartingConfig(t);let o;o=i.playerZero===t.creator?I.ONE:I.ZERO,yield n.partDAO.update(e,i),yield n.gameEventService.startGame(e,o)})()}getPart(e){return this.partDAO.read(e)}subscribeToChanges(e,t){return this.partDAO.subscribeToChanges(e,t)}resign(e,t,n,i){var o=this;return M(function*(){const s={winner:n,loser:i,result:k1.RESIGN.value};yield o.partDAO.update(e,s),yield o.gameEventService.addAction(e,t,"EndGame")})()}notifyTimeout(e,t,n,i){var o=this;return M(function*(){const s={winner:n,loser:i,result:k1.TIMEOUT.value};yield o.partDAO.update(e,s),yield o.gameEventService.addAction(e,t,"EndGame")})()}proposeDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"Draw")})()}acceptDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Accept","Draw");const o={result:(t===I.ZERO?k1.AGREED_DRAW_BY_ZERO:k1.AGREED_DRAW_BY_ONE).value};yield n.partDAO.update(e,o),yield n.gameEventService.addAction(e,t,"EndGame")})()}refuseDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","Draw")})()}proposeRematch(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"Rematch")})()}rejectRematch(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","Rematch")})()}acceptRematch(e,t){var n=this;return M(function*(){const i=q.getNonNullable(e.data),o=yield n.configRoomService.readConfigRoomById(e.id);let s;const a=n.connectedUserService.user.get().toMinimalUser();let c;i.playerZero.id===a.id?(c=q.getNonNullable(i.playerOne),s=L2.CHOSEN_PLAYER):(c=i.playerZero,s=L2.CREATOR);const l={...o,firstPlayer:s.value,creator:a,chosenOpponent:c,partStatus:ci.PART_STARTED.value},f=n.getStartingConfig(l),d={typeGame:i.typeGame,result:k1.UNACHIEVED.value,...f},m=yield n.partDAO.create(d);yield n.configRoomService.createConfigRoom(m,l),yield n.createChat(m),yield n.gameEventService.addReply(e.id,t,"Accept","Rematch",m),yield n.gameEventService.startGame(m,t.getOpponent())})()}askTakeBack(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"TakeBack")})()}acceptTakeBack(e,t,n){var i=this;return M(function*(){let o=t-1;o%2===n.value&&o--;const s={turn:o};return yield i.gameEventService.addReply(e,n,"Accept","TakeBack"),yield i.partDAO.update(e,s)})()}refuseTakeBack(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","TakeBack")})()}addGlobalTime(e,t){var n=this;return M(function*(){yield n.gameEventService.addAction(e,t,"AddGlobalTime")})()}addTurnTime(e,t){var n=this;return M(function*(){yield n.gameEventService.addAction(e,t,"AddTurnTime")})()}preparePartUpdate(e,t){var n=this;return M(function*(){let s={turn:(yield n.partDAO.read(e)).get().turn+1};return s=n.updateScore(s,t),s})()}updatePart(e,t){var n=this;return M(function*(){const i=yield n.preparePartUpdate(e,t);yield n.update(e,i)})()}drawPart(e,t,n){var i=this;return M(function*(){let o=yield i.preparePartUpdate(e,n);o={...o,result:k1.HARD_DRAW.value},yield i.update(e,o),yield i.gameEventService.addAction(e,t,"EndGame")})()}endPartWithVictory(e,t,n,i,o){var s=this;return M(function*(){let a=yield s.preparePartUpdate(e,o);a={...a,winner:n,loser:i,result:k1.VICTORY.value},yield s.update(e,a),yield s.gameEventService.addAction(e,t,"EndGame")})()}addMove(e,t,n){var i=this;return M(function*(){yield i.gameEventService.addMove(e,t,n)})()}updateScore(e,t){return t.isPresent()?{...e,scorePlayerZero:t.get()[0],scorePlayerOne:t.get()[1]}:e}},u(v0,"\u0275fac",function(e){return new(e||v0)(Pe(od),Pe(Zk),Pe(ar),Pe(sd),Pe(W5))}),u(v0,"\u0275prov",He({token:v0,factory:v0.\u0275fac,providedIn:"root"})),v0);Z5=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],Z5);var Nee={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},Ree={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},zee={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class ad{static getNavigatorLanguage(){return navigator.language}static getLocale(){const n=(localStorage.getItem("locale")??ad.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(i=>i===n)?n:"fr"}}let $ee=(()=>{var r;class e{changeTheme(n){localStorage.setItem("theme",n)}getTheme(){return g.ofNullable(localStorage.getItem("theme"))}changeLanguage(n){localStorage.setItem("locale",n.toLowerCase())}getLanguage(){return ad.getLocale()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),_v=(()=>{var r;class e{constructor(n,i){u(this,"document",void 0),u(this,"userSettingsService",void 0),u(this,"theme",void 0),u(this,"availableThemes",["dark","light"]),this.document=n,this.userSettingsService=i;const o=this.getStoredTheme();o.isPresent()?this.loadTheme(o.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const n=this.userSettingsService.getTheme();if(n.isPresent()){const i=n.get();if(this.availableThemes.some(o=>o===i))return g.of(i)}return g.empty()}loadTheme(n){this.loadStyle(n+".css"),this.theme=n}loadStyle(n){const i=this.document.getElementsByTagName("head")[0],o=this.document.getElementById("theme");if(null!=o)o.href=n;else{const s=this.document.createElement("link");s.id="theme",s.rel="stylesheet",s.href=`${n}`,i.appendChild(s)}}getTheme(){return this.theme}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(T2),Pe($ee))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function Bee(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ct(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Bee(Object(t),!0).forEach(function(n){f2(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Bee(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function vv(r){return(vv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function Gee(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function f2(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Qk(r,e){return function VGe(r){if(Array.isArray(r))return r}(r)||function $Ge(r,e){var t=null==r?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var s,a,n=[],i=!0,o=!1;try{for(t=t.call(r);!(i=(s=t.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(c){o=!0,a=c}finally{try{!i&&null!=t.return&&t.return()}finally{if(o)throw a}}return n}}(r,e)||Uee(r,e)||function GGe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ld(r){return function HGe(r){if(Array.isArray(r))return Jk(r)}(r)||function FGe(r){if(typeof Symbol<"u"&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||Uee(r)||function BGe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uee(r,e){if(r){if("string"==typeof r)return Jk(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if("Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Jk(r,e)}}function Jk(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var Wee=function(){},ex={},qee={},jee=null,Zee={mark:Wee,measure:Wee};try{typeof window<"u"&&(ex=window),typeof document<"u"&&(qee=document),typeof MutationObserver<"u"&&(jee=MutationObserver),typeof performance<"u"&&(Zee=performance)}catch{}var Mv,Ev,Sv,Pv,Tv,Yee=(ex.navigator||{}).userAgent,Kee=void 0===Yee?"":Yee,pl=ex,F1=qee,Xee=jee,yv=Zee,K3=!!F1.documentElement&&!!F1.head&&"function"==typeof F1.addEventListener&&"function"==typeof F1.createElement,Qee=~Kee.indexOf("MSIE")||~Kee.indexOf("Trident/"),X3="___FONT_AWESOME___",Jee="fa",ete="svg-inline--fa",C0="data-fa-i2svg",nx="data-fa-pseudo-element",WGe="data-fa-pseudo-element-pending",rx="data-prefix",ix="data-icon",tte="fontawesome-i2svg",qGe="async",jGe=["HTML","HEAD","STYLE","SCRIPT"],nte=function(){try{return!0}catch{return!1}}(),$1="classic",Er="sharp",ox=[$1,Er];function ud(r){return new Proxy(r,{get:function(t,n){return n in t?t[n]:t[$1]}})}var fd=ud((f2(Mv={},$1,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),f2(Mv,Er,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light"}),Mv)),dd=ud((f2(Ev={},$1,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),f2(Ev,Er,{solid:"fass",regular:"fasr",light:"fasl"}),Ev)),hd=ud((f2(Sv={},$1,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),f2(Sv,Er,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light"}),Sv)),ZGe=ud((f2(Pv={},$1,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),f2(Pv,Er,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl"}),Pv)),YGe=/fa(s|r|l|t|d|b|k|ss|sr|sl)?[\-\ ]/,rte="fa-layers-text",KGe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,XGe=ud((f2(Tv={},$1,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),f2(Tv,Er,{900:"fass",400:"fasr",300:"fasl"}),Tv)),ite=[1,2,3,4,5,6,7,8,9,10],QGe=ite.concat([11,12,13,14,15,16,17,18,19,20]),JGe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],y0={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},pd=new Set;Object.keys(dd[$1]).map(pd.add.bind(pd)),Object.keys(dd[Er]).map(pd.add.bind(pd));var eUe=[].concat(ox,ld(pd),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",y0.GROUP,y0.SWAP_OPACITY,y0.PRIMARY,y0.SECONDARY]).concat(ite.map(function(r){return"".concat(r,"x")})).concat(QGe.map(function(r){return"w-".concat(r)})),gd=pl.FontAwesomeConfig||{};F1&&"function"==typeof F1.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(r){var e=Qk(r,2),n=e[1],i=function nUe(r){return""===r||"false"!==r&&("true"===r||r)}(function tUe(r){var e=F1.querySelector("script["+r+"]");if(e)return e.getAttribute(r)}(e[0]));null!=i&&(gd[n]=i)});var ote={styleDefault:"solid",familyDefault:"classic",cssPrefix:Jee,replacementClass:ete,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};gd.familyPrefix&&(gd.cssPrefix=gd.familyPrefix);var Y5=ct(ct({},ote),gd);Y5.autoReplaceSvg||(Y5.observeMutations=!1);var _t={};Object.keys(ote).forEach(function(r){Object.defineProperty(_t,r,{enumerable:!0,set:function(t){Y5[r]=t,md.forEach(function(n){return n(_t)})},get:function(){return Y5[r]}})}),Object.defineProperty(_t,"familyPrefix",{enumerable:!0,set:function(e){Y5.cssPrefix=e,md.forEach(function(t){return t(_t)})},get:function(){return Y5.cssPrefix}}),pl.FontAwesomeConfig=_t;var md=[],Rc={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1},sUe="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function _d(){for(var r=12,e="";r-- >0;)e+=sUe[62*Math.random()|0];return e}function K5(r){for(var e=[],t=(r||[]).length>>>0;t--;)e[t]=r[t];return e}function sx(r){return r.classList?K5(r.classList):(r.getAttribute("class")||"").split(" ").filter(function(e){return e})}function ste(r){return"".concat(r).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ov(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(r[t].trim(),";")},"")}function ax(r){return r.size!==Rc.size||r.x!==Rc.x||r.y!==Rc.y||r.rotate!==Rc.rotate||r.flipX||r.flipY}var uUe=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    -webkit-transition-delay: 0s;\n            transition-delay: 0s;\n    -webkit-transition-duration: 0s;\n            transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';function ate(){var r=Jee,e=ete,t=_t.cssPrefix,n=_t.replacementClass,i=uUe;if(t!==r||n!==e){var o=new RegExp("\\.".concat(r,"\\-"),"g"),s=new RegExp("\\--".concat(r,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");i=i.replace(o,".".concat(t,"-")).replace(s,"--".concat(t,"-")).replace(a,".".concat(n))}return i}var cte=!1;function cx(){_t.autoAddCss&&!cte&&(function oUe(r){if(r&&K3){var e=F1.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=r;for(var t=F1.head.childNodes,n=null,i=t.length-1;i>-1;i--){var o=t[i],s=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(s)>-1&&(n=o)}F1.head.insertBefore(e,n)}}(ate()),cte=!0)}var fUe={mixout:function(){return{dom:{css:ate,insertCss:cx}}},hooks:function(){return{beforeDOMElementCreation:function(){cx()},beforeI2svg:function(){cx()}}}},Q3=pl||{};Q3[X3]||(Q3[X3]={}),Q3[X3].styles||(Q3[X3].styles={}),Q3[X3].hooks||(Q3[X3].hooks={}),Q3[X3].shims||(Q3[X3].shims=[]);var Pa=Q3[X3],lte=[],bv=!1;function vd(r){var e=r.tag,t=r.attributes,n=void 0===t?{}:t,i=r.children,o=void 0===i?[]:i;return"string"==typeof r?ste(r):"<".concat(e," ").concat(function aUe(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,'="').concat(ste(r[t]),'" ')},"").trim()}(n),">").concat(o.map(vd).join(""),"</").concat(e,">")}function ute(r,e,t){if(r&&r[e]&&r[e][t])return{prefix:e,iconName:t,icon:r[e][t]}}K3&&((bv=(F1.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(F1.readyState))||F1.addEventListener("DOMContentLoaded",function r(){F1.removeEventListener("DOMContentLoaded",r),bv=1,lte.map(function(e){return e()})}));var lx=function(e,t,n,i){var c,l,f,o=Object.keys(e),s=o.length,a=void 0!==i?function(e,t){return function(n,i,o,s){return e.call(t,n,i,o,s)}}(t,i):t;for(void 0===n?(c=1,f=e[o[0]]):(c=0,f=n);c<s;c++)f=a(f,e[l=o[c]],l,e);return f};function ux(r){var e=function gUe(r){for(var e=[],t=0,n=r.length;t<n;){var i=r.charCodeAt(t++);if(i>=55296&&i<=56319&&t<n){var o=r.charCodeAt(t++);56320==(64512&o)?e.push(((1023&i)<<10)+(1023&o)+65536):(e.push(i),t--)}else e.push(i)}return e}(r);return 1===e.length?e[0].toString(16):null}function fte(r){return Object.keys(r).reduce(function(e,t){var n=r[t];return n.icon?e[n.iconName]=n.icon:e[t]=n,e},{})}function fx(r,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipHooks,i=void 0!==n&&n,o=fte(e);"function"!=typeof Pa.hooks.addPack||i?Pa.styles[r]=ct(ct({},Pa.styles[r]||{}),o):Pa.hooks.addPack(r,fte(e)),"fas"===r&&fx("fa",e)}var wv,Nv,Av,X5=Pa.styles,_Ue=Pa.shims,vUe=(f2(wv={},$1,Object.values(hd[$1])),f2(wv,Er,Object.values(hd[Er])),wv),dx=null,dte={},hte={},pte={},gte={},mte={},CUe=(f2(Nv={},$1,Object.keys(fd[$1])),f2(Nv,Er,Object.keys(fd[Er])),Nv);var _te=function(){var e=function(o){return lx(X5,function(s,a,c){return s[c]=lx(a,o,{}),s},{})};dte=e(function(i,o,s){return o[3]&&(i[o[3]]=s),o[2]&&o[2].filter(function(c){return"number"==typeof c}).forEach(function(c){i[c.toString(16)]=s}),i}),hte=e(function(i,o,s){return i[s]=s,o[2]&&o[2].filter(function(c){return"string"==typeof c}).forEach(function(c){i[c]=s}),i}),mte=e(function(i,o,s){var a=o[2];return i[s]=s,a.forEach(function(c){i[c]=s}),i});var t="far"in X5||_t.autoFetchSvg,n=lx(_Ue,function(i,o){var s=o[0],a=o[1],c=o[2];return"far"===a&&!t&&(a="fas"),"string"==typeof s&&(i.names[s]={prefix:a,iconName:c}),"number"==typeof s&&(i.unicodes[s.toString(16)]={prefix:a,iconName:c}),i},{names:{},unicodes:{}});pte=n.names,gte=n.unicodes,dx=Iv(_t.styleDefault,{family:_t.familyDefault})};function hx(r,e){return(dte[r]||{})[e]}function M0(r,e){return(mte[r]||{})[e]}function vte(r){return pte[r]||{prefix:null,iconName:null}}function ml(){return dx}(function iUe(r){md.push(r)})(function(r){dx=Iv(r.styleDefault,{family:_t.familyDefault})}),_te();var px=function(){return{prefix:null,iconName:null,rest:[]}};function Iv(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).family,n=void 0===t?$1:t;return dd[n][r]||dd[n][fd[n][r]]||(r in Pa.styles?r:null)||null}var Cte=(f2(Av={},$1,Object.keys(hd[$1])),f2(Av,Er,Object.keys(hd[Er])),Av);function kv(r){var e,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).skipLookups,i=void 0!==n&&n,o=(f2(e={},$1,"".concat(_t.cssPrefix,"-").concat($1)),f2(e,Er,"".concat(_t.cssPrefix,"-").concat(Er)),e),s=null,a=$1;(r.includes(o[$1])||r.some(function(l){return Cte[$1].includes(l)}))&&(a=$1),(r.includes(o[Er])||r.some(function(l){return Cte[Er].includes(l)}))&&(a=Er);var c=r.reduce(function(l,f){var d=function MUe(r,e){var t=e.split("-"),n=t[0],i=t.slice(1).join("-");return n!==r||""===i||function yUe(r){return~eUe.indexOf(r)}(i)?null:i}(_t.cssPrefix,f);if(X5[f]?(f=vUe[a].includes(f)?ZGe[a][f]:f,s=f,l.prefix=f):CUe[a].indexOf(f)>-1?(s=f,l.prefix=Iv(f,{family:a})):d?l.iconName=d:f!==_t.replacementClass&&f!==o[$1]&&f!==o[Er]&&l.rest.push(f),!i&&l.prefix&&l.iconName){var m="fa"===s?vte(l.iconName):{},E=M0(l.prefix,l.iconName);m.prefix&&(s=null),l.iconName=m.iconName||E||l.iconName,l.prefix=m.prefix||l.prefix,"far"===l.prefix&&!X5.far&&X5.fas&&!_t.autoFetchSvg&&(l.prefix="fas")}return l},px());return(r.includes("fa-brands")||r.includes("fab"))&&(c.prefix="fab"),(r.includes("fa-duotone")||r.includes("fad"))&&(c.prefix="fad"),!c.prefix&&a===Er&&(X5.fass||_t.autoFetchSvg)&&(c.prefix="fass",c.iconName=M0(c.prefix,c.iconName)||c.iconName),("fa"===c.prefix||"fa"===s)&&(c.prefix=ml()||"fas"),c}var PUe=function(){function r(){(function RGe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")})(this,r),this.definitions={}}return function zGe(r,e,t){e&&Gee(r.prototype,e),t&&Gee(r,t),Object.defineProperty(r,"prototype",{writable:!1})}(r,[{key:"add",value:function(){for(var t=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var s=i.reduce(this._pullDefinitions,{});Object.keys(s).forEach(function(a){t.definitions[a]=ct(ct({},t.definitions[a]||{}),s[a]),fx(a,s[a]);var c=hd[$1][a];c&&fx(c,s[a]),_te()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,n){var i=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(i).map(function(o){var s=i[o],a=s.prefix,c=s.iconName,l=s.icon,f=l[2];t[a]||(t[a]={}),f.length>0&&f.forEach(function(d){"string"==typeof d&&(t[a][d]=l)}),t[a][c]=l}),t}}]),r}(),yte=[],Q5={},J5={},TUe=Object.keys(J5);function gx(r,e){for(var t=arguments.length,n=new Array(t>2?t-2:0),i=2;i<t;i++)n[i-2]=arguments[i];return(Q5[r]||[]).forEach(function(s){e=s.apply(null,[e].concat(n))}),e}function E0(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];(Q5[r]||[]).forEach(function(o){o.apply(null,t)})}function J3(){var r=arguments[0],e=Array.prototype.slice.call(arguments,1);return J5[r]?J5[r].apply(null,e):void 0}function mx(r){"fa"===r.prefix&&(r.prefix="fas");var e=r.iconName,t=r.prefix||ml();if(e)return e=M0(t,e)||e,ute(Mte.definitions,t,e)||ute(Pa.styles,t,e)}var Mte=new PUe,wUe={i2svg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return K3?(E0("beforeI2svg",e),J3("pseudoElements2svg",e),J3("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot;!1===_t.autoReplaceSvg&&(_t.autoReplaceSvg=!0),_t.observeMutations=!0,function hUe(r){K3&&(bv?setTimeout(r,0):lte.push(r))}(function(){AUe({autoReplaceSvgRoot:t}),E0("watch",e)})}},us={noAuto:function(){_t.autoReplaceSvg=!1,_t.observeMutations=!1,E0("noAuto")},config:_t,dom:wUe,parse:{icon:function(e){if(null===e)return null;if("object"===vv(e)&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:M0(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){var t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],n=Iv(e[0]);return{prefix:n,iconName:M0(n,t)||t}}if("string"==typeof e&&(e.indexOf("".concat(_t.cssPrefix,"-"))>-1||e.match(YGe))){var i=kv(e.split(" "),{skipLookups:!0});return{prefix:i.prefix||ml(),iconName:M0(i.prefix,i.iconName)||i.iconName}}if("string"==typeof e){var o=ml();return{prefix:o,iconName:M0(o,e)||e}}}},library:Mte,findIconDefinition:mx,toHtml:vd},AUe=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).autoReplaceSvgRoot,n=void 0===t?F1:t;(Object.keys(Pa.styles).length>0||_t.autoFetchSvg)&&K3&&_t.autoReplaceSvg&&us.dom.i2svg({node:n})};function xv(r,e){return Object.defineProperty(r,"abstract",{get:e}),Object.defineProperty(r,"html",{get:function(){return r.abstract.map(function(n){return vd(n)})}}),Object.defineProperty(r,"node",{get:function(){if(K3){var n=F1.createElement("div");return n.innerHTML=r.html,n.children}}}),r}function _x(r){var e=r.icons,t=e.main,n=e.mask,i=r.prefix,o=r.iconName,s=r.transform,a=r.symbol,c=r.title,l=r.maskId,f=r.titleId,d=r.extra,m=r.watchable,E=void 0!==m&&m,w=n.found?n:t,L=w.width,z=w.height,$="fak"===i,B=[_t.replacementClass,o?"".concat(_t.cssPrefix,"-").concat(o):""].filter(function(Et){return-1===d.classes.indexOf(Et)}).filter(function(Et){return""!==Et||!!Et}).concat(d.classes).join(" "),de={children:[],attributes:ct(ct({},d.attributes),{},{"data-prefix":i,"data-icon":o,class:B,role:d.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(L," ").concat(z)})},_e=$&&!~d.classes.indexOf("fa-fw")?{width:"".concat(L/z*16*.0625,"em")}:{};E&&(de.attributes[C0]=""),c&&(de.children.push({tag:"title",attributes:{id:de.attributes["aria-labelledby"]||"title-".concat(f||_d())},children:[c]}),delete de.attributes.title);var xe=ct(ct({},de),{},{prefix:i,iconName:o,main:t,mask:n,maskId:l,transform:s,symbol:a,styles:ct(ct({},_e),d.styles)}),nt=n.found&&t.found?J3("generateAbstractMask",xe)||{children:[],attributes:{}}:J3("generateAbstractIcon",xe)||{children:[],attributes:{}},Mn=nt.attributes;return xe.children=nt.children,xe.attributes=Mn,a?function kUe(r){var t=r.iconName,n=r.children,i=r.attributes,o=r.symbol,s=!0===o?"".concat(r.prefix,"-").concat(_t.cssPrefix,"-").concat(t):o;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:ct(ct({},i),{},{id:s}),children:n}]}]}(xe):function IUe(r){var e=r.children,t=r.main,n=r.mask,i=r.attributes,o=r.styles,s=r.transform;if(ax(s)&&t.found&&!n.found){var l={x:t.width/t.height/2,y:.5};i.style=Ov(ct(ct({},o),{},{"transform-origin":"".concat(l.x+s.x/16,"em ").concat(l.y+s.y/16,"em")}))}return[{tag:"svg",attributes:i,children:e}]}(xe)}function Ete(r){var e=r.content,t=r.width,n=r.height,i=r.transform,o=r.title,s=r.extra,a=r.watchable,c=void 0!==a&&a,l=ct(ct(ct({},s.attributes),o?{title:o}:{}),{},{class:s.classes.join(" ")});c&&(l[C0]="");var f=ct({},s.styles);ax(i)&&(f.transform=function lUe(r){var e=r.transform,t=r.width,i=r.height,o=void 0===i?16:i,s=r.startCentered,a=void 0!==s&&s,c="";return c+=a&&Qee?"translate(".concat(e.x/16-(void 0===t?16:t)/2,"em, ").concat(e.y/16-o/2,"em) "):a?"translate(calc(-50% + ".concat(e.x/16,"em), calc(-50% + ").concat(e.y/16,"em)) "):"translate(".concat(e.x/16,"em, ").concat(e.y/16,"em) "),(c+="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "))+"rotate(".concat(e.rotate,"deg) ")}({transform:i,startCentered:!0,width:t,height:n}),f["-webkit-transform"]=f.transform);var d=Ov(f);d.length>0&&(l.style=d);var m=[];return m.push({tag:"span",attributes:l,children:[e]}),o&&m.push({tag:"span",attributes:{class:"sr-only"},children:[o]}),m}var vx=Pa.styles;function Cx(r){var e=r[0],t=r[1],o=Qk(r.slice(4),1)[0];return{found:!0,width:e,height:t,icon:Array.isArray(o)?{tag:"g",attributes:{class:"".concat(_t.cssPrefix,"-").concat(y0.GROUP)},children:[{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(y0.SECONDARY),fill:"currentColor",d:o[0]}},{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(y0.PRIMARY),fill:"currentColor",d:o[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:o}}}}var LUe={found:!1,width:512,height:512};function yx(r,e){var t=e;return"fa"===e&&null!==_t.styleDefault&&(e=ml()),new Promise(function(n,i){if(J3("missingIconAbstract"),"fa"===t){var s=vte(r)||{};r=s.iconName||r,e=s.prefix||e}if(r&&e&&vx[e]&&vx[e][r])return n(Cx(vx[e][r]));(function RUe(r,e){!nte&&!_t.showMissingIcons&&r&&console.error('Icon with name "'.concat(r,'" and prefix "').concat(e,'" is missing.'))})(r,e),n(ct(ct({},LUe),{},{icon:_t.showMissingIcons&&r&&J3("missingIconAbstract")||{}}))})}var Ste=function(){},Mx=_t.measurePerformance&&yv&&yv.mark&&yv.measure?yv:{mark:Ste,measure:Ste},Cd='FA "6.4.2"',Pte=function(e){Mx.mark("".concat(Cd," ").concat(e," ends")),Mx.measure("".concat(Cd," ").concat(e),"".concat(Cd," ").concat(e," begins"),"".concat(Cd," ").concat(e," ends"))},Ex={begin:function(e){return Mx.mark("".concat(Cd," ").concat(e," begins")),function(){return Pte(e)}},end:Pte},Lv=function(){};function Tte(r){return"string"==typeof(r.getAttribute?r.getAttribute(C0):null)}function FUe(r){return F1.createElementNS("http://www.w3.org/2000/svg",r)}function $Ue(r){return F1.createElement(r)}function Ote(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ceFn,n=void 0===t?"svg"===r.tag?FUe:$Ue:t;if("string"==typeof r)return F1.createTextNode(r);var i=n(r.tag);return Object.keys(r.attributes||[]).forEach(function(s){i.setAttribute(s,r.attributes[s])}),(r.children||[]).forEach(function(s){i.appendChild(Ote(s,{ceFn:n}))}),i}var Rv={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(i){t.parentNode.insertBefore(Ote(i),t)}),null===t.getAttribute(C0)&&_t.keepOriginalSource){var n=F1.createComment(function BUe(r){var e=" ".concat(r.outerHTML," ");return"".concat(e,"Font Awesome fontawesome.com ")}(t));t.parentNode.replaceChild(n,t)}else t.remove()},nest:function(e){var t=e[0],n=e[1];if(~sx(t).indexOf(_t.replacementClass))return Rv.replace(e);var i=new RegExp("".concat(_t.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){var o=n[0].attributes.class.split(" ").reduce(function(a,c){return c===_t.replacementClass||c.match(i)?a.toSvg.push(c):a.toNode.push(c),a},{toNode:[],toSvg:[]});n[0].attributes.class=o.toSvg.join(" "),0===o.toNode.length?t.removeAttribute("class"):t.setAttribute("class",o.toNode.join(" "))}var s=n.map(function(a){return vd(a)}).join("\n");t.setAttribute(C0,""),t.innerHTML=s}};function bte(r){r()}function wte(r,e){var t="function"==typeof e?e:Lv;if(0===r.length)t();else{var n=bte;_t.mutateApproach===qGe&&(n=pl.requestAnimationFrame||bte),n(function(){var i=function VUe(){return!0===_t.autoReplaceSvg?Rv.replace:Rv[_t.autoReplaceSvg]||Rv.replace}(),o=Ex.begin("mutate");r.map(i),o(),t()})}}var Sx=!1;function Nte(){Sx=!0}function Px(){Sx=!1}var zv=null;function Ate(r){if(Xee&&_t.observeMutations){var e=r.treeCallback,t=void 0===e?Lv:e,n=r.nodeCallback,i=void 0===n?Lv:n,o=r.pseudoElementsCallback,s=void 0===o?Lv:o,a=r.observeMutationsRoot,c=void 0===a?F1:a;zv=new Xee(function(l){if(!Sx){var f=ml();K5(l).forEach(function(d){if("childList"===d.type&&d.addedNodes.length>0&&!Tte(d.addedNodes[0])&&(_t.searchPseudoElements&&s(d.target),t(d.target)),"attributes"===d.type&&d.target.parentNode&&_t.searchPseudoElements&&s(d.target.parentNode),"attributes"===d.type&&Tte(d.target)&&~JGe.indexOf(d.attributeName))if("class"===d.attributeName&&function DUe(r){var e=r.getAttribute?r.getAttribute(rx):null,t=r.getAttribute?r.getAttribute(ix):null;return e&&t}(d.target)){var m=kv(sx(d.target)),w=m.iconName;d.target.setAttribute(rx,m.prefix||f),w&&d.target.setAttribute(ix,w)}else(function HUe(r){return r&&r.classList&&r.classList.contains&&r.classList.contains(_t.replacementClass)})(d.target)&&i(d.target)})}}),K3&&zv.observe(c,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function Ite(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},t=function WUe(r){var e=r.getAttribute("data-prefix"),t=r.getAttribute("data-icon"),n=void 0!==r.innerText?r.innerText.trim():"",i=kv(sx(r));return i.prefix||(i.prefix=ml()),e&&t&&(i.prefix=e,i.iconName=t),i.iconName&&i.prefix||(i.prefix&&n.length>0&&(i.iconName=function EUe(r,e){return(hte[r]||{})[e]}(i.prefix,r.innerText)||hx(i.prefix,ux(r.innerText))),!i.iconName&&_t.autoFetchSvg&&r.firstChild&&r.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=r.firstChild.data)),i}(r),n=t.iconName,i=t.prefix,o=t.rest,s=function qUe(r){var e=K5(r.attributes).reduce(function(i,o){return"class"!==i.name&&"style"!==i.name&&(i[o.name]=o.value),i},{}),t=r.getAttribute("title"),n=r.getAttribute("data-fa-title-id");return _t.autoA11y&&(t?e["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(n||_d()):(e["aria-hidden"]="true",e.focusable="false")),e}(r),a=gx("parseNodeAttributes",{},r),c=e.styleParser?function UUe(r){var e=r.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(n,i){var o=i.split(":"),s=o[0],a=o.slice(1);return s&&a.length>0&&(n[s]=a.join(":").trim()),n},{})),t}(r):[];return ct({iconName:n,title:r.getAttribute("title"),titleId:r.getAttribute("data-fa-title-id"),prefix:i,transform:Rc,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:o,styles:c,attributes:s}},a)}var ZUe=Pa.styles;function kte(r){var e="nest"===_t.autoReplaceSvg?Ite(r,{styleParser:!1}):Ite(r);return~e.extra.classes.indexOf(rte)?J3("generateLayersText",r,e):J3("generateSvgReplacementMutation",r,e)}var _l=new Set;function xte(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!K3)return Promise.resolve();var t=F1.documentElement.classList,n=function(d){return t.add("".concat(tte,"-").concat(d))},i=function(d){return t.remove("".concat(tte,"-").concat(d))},o=_t.autoFetchSvg?_l:ox.map(function(f){return"fa-".concat(f)}).concat(Object.keys(ZUe));o.includes("fa")||o.push("fa");var s=[".".concat(rte,":not([").concat(C0,"])")].concat(o.map(function(f){return".".concat(f,":not([").concat(C0,"])")})).join(", ");if(0===s.length)return Promise.resolve();var a=[];try{a=K5(r.querySelectorAll(s))}catch{}if(!(a.length>0))return Promise.resolve();n("pending"),i("complete");var c=Ex.begin("onTree"),l=a.reduce(function(f,d){try{var m=kte(d);m&&f.push(m)}catch(E){nte||"MissingIcon"===E.name&&console.error(E)}return f},[]);return new Promise(function(f,d){Promise.all(l).then(function(m){wte(m,function(){n("active"),n("complete"),i("pending"),"function"==typeof e&&e(),c(),f()})}).catch(function(m){c(),d(m)})})}function YUe(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;kte(r).then(function(t){t&&wte([t],e)})}function KUe(r){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e||{}).icon?e:mx(e||{}),i=t.mask;return i&&(i=(i||{}).icon?i:mx(i||{})),r(n,ct(ct({},t),{},{mask:i}))}}ox.map(function(r){_l.add("fa-".concat(r))}),Object.keys(fd[$1]).map(_l.add.bind(_l)),Object.keys(fd[Er]).map(_l.add.bind(_l)),_l=ld(_l);var XUe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,i=void 0===n?Rc:n,o=t.symbol,s=void 0!==o&&o,a=t.mask,c=void 0===a?null:a,l=t.maskId,f=void 0===l?null:l,d=t.title,m=void 0===d?null:d,E=t.titleId,w=void 0===E?null:E,L=t.classes,z=void 0===L?[]:L,$=t.attributes,B=void 0===$?{}:$,de=t.styles,_e=void 0===de?{}:de;if(e){var xe=e.prefix,nt=e.iconName,gt=e.icon;return xv(ct({type:"icon"},e),function(){return E0("beforeDOMElementCreation",{iconDefinition:e,params:t}),_t.autoA11y&&(m?B["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(w||_d()):(B["aria-hidden"]="true",B.focusable="false")),_x({icons:{main:Cx(gt),mask:c?Cx(c.icon):{found:!1,width:null,height:null,icon:{}}},prefix:xe,iconName:nt,transform:ct(ct({},Rc),i),symbol:s,title:m,maskId:f,titleId:w,extra:{attributes:B,styles:_e,classes:z}})})}},QUe={mixout:function(){return{icon:KUe(XUe)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=xte,t.nodeCallback=YUe,t}}},provides:function(e){e.i2svg=function(t){var n=t.node,o=t.callback;return xte(void 0===n?F1:n,void 0===o?function(){}:o)},e.generateSvgReplacementMutation=function(t,n){var i=n.iconName,o=n.title,s=n.titleId,a=n.prefix,c=n.transform,l=n.symbol,f=n.mask,d=n.maskId,m=n.extra;return new Promise(function(E,w){Promise.all([yx(i,a),f.iconName?yx(f.iconName,f.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(L){var z=Qk(L,2);E([t,_x({icons:{main:z[0],mask:z[1]},prefix:a,iconName:i,transform:c,symbol:l,maskId:d,title:o,titleId:s,extra:m,watchable:!0})])}).catch(w)})},e.generateAbstractIcon=function(t){var l,n=t.children,i=t.attributes,o=t.main,s=t.transform,c=Ov(t.styles);return c.length>0&&(i.style=c),ax(s)&&(l=J3("generateAbstractTransformGrouping",{main:o,transform:s,containerWidth:o.width,iconWidth:o.width})),n.push(l||o.icon),{children:n,attributes:i}}}},JUe={mixout:function(){return{layer:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.classes,o=void 0===i?[]:i;return xv({type:"layer"},function(){E0("beforeDOMElementCreation",{assembler:t,params:n});var s=[];return t(function(a){Array.isArray(a)?a.map(function(c){s=s.concat(c.abstract)}):s=s.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(_t.cssPrefix,"-layers")].concat(ld(o)).join(" ")},children:s}]})}}}},eWe={mixout:function(){return{counter:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.title,o=void 0===i?null:i,s=n.classes,a=void 0===s?[]:s,c=n.attributes,l=void 0===c?{}:c,f=n.styles,d=void 0===f?{}:f;return xv({type:"counter",content:t},function(){return E0("beforeDOMElementCreation",{content:t,params:n}),function xUe(r){var e=r.content,t=r.title,n=r.extra,i=ct(ct(ct({},n.attributes),t?{title:t}:{}),{},{class:n.classes.join(" ")}),o=Ov(n.styles);o.length>0&&(i.style=o);var s=[];return s.push({tag:"span",attributes:i,children:[e]}),t&&s.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),s}({content:t.toString(),title:o,extra:{attributes:l,styles:d,classes:["".concat(_t.cssPrefix,"-layers-counter")].concat(ld(a))}})})}}}},tWe={mixout:function(){return{text:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.transform,o=void 0===i?Rc:i,s=n.title,a=void 0===s?null:s,c=n.classes,l=void 0===c?[]:c,f=n.attributes,d=void 0===f?{}:f,m=n.styles,E=void 0===m?{}:m;return xv({type:"text",content:t},function(){return E0("beforeDOMElementCreation",{content:t,params:n}),Ete({content:t,transform:ct(ct({},Rc),o),title:a,extra:{attributes:d,styles:E,classes:["".concat(_t.cssPrefix,"-layers-text")].concat(ld(l))}})})}}},provides:function(e){e.generateLayersText=function(t,n){var i=n.title,o=n.transform,s=n.extra,a=null,c=null;if(Qee){var l=parseInt(getComputedStyle(t).fontSize,10),f=t.getBoundingClientRect();a=f.width/l,c=f.height/l}return _t.autoA11y&&!i&&(s.attributes["aria-hidden"]="true"),Promise.resolve([t,Ete({content:t.innerHTML,width:a,height:c,transform:o,title:i,extra:s,watchable:!0})])}}},nWe=new RegExp('"',"ug"),Lte=[1105920,1112319];function Rte(r,e){var t="".concat(WGe).concat(e.replace(":","-"));return new Promise(function(n,i){if(null!==r.getAttribute(t))return n();var s=K5(r.children).filter(function(gt){return gt.getAttribute(nx)===e})[0],a=pl.getComputedStyle(r,e),c=a.getPropertyValue("font-family").match(KGe),l=a.getPropertyValue("font-weight"),f=a.getPropertyValue("content");if(s&&!c)return r.removeChild(s),n();if(c&&"none"!==f&&""!==f){var d=a.getPropertyValue("content"),m=~["Sharp"].indexOf(c[2])?Er:$1,E=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(c[2])?dd[m][c[2].toLowerCase()]:XGe[m][l],w=function rWe(r){var e=r.replace(nWe,""),t=function mUe(r,e){var i,t=r.length,n=r.charCodeAt(e);return n>=55296&&n<=56319&&t>e+1&&(i=r.charCodeAt(e+1))>=56320&&i<=57343?1024*(n-55296)+i-56320+65536:n}(e,0),n=t>=Lte[0]&&t<=Lte[1],i=2===e.length&&e[0]===e[1];return{value:ux(i?e[0]:e),isSecondary:n||i}}(d),L=w.value,z=w.isSecondary,$=c[0].startsWith("FontAwesome"),B=hx(E,L),de=B;if($){var _e=function SUe(r){var e=gte[r],t=hx("fas",r);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}(L);_e.iconName&&_e.prefix&&(B=_e.iconName,E=_e.prefix)}if(!B||z||s&&s.getAttribute(rx)===E&&s.getAttribute(ix)===de)n();else{r.setAttribute(t,de),s&&r.removeChild(s);var xe=function jUe(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Rc,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),nt=xe.extra;nt.attributes[nx]=e,yx(B,E).then(function(gt){var Mn=_x(ct(ct({},xe),{},{icons:{main:gt,mask:px()},prefix:E,iconName:de,extra:nt,watchable:!0})),Et=F1.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===e?r.insertBefore(Et,r.firstChild):r.appendChild(Et),Et.outerHTML=Mn.map(function(q2){return vd(q2)}).join("\n"),r.removeAttribute(t),n()}).catch(i)}}else n()})}function iWe(r){return Promise.all([Rte(r,"::before"),Rte(r,"::after")])}function oWe(r){return!(r.parentNode===document.head||~jGe.indexOf(r.tagName.toUpperCase())||r.getAttribute(nx)||r.parentNode&&"svg"===r.parentNode.tagName)}function zte(r){if(K3)return new Promise(function(e,t){var n=K5(r.querySelectorAll("*")).filter(oWe).map(iWe),i=Ex.begin("searchPseudoElements");Nte(),Promise.all(n).then(function(){i(),Px(),e()}).catch(function(){i(),Px(),t()})})}var Dte=!1,Hte=function(e){return e.toLowerCase().split(" ").reduce(function(n,i){var o=i.toLowerCase().split("-"),s=o[0],a=o.slice(1).join("-");if(s&&"h"===a)return n.flipX=!0,n;if(s&&"v"===a)return n.flipY=!0,n;if(a=parseFloat(a),isNaN(a))return n;switch(s){case"grow":n.size=n.size+a;break;case"shrink":n.size=n.size-a;break;case"left":n.x=n.x-a;break;case"right":n.x=n.x+a;break;case"up":n.y=n.y-a;break;case"down":n.y=n.y+a;break;case"rotate":n.rotate=n.rotate+a}return n},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},Tx={x:0,y:0,width:"100%",height:"100%"};function Vte(r){return r.attributes&&(r.attributes.fill||!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(r.attributes.fill="black"),r}function lWe(r){return"g"===r.tag?r.children:[r]}var uWe={hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-mask"),o=i?kv(i.split(" ").map(function(s){return s.trim()})):px();return o.prefix||(o.prefix=ml()),t.mask=o,t.maskId=n.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var n=t.children,i=t.attributes,o=t.main,s=t.mask,a=t.maskId,f=o.icon,m=s.icon,E=function cUe(r){var e=r.transform,n=r.iconWidth,i={transform:"translate(".concat(r.containerWidth/2," 256)")},o="translate(".concat(32*e.x,", ").concat(32*e.y,") "),s="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(o," ").concat(s," ").concat(a)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}({transform:t.transform,containerWidth:s.width,iconWidth:o.width}),w={tag:"rect",attributes:ct(ct({},Tx),{},{fill:"white"})},L=f.children?{children:f.children.map(Vte)}:{},z={tag:"g",attributes:ct({},E.inner),children:[Vte(ct({tag:f.tag,attributes:ct(ct({},f.attributes),E.path)},L))]},$={tag:"g",attributes:ct({},E.outer),children:[z]},B="mask-".concat(a||_d()),de="clip-".concat(a||_d()),_e={tag:"mask",attributes:ct(ct({},Tx),{},{id:B,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[w,$]},xe={tag:"defs",children:[{tag:"clipPath",attributes:{id:de},children:lWe(m)},_e]};return n.push(xe,{tag:"rect",attributes:ct({fill:"currentColor","clip-path":"url(#".concat(de,")"),mask:"url(#".concat(B,")")},Tx)}),{children:n,attributes:i}}}};!function OUe(r,e){var t=e.mixoutsTo;yte=r,Q5={},Object.keys(J5).forEach(function(n){-1===TUe.indexOf(n)&&delete J5[n]}),yte.forEach(function(n){var i=n.mixout?n.mixout():{};if(Object.keys(i).forEach(function(s){"function"==typeof i[s]&&(t[s]=i[s]),"object"===vv(i[s])&&Object.keys(i[s]).forEach(function(a){t[s]||(t[s]={}),t[s][a]=i[s][a]})}),n.hooks){var o=n.hooks();Object.keys(o).forEach(function(s){Q5[s]||(Q5[s]=[]),Q5[s].push(o[s])})}n.provides&&n.provides(J5)})}([fUe,QUe,JUe,eWe,tWe,{hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=zte,t}}},provides:function(e){e.pseudoElements2svg=function(t){var n=t.node;_t.searchPseudoElements&&zte(void 0===n?F1:n)}}},{mixout:function(){return{dom:{unwatch:function(){Nte(),Dte=!0}}}},hooks:function(){return{bootstrap:function(){Ate(gx("mutationObserverCallbacks",{}))},noAuto:function(){!function GUe(){zv&&zv.disconnect()}()},watch:function(t){var n=t.observeMutationsRoot;Dte?Px():Ate(gx("mutationObserverCallbacks",{observeMutationsRoot:n}))}}}},{mixout:function(){return{parse:{transform:function(t){return Hte(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-transform");return i&&(t.transform=Hte(i)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var n=t.main,i=t.transform,s=t.iconWidth,a={transform:"translate(".concat(t.containerWidth/2," 256)")},c="translate(".concat(32*i.x,", ").concat(32*i.y,") "),l="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),f="rotate(".concat(i.rotate," 0 0)"),E={outer:a,inner:{transform:"".concat(c," ").concat(l," ").concat(f)},path:{transform:"translate(".concat(s/2*-1," -256)")}};return{tag:"g",attributes:ct({},E.outer),children:[{tag:"g",attributes:ct({},E.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:ct(ct({},n.icon.attributes),E.path)}]}]}}}},uWe,{provides:function(e){var t=!1;pl.matchMedia&&(t=pl.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var n=[],i={fill:"currentColor"},o={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:ct(ct({},i),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var s=ct(ct({},o),{},{attributeName:"opacity"}),a={tag:"circle",attributes:ct(ct({},i),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:ct(ct({},o),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:ct(ct({},s),{},{values:"1;0;1;1;0;1;"})}),n.push(a),n.push({tag:"path",attributes:ct(ct({},i),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:ct(ct({},s),{},{values:"1;0;0;0;0;1;"})}]}),t||n.push({tag:"path",attributes:ct(ct({},i),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:ct(ct({},s),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},{hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-symbol");return t.symbol=null!==i&&(""===i||i),t}}}}],{mixoutsTo:us});var pWe=us.parse,gWe=us.icon;const mWe=["*"],CWe=r=>{const e={[`fa-${r.animation}`]:null!=r.animation&&!r.animation.startsWith("spin"),"fa-spin":"spin"===r.animation||"spin-reverse"===r.animation,"fa-spin-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-spin-reverse":"spin-reverse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-fw":r.fixedWidth,"fa-border":r.border,"fa-inverse":r.inverse,"fa-layers-counter":r.counter,"fa-flip-horizontal":"horizontal"===r.flip||"both"===r.flip,"fa-flip-vertical":"vertical"===r.flip||"both"===r.flip,[`fa-${r.size}`]:null!==r.size,[`fa-rotate-${r.rotate}`]:null!==r.rotate,[`fa-pull-${r.pull}`]:null!==r.pull,[`fa-stack-${r.stackItemSize}`]:null!=r.stackItemSize};return Object.keys(e).map(t=>e[t]?t:null).filter(t=>t)};let EWe=(()=>{var r;class e{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),SWe=(()=>{var r;class e{constructor(){this.definitions={}}addIcons(...n){for(const i of n){i.prefix in this.definitions||(this.definitions[i.prefix]={}),this.definitions[i.prefix][i.iconName]=i;for(const o of i.icon[2])"string"==typeof o&&(this.definitions[i.prefix][o]=i)}}addIconPacks(...n){for(const i of n){const o=Object.keys(i).map(s=>i[s]);this.addIcons(...o)}}getIconDefinition(n,i){return n in this.definitions&&i in this.definitions[n]?this.definitions[n][i]:null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=He({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),PWe=(()=>{var r;class e{constructor(){this.stackItemSize="1x"}ngOnChanges(n){if("size"in n)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[Xi]}),e})(),TWe=(()=>{var r;class e{constructor(n,i){this.renderer=n,this.elementRef=i}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(n){"size"in n&&(null!=n.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${n.size.currentValue}`),null!=n.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${n.size.previousValue}`))}}return(r=e).\u0275fac=function(n){return new(n||r)(G(lc),G(Pi))},r.\u0275cmp=je({type:r,selectors:[["fa-stack"]],inputs:{size:"size"},features:[Xi],ngContentSelectors:mWe,decls:1,vars:0,template:function(n,i){1&n&&(function AV(r){const e=Ee()[xr][Ei];if(!e.projection){const n=e.projection=o7(r?r.length:1,null),i=n.slice();let o=e.child;for(;null!==o;){const s=r?X5e(o,r):0;null!==s&&(i[s]?i[s].projectionNext=o:n[s]=o,i[s]=o),o=o.next}}}(),function IV(r,e=0,t){const n=Ee(),i=zn(),o=C8(i,mn+r,16,null,t||null);null===o.projection&&(o.projection=e),Hy(),(!n[u3]||Q0())&&32!=(32&o.flags)&&function i0e(r,e,t){FD(e[Zt],0,e,t,fM(r,t,e),LD(t.parent||e[Ei],t,e))}(i,n,o)}(0))},encapsulation:2}),e})(),S0=(()=>{var r;class e{set spin(n){this.animation=n?"spin":void 0}set pulse(n){this.animation=n?"spin-pulse":void 0}constructor(n,i,o,s,a){this.sanitizer=n,this.config=i,this.iconLibrary=o,this.stackItem=s,this.classes=[],null!=a&&null==s&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(n){if(null!=this.icon||null!=this.config.fallbackIcon){if(n){const o=this.findIconDefinition(null!=this.icon?this.icon:this.config.fallbackIcon);if(null!=o){const s=this.buildParams();this.renderIcon(o,s)}}}else(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})()}render(){this.ngOnChanges({})}findIconDefinition(n){const i=((r,e)=>(r=>void 0!==r.prefix&&void 0!==r.iconName)(r)?r:"string"==typeof r?{prefix:e,iconName:r}:{prefix:r[0],iconName:r[1]})(n,this.config.defaultPrefix);return"icon"in i?i:this.iconLibrary.getIconDefinition(i.prefix,i.iconName)??((r=>{throw new Error(`Could not find icon with iconName=${r.iconName} and prefix=${r.prefix} in the icon library.`)})(i),null)}buildParams(){const n={flip:this.flip,animation:this.animation,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},i="string"==typeof this.transform?pWe.transform(this.transform):this.transform;return{title:this.title,transform:i,classes:[...CWe(n),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(n,i){const o=gWe(n,i);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(o.html.join("\n"))}}return(r=e).\u0275fac=function(n){return new(n||r)(G(lG),G(EWe),G(SWe),G(PWe,8),G(TWe,8))},r.\u0275cmp=je({type:r,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(n,i){2&n&&(hE("innerHTML",i.renderedIconHTML,d7),k("title",i.title))},inputs:{icon:"icon",title:"title",animation:"animation",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[Xi],decls:0,vars:0,template:function(n,i){},encapsulation:2}),e})(),OWe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=yi({type:r}),r.\u0275inj=Y2({}),e})();var Nx={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},Bne={prefix:"fas",iconName:"flag",icon:[448,512,[127988,61725],"f024","M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"]},S1e={prefix:"fas",iconName:"repeat",icon:[512,512,[128257],"f363","M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"]},Ux={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"]},Nie={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"]},Qx={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"]},Vie={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},ose={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},pL={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},$se={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class gae{static toComparableObjectSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>i.equals(n))&&t.push(n)}),t}static toComparableSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>zs(i,n))&&t.push(n)}),t}}let mae;mae=Symbol.iterator;class dt{constructor(e){u(this,"values",void 0),this.values=void 0===e?[]:gae.toComparableSet(e)}equals(e){if(e.size()!==this.size())return!1;for(const t of this)if(!1===e.contains(t))return!1;return!0}toString(){let e="";for(const t of this)e+=null==t?"null, ":t.toString()+", ";return"["+e.slice(0,-2)+"]"}add(e){return!this.contains(e)&&(this.values.push(e),!0)}remove(e){for(let t=0;t<this.values.length;t++)if(zs(this.values[t],e))return this.values.splice(t,1),!0;return!1}addAll(e){for(const t of e)this.add(t)}union(e){const t=new dt(this.toList());return t.addAll(e),t}contains(e){for(const t of this.values)if(zs(t,e))return!0;return!1}size(){return this.values.length}toList(){const e=[];for(const t of this)e.push(t);return e}getAnyElement(){return this.size()>0?g.of(this.values[0]):g.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(e){const t=[];for(const n of this.values)t.push(e(n));return new dt(t)}flatMap(e){const t=new dt;for(const n of this)t.addAll(e(n));return t}filter(e){const t=new dt;for(const n of this)e(n)&&t.add(n);return t}findAnyCommonElement(e){for(const t of e)if(this.contains(t))return g.of(t);return g.empty()}intersection(e){const t=new dt;for(const n of e)this.contains(n)&&t.add(n);return t}[mae](){return this.values.values()}}class un{static from(e){const t=Object.keys(e),n=new un;for(const i of t)n.set(i,e[i]);return n}constructor(e=[],t=!1){u(this,"map",void 0),u(this,"isImmutable",void 0),this.map=e,this.isImmutable=t}makeImmutable(){this.isImmutable=!0}get(e){for(const t of this.map)if(zs(t.key,e))return g.of(t.value);return g.empty()}getAnyPair(){return this.size()>0?g.of(this.map[0]):g.empty()}forEach(e){for(const t of this.map)e(t)}putAll(e){this.checkImmutability("putAll");for(const t of e.map)this.put(t.key,t.value)}checkImmutability(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}put(e,t){this.checkImmutability("put");for(const n of this.map)if(zs(n.key,e)){const i=n.value;return n.value=t,g.of(i)}return this.map.push({key:e,value:t}),g.empty()}containsKey(e){return this.map.some(t=>zs(t.key,e))}size(){return this.map.length}listKeys(){return this.map.map(e=>e.key)}getKeySet(){return new dt(this.listKeys())}filter(e){const t=new un;for(const n of this.map)e(n.key,n.value)&&t.set(n.key,n.value);return t}replace(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}set(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}delete(e){this.checkImmutability("delete");for(let t=0;t<this.map.length;t++)if(zs(this.map[t].key,e)){const i=this.map[t].value,o=this.map.slice(0,t),s=this.map.slice(t+1);return this.map=o.concat(s),i}throw new Error('No Value to delete for key "'+e.toString()+'"!')}getCopy(){const e=new this.constructor;for(const t of this.listKeys())e.set(t,this.get(t).get());return e}equals(e){const t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;for(const i of t){const o=this.get(i).get(),s=e.get(i);if(Fe(s.isPresent(),"value is absent in a map even though its key is present!"),!1===zs(o,s.get()))return!1}return!0}}class eu extends un{reverse(){const e=new eu;for(const t of this.listKeys()){const n=this.get(t).get();if(e.containsKey(n))e.get(n).get().add(t);else{const i=new dt;i.add(t),e.set(n,i)}}return e}}var Jv;class uo{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"connectedUserService",void 0),u(this,"authSubscription",void 0),u(this,"userSubscription",new Sn),u(this,"currentGame",g.empty()),u(this,"currentGameRS",void 0),u(this,"currentGameObs",void 0),this.userDAO=e,this.userService=t,this.connectedUserService=n,this.currentGameRS=new ree(1),this.currentGameObs=this.currentGameRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(function(){var o=M(function*(s){yield i.onUserUpdate(s)});return function(s){return o.apply(this,arguments)}}())}onUserUpdate(e){var t=this;return M(function*(){if(e===g0.NOT_CONNECTED)t.userSubscription.unsubscribe(),t.currentGame=g.empty(),t.currentGameRS.next(g.empty());else{t.userSubscription=t.userService.observeUserOnServer(e.id,i=>{Fe(i.isPresent(),"Observing part service expected user to already have a document!");const o=i.get();t.onCurrentGameUpdate(o.currentGame)});const n=yield t.userDAO.read(e.id);t.currentGame=g.ofNullable(n.get().currentGame),t.currentGameRS.next(t.currentGame)}})()}onCurrentGameUpdate(e){const t=this.currentGame,n=null==e&&t.isAbsent(),i=null!=e&&t.equalsValue(e);!1===n&&!1===i&&(this.currentGame=g.ofNullable(e),this.currentGameRS.next(this.currentGame))}updateCurrentGame(e){if(Fe(this.connectedUserService.user.isPresent(),"Should not call updateCurrentGame when not connected"),this.currentGame.isPresent()){const n={...this.currentGame.get(),...e};return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:n})}{const n=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const i of n)Fe(null!=e[i],"field "+i+" should be set before updating currentGame");return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:e})}}removeCurrentGame(){return Fe(this.connectedUserService.user.isPresent(),"Should not call removeCurrentGame when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:null})}subscribeToCurrentGame(e){return this.currentGameObs.subscribe(e)}canUserCreate(){if(this.currentGame.isAbsent())return b.SUCCESS;{const e=uo.roleToMessage.get(this.currentGame.get().role).get()();return b.failure(e)}}canUserJoin(e,t){if(this.currentGame.isAbsent()||this.currentGame.get().id===e)return b.SUCCESS;if(t&&"Observer"===this.currentGame.get().role)return b.SUCCESS;{const n=uo.roleToMessage.get(this.currentGame.get().role).get()();return b.failure(n)}}getCurrentGame(){return new Promise(e=>{let t=new Sn;t=this.currentGameObs.subscribe(n=>{e(n),t.unsubscribe()})})}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function jut(r,e){if(1&r&&(Bt(0),se(1,31),Gt()),2&r){const t=p(2);_(1),Bn(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),jn(1)}}function Zut(r,e){if(1&r&&(Bt(0),se(1,33),Gt()),2&r){const t=p(3);_(1),Bn(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),jn(1)}}function Yut(r,e){if(1&r&&(Bt(0),se(1,34),Gt()),2&r){const t=p(3);_(1),Bn(t.currentGame.get().typeGame),jn(1)}}function Kut(r,e){if(1&r&&(T(0,Zut,2,2,"ng-container",27),T(1,Yut,2,1,"ng-template",null,32,dn)),2&r){const t=ln(2);y("ngIf",p(2).currentGame.get().opponent)("ngIfElse",t)}}function Xut(r,e){if(1&r){const t=pe();S(0,"a",29),U("click",function(){return te(t),ne(p().navigateToPart())}),T(1,jut,2,2,"ng-container",27),T(2,Kut,3,2,"ng-template",null,30,dn),P()}if(2&r){const t=ln(3),n=p();_(1),y("ngIf","Observer"===n.currentGame.get().role||"Candidate"===n.currentGame.get().role)("ngIfElse",t)}}function Qut(r,e){if(1&r&&(Bt(0),F(1,"fa-icon",35),Gt()),2&r){const t=p();_(1),y("icon",t.faSpinner)}}function Jut(r,e){if(1&r){const t=pe();Bt(0),S(1,"div",10)(2,"a",37),lt(3),P(),S(4,"div",13)(5,"a",38),se(6,39),P(),S(7,"a",40),U("click",function(){return te(t),ne(p(2).logout())}),se(8,41),P()()(),Gt()}if(2&r){const t=p(2);_(3),An(t.username.get())}}Jv=uo,u(uo,"roleToMessage",new un([{key:"Candidate",value:rd.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:rd.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:rd.YOU_ARE_ALREADY_CREATING},{key:"Player",value:rd.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:rd.YOU_ARE_ALREADY_OBSERVING}])),u(uo,"\u0275fac",function(e){return new(e||Jv)(Pe(nd),Pe(q5),Pe(ar))}),u(uo,"\u0275prov",He({token:Jv,factory:Jv.\u0275fac,providedIn:"root"}));const e7t=function(){return["/register"]},t7t=function(){return["/login"]};function n7t(r,e){1&r&&(S(0,"div",42)(1,"a",43)(2,"strong"),se(3,44),P()(),S(4,"a",45),se(5,46),P()()),2&r&&(_(1),y("routerLink",_1(2,e7t)),_(3),y("routerLink",_1(3,t7t)))}function r7t(r,e){if(1&r&&(T(0,Jut,9,1,"ng-container",27),T(1,n7t,6,4,"ng-template",null,36,dn)),2&r){const t=ln(2);y("ngIf",p().username.isPresent())("ngIfElse",t)}}const _ae=function(){return["/"]},i7t=function(){return["/play"]},o7t=function(){return["/lobby"]},s7t=function(){return["/local"]},a7t=function(){return["/tutorial"]},c7t=function(){return["/settings"]};let l7t=(()=>{var r;class e{constructor(n,i,o,s){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"loading",!0),u(this,"username",g.empty()),u(this,"faCog",Nie),u(this,"faSpinner",ose),u(this,"userSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"showMenu",!1),u(this,"currentGame",g.empty()),this.router=n,this.connectedUserService=i,this.currentGameService=o,this.userService=s}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(n=>{this.loading=!1,this.username=n.username.isPresent()?n.username:n.email}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(n=>{this.currentGame=n})}logout(){var n=this;return M(function*(){yield n.connectedUserService.disconnect(),yield n.router.navigate(["/"])})()}navigateToPart(){var n=this;return M(function*(){return n.router.navigate(["/play",n.currentGame.get().typeGame,n.currentGame.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Gn),G(ar),G(uo),G(q5))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,n,i,o,s,a,c,l,f,d,m,E,w,L,z;return t=$localize`Home`,n=$localize`Play online`,i=$localize`Create a game`,o=$localize`Join a game`,s=$localize`Play offline`,a=$localize`Create a game`,c=$localize`Learn the rules`,l=$localize`Settings`,f=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,d=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,E=$localize`Account`,w=$localize`Log out`,L=$localize`Register`,z=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],n,[1,"navbar-dropdown"],i,o,["id","playOffline",1,"navbar-link"],s,["id","playLocally",1,"navbar-item",3,"routerLink"],a,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","currentGameLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",l,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","currentGameLink",1,"navbar-item",3,"click"],["activeUser",""],f,["waitingForOpponent",""],d,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","account","routerLink","/account",1,"navbar-item"],E,["id","logout",1,"navbar-item",3,"click"],w,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],L,["id","login",1,"button","is-light",3,"routerLink"],z]},template:function(n,i){if(1&n&&(S(0,"nav",0)(1,"div",1)(2,"a",2),F(3,"img",3),P(),S(4,"a",4),U("click",function(){return i.showMenu=!i.showMenu}),F(5,"span",5)(6,"span",5)(7,"span",5),P()(),S(8,"div",6),U("click",function(){return i.showMenu=!i.showMenu}),S(9,"div",7)(10,"a",8),se(11,9),P(),S(12,"div",10)(13,"a",11),se(14,12),P(),S(15,"div",13)(16,"a",2),se(17,14),P(),S(18,"a",2),se(19,15),P()()(),S(20,"div",10)(21,"a",16),se(22,17),P(),S(23,"div",13)(24,"a",18),se(25,19),P(),S(26,"a",20),se(27,21),P()()()(),S(28,"div",22),T(29,Xut,4,2,"a",23),S(30,"a",24),F(31,"fa-icon",25),P(),S(32,"div",26),T(33,Qut,2,1,"ng-container",27),T(34,r7t,3,2,"ng-template",null,28,dn),P()()()()),2&n){const o=ln(35);_(2),y("routerLink",_1(13,_ae)),_(2),y("ngClass",i.showMenu?"is-active":""),_(4),y("ngClass",i.showMenu?"is-active":""),_(2),y("routerLink",_1(14,_ae)),_(6),y("routerLink",_1(15,i7t)),_(2),y("routerLink",_1(16,o7t)),_(6),y("routerLink",_1(17,s7t)),_(2),y("routerLink",_1(18,a7t)),_(3),y("ngIf",i.currentGame.isPresent()),_(1),y("routerLink",_1(19,c7t)),_(1),y("icon",i.faCog),_(2),y("ngIf",i.loading)("ngIfElse",o)}},dependencies:[Ft,Nt,yc,S0],encapsulation:2})),e})(),u7t=(()=>{var r;class e{constructor(n,i){u(this,"_themeService",void 0),u(this,"_errorLoggerService",void 0),u(this,"faTwitter",zee),u(this,"faFacebook",Nee),u(this,"faGithub",Ree),this._themeService=n,this._errorLoggerService=i}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(_v),G(u2))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(n,i){1&n&&(F(0,"app-header"),S(1,"main",0),F(2,"router-outlet"),P(),S(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),Ao(7,3),F(8,"strong"),Io(),P(),lt(9," \xa0 "),S(10,"a",4),F(11,"fa-icon",5),P(),lt(12,"\xa0 "),S(13,"a",6),F(14,"fa-icon",5),P(),lt(15,"\xa0 "),S(16,"a",7),F(17,"fa-icon",5),P()()()()),2&n&&(_(11),y("icon",i.faGithub),_(3),y("icon",i.faTwitter),_(3),y("icon",i.faFacebook))},dependencies:[hP,S0,l7t],encapsulation:2})),e})();class Ri{constructor(){u(this,"__nominal",void 0)}}var tu;class Jt{static of(e){switch(e){case 0:return Jt.ZERO;case 1:return Jt.ONE;case 2:return Jt.TWO;default:return Fe(3===e,"Invalid Apagos Coord "+e),Jt.THREE}}constructor(e){u(this,"x",void 0),this.x=e}equals(e){return this.x===e.x}}tu=Jt,u(Jt,"encoder",we.tuple([we.identity()],r=>[r.x],r=>tu.of(r[0]))),u(Jt,"ZERO",new tu(0)),u(Jt,"ONE",new tu(1)),u(Jt,"TWO",new tu(2)),u(Jt,"THREE",new tu(3));let nu=(()=>{class r{}return u(r,"PIECE_SHOULD_MOVE_DOWNWARD",()=>$localize`Pieces should only move downward!`),u(r,"CANNOT_LAND_ON_A_FULL_SQUARE",()=>$localize`That square is already full, you cannot put a piece in it!`),u(r,"NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE",()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`),u(r,"NO_PIECE_REMAINING_TO_DROP",()=>$localize`There are no remaining pieces of that color to drop!`),u(r,"NO_POSSIBLE_TRANSFER_REMAINS",()=>$localize`There is no possible transfer from that square!`),r})();var zi;class fs extends Ri{static drop(e,t){return q.getNonNullable(fs.ALL_MOVES.find(i=>i.landing.equals(e)&&i.piece.equalsValue(t)&&i.starting.equals(g.empty())))}static transfer(e,t){if(e.x<=t.x)return ie.failure(nu.PIECE_SHOULD_MOVE_DOWNWARD());const n=q.getNonNullable(fs.ALL_MOVES.find(i=>i.landing.equals(t)&&i.piece.equals(g.empty())&&i.starting.equals(g.of(e))));return ie.success(n)}constructor(e,t,n){super(),u(this,"landing",void 0),u(this,"piece",void 0),u(this,"starting",void 0),this.landing=e,this.piece=t,this.starting=n}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}u(fs,"ALL_MOVES",[new(zi=fs)(Jt.ZERO,g.of(I.ZERO),g.empty()),new zi(Jt.ONE,g.of(I.ZERO),g.empty()),new zi(Jt.TWO,g.of(I.ZERO),g.empty()),new zi(Jt.THREE,g.of(I.ZERO),g.empty()),new zi(Jt.ZERO,g.of(I.ONE),g.empty()),new zi(Jt.ONE,g.of(I.ONE),g.empty()),new zi(Jt.TWO,g.of(I.ONE),g.empty()),new zi(Jt.THREE,g.of(I.ONE),g.empty()),new zi(Jt.TWO,g.empty(),g.of(Jt.THREE)),new zi(Jt.ONE,g.empty(),g.of(Jt.THREE)),new zi(Jt.ZERO,g.empty(),g.of(Jt.THREE)),new zi(Jt.ONE,g.empty(),g.of(Jt.TWO)),new zi(Jt.ZERO,g.empty(),g.of(Jt.TWO)),new zi(Jt.ZERO,g.empty(),g.of(Jt.ONE))]),u(fs,"encoder",we.tuple([Jt.encoder,g.getEncoder(I.encoder),g.getEncoder(Jt.encoder)],r=>[r.landing,r.piece,r.starting],r=>new zi(r[0],r[1],r[2])));class eC{constructor(e){u(this,"turn",void 0),this.turn=e}getCurrentPlayer(){return I.ofTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?I.ZERO:I.ONE}}let vae;class Re{static mapBiArray(e,t){const n=[];let i=0;for(;i<e.length;){n[i]=[];let o=0;for(;o<e[i].length;)n[i][o]=t(e[i][o]),o++;i++}return n}static create3DTable(e,t,n,i){const o=[];for(let s=0;s<e;s++)o.push(Re.createTable(t,n,i));return o}static createTable(e,t,n){const i=[];for(let o=0;o<t;o++)i.push(Re.createArray(e,n));return i}static createArray(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}static copyBiArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=Re.copyImmutableArray(e[n]),n++;return t}static copyImmutableArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=e[n],n++;return t}static sortByDescending(e,t){e.sort((n,i)=>{const o=t(n),s=t(i);return o<s?1:o>s?-1:0})}static compareArray(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===zs(e[n],t[n]))return!1;return!0}static compareTable(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===Re.compareArray(e[n],t[n]))return!1;return!0}static isPrefix(e,t){return!(e.length>t.length)&&Re.compareArray(e,t.slice(0,e.length))}static range(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}static smallerFirst(e,t){return e-t}}vae=Symbol.iterator;class Cae{constructor(){u(this,"content",new un)}get(e){const t=this.content.get(e.y);return t.isAbsent()?g.empty():t.get().get(e.x)}set(e,t){const n=this.content.get(e.y);let i;n.isPresent()?i=n.get():(i=new un,this.content.set(e.y,i)),i.set(e.x,t)}[vae](){const e=[],t=this.content.getKeySet().toList();t.sort(Re.smallerFirst);for(const n of t){const i=this.content.get(n).get(),o=i.getKeySet().toList();o.sort(Re.smallerFirst);for(const s of o){const a=i.get(s).get();e.push({x:s,y:n,content:a})}}return e.values()}}class Td{static from(e,t,n){if(e+t>n)return ie.failure("invalid starting space");const i=new un([{key:I.ZERO,value:e},{key:I.ONE,value:t},{key:K.NONE,value:n}]);i.makeImmutable();const o=new Td(i);return ie.success(o)}constructor(e){u(this,"containing",void 0),this.containing=e}isFull(){return this.count(I.ZERO)+this.count(I.ONE)>=this.count(K.NONE)}count(e){return this.containing.get(e).get()}addPiece(e){let t=this.count(I.ZERO),n=this.count(I.ONE);const i=this.count(K.NONE);return e===I.ZERO?t++:n++,Td.from(t,n,i).get()}substractPiece(e){let t=this.count(I.ZERO),n=this.count(I.ONE);const i=this.count(K.NONE);return e===I.ZERO?t--:n--,Td.from(t,n,i).get()}getDominatingPlayer(){const e=this.count(I.ZERO),t=this.count(I.ONE);return e>t?I.ZERO:t>e?I.ONE:K.NONE}equals(e){return this.containing.equals(e.containing)}}let vl=(()=>{class r extends eC{static getInitialState(){return r.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(t,n,i,o){const s=[];for(let c=0;c<4;c++){const m=Td.from(n[0][c],n[1][c],n[2][c]).get();s.push(m)}const a=new un;return a.set(I.ZERO,i),a.set(I.ONE,o),new r(t,s,a)}constructor(t,n,i){super(t),u(this,"board",void 0),u(this,"remaining",void 0),this.board=n,this.remaining=i,this.remaining.makeImmutable()}getPieceAt(t){return this.board[t.x]}updateAt(t,n){const i=[];for(let s=0;s<4;s++)i.push(t.x===s?n:this.board[s]);const o=this.getRemainingCopy();return new r(this.turn,i,o)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(t){return this.remaining.get(t).get()}equals(t){return this.turn===t.turn&&Re.compareArray(t.board,this.board)&&this.remaining.equals(t.remaining)}}return u(r,"PIECES_PER_PLAYER",10),r})();class W{static fromMove(e,t,n,i,o,s){return new f7t(e,t,n,i,o,s)}static forClick(e,t,n,i,o,s){return new h7t(e,t,n,i,o,s)}static anyMove(e,t,n,i,o){return new d7t(e,t,n,i,o)}static fromPredicate(e,t,n,i,o,s){return new p7t(e,t,n,i,o,s)}static informational(e,t,n){return new g7t(e,t,n)}constructor(e,t,n){u(this,"title",void 0),u(this,"instruction",void 0),u(this,"state",void 0),u(this,"previousMove",g.empty()),this.title=e,this.instruction=t,this.state=n}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(e){return this.previousMove=g.of(e),this}}class tC extends W{constructor(e,t,n,i){super(e,t,n),u(this,"successMessage",void 0),this.successMessage=i}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class f7t extends tC{constructor(e,t,n,i,o,s){super(e,t,n,o),u(this,"acceptedMoves",void 0),u(this,"failureMessage",void 0),this.acceptedMoves=i,this.failureMessage=s,Fe(i.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class d7t extends tC{constructor(e,t,n,i,o){super(e,t,n,o),u(this,"solutionMove",void 0),this.solutionMove=i}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class h7t extends tC{constructor(e,t,n,i,o,s){super(e,t,n,o),u(this,"acceptedClicks",void 0),u(this,"failureMessage",void 0),this.acceptedClicks=i,this.failureMessage=s}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class p7t extends tC{constructor(e,t,n,i,o,s){super(e,t,n,s),u(this,"solutionMove",void 0),u(this,"predicate",void 0),this.solutionMove=i,this.predicate=o}getSolution(){return this.solutionMove}isPredicate(){return!0}}class g7t extends W{isInformation(){return!0}}class Zn{}class yae extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,vl.getInitialState()),W.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,vl.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),fs.drop(Jt.ZERO,I.ZERO),$localize`Congratulations!`),W.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,vl.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),fs.transfer(Jt.TWO,Jt.ZERO).get(),(t,n,i)=>t.isDrop()?b.failure($localize`This move is a drop, please do a transfer!`):b.SUCCESS,$localize`Congratulations!`),W.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,vl.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),fs.drop(Jt.TWO,I.ONE),(t,n,i)=>t.isDrop()?t.piece.equalsValue(I.ONE)?b.SUCCESS:b.failure($localize`You actively made your opponent win!`):b.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)])}}class an{static fromWinner(e){return e.isPlayer()?new an(e.getVictoryValue()):new an(0)}static of(e,t){return e*=I.ZERO.getScoreModifier(),t*=I.ONE.getScoreModifier(),new an(e+t)}toString(){return""+this.value}constructor(e){u(this,"value",void 0),this.value=e}}var Od;u(an,"VICTORIES",[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER]);class ve{static getVictory(e){return e===I.ZERO?ve.ZERO_WON:ve.ONE_WON}static getDefeat(e){return e===I.ZERO?ve.ONE_WON:ve.ZERO_WON}constructor(e,t){u(this,"isEndGame",void 0),u(this,"winner",void 0),this.isEndGame=e,this.winner=t}toBoardValue(){return this.winner.isPlayer()?new an(this.winner.getVictoryValue()):new an(0)}}u(ve,"ZERO_WON",new(Od=ve)(!0,I.ZERO)),u(ve,"ONE_WON",new Od(!0,I.ONE)),u(ve,"DRAW",new Od(!0,K.NONE)),u(ve,"ONGOING",new Od(!1,K.NONE));var nC,EL,en=function(r){return r.VICTORY="VICTORY",r.PRE_VICTORY="PRE_VICTORY",r.DEFAULT="DEFAULT",r}(en||{});let rC=(()=>{class r{}return u(r,"createdNodes",0),u(r,"minimaxTime",0),r})(),Di=(nC=class{static getScoreStatus(e){return e===Number.MAX_SAFE_INTEGER||e===Number.MIN_SAFE_INTEGER?(Ae.display("MGPNode","getScoreStatus","VICTORY"),en.VICTORY):e===Number.MIN_SAFE_INTEGER+1?(Ae.display("MGPNode","getScoreStatus","PRE_VICTORY_MIN"),en.PRE_VICTORY):e===Number.MAX_SAFE_INTEGER-1?(Ae.display("MGPNode","getScoreStatus","PRE_VICTORY_MAX"),en.PRE_VICTORY):(Ae.display("MGPNode","getScoreStatus","DEFAULT"),en.DEFAULT)}constructor(e,t=g.empty(),n=g.empty(),i){if(u(this,"gameState",void 0),u(this,"mother",void 0),u(this,"move",void 0),u(this,"minimaxCreator",void 0),u(this,"childs",g.empty()),u(this,"hopedValue",new un),u(this,"ownValue",new un),u(this,"possibleMoves",new un),this.gameState=e,this.mother=t,this.move=n,this.minimaxCreator=i,this.ownValue=new un,null!=i){const o=i.getBoardValue(this);this.ownValue.set(i.name,o),this.hopedValue.set(i.name,o.value)}rC.createdNodes++}findBestMove(e,t,n=!1,i=!0){const o=(new Date).getTime();let s=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,i);for(;s.gameState.turn>this.gameState.turn+1;)s=s.mother.get(),e--;return rC.minimaxTime+=(new Date).getTime()-o,s.move.get()}alphaBeta(e,t,n,i,o,s){if(e<1)return Ae.display("MGPNode","alphaBeta","isLeaf-Calculation : "+this.myToString()+" at depth "+e),this;if(i.ruler.getGameStatus(this).isEndGame)return Ae.display("MGPNode","alphaBeta","isLeaf-EndGame("+i.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+e),this;const a=this.getPossibleMoves(i);Fe(a.size()>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=g.of([]));const c=this.getBestChilds(a,e,t,n,i,o,s),l=this.getBestChildAmongst(c,o),f=l.hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),f),l}getPossibleMoves(e){const t=this.possibleMoves.get(e.name);if(t.isAbsent()){const n=e.getListMoves(this);return this.possibleMoves.set(e.name,new dt(n)),new dt(n)}return t.get()}getBestChilds(e,t,n,i,o,s,a){let c=[];const l=this.gameState.getCurrentPlayer();let f=l===I.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const d=l===I.ZERO?(m,E)=>m<E:(m,E)=>E<m;for(const m of e){const w=this.getOrCreateChild(m,o).alphaBeta(t-1,n,i,o,s,a),L=w.getHopedValue(o);if(d(L,f)||0===c.length?(f=L,c=[w]):L===f&&c.push(w),a&&d(f,l===I.ZERO?n:i))break;l===I.ZERO?i=Math.min(f,i):n=Math.max(f,n)}return c}getBestChildAmongst(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}getOrCreateChild(e,t){let n=this.getSonByMove(e);if(n.isAbsent()){const i=t.ruler.isLegal(e,this.gameState),o=e.toString();Fe(i.isSuccess(),'The minimax "'+t.name+'" has proposed an illegal move ('+o+"), refusal reason: "+i.getReasonOr("")+" this should not happen.");const s=t.ruler.applyLegalMove(e,this.gameState,i.get());n=g.of(new EL(s,g.of(this),g.of(e),t)),this.childs.get().push(n.get())}return n.get()}getSonByMove(e){Fe(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const t of this.childs.get())if(t.move.isPresent()&&t.move.equalsValue(e))return g.of(t);return g.empty()}getHopedValue(e){return this.hopedValue.get(e.name).get()}getOwnValue(e){const t=this.ownValue.get(e.name);if(t.isAbsent()){const n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}myToString(){let e="",t=this;if(t.mother.isAbsent())return"InitialNode: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let e=this.childs.get().length;for(const t of this.childs.get())e+=t.countDescendants();return e}},EL=nC,u(nC,"minimaxes",new un),nC);Di=EL=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],Di);class Yn{constructor(e){u(this,"stateType",void 0),this.stateType=e}choose(e,t){Ae.display("Rules","choose",t.toString()+" was proposed");const n=this.isLegal(t,e.gameState);if(e.hasMoves()){Ae.display("Rules","choose","current node has moves");const s=e.getSonByMove(t);if(s.isPresent())return Fe(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),Ae.display("Rules","choose","and this proposed move is found in the list, so it is legal"),g.of(s.get())}if(Ae.display("Rules","choose","current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return Ae.display("Rules","choose","Move is illegal: "+n.getReason()),g.empty();Ae.display("Rules","choose","Move is legal, let's apply it");const i=this.applyLegalMove(t,e.gameState,n.get()),o=new Di(i,g.of(e),g.of(t));return g.of(o)}getInitialNode(){const e=this.stateType.getInitialState();return new Di(e)}}class e4 extends Yn{static get(){return e4.singleton.isAbsent()&&(e4.singleton=g.of(new e4)),e4.singleton.get()}constructor(){super(vl)}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}applyLegalDrop(e,t){const n=t.getRemainingCopy(),i=n.get(e.piece.get()).get();n.put(e.piece.get(),i-1);const o=new vl(t.turn+1,t.board,n),s=e.piece.get(),a=o.getPieceAt(e.landing).addPiece(s);if(e.landing===Jt.THREE)return o.updateAt(e.landing,a);{const c=Jt.of(e.landing.x+1),l=o.getPieceAt(c);return o.updateAt(e.landing,l).updateAt(c,a)}}applyLegalTransfer(e,t){const n=t.getCurrentPlayer(),i=e.starting.get(),o=t.getPieceAt(i).substractPiece(n),s=t.getPieceAt(e.landing).addPiece(n);let a=t.updateAt(i,o);return a=a.updateAt(e.landing,s),new vl(a.turn+1,a.board,a.remaining)}isLegal(e,t){return t.getPieceAt(e.landing).isFull()?b.failure(nu.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}isLegalDrop(e,t){return t.getRemaining(e.piece.get())<=0?b.failure(nu.NO_PIECE_REMAINING_TO_DROP()):b.SUCCESS}isLegalSlideDown(e,t){const n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?b.failure(nu.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):b.SUCCESS}getGameStatus(e){const t=e.gameState;for(let i=0;i<4;i++)if(!1===t.getPieceAt(Jt.of(i)).isFull())return ve.ONGOING;const n=t.getPieceAt(Jt.THREE).getDominatingPlayer();return Fe(n.isPlayer(),"winner can only be a player if the game is finished"),ve.getVictory(n)}}u(e4,"singleton",g.empty());class SL{static gcd(e,t){return 0===t?Math.abs(e):SL.gcd(t,e%t)}}class St{constructor(e,t){u(this,"x",void 0),u(this,"y",void 0),this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}isDiagonalOfLength(e){return Math.abs(this.x)===e&&Math.abs(this.y)===e}toMinimalVector(){const e=SL.gcd(this.x,this.y);return new St(this.x/e,this.y/e)}combine(e,t=1){return new St(this.x+t*e.x,this.y+t*e.y)}toString(){return"("+this.x+", "+this.y+")"}}var C1,fo;class PL extends St{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class TL{from(e,t){for(const n of this.all)if(n.x===e&&n.y===t)return ie.success(n);return ie.failure("Invalid x and y in direction construction")}fromDelta(e,t){return 0===e&&0===t?ie.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.from(Math.sign(e),Math.sign(t)):ie.failure(_7t.DIRECTION_MUST_BE_LINEAR())}fromMove(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}fromString(e){switch(e){case"UP":return this.from(0,-1);case"RIGHT":return this.from(1,0);case"DOWN":return this.from(0,1);case"LEFT":return this.from(-1,0);case"UP_LEFT":return this.from(-1,-1);case"UP_RIGHT":return this.from(1,-1);case"DOWN_LEFT":return this.from(-1,1);case"DOWN_RIGHT":return this.from(1,1);default:return ie.failure(`Invalid direction string ${e}`)}}fromInt(e){switch(e){case 0:return this.from(0,-1);case 1:return this.from(1,0);case 2:return this.from(0,1);case 3:return this.from(-1,0);case 4:return this.from(-1,-1);case 5:return this.from(1,-1);case 6:return this.from(-1,1);case 7:return this.from(1,1);default:return ie.failure(`Invalid int direction: ${e}`)}}}class Me extends PL{constructor(e,t){super(e,t)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return Me.factory.from(-this.x,-this.y).get()}}u(Me,"UP",new(C1=Me)(0,-1)),u(Me,"UP_RIGHT",new C1(1,-1)),u(Me,"RIGHT",new C1(1,0)),u(Me,"DOWN_RIGHT",new C1(1,1)),u(Me,"DOWN",new C1(0,1)),u(Me,"DOWN_LEFT",new C1(-1,1)),u(Me,"LEFT",new C1(-1,0)),u(Me,"UP_LEFT",new C1(-1,-1)),u(Me,"factory",new class extends TL{constructor(...r){super(...r),u(this,"all",[C1.UP,C1.UP_RIGHT,C1.RIGHT,C1.DOWN_RIGHT,C1.DOWN,C1.DOWN_LEFT,C1.LEFT,C1.UP_LEFT])}}),u(Me,"DIRECTIONS",C1.factory.all),u(Me,"DIAGONALS",[C1.UP_RIGHT,C1.DOWN_RIGHT,C1.DOWN_LEFT,C1.UP_LEFT]),u(Me,"ORTHOGONALS",[C1.UP,C1.RIGHT,C1.DOWN,C1.LEFT]),u(Me,"encoder",we.fromFunctions(r=>r.toString(),r=>(Fe("string"==typeof r,"Invalid encoded direction"),C1.factory.fromString(r).get())));class ze extends PL{constructor(e,t){super(e,t)}getOpposite(){return ze.factory.from(-this.x,-this.y).get()}rotateClockwise(){return ze.factory.from(-this.y,this.x).get()}}u(ze,"UP",new(fo=ze)(0,-1)),u(ze,"RIGHT",new fo(1,0)),u(ze,"DOWN",new fo(0,1)),u(ze,"LEFT",new fo(-1,0)),u(ze,"factory",new class extends TL{constructor(...r){super(...r),u(this,"all",[fo.UP,fo.RIGHT,fo.DOWN,fo.LEFT])}from(r,e){return 0===r&&-1===e?ie.success(fo.UP):1===r&&0===e?ie.success(fo.RIGHT):0===r&&1===e?ie.success(fo.DOWN):-1===r&&0===e?ie.success(fo.LEFT):ie.failure("Invalid orthogonal from x and y")}}),u(ze,"ORTHOGONALS",fo.factory.all),u(ze,"encoder",we.fromFunctions(r=>r.toString(),r=>(Fe("string"==typeof r,"Invalid encoded orthogonal"),fo.factory.fromString(r).get())));let _7t=(()=>{class r{}return u(r,"DIRECTION_MUST_BE_LINEAR",()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`),r})();var OL;let ru=(()=>{class r{}return u(r,"OUT_OF_RANGE",e=>`The coordinate ${e.toString()} is not on the board`),r})();class C extends St{static getEncoder(e){return we.tuple([we.identity(),we.identity()],t=>[t.x,t.y],t=>e(t[0],t[1]))}constructor(e,t){super(e,t)}getNext(e,t){const n=this.combine(e,t);return new C(n.x,n.y)}getPrevious(e,t){return this.getNext(e,-(t=t??1))}getLeft(e){return new C(this.x+e.y,this.y+-e.x)}getRight(e){return new C(this.x+-e.y,this.y+e.x)}isInRange(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}isNotInRange(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}getDirectionToward(e){return Me.factory.fromMove(this,e)}getOrthogonalDistance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getDistance(e){if(!1===e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}isHexagonallyAlignedWith(e){const t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}isAlignedWith(e){const t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}getVectorToward(e){return new St(e.x-this.x,e.y-this.y)}toVector(){return new St(this.x,this.y)}getCoordsToward(e){if(e.equals(this))return[];if(!1===e.isAlignedWith(this))return[];const t=this.getDirectionToward(e).get();let n=this.getNext(t,1);const i=[];for(;!1===n.equals(e);)i.push(n),n=n.getNext(t,1);return i}getUntil(e){const t=[],n=this.getDirectionToward(e).get();let i=this.getNext(n);for(;!1===i.equals(e);)t.push(i),i=i.getNext(n);return t}equals(e){return this===e||e.x===this.x&&e.y===this.y}compareTo(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}toSVGPoint(){return this.x+","+this.y}}u(C,"encoder",(OL=C).getEncoder((r,e)=>new OL(r,e)));class Mae{constructor(){u(this,"ArrayUtils",Re)}getPlayerClass(e){switch(e){case I.ZERO:return"player0-fill";case I.ONE:return"player1-fill";default:return q.expectToBe(e,K.NONE),""}}}let Cl=(()=>{var r;class e extends Mae{constructor(n){super(),u(this,"messageDisplayer",void 0),u(this,"encoder",void 0),u(this,"Player",I),u(this,"SPACE_SIZE",100),u(this,"STROKE_WIDTH",8),u(this,"SMALL_STROKE_WIDTH",2),u(this,"rules",void 0),u(this,"node",void 0),u(this,"availableMinimaxes",void 0),u(this,"canPass",!1),u(this,"scores",g.empty()),u(this,"imagesLocation","assets/images/"),u(this,"hasAsymmetricBoard",!1),u(this,"rotation",""),u(this,"tutorial",void 0),u(this,"isPlayerTurn",void 0),u(this,"chooseMove",void 0),u(this,"canUserPlay",void 0),u(this,"cancelMoveOnWrapper",void 0),u(this,"role",void 0),this.messageDisplayer=n}message(n){this.messageDisplayer.gameMessage(n)}cancelMove(n){var i=this;return M(function*(){return i.cancelMoveAttempt(),i.cancelMoveOnWrapper(n),i.node.move.isPresent()&&(yield i.showLastMove(i.node.move.get())),null==n?b.SUCCESS:(i.messageDisplayer.gameMessage(n),b.failure(n))})()}cancelMoveAttempt(){}pass(){var n=this;return M(function*(){return u2.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:n.constructor.name})})()}getTurn(){return this.node.gameState.turn}getCurrentPlayer(){return this.node.gameState.getCurrentPlayer()}getCurrentOpponent(){return this.node.gameState.getCurrentOpponent()}getState(){return this.node.gameState}getPreviousState(){return this.node.mother.get().gameState}showLastMove(n){return M(function*(){})()}hideLastMove(){}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),iu=(()=>{var r;class e extends Cl{constructor(...n){super(...n),u(this,"hexaLayout",void 0),u(this,"hexaBoard",void 0)}getHexaPointsAtXY(n,i){const o=new C(n,i);return this.getHexaPointsAt(o)}getHexaPointsAt(n){return this.hexaLayout.getHexaPointsAt(n)}getCenterAtXY(n,i){const o=new C(n,i);return this.getCenterAt(o)}getCenterAt(n){return this.hexaLayout.getCenterAt(n)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}()),u(e,"\u0275cmp",je({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();var bd,d2;class Ce{static of(e){switch(e){case Ce.ZERO.value:return Ce.ZERO;case Ce.ONE.value:return Ce.ONE;case Ce.EMPTY.value:return Ce.EMPTY;case Ce.UNREACHABLE.value:return Ce.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+e)}}static ofPlayer(e){return e===I.ZERO?Ce.ZERO:(q.expectToBe(e,I.ONE),Ce.ONE)}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}is(e){return this.value===e.value}isPlayer(){return this===Ce.ZERO||this===Ce.ONE}}u(Ce,"ZERO",new(bd=Ce)(I.ZERO.value)),u(Ce,"ONE",new bd(I.ONE.value)),u(Ce,"EMPTY",new bd(K.NONE.value)),u(Ce,"UNREACHABLE",new bd(3));class be extends PL{static getAngle(e){switch(e){case be.UP:return 0;case be.UP_RIGHT:return 60;case be.RIGHT:return 120;case be.DOWN:return 180;case be.DOWN_LEFT:return 240;default:return q.expectToBe(e,be.LEFT),300}}constructor(e,t){super(e,t)}getOpposite(){return be.factory.from(-this.x,-this.y).get()}}u(be,"UP",new(d2=be)(0,-1)),u(be,"LEFT",new d2(-1,0)),u(be,"UP_RIGHT",new d2(1,-1)),u(be,"DOWN_LEFT",new d2(-1,1)),u(be,"RIGHT",new d2(1,0)),u(be,"DOWN",new d2(0,1)),u(be,"factory",new class extends TL{constructor(...r){super(...r),u(this,"all",[d2.UP,d2.UP_RIGHT,d2.RIGHT,d2.DOWN,d2.DOWN_LEFT,d2.LEFT])}}),u(be,"encoder",we.fromFunctions(r=>{switch(r){case d2.UP:return 0;case d2.UP_RIGHT:return 1;case d2.RIGHT:return 2;case d2.DOWN:return 3;case d2.DOWN_LEFT:return 4;default:return 5}},r=>(q.assert(0<=r&&r<=5,"Invalid encoded number for HexaDirection "+r),d2.factory.all[r])));class Pae{constructor(){u(this,"startAngle",void 0),u(this,"conversionMatrix",void 0),u(this,"inverseConversionMatrix",void 0)}}class iC extends Pae{constructor(){super(),u(this,"startAngle",.5),u(this,"conversionMatrix",[Math.sqrt(3),Math.sqrt(3)/2,0,1.5]),u(this,"inverseConversionMatrix",[Math.sqrt(3)/3,-1/3,0,2/3])}}u(iC,"INSTANCE",new iC);class Fr extends Pae{constructor(){super(),u(this,"startAngle",0),u(this,"conversionMatrix",[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)]),u(this,"inverseConversionMatrix",[2/3,0,-1/3,Math.sqrt(3)/3])}isOnBorder(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}isOnTopRightBorder(e,t){return 0===t.y}isOnRightBorder(e,t){return t.x===e.width-1}isOnLeftBorder(e,t){return 0===t.x}isOnBottomLeftBorder(e,t){return t.y===e.height-1}isOnTopLeftBorder(e,t){return null!=e.excludedSpaces[t.y]?t.x===e.excludedSpaces[t.y]:t.y===e.excludedSpaces.length&&0===t.x}isOnBottomRightBorder(e,t){return null!=e.excludedSpaces[e.height-1-t.y]?e.width-1-t.x===e.excludedSpaces[e.height-1-t.y]:e.height-1-t.y===e.excludedSpaces.length&&t.x===e.width-1}getAllBorders(e){const t=[];return e.forEachCoord((n,i)=>{this.isOnBorder(e,n)&&t.push(n)}),t}isTopCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}isTopLeftCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isTopRightCorner(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}isBottomCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}isBottomLeftCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isBottomRightCorner(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}u(Fr,"INSTANCE",new Fr);class ou{constructor(e,t,n){u(this,"size",void 0),u(this,"origin",void 0),u(this,"orientation",void 0),this.size=e,this.origin=t,this.orientation=n}getCenterAt(e){const t=this.orientation.conversionMatrix;return new C(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}getCornerOffset(e){const t=2*Math.PI*(this.orientation.startAngle+e)/6;return new C(this.size*Math.cos(t),this.size*Math.sin(t))}getHexaPointsListAt(e){const t=this.getCenterAt(e),n=[];for(let i=0;i<6;i+=1){const o=this.getCornerOffset(i);n.push(new C(t.x+o.x,t.y+o.y))}return n}getHexaPointsAt(e){return this.getHexaPointsListAt(e).map(n=>n.toSVGPoint()).join(" ")}getIsoPoints(e,t){q.assert(this.orientation===Fr.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const n=this.getCenterAt(e),i=this.getCornerOffset(0),o=this.getCornerOffset(1),s=this.getCornerOffset(2),a=this.getCornerOffset(3);return[[new C(n.x+a.x,n.y+a.y),new C(n.x+a.x,n.y+a.y+t),new C(n.x+s.x,n.y+s.y+t),new C(n.x+s.x,n.y+s.y)],[new C(n.x+i.x,n.y+i.y),new C(n.x+i.x,n.y+i.y+t),new C(n.x+o.x,n.y+o.y+t),new C(n.x+s.x,n.y+s.y+t),new C(n.x+s.x,n.y+s.y),new C(n.x+o.x,n.y+o.y)],[new C(n.x+a.x,n.y+a.y),new C(n.x+a.x,n.y+a.y+t),new C(n.x+s.x,n.y+s.y+t),new C(n.x+o.x,n.y+o.y+t),new C(n.x+i.x,n.y+i.y+t),new C(n.x+i.x,n.y+i.y),new C(n.x+o.x,n.y+o.y),new C(n.x+s.x,n.y+s.y)]]}}let Tae,Le=(()=>{class r{}return u(r,"CANNOT_CHOOSE_OPPONENT_PIECE",()=>$localize`You cannot pick a piece of the opponent.`),u(r,"MUST_CLICK_ON_EMPTY_SPACE",()=>$localize`You must click on an empty space.`),u(r,"MUST_CLICK_ON_EMPTY_SQUARE",()=>$localize`You must click on an empty square.`),u(r,"SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE",()=>$localize`Your landing space should be empty or contain a piece of the opponent.`),u(r,"CANNOT_SELF_CAPTURE",()=>$localize`You cannot capture your own pieces.`),u(r,"MUST_CHOOSE_PLAYER_PIECE",()=>$localize`You must pick one of your pieces.`),u(r,"CANNOT_PASS",()=>$localize`You cannot pass your turn.`),u(r,"MUST_LAND_ON_EMPTY_SPACE",()=>$localize`You must drop your piece on an empty space.`),u(r,"MUST_PASS",()=>$localize`You must pass your turn.`),u(r,"MUST_CHOOSE_OWN_PIECE_NOT_EMPTY",()=>$localize`You have selected an empty space, you must select one of your own pieces.`),u(r,"MOVE_CANNOT_BE_STATIC",()=>$localize`You must choose different starting and ending coordinates.`),u(r,"SOMETHING_IN_THE_WAY",()=>$localize`There is a piece between the piece you chose and its landing space.`),r})();class ds{constructor(e,t){u(this,"ruler",void 0),u(this,"name",void 0),this.ruler=e,this.name=t}toString(){return this.name}}class Sr extends ds{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return an.fromWinner(t.winner);{const n=this.getMetrics(e);return an.of(n[0],n[1])}}}Tae=Symbol.iterator;class B1 extends eC{constructor(e,t){super(t),u(this,"board",void 0),this.board=e}getPieceAt(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}tryToGetPieceAt(e){return this.isOnBoard(e)?g.of(this.board[e.y][e.x]):g.empty()}isOnBoard(e){return e.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(e,t){return this.getPieceAt(new C(e,t))}forEachCoord(e){for(const{coord:t,content:n}of this.getCoordsAndContents())e(t,n)}getCoordsAndContents(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const i=new C(n,t);this.isOnBoard(i)&&e.push({coord:i,content:this.getPieceAt(i)})}return e}getCopiedBoard(){return Re.copyBiArray(this.board)}toMap(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const i=new C(n,t);e.push({key:i,value:this.getPieceAt(i)})}return e}[Tae](){const e=[];for(const t of this.board)e.push(...t);return e.values()}}class Hi extends B1{static getInitialState(){const e=Ce.EMPTY,t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE;return new Hi([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,n,n,n,e,e,t,t],[n,n,n,n,n,n,t,t,t],[n,n,n,n,n,t,t,t,t]],0)}static isOnBoard(e){return e.isInRange(9,9)&&Hi.getInitialState().getPieceAt(e)!==Ce.UNREACHABLE}isPiece(e){return this.getPieceAt(e).isPlayer()}getScores(){const e=[14,14];for(let t=0;t<9;t++)for(let n=0;n<9;n++)this.getPieceAtXY(n,t)===Ce.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===Ce.ONE&&(e[0]=e[0]-1);return e}}class Pr extends Ri{static getFallibleEncoder(e){return we.tuple([C.encoder],t=>[t.coord],t=>e(t[0]).get())}static getEncoder(e){return we.tuple([C.encoder],t=>[t.coord],t=>e(t[0]))}constructor(e,t){super(),u(this,"coord",void 0),this.coord=new C(e,t)}equals(e){return this===e||this.coord.equals(e.coord)}}var Oae;class R2 extends Pr{static fromSingleCoord(e,t){try{return ie.success(new R2(e,t,g.empty()))}catch(n){return ie.failure(n.message)}}static fromDoubleCoord(e,t,n){const i=[e,t];Re.sortByDescending(i,R2.sortCoord);const o=i[1].getDirectionToward(i[0]).get(),s=be.factory.fromDelta(o.x,o.y);if(s.isFailure())return ie.failure("Invalid direction");const a=s.get();return i[1].getDistance(i[0])>2?ie.failure("Distance between first coord and last coord is too big"):a.equals(n)?R2.fromSingleCoord(i[1],n):a.getOpposite().equals(n)?R2.fromSingleCoord(i[0],n):ie.success(new R2(i[1],n,g.of(i[0])))}static sortCoord(e){return 9*e.y+e.x}constructor(e,t,n){if(super(e.x,e.y),u(this,"dir",void 0),u(this,"lastPiece",void 0),this.dir=t,this.lastPiece=n,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!")}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}Oae=R2,u(R2,"encoder",we.tuple([C.encoder,be.encoder,g.getEncoder(C.encoder)],r=>[r.coord,r.dir,r.lastPiece],r=>new Oae(r[0],r[1],r[2])));let yl=(()=>{class r{}return u(r,"CANNOT_MOVE_MORE_THAN_THREE_PIECES",()=>$localize`You cannot move more than 3 of your pieces!`),u(r,"NOT_ENOUGH_PIECE_TO_PUSH",()=>$localize`You don't have enough pieces to push that group!`),u(r,"CANNOT_PUSH_YOUR_OWN_PIECES",()=>$localize`You cannot push this piece because it is blocked by one of yours!`),u(r,"MUST_ONLY_TRANSLATE_YOUR_PIECES",()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`),u(r,"TRANSLATION_IMPOSSIBLE",()=>$localize`This move is impossible, some landing spaces are occupied.`),u(r,"LINE_AND_COORD_NOT_ALIGNED",()=>$localize`This space is not aligned with the current line.`),r})();class Hs extends Yn{static get(){return Hs.singleton.isAbsent()&&(Hs.singleton=g.of(new Hs)),Hs.singleton.get()}constructor(){super(Hi)}static isLegalRealPush(e,t,n,i,o){let s=0;const a=Ce.ofPlayer(n.getCurrentOpponent()),c=Ce.ofPlayer(n.getCurrentPlayer());for(;s<i&&n.isOnBoard(e)&&n.getPieceAt(e)===a;)s++,e=e.getNext(t.dir);return s>=i?ie.failure(yl.NOT_ENOUGH_PIECE_TO_PUSH()):Hi.isOnBoard(e)&&(n.getPieceAt(e)===Ce.EMPTY&&(o[e.y][e.x]=a),n.getPieceAt(e)===c)?ie.failure(yl.CANNOT_PUSH_YOUR_OWN_PIECES()):ie.success(o)}static getGameStatus(e){const t=e.gameState.getScores();return t[0]>5?ve.ZERO_WON:t[1]>5?ve.ONE_WON:ve.ONGOING}applyLegalMove(e,t,n){return new Hi(n,t.turn+1)}isLegal(e,t){const n=this.getFirstPieceValidity(e,t);return n.isFailure()?n.toOtherFallible():e.isSingleCoord()?this.isLegalPush(e,t):this.isLegalSideStep(e,t)}getFirstPieceValidity(e,t){const n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===Ce.ofPlayer(t.getCurrentOpponent())?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):b.SUCCESS}isLegalPush(e,t){let n=1,i=e.coord.getNext(e.dir);const o=Ce.ofPlayer(t.getCurrentPlayer()),s=Ce.EMPTY,a=t.getCopiedBoard();for(a[e.coord.y][e.coord.x]=s;n<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===o;)n++,i=i.getNext(e.dir);return n>3?ie.failure(yl.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===Hi.isOnBoard(i)||(a[i.y][i.x]=o,t.getPieceAt(i)===s)?ie.success(a):Hs.isLegalRealPush(i,e,t,n,a)}isLegalSideStep(e,t){let n=e.lastPiece.get();const i=e.coord.getDirectionToward(n).get();n=n.getNext(i);let o=e.coord;const s=Ce.ofPlayer(t.getCurrentPlayer()),a=t.getCopiedBoard();for(;!1===o.equals(n)&&Hi.isOnBoard(o);){if(t.getPieceAt(o)!==s)return ie.failure(yl.MUST_ONLY_TRANSLATE_YOUR_PIECES());const c=o.getNext(e.dir);if(a[o.y][o.x]=Ce.EMPTY,Hi.isOnBoard(c)){if(t.isPiece(c))return ie.failure(yl.TRANSLATION_IMPOSSIBLE());t.getPieceAt(c)===Ce.EMPTY&&(a[c.y][c.x]=s)}o=o.getNext(i)}return ie.success(a)}getGameStatus(e){return Hs.getGameStatus(e)}}u(Hs,"singleton",g.empty());class v7t extends Sr{getListMoves(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(let o=0;o<9;o++)for(let s=0;s<9;s++){const a=new C(s,o);if(!1!==n.getPieceAt(a).is(i))for(const c of be.factory.all){const l=R2.fromSingleCoord(a,c).get();if(this.isAcceptablePush(l,n)){t.push(l);for(const f of be.factory.all)for(let d=1;d<=2&&!f.equals(c);d++){const m=a.getNext(f,d);if(!Hi.isOnBoard(m))break;{const E=R2.fromDoubleCoord(a,m,c).get();Hs.get().isLegal(E,n).isSuccess()&&t.push(E)}}}}}return new dt(t).toList()}isAcceptablePush(e,t){const n=t.getScores(),i=Hs.get().isLegal(e,t);if(i.isSuccess()){const o=t.getCurrentOpponent().value;return!(new Hi(i.get(),t.turn+1).getScores()[o]>n[o])}return!1}getMetrics(e){return e.gameState.getScores()}}const tn=Ce.EMPTY,Jr=Ce.UNREACHABLE,Vs=Ce.ZERO,su=Ce.ONE;class bae extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,Hi.getInitialState()),W.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,Hi.getInitialState(),R2.fromSingleCoord(new C(2,6),be.UP).get(),$localize`Congratulations!`),W.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new Hi([[Jr,Jr,Jr,Jr,tn,Vs,Vs,su,su],[Jr,Jr,Jr,tn,tn,tn,tn,tn,tn],[Jr,Jr,tn,Vs,Vs,Vs,su,Vs,tn],[Jr,tn,tn,tn,tn,tn,tn,tn,tn],[tn,tn,tn,tn,Vs,Vs,Vs,su,su],[tn,tn,tn,tn,tn,tn,tn,tn,Jr],[tn,tn,tn,tn,Vs,su,tn,Jr,Jr],[tn,tn,tn,Vs,tn,tn,Jr,Jr,Jr],[tn,tn,Vs,tn,tn,Jr,Jr,Jr,Jr]],0),[R2.fromSingleCoord(new C(4,4),be.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)])}}function C7t(r,e){if(1&r){const t=pe();A(),S(0,"circle",6),U("click",function(){te(t);const i=p(2).index,o=p().index;return ne(p().onPieceClick(i,o))}),P()}if(2&r){const t=p(2).index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),k("cx",i.getCenterAtXY(t,n).x)("cy",i.getCenterAtXY(t,n).y)("r",.5*i.SPACE_SIZE)}}function y7t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"polygon",4),U("click",function(){te(t);const i=p().index,o=p().index;return ne(p().onSpaceClick(i,o))}),P(),T(2,C7t,1,6,"circle",5),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();_(1),ye("id","space_",n,"_",o,""),y("ngClass",s.getSquareClasses(n,o)),k("points",s.getHexaPointsAtXY(n,o)),_(1),y("ngIf",s.isPiece(i))}}function M7t(r,e){if(1&r&&(A(),S(0,"g"),T(1,y7t,3,5,"g",3),P()),2&r){const t=e.$implicit,n=p(2);_(1),y("ngIf",n.isBoard(t))}}function E7t(r,e){if(1&r&&(A(),S(0,"g"),T(1,M7t,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function S7t(r,e){1&r&&(A(),S(0,"marker",7),F(1,"polygon",8),P()),2&r&&Dn("id","arrowhead_",e.$implicit.dir.toString(),"")}function P7t(r,e){if(1&r){const t=pe();A(),S(0,"g"),F(1,"line",9),S(2,"line",10),U("click",function(){const o=te(t).$implicit;return ne(p().chooseDirection(o.dir))}),P(),S(3,"polygon",11),U("click",function(){const o=te(t).$implicit;return ne(p().chooseDirection(o.dir))}),P()()}if(2&r){const t=e.$implicit;_(1),Dn("id","line_start_",t.dir.toString(),""),k("x1",t.startCenter.x)("y1",t.startCenter.y)("x2",t.middle.x)("y2",t.middle.y),_(1),Dn("id","line_end_",t.dir.toString(),""),k("x1",t.middle.x)("y1",t.middle.y)("x2",t.landingCenter.x)("y2",t.landingCenter.y),_(1),Dn("id","direction_",t.dir.toString(),""),k("transform",t.transformation)}}class T7t{constructor(e,t,n,i,o,s){u(this,"startCenter",void 0),u(this,"middle",void 0),u(this,"landingCenter",void 0),u(this,"landing",void 0),u(this,"dir",void 0),u(this,"transformation",void 0),this.startCenter=e,this.middle=t,this.landingCenter=n,this.landing=i,this.dir=o,this.transformation=s}}let O7t=(()=>{var r;class e extends iu{constructor(n){super(n),u(this,"moveds",[]),u(this,"directions",[]),u(this,"selecteds",[]),this.rules=Hs.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new v7t(this.rules,"Dummy")],this.encoder=R2.encoder,this.tutorial=(new bae).tutorial,this.scores=g.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new ou(this.SPACE_SIZE,new C(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),iC.INSTANCE)}updateBoard(n){var i=this;return M(function*(){i.hexaBoard=i.getState().getCopiedBoard(),i.scores=g.of(i.getState().getScores())})()}hideLastMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(n){var i=this;return M(function*(){n.isSingleCoord()?i.showPushingMove(n):i.showSideStepMove(n)})()}showPushingMove(n){const i=this.getPreviousState();let o=n.coord;for(this.moveds=[o],o=o.getNext(n.dir);Hi.isOnBoard(o)&&i.isPiece(o);)this.moveds.push(o),o=o.getNext(n.dir);Hi.isOnBoard(o)&&this.moveds.push(o)}showSideStepMove(n){let i=n.lastPiece.get();const o=n.coord.getDirectionToward(i).get();i=i.getNext(o);let s=n.coord;for(;!1===s.equals(i);)this.moveds.push(s),this.moveds.push(s.getNext(n.dir)),s=s.getNext(o)}onPieceClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#piece_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=o.getState().getCurrentOpponent();return o.hexaBoard[i][n].is(a)?o.opponentClick(n,i):0===o.selecteds.length?o.firstClick(n,i):1===o.selecteds.length?o.secondClick(n,i):o.thirdClick(n,i)})()}opponentClick(n,i){var o=this;return M(function*(){return(yield o.tryChoosingDirection(n,i)).isSuccess()?b.SUCCESS:o.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(n,i){var o=this;return M(function*(){return o.selecteds=[new C(n,i)],o.showPossibleDirections(),b.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(n){const i=this.getState(),o=Ce.ofPlayer(i.getCurrentPlayer()),s=this.selecteds[0],a=this.selecteds[this.selecteds.length-1];for(const c of be.factory.all){let f,l=s.getNext(c,1);if(i.isOnBoard(l)&&i.getPieceAt(l)===o){if(n)continue;if(l=a.getNext(c,1),i.isOnBoard(l)&&i.getPieceAt(l)===o)continue}if(f=n?R2.fromSingleCoord(s,c).get():R2.fromDoubleCoord(s,a,c).get(),this.rules.isLegal(f,i).isSuccess()){const m=this.getCenterAt(s),E=this.getCenterAt(l),w=this.getMiddleOfArrow(c,l,E),L=E.x+" "+E.y,$="rotate("+(be.getAngle(c)+150)+" "+L+")",_e=new T7t(m,w,E,l,c,$+" translate("+L+")");this.directions.push(_e)}}}getMiddleOfArrow(n,i,o){const s=i.getPrevious(n),a=this.getCenterAt(s);return new C(a.x+(o.x-a.x)/2,a.y+(o.y-a.y)/2)}isBoard(n){return n!==Ce.UNREACHABLE}isPiece(n){return n!==Ce.EMPTY}secondClick(n,i){var o=this;return M(function*(){const s=o.selecteds[0],a=new C(n,i);if(a.equals(s))return o.cancelMoveAttempt(),b.SUCCESS;if(!1===a.isHexagonallyAlignedWith(s))return o.cancelMoveAttempt(),o.firstClick(n,i);const c=a.getDistance(s);if(c>2)return o.cancelMove(yl.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const l=s.getDirectionToward(a).get();o.selecteds=[s];for(let f=0;f<c;f++)o.selecteds.push(s.getNext(l,f+1));if(3===o.selecteds.length){const f=o.selecteds[1],d=o.getState().getCurrentPlayer();if(!1===o.hexaBoard[f.y][f.x].is(d))return o.cancelMoveAttempt(),o.firstClick(n,i)}return o.showPossibleDirections(),b.SUCCESS})()}thirdClick(n,i){var o=this;return M(function*(){const s=new C(n,i),a=o.selecteds[0];if(s.equals(a))return o.deselectExtremity(!0);const c=o.selecteds[o.selecteds.length-1];return s.equals(c)?o.deselectExtremity(!1):3===o.selecteds.length&&s.equals(o.selecteds[1])?(o.cancelMoveAttempt(),b.SUCCESS):o.tryExtension(s,a,c)})()}tryExtension(n,i,o){var s=this;return M(function*(){const a=Me.factory.fromMove(i,n);if(a.isSuccess()){const l=Me.factory.fromMove(o,n);if(a.equals(l)){const f=i.getDistance(n),d=o.getDistance(n);return 2===Math.max(f,d)?(s.selecteds.push(n),Re.sortByDescending(s.selecteds,R2.sortCoord),s.showPossibleDirections(),b.SUCCESS):s.cancelMove(yl.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=yield s.cancelMove(yl.LINE_AND_COORD_NOT_ALIGNED());return yield s.firstClick(n.x,n.y),c})()}deselectExtremity(n){var i=this;return M(function*(){return i.selecteds=i.selecteds.slice(n?1:0,n?void 0:-1),i.showPossibleDirections(),b.SUCCESS})()}chooseDirection(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#direction_"+n.toString());return o.isFailure()?i.cancelMove(o.getReason()):i._chooseDirection(n)})()}_chooseDirection(n){var i=this;return M(function*(){const o=i.selecteds[0];if(1===i.selecteds.length){const s=R2.fromSingleCoord(o,n).get();return i.chooseMove(s)}{const a=R2.fromDoubleCoord(o,i.selecteds[i.selecteds.length-1],n).get();return i.chooseMove(a)}})()}onSpaceClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#space_"+n+"_"+i);return s.isFailure()?o.cancelMove(s.getReason()):o.tryChoosingDirection(n,i)})()}tryChoosingDirection(n,i){var o=this;return M(function*(){const s=new C(n,i);for(const a of o.directions)if(a.landing.equals(s))return o._chooseDirection(a.dir);return b.failure("not a direction")})()}getSquareClasses(n,i){const o=new C(n,i),s=[];return this.moveds.some(a=>a.equals(o))&&s.push("moved-fill"),s}getPieceClasses(n,i){const o=new C(n,i),s=I.of(this.hexaBoard[i][n].value),a=[this.getPlayerClass(s)];return this.selecteds.some(c=>c.equals(o))&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-abalone"]],features:[Qe],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,E7t,2,1,"g",1),S(2,"defs"),T(3,S7t,2,1,"marker",2),P(),T(4,P7t,4,12,"g",1),P()),2&n&&(_(1),y("ngForOf",i.hexaBoard),_(2),y("ngForOf",i.directions),_(1),y("ngForOf",i.directions))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class b7t extends Sr{getListMoves(e){const t=e.gameState;return fs.ALL_MOVES.filter(function n(i){return e4.get().isLegal(i,t).isSuccess()})}getMetrics(e){const t=e.gameState.board[3].getDominatingPlayer(),n=[0,0];return t.isPlayer()&&(n[t.value]=1),n}}function w7t(r,e){if(1&r&&(A(),F(0,"circle",5)),2&r){const t=e.$implicit,n=p();k("cx",n.getRemainingPieceCx(t))("cy",n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function N7t(r,e){if(1&r&&(A(),F(0,"circle",6)),2&r){const t=e.$implicit,n=p();k("cx",n.BOARD_WIDTH-n.getRemainingPieceCx(t))("cy",n.BOARD_HEIGHT-n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function A7t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",9),U("click",function(){te(t);const i=p().index,o=p();return ne(o.onArrowClick(i,o.PlayerOrNone.ZERO))}),P()}if(2&r){const t=p().index,n=p();Dn("id","dropArrow_zero_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ZERO)),k("points",n.ARROW_COORD)("transform","translate("+n.SPACE_SIZE/2+" "+-n.SPACE_SIZE/2+")")}}function I7t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",9),U("click",function(){te(t);const i=p().index,o=p();return ne(o.onArrowClick(i,o.PlayerOrNone.ONE))}),P()}if(2&r){const t=p().index,n=p();Dn("id","dropArrow_one_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ONE)),k("points",n.ARROW_COORD)("transform","translate(0 "+-n.SPACE_SIZE/2+")")}}function k7t(r,e){if(1&r){const t=pe();A(),Bt(0),S(1,"circle",10),U("click",function(){te(t);const i=p().index;return ne(p().onSquareClick(i))}),P(),Gt()}if(2&r){const t=e.$implicit,n=p(),i=n.index,o=n.$implicit,s=p();_(1),Oi("id","square_",i,"_piece_",t,"_out_of_",o.count(s.PlayerOrNone.NONE),""),y("ngClass",s.getPieceClasses(i,t,o)),k("cx",s.getCircleCenter(i,t,o).x)("cy",s.getCircleCenter(i,t,o).y)}}function x7t(r,e){if(1&r){const t=pe();A(),S(0,"g"),T(1,A7t,1,4,"polygon",7),T(2,I7t,1,4,"polygon",7),S(3,"rect",8),U("click",function(){const o=te(t).index;return ne(p().onSquareClick(o))}),P(),T(4,k7t,2,6,"ng-container",4),P()}if(2&r){const t=e.$implicit,n=e.index,i=p();k("transform",i.getBlockTransform(n)),_(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ZERO)),_(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ONE)),_(1),Dn("id","square_",n,""),y("ngClass",i.getSquareClasses(n)),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngForOf",i.ArrayUtils.range(t.count(i.PlayerOrNone.NONE)))}}let wae,L7t=(()=>{var r;class e extends Cl{static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}constructor(n){super(n),u(this,"PlayerOrNone",K),u(this,"BOARD_WIDTH",4*this.SPACE_SIZE),u(this,"BOARD_HEIGHT",4.5*this.SPACE_SIZE),u(this,"board",void 0),u(this,"remainingZero",void 0),u(this,"remainingOne",void 0),u(this,"ARROW_COORD",e.getArrowCoord()),u(this,"PIECES_PER_PLAYER",vl.PIECES_PER_PLAYER),u(this,"PIECE_RADIUS",void 0),u(this,"movedSquare",void 0),u(this,"selectedPiece",g.empty()),u(this,"leftPiece",g.empty()),u(this,"droppedPiece",g.empty()),u(this,"displayableArrow",[]),this.rules=e4.get(),this.node=this.rules.getInitialNode(),this.hasAsymmetricBoard=!0,this.availableMinimaxes=[new b7t(this.rules,"ApagosDummyMinimax")],this.encoder=fs.encoder,this.tutorial=(new yae).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5)}cancelMoveAttempt(){this.selectedPiece=g.empty(),this.showPossibleDrops()}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.board,i.remainingZero=o.remaining.get(I.ZERO).get(),i.remainingOne=o.remaining.get(I.ONE).get(),i.hideLastMove(),i.showPossibleDrops()})()}hideLastMove(){this.movedSquare=[],this.droppedPiece=g.empty(),this.leftPiece=g.empty(),this.selectedPiece=g.empty()}showLastMove(n){var i=this;return M(function*(){n.isDrop()?i.showLastDrop(n):i.showLastTransfer(n)})()}showLastDrop(n){const i=n.piece.get();let o=n.landing.x;this.movedSquare=[o],3!==n.landing.x&&(o+=1,this.movedSquare.push(o));const a=this.getLowestPlayerPiece(this.board[o],i);this.droppedPiece=g.of({square:o,piece:a})}getLowestPlayerPiece(n,i){const o=n.count(i);return i===I.ZERO?o-1:n.count(K.NONE)-o}showLastTransfer(n){const i=this.getPreviousState(),o=i.getCurrentPlayer(),s=n.starting.get().x,c=this.getLowestPlayerPiece(i.board[s],o);this.leftPiece=g.of({square:s,piece:c});const l=n.landing.x,d=this.getLowestPlayerPiece(this.board[l],o);this.droppedPiece=g.of({square:l,piece:d})}showPossibleDrops(){this.displayableArrow=[];const n=this.getState();for(let i=0;i<4;i++)!1===n.board[i].isFull()&&(n.remaining.get(I.ZERO).get()>0&&this.displayableArrow.push({x:i,player:I.ZERO}),n.remaining.get(I.ONE).get()>0&&this.displayableArrow.push({x:i,player:I.ONE}))}getCircleCenter(n,i,o){const s=this.SPACE_SIZE/2,a=this.SPACE_SIZE/2;if(1===o.count(K.NONE))return new C(s,a);const c=o.count(K.NONE),l=2*i*Math.PI/c-Math.PI/2,f=.3*this.SPACE_SIZE,d=f*Math.cos(l),m=f*Math.sin(l);return new C(s+d,a+m)}canDisplayArrow(n,i){return this.displayableArrow.some(o=>o.x===n&&o.player.equals(i))}getArrowClasses(n,i){return[this.getPlayerClass(i)]}getBlockTransform(n){return"translate("+n*this.SPACE_SIZE+", "+((3-n)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(n){const i=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===n?i.push("selected-stroke"):this.movedSquare.includes(n)&&i.push("last-move-stroke"),i}onArrowClick(n,i){var o=this;return M(function*(){const s=i===I.ZERO?"zero":"one",a=yield o.canUserPlay("#dropArrow_"+s+"_"+n);if(a.isFailure())return o.cancelMove(a.getReason());const c=Jt.of(n);if(o.selectedPiece.isPresent()){const l=o.selectedPiece.get().square,f=fs.transfer(Jt.of(l),c).get();return o.chooseMove(f)}{const l=fs.drop(c,i);return o.chooseMove(l)}})()}getPieceClasses(n,i,o){const s={square:n,piece:i},a=[];let c=o.count(I.ZERO),l=o.count(I.ONE);if(this.selectedPiece.equalsValue(s))a.push("selected-stroke");else if(this.droppedPiece.equalsValue(s))a.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===n){if(this.leftPiece.get().piece===i)return a.push("captured-stroke"),a;this.getState().getCurrentOpponent()===I.ZERO?c++:l++}const f=o.count(K.NONE)-(l+c),d=this.getPieceColor(i,c,f);return""!==d&&a.push(d),a}getPieceColor(n,i,o){return n<i?"player0-fill":n>=i+o?"player1-fill":""}onSquareClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#square_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(i.selectedPiece.isPresent()&&i.selectedPiece.get().square===n)return i.cancelMoveAttempt(),b.SUCCESS;const s=i.getState().getCurrentPlayer(),a=i.board[n];return a.count(s)<=0?i.cancelMove(nu.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(i.selectedPiece=g.of({square:n,piece:i.getLowestPlayerPiece(a,s)}),0===i.showAndGetPossibleTranfers().length?i.cancelMove(nu.NO_POSSIBLE_TRANSFER_REMAINS()):b.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let n=this.selectedPiece.get().square-1;const i=this.getState().getCurrentPlayer();for(;0<=n;)!1===this.board[n].isFull()&&this.displayableArrow.push({x:n,player:i}),n--;return this.displayableArrow}getRemainingPieceCx(n){return(n+.5)*this.PIECE_RADIUS*1.5}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-apagos"]],features:[Qe],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g"),T(2,w7t,1,3,"circle",1),T(3,N7t,1,3,"circle",2),P(),S(4,"g",3),T(5,x7t,5,8,"g",4),P()()),2&n&&(k("viewBox",-i.STROKE_WIDTH/2+" "+-i.STROKE_WIDTH/2+" "+(i.BOARD_WIDTH+i.STROKE_WIDTH)+" "+(i.BOARD_HEIGHT+i.STROKE_WIDTH)),_(1),k("transform","rotate("+180*i.role.value+" "+i.BOARD_WIDTH/2+" "+i.BOARD_HEIGHT/2+")"),_(1),y("ngForOf",i.ArrayUtils.range(i.remainingOne)),_(1),y("ngForOf",i.ArrayUtils.range(i.remainingZero)),_(2),y("ngForOf",i.board))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),_n=(()=>{class r extends B1{static getInitialState(){const t=Re.createTable(r.WIDTH,2,4);return new r(t,0,[0,0])}constructor(t,n,i){super(t,n),u(this,"scores",void 0),this.scores=i}getScoresCopy(){return[this.scores[0],this.scores[1]]}equals(t){return!1!==Re.compareTable(this.board,t.board)&&!1!==Re.compareArray(this.scores,t.scores)&&this.turn===t.turn}getCurrentPlayerY(){return this.getCurrentOpponent().value}getOpponentY(){return this.getCurrentPlayer().value}}return u(r,"WIDTH",6),r})(),au=(()=>{class r{}return u(r,"MUST_DISTRIBUTE_YOUR_OWN_HOUSES",()=>$localize`You must distribute one of your houses.`),u(r,"MUST_CHOOSE_NON_EMPTY_HOUSE",()=>$localize`You should choose a non-empty house to distribute.`),u(r,"SHOULD_DISTRIBUTE",()=>$localize`You should feed but you do not.`),r})();class ho extends Yn{static isStarving(e,t){let n=0;const i=e.getOpponent().value;for(;n<_n.WIDTH;)if(t[i][n++]>0)return!1;return!0}constructor(e){super(_n),u(this,"config",void 0),this.config=e}mustMansoon(e){const t=e.getCopiedBoard(),n=e.getCurrentOpponent(),i=e.getCurrentPlayer();if(this.config.mustFeed){if(ho.isStarving(i,t)&&!1===this.canDistribute(n,t))return n}else{if(ho.isStarving(n,t))return i;if(ho.isStarving(i,t))return n}return K.NONE}getGameStatus(e){const t=e.gameState;return t.scores[0]>24?ve.ZERO_WON:t.scores[1]>24?ve.ONE_WON:24===t.scores[0]&&24===t.scores[1]?ve.DRAW:ve.ONGOING}applyLegalMove(e,t,n){const i=this.distributeMove(e,t),o=this.applyCapture(i);let s=o.resultingState;const a=this.mustMansoon(s);return a!==K.NONE&&(s=this.monsoon(a,o).resultingState),new _n(s.board,s.turn+1,s.scores)}distributeHouse(e,t,n){let i=new C(e,t);const o=n.getCopiedBoard(),s=n.getCurrentPlayer(),a=new C(e,t);let c=o[t][e];const l=[];o[t][e]=0;let f=0,d=!1,m=!1;for(;c>0;){d=m,m=!1;const E=this.getNextCoord(i,s,d);m=E.isAbsent(),m?(f++,c--,l.push(ho.FAKE_STORE_COORD.get(s).get())):(i=E.get(),(!1===a.equals(i)||this.config.feedOriginalHouse)&&(o[i.y][i.x]+=1,l.push(i),c--))}return{filledCoords:l,passedByKalahNTimes:f,endsUpInKalah:m,resultingState:new _n(o,n.turn,n.getScoresCopy())}}getNextCoord(e,t,n){return 0===e.y?e.x===_n.WIDTH-1?this.config.passByPlayerStore&&t===I.ONE&&!1===n?g.empty():g.of(new C(e.x,1)):g.of(new C(e.x+1,e.y)):0===e.x?this.config.passByPlayerStore&&t===I.ZERO&&!1===n?g.empty():g.of(new C(e.x,0)):g.of(new C(e.x-1,e.y))}doesDistribute(e,t,n){return 0===t?n[t][e]>_n.WIDTH-1-e:n[t][e]>e}canDistribute(e,t){for(let n=0;n<_n.WIDTH;n++)if(this.doesDistribute(n,e.getOpponent().value,t))return!0;return!1}monsoon(e,t){const n=t.resultingState,i=n.getCopiedBoard(),o=n.getScoresCopy();let s=0;const a=Re.copyBiArray(t.captureMap);let c=0;const l=e.getOpponent().value;for(;c<_n.WIDTH;)s+=i[l][c],a[l][c]+=i[l][c],i[l][c]=0,c++;return o[e.value]+=s,{capturedSum:s,captureMap:a,resultingState:new _n(i,n.turn,o)}}}u(ho,"FAKE_STORE_COORD",new eu([{key:I.ZERO,value:new C(-1,-1)},{key:I.ONE,value:new C(2,2)}]));class Ta extends ho{static get(){return Ta.singleton.isAbsent()&&(Ta.singleton=g.of(new Ta)),Ta.singleton.get()}constructor(){super({passByPlayerStore:!1,mustFeed:!0,feedOriginalHouse:!1})}distributeMove(e,t){const n=t.getCurrentPlayerY();return this.distributeHouse(e.x,n,t)}applyCapture(e){const t=e.filledCoords,n=t[t.length-1];return this.captureIfLegal(n.x,n.y,e.resultingState)}isLegal(e,t){const n=t.getCurrentOpponent(),i=t.getCurrentPlayerY(),o=e.x;if(0===t.getPieceAtXY(o,i))return b.failure(au.MUST_CHOOSE_NON_EMPTY_HOUSE());const s=ho.isStarving(n,t.board),a=!1===this.doesDistribute(o,i,t.board);return s&&a?b.failure(au.SHOULD_DISTRIBUTE()):b.SUCCESS}capture(e,t,n){const i=n.getCurrentPlayerY();q.assert(t!==i,"AwaleRules.capture cannot capture the players house");const o=n.getCopiedBoard();let s=o[t][e],a=0;const c=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(s<2||s>3)return{capturedSum:0,captureMap:c,resultingState:n};let l=-1,f=-1;n.getCurrentPlayer()===I.ONE&&(l=1,f=_n.WIDTH);do{c[t][e]=s,a+=s,o[t][e]=0,s=o[t][e+=l]}while(e!==f&&(2===s||3===s));const d=n.getScoresCopy();return d[n.getCurrentPlayer().value]+=a,{capturedSum:a,captureMap:c,resultingState:new _n(o,n.turn,d)}}captureIfLegal(e,t,n){const i=n.getCurrentPlayer(),o={capturedSum:0,resultingState:n,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]};if(t===i.getOpponent().value)return o;{const s=this.capture(e,t,n),a=ho.isStarving(i.getOpponent(),s.resultingState.board);return s.capturedSum>0&&a?o:s}}}var Ml,El;u(Ta,"singleton",g.empty());class l1{static of(e){switch(e){case 0:return l1.ZERO;case 1:return l1.ONE;case 2:return l1.TWO;case 3:return l1.THREE;case 4:return l1.FOUR;default:return q.expectToBe(e,5,"Invalid x for AwaleMove: "+e),l1.FIVE}}constructor(e){u(this,"x",void 0),this.x=e}equals(e){return e===this||e.x===this.x}}Ml=l1,u(l1,"encoder",we.tuple([we.identity()],r=>[r.x],r=>Ml.of(r[0]))),u(l1,"ZERO",new Ml(0)),u(l1,"ONE",new Ml(1)),u(l1,"TWO",new Ml(2)),u(l1,"THREE",new Ml(3)),u(l1,"FOUR",new Ml(4)),u(l1,"FIVE",new Ml(5)),wae=Symbol.iterator;class Nae extends Ri{constructor(e){super(),u(this,"distributions",void 0),this.distributions=e}[wae](){return this.distributions.values()}}class d1 extends Nae{static of(e){switch(e){case 0:return d1.ZERO;case 1:return d1.ONE;case 2:return d1.TWO;case 3:return d1.THREE;case 4:return d1.FOUR;default:return q.expectToBe(e,5,"Invalid x for AwaleMove: "+e),d1.FIVE}}constructor(e){super([l1.of(e)]),u(this,"x",void 0),this.x=e}equals(e){return e===this||e.x===this.x}toString(){return"AwaleMove("+this.x+")"}}u(d1,"ZERO",new(El=d1)(0)),u(d1,"ONE",new El(1)),u(d1,"TWO",new El(2)),u(d1,"THREE",new El(3)),u(d1,"FOUR",new El(4)),u(d1,"FIVE",new El(5)),u(d1,"encoder",we.tuple([we.identity()],r=>[r.x],r=>El.of(r[0])));class R7t extends Sr{constructor(){super(Ta.get(),"AwaleMinimax")}getListMoves(e){const t=[],n=e.gameState,o=(n.turn+1)%2;let s,a=0;for(;a<_n.WIDTH;)0!==n.getPieceAtXY(a,o)&&(s=d1.of(a),this.ruler.isLegal(s,n).isSuccess()&&(s=d1.of(a),t.push(s))),a++;return this.orderMoves(e,t)}orderMoves(e,t){const n=e.gameState.getCurrentPlayer(),i=e.gameState.getOpponentY(),o=n.value;return Re.sortByDescending(t,s=>{const c=e.gameState.getCopiedBoard()[i][s.x],f=Ta.get().distributeMove(s,e.gameState).filledCoords,d=f[f.length-1];let m,E=0;return d.y===i?(m=0,c<=_n.WIDTH&&(E=10)):m=Ta.get().captureIfLegal(d.x,o,e.gameState).capturedSum,100*m+E-c}),t}getMetrics(e){const t=e.gameState.getScoresCopy();return[t[0],t[1]]}}let Aae=(()=>{class r{}return u(r,"SOWING",e=>W.fromMove($localize`Sowing`,$localize`The main move in Mancala games is sowing, let's see how seeds are sown. As you are playing Dark, the 6 houses on the bottom are yours.<br/><br>Click on the rightmost bottom house to sow the seeds it contains: they will be sown clockwise, one seed per house.<br/><br/>Click on the rightmost house!`,_n.getInitialState(),[e],$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds. This is how seeds are sown: one by one from the house next to the one they come from, clockwise.`,$localize`Failed. Choose the rightmost house on the bottom.`)),r})();class Iae extends Zn{constructor(...e){super(...e),u(this,"gameName",$localize`Awalé`),u(this,"tutorial",[W.informational(this.gameName,$localize`${this.gameName} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player won. As you are playing Dark, the 6 houses on the bottom are yours.`,_n.getInitialState()),W.informational($localize`Awalé`,$localize`Bonus fact: Awalé is the most common of all Mancalas.`,_n.getInitialState()),Aae.SOWING(d1.FIVE),W.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new _n([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),d1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),W.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new _n([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[d1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),W.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which now contains 2 seeds, so this will be a capture. But now, the house right before it contains 3 seeds, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new _n([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[d1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),W.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new _n([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[d1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),W.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new _n([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[d1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),W.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>You're playing Dark. Try it.`,new _n([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[d1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),W.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new _n([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),d1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),W.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new _n([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[23,10]),d1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side. Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)])}}let Vi=(()=>{var r;class e extends Cl{constructor(...n){super(...n),u(this,"board",void 0)}getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}()),u(e,"\u0275cmp",je({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();function kae(r){return 1e3*r.seconds+r.nanoseconds/1e6}function xae(r,e){return kae(e)-kae(r)}class bL{static sleep(e){return M(function*(){return new Promise(t=>{window.setTimeout(t,e)})})()}}let Lae=(()=>{class r extends Vi{constructor(t,n){super(t),u(this,"cdr",void 0),u(this,"MGPOptional",g),u(this,"lastDistributedHouses",[]),u(this,"currentMove",g.empty()),u(this,"clickOngoing",!1),u(this,"captured",[[0,0,0,0,0,0],[0,0,0,0,0,0]]),u(this,"droppedInStore",[0,0]),u(this,"filledCoords",[]),u(this,"constructedState",void 0),u(this,"opponentMoveIsBeingAnimated",!1),this.cdr=n,this.hasAsymmetricBoard=!0,this.scores=g.of([0,0])}showLastMove(t){var n=this;return M(function*(){n.droppedInStore=[0,0];const i=n.getPreviousState(),o=n.rules.distributeMove(t,i);n.filledCoords=o.filledCoords;let s=n.rules.applyCapture(o);n.captured=s.captureMap;const a=i.getCurrentPlayerY();n.lastDistributedHouses=t.distributions.map(l=>new C(l.x,a));const c=n.rules.mustMansoon(s.resultingState);c!==K.NONE&&(s=n.rules.monsoon(c,s),n.captured=s.captureMap),n.changeVisibleState(n.getState())})()}updateBoard(t){var n=this;return M(function*(){const i=n.getState();if(t){n.opponentMoveIsBeingAnimated=!0,q.assert(n.node.mother.isPresent(),"triggerAnimation in store should be false at first turn"),n.changeVisibleState(n.node.mother.get().gameState);let o=0;const s=n.node.move.get();for(const a of s)yield n.showSimpleDistribution(a),o+1<s.distributions.length&&(yield bL.sleep(r.TIMEOUT_BETWEEN_DISTRIBUTION)),o++;n.opponentMoveIsBeingAnimated=!1}n.scores=g.of(i.getScoresCopy()),n.changeVisibleState(i)})()}onClick(t,n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+t+"_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(!0===i.clickOngoing)return b.SUCCESS;if(!0===i.opponentMoveIsBeingAnimated)return b.SUCCESS;{i.clickOngoing=!0;const s=yield i.onLegalClick(t,n);return i.clickOngoing=!1,s}})()}onLegalClick(t,n){var i=this;return M(function*(){return n===i.getState().getCurrentPlayer().value?i.cancelMove(au.MUST_DISTRIBUTE_YOUR_OWN_HOUSES()):(i.updateOrCreateCurrentMove(t),0===i.constructedState.getPieceAtXY(t,n)?i.cancelMove(au.MUST_CHOOSE_NON_EMPTY_HOUSE()):i.continueMoveConstruction(t))})()}continueMoveConstruction(t){var n=this;return M(function*(){const i=yield n.showSimpleDistribution(l1.of(t));if(i.endsUpInKalah){const o=n.constructedState.getCurrentPlayer();return ho.isStarving(o,i.resultingState.board)?n.chooseMove(n.currentMove.get()):b.SUCCESS}return n.chooseMove(n.currentMove.get())})()}showSimpleDistribution(t){var n=this;return M(function*(){const i=n.constructedState,o=i.getCurrentPlayerY(),s=new C(t.x,o);return n.lastDistributedHouses.push(s),yield n.showSeedBySeed(s,i),n.rules.distributeHouse(t.x,o,i)})()}showSeedBySeed(t,n){var i=this;return M(function*(){const o=n.getCopiedBoard(),s=n.getCurrentPlayer(),a=t;let c=o[t.y][t.x],l=!1;const f=n.getScoresCopy();for(o[t.y][t.x]=0,i.changeVisibleState(new _n(o,n.turn,f)),yield bL.sleep(r.TIMEOUT_BETWEEN_SEED);c>0;){const d=i.rules.getNextCoord(t,s,l);l=d.isAbsent(),l?(c--,i.filledCoords.push(ho.FAKE_STORE_COORD.get(s).get()),i.droppedInStore[s.value]+=1,f[s.value]+=1):(t=d.get(),(!1===a.equals(t)||i.rules.config.feedOriginalHouse)&&(o[t.y][t.x]+=1,i.filledCoords.push(t),c--)),i.changeVisibleState(new _n(o,n.turn,f)),yield bL.sleep(r.TIMEOUT_BETWEEN_SEED)}})()}hideLastMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}cancelMoveAttempt(){this.currentMove=g.empty(),this.droppedInStore=[0,0],this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}getSpaceClasses(t,n){const i=new C(t,n),o=this.getSpaceOwner(i),s=this.getPlayerClass(o);return this.getStoreOwner(i).isAbsent()&&this.captured[n][t]>0?["captured-fill","moved-stroke"]:this.lastDistributedHouses.some(a=>a.equals(i))?["last-move-stroke",s]:this.filledCoords.some(a=>a.equals(i))?["moved-stroke",s]:[s]}getStoreOwner(t){return ho.FAKE_STORE_COORD.reverse().get(t)}getSpaceOwner(t){const n=this.getStoreOwner(t);return n.isPresent()?n.get().getAnyElement().get():I.of((t.y+1)%2)}getPieceCx(t){return 80+100*(t+1)}getPieceCy(t){return 60+120*t}getPieceTransform(t,n){return"translate("+this.getPieceCx(t)+", "+this.getPieceCy(n)+")"}getPieceRotation(){return"rotate("+180*this.role.value+")"}getHouseSecondaryContent(t,n){const i=this.getPreviousStableState().getPieceAtXY(t,n),s=this.constructedState.getPieceAtXY(t,n)-i;return this.captured[n][t]>0?g.of("-"+this.captured[n][t]):s>0?g.of("+"+s):s<0?g.of(""+s):g.empty()}getStoreContent(t){return this.scores.get()[t.value]+this.droppedInStore[t.value]}getStoreSecondaryContent(t){const n=this.getPreviousStableState().scores[t.value],o=this.constructedState.scores[t.value]-n;return o>0?g.of("+"+o):g.empty()}getPreviousStableState(){return this.opponentMoveIsBeingAnimated?(q.assert(this.getTurn()>0,"Kalah: Should not animate move at turn 0"),this.node.mother.get().gameState):!0===this.constructedState.equals(this.getState())&&this.node.mother.isPresent()?this.node.mother.get().gameState:this.getState()}onStoreClick(t){var n=this;return M(function*(){const i=yield n.canUserPlay("#store_player_"+t.value);return i.isFailure()?n.cancelMove(i.getReason()):n.cancelMove(au.MUST_DISTRIBUTE_YOUR_OWN_HOUSES())})()}changeVisibleState(t){this.constructedState=t,this.board=this.constructedState.board,this.cdr.detectChanges()}}return u(r,"TIMEOUT_BETWEEN_SEED",200),u(r,"TIMEOUT_BETWEEN_DISTRIBUTION",1e3),r})();class z7t extends Lae{constructor(e,t){super(e,t)}updateOrCreateCurrentMove(e){this.currentMove=g.of(this.generateMove(e))}}const D7t=["app-numbered-circle",""];function H7t(r,e){if(1&r&&(A(),S(0,"text",3),lt(1),P()),2&r){const t=p();ye("id","secondary_message_",t.x,"_",t.y,""),k("x",15)("y",31)("transform",t.rotation),_(1),P2(" ",t.secondaryContent.get()," ")}}let Rae=(()=>{var r;class e{constructor(){u(this,"x",void 0),u(this,"y",void 0),u(this,"spaceClasses",void 0),u(this,"content",void 0),u(this,"secondaryContent",void 0),u(this,"rotation",void 0)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",je({type:r,selectors:[["","app-numbered-circle",""]],inputs:{x:"x",y:"y",spaceClasses:"spaceClasses",content:"content",secondaryContent:"secondaryContent",rotation:"rotation"},attrs:D7t,decls:4,vars:10,consts:[["r","45",1,"base",3,"id","ngClass"],[1,"text-big","text-center",3,"id"],["class","text-20 text-center",3,"id",4,"ngIf"],[1,"text-20","text-center",3,"id"]],template:function(n,i){1&n&&(A(),F(0,"circle",0),S(1,"text",1),lt(2),P(),T(3,H7t,2,6,"text",2)),2&n&&(ye("id","circle_",i.x,"_",i.y,""),y("ngClass",i.spaceClasses),_(1),ye("id","number_",i.x,"_",i.y,""),k("x",0)("y",16)("transform",i.rotation),_(1),P2(" ",i.content," "),_(1),y("ngIf",i.secondaryContent.isPresent()))},dependencies:[Ft,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();function V7t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",8),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),ye("id","click_",n,"_",i,""),y("x",n)("y",i)("content",t)("spaceClasses",o.getSpaceClasses(n,i))("rotation",o.getPieceRotation())("secondaryContent",o.getHouseSecondaryContent(n,i)),k("transform",o.getPieceTransform(n,i))}}function F7t(r,e){if(1&r&&(A(),S(0,"g"),T(1,V7t,2,9,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let $7t=(()=>{var r;class e extends z7t{constructor(n,i){super(n,i),this.rules=Ta.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new R7t],this.encoder=d1.encoder,this.tutorial=(new Iae).tutorial}generateMove(n){return d1.of(n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut),G(y3))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-awale-component"]],features:[Qe],decls:8,vars:14,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 870 250","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","width","860","height","240","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","x2","740","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["x1","740","y1","0","x2","740","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","","transform","translate(800 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),F(1,"rect",1),T(2,F7t,2,1,"g",2),F(3,"line",3)(4,"line",4)(5,"line",5),S(6,"g",6),U("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),S(7,"g",7),U("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(k("transform",i.rotation),_(2),y("ngForOf",i.board),_(4),y("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),_(1),y("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)))},dependencies:[Wt,Rae],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Ho extends Ri{static getFallibleEncoder(e){return we.tuple([C.encoder,C.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]).get())}static getEncoder(e){return we.tuple([C.encoder,C.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]))}constructor(e,t){super(),u(this,"first",void 0),u(this,"second",void 0),this.first=e,this.second=t}getFirst(){return this.first}getSecond(){return this.second}}class Fs extends Ho{constructor(e,t){if(super(e,t),e.equals(t))throw new Error(Le.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return Me.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}equals(e){return this===e||!1!==this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}let oC=(()=>{class r{}return u(r,"LANDING_ON_OCCUPIED_SQUARE",()=>$localize`You cannot land on an occupied square.`),u(r,"THRONE_IS_LEFT_FOR_GOOD",()=>$localize`Once you left the central throne, you cannot return to it.`),u(r,"SOLDIERS_CANNOT_SIT_ON_THRONE",()=>$localize`Soldiers cannot sit on the throne.`),u(r,"MOVE_MUST_BE_ORTHOGONAL",()=>$localize`Tafl moves must be orthogonal.`),r})();class wL extends Fs{constructor(e,t){if(super(e,t),e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+t.toString()+".");const n=e.getDirectionToward(t);if(n.isFailure()||n.get().isDiagonal())throw new Error(oC.MOVE_MUST_BE_ORTHOGONAL())}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class po extends wL{static of(e,t){return new po(e,t)}static from(e,t){try{const n=new po(e,t);return ie.success(n)}catch(n){return ie.failure(n.message)}}getMaximalDistance(){return 7}}u(po,"encoder",Ho.getFallibleEncoder(po.from));const B7t={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:I.ZERO};var wd,sC;class on{constructor(e,t){u(this,"owner",void 0),u(this,"king",void 0),this.owner=e,this.king=t}isKing(){return this.king}getOwner(){return this.owner}}u(on,"UNOCCUPIED",new(wd=on)(K.NONE,!1)),u(on,"PLAYER_ONE_KING",new wd(K.ONE,!0)),u(on,"INVADERS",new wd(K.ZERO,!1)),u(on,"DEFENDERS",new wd(K.ONE,!1));class y1{constructor(e){u(this,"value",void 0),this.value=e}}u(y1,"NONE",new(sC=y1)("NONE")),u(y1,"OPPONENT",new sC("OPPONENT")),u(y1,"PLAYER",new sC("PLAYER"));class NL extends B1{isCentralThrone(e){return e.equals(this.getCentralThrone())}getCentralThrone(){const e=(this.board.length-1)/2;return new C(e,e)}getRelativeOwner(e,t){const n=this.getAbsoluteOwner(t);let i;return i=n===K.NONE?y1.NONE:e===n?y1.PLAYER:y1.OPPONENT,i}getAbsoluteOwner(e){return this.getPieceAt(e).getOwner()}}class Oa extends NL{static getInitialState(){const e=on.UNOCCUPIED,t=on.INVADERS,n=on.DEFENDERS;return new Oa([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,n,e,e,e],[t,t,n,on.PLAYER_ONE_KING,n,t,t],[e,e,e,n,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}of(e,t){return new Oa(e,t)}}class AL extends Yn{constructor(e,t,n){super(e),u(this,"config",void 0),u(this,"generateMove",void 0),this.config=t,this.generateMove=n}isLegal(e,t){const n=t.getCurrentPlayer(),i=this.getMoveValidity(n,e,t);return i.isFailure()?b.failure(i.getReason()):b.SUCCESS}getMoveValidity(e,t,n){const i=n.getRelativeOwner(e,t.getStart());if(i===y1.NONE)return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(i===y1.OPPONENT)return b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.getEnd())!==y1.NONE)return b.failure(oC.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.getEnd())){if(!n.getPieceAt(t.getStart()).isKing())return b.failure(oC.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return b.failure(oC.THRONE_IS_LEFT_FOR_GOOD())}const s=t.getStart().getDirectionToward(t.getEnd()).get(),a=t.getStart().getOrthogonalDistance(t.getEnd());let c=t.getStart().getNext(s);for(let l=1;l<a;l++){if(n.getPieceAt(c)!==on.UNOCCUPIED)return b.failure(Le.SOMETHING_IN_THE_WAY());c=c.getNext(s)}return b.SUCCESS}isThrone(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}isExternalThrone(e){const t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}tryCapture(e,t,n,i){const o=t.getNext(n);return o.isNotInRange(this.config.WIDTH,this.config.WIDTH)||i.getRelativeOwner(e,o)!==y1.OPPONENT?g.empty():i.getPieceAt(o).isKing()?this.captureKing(e,t,n,i):this.capturePawn(e,t,n,i)}captureKing(e,t,n,i){const o=t.getNext(n),{backCoord:s,back:a,backInRange:c,left:l,leftCoord:f,right:d,rightCoord:m}=this.getSurroundings(o,n,e,i);return!1===c?this.captureKingAgainstTheWall(l,d,o):a===y1.NONE&&this.isThrone(i,s)?this.captureKingAgainstThrone(s,o,l,d):a===y1.PLAYER?this.captureKingWithAtLeastASandwich(i,o,l,f,d,m):g.empty()}getSurroundings(e,t,n,i){const o=e.getNext(t),s=o.isInRange(this.config.WIDTH,this.config.WIDTH),a=s?i.getRelativeOwner(n,o):y1.NONE,c=e.getLeft(t),f=c.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(n,c):y1.NONE,d=e.getRight(t),E=d.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(n,d):y1.NONE;return{backCoord:o,back:a,backInRange:s,leftCoord:c,left:f,rightCoord:d,right:E}}captureKingAgainstTheWall(e,t,n){let i=e===y1.PLAYER?1:0;return i+=t===y1.PLAYER?1:0,2===i&&this.config.BORDER_CAN_SURROUND_KING?g.of(n):g.empty()}captureKingAgainstThrone(e,t,n,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return g.of(t)}else if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&(n===y1.PLAYER||i===y1.PLAYER))return g.of(t);return g.empty()}capturePawn(e,t,n,i){const o=t.getNext(n),s=o.getNext(n);let a=y1.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(a=i.getRelativeOwner(e,s)),a===y1.NONE?!1===this.isThrone(i,s)?(Ae.display("TaflRules","capturePawn","cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")cannot capture a pawn without an ally behind"),g.empty()):(Ae.display("TaflRules","capturePawn","pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.of(o)):a===y1.PLAYER?(Ae.display("TaflRules","capturePawn","pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.of(o)):(Ae.display("TaflRules","capturePawn","no captures; "+o+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.empty())}captureKingWithAtLeastASandwich(e,t,n,i,o,s){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return g.of(t);const a=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,c=this.isThrone(e,i),l=n===y1.PLAYER||c&&a,f=this.isThrone(e,s);return l&&(o===y1.PLAYER||f&&a)?g.of(t):g.empty()}kingTouchCentralThrone(e,t){const n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}applyLegalMove(e,t,n){const i=t.turn,o=t.getCopiedBoard(),s=t.getCurrentPlayer(),a=e.getStart(),c=e.getEnd();o[c.y][c.x]=o[a.y][a.x],o[a.y][a.x]=on.UNOCCUPIED;for(const l of ze.ORTHOGONALS){const f=this.tryCapture(s,e.getEnd(),l,t);f.isPresent()&&(o[f.get().y][f.get().x]=on.UNOCCUPIED)}return t.of(o,i+1)}getGameStatus(e){const n=this.getWinner(e.gameState);return n.isPresent()?ve.getVictory(n.get()):ve.ONGOING}getWinner(e){const t=this.getKingCoord(e);if(t.isAbsent())return Ae.display("TaflRules","getWinner","The king is dead, victory to invader"),g.of(this.getInvader());const n=t.get();return this.isExternalThrone(n)?(Ae.display("TaflRules","getWinner","The king escape, victory to defender"),g.of(this.getDefender())):this.isPlayerImmobilized(I.ZERO,e)?(Ae.display("TaflRules","getWinner","Zero has no move, victory to one"),g.of(I.ONE)):this.isPlayerImmobilized(I.ONE,e)?(Ae.display("TaflRules","getWinner","One has no move, victory to zero"),g.of(I.ZERO)):(Ae.display("TaflRules","getWinner","no victory"),g.empty())}getKingCoord(e){for(let t=0;t<this.config.WIDTH;t++)for(let n=0;n<this.config.WIDTH;n++)if(e.getPieceAtXY(n,t).isKing())return g.of(new C(n,t));return g.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,t){return 0===this.getPlayerListMoves(e,t).length}getPlayerListMoves(e,t){const n=[],i=this.getPlayerListPawns(e,t);for(const o of i){const s=this.getPossibleDestinations(o,t);for(const a of s){const c=this.generateMove(o,a).get();n.push(c)}}return n}getPlayerListPawns(e,t){const n=[];for(let i=0;i<this.config.WIDTH;i++)for(let o=0;o<this.config.WIDTH;o++){const s=new C(o,i);t.getAbsoluteOwner(s)===e&&n.push(s)}return n}getPossibleDestinations(e,t){const n=[];let i;for(const o of ze.ORTHOGONALS){i=e.getNext(o,1);let s=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(i)===K.NONE?this.isExternalThrone(i)?t.getPieceAt(e).isKing()&&n.push(i):t.isCentralThrone(i)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&n.push(i):n.push(i):s=!0,i=i.getNext(o,1)}return n}}class Sl extends AL{static get(){return Sl.singleton.isAbsent()&&(Sl.singleton=g.of(new Sl)),Sl.singleton.get()}constructor(){super(Oa,B7t,po.from)}}u(Sl,"singleton",g.empty());let Hae,aC=class extends Sr{getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),i=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,i)}orderMoves(e,t){const n=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?Re.sortByDescending(t,i=>-i.getEnd().getOrthogonalDistance(n)):Re.sortByDescending(t,i=>i.getStart().equals(n)?this.ruler.isExternalThrone(i.getEnd())?2:1:0),t}getMetrics(e){const t=e.gameState,n=this.ruler.getPlayerListPawns(I.ZERO,t).length,i=this.ruler.getPlayerListPawns(I.ONE,t).length;return[n*[1,2][this.ruler.config.INVADER.value],i*[2,1][this.ruler.config.INVADER.value]]}};aC=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],aC);class cC{constructor(e,t){u(this,"directThreats",void 0),u(this,"mover",void 0),this.directThreats=e,this.mover=t}equals(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}class Dae extends cC{constructor(e,t){super(new dt([e]),t),u(this,"directThreat",void 0),this.directThreat=e}}Hae=Symbol.iterator;class U7t extends dt{constructor(e){if(super(),u(this,"valueMap",void 0),this.valueMap=[],this.values=[],void 0!==e)for(const t of e)this.add(t)}add(e){const t=this.toFields(e);let n=this.valueMap;for(const o of t[0])void 0===n[o]&&(n[o]=[]),n=n[o];const i=t[1];return void 0===n[i]&&(n[i]=!0,this.values.push(e),!0)}contains(e){const t=this.toFields(e);let n=this.valueMap;for(const o of t[0]){if(void 0===n[o])return!1;n=n[o]}return void 0!==n[t[1]]}[Hae](){return this.values.values()}}class G1 extends U7t{toFields(e){return[[e.y],e.x]}}class Vae extends aC{constructor(e,t){super(e,t),u(this,"width",void 0),u(this,"maxInfluence",void 0),u(this,"scoreByThreatenedPiece",void 0),u(this,"scoreBySafePiece",void 0),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=e.gameState,i=on.UNOCCUPIED;let o=0;const s=this.getPiecesMap(n),a=this.getThreatMap(n,s),c=this.filterThreatMap(a,n);for(const l of I.PLAYERS)for(const f of s.get(l).get())if(c.get(f).isPresent())o+=l.getScoreModifier()*this.scoreByThreatenedPiece;else{o+=l.getScoreModifier()*this.scoreBySafePiece;let d=0;for(const m of ze.ORTHOGONALS){let E=f.getNext(m,1);for(;E.isInRange(this.width,this.width)&&n.getPieceAt(E)===i;)d++,E=E.getNext(m,1)}o+=d*l.getScoreModifier()}return new an(o)}getPiecesMap(e){const t=on.UNOCCUPIED,n=[],i=[];for(let s=0;s<this.width;s++)for(let a=0;a<this.width;a++){const c=new C(a,s);e.getPieceAt(c)!==t&&(e.getAbsoluteOwner(c)===I.ZERO?n.push(c):i.push(c))}return new un([{key:I.ZERO,value:new G1(n)},{key:I.ONE,value:new G1(i)}])}getThreatMap(e,t){const n=new un;for(const i of I.PLAYERS)for(const o of t.get(i).get()){const s=this.getThreats(o,e);this.isThreatReal(o,e,s)&&n.set(o,new dt(s))}return n}getThreats(e,t){const n=t.getAbsoluteOwner(e);Fe(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const i=n.getOpponent(),o=[];for(const s of ze.ORTHOGONALS){const a=e.getPrevious(s,1);if(this.isAThreat(a,t,i)){const c=[];for(const l of ze.ORTHOGONALS){if(l===s.getOpposite())continue;let f=e.getNext(s,1);for(;f.isInRange(this.width,this.width)&&t.getPieceAt(f)===on.UNOCCUPIED;)f=f.getNext(l);f.isInRange(this.width,this.width)&&t.getAbsoluteOwner(f)===i&&!1===e.getNext(s,1).equals(f)&&c.push(f)}o.push(new Dae(a,new G1(c)))}}return o}isAThreat(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==I.ONE&&t.getPieceAt(e)!==on.UNOCCUPIED))}isThreatReal(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;for(const i of n)if(i.mover.size()>0)return!0;return!1}filterThreatMap(e,t){const n=new un,i=e.listKeys(),o=i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentPlayer()),s=new G1(i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentOpponent()));for(const a of o){const c=e.get(a).get(),l=[];for(const f of c)if(!1===s.contains(f.directThreat)){const d=[];for(const m of f.mover)!1===s.contains(m)&&d.push(m);d.length>0&&l.push(new Dae(f.directThreat,new G1(d)))}l.length>0&&n.set(a,new dt(l))}for(const a of s){const c=e.get(a).get();n.set(a,c)}return n}}class Fae extends Vae{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=e.gameState,o=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,n);let s=o.controlScore;s+=o.safeScore*this.getScoreBySafePiece(n);const a=this.getScoreByThreatenedPiece(n);return s+=o.threatenedScore*a,Fe(o.controlScore<=a,"Control Score should be below "+a+", got "+o.controlScore),Fe(o.threatenedScore<=16,"Threatened Score should be below 16, got "+o.threatenedScore),Fe(o.safeScore<=16,"Safe Score should be below 16, got "+o.threatenedScore),new an(s)}getControlScoreAndPieceScores(e,t){const n=this.getPiecesMap(t),i=this.getThreatMap(t,n),o=this.filterThreatMap(i,t),s={safeScore:0,threatenedScore:0,controlScore:0};for(const a of I.PLAYERS){const c=new G1;for(const l of n.get(a).get())if(o.get(l).isPresent())s.threatenedScore+=a.getScoreModifier();else{s.safeScore+=a.getScoreModifier();for(const f of ze.ORTHOGONALS){let d=l.getNext(f,1);for(;d.isInRange(e,e)&&t.getPieceAt(d)===on.UNOCCUPIED;)c.add(d),d=d.getNext(f,1)}}for(const l of c){const f=this.getControlledPieceValue(l.x,l.y,e);s.controlScore+=a.getScoreModifier()*f}}return s}getControlledPieceValue(e,t,n){let i=1;return(0===e||e===n-1)&&(i*=n),(0===t||t===n-1)&&(i*=n),i}getScoreByThreatenedPiece(e){const t=e.board.length,n=t-2;return 4*t*t+4*n*t+n*n}getScoreBySafePiece(e){return 16*this.getScoreByThreatenedPiece(e)+1}}class W7t extends Fae{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=e.gameState,o=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,n),s=n.getPieceAt(this.ruler.getKingCoord(n).get()).getOwner(),a=this.getStepForEscape(n)*s.getScoreModifier();if(-1===a)return new an(s.getOpponent().getPreVictory());const c=this.getScoreByThreatenedPiece(n);return q.assert(o.controlScore<=c,"Control Score should be below "+c+", got "+o.controlScore),q.assert(o.threatenedScore<=16,"Threatened Score should be below 16, got "+o.threatenedScore),q.assert(o.safeScore<=16,"Safe Score should be below 16, got "+o.threatenedScore),new an(-1*a*(c+1)*17*17+o.safeScore*(c+1)*17+o.threatenedScore*(c+1)+o.controlScore)}getStepForEscape(e){const t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(-1)}_getStepForEscape(e,t,n,i){const o=this.getNextGen(e,n,i);return 0===o.length?g.empty():o.some(s=>this.ruler.isExternalThrone(s))?g.of(t):(t++,i.push(...o),this._getStepForEscape(e,t,o,i))}getNextGen(e,t,n){const i=[];for(const o of t)for(const s of ze.ORTHOGONALS){let a=o.getNext(s,1);for(;a.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&e.getPieceAt(a)===on.UNOCCUPIED;)n.every(c=>!1===c.equals(a))&&i.push(a),a=a.getNext(s,1)}return i}}class IL extends Vi{constructor(e,t){super(e),u(this,"generateMove",void 0),u(this,"viewInfo",{pieceClasses:[]}),u(this,"EMPTY",on.UNOCCUPIED),u(this,"capturedCoords",[]),u(this,"chosen",g.empty()),this.generateMove=t}getViewBox(){const e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}updateBoard(e){var t=this;return M(function*(){t.board=t.getState().getCopiedBoard(),t.capturedCoords=[],t.updateViewInfo()})()}showLastMove(e){var t=this;return M(function*(){const n=t.getPreviousState(),i=t.getState().getCurrentOpponent();for(const o of ze.ORTHOGONALS){const s=e.getEnd().getNext(o,1);if(s.isInRange(t.rules.config.WIDTH,t.rules.config.WIDTH)){const c=n.getRelativeOwner(i,s)===y1.OPPONENT,f=t.getState().getPieceAt(s)===on.UNOCCUPIED;c&&f&&t.capturedCoords.push(s)}}})()}updateViewInfo(){const e=[];this.board=this.getState().getCopiedBoard();for(let t=0;t<this.board.length;t++){const n=[];for(let i=0;i<this.board[0].length;i++){let o=[];o=this.board[t][i].getOwner()===K.NONE?[""]:this.getPieceClasses(i,t),n.push(o)}e.push(n)}this.viewInfo={pieceClasses:e}}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const o=new C(e,t);return n.chosen.equalsValue(o)?(n.cancelMoveAttempt(),b.SUCCESS):n.chosen.isAbsent()||n.pieceBelongToCurrentPlayer(o)?n.choosePiece(o):n.chooseDestination(e,t)})()}chooseDestination(e,t){var n=this;return M(function*(){const i=n.chosen.get(),o=new C(e,t),s=n.generateMove(i,o);return s.isSuccess()?yield n.chooseMove(s.get()):n.cancelMove(s.getReason())})()}choosePiece(e){var t=this;return M(function*(){return t.board[e.y][e.x]===on.UNOCCUPIED?t.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):!1===t.pieceBelongToCurrentPlayer(e)?t.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.chosen=g.of(e),t.updateViewInfo(),b.SUCCESS)})()}pieceBelongToCurrentPlayer(e){const t=this.getState(),n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===y1.PLAYER}cancelMoveAttempt(){this.chosen=g.empty(),this.updateViewInfo()}isThrone(e,t){const n=this.getState();return this.rules.isThrone(n,new C(e,t))}isCentralThrone(e,t){return this.getState().isCentralThrone(new C(e,t))}getPieceClasses(e,t){const n=[],i=new C(e,t),o=this.getState().getAbsoluteOwner(i);return n.push(this.getPlayerClass(o)),this.chosen.equalsValue(i)&&n.push("selected-stroke"),n}getRectClasses(e,t){const n=[],i=new C(e,t);if(this.capturedCoords.some(o=>o.equals(i)))n.push("captured-fill");else if(this.node.move.isPresent()){const o=this.node.move.get().getStart(),s=this.node.move.get().getEnd();(i.equals(o)||i.equals(s))&&n.push("moved-fill")}return n}getClickables(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const i=new C(n,t);this.isClickable(i)&&e.push(i)}return e}isClickable(e){return this.pieceBelongToCurrentPlayer(e)}isInvader(e,t){return this.board[t][e]===on.INVADERS}isKing(e,t){return this.board[t][e].isKing()}createMinimaxes(){return[new aC(this.rules,"DummyBot"),new Vae(this.rules,"Piece > Influence"),new Fae(this.rules,"Piece > Control"),new W7t(this.rules,"Escape > Piece > Control")]}}const j=on.UNOCCUPIED,u1=on.INVADERS,Vo=on.DEFENDERS,Nd=on.PLAYER_ONE_KING;class $ae extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Oa.getInitialState()),W.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Oa.getInitialState(),po.of(new C(3,1),new C(1,1)),$localize`Congratulations!`),W.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Oa([[j,j,j,u1,j,j,j],[j,j,j,u1,j,j,j],[u1,j,j,Vo,j,j,j],[j,j,Vo,Nd,Vo,u1,u1],[j,j,u1,j,j,j,j],[j,j,j,Vo,j,u1,j],[j,j,j,u1,j,j,j]],1),[po.of(new C(3,5),new C(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),W.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Oa([[j,j,j,u1,j,j,j],[j,j,u1,j,j,j,j],[j,j,j,Vo,j,j,j],[u1,Vo,j,j,Vo,u1,u1],[j,Vo,j,j,j,j,j],[j,u1,j,Nd,j,u1,j],[j,j,j,u1,j,j,j]],12),[po.of(new C(2,1),new C(3,1)),po.of(new C(3,0),new C(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),W.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new Oa([[j,j,j,j,j,j,j],[j,j,j,Vo,j,j,j],[j,j,j,u1,j,j,j],[j,u1,j,Nd,u1,j,j],[j,j,j,u1,j,j,j],[j,Vo,j,j,j,j,j],[j,j,j,j,j,j,j]],72),[po.of(new C(1,3),new C(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),W.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new Oa([[j,j,u1,j,j,j,j],[j,j,j,u1,j,j,j],[j,j,j,Nd,u1,j,j],[j,u1,Vo,j,Vo,j,j],[j,j,j,u1,j,j,j],[j,j,j,j,j,j,j],[j,j,j,j,j,j,j]],72),[po.of(new C(2,0),new C(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),W.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new Oa([[j,j,j,j,j,j,j],[j,j,j,j,j,j,j],[j,u1,j,u1,j,j,j],[u1,j,j,j,Vo,j,j],[j,j,j,Vo,j,j,j],[j,j,j,j,j,j,j],[j,Nd,j,u1,j,j,j]],72),[po.of(new C(3,6),new C(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function q7t(r,e){1&r&&(A(),F(0,"polygon",8))}function j7t(r,e){1&r&&(A(),F(0,"rect",9))}function Z7t(r,e){if(1&r&&(A(),S(0,"g"),T(1,q7t,1,0,"polygon",6),T(2,j7t,1,0,"ng-template",null,7,dn),P()),2&r){const t=ln(3),n=p().index,i=p().index,o=p();_(1),y("ngIf",o.isCentralThrone(n,i))("ngIfElse",t)}}function Y7t(r,e){if(1&r&&(A(),S(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function K7t(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function X7t(r,e){if(1&r&&(A(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function Q7t(r,e){if(1&r&&(A(),T(0,K7t,1,1,"polyline",14),T(1,X7t,4,20,"ng-template",null,15,dn)),2&r){const t=ln(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function J7t(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",10),T(2,Y7t,6,25,"g",11),T(3,Q7t,3,2,"ng-template",null,12,dn),P()),2&r){const t=ln(4),n=p().index,i=p().index,o=p();_(1),ye("id","piece_",n,"_",i,""),y("ngClass",o.viewInfo.pieceClasses[i][n]),k("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),_(1),y("ngIf",o.isInvader(n,i))("ngIfElse",t)}}function eft(r,e){if(1&r){const t=pe();A(),S(0,"g",3),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),F(1,"rect",4),T(2,Z7t,4,2,"g",5),T(3,J7t,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),k("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function tft(r,e){if(1&r&&(A(),S(0,"g"),T(1,eft,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function nft(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",17),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ye("id","click_",t.x,"_",t.y,""),k("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let rft=(()=>{var r;class e extends IL{constructor(n){super(n,po.from),this.rules=Sl.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=this.createMinimaxes(),this.encoder=po.encoder,this.tutorial=(new $ae).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-brandhub"]],features:[Qe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,tft,2,1,"g",1),T(2,nft,2,6,"g",1),P()),2&n&&(k("viewBox",i.getViewBox()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),li=(()=>{class r extends B1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}static getInitialState(){const t=Re.createTable(r.WIDTH,r.HEIGHT,K.NONE);return new r(t,0)}}return u(r,"WIDTH",19),u(r,"HEIGHT",19),r})();var kL;class ba extends Pr{static of(e){return q.assert(li.isOnBoard(e),"FIRST_COORD_IS_OUT_OF_RANGE"),new ba(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}u(ba,"encoder",Pr.getEncoder(ba.of));class wa extends Ho{static of(e,t){return q.assert(li.isOnBoard(e),"FIRST_COORD_IS_OUT_OF_RANGE"),q.assert(li.isOnBoard(t),"SECOND_COORD_IS_OUT_OF_RANGE"),q.assert(!1===e.equals(t),"COORDS_SHOULD_BE_DIFFERENT"),new wa(e,t)}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(e){const t=this.getFirst(),n=e.getFirst(),i=this.getSecond(),o=e.getSecond();return!(!t.equals(n)||!i.equals(o))||!(!t.equals(o)||!i.equals(n))}}u(wa,"encoder",Ho.getEncoder(wa.of)),function(r){r.isFirstMove=function e(n){return n instanceof ba},r.isDrop=function t(n){return n instanceof wa},r.encoder=we.disjunction([r.isFirstMove,r.isDrop],[ba.encoder,wa.encoder])}(kL||(kL={}));class cu{constructor(e,t,n){u(this,"isInRange",void 0),u(this,"getOwner",void 0),u(this,"N",void 0),this.isInRange=e,this.getOwner=t,this.N=n}getBoardValue(e){let t=0;for(const n of e.getCoordsAndContents()){const o=n.coord;if(this.getOwner(n.content,e).isPlayer()){const s=this.getSquareScore(e,o);if(an.VICTORIES.some(a=>a===s))return new an(s);t+=s}}return new an(t)}getSquareScore(e,t){const n=e.getPieceAt(t),i=this.getOwner(n,e);Fe(i.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const o=new un,s=new un;for(const c of Me.DIRECTIONS){const l=this.getNumberOfFreeSpacesAndAllies(e,t,c,i);o.set(c,l[0]),s.set(c,l[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(s,o)*i.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(e,t){let n=0;for(const i of[Me.UP,Me.UP_RIGHT,Me.RIGHT,Me.DOWN_RIGHT]){const o=e.get(i).get(),s=e.get(i.getOpposite()).get();if(this.N<=o+s+1)return Number.MAX_SAFE_INTEGER;const f=t.get(i).get()+t.get(i.getOpposite()).get();this.N<=f+1&&(n+=2+f-this.N)}return n}getNumberOfFreeSpacesAndAllies(e,t,n,i){let o=0,s=0,a=!0,c=new C(t.x+n.x,t.y+n.y),l=1;const f=i.getOpponent();for(;this.isInRange(c)&&l<this.N;){const d=e.getPieceAt(c);if(this.getOwner(d,e)===f)return[o,s];this.getOwner(d,e)===i&&a?s++:a=!1,d!==f&&d!==i&&o++,c=c.getNext(n),l++}return[o,s]}getVictoriousCoord(e){const t=[];for(const n of e.getCoordsAndContents())if(this.getOwner(n.content,e).isPlayer()){const i=n.coord,o=this.getSquareScore(e,i);Di.getScoreStatus(o)===en.VICTORY&&(o===I.ZERO.getVictoryValue()||o===I.ONE.getVictoryValue())&&t.push(i)}return t}}class hs extends Yn{static get(){return hs.singleton.isAbsent()&&(hs.singleton=g.of(new hs)),hs.singleton.get()}static getVictoriousCoords(e){return hs.CONNECT_SIX_HELPER.getVictoriousCoord(e)}constructor(){super(li)}applyLegalMove(e,t,n){return e instanceof wa?this.applyLegalDrops(e,t):this.applyLegalFirstMove(e,t)}applyLegalDrops(e,t){const n=t.getCurrentPlayer(),i=e.getFirst(),o=e.getSecond(),s=t.getCopiedBoard();return s[i.y][i.x]=n,s[o.y][o.x]=n,new li(s,t.turn+1)}applyLegalFirstMove(e,t){const n=t.getCurrentPlayer(),i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=n,new li(i,t.turn+1)}isLegal(e,t){return 0===t.turn?(q.assert(e instanceof ba,"First move should be instance of ConnectSixFirstMove"),b.SUCCESS):(q.assert(e instanceof wa,"non-firsts moves should be instance of ConnectSixDrops"),this.isLegalDrops(e,t))}isLegalDrops(e,t){return t.getPieceAt(e.getFirst()).isPlayer()||t.getPieceAt(e.getSecond()).isPlayer()?b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}getGameStatus(e){const t=e.gameState;return hs.CONNECT_SIX_HELPER.getVictoriousCoord(t).length>0?ve.getVictory(t.getCurrentOpponent()):181===t.turn?ve.DRAW:ve.ONGOING}}u(hs,"singleton",g.empty()),u(hs,"CONNECT_SIX_HELPER",new cu(li.isOnBoard,q.identity,6));const R=K.NONE,ui=K.ZERO,z2=K.ONE;class Uae extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,li.getInitialState()),W.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,li.getInitialState(),ba.of(new C(9,9)),$localize`Congratulations!`),W.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new li([[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,z2,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,ui,R,z2,ui,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,ui,ui,R,R,z2,R,R,R,R,R,R],[R,R,R,R,R,R,R,z2,ui,ui,ui,ui,z2,R,R,R,R,R,R],[R,R,R,R,R,R,z2,ui,ui,ui,ui,z2,R,R,R,R,R,R,R],[R,R,R,R,R,R,z2,R,z2,ui,z2,z2,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,ui,z2,ui,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,z2,R,z2,R,ui,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,z2,z2,R,z2,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,z2,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,ui,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R]],20),wa.of(new C(4,11),new C(5,10)),$localize`Congratulations!`)])}}let xL=(()=>{var r;class e extends Vi{constructor(...n){super(...n),u(this,"hoshis",[])}createHoshis(){const n=this.board.length,i=Math.floor(n/2),o=n<12?2:3,s=n-(o+1);18<n&&this.hoshis.push(new C(o,i),new C(i,o),new C(i,s),new C(s,i)),this.hoshis.push(new C(i,i),new C(o,o),new C(o,s),new C(s,o),new C(s,s))}isHoshi(n,i){return this.hoshis.some(o=>o.x===n&&o.y===i)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}()),u(e,"\u0275cmp",je({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();class ift extends ds{getListMoves(e){return 0===e.gameState.turn?this.getFirstMove():this.getListDrops(e)}getFirstMove(){const t=li.HEIGHT,n=Math.floor(li.WIDTH/2),i=Math.floor(t/2);return[ba.of(new C(n,i))]}getListDrops(e){const t=this.getAvailableCoords(e.gameState),n=[];for(const i of t){const o=e.gameState.getCopiedBoard();o[i.y][i.x]=e.gameState.getCurrentPlayer();const s=new li(o,e.gameState.turn),a=this.getAvailableCoords(s);for(const c of a){const l=wa.of(i,c);n.push(l)}}return new dt(n).toList()}getAvailableCoords(e){const t=this.getUsefulCoordsMap(e),n=[];for(const i of e.getCoordsAndContents()){const o=i.coord;!0===t[o.y][o.x]&&!1===i.content.isPlayer()&&n.push(o)}return n}getUsefulCoordsMap(e){const t=Re.createTable(li.WIDTH,li.HEIGHT,!1);for(const n of e.getCoordsAndContents())n.content.isPlayer()&&this.addNeighboringCoord(t,n.coord);return t}addNeighboringCoord(e,t){const i=Math.max(0,t.x-1),o=Math.max(0,t.y-1),s=Math.min(li.WIDTH-1,t.x+1),a=Math.min(li.HEIGHT-1,t.y+1);for(let c=o;c<=a;c++)for(let l=i;l<=s;l++)e[c][l]=!0}getBoardValue(e){const t=e.gameState;let n=0;for(const i of t.getCoordsAndContents())if(i.content.isPlayer()){const o=hs.CONNECT_SIX_HELPER.getSquareScore(t,i.coord);if(Di.getScoreStatus(o)===en.VICTORY)return new an(o);n+=o}return new an(n)}}function oft(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function sft(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();ye("id","hoshi_",t,"_",n,""),k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.1*i.SPACE_SIZE)}}function aft(r,e){if(1&r&&(A(),F(0,"rect",9)(1,"line",10)(2,"line",10),T(3,sft,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();k("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),k("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),k("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),y("ngIf",i.isHoshi(t,n))}}function cft(r,e){if(1&r){const t=pe();A(),S(0,"g",5),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),T(1,oft,1,6,"circle",6),T(2,aft,4,13,"ng-template",null,7,dn),P()}if(2&r){const t=e.$implicit,n=e.index,i=ln(3);ye("id","click_",n,"_",p().index,""),_(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function lft(r,e){if(1&r&&(A(),S(0,"g"),T(1,cft,4,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function uft(r,e){if(1&r){const t=pe();A(),S(0,"circle",13),U("click",function(){te(t);const i=p();return ne(i.onClick(i.droppedCoord.get().x,i.droppedCoord.get().y))}),P()}if(2&r){const t=p();y("ngClass",t.getSpaceClass(t.droppedCoord.get().x,t.droppedCoord.get().y)),k("cx",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().x)("cy",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().y)("r",.22*t.SPACE_SIZE)}}let fft=(()=>{var r;class e extends xL{constructor(n){super(n),u(this,"droppedCoord",g.empty()),u(this,"lastMoved",[]),u(this,"victoryCoords",[]),this.rules=hs.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new ift(this.rules,"Minimax")],this.encoder=kL.encoder,this.tutorial=(new Uae).tutorial}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.getCopiedBoard(),i.victoryCoords=hs.getVictoriousCoords(o),i.createHoshis()})()}showLastMove(n){var i=this;return M(function*(){i.lastMoved=n instanceof ba?[n.coord]:[n.getFirst(),n.getSecond()]})()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new C(n,i);if(0===o.getState().turn){const c=ba.of(a);return o.chooseMove(c)}if(o.getState().getPieceAt(a).isPlayer())return o.cancelMove(Le.MUST_CLICK_ON_EMPTY_SQUARE());if(o.droppedCoord.isPresent()){if(o.droppedCoord.equalsValue(a))return o.droppedCoord=g.empty(),b.SUCCESS;{const c=wa.of(o.droppedCoord.get(),a);return o.chooseMove(c)}}return o.droppedCoord=g.of(a),b.SUCCESS})()}getSpaceClass(n,i){const o=new C(n,i),s=this.getState().getPieceAt(o),a=[];return this.droppedCoord.equalsValue(o)?(a.push(this.getPlayerClass(this.getState().getCurrentPlayer())),a.push("highlighted-stroke")):(a.push(this.getPlayerClass(s)),this.victoryCoords.some(c=>c.equals(o))&&a.push("victory-stroke"),this.lastMoved.some(c=>c.equals(o))&&a.push("last-move-stroke")),a}cancelMoveAttempt(){this.droppedCoord=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-connect-six"]],features:[Qe],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["id","dropped","class","base mid-stroke moved-stroke",3,"ngClass","click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],["id","dropped",1,"base","mid-stroke","moved-stroke",3,"ngClass","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),F(1,"rect",1),T(2,lft,2,1,"g",2),T(3,uft,1,4,"circle",3),P()),2&n&&(k("viewBox","0 -3 "+i.board.length*i.SPACE_SIZE*.5+" "+(6+i.board.length*i.SPACE_SIZE*.5)),_(1),k("width",i.board.length*i.SPACE_SIZE*.5)("height",i.board.length*i.SPACE_SIZE*.5),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.droppedCoord.isPresent()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),t4=(()=>{class r{}return u(r,"SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP",()=>$localize`Your piece should land on a neighboring square.`),u(r,"CANNOT_DROP_AFTER_TURN_40",()=>$localize`You cannot drop a piece during the moving phase.`),u(r,"CANNOT_MOVE_BEFORE_TURN_40",()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`),u(r,"MUST_JUMP_OVER_PIECES",()=>$localize`A jump must be made over a piece, not over an empty square.`),u(r,"MUST_DROP_IN_CENTRAL_ZONE",()=>$localize`A drop must occur in the central zone of the board.`),u(r,"INVALID_JUMP",()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`),u(r,"SAME_LOCATION_VISITED_IN_JUMP",()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`),r})();var lC,jae,h2;class Lt extends B1{static isOnBoard(e){return e.isInRange(Lt.WIDTH,Lt.HEIGHT)}static getInitialState(){const e=Re.createTable(Lt.WIDTH,Lt.HEIGHT,K.NONE);return new Lt(e,0)}isShelter(e){return 0===e.x||e.x===Lt.WIDTH-1?Lt.SHELTERS_INDICES.some(t=>e.y===t):(0===e.y||e.y===Lt.HEIGHT-1)&&Lt.SHELTERS_INDICES.some(t=>e.x===t)}isCentralZone(e){return e.x>=Lt.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=Lt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=Lt.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=Lt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}lC=Lt,u(Lt,"WIDTH",17),u(Lt,"HEIGHT",17),u(Lt,"CENTRAL_ZONE_TOP_LEFT",new C(4,6)),u(Lt,"CENTRAL_ZONE_BOTTOM_RIGHT",new C(12,10)),u(Lt,"SHELTERS_INDICES",[0,1,3,5,7,8,9,11,13,15,16]),u(Lt,"ALL_SHELTERS",new dt(lC.SHELTERS_INDICES.flatMap(r=>[new C(r,0),new C(r,lC.HEIGHT-1),new C(0,r),new C(lC.WIDTH-1,r)])).toList());class n4 extends Pr{static of(e){return q.assert(Lt.isOnBoard(e),"Move out of board"),new n4(e)}constructor(e){super(e.x,e.y)}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(e){return!!h2.isDrop(e)&&this.coord.equals(e.coord)}}u(n4,"encoder",Pr.getEncoder(n4.of));class r4 extends Fs{static from(e,t){const n=Lt.isOnBoard(e),i=Lt.isOnBoard(t);return q.assert(n&&i,"Move out of board"),e.isAlignedWith(t)&&1===e.getDistance(t)?ie.success(new r4(e,t)):ie.failure(t4.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP())}constructor(e,t){super(e,t)}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!!h2.isSimple(e)&&super.equals(e)}}u(r4,"encoder",Ho.getFallibleEncoder(r4.from));class $s extends Ri{static from(e){if(e.length<2)return ie.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const n of e)if(!1===Lt.isOnBoard(n))return ie.failure("Move out of board");for(let n=1;n<e.length;n++)if(e[n-1].getDirectionToward(e[n]).isFailure()||2!==e[n-1].getDistance(e[n]))return ie.failure(t4.INVALID_JUMP());return new G1(e).size()===e.length?ie.success(new $s(e)):ie.failure(t4.SAME_LOCATION_VISITED_IN_JUMP())}constructor(e){super(),u(this,"coords",void 0),this.coords=e}addJump(e){const t=Re.copyImmutableArray(this.coords);return t.push(e),$s.from(t)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const e=[];for(let t=1;t<this.coords.length;t++){const n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}toString(){return`ConspirateursMoveJump(${this.coords.map(t=>t.toString()).reduce((t,n)=>t+" -> "+n)})`}equals(e){return!(h2.isSimple(e)||h2.isDrop(e)||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}}jae=$s,u($s,"encoder",we.tuple([we.list(C.encoder)],r=>[Re.copyImmutableArray(r.coords)],r=>jae.from(r[0]).get())),function(r){r.isDrop=function e(i){return i instanceof n4},r.isSimple=function t(i){return i instanceof r4},r.isJump=function n(i){return i instanceof $s},r.encoder=we.disjunction([r.isDrop,r.isSimple,r.isJump],[n4.encoder,r4.encoder,$s.encoder])}(h2||(h2={}));const v=K.NONE,vt=K.ZERO,pt=K.ONE;class Zae extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,Lt.getInitialState()),W.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,Lt.getInitialState(),n4.of(new C(7,7)),$localize`Congratulations!`),W.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new Lt([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,vt,vt,pt,pt,vt,vt,pt,vt,pt,v,v,v,v],[v,v,v,v,vt,pt,vt,pt,vt,vt,vt,vt,pt,v,v,v,v],[v,v,v,v,vt,pt,v,v,v,v,v,pt,vt,v,v,v,v],[v,v,v,v,pt,vt,vt,pt,pt,pt,vt,vt,vt,v,v,v,v],[v,v,v,v,pt,vt,pt,pt,pt,pt,pt,pt,vt,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],40),r4.from(new C(4,6),new C(3,5)).get(),(t,n,i)=>h2.isSimple(t)?b.SUCCESS:b.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),W.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new Lt([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,vt,vt,pt,pt,vt,vt,pt,vt,pt,v,v,v,v],[v,v,v,v,vt,pt,vt,pt,vt,vt,vt,vt,pt,v,v,v,v],[v,v,v,v,vt,pt,v,v,v,v,v,pt,vt,v,v,v,v],[v,v,v,v,pt,vt,vt,pt,pt,pt,vt,vt,vt,v,v,v,v],[v,v,v,v,pt,vt,pt,pt,pt,pt,pt,pt,vt,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],40),$s.from([new C(6,7),new C(6,5)]).get(),(t,n,i)=>h2.isJump(t)?b.SUCCESS:b.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),W.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new Lt([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,pt,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,pt,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,pt,v,v,v,v,v,v,v,v,v],[v,v,v,v,vt,vt,v,pt,vt,vt,pt,vt,pt,v,v,v,v],[v,v,v,v,vt,v,vt,pt,vt,vt,vt,vt,pt,v,v,v,v],[v,v,v,v,vt,pt,v,v,v,v,v,pt,vt,v,v,v,v],[v,v,v,v,pt,vt,vt,pt,pt,pt,vt,vt,vt,v,v,v,v],[v,v,v,v,pt,vt,pt,pt,pt,pt,pt,pt,vt,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],40),[$s.from([new C(8,6),new C(6,4),new C(6,2),new C(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)])}}class ps extends Yn{static get(){return ps.singleton.isAbsent()&&(ps.singleton=g.of(new ps)),ps.singleton.get()}constructor(){super(Lt)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();if(h2.isDrop(e))i[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(h2.isSimple(e))i[e.getStart().y][e.getStart().x]=K.NONE,i[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer();else{const o=e.getStartingCoord(),s=e.getEndingCoord();i[o.y][o.x]=K.NONE,i[s.y][s.x]=t.getCurrentPlayer()}return new Lt(i,t.turn+1)}isLegal(e,t){return h2.isDrop(e)?this.dropLegality(e,t):h2.isSimple(e)?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}dropLegality(e,t){return t.turn>=40?b.failure(t4.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?b.failure(t4.MUST_DROP_IN_CENTRAL_ZONE()):b.SUCCESS}simpleMoveLegality(e,t){return t.turn<40?b.failure(t4.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.getStart())!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.getEnd()).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}jumpLegality(e,t){if(t.turn<40)return b.failure(t4.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());for(const n of e.getJumpedOverCoords())if(t.getPieceAt(n)===K.NONE)return b.failure(t4.MUST_JUMP_OVER_PIECES());for(const n of e.getLandingCoords())if(t.getPieceAt(n).isPlayer())return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());return b.SUCCESS}jumpTargetsFrom(e){const t=[new C(e.x+2,e.y),new C(e.x-2,e.y),new C(e.x,e.y+2),new C(e.x,e.y-2),new C(e.x+2,e.y+2),new C(e.x+2,e.y-2),new C(e.x-2,e.y+2),new C(e.x-2,e.y-2)],n=[];for(const i of t)$s.from([e,i]).isSuccess()&&n.push(i);return n}nextJumps(e,t){const n=e.getEndingCoord(),i=[];for(const o of this.jumpTargetsFrom(n)){const s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}return i}jumpHasPossibleNextTargets(e,t){return this.nextJumps(e,t).length>0}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of Lt.ALL_SHELTERS){const o=t.getPieceAt(i);if(o.isPlayer()&&(n[o.value]+=1,20===n[o.value]))return ve.getVictory(o)}return ve.ONGOING}}u(ps,"singleton",g.empty());let Ad=(()=>{class r{}return u(r,"NO_MORE_PIECES_OF_THIS_TYPE",()=>$localize`You do not have any pieces of this type anymore.`),u(r,"SPACE_IS_FULL",()=>$localize`You cannot play here: this space is already full.`),u(r,"TARGET_STACK_TOO_HIGH",()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`),u(r,"MUST_SHIFT_TO_NEIGHBOR",()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`),u(r,"MUST_SELECT_PIECE_FIRST",()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`),r})();var Na,Yae,Kae;class Tn{static of(e,t){return e===I.ZERO?t?Tn.ZERO_SECOND:Tn.ZERO_FIRST:e===I.ONE?t?Tn.ONE_SECOND:Tn.ONE_FIRST:Tn.EMPTY}constructor(e,t){u(this,"owner",void 0),u(this,"otherPieceType",void 0),this.owner=e,this.otherPieceType=t}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(e){return this===e}}Na=Tn,u(Tn,"encoder",we.tuple([K.encoder,we.identity()],r=>[r.owner,r.otherPieceType],r=>Na.of(r[0],r[1]))),u(Tn,"EMPTY",new Na(K.NONE,!1)),u(Tn,"ZERO_FIRST",new Na(I.ZERO,!1)),u(Tn,"ZERO_SECOND",new Na(I.ZERO,!0)),u(Tn,"ONE_FIRST",new Na(I.ONE,!1)),u(Tn,"ONE_SECOND",new Na(I.ONE,!0)),u(Tn,"PLAYER_PIECES",[Na.ZERO_FIRST,Na.ZERO_SECOND,Na.ONE_FIRST,Na.ONE_SECOND]);class Xae extends Ri{isDrop(){return this instanceof i4}isShift(){return this instanceof D2}}class i4 extends Xae{constructor(e,t){if(super(),u(this,"target",void 0),u(this,"piece",void 0),this.target=e,this.piece=t,t===Tn.EMPTY)throw new Error("Cannot drop an empty piece")}getTarget(){return this.target}equals(e){return e instanceof i4&&!(this.target!==e.target||this.piece!==e.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}Yae=i4,u(i4,"encoder",we.tuple([we.identity(),Tn.encoder],r=>[r.target,r.piece],r=>new Yae(r[0],r[1])));class D2 extends Xae{static ofRepresentation(e,t){return new D2(new C(e.x,3-e.y),t)}constructor(e,t){super(),u(this,"start",void 0),u(this,"moveDirection",void 0),this.start=e,this.moveDirection=t}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(e){return e instanceof D2&&!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}Kae=D2,u(D2,"encoder",we.tuple([C.encoder,we.identity()],r=>[r.start,"clockwise"===r.moveDirection],r=>new Kae(r[0],r[1]?"clockwise":"counterclockwise")));const dft=we.disjunction([r=>r.isDrop(),r=>r.isShift()],[i4.encoder,D2.encoder]);let X1=(()=>{class r extends B1{static getInitialState(){const t=Tn.EMPTY;return new r([[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t]],[4,4,4,4],0)}static ofRepresentation(t,n){const i=t.reverse(),o=[4,4,4,4];for(let s=0;s<r.HEIGHT;s++)for(let a=0;a<r.WIDTH;a++)i[s][a]!==Tn.EMPTY&&o[r.pieceIndex(i[s][a])]--;return Fe(o.every(s=>s>=0),"Invalid DiamState representation uses too many pieces"),new r(i,o,n)}static pieceIndex(t){switch(t){case Tn.ZERO_FIRST:return 0;case Tn.ZERO_SECOND:return 1;case Tn.ONE_FIRST:return 2;default:return q.expectToBe(t,Tn.ONE_SECOND),3}}constructor(t,n,i){super(t,i),u(this,"remainingPieces",void 0),this.remainingPieces=n}getRemainingPiecesOf(t){return this.remainingPieces[r.pieceIndex(t)]}getStackHeight(t){let n=0;for(let i=0;i<r.HEIGHT&&this.getPieceAtXY(t,i)!==Tn.EMPTY;i++)n++;return n}}return u(r,"WIDTH",8),u(r,"HEIGHT",4),r})();class zc extends Yn{static get(){return zc.singleton.isAbsent()&&(zc.singleton=g.of(new zc)),zc.singleton.get()}constructor(){super(X1)}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}applyLegalDrop(e,t){const n=Re.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;const i=Re.copyImmutableArray(t.remainingPieces);return i[X1.pieceIndex(e.piece)]-=1,new X1(n,i,t.turn+1)}applyLegalShift(e,t){const n=Re.copyBiArray(t.board),i=e.getTarget();let o=t.getStackHeight(i),s=e.start.y;for(;s<X1.HEIGHT&&t.getPieceAtXY(e.start.x,s)!==Tn.EMPTY;)n[o][i]=t.getPieceAtXY(e.start.x,s),n[s][e.start.x]=Tn.EMPTY,o++,s++;return new X1(n,t.remainingPieces,t.turn+1)}isLegal(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}isDropLegal(e,t){return e.piece.owner!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?b.failure(Ad.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}dropHeightValidity(e,t){return t.getStackHeight(e.target)===X1.HEIGHT?b.failure(Ad.SPACE_IS_FULL()):b.SUCCESS}isShiftLegal(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}shiftHeightValidity(e,t){const n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>X1.HEIGHT?b.failure(Ad.TARGET_STACK_TOO_HIGH()):b.SUCCESS}getGameStatus(e){const t=this.findHighestAlignment(e.gameState);if(t.isPresent()){const n=e.gameState.getPieceAt(t.get());return Fe(n.owner.isPlayer(),"highest alignment is owned by a player"),ve.getVictory(n.owner)}return ve.ONGOING}findHighestAlignment(e){for(let t=0;t<X1.WIDTH/2;t++)for(let n=X1.HEIGHT-1;n>0;n--){const i=e.getPieceAtXY(t,n),o=e.getPieceAtXY(t+X1.WIDTH/2,n);if(i!==Tn.EMPTY&&i===o)return g.of(new C(t,n))}return g.empty()}pieceCanMove(e,t){return!!this.isShiftLegal(new D2(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new D2(t,"counterclockwise"),e).isSuccess()}}u(zc,"singleton",g.empty());const Be=Tn.EMPTY,lu=Tn.ZERO_FIRST,Qae=Tn.ZERO_SECOND,uC=Tn.ONE_FIRST,LL=Tn.ONE_SECOND;class Jae{constructor(){u(this,"tutorial",[W.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,X1.getInitialState()),W.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,X1.ofRepresentation([[Be,Be,Be,Be,Be,Be,Be,Be],[Be,Be,Be,Be,Be,Be,Be,Be],[Be,Be,Be,Be,uC,Be,Be,Be],[lu,Be,Be,Be,lu,Be,Be,Be]],3),[new i4(0,Tn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),W.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,X1.ofRepresentation([[Be,Be,Be,Be,Be,Be,Be,Be],[Be,Be,Be,Be,LL,Be,Be,Be],[Be,Be,Be,Be,lu,Be,Be,Be],[uC,Be,Be,Be,Qae,Be,Be,Be]],4),[D2.ofRepresentation(new C(4,3),"counterclockwise"),D2.ofRepresentation(new C(4,3),"clockwise"),D2.ofRepresentation(new C(4,2),"counterclockwise"),D2.ofRepresentation(new C(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),W.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,X1.ofRepresentation([[Be,Be,Be,Be,lu,Be,Be,Be],[Be,Be,Be,Be,LL,Be,Be,lu],[Be,Be,Be,Be,lu,Be,Be,LL],[Be,uC,Be,Be,Qae,Be,Be,uC]],8),[D2.ofRepresentation(new C(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)])}}let ece=(()=>{var r;class e extends Cl{constructor(...n){super(...n),u(this,"SPACE_SIZE",100),u(this,"board",void 0)}getTriangleCornerCoords(n,i){return(n+i)%2==0?this.getUpwardCoordinate():this.getDownwardCoordinate()}getTrianglePoints(n,i){return this.getTriangleCornerCoords(n,i).map(a=>a.x+","+a.y).reduce((a,c)=>a+","+c)}getTriangleTranslateCoord(n,i){return new C(.5*n*this.SPACE_SIZE,i*this.SPACE_SIZE)}getTriangleTranslate(n,i){const o=this.getTriangleTranslateCoord(n,i);return"translate("+o.x+", "+o.y+")"}getDownwardCoordinate(){const o=this.SPACE_SIZE/2,s=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new C(-this.SPACE_SIZE/2,s);return[c,new C(0,a),new C(o,s),c]}getUpwardCoordinate(){const o=this.SPACE_SIZE/2,s=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new C(-this.SPACE_SIZE/2,a);return[c,new C(0,s),new C(o,a),c]}getPyramidPoints(n,i){return(n+i)%2==1?this.getDownwardPyramidPoints():this.getUpwardPyramidPoints()}getDownwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+-n,o=n+", "+-n,s="0, "+n,a="0, 0";return i+","+s+","+a+","+i+","+a+","+o+","+i+","+o+","+s+","+a+","+o}getUpwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+n,o=n+", "+n,s="0, "+-n,a="0, 0";return i+","+s+","+a+","+i+","+a+","+o+","+i+","+o+","+s+","+a+","+o}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}()),u(e,"\u0275cmp",je({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),Id=(()=>{class r{}return u(r,"INVALID_DISTANCE",()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`),u(r,"NOT_ENOUGH_TILES_TO_EXCHANGE",()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`),u(r,"FIRST_CLICK_SHOULD_NOT_BE_NULL",()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`),u(r,"CANNOT_CAPTURE_FROM_EMPTY",()=>$localize`You cannot capture from an empty space.`),r})();class Bs{static getNeighbors(e){let t;const n=new C(e.x-1,e.y),i=new C(e.x+1,e.y);return t=(e.x+e.y)%2==1?[n,i,new C(e.x,e.y-1)]:[n,i,new C(e.x,e.y+1)],t}static getFakeNeighbors(e){return new C(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}static getCommonNeighbor(e,t){const n=Bs.getNeighbors(e),i=Bs.getNeighbors(t);let o=0;for(;o<n.length;){const s=n[o];let a=0;for(;a<i.length;){if(s.equals(i[a]))return g.of(s);a++}o++}return g.empty()}static isSpaceDark(e){return(e.x+e.y)%2==0}}class P0 extends B1{static getEmptyNeighbors(e,t,n){const i=[];for(const o of Bs.getNeighbors(t))o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o);return i}getEmptyNeighbors(e,t){return P0.getEmptyNeighbors(this.board,e,t)}}var fC,Aa;let $r=(fC=class extends P0{static getTilesUpperLeftCoord(e){const t=e.x-e.x%3;let n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new C(t,n)}static isOnBoard(e){return e.isInRange(15,10)}static getPresentNeighborEntrances(e){return[new C(e.x+1,e.y-1),new C(e.x+3,e.y+0),new C(e.x+3,e.y+1),new C(e.x+1,e.y+2),new C(e.x-1,e.y+1),new C(e.x-1,e.y+0)].filter(Aa.isOnBoard)}static getInitialState(){const e=Ce.EMPTY,t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE;return new Aa([[t,t,t,t,t,t,n,e,n,t,t,t,t,t,t],[t,t,t,e,e,n,e,e,e,n,e,e,t,t,t],[e,i,e,i,e,e,n,e,n,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,n,e,n,e,e,e,e,e,e,e,n,e,n,e],[n,e,e,e,n,e,e,e,e,e,n,e,e,e,n],[e,n,e,n,e,e,i,e,i,e,e,n,e,n,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}constructor(e,t,n,i){super(e,t),u(this,"tiles",void 0),u(this,"captures",void 0),this.tiles=n,this.captures=i}applyLegalMovement(e){const t=e.getStart(),n=e.getEnd(),i=this.getCopiedBoard();return i[n.y][n.x]=Ce.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=Ce.EMPTY,new Aa(i,this.turn,this.tiles,this.captures)}doMovementCaptures(e){const t=this.getCapturedNeighbors(e.getEnd());let n=this;for(const i of t)n=n.capture(i);return n}getCapturedNeighbors(e){const t=this.getCurrentOpponent();return Bs.getNeighbors(e).filter(i=>!i.isNotInRange(15,10)&&!!this.getPieceAt(i).is(t)&&this.isSurrounded(i))}isSurrounded(e){return 0===this.getEmptyNeighbors(e,Ce.EMPTY).length}capture(e){const t=this.getCopiedBoard(),n=[this.captures[0],this.captures[1]];return t[e.y][e.x]=Ce.EMPTY,n[this.getCurrentPlayer().value]+=1,new Aa(t,this.turn,this.tiles,n)}removeTilesIfNeeded(e,t){let n=this;const i=Aa.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){n=this.deconnectTile(i,t);const o=Aa.getPresentNeighborEntrances(i);for(const s of o){const a=n.getPieceAt(s);a===Ce.EMPTY?n=n.removeTilesIfNeeded(s,t):a.is(this.getCurrentOpponent())&&n.isSurrounded(s)&&(n=n.capture(s))}}return n}isTileEmpty(e){q.assert(this.getPieceAt(e)!==Ce.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let t=0;t<2;t++)for(let n=0;n<3;n++){const i=e.getNext(new St(n,t),1);if(this.getPieceAt(i)!==Ce.EMPTY)return!1}return!0}isDeconnectable(e){const t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;let n=0;for(let i=1;i<t.length;i++)!1===this.areNeighbor(t[i-1],t[i])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}areNeighbor(e,t){return e+1===t||0===e&&5===t}getPresentNeighborTilesRelativeIndexes(e){const t=[];let n=g.empty();for(let i=0;i<6;i++){const s=e.getNext(Aa.NEIGHBORS_TILES_DIRECTIONS[i],1);Aa.isOnBoard(s)&&this.getPieceAt(s)!==Ce.UNREACHABLE&&(n.isAbsent()&&(n=g.of(i)),t.push(i-n.get()))}return t}deconnectTile(e,t){const n=this.getCopiedBoard(),i=e.x,o=e.y;for(let a=0;a<2;a++)for(let c=0;c<3;c++)n[o+a][i+c]=Ce.UNREACHABLE;const s=[this.tiles[0],this.tiles[1]];return t&&(s[this.getCurrentPlayer().value]+=1),new Aa(n,this.turn,s,this.captures)}getLegalLandings(e){const t=[];for(const n of go.STEPS){const i=e.getNext(n.direction,1);this.isOnBoard(i)&&this.getPieceAt(i)===Ce.EMPTY&&t.push(i)}return t}getPiecesByFreedom(){const e=[[0,0,0,0],[0,0,0,0]];for(let t=0;t<10;t++)for(let n=0;n<15;n++){const i=this.board[t][n];if(i.isPlayer()){const o=this.getEmptyNeighbors(new C(n,t),Ce.EMPTY).length;e[i.value][o]=e[i.value][o]+1}}return e}},Aa=fC,u(fC,"NEIGHBORS_TILES_DIRECTIONS",[new St(0,-2),new St(3,-1),new St(3,1),new St(0,2),new St(-3,1),new St(-3,-1)]),fC);var gs,Pl,dC,T0;$r=Aa=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],$r);class go{static ofCoords(e,t){const n=e.getVectorToward(t),i=go.STEPS.findIndex(o=>o.direction.equals(n));return q.assert(-1!==i,Id.INVALID_DISTANCE()),go.STEPS[i]}constructor(e,t){u(this,"direction",void 0),u(this,"str",void 0),this.direction=e,this.str=t}}u(go,"LEFT",new(gs=go)(new St(-2,0),"LEFT")),u(go,"UP_LEFT",new gs(Me.UP_LEFT,"UP_LEFT")),u(go,"UP_RIGHT",new gs(Me.UP_RIGHT,"UP_RIGHT")),u(go,"RIGHT",new gs(new St(2,0),"RIGHT")),u(go,"DOWN_LEFT",new gs(Me.DOWN_LEFT,"DOWN_LEFT")),u(go,"DOWN_RIGHT",new gs(Me.DOWN_RIGHT,"DOWN_RIGHT")),u(go,"STEPS",[gs.LEFT,gs.UP_LEFT,gs.UP_RIGHT,gs.RIGHT,gs.DOWN_LEFT,gs.DOWN_RIGHT]);class H2 extends Fs{static of(e,t){const n=go.ofCoords(e,t);return H2.ofMovement(e,n)}static ofMovement(e,t){q.assert($r.isOnBoard(e),"Starting coord cannot be out of range (width: 15, height: 10).");const n=new C(e.x+t.direction.x,e.y+t.direction.y);return q.assert($r.isOnBoard(n),"Landing coord cannot be out of range (width: 15, height: 10)."),new H2(e,n)}constructor(e,t){super(e,t)}toString(){return"CoerceoRegularMove("+this.getStart().toString()+" > "+this.getEnd().toString()+")"}equals(e){return!Pl.isTileExchange(e)&&super.equals(e)}}u(H2,"encoder",Fs.getEncoder(H2.of));class o4 extends Pr{static of(e){return q.assert($r.isOnBoard(e),"Captured coord cannot be out of range (width: 15, height: 10)."),new o4(e)}constructor(e){super(e.x,e.y)}toString(){return"CoerceoTileExchangeMove("+this.coord.x+", "+this.coord.y+")"}equals(e){return!!Pl.isTileExchange(e)&&e.coord.equals(this.coord)}}u(o4,"encoder",Pr.getEncoder(o4.of)),function(r){r.isNormalMove=function e(n){return n instanceof H2},r.isTileExchange=function t(n){return n instanceof o4},r.encoder=we.disjunction([r.isNormalMove,r.isTileExchange],[H2.encoder,o4.encoder])}(Pl||(Pl={}));let hC=(dC=class extends Yn{static get(){return T0.singleton.isAbsent()&&(T0.singleton=g.of(new T0)),T0.singleton.get()}constructor(){super($r)}applyLegalMove(e,t,n){return Pl.isTileExchange(e)?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}applyLegalTileExchange(e,t){const n=t.getCopiedBoard(),i=e.coord;n[i.y][i.x]=Ce.EMPTY;const o=[t.captures[0],t.captures[1]];o[t.getCurrentPlayer().value]+=1;const s=[t.tiles[0],t.tiles[1]];s[t.getCurrentPlayer().value]-=2;const c=new $r(n,t.turn,s,o).removeTilesIfNeeded(i,!1);return new $r(c.getCopiedBoard(),c.turn+1,c.tiles,c.captures)}applyLegalMovement(e,t){const o=t.applyLegalMovement(e).removeTilesIfNeeded(e.getStart(),!0).doMovementCaptures(e);return new $r(o.board,t.turn+1,o.tiles,o.captures)}isLegal(e,t){return Pl.isTileExchange(e)?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}isLegalTileExchange(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return b.failure(Id.NOT_ENOUGH_TILES_TO_EXCHANGE());const n=t.getPieceAt(e.coord);return n===Ce.UNREACHABLE||n===Ce.EMPTY?b.failure(Id.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?b.failure(Le.CANNOT_SELF_CAPTURE()):b.SUCCESS}isLegalMovement(e,t){q.assert(t.getPieceAt(e.getStart())!==Ce.UNREACHABLE,"Cannot start with a coord outside the board "+e.getStart().toString()+"."),q.assert(t.getPieceAt(e.getEnd())!==Ce.UNREACHABLE,"Cannot end with a coord outside the board "+e.getEnd().toString()+".");const n=t.getPieceAt(e.getStart());return n===Ce.EMPTY?b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.is(t.getCurrentOpponent())?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.getEnd()).is(t.getCurrentPlayer())?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}static getGameStatus(e){const t=e.gameState;return t.captures[0]>=18?ve.ZERO_WON:t.captures[1]>=18?ve.ONE_WON:ve.ONGOING}getGameStatus(e){return T0.getGameStatus(e)}},T0=dC,u(dC,"singleton",g.empty()),dC);hC=T0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],hC);class rce extends Sr{getListMoves(e){let t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}getListExchanges(e){const t=[],n=e.gameState,i=n.getCurrentPlayer().value,o=Ce.ofPlayer(n.getCurrentOpponent());if(n.tiles[i]<2)return t;for(const s of n.getCoordsAndContents())if(s.content===o){const a=o4.of(s.coord);t.push(a)}return t}getListMovement(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(const o of n.getCoordsAndContents()){const s=o.coord;if(o.content.is(i)){const a=n.getLegalLandings(s);for(const c of a){const l=H2.of(s,c);t.push(l)}}}return t}getMetrics(e){const t=e.gameState,n=t.getPiecesByFreedom(),i=this.getPiecesScore(n);return[2*t.captures[0]+i[0],2*t.captures[1]+i[1]]}getPiecesScore(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}getPlayerPiecesScore(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}putCaptureFirst(e,t){return Re.sortByDescending(t,n=>this.moveCapturesList(e,n).length),t}moveCapturesList(e,t){return Pl.isTileExchange(t)?[t.coord]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.getStart(),!0).getCapturedNeighbors(t.getEnd())}}let gft=(()=>{class r extends rce{getMetrics(t){const n=t.gameState,i=this.getPiecesMap(n),o=this.getThreatMap(n,i),s=this.filterThreatMap(o,n),a=[0,0];for(const c of I.PLAYERS){for(const l of i.get(c).get())s.get(l).isPresent()?a[c.value]+=r.SCORE_BY_THREATENED_PIECE:a[c.value]+=r.SCORE_BY_SAFE_PIECE;a[c.value]+=n.tiles[c.value]}return a}getPiecesMap(t){const n=new un,i=[],o=[];for(const s of t.getCoordsAndContents()){const a=s.coord,c=t.getPieceAt(a);c===Ce.ZERO?i.push(a):c===Ce.ONE&&o.push(a)}return n.set(I.ZERO,new G1(i)),n.set(I.ONE,new G1(o)),n}getThreatMap(t,n){const i=new un;for(const o of I.PLAYERS)for(const s of n.get(o).get()){const a=this.getThreat(s,t);a.isPresent()&&i.set(s,a.get())}return i}getThreat(t,n){const o=I.of(n.getPieceAt(t).value).getOpponent();let s=g.empty(),a=g.empty(),c=[];const l=Bs.getNeighbors(t).filter($r.isOnBoard);for(const f of l){const d=n.getPieceAt(f);if(d.is(o))c.push(f),this.tileCouldBeRemovedThisTurn(f,n,o)&&(a=g.of(f));else if(d===Ce.EMPTY){if(s.isPresent())return g.empty();s=g.of(f)}}if(s.isPresent()){const f=[];for(const d of go.STEPS){const m=s.get().getNext(d.direction,1);$r.isOnBoard(m)&&n.getPieceAt(m).is(o)&&!1===c.some(E=>E.equals(m))&&f.push(m)}if(f.length>0)return g.of(new cC(new G1(c),new G1(f)))}if(a.isPresent()){c=c.filter(d=>d.equals(a.get()));const f=new G1(c);return g.of(new cC(f,new G1([a.get()])))}return g.empty()}tileCouldBeRemovedThisTurn(t,n,i){const o=i.getOpponent();if(!1===n.isDeconnectable(t))return!1;let a=g.empty();const c=$r.getTilesUpperLeftCoord(t);for(let l=0;l<2;l++)for(let f=0;f<3;f++){const d=c.getNext(new St(f,l),1);if(n.getPieceAt(d).is(i)){if(!this.pieceCouldLeaveTheTile(d,n))return!1;a=g.of(d)}else if(n.getPieceAt(d).is(o))return!1}return a.isPresent()}pieceCouldLeaveTheTile(t,n){const i=$r.getTilesUpperLeftCoord(t);for(const o of go.STEPS){const s=t.getNext(o.direction,1),a=$r.getTilesUpperLeftCoord(s);if(!1===i.equals(a)&&$r.isOnBoard(s)&&n.getPieceAt(s)===Ce.EMPTY)return!0}return!1}filterThreatMap(t,n){const i=new un,o=t.listKeys(),s=o.filter(c=>n.getPieceAt(c).is(n.getCurrentPlayer())),a=new G1(o.filter(c=>n.getPieceAt(c).is(n.getCurrentOpponent())));for(const c of s){const l=t.get(c).get();let f=g.empty();for(const d of l.directThreats)if(!1===a.contains(d)){const m=[];for(const E of l.mover)!1===a.contains(E)&&m.push(E);m.length>0&&(f=g.of(new cC(l.directThreats,new G1(m))))}f.isPresent()&&i.set(c,f.get())}for(const c of a){const l=t.get(c).get();i.set(c,l)}return i}}return u(r,"SCORE_BY_THREATENED_PIECE",1e3),u(r,"SCORE_BY_SAFE_PIECE",1e6),r})();const ee=Ce.EMPTY,x=Ce.UNREACHABLE,n1=Ce.ZERO,vn=Ce.ONE;class ice extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,$r.getInitialState()),W.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,$r.getInitialState(),H2.of(new C(3,5),new C(5,5)),$localize`Congratulations! Let's see captures now.`),W.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new $r([[x,x,x,x,x,x,n1,ee,n1,x,x,x,x,x,x],[x,x,x,n1,ee,ee,ee,ee,ee,n1,ee,ee,x,x,x],[ee,vn,ee,vn,n1,vn,ee,ee,n1,ee,ee,vn,ee,vn,ee],[vn,ee,ee,ee,ee,ee,ee,ee,ee,ee,vn,ee,ee,ee,vn],[ee,vn,ee,vn,ee,ee,ee,ee,ee,ee,ee,vn,ee,vn,ee],[ee,n1,ee,n1,ee,ee,ee,ee,ee,ee,ee,n1,ee,n1,ee],[n1,ee,ee,ee,n1,ee,ee,ee,ee,ee,n1,ee,ee,ee,n1],[ee,n1,ee,n1,ee,ee,vn,ee,vn,ee,ee,n1,ee,n1,ee],[x,x,x,ee,ee,vn,ee,ee,ee,vn,ee,ee,x,x,x],[x,x,x,x,x,x,vn,ee,vn,x,x,x,x,x,x]],3,[0,0],[0,0]),[H2.of(new C(5,2),new C(4,1)),H2.of(new C(3,4),new C(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),W.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new $r([[x,x,x,x,x,x,ee,ee,ee,x,x,x,x,x,x],[x,x,x,x,x,x,vn,ee,ee,x,x,x,x,x,x],[ee,ee,ee,x,x,x,ee,ee,ee,x,x,x,x,x,x],[ee,ee,vn,ee,ee,ee,ee,n1,ee,x,x,x,x,x,x],[ee,ee,ee,vn,ee,ee,ee,ee,ee,x,x,x,x,x,x],[ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,n1,x,x,x],[ee,ee,n1,ee,ee,vn,ee,ee,ee,ee,n1,ee,ee,ee,n1],[ee,ee,ee,ee,ee,ee,vn,ee,vn,ee,ee,n1,ee,n1,ee],[x,x,x,ee,ee,vn,ee,ee,ee,vn,ee,ee,x,x,x],[x,x,x,x,x,x,vn,ee,vn,x,x,x,x,x,x]],2,[0,0],[0,0]),[H2.of(new C(2,6),new C(4,6)),H2.of(new C(2,6),new C(3,5)),H2.of(new C(2,6),new C(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),W.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new $r([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,ee,ee,n1,x,x,x,x,x,x,x,x,x],[x,x,x,ee,ee,ee,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,ee,ee,vn,ee,vn,x,x,x,x,x,x],[x,x,x,ee,ee,vn,ee,ee,ee,x,x,x,x,x,x],[x,x,x,x,x,x,vn,ee,vn,x,x,x,x,x,x]],1,[0,2],[0,0]),[o4.of(new C(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),W.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new $r([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,ee,ee,n1,x,x,x,x,x,x],[x,x,x,ee,ee,n1,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,n1,vn,ee,vn,ee,x,x,x,x,x,x],[x,x,x,ee,vn,n1,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,ee,vn,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x]],1,[0,0],[0,0]),[H2.of(new C(7,6),new C(6,5)),H2.of(new C(7,6),new C(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)])}}function mft(r,e){if(1&r&&(A(),F(0,"polygon",7)),2&r){const t=p().index,n=p().index,i=p();ye("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),k("points",i.getTrianglePoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function _ft(r,e){if(1&r){const t=pe();A(),S(0,"g",5),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),T(1,mft,1,5,"polygon",6),P()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),_(1),y("ngIf",i.mustDraw(t,n))}}function vft(r,e){if(1&r&&(A(),S(0,"g"),T(1,_ft,2,3,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Cft(r,e){if(1&r&&(A(),F(0,"polygon",9)),2&r){const t=p().index,n=p().index,i=p();ye("id","pyramid_",t,"_",n,""),y("ngClass",i.getPyramidClass(t,n)),k("points",i.getPyramidPoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function yft(r,e){if(1&r){const t=pe();A(),S(0,"g",5),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),T(1,Cft,1,5,"polygon",8),P()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),_(1),y("ngIf",i.isPyramid(t,n))}}function Mft(r,e){if(1&r&&(A(),S(0,"g"),T(1,yft,2,3,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Eft(r,e){if(1&r){const t=pe();A(),S(0,"rect",12),U("click",function(){const o=te(t).$implicit;return ne(p(2).onClick(o.x,o.y))}),P()}if(2&r){const t=e.$implicit,n=p(2);k("x",-n.INDICATOR_SIZE/2)("y",n.getIndicatorY(t))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)("transform",n.getTriangleInHexTranslate(t.x,t.y))}}function Sft(r,e){if(1&r&&(A(),S(0,"g"),F(1,"polygon",10),T(2,Eft,1,5,"rect",11),P()),2&r){const t=p();_(1),ye("id","selected_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),k("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleInHexTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y)),_(1),y("ngForOf",t.possibleLandings)}}function Pft(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=p(2);ye("id","last_start_",t.lastStart.get().x,"_",t.lastStart.get().y,""),k("points",t.getTrianglePoints(t.lastStart.get().x,t.lastStart.get().y))("transform",t.getTriangleInHexTranslate(t.lastStart.get().x,t.lastStart.get().y))}}function Tft(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=p(2);ye("id","last_end_",t.lastEnd.get().x,"_",t.lastEnd.get().y,""),k("points",t.getTrianglePoints(t.lastEnd.get().x,t.lastEnd.get().y))("transform",t.getTriangleInHexTranslate(t.lastEnd.get().x,t.lastEnd.get().y))}}function Oft(r,e){if(1&r&&(A(),T(0,Pft,1,4,"polygon",13),T(1,Tft,1,4,"polygon",13)),2&r){const t=p();y("ngIf",t.lastStart.isPresent()),_(1),y("ngIf",t.lastEnd.isPresent())}}const bft=function(r){return["base",r]};function wft(r,e){if(1&r&&(A(),S(0,"g",16),F(1,"polygon",17),S(2,"text",18),lt(3),P()()),2&r){const t=p().$implicit,n=p();y("id","tilesCount"+t.value),k("transform",n.getTilesCountTranslate(t)),_(1),y("ngClass",pa(7,bft,"player"+t+"-fill")),k("points",n.getTilesCountCoordinate())("stroke",n.lastTurnWasTilesExchange(t)?"yellow":"black"),_(1),k("font-size",n.SPACE_SIZE/2),_(1),An(n.tiles[t.value])}}function Nft(r,e){if(1&r&&(A(),S(0,"g"),T(1,wft,4,9,"g",15),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngIf",n.mustShowTilesOf(t))}}let Aft=(()=>{var r;class e extends ece{constructor(n){super(n),u(this,"state",void 0),u(this,"tiles",[0,0]),u(this,"NONE",Ce.UNREACHABLE),u(this,"INDICATOR_SIZE",15),u(this,"chosenCoord",g.empty()),u(this,"lastStart",g.empty()),u(this,"lastEnd",g.empty()),u(this,"possibleLandings",[]),u(this,"left",-2*this.STROKE_WIDTH),u(this,"up",-this.SPACE_SIZE/2-2*this.STROKE_WIDTH),u(this,"width",8*this.SPACE_SIZE),u(this,"height",10*(this.SPACE_SIZE+this.STROKE_WIDTH)),this.scores=g.of([0,0]),this.rules=hC.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new rce(this.rules,"Normal"),new gft(this.rules,"Piece > Threat > Tiles")],this.encoder=Pl.encoder,this.tutorial=(new ice).tutorial,this.SPACE_SIZE=70}updateBoard(n){var i=this;return M(function*(){i.chosenCoord=g.empty(),i.state=i.getState(),i.scores=g.of(i.state.captures),i.tiles=i.state.tiles,i.board=i.getState().board})()}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.possibleLandings=[]}showLastMove(n){var i=this;return M(function*(){n instanceof H2?(i.lastStart=g.of(n.getStart()),i.lastEnd=g.of(n.getEnd())):(i.lastStart=g.empty(),i.lastEnd=g.empty())})()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new C(n,i),c=o.state.getCurrentPlayer();return o.chosenCoord.equalsValue(a)?(o.cancelMoveAttempt(),b.SUCCESS):o.chosenCoord.isAbsent()||o.state.getPieceAt(a).is(c)?o.firstClick(a):o.secondClick(a)})()}firstClick(n){var i=this;return M(function*(){const o=i.state.getPieceAt(n);if(o.is(i.state.getCurrentOpponent())){const s=o4.of(n);return i.chooseMove(s)}return o.is(i.state.getCurrentPlayer())?(i.chosenCoord=g.of(n),i.showHighlight(),b.SUCCESS):i.cancelMove(Id.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(n){var i=this;return M(function*(){if(i.possibleLandings.some(o=>o.equals(n))){const o=H2.of(i.chosenCoord.get(),n);return i.chooseMove(o)}return i.cancelMove(Id.INVALID_DISTANCE())})()}isPyramid(n,i){return this.board[i][n].isPlayer()||this.wasOpponent(n,i)}wasOpponent(n,i){const o=this.node.mother;if(o.isPresent()){const s=o.get().gameState.getCurrentOpponent();return o.get().gameState.getPieceAtXY(n,i).is(s)}return!1}getPyramidClass(n,i){const o=this.board[i][n];return o===Ce.ZERO?this.getPlayerClass(I.ZERO):o===Ce.ONE?this.getPlayerClass(I.ONE):"captured-fill"}mustDraw(n,i){return this.board[i][n]!==Ce.UNREACHABLE||this.wasRemoved(n,i)}wasRemoved(n,i){const s=this.node.mother;if(this.board[i][n]===Ce.UNREACHABLE&&s.isPresent()){const a=s.get().gameState.getPieceAtXY(n,i);return a===Ce.EMPTY||a.is(s.get().gameState.getCurrentPlayer())}return!1}getSpaceClass(n,i){return this.wasRemoved(n,i)?"captured-alternate-fill":(n+i)%2==1?"background":"background2"}getTilesCountCoordinate(){return"-15, -40, 35, -40, 60, 10, 35, 60, -15, 60, -40, 10, -15, -40"}mustShowTilesOf(n){return this.tiles[n.value]>0||this.lastTurnWasTilesExchange(n)}lastTurnWasTilesExchange(n){return!this.node.mother.isAbsent()&&this.getPreviousState().tiles[n.value]>this.tiles[n.value]}getIndicatorY(n){const i=this.INDICATOR_SIZE/2;return(n.x+n.y)%2==0?i:i-30}getTriangleInHexTranslate(n,i){const o=this.getTriangleTranslateCoord(n,i),s=o.x+2*Math.floor(n/3)*this.STROKE_WIDTH;let a=o.y;return Math.floor(n/3)%2==0?a+=2*Math.floor(i/2)*this.STROKE_WIDTH:(a+=2*Math.abs(Math.floor((i-1)/2))*this.STROKE_WIDTH,a+=this.STROKE_WIDTH),"translate("+s+", "+a+")"}getTilesCountTranslate(n){let i,o;return n===I.ZERO?(i=-.05,o=-.1):(i=7.5,o=9.45),i*=this.SPACE_SIZE,o*=this.SPACE_SIZE,"translate("+i+", "+o+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-coerceo"]],features:[Qe],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"id","ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],["class","base-no-fill indicator clickable-fill",3,"click",4,"ngFor","ngForOf"],[1,"base-no-fill","indicator","clickable-fill",3,"click"],["class","base no-fill mid-stroke last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount","x","-5","y","5",1,"text-giant"]],template:function(n,i){if(1&n&&(A(),S(0,"svg",0),T(1,vft,2,1,"g",1),T(2,Mft,2,1,"g",1),T(3,Sft,3,5,"g",2),T(4,Oft,2,2,"ng-template",null,3,dn),T(6,Nft,2,1,"g",1),P()),2&n){const o=ln(5);k("viewBox",i.left+" "+i.up+" "+i.width+" "+i.height),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",o),_(3),y("ngForOf",i.Player.PLAYERS)}},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Ift extends Sr{getListMoves(e){return this.sortByNumberOfJump(e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState))}sortByNumberOfJump(e){return e.sort((t,n)=>{const i=h2.isDrop(t)?1:h2.isSimple(t)?2:t.coords.length;return(h2.isDrop(n)?1:h2.isSimple(n)?2:n.coords.length)-i})}getListMovesDrop(e){const t=[],n=Lt.CENTRAL_ZONE_TOP_LEFT,i=Lt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let o=n.y;o<=i.y;o++)for(let s=n.x;s<=i.x;s++)e.getPieceAtXY(s,o)===K.NONE&&t.push(n4.of(new C(s,o)));return t}getListMovesAfterDrop(e){let t=[];const n=e.getCurrentPlayer();for(let i=0;i<Lt.HEIGHT;i++)for(let o=0;o<Lt.WIDTH;o++){const s=new C(o,i);e.getPieceAt(s)===n&&(t=t.concat(this.getListSimpleMoves(e,s)),t=t.concat(this.getListJumps(e,s)))}return t}getListSimpleMoves(e,t){const n=[],i=[new C(t.x+1,t.y),new C(t.x-1,t.y),new C(t.x,t.y+1),new C(t.x,t.y-1),new C(t.x+1,t.y+1),new C(t.x+1,t.y-1),new C(t.x-1,t.y+1),new C(t.x-1,t.y-1)].filter(o=>Lt.isOnBoard(o));for(const o of i){const s=r4.from(t,o);s.isSuccess()&&ps.get().simpleMoveLegality(s.get(),e).isSuccess()&&n.push(s.get())}return n}getListJumps(e,t){const n=new dt;for(const i of ps.get().jumpTargetsFrom(t)){const o=$s.from([t,i]).get();ps.get().jumpLegality(o,e).isSuccess()&&(n.add(o),n.addAll(this.getListJumpStartingFrom(e,o)))}return n.toList()}getListJumpStartingFrom(e,t){const n=ps.get().nextJumps(t,e),i=new dt(n);for(const o of n)i.addAll(this.getListJumpStartingFrom(e,o));return i}getMetrics(e){const t=e.gameState,n=[0,0];for(let i=0;i<Lt.HEIGHT;i++)for(let o=0;o<Lt.WIDTH;o++){const s=new C(o,i),a=t.getPieceAt(s);if(a.isPlayer())if(t.isShelter(s))n[a.value]+=20;else{let c=100;for(const l of Lt.ALL_SHELTERS)if(t.getPieceAt(l)===K.NONE){const f=s.getOrthogonalDistance(l);c=Math.min(c,f)}n[a.value]-=c}}return n}}function kft(r,e){if(1&r){const t=pe();A(),S(0,"rect",9),U("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),P()}if(2&r){const t=p().$implicit,n=p(2);k("x",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.x+n.STROKE_WIDTH)("y",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function xft(r,e){if(1&r){const t=pe();A(),S(0,"circle",6),U("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();ye("id","piece_",n,"_",o,""),y("ngClass",i.pieceClasses),k("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*n+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function Lft(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",6),U("click",function(){const o=te(t).$implicit;return ne(p(2).onClick(o.coord))}),P(),T(2,kft,1,4,"rect",7),T(3,xft,1,6,"circle",8),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),ye("id","click_",n,"_",i,""),y("ngClass",t.squareClasses),k("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t.isShelter),_(1),y("ngIf",t.hasPiece)}}function Rft(r,e){if(1&r&&(A(),S(0,"g"),T(1,Lft,4,9,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function zft(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",10),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),y("ngClass",n.viewInfo.boardInfo[t.y][t.x].shelterClasses),k("x",n.SPACE_SIZE*t.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Dft(r,e){if(1&r&&(A(),F(0,"circle",11)),2&r){const t=e.$implicit,n=p();Dn("id","sidePiece_0_",t,""),k("cx",-n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function Hft(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=e.$implicit,n=p();Dn("id","sidePiece_1_",t,""),k("cx",1715+n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function Vft(r,e){if(1&r&&(A(),F(0,"rect",13)),2&r){const t=p();k("x",t.SPACE_SIZE*t.CENTRAL_ZONE_START.x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.CENTRAL_ZONE_START.y+t.STROKE_WIDTH)("width",t.CENTRAL_ZONE_SIZE.x*t.SPACE_SIZE)("height",t.CENTRAL_ZONE_SIZE.y*t.SPACE_SIZE)}}let Fft=(()=>{var r;class e extends Cl{constructor(n){super(n),u(this,"PIECE_RADIUS",void 0),u(this,"ALL_SHELTERS",Lt.ALL_SHELTERS),u(this,"CENTRAL_ZONE_START",Lt.CENTRAL_ZONE_TOP_LEFT),u(this,"CENTRAL_ZONE_SIZE",new St(Lt.CENTRAL_ZONE_BOTTOM_RIGHT.x-Lt.CENTRAL_ZONE_TOP_LEFT.x+1,Lt.CENTRAL_ZONE_BOTTOM_RIGHT.y-Lt.CENTRAL_ZONE_TOP_LEFT.y+1)),u(this,"viewInfo",{dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]}),u(this,"selected",g.empty()),u(this,"jumpInConstruction",g.empty()),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=ps.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Ift(this.rules,"ConspirateursMinimax")],this.encoder=h2.encoder,this.tutorial=(new Zae).tutorial}updateBoard(n){var i=this;return M(function*(){i.updateViewInfo()})()}updateViewInfo(){const n=this.getState();this.viewInfo.dropPhase=n.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let i=0;i<Lt.HEIGHT;i++){this.viewInfo.boardInfo.push([]);for(let o=0;o<Lt.WIDTH;o++){const s=new C(o,i),a=n.getPieceAt(s),c={coord:s,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(a)],hasPiece:a.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[i].push(c)}}this.viewInfo.sidePieces=n.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const n of Lt.ALL_SHELTERS){const i=this.viewInfo.boardInfo[n.y][n.x];i.isShelter=!0,i.hasPiece&&i.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const n=this.jumpInConstruction.get(),i=n.getStartingCoord(),o=n.getEndingCoord();this.viewInfo.boardInfo[i.y][i.x].hasPiece=!1,this.viewInfo.boardInfo[o.y][o.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[o.y][o.x].hasPiece=!0;for(const s of n.coords)this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("moved-fill")}else{const n=this.selected.get();this.viewInfo.boardInfo[n.y][n.x].pieceClasses.push("selected-stroke")}}updateVictory(){const n=this.getState(),i=ps.get().getGameStatus(this.node);if(!0===i.isEndGame)for(const o of Lt.ALL_SHELTERS)n.getPieceAt(o)===i.winner&&this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("victory-fill")}showLastMove(n){var i=this;return M(function*(){if(h2.isDrop(n))i.viewInfo.boardInfo[n.coord.y][n.coord.x].squareClasses.push("moved-fill");else if(h2.isSimple(n))i.viewInfo.boardInfo[n.getStart().y][n.getStart().x].squareClasses.push("moved-fill"),i.viewInfo.boardInfo[n.getEnd().y][n.getEnd().x].squareClasses.push("moved-fill");else{i.viewInfo.lastMoveArrow="";for(const o of n.coords)i.viewInfo.boardInfo[o.y][o.x].squareClasses.push("moved-fill"),i.viewInfo.lastMoveArrow+=o.x*i.SPACE_SIZE+i.SPACE_SIZE/2+i.STROKE_WIDTH,i.viewInfo.lastMoveArrow+=" ",i.viewInfo.lastMoveArrow+=o.y*i.SPACE_SIZE+i.SPACE_SIZE/2+i.STROKE_WIDTH,i.viewInfo.lastMoveArrow+=" "}})()}cancelMoveAttempt(){var n=this;return M(function*(){n.jumpInConstruction=g.empty(),n.selected=g.empty(),yield n.updateBoard(!1)})()}onClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+n.x+"_"+n.y);if(o.isFailure())return i.cancelMove(o.getReason());const s=i.getState();if(s.getPieceAt(n)===i.getCurrentPlayer())return i.selected.equalsValue(n)?yield i.cancelMoveAttempt():(i.selected=g.of(n),i.jumpInConstruction=g.empty()),i.updateViewInfo(),b.SUCCESS;if(i.jumpInConstruction.isPresent())return i.constructJump(n);if(i.selected.isPresent())return i.selectNextCoord(n);if(s.isDropPhase()){const a=n4.of(n);return i.chooseMove(a)}return i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(n){var i=this;return M(function*(){const o=i.jumpInConstruction.get(),s=i.getState();if(n.equals(o.getEndingCoord()))return i.chooseMove(o);{const a=o.addJump(n);if(a.isFailure())return i.cancelMove(a.getReason());const c=i.rules.jumpLegality(a.get(),s);return c.isFailure()?i.cancelMove(c.getReason()):i.updateJump(a.get())}})()}updateJump(n){var i=this;return M(function*(){const o=i.getState();return i.rules.jumpHasPossibleNextTargets(n,o)?(i.jumpInConstruction=g.of(n),i.updateViewInfo(),b.SUCCESS):i.chooseMove(n)})()}selectNextCoord(n){var i=this;return M(function*(){const o=i.selected.get(),s=r4.from(o,n);if(s.isSuccess())return i.chooseMove(s.get());{const a=$s.from([o,n]);return a.isFailure()?i.cancelMove(a.getReason()):i.updateJump(a.get())}})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-conspirateurs"]],features:[Qe],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,Rft,2,1,"g",1),T(2,zft,2,5,"g",1),T(3,Dft,1,4,"circle",2),T(4,Hft,1,4,"circle",3),T(5,Vft,1,4,"rect",4),F(6,"polyline",5),P()),2&n&&(_(1),y("ngForOf",i.viewInfo.boardInfo),_(1),y("ngForOf",i.ALL_SHELTERS),_(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[0])),_(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[1])),_(1),y("ngIf",i.viewInfo.dropPhase),_(1),k("points",i.viewInfo.lastMoveArrow))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class $ft extends Sr{getListMoves(e){const t=e.gameState,n=this.getListDrops(t),i=this.getListShifts(t);return n.concat(i)}getListShifts(e){const t=[],n=this.getShiftSources(e);for(const i of n)for(const o of[new D2(i,"clockwise"),new D2(i,"counterclockwise")])zc.get().shiftHeightValidity(o,e).isSuccess()&&t.push(o);return t}getListDrops(e){const t=this.getRemainingPiecesForCurrentPlayer(e),n=[];for(let i=0;i<X1.WIDTH;i++)for(const o of t){const s=new i4(i,o);zc.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}return n}getRemainingPiecesForCurrentPlayer(e){const t=[];for(const n of Tn.PLAYER_PIECES)this.currentPlayerCanDropPiece(e,n)&&t.push(n);return t}currentPlayerCanDropPiece(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}getShiftSources(e){const t=[],n=e.getCurrentPlayer();for(let i=0;i<X1.HEIGHT;i++)for(let o=0;o<X1.WIDTH;o++)e.getPieceAtXY(o,i).owner===n&&t.push(new C(o,i));return t}getMetrics(e){return[0,0]}}var RL;function Bft(r,e){if(1&r){const t=pe();A(),S(0,"g",6)(1,"path",7),U("click",function(){const o=te(t).$implicit;return ne(p().onSpaceClick(o))}),P(),S(2,"path",8),U("click",function(){const o=te(t).$implicit;return ne(p().onSpaceClick(o))}),P()()}if(2&r){const t=e.$implicit,n=p();Dn("id","board_space_",t,""),_(1),Dn("id","click_",t,""),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),k("d",n.BOARD_PATHS[t]),_(1),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),k("d",n.DECORATION_PATHS[t])}}function Gft(r,e){if(1&r){const t=pe();A(),S(0,"g",10),U("click",function(){const o=te(t).$implicit,s=p().$implicit;return ne(p().onPieceInGameClick(s,o.y))}),F(1,"use",11)(2,"use",12),P()}if(2&r){const t=e.$implicit;ye("id","click_",p().$implicit,"_",t.y,""),y("ngClass",t.foregroundClasses),_(1),y("ngClass",t.backgroundClasses),k("x",t.drawPosition.x)("y",t.drawPosition.y),_(1),k("x",t.drawPosition.x)("y",t.drawPosition.y)}}function Uft(r,e){if(1&r&&(A(),S(0,"g"),T(1,Gft,3,8,"g",9),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.viewInfo.boardInfo[t].pieces)}}function Wft(r,e){if(1&r){const t=pe();A(),S(0,"g",14),U("click",function(){const i=te(t),o=i.$implicit,s=i.index;return ne(p(2).onRemainingPieceClick(o.actualPiece,s))}),F(1,"use",11)(2,"use",12),P()}if(2&r){const t=e.$implicit,n=e.index;Oi("id","piece_",t.actualPiece.owner.toString(),"_",t.actualPiece.otherPieceType?1:0,"_",n,""),y("ngClass",t.foregroundClasses),_(1),y("ngClass",t.backgroundClasses),k("x",t.drawPosition.x)("y",t.drawPosition.y),_(1),k("x",t.drawPosition.x)("y",t.drawPosition.y)}}function qft(r,e){if(1&r&&(A(),S(0,"g"),T(1,Wft,3,9,"g",13),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.viewInfo.remainingPieces.get(t).get())}}const jft=function(){return[0,1,2,3,4,5,6,7]},Zft=function(){return[2,1,3,0,4,7,5,6]};class Dc extends Cl{constructor(e){super(e),u(this,"BOARD_PATHS",["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"]),u(this,"DECORATION_PATHS",["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"]),u(this,"selected",g.empty()),u(this,"viewInfo",{boardInfo:[],remainingPieces:new un([{key:I.ZERO,value:[]},{key:I.ONE,value:[]}])}),this.rules=zc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new $ft(this.rules,"DiamDummyMinimax")],this.encoder=dft,this.tutorial=(new Jae).tutorial}onSpaceClick(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#click_"+e);return n.isFailure()?t.cancelMove(n.getReason()):t.onSpaceClickAfterCheck(e)})()}onSpaceClickAfterCheck(e){var t=this;return M(function*(){if(t.selected.isPresent()){const n=t.selected.get();let i;if("pieceFromReserve"===n.type)i=new i4(e,n.piece);else if((n.position.x+1)%X1.WIDTH===e)i=new D2(n.position,"clockwise");else{if((n.position.x+(X1.WIDTH-1))%X1.WIDTH!==e)return t.cancelMove(Ad.MUST_SHIFT_TO_NEIGHBOR());i=new D2(n.position,"counterclockwise")}return t.chooseMove(i)}return t.cancelMove(Ad.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const o=new C(e,t);return n.getState().getPieceAt(o).owner===n.getCurrentPlayer()?(n.isSelected(null,o)?yield n.cancelMoveAttempt():n.selected=g.of({type:"pieceFromBoard",position:o}),n.updateViewInfo(),b.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay(n.getPieceId(e,t));return i.isFailure()?n.cancelMove(i.getReason()):e.owner===n.getCurrentPlayer()?(n.selected=n.isSelected(e)?g.empty():g.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),b.SUCCESS):n.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}isSelected(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}updateBoard(e){var t=this;return M(function*(){t.updateViewInfo()})()}getLastMovedFromDrop(e,t){const n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),i=e.getTarget(),o=t.getStackHeight(e.getTarget()),s=this.getDrawPositionOnBoard(i,o),a=new C(i,o);return[{start:g.empty(),end:a,startDrawPosition:n,endDrawPosition:s}]}getLastMovedFromShift(e,t){const n=e.start.x,i=e.getTarget();let o=t.getStackHeight(i);const s=[];for(let a=e.start.y;a<X1.HEIGHT&&t.getPieceAtXY(n,a)!==Tn.EMPTY;a++,o++)s.push({start:g.of(new C(n,a)),end:new C(i,o),startDrawPosition:this.getDrawPositionOnBoard(n,a),endDrawPosition:this.getDrawPositionOnBoard(i,o)});return s}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let e=0;e<X1.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}showLastMove(e){var t=this;return M(function*(){t.showLastMoveOnSpaces(e),t.showLastMoveOnPieces(e)})()}showLastMoveOnSpaces(e){for(let t=0;t<X1.WIDTH;t++){const n=[];if(e.isDrop())e.getTarget()===t&&n.push("moved-fill");else{const i=e;(i.getTarget()===t||i.start.x===t)&&n.push("moved-fill")}this.viewInfo.boardInfo[t].spaceClasses=n}}showLastMoveOnPieces(e){const t=this.getPreviousState();let n=[];n=e.isDrop()?this.getLastMovedFromDrop(e,t):this.getLastMovedFromShift(e,t);for(const i of n)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new un([{key:I.ZERO,value:[]},{key:I.ONE,value:[]}]);const t=this.isPlayerTurn();for(const n of Tn.PLAYER_PIECES){const i=this.getState().getRemainingPiecesOf(n);for(let o=0;o<i;o++){const s=[];this.isTopPieceOfReserveAndSelected(o,i,n)&&s.push("selected-stroke"),t&&o===i-1&&n.owner===e&&s.push("clickable-stroke-hover");const a=this.viewInfo.remainingPieces.get(n.owner).get(),c=[];c.push(n.otherPieceType?"player"+n.owner.value+"-alternate-fill":"player"+n.owner.value+"-fill"),a.push({backgroundClasses:c,foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(n,o),actualPiece:n}),this.viewInfo.remainingPieces.put(n.owner,a)}}}isTopPieceOfReserveAndSelected(e,t,n){if(this.selected.isPresent()){const i=this.selected.get();return"pieceFromReserve"===i.type&&i.piece===n&&e===t-1}return!1}getDrawPositionRemainingPiece(e,t){let n,i;return n=e.owner===I.ZERO?-100:600,i=e.otherPieceType?100:450,new C(n,i).getNext(new St(0,-t*Dc.PIECE_HEIGHT))}getPieces(e){const t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),i=[];for(let o=0;o<X1.HEIGHT;o++){const s=this.getState().getPieceAtXY(e,o),a=new C(e,o);if(s!==Tn.EMPTY){const c=[];this.pieceFromBoardIsSelected(e,o)&&c.push("selected-stroke"),this.isVictory(e,o,t)&&c.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),a)&&c.push("clickable-stroke-hover"),i.push({backgroundClasses:["player"+s.owner.value+(s.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:c,y:o,drawPosition:this.getDrawPositionOnBoard(e,o),actualPiece:s})}}return i}pieceFromBoardIsSelected(e,t){if(this.selected.isPresent()){const n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}isVictory(e,t,n){if(n.isPresent()){const i=n.get();return i.x%4==e%4&&i.y===t}return!1}getDrawPositionOnBoard(e,t){return Dc.CENTER[e].getNext(new St(0,-t*Dc.PIECE_HEIGHT))}cancelMoveAttempt(){var e=this;return M(function*(){e.selected=g.empty(),yield e.updateBoard(!1)})()}}RL=Dc,u(Dc,"CENTER",[new C(40,160),new C(100,50),new C(255,2),new C(400,50),new C(460,160),new C(400,270),new C(255,320),new C(100,270)]),u(Dc,"PIECE_HEIGHT",36),u(Dc,"\u0275fac",function(e){return new(e||RL)(G(Ut))}),u(Dc,"\u0275cmp",je({type:RL,selectors:[["app-diam"]],features:[Qe],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(A(),S(0,"svg",0)(1,"defs")(2,"g",1),F(3,"path",2)(4,"ellipse",3),P()(),T(5,Bft,3,6,"g",4),T(6,Uft,2,1,"g",5),T(7,qft,2,1,"g",5),P()),2&e&&(_(5),y("ngForOf",_1(3,jft)),_(1),y("ngForOf",_1(4,Zft)),_(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Ft,Wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class ms{static fromTwoCoords(e,t){const n=e.x,i=t.x,o=e.y,s=t.y,a=n+o,c=i+s;return n===i&&o!==s&&a!==c?g.of(ms.constantQ(n)):n!==i&&o===s&&a!==c?g.of(ms.constantR(o)):n!==i&&o!==s&&a===c?g.of(ms.constantS(a)):g.empty()}static constantQ(e){return new ms(e,"q")}static constantR(e){return new ms(e,"r")}static constantS(e){return new ms(e,"s")}static areOnSameLine(e){if(e.length<2)return!0;const t=ms.fromTwoCoords(e[0],e[1]);if(t.isAbsent())return!1;const n=t.get();for(const i of e.slice(2))if(!1===n.contains(i))return!1;return!0}constructor(e,t){u(this,"offset",void 0),u(this,"constant",void 0),this.offset=e,this.constant=t}toString(){return`Line(${this.constant}, ${this.offset})`}equals(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}contains(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}getDirection(){switch(this.constant){case"q":return be.DOWN;case"r":return be.RIGHT;case"s":return be.DOWN_LEFT}}}class zL extends B1{constructor(e,t,n,i,o,s){super(t,e),u(this,"width",void 0),u(this,"height",void 0),u(this,"excludedSpaces",void 0),u(this,"empty",void 0),this.width=n,this.height=i,this.excludedSpaces=o,this.empty=s,Fe(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}equalsT(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedSpaces.length!==e.excludedSpaces.length)return!1;for(let n=0;n<this.excludedSpaces.length;n++)if(this.excludedSpaces[n]!==e.excludedSpaces[n])return!1;for(const n of this.allCoords())if(!1===t(this.getPieceAt(n),e.getPieceAt(n)))return!1;return!0}allCoords(){const e=[];return this.forEachCoord(t=>{e.push(t)}),e}allLines(){const e=[];for(let t=0;t<this.width;t++)e.push(ms.constantQ(t));for(let t=0;t<this.height;t++)e.push(ms.constantR(t));for(let t=this.excludedSpaces.length;t<this.height+this.excludedSpaces.length;t++)e.push(ms.constantS(t));return e}getEntranceOnLine(e){let t,n;switch(e.constant){case"q":return n=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new C(e.offset,n));case"r":return t=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new C(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new C(e.offset,0):new C(this.width-1,e.offset-this.width+1))}}findEntranceFrom(e,t){const n=e.getDirection();let i=t;for(let s=0;s<Math.max(this.width,this.height);s++){if(this.isOnBoard(i))return i;i=i.getNext(n)}const o=u2.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(o.getReason())}}class p2{static getNeighbors(e,t=1){const n=[];for(const i of be.factory.all)n.push(e.getNext(i,t));return n}static areNeighbors(e,t){for(const n of be.factory.all)if(e.getNext(n).equals(t))return!0;return!1}}var O0;class f1{static append(e,t){return new f1(e.owner,e.size+t.size,e.source||t.source)}constructor(e,t,n){u(this,"owner",void 0),u(this,"size",void 0),u(this,"source",void 0),this.owner=e,this.size=t,this.source=n}getOwner(){return this.owner}belongsTo(e){return this.owner===e}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(e){return this.owner===e.owner&&this.size===e.size&&this.source===e.source}}O0=f1,u(f1,"encoder",we.tuple([we.identity(),I.encoder,we.identity()],r=>[r.source,r.owner,r.size],r=>new O0(r[1],r[2],r[0]))),u(f1,"MAX_SIZE",49),u(f1,"EMPTY",new O0(K.NONE,0,!1)),u(f1,"UNREACHABLE",new O0(K.NONE,-1,!1)),u(f1,"PLAYER_ZERO",new O0(I.ZERO,1,!1)),u(f1,"PLAYER_ONE",new O0(I.ONE,1,!1)),u(f1,"SOURCE",new O0(K.NONE,1,!0));let Gs=(()=>{class r extends zL{static balancedBoard(){const t=f1.UNREACHABLE,n=f1.PLAYER_ZERO,i=f1.PLAYER_ONE,o=f1.SOURCE;return[[t,t,n,i,i,i,n,n,i,o,i],[t,i,i,n,n,n,i,i,n,i,i],[i,i,i,i,n,o,i,n,n,n,n],[n,n,i,n,n,i,i,i,n,n,t],[n,o,n,i,i,n,n,n,i,t,t]]}static isOnBoard(t){return!t.isNotInRange(r.WIDTH,r.HEIGHT)&&r.balancedBoard()[t.y][t.x]!==f1.UNREACHABLE}static getInitialState(){return new r(r.balancedBoard(),0,!1)}constructor(t,n,i){super(n,t,r.WIDTH,r.HEIGHT,r.EXCLUDED_SPACES,f1.EMPTY),u(this,"alreadyPassed",void 0),this.alreadyPassed=i}getAllPieces(){const t=[];for(let n=0;n<r.HEIGHT;n++)for(let i=0;i<r.WIDTH;i++){const o=new C(i,n);this.isOnBoard(o)&&this.getPieceAt(o).hasPieces()&&t.push(o)}return t}numberOfNeighbors(t){return p2.getNeighbors(t,1).filter(o=>this.isOnBoard(o)&&this.getPieceAt(o).hasPieces()).length}setAtUnsafe(t,n){const i=Re.copyBiArray(this.board);return i[t.y][t.x]=n,new r(i,this.turn,this.alreadyPassed)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==f1.UNREACHABLE}}return u(r,"WIDTH",11),u(r,"HEIGHT",5),u(r,"EXCLUDED_SPACES",[2,1]),r})(),b0=(()=>{class r{}return u(r,"NOT_PLAYER_PIECE",()=>$localize`You must select a piece or a stack of your color.`),u(r,"EMPTY_STACK",()=>$localize`You must select a stack.`),u(r,"TOO_MANY_NEIGHBORS",()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`),u(r,"CANT_REACH_TARGET",()=>$localize`This stack cannot move because it could never land on another piece.`),u(r,"INVALID_MOVE_LENGTH",()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`),u(r,"EMPTY_TARGET_STACK",()=>$localize`The stack must land on an occupied space.`),u(r,"MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`A stack must move in a straight line.`),r})();var DL;class lr extends Fs{constructor(e,t){super(e,t)}static from(e,t){return-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y?ie.success(lr.PASS):!1===Gs.isOnBoard(e)?ie.failure("Starting coord of DvonnMove must be on the board, not at "+e.toString()):!1===Gs.isOnBoard(t)?ie.failure("End coord of DvonnMove must be on the board, not at "+e.toString()):e.y===t.y||e.x===t.x||e.x+e.y===t.x+t.y?ie.success(new lr(e,t)):ie.failure(b0.MUST_MOVE_IN_STRAIGHT_LINE())}toString(){return this===lr.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}}u(lr,"PASS",new(DL=lr)(new C(-1,-1),new C(-2,-2))),u(lr,"encoder",Ho.getFallibleEncoder(DL.from));const oe=f1.EMPTY,Q1=f1.UNREACHABLE,Tl=f1.SOURCE,uu=f1.PLAYER_ZERO,fu=f1.PLAYER_ONE,Yft=new f1(I.ZERO,2,!1),HL=new f1(I.ONE,2,!1),oce=new f1(I.ZERO,4,!1),Kft=new f1(I.ONE,4,!1);class sce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Gs.getInitialState(),lr.from(new C(2,0),new C(3,0)).get(),$localize`Congratulations!`),W.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Gs([[Q1,Q1,fu,Tl,oe,oe,oe,oe,oe,oe,oe],[Q1,oe,uu,oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,Kft,oe,oe,oe,oe,fu,Tl,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,Q1],[oe,oe,oe,oe,oe,oe,oe,oe,oe,Q1,Q1]],0,!1),lr.from(new C(2,1),new C(2,0)).get(),(t,n,i)=>t.getEnd().equals(new C(3,0))?b.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(Fe(t.getEnd().equals(new C(2,0)),"player made an impossible move"),b.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),W.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Gs([[Q1,Q1,Tl,fu,oe,oe,oe,oe,oe,oe,oe],[Q1,uu,uu,oe,oe,oe,oe,oe,oe,oe,oe],[oe,fu,uu,fu,oe,oe,uu,HL,Tl,oe,oe],[oe,oe,fu,oe,oe,oe,oe,oe,oe,oe,Q1],[oe,oe,oe,oe,oe,oe,oe,oe,oe,Q1,Q1]],0,!1),lr.from(new C(2,1),new C(2,0)).get(),(t,n,i)=>t.getEnd().equals(new C(2,0))?b.SUCCESS:b.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),W.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Gs([[Q1,Q1,Tl,oe,oe,oe,oe,oe,oe,oe,oe],[Q1,oe,Yft,oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,HL,oe,oe,oe,oe,HL,Tl,oce,oe],[oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,Q1],[oe,oe,oe,oe,oe,oe,oe,oe,oe,Q1,Q1]],0,!1)),W.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new Gs([[Q1,Q1,Tl,oe,oe,oe,oe,oe,oe,oe,oe],[Q1,oe,uu,oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe,Tl,oce,oe],[oe,oe,oe,oe,oe,oe,oe,oe,oe,oe,Q1],[oe,oe,oe,oe,oe,oe,oe,oe,oe,Q1,Q1]],0,!1),[lr.from(new C(2,1),new C(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)])}}class Tr extends Yn{static get(){return Tr.singleton.isAbsent()&&(Tr.singleton=g.of(new Tr)),Tr.singleton.get()}constructor(){super(Gs)}static getGameStatus(e){const t=e.gameState,n=Tr.getScores(t);return 0===Tr.getMovablePieces(t).length?n[0]>n[1]?ve.ZERO_WON:n[0]<n[1]?ve.ONE_WON:ve.DRAW:ve.ONGOING}static getMovablePieces(e){return Tr.getFreePieces(e).filter(t=>Tr.pieceHasTarget(e,t))}static getFreePieces(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6)}static pieceHasTarget(e,t){const n=e.getPieceAt(t).getSize();return void 0!==p2.getNeighbors(t,n).find(o=>e.isOnBoard(o)&&e.getPieceAt(o).hasPieces())}static pieceTargets(e,t){const n=e.getPieceAt(t).getSize();return p2.getNeighbors(t,n).filter(o=>e.isOnBoard(o)&&e.getPieceAt(o).hasPieces())}static getScores(e){let t=0,n=0;return e.getAllPieces().map(i=>{const o=e.getPieceAt(i);o.belongsTo(I.ZERO)?t+=o.getSize():o.belongsTo(I.ONE)&&(n+=o.getSize())}),[t,n]}isMovablePiece(e,t){Fe(e.isOnBoard(t),"piece is not on the board");const n=e.getPieceAt(t);return n.getSize()<1?b.failure(b0.EMPTY_STACK()):!1===n.belongsTo(e.getCurrentPlayer())?b.failure(b0.NOT_PLAYER_PIECE()):e.numberOfNeighbors(t)>=6?b.failure(b0.TOO_MANY_NEIGHBORS()):!1===Tr.pieceHasTarget(e,t)?b.failure(b0.CANT_REACH_TARGET()):b.SUCCESS}canOnlyPass(e){return 0===Tr.getMovablePieces(e).length}sourceCoords(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).containsSource())}markPiecesConnectedTo(e,t,n){p2.getNeighbors(t,1).forEach(i=>{e.isOnBoard(i)&&!1===n[i.y][i.x]&&e.getPieceAt(i).hasPieces()&&(n[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,n))})}removeDisconnectedPieces(e){const t=Re.createTable(Gs.WIDTH,Gs.HEIGHT,!1);this.sourceCoords(e).forEach(i=>{t[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,t)});let n=e;return n.getAllPieces().forEach(i=>{!1===t[i.y][i.x]&&(n=n.setAt(i,f1.EMPTY))}),n}applyLegalMove(e,t,n){if(e===lr.PASS)return new Gs(t.board,t.turn+1,!0);{const i=t.getPieceAt(e.getStart()),o=t.getPieceAt(e.getEnd()),s=t.setAt(e.getStart(),f1.EMPTY).setAt(e.getEnd(),f1.append(i,o));return this.removeDisconnectedPieces(new Gs(s.board,t.turn+1,!1))}}isLegal(e,t){if(0===Tr.getMovablePieces(t).length)return e===lr.PASS&&!1===t.alreadyPassed?b.SUCCESS:b.failure(Le.MUST_PASS());if(e===lr.PASS)return b.failure(Le.CANNOT_PASS());const n=this.isMovablePiece(t,e.getStart());if(n.isFailure())return n;const i=t.getPieceAt(e.getStart());return e.length()!==i.getSize()?ie.failure(b0.INVALID_MOVE_LENGTH()):t.getPieceAt(e.getEnd()).isEmpty()?ie.failure(b0.EMPTY_TARGET_STACK()):ie.success(void 0)}getGameStatus(e){return Tr.getGameStatus(e)}}u(Tr,"singleton",g.empty());class ace extends Sr{getListMoves(e){const t=e.move,n=e.gameState,i=[];return Tr.getMovablePieces(n).forEach(o=>Tr.pieceTargets(n,o).forEach(s=>{const a=lr.from(o,s).get();i.push(a)})),0===i.length&&!1===t.equalsValue(lr.PASS)&&i.push(lr.PASS),i}getMetrics(e){return Tr.getScores(e.gameState)}}class Xft extends ace{getListMoves(e){const t=e.gameState,n=super.getListMoves(e),i=t.getCurrentOpponent();return Re.sortByDescending(n,o=>{Fe(o!==lr.PASS,"Cannot sort with DvonnMove.PASS");const s=t.getPieceAt(o.getEnd());return s.belongsTo(i)?s.getSize():0}),n}getMetrics(e){const t=e.gameState,n=Tr.getScores(t),i=t.getAllPieces(),o=i.length;for(const s of I.PLAYERS){const a=i.filter(c=>t.getPieceAt(c).belongsTo(s)).length;n[s.value]=n[s.value]*a/o}return n}}function Qft(r,e){if(1&r&&(A(),F(0,"circle",11)),2&r){const t=p().$implicit,n=p().$implicit,i=p();ye("id","piece_",n.x,"_",n.y,""),y("ngClass",i.getPieceClasses(t)),k("cx",i.getCenterAt(n).x)("cy",i.getCenterAt(n).y)("r",i.SPACE_SIZE)}}function Jft(r,e){if(1&r&&(A(),F(0,"polygon",12)),2&r){const t=p().$implicit,n=p().$implicit,i=p();k("transform",1===t.getSize()?"translate("+(i.getCenterAt(n).x-18)+" "+(i.getCenterAt(n).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(n).x-3)+" "+(i.getCenterAt(n).y-12)+") scale(0.07)")}}function e9t(r,e){if(1&r){const t=pe();A(),S(0,"text",13),U("click",function(){te(t);const i=p(2).$implicit;return ne(p().onClick(i.x,i.y))}),lt(1),P()}if(2&r){const t=p().$implicit,n=p().$implicit,i=p();k("x",t.containsSource()?i.getCenterAt(n).x-7:i.getCenterAt(n).x)("y",i.getCenterAt(n).y),_(1),An(t.getSize())}}function t9t(r,e){if(1&r){const t=pe();A(),S(0,"g",6),U("click",function(){te(t);const i=p().$implicit;return ne(p().onClick(i.x,i.y))}),F(1,"polygon",7),T(2,Qft,1,6,"circle",8),T(3,Jft,1,1,"polygon",9),T(4,e9t,2,3,"text",10),P()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p();ye("id","click_",n.x,"_",n.y,""),_(1),k("points",i.getHexaPointsAt(n)),_(1),y("ngIf",t.getSize()>0),_(1),y("ngIf",t.containsSource()),_(1),y("ngIf",t.getSize()>1)}}const n9t=function(r){return[r]};function r9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,t9t,5,6,"g",5),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",pa(1,n9t,n.state.getPieceAt(t)))}}function i9t(r,e){if(1&r&&(A(),S(0,"text",18),lt(1),P()),2&r){const t=p().$implicit,n=p();k("x",n.getCenterAt(t.coord).x)("y",n.getCenterAt(t.coord).y),_(1),An(t.spaceContent.getSize())}}function o9t(r,e){if(1&r&&(A(),S(0,"g",14),F(1,"polygon",15)(2,"circle",16),T(3,i9t,2,3,"text",17),P()),2&r){const t=e.$implicit,n=p();ye("id","disconnected_",t.coord.x,"_",t.coord.y,""),_(1),k("points",n.getHexaPointsAt(t.coord)),_(1),ye("id","captured_",t.coord.x,"_",t.coord.y,""),y("ngClass",n.getPieceClasses(t.spaceContent)),k("cx",n.getCenterAt(t.coord).x)("cy",n.getCenterAt(t.coord).y)("r",n.SPACE_SIZE),_(1),y("ngIf",t.spaceContent.getSize()>1)}}function s9t(r,e){if(1&r&&(A(),Bt(0),F(1,"polygon",19)(2,"polygon",19),Gt()),2&r){const t=p();_(1),k("points",t.getHexaPointsAt(t.lastMove.get().getStart())),_(1),k("points",t.getHexaPointsAt(t.lastMove.get().getEnd()))}}function a9t(r,e){if(1&r&&(A(),F(0,"polygon",20)),2&r){const t=p();ye("id","chosen_",t.chosen.get().x,"_",t.chosen.get().y,""),k("points",t.getHexaPointsAt(t.chosen.get()))}}let c9t=(()=>{var r;class e extends iu{constructor(n){super(n),u(this,"lastMove",g.empty()),u(this,"chosen",g.empty()),u(this,"disconnecteds",[]),u(this,"state",void 0),this.rules=Tr.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new ace(this.rules,"DvonnMinimax"),new Xft(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=lr.encoder,this.tutorial=(new sce).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=g.of(Tr.getScores(this.getState())),this.hexaLayout=new ou(1.5*this.SPACE_SIZE,new C(-this.SPACE_SIZE,2*this.SPACE_SIZE),iC.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=g.empty()}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.state=i.getState(),i.disconnecteds=[],i.hideLastMove(),i.canPass=i.rules.canOnlyPass(i.state),i.scores=g.of(Tr.getScores(i.state))})()}showLastMove(n){var i=this;return M(function*(){i.lastMove=g.of(n);const o=i.getPreviousState(),s=i.getState();for(let a=0;a<s.board.length;a++)for(let c=0;c<s.board[a].length;c++){const l=new C(c,a);if(!0===s.isOnBoard(l)&&!1===l.equals(i.lastMove.get().getStart())){const f=s.getPieceAt(l),d=o.getPieceAt(l);if(f.isEmpty()&&d.hasPieces()){const E={coord:new C(c,a),spaceContent:d};i.disconnecteds.push(E)}}}})()}cancelMoveAttempt(){this.chosen=g.empty()}pass(){var n=this;return M(function*(){return Fe(n.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield n.chooseMove(lr.PASS)})()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);return s.isFailure()?o.cancelMove(s.getReason()):o.chosen.isAbsent()?o.choosePiece(n,i):o.chosen.equalsValue(new C(n,i))?(o.cancelMoveAttempt(),b.SUCCESS):yield o.chooseDestination(n,i)})()}choosePiece(n,i){var o=this;return M(function*(){const s=new C(n,i),a=o.rules.isMovablePiece(o.getState(),s);return a.isSuccess()?(o.chosen=g.of(s),b.SUCCESS):o.cancelMove(a.getReason())})()}chooseDestination(n,i){var o=this;return M(function*(){const s=o.getState(),a=o.chosen.get(),c=new C(n,i),l=lr.from(a,c);return l.isFailure()?o.rules.isMovablePiece(s,c).isSuccess()?o.choosePiece(n,i):o.cancelMove(l.getReason()):o.rules.isLegal(l.get(),s).isFailure()&&o.rules.isMovablePiece(s,c).isSuccess()?o.choosePiece(n,i):o.chooseMove(l.get())})()}getPieceClasses(n){if(n.containsSource()&&1===n.getSize())return["nonplayer-fill","dashed-stroke"];const i=this.getPlayerClass(n.getOwner());return n.containsSource()?[i,"nonplayer-stroke","dashed-stroke"]:[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-dvonn"]],features:[Qe],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,r9t,2,3,"g",1),T(2,o9t,4,10,"g",2),T(3,s9t,3,2,"ng-container",3),T(4,a9t,1,3,"polygon",4),P()),2&n&&(_(1),y("ngForOf",i.state.allCoords()),_(1),y("ngForOf",i.disconnecteds),_(1),y("ngIf",i.lastMove.isPresent()),_(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var s4,x1=function(r){return r[r.NONE=0]="NONE",r[r.SMALL=1]="SMALL",r[r.MEDIUM=2]="MEDIUM",r[r.BIG=3]="BIG",r}(x1||{});class We{static of(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}static ofSizeAndPlayer(e,t){return t===I.ZERO&&e===x1.BIG?We.BIG_DARK:t===I.ZERO&&e===x1.MEDIUM?We.MEDIUM_DARK:t===I.ZERO&&e===x1.SMALL?We.SMALL_DARK:t===I.ONE&&e===x1.BIG?We.BIG_LIGHT:t===I.ONE&&e===x1.MEDIUM?We.MEDIUM_LIGHT:t===I.ONE&&e===x1.SMALL?We.SMALL_LIGHT:We.NONE}constructor(e){u(this,"value",void 0),this.value=e}getPlayer(){switch(this){case We.SMALL_DARK:case We.MEDIUM_DARK:case We.BIG_DARK:return I.ZERO;case We.SMALL_LIGHT:case We.MEDIUM_LIGHT:case We.BIG_LIGHT:return I.ONE;default:return K.NONE}}getSize(){switch(this){case We.BIG_DARK:case We.BIG_LIGHT:return x1.BIG;case We.MEDIUM_DARK:case We.MEDIUM_LIGHT:return x1.MEDIUM;case We.SMALL_DARK:case We.SMALL_LIGHT:return x1.SMALL;default:return q.expectToBe(this,We.NONE),x1.NONE}}belongsTo(e){return this.getPlayer()===e}equals(e){return this===e}toString(){switch(this){case We.BIG_DARK:return"BIG_DARK";case We.BIG_LIGHT:return"BIG_LIGHT";case We.MEDIUM_DARK:return"MEDIUM_DARK";case We.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case We.SMALL_DARK:return"SMALL_DARK";case We.SMALL_LIGHT:return"SMALL_LIGHT";default:return q.expectToBe(this,We.NONE),"EMPTY"}}}s4=We,u(We,"encoder",we.tuple([we.identity()],r=>[r.value],r=>s4.of(r[0]))),u(We,"SMALL_DARK",new s4(0)),u(We,"SMALL_LIGHT",new s4(1)),u(We,"MEDIUM_DARK",new s4(2)),u(We,"MEDIUM_LIGHT",new s4(3)),u(We,"BIG_DARK",new s4(4)),u(We,"BIG_LIGHT",new s4(5)),u(We,"NONE",new s4(6));class Ol extends B1{constructor(e,t,n){super(e,t),u(this,"remainingPieces",void 0),this.remainingPieces=n}static getInitialState(){const e=new V2(K.NONE,K.NONE,K.NONE),t=Re.createTable(3,3,e);return new Ol(t,0,[We.BIG_DARK,We.BIG_DARK,We.BIG_LIGHT,We.BIG_LIGHT,We.MEDIUM_DARK,We.MEDIUM_DARK,We.MEDIUM_LIGHT,We.MEDIUM_LIGHT,We.SMALL_DARK,We.SMALL_DARK,We.SMALL_LIGHT,We.SMALL_LIGHT])}getRemainingPieces(){return Re.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(e){return this.getRemainingPieces().filter(t=>t.getPlayer()===e)}pieceBelongsToCurrentPlayer(e){return e.belongsTo(this.getCurrentPlayer())}isDroppable(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}isInRemainingPieces(e){return this.remainingPieces.some(t=>t===e)}getPlayerRemainingPieces(){return this.remainingPieces.filter(e=>this.pieceBelongsToCurrentPlayer(e))}}class V2{constructor(e,t,n){u(this,"small",void 0),u(this,"medium",void 0),u(this,"big",void 0),this.small=e,this.medium=t,this.big=n}isEmpty(){return this.small===K.NONE&&this.medium===K.NONE&&this.big===K.NONE}toList(){const e=[];return this.small.isPlayer()&&e.push(We.ofSizeAndPlayer(x1.SMALL,this.small)),this.medium.isPlayer()&&e.push(We.ofSizeAndPlayer(x1.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(We.ofSizeAndPlayer(x1.BIG,this.big)),e}toOrderedPieceNames(){const e=We.ofSizeAndPlayer(x1.SMALL,this.small),t=We.ofSizeAndPlayer(x1.MEDIUM,this.medium),n=We.ofSizeAndPlayer(x1.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}getBiggest(){return this.big===I.ZERO?We.BIG_DARK:this.big===I.ONE?We.BIG_LIGHT:this.medium===I.ZERO?We.MEDIUM_DARK:this.medium===I.ONE?We.MEDIUM_LIGHT:this.small===I.ZERO?We.SMALL_DARK:this.small===I.ONE?We.SMALL_LIGHT:We.NONE}tryToSuperposePiece(e){const t=this.getBiggest().getSize();if(e===We.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?g.of(this.put(e)):g.empty()}removeBiggest(){const e=this.getBiggest();if(e===We.NONE)throw new Error("Cannot removed piece from empty space");let t;const n=e.getSize();switch(n){case x1.BIG:t=new V2(this.small,this.medium,K.NONE);break;case x1.MEDIUM:t=new V2(this.small,K.NONE,K.NONE);break;default:q.expectToBe(n,x1.SMALL),t=new V2(K.NONE,K.NONE,K.NONE)}return{removedSpace:t,removedPiece:e}}put(e){if(e===We.NONE)throw new Error("Cannot put NONE on space");const t=e.getPlayer(),n=e.getSize();switch(n){case x1.BIG:return new V2(this.small,this.medium,t);case x1.MEDIUM:return Fe(this.big===K.NONE,"Cannot put a piece on top of a bigger one"),new V2(this.small,t,this.big);default:return q.expectToBe(n,x1.SMALL),Fe(this.big===K.NONE,"Cannot put a piece on top of a bigger one"),Fe(this.medium===K.NONE,"Cannot put a piece on top of a bigger one"),new V2(t,this.medium,this.big)}}belongsTo(e){return this.getBiggest().getPlayer()===e}toString(){const e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}u(V2,"EMPTY",new V2(K.NONE,K.NONE,K.NONE));let kd=(()=>{class r{}return u(r,"PIECE_OUT_OF_STOCK",()=>$localize`You do not have pieces of this type anymore.`),u(r,"INVALID_PLACEMENT",()=>$localize`You must put your piece on an empty square or on a smaller piece.`),u(r,"NOT_DROPPABLE",()=>$localize`You must pick your piece among the remaining ones.`),u(r,"INVALID_PIECE_SELECTED",()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`),u(r,"END_YOUR_MOVE",()=>$localize`You are performing a move, you must select a landing square.`),r})();var xd,Ia;let du=(xd=class extends Yn{static get(){return Ia.singleton.isAbsent()&&(Ia.singleton=g.of(new Ia)),Ia.singleton.get()}constructor(){super(Ol)}static isVictory(e){const t=e.getCopiedBoard();for(const n of Ia.LINES){const o=Ia.isVictoriousLine([t[n[0].y][n[0].x],t[n[1].y][n[1].x],t[n[2].y][n[2].x]]);if(o.isPresent())return o}return g.empty()}static isVictoriousLine(e){const n=e.map(i=>i.getBiggest()).map(i=>i.getPlayer());return n[0]===K.NONE?g.empty():n[0]===n[1]&&n[1]===n[2]?g.of(n[0]):g.empty()}static isLegal(e,t){let n;if(e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return ie.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return ie.failure(kd.PIECE_OUT_OF_STOCK())}else{const s=e.startingCoord.get();if(n=t.getPieceAt(s).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return ie.failure(Le.MUST_CHOOSE_PLAYER_PIECE())}const o=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return o.isPresent()?ie.success(o.get()):ie.failure(kd.INVALID_PLACEMENT())}isLegal(e,t){return Ia.isLegal(e,t)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();let o=t.getRemainingPieces();const s=t.turn+1;let a;if(i[e.landingCoord.y][e.landingCoord.x]=n,e.isDropping()){a=e.piece.get();const l=o.indexOf(a);o=o.slice(0,l).concat(o.slice(l+1))}else{const l=e.startingCoord.get(),d=i[l.y][l.x].removeBiggest();i[l.y][l.x]=d.removedSpace,a=d.removedPiece}return new Ol(i,s,o)}static getGameStatus(e){const n=Ia.isVictory(e.gameState);return n.isPresent()?ve.getVictory(n.get()):ve.ONGOING}getGameStatus(e){return Ia.getGameStatus(e)}},Ia=xd,u(xd,"singleton",g.empty()),u(xd,"LINES",[[new C(0,0),new C(0,1),new C(0,2)],[new C(1,0),new C(1,1),new C(1,2)],[new C(2,0),new C(2,1),new C(2,2)],[new C(0,0),new C(1,0),new C(2,0)],[new C(0,1),new C(1,1),new C(2,1)],[new C(0,2),new C(1,2),new C(2,2)],[new C(0,0),new C(1,1),new C(2,2)],[new C(0,2),new C(1,1),new C(2,0)]]),xd);var lce;du=Ia=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],du);class g2 extends Ri{constructor(e,t,n){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"piece",void 0),this.startingCoord=e,this.landingCoord=t,this.piece=n}static ofMove(e,t){return q.assert(!1===e.equals(t),"Starting coord and landing coord must be separate coords"),new g2(g.of(e),t,g.empty())}static ofDrop(e,t){return new g2(g.empty(),t,g.of(e))}isDropping(){return this.startingCoord.isAbsent()}equals(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}lce=g2,u(g2,"encoder",we.tuple([g.getEncoder(C.encoder),C.encoder,g.getEncoder(We.encoder)],r=>[r.startingCoord,r.landingCoord,r.piece],r=>new lce(r[0],r[1],r[2])));class u9t extends Sr{getMetrics(e){return[0,0]}getListMoves(e){const t=[],n=e.gameState,i=n.getCopiedBoard(),o=n.getCurrentPlayer(),s=gae.toComparableObjectSet(n.getPlayerRemainingPieces());for(let a=0;a<3;a++)for(let c=0;c<3;c++){const l=new C(c,a);for(const f of s){const d=g2.ofDrop(f,l);du.isLegal(d,n).isSuccess()&&t.push(d)}if(i[a][c].belongsTo(o))for(let f=0;f<3;f++)for(let d=0;d<3;d++){const m=new C(d,f);if(!1===m.equals(l)){const E=g2.ofMove(l,m);du.isLegal(E,n).isSuccess()&&t.push(E)}}}return t}}const mo=new V2(K.NONE,K.NONE,K.NONE),uce=new V2(I.ZERO,K.NONE,K.NONE),f9t=new V2(K.NONE,I.ZERO,K.NONE),d9t=new V2(K.NONE,K.NONE,I.ZERO),fce=new V2(I.ONE,K.NONE,K.NONE),pC=new V2(K.NONE,K.NONE,I.ONE),h9t=new V2(I.ONE,I.ZERO,K.NONE),p9t=new V2(I.ZERO,I.ZERO,K.NONE);class dce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new Ol([[uce,fce,pC],[mo,f9t,mo],[mo,mo,d9t]],0,[We.SMALL_DARK,We.MEDIUM_DARK,We.BIG_DARK,We.SMALL_LIGHT,We.MEDIUM_LIGHT,We.MEDIUM_LIGHT,We.BIG_LIGHT])),W.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,Ol.getInitialState(),g2.ofDrop(We.SMALL_DARK,new C(1,1)),$localize`Congratulations!`),W.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new Ol([[uce,pC,mo],[mo,mo,mo],[mo,mo,mo]],0,[]),[g2.ofMove(new C(0,0),new C(2,0)),g2.ofMove(new C(0,0),new C(0,1)),g2.ofMove(new C(0,0),new C(1,1)),g2.ofMove(new C(0,0),new C(2,1)),g2.ofMove(new C(0,0),new C(0,2)),g2.ofMove(new C(0,0),new C(1,2)),g2.ofMove(new C(0,0),new C(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new Ol([[h9t,mo,fce],[p9t,pC,pC],[mo,mo,mo]],0,[We.MEDIUM_DARK,We.BIG_DARK,We.MEDIUM_LIGHT,We.MEDIUM_LIGHT]),g2.ofMove(new C(0,1),new C(0,2)),(t,n,i)=>{if(t.landingCoord.equals(new C(0,2))){if(t.isDropping())return b.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new C(0,1)))return b.SUCCESS}return b.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)])}}function g9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"circle",5),U("click",function(){const i=te(t),o=i.$implicit,s=i.index,a=p().$implicit;return ne(p().onPieceClick(a.value,o,s))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,o=p();_(1),Oi("id","piece_",i.value,"_",t.toString(),"_",n,""),y("ngClass",o.getSidePieceClasses(t,n)),k("transform","rotate("+180*(o.role.value+i.value)+" "+o.CENTER+" "+o.CENTER+")")("r",o.getPieceRadius(t))("cx",o.getRemainingPieceCenterCoord(i,n).x)("cy",o.getRemainingPieceCenterCoord(i,n).y)}}function m9t(r,e){if(1&r&&(A(),S(0,"g",null,4),T(2,g9t,2,8,"g",1),P()),2&r){const t=e.$implicit,n=p();_(2),y("ngForOf",n.getRemainingPieces(t))}}function _9t(r,e){if(1&r){const t=pe();A(),S(0,"circle",8),U("click",function(){te(t);const i=p().index,o=p().index;return ne(p().onBoardClick(i,o))}),P()}if(2&r){const t=e.$implicit,n=p().index,i=p().index,o=p();y("ngClass",o.getPieceClasses(t)),k("r",o.getPieceRadius(t))("cx",o.getPieceCenter(n))("cy",o.getPieceCenter(i))}}function v9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",6),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onBoardClick(o,s))}),P(),T(2,_9t,1,4,"circle",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),ye("id","click_",n,"_",i,""),y("ngClass",o.getRectClasses(n,i)),k("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngForOf",o.getListPieces(t))}}function C9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,v9t,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function y9t(r,e){if(1&r){const t=pe();A(),S(0,"rect",9),U("click",function(){te(t);const i=p();return ne(i.onBoardClick(i.chosenCoord.get().x,i.chosenCoord.get().y))}),P()}if(2&r){const t=p();ye("id","chosenCoord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),k("x",t.SPACE_SIZE*t.chosenCoord.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.chosenCoord.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}let M9t=(()=>{var r;class e extends Vi{constructor(n){super(n),u(this,"CENTER",this.getPieceCenter(1)),u(this,"UPLEFT",-(this.SPACE_SIZE+.5*this.STROKE_WIDTH)),u(this,"WIDTH",5*this.SPACE_SIZE+3*this.STROKE_WIDTH),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenPiece",g.empty()),u(this,"chosenPieceIndex",void 0),u(this,"remainingPieceCenterCoords",new un),this.rules=du.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new u9t(this.rules,"EncapsuleMinimax")],this.encoder=g2.encoder,this.tutorial=(new dce).tutorial}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.getCopiedBoard();const s=i.node.move;i.calculateLeftPieceCoords(),s.isPresent()?(i.lastLandingCoord=g.of(s.get().landingCoord),i.lastStartingCoord=s.get().startingCoord):(i.lastLandingCoord=g.empty(),i.lastStartingCoord=g.empty())})()}getListPieces(n){return n.toList()}getRemainingPieces(n){return this.getState().getRemainingPiecesOfPlayer(n)}onBoardClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new C(n,i),c=o.getState();if(o.chosenCoord.isAbsent()){if(o.chosenCoord=g.of(a),o.chosenPiece.isPresent()){const l=g2.ofDrop(o.chosenPiece.get(),a);return o.chooseMove(l)}return!1===c.getPieceAt(a).belongsTo(c.getCurrentPlayer())?o.cancelMove(kd.INVALID_PIECE_SELECTED()):b.SUCCESS}if(o.chosenCoord.equalsValue(a))return o.cancelMoveAttempt(),b.SUCCESS;{const l=g2.ofMove(o.chosenCoord.get(),a);return o.chooseMove(l)}})()}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.chosenPiece=g.empty(),this.chosenPieceIndex=g.empty()}onPieceClick(n,i,o){var s=this;return M(function*(){const a="#piece_"+n+"_"+i.toString()+"_"+o,c=yield s.canUserPlay(a);return c.isFailure()?s.cancelMove(c.getReason()):!1===s.getState().isDroppable(i)?s.cancelMove(kd.NOT_DROPPABLE()):s.chosenCoord.isAbsent()?(s.chosenPiece.equalsValue(i)&&s.chosenPieceIndex.equalsValue(o)?(s.chosenPiece=g.empty(),s.chosenPieceIndex=g.empty()):(s.chosenPiece=g.of(i),s.chosenPieceIndex=g.of(o)),b.SUCCESS):s.cancelMove(kd.END_YOUR_MOVE())})()}getRectClasses(n,i){return this.isSelected(n,i)?"moved-fill":""}isSelected(n,i){const o=new C(n,i);return!(!this.lastStartingCoord.equalsValue(o)&&!this.lastLandingCoord.equalsValue(o))}getPieceClasses(n){return[this.getPieceStrokeClass(n)]}getPieceCenter(n){return this.SPACE_SIZE*n+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(n){const i=n.getPlayer();return Fe(i.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+i.value+"-stroke"}getPieceRadius(n){switch(n.getSize()){case x1.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case x1.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return q.expectToBe(n.getSize(),x1.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(n,i){const o=this.getPieceClasses(n);return this.isSelectedPiece(n)&&this.chosenPieceIndex.equalsValue(i)&&o.push("selected-stroke"),o}isSelectedPiece(n){return this.chosenPiece.equalsValue(n)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new un;for(const n of I.PLAYERS){const i=[],o=this.getRemainingPieces(n);for(let s=0;s<o.length;s++){let a,c=0,l=0;s<=2?(a=new C(2-s,3),l=this.STROKE_WIDTH):(a=new C(-1,5-s),c=-this.STROKE_WIDTH);const f=this.getPieceCenter(a.x),d=this.getPieceCenter(a.y);i.push(new C(f+c,d+l))}this.remainingPieceCenterCoords.set(n,i)}}getRemainingPieceCenterCoord(n,i){return this.remainingPieceCenterCoords.get(n).get()[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-encapsule"]],features:[Qe],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,m9t,3,1,"g",1),S(2,"g",null,2),T(4,C9t,2,1,"g",1),T(5,y9t,1,6,"rect",3),P()()),2&n&&(k("viewBox",i.UPLEFT+" "+i.UPLEFT+" "+i.WIDTH+" "+i.WIDTH),_(1),y("ngForOf",i.Player.PLAYERS),_(3),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),hn=(()=>{class r extends B1{static getInitialState(){const t=K.NONE,n=K.ZERO,i=K.ONE;return new r([[i,i,i,i,i,i,i,i,i,i,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,i,i,i],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[n,n,n,n,n,n,n,n,n,n,n,n,n,n],[n,n,n,n,n,n,n,n,n,n,n,n,n,n]],0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}count(t,n){let i=0;for(let o=0;o<14;o++)this.board[n][o]===t&&i++;return i}doesOwnPiece(t){for(const n of this.getCoordsAndContents())if(n.content===t)return!0;return!1}}return u(r,"WIDTH",14),u(r,"HEIGHT",12),r})();var hce;class Us extends Pr{constructor(e,t,n,i,o){super(e,t),u(this,"movedPieces",void 0),u(this,"stepSize",void 0),u(this,"direction",void 0),this.movedPieces=n,this.stepSize=i,this.direction=o,q.assert(hn.isOnBoard(this.coord),"Illegal coord outside of board "+this.coord.toString()+"."),q.assert(n>0,"Must select minimum one piece (got "+n+")."),q.assert(i>0,"Step size must be minimum one (got "+i+")."),q.assert(i<=n,"Cannot move a phalanx further than its size (got step size "+i+" for "+n+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&this.movedPieces===e.movedPieces&&this.stepSize===e.stepSize&&this.direction.equals(e.direction)}}hce=Us,u(Us,"encoder",we.tuple([C.encoder,we.identity(),we.identity(),Me.encoder],r=>[r.coord,r.movedPieces,r.stepSize,r.direction],r=>new hce(r[0].x,r[0].y,r[1],r[2],r[3])));let Ws=(()=>{class r{}return u(r,"PHALANX_IS_LEAVING_BOARD",()=>$localize`The move distance of your phalanx puts it out of the board.`),u(r,"SOMETHING_IN_PHALANX_WAY",()=>$localize`There is something in the way of your phalanx.`),u(r,"PHALANX_SHOULD_BE_GREATER_TO_CAPTURE",()=>$localize`Your phalanx must be bigger than the one you are capturing.`),u(r,"SQUARE_NOT_ALIGNED_WITH_SELECTED",()=>$localize`This square is not aligned with the selected piece.`),u(r,"SINGLE_PIECE_MUST_MOVE_BY_ONE",()=>$localize`A single piece can only move by one square.`),u(r,"SINGLE_PIECE_CANNOT_CAPTURE",()=>$localize`A single piece cannot make a capture.`),u(r,"SQUARE_NOT_ALIGNED_WITH_PHALANX",()=>$localize`This square is not aligned with the direction of the phalanx.`),u(r,"PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD",()=>$localize`A phalanx can't contain pieces outside of the board.`),u(r,"PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE",()=>$localize`A phalanx cannot contain an empty square.`),u(r,"PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE",()=>$localize`A phalanx cannot contain a piece of the opponent.`),r})();class Fi extends Yn{static get(){return Fi.singleton.isAbsent()&&(Fi.singleton=g.of(new Fi)),Fi.singleton.get()}constructor(){super(hn)}static isLegal(e,t){const n=this.getPhalanxValidity(t,e);if(n.isFailure())return ie.failure(n.getReason());const i=this.getLandingStatus(t,e);if(i.isFailure())return i;const o=Re.copyBiArray(i.get()),s=t.getCurrentOpponent(),a=Fi.getCaptureValidity(t,o,e,s);return a.isFailure()?a:ie.success(a.get())}static getPhalanxValidity(e,t){let n=t.coord,i=0;const o=e.getCurrentOpponent();for(;i<t.movedPieces;){if(!1===hn.isOnBoard(n))return b.failure(Ws.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const s=e.getPieceAt(n);if(s===K.NONE)return b.failure(Ws.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(s===o)return b.failure(Ws.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),i++}return b.SUCCESS}static getLandingStatus(e,t){const n=e.getCopiedBoard(),i=e.getCurrentPlayer();let o=t.coord,s=t.coord.getNext(t.direction,t.movedPieces),a=0;for(;a+1<t.stepSize;){if(n[o.y][o.x]=K.NONE,n[s.y][s.x]=i,!1===hn.isOnBoard(s))return ie.failure(Ws.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(s).isPlayer())return ie.failure(Ws.SOMETHING_IN_PHALANX_WAY());a++,s=s.getNext(t.direction,1),o=o.getNext(t.direction,1)}return!1===hn.isOnBoard(s)?ie.failure(Ws.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(s)===i?ie.failure(Le.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(n[o.y][o.x]=K.NONE,n[s.y][s.x]=i,ie.success(n))}static getCaptureValidity(e,t,n,i){let o=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),s=0;for(;hn.isOnBoard(o)&&e.getPieceAt(o)===i;){if(s>0&&(t[o.y][o.x]=K.NONE),s++,s>=n.movedPieces)return ie.failure(Ws.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());o=o.getNext(n.direction,1)}return ie.success(t)}isLegal(e,t){return Fi.isLegal(e,t)}applyLegalMove(e,t,n){return new hn(n,t.turn+1)}getGameStatus(e){const t=e.gameState,n=t.count(I.ZERO,0),i=t.count(I.ONE,hn.HEIGHT-1);if(t.turn%2==0){if(n>i)return ve.ZERO_WON}else if(i>n)return ve.ONE_WON;return!1===t.doesOwnPiece(I.ZERO)?ve.ONE_WON:!1===t.doesOwnPiece(I.ONE)?ve.ZERO_WON:ve.ONGOING}}u(Fi,"singleton",g.empty());class Ld extends ds{static getListMoves(e){const t=e.gameState.getCurrentPlayer(),n=e.gameState.getCurrentOpponent(),i=K.NONE;let o=[];const s=e.gameState;for(const a of s.getCoordsAndContents()){const c=a.coord;if(a.content===t){let l;for(const f of Me.DIRECTIONS){let d=1,m=c.getNext(f,1);for(;hn.isOnBoard(m)&&s.getPieceAt(m)===t;)d+=1,m=m.getNext(f,1);let E=1;for(;hn.isOnBoard(m)&&E<=d&&s.getPieceAt(m)===i;)l=new Us(c.x,c.y,d,E,f),o=this.addMove(o,l,s),E++,m=m.getNext(f,1);hn.isOnBoard(m)&&E<=d&&s.getPieceAt(m)===n&&(l=new Us(c.x,c.y,d,E,f),o=this.addMove(o,l,s))}}}return o}static addMove(e,t,n){return Fi.isLegal(t,n).isSuccess()&&e.push(t),e}getListMoves(e){const t=Ld.getListMoves(e);return Re.sortByDescending(t,n=>n.stepSize),t}getBoardValue(e){const t=Fi.get().getGameStatus(e);return t.isEndGame?t.toBoardValue():new an(this.getPieceCountPlusRowDomination(e.gameState))}getPieceCountPlusRowDomination(e){const t=13*hn.WIDTH*11;let s=0;for(let a=0;a<hn.HEIGHT;a++){let c=0;const l=[0,0];for(let f=0;f<hn.WIDTH;f++){const d=new C(f,a),m=e.getPieceAt(d);if(m.isPlayer()){const E=m.getScoreModifier();s+=t*E,l[m.value]=E,c+=E;for(const w of[Me.UP_LEFT,Me.UP,Me.UP_RIGHT]){let L=d.getNext(w,1);for(;hn.isOnBoard(L)&&e.getPieceAt(L)===m;)s+=1*E,L=L.getNext(w,1)}}}0!==c&&(s+=Math.abs(c)/c*2),s+=1*l.reduce((f,d)=>f+d)}return s}}class E9t extends ds{getListMoves(e){const t=Ld.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}orderMovesByPhalanxSizeAndFilter(e,t){return Re.sortByDescending(e,n=>n.movedPieces),e.length>40?e.filter(i=>!!this.moveIsCapture(i,t)||i.movedPieces*Math.random()>1):e}moveIsCapture(e,t){const n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}getBoardValue(e){const t=Fi.get().getGameStatus(e);return t.isEndGame?t.toBoardValue():new an(this.getPieceCountThenSupportThenAdvancement(e.gameState))}getPieceCountThenSupportThenAdvancement(e){const n=28*hn.WIDTH+1,o=444*n+1;let s=0;for(const a of e.getCoordsAndContents()){const c=a.coord,l=a.content;if(l.isPlayer()){let f,d;l===I.ZERO?(f=hn.HEIGHT-c.y,d=[Me.UP_LEFT,Me.UP,Me.UP_RIGHT]):(f=c.y+1,d=[Me.DOWN_LEFT,Me.DOWN,Me.DOWN_RIGHT]);const m=l.getScoreModifier();s+=f*m,s+=o*m;for(const E of d){let w=c.getNext(E,1);for(;hn.isOnBoard(w)&&e.getPieceAt(w)===l;)s+=m*n,w=w.getNext(E,1)}}}return s}}class S9t extends Ld{constructor(...e){super(...e),u(this,"DOMINANCE_FACTOR",20),u(this,"DEFENSE_FACTOR",5),u(this,"TERRITORY_FACTOR",2),u(this,"OFFENSE_FACTOR",10),u(this,"CENTER_FACTOR",5),u(this,"MOBILITY_FACTOR",.12)}getDominance(e){let t=0;for(const n of e.getCoordsAndContents())n.content.isPlayer()&&(t+=n.content.getScoreModifier());return t*this.DOMINANCE_FACTOR}getDefense(e){let t=0;for(let n=0;n<hn.WIDTH;n++)e.getPieceAtXY(n,hn.HEIGHT-1)===I.ZERO&&(t+=I.ZERO.getScoreModifier()),e.getPieceAtXY(n,0)===I.ONE&&(t+=I.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}getTerritory(e){let t=0;for(const n of e.getCoordsAndContents()){const i=n.content;if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let s=-1;s<=1;s++){const a=n.coord.getNext(new C(o,s),1);if(hn.isOnBoard(a)){const c=e.getPieceAt(a);(c===i||c===K.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}getOffense(e){let t=0;for(let n=0;n<hn.WIDTH;n++)e.getPieceAtXY(n,0)===I.ZERO&&(t+=I.ZERO.getScoreModifier()),e.getPieceAtXY(n,hn.HEIGHT-1)===I.ONE&&(t+=I.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}getCenter(e){let t=0;const n=(hn.WIDTH-1)/2;for(const i of e.getCoordsAndContents()){const o=i.content;o.isPlayer()&&(t+=o.getScoreModifier()*Math.abs(i.coord.x-n))}return t*this.CENTER_FACTOR}getMobility(e){let t=0,n=0,i=0;for(const o of e.getCoordsAndContents()){const s=o.coord,a=o.content;if(a.isPlayer())for(const c of Me.DIRECTIONS){let l=1,f=s.getNext(c,1);for(;hn.isOnBoard(f)&&e.getPieceAt(f)===a;)l+=1,f=f.getNext(c,1);let d=1;for(;hn.isOnBoard(f)&&d<=l&&e.getPieceAt(f)===K.NONE;)d++,f=f.getNext(c,1);t+=d*d*a.getScoreModifier(),a===I.ZERO?n=Math.max(n,d):a===I.ONE&&(i=Math.max(i,d))}}return(t+n*I.ZERO.getScoreModifier()+i*I.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(e){const t=e.gameState,n=Fi.get().getGameStatus(e);if(n.isEndGame)return n.toBoardValue();const i=this.getDominance(t),o=this.getDefense(t),s=this.getTerritory(t),a=this.getCenter(t),c=this.getOffense(t),l=this.getMobility(t);return new an(i+o+s+a+c+l)}}const O=K.NONE,U1=K.ZERO,r1=K.ONE;class pce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,hn.getInitialState()),W.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new hn([[O,O,O,O,O,U1,O,O,r1,r1,r1,r1,r1,r1],[O,O,O,O,O,U1,O,O,O,O,O,O,r1,r1],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,r1,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,U1,U1,U1,U1,O,O,O]],0)),W.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new hn([[O,O,O,O,O,U1,O,O,O,O,r1,r1,r1,r1],[O,O,O,O,O,U1,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,r1,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,r1,r1,O,O,O,U1,U1,O,U1,U1,U1,U1]],1)),W.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,hn.getInitialState(),new Us(0,10,1,1,Me.UP),(t,n,i)=>1===t.movedPieces?b.SUCCESS:b.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),W.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,hn.getInitialState(),new Us(0,11,2,1,Me.UP),(t,n,i)=>t.movedPieces>1?b.SUCCESS:b.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),W.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new hn([[O,O,O,O,O,O,O,O,r1,r1,r1,r1,r1,r1],[O,O,O,O,O,O,r1,O,O,O,O,O,O,O],[O,O,O,O,O,r1,O,O,O,O,O,O,O,O],[O,O,r1,O,r1,O,O,O,O,O,O,O,O,O],[O,O,r1,r1,O,O,O,O,O,O,O,O,O,O],[O,O,r1,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,U1,O,O,O,O,O,O,O,O,O,O,O],[O,O,U1,O,O,O,O,r1,O,O,O,O,O,O],[O,O,U1,O,O,O,O,O,O,O,O,O,O,O],[O,O,U1,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,U1,U1,U1,U1,U1,U1,U1]],0),[new Us(2,10,4,2,Me.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)])}}function P9t(r,e){if(1&r){const t=pe();A(),S(0,"circle",4),U("click",function(){te(t);const i=p().index,o=p().index;return ne(p().onClick(i,o))}),P()}if(2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClasses(t,n)),k("cx",i.SPACE_SIZE*t+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.STROKE_WIDTH+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function T9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",2),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P(),T(2,P9t,1,4,"circle",3),P()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ye("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),k("x",i.SPACE_SIZE*t+i.STROKE_WIDTH)("y",i.SPACE_SIZE*n+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]!==i.NONE)}}function O9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,T9t,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function b9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",5),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),k("x",n.SPACE_SIZE*t.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let w9t=(()=>{var r;class e extends Vi{constructor(n){super(n),u(this,"NONE",K.NONE),u(this,"firstPiece",g.empty()),u(this,"validExtensions",[]),u(this,"phalanxValidLandings",[]),u(this,"lastPiece",g.empty()),u(this,"phalanxDirection",g.empty()),u(this,"phalanxMiddles",[]),u(this,"moveds",[]),u(this,"capturedCoords",[]),this.hasAsymmetricBoard=!0,this.rules=Fi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Ld(this.rules,"Normal"),new E9t(this.rules,"Positional"),new S9t(this.rules,"Attack")],this.encoder=Us.encoder,this.tutorial=(new pce).tutorial}updateBoard(n){var i=this;return M(function*(){i.firstPiece=g.empty(),i.lastPiece=g.empty(),i.hideLastMove(),i.board=i.getState().getCopiedBoard()})()}showLastMove(n){var i=this;return M(function*(){let o=n.coord;i.moveds=[o];for(let c=1;c<n.stepSize+n.movedPieces;c++)o=o.getNext(n.direction,1),i.moveds.push(o);const s=i.node.mother.get(),a=s.gameState.getCurrentOpponent();for(;hn.isOnBoard(o)&&s.gameState.getPieceAt(o)===a;)i.capturedCoords.push(o),o=o.getNext(n.direction,1)})()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);return s.isFailure()?o.cancelMove(s.getReason()):o.firstPiece.isAbsent()?o.firstClick(n,i):o.lastPiece.isAbsent()?o.secondClick(n,i):o.thirdClick(n,i)})()}firstClick(n,i){var o=this;return M(function*(){const s=o.getState().getCurrentOpponent(),a=o.getState().getCurrentPlayer();switch(o.board[i][n]){case a:return o.firstPiece=g.of(new C(n,i)),o.validExtensions=o.getValidExtensions(a),o.phalanxValidLandings=o.getPhalanxValidLandings(),b.SUCCESS;case s:return o.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE());default:return q.expectToBe(o.board[i][n],K.NONE),o.cancelMove(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hideLastMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(n){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(n):this.getFirstPieceExtensions(n)}getFirstPieceExtensions(n){const i=[];for(const o of Me.DIRECTIONS){let s=this.firstPiece.get().getNext(o,1);for(;hn.isOnBoard(s)&&this.board[s.y][s.x]===n;)i.push(s),s=s.getNext(o,1)}return i}getPhalanxValidExtensions(n){let i=Me.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const o=this.lastPiece.get().getNext(i,1),s=this.getExtensionsToward(o,i,n);i=i.getOpposite();const a=this.firstPiece.get().getNext(i,1),c=this.getExtensionsToward(a,i,n);return s.concat(c)}getExtensionsToward(n,i,o){const s=[];for(;hn.isOnBoard(n)&&this.board[n.y][n.x]===o;)s.push(n),n=n.getNext(i,1);return s}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const n=this.firstPiece.get(),i=this.lastPiece.get(),o=Math.abs(n.x-i.x),s=Math.abs(n.y-i.y),a=Math.max(o,s)+1;let c=Me.factory.fromMove(n,i).get();const l=i.getNext(c,1),f=this.getLandingsToward(l,c,a);c=c.getOpposite();const d=n.getNext(c,1);return this.getLandingsToward(d,c,a).concat(f)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const n=[];for(const i of Me.DIRECTIONS){const o=this.firstPiece.get().getNext(i,1);hn.isOnBoard(o)&&this.board[o.y][o.x]===K.NONE&&n.push(o)}return n}getLandingsToward(n,i,o){const s=this.getState().getCurrentPlayer(),a=this.getState().getCurrentOpponent(),c=[];for(;hn.isOnBoard(n)&&c.length<o&&this.board[n.y][n.x]!==s;){if(this.board[n.y][n.x]===a)return this.getPhalanxLength(n,i,a)<o&&c.push(n),c;c.push(n),n=n.getNext(i,1)}return c}getPhalanxLength(n,i,o){let s=0;for(;hn.isOnBoard(n)&&this.board[n.y][n.x]===o;)s++,n=n.getNext(i,1);return s}cancelMoveAttempt(){this.firstPiece=g.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=g.empty(),this.phalanxMiddles=[],this.hideLastMove()}secondClick(n,i){var o=this;return M(function*(){const s=new C(n,i),a=o.firstPiece.get();if(s.equals(a))return o.cancelMoveAttempt(),b.SUCCESS;const c=o.getState().getCurrentOpponent(),l=o.getState().getCurrentPlayer();if(!1===s.isAlignedWith(a))return o.cancelMove(Ws.SQUARE_NOT_ALIGNED_WITH_SELECTED());const f=s.getDistance(a),d=a.getDirectionToward(s).get();switch(o.board[i][n]){case K.NONE:return 1===f?o.chooseMove(new Us(a.x,a.y,1,1,d)):o.cancelMove(Ws.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return o.cancelMove(Ws.SINGLE_PIECE_CANNOT_CAPTURE());default:q.expectToBe(o.board[i][n],l);const m=new Us(a.x,a.y,f,1,d),E=o.getState(),w=Fi.getPhalanxValidity(E,m);return w.isFailure()?o.cancelMove(w.getReason()):(o.lastPiece=g.of(s),o.validExtensions=o.getValidExtensions(l),o.phalanxValidLandings=o.getPhalanxValidLandings(),o.phalanxMiddles=a.getCoordsToward(s),o.phalanxDirection=g.of(d),b.SUCCESS)}})()}thirdClick(n,i){var o=this;return M(function*(){const s=o.getState().getCurrentPlayer(),a=new C(n,i);if(o.firstPiece.equalsValue(a))return o.moveFirstPiece(s);if(o.lastPiece.equalsValue(a))return o.moveLastPiece(s);const c=o.firstPiece.get(),l=o.lastPiece.get();if(!1===a.isAlignedWith(c))return o.cancelMove(Ws.SQUARE_NOT_ALIGNED_WITH_PHALANX());let f=Me.factory.fromMove(c,l).get();const d=Me.factory.fromMove(c,a).get();if(f===d.getOpposite()&&(o.firstPiece=g.of(l),o.lastPiece=g.of(c),f=d),f!==d)return o.cancelMove(Ws.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(o.board[i][n]===s)return o.thirdClickOnPlayerPiece(a,f,s);{const m=o.firstPiece.get().getDistance(o.lastPiece.get())+1,E=o.lastPiece.get().getDistance(a),w=new Us(o.firstPiece.get().x,o.firstPiece.get().y,m,E,f);return o.chooseMove(w)}})()}thirdClickOnPlayerPiece(n,i,o){var s=this;return M(function*(){s.lastPiece=g.of(n);const a=s.firstPiece.get().getDistance(n)+1,c=new Us(s.firstPiece.get().x,s.firstPiece.get().y,a,1,i),l=Fi.getPhalanxValidity(s.node.gameState,c);return l.isFailure()?s.cancelMove(l.getReason()):(s.phalanxMiddles=s.firstPiece.get().getCoordsToward(s.lastPiece.get()),s.validExtensions=s.getValidExtensions(o),s.phalanxValidLandings=s.getPhalanxValidLandings(),b.SUCCESS)})()}moveFirstPiece(n){var i=this;return M(function*(){return i.firstPiece=g.of(i.firstPiece.get().getNext(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?yield i.moveOnlyPiece(n):(i.phalanxMiddles=i.phalanxMiddles.slice(1),i.validExtensions=i.getPhalanxValidExtensions(n)),i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS})()}moveLastPiece(n){var i=this;return M(function*(){return i.lastPiece=g.of(i.lastPiece.get().getPrevious(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?i.moveOnlyPiece(n):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getPhalanxValidExtensions(n),i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS)})()}moveOnlyPiece(n){var i=this;return M(function*(){return i.lastPiece=g.empty(),i.validExtensions=i.getFirstPieceExtensions(n),i.phalanxDirection=g.empty(),i.phalanxMiddles=[],i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS})()}getPieceClasses(n,i){const o=this.getPlayerClass(this.board[i][n]);return this.getPieceStrokeClasses(n,i).concat([o])}getPieceStrokeClasses(n,i){const o=new C(n,i);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(o)||this.lastPiece.equalsValue(o)||this.phalanxMiddles.some(s=>s.equals(o))?["selected-stroke"]:[]}getRectClasses(n,i){const o=new C(n,i);return this.capturedCoords.some(s=>s.equals(o))?["captured-fill"]:this.moveds.some(s=>s.equals(o))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const n=[],o=this.getState().getCurrentPlayer();for(let s=0;s<this.board.length;s++)for(let a=0;a<this.board[s].length;a++)this.board[s][a]===o&&n.push(new C(a,s));return n}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-epaminondas"]],features:[Qe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,O9t,2,1,"g",1),T(2,b9t,2,4,"g",1),P()),2&n&&(k("transform",i.rotation),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getHighlightedCoords()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var VL,gce,mce;class F2{constructor(e){u(this,"capturedSpaces",void 0),q.assert(e.length>=4,"Cannot create a GipfCapture with less than 4 captured pieces"),q.assert(ms.areOnSameLine(e),"Cannot create a GipfCapture with pieces that are not on the same line"),this.capturedSpaces=Re.copyImmutableArray(e).sort((n,i)=>n.x===i.x?(q.assert(n.y!==i.y,"Cannot create a GipfCapture with duplicate coords"),n.y>i.y?1:-1):n.x>i.x?1:-1);let t=g.empty();for(const n of this.capturedSpaces)q.assert(t.isAbsent()||1===t.get().getDistance(n),"Cannot create a GipfCapture with non-consecutive coords"),t=g.of(n)}toString(){let e="";for(const t of this.capturedSpaces)""!==e&&(e+=","),e+=t.toString();return e}size(){return this.capturedSpaces.length}forEach(e){this.capturedSpaces.forEach(e)}contains(e){for(let t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}intersectsWith(e){return this.capturedSpaces.some(t=>e.contains(t))}getLine(){return ms.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(let t=0;t<this.capturedSpaces.length;t++)if(!1===this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}VL=F2,u(F2,"encoder",we.tuple([we.list(C.encoder)],r=>[r.capturedSpaces],r=>new VL(r[0]))),u(F2,"listEncoder",we.list(VL.encoder));class qs{constructor(e,t){u(this,"coord",void 0),u(this,"direction",void 0),this.coord=e,this.direction=t}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}gce=qs,u(qs,"encoder",we.tuple([C.encoder,g.getEncoder(be.encoder)],r=>[r.coord,r.direction],r=>new gce(r[0],r[1])));class ka extends Ri{constructor(e,t,n){super(),u(this,"placement",void 0),u(this,"initialCaptures",void 0),u(this,"finalCaptures",void 0),this.placement=e,this.initialCaptures=t,this.finalCaptures=n}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}equals(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===Re.compareArray(this.initialCaptures,e.initialCaptures)||!1===Re.compareArray(this.finalCaptures,e.finalCaptures))}}mce=ka,u(ka,"encoder",we.tuple([qs.encoder,F2.listEncoder,F2.listEncoder],r=>[r.placement,r.initialCaptures,r.finalCaptures],r=>new mce(r[0],r[1],r[2])));class js extends zL{static getInitialState(){const e=Ce.EMPTY,t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE;return new js([[t,t,t,i,e,e,n],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[n,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,n,t,t,t]],0,[12,12],[0,0])}constructor(e,t,n,i){super(t,e,7,7,[3,2,1],Ce.EMPTY),u(this,"sidePieces",void 0),u(this,"capturedPieces",void 0),this.sidePieces=n,this.capturedPieces=i}equals(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&Re.compareTable(this.board,e.board)}getNumberOfPiecesToPlace(e){return this.sidePieces[e.value]}getNumberOfPiecesCaptured(e){return this.capturedPieces[e.value]}setAtUnsafe(e,t){const n=Re.copyBiArray(this.board);return n[e.y][e.x]=t,new js(n,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Ce.UNREACHABLE}}let Zs=(()=>{class r{}return u(r,"CAPTURE_MUST_BE_ALIGNED",()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`),u(r,"INVALID_CAPTURED_PIECES",()=>$localize`You must select a valid capture that contains 4 pieces or more.`),u(r,"MISSING_CAPTURES",()=>$localize`There are still possible captures to be done.`),u(r,"PLACEMENT_NOT_ON_BORDER",()=>$localize`Pieces must be inserted in spaces on the edge of the board.`),u(r,"INVALID_PLACEMENT_DIRECTION",()=>$localize`You must select a valid placement direction.`),u(r,"PLACEMENT_WITHOUT_DIRECTION",()=>$localize`You must select a placement with a direction alongside the insertion space.`),u(r,"PLACEMENT_ON_COMPLETE_LINE",()=>$localize`You cannot place a piece on a complete line.`),u(r,"AMBIGUOUS_CAPTURE_COORD",()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`),u(r,"NO_DIRECTIONS_AVAILABLE",()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`),r})();class Qt extends Yn{static get(){return Qt.singleton.isAbsent()&&(Qt.singleton=g.of(new Qt)),Qt.singleton.get()}constructor(){super(js)}applyLegalMove(e,t,n){return new js(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}static applyCaptures(e,t){let n=t;return e.forEach(i=>{n=Qt.applyCapture(i,n)}),n}static applyCapture(e,t){const n=t.getCurrentPlayer();let i=t;const o=[t.sidePieces[0],t.sidePieces[1]],s=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(a=>{const c=t.getPieceAt(a);i=i.setAt(a,Ce.EMPTY),c.is(n)?o[n.value]+=1:s[n.value]+=1}),new js(i.board,t.turn,o,s)}static getPlacements(e){const t=[];return Fr.INSTANCE.getAllBorders(e).forEach(n=>{e.getPieceAt(n)===Ce.EMPTY?t.push(new qs(n,g.empty())):Qt.getAllDirectionsForEntrance(e,n).forEach(i=>{!1===Qt.isLineComplete(e,n,i)&&t.push(new qs(n,g.of(i)))})}),t}static isLineComplete(e,t,n){return Qt.nextGapInLine(e,t,n).isAbsent()}static nextGapInLine(e,t,n){for(let i=t;e.isOnBoard(i);i=i.getNext(n))if(e.getPieceAt(i)===Ce.EMPTY)return g.of(i);return g.empty()}static applyPlacement(e,t){const n=t.getCurrentPlayer();let i=t,o=Ce.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){const a=e.coord;if(t.getPieceAt(a)!==Ce.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");i=i.setAt(a,o)}else for(let a=e.coord;i.isOnBoard(a)&&o!==Ce.EMPTY;a=a.getNext(e.direction.get())){const c=t.getPieceAt(a);i=i.setAt(a,o),o=c}const s=[t.sidePieces[0],t.sidePieces[1]];return s[n.value]-=1,new js(i.board,t.turn,s,t.capturedPieces)}getPiecesMoved(e,t,n){const i=Qt.applyCaptures(t,e);if(n.direction.isAbsent())return[n.coord];{const o=n.direction.get(),s=[];s.push(n.coord);let a=n.coord.getNext(o);for(;i.isOnBoard(a)&&i.getPieceAt(a)!==Ce.EMPTY;)s.push(a),a=a.getNext(o);return Fe(i.isOnBoard(a)&&i.getPieceAt(a)===Ce.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),s.push(a),s}}static getAllDirectionsForEntrance(e,t){if(Fr.INSTANCE.isTopLeftCorner(e,t))return[be.RIGHT,be.DOWN,be.UP_RIGHT];if(Fr.INSTANCE.isTopCorner(e,t))return[be.DOWN,be.DOWN_LEFT,be.RIGHT];if(Fr.INSTANCE.isTopRightCorner(e,t))return[be.DOWN_LEFT,be.DOWN,be.LEFT];if(Fr.INSTANCE.isBottomLeftCorner(e,t))return[be.UP_RIGHT,be.UP,be.RIGHT];if(Fr.INSTANCE.isBottomCorner(e,t))return[be.UP,be.LEFT,be.UP_RIGHT];if(Fr.INSTANCE.isBottomRightCorner(e,t))return[be.LEFT,be.UP,be.DOWN_LEFT];if(Fr.INSTANCE.isOnTopLeftBorder(e,t))return[be.RIGHT,be.DOWN];if(Fr.INSTANCE.isOnLeftBorder(e,t))return[be.UP_RIGHT,be.RIGHT];if(Fr.INSTANCE.isOnBottomLeftBorder(e,t))return[be.UP,be.UP_RIGHT];if(Fr.INSTANCE.isOnBottomRightBorder(e,t))return[be.LEFT,be.UP];if(Fr.INSTANCE.isOnRightBorder(e,t))return[be.LEFT,be.DOWN_LEFT];if(Fr.INSTANCE.isOnTopRightBorder(e,t))return[be.DOWN_LEFT,be.DOWN];throw new Error("not a border")}isLegal(e,t){const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=Qt.applyCaptures(e.initialCaptures,t),o=this.noMoreCapturesValidity(i);if(o.isFailure())return o.toOtherFallible();const s=this.placementValidity(i,e.placement);if(s.isFailure())return s.toOtherFallible();const a=Qt.applyPlacement(e.placement,i),c=this.capturesValidity(a,e.finalCaptures);if(c.isFailure())return c.toOtherFallible();const l=Qt.applyCaptures(e.finalCaptures,a),f=this.noMoreCapturesValidity(l);return f.isFailure()?f.toOtherFallible():ie.success(l)}capturesValidity(e,t){let n=e;for(const i of t){const o=this.captureValidity(n,i);if(o.isFailure())return o;n=Qt.applyCapture(i,n)}return b.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer(),i=Qt.getLinePortionWithFourPiecesOfPlayer(e,n,t.getLine());if(i.isAbsent())return b.failure(Zs.CAPTURE_MUST_BE_ALIGNED());const o=i.get();return Qt.getCapturable(e,o).equals(t)?b.SUCCESS:b.failure(Zs.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const o=Qt.getLinePortionWithFourPiecesOfPlayer(e,t,i);o.isPresent()&&n.push(o.get())}),n}static getLinePortionWithFourPiecesOfPlayer(e,t,n){let i=0;const o=e.getEntranceOnLine(n),s=n.getDirection();let a=o;for(let c=o;e.isOnBoard(c);c=c.getNext(s))if(e.getPieceAt(c).is(t)?(0===i&&(a=c),i+=1):i=0,4===i)return g.of({0:a,1:c,2:s});return g.empty()}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===Qt.getLinePortionsWithFourPiecesOfPlayer(e,t).length?b.SUCCESS:b.failure(Zs.MISSING_CAPTURES())}placementValidity(e,t){const n=this.placementCoordValidity(e,t.coord);if(n.isFailure())return n;if(e.getPieceAt(t.coord)!==Ce.EMPTY){if(t.direction.isAbsent())return b.failure(Zs.PLACEMENT_WITHOUT_DIRECTION());if(Qt.isLineComplete(e,t.coord,t.direction.get()))return b.failure(Zs.PLACEMENT_ON_COMPLETE_LINE());for(const i of Qt.getAllDirectionsForEntrance(e,t.coord))if(i===t.direction.get())return b.SUCCESS;return b.failure(Zs.INVALID_PLACEMENT_DIRECTION())}return b.SUCCESS}placementCoordValidity(e,t){return Fr.INSTANCE.isOnBorder(e,t)?b.SUCCESS:b.failure(Zs.PLACEMENT_NOT_ON_BORDER())}static getCapturable(e,t){const n=[],i=t[0],o=t[1],s=t[2],a=s.getOpposite();let c=i.getNext(a);for(;e.isOnBoard(c)&&e.getPieceAt(c)!==Ce.EMPTY;)n.push(c),c=c.getNext(a);for(let l=i;!1===l.equals(o);l=l.getNext(s))n.push(l);for(let l=o;e.isOnBoard(l)&&e.getPieceAt(l)!==Ce.EMPTY;l=l.getNext(s))n.push(l);return new F2(n)}static getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return Qt.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(i=>{n.push(Qt.getCapturable(e,i))}),n}static getPlayerScore(e,t){const n=e.getNumberOfPiecesToPlace(t);if(0===n&&0===Qt.getPossibleCaptures(e).length)return g.empty();const i=e.getNumberOfPiecesCaptured(t);return g.of(n+3*i)}static isGameOver(e){const t=Qt.getPlayerScore(e,I.ZERO),n=Qt.getPlayerScore(e,I.ONE);return t.isAbsent()||n.isAbsent()}getGameStatus(e){const t=e.gameState,n=Qt.getPlayerScore(t,I.ZERO),i=Qt.getPlayerScore(t,I.ONE);return n.isAbsent()?ve.ONE_WON:i.isAbsent()?ve.ZERO_WON:ve.ONGOING}}u(Qt,"singleton",g.empty());class Rd extends Sr{static getPossibleCaptureCombinationsFromPossibleCaptures(e){const t=Rd.computeIntersections(e);let n=[[]];return e.forEach((i,o)=>{if(0===t[o].length)n.forEach(s=>{s.push(o)});else{const s=[],a=t[o].some(c=>c>o);for(const c of n)!0===c.some(f=>t[o].some(d=>f===d))?s.push(Re.copyImmutableArray(c)):a?(s.push(Re.copyImmutableArray(c)),c.push(o),s.push(Re.copyImmutableArray(c))):(c.push(o),s.push(Re.copyImmutableArray(c)));n=s}}),n.map(i=>i.map(o=>e[o]))}static computeIntersections(e){const t=[];return e.forEach((n,i)=>{t.push([]),e.forEach((o,s)=>{i!==s&&n.intersectsWith(o)&&t[i].push(s)})}),t}getMetrics(e){const t=e.gameState;return[Qt.getPlayerScore(t,I.ZERO).get(),Qt.getPlayerScore(t,I.ONE).get()]}getListMoves(e){return this.getListMoveFromState(e.gameState)}getListMoveFromState(e){const t=[];return Qt.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(n=>{const i=Qt.applyCaptures(n,e);Qt.getPlacements(i).forEach(o=>{const s=Qt.applyPlacement(o,i);this.getPossibleCaptureCombinations(s).forEach(a=>{const c=new ka(o,n,a);t.push(c)})})}),t}getPossibleCaptureCombinations(e){const t=Qt.getPossibleCaptures(e);return Rd.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}class _ce{constructor(e,t,n,i,o,s){u(this,"source",void 0),u(this,"destination",void 0),u(this,"x1",void 0),u(this,"y1",void 0),u(this,"x2",void 0),u(this,"y2",void 0),this.source=e,this.destination=t,this.x1=n,this.y1=i,this.x2=o,this.y2=s}}const On=Ce.UNREACHABLE,Xe=Ce.EMPTY,W1=Ce.ZERO,Hc=Ce.ONE;class vce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,js.getInitialState()),W.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,js.getInitialState(),new ka(new qs(new C(3,0),g.of(be.DOWN)),[],[]),$localize`Congratulations!`),W.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new js([[On,On,On,W1,Hc,Xe,Xe],[On,On,Xe,Xe,Xe,Xe,Xe],[On,Xe,Xe,Xe,Xe,Xe,Xe],[W1,W1,W1,Xe,Xe,Xe,Xe],[Hc,Xe,Xe,Xe,Xe,Xe,On],[Xe,Xe,Xe,Hc,Xe,On,On],[Xe,Xe,Xe,Hc,On,On,On]],42,[8,8],[0,0]),[new ka(new qs(new C(0,3),g.of(be.RIGHT)),[],[new F2([new C(0,3),new C(1,3),new C(2,3),new C(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),W.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new js([[On,On,On,Xe,Xe,Xe,Xe],[On,On,Xe,Hc,Xe,Xe,Xe],[On,Xe,Xe,W1,Xe,Xe,Xe],[W1,W1,W1,Hc,Xe,Xe,Xe],[Xe,Xe,Xe,W1,Xe,Xe,On],[Xe,Xe,Xe,W1,Xe,On,On],[Xe,Xe,Xe,Hc,On,On,On]],42,[8,4],[2,3]),[new ka(new qs(new C(0,3),g.of(be.RIGHT)),[],[new F2([new C(3,1),new C(3,2),new C(3,3),new C(3,4),new C(3,5),new C(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),W.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new js([[On,On,On,W1,Xe,Xe,W1],[On,On,Xe,W1,Xe,Xe,W1],[On,W1,W1,Xe,W1,Hc,W1],[Xe,Xe,Xe,W1,Xe,Xe,W1],[Xe,Xe,Xe,W1,Xe,Xe,On],[W1,W1,W1,Hc,Hc,On,On],[Xe,Xe,Xe,W1,On,On,On]],42,[3,4],[2,3]),[new ka(new qs(new C(3,6),g.of(be.UP)),[new F2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new F2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)]),new F2([new C(1,2),new C(2,2),new C(3,2),new C(4,2),new C(5,2)])]),new ka(new qs(new C(4,6),g.of(be.UP)),[new F2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new F2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)]),new F2([new C(3,0),new C(3,1),new C(3,2),new C(3,3),new C(3,4)])]),new ka(new qs(new C(3,6),g.of(be.UP)),[new F2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new F2([new C(1,2),new C(2,2),new C(3,2),new C(4,2),new C(5,2)]),new F2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)])}}function N9t(r,e){if(1&r&&(A(),F(0,"circle",13)),2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClass(t)),k("cx",n.getCenterAt(t).x)("cy",n.getCenterAt(t).y)("r",n.SPACE_SIZE)}}function A9t(r,e){if(1&r){const t=pe();A(),S(0,"g",10),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o))}),F(1,"polygon",11),T(2,N9t,1,4,"circle",12),P()}if(2&r){const t=e.$implicit,n=p();ye("id","click_",t.x,"_",t.y,""),_(1),ye("id","space_",t.x,"_",t.y,""),y("ngClass",n.getSpaceClass(t)),k("points",n.getHexaPointsAt(t)),_(1),y("ngIf",n.isPiece(t))}}function I9t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",16),U("click",function(){const o=te(t).$implicit;return ne(p(2).onClick(o))}),P()}if(2&r){const t=e.$implicit;k("points",p(2).getHexaPointsAt(t))}}function k9t(r,e){if(1&r&&(A(),S(0,"g",14),T(1,I9t,1,1,"polygon",15),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t.capturedSpaces)}}function x9t(r,e){if(1&r){const t=pe();A(),S(0,"line",17),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.destination))}),P()}if(2&r){const t=e.$implicit;k("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function L9t(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",18),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p();_(1),ye("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),k("cx",i.getRemainingPieceCx(n,t))("cy",i.getRemainingPieceCy(n))("r",.5*i.SPACE_SIZE)}}function R9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,L9t,2,6,"g",8),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getPlayerSidePieces(t))}}function z9t(r,e){if(1&r&&(A(),F(0,"line",19)),2&r){const t=p();k("x1",t.inserted.get().x1)("y1",t.inserted.get().y1)("x2",t.inserted.get().x2)("y2",t.inserted.get().y2)}}let D9t=(()=>{var r;class e extends iu{constructor(n){super(n),u(this,"inserted",g.empty()),u(this,"arrows",[]),u(this,"captured",[]),u(this,"moved",[]),u(this,"hexagonWidth",this.SPACE_SIZE),u(this,"sharedHexagonX",Math.cos(30)*this.hexagonWidth*.5),u(this,"boardWidth",this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2),u(this,"boardHeight",7*this.hexagonWidth+4.5*this.STROKE_WIDTH),u(this,"movePhase",e.PHASE_PLACEMENT_COORD),u(this,"constructedState",void 0),u(this,"possibleCaptures",[]),u(this,"initialCaptures",[]),u(this,"placement",g.empty()),u(this,"placementEntrance",g.empty()),u(this,"finalCaptures",[]),this.hasAsymmetricBoard=!0,this.scores=g.of([0,0]),this.rules=Qt.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Rd(this.rules,"GipfMinimax")],this.encoder=ka.encoder,this.tutorial=(new vce).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new ou(1.5*this.SPACE_SIZE,new C(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),Fr.INSTANCE)}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt()})()}showLastMove(n){var i=this;return M(function*(){if(i.inserted=g.empty(),n.placement.direction.isPresent()){const o=n.placement;i.inserted=g.of(i.arrowTowards(o.coord,o.direction.get()))}i.cancelMoveAttempt()})()}arrowTowards(n,i){const o=n.getNext(i.getOpposite()),s=this.getCenterAt(n),a=this.getCenterAt(o);return new _ce(o,n,a.x,a.y,s.x,s.y)}markCapture(n){n.forEach(i=>{this.captured.push(i)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(n){const i=this.constructedState.getNumberOfPiecesToPlace(n),o=[];for(let s=0;s<i;s+=1)o.push(s);return o}isPiece(n){return this.getPiece(n)!==Ce.EMPTY}getPiece(n){return this.constructedState.getPieceAt(n)}onClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+n.x+"_"+n.y);if(o.isFailure())return i.cancelMove(o.getReason());switch(i.movePhase){case e.PHASE_INITIAL_CAPTURE:case e.PHASE_FINAL_CAPTURE:return i.selectCapture(n);case e.PHASE_PLACEMENT_COORD:return i.selectPlacementCoord(n);default:return q.expectToBe(i.movePhase,e.PHASE_PLACEMENT_DIRECTION),i.selectPlacementDirectionOrPlacementCoord(n)}})()}selectCapture(n){var i=this;return M(function*(){const o=[];if(i.possibleCaptures.forEach(a=>{a.contains(n)&&o.push(a)}),o.length>1)return i.cancelMove(Zs.AMBIGUOUS_CAPTURE_COORD());if(0===o.length)return i.cancelMove(Zs.MISSING_CAPTURES());const s=o[0];return i.constructedState=Qt.applyCapture(s,i.constructedState),i.markCapture(s),i.possibleCaptures=Qt.getPossibleCaptures(i.constructedState),i.movePhase===e.PHASE_INITIAL_CAPTURE?(i.initialCaptures.push(s),0===i.possibleCaptures.length?i.moveToPlacementPhase():b.SUCCESS):(q.expectToBe(i.movePhase,e.PHASE_FINAL_CAPTURE),i.finalCaptures.push(s),0===i.possibleCaptures.length?i.tryMove(i.initialCaptures,i.placement.get(),i.finalCaptures):b.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=e.PHASE_PLACEMENT_COORD,b.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=Qt.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?e.PHASE_PLACEMENT_COORD:e.PHASE_INITIAL_CAPTURE,b.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var n=this;return M(function*(){return n.possibleCaptures=Qt.getPossibleCaptures(n.constructedState),0===n.possibleCaptures.length?n.tryMove(n.initialCaptures,n.placement.get(),n.finalCaptures):(n.movePhase=e.PHASE_FINAL_CAPTURE,b.SUCCESS)})()}computeArrows(n){this.arrows=[];for(const i of Qt.getAllDirectionsForEntrance(this.constructedState,n))if(!1===Qt.isLineComplete(this.constructedState,n,i)){const o=n.getNext(i),s=this.getCenterAt(n),a=this.getCenterAt(o);this.arrows.push(new _ce(n,o,s.x,s.y,a.x,a.y))}}selectPlacementCoord(n){var i=this;return M(function*(){const o=i.rules.placementCoordValidity(i.constructedState,n);return o.isFailure()?i.cancelMove(o.getReason()):i.placementEntrance.equalsValue(n)?(i.cancelMoveAttempt(),b.SUCCESS):(i.placementEntrance=g.of(n),i.constructedState.getPieceAt(n)===Ce.EMPTY?i.selectPlacementDirection(g.empty()):(i.movePhase=e.PHASE_PLACEMENT_DIRECTION,i.computeArrows(n),0===i.arrows.length&&(yield i.cancelMove(Zs.NO_DIRECTIONS_AVAILABLE())),b.SUCCESS))})()}selectPlacementDirection(n){var i=this;return M(function*(){i.placement=g.of(new qs(i.placementEntrance.get(),n));const o=i.rules.placementValidity(i.constructedState,i.placement.get());return o.isFailure()?i.cancelMove(o.getReason()):(i.arrows=[],i.constructedState=Qt.applyPlacement(i.placement.get(),i.constructedState),i.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(n){var i=this;return M(function*(){const o=i.placementEntrance.get();if(!1===o.isAlignedWith(n)||1!==o.getDistance(n))return i.selectPlacementCoord(n);const s=be.factory.fromMove(o,n);return i.selectPlacementDirection(s.toOptional())})()}tryMove(n,i,o){const s=new ka(i,n,o);return this.chooseMove(s)}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const n=this.node.move;if(n.isPresent()){const i=n.get(),o=this.getPreviousState();i.initialCaptures.forEach(s=>this.markCapture(s)),i.finalCaptures.forEach(s=>this.markCapture(s)),this.moved=this.rules.getPiecesMoved(o,i.initialCaptures,i.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=g.empty(),this.placement=g.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(n){return this.captured.some(i=>i.equals(n))?"captured-fill":this.moved.some(i=>i.equals(n))?"moved-fill":""}getPieceClass(n){const i=this.getPiece(n);return this.getPlayerClass(I.of(i.value))}getRemainingPieceCy(n){return n===I.ONE?25:this.boardHeight-25}getRemainingPieceCx(n,i){const o=20+i*this.SPACE_SIZE*.5;return n===I.ONE?o:this.boardWidth-(15+o)}}return r=e,u(e,"PHASE_INITIAL_CAPTURE",0),u(e,"PHASE_PLACEMENT_COORD",1),u(e,"PHASE_PLACEMENT_DIRECTION",2),u(e,"PHASE_FINAL_CAPTURE",3),u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-gipf"]],features:[Qe],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs")(2,"marker",1),F(3,"polygon",2),P(),S(4,"marker",3),F(5,"polygon",4),P()(),T(6,A9t,3,7,"g",5),T(7,k9t,2,1,"g",6),T(8,x9t,1,4,"line",7),T(9,R9t,2,1,"g",8),T(10,z9t,1,4,"line",9),P()),2&n&&(k("viewBox",-i.STROKE_WIDTH+" 0 "+i.boardWidth+" "+i.boardHeight)("transform",i.rotation),_(6),y("ngForOf",i.getAllCoords()),_(1),y("ngForOf",i.possibleCaptures),_(1),y("ngForOf",i.arrows),_(1),y("ngForOf",i.Player.PLAYERS),_(1),y("ngIf",i.inserted.isPresent()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var gC,bl;class J1 extends Pr{static of(e){return new J1(e.x,e.y)}toString(){return this===J1.PASS?"GoMove.PASS":this===J1.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}u(J1,"PASS",new(gC=J1)(-1,0)),u(J1,"ACCEPT",new gC(-2,0)),u(J1,"encoder",Pr.getEncoder(gC.of));class ke{constructor(e,t){u(this,"player",void 0),u(this,"type",void 0),this.player=e,this.type=t}equals(e){return e===this}toString(){switch(this){case ke.DARK:return"GoPiece.DARK";case ke.LIGHT:return"GoPiece.LIGHT";case ke.EMPTY:return"GoPiece.EMPTY";case ke.DEAD_DARK:return"GoPiece.DEAD_DARK";case ke.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case ke.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return Fe(this===ke.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(e,t){return t===e.player&&"territory"!==e.type}static ofPlayer(e){return e===I.ZERO?ke.DARK:ke.LIGHT}isOccupied(){return[ke.DARK,ke.LIGHT,ke.DEAD_DARK,ke.DEAD_LIGHT].includes(this)}isEmpty(){return[ke.DARK_TERRITORY,ke.LIGHT_TERRITORY,ke.EMPTY].includes(this)}isDead(){return[ke.DEAD_DARK,ke.DEAD_LIGHT].includes(this)}isTerritory(){return[ke.DARK_TERRITORY,ke.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return Fe(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),ke.EMPTY}}u(ke,"DARK",new(bl=ke)(I.ZERO,"alive")),u(ke,"LIGHT",new bl(I.ONE,"alive")),u(ke,"EMPTY",new bl(K.NONE,"empty")),u(ke,"DEAD_DARK",new bl(I.ZERO,"dead")),u(ke,"DEAD_LIGHT",new bl(I.ONE,"dead")),u(ke,"DARK_TERRITORY",new bl(K.NONE,"territory")),u(ke,"LIGHT_TERRITORY",new bl(K.NONE,"territory"));var pn=function(r){return r.PLAYING="PLAYING",r.PASSED="PASSED",r.COUNTING="COUNTING",r.ACCEPT="ACCEPT",r.FINISHED="FINISHED",r}(pn||{});let Or=(()=>{class r extends B1{constructor(t,n,i,o,s){super(t,i),u(this,"koCoord",void 0),u(this,"captured",void 0),u(this,"phase",void 0),this.captured=n,this.koCoord=o,this.phase=s}static getInitialState(){const t=r.getStartingBoard();return new r(t,[0,0],0,g.empty(),pn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return Re.createTable(r.WIDTH,r.HEIGHT,ke.EMPTY)}copy(){return new r(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(t){return this.getPieceAt(t).isDead()}isTerritory(t){return this.getPieceAt(t).isTerritory()}}return u(r,"WIDTH",19),u(r,"HEIGHT",19),r})();const qe=ke.LIGHT,$e=ke.DARK,FL=ke.DEAD_LIGHT,hu=ke.LIGHT_TERRITORY,Ys=ke.DARK_TERRITORY,le=ke.EMPTY;class Cce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,Or.getInitialState()),W.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new Or([[le,$e,le,le,qe,qe],[le,$e,le,le,qe,le],[le,$e,$e,qe,qe,le],[le,le,$e,qe,le,le],[le,le,$e,qe,le,le],[le,le,$e,qe,le,le]],[0,0],0,g.empty(),pn.PLAYING)),W.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new Or([[le,le,le,le,le],[le,le,$e,le,le],[le,$e,qe,le,le],[le,le,$e,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),pn.PLAYING),[new J1(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),W.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new Or([[le,$e,le,le,le],[$e,qe,le,le,le],[$e,qe,qe,$e,le],[le,$e,$e,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),pn.PLAYING),[new J1(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),W.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new Or([[le,$e,le,le,le],[$e,le,le,le,le],[$e,le,le,le,qe],[qe,$e,le,qe,le],[le,qe,le,qe,$e]],[0,0],0,g.empty(),pn.PLAYING)),W.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new Or([[le,le,le,le,le],[$e,$e,$e,le,le],[qe,qe,$e,le,le],[le,qe,$e,le,le],[qe,qe,$e,le,le]],[0,0],0,g.empty(),pn.PLAYING)),W.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new Or([[le,$e,qe,le,le],[qe,$e,qe,le,le],[$e,$e,qe,le,le],[qe,$e,qe,le,le],[le,$e,qe,le,le]],[0,0],0,g.empty(),pn.PLAYING)),W.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new Or([[le,qe,$e,le,qe,$e,le],[le,qe,$e,$e,qe,$e,le],[le,qe,$e,$e,qe,$e,le],[le,qe,$e,$e,qe,$e,le],[le,qe,$e,qe,qe,$e,le],[le,qe,$e,qe,qe,$e,le],[le,qe,$e,le,qe,$e,le]],[0,0],0,g.empty(),pn.PLAYING)),W.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new Or([[le,le,le,le,le,le,le],[le,le,le,le,le,le,le],[le,le,le,$e,qe,le,le],[le,le,$e,qe,le,qe,le],[le,le,le,$e,qe,le,le],[le,le,le,le,le,le,le],[le,le,le,le,le,le,le]],[0,0],0,g.empty(),pn.PLAYING),[new J1(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),W.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new Or([[qe,$e,$e,$e,$e,$e,Ys,Ys,Ys],[qe,qe,qe,qe,$e,$e,$e,Ys,Ys],[qe,hu,qe,qe,$e,FL,FL,$e,Ys],[$e,qe,qe,qe,qe,$e,Ys,Ys,Ys],[le,qe,hu,qe,$e,$e,FL,$e,Ys],[qe,hu,qe,qe,$e,$e,$e,$e,$e],[qe,qe,$e,$e,$e,qe,qe,$e,qe],[$e,$e,$e,qe,qe,qe,hu,qe,qe],[Ys,Ys,$e,$e,$e,qe,qe,hu,hu]],[0,0],0,g.empty(),pn.COUNTING),[new J1(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)])}}let $L=class{getGroupDatas(e,t){const i=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,i)}_getGroupDatas(e,t,n){const i=t[e.y][e.x];if(n.addPawn(e,i),i===n.color)for(const o of this.getDirections()){const s=e.getNext(o);s.isInRange(t[0].length,t.length)&&!1===n.contains(s)&&(n=this._getGroupDatas(s,t,n))}return n}};$L=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],$L);class pu{constructor(e){u(this,"color",void 0),this.color=e}selfContains(e){return this.getCoords().some(n=>n.equals(e))}static insertAsEntryPoint(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}class F9t extends pu{constructor(e,t,n,i,o,s){super(e),u(this,"emptyCoords",void 0),u(this,"darkCoords",void 0),u(this,"lightCoords",void 0),u(this,"deadDarkCoords",void 0),u(this,"deadLightCoords",void 0),this.emptyCoords=t,this.darkCoords=n,this.lightCoords=i,this.deadDarkCoords=o,this.deadLightCoords=s}getCoords(){return this.color===ke.DARK?this.darkCoords:this.color===ke.LIGHT?this.lightCoords:this.color===ke.DEAD_DARK?this.deadDarkCoords:this.color===ke.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(n=>n.equals(e))}addPawn(e,t){switch(Fe(!1===this.contains(e),"This group already contains "+e.toString()),t){case ke.DARK:this.darkCoords=pu.insertAsEntryPoint(this.darkCoords,e);break;case ke.LIGHT:this.lightCoords=pu.insertAsEntryPoint(this.lightCoords,e);break;case ke.DEAD_DARK:this.deadDarkCoords=pu.insertAsEntryPoint(this.deadDarkCoords,e);break;case ke.DEAD_LIGHT:this.deadLightCoords=pu.insertAsEntryPoint(this.deadLightCoords,e);break;default:q.expectToBeMultiple(t,[ke.EMPTY,ke.DARK_TERRITORY,ke.LIGHT_TERRITORY]),this.emptyCoords=pu.insertAsEntryPoint(this.emptyCoords,e)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const e=new un;e.set(ke.EMPTY,this.emptyCoords.length),e.set(ke.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(ke.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);const t=e.filter((n,i)=>i>0);if(1===t.size())return t.getAnyPair().get().key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const e=[];return this.color!==ke.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==ke.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==ke.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==ke.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==ke.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}class zd extends $L{getNewInstance(e){return new F9t(e,[],[],[],[],[])}getDirections(){return ze.ORTHOGONALS}}let Dd=(()=>{class r{}return u(r,"ILLEGAL_KO",()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`),u(r,"CANNOT_PASS_AFTER_PASSED_PHASE",()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`),u(r,"CANNOT_ACCEPT_BEFORE_COUNTING_PHASE",()=>$localize`You cannot accept before the counting phase.`),u(r,"OCCUPIED_INTERSECTION",()=>$localize`This intersection is already occupied.`),u(r,"CANNOT_COMMIT_SUICIDE",()=>$localize`You cannot commit suicide.`),r})();var mC,Cn;let a4=(mC=class extends Yn{static get(){return Cn.singleton.isAbsent()&&(Cn.singleton=g.of(new Cn)),Cn.singleton.get()}constructor(){super(Or)}static isLegal(e,t){if(Cn.isPass(e)){const n=t.phase===pn.PLAYING,i=t.phase===pn.PASSED;return Ae.display("GoRules","isLegal","at "+t.phase+(n||i?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),n||i?ie.success([]):ie.failure(Dd.CANNOT_PASS_AFTER_PASSED_PHASE())}return Cn.isAccept(e)?t.phase===pn.COUNTING||t.phase===pn.ACCEPT?ie.success([]):ie.failure(Dd.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE()):Cn.isOccupied(e.coord,t.getCopiedBoard())?(Ae.display("GoRules","isLegal","move is marking"),Cn.isLegalDeadMarking(e,t)?ie.success([]):ie.failure(Dd.OCCUPIED_INTERSECTION())):(Ae.display("GoRules","isLegal","move is normal stuff: "+e.toString()),Cn.isLegalNormalMove(e,t))}static getNewKo(e,t,n){if(1===n.length){const i=n[0],o=e.coord,s=t[o.y][o.x],c=(new zd).getGroupDatas(o,t),l=c.emptyCoords,f=ke.pieceBelongTo(s,I.ZERO)?c.darkCoords:c.lightCoords;if(1===l.length&&l[0].equals(i)&&1===f.length)return g.of(i)}return g.empty()}static markTerritoryAndCount(e){const t=e.getCopiedBoard(),n=Cn.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const o of n){const s=o.getWrapper();if(s===ke.LIGHT){i[1]+=o.emptyCoords.length;for(const a of o.getCoords())t[a.y][a.x]=ke.LIGHT_TERRITORY}else{Fe(s===ke.DARK,"territory should be wrapped by dark or light, not by "+s.toString()),i[0]+=o.emptyCoords.length;for(const a of o.getCoords())t[a.y][a.x]=ke.DARK_TERRITORY}}return new Or(t,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy();let i;for(let o=0;o<e.board.length;o++)for(let s=0;s<e.board[0].length;s++)i=t[o][s],i===ke.DARK_TERRITORY?(t[o][s]=ke.EMPTY,n[0]=n[0]-1):i===ke.LIGHT_TERRITORY&&(t[o][s]=ke.EMPTY,n[1]=n[1]-1);return new Or(t,n,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return Cn.getGroupsDatasWhere(e.getCopiedBoard(),t=>t.isEmpty())}static getGroupsDatasWhere(e,t){const n=[];let i,o,s;const a=new zd;for(let c=0;c<e.length;c++)for(let l=0;l<e[0].length;l++)i=new C(l,c),s=e[c][l],t(s)&&!1===n.some(f=>f.selfContains(i))&&(o=a.getGroupDatas(i,e),n.push(o));return n}static addDeadToScore(e){const t=e.getCapturedCopy();let o,n=t[1],i=t[0];for(let s=0;s<e.board.length;s++)for(let a=0;a<e.board[0].length;a++)o=e.getPieceAtXY(a,s),o===ke.DEAD_DARK?n++:o===ke.DEAD_LIGHT&&i++;return[i,n]}static switchAliveness(e,t){const n=t.getCopiedBoard();Fe(n[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const s=(new zd).getGroupDatas(e,n),a=t.getCapturedCopy();switch(s.color){case ke.DEAD_DARK:a[1]-=2*s.deadDarkCoords.length;for(const c of s.deadDarkCoords)n[c.y][c.x]=ke.DARK;break;case ke.DEAD_LIGHT:a[0]-=2*s.deadLightCoords.length;for(const c of s.deadLightCoords)n[c.y][c.x]=ke.LIGHT;break;case ke.LIGHT:a[0]+=2*s.lightCoords.length;for(const c of s.lightCoords)n[c.y][c.x]=ke.DEAD_LIGHT;break;default:q.expectToBe(s.color,ke.DARK),a[1]+=2*s.darkCoords.length;for(const c of s.darkCoords)n[c.y][c.x]=ke.DEAD_DARK}return new Or(n,a,t.turn,t.koCoord,t.phase)}static getGameStatus(e){const t=e.gameState;return t.phase===pn.FINISHED?t.captured[0]>t.captured[1]?ve.ZERO_WON:t.captured[1]>t.captured[0]?ve.ONE_WON:ve.DRAW:ve.ONGOING}static isPass(e){return e.equals(J1.PASS)}static isAccept(e){return e.equals(J1.ACCEPT)}static isLegalDeadMarking(e,t){return Cn.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===pn.COUNTING||t.phase===pn.ACCEPT)}static isLegalNormalMove(e,t){const n=t.getCopiedBoard();if(Cn.isKo(e,t))return ie.failure(Dd.ILLEGAL_KO());[pn.COUNTING,pn.ACCEPT].includes(t.phase)&&(t=Cn.resurrectStones(t));const i=Cn.getCaptureState(e,t);if(Mce.isCapturing(i))return ie.success(i.capturedCoords);{n[e.coord.y][e.coord.x]=t.turn%2==0?ke.DARK:ke.LIGHT;const a=0===(new zd).getGroupDatas(e.coord,n).emptyCoords.length;return n[e.coord.y][e.coord.x]=ke.EMPTY,a?ie.failure(Dd.CANNOT_COMMIT_SUICIDE()):ie.success([])}}static isOccupied(e,t){return t[e.y][e.x].isOccupied()}static isKo(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}static getCaptureState(e,t){const n=new Mce;let i;for(const o of ze.ORTHOGONALS)i=Cn.getCapturedInDirection(e.coord,o,t),i.length>0&&n.capturedCoords.every(s=>!1===i[0].equals(s))&&(n.capturedCoords=n.capturedCoords.concat(i));return n}static getCapturedInDirection(e,t,n){const i=n.getCopiedBoard(),o=e.getNext(t);if(o.isInRange(n.board[0].length,n.board.length)&&i[o.y][o.x]===(n.turn%2==0?ke.LIGHT:ke.DARK)){Ae.display("GoRules","getCapturedInDirection","a group could be captured");const c=(new zd).getGroupDatas(o,i);if(Cn.isCapturableGroup(c,n.koCoord))return Ae.display("GoRules","getCapturedInDirection",{neightbooringGroupCoord:c.getCoords(),message:"is capturable"}),c.getCoords()}return[]}static isCapturableGroup(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return Cn.getEmptyZones(e).filter(n=>n.isMonoWrapped())}static applyPass(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy(),i=e.turn;let o,s;return e.phase===pn.PASSED?(o=pn.COUNTING,s=new Or(t,n,i+1,g.empty(),o),s=Cn.markTerritoryAndCount(s)):(Fe(e.phase===pn.PLAYING,"Cannot pass in counting phase!"),o=pn.PASSED,s=new Or(t,n,i+1,g.empty(),o)),s}static applyLegalAccept(e){const t=e.getCopiedBoard();let n;return n=e.phase===pn.COUNTING?pn.ACCEPT:pn.FINISHED,new Or(t,e.getCapturedCopy(),e.turn+1,g.empty(),n)}static applyNormalLegalMove(e,t,n){let i;i=[pn.COUNTING,pn.ACCEPT].includes(t.phase)?Cn.resurrectStones(t):t.copy();const o=e.coord.x,s=e.coord.y,a=i.getCopiedBoard(),c=i.turn,l=ke.ofPlayer(i.getCurrentPlayer()),f=c+1;a[s][o]=l;for(const E of n)a[E.y][E.x]=ke.EMPTY;const d=Cn.getNewKo(e,a,n),m=i.getCapturedCopy();return m[l.player.value]+=n.length,new Or(a,m,f,d,pn.PLAYING)}static resurrectStones(e){for(let t=0;t<e.board.length;t++)for(let n=0;n<e.board[0].length;n++)e.getPieceAtXY(n,t).isDead()&&(e=Cn.switchAliveness(new C(n,t),e));return Cn.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,t){const n=Cn.removeAndSubstractTerritory(t),i=Cn.switchAliveness(e.coord,n),o=new Or(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,g.empty(),pn.COUNTING);return Cn.markTerritoryAndCount(o)}isLegal(e,t){return Cn.isLegal(e,t)}applyLegalMove(e,t,n){return Cn.isPass(e)?(Ae.display("GoRules","applyLegalMove","isPass"),Cn.applyPass(t)):Cn.isAccept(e)?(Ae.display("GoRules","applyLegalMove","isAccept"),Cn.applyLegalAccept(t)):Cn.isLegalDeadMarking(e,t)?(Ae.display("GoRules","applyLegalMove","isDeadMarking"),Cn.applyDeadMarkingMove(e,t)):(Ae.display("GoRules","applyLegalMove","else it is normal move"),Cn.applyNormalLegalMove(e,t,n))}getGameStatus(e){return Cn.getGameStatus(e)}},Cn=mC,u(mC,"singleton",g.empty()),mC);a4=Cn=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],a4);class Mce{constructor(){u(this,"capturedCoords",[])}static isCapturing(e){return e.capturedCoords.length>0}}let BL=class extends Sr{getListMoves(e){const t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===pn.PLAYING||t.phase===pn.PASSED)return n.push(J1.PASS),n;{const i=this.getCountingMovesList(t);return 0===i.length?[J1.ACCEPT]:i}}getPlayingMovesList(e){const t=[];let n;for(let i=0;i<e.board.length;i++)for(let o=0;o<e.board[0].length;o++)n=new J1(o,i),e.getPieceAt(n.coord)===ke.EMPTY&&a4.isLegal(n,e).isSuccess()&&t.push(n);return t}getCountingMovesList(e){const t=[],n=this.getCorrectBoard(e).getCopiedBoard(),i=a4.getGroupsDatasWhere(n,o=>o!==ke.EMPTY);for(const o of i){const s=o.getCoords()[0],a=n[s.y][s.x];if(e.getPieceAt(s)!==a){const l=new J1(s.x,s.y);return t.push(l),t}}return t}getCorrectBoard(e){const n=this.mapBoard(e.getCopiedBoard(),s=>s===ke.DARK?ke.DEAD_DARK:s===ke.LIGHT?ke.DEAD_LIGHT:s.isTerritory()?ke.EMPTY:s),i=new Or(n,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),o=a4.getTerritoryLikeGroup(i);return this.setAliveUniqueWrapper(i,o)}mapBoard(e,t){const n=[];for(let i=0;i<e.length;i++){n[i]=[];for(let o=0;o<e[0].length;o++)n[i][o]=t(e[i][o])}return n}setAliveUniqueWrapper(e,t){let i,n=e.copy();for(const o of t){i=o.deadDarkCoords.concat(o.deadLightCoords);for(const s of i)n.isDead(s)&&(n=a4.switchAliveness(s,n))}return n}getMetrics(e){const t=a4.markTerritoryAndCount(e.gameState),n=t.getCapturedCopy(),i=this.getDeadStones(t);return[n[0]+2*i[1],n[1]+2*i[0]]}getDeadStones(e){const t=[0,0];for(let n=0;n<e.board.length;n++)for(let i=0;i<e.board[0].length;i++){const o=e.getPieceAtXY(i,n);"dead"===o.type&&(t[o.player.value]=t[o.player.value]+1)}return t}};var gu;function U9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",8),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P(),S(2,"line",9),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P(),S(3,"line",9),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ye("id","click_",t,"_",n,""),k("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),k("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),k("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)}}function W9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,U9t,4,14,"g",3),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function q9t(r,e){if(1&r){const t=pe();A(),S(0,"circle",10),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","hoshi_",t.x,"_",t.y,""),k("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.1*n.SPACE_SIZE)}}function j9t(r,e){if(1&r&&(A(),F(0,"circle",16)),2&r){const t=p(2).index,n=p().index,i=p();k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function Z9t(r,e){if(1&r){const t=pe();A(),S(0,"line",17),U("click",function(){te(t);const i=p(2).index,o=p().index;return ne(p().onClick(i,o))}),P()}if(2&r){const t=p(2).index,n=p().index,i=p();k("x1",.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)}}function Y9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"circle",13),U("click",function(){te(t);const i=p().index,o=p().index;return ne(p().onClick(i,o))}),P(),T(2,j9t,1,3,"circle",14),T(3,Z9t,1,4,"line",15),P()}if(2&r){const t=p().index,n=p().index,i=p();_(1),y("ngClass",i.getSpaceClass(t,n)),k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE),_(1),y("ngIf",i.isLastSpace(t,n)),_(1),y("ngIf",i.isDead(t,n))}}function K9t(r,e){if(1&r){const t=pe();A(),S(0,"circle",19),U("click",function(){te(t);const i=p(2).index,o=p().index;return ne(p().onClick(i,o))}),P()}if(2&r){const t=p(2),n=t.index,i=t.$implicit,o=p().index,s=p();k("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*n)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*o)("r",.1*s.SPACE_SIZE)("class",i===s.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function X9t(r,e){if(1&r&&(A(),T(0,K9t,1,4,"circle",18)),2&r){const t=p().index,n=p().index;y("ngIf",p().isTerritory(t,n))}}function Q9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,Y9t,4,6,"g",11),T(2,X9t,1,1,"ng-template",null,12,dn),P()),2&r){const t=e.index,n=ln(3),i=p().index,o=p();_(1),y("ngIf",o.spaceIsFull(t,i))("ngIfElse",n)}}function J9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,Q9t,4,2,"g",3),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function edt(r,e){if(1&r&&(A(),F(0,"rect",20)),2&r){const t=p();k("width",.25*t.SPACE_SIZE)("height",.25*t.SPACE_SIZE)("x",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().x)("y",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().y)}}function tdt(r,e){if(1&r){const t=pe();A(),S(0,"circle",21),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()}if(2&r){const t=e.$implicit,n=p();k("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.07*n.SPACE_SIZE)}}BL=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],BL);let GL=(gu=class extends xL{constructor(e){super(e),u(this,"boardInfo",void 0),u(this,"ko",g.empty()),u(this,"last",g.empty()),u(this,"captures",[]),u(this,"GoPiece",ke),u(this,"boardHeight",Or.HEIGHT),u(this,"boardWidth",Or.WIDTH),this.scores=g.of([0,0]),this.rules=a4.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new BL(this.rules,"GoMinimax")],this.encoder=J1.encoder,this.tutorial=(new Cce).tutorial,this.canPass=!0,this.boardHeight=this.getState().board.length,this.boardWidth=this.getState().board[0].length}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());n.last=g.empty();const o=new J1(e,t);return n.chooseMove(o)})()}updateBoard(e){var t=this;return M(function*(){const n=t.getState(),i=t.node.move,o=n.phase;t.board=n.getCopiedBoard(),t.scores=g.of(n.getCapturedCopy()),t.ko=n.koCoord,i.isPresent()?t.showCaptures():t.captures=[],t.last=i.map(s=>s.coord),t.canPass=o!==pn.FINISHED,t.createHoshis()})()}showCaptures(){const e=this.getPreviousState();this.captures=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const i=new C(n,t),o=e.getPieceAt(i).isOccupied(),s=this.board[t][n]===ke.EMPTY,a=!1===this.ko.equalsValue(i);o&&s&&a&&this.captures.push(i)}}pass(){var e=this;return M(function*(){const t=e.getState().phase;return t===pn.PLAYING||t===pn.PASSED?e.onClick(J1.PASS.coord.x,J1.PASS.coord.y):(Fe(t===pn.COUNTING||t===pn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(J1.ACCEPT.coord.x,J1.ACCEPT.coord.y))})()}getSpaceClass(e,t){const n=this.getState().getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}spaceIsFull(e,t){return this.getState().getPieceAtXY(e,t)!==ke.EMPTY&&!1===this.isTerritory(e,t)}isLastSpace(e,t){if(this.last.isPresent()){const n=this.last.get();return e===n.x&&t===n.y}return!1}isDead(e,t){return this.getState().isDead(new C(e,t))}isTerritory(e,t){return this.getState().isTerritory(new C(e,t))}},u(gu,"\u0275fac",function(e){return new(e||gu)(G(Ut))}),u(gu,"\u0275cmp",je({type:gu,selectors:[["app-go"]],features:[Qe],decls:9,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],["id","blank_board"],[4,"ngFor","ngForOf"],["class","base-no-stroke",3,"id","click",4,"ngFor","ngForOf"],["id","piece_ko_territory_markers_and_dead_stones"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],["fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[1,"base-no-stroke",3,"id","click"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,t){1&e&&(A(),S(0,"svg",0),F(1,"rect",1),S(2,"g",2),T(3,W9t,2,1,"g",3),T(4,q9t,1,5,"circle",4),P(),S(5,"g",5),T(6,J9t,2,1,"g",3),P(),T(7,edt,1,4,"rect",6),T(8,tdt,1,3,"circle",7),P()),2&e&&(k("viewBox","0 -3 "+t.boardWidth*t.SPACE_SIZE*.5+" "+(6+t.boardHeight*t.SPACE_SIZE*.5)),_(1),k("width",t.boardWidth*t.SPACE_SIZE*.5)("height",t.boardHeight*t.SPACE_SIZE*.5),_(2),y("ngForOf",t.board),_(1),y("ngForOf",t.hoshis),_(2),y("ngForOf",t.board),_(1),y("ngIf",t.ko.isPresent()),_(1),y("ngForOf",t.captures))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),gu);GL=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],GL);class c4{static fromLimits(e,t,n,i){return new c4(e,n,t-e,i-n)}static fromHexa(e,t,n){const i=e.flatMap(f=>t.getHexaPointsListAt(f)),o=c4.getLimits(i);return new c4(o.minX-n/2,o.minY-n/2,n+o.maxX-o.minX,n+o.maxY-o.minY)}static getLimits(e){let t=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER;for(const s of e)i=Math.min(i,s.x),o=Math.min(o,s.y),t=Math.max(t,s.x),n=Math.max(n,s.y);return{minX:i,minY:o,maxX:t,maxY:n}}constructor(e,t,n,i){u(this,"left",void 0),u(this,"up",void 0),u(this,"width",void 0),u(this,"height",void 0),this.left=e,this.up=t,this.width=n,this.height=i}center(){return new C(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(e,t,n,i){return new c4(this.left-e,this.up-n,this.width+e+t,this.height+n+i)}containingAtLeast(e){const t=Math.min(this.left,e.left),n=Math.max(this.right(),e.right()),i=Math.min(this.up,e.up),o=Math.max(this.bottom(),e.bottom());return c4.fromLimits(t,n,i,o)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}class ndt{static getArrowTransform(e,t,n){let i,o,s;switch(n){case ze.UP:i=1,o=0,s=-90;break;case ze.DOWN:i=1,o=2,s=90;break;case ze.LEFT:i=0,o=1,s=180;break;default:q.expectToBe(n,ze.RIGHT),i=2,o=1,s=0}return["scale("+e/300+")",`translate(${100*i} ${100*o})`,"rotate("+s+" 50 50)"].join(" ")}}let ur=(()=>{class r{}return u(r,"CANNOT_DROP_PIECE_YOU_DONT_HAVE",()=>"You cannot drop a piece that you do not have in your reserve."),u(r,"QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The queen bee can only move to one of its direct neighbors.`),u(r,"BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The beetle can only move to one of its direct neighbors.`),u(r,"GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`The grasshopper must move in a straight line.`),u(r,"GRASSHOPPER_MUST_JUMP_OVER_PIECES",()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`),u(r,"SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES",()=>$localize`The spider must move on neighboring spaces.`),u(r,"SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT",()=>$localize`The spider can only move around pieces that are in direct contact with it.`),u(r,"SPIDER_CANNOT_BACKTRACK",()=>$localize`The spider cannot go twice through the same space in the same move.`),u(r,"QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE",()=>$localize`The queen bee must be placed on the board before moving a piece.`),u(r,"THIS_PIECE_CANNOT_CLIMB",()=>$localize`Only the beetle is allowed to climb over other pieces.`),u(r,"CANNOT_DISCONNECT_HIVE",()=>$localize`You are not allowed to split the hive.`),u(r,"MUST_BE_ABLE_TO_SLIDE",()=>$localize`This piece must be able to slide to its destination.`),u(r,"MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN",()=>$localize`You must place your queen bee at this turn!`),u(r,"CANNOT_DROP_NEXT_TO_OPPONENT",()=>$localize`You cannot drop a piece next to one of your opponent's stack.`),u(r,"MUST_DROP_ON_EMPTY_SPACE",()=>$localize`You must always drop your piece on an empty space.`),u(r,"MUST_BE_CONNECTED_TO_HIVE",()=>$localize`The piece you are dropping must be connected to the hive.`),r})();var Ece;const rdt=we.fromFunctions(r=>r,r=>r);class e2{constructor(e,t){u(this,"owner",void 0),u(this,"kind",void 0),this.owner=e,this.kind=t}toString(){return`${this.kind}_${this.owner.toString()}`}equals(e){return this.owner===e.owner&&this.kind===e.kind}}Ece=e2,u(e2,"encoder",we.tuple([I.encoder,rdt],r=>[r.owner,r.kind],r=>new Ece(r[0],r[1])));class Vc{constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.size()===e.size()&&Re.compareArray(this.pieces,e.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(e){return new Vc([e,...this.pieces])}topPiece(){return q.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const e=[...this.pieces];return e.shift(),new Vc(e)}size(){return this.pieces.length}}var Pce,Oce,m2;u(Vc,"EMPTY",new Vc([]));class Ks extends Pr{static of(e,t){return new Ks(e,t.x,t.y)}constructor(e,t,n){super(t,n),u(this,"piece",void 0),this.piece=e}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(e){return e instanceof Ks&&this.piece.equals(e.piece)&&this.coord.equals(e.coord)}}Pce=Ks,u(Ks,"encoder",we.tuple([e2.encoder,C.encoder],r=>[r.piece,r.coord],r=>new Pce(r[0],r[1].x,r[1].y)));class $i extends Fs{static from(e,t){return e.equals(t)?ie.failure(Le.MOVE_CANNOT_BE_STATIC()):ie.success(new $i(e,t))}constructor(e,t){super(e,t)}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!(e instanceof xa)&&e instanceof $i&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}u($i,"encoder",Ho.getFallibleEncoder($i.from));class xa extends $i{static ofCoords(e){return new xa(e)}constructor(e){super(e[0],e[3]),u(this,"coords",void 0),this.coords=e}toString(){return`HiveMoveSpider(${this.coords.map(t=>t.toString()).join(", ")})`}equals(e){return e instanceof xa&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}Oce=xa,u(xa,"encoder",we.tuple([C.encoder,C.encoder,C.encoder,C.encoder],r=>r.coords,r=>new Oce(r)));class w0 extends Ri{toString(){return"HiveMovePass"}equals(e){return e instanceof w0}}function idt(r){return r instanceof Ks}function odt(r){return r instanceof xa}function sdt(r){return r instanceof $i}function adt(r){return r instanceof w0}u(w0,"encoder",we.constant("HiveMovePass",new w0)),function(r){r.PASS=new w0,r.drop=function e(i,o){return Ks.of(i,o)},r.move=function t(i,o){return $i.from(i,o)},r.spiderMove=function n(i){return xa.ofCoords(i)},r.encoder=we.disjunction([idt,odt,sdt,adt],[Ks.encoder,xa.encoder,$i.encoder,w0.encoder])}(m2||(m2={}));class Xs{static of(e){return Xs.INSTANCES.isAbsent()&&(Xs.INSTANCES=g.of({QueenBee:_C.get(),Beetle:vC.get(),Grasshopper:CC.get(),Spider:Hd.get(),SoldierAnt:yC.get()})),Xs.INSTANCES.get()[e.kind]}checkEmptyDestination(e,t){return t.getAt(e.getEnd()).hasPieces()?b.failure(ur.THIS_PIECE_CANNOT_CLIMB()):b.SUCCESS}canSlideBetweenNeighbors(e,t,n){const i=new dt(p2.getNeighbors(t)),o=new dt(p2.getNeighbors(n)),s=i.intersection(o);for(const a of s)if(e.getAt(a).isEmpty())return!0;return!1}}u(Xs,"INSTANCES",g.empty());class _C extends Xs{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new _C)),this.INSTANCE.get()}moveValidity(e,t){return!1===p2.areNeighbors(e.getStart(),e.getEnd())?b.failure(ur.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(t,e.getStart(),e.getEnd())?b.failure(ur.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of p2.getNeighbors(e))t.getAt(i).isEmpty()&&n.push($i.from(e,i).get());return n}}u(_C,"INSTANCE",g.empty());class vC extends Xs{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new vC)),this.INSTANCE.get()}moveValidity(e,t){return!1===p2.areNeighbors(e.getStart(),e.getEnd())?b.failure(ur.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):b.SUCCESS}getPotentialMoves(e,t){const n=[];for(const i of p2.getNeighbors(e))n.push($i.from(e,i).get());return n}}u(vC,"INSTANCE",g.empty());class CC extends Xs{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new CC)),this.INSTANCE.get()}moveValidity(e,t){if(be.factory.fromMove(e.getStart(),e.getEnd()).isFailure())return b.failure(ur.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const i=e.getStart().getCoordsToward(e.getEnd());if(0===i.length)return b.failure(ur.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const o of i)if(t.getAt(o).isEmpty())return b.failure(ur.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of be.factory.all){const o=e.getNext(i);if(t.getAt(o).hasPieces()){let s=o;for(;t.getAt(s).hasPieces();)s=s.getNext(i);n.push($i.from(e,s).get())}}return n}}u(CC,"INSTANCE",g.empty());class Hd extends Xs{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new Hd)),this.INSTANCE.get()}prefixLegality(e,t){const n=new dt,i=t.update().setAt(e[0],Vc.EMPTY).increaseTurnAndFinalizeUpdate();for(let o=1;o<e.length;o++){if(i.getAt(e[o]).hasPieces())return b.failure(ur.THIS_PIECE_CANNOT_CLIMB());if(!1===p2.areNeighbors(e[o-1],e[o]))return b.failure(ur.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===i.haveCommonNeighbor(e[o],e[o-1]))return b.failure(ur.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(i,e[o-1],e[o]))return b.failure(ur.MUST_BE_ABLE_TO_SLIDE());if(n.contains(e[o]))return b.failure(ur.SPIDER_CANNOT_BACKTRACK());n.add(e[o])}return b.SUCCESS}moveValidity(e,t){q.assert(e instanceof xa,"HiveSpiderRules: move should be a spider move");const i=this.prefixLegality(e.coords,t);return i.isFailure()?i:this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=t.update().setAt(e,Vc.EMPTY).increaseTurnAndFinalizeUpdate();let i=[[e]];for(let a=0;a<3;a++)i=i.flatMap(c=>this.nextMoveStep(n,c));return new dt(i.map(function o(a){return xa.ofCoords(a)})).toList()}nextMoveStep(e,t){const n=t[t.length-1];return new dt(p2.getNeighbors(n)).filter(function i(s){return!e.getAt(s).hasPieces()&&void 0===t.find(a=>s.equals(a))&&e.haveCommonNeighbor(s,n)}).toList().map(s=>[...t,s])}}u(Hd,"INSTANCE",g.empty());class yC extends Xs{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new yC)),this.INSTANCE.get()}pathExists(e,t,n){const i=new dt,o=[t];for(;o.length>0;){const s=o.pop();if(!i.contains(s)){if(i.add(s),s.equals(n))return!0;for(const a of p2.getNeighbors(s)){const c=e.getAt(a).isEmpty(),l=e.getOccupiedNeighbors(a).size()>0,f=this.canSlideBetweenNeighbors(e,s,a);c&&l&&f&&o.push(a)}}}return!1}moveValidity(e,t){return!1===this.pathExists(t,e.getStart(),e.getEnd())?b.failure(ur.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=new dt;for(const i of t.occupiedSpaces())if(!i.equals(e))for(const o of t.emptyNeighbors(i))n.add($i.from(e,o).get());return n.toList()}}u(yC,"INSTANCE",g.empty());class wce extends eC{constructor(e,t){super(t),u(this,"pieces",void 0),u(this,"width",void 0),u(this,"height",void 0),this.pieces=e;const n=this.computeScale();this.width=n.width,this.height=n.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(const o of this.pieces.listKeys())e=Math.min(o.x,e),t=Math.max(o.x,t),n=Math.min(o.y,n),i=Math.max(o.y,i);return{width:t+1-e,height:i+1-n}}isOnBoard(e){return this.pieces.containsKey(e)}getOccupiedNeighbors(e){return new dt(p2.getNeighbors(e)).filter(n=>this.pieces.get(n).isPresent())}getGroups(){const e=new dt,t=new dt;return this.pieces.forEach(n=>{if(!1===e.contains(n.key)){const i=new dt,o=new dt([n.key]);for(;o.hasElements();){const s=o.getAnyElement().get();o.remove(s),e.add(s),i.add(s),o.addAll(this.getOccupiedNeighbors(s).filter(a=>!1===e.contains(a)))}t.add(i)}}),t}}class MC{static getInitial(){const e=new un;for(const t of I.PLAYERS)e.set(new e2(t,"QueenBee"),1),e.set(new e2(t,"Beetle"),2),e.set(new e2(t,"Spider"),2),e.set(new e2(t,"Grasshopper"),3),e.set(new e2(t,"SoldierAnt"),3);return e.makeImmutable(),new MC(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.pieces.equals(e.pieces)}getQuantity(e){return this.pieces.get(e).get()}hasRemaining(e){return this.getQuantity(e)>0}getAny(e){for(const t of this.pieces.listKeys())if(t.owner===e&&this.hasRemaining(t))return g.of(t);return g.empty()}remove(e){const t=this.pieces.get(e).get();q.assert(t>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const n=this.pieces.getCopy();return n.replace(e,t-1),new MC(n)}toListOfStacks(){const e=[];return this.pieces.forEach(t=>{const n=[];for(let i=0;i<t.value;i++)n.push(t.key);e.push(new Vc(n))}),e}getPlayerPieces(e){const t=[];return this.pieces.forEach(n=>{n.key.owner===e&&n.value>0&&t.push(n.key)}),t}}class Vd{static of(e){return new Vd(e.pieces,e.remainingPieces,e.queenBees,e.turn)}constructor(e,t,n,i){u(this,"pieces",void 0),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),u(this,"turn",void 0),this.pieces=e,this.remainingPieces=t,this.queenBees=n,this.turn=i}setAt(e,t){const n=this.queenBees.getCopy();for(const o of I.PLAYERS)n.get(o).equalsValue(e)&&n.delete(o);for(const o of t.pieces)"QueenBee"===o.kind&&n.put(o.owner,e);const i=this.pieces.getCopy();return t.isEmpty()?i.delete(e):i.put(e,t),new Vd(i,this.remainingPieces,n,this.turn)}removeRemainingPiece(e){return new Vd(this.pieces,this.remainingPieces.remove(e),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new fi(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class fi extends wce{static getInitialState(){return fi.fromRepresentation([],0)}static fromRepresentation(e,t,n=new St(0,0)){const i=new eu;let o=MC.getInitial();const s=new un;for(let a=0;a<e.length;a++)for(let c=0;c<e[0].length;c++)if(e[a][c].length>0){const l=new C(c,a).getNext(n,1);i.set(l,new Vc(e[a][c]));const f=g.ofNullable(e[a][c].find(d=>"QueenBee"===d.kind));f.isPresent()&&s.set(f.get().owner,l);for(const d of e[a][c])o=o.remove(d)}return new fi(i,o,s,t)}constructor(e,t,n,i){super(e,i),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),this.remainingPieces=t,this.queenBees=n,this.queenBees=n.getCopy();for(const o of n.listKeys()){const s=n.get(o).get();this.queenBees.replace(o,s)}this.queenBees.makeImmutable()}update(){return Vd.of(this)}equals(e){return this.pieces.equals(e.pieces)&&this.remainingPieces.equals(e.remainingPieces)&&this.queenBees.equals(e.queenBees)&&this.turn===e.turn}getAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():Vc.EMPTY}queenBeeLocation(e){return this.queenBees.get(e)}hasQueenBeeOnBoard(e){return this.queenBeeLocation(e).isPresent()}numberOfNeighbors(e){let t=0;for(const n of p2.getNeighbors(e))this.getAt(n).hasPieces()&&(t+=1);return t}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(e){const t=[];for(const n of p2.getNeighbors(e))this.getAt(n).isEmpty()&&t.push(n);return t}haveCommonNeighbor(e,t){const n=this.getOccupiedNeighbors(e),i=this.getOccupiedNeighbors(t);return n.findAnyCommonElement(i).isPresent()}}class $2 extends Yn{static get(){return $2.singleton.isAbsent()&&($2.singleton=g.of(new $2)),$2.singleton.get()}constructor(){super(fi)}applyLegalMove(e,t,n){return e instanceof Ks?this.applyLegalDrop(e,t):e instanceof $i?this.applyLegalMoveCoordToCoord(e,t):t.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(e,t){const n=t.getAt(e.coord);return t.update().setAt(e.coord,n.add(e.piece)).removeRemainingPiece(e.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(e,t){const n=t.getAt(e.getStart()),i=t.getAt(e.getEnd());return t.update().setAt(e.getStart(),n.removeTopPiece()).setAt(e.getEnd(),i.add(n.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(e,t){return e instanceof Ks?this.isLegalDrop(e,t):e instanceof $i?this.isLegalMoveCoordToCoord(e,t):this.shouldPass(t)?b.SUCCESS:b.failure(Le.CANNOT_PASS())}isLegalMoveCoordToCoord(e,t){if(!1===t.queenBeeLocation(t.getCurrentPlayer()).isPresent())return b.failure(ur.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const n=t.getAt(e.getStart());if(n.isEmpty())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());const i=n.topPiece();if(i.owner===t.getCurrentOpponent())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());const o=Xs.of(i).moveValidity(e,t);if(o.isFailure())return o;const s=t.update().setAt(e.getStart(),n.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(s.isDisconnected())return b.failure(ur.CANNOT_DISCONNECT_HIVE());const a=e.getEnd();return 0===s.numberOfNeighbors(a)?b.failure(ur.CANNOT_DISCONNECT_HIVE()):b.SUCCESS}mustPlaceQueenBee(e){return e.turn>=6&&!1===e.hasQueenBeeOnBoard(e.getCurrentPlayer())}isLegalDrop(e,t){const n=t.getCurrentPlayer();if(e.piece.owner===n.getOpponent())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.remainingPieces.hasRemaining(e.piece))return b.failure(ur.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==e.piece.kind&&this.mustPlaceQueenBee(t))return b.failure(ur.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const i=this.checkNeighborValidity(e,t);return i.isFailure()?i:t.getAt(e.coord).hasPieces()?b.failure(ur.MUST_DROP_ON_EMPTY_SPACE()):b.SUCCESS}checkNeighborValidity(e,t){const n=t.getCurrentPlayer();let i=!1;for(const o of p2.getNeighbors(e.coord)){const s=t.getAt(o);if(s.hasPieces()&&(i=!0,1!==t.turn&&s.topPiece().owner===n.getOpponent()))return b.failure(ur.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==t.turn&&!1===i?b.failure(ur.MUST_BE_CONNECTED_TO_HIVE()):b.SUCCESS}getPossibleDropLocations(e){const t=e.getCurrentPlayer();if(0===e.turn)return new dt([new C(0,0)]);if(1===e.turn)return new dt(p2.getNeighbors(new C(0,0)));const n=e.remainingPieces.getAny(t);if(n.isAbsent())return new dt;const i=n.get(),o=new dt;for(const s of e.occupiedSpaces())if(e.getAt(s).topPiece().owner===t)for(const a of e.emptyNeighbors(s)){const c=Ks.of(i,a);this.isLegalDrop(c,e).isSuccess()&&o.add(a)}return o}getPossibleMovesFrom(e,t){const n=e.getCurrentPlayer(),i=new dt,o=e.getAt(t).topPiece();if(o.owner===n)for(const s of Xs.of(o).getPotentialMoves(t,e))this.isLegalMoveCoordToCoord(s,e).isSuccess()&&i.add(s);return i}getPossibleMovesOnBoard(e){const t=new dt;for(const n of e.occupiedSpaces())t.addAll(this.getPossibleMovesFrom(e,n));return t}shouldPass(e){return 0===this.getPossibleDropLocations(e).size()&&0===this.getPossibleMovesOnBoard(e).size()}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of I.PLAYERS){const o=t.queenBeeLocation(i);o.isPresent()&&(n[i.value]=t.numberOfNeighbors(o.get()))}return 6===n[0]&&6===n[1]?ve.DRAW:6===n[0]?ve.getVictory(I.ONE):6===n[1]?ve.getVictory(I.ZERO):ve.ONGOING}}u($2,"singleton",g.empty());class cdt extends Sr{getListMoves(e){const t=this.getListDrops(e.gameState),n=this.getListOfOnBoardMoves(e.gameState),i=t.concat(n);return 0===i.length?[m2.PASS]:i}getListOfOnBoardMoves(e){return $2.get().getPossibleMovesOnBoard(e).toList()}getListDrops(e){const t=[],n=e.getCurrentPlayer(),i=new e2(n,"QueenBee");for(const o of $2.get().getPossibleDropLocations(e))if($2.get().mustPlaceQueenBee(e))t.push(m2.drop(i,o));else for(const s of e.remainingPieces.getPlayerPieces(e.getCurrentPlayer()))t.push(m2.drop(s,o));return t}getMetrics(e){return[this.queenBeeMobility(e.gameState,I.ZERO),this.queenBeeMobility(e.gameState,I.ONE)]}queenBeeMobility(e,t){const n=e.queenBeeLocation(t);return n.isPresent()?$2.get().getPossibleMovesFrom(e,n.get()).size():0}}const Fc=new e2(I.ZERO,"QueenBee"),N0=new e2(I.ZERO,"Beetle"),mu=new e2(I.ZERO,"Grasshopper"),EC=new e2(I.ZERO,"Spider"),SC=new e2(I.ZERO,"SoldierAnt"),A0=new e2(I.ONE,"QueenBee"),_s=new e2(I.ONE,"Beetle"),UL=new e2(I.ONE,"Grasshopper"),WL=new e2(I.ONE,"Spider"),Fd=new e2(I.ONE,"SoldierAnt");class Nce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,fi.fromRepresentation([[[A0],[_s],[WL],[mu]],[[mu],[],[SC],[]],[[SC],[],[],[]]],8)),W.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,fi.fromRepresentation([[[],[_s],[EC]],[[Fd],[A0],[Fc]],[[mu],[N0],[]]],7)),W.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,fi.getInitialState(),m2.drop(N0,new C(0,0)),$localize`Congratulations!`),W.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,fi.fromRepresentation([[[_s],[mu]]],2),m2.drop(Fc,new C(2,0)),$localize`Congratulations!`),W.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,fi.fromRepresentation([[[],[EC],[UL],[A0],[_s]],[[_s],[Fc],[N0],[],[]]],4),[m2.move(new C(1,1),new C(0,2)).get(),m2.move(new C(1,1),new C(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,fi.fromRepresentation([[[Fc],[A0],[N0]],[[_s],[],[]]],6),[m2.move(new C(2,0),new C(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),W.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,fi.fromRepresentation([[[_s,Fc],[A0],[N0]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,fi.fromRepresentation([[[mu],[Fc],[_s],[Fd]],[[UL],[],[],[]]],6),[m2.move(new C(0,0),new C(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,fi.fromRepresentation([[[],[SC],[A0]],[[],[Fc],[_s]],[[Fd],[WL],[]]],6),m2.move(new C(1,0),new C(3,1)).get(),(t,n,i)=>t.equals(m2.move(new C(1,0),new C(0,1)).get())?b.failure($localize`You have not freed your queen, try again!`):b.SUCCESS,$localize`Congratulations!`),W.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,fi.fromRepresentation([[[],[EC],[WL],[_s]],[[],[],[],[N0]],[[_s],[],[],[Fd]],[[SC],[],[mu],[]],[[Fc],[UL],[],[]]],6),m2.spiderMove([new C(1,0),new C(1,1),new C(2,1),new C(2,2)]),$localize`Congratulations!`),W.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,fi.fromRepresentation([[[],[EC],[]],[[],[Fc],[_s]],[[Fd],[],[]]],6)),W.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,fi.fromRepresentation([[[_s,N0],[Fc],[A0]]],4))])}}const ldt=["app-hive-piece",""];function udt(r,e){1&r&&(A(),F(0,"path",9))}function fdt(r,e){1&r&&(A(),F(0,"path",10))}function ddt(r,e){1&r&&(A(),F(0,"path",11))}function hdt(r,e){1&r&&(A(),F(0,"path",12))}function pdt(r,e){1&r&&(A(),F(0,"path",13))}let gdt=(()=>{var r;class e extends Mae{constructor(...n){super(...n),u(this,"piece",void 0),u(this,"x",void 0),u(this,"y",void 0),u(this,"hexaLayout",void 0),u(this,"layer",void 0),u(this,"pieceHeight",void 0),u(this,"hexaPoints",""),u(this,"pieceClass",""),u(this,"isoPointsLight",""),u(this,"isoPointsDark",""),u(this,"isoPointsStroke",""),u(this,"layerTransform",""),u(this,"hexaCenter",new C(0,0))}ngAfterContentChecked(){const n=new C(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(n),this.hexaCenter=this.hexaLayout.getCenterAt(n);const o=this.hexaLayout.getIsoPoints(n,this.pieceHeight).map(s=>s.map(a=>a.toSVGPoint()).join(" "));this.isoPointsLight=o[0],this.isoPointsDark=o[1],this.isoPointsStroke=o[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}()),u(e,"\u0275cmp",je({type:r,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[Qe],attrs:ldt,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(n,i){1&n&&(A(),S(0,"g"),F(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),S(5,"g"),T(6,udt,1,0,"path",4),T(7,fdt,1,0,"path",5),T(8,ddt,1,0,"path",6),T(9,hdt,1,0,"path",7),T(10,pdt,1,0,"path",8),P()()),2&n&&(k("transform",i.layerTransform),_(1),y("ngClass",i.pieceClass),k("points",i.isoPointsLight),_(1),y("ngClass",i.pieceClass),k("points",i.isoPointsDark),_(1),k("points",i.isoPointsStroke),_(1),y("ngClass",i.pieceClass),k("points",i.hexaPoints),_(1),k("transform","translate("+i.hexaCenter.x+" "+i.hexaCenter.y+")"),_(1),y("ngIf","QueenBee"===i.piece.kind),_(1),y("ngIf","Beetle"===i.piece.kind),_(1),y("ngIf","Grasshopper"===i.piece.kind),_(1),y("ngIf","Spider"===i.piece.kind),_(1),y("ngIf","SoldierAnt"===i.piece.kind))},dependencies:[Ft,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();function mdt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"polygon",4),U("click",function(){const o=te(t).$implicit;return ne(p().selectSpace(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ye("id","space_",t.x,"_",t.y,""),y("ngClass",t.content.spaceClasses),k("points",n.getHexaPointsAtXY(t.x,t.y))}}function _dt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",6),U("click",function(){te(t);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();ye("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),k("points",n.getHexaPointsAtXY(t.x,t.y))}}function vdt(r,e){if(1&r&&(A(),S(0,"g"),T(1,_dt,1,4,"polygon",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.strokeClasses.length>0)}}function Cdt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",8),U("click",function(){te(t);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();ye("id","stroke_",t.x,"_",t.y,""),k("points",n.getHexaPointsAtXY(t.x,t.y))}}function ydt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Cdt,1,3,"polygon",7),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.selected)}}function Mdt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",9),U("click",function(){const o=te(t).$implicit;return ne(p(2).selectStack(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p().index,i=p();_(1),ye("id","piece_",t.x,"_",t.y,""),y("piece",t.content.piece)("x",t.x)("y",t.y)("pieceHeight",i.PIECE_HEIGHT)("hexaLayout",i.hexaLayout)("layer",n)}}function Edt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",6),U("click",function(){te(t);const i=p().$implicit;return ne(p(2).selectStack(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p().index,i=p();ye("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),k("transform","translate(0 "+-(n+1)*i.PIECE_HEIGHT+")")("points",i.getHexaPointsAtXY(t.x,t.y))}}function Sdt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Edt,1,5,"polygon",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.strokeClasses.length>0)}}function Pdt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Mdt,2,8,"g",1),T(2,Sdt,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t),_(1),y("ngForOf",t)}}function Tdt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",10),U("click",function(){const o=te(t).$implicit;return ne(p(2).selectRemaining(o))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);_(1),Dn("id","remainingPiece_",t.toString(),""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("layer",n)("hexaLayout",i.hexaLayout),k("transform",i.getRemainingPieceTransform(t))}}function Odt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Tdt,2,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t.pieces)}}function bdt(r,e){if(1&r&&(A(),F(0,"polygon",11)),2&r){const t=p();k("transform",t.getRemainingPieceHighlightTransform(t.selectedRemaining.get()))("points",t.getHexaPointsAt(t.ORIGIN))}}function wdt(r,e){if(1&r&&(A(),F(0,"g",13)),2&r){const t=e.$implicit,n=e.index,i=p(2);Dn("id","inspectedStack_",n,""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",i.hexaLayout)("layer",6*n),k("transform",i.inspectedStackTransform)}}function Ndt(r,e){if(1&r&&(A(),S(0,"g"),T(1,wdt,1,8,"g",12),P()),2&r){const t=p();_(1),y("ngForOf",t.inspectedStack.get().pieces.slice().reverse())}}class Ace extends Cae{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e){this.set(e,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(e,t){this.highlighted.push(e),this.get(e).map(n=>n.spaceClasses.push(t))}highlightStroke(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}select(e){this.highlighted.push(e),this.get(e).map(t=>t.selected=!0)}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[],t.spaceClasses=[],t.selected=!1});this.highlighted=[]}}class Adt extends Cae{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e,t){this.set(e,{piece:t,strokeClasses:[]})}highlight(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[]});this.highlighted=[]}}let Idt=(()=>{var r;class e extends iu{constructor(n){super(n),u(this,"ORIGIN",new C(0,0)),u(this,"remainingStacks",[]),u(this,"layers",[]),u(this,"ground",new Ace),u(this,"inspectedStack",g.empty()),u(this,"inspectedStackCoord",g.empty()),u(this,"selectedRemaining",g.empty()),u(this,"selectedStart",g.empty()),u(this,"selectedSpiderCoords",[]),u(this,"PIECE_HEIGHT",void 0),u(this,"boardViewBox",void 0),u(this,"viewBox",void 0),u(this,"inspectedStackTransform",void 0),this.rules=$2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new cdt(this.rules,"HiveMinimax")],this.encoder=m2.encoder,this.tutorial=(new Nce).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new ou(1.5*this.SPACE_SIZE,new C(2*this.SPACE_SIZE,0),Fr.INSTANCE),this.canPass=!1}updateBoard(n){var i=this;return M(function*(){i.layers=[];for(const s of i.getState().occupiedSpaces()){const a=i.getState().getAt(s),c=s.x,l=s.y;for(let f=0;f<a.size();f++){f in i.layers||(i.layers[f]=new Adt);const d=a.pieces[a.size()-1-f];i.layers[f].initialize(new C(c,l),d)}}i.ground=i.getGround(),i.computeViewBox(),i.remainingStacks=i.getState().remainingPieces.toListOfStacks(),i.canPass=$2.get().shouldPass(i.getState());const o=$2.get().getGameStatus(i.node);switch(o){case ve.ONGOING:break;case ve.DRAW:i.highlight(i.getState().queenBeeLocation(I.ZERO).get(),"victory-stroke"),i.highlight(i.getState().queenBeeLocation(I.ONE).get(),"victory-stroke");break;default:const a=o.winner.getOpponent();i.highlight(i.getState().queenBeeLocation(a).get(),"victory-stroke")}})()}highlight(n,i){const o=this.getState().getAt(n).size();o-1 in this.layers&&this.layers[o-1].highlight(n,i)}pass(){var n=this;return M(function*(){return q.assert(n.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield n.chooseMove(m2.PASS)})()}computeViewBox(){const n=this.getPieceCoords().union(this.getAllNeighbors()).toList();n.push(new C(0,0)),this.boardViewBox=c4.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH);const i=new c4(this.getRemainingPieceTransformAsCoord(new e2(I.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),o=5*this.SPACE_SIZE;let s=0;this.getState().remainingPieces.getAny(I.ZERO).isPresent()&&(s=o);let a=0;this.getState().remainingPieces.getAny(I.ONE).isPresent()&&(a=o);const c=this.boardViewBox.containingAtLeast(i).expand(0,0,s,a);if(this.inspectedStack.isPresent()){const l=new C(c.right()+this.SPACE_SIZE,c.center().y),f=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${l.x} ${l.y+3*(f-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const n=new Ace;for(const i of this.getAllNeighbors())n.initialize(i);return n}getAllNeighbors(){const n=new dt;for(const i of this.getPieceCoords())n.addAll(new dt(this.getState().emptyNeighbors(i)));return n.isEmpty()&&n.add(new C(0,0)),n}clearHighlights(){for(const n of this.layers)n.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=g.empty(),this.selectedRemaining=g.empty(),this.selectedSpiderCoords=[],this.inspectedStack=g.empty(),this.computeViewBox()}showLastMove(n){var i=this;return M(function*(){for(const o of i.getLastMoveCoords(n))i.highlight(o,"last-move-stroke"),i.ground.highlightStroke(o,"last-move-stroke"),i.ground.highlightFill(o,"moved-fill")})()}getLastMoveCoords(n){let i=[];return n instanceof Ks?i=[n.coord]:n instanceof $i&&(i=[n.getStart(),n.getEnd()]),i}getRemainingPieceTransformAsCoord(n){const i=this.getRemainingPieceShift(n),o=this.boardViewBox.center().x+i*this.SPACE_SIZE*4;let s;return s=n.owner===this.role?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new C(o,s)}getRemainingPieceTransform(n){const i=this.getRemainingPieceTransformAsCoord(n);return`translate(${i.x} ${i.y})`}getRemainingPieceHighlightTransform(n){const i=this.getRemainingPieceTransformAsCoord(n),o=this.getState().remainingPieces.getQuantity(n);return`translate(${i.x} ${i.y-this.PIECE_HEIGHT*o})`}getRemainingPieceShift(n){switch(n.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return q.expectToBe(n.kind,"SoldierAnt"),1.5}}selectRemaining(n){var i=this;return M(function*(){const o=yield i.canUserPlay(`#remainingPiece_${n.toString()}`);if(o.isFailure())return i.cancelMove(o.getReason());if(n.owner===i.getCurrentOpponent())return i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE());if("QueenBee"!==n.kind&&$2.get().mustPlaceQueenBee(i.getState()))return i.cancelMove(ur.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(i.selectedRemaining.equalsValue(n))i.cancelMoveAttempt();else{i.cancelMoveAttempt(),i.selectedRemaining=g.of(n),i.clearHighlights();const s=$2.get().getPossibleDropLocations(i.getState()).toList();for(const a of s)i.ground.highlightStroke(a,"clickable-stroke")}return b.SUCCESS})()}selectStack(n,i){var o=this;return M(function*(){return yield o.select(new C(n,i),"piece")})()}selectSpace(n,i){var o=this;return M(function*(){return yield o.select(new C(n,i),"space")})()}select(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay(`#${i}_${n.x}_${n.y}`);if(s.isFailure())return o.cancelMove(s.getReason());const a=o.getState(),c=a.getAt(n);if(o.selectedRemaining.isPresent()){const l=m2.drop(o.selectedRemaining.get(),n);return o.chooseMove(l)}if(o.selectedStart.isPresent()){const l=a.getAt(o.selectedStart.get()).topPiece();return o.selectedStart.equalsValue(n)?o.cancelMove():o.selectTarget(n,l)}return 0===c.size()?o.cancelMove():o.selectStart(n,c)})()}selectTarget(n,i){var o=this;return M(function*(){if("Spider"===i.kind)return o.selectNextSpiderSpace(n);{const s=m2.move(o.selectedStart.get(),n);return Fe(s.isSuccess(),"Hive: the only forbidden moves are static moves"),o.chooseMove(s.get())}})()}selectStart(n,i){var o=this;return M(function*(){const s=o.getState(),a=i.topPiece();return a.owner===s.getCurrentOpponent()?1===i.size()?o.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):o.inspectedStack.isPresent()?(o.cancelMoveAttempt(),o.clearHighlights(),b.SUCCESS):(o.highlight(n,"selected-stroke"),o.inspectedStack=g.of(i),o.inspectedStackCoord=g.of(n),o.computeViewBox(),b.SUCCESS):(o.cancelMoveAttempt(),o.clearHighlights(),"QueenBee"!==a.kind&&$2.get().mustPlaceQueenBee(s)?o.cancelMove(ur.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(o.selectedStart=g.of(n),o.highlight(n,"selected-stroke"),"Spider"===a.kind&&o.selectedSpiderCoords.push(o.selectedStart.get()),i.size()>1&&(o.inspectedStack=g.of(i),o.inspectedStackCoord=g.of(n),o.computeViewBox()),o.highlightNextPossibleCoords(n),b.SUCCESS))})()}highlightNextPossibleCoords(n){for(const i of this.getNextPossibleCoords(n))this.highlight(i,"clickable-stroke"),this.ground.highlightStroke(i,"clickable-stroke")}getNextPossibleCoords(n){const i=this.getState(),o=i.getAt(n).topPiece(),s=$2.get().getPossibleMovesFrom(i,n);return"Spider"===o.kind?s.filter(c=>Re.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():s.map(a=>a.getEnd()).toList()}selectNextSpiderSpace(n){var i=this;return M(function*(){if(i.selectedSpiderCoords.push(n),4===i.selectedSpiderCoords.length){const s=m2.spiderMove(i.selectedSpiderCoords);return i.chooseMove(s)}const o=Hd.get().prefixLegality(i.selectedSpiderCoords,i.getState());if(o.isFailure())return i.cancelMove(o.getReason());i.clearHighlights(),i.highlight(i.selectedStart.get(),"selected-stroke");for(const s of i.selectedSpiderCoords)i.ground.select(s);return i.highlightNextPossibleCoords(i.selectedStart.get()),b.SUCCESS})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-hive"]],features:[Qe],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,mdt,2,4,"g",1),T(2,vdt,2,1,"g",1),T(3,ydt,2,1,"g",1),T(4,Pdt,3,2,"g",1),T(5,Odt,2,1,"g",1),T(6,bdt,1,2,"polygon",2),T(7,Ndt,2,1,"g",3),P()),2&n&&(k("viewBox",i.viewBox),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.layers),_(1),y("ngForOf",i.remainingStacks),_(1),y("ngIf",i.selectedRemaining.isPresent()),_(1),y("ngIf",i.inspectedStack.isPresent()))},dependencies:[Ft,Wt,Nt,gdt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const kdt={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:I.ZERO};class $c extends NL{static getInitialState(){const e=on.UNOCCUPIED,t=on.INVADERS,n=on.DEFENDERS;return new $c([[e,e,e,t,t,t,t,t,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,n,e,e,e,e,t],[t,e,e,e,n,n,n,e,e,e,t],[t,t,e,n,n,on.PLAYER_ONE_KING,n,n,e,t,t],[t,e,e,e,n,n,n,e,e,e,t],[t,e,e,e,e,n,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,t,t,t,t,t,e,e,e]],0)}of(e,t){return new $c(e,t)}}class _o extends wL{static of(e,t){return new _o(e,t)}static from(e,t){try{const n=new _o(e,t);return ie.success(n)}catch(n){return ie.failure(n.message)}}getMaximalDistance(){return 11}}u(_o,"encoder",Ho.getFallibleEncoder(_o.from));class wl extends AL{static get(){return wl.singleton.isAbsent()&&(wl.singleton=g.of(new wl)),wl.singleton.get()}constructor(){super($c,kdt,_o.from)}}u(wl,"singleton",g.empty());const N=on.UNOCCUPIED,At=on.INVADERS,fr=on.DEFENDERS,PC=on.PLAYER_ONE_KING;class kce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,$c.getInitialState()),W.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,$c.getInitialState(),_o.of(new C(5,1),new C(1,1)),$localize`Congratulations!`),W.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new $c([[N,N,N,N,At,At,At,At,N,N,N],[N,N,N,N,N,At,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[At,N,N,N,N,fr,N,N,N,N,At],[At,N,N,At,fr,fr,fr,N,N,N,At],[At,At,N,fr,fr,PC,fr,fr,N,At,At],[At,N,N,N,fr,fr,fr,N,N,N,At],[At,N,N,N,N,fr,N,N,N,N,At],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,At,N,N,N,N,N],[N,N,N,At,At,At,At,At,N,N,N]],1),[_o.of(new C(5,3),new C(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(_o.of(new C(3,0),new C(3,4))),W.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new $c([[N,N,N,At,At,At,At,At,N,N,N],[N,fr,N,N,N,At,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,fr,N,N,N,N,At],[At,N,N,N,N,fr,fr,N,N,N,At],[At,At,PC,N,fr,N,fr,fr,N,N,At],[N,N,At,N,N,fr,fr,N,N,N,At],[At,N,N,N,N,fr,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,At,N,N,N,N,N,N,N,N,N],[N,N,N,At,At,At,At,N,At,N,N]],12),[_o.of(new C(3,0),new C(3,5)),_o.of(new C(3,10),new C(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),W.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new $c([[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,At,N,N,N,N,N,N,N,N,N],[At,PC,N,At,N,N,N,N,N,N,N],[N,At,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N]],72),[_o.of(new C(3,4),new C(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),W.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new $c([[N,N,At,PC,At,N,N,N,N,N,N],[N,N,N,N,N,N,fr,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,At,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N]],72),[_o.of(new C(3,3),new C(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function xdt(r,e){1&r&&(A(),F(0,"polygon",8))}function Ldt(r,e){1&r&&(A(),F(0,"rect",9))}function Rdt(r,e){if(1&r&&(A(),S(0,"g"),T(1,xdt,1,0,"polygon",6),T(2,Ldt,1,0,"ng-template",null,7,dn),P()),2&r){const t=ln(3),n=p().index,i=p().index,o=p();_(1),y("ngIf",o.isCentralThrone(n,i))("ngIfElse",t)}}function zdt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Ddt(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function Hdt(r,e){if(1&r&&(A(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function Vdt(r,e){if(1&r&&(A(),T(0,Ddt,1,1,"polyline",14),T(1,Hdt,4,20,"ng-template",null,15,dn)),2&r){const t=ln(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function Fdt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",10),T(2,zdt,6,25,"g",11),T(3,Vdt,3,2,"ng-template",null,12,dn),P()),2&r){const t=ln(4),n=p().index,i=p().index,o=p();_(1),ye("id","piece_",n,"_",i,""),y("ngClass",o.viewInfo.pieceClasses[i][n]),k("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),_(1),y("ngIf",o.isInvader(n,i))("ngIfElse",t)}}function $dt(r,e){if(1&r){const t=pe();A(),S(0,"g",3),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),F(1,"rect",4),T(2,Rdt,4,2,"g",5),T(3,Fdt,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),k("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function Bdt(r,e){if(1&r&&(A(),S(0,"g"),T(1,$dt,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Gdt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",17),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ye("id","click_",t.x,"_",t.y,""),k("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let Udt=(()=>{var r;class e extends IL{constructor(n){super(n,_o.from),this.rules=wl.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=this.createMinimaxes(),this.encoder=_o.encoder,this.tutorial=(new kce).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-hnefatafl"]],features:[Qe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,Bdt,2,1,"g",1),T(2,Gdt,2,6,"g",1),P()),2&n&&(k("viewBox",i.getViewBox()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Wdt extends Lae{constructor(e,t){super(e,t)}updateOrCreateCurrentMove(e){if(this.currentMove.isAbsent())this.hideLastMove(),this.currentMove=g.of(this.generateMove(e));else{const t=this.addToMove(e);this.currentMove=g.of(t)}}}class l4 extends ho{static get(){return l4.singleton.isAbsent()&&(l4.singleton=g.of(new l4)),l4.singleton.get()}constructor(){super({passByPlayerStore:!0,mustFeed:!1,feedOriginalHouse:!0})}isLegal(e,t){const n=t.getCurrentPlayerY();let i=!0;for(const o of e){q.assert(!0===i,"CANNOT_PLAY_AFTER_NON_KALAH_MOVE");const s=this.isLegalDistribution(o,t);if(s.isFailure())return b.ofFallible(s);t=this.distributeHouse(o.x,n,t).resultingState,i=s.get()}return q.assert(!1===i,"MUST_CONTINUE_PLAYING_AFTER_KALAH_MOVE"),b.SUCCESS}isLegalDistribution(e,t){const n=t.getCurrentPlayerY();if(0===t.getPieceAtXY(e.x,n))return ie.failure(au.MUST_CHOOSE_NON_EMPTY_HOUSE());const i=this.distributeHouse(e.x,n,t),o=ho.isStarving(i.resultingState.getCurrentPlayer(),i.resultingState.board);return ie.success(i.endsUpInKalah&&!1===o)}distributeMove(e,t){const n=t.getCurrentPlayer().value,i=t.getCurrentPlayerY(),o=[];let s=0,a=!1,c=t;for(const d of e){const m=this.distributeHouse(d.x,i,c);c.getScoresCopy()[n]+=m.passedByKalahNTimes,c=m.resultingState,o.push(...m.filledCoords),s+=m.passedByKalahNTimes,a=m.endsUpInKalah}const l=c.getScoresCopy();return l[n]+=s,{endsUpInKalah:a,filledCoords:o,passedByKalahNTimes:s,resultingState:new _n(c.getCopiedBoard(),c.turn,l)}}applyCapture(e){const t=e.resultingState,n={capturedSum:0,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]],resultingState:t};if(e.endsUpInKalah)return n;{const i=e.filledCoords[e.filledCoords.length-1],o=e.resultingState.getCurrentPlayerY(),s=e.resultingState.getOpponentY(),a=e.resultingState.getPieceAt(i),c=e.resultingState.getPieceAtXY(i.x,s);if(i.y===o&&1===a&&c>0){const l=t.getCopiedBoard(),f=l[0][i.x]+l[1][i.x],d=Re.createTable(_n.WIDTH,2,0);d[0][i.x]=l[0][i.x],d[1][i.x]=l[1][i.x],l[0][i.x]=0,l[1][i.x]=0;const m=t.getScoresCopy();return m[t.getCurrentPlayer().value]+=f,{capturedSum:f,captureMap:d,resultingState:new _n(l,t.turn,m)}}return n}}}var xce;u(l4,"singleton",g.empty());class Qs extends Nae{static of(e,t=[]){const n=[e];return n.push(...t),new Qs(n)}add(e){return Qs.of(this.distributions[0],this.distributions.slice(1).concat(e))}toString(){return"KalahMove(["+this.distributions.map(t=>t.x).join(", ")+"])"}equals(e){return Re.compareArray(this.distributions,e.distributions)}}xce=Qs,u(Qs,"encoder",we.tuple([we.list(l1.encoder)],r=>[r.distributions],r=>xce.of(r[0][0],r[0].slice(1))));class qdt extends Sr{constructor(){super(l4.get(),"Dummy Minimax")}getMetrics(e){return e.gameState.getScoresCopy()}getListMoves(e){const t=[],n=e.gameState.getCurrentPlayerY();for(let i=0;i<_n.WIDTH;i++)if(e.gameState.getPieceAtXY(i,n)>0){const o=e.gameState,s=Qs.of(l1.of(i));t.push(...this.getPossibleMoveContinuations(o,i,n,s))}return t}getPossibleMoveContinuations(e,t,n,i){const o=[],s=this.ruler.distributeHouse(t,n,e),a=s.resultingState,c=!1===ho.isStarving(a.getCurrentPlayer(),a.board);if(s.endsUpInKalah&&c){for(let l=0;l<_n.WIDTH;l++)if(a.getPieceAtXY(l,n)>0){const f=i.add(l1.of(l));o.push(...this.getPossibleMoveContinuations(a,l,n,f))}return o}return[i]}}class Lce extends Zn{constructor(...e){super(...e),u(this,"gameName",$localize`Kalah`),u(this,"tutorial",[W.informational(this.gameName,$localize`${this.gameName} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player won. As you are playing Dark, the 6 houses on the bottom are yours.`,_n.getInitialState()),W.informational($localize`Kalah`,$localize`Bonus fact: Kalah has been created in the U.S.A in 1940 by William Julius Champion Jr.`,_n.getInitialState()),Aae.SOWING(Qs.of(l1.FIVE)),W.forClick($localize`The Kalah (1/2)`,$localize`The houses on the extreme left and right, unaligned with the others, are the Kalah. Yours is on the left, the opponent's on the right. When sowing, before passing from your last house to the first of the opponent, you must drop one seed in your Kalah, but you won't have to drop seed in your opponent's Kalah. When you make a capture, the captured seeds are put in your Kalah.<br/><br/>You're playing Dark. Make a move that passes through your Kalah then feeds opponent's houses.`,_n.getInitialState(),["#click_0_1","#click_1_1","#click_2_1"],$localize`As you see, three houses have been fed in addition to your Kalah.`,$localize`Failed. Choose the three leftmost house on the bottom.`),W.fromPredicate($localize`The Kalah (2/2)`,$localize`When ending in the Kalah, you must distribute again.<br/><br/>You're playing Dark, play the house that ends up in the Kalah then do a second distribution!`,_n.getInitialState(),Qs.of(l1.THREE,[l1.ONE]),(t,n,i)=>1===t.distributions.length?b.failure($localize`This move only distributed one house, do one distribution that ends in the Kalah, then do a second one!`):b.SUCCESS,$localize`Congratulations!`),W.fromPredicate($localize`Capture`,$localize`When the last seed of a distribution ends up in one of your empty houses, if the opposite house is filled, then you capture both houses. On this board, such a move is possible.<br/><br/>You're playing Dark, do a capture!`,new _n([[0,4,4,4,4,4],[0,2,0,2,4,0]],4,[0,0]),Qs.of(l1.ONE,[l1.ZERO,l1.THREE]),(t,n,i)=>0===i.getPieceAtXY(1,0)?b.SUCCESS:b.failure($localize`You did not capture, try again!`),$localize`Congratulations!`),W.fromMove($localize`End of the game`,$localize`At any moment, when one player has more than 24 seeds in their Kalah, they win. That can happen before the board is empty, but, there is also a second way. When you don't have any seed in your houses, the game is over and your opponent takes all the remaining seeds from their houses. Here, your opponent just need one more point to win and will get it next turn if you allow it.<br/><br/>You're playing Dark, win!`,new _n([[0,0,0,0,2,0],[2,0,0,0,0,1]],0,[19,24]),[Qs.of(l1.FIVE)],$localize`Since there is no longer seeds in the opponent houses, all your seeds have been captured by you. Congratulations, you won!`,$localize`Failed, you gave the opponent a seed! Try again.`)])}}function jdt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",8),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),ye("id","click_",n,"_",i,""),y("x",n)("y",i)("content",t)("spaceClasses",o.getSpaceClasses(n,i))("rotation",o.getPieceRotation())("secondaryContent",o.getHouseSecondaryContent(n,i)),k("transform",o.getPieceTransform(n,i))}}function Zdt(r,e){if(1&r&&(A(),S(0,"g"),T(1,jdt,2,9,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let Ydt=(()=>{var r;class e extends Wdt{constructor(n,i){super(n,i),this.rules=l4.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new qdt],this.encoder=Qs.encoder,this.tutorial=(new Lce).tutorial}generateMove(n){return Qs.of(l1.of(n))}addToMove(n){return this.currentMove.get().add(l1.of(n))}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut),G(y3))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-kalah-component"]],features:[Qe],decls:8,vars:14,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 870 250","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","width","860","height","240","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","x2","740","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["x1","740","y1","0","x2","740","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","","transform","translate(800 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),F(1,"rect",1),T(2,Zdt,2,1,"g",2),F(3,"line",3)(4,"line",4)(5,"line",5),S(6,"g",6),U("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),S(7,"g",7),U("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(k("transform",i.rotation),_(2),y("ngForOf",i.board),_(4),y("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),_(1),y("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)))},dependencies:[Wt,Rae],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"],changeDetection:0})),e})();var Bc,TC,qL,_2;class yn{static of(e){switch(e){case 0:return yn.ANY;case 1:return yn.ORANGE;case 2:return yn.BLUE;case 3:return yn.PURPLE;case 4:return yn.PINK;case 5:return yn.YELLOW;case 6:return yn.RED;case 7:return yn.GREEN;default:return q.expectToBe(e,8,"Invalid value "+e+" for KamisadoColor"),yn.BROWN}}constructor(e,t,n){u(this,"value",void 0),u(this,"name",void 0),u(this,"rgb",void 0),this.value=e,this.name=t,this.rgb=n}}u(yn,"ANY",new(Bc=yn)(0,"any","#000")),u(yn,"ORANGE",new Bc(1,"orange","#d67421")),u(yn,"BLUE",new Bc(2,"blue","#006bac")),u(yn,"PURPLE",new Bc(3,"purple","#6f3787")),u(yn,"PINK",new Bc(4,"pink","#d2719e")),u(yn,"YELLOW",new Bc(5,"yellow","#e2c200")),u(yn,"RED",new Bc(6,"red","#d23339")),u(yn,"GREEN",new Bc(7,"green","#009157")),u(yn,"BROWN",new Bc(8,"brown","#562500"));class gn{constructor(e,t){u(this,"player",void 0),u(this,"color",void 0),this.player=e,this.color=t}static of(e,t){return new gn(e,yn.of(t))}static createPlayerColors(e){return{ORANGE:new gn(e,yn.ORANGE),BLUE:new gn(e,yn.BLUE),PURPLE:new gn(e,yn.PURPLE),PINK:new gn(e,yn.PINK),YELLOW:new gn(e,yn.YELLOW),RED:new gn(e,yn.RED),GREEN:new gn(e,yn.GREEN),BROWN:new gn(e,yn.BROWN)}}equals(e){return e.player===this.player&&e.color===this.color}isEmpty(){return this.player.equals(K.NONE)}belongsTo(e){return this.player===e}}u(gn,"EMPTY",new(TC=gn)(K.NONE,yn.ANY)),u(gn,"ZERO",TC.createPlayerColors(I.ZERO)),u(gn,"ONE",TC.createPlayerColors(I.ONE));class di{static getColorAt(e,t){return di.COLORS[t][e]}static getInitialBoard(){const e=gn.EMPTY;return[[1,2,3,4,5,6,7,8].map(t=>gn.of(I.ONE,t)),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(t=>gn.of(I.ZERO,t))]}static isEmptyAt(e,t){return e[t.y][t.x].equals(gn.EMPTY)}static allPieceCoords(e){const t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++){const o=new C(i,n);!1===di.isEmptyAt(e,o)&&t.push(o)}return t}}u(di,"INITIAL",di.getInitialBoard()),u(di,"SIZE",8),u(di,"COLORS",Re.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],yn.of));class Js extends B1{static isOnBoard(e){return e.isInRange(di.SIZE,di.SIZE)}static getInitialState(){return new Js(0,yn.ANY,g.empty(),!1,di.INITIAL)}constructor(e,t,n,i,o){super(Re.copyBiArray(o),e),u(this,"colorToPlay",void 0),u(this,"coordToPlay",void 0),u(this,"alreadyPassed",void 0),this.colorToPlay=t,this.coordToPlay=n,this.alreadyPassed=i}}class _u extends Ri{constructor(){super()}length(){return 0}equals(e){return this===e}toString(){return"KamisadoMove(PASS)"}}u(_u,"PASS",new(qL=_u)),u(_u,"encoder",we.constant("PASS",qL.PASS));class I0 extends Fs{static of(e,t){return q.assert(Js.isOnBoard(e),"Starting coord of KamisadoMove must be on the board, not at "+e.toString()),q.assert(Js.isOnBoard(t),"End coord of KamisadoMove must be on the board, not at "+t.toString()),new I0(e,t)}constructor(e,t){super(e,t)}equals(e){return e===this||!!_2.isPiece(e)&&!1!==e.getStart().equals(this.getStart())&&e.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}function Kdt(r){return r instanceof _u}u(I0,"encoder",Ho.getEncoder(I0.of)),function(r){r.PASS=_u.PASS,r.of=function e(n,i){return I0.of(n,i)},r.isPiece=function t(n){return n instanceof I0},r.encoder=we.disjunction([r.isPiece,Kdt],[I0.encoder,_u.encoder])}(_2||(_2={}));let $d=(()=>{class r{}return u(r,"NOT_RIGHT_COLOR",()=>$localize`This piece is not of the color you have to play.`),u(r,"DIRECTION_NOT_ALLOWED",()=>$localize`You can only move forward, orthogonally or diagonally.`),u(r,"MOVE_BLOCKED",()=>$localize`This move is blocked by another piece.`),u(r,"PLAY_WITH_SELECTED_PIECE",()=>$localize`You must play with the selected piece.`),r})();class v2 extends Yn{static get(){return v2.singleton.isAbsent()&&(v2.singleton=g.of(new v2)),v2.singleton.get()}constructor(){super(Js)}static getColorMatchingPiece(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new C(0,7),new C(1,7),new C(2,7),new C(3,7),new C(4,7),new C(5,7),new C(6,7),new C(7,7)]}static getMovablePieces(e){return v2.getColorMatchingPiece(e).filter(t=>{for(const n of this.playerDirections(e.getCurrentPlayer())){const i=t.getNext(n);if(e.isOnBoard(i)&&di.isEmptyAt(e.board,i))return!0}return!1})}static playerDirections(e){return e===I.ONE?[Me.DOWN,Me.DOWN_LEFT,Me.DOWN_RIGHT]:[Me.UP,Me.UP_LEFT,Me.UP_RIGHT]}static directionAllowedForPlayer(e,t){return t===I.ZERO?e.y<0:e.y>0}static getListMovesFromState(e){const t=v2.getMovablePieces(e);return 0===t.length?(Fe(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[_2.PASS]):v2.getListMovesFromNonBlockedState(e,t)}static getListMovesFromNonBlockedState(e,t){const n=[],i=e.getCurrentPlayer();for(const o of t)for(const s of v2.playerDirections(i))for(let a=1;a<di.SIZE;a++){const c=o.getNext(s,a);if(!e.isOnBoard(c)||!di.isEmptyAt(e.board,c))break;{const l=_2.of(o,c);n.push(l)}}return n}static mustPass(e){return 0===this.getMovablePieces(e).length}static getFurthestPiecePositions(e){let t=7,n=0;return di.allPieceCoords(e.board).forEach(i=>{const o=e.getPieceAt(i);Fe(o!==gn.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),o.player===I.ONE?n=Math.max(n,i.y):t=Math.min(t,i.y)}),[t,n]}static isLegal(e,t){if(_2.isPiece(e)){const n=e.getStart(),i=e.getEnd(),o=t.colorToPlay,s=t.getPieceAt(n);if(!1===s.belongsTo(t.getCurrentPlayer()))return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(o!==yn.ANY&&s.color!==o)return b.failure($d.NOT_RIGHT_COLOR());if(!1===t.getPieceAt(i).isEmpty())return b.failure(Le.MUST_CLICK_ON_EMPTY_SPACE());const c=Me.factory.fromMove(n,i);if(c.isFailure())return b.failure($d.DIRECTION_NOT_ALLOWED());const l=c.get();if(!1===v2.directionAllowedForPlayer(l,t.getCurrentPlayer()))return b.failure($d.DIRECTION_NOT_ALLOWED());let f=n;for(;!1===f.equals(i);)if(f=f.getNext(l),!1===t.getPieceAt(f).isEmpty())return b.failure($d.MOVE_BLOCKED());return b.SUCCESS}return this.isLegalPass(t)}static isLegalPass(e){return this.mustPass(e)&&!1===e.alreadyPassed?b.SUCCESS:b.failure(Le.CANNOT_PASS())}nextCoordToPlay(e,t){return g.ofNullable(di.allPieceCoords(e.board).find(n=>{const i=e.getPieceAt(n);return i.player===e.getCurrentOpponent()&&i.color===t}))}applyLegalMove(e,t,n){if(_2.isPiece(e)){const i=e.getStart(),o=e.getEnd(),s=t.getCopiedBoard();s[o.y][o.x]=s[i.y][i.x],s[i.y][i.x]=gn.EMPTY;const a=di.getColorAt(o.x,o.y),c=this.nextCoordToPlay(t,a);return new Js(t.turn+1,a,c,!1,s)}{const i=this.nextCoordToPlay(t,t.colorToPlay);return new Js(t.turn+1,t.colorToPlay,i,!0,t.board)}}isLegal(e,t){return v2.isLegal(e,t)}getGameStatus(e){const t=e.gameState,n=t.getCurrentPlayer();if(v2.mustPass(t)&&t.alreadyPassed)return ve.getDefeat(n);const[i,o]=v2.getFurthestPiecePositions(t);return 7===o?ve.ONE_WON:0===i?ve.ZERO_WON:ve.ONGOING}}u(v2,"singleton",g.empty());class Xdt extends Sr{getListMoves(e){const t=v2.getListMovesFromState(e.gameState);return Re.sortByDescending(t,n=>n.length()),t}getMetrics(e){const t=e.gameState,[n,i]=v2.getFurthestPiecePositions(t);return[7-n,i]}}const Y=gn.EMPTY,OC=gn.ZERO.ORANGE,bC=gn.ONE.ORANGE,wC=gn.ZERO.BLUE,NC=gn.ONE.BLUE,jL=gn.ZERO.PURPLE,Bd=gn.ONE.PURPLE,AC=gn.ZERO.PINK,IC=gn.ONE.PINK,kC=gn.ZERO.YELLOW,xC=gn.ONE.YELLOW,LC=gn.ZERO.RED,RC=gn.ONE.RED,zC=gn.ZERO.GREEN,DC=gn.ONE.GREEN,HC=gn.ZERO.BROWN,VC=gn.ONE.BROWN;class Dce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new Js(5,yn.ORANGE,g.empty(),!1,[[HC,NC,Bd,IC,xC,RC,DC,VC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,bC,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,zC,LC,kC,AC,jL,wC,OC]])).withPreviousMove(_2.of(new C(0,7),new C(0,0))),W.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,Js.getInitialState(),_2.of(new C(7,7),new C(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),W.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new Js(1,yn.PINK,g.of(new C(3,0)),!1,[[bC,NC,Bd,IC,xC,RC,DC,VC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,wC,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[HC,zC,LC,kC,AC,jL,Y,OC]]),[_2.of(new C(3,0),new C(3,6)),_2.of(new C(3,0),new C(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(_2.of(new C(6,7),new C(6,5))),W.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new Js(1,yn.PINK,g.of(new C(3,6)),!1,[[bC,NC,Bd,Y,xC,RC,DC,VC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,wC],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,IC,Y,Y,Y,Y],[HC,zC,LC,kC,AC,jL,Y,OC]])).withPreviousMove(_2.of(new C(6,5),new C(7,4))),W.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new Js(2,yn.RED,g.of(new C(2,4)),!1,[[Y,NC,Bd,Y,Y,RC,Y,Y],[Y,Y,Y,xC,Y,Y,Y,Y],[Y,Y,Y,IC,Y,Bd,Y,Y],[Y,Y,Y,kC,Y,Y,Y,Y],[Y,Y,LC,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,DC,Y],[bC,Y,Y,Y,Y,AC,Y,VC],[HC,zC,Y,Y,Y,Y,wC,OC]]),[_2.of(new C(2,4),new C(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(_2.of(new C(4,0),new C(3,1)))])}}function Qdt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p(),n=t.$implicit,i=t.index,o=p().index,s=p();y("ngClass",s.piecePlayerClass(n)),k("cx",s.SPACE_SIZE/2+i*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+o*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function Jdt(r,e){if(1&r&&(A(),F(0,"rect",9)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();k("x",s.SPACE_SIZE/2+n*s.SPACE_SIZE-s.SPACE_SIZE/8)("y",s.SPACE_SIZE/2+o*s.SPACE_SIZE-s.SPACE_SIZE/8)("rx",s.isPlayerZero(i)?s.SPACE_SIZE:0)("ry",s.isPlayerZero(i)?s.SPACE_SIZE:0)("width",s.SPACE_SIZE/4)("height",s.SPACE_SIZE/4)("fill",s.pieceColor(i))}}function eht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",4),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),F(2,"rect",5),T(3,Qdt,1,4,"circle",6),T(4,Jdt,1,7,"rect",7),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),ye("id","click_",n,"_",i,""),_(1),k("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(n,i)),_(1),y("ngIf",t!==o.UNOCCUPIED),_(1),y("ngIf",t!==o.UNOCCUPIED)}}function tht(r,e){if(1&r&&(A(),S(0,"g"),T(1,eht,5,9,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function nht(r,e){if(1&r&&(A(),S(0,"g"),F(1,"rect",10)(2,"rect",10),P()),2&r){const t=p();_(1),ye("id","last_move_start_",t.lastPieceMove.get().getStart().x,"_",t.lastPieceMove.get().getStart().y,""),k("x",t.lastPieceMove.get().getStart().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getStart().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),ye("id","last_move_start_",t.lastPieceMove.get().getEnd().x,"_",t.lastPieceMove.get().getEnd().y,""),k("x",t.lastPieceMove.get().getEnd().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getEnd().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function rht(r,e){if(1&r&&(A(),F(0,"circle",11)),2&r){const t=p();k("cx",t.SPACE_SIZE/2+t.chosen.get().x*t.SPACE_SIZE)("cy",t.SPACE_SIZE/2+t.chosen.get().y*t.SPACE_SIZE)("r",t.SPACE_SIZE/2-t.STROKE_WIDTH)}}let iht=(()=>{var r;class e extends Vi{constructor(n){super(n),u(this,"UNOCCUPIED",gn.EMPTY),u(this,"lastMove",g.empty()),u(this,"lastPieceMove",g.empty()),u(this,"chosen",g.empty()),u(this,"chosenAutomatically",!1),this.hasAsymmetricBoard=!0,this.rules=v2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Xdt(this.rules,"KamisadoMinimax")],this.encoder=_2.encoder,this.tutorial=(new Dce).tutorial,this.canPass=!1}backgroundColor(n,i){return di.getColorAt(n,i).rgb}isPlayerZero(n){return n.player===I.ZERO}pieceColor(n){return n.color.rgb}piecePlayerClass(n){return this.getPlayerClass(n.player)}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.getCopiedBoard(),i.lastPieceMove=g.empty(),i.canPass=v2.mustPass(o);const s=i.rules.getGameStatus(i.node)!==ve.ONGOING;i.canPass||o.coordToPlay.isAbsent()||s?(i.chosenAutomatically=!1,i.chosen=g.empty()):(i.chosenAutomatically=!0,i.chosen=o.coordToPlay)})()}showLastMove(n){var i=this;return M(function*(){_2.isPiece(n)&&(i.lastPieceMove=g.of(n))})()}pass(){var n=this;return M(function*(){return Fe(n.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),n.chooseMove(_2.PASS)})()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new C(n,i);if(o.canPass)return o.cancelMove(Le.MUST_PASS());if(o.chosen.isAbsent())return o.choosePiece(n,i);if(!1===o.chosenAutomatically&&o.chosen.equalsValue(a))return o.cancelMoveAttempt(),b.SUCCESS;{const c=o.getState().getPieceAtXY(n,i),l=o.getState().getCurrentPlayer();return c.belongsTo(l)?o.chosenAutomatically?o.cancelMove($d.PLAY_WITH_SELECTED_PIECE()):(o.chosen=g.of(a),b.SUCCESS):yield o.chooseDestination(n,i)}})()}choosePiece(n,i){var o=this;return M(function*(){const s=o.getState().getPieceAtXY(n,i),a=o.getState().getCurrentOpponent();return s.belongsTo(a)?o.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(o.chosen=g.of(new C(n,i)),b.SUCCESS)})()}chooseDestination(n,i){var o=this;return M(function*(){const s=o.chosen.get(),a=new C(n,i),c=_2.of(s,a);return o.chooseMove(c)})()}cancelMoveAttempt(){!1===this.chosenAutomatically&&(this.chosen=g.empty())}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-kamisado"]],features:[Qe],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,tht,2,1,"g",1),T(2,nht,3,12,"g",2),T(3,rht,1,3,"circle",3),P()),2&n&&(k("viewBox",i.getViewBox())("transform",i.rotation),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.lastPieceMove.isPresent()),_(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Hce=(()=>{var r;class e extends Vi{getParallelogramCoords(n){const i=n.parallelogramHeight,o=i*n.horizontalWidthRatio,s=i*n.offsetRatio,a=o,l=o-s,f=i,d=-s,m=i;return[new C(0,0),new C(a,0),new C(l,f),new C(d,m)]}getCoordTranslate(n,i,o,s){const a=s.parallelogramHeight;return new C(n*(a*s.horizontalWidthRatio)+s.offsetRatio*a*(s.abstractBoardSize-i),i*a-s.pieceHeightRatio*a*o)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ir(r)))(i||r)}}()),u(e,"\u0275cmp",je({type:r,selectors:[["ng-component"]],features:[Qe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),u4=(()=>{class r{}return u(r,"CANNOT_GO_BACKWARD",()=>$localize`You cannot go backward with normal pieces!`),u(r,"CANNOT_CAPTURE_EMPTY_SPACE",()=>$localize`You cannot capture an empty square, nor jump over it!`),u(r,"CANNOT_SKIP_CAPTURE",()=>$localize`You must capture when it is possible!`),u(r,"MUST_FINISH_CAPTURING",()=>$localize`You must finish this capture!`),u(r,"THIS_PIECE_CANNOT_MOVE",()=>$localize`This piece cannot move!`),u(r,"CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL",()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`),u(r,"MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL",()=>$localize`You must move in a single diagonal step!`),u(r,"CANNOT_CAPTURE_TWICE_THE_SAME_COORD",()=>$localize`You cannot jump over the same square several times!`),r})();var Gd;class B2{static getPlayerOfficer(e){return e===I.ZERO?B2.ZERO_OFFICER:B2.ONE_OFFICER}constructor(e,t){u(this,"player",void 0),u(this,"isOfficer",void 0),this.player=e,this.isOfficer=t}toString(){switch(this){case B2.ZERO:return"u";case B2.ONE:return"v";case B2.ZERO_OFFICER:return"O";default:return q.expectToBe(this,B2.ONE_OFFICER),"X"}}equals(e){return this===e}}u(B2,"ZERO",new(Gd=B2)(I.ZERO,!1)),u(B2,"ONE",new Gd(I.ONE,!1)),u(B2,"ZERO_OFFICER",new Gd(I.ZERO,!0)),u(B2,"ONE_OFFICER",new Gd(I.ONE,!0));class vo{constructor(e){u(this,"pieces",void 0),this.pieces=e}isEmpty(){return 0===this.pieces.length}isCommandedBy(e){return!this.isEmpty()&&this.getCommander().player===e}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new vo(this.pieces.slice(1))}capturePiece(e){return new vo(this.pieces.concat(e))}addStackBelow(e){let t=this;for(const n of e.pieces)t=t.capturePiece(n);return t}getStackSize(){return this.pieces.length}promoteCommander(){let e=this.getCommander();if(e.isOfficer)return this;{e=B2.getPlayerOfficer(e.player);const t=this.getPiecesUnderCommander();return new vo([e]).addStackBelow(t)}}get(e){return this.pieces[e]}toString(e){let t=e-this.getStackSize(),n="";for(;t>0;)n+="_",t--;for(const i of this.pieces)n+=i.toString();return n}}u(vo,"EMPTY",new vo([]));let h1=(()=>{class r extends B1{static getInitialState(){const t=new vo([B2.ZERO]),n=new vo([B2.ONE]),i=vo.EMPTY;return new r([[n,i,n,i,n,i,n],[i,n,i,n,i,n,i],[n,i,n,i,n,i,n],[i,i,i,i,i,i,i],[t,i,t,i,t,i,t],[i,t,i,t,i,t,i],[t,i,t,i,t,i,t]],0)}static of(t,n){return new r(t,n)}static isNotOnBoard(t){return t.isNotInRange(r.SIZE,r.SIZE)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}getStacksOf(t){const n=[];for(let i=0;i<r.SIZE;i++)for(let o=0;o<r.SIZE;o++)this.getPieceAtXY(o,i).isCommandedBy(t)&&n.push(new C(o,i));return n}set(t,n){const i=this.getCopiedBoard();return i[t.y][t.x]=n,new r(i,this.turn)}remove(t){return this.set(t,vo.EMPTY)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(t){return t===I.ZERO?0:r.SIZE-1}toString(){let t=1;for(let i=0;i<r.SIZE;i++)for(let o=0;o<r.SIZE;o++){const s=this.getPieceAtXY(o,i).getStackSize();t=Math.max(t,s)}const n=[];for(let i=0;i<r.SIZE;i++){const o=[];for(let s=0;s<r.SIZE;s++)o.push(this.getPieceAtXY(s,i).toString(t));n.push(o.join(" "))}return n.join("\n")}}return u(r,"SIZE",7),r})();class oht extends dt{equals(e){if(e.size()!==this.size())return!1;for(let t=0;t<this.size();t++)if(!1===zs(e.get(t),this.get(t)))return!1;return!0}get(e){return q.assert(e<this.values.length,"MGPUniqueList: index out of bounds: "+e),this.values[e]}getFromEnd(e){return q.assert(e<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+e),this.get(this.values.length-1-e)}}var Fce;class Br extends Ri{static of(e,t){return new Br(e,t)}static fromCapture(e){const t=Br.getSteppedOverCoords(e);return t.isSuccess()?ie.success(new Br(e,!1)):ie.failure(t.getReason())}static getSteppedOverCoords(e){let t=g.empty();const n=new dt;for(const i of e){if(h1.isNotOnBoard(i))return ie.failure(ru.OUT_OF_RANGE(i));if(t.isPresent()){const o=t.get();if(!1===o.getVectorToward(i).isDiagonalOfLength(2))return ie.failure(u4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const a=o.getCoordsToward(i)[0];if(n.contains(a))return ie.failure(u4.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());n.add(a)}t=g.of(i)}return ie.success(n)}static fromStep(e,t){return h1.isNotOnBoard(e)?ie.failure(ru.OUT_OF_RANGE(e)):h1.isNotOnBoard(t)?ie.failure(ru.OUT_OF_RANGE(t)):!1===e.getVectorToward(t).isDiagonalOfLength(1)?ie.failure(u4.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):ie.success(new Br([e,t],!0))}constructor(e,t){super(),u(this,"isStep",void 0),u(this,"coords",void 0),this.isStep=t,this.coords=new oht(e)}toString(){return"LascaMove("+this.coords.toList().map(n=>n.toString()).join(", ")+")"}getRelation(e){const t=this.coords.size(),n=e.coords.size(),i=Math.min(t,n);for(let o=0;o<i;o++)if(!1===this.coords.toList()[o].equals(e.coords.toList()[o]))return"INEQUALITY";return t===n?"EQUALITY":"PREFIX"}equals(e){return"EQUALITY"===this.getRelation(e)}isPrefix(e){return"PREFIX"===this.getRelation(e)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return Br.getSteppedOverCoords(this.coords.toList())}concatenate(e){const t=this.getEndingCoord(),n=e.coords.toList()[0];Fe(t.equals(n),"should not concatenate non-touching move");const i=this.coords.toList(),o=Re.copyImmutableArray(i),s=e.coords.toList(),a=Re.copyImmutableArray(s).slice(1);return Br.fromCapture(o.concat(a)).get()}}Fce=Br,u(Br,"encoder",we.tuple([we.list(C.encoder),we.identity()],r=>[r.coords.toList(),r.isStep],r=>Fce.of(r[0],r[1])));class Co extends Yn{static get(){return Co.singleton.isAbsent()&&(Co.singleton=g.of(new Co)),Co.singleton.get()}constructor(){super(h1)}getCaptures(e){const t=e.getCurrentPlayer();return this.getCapturesOf(e,t)}getCapturesOf(e,t){const n=[],i=e.getStacksOf(t);for(const o of i)n.push(...this.getPieceCaptures(e,o));return n}getPieceCaptures(e,t){let n=[];const s=e.getPieceAt(t).getCommander().player.getOpponent(),a=this.getPieceDirections(e,t),c=e.getPieceAt(t);for(const l of a){const f=t.getNext(l,1);if(h1.isOnBoard(f)&&e.getPieceAt(f).isCommandedBy(s)){const d=f.getNext(l,1);if(h1.isOnBoard(d)&&e.getPieceAt(d).isEmpty()){const m=e.remove(t).remove(f).set(d,c),E=Br.fromCapture([t,d]).get(),w=this.getPieceCaptures(m,d);if(0===w.length)n=n.concat(E);else{const L=w.map(z=>E.concatenate(z));n=n.concat(L)}}}}return n}getPieceDirections(e,t){const o=e.getPieceAt(t).getCommander().player.getScoreModifier(),s=[Me.factory.fromDelta(-1,o).get(),Me.factory.fromDelta(1,o).get()];return e.getPieceAt(t).getCommander().isOfficer&&s.push(Me.factory.fromDelta(-1,-o).get(),Me.factory.fromDelta(1,-o).get()),s}getSteps(e){const t=e.getCurrentPlayer();return this.getStepsOf(e,t)}getStepsOf(e,t){const n=[],i=e.getStacksOf(t);for(const o of i)n.push(...this.getPieceSteps(e,o));return n}getPieceSteps(e,t){const n=[],i=this.getPieceDirections(e,t);for(const o of i){const s=t.getNext(o,1);if(h1.isOnBoard(s)&&e.getPieceAt(s).isEmpty()){const a=Br.fromStep(t,s).get();n.push(a)}}return n}applyLegalMove(e,t,n){const i=e.getStartingCoord(),o=e.getEndingCoord();let s=t.getPieceAt(i),a=t.remove(i);if(!1===e.isStep)for(const c of e.getCapturedCoords().get()){const l=t.getPieceAt(c),f=l.getCommander();s=s.capturePiece(f);const d=l.getPiecesUnderCommander();a=a.set(c,d)}if(a=a.set(o,s),o.y===t.getFinishLineOf(t.getCurrentPlayer())){const c=s.promoteCommander();a=a.set(o,c)}return a.incrementTurn()}isLegal(e,t){const n=e.getStartingCoord();if(t.getPieceAt(n).isEmpty())return b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=t.getPieceAt(n),o=t.getCurrentOpponent();if(i.isCommandedBy(o))return b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());const s=e.coords.get(1);if(!1===i.getCommander().isOfficer&&n.getDirectionToward(s).get().y===o.getScoreModifier())return b.failure(u4.CANNOT_GO_BACKWARD());if(!1===t.getPieceAt(s).isEmpty())return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());const a=this.getCaptures(t);return e.isStep?a.length>0?b.failure(u4.CANNOT_SKIP_CAPTURE()):b.SUCCESS:this.isLegalCapture(e,t,a)}isLegalCapture(e,t,n){const i=t.getCurrentPlayer(),o=e.getCapturedCoords().get();for(const s of o){const a=t.getPieceAt(s);if(a.isCommandedBy(i))return b.failure(Le.CANNOT_SELF_CAPTURE());if(a.isEmpty())return b.failure(u4.CANNOT_CAPTURE_EMPTY_SPACE())}return n.some(s=>s.equals(e))?b.SUCCESS:b.failure(u4.MUST_FINISH_CAPTURING())}getGameStatus(e){const t=e.gameState;return this.getCaptures(t).length>0||this.getSteps(t).length>0?ve.ONGOING:ve.getVictory(t.getCurrentOpponent())}}u(Co,"singleton",g.empty());class Ud extends ds{constructor(e){super(Co.get(),e)}static getListMoves(e){const t=Co.get().getCaptures(e.gameState);return t.length>0?t:Co.get().getSteps(e.gameState)}getListMoves(e){return Ud.getListMoves(e)}getBoardValue(e){const t=Co.get().getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=e.gameState,i=this.getNumberOfMobileCoords(n,I.ZERO),o=this.getNumberOfMobileCoords(n,I.ONE);return an.of(i,o)}getNumberOfMobileCoords(e,t){const i=this.getCapturesAndSteps(e,t).map(s=>s.getStartingCoord());return new dt(i).size()}getCapturesAndSteps(e,t){const n=Co.get().getCapturesOf(e,t),i=Co.get().getStepsOf(e,t);return n.concat(i)}}class sht extends Ud{constructor(){super("Lasca Control And Domination Minimax")}getBoardValue(e){const t=Co.get().getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=12*super.getBoardValue(e).value;let i=0;for(let o=0;o<h1.SIZE;o++)for(let s=0;s<h1.SIZE;s++){const a=e.gameState.getPieceAtXY(s,o);if(a.getStackSize()>0){const c=a.getStackSize();let l=0;const f=a.getCommander().player;for(;l<c&&a.get(l).player===f;)l++;i+=l*f.getScoreModifier()}}return new an(n+i)}}const $ce=B2.ZERO,ZL=B2.ONE,Gr=new vo([$ce]),L1=new vo([ZL]),aht=new vo([$ce,ZL]),cht=new vo([B2.ZERO_OFFICER,ZL]),Z=vo.EMPTY;class Bce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,h1.getInitialState()),W.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,h1.getInitialState()),W.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,h1.getInitialState(),Br.fromStep(new C(4,4),new C(3,3)).get(),$localize`Congratulations!`),W.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,h1.of([[L1,Z,Z,Z,L1,Z,L1],[Z,Z,Z,L1,Z,L1,Z],[Z,Z,L1,Z,L1,Z,L1],[Z,L1,Z,Z,Z,Z,Z],[Gr,Z,Gr,Z,Gr,Z,Gr],[Z,Gr,Z,Gr,Z,Gr,Z],[Gr,Z,Gr,Z,Gr,Z,Gr]],2),Br.fromCapture([new C(2,4),new C(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),W.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,h1.of([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[L1,Z,Z,Z,L1,Z,L1],[Z,L1,Z,L1,Z,L1,Z],[Z,Z,L1,Z,L1,Z,L1],[Z,L1,Z,Z,Z,Z,Z],[Z,Z,Gr,Z,Gr,Z,Gr]],2),Br.fromCapture([new C(2,6),new C(0,4),new C(2,2)]).get(),$localize`Congratulations!`),W.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,h1.of([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,L1,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,L1,Z,L1,Z,Z,Z],[Z,Z,Gr,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z]],2)),W.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,h1.of([[Z,Z,Z,Z,Z,Z,L1],[Z,Z,Z,aht,Z,L1,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Gr,Z,Gr,Z,Gr]],2),[Br.fromStep(new C(3,1),new C(2,0)).get(),Br.fromStep(new C(3,1),new C(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),W.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,h1.of([[Z,Z,Z,Z,cht,Z,L1],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,L1,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Gr,Z,Gr,Z,Gr]],2),[Br.fromStep(new C(4,0),new C(3,1)).get(),Br.fromStep(new C(4,0),new C(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)])}}function lht(r,e){if(1&r&&(A(),F(0,"circle",13)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p().index,a=p();Oi("id","square_",o,"_",s,"_piece_",n,"_officer_symbol"),y("ngClass",i.classes),k("cx",.4*a.SPACE_SIZE)("cy",.575*a.SPACE_SIZE)("r",.045*a.SPACE_SIZE)}}function uht(r,e){if(1&r&&(A(),S(0,"g",10),F(1,"use",11),T(2,lht,1,7,"circle",12),P()),2&r){const t=e.$implicit,n=e.index,i=p().index,o=p().index;k("transform",p().getPieceTranslate(n)),_(1),Oi("id","square_",i,"_",o,"_piece_",n,""),y("ngClass",t.classes),_(1),y("ngIf",t.isOfficer)}}function fht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",7),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),F(2,"polygon",8),T(3,uht,3,6,"g",9),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),ye("id","coord_",n,"_",i,""),k("transform",o.getTranslate(n,i,0)),_(1),ye("id","square_",n,"_",i,""),y("ngClass",t.squareClasses),k("points",o.getParallelogramPoints()),_(1),y("ngForOf",t.pieceInfos)}}function dht(r,e){if(1&r&&(A(),S(0,"g"),T(1,fht,4,8,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let hht=(()=>{var r;class e extends Hce{constructor(n){super(n),u(this,"THICKNESS",40),u(this,"mode",{horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:h1.SIZE}),u(this,"LEFT",0),u(this,"UP",-this.SPACE_SIZE),u(this,"basicWidth",this.mode.abstractBoardSize*this.mode.parallelogramHeight),u(this,"WIDTH",this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio)),u(this,"HEIGHT",this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP),u(this,"CX",this.WIDTH/2),u(this,"CY",(this.HEIGHT+this.UP)/2),u(this,"adaptedBoard",{isAlreadySwitched:!1,spaceInfo:[]}),u(this,"lastMove",g.empty()),u(this,"currentMoveClicks",[]),u(this,"capturedCoords",[]),u(this,"legalMoves",[]),this.hasAsymmetricBoard=!0,this.rules=Co.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Ud("Lasca Control Minimax"),new sht],this.encoder=Br.encoder,this.tutorial=(new Bce).tutorial,this.canPass=!1}updateBoard(n){var i=this;return M(function*(){i.lastMove=i.node.move;const o=i.getState();i.board=o.getCopiedBoard(),i.legalMoves=Ud.getListMoves(i.node),i.createAdaptedBoardFrom(o),i.showPossibleMoves(),i.rotateAdaptedBoardIfNeeded()})()}createAdaptedBoardFrom(n){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let s=0;s<h1.SIZE;s++){const a=[];for(let c=0;c<h1.SIZE;c++){const l=this.getSpaceInfo(n,c,s);a.push(l)}this.adaptedBoard.spaceInfo.push(a)}const o=g.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(o.isPresent()){const s=o.get();for(const a of this.getSpaceInfoAt(s).pieceInfos)a.classes.push("selected-stroke");this.showPossibleLandings(s,n)}for(const s of this.capturedCoords)this.getSpaceInfoAt(s).squareClasses.push("captured-fill");for(const s of this.currentMoveClicks)this.getSpaceInfoAt(s).squareClasses.push("moved-fill")}getSpaceInfo(n,i,o){const s=n.getPieceAtXY(i,o),a=[];for(let c=s.getStackSize()-1;c>=0;c--){const l=s.get(c);a.push({classes:[this.getPlayerClass(l.player)],isOfficer:l.isOfficer})}return{pieceInfos:a,squareClasses:[]}}showLastMove(n){var i=this;return M(function*(){i.showLastCapture(n),i.showSteppedOnCoord(n)})()}showLastCapture(n){if(!1===n.isStep){const i=n.getCapturedCoords();q.assert(i.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const o of i.get())this.getSpaceInfoAt(o).squareClasses.push("captured-fill")}}showSteppedOnCoord(n){for(const i of n.coords)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}showPossibleMoves(){for(const n of this.legalMoves){const i=n.getStartingCoord();this.getSpaceInfoAt(i).squareClasses.push("selectable-fill")}}getSpaceInfoAt(n){if(this.role===I.ONE&&this.adaptedBoard.isAlreadySwitched){const i=h1.SIZE-1,o=new C(i-n.x,i-n.y);return this.adaptedBoard.spaceInfo[o.y][o.x]}return this.adaptedBoard.spaceInfo[n.y][n.x]}rotateAdaptedBoardIfNeeded(){if(this.role===I.ONE){const n=[];for(let i=0;i<h1.SIZE;i++){n[h1.SIZE-1-i]=[];for(let o=0;o<h1.SIZE;o++)n[h1.SIZE-1-i][h1.SIZE-1-o]=this.getSpaceInfoAt(new C(o,i))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:n}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(n,i){var o=this;return M(function*(){o.role===I.ONE&&(n=h1.SIZE-1-n,i=h1.SIZE-1-i);const s=yield o.canUserPlay("#coord_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new C(n,i),c=o.getState().getPieceAt(a),l=o.getState().getCurrentOpponent();return c.isCommandedBy(l)?o.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):0===o.currentMoveClicks.length?o.trySelectingPiece(a):o.moveClick(a)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(n){var i=this;return M(function*(){if(n.equals(i.currentMoveClicks[0]))return i.cancelMoveAttempt(),b.SUCCESS;const o=i.getState().getPieceAt(n),s=i.getState().getCurrentPlayer();if(o.isCommandedBy(s))return i.cancelMoveAttempt(),i.trySelectingPiece(n);if(1===i.currentMoveClicks.length&&i.currentMoveClicks[0].getVectorToward(n).isDiagonalOfLength(1)){const c=Br.fromStep(i.currentMoveClicks[0],n).get();return i.chooseMove(c)}return i.capture(n)})()}capture(n){var i=this;return M(function*(){const s=i.currentMoveClicks[i.currentMoveClicks.length-1],a=s.getVectorToward(n);if(a.isDiagonalOfLength(2)){const c=new C(s.x+a.x/2,s.y+a.y/2);i.capturedCoords.push(c),i.currentMoveClicks.push(n);const l=Br.fromCapture(i.currentMoveClicks).get();return i.legalMoves.some(f=>f.isPrefix(l))?i.applyPartialCapture():i.chooseMove(l)}return i.cancelMove(u4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let n=this.getState().remove(this.currentMoveClicks[0]),i=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const s of this.capturedCoords){const a=this.getState().getPieceAt(s),c=a.getCommander(),l=a.getPiecesUnderCommander();n=n.set(s,l),i=i.capturePiece(c)}return n=n.set(this.currentMoveClicks[this.currentMoveClicks.length-1],i),this.createAdaptedBoardFrom(n),this.rotateAdaptedBoardIfNeeded(),b.SUCCESS}trySelectingPiece(n){var i=this;return M(function*(){return i.getState().getPieceAt(n).isEmpty()?i.cancelMove(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.selectPiece(n)})()}selectPiece(n){var i=this;return M(function*(){return i.capturedCoords=[],i.legalMoves.some(o=>o.getStartingCoord().equals(n))?(i.currentMoveClicks=[n],i.hideLastMove(),b.SUCCESS):i.cancelMove(u4.THIS_PIECE_CANNOT_MOVE())})()}showPossibleLandings(n,i){const o=this.rules.getPieceCaptures(i,n);if(0===o.length){const s=this.rules.getPieceSteps(i,n);for(const a of s)this.getSpaceInfoAt(a.getEndingCoord()).squareClasses.push("selectable-fill")}else{const s=o.map(a=>a.coords.get(1));for(const a of s)this.getSpaceInfoAt(a).squareClasses.push("capturable-fill")}}getTranslate(n,i,o){const s=this.getCoordTranslate(n,i,o,this.mode);return"translate("+s.x+" "+s.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(i=>i.x+", "+i.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const n=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(n[0],n[1],n[2],n[3])}getParallelogramCenterOf(n,i,o,s){const a=Math.max(n.x,i.x,o.x,s.x),c=Math.max(n.y,i.y,o.y,s.y),l=Math.min(n.x,i.x,o.x,s.x),f=Math.min(n.y,i.y,o.y,s.y);return new C((a-l)/2,(c-f)/2)}getRightEdge(){const n=this.basicWidth*this.mode.horizontalWidthRatio,i=this.basicWidth*this.mode.offsetRatio;return[i+n,0,i+n,this.THICKNESS,n,this.basicWidth+this.THICKNESS,n,this.basicWidth].join(" ")}getPieceTranslate(n){return"translate(0 "+(this.getParallelogramCenter().y-32.5-n*(.15*this.SPACE_SIZE))+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-lasca"]],features:[Qe],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs")(2,"g",1),F(3,"path",2)(4,"ellipse",3),P()(),T(5,dht,2,1,"g",4),F(6,"rect",5)(7,"polygon",6),P()),2&n&&(k("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),_(5),y("ngForOf",i.adaptedBoard.spaceInfo),_(1),k("y",i.basicWidth)("width",i.basicWidth*i.mode.horizontalWidthRatio)("height",i.THICKNESS),_(1),k("points",i.getRightEdge()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),hi=(()=>{class r extends B1{static getInitialState(){const t=K.NONE,n=K.ZERO,i=K.ONE;return new r([[t,n,n,n,n,n,n,t],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[t,n,n,n,n,n,n,t]],0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}}return u(r,"SIZE",8),r})();class Bi extends Fs{static from(e,t){const n=Me.factory.fromMove(e,t);return n.isFailure()?ie.failure(n.getReason()):e.isNotInRange(hi.SIZE,hi.SIZE)?ie.failure("start coord is not in range"):t.isNotInRange(hi.SIZE,hi.SIZE)?ie.failure("end coord is not in range"):ie.success(new Bi(e,t,n.get()))}constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n,this.direction=Me.factory.fromMove(e,t).get()}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}}u(Bi,"encoder",Ho.getFallibleEncoder(Bi.from));let YL=(()=>{class r{}return u(r,"INVALID_MOVE_LENGTH",()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`),u(r,"CANNOT_JUMP_OVER_OPPONENT",()=>$localize`You cannot jump over the opponent's pieces.`),u(r,"PIECE_CANNOT_MOVE",()=>$localize`This piece has no possible move, select another one.`),r})();class Ur extends Yn{static get(){return Ur.singleton.isAbsent()&&(Ur.singleton=g.of(new Ur)),Ur.singleton.get()}constructor(){super(hi)}static getListMovesFromState(e){const t=[];if(Ur.getVictory(e).isPresent())return t;for(let n=0;n<hi.SIZE;n++)for(let i=0;i<hi.SIZE;i++){const o=new C(i,n);if(e.getPieceAt(o).isPlayer())for(const a of Ur.possibleTargets(e,o)){const c=Bi.from(o,a).get();t.push(c)}}return t}static getNumberOfGroups(e){const t=Re.createTable(hi.SIZE,hi.SIZE,-1),n=[0,0];let i=0;for(const o of e.getCoordsAndContents())-1===t[o.coord.y][o.coord.x]&&o.content.isPlayer()&&(i+=1,Ur.markGroupStartingAt(e,t,o.coord,i),n[o.content.value]+=1);return n}static markGroupStartingAt(e,t,n,i){const o=[n],s=e.getPieceAt(n);for(;o.length>0;){const a=q.getNonNullable(o.pop());if(-1===t[a.y][a.x]){const c=e.getPieceAt(a);if(c===s){t[a.y][a.x]=i;for(const l of Me.DIRECTIONS){const f=a.getNext(l);e.isOnBoard(f)&&o.push(f)}}else c===K.NONE&&(t[a.y][a.x]=0)}}}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.getStart().y][e.getStart().x]=K.NONE,i[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new hi(i,t.turn+1)}static isLegal(e,t){return t.getPieceAt(e.getStart())!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.getStart(),e.direction)?b.failure(YL.INVALID_MOVE_LENGTH()):e.getStart().getCoordsToward(e.getEnd()).some(n=>t.getPieceAt(n)===t.getCurrentOpponent())?b.failure(YL.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.getEnd())===t.getCurrentPlayer()?b.failure(Le.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):b.SUCCESS}isLegal(e,t){return Ur.isLegal(e,t)}static numberOfPiecesOnLine(e,t,n){let i=0;for(const o of Ur.getLineCoords(t,n))e.getPieceAt(o).isPlayer()&&(i+=1);return i}static getLineCoords(e,t){const n=Ur.getEntranceAndForwardDirection(e,t);let i=n[0];const o=n[1],s=[];for(;hi.isOnBoard(i);)s.push(i),i=i.getNext(o);return s}static getEntranceAndForwardDirection(e,t){switch(t){case Me.UP:case Me.DOWN:return[new C(e.x,0),Me.DOWN];case Me.LEFT:case Me.RIGHT:return[new C(0,e.y),Me.RIGHT];case Me.UP_RIGHT:case Me.DOWN_LEFT:return[new C(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),Me.UP_RIGHT];default:return q.expectToBeMultiple(t,[Me.UP_LEFT,Me.DOWN_RIGHT]),[new C(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),Me.DOWN_RIGHT]}}static getVictory(e){const[t,n]=Ur.getNumberOfGroups(e);return 1===t&&1===n?g.of(K.NONE):1===t?g.of(I.ZERO):1===n?g.of(I.ONE):g.empty()}static possibleTargets(e,t){const n=[];for(const i of Me.DIRECTIONS){const o=Ur.numberOfPiecesOnLine(e,t,i),s=t.getNext(i,o);if(e.isOnBoard(s)){const a=Bi.from(t,s).get();Ur.isLegal(a,e).isSuccess()&&n.push(s)}}return n}getGameStatus(e){const t=e.gameState,[n,i]=Ur.getNumberOfGroups(t);return 1===n&&i>1?ve.ZERO_WON:n>1&&1===i?ve.ONE_WON:ve.ONGOING}}u(Ur,"singleton",g.empty());class pht extends Sr{getListMoves(e){return Ur.getListMovesFromState(e.gameState)}getMetrics(e){const t=e.gameState,[n,i]=Ur.getNumberOfGroups(t);return[100/n,100/i]}}const V=K.NONE,M1=K.ZERO,p1=K.ONE;class Uce{constructor(){u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new hi([[V,V,V,V,V,V,V,V],[p1,V,V,V,M1,V,V,p1],[V,V,M1,M1,p1,V,V,V],[V,V,V,M1,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V]],0)),W.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,hi.getInitialState(),Bi.from(new C(1,7),new C(1,5)).get(),$localize`Congratulations!`),W.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new hi([[V,V,V,V,V,V,V,V],[V,V,p1,M1,M1,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,p1],[V,V,V,V,V,V,V,M1]],0),[Bi.from(new C(3,1),new C(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),W.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new hi([[V,V,V,V,V,V,p1,V],[V,V,V,V,V,M1,V,V],[V,V,V,V,p1,V,V,V],[V,V,V,M1,V,V,V,V],[V,V,V,V,V,V,V,p1],[V,V,V,V,V,p1,V,p1],[V,V,V,M1,V,V,p1,p1],[V,V,V,M1,V,V,V,V]],0),[Bi.from(new C(3,3),new C(3,0)).get(),Bi.from(new C(3,3),new C(0,0)).get(),Bi.from(new C(3,3),new C(2,3)).get(),Bi.from(new C(3,3),new C(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),W.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new hi([[V,M1,V,M1,M1,M1,M1,V],[p1,V,V,V,V,V,V,p1],[V,V,M1,V,p1,V,V,V],[p1,V,V,V,V,V,V,p1],[p1,V,V,V,V,V,V,p1],[p1,V,V,V,V,V,V,p1],[p1,V,V,V,V,V,V,p1],[V,M1,M1,M1,M1,M1,M1,V]],0),Bi.from(new C(2,2),new C(4,2)).get(),(e,t,n)=>t.getPieceAt(e.getEnd())===K.ONE?b.SUCCESS:b.failure($localize`Failed. Try again.`),$localize`Congratulations!`),W.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new hi([[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[M1,V,V,M1,p1,M1,V,V],[V,V,V,M1,V,V,V,p1],[V,V,V,V,V,V,V,p1],[V,V,V,V,V,V,V,p1],[V,V,V,V,V,V,V,p1],[V,V,V,V,V,V,V,V]],0),[Bi.from(new C(0,2),new C(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}function ght(r,e){if(1&r&&(A(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),k("cx",i.SPACE_SIZE/2+t*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function mht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",3),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),F(2,"rect",4),T(3,ght,1,6,"circle",5),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),ye("id","click_",n,"_",i,""),_(1),ye("id","space_",n,"_",i,""),y("ngClass",o.getSquareClasses(n,i)),k("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t!==o.EMPTY)}}function _ht(r,e){if(1&r&&(A(),S(0,"g"),T(1,mht,4,10,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function vht(r,e){if(1&r){const t=pe();A(),S(0,"rect",6),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()}if(2&r){const t=e.$implicit,n=p();k("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}let Cht=(()=>{var r;class e extends Vi{constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"EMPTY",K.NONE),u(this,"targets",[]),u(this,"state",void 0),u(this,"selected",g.empty()),u(this,"lastMove",g.empty()),u(this,"captured",g.empty()),this.rules=Ur.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new pht(this.rules,"LinesOfActionMinimax")],this.encoder=Bi.encoder,this.tutorial=(new Uce).tutorial}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new C(n,i);if(o.selected.equalsValue(a))return o.cancelMoveAttempt(),b.SUCCESS;const c=o.getState().getCurrentPlayer();return o.selected.isAbsent()||o.getState().getPieceAt(a)===c?o.select(a):o.concludeMove(a)})()}concludeMove(n){var i=this;return M(function*(){const o=Bi.from(i.selected.get(),n);return o.isSuccess()?i.chooseMove(o.get()):i.cancelMove(o.getReason())})()}select(n){var i=this;return M(function*(){return i.getState().getPieceAt(n)!==i.getState().getCurrentPlayer()?i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):(i.selected=g.of(n),i.targets=Ur.possibleTargets(i.getState(),i.selected.get()),0===i.targets.length?i.cancelMove(YL.PIECE_CANNOT_MOVE()):b.SUCCESS)})()}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.board=i.getState().board,i.lastMove=i.node.move})()}showLastMove(n){var i=this;return M(function*(){i.captured=i.getPreviousState().getPieceAt(n.getEnd()).isPlayer()?g.of(n.getEnd()):g.empty()})()}cancelMoveAttempt(){this.selected=g.empty(),this.targets=[]}getSquareClasses(n,i){const o=new C(n,i);if(this.lastMove.isPresent()){const s=this.lastMove.get().getStart(),a=this.lastMove.get().getEnd();if(this.captured.isPresent()&&o.equals(this.captured.get()))return["captured-fill"];if(o.equals(s)||o.equals(a))return["moved-fill"]}return[]}getPieceClasses(n,i){const o=this.board[i][n],s=new C(n,i),a=[this.getPlayerClass(o)];return this.selected.isPresent()&&this.selected.get().equals(s)&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-linesofaction"]],features:[Qe],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,_ht,2,1,"g",1),T(2,vht,1,4,"rect",2),P()),2&n&&(_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.targets))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var Wce,KL,XL,f4,QL;class Gc extends Pr{constructor(e,t,n,i={top:0,bottom:0,left:0,right:0}){super(e.x,e.y),u(this,"direction",void 0),u(this,"orientation",void 0),u(this,"captures",void 0),this.direction=t,this.orientation=n,this.captures=i}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}Wce=Gc,u(Gc,"encoder",new class extends we{encode(r){return{coord:C.encoder.encode(r.coord),direction:r.direction,orientation:r.orientation,captures:r.captures}}decode(r){const e=r;return Fe(null!=e.coord,"Invalid encoded LodestoneMove"),Fe(null!=e.direction,"Invalid encoded LodestoneMove"),Fe(null!=e.orientation,"Invalid encoded LodestoneMove"),Fe(null!=e.captures,"Invalid encoded LodestoneMove"),new Wce(C.encoder.decode(e.coord),e.direction,e.orientation,e.captures)}});class yo{constructor(e){u(this,"unreachable",void 0),this.unreachable=e}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(e){return this===e}}u(yo,"UNREACHABLE",new(KL=yo)(!0)),u(yo,"EMPTY",new KL(!1));class La{static of(e){return e===I.ZERO?La.ZERO:La.ONE}constructor(e){u(this,"owner",void 0),this.owner=e}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(La,"ZERO",new(XL=La)(I.ZERO)),u(La,"ONE",new XL(I.ONE));class Nl{constructor(e,t,n){u(this,"owner",void 0),u(this,"direction",void 0),u(this,"orientation",void 0),this.owner=e,this.direction=t,this.orientation=n}static of(e,t){return Nl.LODESTONES[e.value][t.direction][t.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(Nl,"LODESTONES",{0:{push:{diagonal:new(f4=Nl)(I.ZERO,"push","diagonal"),orthogonal:new f4(I.ZERO,"push","orthogonal")},pull:{diagonal:new f4(I.ZERO,"pull","diagonal"),orthogonal:new f4(I.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new f4(I.ONE,"push","diagonal"),orthogonal:new f4(I.ONE,"push","orthogonal")},pull:{diagonal:new f4(I.ONE,"pull","diagonal"),orthogonal:new f4(I.ONE,"pull","orthogonal")}}});class q1{constructor(e,t){u(this,"width",void 0),u(this,"pieces",void 0),this.width=e,this.pieces=t}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(e,t){if(this.pieces.length+t>=this.width)return 5===this.width?q1.EMPTY_3.addCaptured(e,t+this.pieces.length-5):(Fe(this.pieces.length+t===3,"should never put more pieces than the plate can support"),g.empty());{const n=Re.copyImmutableArray(this.pieces);for(let i=0;i<t;i++)n.push(La.of(e));return g.of(new q1(this.width,n))}}getPieceAt(e){return e<this.pieces.length?this.pieces[e]:yo.EMPTY}}QL=q1,u(q1,"POSITIONS",["top","bottom","left","right"]),u(q1,"EMPTY_5",new QL(5,[])),u(q1,"EMPTY_3",new QL(3,[]));let g1=(()=>{class r extends B1{static getInitialState(){const t=yo.EMPTY,n=La.ZERO,i=La.ONE;return new r([[t,t,n,i,n,i,t,t],[t,n,i,n,i,n,i,t],[n,i,n,i,n,i,n,i],[i,n,i,t,t,n,i,n],[n,i,n,t,t,i,n,i],[i,n,i,n,i,n,i,n],[t,i,n,i,n,i,n,t],[t,t,i,n,i,n,t,t]],0,new un,{top:g.of(q1.EMPTY_5),bottom:g.of(q1.EMPTY_5),left:g.of(q1.EMPTY_5),right:g.of(q1.EMPTY_5)})}constructor(t,n,i,o){super(t,n),u(this,"lodestones",void 0),u(this,"pressurePlates",void 0),this.lodestones=i,this.pressurePlates=o}withBoard(t){return new r(t,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const t=this.remainingSpacesDetails();return t.top+t.bottom+t.left+t.right}remainingSpacesDetails(){const t={top:0,bottom:0,left:0,right:0};for(const n of q1.POSITIONS){const i=this.pressurePlates[n];i.isPresent()&&(t[n]=i.get().remainingSpaces())}return t}numberOfPieces(){const t=[0,0];for(let n=0;n<r.SIZE;n++)for(let i=0;i<r.SIZE;i++){const o=this.getPieceAtXY(i,n);o.isPlayerPiece()&&(t[o.owner.value]+=1)}return t}getScores(){const t=this.numberOfPieces();return[24-t[1],24-t[0]]}nextLodestoneDirection(){const t=this.getCurrentPlayer(),n=this.lodestones.get(t);if(!n.isPresent())return g.empty();{const i=this.getPieceAt(n.get());switch(Fe(i.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+n.get()),i.direction){case"push":return g.of("pull");case"pull":return g.of("push")}}}}return u(r,"SIZE",8),r})();const Ne=yo.UNREACHABLE,J=yo.EMPTY,br=La.ZERO,Gi=La.ONE,Wd=Nl.of(I.ONE,{direction:"push",orientation:"orthogonal"}),JL={top:g.of(q1.EMPTY_5),bottom:g.of(q1.EMPTY_5),left:g.of(q1.EMPTY_5),right:g.of(q1.EMPTY_5)};class qce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,g1.getInitialState()),W.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,g1.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),W.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,g1.getInitialState()),W.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,g1.getInitialState()),W.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,g1.getInitialState()),W.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,g1.getInitialState(),new Gc(new C(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,n,i)=>32===i.remainingSpaces()?b.failure($localize`You have not captured any of the opponent's pieces, try again!`):b.SUCCESS,$localize`Congratulations!`),W.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new g1([[J,J,J,J,Gi,J,J,J],[J,J,br,J,J,Gi,J,J],[J,J,Wd,J,J,J,J,br],[J,J,J,J,Gi,J,J,br],[J,J,J,J,J,br,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new un([{key:I.ONE,value:new C(2,2)}]),{...JL,top:q1.EMPTY_5.addCaptured(I.ONE,4)}),new Gc(new C(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>5===i.pressurePlates.top.get().width?b.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):b.SUCCESS,$localize`Congratulations!`),W.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new g1([[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,br],[J,J,J,J,J,br,J,br],[J,Wd,J,J,Gi,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,Gi,J,J,J],[J,J,J,J,J,J,J,J]],0,new un([{key:I.ONE,value:new C(1,4)}]),{...JL,top:q1.EMPTY_3.addCaptured(I.ONE,2)}),new Gc(new C(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>i.pressurePlates.top.isPresent()?b.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):b.SUCCESS,$localize`Congratulations!`),W.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new g1([[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[Ne,Ne,br,Gi,J,J,Ne,Ne],[Ne,Ne,Wd,Gi,J,J,Ne,Ne],[Ne,Ne,J,br,br,J,Ne,Ne],[Ne,Ne,br,J,J,J,Ne,Ne],[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne]],0,new un([{key:I.ONE,value:new C(2,3)}]),{top:g.empty(),bottom:g.empty(),left:g.empty(),right:g.empty()})),W.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new g1([[J,J,J,J,J,J,J,J],[J,J,J,J,J,Gi,J,J],[J,J,J,Wd,J,J,br,J],[J,J,br,br,Gi,J,J,br],[J,J,J,J,J,br,J,J],[J,J,br,J,J,J,J,J],[J,J,Gi,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new un([{key:I.ONE,value:new C(3,2)}]),{...JL,top:q1.EMPTY_5.addCaptured(I.ONE,4)}),[new Gc(new C(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),W.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new g1([[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[Ne,Gi,br,Gi,J,J,Ne,Ne],[Ne,Gi,Wd,J,Gi,J,Ne,Ne],[Ne,J,J,br,br,J,Ne,Ne],[Ne,Gi,br,J,Gi,J,Ne,Ne],[Ne,J,J,J,br,J,Ne,Ne],[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne]],0,new un([{key:I.ONE,value:new C(2,3)}]),{top:g.empty(),bottom:q1.EMPTY_3.addCaptured(I.ZERO,2),left:g.of(q1.EMPTY_3),right:g.empty()}),[new Gc(new C(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)])}}let vu=(()=>{class r{}return u(r,"MUST_FLIP_LODESTONE",()=>$localize`You must flip your lodestone before putting it back on the board.`),u(r,"MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES",()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`),u(r,"TARGET_IS_CRUMBLED",()=>$localize`You must place your lodestone on a non-crumbled square!`),u(r,"TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE",()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`),u(r,"MUST_PLACE_CAPTURES",()=>$localize`You must place your captures on the pressure plates, on the side of the board.`),u(r,"NO_CAPTURES_TO_PLACE_YET",()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`),r})();class pi extends Yn{static get(){return pi.singleton.isAbsent()&&(pi.singleton=g.of(new pi)),pi.singleton.get()}constructor(){super(g1)}applyLegalMove(e,t,n){const i=t.getCurrentPlayer(),o=i.getOpponent(),s=Re.copyBiArray(n.board),a=t.lodestones.getCopy();a.put(i,e.coord);const c={...t.pressurePlates};return this.updatePressurePlates(s,c,a,o,e.captures),new g1(s,t.turn+1,a,c)}updatePressurePlates(e,t,n,i,o){for(const s of q1.POSITIONS)t[s]=this.updatePressurePlate(e,s,t[s],n,i,o[s])}updatePressurePlate(e,t,n,i,o,s){if(n.isPresent()){const a=n.get().addCaptured(o,s),c=pi.THREATENED_COORD_RANGE.get(t).get();return a.isAbsent()?(this.removePressurePlate(e,c.startForBigPlate,c.direction,i),this.removePressurePlate(e,c.startForSmallPlate,c.direction,i)):a.get().width<n.get().width&&this.removePressurePlate(e,c.startForBigPlate,c.direction,i),a}return n}removePressurePlate(e,t,n,i){for(let o=t;o.isInRange(g1.SIZE,g1.SIZE);o=o.getNext(n)){for(const s of I.PLAYERS)i.get(s).equalsValue(o)&&i.delete(s);e[o.y][o.x]=yo.UNREACHABLE}}isLegal(e,t){const n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return ie.failure(n.getReason());const i=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(i.captures.length,t.remainingSpaces()))return ie.failure(vu.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const a of q1.POSITIONS){const c=t.pressurePlates[a];if(c.isPresent()&&c.get().remainingSpaces()<e.captures[a])return ie.failure(vu.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return ie.success(i)}applyMoveWithoutPlacingCaptures(e,t,n){let i;const o=Re.copyBiArray(e.board),s=e.lodestones.get(e.getCurrentPlayer());if(s.isPresent()){const a=s.get();o[a.y][a.x]=yo.EMPTY}return i="pull"===n.direction?this.applyPull(e,o,t,n.orientation):this.applyPush(e,o,t,n.orientation),i.board[t.y][t.x]=Nl.of(e.getCurrentPlayer(),n),i.moved.push(t),i}applyPull(e,t,n,i){const o=e.getCurrentPlayer(),s=o.getOpponent(),a=[],c=[],l="diagonal"===i?Me.DIAGONALS:Me.ORTHOGONALS;for(const f of l)for(let d=n.getNext(f);e.isOnBoard(d);d=d.getNext(f)){const m=t[d.y][d.x],E=d.getNext(f);if(e.isOnBoard(E)){const w=t[E.y][E.x];w.isPlayerPiece()&&w.owner===o&&(m.isEmpty()?(c.push(d),t[d.y][d.x]=w,c.push(E),t[E.y][E.x]=yo.EMPTY):m.isPlayerPiece()&&m.owner===s&&(a.push(d),t[d.y][d.x]=w,c.push(E),t[E.y][E.x]=yo.EMPTY))}}return{board:t,captures:a,moved:c}}applyPush(e,t,n,i){const s=e.getCurrentPlayer().getOpponent(),a=[],c=[],l="diagonal"===i?Me.DIAGONALS:Me.ORTHOGONALS;for(const f of l)for(let m=n.getNext(f,g1.SIZE);!1===m.equals(n);m=m.getPrevious(f))if(e.isOnBoard(m)){const E=t[m.y][m.x];if(E.isPlayerPiece()&&E.owner===s){const w=m.getNext(f);if(e.isOnBoard(w)){const L=t[w.y][w.x];L.isUnreachable()?(a.push(m),t[m.y][m.x]=yo.EMPTY):L.isEmpty()&&(c.push(w),t[w.y][w.x]=E,c.push(m),t[m.y][m.x]=yo.EMPTY)}else a.push(m),t[m.y][m.x]=yo.EMPTY}}return{board:t,captures:a,moved:c}}isLegalWithoutCaptures(e,t,n){const i=this.isTargetLegal(e,t);if(i.isFailure())return i;const o=e.nextLodestoneDirection();return!1===(o.isAbsent()||o.equalsValue(n))?b.failure(vu.MUST_FLIP_LODESTONE()):b.SUCCESS}isTargetLegal(e,t){const n=e.getPieceAt(t);if(n.isUnreachable())return b.failure(vu.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE());const i=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==i?b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}getGameStatus(e){const n=e.gameState.numberOfPieces();return 0===n[0]&&0===n[1]?ve.DRAW:0===n[0]?ve.ONE_WON:0===n[1]?ve.ZERO_WON:ve.ONGOING}}u(pi,"THREATENED_COORD_RANGE",un.from({top:{startForBigPlate:new C(0,0),startForSmallPlate:new C(0,1),direction:Me.RIGHT},bottom:{startForBigPlate:new C(0,g1.SIZE-1),startForSmallPlate:new C(0,g1.SIZE-2),direction:Me.RIGHT},left:{startForBigPlate:new C(0,0),startForSmallPlate:new C(1,0),direction:Me.DOWN},right:{startForBigPlate:new C(g1.SIZE-1,0),startForSmallPlate:new C(g1.SIZE-2,0),direction:Me.DOWN}})),u(pi,"singleton",g.empty());class yht extends ds{getListMoves(e){const t=e.gameState;return this.flatMapEmptyCoords(t,n=>{const i=[];for(const o of this.nextDirection(t)){const s=["diagonal","orthogonal"];for(const a of s){const f=pi.get().applyMoveWithoutPlacingCaptures(t,n,{direction:o,orientation:a}).captures.length;for(const d of this.captureCombinations(t,f))i.push(new Gc(n,o,a,d))}}return i})}captureCombinations(e,t){if(0===t)return new dt([{top:0,bottom:0,left:0,right:0}]);{const n=new dt,i=e.remainingSpacesDetails(),o=this.captureCombinations(e,t-1);for(const s of o)s.top+1<=i.top&&n.add({...s,top:s.top+1}),s.bottom+1<=i.bottom&&n.add({...s,bottom:s.bottom+1}),s.left+1<=i.left&&n.add({...s,left:s.left+1}),s.right+1<=i.right&&n.add({...s,right:s.right+1});return 0===n.size()?o:n}}flatMapEmptyCoords(e,t){let n=[];for(let i=0;i<g1.SIZE;i++)for(let o=0;o<g1.SIZE;o++){const s=new C(o,i),a=e.getPieceAt(s);(a.isEmpty()&&!1===a.isUnreachable()||a.isLodestone()&&a.owner===e.getCurrentPlayer())&&(n=n.concat(t(s)))}return n}nextDirection(e){const t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}getBoardValue(e){const t=e.gameState.getScores();let n;return n=24===t[0]&&24!==t[1]?I.ZERO.getVictoryValue():24!==t[0]&&24===t[1]?I.ONE.getVictoryValue():an.of(t[0],t[1]).value,new an(n)}}var Ra;function Mht(r,e){if(1&r&&(A(),F(0,"circle",10)),2&r){const t=p(2),n=t.index,i=t.$implicit,o=p().index,s=p();ye("id","piece_",n,"_",o,""),y("ngClass",i.pieceClasses),k("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*n+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function Eht(r,e){if(1&r&&(A(),F(0,"polygon",15)),2&r){const t=p().$implicit,n=p(3).$implicit,i=p(2);s6("transform","rotate(",90*t,")"),y("ngClass",n.lodestone.movingClass),k("points",i.TRIANGLE_OUT)}}function Sht(r,e){if(1&r&&(A(),F(0,"polygon",15)),2&r){const t=p().$implicit,n=p(3).$implicit,i=p(2);s6("transform","rotate(",90*t,")"),y("ngClass",n.lodestone.movingClass),k("points",i.TRIANGLE_IN)}}function Pht(r,e){if(1&r&&(A(),S(0,"g"),T(1,Eht,1,3,"polygon",14),T(2,Sht,1,3,"polygon",14),P()),2&r){const t=p(3).$implicit;_(1),y("ngIf","push"===t.lodestone.direction),_(1),y("ngIf","pull"===t.lodestone.direction)}}const jce=function(){return[0,1,2,3]};function Tht(r,e){if(1&r&&(A(),S(0,"g",11),F(1,"circle",12)(2,"circle",13),S(3,"g"),T(4,Pht,3,2,"g",1),P()()),2&r){const t=p(2),n=t.index,i=t.$implicit,o=p().index,s=p();k("transform",s.getSquareTransform(n,o)),_(1),y("ngClass",i.lodestone.selectedClass),k("r",s.PIECE_RADIUS),_(1),y("ngClass",i.lodestone.pieceClasses),k("r",s.PIECE_RADIUS/4),_(1),s6("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),_(1),y("ngForOf",_1(7,jce))}}function Oht(r,e){if(1&r){const t=pe();A(),S(0,"g",6),U("click",function(){te(t);const i=p().$implicit;return ne(p(2).selectCoord(i.coord))}),F(1,"rect",7),T(2,Mht,1,6,"circle",8),T(3,Tht,5,8,"g",9),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();ye("id","square_",n,"_",o,""),_(1),y("ngClass",i.squareClasses),k("x",s.SPACE_SIZE*n+s.STROKE_WIDTH)("y",s.SPACE_SIZE*o+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",i.hasPiece),_(1),y("ngIf",i.lodestone)}}function bht(r,e){if(1&r&&(A(),S(0,"g"),T(1,Oht,4,9,"g",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",!1===t.crumbled)}}function wht(r,e){if(1&r&&(A(),S(0,"g"),T(1,bht,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Nht(r,e){if(1&r&&(A(),S(0,"g",16),F(1,"circle",17),P()),2&r){const t=e.$implicit,n=e.index,i=p();Dn("id","capture_",n,""),k("transform",i.getCaptureTransform(n)),_(1),y("ngClass",t.pieceClasses),k("r",i.PIECE_RADIUS)}}function Aht(r,e){if(1&r&&(A(),S(0,"g"),F(1,"polygon",15),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p();_(1),s6("transform","rotate(",90*t,")"),y("ngClass",n.movingClass),k("points","push"===n.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function Iht(r,e){if(1&r){const t=pe();A(),S(0,"g",6),U("click",function(){const o=te(t).$implicit;return ne(p().selectLodestone(o))}),F(1,"circle",12)(2,"circle",13),S(3,"g"),T(4,Aht,2,3,"g",1),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p();ye("id","lodestone_",t.direction,"_",t.orientation,""),k("transform",i.getAvailableLodestoneTransform(n)),_(1),y("ngClass",t.selectedClass),k("r",i.PIECE_RADIUS),_(1),y("ngClass",t.pieceClasses),k("r",i.PIECE_RADIUS/4),_(1),s6("transform","rotate(","diagonal"===t.orientation?45:0,")"),_(1),y("ngForOf",_1(9,jce))}}function kht(r,e){if(1&r&&(A(),F(0,"circle",10)),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().$implicit,s=p();ye("id","platePiece_",o.position,"_",n,""),y("ngClass",i.pieceClasses),k("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i.coord.x+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*i.coord.y+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function xht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",6),U("click",function(){const i=te(t),o=i.$implicit,s=i.index,a=p().$implicit;return ne(p().onPressurePlateClick(o.temporary,a.position,s))}),F(2,"rect",18),T(3,kht,1,6,"circle",8),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,o=p();k("transform",o.getPressurePlateTransform(i.position)),_(1),ye("id","plate_",i.position,"_",n,""),_(1),ye("id","plateSquare_",i.position,"_",n,""),y("ngClass",t.squareClasses),k("x",o.SPACE_SIZE*t.coord.x+o.STROKE_WIDTH)("y",o.SPACE_SIZE*t.coord.y+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t.hasPiece)}}function Lht(r,e){if(1&r&&(A(),S(0,"g",16),T(1,xht,4,11,"g",1),P()),2&r){const t=e.$implicit;Dn("id","pressurePlate_",t.position,""),_(1),y("ngForOf",t.coords)}}function Rht(r,e){if(1&r&&(A(),F(0,"rect",19)),2&r){const t=p();ye("id","selection_",t.viewInfo.selected.get().x,"_",t.viewInfo.selected.get().y,""),k("x",t.SPACE_SIZE*t.viewInfo.selected.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.viewInfo.selected.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}class Al extends Cl{constructor(e){super(e),u(this,"PIECE_RADIUS",void 0),u(this,"TRIANGLE_OUT",void 0),u(this,"TRIANGLE_IN",void 0),u(this,"viewInfo",{availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:g.empty(),pressurePlateShift:{top:new St(0,0),left:new St(0,0),right:new St(0,0),bottom:new St(0,0)}}),u(this,"displayedState",void 0),u(this,"stateAfterPlacingLodestone",g.empty()),u(this,"lastInfos",g.empty()),u(this,"capturesToPlace",0),u(this,"selectedCoord",g.empty()),u(this,"selectedLodestone",g.empty()),u(this,"captures",{top:0,bottom:0,left:0,right:0}),this.rules=pi.get(),this.node=this.rules.getInitialNode(),this.tutorial=(new qce).tutorial,this.availableMinimaxes=[new yht(this.rules,"LodestoneDummyMinimax")],this.encoder=Gc.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const t=.8*this.PIECE_RADIUS,n=.3*this.PIECE_RADIUS,i=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${t},0 ${n},${i} ${n},-${i}`,this.TRIANGLE_IN=`${n},0 ${t},${n} ${t},-${n}`,this.displayedState=this.getState(),this.scores=g.of([0,0])}selectCoord(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#square_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.capturesToPlace>0)return t.cancelMove(vu.MUST_PLACE_CAPTURES());const i=pi.get().isTargetLegal(t.getState(),e);return i.isFailure()?t.cancelMove(i.getReason()):t.selectedCoord.equalsValue(e)?(t.cancelMoveAttempt(),b.SUCCESS):(t.selectedCoord=g.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),b.SUCCESS))})()}selectLodestone(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation);if(n.isFailure())return t.cancelMove(n.getReason());Fe(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const i=t.getCurrentPlayer(),o=Nl.of(i,e);return t.selectedLodestone.equalsValue(o)?(t.cancelMoveAttempt(),b.SUCCESS):(t.selectedLodestone=g.of(o),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),b.SUCCESS))})()}putLodestone(){var e=this;return M(function*(){Fe(e.selectedCoord.isPresent(),"coord should have been selected"),Fe(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=e.getState();Fe(pi.get().isLegalWithoutCaptures(i,t,n.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const s=pi.get().applyMoveWithoutPlacingCaptures(i,t,n);return e.lastInfos=g.of(s),e.capturesToPlace=Math.min(s.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(s.board),e.stateAfterPlacingLodestone=g.of(e.displayedState),e.updateViewInfo(),b.SUCCESS)})()}applyMove(){var e=this;return M(function*(){Fe(e.selectedCoord.isPresent(),"coord should have been selected"),Fe(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=new Gc(t,n.direction,n.orientation,e.captures);return e.chooseMove(i)})()}onPressurePlateClick(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}selectPressurePlate(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#plate_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());if(0===n.capturesToPlace)return n.cancelMove(vu.NO_CAPTURES_TO_PLACE_YET());n.capturesToPlace--,n.captures[e]++;const o=n.stateAfterPlacingLodestone.get(),s=n.getCurrentOpponent(),a=Re.copyBiArray(o.board),c={...o.pressurePlates},l=o.lodestones.getCopy();return pi.get().updatePressurePlates(a,c,l,s,n.captures),n.displayedState=new g1(a,o.turn,l,c),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),b.SUCCESS)})()}deselectPressurePlate(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#plate_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());n.capturesToPlace++,n.captures[e]--;const o=n.stateAfterPlacingLodestone.get(),s=n.getCurrentOpponent(),a=Re.copyBiArray(o.board),c={...o.pressurePlates},l=o.lodestones.getCopy();return pi.get().updatePressurePlates(a,c,l,s,n.captures),n.displayedState=new g1(a,o.turn,l,c),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),b.SUCCESS})()}updateBoard(e){var t=this;return M(function*(){t.cancelMoveAttempt(),t.scores=g.of(t.getState().getScores())})()}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=g.empty(),this.lastInfos=g.empty();const e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){const t=Re.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=yo.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=g.empty(),this.selectedLodestone=g.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const t=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(t),this.viewInfo.opponentClass=this.getPlayerClass(t.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let e=0;e<g1.SIZE;e++){this.viewInfo.boardInfo.push([]);for(let t=0;t<g1.SIZE;t++){const n=new C(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:g.empty()}getSquareInfo(e){const t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){const n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const e=this.getCurrentOpponent();this.viewInfo.capturesToPlace=[];for(let t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}nextLodestone(e,t){const n=Nl.of(e,t),i={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return i.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(i.selectedClass="selected-stroke"),i}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const e of q1.POSITIONS){const t=[],n=this.displayedState.pressurePlates[e];if(n.isPresent()){const i=Al.PRESSURE_PLATES_POSITIONS.get(e).get(),o=n.get().width;let s=5===o?i.startForBigPlate:i.startForSmallPlate;for(let a=0;a<o;a++){s=s.getNext(i.direction);const c=n.get().getPieceAt(a);let l="";c.isPlayerPiece()&&(l=this.getPlayerClass(c.owner)),t.push({coord:s,hasPiece:c.isPlayerPiece(),pieceClasses:[l],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:e,coords:t})}}showLastMove(e){var t=this;return M(function*(){const n=t.getPreviousState();t.lastInfos=g.of(pi.get().applyMoveWithoutPlacingCaptures(n,e.coord,e)),t.updateViewInfo();const i=t.getState();t.showPressurePlateDifferences(n,i,!1)})()}showPressurePlateDifferences(e,t,n){for(const i of q1.POSITIONS)this.showPressurePlateDifference(e.pressurePlates[i],t.pressurePlates[i],i,n)}showPressurePlateDifference(e,t,n,i){if(e.isPresent()&&t.isPresent()){const o=e.get(),s=t.get(),a=q.getNonNullable(this.viewInfo.pressurePlates.find(c=>c.position===n));if(o.width===s.width)for(let c=0;c<s.width;c++){const l=o.getPieceAt(c),f=s.getPieceAt(c);!1===l.equals(f)&&(a.coords[c].squareClasses.push("moved-fill"),a.coords[c].temporary=i,i&&a.coords[c].pieceClasses.push("semi-transparent"))}else for(const c of a.coords)c.squareClasses.push("moved-fill")}}showMovedAndCaptured(e){for(const t of e.moved)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved-fill");for(const t of e.captures)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),i=this.getPressurePlateShift(e.pressurePlates.top),o=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new St(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new St(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new St(0,.5*(i-o)),this.viewInfo.pressurePlateShift.right=new St(0,.5*(i-o))}getPressurePlateShift(e){return e.isAbsent()?2:3===e.get().width?1:0}getSquareTransform(e,t){return`translate(${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(e){return`translate(${(e+(g1.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(e){return`translate(${(e+(g1.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(e){return`translate(${this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE})`}}var qd,Zce;Ra=Al,u(Al,"PRESSURE_PLATE_EXTRA_SHIFT",.2),u(Al,"PRESSURE_PLATES_POSITIONS",un.from({top:{startForBigPlate:new C(.5,-1-Ra.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new C(1.5,0-Ra.PRESSURE_PLATE_EXTRA_SHIFT),direction:Me.RIGHT},bottom:{startForBigPlate:new C(.5,8+Ra.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new C(1.5,7+Ra.PRESSURE_PLATE_EXTRA_SHIFT),direction:Me.RIGHT},left:{startForBigPlate:new C(-1-Ra.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new C(0-Ra.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Me.DOWN},right:{startForBigPlate:new C(8+Ra.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new C(7+Ra.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Me.DOWN}})),u(Al,"\u0275fac",function(e){return new(e||Ra)(G(Ut))}),u(Al,"\u0275cmp",je({type:Ra,selectors:[["app-lodestone"]],features:[Qe],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,t){1&e&&(A(),S(0,"svg",0),T(1,wht,2,1,"g",1),T(2,Nht,2,4,"g",2),T(3,Iht,5,10,"g",3),T(4,Lht,2,2,"g",2),T(5,Rht,1,6,"rect",4),P()),2&e&&(_(1),y("ngForOf",t.viewInfo.boardInfo),_(1),y("ngForOf",t.viewInfo.capturesToPlace),_(1),y("ngForOf",t.viewInfo.availableLodestones),_(1),y("ngForOf",t.viewInfo.pressurePlates),_(1),y("ngIf",t.viewInfo.selected.isPresent()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class bt{static tryMerge(e,t){Fe(e!==bt.EMPTY&&t!==bt.EMPTY,"tryMerge cannot be called with empty pieces");const i=e.value+t.value;return 2===i||3===i?g.of(bt.of(i)):g.empty()}static of(e){return e===bt.DRONE.value?bt.DRONE:(q.expectToBe(e,bt.QUEEN.value),bt.QUEEN)}constructor(e){u(this,"value",void 0),this.value=e}getValue(){return this.value}equals(e){return this.getValue()===e.getValue()}}u(bt,"EMPTY",new(qd=bt)(0)),u(bt,"PAWN",new qd(1)),u(bt,"DRONE",new qd(2)),u(bt,"QUEEN",new qd(3));class k0{static of(e){const t=new un;for(const n of e)k0.addToMap(t,n);return new k0(t)}static addToMap(e,t){const n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}constructor(e){u(this,"captures",void 0),this.captures=e,e.makeImmutable()}toValue(){let e=0;return this.captures.forEach(t=>{e+=t.key.getValue()*t.value}),e}add(e){const t=this.captures.getCopy();return k0.addToMap(t,e),new k0(t)}}class bn extends B1{static getInitialState(){const e=bt.EMPTY,t=bt.PAWN,n=bt.DRONE,i=bt.QUEEN;return new bn([[i,i,n,e],[i,n,t,e],[n,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,n],[e,t,n,i],[e,n,i,i]],0,g.empty())}static isOnBoard(e){return e.isInRange(bn.WIDTH,bn.HEIGHT)}constructor(e,t,n=g.empty(),i=g.empty(),o){super(e,t),u(this,"lastMove",void 0),u(this,"countDown",void 0),u(this,"captured",void 0),this.lastMove=n,this.countDown=i,null==o&&(o=new un([{key:I.ZERO,value:k0.of([])},{key:I.ONE,value:k0.of([])}])),o.makeImmutable(),this.captured=o}getPlayerTerritory(e){return e===I.ZERO?bn.PLAYER_ZERO_TERRITORY:bn.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(e){const t=this.getCurrentPlayer(),n=this.getPlayerTerritory(t);for(const i of n)for(let o=0;o<bn.WIDTH;o++)if(this.getPieceAtXY(o,i)===e)return!0;return!1}getScoreOf(e){return this.captured.get(e).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(I.ZERO)?g.of(I.ZERO):this.isTerritoryEmpty(I.ONE)?g.of(I.ONE):g.empty()}isTerritoryEmpty(e){const t=this.getPlayerTerritory(e);for(const n of t)for(let i=0;i<bn.WIDTH;i++)if(this.getPieceAtXY(i,n)!==bt.EMPTY)return!1;return!0}isInOpponentTerritory(e){const t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}isInPlayerTerritory(e){const t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}getCapturesOf(e){const t=this.captured.get(e).get();return[t.captures.get(bt.PAWN).getOrElse(0),t.captures.get(bt.DRONE).getOrElse(0),t.captures.get(bt.QUEEN).getOrElse(0)]}}u(bn,"WIDTH",4),u(bn,"HEIGHT",8),u(bn,"PLAYER_ZERO_TERRITORY",new dt([4,5,6,7])),u(bn,"PLAYER_ONE_TERRITORY",new dt([0,1,2,3]));let FC=(()=>{class r{}return u(r,"START_COORD_OUT_OF_RANGE",()=>$localize`Start coord cannot be out of range`),u(r,"END_COORD_OUT_OF_RANGE",()=>$localize`End coord cannot be out of range`),u(r,"PAWN_MUST_MOVE_ONE_DIAGONAL_STEP",()=>$localize`Pawns must move one step diagonally.`),u(r,"DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS",()=>$localize`Drones must move one or two steps in any direction.`),r})();class wr extends Fs{static from(e,t,n=!1){if(!1===bn.isOnBoard(e))return ie.failure(FC.START_COORD_OUT_OF_RANGE());if(!1===bn.isOnBoard(t))return ie.failure(FC.END_COORD_OUT_OF_RANGE());if(t.equals(e))return ie.failure(Le.MOVE_CANNOT_BE_STATIC());const i=Me.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?ie.failure(i.getReason()):ie.success(new wr(e,t,n))}constructor(e,t,n){super(e,t),u(this,"calledTheClock",void 0),this.calledTheClock=n}toString(){const e=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+e+")"}equals(e){return!1!==super.equals(e)&&this.calledTheClock===e.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(e){if(e.isAbsent())return!1;const t=e.get();return t.getEnd().equals(this.getStart())&&t.getStart().equals(this.getEnd())}}Zce=wr,u(wr,"encoder",we.tuple([C.encoder,C.encoder,we.identity()],r=>[r.getStart(),r.getEnd(),r.calledTheClock],r=>Zce.from(r[0],r[1],r[2]).get()));let Yce=(()=>{class r{}return u(r,"YOU_DID_NOT_CAPTURE_ANY_PIECE",()=>$localize`Failed, you did not capture any piece.`),r})();const X=bt.EMPTY,gi=bt.PAWN,d4=bt.DRONE,Il=bt.QUEEN;class Kce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,bn.getInitialState()),W.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,bn.getInitialState()),W.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,bn.getInitialState(),wr.from(new C(2,5),new C(1,4)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.PAWN?b.SUCCESS:b.failure($localize`This is not a pawn!`),$localize`Congratulations!`),W.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,bn.getInitialState(),wr.from(new C(1,7),new C(0,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.DRONE?b.SUCCESS:b.failure($localize`This is not a drone!`),$localize`Congratulations!`),W.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new bn([[d4,gi,X,X],[Il,X,X,X],[X,X,X,X],[X,X,Il,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[Il,d4,gi,X]],1),wr.from(new C(2,3),new C(2,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.QUEEN?b.SUCCESS:b.failure($localize`This is not a queen!`),$localize`Congratulations!`),W.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new bn([[d4,gi,gi,X],[X,X,X,X],[Il,X,X,X],[X,X,X,X],[X,X,gi,X],[X,X,X,X],[X,X,X,X],[X,d4,gi,X]],1),[wr.from(new C(0,2),new C(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,Yce.YOU_DID_NOT_CAPTURE_ANY_PIECE()),W.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new bn([[X,X,X,Il],[X,gi,X,X],[X,X,gi,X],[X,X,X,X],[X,X,X,X],[X,X,X,Il],[X,X,d4,X],[X,gi,X,X]],1),[wr.from(new C(1,1),new C(2,2)).get(),wr.from(new C(2,2),new C(1,1)).get()],$localize`Congratulations!`,$localize`This is not a field promotion!`),W.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new bn([[gi,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,d4,X],[X,gi,X,X]],0),wr.from(new C(1,7),new C(2,6)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.QUEEN?b.SUCCESS:b.failure($localize`This is not a field promotion!`),$localize`Congratulations!`),W.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,bn.getInitialState(),wr.from(new C(1,5),new C(0,4),!0).get(),(t,n,i)=>t.calledTheClock?b.SUCCESS:b.failure($localize`You did not call the clock!`),$localize`Congratulations!`),W.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new bn([[X,X,X,X],[X,gi,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,gi],[X,X,d4,X],[X,gi,X,X]],15,g.empty(),g.of(1)),[wr.from(new C(1,1),new C(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),W.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new bn([[X,X,X,Il],[X,gi,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[d4,X,X,X],[X,X,X,X],[X,d4,X,X]],15,g.empty(),g.of(1)),wr.from(new C(1,1),new C(2,2)).get(),$localize`Congratulations!`),W.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new bn([[X,X,X,Il],[X,gi,X,X],[X,X,X,X],[X,X,X,X],[X,X,gi,X],[X,X,X,X],[X,X,X,X],[X,X,X,X]],0),wr.from(new C(2,4),new C(1,3)).get(),(t,n,i)=>3===t.getEnd().y?b.SUCCESS:b.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)])}}let $C=(()=>{class r{}return u(r,"MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY",()=>$localize`You must pick a piece from your side of the board in order to move it.`),u(r,"CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT",()=>$localize`This is not a valid promotion nor a valid capture.`),u(r,"CANNOT_UNDO_LAST_MOVE",()=>$localize`You cannot perform a move that is the reverse of the previous one.`),r})();class za extends Yn{static get(){return za.singleton.isAbsent()&&(za.singleton=g.of(new za)),za.singleton.get()}constructor(){super(bn)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();i[e.getStart().y][e.getStart().x]=bt.EMPTY;const o=n.finalPiece;i[e.getEnd().y][e.getEnd().x]=o;const s=n.score;let a=t.countDown;if(a.isPresent())if(this.isCapture(e,t))a=za.STARTING_COUNT_DOWN;else{const l=t.countDown.get();a=g.of(l-1)}return e.calledTheClock&&(a=za.STARTING_COUNT_DOWN),new bn(i,t.turn+1,g.of(e),a,s)}isLegal(e,t){this.assertNonDoubleClockCall(e,t);const n=this.isLegalMove(e,t);if(n.isFailure())return n.toOtherFallible();if(e.isUndoneBy(t.lastMove))return ie.failure($C.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);const i=t.getPieceAt(e.getStart()),o=t.captured.getCopy();if(this.isCapture(e,t)){const a=t.getCurrentPlayer();let c=o.get(a).get();const l=t.getPieceAt(e.getEnd());c=c.add(l),o.replace(a,c),o.makeImmutable()}return ie.success({finalPiece:i,score:o})}assertNonDoubleClockCall(e,t){Fe(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}isCapture(e,t){const n=t.isInOpponentTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==bt.EMPTY;return n&&i}isFieldPromotion(e,t){const n=t.isInPlayerTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==bt.EMPTY;return n&&i}isLegalFieldPromotion(e,t){const n=this.getPromotedPiece(e,t);if(n.isAbsent())return ie.failure($C.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const i=n.get();if(t.isTherePieceOnPlayerSide(i))return ie.failure($C.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const o={finalPiece:i,score:t.captured.getCopy()};return ie.success(o)}}isLegalMove(e,t){if(!1===t.isInPlayerTerritory(e.getStart()))return b.failure($C.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const i=t.getPieceAt(e.getStart());if(i===bt.EMPTY)return b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i===bt.PAWN)return e.isValidForPawn()?b.SUCCESS:b.failure(FC.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(i===bt.DRONE&&!1===e.isValidForDrone())return b.failure(FC.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const o of e.getStart().getUntil(e.getEnd()))if(t.getPieceAt(o)!==bt.EMPTY)return b.failure(Le.SOMETHING_IN_THE_WAY());return b.SUCCESS}getPromotedPiece(e,t){const n=t.getPieceAt(e.getStart()),i=t.getPieceAt(e.getEnd());return bt.tryMerge(n,i)}getGameStatus(e){const t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,ve.DRAW);if(t.getEmptyTerritory().isPresent()){const i=t.getCurrentOpponent(),o=ve.getVictory(i);return this.getGameStatusScoreVictoryOr(t,o)}return ve.ONGOING}getGameStatusScoreVictoryOr(e,t){const n=e.getScoreOf(I.ZERO),i=e.getScoreOf(I.ONE);return n>i?ve.ZERO_WON:i>n?ve.ONE_WON:t}}u(za,"STARTING_COUNT_DOWN",g.of(7)),u(za,"singleton",g.empty());class zht extends Sr{constructor(e,t){super(e,t)}getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),i=t.getPlayerTerritory(n);let o=[];for(const s of i)for(let a=0;a<bn.WIDTH;a++)switch(t.getPieceAtXY(a,s)){case bt.PAWN:o=o.concat(this.getMovesForPawnAt(t,a,s));break;case bt.DRONE:o=o.concat(this.getMovesForDroneAt(t,a,s));break;case bt.QUEEN:o=o.concat(this.getMovesForQueenAt(t,a,s))}return o}getMovesForPawnAt(e,t,n){const i=new C(t,n),o=[];for(const s of Me.DIAGONALS){const a=i.getNext(s);bn.isOnBoard(a)&&o.push(a)}return this.addLegalMoves(e,i,o)}addLegalMoves(e,t,n){const i=[],o=e.getPieceAt(t),s=!1===e.isTherePieceOnPlayerSide(bt.DRONE),a=!1===e.isTherePieceOnPlayerSide(bt.QUEEN),c=e.lastMove;for(const l of n){const f=e.getPieceAt(l);if(f===bt.EMPTY)this.add(i,wr.from(t,l).get(),c);else if(e.isInPlayerTerritory(l)){const d=bt.tryMerge(f,o);if(d.isPresent()){const m=d.get(),E=wr.from(t,l).get();(m===bt.DRONE&&s||m===bt.QUEEN&&a)&&this.add(i,E,c)}}else this.add(i,wr.from(t,l).get(),c)}return i}add(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}getMovesForDroneAt(e,t,n){const i=new C(t,n),o=this.getLandingCoordsForLinearMove(i,e,2);return this.addLegalMoves(e,i,o)}getLandingCoordsForLinearMove(e,t,n){const i=[];for(const o of Me.DIRECTIONS){let s=1,a=e.getNext(o,s),c=t.tryToGetPieceAt(a),l=c.equalsValue(bt.EMPTY);for(;l;)i.push(a),s++,a=e.getNext(o,s),c=t.tryToGetPieceAt(a),l=c.equalsValue(bt.EMPTY)&&s<n;c.isPresent()&&i.push(a)}return i}getMovesForQueenAt(e,t,n){const i=new C(t,n),o=this.getLandingCoordsForQueen(i,e);return this.addLegalMoves(e,i,o)}getLandingCoordsForQueen(e,t){return this.getLandingCoordsForLinearMove(e,t,bn.HEIGHT)}getMetrics(e){return[e.gameState.getScoreOf(I.ZERO),e.gameState.getScoreOf(I.ONE)]}}function Dht(r,e){if(1&r&&(A(),F(0,"g",19)),2&r){const t=p(2).index,n=p().index,i=p();ei(i.style),ye("mainShapeId","pawn_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function Hht(r,e){if(1&r&&(A(),F(0,"g",20)),2&r){const t=p(2).index,n=p().index,i=p();ei(i.style),ye("mainShapeId","drone_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function Vht(r,e){if(1&r&&(A(),F(0,"g",21)),2&r){const t=p(2).index,n=p().index,i=p();ei(i.style),ye("mainShapeId","queen_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function Fht(r,e){if(1&r&&(A(),S(0,"g"),T(1,Dht,1,5,"g",16),T(2,Hht,1,5,"g",17),T(3,Vht,1,5,"g",18),P()),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();k("transform",s.getPieceLocation(n,o)),_(1),y("ngIf",i===s.pieces.PAWN),_(1),y("ngIf",i===s.pieces.DRONE),_(1),y("ngIf",i===s.pieces.QUEEN)}}function $ht(r,e){if(1&r){const t=pe();A(),S(0,"g",14),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),F(1,"rect",15),T(2,Fht,4,4,"g",13),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();ye("id","click_",n,"_",i,""),k("transform",o.getPieceTranslation(i)),_(1),ye("id","square_",n,"_",i,""),y("ngClass",o.getSquareClasses(n,i)),k("x",n*o.SPACE_SIZE)("y",i*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t!==o.pieces.EMPTY)}}function Bht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",22),U("click",function(){const o=te(t).$implicit;return ne(p(3).onClick(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p(3);_(1),ye("id","indicator_",t.x,"_",t.y,""),k("transform",n.getPieceTranslation(t.y))("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function Ght(r,e){if(1&r&&(A(),S(0,"g"),T(1,Bht,2,7,"g",1),P()),2&r){const t=p(2);_(1),y("ngForOf",t.selectedPieceInfo.get().legalLandings)}}function Uht(r,e){if(1&r&&(A(),S(0,"g"),T(1,$ht,3,11,"g",12),T(2,Ght,2,1,"g",13),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",t),_(1),y("ngIf",n.selectedPieceInfo.isPresent())}}function Wht(r,e){if(1&r&&(A(),S(0,"text",23),lt(1),P()),2&r){const t=p();y("ngClass","player"+t.getCurrentPlayer().value)("ngClass",t.getClockCircleClasses()),k("x",.5*t.SPACE_SIZE)("y",.5*t.SPACE_SIZE),_(1),An(t.countDown.get())}}function qht(r,e){if(1&r&&(A(),F(0,"polyline",24)),2&r){const t=p();y("ngClass",t.getClockCircleClasses()),k("points",t.clockNeedlesPoints)}}const BC=function(r){return[r]};function jht(r,e){if(1&r){const t=pe();A(),Bt(0),S(1,"g",27),U("click",function(){const o=te(t).index;return ne(p(2).chooseStyle(o))}),P(),Gt()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);_(1),ei(t.style),y("id",t.name)("pieceClasses",pa(5,BC,"player"+i.getCurrentPlayer().value+"-fill")),k("transform","translate(0, "+-(n+1)*i.SPACE_SIZE+")")}}function Zht(r,e){if(1&r&&(A(),S(0,"g",25),F(1,"rect",26),T(2,jht,2,7,"ng-container",1),P()),2&r){const t=p();_(1),k("x",0)("y",-t.listOfStyles.length*t.SPACE_SIZE)("width",1*t.SPACE_SIZE)("height",t.listOfStyles.length*t.SPACE_SIZE),_(1),y("ngForOf",t.listOfStyles)}}function Yht(r,e){if(1&r&&(A(),S(0,"text",33),lt(1),P()),2&r){const t=p(2).$implicit,n=p().$implicit,i=p();y("ngClass",i.getPlayerClass(n)),k("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),_(1),An(t+" x ")}}function Kht(r,e){if(1&r&&(A(),F(0,"g",34)),2&r){const t=p(3).$implicit,n=p();ei(n.style),y("pieceClasses",pa(3,BC,n.getPlayerClass(t)))}}function Xht(r,e){if(1&r&&(A(),F(0,"g",35)),2&r){const t=p(3).$implicit,n=p();ei(n.style),y("pieceClasses",pa(3,BC,n.getPlayerClass(t)))}}function Qht(r,e){if(1&r&&(A(),F(0,"g",36)),2&r){const t=p(3).$implicit,n=p();ei(n.style),y("pieceClasses",pa(3,BC,n.getPlayerClass(t)))}}function Jht(r,e){if(1&r&&(A(),S(0,"g"),T(1,Yht,2,4,"text",29),S(2,"g",28),T(3,Kht,1,5,"g",30),T(4,Xht,1,5,"g",31),T(5,Qht,1,5,"g",32),P()()),2&r){const t=p(),n=t.index,i=t.$implicit,o=p().$implicit,s=p();k("transform","translate(0, "+2*n*s.SPACE_SIZE+")"),_(1),y("ngIf",i>1),_(1),ye("id","piece_",n,"_player_",o.value,""),k("transform","translate("+s.SPACE_SIZE+", 0)"),_(1),y("ngIf",0===n),_(1),y("ngIf",1===n),_(1),y("ngIf",2===n)}}function ept(r,e){if(1&r&&(A(),S(0,"g"),T(1,Jht,6,8,"g",13),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t>0)}}function tpt(r,e){if(1&r&&(A(),S(0,"g")(1,"g",28),T(2,ept,2,1,"g",1),P()()),2&r){const t=e.$implicit,n=p();_(1),Dn("id","capture_of_player_",t.value,""),k("transform",n.getCapturesTransformation(t)),_(1),y("ngForOf",n.state.getCapturesOf(t))}}let Mo=(()=>{var r;class e extends Vi{static getRegularPolygon(n,i=0){const o=e.getRegularPolygonCoords(n,i);return e.mapCoordsToString(o)}static getNPointedStar(n,i){const o=this.getNPointedStarCoords(n,i);return e.mapCoordsToString(o)}static getNPointedStarCoords(n,i){const o=[],s=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;n*=2;for(let c=0;c<n;c++){const f=(c*(360/n)+i)/180*Math.PI,d=c%2==0?e.SPACE_SIZE/2:e.SPACE_SIZE/6,m=s+.8*d*Math.cos(f),E=a+.8*d*Math.sin(f);o.push(new C(m,E))}return o}static getRegularPolygonCoords(n,i=0){const o=[],s=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;for(let c=0;c<n;c++){const f=(c*(360/n)-90)/180*Math.PI,d=.5*e.SPACE_SIZE,m=s+.8*d*Math.cos(f),E=a+.8*d*Math.sin(f)+i;o.push(new C(m,E))}return o}static mapCoordsToString(n){let i="";for(const o of n)i+=o.x+", "+o.y+" ";return i}static getRadius(n){return this.SPACE_SIZE*n/10}constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"HORIZONTAL_CENTER",.5*bn.WIDTH*e.SPACE_SIZE),u(this,"UNSTROKED_HEIGHT",bn.HEIGHT*e.SPACE_SIZE),u(this,"VERTICAL_CENTER",.5*this.UNSTROKED_HEIGHT+e.STROKE_WIDTH),u(this,"LEFT",e.SPACE_SIZE/-4+e.STROKE_WIDTH/-2),u(this,"UNSTROKED_WIDTH",bn.WIDTH*e.SPACE_SIZE),u(this,"UP",-e.STROKE_WIDTH/2),u(this,"WIDTH",this.UNSTROKED_WIDTH+2.5*e.SPACE_SIZE+e.STROKE_WIDTH),u(this,"HEIGHT",this.UNSTROKED_HEIGHT+3*e.STROKE_WIDTH),u(this,"MartianChessComponent",e),u(this,"style",{shape:"Circle",points:"Horizontal Points"}),u(this,"pieces",bt),u(this,"state",void 0),u(this,"configViewTranslation",void 0),u(this,"configCogTransformation",void 0),u(this,"selectedPieceInfo",g.empty()),u(this,"countDown",g.empty()),u(this,"callTheClock",!1),u(this,"displayModePanel",!1),u(this,"listOfStyles",[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}]),u(this,"clockNeedlesPoints",void 0),this.hasAsymmetricBoard=!0,this.rules=za.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new zht(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=e.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=wr.encoder,this.tutorial=(new Kce).tutorial,this.scores=g.of([0,0])}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const n=this.STROKE_WIDTH,o=(this.SPACE_SIZE-n)/40;return"translate("+1*n+", "+1*n+") scale("+o+" "+o+")"}getClockNeedlesPoints(){const n=.5*this.SPACE_SIZE;return n+" "+.1*this.SPACE_SIZE+", "+n+" "+n+", "+.75*this.SPACE_SIZE+" "+n}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.board=i.state.board;const o=i.state.getScoreOf(I.ZERO),s=i.state.getScoreOf(I.ONE);i.countDown=i.state.countDown,i.scores=g.of([o,s])})()}getPieceLocation(n,i){return"translate("+this.SPACE_SIZE*n+", "+this.SPACE_SIZE*i+")"}getPieceClasses(n,i){const o=new C(n,i),s=[];return s.push(i>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(o)&&s.push("selected-stroke"),this.node.move.isPresent()&&this.node.move.get().getEnd().equals(o)&&this.getPreviousState().getPieceAt(o)!==bt.EMPTY&&this.getState().isInOpponentTerritory(new C(0,i))&&s.push("last-move-stroke"),s}onClick(n,i){var o=this;return M(function*(){o.displayModePanel=!1;const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new C(n,i);return o.selectedPieceInfo.isPresent()?o.secondClick(a):o.firstClick(a)})()}firstClick(n){var i=this;return M(function*(){return i.isOneOfUsersPieces(n)?i.selectAsFirstPiece(n):(i.cancelMoveAttempt(),b.SUCCESS)})()}selectAsFirstPiece(n){var i=this;return M(function*(){const o=i.getLegalLandings(n);return i.selectedPieceInfo=g.of({selectedPiece:n,legalLandings:o}),b.SUCCESS})()}getLegalLandings(n){const i=this.state.getPieceAt(n);let o;return o=i===bt.PAWN?Me.DIAGONALS.map(s=>n.getNext(s)):this.getValidLinearLandingSquareUntil(n,i===bt.DRONE?2:bn.HEIGHT),o.filter(s=>{const a=wr.from(n,s);return!!a.isSuccess()&&this.rules.isLegal(a.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(n,i){return Me.DIRECTIONS.flatMap(o=>{const s=[];let a=n.getNext(o),c=1;for(;bn.isOnBoard(a)&&c<=i&&(s.push(a),this.getState().getPieceAt(a)===bt.EMPTY);)a=a.getNext(o),c++;return s})}secondClick(n){var i=this;return M(function*(){const o=i.selectedPieceInfo.get();if(o.selectedPiece.equals(n))return i.cancelMoveAttempt(),b.SUCCESS;if(o.legalLandings.some(s=>s.equals(n))){const s=wr.from(o.selectedPiece,n,i.callTheClock);return q.assert(s.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),i.chooseMove(s.get())}if(i.isOneOfUsersPieces(n))return i.selectAsFirstPiece(n);{const s=wr.from(o.selectedPiece,n,i.callTheClock);return s.isSuccess()?i.chooseMove(s.get()):i.cancelMove(s.getReason())}})()}isOneOfUsersPieces(n){return this.state.getPieceAt(n)!==bt.EMPTY&&this.state.isInPlayerTerritory(n)}cancelMoveAttempt(){this.selectedPieceInfo=g.empty(),this.callTheClock=!1}onClockClick(){var n=this;return M(function*(){const i=yield n.canUserPlay("#clockOrCountDownView");return i.isFailure()?n.cancelMove(i.getReason()):(n.getState().countDown.isAbsent()&&(n.callTheClock=!1===n.callTheClock),b.SUCCESS)})()}getClockCircleClasses(){const n=["base"];return this.callTheClock&&n.push("selected-stroke"),this.getCurrentPlayer()===I.ZERO?n.push("player0-stroke"):n.push("player1-stroke"),n}getSquareClasses(n,i){const o=new C(n,i),s=["base"];if(this.node.move.isPresent()){const a=this.node,c=a.move.get();c.getStart().equals(o)?s.push("moved-fill"):c.getEnd().equals(o)&&(a.mother.get().gameState.getPieceAt(o)===bt.EMPTY||a.gameState.isInOpponentTerritory(new C(0,i))?s.push("moved-fill"):s.push("captured-fill"))}return s}onModeCogClick(){this.displayModePanel=!1===this.displayModePanel}chooseStyle(n){this.style=this.listOfStyles[n].style,this.displayModePanel=!1}getPieceTranslation(n){return"translate(0, "+(n<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.role.value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(n){let s=this.SPACE_SIZE/2;return n===this.role&&(s+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+-this.SPACE_SIZE/2+", "+s+")"}}return r=e,u(e,"SPACE_SIZE",100),u(e,"STROKE_WIDTH",8),u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-martian-chess"]],features:[Qe],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g"),T(2,Uht,3,2,"g",1),P(),S(3,"g",2),U("click",function(){return i.onClockClick()}),F(4,"rect",3)(5,"circle",4),T(6,Wht,2,5,"text",5),T(7,qht,1,2,"polyline",6),P(),S(8,"g",7)(9,"g",8),U("click",function(){return i.onModeCogClick()}),F(10,"rect",3)(11,"path",9),P(),T(12,Zht,3,5,"g",10),P(),S(13,"g",11),T(14,tpt,3,3,"g",1),P()()),2&n&&(k("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),_(1),k("transform",i.getBoardTransformation()),_(1),y("ngForOf",i.board),_(1),k("transform","translate("+5.25*i.SPACE_SIZE+", 0)"),_(1),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngClass",i.getClockCircleClasses()),k("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE)("r",.4*i.SPACE_SIZE),_(1),y("ngIf",i.countDown.isPresent()),_(1),y("ngIf",i.countDown.isAbsent()),_(1),k("transform",i.configViewTranslation),_(2),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngClass",i.getPlayerClass(i.getCurrentPlayer())),k("transform",i.configCogTransformation),_(1),y("ngIf",i.displayModePanel),_(2),y("ngForOf",i.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Da=(()=>{class r extends B1{static getInitialState(){const t=Re.createTable(r.WIDTH,r.HEIGHT,K.NONE);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"WIDTH",7),u(r,"HEIGHT",6),r})();var h4;class er extends Ri{static of(e){switch(e){case 0:return er.ZERO;case 1:return er.ONE;case 2:return er.TWO;case 3:return er.THREE;case 4:return er.FOUR;case 5:return er.FIVE;case 6:return er.SIX;default:throw new Error("Invalid P4Move")}}constructor(e){super(),u(this,"x",void 0),this.x=e}equals(e){return this===e}toString(){return"P4Move("+this.x+")"}}u(er,"ZERO",new(h4=er)(0)),u(er,"ONE",new h4(1)),u(er,"TWO",new h4(2)),u(er,"THREE",new h4(3)),u(er,"FOUR",new h4(4)),u(er,"FIVE",new h4(5)),u(er,"SIX",new h4(6)),u(er,"encoder",we.tuple([we.identity()],r=>[r.x],r=>h4.of(r[0])));let npt=(()=>{class r{}return u(r,"COLUMN_IS_FULL",()=>$localize`Please put your piece in an incomplete column.`),r})();var jd,p4;let kl=(jd=class extends Yn{static get(){return p4.singleton.isAbsent()&&(p4.singleton=g.of(new p4)),p4.singleton.get()}static getVictoriousCoords(e){return p4.P4_HELPER.getVictoriousCoord(e)}static getLowestUnoccupiedSpace(e,t){let n=0;for(;n<Da.HEIGHT&&e[n][t]===K.NONE;)n++;return n-1}static getListMoves(e){const t=e.gameState,n=[];for(let i=0;i<Da.WIDTH;i++)if(t.getPieceAtXY(i,0)===K.NONE){const o=er.of(i);n.push(o)}return n}constructor(){super(Da)}applyLegalMove(e,t,n){const i=e.x,o=t.getCopiedBoard(),s=p4.getLowestUnoccupiedSpace(o,i),a=t.turn;return o[s][i]=t.getCurrentPlayer(),new Da(o,a+1)}isLegal(e,t){return t.getPieceAtXY(e.x,0).isPlayer()?b.failure(npt.COLUMN_IS_FULL()):b.SUCCESS}getGameStatus(e){const t=e.gameState;return p4.P4_HELPER.getVictoriousCoord(t).length>0?ve.getVictory(t.getCurrentOpponent()):42===t.turn?ve.DRAW:ve.ONGOING}},p4=jd,u(jd,"singleton",g.empty()),u(jd,"P4_HELPER",new cu(Da.isOnBoard,q.identity,4)),jd);kl=p4=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],kl);let eR=class extends ds{getListMoves(e){return kl.getListMoves(e).sort((t,n)=>Math.abs(t.x-3)-Math.abs(n.x-3))}getBoardValue(e){const t=e.gameState;let n=0;for(let i=0;i<Da.WIDTH;i++)for(let o=Da.HEIGHT-1;-1!==o&&t.board[o][i].isPlayer();o--){const s=kl.P4_HELPER.getSquareScore(t,new C(i,o));if(Di.getScoreStatus(s)===en.VICTORY)return new an(s);n+=s}return new an(n)}};eR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],eR);const it=K.NONE,g4=K.ZERO,Cu=K.ONE;class Xce extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,Da.getInitialState()),W.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,Da.getInitialState(),er.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),W.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new Da([[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,Cu,it,it,it],[it,it,it,Cu,it,it,it],[it,it,g4,g4,g4,Cu,it]],0),[er.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),W.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new Da([[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,g4,Cu,it,it],[it,it,g4,g4,Cu,it,it],[it,g4,Cu,g4,g4,it,it]],0),[er.of(3),er.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)])}}function opt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getSquareFillClass(t,n)),k("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function spt(r,e){if(1&r){const t=pe();A(),S(0,"g",5),U("click",function(){const o=te(t).index;return ne(p(2).onClick(o))}),F(1,"rect",6),T(2,opt,1,4,"circle",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();Dn("id","click_",n,""),_(1),k("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t!==o.EMPTY)}}function apt(r,e){if(1&r&&(A(),S(0,"g"),T(1,spt,3,6,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function cpt(r,e){if(1&r&&(A(),F(0,"rect",9)),2&r){const t=p();k("x",t.SPACE_SIZE*t.last.get().x)("y",t.SPACE_SIZE*t.last.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function lpt(r,e){if(1&r&&(A(),F(0,"rect",10)),2&r){const t=e.$implicit,n=p();ye("id","victory_coord_",t.x,"_",t.y,""),k("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let upt=(()=>{var r;class e extends Vi{constructor(n){super(n),u(this,"EMPTY",K.NONE),u(this,"last",void 0),u(this,"victoryCoords",[]),this.rules=kl.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new eR(this.rules,"P4Minimax")],this.encoder=er.encoder,this.tutorial=(new Xce).tutorial}onClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#click_"+n);if(o.isFailure())return i.cancelMove(o.getReason());const s=er.of(n);return yield i.chooseMove(s)})()}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.victoryCoords=kl.getVictoriousCoords(o),i.board=o.board})()}showLastMove(n){var i=this;return M(function*(){const o=i.getState(),s=kl.getLowestUnoccupiedSpace(o.board,n.x)+1;i.last=g.of(new C(n.x,s))})()}hideLastMove(){this.last=g.empty()}getSquareFillClass(n,i){return[this.getPlayerClass(this.board[i][n])]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-p4"]],features:[Qe],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,apt,2,1,"g",1),T(2,cpt,1,4,"rect",2),T(3,lpt,1,6,"rect",3),P()),2&n&&(_(1),y("ngForOf",i.board),_(1),y("ngIf",i.last.isPresent()),_(1),y("ngForOf",i.victoryCoords))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class E1 extends B1{static getInitialState(){const e=Re.createTable(E1.SIZE,E1.SIZE,K.NONE);return new E1(e,0)}static isOnBoard(e){return e.isInRange(E1.SIZE,E1.SIZE)}constructor(e,t){super(e,t),u(this,"neutralBlocks",void 0),this.neutralBlocks=this.getBlocksNeutralities()}getBlocksNeutralities(){const e=[];for(let t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}getBlockNeutrality(e){const t=E1.getBlockCenter(e),n=this.getPieceAt(t.getNext(Me.UP,1)),i=this.getPieceAt(t.getNext(Me.UP_LEFT,1));return this.getPieceAt(t.getNext(Me.RIGHT,1))===n&&this.getPieceAt(t.getNext(Me.DOWN,1))===n&&this.getPieceAt(t.getNext(Me.LEFT,1))===n&&this.getPieceAt(t.getNext(Me.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(Me.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(Me.DOWN_LEFT,1))===i}static getBlockCenter(e){return new C(1+(e%2==0?0:3),1+(e<2?0:3))}applyLegalDrop(e){const t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new E1(t,this.turn)}applyLegalMove(e){const t=this.applyLegalDrop(e),n=t.getCopiedBoard();if(e.blockTurned.isPresent()){const o=E1.getBlockCenter(e.blockTurned.get()).toVector();if(e.turnedClockwise)for(const s of E1.ROTATION_MAP){const a=s[0].getNext(o),c=s[1].getNext(o),l=t.getPieceAt(a);n[c.y][c.x]=l}else for(const s of E1.ROTATION_MAP){const a=s[1].getNext(o),c=s[0].getNext(o),l=t.getPieceAt(a);n[c.y][c.x]=l}}return new E1(n,this.turn+1)}blockIsNeutral(e){return this.neutralBlocks.includes(e)}}var Qce;u(E1,"SIZE",6),u(E1,"ROTATION_MAP",[[new C(-1,-1),new C(1,-1)],[new C(0,-1),new C(1,0)],[new C(1,-1),new C(1,1)],[new C(1,0),new C(0,1)],[new C(1,1),new C(-1,1)],[new C(0,1),new C(-1,0)],[new C(-1,1),new C(-1,-1)],[new C(-1,0),new C(0,-1)]]);class Wr extends Pr{static of(e,t,n){return new Wr(e.x,e.y,t,n)}static withRotation(e,t,n,i){return q.assert(0<=n&&n<=3,"This block does not exist: "+n),new Wr(e,t,g.of(n),i)}static rotationless(e,t){return new Wr(e,t,g.empty())}constructor(e,t,n,i=!1){super(e,t),u(this,"blockTurned",void 0),u(this,"turnedClockwise",void 0),this.blockTurned=n,this.turnedClockwise=i,q.assert(E1.isOnBoard(this.coord),"The board is a "+E1.SIZE+" space wide square, invalid coord: "+this.coord.toString())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}Qce=Wr,u(Wr,"encoder",we.tuple([C.encoder,g.getEncoder(we.identity()),we.identity()],r=>[r.coord,r.blockTurned,r.turnedClockwise],r=>Qce.of(r[0],r[1],r[2])));class GC extends Sr{getListMoves(e){const t=[],n=e.gameState.neutralBlocks;if(0===e.gameState.turn)return GC.FIRST_TURN_MOVES;const i=this.getLegalDrops(e.gameState);for(const o of i){const s=Wr.rotationless(o.x,o.y),a=e.gameState.applyLegalDrop(s),c=this.getLegalRotations(a,n);for(const f of c)t.push(Wr.withRotation(o.x,o.y,f[0],f[1]));0===a.neutralBlocks.length==0&&t.push(s)}return t}getLegalDrops(e){const t=[];for(let n=0;n<E1.SIZE;n++)for(let i=0;i<E1.SIZE;i++){const o=new C(i,n);e.getPieceAt(o)===K.NONE&&t.push(o)}return t}getLegalRotations(e,t){const n=0===e.neutralBlocks.length,i=[];for(let o=0;o<4;o++)!1===e.blockIsNeutral(o)&&(t.includes(o)?n&&i.push([o,!0]):i.push([o,!0],[o,!1]));return i}getMetrics(e){return[0,0]}}u(GC,"FIRST_TURN_MOVES",[Wr.rotationless(0,0),Wr.rotationless(1,0),Wr.rotationless(2,0),Wr.rotationless(0,1),Wr.rotationless(1,1),Wr.rotationless(0,2)]);let Jce=(()=>{class r{}return u(r,"CANNOT_ROTATE_NEUTRAL_BLOCK",()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`),u(r,"MUST_CHOOSE_BLOCK_TO_ROTATE",()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`),r})();class Uc extends Yn{static get(){return Uc.singleton.isAbsent()&&(Uc.singleton=g.of(new Uc)),Uc.singleton.get()}constructor(){super(E1)}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){if(t.getPieceAt(e.coord).isPlayer())return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());const n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return b.failure(Jce.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){const i=e.blockTurned.get();if(n.neutralBlocks.includes(i))return b.failure(Jce.CANNOT_ROTATE_NEUTRAL_BLOCK())}return b.SUCCESS}getVictoryCoords(e){let t=[];for(const n of Uc.VICTORY_SOURCE){const i=e.getPieceAt(n[0]),o=[n[0]];if(i.isPlayer()){let s=n[0].getNext(n[1]),a=!0;for(let c=0;c<3&&a;c++)e.getPieceAt(s)!==i?a=!1:(o.push(s),s=s.getNext(n[1]));if(a&&(e.getPieceAt(s)===i&&(o.push(s),t=t.concat(o)),n[2])){const c=n[0].getPrevious(n[1],1);e.getPieceAt(c)===i&&(o.push(c),t=t.concat(o))}}}return t}getGameStatus(e){const t=e.gameState,n=this.getVictoryCoords(t),i=[!1,!1];for(let o=0;o<n.length;o+=5)i[t.getPieceAt(n[o]).value]=!0;return!0===i[0]?!0===i[1]?ve.DRAW:ve.ZERO_WON:!0===i[1]?ve.ONE_WON:t.turn===E1.SIZE*E1.SIZE?ve.DRAW:ve.ONGOING}}u(Uc,"singleton",g.empty()),u(Uc,"VICTORY_SOURCE",[[new C(1,0),new St(1,1),!1],[new C(0,1),new St(1,1),!1],[new C(4,0),new St(-1,1),!1],[new C(5,1),new St(-1,1),!1],[new C(1,1),new St(1,1),!0],[new C(4,1),new St(-1,1),!0],[new C(0,1),new St(0,1),!0],[new C(1,1),new St(0,1),!0],[new C(2,1),new St(0,1),!0],[new C(3,1),new St(0,1),!0],[new C(4,1),new St(0,1),!0],[new C(5,1),new St(0,1),!0],[new C(1,0),new St(1,0),!0],[new C(1,1),new St(1,0),!0],[new C(1,2),new St(1,0),!0],[new C(1,3),new St(1,0),!0],[new C(1,4),new St(1,0),!0],[new C(1,5),new St(1,0),!0]]);const De=K.NONE,Wc=K.ZERO,m4=K.ONE;class e3e{constructor(){u(this,"tutorial",[W.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,E1.getInitialState()),W.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new E1([[Wc,De,De,Wc,m4,De],[Wc,m4,De,De,De,De],[Wc,De,m4,De,De,De],[Wc,De,De,De,De,m4],[Wc,De,De,De,m4,De],[De,De,De,De,De,De]],10)).withPreviousMove(Wr.withRotation(0,0,0,!1)),W.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new E1([[De,De,De,De,De,De],[De,Wc,De,De,m4,De],[De,De,De,De,De,De],[De,De,De,De,De,De],[De,m4,De,De,Wc,De],[De,De,De,De,De,De]],10),Wr.rotationless(2,2),(e,t,n)=>e.blockTurned.isPresent()?b.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):b.SUCCESS,$localize`Congratulations!`),W.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new E1([[De,De,De,De,De,De],[De,Wc,De,De,m4,De],[De,De,De,De,De,De],[De,De,De,De,De,De],[De,m4,De,De,Wc,De],[De,De,De,De,De,De]],10),Wr.withRotation(0,0,0,!0),(e,t,n)=>e.blockTurned.isPresent()?b.SUCCESS:b.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)])}}function fpt(r,e){if(1&r){const t=pe();A(),S(0,"circle",12),U("click",function(){const o=te(t).$implicit,s=p().$implicit,a=p().index,c=p().index;return ne(p().onClick(3*a+o,3*c+s))}),P()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p(),o=i.index,s=i.$implicit,a=p(),c=a.index,l=a.$implicit,f=p();ye("id","click_",3*o+t,"_",3*c+n,""),y("ngClass",f.getSquareClasses(3*o+t,3*c+n)),k("cx",s+2*f.STROKE_WIDTH+(t+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(n+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}const t3e=function(){return[0,1,2]};function dpt(r,e){1&r&&(A(),Bt(0),T(1,fpt,1,6,"circle",11),Gt()),2&r&&(_(1),y("ngForOf",_1(1,t3e)))}function hpt(r,e){if(1&r&&(A(),Bt(0),F(1,"rect",10),T(2,dpt,2,2,"ng-container",4),Gt()),2&r){const t=e.$implicit,n=e.index,i=p(),o=i.index,s=i.$implicit,a=p();_(1),y("ngClass",a.getBlockClasses(n,o)),k("x",a.STROKE_WIDTH+t)("y",a.STROKE_WIDTH+s)("rx",3*a.STROKE_WIDTH)("ry",3*a.STROKE_WIDTH)("width",a.BLOCK_WIDTH)("height",a.BLOCK_WIDTH),_(1),y("ngForOf",_1(8,t3e))}}const n3e=function(r){return[0,r]};function ppt(r,e){if(1&r&&(A(),Bt(0),T(1,hpt,3,9,"ng-container",4),Gt()),2&r){const t=p();_(1),y("ngForOf",pa(1,n3e,t.BLOCK_SEPARATION))}}function gpt(r,e){if(1&r&&(A(),F(0,"circle",13)),2&r){const t=p();ye("id","currentDrop_",t.currentDrop.get().x,"_",t.currentDrop.get().y,""),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),k("cx",t.getCenter(t.currentDrop.get().x))("cy",t.getCenter(t.currentDrop.get().y))("r",(t.SPACE_SIZE-t.STROKE_WIDTH)/2)}}function mpt(r,e){if(1&r){const t=pe();A(),S(0,"path",14),U("click",function(){const o=te(t).$implicit;return ne(p().rotate(o))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","rotate_",t.blockIndex,"_",t.clockwise?"clockwise":"counterclockwise",""),k("d",t.path)("stroke-width",2*n.STROKE_WIDTH)}}function _pt(r,e){if(1&r&&(A(),F(0,"path",15)),2&r){const t=p();ye("id","last_rotation_",t.lastRotation.get().blockIndex,"_",t.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),k("d",t.lastRotation.get().path)("stroke-width",2*t.STROKE_WIDTH)}}function vpt(r,e){if(1&r&&(A(),F(0,"circle",16)),2&r){const t=e.$implicit,n=p();ye("id","victoryCoord_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),k("cx",n.getCenter(t.x))("cy",n.getCenter(t.y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)("stroke-width",n.STROKE_WIDTH)}}function Cpt(r,e){if(1&r){const t=pe();A(),S(0,"g",17),U("click",function(){return te(t),ne(p().skipRotation())}),F(1,"circle",18)(2,"line",19),P()}if(2&r){const t=p();_(1),k("cx",t.BLOCK_SEPARATION)("cy",t.BLOCK_SEPARATION)("r",.75*t.SPACE_SIZE)("stroke-width",2*t.STROKE_WIDTH),_(1),k("x1",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("y1",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("x2",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("y2",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("stroke-width",2*t.STROKE_WIDTH)}}let ypt=(()=>{var r;class e extends Vi{constructor(n){super(n),u(this,"BLOCK_WIDTH",void 0),u(this,"BLOCK_SEPARATION",void 0),u(this,"DIAGONAL_BAR_OFFSET",void 0),u(this,"arrows",[]),u(this,"victoryCoords",[]),u(this,"canSkipRotation",void 0),u(this,"currentDrop",g.empty()),u(this,"movedBlock",g.empty()),u(this,"lastDrop",g.empty()),u(this,"lastRotation",g.empty()),u(this,"ARROWS",void 0),this.rules=Uc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new GC(this.rules,"PentagoMinimax")],this.encoder=Wr.encoder,this.tutorial=(new e3e).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord()}updateBoard(n){var i=this;return M(function*(){i.board=i.getState().getCopiedBoard(),i.victoryCoords=i.rules.getVictoryCoords(i.getState()),i.lastDrop=g.empty(),i.lastRotation=g.empty()})()}showLastMove(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.movedBlock=n.blockTurned;const o=new C(n.coord.x%3-1,n.coord.y%3-1);if(n.blockTurned.isPresent()&&(i.showLastRotation(n),!1===o.equals(new C(0,0))&&i.coordBelongToBlock(n)))return i.showLastDrop(n,o);i.lastDrop=g.of(n.coord)})()}showLastRotation(n){if(n.blockTurned.isPresent()){const i=n.blockTurned.get(),o=this.ARROWS.filter(s=>s.blockIndex===i&&s.clockwise===n.turnedClockwise)[0];this.lastRotation=g.of(o)}}showLastDrop(n,i){let o;o=n.turnedClockwise?q.getNonNullable(E1.ROTATION_MAP.find(f=>f[0].equals(i)))[1]:q.getNonNullable(E1.ROTATION_MAP.find(f=>f[1].equals(i)))[0];const s=n.blockTurned.get(),l=new C(s%2==0?1:4,s<2?1:4);o=o.getNext(l,1),this.lastDrop=g.of(o)}coordBelongToBlock(n){return n.blockTurned.equalsValue(2*(n.coord.y<3?0:1)+(n.coord.x<3?0:1))}hideLastMove(){this.lastDrop=g.empty(),this.movedBlock=g.empty(),this.lastRotation=g.empty(),this.victoryCoords=[]}generateArrowsCoord(){const n=2*this.BLOCK_SEPARATION,o=this.SPACE_SIZE,s=n-o,a=2*o,c=.5*this.SPACE_SIZE;return[{path:"M "+c+" 0 q  "+o+" -"+o+"  "+a+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+c+" q -"+o+"  "+o+"  0  "+a,blockIndex:0,clockwise:!1},{path:"M "+n+" "+c+" q  "+o+"  "+o+"  0  "+a,blockIndex:1,clockwise:!0},{path:"M "+s+" 0 q -"+o+" -"+o+" -"+a+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+s+" q -"+o+" -"+o+"  0 -"+a,blockIndex:2,clockwise:!0},{path:"M "+c+" "+n+" q  "+o+"  "+o+"  "+a+"  0",blockIndex:2,clockwise:!1},{path:"M "+s+" "+n+" q -"+o+"  "+o+" -"+a+"  0",blockIndex:3,clockwise:!0},{path:"M "+n+" "+s+" q  "+o+" -"+o+"  0 -"+a,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=g.empty(),this.canSkipRotation=!1}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());if(o.hideLastMove(),o.board[i][n].isPlayer())return o.cancelMove(Le.MUST_LAND_ON_EMPTY_SPACE());const a=Wr.rotationless(n,i),l=o.getState().applyLegalDrop(a);if(4===l.neutralBlocks.length)return o.chooseMove(a);const f=o.rules.getGameStatus(o.node);return o.canSkipRotation=l.neutralBlocks.length>0&&!1===f.isEndGame,o.currentDrop=g.of(new C(n,i)),o.displayArrows(l.neutralBlocks),b.SUCCESS})()}getCenter(n){return(n<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(n%3+.5)*this.SPACE_SIZE}displayArrows(n){this.arrows=[];for(let i=0;i<4;i++)if(!1===n.includes(i)){const o=this.ARROWS.filter(s=>s.blockIndex===i);this.arrows=this.arrows.concat(o)}}getBlockClasses(n,i){return this.movedBlock.equalsValue(n+2*i)?["last-move-stroke"]:[]}getSquareClasses(n,i){const o=[],s=this.getPlayerClass(this.board[i][n]);return o.push(s),this.lastDrop.equalsValue(new C(n,i))&&o.push("last-move-stroke"),o}rotate(n){var i=this;return M(function*(){const o=n.clockwise?"clockwise":"counterclockwise",s=yield i.canUserPlay("#rotate_"+n.blockIndex+"_"+o);if(s.isFailure())return i.cancelMove(s.getReason());const a=i.currentDrop.get(),c=Wr.withRotation(a.x,a.y,n.blockIndex,n.clockwise);return i.chooseMove(c)})()}skipRotation(){var n=this;return M(function*(){const i=yield n.canUserPlay("#skipRotation");if(i.isFailure())return n.cancelMove(i.getReason());const o=n.currentDrop.get(),s=Wr.rotationless(o.x,o.y);return n.chooseMove(s)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-pentago"]],features:[Qe],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs")(2,"marker",1),F(3,"polygon",2),P()(),S(4,"defs")(5,"marker",3),F(6,"polygon",2),P()(),T(7,ppt,2,3,"ng-container",4),T(8,gpt,1,6,"circle",5),T(9,mpt,1,4,"path",6),T(10,_pt,1,4,"path",7),T(11,vpt,1,7,"circle",8),T(12,Cpt,3,9,"g",9),P()),2&n&&(_(7),y("ngForOf",pa(6,n3e,i.BLOCK_SEPARATION)),_(1),y("ngIf",i.currentDrop.isPresent()),_(1),y("ngForOf",i.arrows),_(1),y("ngIf",i.lastRotation.isPresent()),_(1),y("ngForOf",i.victoryCoords),_(1),y("ngIf",i.canSkipRotation))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Ha=(()=>{class r extends B1{static getInitialState(){const t=Re.createTable(r.SIZE,r.SIZE,K.NONE);return t[9][9]=K.ONE,new r(t,[0,0],0)}constructor(t,n,i){super(t,i),u(this,"captures",void 0),this.captures=n}}return u(r,"SIZE",19),r})();class G2 extends Pr{static isOnBoard(e){return e.isInRange(Ha.SIZE,Ha.SIZE)}static of(e){return q.assert(G2.isOnBoard(e),"PenteMove: coord is out of the board"),new G2(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}u(G2,"encoder",Pr.getEncoder(G2.of));class Fo extends Yn{static get(){return Fo.singleton.isAbsent()&&(Fo.singleton=g.of(new Fo)),Fo.singleton.get()}constructor(){super(Ha)}isLegal(e,t){return t.getPieceAt(e.coord).isPlayer()?b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}applyLegalMove(e,t,n){const i=t.getCurrentPlayer(),o=t.getCopiedBoard();o[e.coord.y][e.coord.x]=i;const s=this.getCaptures(e.coord,t,i);for(const c of s)o[c.y][c.x]=K.NONE;const a=[t.captures[0],t.captures[1]];return a[i.value]+=s.length,new Ha(o,a,t.turn+1)}getCaptures(e,t,n){const i=n.getOpponent(),o=[];for(const s of Me.factory.all){const a=e.getNext(s,1),c=e.getNext(s,2),l=e.getNext(s,3);G2.isOnBoard(a)&&t.getPieceAt(a)===i&&G2.isOnBoard(c)&&t.getPieceAt(c)===i&&G2.isOnBoard(l)&&t.getPieceAt(l)===n&&(o.push(a),o.push(c))}return o}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();return t.captures[n.value]>=10||Fo.PENTE_HELPER.getVictoriousCoord(t).length>0?ve.getVictory(n):this.stillHaveEmptySquare(t)?ve.ONGOING:ve.DRAW}stillHaveEmptySquare(e){for(let t=0;t<Ha.SIZE;t++)for(let n=0;n<Ha.SIZE;n++)if(e.board[t][n]===K.NONE)return!0;return!1}}u(Fo,"PENTE_HELPER",new cu(G2.isOnBoard,q.identity,5)),u(Fo,"singleton",g.empty());class Mpt extends ds{getListMoves(e){const n=[];return e.gameState.forEachCoord((i,o)=>{!1===o.isPlayer()&&n.push(G2.of(i))}),n}getBoardValue(e){const t=Fo.get().getGameStatus(e);return t.isEndGame?an.fromWinner(t.winner):Fo.PENTE_HELPER.getBoardValue(e.gameState)}}const h=K.NONE,qc=K.ZERO,Va=K.ONE;class i3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the pieces are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a piece of the second player is in the center location of the board.`,Ha.getInitialState()),W.anyMove($localize`Dropping a piece`,$localize`At your turn, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,Ha.getInitialState(),G2.of(new C(9,8)),$localize`Congratulations!`),W.fromMove($localize`Capturing`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new Ha([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,qc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Va,qc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Va,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],3),[G2.of(new C(9,6))],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new Ha([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Va,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Va,qc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Va,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],4),[G2.of(new C(9,7))],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new Ha([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Va,h,h,qc,qc,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,qc,h,qc,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Va,qc,qc,qc,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Va,Va,Va,Va,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[8,8],7),[G2.of(new C(9,6)),G2.of(new C(8,9)),G2.of(new C(13,9))],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}function Ept(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function Spt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();ye("id","hoshi_",t,"_",n,""),k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.1*i.SPACE_SIZE)}}function Ppt(r,e){if(1&r&&(A(),F(0,"rect",9)(1,"line",10)(2,"line",10),T(3,Spt,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();k("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),k("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),k("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),y("ngIf",i.isHoshi(t,n))}}function Tpt(r,e){if(1&r){const t=pe();A(),S(0,"g",5),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),T(1,Ept,1,6,"circle",6),T(2,Ppt,4,13,"ng-template",null,7,dn),P()}if(2&r){const t=e.$implicit,n=e.index,i=ln(3);ye("id","click_",n,"_",p().index,""),_(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function Opt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Tpt,4,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function bpt(r,e){if(1&r){const t=pe();A(),S(0,"circle",13),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","capture_",t.x,"_",t.y,""),k("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.07*n.SPACE_SIZE)}}let wpt=(()=>{var r;class e extends xL{constructor(n){super(n),u(this,"lastMoved",g.empty()),u(this,"victoryCoords",[]),u(this,"captured",[]),this.scores=g.of([0,0]),this.rules=Fo.get(),this.node=this.rules.getInitialNode(),this.encoder=G2.encoder,this.tutorial=(new i3e).tutorial,this.availableMinimaxes=[new Mpt(this.rules,"Alignment")]}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.board,i.scores=g.of(i.getState().captures),i.victoryCoords=Fo.PENTE_HELPER.getVictoriousCoord(o),i.createHoshis(),i.cancelMoveAttempt()})()}showLastMove(n){var i=this;return M(function*(){i.lastMoved=g.of(n.coord);const o=i.getCurrentOpponent();i.captured=Fo.get().getCaptures(n.coord,i.getPreviousState(),o)})()}cancelMoveAttempt(){this.lastMoved=g.empty(),this.captured=[]}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new C(n,i);return o.chooseMove(G2.of(a))})()}getSpaceClass(n,i){const o=new C(n,i),s=this.getState().getPieceAt(o),a=[];return a.push(this.getPlayerClass(s)),this.victoryCoords.some(c=>c.equals(o))&&a.push("victory-stroke"),this.lastMoved.equalsValue(o)&&a.push("last-move-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-new-game"]],features:[Qe],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],[1,"captured-fill",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),F(1,"rect",1),T(2,Opt,2,1,"g",2),T(3,bpt,1,5,"circle",3),P()),2&n&&(k("viewBox","0 -3 "+i.board.length*i.SPACE_SIZE*.5+" "+(6+i.board.length*i.SPACE_SIZE*.5)),_(1),k("width",i.board.length*i.SPACE_SIZE*.5)("height",i.board.length*i.SPACE_SIZE*.5),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.captured))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Zd extends C{static getCoord3DEncoder(e){return we.tuple([we.identity(),we.identity(),we.identity()],t=>[t.x,t.y,t.z],t=>e(t[0],t[1],t[2]))}static of(e,t,n){return new Zd(e,t,n)}constructor(e,t,n){super(e,t),u(this,"z",void 0),this.z=n}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}isHigherThan(e){return this.z>e.z}}var tR;class fn extends Zd{static of(e,t,n){return new fn(e,t,n)}constructor(e,t,n){super(e,t,n),q.assert(0<=e&&e<=3,`PylosCoord: Invalid X: ${e}.`),q.assert(0<=t&&t<=3,`PylosCoord: Invalid Y: ${t}.`),q.assert(0<=n&&n<=3,`PylosCoord: Invalid Z: ${n}.`);const i=4-n;q.assert(this.isInRange(i,i),this.toString()+" is not in range.")}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const e=this.z-1;return[new fn(this.x,this.y,e),new fn(this.x+1,this.y,e),new fn(this.x,this.y+1,e),new fn(this.x+1,this.y+1,e)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const e=this.z+1,t=new C(this.x-1,this.y-1),n=new C(this.x,this.y-1),i=new C(this.x-1,this.y),o=new C(this.x,this.y),s=4-e;return[t,n,i,o].filter(a=>a.isInRange(s,s)).map(a=>new fn(a.x,a.y,e))}getNextValid(e){const t=new C(this.x,this.y).getNext(e),n=4-this.z;return t.isNotInRange(n,n)?g.empty():g.of(new fn(t.x,t.y,this.z))}}u(fn,"coordEncoder",Zd.getCoord3DEncoder((tR=fn).of)),u(fn,"optionalEncoder",g.getEncoder(tR.coordEncoder));let xl=(()=>{class r{}return u(r,"MUST_MOVE_UPWARD",()=>$localize`You must move your pieces upward.`),u(r,"SHOULD_HAVE_SUPPORTING_PIECES",()=>$localize`Your piece must land on the board or on 4 other pieces.`),u(r,"CANNOT_MOVE_SUPPORTING_PIECE",()=>$localize`You cannot move a supporting piece.`),u(r,"CANNOT_CAPTURE",()=>$localize`You cannot capture.`),u(r,"INVALID_FIRST_CAPTURE",()=>$localize`Your first capture is invalid.`),u(r,"INVALID_SECOND_CAPTURE",()=>$localize`Your second capture is invalid.`),r})();var o3e;let s3e=(()=>{class r{}return u(r,"MUST_CAPTURE_MAXIMUM_TWO_PIECES",()=>$localize`You must capture one or two pieces, not more.`),r})();class dr extends Ri{static ofClimb(e,t,n){const i=g.of(e),o=dr.checkCaptures(n),s=new dr(i,t,o.firstCapture,o.secondCapture);return q.assert(t.isHigherThan(e),xl.MUST_MOVE_UPWARD()),s}static checkCaptures(e){let t=g.empty(),n=g.empty();if(e.length>0&&(t=g.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=g.of(e[1]),e[1].isHigherThan(e[0])&&(t=g.of(e[1]),n=g.of(e[0])),e.length>2)throw new Error(s3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:n}}static ofDrop(e,t){const n=g.empty(),i=dr.checkCaptures(t);return new dr(n,e,i.firstCapture,i.secondCapture)}static changeCapture(e,t){const n=dr.checkCaptures(t);return new dr(e.startingCoord,e.landingCoord,n.firstCapture,n.secondCapture)}static of(e,t,n,i){return new dr(e,t,n,i)}constructor(e,t,n,i){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"firstCapture",void 0),u(this,"secondCapture",void 0),this.startingCoord=e,this.landingCoord=t,this.firstCapture=n,this.secondCapture=i}isClimb(){return this.startingCoord.isPresent()}toString(){const e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}equals(e){return e===this||!(!1===this.startingCoord.equals(e.startingCoord)||!1===this.landingCoord.equals(e.landingCoord)||!1===this.firstCapture.equals(e.firstCapture)||!1===this.secondCapture.equals(e.secondCapture))}}o3e=dr,u(dr,"encoder",we.tuple([fn.optionalEncoder,fn.coordEncoder,fn.optionalEncoder,fn.optionalEncoder],r=>[r.startingCoord,r.landingCoord,r.firstCapture,r.secondCapture],r=>o3e.of(r[0],r[1],r[2],r[3])));class Fa extends eC{static getInitialState(){const e=Re.createTable(4,4,K.NONE),t=Re.createTable(3,3,K.NONE),n=Re.createTable(2,2,K.NONE);return new Fa([e,t,n,[[K.NONE]]],0)}static getLevelRange(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return q.expectToBe(e,2),[0,1]}}constructor(e,t){super(t),u(this,"boards",void 0),this.boards=e}getPieceAt(e){return this.boards[e.z][e.y][e.x]}applyLegalMove(e,t=!0){const n=[];let i;return n.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&n.push({coord:e.startingCoord.get(),value:K.NONE}),e.firstCapture.isPresent()&&n.push({coord:e.firstCapture.get(),value:K.NONE}),e.secondCapture.isPresent()&&n.push({coord:e.secondCapture.get(),value:K.NONE}),i=t?this.turn+1:this.turn,this.setBoardAtCoords(n,i)}setBoardAtCoords(e,t){const n=[Re.copyBiArray(this.boards[0]),Re.copyBiArray(this.boards[1]),Re.copyBiArray(this.boards[2]),Re.copyBiArray(this.boards[3])];for(const i of e){const o=i.coord;n[o.z][o.y][o.x]=i.value}return new Fa(n,t)}isLandable(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;const t=e.getLowerPieces();for(const n of t)if(this.getPieceAt(n)===K.NONE)return!1;return!0}isSupporting(e){if(3===e.z)return!1;const t=e.getHigherCoords();for(const n of t)if(this.getPieceAt(n).isPlayer())return!0;return!1}getPiecesRepartition(){const e={};e[K.NONE.value]=0,e[I.ZERO.value]=0,e[I.ONE.value]=0;for(let t=0;t<3;t++)for(let n=0;n<4-t;n++)for(let i=0;i<4-t;i++){const o=new fn(i,n,t),s=this.getPieceAt(o);e[s.value]=1+e[s.value]}return e}removePieceAt(e){return this.setBoardAtCoords([{coord:e,value:K.NONE}],this.turn)}dropCurrentPlayersPieceAt(e){const t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}getFreeToMoves(){const e=[],t=this.getCurrentPlayer();for(let n=0;n<=2;n++){const i=Fa.getLevelRange(n);for(const o of i)for(const s of i){const a=new fn(s,o,n);this.getPieceAt(a).equals(t)&&!1===this.isSupporting(a)&&e.push(a)}}return e}}class C2 extends Yn{static get(){return C2.singleton.isAbsent()&&(C2.singleton=g.of(new C2)),C2.singleton.get()}constructor(){super(Fa)}static getStateInfo(e){const t=[],n=[];for(let i=0;i<3;i++)for(let o=0;o<4-i;o++)for(let s=0;s<4-i;s++){const a=new fn(s,o,i);e.getPieceAt(a)===e.getCurrentPlayer()&&!1===e.isSupporting(a)&&t.push(a),e.isLandable(a)&&n.push(a)}return{freeToMove:t,landable:n}}static getClimbingMoves(e){const t=[];for(const n of e.freeToMove)for(const i of e.landable)if(i.isHigherThan(n)&&!1===i.getLowerPieces().some(o=>n.equals(o))){const o=dr.ofClimb(n,i,[]);t.push(o)}return t}static getDropMoves(e){const t=[];for(const n of e.landable){const i=dr.ofDrop(n,[]);t.push(i)}return t}static canCapture(e,t){const n=e.getCurrentPlayer();for(const i of[ze.UP,ze.DOWN]){const o=t.getNextValid(i);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(const s of[ze.LEFT,ze.RIGHT]){const a=o.get().getNextValid(s);if(a.isPresent()&&e.getPieceAt(a.get())===n){const c=i.getOpposite(),l=a.get().getNextValid(c).get();if(e.getPieceAt(l)===n)return!0}}}return!1}static getPossibleCaptures(e){const t=new dt,n=e.getFreeToMoves();for(const i of n){t.add(new dt([i]));const s=e.removePieceAt(i).getFreeToMoves();for(const a of s){const c=new dt([i,a]);t.add(c)}}return t}static applyLegalMove(e,t,n){return t.applyLegalMove(e)}static isValidCapture(e,t,n){const i=e.getCurrentPlayer();return(!1!==n.equals(t.landingCoord)||e.getPieceAt(n)===i)&&0===n.getHigherCoords().filter(s=>e.getPieceAt(s).isPlayer()&&!1===s.equals(t.firstCapture.get())).length}static getGameStatus(e){const n=e.gameState.getPiecesRepartition();return 15===n[I.ZERO.value]?ve.ONE_WON:15===n[I.ONE.value]?ve.ZERO_WON:ve.ONGOING}applyLegalMove(e,t,n){return C2.applyLegalMove(e,t,n)}isLegal(e,t){const n=this.isLegalStartingCoord(e,t);if(n.isFailure())return n.toOtherFallible();const i=n.get(),o=this.isLegalLandingCoord(e,i);if(o.isFailure())return o.toOtherFallible();const s=o.get(),a=this.isLegalCaptures(e,s);return a.isFailure()?a:b.SUCCESS}isLegalStartingCoord(e,t){const n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){const i=e.startingCoord.get(),o=t.getPieceAt(i);if(o===n)return ie.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());if(o===K.NONE)return ie.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===i.getHigherCoords().filter(a=>t.getPieceAt(a).isPlayer()).length){const a=t.removePieceAt(e.startingCoord.get());return ie.success(a)}return ie.failure(xl.CANNOT_MOVE_SUPPORTING_PIECE())}return ie.success(t)}isLegalLandingCoord(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?ie.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?ie.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):ie.failure(xl.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(e,t){if(e.firstCapture.isAbsent())return b.SUCCESS;if(!1===C2.canCapture(t,e.landingCoord))return b.failure(xl.CANNOT_CAPTURE());if(C2.isValidCapture(t,e,e.firstCapture.get())){const n=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||C2.isValidCapture(n,e,e.secondCapture.get())?b.SUCCESS:b.failure(xl.INVALID_SECOND_CAPTURE())}return b.failure(xl.INVALID_FIRST_CAPTURE())}getGameStatus(e){return C2.getGameStatus(e)}}u(C2,"singleton",g.empty());class Yd extends Sr{static getListMoves(e){const t=e.gameState,n=[],i=C2.getStateInfo(t),o=C2.getClimbingMoves(i),s=C2.getDropMoves(i),a=o.concat(s);for(const c of a){const l=t.applyLegalMove(c,!1);let f=new dt;C2.canCapture(l,c.landingCoord)?f=C2.getPossibleCaptures(l):n.push(c);for(const d of f){const m=dr.changeCapture(c,d.toList());n.push(m)}}return n}getListMoves(e){return Yd.getListMoves(e)}getMetrics(e){const t=e.gameState.getPiecesRepartition();return[t[I.ZERO.value],t[I.ONE.value]]}}class yu extends Yd{static countStoneUsed(e){let t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}static sumMoveEmplacementByValue(e){let t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}getListMoves(e){const t=Yd.getListMoves(e);return this.orderMoves(t)}orderMoves(e){return e.sort((t,n)=>{const i=12*yu.countStoneUsed(t),o=12*yu.countStoneUsed(n);return i+yu.sumMoveEmplacementByValue(t)-(o+yu.sumMoveEmplacementByValue(n))})}}const Ge=K.NONE,_4=K.ZERO,a3e=K.ONE;class c3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,Fa.getInitialState()),W.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,Fa.getInitialState(),dr.ofDrop(new fn(1,1,0),[]),$localize`There you go, as simple as that.`),W.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new Fa([[[_4,a3e,Ge,Ge],[a3e,_4,Ge,Ge],[Ge,Ge,Ge,Ge],[Ge,Ge,Ge,_4]],[[Ge,Ge,Ge],[Ge,Ge,Ge],[Ge,Ge,Ge]],[[Ge,Ge],[Ge,Ge]],[[Ge]]],0),[dr.ofClimb(new fn(3,3,0),new fn(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),W.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new Fa([[[_4,_4,Ge,Ge],[Ge,_4,Ge,Ge],[Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge]],[[Ge,Ge,Ge],[Ge,Ge,Ge],[Ge,Ge,Ge]],[[Ge,Ge],[Ge,Ge]],[[Ge]]],0),[dr.ofDrop(new fn(0,1,0),[new fn(0,0,0)]),dr.ofDrop(new fn(0,1,0),[new fn(0,1,0)]),dr.ofDrop(new fn(0,1,0),[new fn(1,0,0)]),dr.ofDrop(new fn(0,1,0),[new fn(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),W.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new Fa([[[_4,_4,Ge,Ge],[Ge,_4,Ge,Ge],[Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge]],[[Ge,Ge,Ge],[Ge,Ge,Ge],[Ge,Ge,Ge]],[[Ge,Ge],[Ge,Ge]],[[Ge]]],0),dr.ofDrop(new fn(0,1,0),[new fn(0,0,0),new fn(1,0,0)]),(t,n,i)=>t.secondCapture.isPresent()?b.SUCCESS:t.firstCapture.isPresent()?b.failure($localize`Failed, you only captured one piece.`):b.failure(Yce.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)])}}function Npt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=e.$implicit,n=p().$implicit,i=p();ye("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),k("cx",i.SPACE_SIZE/4+t/15*(i.boardWidth-i.SPACE_SIZE/4))("cy",i.getPiecesCyForPlayer(n))("r",i.SPACE_SIZE/4-i.STROKE_WIDTH)}}function Apt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Npt,1,6,"circle",7),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getPlayerSidePieces(t))}}function Ipt(r,e){if(1&r){const t=pe();A(),S(0,"circle",12),U("click",function(){te(t);const i=p(2).$implicit,o=p().$implicit,s=p().$implicit;return ne(p().onPieceClick(i,o,s))}),P()}if(2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit,o=p();Oi("id","piece_",t,"_",n,"_",i,""),y("ngClass",o.getPieceClasses(t,n,i)),k("r",o.getPieceRadius(i)-o.STROKE_WIDTH)("cx",o.getPieceCx(t,n,i))("cy",o.getPieceCy(t,n,i))}}function kpt(r,e){if(1&r){const t=pe();A(),S(0,"rect",12),U("click",function(){te(t);const i=p(3).$implicit,o=p().$implicit,s=p().$implicit;return ne(p().onDrop(i,o,s))}),P()}if(2&r){const t=p(3).$implicit,n=p().$implicit,i=p().$implicit,o=p();Oi("id","drop_",t,"_",n,"_",i,""),y("ngClass",o.getSquareClasses(t,n,i)),k("width",2*o.getPieceRadius(i))("height",2*o.getPieceRadius(i))("x",o.getPieceCx(t,n,i)-o.getPieceRadius(i))("y",o.getPieceCy(t,n,i)-o.getPieceRadius(i))}}function xpt(r,e){if(1&r&&(A(),T(0,kpt,1,8,"rect",13)),2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit;y("ngIf",p().mustDisplayLandingCoord(t,n,i))}}function Lpt(r,e){if(1&r&&(A(),Bt(0),T(1,Ipt,1,7,"circle",10),T(2,xpt,1,1,"ng-template",null,11,dn),Gt()),2&r){const t=ln(3),n=p().$implicit,i=p().$implicit,o=p().$implicit,s=p();_(1),y("ngIf",s.isOccupied(n,i,o))("ngIfElse",t)}}function Rpt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Lpt,4,2,"ng-container",9),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p().$implicit,o=p();_(1),y("ngIf",o.mustDraw(t,n,i))}}function zpt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Rpt,2,1,"g",1),P()),2&r){const t=p().$implicit,n=p();_(1),y("ngForOf",n.getLevelRange(t))}}function Dpt(r,e){if(1&r&&(A(),S(0,"g"),T(1,zpt,2,1,"g",1),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getLevelRange(t))}}function Hpt(r,e){if(1&r&&(A(),F(0,"rect",14)),2&r){const t=p();Oi("id","highCapture_",t.highCapture.get().x,"_",t.highCapture.get().y,"_",t.highCapture.get().z,""),k("width",2*t.getPieceRadius(t.highCapture.get().z))("height",2*t.getPieceRadius(t.highCapture.get().z))("x",t.getPieceCxByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))("y",t.getPieceCyByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))}}function Vpt(r,e){if(1&r){const t=pe();A(),S(0,"g",15),U("click",function(){return te(t),ne(p().validateCapture())}),F(1,"circle",16)(2,"polygon",17),P()}if(2&r){const t=p();k("transform","translate("+4*t.SPACE_SIZE+" "+4*t.SPACE_SIZE+")"),_(1),y("ngClass",t.getCaptureValidationButtonClasses()),k("cx",t.STROKE_WIDTH/2)("cy",t.STROKE_WIDTH/2)("r",t.SPACE_SIZE/2)}}function Fpt(r,e){if(1&r){const t=pe();A(),S(0,"g",18),U("click",function(){const o=te(t).$implicit;return ne(p().onPieceClick(o.x,o.y,o.z))}),F(1,"line",19)(2,"line",19),P()}if(2&r){const t=e.$implicit,n=p();Oi("id","capturable_",t.x,"_",t.y,"_",t.z,""),k("transform","translate("+n.getPieceCxByCoord(t)+" "+n.getPieceCyByCoord(t)+")"),_(1),k("x1",-.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z)),_(1),k("x1",.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",-.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z))}}const $pt=function(){return[0,1,2]};let Bpt=(()=>{var r;class e extends Cl{constructor(n){super(n),u(this,"boardWidth",4*this.SPACE_SIZE+this.STROKE_WIDTH),u(this,"pieceRowHeight",this.SPACE_SIZE/2),u(this,"boardHeight",this.boardWidth+2*this.pieceRowHeight),u(this,"state",void 0),u(this,"constructedState",void 0),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"lastFirstCapture",g.empty()),u(this,"lastSecondCapture",g.empty()),u(this,"highCapture",g.empty()),u(this,"capturables",[]),u(this,"chosenStartingCoord",g.empty()),u(this,"chosenLandingCoord",g.empty()),u(this,"chosenFirstCapture",g.empty()),u(this,"chosenSecondCapture",g.empty()),u(this,"lastMove",g.empty()),u(this,"remainingPieces",{0:15,1:15}),this.hasAsymmetricBoard=!0,this.rules=C2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Yd(this.rules,"PylosMinimax"),new yu(this.rules,"PylosOrderedMinimax")],this.encoder=dr.encoder,this.tutorial=(new c3e).tutorial}getPiecesCyForPlayer(n){return n===I.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(n){return Fa.getLevelRange(n)}mustDraw(n,i,o){const s=new fn(n,i,o);return!!(this.constructedState.getPieceAt(s).isPlayer()||this.justClimbed(s)||this.isCaptured(s))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(s)}isCaptured(n){return this.chosenFirstCapture.equalsValue(n)||this.chosenSecondCapture.equalsValue(n)}onPieceClick(n,i,o){var s=this;return M(function*(){const a=yield s.canUserPlay("#piece_"+n+"_"+i+"_"+o);if(a.isFailure())return s.cancelMove(a.getReason());const c=new fn(n,i,o);return s.state.getPieceAt(c)===s.state.getCurrentOpponent()?s.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):s.chosenStartingCoord.equalsValue(c)?(s.cancelMoveAttempt(),b.SUCCESS):s.chosenLandingCoord.isPresent()?s.isSupporting(c,s.constructedState)?s.cancelMove(xl.CANNOT_MOVE_SUPPORTING_PIECE()):s.onCaptureClick(c):s.isSupporting(c,s.getState())?s.cancelMove(xl.CANNOT_MOVE_SUPPORTING_PIECE()):s.onClimbClick(c)})()}isSupporting(n,i){return i.isSupporting(n)}onClimbClick(n){var i=this;return M(function*(){return i.chosenStartingCoord=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),b.SUCCESS})()}onCaptureClick(n){var i=this;return M(function*(){return i.chosenFirstCapture.equalsValue(n)?(i.chosenFirstCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenSecondCapture.equalsValue(n)?(i.chosenSecondCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenFirstCapture.isAbsent()?(i.chosenFirstCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenSecondCapture.isAbsent()?(i.chosenSecondCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),b.SUCCESS):i.cancelMove(s3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var n=this;return M(function*(){const i=yield n.canUserPlay("#capture_validation");return i.isFailure()?n.cancelMove(i.getReason()):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isAbsent()?b.SUCCESS:n.chosenFirstCapture.isPresent()&&n.chosenSecondCapture.isAbsent()?n.concludeMoveWithCapture([n.chosenFirstCapture.get()]):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isPresent()?n.concludeMoveWithCapture([n.chosenSecondCapture.get()]):n.concludeMoveWithCapture([n.chosenFirstCapture.get(),n.chosenSecondCapture.get()])})()}concludeMoveWithCapture(n){var i=this;return M(function*(){if(i.chosenStartingCoord.isAbsent()){const o=dr.ofDrop(i.chosenLandingCoord.get(),n);return i.chooseMove(o)}{const o=dr.ofClimb(i.chosenStartingCoord.get(),i.chosenLandingCoord.get(),n);return i.chooseMove(o)}})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=g.empty(),this.chosenLandingCoord=g.empty(),this.chosenFirstCapture=g.empty(),this.chosenSecondCapture=g.empty(),this.capturables=[]}onDrop(n,i,o){var s=this;return M(function*(){const a=yield s.canUserPlay("#drop_"+n+"_"+i+"_"+o);if(a.isFailure())return s.cancelMove(a.getReason());const c=new fn(n,i,o);return C2.canCapture(s.constructedState,c)?(s.chosenLandingCoord=g.of(c),s.constructedState=s.constructedState.dropCurrentPlayersPieceAt(c),s.updateCapturableList(),b.SUCCESS):(s.chosenLandingCoord=g.of(c),s.concludeMoveWithCapture([]))})()}getSquareClasses(n,i,o){const s=new fn(n,i,o);if(this.lastMove.isPresent()){const a=this.lastMove.get();if(a.firstCapture.equalsValue(s)||a.secondCapture.equalsValue(s))return["captured-fill"];if(s.equals(a.landingCoord)||a.startingCoord.equalsValue(s))return["moved-fill"]}else if(this.justClimbed(s))return["moved-fill"];return[]}justClimbed(n){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(n)}getPieceRadius(n){return this.SPACE_SIZE*(.45+.025*n)}getPieceCx(n,i,o){return this.SPACE_SIZE/2+.5*o*this.SPACE_SIZE+n*this.SPACE_SIZE}getPieceCy(n,i,o){return this.SPACE_SIZE/2+.5*o*this.SPACE_SIZE+i*this.SPACE_SIZE}getPieceCxByCoord(n){return this.getPieceCx(n.x,n.y,n.z)}getPieceCyByCoord(n){return this.getPieceCy(n.x,n.y,n.z)}isOccupied(n,i,o){const s=new fn(n,i,o);if(this.justClimbed(s))return!1;const a=this.getState().getPieceAt(s).isPlayer(),c=this.chosenLandingCoord.equalsValue(s);return a||c}getPieceClasses(n,i,o){const s=new fn(n,i,o),a=[this.getPieceFillClass(s)];return(this.lastLandingCoord.equalsValue(s)||this.lastStartingCoord.equalsValue(s))&&a.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(s)||this.chosenLandingCoord.equalsValue(s))&&a.push("selected-stroke"),this.isCaptured(s)&&a.push("pre-captured-fill"),a}getPieceFillClass(n){return this.chosenLandingCoord.equalsValue(n)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(n))}getPlayerSidePieces(n){const i=this.remainingPieces[n.value],o=[];for(let s=0;s<i;s++)o.push(s);return o}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.constructedState=i.state,i.lastMove=i.node.move;const o=i.state.getPiecesRepartition();i.remainingPieces={0:15-o[0],1:15-o[1]},i.highCapture=g.empty(),i.cancelMoveAttempt(),i.hideLastMove()})()}showLastMove(n){var i=this;return M(function*(){i.lastLandingCoord=g.of(n.landingCoord),i.lastStartingCoord=n.startingCoord,i.lastFirstCapture=n.firstCapture,i.lastSecondCapture=n.secondCapture,i.lastFirstCapture.isPresent()&&!1===i.mustDrawCoord(i.lastFirstCapture.get())&&(i.highCapture=i.lastFirstCapture)})()}hideLastMove(){this.lastStartingCoord=g.empty(),this.lastLandingCoord=g.empty(),this.lastFirstCapture=g.empty(),this.lastSecondCapture=g.empty()}mustDrawCoord(n){return this.mustDraw(n.x,n.y,n.z)}mustDisplayLandingCoord(n,i,o){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new fn(n,i,o))||this.chosenStartingCoord.get().z<o}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-pylos"]],features:[Qe],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g"),T(2,Apt,2,1,"g",1),P(),S(3,"g",null,2),F(5,"rect",3),T(6,Dpt,2,1,"g",1),T(7,Hpt,1,7,"rect",4),T(8,Vpt,3,5,"g",5),T(9,Fpt,3,12,"g",6),P()()),2&n&&(k("viewBox","0 0 "+i.boardWidth+" "+i.boardHeight),_(1),k("transform","rotate("+180*i.role.value+" "+i.boardWidth/2+" "+i.boardHeight/2+")"),_(1),y("ngForOf",i.Player.PLAYERS),_(1),k("transform","translate("+i.STROKE_WIDTH/2+" "+(i.STROKE_WIDTH/2+i.pieceRowHeight)+")"),_(2),k("width",4*i.SPACE_SIZE)("height",4*i.SPACE_SIZE),_(1),y("ngForOf",_1(10,$pt)),_(1),y("ngIf",i.highCapture.isPresent()),_(1),y("ngIf",i.chosenLandingCoord.isPresent()),_(1),y("ngForOf",i.capturables))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var kn,l3e;class yt{static ofInt(e){if(0<=e&&e<=15)return yt.pieces[e];if(16===e)return yt.EMPTY;throw new Error("Invalid piece ("+e+")")}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}u(yt,"AAAA",new(kn=yt)(0)),u(yt,"AAAB",new kn(1)),u(yt,"AABA",new kn(2)),u(yt,"AABB",new kn(3)),u(yt,"ABAA",new kn(4)),u(yt,"ABAB",new kn(5)),u(yt,"ABBA",new kn(6)),u(yt,"ABBB",new kn(7)),u(yt,"BAAA",new kn(8)),u(yt,"BAAB",new kn(9)),u(yt,"BABA",new kn(10)),u(yt,"BABB",new kn(11)),u(yt,"BBAA",new kn(12)),u(yt,"BBAB",new kn(13)),u(yt,"BBBA",new kn(14)),u(yt,"BBBB",new kn(15)),u(yt,"EMPTY",new kn(16)),u(yt,"pieces",[kn.AAAA,kn.AAAB,kn.AABA,kn.AABB,kn.ABAA,kn.ABAB,kn.ABBA,kn.ABBB,kn.BAAA,kn.BAAB,kn.BABA,kn.BABB,kn.BBAA,kn.BBAB,kn.BBBA,kn.BBBB]),u(yt,"encoder",we.fromFunctions(r=>r.value,kn.ofInt));class jc extends Pr{constructor(e,t,n){super(e,t),u(this,"piece",void 0),this.piece=n}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(e){return this===e||!1!==e.coord.equals(this.coord)&&this.piece===e.piece}}l3e=jc,u(jc,"encoder",we.tuple([C.encoder,yt.encoder],r=>[r.coord,r.piece],r=>new l3e(r[0].x,r[0].y,r[1])));class $a extends B1{constructor(e,t,n){super(e,t),u(this,"pieceInHand",void 0),this.pieceInHand=n}static getInitialState(){const e=Re.createTable(4,4,yt.EMPTY);return new $a(e,0,yt.AAAA)}static isGivable(e,t,n){return e!==n&&!1===$a.isAlreadyOnBoard(e,t)}static isAlreadyOnBoard(e,t){for(let n=0;n<4;n++)for(let i=0;i<4;i++)if(t[n][i]===e)return!0;return!1}getRemainingPieces(){const e=yt.pieces,t=[];for(const n of e)$a.isGivable(n,this.board,this.pieceInHand)&&t.push(n);return t}}let nR=(()=>{class r{}return u(r,"MUST_GIVE_A_PIECE",()=>$localize`You must give a piece.`),u(r,"PIECE_ALREADY_ON_BOARD",()=>$localize`That piece is already on the board.`),u(r,"CANNOT_GIVE_PIECE_IN_HAND",()=>$localize`You cannot give the piece that was in your hands.`),r})();class Kd{constructor(e){u(this,"subCriterion",[g.empty(),g.empty(),g.empty(),g.empty()]),this.subCriterion[0]=g.of(8==(8&e.value)),this.subCriterion[1]=g.of(4==(4&e.value)),this.subCriterion[2]=g.of(2==(2&e.value)),this.subCriterion[3]=g.of(1==(1&e.value))}mergeWith(e){let t=4;for(let n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=g.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}mergeWithQuartoPiece(e){const t=new Kd(e);return this.mergeWith(t)}areAllAbsent(){for(let e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}match(e){for(let t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}matchPiece(e){return this.match(new Kd(e))}toString(){return"Criterion{"+this.subCriterion.map(e=>e.isPresent()?e.get()?"1":"0":"x").join(" ")+"}"}}class Zc{constructor(e,t){u(this,"initialCoord",void 0),u(this,"direction",void 0),this.initialCoord=e,this.direction=t}allCoords(){const e=[];for(let t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}class Nr extends Yn{static get(){return Nr.singleton.isAbsent()&&(Nr.singleton=g.of(new Nr)),Nr.singleton.get()}constructor(){super($a)}static isOccupied(e){return e!==yt.EMPTY}static isLegal(e,t){const n=e.coord.x,i=e.coord.y,o=e.piece,s=t.getCopiedBoard(),a=t.pieceInHand;return Nr.isOccupied(s[i][n])?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):o===yt.EMPTY?15===t.turn?b.SUCCESS:b.failure(nR.MUST_GIVE_A_PIECE()):$a.isAlreadyOnBoard(o,s)?b.failure(nR.PIECE_ALREADY_ON_BOARD()):a===o?b.failure(nR.CANNOT_GIVE_PIECE_IN_HAND()):b.SUCCESS}isLegal(e,t){return Nr.isLegal(e,t)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=t.pieceInHand,new $a(i,t.turn+1,e.piece)}static updateBoardStatus(e,t,n){return n.score===en.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:en.VICTORY,sensitiveSquares:new G1}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}static isThereAVictoriousLine(e,t){let n=e.initialCoord,i=t.getPieceAt(n);const o=new Kd(i);for(let s=0;s<3&&!1!==Nr.isOccupied(i)&&!o.areAllAbsent();s++)n=n.getNext(e.direction,1),i=t.getPieceAt(n),o.mergeWithQuartoPiece(i);return!(!Nr.isOccupied(i)||!1!==o.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(e,t,n){const i=Nr.getLineInfos(e,t,n);if(i.boardStatus.isPresent())return i.boardStatus.get();const o=i.commonCriterion,s=i.sensitiveCoord;if(o.isPresent()&&!1===o.get().areAllAbsent()){if(s.isAbsent())return{score:en.VICTORY,sensitiveSquares:new G1};{o.get().matchPiece(t.pieceInHand)&&(n.score=en.PRE_VICTORY);const a=s.get();n.sensitiveSquares.add(a)}}return n}static getLineInfos(e,t,n){let i=g.empty(),o=g.empty(),s=e.initialCoord;for(let a=0;a<4;a++){const c=t.getPieceAt(s);if(c===yt.EMPTY){if(!i.isAbsent())return{sensitiveCoord:g.of(s),commonCriterion:o,boardStatus:g.of(n)};i=g.of(s)}else o.isAbsent()?(o=g.of(new Kd(c)),Ae.display("QuartoRules","getLineInfos","set commonCrit to "+o.toString())):(o.get().mergeWithQuartoPiece(c),Ae.display("QuartoRules","getLineInfos","update commonCrit: "+o.toString()));s=s.getNext(e.direction,1)}return{commonCriterion:o,sensitiveCoord:i,boardStatus:g.empty()}}static scoreToGameStatus(e,t){const n=I.of(t%2);return e===en.VICTORY?ve.getDefeat(n):16===t?ve.DRAW:ve.ONGOING}getGameStatus(e){const t=e.gameState;let n={score:en.DEFAULT,sensitiveSquares:new G1};for(const i of Nr.lines)if(n=Nr.updateBoardStatus(i,t,n),n.score===en.VICTORY)return Nr.scoreToGameStatus(n.score,t.turn);return Nr.scoreToGameStatus(n.score,t.turn)}getVictoriousCoords(e){for(const t of Nr.lines)if(Nr.isThereAVictoriousLine(t,e))return t.allCoords();return[]}}u(Nr,"singleton",g.empty()),u(Nr,"lines",[new Zc(new C(0,0),Me.DOWN),new Zc(new C(1,0),Me.DOWN),new Zc(new C(2,0),Me.DOWN),new Zc(new C(3,0),Me.DOWN),new Zc(new C(0,0),Me.RIGHT),new Zc(new C(0,1),Me.RIGHT),new Zc(new C(0,2),Me.RIGHT),new Zc(new C(0,3),Me.RIGHT),new Zc(new C(0,0),Me.DOWN_RIGHT),new Zc(new C(0,3),Me.UP_RIGHT)]);class rR extends ds{static scoreToBoardValue(e,t){if(e===en.DEFAULT)return new an(0);{const n=I.of(t%2);return new an(e===en.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}getListMoves(e){const t=[],n=e.gameState,i=n.getCopiedBoard(),o=n.getRemainingPieces(),s=n.pieceInHand;let a;for(let c=0;c<4;c++)for(let l=0;l<4;l++)if(i[c][l]===yt.EMPTY){if(a=n.getCopiedBoard(),a[c][l]=s,15===n.turn){const f=new jc(l,c,yt.EMPTY);return t.push(f),t}for(const f of o){const d=new jc(l,c,f);t.push(d)}}return t}getBoardValue(e){const t=e.gameState;let n={score:en.DEFAULT,sensitiveSquares:new G1};for(const i of Nr.lines)if(n=Nr.updateBoardStatus(i,t,n),n.score===en.VICTORY)break;return rR.scoreToBoardValue(n.score,t.turn)}}const Gpt=yt.AABA,Upt=yt.AABB,u3e=yt.ABAA,Wpt=yt.ABAB,qpt=yt.ABBA,f3e=yt.BAAA,jpt=yt.BAAB,Zpt=yt.BABB,d3e=yt.BBAA,Ypt=yt.BBAB,iR=yt.BBBA,Kpt=yt.BBBB,Qn=yt.EMPTY;class h3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new $a([[iR,d3e,u3e,Gpt],[Qn,Qn,Qn,Qn],[Qn,Qn,Qn,Qn],[Qn,Qn,Qn,Qn]],7,yt.ABAB)),W.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new $a([[iR,Upt,qpt,Qn],[Qn,Qn,Qn,Qn],[Qn,f3e,Qn,Qn],[Qn,Qn,Qn,Qn]],7,yt.ABAA),new jc(2,2,yt.BAAB),$localize`Perfect!`),W.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new $a([[Kpt,iR,Ypt,Qn],[u3e,Zpt,d3e,Qn],[Wpt,f3e,jpt,Qn],[Qn,Qn,Qn,Qn]],7,yt.AABA),[new jc(3,3,yt.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)])}}function Xpt(r,e){if(1&r&&(A(),F(0,"rect",12)),2&r){const t=p(2),n=t.$implicit,i=t.index,o=p().index,s=p();y("ngClass",s.getPieceClasses(n.value)),k("x",s.SPACE_SIZE*i+(s.SPACE_SIZE/2-s.getPieceSize(n.value)))("y",s.SPACE_SIZE*o+(s.SPACE_SIZE/2-s.getPieceSize(n.value)))("width",2*s.getPieceSize(n.value))("height",2*s.getPieceSize(n.value))}}function Qpt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2),n=t.$implicit,i=t.index,o=p().index,s=p();y("ngClass",s.getPieceClasses(n.value)),k("cx",s.SPACE_SIZE*i+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.SPACE_SIZE/2)("r",s.getPieceSize(n.value))}}function Jpt(r,e){if(1&r&&(A(),F(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();k("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function egt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Xpt,1,5,"rect",10),T(2,Qpt,1,4,"ng-template",null,11,dn),T(4,Jpt,1,3,"circle",7),P()),2&r){const t=ln(3),n=p().$implicit,i=p(2);_(1),y("ngIf",n.isRectangle())("ngIfElse",t),_(3),y("ngIf",i.pieceHasDot(n.value))}}function tgt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",9),U("click",function(){const o=te(t).index,s=p().index;return ne(p().chooseCoord(o,s))}),P(),T(2,egt,5,3,"g",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),ye("id","chooseCoord_",n,"_",i,""),y("ngClass",o.getSquareClasses(n,i)),k("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t!==o.EMPTY)}}function ngt(r,e){if(1&r&&(A(),S(0,"g",null,8),T(2,tgt,3,8,"g",2),P()),2&r){const t=e.$implicit;_(2),y("ngForOf",t)}}function rgt(r,e){if(1&r&&(A(),F(0,"rect",17)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),k("x",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("y",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function igt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),k("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",t.getPieceSize(t.pieceInHand.value))}}function ogt(r,e){if(1&r&&(A(),F(0,"circle")),2&r){const t=p(2);k("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",10)}}function sgt(r,e){if(1&r){const t=pe();A(),S(0,"g",13,14),U("click",function(){return te(t),ne(p().deselectDroppedPiece())}),F(2,"rect",15),T(3,rgt,1,5,"rect",16),T(4,igt,1,4,"ng-template",null,11,dn),T(6,ogt,1,3,"circle",7),P()}if(2&r){const t=ln(5),n=p();ye("id","droppedPiece_",n.chosen.get().x,"_",n.chosen.get().y,""),k("transform","translate("+n.chosen.get().x*n.SPACE_SIZE+" "+n.chosen.get().y*n.SPACE_SIZE+")"),_(2),k("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),_(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),_(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function agt(r,e){if(1&r&&(A(),S(0,"g",null,18),F(2,"rect",19),P()),2&r){const t=e.$implicit,n=p();_(2),k("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)("transform","translate("+t.x*n.SPACE_SIZE+" "+t.y*n.SPACE_SIZE+")")}}function cgt(r,e){if(1&r&&(A(),F(0,"rect",12)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),k("x",0)("y",.75*t.SPACE_SIZE)("transform","translate("+-t.getPieceSize(t.pieceInHand.value)+", "+-t.getPieceSize(t.pieceInHand.value)+")")("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function lgt(r,e){if(1&r&&(A(),F(0,"circle",21)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),k("cy",.75*t.SPACE_SIZE)("r",t.getPieceSize(t.pieceInHand.value))}}function ugt(r,e){1&r&&(A(),F(0,"circle",22)),2&r&&k("cy",.75*p(2).SPACE_SIZE)("r",10)}function fgt(r,e){if(1&r&&(A(),S(0,"g"),T(1,cgt,1,6,"rect",10),T(2,lgt,1,3,"ng-template",null,11,dn),T(4,ugt,1,2,"circle",20),P()),2&r){const t=ln(3),n=p();_(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),_(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function dgt(r,e){if(1&r&&(A(),F(0,"rect",27)),2&r){const t=p(2).index,n=p().index,i=p();Dn("id","chosenPiece_",4*n+t,""),k("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function hgt(r,e){if(1&r&&(A(),F(0,"rect",12)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),k("x",i.SPACE_SIZE*t+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("y",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("width",2*i.getPieceSize(4*n+t))("height",2*i.getPieceSize(4*n+t))}}function pgt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),k("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.getPieceSize(4*n+t))}}function ggt(r,e){if(1&r&&(A(),F(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();k("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function mgt(r,e){if(1&r){const t=pe();A(),S(0,"g",13),U("click",function(){te(t);const i=p().index,o=p().index;return ne(p().choosePiece(4*o+i))}),T(1,dgt,1,5,"rect",26),T(2,hgt,1,5,"rect",10),T(3,pgt,1,4,"ng-template",null,11,dn),T(5,ggt,1,3,"circle",7),P()}if(2&r){const t=ln(4),n=p().index,i=p().index,o=p();Dn("id","choosePiece_",4*i+n,""),_(1),y("ngIf",o.pieceToGive.equalsValue(o.QuartoPiece.ofInt(4*i+n))),_(1),y("ngIf",(4*i+n)%4<2)("ngIfElse",t),_(3),y("ngIf",o.pieceHasDot(4*i+n))}}function _gt(r,e){if(1&r&&(A(),S(0,"g"),T(1,mgt,6,5,"g",3),P()),2&r){const t=e.index,n=p().index,i=p();_(1),y("ngIf",i.isRemaining(4*n+t))}}function vgt(r,e){if(1&r&&(A(),S(0,"g",null,23),F(2,"rect",24,25),T(4,_gt,2,1,"g",2),P()),2&r){const t=e.$implicit,n=p();k("transform","translate(0 "+6.5*n.SPACE_SIZE+")"),_(2),k("x",-.125*n.SPACE_SIZE)("y",-.125*n.SPACE_SIZE)("width",4.25*n.SPACE_SIZE)("height",4.25*n.SPACE_SIZE),_(2),y("ngForOf",t)}}let Cgt=(()=>{var r;class e extends Vi{constructor(n){super(n),u(this,"EMPTY",yt.EMPTY),u(this,"QuartoPiece",yt),u(this,"chosen",g.empty()),u(this,"lastMove",g.empty()),u(this,"pieceInHand",yt.EMPTY),u(this,"pieceToGive",g.empty()),u(this,"victoriousCoords",[]),this.rules=Nr.get(),this.node=this.rules.getInitialNode(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new rR(this.rules,"QuartoMinimax")],this.encoder=jc.encoder,this.tutorial=(new h3e).tutorial,this.pieceInHand=this.getState().pieceInHand}updateBoard(n){var i=this;return M(function*(){const o=i.getState(),s=i.node.move;i.board=o.getCopiedBoard(),i.chosen=g.empty(),i.pieceInHand=o.pieceInHand,i.victoriousCoords=i.rules.getVictoriousCoords(o),i.lastMove=s.map(a=>a.coord)})()}chooseCoord(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#chooseCoord_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());if(o.hideLastMove(),o.board[i][n]===yt.EMPTY){if(o.showPieceInHandOnBoard(n,i),15===o.getState().turn){const a=new jc(n,i,yt.EMPTY);return o.chooseMove(a)}if(o.pieceToGive.isAbsent())return b.SUCCESS;{const a=new jc(n,i,o.pieceToGive.get());return o.chooseMove(a)}}return o.cancelMove(Le.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#choosePiece_"+n);if(o.isFailure())return i.cancelMove(o.getReason());if(i.hideLastMove(),i.pieceToGive.equalsValue(yt.ofInt(n)))return i.cancelMoveAttempt(),b.SUCCESS;if(i.pieceToGive=g.of(yt.ofInt(n)),i.chosen.isAbsent())return b.SUCCESS;{const s=i.chosen.get(),a=new jc(s.x,s.y,i.pieceToGive.get());return i.chooseMove(a)}})()}hideLastMove(){this.lastMove=g.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=g.empty(),this.chosen=g.empty()}deselectDroppedPiece(){var n=this;return M(function*(){const i=n.chosen.getOrElse(new C(404,404)),o="#droppedPiece_"+i.x+"_"+i.y,s=yield n.canUserPlay(o);return s.isFailure()?n.cancelMove(s.getReason()):(n.cancelMoveAttempt(),b.SUCCESS)})()}showPieceInHandOnBoard(n,i){this.chosen=g.of(new C(n,i))}isRemaining(n){return $a.isGivable(yt.ofInt(n),this.board,this.pieceInHand)}getSquareClasses(n,i){const o=new C(n,i);return this.lastMove.equalsValue(o)?["moved-fill"]:[]}getPieceClasses(n){const i=[];return i.push(n%2==0?"player0-fill":"player1-fill"),i}getPieceSize(n){return n<8?40:25}pieceHasDot(n){return n!==yt.EMPTY.value&&n%8<4}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-quarto"]],features:[Qe],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g",1),T(2,ngt,3,1,"g",2),T(3,sgt,7,8,"g",3),T(4,agt,3,3,"g",2),S(5,"g",null,4),F(7,"rect",5,6),T(9,fgt,5,3,"g",7),P(),T(10,vgt,5,6,"g",2),P()()),2&n&&(k("viewBox","0 0 "+4.25*i.SPACE_SIZE+" "+10.75*i.SPACE_SIZE),_(2),y("ngForOf",i.board),_(1),y("ngIf",i.chosen.isPresent()),_(1),y("ngForOf",i.victoriousCoords),_(1),k("transform","translate("+2*i.SPACE_SIZE+", "+4.5*i.SPACE_SIZE+")"),_(2),k("width",1.5*i.SPACE_SIZE)("height",1.5*i.SPACE_SIZE)("transform","translate("+-.75*i.SPACE_SIZE+", 0)"),_(2),y("ngIf",i.chosen.isAbsent()),_(1),y("ngForOf",i.board))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),ygt=(()=>{class r{}return u(r,"NO_INSIDE_CLICK",()=>$localize`You must pick a space from the edge of the board.`),r})(),tr=(()=>{class r extends B1{static getInitialState(){const t=Re.createTable(r.SIZE,r.SIZE,K.NONE);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}applyLegalMove(t){const n=this.getCopiedBoard(),i=this.turn+1;let o=t.coord,s=t.coord.getNext(t.direction);for(;r.isOnBoard(s);)n[o.y][o.x]=n[s.y][s.x],o=o.getNext(t.direction),s=s.getNext(t.direction);return n[o.y][o.x]=this.getCurrentPlayer(),new r(n,i)}}return u(r,"SIZE",5),r})();var p3e;class Yc extends Pr{static isValidCoord(e){return!1===tr.isOnBoard(e)?b.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&e.x!==tr.SIZE-1&&0!==e.y&&e.y!==tr.SIZE-1?b.failure(ygt.NO_INSIDE_CLICK()):b.SUCCESS}constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n;const i=Yc.isValidCoord(this.coord);if(i.isFailure())throw new Error(i.getReason());if(0===e&&n===ze.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(e===tr.SIZE-1&&n===ze.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===t&&n===ze.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(t===tr.SIZE-1&&n===ze.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(e){return e===this||!1!==e.coord.equals(this.coord)&&e.direction===this.direction}}p3e=Yc,u(Yc,"encoder",we.tuple([C.encoder,ze.encoder],r=>[r.coord,r.direction],r=>new p3e(r[0].x,r[0].y,r[1])));class U2 extends Yn{static get(){return U2.singleton.isAbsent()&&(U2.singleton=g.of(new U2)),U2.singleton.get()}constructor(){super(tr)}static getVerticalCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let i=0;i<tr.SIZE;i++)e.gameState.getPieceAtXY(0,i)!==t&&n.push(new C(0,i)),e.gameState.getPieceAtXY(tr.SIZE-1,i)!==t&&n.push(new C(tr.SIZE-1,i));return n}static getHorizontalCenterCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let i=1;i<tr.SIZE-1;i++)e.gameState.getPieceAtXY(i,0)!==t&&n.push(new C(i,0)),e.gameState.getPieceAtXY(i,tr.SIZE-1)!==t&&n.push(new C(i,tr.SIZE-1));return n}static getPossibleDirections(e){const t=[];return 0!==e.x&&t.push(ze.LEFT),0!==e.y&&t.push(ze.UP),e.x!==tr.SIZE-1&&t.push(ze.RIGHT),e.y!==tr.SIZE-1&&t.push(ze.DOWN),t}static getLinesSums(e){const t={};t[I.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[I.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(const n of e.getCoordsAndContents()){const i=n.content,o=n.coord.x,s=n.coord.y;if(i.isPlayer()){const a=i.value;t[a].columns[o]=t[a].columns[o]+1,t[a].rows[s]=t[a].rows[s]+1,o===s&&(t[a].diagonals[0]=t[a].diagonals[0]+1),o+s===tr.SIZE-1&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}static getVictoriousCoords(e){return U2.QUIXO_HELPER.getVictoriousCoord(e)}static getFullestLine(e){const t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max(...t)}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):b.SUCCESS}getGameStatus(e){const t=e.gameState,i=U2.QUIXO_HELPER.getVictoriousCoord(t).map(s=>t.getPieceAt(s)),o=new dt(i);return 0===o.size()?ve.ONGOING:1===o.size()?ve.getVictory(o.getAnyElement().get()):ve.getVictory(t.getCurrentPlayer())}}u(U2,"singleton",g.empty()),u(U2,"QUIXO_HELPER",new cu(tr.isOnBoard,q.identity,tr.SIZE));class Mgt extends Sr{getListMoves(e){const t=[],n=U2.getVerticalCoords(e),o=U2.getHorizontalCenterCoords(e).concat(n);for(const s of o){const a=U2.getPossibleDirections(s);for(const c of a){const l=new Yc(s.x,s.y,c);t.push(l)}}return t}getMetrics(e){const n=U2.getLinesSums(e.gameState);return[U2.getFullestLine(n[I.ZERO.value]),U2.getFullestLine(n[I.ONE.value])]}}const S1=K.NONE,ea=K.ZERO,Ba=K.ONE;class g3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,tr.getInitialState()),W.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new tr([[S1,S1,S1,S1,S1],[S1,S1,S1,S1,S1],[S1,S1,S1,S1,S1],[S1,S1,S1,S1,S1],[ea,ea,ea,ea,S1]],1),[new Yc(4,4,ze.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),W.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new tr([[S1,Ba,S1,Ba,Ba],[S1,ea,ea,S1,ea],[Ba,Ba,Ba,ea,Ba],[ea,S1,ea,Ba,Ba],[Ba,ea,S1,Ba,ea]],31),[new Yc(3,0,ze.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)])}}function Egt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"circle",4),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onBoardClick(o,s))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ye("id","click_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),k("r",.45*i.SPACE_SIZE)("cx",(t+.5)*i.SPACE_SIZE)("cy",(n+.5)*i.SPACE_SIZE)}}function Sgt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Egt,2,6,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Pgt(r,e){if(1&r){const t=pe();A(),S(0,"use",6),U("click",function(){const o=te(t).$implicit;return ne(p(2).chooseDirection(o))}),P()}if(2&r){const t=e.$implicit,n=p(2);Dn("id","chooseDirection_",t,""),k("transform",n.getArrowTransform(t))}}function Tgt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Pgt,1,2,"use",5),P()),2&r){const t=p();_(1),y("ngForOf",t.getPossiblesDirections())}}let Ogt=(()=>{var r;class e extends Vi{constructor(n){super(n),u(this,"QuixoState",tr),u(this,"state",void 0),u(this,"lastMoveCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenDirection",void 0),u(this,"victoriousCoords",[]),this.rules=U2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Mgt(this.rules,"QuixoMinimax")],this.encoder=Yc.encoder,this.tutorial=(new g3e).tutorial}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.board=i.state.board,i.lastMoveCoord=i.node.move.map(o=>o.coord),i.victoriousCoords=U2.getVictoriousCoords(i.state)})()}cancelMoveAttempt(){this.chosenCoord=g.empty()}getPieceClasses(n,i){const o=new C(n,i),a=[];return a.push(this.getPlayerClass(this.board[i][n])),this.chosenCoord.equalsValue(o)?a.push("selected-stroke"):this.lastMoveCoord.equalsValue(o)&&a.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(o))&&a.push("victory-stroke"),a}onBoardClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new C(n,i),c=Yc.isValidCoord(a);return c.isFailure()?o.cancelMove(c.getReason()):o.board[i][n]===o.state.getCurrentOpponent()?o.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(o.chosenCoord.equalsValue(a)?o.cancelMoveAttempt():o.chosenCoord=g.of(a),b.SUCCESS)})()}getPossiblesDirections(){const n=[],i=this.chosenCoord.get();return i.x!==tr.SIZE-1&&n.push(ze.RIGHT),0!==i.x&&n.push(ze.LEFT),i.y!==tr.SIZE&&n.push(ze.DOWN),0!==i.y&&n.push(ze.UP),n}chooseDirection(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#chooseDirection_"+n.toString());return o.isFailure()?i.cancelMove(o.getReason()):(i.chosenDirection=n,yield i.tryMove())})()}tryMove(){var n=this;return M(function*(){const i=n.chosenCoord.get(),o=new Yc(i.x,i.y,n.chosenDirection);return n.chooseMove(o)})()}getArrowTransform(n){return ndt.getArrowTransform(tr.SIZE*this.SPACE_SIZE,new C(0,0),n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-quixo"]],features:[Qe],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs"),F(2,"polygon",1),P(),T(3,Sgt,2,1,"g",2),T(4,Tgt,2,1,"g",3),P()),2&n&&(k("viewBox","0 0 "+i.QuixoState.SIZE*i.SPACE_SIZE+" "+i.QuixoState.SIZE*i.SPACE_SIZE),_(3),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),t2=(()=>{class r extends B1{static getInitialState(){const t=Re.createTable(r.BOARD_WIDTH,r.BOARD_HEIGHT,K.NONE);return t[3][3]=I.ZERO,t[4][4]=I.ZERO,t[3][4]=I.ONE,t[4][3]=I.ONE,new r(t,0)}static isOnBoard(t){return t.isInRange(r.BOARD_WIDTH,r.BOARD_HEIGHT)}static getNeighboringPawnLike(t,n,i,o){let s;const a=[];for(let c=-1;c<2;c++)for(let l=-1;l<2;l++)s=new C(i+l,o+c),r.isOnBoard(s)&&t[s.y][s.x]===n&&a.push(s);return a}countScore(){const t=[0,0];for(let n=0;n<r.BOARD_HEIGHT;n++)for(let i=0;i<r.BOARD_WIDTH;i++){const o=this.board[n][i];o.isPlayer()&&(t[o.value]+=1)}return t}}return u(r,"BOARD_WIDTH",8),u(r,"BOARD_HEIGHT",8),r})();var oR;class Ui extends Pr{static of(e){return new Ui(e.x,e.y)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}u(Ui,"encoder",Pr.getEncoder((oR=Ui).of)),u(Ui,"PASS",new oR(-1,-1));let bgt=(()=>{class r{}return u(r,"NO_ELEMENT_SWITCHED",()=>$localize`Your move should switch at least one piece.`),r})();var UC,ta;class m3e{constructor(e,t){u(this,"move",void 0),u(this,"switched",void 0),this.move=e,this.switched=t}}let Mu=(UC=class extends Yn{static get(){return ta.singleton.isAbsent()&&(ta.singleton=g.of(new ta)),ta.singleton.get()}constructor(){super(t2)}static getGameStatus(e){const t=e.gameState;if(!1===ta.isGameEnded(t))return ve.ONGOING;const i=t.countScore(),o=i[1]-i[0];return o<0?ve.ZERO_WON:o>0?ve.ONE_WON:ve.DRAW}applyLegalMove(e,t,n){const i=t.turn,o=t.getCurrentPlayer(),s=t.getCopiedBoard();if(e.equals(Ui.PASS))return new t2(s,i+1);for(const c of n)s[c.y][c.x]=o;return s[e.coord.y][e.coord.x]=o,new t2(s,i+1)}static getAllSwitcheds(e,t,n){const i=[],o=t.getOpponent();for(const s of Me.DIRECTIONS){const a=e.coord.getNext(s);if(t2.isOnBoard(a)&&n[a.y][a.x]===o){const c=ta.getSandwicheds(t,s,a,n);for(const l of c)i.push(l)}}return i}static getSandwicheds(e,t,n,i){const o=[n];let s=n.getNext(t);for(;t2.isOnBoard(s);){const a=i[s.y][s.x];if(a===e)return o;if(a===K.NONE)return[];o.push(s),s=s.getNext(t)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(e){return ta.getGameStatus(e)}static playerCanOnlyPass(e){const t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(Ui.PASS)}static nextPlayerCantOnlyPass(e){const t=e.getCopiedBoard(),i=new t2(t,e.turn+1);return this.playerCanOnlyPass(i)}static getListMoves(e){const t=[];let n;const i=e.getCurrentPlayer(),o=e.getCurrentOpponent();for(let s=0;s<8;s++)for(let a=0;a<8;a++)if(e.getPieceAtXY(a,s)===K.NONE&&(n=e.getCopiedBoard(),t2.getNeighboringPawnLike(n,o,a,s).length>0)){const l=new Ui(a,s),f=ta.getAllSwitcheds(l,i,n);if(f.length>0){for(const d of f)q.assert(i!==e.getPieceAt(d),d+"was already switched!"),n[d.y][d.x]=i;n[s][a]=i,t.push(new m3e(l,f.length))}}return 0===t.length&&t.push(new m3e(Ui.PASS,0)),t}isLegal(e,t){if(e.equals(Ui.PASS))return ta.playerCanOnlyPass(t)?ie.success([]):ie.failure(Le.CANNOT_PASS());if(t.getPieceAt(e.coord).isPlayer())return ie.failure(Le.MUST_CLICK_ON_EMPTY_SPACE());const n=t.getCopiedBoard(),i=ta.getAllSwitcheds(e,t.getCurrentPlayer(),n);return 0===i.length?ie.failure(bgt.NO_ELEMENT_SWITCHED()):ie.success(i)}},ta=UC,u(UC,"singleton",g.empty()),UC);Mu=ta=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],Mu);class WC extends Sr{getMetrics(e){const n=e.gameState.getCopiedBoard();let i=0,o=0;for(let s=0;s<t2.BOARD_HEIGHT;s++)for(let a=0;a<t2.BOARD_WIDTH;a++){const f=(0===a||a===t2.BOARD_WIDTH-1?4:1)*(0===s||s===t2.BOARD_HEIGHT-1?4:1);n[s][a]===I.ZERO&&(i+=f),n[s][a]===I.ONE&&(o+=f)}return[i,o]}getListMoves(e){const t=Mu.getListMoves(e.gameState);return Re.sortByDescending(t,n=>WC.bestCoords.some(i=>n.move.coord.equals(i))?100:n.switched),t.map(n=>n.move)}}u(WC,"bestCoords",[new C(0,0),new C(0,t2.BOARD_HEIGHT-1),new C(t2.BOARD_WIDTH-1,0),new C(t2.BOARD_WIDTH-1,t2.BOARD_HEIGHT-1)]);const Mt=K.NONE,Pt=K.ZERO,Ye=K.ONE;class _3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new t2([[Pt,Pt,Pt,Pt,Pt,Pt,Pt,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Pt,Pt,Pt,Pt,Pt,Pt,Pt]],60)),W.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,t2.getInitialState(),new Ui(2,4),$localize`Congratulations!`),W.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new t2([[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Ye,Mt,Mt,Mt],[Mt,Mt,Mt,Pt,Mt,Mt,Mt,Mt],[Mt,Mt,Pt,Mt,Mt,Mt,Mt,Mt],[Pt,Pt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Pt,Ye,Pt,Ye,Pt,Mt,Mt]],1),[new Ui(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),W.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new t2([[Ye,Pt,Pt,Pt,Pt,Pt,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Pt,Ye,Ye,Ye,Ye,Ye,Ye,Pt],[Ye,Ye,Ye,Ye,Ye,Ye,Mt,Mt],[Pt,Pt,Pt,Pt,Pt,Pt,Mt,Mt]],60))])}}function Ngt(r,e){if(1&r&&(A(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClass(t,n)),k("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function Agt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",2),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P(),T(2,Ngt,1,4,"circle",3),P()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ye("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),k("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function Igt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Agt,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let kgt=(()=>{var r;class e extends Vi{constructor(n){super(n),u(this,"EMPTY",K.NONE),u(this,"lastMove",new C(-2,-2)),u(this,"capturedCoords",[]),this.scores=g.of([2,2]),this.rules=Mu.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new WC(this.rules,"ReversiMinimax")],this.encoder=Ui.encoder,this.tutorial=(new _3e).tutorial,this.canPass=!1}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new Ui(n,i);return yield o.chooseMove(a)})()}updateBoard(n){var i=this;return M(function*(){const o=i.getState();i.board=o.getCopiedBoard(),i.capturedCoords=[],i.lastMove=new C(-2,-2),i.scores=g.of(o.countScore()),i.canPass=Mu.playerCanOnlyPass(o)})()}showLastMove(n){var i=this;return M(function*(){i.lastMove=n.coord;const o=i.getState().getCurrentPlayer(),s=i.getState().getCurrentOpponent();for(const a of Me.DIRECTIONS){let c=i.lastMove.getNext(a,1);for(;t2.isOnBoard(c)&&i.getState().getPieceAt(c)===s&&i.getPreviousState().getPieceAt(c)===o;)i.capturedCoords.push(c),c=c.getNext(a,1)}})()}getRectClasses(n,i){const o=new C(n,i);return this.capturedCoords.some(s=>s.equals(o))?["captured-fill"]:o.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(n,i){return this.getPlayerClass(this.board[i][n])}pass(){var n=this;return M(function*(){return q.assert(n.canPass,"ReversiComponent: pass() can only be called if canPass is true"),n.onClick(Ui.PASS.coord.x,Ui.PASS.coord.y)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-reversi"]],features:[Qe],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,Igt,2,1,"g",1),P()),2&n&&(k("viewBox","0 -4 "+8*i.SPACE_SIZE+" "+(10+8*i.SPACE_SIZE)),_(1),y("ngForOf",i.board))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Ga=(()=>{class r extends P0{static getInitialState(){const t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE,o=Ce.EMPTY;return new r([[t,t,n,i,o,o,o,n,i,t,t],[t,o,o,o,o,o,o,o,o,o,t],[i,o,o,o,o,o,o,o,o,o,n],[n,o,o,o,o,o,o,o,o,o,i],[t,o,o,o,o,o,o,o,o,o,t],[t,t,i,n,o,o,o,i,n,t,t]],0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"HEIGHT",6),u(r,"WIDTH",11),r})(),Eu=(()=>{class r{}return u(r,"CAN_ONLY_REBOUND_ON_BLACK",()=>$localize`You can only rebound on dark spaces.`),u(r,"CAN_ONLY_REBOUND_ON_EMPTY_SPACE",()=>$localize`You can only rebound on empty spaces.`),u(r,"MUST_CHOOSE_PYRAMID_FIRST",()=>$localize`You must pick one of your pyramids first.`),u(r,"MUST_CHOOSE_OWN_PYRAMID",()=>$localize`You must pick one of your pyramids.`),u(r,"THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS",()=>$localize`Those two spaces are not neighbors.`),u(r,"THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR",()=>$localize`Those two spaces have no intermediary neighbor.`),r})();class Ua extends Fs{static checkDistanceAndLocation(e,t){const n=e.getOrthogonalDistance(t);if(0===n)return b.failure(Le.MOVE_CANNOT_BE_STATIC());if(1===n){const i=Bs.getFakeNeighbors(e);if(t.equals(i))return b.failure(Eu.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return b.failure($localize`You can move one or two spaces, not ${n}.`);if(Bs.isSpaceDark(e))return b.failure(Eu.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return b.failure(Eu.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return b.SUCCESS}static from(e,t){q.assert(Ga.isOnBoard(e),"Move must start inside the board not at "+e.toString()+"."),q.assert(Ga.isOnBoard(t),"Move must end inside the board not at "+t.toString()+".");const n=Ua.checkDistanceAndLocation(e,t);return n.isFailure()?n.toOtherFallible():ie.success(new Ua(e,t))}constructor(e,t){super(e,t)}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}var qC,Kc;u(Ua,"encoder",Ho.getFallibleEncoder(Ua.from));let x0=(qC=class extends Yn{static get(){return Kc.singleton.isAbsent()&&(Kc.singleton=g.of(new Kc)),Kc.singleton.get()}constructor(){super(Ga)}static getStartingCoords(e,t){const n=[];for(let i=0;i<Ga.HEIGHT;i++)for(let o=0;o<Ga.WIDTH;o++)e[i][o].is(t)&&n.push(new C(o,i));return n}static getBoardValuesFor(e,t){const n=Kc.getStartingCoords(e,t),i=[];for(const o of n){const s=P0.getEmptyNeighbors(e,o,Ce.EMPTY).length;if(0===s)return[0];i.push(s)}return i.sort((o,s)=>o-s)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.getEnd().y][e.getEnd().x]=i[e.getStart().y][e.getStart().x],i[e.getStart().y][e.getStart().x]=Ce.EMPTY,new Ga(i,t.turn+1)}isLegal(e,t){if(t.getPieceAt(e.getStart()).value!==t.getCurrentPlayer().value)return b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.getEnd())!==Ce.EMPTY)return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());const o=Bs.getCommonNeighbor(e.getStart(),e.getEnd());return o.isPresent()?t.getPieceAt(o.get())===Ce.EMPTY?b.SUCCESS:b.failure(Eu.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):b.SUCCESS}getGameStatus(e){const t=e.gameState.getCopiedBoard(),n=Kc.getBoardValuesFor(t,I.ZERO),i=Kc.getBoardValuesFor(t,I.ONE);return Kc.getGameStatusFromFreedoms(n,i)}getLandingCoords(e,t){const n=o=>Ga.isOnBoard(o)&&e[o.y][o.x]===Ce.EMPTY,i=new dt(Bs.getNeighbors(t).filter(n));if(!0===Bs.isSpaceDark(t))return i.toList();{const o=new dt(i.toList());for(const s of i){const a=Bs.getNeighbors(s).filter(n);for(const c of a)o.add(c)}return o.toList()}}static getGameStatusFromFreedoms(e,t){return 0===e[0]?ve.ONE_WON:0===t[0]?ve.ZERO_WON:ve.ONGOING}},Kc=qC,u(qC,"singleton",g.empty()),qC);x0=Kc=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],x0);class Lgt extends Sr{getListMoves(e){const t=[],n=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),o=x0.getStartingCoords(n,i);for(const s of o){const a=P0.getEmptyNeighbors(n,s,Ce.EMPTY);for(const c of a){const l=Ua.from(s,c).get();if(n[c.y][c.x]=n[s.y][s.x],n[s.y][s.x]=Ce.EMPTY,t.push(l),(c.y+c.x)%2==0){const d=P0.getEmptyNeighbors(n,c,Ce.EMPTY);for(const m of d)if(!1===m.equals(s)){const E=Ua.from(s,m).get();n[m.y][m.x]=n[c.y][c.x],n[c.y][c.x]=Ce.EMPTY,t.push(E),n[c.y][c.x]=n[m.y][m.x],n[m.y][m.x]=Ce.EMPTY}}n[s.y][s.x]=n[c.y][c.x],n[c.y][c.x]=Ce.EMPTY}}return t}getMetrics(e){const t=e.gameState.board,n=x0.getBoardValuesFor(t,I.ZERO),i=x0.getBoardValuesFor(t,I.ONE);let o=0;for(;o<6&&n[o]===i[o];)o++;return[n[o%6],i[o%6]]}}const na=Ce.UNREACHABLE,Su=Ce.ZERO,Pu=Ce.ONE,sn=Ce.EMPTY;class C3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board`,$localize`Sâhârâ is played on a board where each space is a triangle.
        Each player has six pyramids.`,Ga.getInitialState()),W.informational($localize`Goal of the game`,$localize`At Sâhârâ, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new Ga([[na,na,sn,sn,Pu,sn,sn,Su,Pu,na,na],[na,sn,sn,sn,sn,sn,sn,sn,sn,sn,na],[Pu,Su,sn,sn,sn,sn,sn,sn,sn,sn,Su],[Su,sn,sn,sn,sn,sn,sn,sn,sn,sn,Pu],[na,sn,sn,sn,sn,sn,sn,sn,sn,sn,na],[na,na,Pu,Su,sn,sn,sn,Pu,Su,na,na]],3)),W.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,Ga.getInitialState(),Ua.from(new C(2,0),new C(2,1)).get(),(t,n,i)=>t.isSimpleStep()?b.SUCCESS:b.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),W.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,Ga.getInitialState(),Ua.from(new C(7,0),new C(5,0)).get(),(t,n,i)=>t.isSimpleStep()?b.failure($localize`Failed! You have made a single step.`):b.SUCCESS,$localize`Congratulations!`)])}}function Rgt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"polygon",7),P()),2&r){const t=p().index,n=p().index,i=p();_(1),y("ngClass",i.getPlayerClassFor(t,n)),k("points",i.getPyramidPoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function zgt(r,e){if(1&r&&(A(),F(0,"polygon",10)),2&r){const t=p(2).index,n=p().index,i=p();k("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function Dgt(r,e){if(1&r&&(A(),F(0,"polygon",11)),2&r){const t=p(2).index,n=p().index,i=p();k("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function Hgt(r,e){if(1&r&&(A(),S(0,"g"),T(1,zgt,1,2,"polygon",8),T(2,Dgt,1,2,"polygon",9),P()),2&r){const t=p().index,n=p().index;_(1),y("ngIf",(t+n)%2==1),_(1),y("ngIf",(t+n)%2==0)}}function Vgt(r,e){if(1&r){const t=pe();A(),S(0,"g",5),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),T(1,Rgt,2,3,"g",6),T(2,Hgt,3,2,"g",6),P()}if(2&r){const t=e.$implicit;ye("id","click_",e.index,"_",p().index,""),_(1),y("ngIf",t.isPlayer()),_(1),y("ngIf",2===t.value)}}function Fgt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Vgt,3,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function $gt(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=e.$implicit,n=p(2);ye("id","possible_landing_",t.x,"_",t.y,""),k("points",n.getTrianglePoints(t.x,t.y))("transform",n.getTriangleTranslate(t.x,t.y))}}function Bgt(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=p(2);ye("id","chosen_coord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),k("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y))}}function Ggt(r,e){if(1&r&&(A(),Bt(0),T(1,$gt,1,4,"polygon",12),T(2,Bgt,1,4,"polygon",13),Gt()),2&r){const t=p();_(1),y("ngForOf",t.possibleLandings),_(1),y("ngIf",t.chosenCoord.isPresent())}}function Ugt(r,e){if(1&r&&(A(),Bt(0),F(1,"polygon",15)(2,"polygon",15),Gt()),2&r){const t=p(2);_(1),k("points",t.getTrianglePoints(t.lastCoord.get().x,t.lastCoord.get().y))("transform",t.getTriangleTranslate(t.lastCoord.get().x,t.lastCoord.get().y)),_(1),k("points",t.getTrianglePoints(t.lastMoved.get().x,t.lastMoved.get().y))("transform",t.getTriangleTranslate(t.lastMoved.get().x,t.lastMoved.get().y))}}function Wgt(r,e){1&r&&(A(),T(0,Ugt,3,4,"ng-container",6)),2&r&&y("ngIf",p().lastMoved.isPresent())}let qgt=(()=>{var r;class e extends ece{constructor(n){super(n),u(this,"lastCoord",g.empty()),u(this,"lastMoved",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"possibleLandings",[]),this.rules=x0.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Lgt(this.rules,"SaharaMinimax")],this.encoder=Ua.encoder,this.tutorial=(new C3e).tutorial}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=g.empty()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=o.getState().getCurrentPlayer(),c=Ce.ofPlayer(a);return o.chosenCoord.equalsValue(new C(n,i))?(o.cancelMoveAttempt(),b.SUCCESS):o.chosenCoord.isAbsent()||o.board[i][n]===c?o.choosePiece(n,i):o.chooseLandingCoord(n,i)})()}choosePiece(n,i){var o=this;return M(function*(){if(o.board[i][n]===Ce.EMPTY)return o.cancelMove(Eu.MUST_CHOOSE_PYRAMID_FIRST());if(o.board[i][n].is(I.ofTurn(o.getTurn()))){const s=new C(n,i);return o.selectPiece(s),b.SUCCESS}return o.cancelMove(Eu.MUST_CHOOSE_OWN_PYRAMID())})()}selectPiece(n){this.chosenCoord=g.of(n),this.possibleLandings=this.rules.getLandingCoords(this.board,n)}chooseLandingCoord(n,i){var o=this;return M(function*(){const s=new C(n,i),a=Ua.from(o.chosenCoord.get(),s);return a.isFailure()?o.cancelMove(a.getReason()):yield o.chooseMove(a.get())})()}updateBoard(n){var i=this;return M(function*(){const o=i.node.move;i.lastCoord=o.map(s=>s.getStart()),i.lastMoved=o.map(s=>s.getEnd()),i.board=i.getState().board})()}getPlayerClassFor(n,i){return this.getPlayerClass(I.of(this.board[i][n].value))}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-sahara"]],features:[Qe],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-55 -55 610 610","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["class","base mid-stroke",4,"ngIf"],["class","base mid-stroke background2",4,"ngIf"],[1,"base","mid-stroke"],[1,"base","mid-stroke","background2"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],[1,"base","no-fill","mid-stroke","moved-stroke"]],template:function(n,i){if(1&n&&(A(),S(0,"svg",0),T(1,Fgt,2,1,"g",1),T(2,Ggt,3,2,"ng-container",2),T(3,Wgt,1,1,"ng-template",null,3,dn),P()),2&n){const o=ln(4);_(1),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",o)}},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var Wa;class ut{static decode(e){switch(e){case 0:return ut.EMPTY;case 1:return ut.LIGHT_UP;case 2:return ut.LIGHT_RIGHT;case 3:return ut.LIGHT_DOWN;case 4:return ut.LIGHT_LEFT;case 5:return ut.DARK_UP;case 6:return ut.DARK_RIGHT;case 7:return ut.DARK_DOWN;case 8:return ut.DARK_LEFT;case 9:return ut.MOUNTAIN}}belongTo(e){return e===I.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!1===this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?I.ZERO:5<=this.value&&this.value<=8?I.ONE:K.NONE}getOptionalDirection(){switch(this.value){case 0:return g.empty();case 1:case 5:return g.of(ze.UP);case 2:case 6:return g.of(ze.RIGHT);case 3:case 7:return g.of(ze.DOWN);case 4:case 8:return g.of(ze.LEFT);default:return q.expectToBe(this.value,9),g.empty()}}static of(e,t){return t===I.ZERO?e===ze.UP?ut.LIGHT_UP:e===ze.RIGHT?ut.LIGHT_RIGHT:e===ze.DOWN?ut.LIGHT_DOWN:ut.LIGHT_LEFT:e===ze.UP?ut.DARK_UP:e===ze.RIGHT?ut.DARK_RIGHT:e===ze.DOWN?ut.DARK_DOWN:ut.DARK_LEFT}constructor(e){u(this,"value",void 0),this.value=e}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return q.expectToBe(this.value,9),"MOUNTAIN"}}}u(ut,"EMPTY",new(Wa=ut)(0)),u(ut,"LIGHT_UP",new Wa(1)),u(ut,"LIGHT_RIGHT",new Wa(2)),u(ut,"LIGHT_DOWN",new Wa(3)),u(ut,"LIGHT_LEFT",new Wa(4)),u(ut,"DARK_UP",new Wa(5)),u(ut,"DARK_RIGHT",new Wa(6)),u(ut,"DARK_DOWN",new Wa(7)),u(ut,"DARK_LEFT",new Wa(8)),u(ut,"MOUNTAIN",new Wa(9));let P1=(()=>{class r extends B1{static getInitialState(){const t=Re.createTable(r.SIZE,r.SIZE,ut.EMPTY);return t[2][1]=ut.MOUNTAIN,t[2][2]=ut.MOUNTAIN,t[2][3]=ut.MOUNTAIN,new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(const n of this.getCoordsAndContents())n.content!==ut.EMPTY&&t[n.content.getOwner().value]++;return t}}return u(r,"SIZE",5),r})();var y3e;class $o extends Pr{constructor(e,t,n,i){super(e,t),u(this,"x",void 0),u(this,"y",void 0),u(this,"direction",void 0),u(this,"landingOrientation",void 0),this.x=e,this.y=t,this.direction=n,this.landingOrientation=i}static from(e,t,n,i){const o=new $o(e,t,n,i),s=!1===P1.isOnBoard(o.coord);if(o.isRotation()){if(s)return ie.failure("Cannot rotate piece outside the board: "+o.toString())}else if(!1===P1.isOnBoard(o.coord.getNext(o.direction.get()))){if(s)return ie.failure("SiamMove should end or start on the board: "+o.toString());if(o.direction.get()!==o.landingOrientation)return ie.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+o.toString())}return ie.success(o)}isRotation(){return this.direction.isAbsent()}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&!1!==this.direction.equals(e.direction)&&this.landingOrientation===e.landingOrientation}toString(){const e=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||this.coord.x===+P1.SIZE||-1===this.coord.y||this.coord.y===+P1.SIZE}}y3e=$o,u($o,"encoder",we.tuple([we.identity(),we.identity(),g.getEncoder(ze.encoder),ze.encoder],r=>[r.x,r.y,r.direction,r.landingOrientation],r=>y3e.from(r[0],r[1],r[2],r[3]).get()));let Tu=(()=>{class r{}return u(r,"NO_REMAINING_PIECE_TO_INSERT",()=>$localize`You cannot insert a piece, all your pieces are already on the board.`),u(r,"NOT_ENOUGH_FORCE_TO_PUSH",()=>$localize`You do not have enough strength to push.`),u(r,"MUST_MOVE_OR_ROTATE",()=>$localize`You must move or rotate your piece.`),u(r,"ILLEGAL_PUSH",()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`),u(r,"MUST_SELECT_VALID_DESTINATION",()=>$localize`You must select a valid destination (highlighted on the board) for your piece`),u(r,"MUST_SELECT_ORIENTATION",()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`),r})();var jC,Ou;class M3e{constructor(e,t){u(this,"resultingBoard",void 0),u(this,"moved",void 0),this.resultingBoard=e,this.moved=t}}let qa=(jC=class extends Yn{static get(){return Ou.singleton.isAbsent()&&(Ou.singleton=g.of(new Ou)),Ou.singleton.get()}constructor(){super(P1)}isLegal(e,t){if(!1===e.isInsertion()&&!1===t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return ie.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return this.isLegalRotation(e,t);{let n;if(e.isInsertion()){const i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return ie.failure(i.legal.getReason());n=i.insertedPiece}else n=t.getPieceAt(e.coord);return this.isLegalForwarding(e,t,n)}}isLegalInsertion(e,t){const n=t.countCurrentPlayerPawn(),i=t.getCurrentPlayer(),o=n<5?b.SUCCESS:b.failure(Tu.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(e,i),legal:o}}getInsertedPiece(e,t){return ut.of(-1===e.x?ze.RIGHT:-1===e.y?ze.DOWN:e.x===P1.SIZE?ze.LEFT:ze.UP,t)}isLegalForwarding(e,t,n){q.assert(n!==ut.MOUNTAIN&&n!==ut.EMPTY,"forwarding must be done with player piece");const i=[];let o=ut.of(e.landingOrientation,t.getCurrentPlayer());const s=e.direction.get();let a=e.coord.getNext(s);if(P1.isOnBoard(a)&&t.getPieceAt(a)!==ut.EMPTY&&!1===this.isStraight(n,e))return ie.failure(Tu.ILLEGAL_PUSH());let c=g.of(s);const l=s.getOpposite();let f=0;const d=t.getCopiedBoard();P1.isOnBoard(e.coord)&&(d[e.coord.y][e.coord.x]=ut.EMPTY,i.push(e.coord));let m=P1.isOnBoard(a)&&o!==ut.EMPTY;for(;m;){c.equalsValue(s)?f++:c.equalsValue(l)&&f--;const E=d[a.y][a.x];E===ut.MOUNTAIN&&(f-=.9),d[a.y][a.x]=o,i.push(a),o=E,a=a.getNext(s),c=o.getOptionalDirection(),m=P1.isOnBoard(a)&&o!==ut.EMPTY&&f>0}return!1===P1.isOnBoard(a)&&(c.equalsValue(s)?f++:c.equalsValue(l)&&f--),f<=0?ie.failure(Tu.NOT_ENOUGH_FORCE_TO_PUSH()):ie.success(new M3e(d,i))}isStraight(e,t){const n=e.getDirection();return t.direction.equalsValue(n)&&n===t.landingOrientation}isLegalRotation(e,t){const n=e.coord,i=t.getPieceAt(n),o=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return ie.failure(Tu.MUST_MOVE_OR_ROTATE());const s=t.getCopiedBoard();return s[n.y][n.x]=ut.of(e.landingOrientation,o),ie.success(new M3e(s,[n]))}applyLegalMove(e,t,n){const i=Re.copyBiArray(n.resultingBoard);return new P1(i,t.turn+1)}getBoardValueInfo(e,t){const n=this.getMountainsRowsAndColumns(t),i=n.rows,o=n.columns,s=this.getWinner(t,e,n.nbMountain);if(s.isPlayer())return s===I.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const a=this.getPushers(t,o,i);let c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER;const f=t.getCurrentPlayer();for(const m of a)P1.isOnBoard(m.coord)?t.getPieceAt(m.coord).belongTo(I.ZERO)?c=Math.min(c,m.distance):l=Math.min(l,m.distance):f===I.ZERO?c=Math.min(c,m.distance):l=Math.min(l,m.distance);return{shortestZero:c,shortestOne:l,boardValue:this.getScoreFromShortestDistances(c,l,f)}}}getScoreFromShortestDistances(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);const i=6-e,o=6-t;return i===o?n.getScoreModifier():i>o?-10*(i+1)+(o+1):10*(o+1)-(i+1)}getMountainsRowsAndColumns(e){const t=[],n=[];let i=0;for(const o of e.getCoordsAndContents())o.content===ut.MOUNTAIN&&(!1===t.includes(o.coord.y)&&t.push(o.coord.y),!1===n.includes(o.coord.x)&&n.push(o.coord.x),i++);return{rows:t,columns:n,nbMountain:i}}getWinner(e,t,n){return 2===n?this.getPusher(e,t.get()):K.NONE}getPusher(e,t){const n=t.coord;let i;i=P1.isOnBoard(n)?e.getPieceAt(n.getNext(t.landingOrientation)):this.getInsertedPiece(n,e.getCurrentOpponent());const o=i.getDirection(),s=this.getPusherCoord(e,o,n),a=e.getPieceAt(s).getOwner();return Ae.display("SiamRules","getPusher",n.toString()+" belong to "+e.getCurrentOpponent().value+", "+s.toString()+" belong to "+a.value+", "+a.value+" win"),a}getPusherCoord(e,t,n){let i=n.getNext(t),o=n;for(;P1.isOnBoard(i);){n=i,i=i.getNext(t);const s=e.getPieceAt(n);s!==ut.MOUNTAIN&&s.getDirection()===t&&(o=n)}return o}getPushers(e,t,n){let i=[];const o=[];for(const s of t){let a=ze.DOWN,c=new C(s,4);o.push({direction:a,fallingCoord:c}),a=ze.UP,c=new C(s,0),o.push({direction:a,fallingCoord:c})}for(const s of n){let a=ze.LEFT,c=new C(0,s);o.push({direction:a,fallingCoord:c}),a=ze.RIGHT,c=new C(4,s),o.push({direction:a,fallingCoord:c})}for(const s of o)i=this.addPotentialDirectionPusher(e,s.fallingCoord,s.direction,i);return i}addPotentialDirectionPusher(e,t,n,i){const o=this.getLineClosestPusher(e,t,n);if(o.isAbsent())return i;const s=o.get();return i.push({coord:s.coord,distance:s.distance}),i}getLineClosestPusher(e,t,n){const i=n.getOpposite();let o=1,s=e.getPieceAt(t),a=t,c=g.empty(),l=!1,f=!1,d=0;for(;P1.isOnBoard(a)&&!1===l;){const m=e.getPieceAt(a);if(m.isEmptyOrMountain())m===ut.MOUNTAIN?(d+=.9,f=!0):o++;else{const E=m.getDirection();E===n?f&&(d-=1,d<=0&&(l=!0,a=a.getNext(n))):E===i?(d+=1,!1===f&&o++):f?(c=g.of(a),s!==ut.EMPTY&&o++):o++}s=m,a=a.getPrevious(n)}if(!1===l&&c.isPresent())for(o++,d-=1;!1===a.equals(c.get());)a=a.getNext(n),o--;return!1===P1.isOnBoard(a)&&(d-=1,5===e.countCurrentPlayerPawn())||d>0?g.empty():g.of({distance:o,coord:a})}getInsertions(e){let t=[];for(let n=1;n<4;n++)t=t.concat(this.getInsertionsAt(e,0,n)),t=t.concat(this.getInsertionsAt(e,4,n)),t=t.concat(this.getInsertionsAt(e,n,0)),t=t.concat(this.getInsertionsAt(e,n,4));return t=t.concat(this.getInsertionsAt(e,0,0)),t=t.concat(this.getInsertionsAt(e,0,4)),t=t.concat(this.getInsertionsAt(e,4,0)),t=t.concat(this.getInsertionsAt(e,4,4)),t}getInsertionsAt(e,t,n){const i=[];for(const o of ze.ORTHOGONALS){const s=new C(t,n).getPrevious(o);if(!1===P1.isOnBoard(s))for(const a of ze.ORTHOGONALS){const c=$o.from(s.x,s.y,g.of(o),a);q.assert(c.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(c.get(),e).isSuccess()&&i.push(c.get())}}return i}getMovesFrom(e,t,n,i){const o=new C(n,i);let s=this.getRotationMovesAt(o,t);for(const a of ze.ORTHOGONALS){const c=o.getNext(a);s=s.concat(this.getForwardMovesBetween(e,o,c))}return s}getMovesBetween(e,t,n,i){return n.equals(i)?this.getRotationMovesAt(n,t):ze.factory.fromMove(n,i).isSuccess()&&1===n.getDistance(i)?this.getForwardMovesBetween(e,n,i):[]}getRotationMovesAt(e,t){const n=[],i=t.getDirection();for(const o of ze.ORTHOGONALS)if(o!==i){const s=$o.from(e.x,e.y,g.empty(),o).get();n.push(s)}return n}getForwardMovesBetween(e,t,n){const i=[];let o;const s=ze.factory.fromMove(t,n).get(),a=e.getPieceAt(t);o=P1.isOnBoard(n)?ze.ORTHOGONALS:[s];for(const c of o){const l=$o.from(t.x,t.y,g.of(s),c).get();this.isLegalForwarding(l,e,a).isSuccess()&&i.push(l)}return i}getGameStatus(e){const t=this.getMountainsRowsAndColumns(e.gameState),n=this.getWinner(e.gameState,e.move,t.nbMountain);return n.isPlayer()?ve.getVictory(n):ve.ONGOING}},Ou=jC,u(jC,"singleton",g.empty()),jC);qa=Ou=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],qa);let sR=class extends ds{getBoardValue(e){return new an(qa.get().getBoardValueInfo(e.move,e.gameState).boardValue)}getListMoves(e){let t=[];const n=e.gameState.getCurrentPlayer();for(const i of e.gameState.getCoordsAndContents()){const o=i.content;o.belongTo(n)&&(t=t.concat(qa.get().getMovesFrom(e.gameState,o,i.coord.x,i.coord.y)))}if(e.gameState.countCurrentPlayerPawn()<5)for(const i of qa.get().getInsertions(e.gameState))if(i.direction.get().getOpposite()!==i.landingOrientation){if(this.isOnBorder(i)&&i.direction.get()!==i.landingOrientation)continue;t.push(i)}return t}isOnBorder(e){return 0===e.coord.x||4===e.coord.x||0===e.coord.y||4===e.coord.y}};sR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],sR);const Ie=ut.EMPTY,vs=ut.MOUNTAIN,aR=ut.LIGHT_UP,cR=ut.LIGHT_LEFT,bu=ut.LIGHT_RIGHT,Ygt=ut.LIGHT_DOWN,Kgt=ut.DARK_UP,E3e=ut.DARK_LEFT,S3e=ut.DARK_RIGHT,Xgt=ut.DARK_DOWN;class P3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,P1.getInitialState()),W.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,P1.getInitialState(),$o.from(2,-1,g.of(ze.DOWN),ze.DOWN).get(),$localize`Congratulations!`),W.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new P1([[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie],[Ie,vs,vs,vs,Ie],[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,aR,Ie,Ie]],0),[$o.from(2,4,g.of(ze.UP),ze.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),W.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new P1([[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie],[Ie,vs,vs,vs,Ie],[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,aR,Ie,Ie]],0),[$o.from(2,4,g.of(ze.DOWN),ze.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),W.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new P1([[Ie,bu,E3e,Ie,Ie],[bu,S3e,cR,Ie,Ie],[Ie,Ie,aR,Ie,Ie],[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie]],0),[$o.from(2,2,g.of(ze.UP),ze.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new P1([[Ie,Ie,bu,vs,Ie],[Ie,Ie,bu,vs,cR],[Ie,bu,vs,vs,Ie],[Ie,bu,S3e,E3e,vs],[Ie,Ie,Ie,Ie,Ie]],0),[$o.from(1,3,g.of(ze.RIGHT),ze.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),W.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new P1([[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie],[vs,Kgt,cR,Ie,Ygt],[Ie,Ie,Ie,Ie,Xgt],[Ie,Ie,Ie,Ie,vs]],0),[$o.from(2,2,g.of(ze.LEFT),ze.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)])}}var wu;function Jgt(r,e){if(1&r){const t=pe();A(),S(0,"use",11),U("click",function(){te(t);const i=p().index,o=p().index;return ne(p().clickSquare(i,o))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p();ye("id","piece_",n,"_",o,""),y("ngClass",s.getPieceClasses(n,o,i)),k("transform",s.getPieceTransform(n,o))}}function emt(r,e){if(1&r){const t=pe();A(),S(0,"use",12),U("click",function(){te(t);const i=p().index,o=p().index;return ne(p().clickSquare(i,o))}),P()}if(2&r){const t=p().index,n=p().index,i=p();k("transform","translate("+(t+1)*i.SPACE_SIZE+" "+(n+1)*i.SPACE_SIZE+")")}}function tmt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",8),U("click",function(){const o=te(t).index,s=p().index;return ne(p().clickSquare(o,s))}),P(),T(2,Jgt,1,4,"use",9),T(3,emt,1,1,"use",10),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();_(1),ye("id","square_",n,"_",i,""),y("ngClass",o.getSquareClasses(n,i)),k("x",o.SPACE_SIZE*(n+1))("y",o.SPACE_SIZE*(i+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t.isPiece()),_(1),y("ngIf",o.isMountain(t))}}function nmt(r,e){if(1&r&&(A(),S(0,"g"),T(1,tmt,4,9,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function rmt(r,e){if(1&r){const t=pe();A(),S(0,"rect",15),U("click",function(){te(t);const i=p().$implicit;return ne(p().clickSquare(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();ye("id","square_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),k("x",n.SPACE_SIZE*(t.x+1))("y",n.SPACE_SIZE*(t.y+1))("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function imt(r,e){if(1&r){const t=pe();A(),S(0,"g"),T(1,rmt,1,7,"rect",13),S(2,"rect",14),U("click",function(){const o=te(t).$implicit;return ne(p().clickSquare(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),y("ngIf",!1===n.SiamState.isOnBoard(t)),_(1),k("x",n.SPACE_SIZE*(t.x+1))("y",n.SPACE_SIZE*(t.y+1))("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function omt(r,e){if(1&r){const t=pe();A(),S(0,"rect",16),U("click",function(){te(t);const i=p();return ne(i.clickSquare(i.selectedLanding.get().x,i.selectedLanding.get().y))}),P()}if(2&r){const t=p();k("x",t.SPACE_SIZE*(t.selectedLanding.get().x+1))("y",t.SPACE_SIZE*(t.selectedLanding.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function smt(r,e){if(1&r){const t=pe();A(),S(0,"rect",16),U("click",function(){te(t);const i=p();return ne(i.clickSquare(i.selectedPiece.get().x,i.selectedPiece.get().y))}),P()}if(2&r){const t=p();k("x",t.SPACE_SIZE*(t.selectedPiece.get().x+1))("y",t.SPACE_SIZE*(t.selectedPiece.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function amt(r,e){if(1&r&&(A(),F(0,"use",19)),2&r){const t=e.$implicit,n=p().$implicit,i=p();ye("id","remainingPieces_",n.value,"_",t,""),y("ngClass",i.getRemainingPieceClasses(n,t)),k("transform",i.getRemainingPieceTransform(t,n))}}function cmt(r,e){if(1&r){const t=pe();A(),S(0,"g",17),U("click",function(){const o=te(t).$implicit;return ne(p().selectPieceForInsertion(o))}),T(1,amt,1,4,"use",18),P()}if(2&r){const t=e.$implicit,n=p();Dn("id","remainingPieces_",t.value,""),_(1),y("ngForOf",n.ArrayUtils.range(n.playerPieces(t)))}}function lmt(r,e){if(1&r){const t=pe();A(),S(0,"use",22),U("click",function(){te(t);const i=p().$implicit;return ne(p().clickSquare(i.source.get().coord.x,i.source.get().coord.y))}),P()}if(2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClasses(t.source.get().coord.x,t.source.get().coord.y,t.source.get().piece)),k("transform",n.getPieceTransform(t.source.get().coord.x,t.source.get().coord.y))}}function umt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"use",20),U("click",function(){const o=te(t).$implicit;return ne(p().clickArrow(o))}),P(),T(2,lmt,1,2,"use",21),P()}if(2&r){const t=e.$implicit,n=p();_(1),Oi("id","indicator_",t.target.x,"_",t.target.y,"_",t.direction.toString(),""),k("transform",n.getIndicatorTransform(t)),_(1),y("ngIf",t.source.isPresent())}}function fmt(r,e){if(1&r){const t=pe();A(),S(0,"use",23),U("click",function(){const o=te(t).$implicit;return ne(p().selectOrientation(o))}),P()}if(2&r){const t=e.$implicit,n=p();Dn("id","orientation_",t.landingOrientation,""),y("ngClass",n.getCurrentPlayerClass()),k("transform",n.getOrientationTransform(t.landingOrientation))}}let lR=(wu=class extends Vi{constructor(e){super(e),u(this,"SiamState",P1),u(this,"lastMove",g.empty()),u(this,"movedPieces",[]),u(this,"selectedPiece",g.empty()),u(this,"selectedLanding",g.empty()),u(this,"orientations",[]),u(this,"clickableCoords",new dt),u(this,"indicatorArrows",[]),u(this,"insertingPiece",!1),this.rules=qa.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new sR(this.rules,"SiamMinimax")],this.encoder=$o.encoder,this.tutorial=(new P3e).tutorial}updateBoard(e){var t=this;return M(function*(){const n=t.getState();t.board=n.board,t.movedPieces=[]})()}showLastMove(e){var t=this;return M(function*(){t.lastMove=g.of(e);const n=t.getPreviousState();t.movedPieces=t.rules.isLegal(t.lastMove.get(),n).get().moved})()}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=g.empty(),this.selectedLanding=g.empty(),this.orientations=[],this.clickableCoords=new dt,this.indicatorArrows=[]}selectPieceForInsertion(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#remainingPieces_"+e.value);if(n.isFailure())return t.cancelMove(n.getReason());if(e!==t.getCurrentPlayer())return t.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE());if(t.insertingPiece)return t.cancelMoveAttempt(),b.SUCCESS;t.cancelMoveAttempt();for(const i of qa.get().getInsertions(t.getState())){const o=i.coord.getNext(i.direction.get());if(t.board[o.y][o.x]!==ut.EMPTY){const s={source:g.empty(),target:o,direction:i.direction.get(),move:i};t.indicatorArrows.push(s)}t.clickableCoords.add(o)}return t.insertingPiece=!0,b.SUCCESS})()}selectOrientation(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#orientation_"+e.landingOrientation.toString());return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e)})()}clickSquare(e,t,n=!1){var i=this;return M(function*(){if(!1===n){const s=yield i.canUserPlay("#square_"+e+"_"+t);if(s.isFailure())return i.cancelMove(s.getReason())}const o=new C(e,t);if(i.insertingPiece)return i.insertPiece(o);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),b.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=g.of(o);const s=qa.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),o);return 0===s.length?i.changeMoveDestinationClick(o):i.performMoveOrShowOrientationArrows(s)}{q.assert(i.getState().isOnBoard(o),"SiamComponent: user clicked outside of board when it should not be possible");const s=i.board[t][e];return s.getOwner()!==i.getCurrentPlayer()?i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(o,s)}})()}insertPiece(e){var t=this;return M(function*(){if(t.selectedLanding.isPresent())return yield t.cancelMove(Tu.MUST_SELECT_ORIENTATION()),b.SUCCESS;t.selectedLanding=g.of(e);const n=qa.get().getInsertionsAt(t.getState(),e.x,e.y);return 0===n.length?t.changeMoveDestinationClick(e):t.performMoveOrShowOrientationArrows(n)})()}changeMoveDestinationClick(e){var t=this;return M(function*(){return t.cancelMoveAttempt(),t.getState().getPieceAt(e).getOwner()===t.getCurrentPlayer()?t.clickSquare(e.x,e.y,!0):t.cancelMove(Tu.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var t=this;return M(function*(){return q.assert(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?t.chooseMove(e[0]):(t.clickableCoords=new dt,t.indicatorArrows=[],t.orientations=e,b.SUCCESS)})()}selectPiece(e,t){this.cancelMoveAttempt();const n=this.getState();this.selectedPiece=g.of(e);const i=qa.get().getMovesFrom(n,t,e.x,e.y);for(const o of i)if(o.direction.isPresent()){const s=o.coord.getNext(o.direction.get());if(this.clickableCoords.add(s),n.isOnBoard(s)&&n.getPieceAt(s)!==ut.EMPTY){const a={source:g.of({coord:e,piece:t}),target:s,direction:o.direction.get(),move:o};this.indicatorArrows.push(a)}}else this.clickableCoords.add(o.coord);return b.SUCCESS}clickArrow(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e.move)})()}isMountain(e){return e===ut.MOUNTAIN}getArrowTransform(e,t,n){const o=`rotate(${90*(n.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",o].join(" ")}getPieceTransform(e,t){return this.getArrowTransform(e+1,t+1,this.board[t][e].getDirection())}getIndicatorTransform(e){const t=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(t.x+1,t.y+1,e.direction)}getRemainingPieceTransform(e,t){const n=this.playerPieces(t);let a,c,s=2;return t===I.ONE?(s+=(n-e+(5-n)/2)/3,a=-1,c=ze.RIGHT):(s+=(e+1+(5-n)/2)/3,a=7,c=ze.LEFT),this.getArrowTransform(s,a,c)}getOrientationTransform(e){const t=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,t].join(" ")}getPieceClasses(e,t,n){const i=new C(e,t),o=[this.getPlayerClass(n.getOwner())];return this.selectedPiece.equalsValue(i)&&o.push("selected-stroke"),o}getSquareClasses(e,t){const n=new C(e,t);return this.movedPieces.some(i=>i.equals(n))?["moved-fill"]:[]}getRemainingPieceClasses(e,t){const n=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&t===this.playerPieces(e)-1&&n.push("selected-stroke"),n}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}},u(wu,"\u0275fac",function(e){return new(e||wu)(G(Ut))}),u(wu,"\u0275cmp",je({type:wu,selectors:[["app-siam"]],features:[Qe],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,t){1&e&&(A(),S(0,"svg",0)(1,"defs"),F(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),P(),T(5,nmt,2,1,"g",4),T(6,imt,3,5,"g",4),T(7,omt,1,4,"rect",5),T(8,smt,1,4,"rect",5),T(9,cmt,2,2,"g",6),T(10,umt,3,5,"g",4),T(11,fmt,1,3,"use",7),P()),2&e&&(_(5),y("ngForOf",t.board),_(1),y("ngForOf",t.clickableCoords),_(1),y("ngIf",t.selectedLanding.isPresent()),_(1),y("ngIf",t.selectedPiece.isPresent()),_(1),y("ngForOf",t.Player.PLAYERS),_(1),y("ngForOf",t.indicatorArrows),_(1),y("ngForOf",t.orientations))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),wu);var T3e;lR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],lR);class nr extends Ri{static of(e,t,n){return new nr(e,t,n)}static ofDrop(e){return new nr(g.empty(),e,g.empty())}static ofMovement(e,t){return new nr(g.of(e),t,g.empty())}static ofCut(e,t,n){return new nr(g.of(e),t,g.of(n))}constructor(e,t,n){super(),u(this,"start",void 0),u(this,"landing",void 0),u(this,"keep",void 0),this.start=e,this.landing=t,this.keep=n,q.assert(!1===e.equalsValue(t),"Deplacement cannot be static!"),q.assert(e.isAbsent()||!1===e.equals(n),"Cannot keep starting coord, since it will always be empty after move!")}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}T3e=nr,u(nr,"encoder",we.tuple([g.getEncoder(C.encoder),C.encoder,g.getEncoder(C.encoder)],r=>[r.start,r.landing,r.keep],r=>T3e.of(r[0],r[1],r[2])));let ja=(()=>{class r{}return u(r,"NO_MOVEMENT_BEFORE_TURN_40",()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`),u(r,"MUST_CUT",()=>$localize`Several groups are of the same size, you must pick the one to keep.`),u(r,"CANNOT_CHOOSE_TO_KEEP",()=>$localize`You cannot choose which part to keep when one is smaller than the other.`),u(r,"CAN_NO_LONGER_DROP",()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`),u(r,"MUST_CAPTURE_BIGGEST_GROUPS",()=>$localize`You must choose one of the biggest groups to keep it.`),u(r,"CANNOT_KEEP_EMPTY_COORD",()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`),u(r,"MUST_DROP_NEXT_TO_OTHER_PIECE",()=>$localize`You must put this piece next to another piece.`),r})();class Wi extends wce{static getInitialState(){return Wi.ofRepresentation([[I.ZERO],[I.ONE]],0)}static ofRepresentation(e,t,n=new St(0,0)){const i=new eu;for(let o=0;o<e.length;o++)for(let s=0;s<e[0].length;s++)if(e[o][s]!==K.NONE){const a=new C(s,o).getNext(n);i.set(a,e[o][s])}return new Wi(i,t)}movePiece(e){const t=this.pieces.getCopy();return t.delete(e.start.get()),t.set(e.landing,this.getCurrentPlayer()),new Wi(t,this.turn)}toRepresentation(){const e=Re.createTable(this.width,this.height,K.NONE);for(const t of this.pieces.listKeys()){const n=this.getPieceAt(t);e[t.y][t.x]=n}return e}isIllegalLandingZone(e,t){return this.pieces.containsKey(e)?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?b.SUCCESS:b.failure(ja.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(e,t){for(const n of p2.getNeighbors(e))if(this.pieces.containsKey(n)&&!1===t.equalsValue(n))return!0;return!1}getPieceAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():K.NONE}applyLegalDrop(e){const t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new Wi(t,this.turn+1)}applyLegalDeplacement(e,t){const n=this.movePiece(e);if(t.size()>0){const i=new eu;for(const o of t)i.set(o,n.getPieceAt(o));return new Wi(i,this.turn+1)}return new Wi(n.pieces,this.turn+1)}countPieces(){const e=this.pieces.reverse(),t=e.get(I.ZERO).getOrElse(new G1),n=e.get(I.ONE).getOrElse(new G1);return[t.size(),n.size()]}switchPiece(e){const t=this.pieces.getCopy(),n=this.getPieceAt(e);if(n.isPlayer())return t.replace(e,n.getOpponent()),new Wi(t,this.turn);u2.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}equals(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}var ZC,Ll;let Za=(ZC=class extends Yn{static get(){return Ll.singleton.isAbsent()&&(Ll.singleton=g.of(new Ll)),Ll.singleton.get()}constructor(){super(Wi),u(this,"currentVictorySource",void 0)}applyLegalMove(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}isLegal(e,t){const n=t.isIllegalLandingZone(e.landing,e.start);return n.isFailure()?n.toOtherFallible():t.turn<40?this.isLegalDrop(e,t):Ll.isLegalPhaseTwoMove(e,t)}static getLegalLandings(e){const t=new G1;for(const n of e.getPieceCoords())for(const i of be.factory.all){const o=n.getNext(i,1);e.getPieceAt(o)===K.NONE&&t.add(o)}return t.toList()}isLegalDrop(e,t){return!1===e.isDrop()?ie.failure(ja.NO_MOVEMENT_BEFORE_TURN_40()):ie.success(new dt(t.getPieceCoords()))}static isLegalPhaseTwoMove(e,t){if(e.isDrop())return ie.failure(ja.CAN_NO_LONGER_DROP());const n=t.getPieceAt(e.start.get());if(n===K.NONE)return ie.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===t.getCurrentOpponent())return ie.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());const i=t.movePiece(e),o=i.getGroups();if(Ll.isSplit(o)){const s=this.getLargestGroups(o);return 1===s.size()?e.keep.isPresent()?ie.failure(ja.CANNOT_CHOOSE_TO_KEEP()):ie.success(s.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,s,i)}return ie.success(new G1)}static isSplit(e){return e.size()>1}static getLargestGroups(e){let t=0,n=new dt;for(const i of e){const o=i.size();o>t?(t=o,n=new dt([i])):o===t&&n.add(i)}return n}static moveKeepBiggerGroup(e,t,n){if(e.isAbsent())return ie.failure(ja.MUST_CUT());if(n.getPieces().get(e.get()).isAbsent())return ie.failure(ja.CANNOT_KEEP_EMPTY_COORD());const i=e.get();for(const o of t)if(o.contains(i))return ie.success(o);return ie.failure(ja.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=[];if(e.move.isPresent()&&(i=this.getShapeVictory(e.move.get(),t)),6===i.length)return ve.getVictory(n);if(t.turn>39){const o=t.countPieces(),s=o[0],a=o[1];return s<6&&a<6?s<a?ve.ONE_WON:a<s?ve.ZERO_WON:ve.DRAW:s<6?ve.getDefeat(I.ZERO):a<6?ve.getDefeat(I.ONE):ve.ONGOING}return ve.ONGOING}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),s=[t];let a=t.getNext(be.factory.all[e],1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];const l=(e+s.length)%6;s.push(a),a=a.getNext(be.factory.all[l],1)}return s}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let o=be.factory.all[e],s=t.getNext(o,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(s)===i)a.push(s);else{if(c)return[];c=!0,o=o.getOpposite(),s=s.getNext(o,a.length)}s=s.getNext(o,1)}return a}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let o=be.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];s.length%2==0&&(o=be.factory.all[(e+s.length)%6]),s.push(a),a=a.getNext(o,1)}return s}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let o=be.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return[];s.push(a),s.length%2==0&&(o=be.factory.all[(e+s.length)%6]),a=a.getNext(o,1)}return s}},Ll=ZC,u(ZC,"singleton",g.empty()),ZC);Za=Ll=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],Za);class hmt extends ds{calculateBoardValue(e,t){this.startSearchingVictorySources();const n={status:en.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};for(;this.hasNextVictorySource();){const i=this.getNextVictorySource();let o;if(o=n.status===en.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n),o.status===en.VICTORY)return o;n.status=o.status,n.sum=n.sum+o.sum,n.preVictory.isAbsent()&&(n.preVictory=o.preVictory)}return n}}var YC,L0;class v4 extends an{constructor(e,t){super(e),u(this,"preVictory",void 0),this.preVictory=t}}let uR=(YC=class extends hmt{constructor(...e){super(...e),u(this,"currentVictorySource",void 0)}static get(){if(L0.singleton.isAbsent()){const e=Za.get();L0.singleton=g.of(new L0(e,"SixMinimax"))}return L0.singleton.get()}getListMoves(e){const t=L0.get(),n=e.getOwnValue(t);if(n.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(n):this.createForcedMovement(e,n);const i=Za.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getMovement(e.gameState,i)}getMovement(e,t){const n=this.getSafelyMovablePieceOrFirstOne(e);return this.getMovementFrom(e,n,t)}createForcedDrop(e){const t=[],n=nr.ofDrop(e.preVictory.get());return t.push(n),t}createForcedMovement(e,t){const n=this.getSafelyMovablePieceOrFirstOne(e.gameState),i=[t.preVictory.get()];return this.getMovementFrom(e.gameState,n,i)}getMovementFrom(e,t,n){const i=[];for(const o of t)for(const s of n){const a=nr.ofMovement(o,s);if(e.isCoordConnected(s,g.of(o))){const l=e.movePiece(a).getGroups();if(Za.isSplit(l)){const f=Za.getLargestGroups(l);if(1===f.size())i.push(nr.ofMovement(o,s));else for(const d of f){const m=d.getAnyElement().get(),E=nr.ofCut(o,s,m);i.push(E)}}else i.push(a)}}return i}getSafelyMovablePieceOrFirstOne(e){const t=e.getPieces().reverse(),n=e.getCurrentPlayer(),i=t.get(n).get(),o=i.getAnyElement().get(),s=[];for(const a of i)!1===this.isPieceBlockingAVictory(e,a)&&s.push(a);return new G1(0===s.length?[o]:s)}isPieceBlockingAVictory(e,t){const n=e.switchPiece(t),i=nr.ofDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,i,n).status===en.VICTORY)return!0;return!1}getListDrop(e){const t=[];for(const n of e){const i=nr.ofDrop(n);t.push(i)}return t}getBoardValue(e){const t=e.move,n=e.gameState,i=n.getCurrentOpponent(),o=i.getVictoryValue();let s={status:en.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};if(t.isPresent()&&(s=this.calculateBoardValue(t.get(),n)),s.status===en.VICTORY)return new v4(o,g.empty());if(n.turn>39){const a=n.countPieces(),c=a[0],l=a[1];return c<6&&l<6?new v4(c<l?I.ONE.getVictoryValue():l<c?I.ZERO.getVictoryValue():0,g.empty()):c<6?new v4(I.ZERO.getDefeatValue(),g.empty()):l<6?new v4(I.ONE.getDefeatValue(),g.empty()):new v4(c-l,s.preVictory)}return new v4(s.status===en.PRE_VICTORY?i.getPreVictory():s.sum*i.getScoreModifier(),s.preVictory)}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),s=[t];let a=t.getNext(be.factory.all[e],1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:en.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};const l=(e+s.length)%6;s.push(a),a=a.getNext(be.factory.all[l],1)}return{status:en.VICTORY,victory:g.of(s),preVictory:g.empty(),sum:0}}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let o=be.factory.all[e],s=t.getNext(o,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(s)===i)a.push(s);else{if(c)return{status:en.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};c=!0,o=o.getOpposite(),s=s.getNext(o,a.length-1)}s=s.getNext(o,1)}return{status:en.VICTORY,victory:g.of(a),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let o=be.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:en.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};s.length%2==0&&(o=be.factory.all[(e+s.length)%6]),s.push(a),a=a.getNext(o,1)}return{status:en.VICTORY,victory:g.of(s),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let o=be.factory.all[e];const s=[t];let a=t.getNext(o,1);for(;s.length<6;){if(n.getPieceAt(a)!==i)return{status:en.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};s.push(a),s.length%2==0&&(o=be.factory.all[(e+s.length)%6]),a=a.getNext(o,1)}return{status:en.VICTORY,victory:g.of(s),preVictory:g.empty(),sum:0}}getBoardInfo(e,t,n,i){const o=t.landing;switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,o,n,i);case"LINE":return this.getBoardInfoForLine(e.index,o,n,i);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,o,n,i);default:return this.getBoardInfoForTriangleEdge(e.index,o,n,i)}}getBoardInfoForCircle(e,t,n,i){const o=n.getCurrentPlayer(),a=[t];let c=t.getNext(be.factory.all[e],1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===o)return i;const m=(e+a.length)%6;a.push(c);const E=be.factory.all[m];d===K.NONE?(l+=.16,f=g.of(c)):l++,c=c.getNext(E,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoResult(e,t,n,i){let o=i.preVictory;if(4.16===e){if(o.isPresent()&&!1===o.equals(t))return{status:en.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};o=t}else if(5===e)return{status:en.VICTORY,victory:g.of(n),preVictory:g.empty(),sum:0};return{status:i.status,victory:g.empty(),preVictory:o,sum:i.sum+e}}getBoardInfoForLine(e,t,n,i){const o=be.factory.all[e];let s=t.getPrevious(o,5),a=[],c=[],l=g.empty();for(let L=0;L<6;L++){const z=this.updateEncounterAndReturnLastEmpty(n,s,c);z.isPresent()&&(l=z),a.push(s),s=s.getNext(o,1)}let f=i.status,d=i.preVictory,m=0,E=0;for(;m<6;){const L=c.reduce(($,B)=>$+B);if(6===L)return{status:en.VICTORY,victory:g.of(a),preVictory:g.empty(),sum:0};5.16===L&&f===en.DEFAULT&&(d.isPresent()?(Fe(!1===d.equals(l),"Impossible to have point aligned with differents line to a same point"),f=en.PRE_VICTORY):d=l),E=Math.max(E,L),a=a.slice(1,6),a.push(s),c=c.slice(1,6);const z=this.updateEncounterAndReturnLastEmpty(n,s,c);z.isPresent()&&(l=z),m++,s=s.getNext(o,1)}const w={status:f,victory:g.of(a),preVictory:d,sum:E};return this.getBoardInfoResult(E,l,a,w)}updateEncounterAndReturnLastEmpty(e,t,n){const i=e.getCurrentPlayer();switch(e.getPieceAt(t)){case i:return n.push(-7),g.empty();case K.NONE:return n.push(.16),g.of(t);default:return n.push(1),g.empty()}}getBoardInfoForTriangleCorner(e,t,n,i){const o=n.getCurrentPlayer();let s=be.factory.all[e];const a=[t];let c=t.getNext(s,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===o)return i;d===K.NONE?(l+=.16,f=g.of(c)):l++,a.length%2==0&&(s=be.factory.all[(e+a.length)%6]),a.push(c),c=c.getNext(s,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoForTriangleEdge(e,t,n,i){const o=n.getCurrentPlayer();let s=be.factory.all[e];const a=[t];let c=t.getNext(s,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===o)return i;d===K.NONE?(l+=.16,f=g.of(c)):l++,a.push(c),a.length%2==0&&(s=be.factory.all[(e+a.length)%6]),c=c.getNext(s,1)}return this.getBoardInfoResult(l,f,a,i)}},L0=YC,u(YC,"singleton",g.empty()),YC);uR=L0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],uR);const ue=K.NONE,Tt=I.ZERO,It=I.ONE;let fR=(()=>{class r{}return u(r,"MOVEMENT_NOT_DISCONNECTING",()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`),u(r,"MOVEMENT_SELF_DISCONNECTING",()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`),r})();class O3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,Wi.getInitialState()),W.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,Wi.ofRepresentation([[Tt,It,It,It,It,Tt],[ue,Tt,It,ue,Tt,ue],[It,It,Tt,ue,ue,ue],[ue,ue,Tt,ue,ue,ue],[ue,Tt,ue,ue,ue,ue],[Tt,ue,ue,ue,ue,ue]],0),[nr.ofDrop(new C(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Wi.ofRepresentation([[ue,ue,ue,It,ue,ue],[ue,ue,It,It,Tt,Tt],[ue,It,ue,Tt,It,ue],[It,Tt,Tt,Tt,Tt,It]],0),[nr.ofDrop(new C(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),W.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Wi.ofRepresentation([[ue,ue,ue,It,ue,ue],[ue,Tt,It,Tt,Tt,Tt],[ue,Tt,ue,Tt,Tt,ue],[It,It,It,ue,It,ue]],0),[nr.ofDrop(new C(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,Wi.ofRepresentation([[ue,ue,ue,ue,ue,ue,ue,It,ue],[ue,ue,ue,ue,ue,ue,Tt,ue,ue],[ue,ue,ue,ue,Tt,Tt,Tt,ue,ue],[ue,ue,ue,ue,It,It,ue,It,Tt],[ue,Tt,It,It,Tt,Tt,It,ue,ue],[Tt,Tt,Tt,Tt,It,It,It,Tt,ue],[It,It,Tt,ue,It,It,Tt,ue,ue],[ue,Tt,ue,Tt,Tt,ue,ue,ue,ue],[It,It,It,It,ue,ue,ue,ue,ue],[ue,Tt,ue,It,ue,ue,ue,ue,ue]],40),nr.ofMovement(new C(6,1),new C(5,1)),(t,n,i)=>{const o=i.countPieces();return 19===o[0]?18===o[1]?b.SUCCESS:b.failure(fR.MOVEMENT_NOT_DISCONNECTING()):b.failure(fR.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),W.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,Wi.ofRepresentation([[ue,ue,ue,ue,ue,It],[ue,ue,ue,ue,Tt,It],[ue,ue,ue,It,Tt,Tt],[ue,ue,Tt,ue,It,Tt],[It,It,ue,ue,ue,Tt],[Tt,It,ue,ue,ue,ue],[Tt,ue,ue,ue,ue,ue]],40),nr.ofMovement(new C(2,3),new C(3,3)),(t,n,i)=>t.start.equalsValue(new C(2,3))?b.SUCCESS:b.failure(fR.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),W.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,Wi.ofRepresentation([[ue,ue,ue,ue,ue,It],[ue,ue,ue,ue,Tt,It],[ue,ue,ue,It,Tt,Tt],[Tt,ue,Tt,ue,ue,It],[It,It,ue,ue,ue,ue],[Tt,Tt,ue,ue,ue,ue],[Tt,ue,ue,ue,ue,ue]],40),nr.ofCut(new C(2,3),new C(2,5),new C(2,5)),(t,n,i)=>t.keep.isAbsent()?b.failure($localize`This move has not cut the board in two equal halves.`):i.getPieceAt(t.landing)===K.NONE?b.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):b.SUCCESS,$localize`Congratulations, you won!`)])}}function gmt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",10),U("click",function(){const o=te(t).$implicit;return ne(p().onPieceClick(o))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","piece_",t.x,"_",t.y,""),y("ngClass",n.getPieceClass(t)),k("points",n.getHexaPointsAt(t))}}function mmt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",11),U("click",function(){const o=te(t).$implicit;return ne(p().onNeighborClick(o))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","neighbor_",t.x,"_",t.y,""),k("points",n.getHexaPointsAt(t))}}function _mt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",10),U("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.chosenLanding.get()))}),P()}if(2&r){const t=p();ye("id","chosenLanding_",t.chosenLanding.get().x,"_",t.chosenLanding.get().y,""),y("ngClass",t.getPlayerClass(t.state.getCurrentPlayer())),k("points",t.getHexaPointsAt(t.chosenLanding.get()))}}function vmt(r,e){if(1&r&&(A(),F(0,"polygon",12)),2&r){const t=e.$implicit,n=p();ye("id","disconnected_",t.x,"_",t.y,""),k("points",n.getHexaPointsAt(t))}}function Cmt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",13),U("click",function(){te(t);const i=p();return ne(i.onNeighborClick(i.leftCoord.get()))}),P()}if(2&r){const t=p();ye("id","leftCoord_",t.leftCoord.get().x,"_",t.leftCoord.get().y,""),k("points",t.getHexaPointsAt(t.leftCoord.get()))}}function ymt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",14),U("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.lastDrop.get()))}),P()}if(2&r){const t=p();ye("id","lastDrop_",t.lastDrop.get().x,"_",t.lastDrop.get().y,""),k("points",t.getHexaPointsAt(t.lastDrop.get()))}}function Mmt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",15),U("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.selectedPiece.get()))}),P()}if(2&r){const t=p();ye("id","selectedPiece_",t.selectedPiece.get().x,"_",t.selectedPiece.get().y,""),y("ngClass",t.getSelectedPieceClass()),k("points",t.getHexaPointsAt(t.selectedPiece.get()))}}function Emt(r,e){if(1&r&&(A(),F(0,"polygon",16)),2&r){const t=e.$implicit,n=p();ye("id","victoryCoord_",t.x,"_",t.y,""),k("points",n.getHexaPointsAt(t))}}function Smt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",19),U("click",function(){const o=te(t).$implicit;return ne(p(2).onPieceClick(o))}),P()}if(2&r){const t=e.$implicit,n=p(2);ye("id","cuttable_",t.x,"_",t.y,""),k("points",n.getHexaPointsAt(t))}}function Pmt(r,e){if(1&r&&(A(),S(0,"g",17),T(1,Smt,1,3,"polygon",18),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let Tmt=(()=>{var r;class e extends iu{constructor(n){super(n),u(this,"state",void 0),u(this,"pieces",void 0),u(this,"disconnecteds",[]),u(this,"cuttableGroups",[]),u(this,"victoryCoords",void 0),u(this,"neighbors",void 0),u(this,"leftCoord",g.empty()),u(this,"lastDrop",g.empty()),u(this,"selectedPiece",g.empty()),u(this,"chosenLanding",g.empty()),u(this,"viewBox",void 0),u(this,"nextClickShouldSelectGroup",!1),this.rules=Za.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new uR(this.rules,"SixMinimax")],this.encoder=nr.encoder,this.tutorial=(new O3e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new ou(1.5*this.SPACE_SIZE,new C(2*this.SPACE_SIZE,0),Fr.INSTANCE)}cancelMoveAttempt(){var n=this;return M(function*(){n.selectedPiece=g.empty(),n.chosenLanding=g.empty(),n.cuttableGroups=[],n.nextClickShouldSelectGroup=!1,yield n.updateBoard(!1)})()}updateBoard(n){var i=this;return M(function*(){i.state=i.node.gameState,i.node.move.isAbsent()&&i.hideLastMove(),i.pieces=i.state.getPieceCoords(),i.neighbors=i.getEmptyNeighbors(),i.viewBox=i.getViewBox()})()}hideLastMove(){this.leftCoord=g.empty(),this.lastDrop=g.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const n=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return c4.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH).toSVGString()}showLastMove(n){var i=this;return M(function*(){i.lastDrop=g.of(n.landing),i.leftCoord=!1===n.isDrop()?g.of(n.start.get()):g.empty();const o=i.getState();i.rules.getGameStatus(i.node).isEndGame&&(i.victoryCoords=i.rules.getShapeVictory(n,o)),i.disconnecteds=i.getDisconnected()})()}getDisconnected(){const n=this.getPreviousState().getPieceCoords(),i=this.getState().getPieceCoords(),o=[];for(const a of n)!1===this.node.move.get().start.equalsValue(a)&&!1===i.some(l=>l.equals(a))&&o.push(a);const s=this.lastDrop.get();return!1===this.pieces.some(a=>a.equals(s))&&!1===i.some(a=>a.equals(s))&&o.push(s),o}getEmptyNeighbors(){let n=Za.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const i=this.chosenLanding.get();n=n.filter(o=>!1===o.equals(i))}return n}getPieceClass(n){const i=this.getState().getPieceAt(n);return this.getPlayerClass(i)}onPieceClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#piece_"+n.x+"_"+n.y);if(o.isFailure())return i.cancelMove(o.getReason());if(i.state.turn<40)return i.cancelMove(ja.NO_MOVEMENT_BEFORE_TURN_40());if(i.chosenLanding.isAbsent())return i.state.getPieceAt(n)===i.state.getCurrentOpponent()?i.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(i.selectedPiece=i.selectedPiece.equalsValue(n)?g.empty():g.of(n),b.SUCCESS);{const s=nr.ofCut(i.selectedPiece.get(),i.chosenLanding.get(),n);return i.chooseMove(s)}})()}onNeighborClick(n){var i=this;return M(function*(){const o=yield i.canUserPlay("#neighbor_"+n.x+"_"+n.y);if(o.isFailure())return i.cancelMove(o.getReason());if(i.nextClickShouldSelectGroup)return i.cancelMove(ja.MUST_CUT());if(i.state.turn<40)return i.chooseMove(nr.ofDrop(n));if(i.selectedPiece.isAbsent())return i.cancelMove(ja.CAN_NO_LONGER_DROP());{const s=nr.ofMovement(i.selectedPiece.get(),n),a=Za.isLegalPhaseTwoMove(s,i.state);return i.neededCutting(a)?(i.chosenLanding=g.of(n),i.moveVirtuallyPiece(),i.showCuttable(),i.nextClickShouldSelectGroup=!0,b.SUCCESS):i.chooseMove(s)}})()}neededCutting(n){return n.isFailure()&&n.getReason()===ja.MUST_CUT()}moveVirtuallyPiece(){const n=this.selectedPiece.get();this.pieces=this.pieces.filter(i=>!1===i.equals(n)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const n=nr.ofMovement(this.selectedPiece.get(),this.chosenLanding.get()),o=this.state.movePiece(n).getGroups(),s=Za.getLargestGroups(o);this.cuttableGroups=[];for(const a of s)this.cuttableGroups.push(a.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-six"]],features:[Qe],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,gmt,1,4,"polygon",1),T(2,mmt,1,3,"polygon",2),T(3,_mt,1,4,"polygon",3),T(4,vmt,1,3,"polygon",4),T(5,Cmt,1,3,"polygon",5),T(6,ymt,1,3,"polygon",6),T(7,Mmt,1,4,"polygon",7),T(8,Emt,1,3,"polygon",8),T(9,Pmt,2,1,"g",9),P()),2&n&&(k("viewBox",i.viewBox),_(1),y("ngForOf",i.pieces),_(1),y("ngForOf",i.neighbors),_(1),y("ngIf",i.chosenLanding.isPresent()),_(1),y("ngForOf",i.disconnecteds),_(1),y("ngIf",i.leftCoord.isPresent()),_(1),y("ngIf",i.lastDrop.isPresent()),_(1),y("ngIf",i.selectedPiece.isPresent()),_(1),y("ngForOf",i.victoryCoords),_(1),y("ngForOf",i.cuttableGroups))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Bo extends wL{static of(e,t){return new Bo(e,t)}static from(e,t){try{const n=new Bo(e,t);return ie.success(n)}catch(n){return ie.failure(n.message)}}getMaximalDistance(){return 9}}u(Bo,"encoder",Ho.getFallibleEncoder(Bo.from));const Omt={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:I.ZERO};class Xc extends NL{static getInitialState(){const e=on.UNOCCUPIED,t=on.INVADERS,n=on.DEFENDERS;return new Xc([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,n,e,e,e,e],[t,e,e,e,n,e,e,e,t],[t,t,n,n,on.PLAYER_ONE_KING,n,n,t,t],[t,e,e,e,n,e,e,e,t],[e,e,e,e,n,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}of(e,t){return new Xc(e,t)}}class Rl extends AL{static get(){return Rl.singleton.isAbsent()&&(Rl.singleton=g.of(new Rl)),Rl.singleton.get()}constructor(){super(Xc,Omt,Bo.from)}}u(Rl,"singleton",g.empty());const H=on.UNOCCUPIED,wn=on.INVADERS,qi=on.DEFENDERS,KC=on.PLAYER_ONE_KING;class w3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Xc.getInitialState()),W.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Xc.getInitialState(),Bo.of(new C(4,1),new C(1,1)),$localize`Congratulations!`),W.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Xc([[H,H,H,wn,wn,wn,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,H,qi,H,H,H,H],[H,H,H,wn,qi,H,H,H,wn],[wn,wn,qi,qi,KC,qi,qi,wn,wn],[H,H,H,H,qi,H,H,H,wn],[H,H,H,H,qi,H,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,wn,wn,wn,H,H,H]],1),[Bo.of(new C(2,4),new C(2,3)),Bo.of(new C(4,2),new C(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),W.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Xc([[H,H,H,wn,wn,wn,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,H,qi,H,H,H,H],[H,H,qi,H,KC,H,qi,H,wn],[wn,wn,H,qi,H,qi,qi,wn,wn],[H,H,H,H,qi,H,H,H,wn],[H,H,H,H,qi,H,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,wn,wn,wn,H,H,H]],12),[Bo.of(new C(1,4),new C(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),W.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new Xc([[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,wn,H,H,H,H,H,H,H],[wn,KC,H,wn,H,H,H,H,H],[H,wn,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[Bo.of(new C(3,4),new C(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),W.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new Xc([[H,H,wn,KC,wn,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,wn,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[Bo.of(new C(3,3),new C(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function bmt(r,e){1&r&&(A(),F(0,"polygon",8))}function wmt(r,e){1&r&&(A(),F(0,"rect",9))}function Nmt(r,e){if(1&r&&(A(),S(0,"g"),T(1,bmt,1,0,"polygon",6),T(2,wmt,1,0,"ng-template",null,7,dn),P()),2&r){const t=ln(3),n=p().index,i=p().index,o=p();_(1),y("ngIf",o.isCentralThrone(n,i))("ngIfElse",t)}}function Amt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Imt(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function kmt(r,e){if(1&r&&(A(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function xmt(r,e){if(1&r&&(A(),T(0,Imt,1,1,"polyline",14),T(1,kmt,4,20,"ng-template",null,15,dn)),2&r){const t=ln(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function Lmt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",10),T(2,Amt,6,25,"g",11),T(3,xmt,3,2,"ng-template",null,12,dn),P()),2&r){const t=ln(4),n=p().index,i=p().index,o=p();_(1),ye("id","piece_",n,"_",i,""),y("ngClass",o.viewInfo.pieceClasses[i][n]),k("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)("cx",.5*o.SPACE_SIZE)("cy",.5*o.SPACE_SIZE),_(1),y("ngIf",o.isInvader(n,i))("ngIfElse",t)}}function Rmt(r,e){if(1&r){const t=pe();A(),S(0,"g",3),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),F(1,"rect",4),T(2,Nmt,4,2,"g",5),T(3,Lmt,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),k("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function zmt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Rmt,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Dmt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",17),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o.x,o.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),ye("id","click_",t.x,"_",t.y,""),k("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let Hmt=(()=>{var r;class e extends IL{constructor(n){super(n,Bo.from),this.rules=Rl.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=this.createMinimaxes(),this.encoder=Bo.encoder,this.tutorial=(new w3e).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-tablut"]],features:[Qe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,zmt,2,1,"g",1),T(2,Dmt,2,6,"g",1),P()),2&n&&(k("viewBox",i.getViewBox()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Cs=(()=>{class r extends B1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.WIDTH)}static getInitialState(){const t=Re.createTable(r.WIDTH,r.WIDTH,K.NONE);return new r(t,0)}isInDropPhase(){return this.turn<8}}return u(r,"WIDTH",5),r})();var dR;class ys extends Pr{static from(e){return Cs.isOnBoard(e)?ie.success(new ys(e.x,e.y)):ie.failure(ru.OUT_OF_RANGE(e))}toString(){return"TeekoMove"+this.coord.toString()}equals(e){return e instanceof ys&&super.equals(e)}}u(ys,"encoder",Pr.getFallibleEncoder(ys.from));class Go extends Fs{static from(e,t){return!1===Cs.isOnBoard(e)?ie.failure(ru.OUT_OF_RANGE(e)):!1===Cs.isOnBoard(t)?ie.failure(ru.OUT_OF_RANGE(t)):e.equals(t)?ie.failure(Le.MOVE_CANNOT_BE_STATIC()):ie.success(new Go(e,t))}toString(){return"TeekoMove("+this.getStart().toString()+" -> "+this.getEnd().toString()+")"}equals(e){return e instanceof Go&&super.equals(e)}}u(Go,"encoder",Fs.getFallibleEncoder(Go.from)),function(r){r.encoder=we.disjunction([e=>e instanceof ys,e=>e instanceof Go],[ys.encoder,Go.encoder])}(dR||(dR={}));class Ms extends Yn{static get(){return Ms.singleton.isAbsent()&&(Ms.singleton=g.of(new Ms)),Ms.singleton.get()}constructor(){super(Cs)}isLegal(e,t){return t.isInDropPhase()?this.isLegalDrop(e,t):this.isLegalTranslation(e,t)}isLegalDrop(e,t){return q.assert(e instanceof ys,"Cannot translate in dropping phase !"),t.getPieceAt(e.coord).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}isLegalTranslation(e,t){q.assert(e instanceof Go,"Cannot drop in translation phase !");const n=e,i=t.getCurrentOpponent();return t.getPieceAt(n.getStart())===i?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(n.getStart())===K.NONE?b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):t.getPieceAt(n.getEnd()).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}applyLegalMove(e,t){return e instanceof ys?this.applyLegalDrop(e,t):this.applyLegalTranslate(e,t)}applyLegalDrop(e,t){const n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.getCurrentPlayer(),new Cs(n,t.turn+1)}applyLegalTranslate(e,t){const n=t.getCopiedBoard();return n[e.getStart().y][e.getStart().x]=K.NONE,n[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new Cs(n,t.turn+1)}getGameStatus(e){const t=e.gameState;return this.getVictoryCoord(t).length>0?ve.getVictory(t.getCurrentOpponent()):ve.ONGOING}getLastCoord(e){return e instanceof ys?e.coord:e.getEnd()}getSquareInfo(e){const t=[],n=[0,0];for(let i=0;i<Cs.WIDTH-1;i++)for(let o=0;o<Cs.WIDTH-1;o++){const s=new C(i,o),a=new C(i+1,o),c=new C(i,o+1),l=new C(i+1,o+1),f=[e.getPieceAt(s),e.getPieceAt(a),e.getPieceAt(c),e.getPieceAt(l)],d=this.count(f,K.NONE),m=this.count(f,K.ZERO),E=this.count(f,K.ONE);d<4&&(4===m||4===E?t.push(s,a,c,l):m>0?n[0]=n[0]+1:n[1]=n[1]+1)}return{score:n[1]-n[0],victoriousCoords:t}}count(e,t){let n=0;for(const i of e)i===t&&n++;return n}getVictoryCoord(e){const t=Ms.TEEKO_HELPER.getVictoriousCoord(e);return t.push(...this.getSquareInfo(e).victoriousCoords),t}}u(Ms,"singleton",g.empty()),u(Ms,"TEEKO_HELPER",new cu(Cs.isOnBoard,q.identity,4));class Vmt extends ds{constructor(){super(Ms.get(),"Teeko Minimax")}getListMoves(e){return e.gameState.isInDropPhase()?this.getListDrops(e.gameState):this.getListTranslations(e.gameState)}getListDrops(e){const t=[];for(const n of e.getCoordsAndContents()){const i=n.coord;if(!1===e.getPieceAt(i).isPlayer()){const o=ys.from(i).get();t.push(o)}}return t}getListTranslations(e){const t=[],n=e.getCurrentPlayer(),i=this.getCoordsContaining(e,n),o=this.getCoordsContaining(e,K.NONE);for(const s of i)for(const a of o){const c=Go.from(s,a).get();t.push(c)}return t}getCoordsContaining(e,t){const n=[];for(const i of e.getCoordsAndContents())i.content===t&&n.push(i.coord);return n}getBoardValue(e){const t=Ms.TEEKO_HELPER.getBoardValue(e.gameState).value;if(an.VICTORIES.some(n=>n===t))return new an(t);{const n=Ms.get().getSquareInfo(e.gameState);return n.victoriousCoords.length>0?an.fromWinner(e.gameState.getCurrentOpponent()):new an(n.score+t)}}}const Fn=K.NONE,zl=K.ZERO,Dl=K.ONE;class I3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The goal of the game is to align your 4 pieces, or to form a square with them.`,Cs.getInitialState()),W.anyMove($localize`Dropping a piece`,$localize`During your first four turns, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,Cs.getInitialState(),ys.from(new C(2,2)).get(),$localize`Congratulations!`),W.anyMove($localize`Moving a piece`,$localize`Once all of your four pieces are placed on the board, you must now move one of your piece to another empty space. The goal remain to be the first to create a line or a square.<br/><br/>You're playing Dark, move a piece.`,new Cs([[zl,Dl,Fn,Fn,Fn],[zl,zl,Fn,Fn,Fn],[Dl,Dl,Fn,Fn,Fn],[Dl,zl,Fn,Fn,Fn],[Fn,Fn,Fn,Fn,Fn]],8),Go.from(new C(1,3),new C(2,1)).get(),$localize`Congratulations!`),W.fromMove($localize`Victory`,$localize`In this board, you can win either by creating a line, or a square.<br/><br/>You are playing Dark, win.`,new Cs([[Dl,Fn,Fn,Fn,Fn],[Dl,zl,Fn,Fn,Fn],[Fn,zl,zl,Dl,Fn],[Fn,Dl,Fn,zl,Fn],[Fn,Fn,Fn,Fn,Fn]],8),[Go.from(new C(1,2),new C(4,4)).get(),Go.from(new C(3,3),new C(2,1)).get()],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)])}}function Fmt(r,e){if(1&r&&(A(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),k("r",42)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function $mt(r,e){if(1&r){const t=pe();A(),S(0,"g",3),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),F(1,"rect",4),T(2,Fmt,1,6,"circle",5),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,o=p();ye("id","click_",n,"_",i,""),_(1),ye("id","space_",n,"_",i,""),y("ngClass",o.getSpaceClasses(n,i)),k("x",o.SPACE_SIZE*n)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",t.isPlayer())}}function Bmt(r,e){if(1&r&&(A(),S(0,"g"),T(1,$mt,3,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let Gmt=(()=>{var r;class e extends Vi{constructor(n){super(n),u(this,"selected",g.empty()),u(this,"last",g.empty()),u(this,"moved",[]),u(this,"victory",[]),this.rules=Ms.get(),this.node=this.rules.getInitialNode(),this.encoder=dR.encoder,this.tutorial=(new I3e).tutorial,this.availableMinimaxes=[new Vmt]}updateBoard(n){var i=this;return M(function*(){i.board=i.node.gameState.board})()}showLastMove(n){var i=this;return M(function*(){i.last=g.of(i.rules.getLastCoord(n)),i.moved=n instanceof Go?[n.getStart(),n.getEnd()]:[],i.victory=i.rules.getVictoryCoord(i.getState())})()}hideLastMove(){var n=this;return M(function*(){n.last=g.empty(),n.moved=[],n.victory=[]})()}cancelMoveAttempt(){this.selected=g.empty()}onClick(n,i){var o=this;return M(function*(){const s=yield o.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return o.cancelMove(s.getReason());const a=new C(n,i);if(o.getState().isInDropPhase()){const c=ys.from(a).get();return o.chooseMove(c)}if(o.selected.isPresent()){if(o.selected.equalsValue(a))return o.selected=g.empty(),b.SUCCESS;{const c=Go.from(o.selected.get(),a).get();return o.chooseMove(c)}}{const c=o.getState().getCurrentPlayer(),l=o.getState().getPieceAt(a);return l===c?(o.selected=g.of(a),b.SUCCESS):o.cancelMove(l===K.NONE?Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Le.CANNOT_CHOOSE_OPPONENT_PIECE())}})()}getPieceClasses(n,i){const o=new C(n,i),a=[this.getPlayerClass(this.getState().getPieceAt(o))];return this.victory.some(c=>c.equals(o))?a.push("victory-stroke"):this.last.equalsValue(o)?a.push("last-move-stroke"):this.selected.equalsValue(o)&&a.push("selected-stroke"),a}getSpaceClasses(n,i){const o=new C(n,i);return this.moved.some(s=>s.equals(o))?["moved-fill"]:[]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-teeko"]],features:[Qe],decls:2,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 510 510","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,Bmt,2,1,"g",1),P()),2&n&&(_(1),y("ngForOf",i.board))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class mi{constructor(e,t){u(this,"owner",void 0),u(this,"tileId",void 0),this.owner=e,this.tileId=t}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class qr{static of(e){let t=-1;for(const n of e)q.assert(t<n.tileId,"TrexoPieceStack: dropped turn should be ascending"),t=n.tileId;return new qr(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}getHeight(){return this.pieces.length}getOwner(){const e=this.pieces.length;return 0===e?K.NONE:this.pieces[e-1].owner}getUpperTileId(){const e=this.pieces.length;return 0===e?-1:this.pieces[e-1].tileId}add(e){return qr.of(this.pieces.concat(e))}getPieceAt(e){return q.assert(e<this.pieces.length,"no element "+e+"in piece!"),this.pieces[e]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(e=>"("+e.toString()+")").join(" ")+"]"}}u(qr,"EMPTY",qr.of([]));let y2=(()=>{class r extends B1{static getInitialState(){const t=Re.createTable(r.SIZE,r.SIZE,qr.EMPTY);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}static of(t,n){q.assert(t.length===r.SIZE,"Invalid board dimensions");for(const i of t)q.assert(i.length===r.SIZE,"Invalid board dimensions");return new r(t,n)}drop(t,n){const i=this.getCopiedBoard(),o=new mi(n,this.turn);return i[t.y][t.x]=i[t.y][t.x].add(o),new r(i,this.turn)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(t=>"["+t.map(n=>"TrexoPieceStack.of("+n.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(t,n,i){return this.getPieceAtXY(t,n).getPieceAt(i)}}return u(r,"SIZE",10),r})(),XC=(()=>{class r{}return u(r,"NON_NEIGHBORING_SPACES",()=>$localize`Those two spaces are not neighbors!`),u(r,"NO_WAY_TO_DROP_IT_HERE",()=>$localize`There is no way to put a piece there!`),u(r,"CANNOT_DROP_ON_ONLY_ONE_PIECE",()=>$localize`You cannot drop on only one piece!`),u(r,"CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS",()=>$localize`You cannot drop a piece on uneven grounds!`),r})();var L3e;class Uo extends Ho{static from(e,t){return q.assert(y2.isOnBoard(e),`${e.toString()} is out of the TrexoBoard!`),q.assert(y2.isOnBoard(t),`${t.toString()} is out of the TrexoBoard!`),1===e.getOrthogonalDistance(t)?ie.success(new Uo(e,t)):ie.failure(XC.NON_NEIGHBORING_SPACES())}constructor(e,t){super(e,t)}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(e){return this.getFirst().equals(e.getFirst())&&this.getSecond().equals(e.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}u(Uo,"encoder",Ho.getFallibleEncoder(Uo.from));class _i extends Yn{static get(){return _i.instance.isAbsent()&&(_i.instance=g.of(new _i)),_i.instance.get()}static getOwner(e){return e.getOwner()}constructor(){super(y2)}applyLegalMove(e,t,n){return t.drop(e.getZero(),I.ZERO).drop(e.getOne(),I.ONE).incrementTurn()}isLegal(e,t){return this.isUnevenGround(e,t)?b.failure(XC.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(e,t)?b.failure(XC.CANNOT_DROP_ON_ONLY_ONE_PIECE()):b.SUCCESS}isUnevenGround(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return n.getHeight()!==i.getHeight()}landsOnOnlyOnePiece(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return(-1!==n.getUpperTileId()||-1!==i.getUpperTileId())&&n.getUpperTileId()===i.getUpperTileId()}static getSquareScore(e,t){return _i.TREXO_HELPER.getSquareScore(e,t)}static getVictoriousCoords(e){const t=[],n=[],i=e.getCurrentOpponent();for(const o of e.toMap()){const s=o.key,a=e.getPieceAt(s).getOwner();if(a.isPlayer()){const c=_i.getSquareScore(e,s);Di.getScoreStatus(c)===en.VICTORY&&(a===i?t.push(s):n.push(s))}}return n.length>0?n:t}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=!1;for(const o of t.toMap()){const s=o.key,a=t.getPieceAt(s).getOwner();if(a.isPlayer()){const c=_i.getSquareScore(t,s);if(Di.getScoreStatus(c)===en.VICTORY){if(a!==n)return ve.getDefeat(n);i=!0}}}return i?ve.getVictory(n):ve.ONGOING}getLegalMoves(e){const t=[];for(const n of e.toMap()){const i=n.key;if(i.x+1<y2.SIZE){const o=new C(i.x+1,i.y);t.push(...this.getPossiblesMoves(e,i,o))}if(i.y+1<y2.SIZE){const o=new C(i.x,i.y+1);t.push(...this.getPossiblesMoves(e,i,o))}}return t}getPossiblesMoves(e,t,n){const i=e.getPieceAt(t),o=e.getPieceAt(n);let s;s=!i.isGround()&&i.getUpperTileId()===o.getUpperTileId();const a=i.getHeight()!==o.getHeight();return s||a?[]:[Uo.from(t,n).get(),Uo.from(n,t).get()]}}L3e=_i,u(_i,"instance",g.empty()),u(_i,"TREXO_HELPER",new cu(y2.isOnBoard,L3e.getOwner,5));class Umt extends ds{getListMoves(e){return _i.get().getLegalMoves(e.gameState)}getBoardValue(e){let t=0;const n=e.gameState,i=n.getCurrentOpponent();let o=!1;for(const s of n.toMap()){const a=n.getPieceAt(s.key).getOwner();if(a.isPlayer()){const c=_i.getSquareScore(n,s.key);if(Di.getScoreStatus(c)===en.VICTORY){if(a!==i)return new an(i.getDefeatValue());o=!0}else t+=c}}return new an(o?i.getVictoryValue():t)}}const Q=qr.EMPTY,R3e=qr.of([new mi(I.ONE,0)]),Wmt=qr.of([new mi(I.ZERO,0)]),qmt=qr.of([new mi(I.ONE,1)]),z3e=qr.of([new mi(I.ZERO,1)]),jmt=qr.of([new mi(I.ZERO,2)]),Zmt=qr.of([new mi(I.ONE,2)]),Ymt=qr.of([new mi(I.ZERO,0),new mi(I.ZERO,3)]),Kmt=qr.of([new mi(I.ONE,1),new mi(I.ONE,3)]),Xmt=qr.of([new mi(I.ZERO,4)]),Qmt=qr.of([new mi(I.ONE,4)]),Jmt=qr.of([new mi(I.ZERO,5)]),e_t=qr.of([new mi(I.ONE,5)]),t_t=qr.of([new mi(I.ONE,6)]),n_t=qr.of([new mi(I.ZERO,6)]);class D3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,y2.getInitialState()),W.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,y2.getInitialState(),Uo.from(new C(4,4),new C(3,4)).get(),$localize`Congratulations!`),W.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new y2([[Q,Q,Q,R3e,Wmt,z3e,qmt,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),[Uo.from(new C(4,0),new C(5,0)).get(),Uo.from(new C(5,0),new C(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),W.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new y2([[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Jmt,Q,Q,Q,Q,Q,Q],[Q,Q,Q,e_t,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,R3e,Q,Q,Xmt,Qmt,Q],[Q,Q,Q,Q,Ymt,Kmt,z3e,Q,Q,Q],[Q,Q,Q,Q,Q,jmt,t_t,n_t,Q,Q],[Q,Q,Q,Q,Q,Zmt,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),Uo.from(new C(2,0),new C(2,1)).get(),(t,n,i)=>_i.TREXO_HELPER.getSquareScore(i,t.getOne())===Number.MAX_SAFE_INTEGER?b.SUCCESS:b.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)])}}var hR;function r_t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"polygon",5),U("click",function(){const o=te(t).index,s=p().index;return ne(p().onClick(o,s))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClasses(t,n)),k("points",i.getParallelogramPoints())("transform",i.getTranslate(t,n,0))}}function i_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,r_t,2,5,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function o_t(r,e){if(1&r){const t=pe();A(),S(0,"g",8),U("click",function(){te(t);const i=p().index,o=p().index;return ne(p(2).onClick(i,o))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index,s=p().index,a=p();Oi("id","half_tile_",n,"_",o,"_",s,""),y("mode",a.mode)("coord",a.Coord3D.of(n,o,s))("mustDisplayHeight","2D"===a.chosenMode)("move",i.move.get())("pieceClasses",a.getPieceClasses(n,o,s)),k("transform",a.getTranslate(n,o,s+1))}}const H3e=function(r){return[r]};function s_t(r,e){if(1&r){const t=pe();A(),S(0,"g",9),U("click",function(){te(t);const i=p().index,o=p().index;return ne(p(2).onClick(i,o))}),P()}if(2&r){const t=p().index,n=p().index,i=p().index,o=p();Oi("id","dropped_piece_",t,"_",n,"_",i,""),y("mode",o.mode)("coord",o.Coord3D.of(t,n,i))("pieceClasses",pa(7,H3e,o.currentOpponentClass)),k("transform",o.getTranslate(t,n,i+1))}}function a_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,o_t,1,9,"g",6),T(2,s_t,1,9,"g",7),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.move.isPresent()),_(1),y("ngIf",t.isDroppedPiece)}}function c_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,a_t,3,2,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function l_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,c_t,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}const u_t=function(){return["player0-fill"]};function f_t(r,e){if(1&r){const t=pe();A(),S(0,"g",10),U("click",function(){return te(t),ne(p().switchToMode("3D"))}),P()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["3D"])("coord",t.Coord3D.of(10.5,8.5,0))("pieceClasses",_1(4,u_t)),k("transform",t.get3DSwitcherTransform())}}function d_t(r,e){if(1&r){const t=pe();A(),S(0,"g",11),U("click",function(){return te(t),ne(p().switchToMode("2D"))}),P()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["2D"])("coord",t.Coord3D.of(12,9,0))("pieceClasses",pa(4,H3e,t.currentPlayerClass)),k("transform",t.getTranslate(12,9,0))}}class $n extends Hce{constructor(e){super(e),u(this,"TrexoComponent",$n),u(this,"left",-this.STROKE_WIDTH/2),u(this,"Coord3D",Zd),u(this,"up",0),u(this,"width",void 0),u(this,"height",void 0),u(this,"mode",void 0),u(this,"chosenMode","3D"),u(this,"victoryCoords",[]),u(this,"droppedPiece",g.empty()),u(this,"possibleNextClicks",[]),u(this,"possibleMoves",[]),u(this,"pieceOnBoard",[]),u(this,"currentOpponentClass","player1"),u(this,"currentPlayerClass","player0"),this.rules=_i.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Umt(this.rules,"TrexoMinimax")],this.encoder=Uo.encoder,this.tutorial=(new D3e).tutorial,$n.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D")}switchToMode(e){this.chosenMode=e,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=$n.modeMap[e]}getViewBoxWidth(){const e=$n.modeMap["3D"],t=y2.SIZE;return"2D"===this.chosenMode?(t+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:t*(this.SPACE_SIZE*(e.horizontalWidthRatio+e.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const t=y2.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?t:this.STROKE_WIDTH+t+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const e=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+e)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*$n.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(e){var t=this;return M(function*(){const n=t.getState();t.board=n.getCopiedBoard(),t.currentOpponentClass=t.getPlayerClass(n.getCurrentOpponent()),t.currentPlayerClass=t.getPlayerClass(n.getCurrentPlayer()),t.possibleMoves=t.rules.getLegalMoves(n),t.victoryCoords=_i.getVictoriousCoords(n),t.pieceOnBoard=t.get3DBoard(),t.height=t.getViewBoxHeight(),t.up=t.getViewBoxUp()})()}get3DBoard(){const e=Re.create3DTable(1,y2.SIZE,y2.SIZE,$n.INITIAL_PIECE_ON_BOARD);let t=1;for(let n=0;n<=t;n++)for(const i of this.getState().toMap()){const o=i.key,s=i.value.getHeight();if(t=Math.max(t,s),n<s){const a=this.extractMoveFromState(o.x,o.y,n);this.addMoveToArray(n,a,e)}}return e}extractMoveFromState(e,t,n){const i=this.getState().getPieceAtXYZ(e,t,n),o=new C(e,t);let s=new C(-2,-2);for(const a of Me.ORTHOGONALS){const c=o.getNext(a);if(y2.isOnBoard(c)){const l=this.getState().getPieceAt(c);l.getHeight()>n&&l.getPieceAt(n).tileId===i.tileId&&(s=c)}}return i.owner===I.ZERO?Uo.from(o,s).get():Uo.from(s,o).get()}addMoveToArray(e,t,n){for(;n.length<=e;)n.push(Re.createTable(y2.SIZE,y2.SIZE,$n.INITIAL_PIECE_ON_BOARD));n[e][t.getZero().y][t.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)},n[e][t.getOne().y][t.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)}}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#space_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const o=new C(e,t);if(n.droppedPiece.isPresent()){const s=n.droppedPiece.get();if(n.droppedPiece.equalsValue(o))return yield n.cancelMoveAttempt(),b.SUCCESS;if(n.possibleNextClicks.some(a=>a.equals(o))){const a=n.getState().getCurrentPlayer()===I.ZERO,f=Uo.from(a?o:s,a?s:o).get();return n.chooseMove(f)}n.deselectPiece()}return n.selectPiece(o)})()}deselectPiece(){const e=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),t=this.droppedPiece.get().y,n=this.droppedPiece.get().x;this.pieceOnBoard[e][t][n]=$n.INITIAL_PIECE_ON_BOARD;for(const i of this.possibleNextClicks)this.pieceOnBoard[e][i.y][i.x].isPossibleClick=!1}selectPiece(e){var t=this;return M(function*(){if(t.possibleMoves.some(n=>n.getZero().equals(e))){const n=t.getState().getPieceAt(e).getHeight();return n>=t.pieceOnBoard.length&&t.pieceOnBoard.push(Re.createTable(y2.SIZE,y2.SIZE,$n.INITIAL_PIECE_ON_BOARD)),t.showDroppedPieceAndIndicators(e,n),b.SUCCESS}return t.cancelMove(XC.NO_WAY_TO_DROP_IT_HERE())})()}showDroppedPieceAndIndicators(e,t){this.droppedPiece=g.of(e),this.possibleNextClicks=this.getPossibleNextClicks(e);for(const n of this.possibleNextClicks)this.pieceOnBoard[t][n.y][n.x]={isDroppedPiece:!1,isPossibleClick:!0,move:g.empty()};this.pieceOnBoard[t][e.y][e.x]={isDroppedPiece:!0,isPossibleClick:!1,move:g.empty()}}getPossibleNextClicks(e){return this.possibleMoves.filter(n=>n.getZero().equals(e)).map(n=>n.getOne())}cancelMoveAttempt(){var e=this;return M(function*(){e.droppedPiece=g.empty(),e.possibleNextClicks=[],yield e.updateBoard(!1)})()}getPieceClasses(e,t,n){const i=new C(e,t),o=this.getState().getPieceAtXYZ(e,t,n).owner;let s=[this.getPlayerClass(o)];s=s.concat(this.getSpaceClasses(e,t));for(const a of this.victoryCoords)if(a.equals(i)){s.push("victory-stroke");break}if(this.node.move.isPresent()){const a=this.node.move.get();(a.getZero().equals(i)||a.getOne().equals(i))&&s.push("last-move-stroke")}return s}getSpaceClasses(e,t){for(const n of this.pieceOnBoard)if(n[t][e].isPossibleClick)return["darker"];return[]}getTranslate(e,t,n){const o=this.getCoordTranslate(e,t,n,$n.modeMap[this.chosenMode]);return"translate("+o.x+" "+o.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(t=>t.x+" "+t.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords($n.modeMap[this.chosenMode])}get3DSwitcherTransform(){const e=$n.modeMap["3D"],t=e.horizontalWidthRatio+e.offsetRatio;return"translate("+(10+e.offsetRatio)*e.parallelogramHeight+", "+(9+(1-1/t)/2)*e.parallelogramHeight+") scale("+1/t+")"}}hR=$n,u($n,"STROKE_WIDTH",void 0),u($n,"INITIAL_PIECE_ON_BOARD",{isDroppedPiece:!1,isPossibleClick:!1,move:g.empty()}),u($n,"modeMap",{"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}}),u($n,"\u0275fac",function(e){return new(e||hR)(G(Ut))}),u($n,"\u0275cmp",je({type:hR,selectors:[["app-trexo"]],features:[Qe],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(e,t){if(1&e&&(A(),S(0,"svg",0),T(1,i_t,2,1,"g",1),T(2,l_t,2,1,"g",1),S(3,"g",null,2),T(5,f_t,1,5,"g",3),T(6,d_t,1,6,"ng-template",null,4,dn),P()()),2&e){const n=ln(7);k("viewBox",t.left+" "+t.up+" "+t.width+" "+t.height),_(1),y("ngForOf",t.board),_(1),y("ngForOf",t.pieceOnBoard),_(3),y("ngIf","2D"===t.chosenMode)("ngIfElse",n)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class j1{}var ra;u(j1,"PLACEMENT_AFTER_INITIAL_PHASE",()=>$localize`You cannot put a new ring after the tenth turn.`),u(j1,"NO_MARKERS_IN_INITIAL_PHASE",()=>$localize`You cannot put a marker in a ring before placing all of your rings.`),u(j1,"MISSING_CAPTURES",Zs.MISSING_CAPTURES),u(j1,"MOVE_DIRECTION_INVALID",()=>$localize`The direction of your move is invalid: a move is made along a straight line.`),u(j1,"CAN_ONLY_CAPTURE_YOUR_MARKERS",()=>$localize`You can only capture your own markers.`),u(j1,"SHOULD_SELECT_PLAYER_RING",()=>$localize`You must pick one of your own rings to move.`),u(j1,"SHOULD_END_MOVE_ON_EMPTY_SPACE",()=>$localize`Your ring must land on an empty space.`),u(j1,"MOVE_SHOULD_NOT_PASS_ABOVE_RING",()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`),u(j1,"MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS",()=>$localize`Your ring must land on the first empty space after a group of markers.`),u(j1,"AMBIGUOUS_CAPTURE_COORD",Zs.AMBIGUOUS_CAPTURE_COORD),u(j1,"CAPTURE_SHOULD_TAKE_RING",()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`);class kt{static of(e,t){return e===K.NONE?kt.EMPTY:t?kt.RINGS[e.value]:kt.MARKERS[e.value]}constructor(e,t){u(this,"player",void 0),u(this,"isRing",void 0),this.player=e,this.isRing=t}equals(e){return this===e}flip(){return Fe(!1===this.isRing,"cannot flip a ring (it should never happen)"),Fe(this.player.isPlayer(),"cannot flip a non-player piece"),kt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case kt.UNREACHABLE:return"NONE";case kt.EMPTY:return"EMPTY";case kt.MARKER_ZERO:return"MARKER_ZERO";case kt.MARKER_ONE:return"MARKER_ONE";case kt.RING_ZERO:return"RING_ZERO";default:return q.expectToBe(this,kt.RING_ONE),"RING_ONE"}}}ra=kt,u(kt,"encoder",we.tuple([K.encoder,we.identity()],r=>[r.player,r.isRing],r=>ra.of(r[0],r[1]))),u(kt,"UNREACHABLE",new ra(K.NONE,!1)),u(kt,"EMPTY",new ra(K.NONE,!1)),u(kt,"MARKER_ZERO",new ra(I.ZERO,!1)),u(kt,"MARKER_ONE",new ra(I.ONE,!1)),u(kt,"MARKERS",[ra.MARKER_ZERO,ra.MARKER_ONE]),u(kt,"RING_ZERO",new ra(I.ZERO,!0)),u(kt,"RING_ONE",new ra(I.ONE,!0)),u(kt,"RINGS",[ra.RING_ZERO,ra.RING_ONE]);let ia=(()=>{class r extends zL{static getInitialState(){const t=kt.EMPTY,n=kt.UNREACHABLE;return new r([[n,n,n,n,n,n,t,t,t,t,n],[n,n,n,n,t,t,t,t,t,t,t],[n,n,n,t,t,t,t,t,t,t,t],[n,n,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,n,n],[t,t,t,t,t,t,t,t,n,n,n],[t,t,t,t,t,t,t,n,n,n,n],[n,t,t,t,t,n,n,n,n,n,n]],[5,5],0)}constructor(t,n,i){super(i,t,r.SIZE,r.SIZE,[6,4,3,2,1],kt.EMPTY),u(this,"sideRings",void 0),this.sideRings=n}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(t){return this===t||this.turn===t.turn&&this.sideRings[0]===t.sideRings[0]&&this.sideRings[1]===t.sideRings[1]&&Re.compareTable(this.board,t.board)}getRingCoords(t){const n=[];return this.forEachCoord((i,o)=>{o.isRing&&o.player===t&&n.push(i)}),n}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==kt.UNREACHABLE}setAtUnsafe(t,n){const i=Re.copyBiArray(this.board);return i[t.y][t.x]=n,new r(i,this.sideRings,this.turn)}}return u(r,"SIZE",11),r})();class h_t{static getCombinations(e,t){return Fe(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(n=>this.getPermutations(n)).reduce((n,i)=>n.concat(i))}static getPermutations(e){const t=e.length,n=[e.slice()],i=new Array(t).fill(0);let o=1;for(;o<t;)if(i[o]<o){const s=o%2&&i[o],a=e[o];e[o]=e[s],e[s]=a,++i[o],o=1,n.push(e.slice())}else i[o]=0,++o;return n}static getSubsetsOfSize(e,t){return function n(i,o){if(o>=e.length||i<1)return[[]];{const s=[];for(;o<=e.length-i;){const a=e[o];for(const c of n(i-1,o+1))c.push(a),s.push(c);++o}return s}}(t,0)}}var V3e,F3e;class oa extends F2{static of(e,t,n){const i=[],o=be.factory.fromMove(e,t).get();for(let s=e;!1===s.equals(t);s=s.getNext(o))i.push(s);return i.push(t),new oa(i,n)}constructor(e,t=g.empty()){if(super(e),u(this,"ringTaken",void 0),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=t}setRingTaken(e){return new oa(this.capturedSpaces,g.of(e))}equals(e){return!(!1===super.equals(e)||!1===this.ringTaken.equals(e.ringTaken))}}V3e=oa,u(oa,"encoder",we.tuple([we.list(C.encoder),g.getEncoder(C.encoder)],r=>[r.capturedSpaces,r.ringTaken],r=>new V3e(r[0],r[1])));class Qc extends Ri{constructor(e,t,n,i){super(),u(this,"initialCaptures",void 0),u(this,"start",void 0),u(this,"end",void 0),u(this,"finalCaptures",void 0),this.initialCaptures=e,this.start=t,this.end=n,this.finalCaptures=i}isInitialPlacement(){return this.end.isAbsent()}equals(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===Re.compareArray(this.initialCaptures,e.initialCaptures)||!1===Re.compareArray(this.finalCaptures,e.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}}F3e=Qc,u(Qc,"encoder",we.tuple([we.list(oa.encoder),C.encoder,g.getEncoder(C.encoder),we.list(oa.encoder)],r=>[r.initialCaptures,r.start,r.end,r.finalCaptures],r=>new F3e(r[0],r[1],r[2],r[3])));class Ya extends Yn{static get(){return Ya.singleton.isAbsent()&&(Ya.singleton=g.of(new Ya)),Ya.singleton.get()}constructor(){super(ia)}applyLegalMove(e,t,n){return new ia(n.board,n.sideRings,n.turn+1)}applyCaptures(e,t){let n=t;return e.forEach(i=>{n=this.applyCapture(i,n)}),n}applyCapture(e,t){const n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new ia(n,t.sideRings,t.turn),e.ringTaken.get())}takeRing(e,t){const n=e.getCurrentPlayer().value,i=e.setAt(t,kt.EMPTY).board,o=[e.sideRings[0],e.sideRings[1]];return o[n]+=1,new ia(i,o,e.turn)}applyCaptureWithoutTakingRing(e,t){return t.forEach(n=>{e=e.setAt(n,kt.EMPTY)}),e.board}ringSelectionValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)===kt.RINGS[n]?b.SUCCESS:b.failure(j1.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(e,t,n){const i=n.getCurrentPlayer().value;let o=n.setAt(e,kt.MARKERS[i]);o=o.setAt(t,kt.RINGS[i]);const s=be.factory.fromMove(e,t).get();for(let a=e.getNext(s);!1===a.equals(t);a=a.getNext(s)){const c=o.getPieceAt(a);c!==kt.EMPTY&&(o=o.setAt(a,c.flip()))}return o}isLegal(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return ie.failure(j1.NO_MARKERS_IN_INITIAL_PHASE());const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=this.applyCaptures(e.initialCaptures,t),o=this.moveValidity(i,e.start,e.end.get());if(o.isFailure())return o.toOtherFallible();const s=this.applyRingMoveAndFlip(e.start,e.end.get(),i),a=this.capturesValidity(s,e.finalCaptures);if(a.isFailure())return a.toOtherFallible();const c=this.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toOtherFallible():ie.success(c)}initialPlacementValidity(e,t){if(!0!==e.isInitialPlacementPhase())return ie.failure(j1.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==kt.EMPTY)return ie.failure(Le.MUST_CLICK_ON_EMPTY_SPACE());const n=e.getCurrentPlayer(),i=[e.sideRings[0],e.sideRings[1]];i[n.value]-=1;const o=e.setAt(t,kt.of(n,!0)).board,s=new ia(o,i,e.turn);return ie.success(s)}moveStartValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==kt.RINGS[n]?b.failure(j1.SHOULD_SELECT_PLAYER_RING()):b.SUCCESS}moveValidity(e,t,n){const i=this.moveStartValidity(e,t);if(i.isFailure())return i;if(e.getPieceAt(n)!==kt.EMPTY)return b.failure(j1.SHOULD_END_MOVE_ON_EMPTY_SPACE());const o=be.factory.fromMove(t,n);if(o.isFailure())return b.failure(j1.MOVE_DIRECTION_INVALID());const s=o.get();let a=!1;for(let c=t.getNext(s);!1===c.equals(n);c=c.getNext(s)){const l=e.getPieceAt(c);if(l===kt.EMPTY){if(a)return b.failure(j1.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(l.isRing)return b.failure(j1.MOVE_SHOULD_NOT_PASS_ABOVE_RING());a=!0}}return b.SUCCESS}capturesValidity(e,t){let n=e;for(const i of t){const o=this.captureValidity(n,i);if(o.isFailure())return o;n=this.applyCapture(i,n)}return b.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer().value;for(const i of t.capturedSpaces)if(e.getPieceAt(i)!==kt.MARKERS[n])return b.failure(j1.CAN_ONLY_CAPTURE_YOUR_MARKERS());return e.getPieceAt(t.ringTaken.get())!==kt.RINGS[n]?b.failure(j1.CAPTURE_SHOULD_TAKE_RING()):b.SUCCESS}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?b.SUCCESS:b.failure(j1.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const o=this.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);o.isPresent()&&n.push(o.get())}),n}getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,n){let i=0;const o=e.getEntranceOnLine(n),s=n.getDirection();let c,a=o;for(c=o;e.isOnBoard(c);c=c.getNext(s)){const l=e.getPieceAt(c);if(l.player===t&&!1===l.isRing)0===i&&(a=c),i+=1;else{if(i>=5)break;i=0}}return i>=5?g.of({start:a,end:c,dir:s}):g.empty()}getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(i=>{for(let o=i.start;o.getDistance(i.end)>=5;o=o.getNext(i.dir))n.push(oa.of(o,o.getNext(i.dir,4)))}),n}getRingTargets(e,t){const n=[];for(const i of be.factory.all){let o=!1;for(let s=t.getNext(i);e.isOnBoard(s);s=s.getNext(i)){const a=e.getPieceAt(s);if(a===kt.EMPTY){if(n.push(s),o)break}else{if(a.isRing)break;o=!0}}}return n}getGameStatus(e){return e.gameState.isInitialPlacementPhase()?ve.ONGOING:e.gameState.sideRings[0]>=3?ve.ZERO_WON:e.gameState.sideRings[1]>=3?ve.ONE_WON:ve.ONGOING}}u(Ya,"singleton",g.empty());class p_t extends Sr{getMetrics(e){return e.gameState.sideRings}getListMoves(e){const t=[],n=e.gameState;if(n.isInitialPlacementPhase())for(const{coord:i,content:o}of n.getCoordsAndContents())o===kt.EMPTY&&t.push(new Qc([],i,g.empty(),[]));else{const i=Ya.get();this.getPossibleCaptureCombinations(n).forEach(o=>{const s=i.applyCaptures(o,n);this.getRingMoves(s).forEach(a=>{const c=i.applyRingMoveAndFlip(a.start,a.end,s);this.getPossibleCaptureCombinations(c).forEach(l=>{const f=new Qc(o,a.start,g.of(a.end),l);t.push(f)})})})}return t}getPossibleCaptureCombinations(e){const n=Ya.get().getPossibleCaptures(e),i=this.getRingCoords(e);return Rd.getPossibleCaptureCombinationsFromPossibleCaptures(n).map(o=>h_t.getCombinations(i,o.length).map(s=>o.map((a,c)=>new oa(a.capturedSpaces,g.of(s[c]))))).reduce((o,s)=>o.concat(s),[])}getRingMoves(e){const t=Ya.get(),n=[];for(const i of this.getRingCoords(e))for(const o of t.getRingTargets(e,i))n.push({start:i,end:o});return n}getRingCoords(e){const t=e.getCurrentPlayer().value,n=[];return e.forEachCoord((i,o)=>{o===kt.RINGS[t]&&n.push(i)}),n}}const D=kt.EMPTY,he=kt.UNREACHABLE,W2=kt.MARKER_ZERO,ji=kt.RING_ZERO,Jc=kt.MARKER_ONE,M2=kt.RING_ONE;let $3e=(()=>{class r{}return u(r,"MUST_ALIGN_FIVE",()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`),u(r,"MUST_CAPTURE_TWO",()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`),r})();class B3e extends Zn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new ia([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,W2,M2,D,D,D,D,D,D],[he,he,D,W2,D,M2,D,Jc,D,D,D],[he,D,ji,Jc,D,D,M2,W2,D,D,D],[he,D,D,W2,Jc,D,D,D,D,D,he],[D,D,D,W2,D,D,D,M2,D,D,he],[D,D,D,Jc,W2,ji,D,D,D,he,he],[D,D,D,D,D,D,D,D,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[3,1],20)),W.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new ia(ia.getInitialState().board,[5,5],0),new Qc([],new C(5,5),g.empty(),[]),$localize`Congratulations!`),W.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new ia([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,M2,D,D,D,D,D,D,D],[he,he,M2,D,D,M2,D,D,D,D,D],[he,D,ji,Jc,D,D,M2,D,D,D,D],[he,D,D,Jc,D,D,D,D,D,D,he],[D,D,D,D,ji,D,D,M2,D,D,he],[D,D,D,D,D,ji,D,D,D,he,he],[D,D,D,ji,D,D,D,he,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new Qc([],new C(2,4),g.of(new C(4,4)),[]),$localize`Congratulations!`),W.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new ia([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,M2,D,D,D,D,D,D,D],[he,he,M2,D,D,M2,D,D,D,D,D],[he,D,W2,W2,ji,Jc,Jc,D,D,D,D],[he,D,D,M2,D,D,D,D,D,D,he],[D,D,D,D,ji,D,D,M2,D,D,he],[D,D,D,D,D,ji,D,D,D,he,he],[D,D,D,ji,D,D,D,ji,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new Qc([],new C(4,4),g.of(new C(7,4)),[oa.of(new C(2,4),new C(6,4),g.of(new C(7,4)))]),(t,n,i)=>1===i.sideRings[I.ZERO.value]?b.SUCCESS:b.failure($3e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),W.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new ia([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,ji,D,D,M2,M2,ji,D],[he,he,he,ji,D,D,Jc,M2,D,ji,D],[he,he,D,ji,D,D,D,D,D,M2,D],[he,D,D,D,D,W2,D,D,M2,D,D],[he,D,D,D,W2,W2,D,Jc,D,D,he],[D,D,D,W2,D,W2,D,D,D,D,he],[D,D,W2,D,D,W2,D,D,D,he,he],[D,W2,D,D,D,W2,D,D,he,he,he],[D,D,D,D,D,W2,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],10),new Qc([oa.of(new C(5,4),new C(1,8),g.of(new C(3,2))),oa.of(new C(5,9),new C(5,5),g.of(new C(3,3)))],new C(4,1),g.of(new C(4,2)),[]),(t,n,i)=>2===i.sideRings[I.ZERO.value]?b.SUCCESS:b.failure($3e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)])}}var QC;function g_t(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);k("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringOuterSize)}}function m_t(r,e){if(1&r&&(A(),F(0,"circle",13)),2&r){const t=p(2),n=t.index,i=t.$implicit,o=p().index,s=p();ye("id","ring_",n,"_",o,""),y("ngClass",i.ringClasses),k("cx",i.center.x)("cy",i.center.y)("r",s.viewInfo.ringMidSize)}}function __t(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);k("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringInnerSize)}}function v_t(r,e){if(1&r&&(A(),F(0,"circle",14)),2&r){const t=p(2),n=t.index,i=t.$implicit,o=p().index,s=p();ye("id","marker_",n,"_",o,""),y("ngClass",i.markerClasses),k("cx",i.center.x)("cy",i.center.y)("r",s.viewInfo.markerSize)}}function C_t(r,e){if(1&r){const t=pe();A(),S(0,"g",6),U("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),F(1,"polygon",7),S(2,"g",8),T(3,g_t,1,3,"circle",9),T(4,m_t,1,6,"circle",10),T(5,__t,1,3,"circle",9),T(6,v_t,1,6,"circle",11),P()()}if(2&r){const t=p(),n=t.index,i=t.$implicit,o=p().index;ye("id","click_",n,"_",o,""),_(1),ye("id","space_",n,"_",o,""),y("ngClass",i.spaceClasses),k("points",i.coordinates),_(1),ye("id","pieceGroup_",n,"_",o,""),y("ngClass",i.removedClass),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isMarker)}}function y_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,C_t,7,13,"g",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",null!=t)}}function M_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,y_t,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function E_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",15),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","selected_",t.x,"_",t.y,""),k("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function S_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",17),U("click",function(){const o=te(t).$implicit;return ne(p(2).onClick(o))}),P()}if(2&r){const t=e.$implicit,n=p(2);ye("id","selectable_",t.x,"_",t.y,""),k("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function P_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,S_t,1,3,"polygon",16),P()),2&r){const t=p();_(1),y("ngForOf",t.viewInfo.selectableCoords)}}function T_t(r,e){if(1&r){const t=pe();A(),S(0,"rect",18),U("click",function(){const o=te(t).$implicit;return ne(p().onClick(o))}),P()}if(2&r){const t=e.$implicit,n=p();ye("id","indicator_",t.x,"_",t.y,""),k("x",n.viewInfo.spaceInfo[t.y][t.x].center.x-n.viewInfo.indicatorSize/2)("y",n.viewInfo.spaceInfo[t.y][t.x].center.y-n.viewInfo.indicatorSize/2)("width",n.viewInfo.indicatorSize)("height",n.viewInfo.indicatorSize)}}function O_t(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",19)(2,"circle",12)(3,"circle",20),P()),2&r){const t=e.index,n=p().$implicit,i=p();_(1),ye("id","player_",n.value,"_sideRing_",t+1,""),k("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringOuterSize),_(1),k("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringInnerSize),_(1),y("ngClass",i.viewInfo.sideRingClass[n.value]),k("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringMidSize)}}const b_t=function(){return[]};function w_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,O_t,4,12,"g",1),P()),2&r){const t=e.$implicit,n=p();k("transform","rotate("+180*(n.role.value+1)+" 532.5 780)"),_(1),y("ngForOf",_1(2,b_t).constructor(n.viewInfo.sideRings[t.value]))}}class vi extends iu{constructor(e){super(e),u(this,"constructedState",void 0),u(this,"movePhase","MOVE_START"),u(this,"moveStart",g.empty()),u(this,"moveEnd",g.empty()),u(this,"currentlyMoved",[]),u(this,"currentCapture",g.empty()),u(this,"initialCaptures",[]),u(this,"finalCaptures",[]),u(this,"possibleCaptures",[]),u(this,"viewInfo",{spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:vi.MARKER_SIZE,ringOuterSize:vi.RING_OUTER_SIZE,ringMidSize:vi.RING_MID_SIZE,ringInnerSize:vi.RING_INNER_SIZE,indicatorSize:vi.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]}),this.scores=g.of([0,0]),this.rules=Ya.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new p_t(this.rules,"YinshMinimax")],this.encoder=Qc.encoder,this.tutorial=(new B3e).tutorial,this.hexaLayout=new ou(1.5*vi.RING_OUTER_SIZE,new C(2*vi.RING_OUTER_SIZE,0),Fr.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(t=>{null==this.viewInfo.spaceInfo[t.y]&&(this.viewInfo.spaceInfo[t.y]=[]),this.viewInfo.spaceInfo[t.y][t.x]={coord:t,coordinates:this.getHexaPointsAt(t),center:this.getCenterAt(t),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(e){var t=this;return M(function*(){t.cancelMoveAttempt();const n=t.getState();t.scores=g.of(n.countScores())})()}updateViewInfo(){this.constructedState.allCoords().forEach(e=>{this.viewInfo.spaceInfo[e.y][e.x].spaceClasses=this.getSpaceClasses(e);const t=this.constructedState.getPieceAt(e);this.viewInfo.spaceInfo[e.y][e.x].removedClass="",this.setRingInfo(e,t),this.setMarkerInfo(e,t)});for(const e of I.PLAYERS)this.viewInfo.sideRings[e.value]=this.constructedState.sideRings[e.value];switch(this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const e of this.possibleCaptures)for(const t of e.capturedSpaces)this.viewInfo.selectableCoords.push(t);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const e of this.initialCaptures)this.markCurrentCapture(e);for(const e of this.finalCaptures)this.markCurrentCapture(e)}getSpaceClasses(e){return this.currentlyMoved.some(t=>t.equals(e))?["moved-fill"]:[]}setRingInfo(e,t){t.isRing?(this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=["player"+t.player.value+"-stroke"]):(this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[])}setMarkerInfo(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==kt.EMPTY&&(!1===t.isRing||this.moveStart.equalsValue(e))){const i=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[i]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=g.empty(),this.moveStart=g.empty(),this.moveEnd=g.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(e){var t=this;return M(function*(){if(e.isInitialPlacement())t.viewInfo.spaceInfo[e.start.y][e.start.x].spaceClasses=["moved-fill"];else{for(const i of t.coordsBetween(e.start,e.end.get()))t.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["moved-fill"];const n=t.currentCapture.isAbsent()&&0===t.initialCaptures.length&&t.moveStart.isAbsent();e.initialCaptures.forEach(i=>t.showLastMoveCapture(i,n)),e.finalCaptures.forEach(i=>t.showLastMoveCapture(i,n))}})()}coordsBetween(e,t){const n=[],i=be.factory.fromMove(e,t).get();for(let o=e;!1===o.equals(t);o=o.getNext(i))this.constructedState.getPieceAt(o)!==kt.EMPTY&&n.push(o),n.push(t);return n}showLastMoveCapture(e,t){for(const n of e.capturedSpaces)this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["captured-fill"],t&&this.markRemovedMarker(n,this.getState().getCurrentOpponent());this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured-fill"],t&&this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),b.SUCCESS}onClick(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());switch(t.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return t.selectCaptureFirstCoord(e);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return t.selectCaptureLastCoord(e);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return t.selectRing(e);case"MOVE_START":return t.selectMoveStart(e);case"MOVE_END":return t.selectMoveEnd(e)}})()}selectCaptureFirstCoord(e){var t=this;return M(function*(){const n=[];if(t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1)t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(n);else{if(0===n.length)return t.cancelMove(j1.MISSING_CAPTURES());t.selectCapture(n[0])}return b.SUCCESS})()}moveToCaptureSelectLast(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;for(const t of e)for(const n of t.capturedSpaces)this.viewInfo.selectableCoords.push(n);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(q.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(e){var t=this;return M(function*(){const n=[];return t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1?t.cancelMove(j1.AMBIGUOUS_CAPTURE_COORD()):0===n.length?t.cancelMove(j1.MISSING_CAPTURES()):t.selectCapture(n[0])})()}selectCapture(e){return this.currentCapture=g.of(e),this.constructedState=new ia(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(Fe("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),b.SUCCESS}markCurrentCapture(e){for(const t of e.capturedSpaces)this.viewInfo.selectedCoords.push(t),this.markRemovedMarker(t,this.getState().getCurrentPlayer());e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,kt.MARKERS[t.value])}markRemovedRing(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,kt.RINGS[t.value])}selectRing(e){var t=this;return M(function*(){const n=t.rules.ringSelectionValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.constructedState=t.rules.takeRing(t.constructedState,e);const i=t.currentCapture.get().setRingTaken(e);return"INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=g.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),b.SUCCESS)):(q.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),b.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),b.SUCCESS}tryMove(){var e=this;return M(function*(){const t=new Qc(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures);return yield e.chooseMove(t)})()}selectMoveStart(e){var t=this;return M(function*(){if(t.constructedState.isInitialPlacementPhase()){const n=t.rules.initialPlacementValidity(t.constructedState,e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveStart=g.of(e),t.tryMove())}{const n=t.rules.moveStartValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.moveStart=g.of(e),t.movePhase="MOVE_END",t.updateViewInfo()}return b.SUCCESS})()}selectMoveEnd(e){var t=this;return M(function*(){if(t.moveStart.equalsValue(e))return t.cancelMoveAttempt(),b.SUCCESS;const n=kt.RINGS[t.getState().getCurrentPlayer().value];if(t.constructedState.getPieceAt(e)===n)return t.cancelMoveAttempt(),t.selectMoveStart(e);const i=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e);return i.isFailure()?t.cancelMove(i.getReason()):(t.moveEnd=g.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var e=this;return M(function*(){return e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),b.SUCCESS)})()}}function N_t(r,e){if(1&r&&(S(0,"option",5),lt(1),P()),2&r){const t=e.$implicit;y("value",t.urlName),_(1),An(t.name)}}QC=vi,u(vi,"RING_OUTER_SIZE",40),u(vi,"RING_MID_SIZE",34),u(vi,"RING_INNER_SIZE",28),u(vi,"MARKER_SIZE",QC.RING_INNER_SIZE),u(vi,"INDICATOR_SIZE",10),u(vi,"\u0275fac",function(e){return new(e||QC)(G(Ut))}),u(vi,"\u0275cmp",je({type:QC,selectors:[["app-yinsh"]],features:[Qe],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(A(),S(0,"svg",0),T(1,M_t,2,1,"g",1),T(2,E_t,1,3,"polygon",2),T(3,P_t,2,1,"g",3),T(4,T_t,1,6,"rect",4),T(5,w_t,2,3,"g",1),P()),2&e&&(_(1),y("ngForOf",t.viewInfo.spaceInfo),_(1),y("ngForOf",t.viewInfo.selectedCoords),_(1),y("ngIf",t.isPlayerTurn()),_(1),y("ngForOf",t.viewInfo.targets),_(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Ft,Wt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));let xn=(()=>{class r{}return u(r,"ABALONE",()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`),u(r,"APAGOS",()=>$localize`Very simple game, but, will you be able to win everytime?`),u(r,"AWALE",()=>$localize`The most widespread of the Mancalas.`),u(r,"BRANDHUB",()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"COERCEO",()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`),u(r,"CONNECT_SIX",()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`),u(r,"CONSPIRATEURS",()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`),u(r,"DIAM",()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`),u(r,"DVONN",()=>$localize`Stack your pieces and control as many stacks as you can to win!`),u(r,"ENCAPSULE",()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`),u(r,"EPAMINONDAS",()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`),u(r,"GIPF",()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`),u(r,"GO",()=>$localize`The oldest strategy game still practiced widely. A territory control game.`),u(r,"HIVE",()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`),u(r,"HNEFATAFL",()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`),u(r,"KALAH",()=>$localize`A modern version of the famous African strategy game!`),u(r,"KAMISADO",()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`),u(r,"LASCA",()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`),u(r,"LINES_OF_ACTION",()=>$localize`Regroup your pieces to win. But your possible moves will often change!`),u(r,"LODESTONE",()=>$localize`Push and crush your opponent's pieces using magnetic forces!`),u(r,"MARTIAN_CHESS",()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`),u(r,"P4",()=>$localize`The classical 4 in a row game!`),u(r,"PENTAGO",()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`),u(r,"PENTE",()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`),u(r,"PYLOS",()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`),u(r,"QUARTO",()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`),u(r,"QUIXO",()=>$localize`Align 5 of your pieces on a board where pieces slide!`),u(r,"REVERSI",()=>$localize`Sandwich your opponent's pieces to dominate the board!`),u(r,"SAHARA",()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`),u(r,"SIAM",()=>$localize`Be the first to push a mountain out of the board!`),u(r,"SIX",()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`),u(r,"TABLUT",()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"TEEKO",()=>$localize`Align your 4 pieces or form a square with them to win!`),u(r,"TREXO",()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`),u(r,"YINSH",()=>$localize`Align your pieces to score points, but beware, pieces can flip!`),r})(),Nu=(()=>{var r;class e{constructor(n,i,o,s,a,c,l,f=!0){u(this,"name",void 0),u(this,"urlName",void 0),u(this,"component",void 0),u(this,"tutorial",void 0),u(this,"rules",void 0),u(this,"creationDate",void 0),u(this,"description",void 0),u(this,"display",void 0),this.name=n,this.urlName=i,this.component=o,this.tutorial=s,this.rules=a,this.creationDate=c,this.description=l,this.display=f}}return r=e,u(e,"ALL_GAMES",()=>[new r($localize`Four in a Row`,"P4",upt,new Xce,kl.get(),new Date("2018-08-28"),xn.P4()),new r($localize`Awalé`,"Awale",$7t,new Iae,Ta.get(),new Date("2018-11-29"),xn.AWALE()),new r($localize`Quarto`,"Quarto",Cgt,new h3e,Nr.get(),new Date("2018-12-09"),xn.QUARTO()),new r($localize`Tablut`,"Tablut",Hmt,new w3e,Rl.get(),new Date("2018-12-27"),xn.TABLUT()),new r($localize`Reversi`,"Reversi",kgt,new _3e,Mu.get(),new Date("2019-01-16"),xn.REVERSI()),new r($localize`Go`,"Go",GL,new Cce,a4.get(),new Date("2019-12-21"),xn.GO()),new r($localize`Encapsule`,"Encapsule",M9t,new dce,du.get(),new Date("2019-12-30"),xn.ENCAPSULE()),new r($localize`Siam`,"Siam",lR,new P3e,qa.get(),new Date("2020-01-11"),xn.SIAM()),new r($localize`Sahara`,"Sahara",qgt,new C3e,x0.get(),new Date("2020-02-29"),xn.SAHARA()),new r($localize`Pylos`,"Pylos",Bpt,new c3e,C2.get(),new Date("2020-10-02"),xn.PYLOS()),new r($localize`Kamisado`,"Kamisado",iht,new Dce,v2.get(),new Date("2020-10-03"),xn.KAMISADO()),new r($localize`Quixo`,"Quixo",Ogt,new g3e,U2.get(),new Date("2020-10-15"),xn.QUIXO()),new r($localize`Dvonn`,"Dvonn",c9t,new sce,Tr.get(),new Date("2020-10-21"),xn.DVONN()),new r($localize`Epaminondas`,"Epaminondas",w9t,new pce,Fi.get(),new Date("2021-01-16"),xn.EPAMINONDAS()),new r($localize`Gipf`,"Gipf",D9t,new vce,Qt.get(),new Date("2021-02-22"),xn.GIPF()),new r($localize`Coerceo`,"Coerceo",Aft,new ice,hC.get(),new Date("2021-03-21"),xn.COERCEO()),new r($localize`Six`,"Six",Tmt,new O3e,Za.get(),new Date("2021-04-08"),xn.SIX()),new r($localize`Lines of Action`,"LinesOfAction",Cht,new Uce,Ur.get(),new Date("2021-04-28"),xn.LINES_OF_ACTION()),new r($localize`Pentago`,"Pentago",ypt,new e3e,Uc.get(),new Date("2021-05-23"),xn.PENTAGO()),new r($localize`Abalone`,"Abalone",O7t,new bae,Hs.get(),new Date("2021-07-13"),xn.ABALONE()),new r($localize`Yinsh`,"Yinsh",vi,new B3e,Ya.get(),new Date("2021-07-31"),xn.YINSH()),new r($localize`Apagos`,"Apagos",L7t,new yae,e4.get(),new Date("2021-11-04"),xn.APAGOS()),new r($localize`Diam`,"Diam",Dc,new Jae,zc.get(),new Date("2021-11-30"),xn.DIAM()),new r($localize`Brandhub`,"Brandhub",rft,new $ae,Sl.get(),new Date("2021-12-07"),xn.BRANDHUB()),new r($localize`Conspirateurs`,"Conspirateurs",Fft,new Zae,ps.get(),new Date("2021-12-30"),xn.CONSPIRATEURS()),new r($localize`Lodestone`,"Lodestone",Al,new qce,pi.get(),new Date("2022-06-24"),xn.LODESTONE()),new r($localize`Martian Chess`,"MartianChess",Mo,new Kce,za.get(),new Date("2022-07-01"),xn.MARTIAN_CHESS()),new r($localize`Hnefatafl`,"Hnefatafl",Udt,new kce,wl.get(),new Date("2022-09-21"),xn.HNEFATAFL()),new r($localize`Hive`,"Hive",Idt,new Nce,$2.get(),new Date("2023-04-02"),xn.HIVE()),new r($localize`Trexo`,"Trexo",$n,new D3e,_i.get(),new Date("2023-04-23"),xn.TREXO()),new r($localize`Lasca`,"Lasca",hht,new Bce,Co.get(),new Date("2023-05-11"),xn.LASCA()),new r($localize`Connect Six`,"ConnectSix",fft,new Uae,hs.get(),new Date("2023-05-13"),xn.CONNECT_SIX()),new r($localize`Pente`,"Pente",wpt,new i3e,Fo.get(),new Date("2023-05-20"),xn.PENTE()),new r($localize`Teeko`,"Teeko",Gmt,new I3e,Ms.get(),new Date("2023-07-30"),xn.TEEKO()),new r($localize`Kalah`,"Kalah",Ydt,new Lce,l4.get(),new Date("2023-09-07"),xn.KALAH())].sort((t,n)=>t.name.localeCompare(n.name))),e})(),pR=(()=>{var r;class e{constructor(){u(this,"games",Nu.ALL_GAMES()),u(this,"pickGame",new N1)}onChange(n){this.pickGame.emit(n.target.value)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",je({type:r,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"select",1),U("change",function(s){return i.onChange(s)}),S(2,"option",2),se(3,3),P(),T(4,N_t,2,2,"option",4),P()()),2&n&&(_(4),y("ngForOf",i.games))},dependencies:[Wt,J7,ef],encapsulation:2})),e})();function A_t(r,e){if(1&r){const t=pe();S(0,"div",26)(1,"div",27),U("click",function(){return te(t),ne(p().closeInfo())}),P(),S(2,"div",28)(3,"header",29)(4,"p",30),lt(5),P(),S(6,"button",31),U("click",function(){return te(t),ne(p().closeInfo())}),P()(),S(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),F(11,"img",35),P()(),S(12,"div",7)(13,"div",13),lt(14),P()()(),S(15,"div",6)(16,"div",33)(17,"a",36),U("click",function(){te(t);const i=p();return ne(i.createGame(i.gameInfoDetails.get().urlName))}),F(18,"fa-icon",37),lt(19,"\xa0"),S(20,"span"),se(21,38),P()()(),S(22,"div",33)(23,"a",36),U("click",function(){te(t);const i=p();return ne(i.createLocalGame(i.gameInfoDetails.get().urlName))}),F(24,"fa-icon",37),lt(25,"\xa0"),S(26,"span"),se(27,39),P()()(),S(28,"div",33)(29,"a",36),U("click",function(){te(t);const i=p();return ne(i.createTutorial(i.gameInfoDetails.get().urlName))}),F(30,"fa-icon",37),lt(31,"\xa0"),S(32,"span"),se(33,40),P()()()()()()()}if(2&r){const t=p();_(5),An(t.gameInfoDetails.get().name),_(6),ye("src","assets/images/",t.theme,"/",t.gameInfoDetails.get().urlName,".png",ip),_(3),P2(" ",t.gameInfoDetails.get().description," "),_(4),y("icon",t.iconOnlineGame),_(6),y("icon",t.iconLocalGame),_(6),y("icon",t.iconTutorial)}}function I_t(r,e){if(1&r){const t=pe();S(0,"div",8)(1,"div",9)(2,"p",10),lt(3),P()(),S(4,"div",42)(5,"figure",34)(6,"img",43),U("click",function(){const o=te(t).$implicit;return ne(p(2).openInfo(o))}),P(),S(7,"figcaption",44),U("click",function(){const o=te(t).$implicit;return ne(p(2).openInfo(o))}),S(8,"div",45),lt(9,"?"),P()(),S(10,"figcaption",46)(11,"a",47),U("click",function(){const o=te(t).$implicit;return ne(p(2).createGame(o.urlName))}),F(12,"fa-icon",37),P(),S(13,"a",48),U("click",function(){const o=te(t).$implicit;return ne(p(2).createLocalGame(o.urlName))}),F(14,"fa-icon",37),P(),S(15,"a",49),U("click",function(){const o=te(t).$implicit;return ne(p(2).createTutorial(o.urlName))}),F(16,"fa-icon",37),P()()()(),S(17,"div",50),lt(18),P()()}if(2&r){const t=e.$implicit,n=p(2);_(3),An(t.name),_(3),Dn("id","image_",t.urlName,""),ye("src","assets/images/",n.theme,"/",t.urlName,".png",ip),_(5),Dn("id","playOnline_",t.urlName,""),_(1),y("icon",n.iconOnlineGame),_(1),Dn("id","playLocally_",t.urlName,""),_(1),y("icon",n.iconLocalGame),_(1),Dn("id","startTutorial_",t.urlName,""),_(1),y("icon",n.iconTutorial),_(2),P2(" ",t.description," ")}}function k_t(r,e){if(1&r&&(S(0,"div",7),T(1,I_t,19,11,"div",41),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let x_t=(()=>{var r;class e{constructor(n,i,o,s){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"currentGameService",void 0),u(this,"numberOfColumns",5),u(this,"games",[]),u(this,"theme",void 0),u(this,"iconOnlineGame",Vie),u(this,"iconLocalGame",pL),u(this,"iconTutorial",$se),u(this,"gameInfoDetails",g.empty()),this.router=n,this.messageDisplayer=i,this.currentGameService=o,this.theme=s.getTheme();const a=Nu.ALL_GAMES();let c=0;for(let l=0;l<a.length;l++)l<this.numberOfColumns&&this.games.push([]),this.games[c].push(a[l]),c=(c+1)%this.numberOfColumns}createGame(n){var i=this;return M(function*(){const o=i.currentGameService.canUserCreate();return o.isSuccess()?i.router.navigate(null==n?["/play"]:["/play",n]):(i.messageDisplayer.criticalMessage(o.getReason()),!1)})()}createLocalGame(n){var i=this;return M(function*(){return i.router.navigate(["/local",n])})()}createTutorial(n){return this.router.navigate(["/tutorial",n])}openInfo(n){this.gameInfoDetails=g.of(n)}closeInfo(){this.gameInfoDetails=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Gn),G(Ut),G(uo),G(_v))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,n,i,o,s,a,c,l,f,d,m,E,w,L;return t=$localize`EveryBoard`,n=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,i=$localize`Play online`,o=$localize`Create an online game`,s=$localize`See the game list`,a=$localize`Play offline`,c=$localize`Play`,l=$localize`Learn`,f=$localize`Play online`,d=$localize`Play offline`,m=$localize`Learn the rules`,E=$localize`Play online`,w=$localize`Play offline`,L=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],n,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],i,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],o,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],s,a,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],l,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],f,d,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",E,1,"button",3,"id","click"],["data-tooltip",w,1,"button",3,"id","click"],["data-tooltip",L,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(n,i){1&n&&(S(0,"section",0)(1,"div",1)(2,"p",2),se(3,3),P(),S(4,"p",4),Ao(5,5),F(6,"br"),Io(),P()(),S(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),se(12,11),P()(),S(13,"div",12)(14,"div",13)(15,"button",14),U("click",function(){return i.createGame()}),se(16,15),P(),S(17,"button",16),se(18,17),P()()()()(),S(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),se(23,18),P()(),S(24,"div",12)(25,"div",19)(26,"button",20),se(27,21),P(),S(28,"button",22),se(29,23),P()()()()()(),T(30,A_t,34,7,"div",24),S(31,"div",6),T(32,k_t,2,1,"div",25),P()()),2&n&&(_(30),y("ngIf",i.gameInfoDetails.isPresent()),_(2),y("ngForOf",i.games))},dependencies:[Wt,Nt,yc,S0],encapsulation:2})),e})();const L_t=["board"];let R0=(()=>{class r{static NO_MATCHING_GAME(t){return $localize`This game (${t}) does not exist.`}}return u(r,"NOT_YOUR_TURN",()=>$localize`It is not your turn!`),u(r,"GAME_HAS_ENDED",()=>$localize`This game has ended.`),u(r,"CANNOT_PLAY_AS_OBSERVER",()=>$localize`You are an observer in this game, you cannot play.`),u(r,"MUST_ANSWER_REQUEST",()=>$localize`You must answer your opponent's request.`),r})(),JC=(()=>{var r;class e{constructor(n,i,o,s){u(this,"actRoute",void 0),u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"boardRef",null),u(this,"gameComponent",void 0),u(this,"players",[g.empty(),g.empty()]),u(this,"role",K.NONE),u(this,"endGame",!1),u(this,"Player",I),this.actRoute=n,this.connectedUserService=i,this.router=o,this.messageDisplayer=s}getMatchingComponent(n){return g.ofNullable(Nu.ALL_GAMES().find(o=>o.urlName===n)).map(o=>o.component)}afterViewInit(){var n=this;return M(function*(){const i=yield n.createGameComponent();return i&&(n.gameComponent.node=n.gameComponent.rules.getInitialNode(),yield n.gameComponent.updateBoard(!1)),i})()}getGameName(){return q.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var n=this;return M(function*(){const i=n.getGameName(),o=n.getMatchingComponent(i);if(o.isAbsent())return yield n.router.navigate(["/notFound",R0.NO_MATCHING_GAME(i)],{skipLocationChange:!0}),!1;Fe(null!=n.boardRef,"Board element should be present");const s=q.getNonNullable(n.boardRef).createComponent(o.get());return n.gameComponent=s.instance,n.gameComponent.chooseMove=a=>n.receiveValidMove(a),n.gameComponent.canUserPlay=a=>n.canUserPlay(a),n.gameComponent.isPlayerTurn=()=>n.isPlayerTurn(),n.gameComponent.cancelMoveOnWrapper=a=>n.onCancelMove(a),yield n.setRole(n.role),!0})()}setRole(n){var i=this;return M(function*(){i.role=n,i.gameComponent.role=i.role,i.gameComponent.hasAsymmetricBoard&&(i.gameComponent.rotation="rotate("+180*i.role.value+")"),yield i.updateBoardAndShowLastMove(!1)})()}receiveValidMove(n){var i=this;return M(function*(){const o=i.gameComponent.rules.isLegal(n,i.gameComponent.getState());return o.isFailure()?(yield i.gameComponent.cancelMove(o.getReason()),b.ofFallible(o)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(n),b.SUCCESS)})()}canUserPlay(n){var i=this;return M(function*(){if(i.role===K.NONE){const o=R0.CANNOT_PLAY_AS_OBSERVER();return b.failure(o)}return!1===i.isPlayerTurn()?b.failure(R0.NOT_YOUR_TURN()):i.endGame?b.failure(R0.GAME_HAS_ENDED()):b.SUCCESS})()}isPlayerTurn(){if(this.role===K.NONE||null==this.gameComponent)return!1;const i=this.gameComponent.getTurn()%2,o=this.getPlayer();return!this.players[i].isPresent()||this.players[i].equalsValue(o)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}updateBoardAndShowLastMove(n){var i=this;return M(function*(){if(i.gameComponent.cancelMoveAttempt(),i.gameComponent.hideLastMove(),yield i.gameComponent.updateBoard(n),i.gameComponent.node.move.isPresent()){const o=i.gameComponent.node.move.get();yield i.gameComponent.showLastMove(o)}})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(xo),G(ar),G(Gn),G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["ng-component"]],viewQuery:function(n,i){if(1&n&&N4(L_t,5,ts),2&n){let o;v3(o=C3())&&(i.boardRef=o.first)}},decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();const R_t=["board"];let z_t=(()=>{var r;class e extends JC{constructor(n,i,o,s,a){super(n,i,o,s),u(this,"cdr",void 0),u(this,"demoNodeInfo",void 0),u(this,"boardRef",null),this.cdr=a}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var n=this;return M(function*(){window.setTimeout(M(function*(){yield n.afterViewInit(),n.gameComponent.node=n.demoNodeInfo.node,yield n.setRole(n.gameComponent.getCurrentPlayer()),n.cdr.detectChanges(),n.demoNodeInfo.click.isPresent()&&(q.getNonNullable(document.querySelector(n.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),n.cdr.detectChanges())}),1)})()}onLegalUserMove(n,i){return M(function*(){})()}getPlayer(){return"no-player"}onCancelMove(n){return M(function*(){})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(xo),G(ar),G(Gn),G(Ut),G(y3))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-demo-card"]],viewQuery:function(n,i){if(1&n&&N4(R_t,5,ts),2&n){let o;v3(o=C3())&&(i.boardRef=o.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[Qe],decls:2,vars:0,consts:[["board",""]],template:function(n,i){1&n&&F(0,"div",null,0)},encapsulation:2})),e})();function D_t(r,e){if(1&r&&(S(0,"div",17)(1,"figure",18),F(2,"app-demo-card",19),P()()),2&r){const t=p().$implicit;_(2),y("demoNodeInfo",t)}}function H_t(r,e){if(1&r&&(S(0,"div",20)(1,"figure",21),F(2,"app-demo-card",19),P()()),2&r){const t=p().$implicit;_(2),y("demoNodeInfo",t)}}function V_t(r,e){if(1&r&&(S(0,"div",12)(1,"div",13)(2,"p",14),lt(3),P()(),T(4,D_t,3,1,"div",15),T(5,H_t,3,1,"ng-template",null,16,dn),P()),2&r){const t=e.$implicit,n=ln(6),i=p(2);_(3),An(t.name),_(1),y("ngIf",i.squared.value)("ngIfElse",n)}}function F_t(r,e){if(1&r&&(S(0,"div",10),T(1,V_t,7,3,"div",11),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let $_t=(()=>{var r;class e{constructor(){u(this,"numberOfColumns",new rs(5)),u(this,"squared",new rs(!0)),u(this,"columns",[]),this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(n=>{this.fillColumns(n)})}fillColumns(n){const i=Nu.ALL_GAMES();let o=0,s=0;this.columns=[];for(const a of i){const c=[],l=a.rules,f=a.tutorial.tutorial;for(const d of f){const m=this.getNodeFromStep(d,l);c.push(m)}for(const d of c)s<n&&this.columns.push([]),this.columns[o].push({name:a.urlName,node:d.node,click:d.click}),s++,o=(o+1)%n}}getNodeFromStep(n,i){if(n.hasSolution()){const o=n.getSolution();if("string"==typeof o)return{node:new Di(n.state),click:g.of(o)};{const s=o;return{node:new Di(i.applyLegalMove(s,n.state,i.isLegal(s,n.state).get()),g.of(new Di(n.state)),g.of(s)),click:g.empty()}}}return{node:new Di(n.state),click:g.empty()}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",je({type:r,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,n;return t=$localize`Number of columns: `,n=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],n,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(n,i){1&n&&(S(0,"form")(1,"div",0)(2,"label",1),Bt(3),se(4,2),Gt(),S(5,"output"),lt(6),P()(),S(7,"div",3),F(8,"input",4),P()(),S(9,"div",0)(10,"label",5),F(11,"input",6),lt(12," \xa0"),Bt(13),se(14,7),Gt(),P()()(),S(15,"div",8),T(16,F_t,2,1,"div",9),P()),2&n&&(_(6),An(i.numberOfColumns.value),_(2),y("formControl",i.numberOfColumns),_(3),y("formControl",i.squared),_(5),y("ngForOf",i.columns))},dependencies:[Wt,Nt,m6,mc,gg,NS,P3,p6,BS,X7,z_t],encapsulation:2})),e})(),gR=(()=>{var r;class e{constructor(n){u(this,"element",void 0),this.element=n}ngAfterViewInit(){this.element.nativeElement.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Pi))}),u(e,"\u0275dir",Rt({type:r,selectors:[["","autofocus",""]]})),e})(),G3e=(()=>{var r;class e{constructor(n){u(this,"shown",!1),u(this,"input",void 0),this.input=n.nativeElement.parentNode.previousSibling,n.nativeElement.addEventListener("click",i=>{this.toggle()})}toggle(){this.shown=!1===this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Pi))}),u(e,"\u0275dir",Rt({type:r,selectors:[["","toggleVisibility",""]]})),e})();function B_t(r,e){if(1&r&&(S(0,"div",29)(1,"div",30),se(2,31),P(),S(3,"div",32),lt(4),P()()),2&r){const t=p();_(4),An(t.errorMessage)}}const G_t=function(){return["/register"]},U_t=function(){return["/reset-password"]};let W_t=(()=>{var r;class e{constructor(n,i){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"faEye",Ux),u(this,"errorMessage",void 0),u(this,"loginForm",new z4({email:new rs,password:new rs})),u(this,"userSubscription",void 0),this.router=n,this.connectedUserService=i}ngOnInit(){var n=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var i=M(function*(o){o!==g0.NOT_CONNECTED&&(yield n.redirect())});return function(o){return i.apply(this,arguments)}}())}loginWithEmail(n){var i=this;return M(function*(){const o=yield i.connectedUserService.doEmailLogin(n.email,n.password);o.isFailure()&&(i.errorMessage=o.getReason())})()}loginWithGoogle(){var n=this;return M(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isFailure()&&(n.errorMessage=i.getReason())})()}redirect(){var n=this;return M(function*(){return n.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Gn),G(ar))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,n,i,o,s,a,c,l,f,d,m,E;return t=$localize`Log in`,n=$localize`Email`,i=$localize`Email`,o=$localize`Password`,s=$localize`Password`,a=$localize`Log in`,c=$localize`Log in with Google`,l=$localize`No account?`,f=$localize`Register`,d=$localize`Forgot your password?`,m=$localize`Reset your password`,E=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",i,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],o,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",s,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],a,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],l,[3,"routerLink"],f,d,m,["role","alert",1,"message","is-danger"],[1,"message-header"],E,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),se(2,2),P(),S(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),se(7,7),P()(),S(8,"div",8)(9,"div",9)(10,"div",10),F(11,"input",11),P()()()(),S(12,"div",4)(13,"div",5)(14,"label",12),se(15,13),P()(),S(16,"div",8)(17,"div",9)(18,"div",14),F(19,"input",15),S(20,"span",16),F(21,"fa-icon",17),P()()()()(),S(22,"div",4),F(23,"div",5),S(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),U("click",function(){return i.loginWithEmail(i.loginForm.value)}),se(28,19),P()()()()(),S(29,"div",4),F(30,"div",5),S(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),U("click",function(){return i.loginWithGoogle()}),se(35,21),P()()()()(),T(36,B_t,5,1,"div",22),S(37,"p",23),Bt(38),se(39,24),Gt(),lt(40,"\xa0 "),S(41,"a",25),se(42,26),P()(),S(43,"p",23),Bt(44),se(45,27),Gt(),lt(46,"\xa0 "),S(47,"a",25),se(48,28),P()()()()),2&n&&(_(3),y("formGroup",i.loginForm),_(18),y("icon",i.faEye),_(6),y("disabled",!i.canLogin()),_(9),y("ngIf",i.errorMessage),_(5),y("routerLink",_1(6,G_t)),_(6),y("routerLink",_1(7,U_t)))},dependencies:[Nt,yc,m6,mc,P3,p6,C6,_6,D8,S0,gR,G3e],encapsulation:2})),e})(),q_t=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}subscribeToActiveParts(n){let i=[];const c=new mv(l=>{i=i.concat(...l),n(i)},l=>{const f=i;for(const d of l)f.forEach(m=>{m.id===d.id&&(m.data=d.data)});i=f,n(i)},l=>{const f=[];for(const d of i)l.every(m=>m.id!==d.id)&&f.push(d);i=f,n(i)});return this.partDAO.observingWhere([["result","==",k1.UNACHIEVED.value]],c)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(od))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),j_t=(()=>{var r;class e{transform(n){return TB(1e3*n.seconds,"HH:mm:ss","en-US")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",Mi({name:"firestoreTime",type:r,pure:!0})),e})();var Au;const Y_t=["chatDiv"];function K_t(r,e){1&r&&(Bt(0),se(1,5),Gt())}function X_t(r,e){1&r&&se(0,6),2&r&&(Bn(p().unreadMessagesText),jn(0))}function Q_t(r,e){if(1&r){const t=pe();S(0,"button",11),U("click",function(){return te(t),ne(p(2).scrollToBottom())}),lt(1),P()}if(2&r){const t=p(2);_(1),P2("",t.unreadMessagesText," \u2193")}}function J_t(r,e){if(1&r&&(S(0,"p"),lt(1),ga(2,"firestoreTime"),S(3,"b",12),lt(4),P(),S(5,"span",13),lt(6),P()()),2&r){const t=e.$implicit;_(1),P2(" [",hc(2,3,t.postedTime),"] "),_(3),P2("",t.sender.name," : "),_(2),An(t.content)}}function evt(r,e){if(1&r){const t=pe();S(0,"div"),T(1,Q_t,2,1,"button",7),S(2,"div",8,9),U("scroll",function(){return te(t),ne(p().updateCurrentScrollPosition())}),T(4,J_t,7,5,"p",10),P()()}if(2&r){const t=p();_(1),y("ngIf",t.showUnreadMessagesButton),_(3),y("ngForOf",t.chat)}}const tvt=function(){return{standalone:!0}};function nvt(r,e){if(1&r){const t=pe();S(0,"form",14),U("onSubmit",function(){return te(t),ne(p().sendMessage())}),S(1,"div",15)(2,"div",16)(3,"input",17,18),U("ngModelChange",function(i){return te(t),ne(p().userMessage=i)}),P(),S(5,"p",19),lt(6),P()(),S(7,"div",20)(8,"button",21),U("click",function(){return te(t),ne(p().sendMessage())}),F(9,"fa-icon",22),P()()(),S(10,"div",23)(11,"p")(12,"strong"),se(13,24),P()()()()}if(2&r){const t=ln(4),n=p();_(3),y("ngModel",n.userMessage)("ngModelOptions",_1(4,tvt)),_(3),P2("",t.value.length,"/128"),_(3),y("icon",n.faReply)}}let ey=(Au=class{constructor(e,t){u(this,"chatService",void 0),u(this,"connectedUserService",void 0),u(this,"chatId",void 0),u(this,"turn",void 0),u(this,"userMessage",""),u(this,"connected",!1),u(this,"chat",[]),u(this,"readMessages",0),u(this,"unreadMessagesText",""),u(this,"showUnreadMessagesButton",!1),u(this,"visible",!0),u(this,"faReply",Nx),u(this,"isNearBottom",!0),u(this,"notYetScrolled",!0),u(this,"chatSubscription",void 0),u(this,"chatDiv",void 0),this.chatService=e,this.connectedUserService=t}ngOnInit(){Fe(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=n=>{this.updateMessages(n.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},t=new mv(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,t)}updateMessages(e){this.chat=this.chat.concat(e);const t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return M(function*(){const t=e.userMessage;e.userMessage="";const n=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,n,t,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}},u(Au,"\u0275fac",function(e){return new(e||Au)(G(W5),G(ar))}),u(Au,"\u0275cmp",je({type:Au,selectors:[["app-chat"]],viewQuery:function(e,t){if(1&e&&N4(Y_t,5),2&e){let n;v3(n=C3())&&(t.chatDiv=n.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let r,e,t,n;return r=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,t=$localize`Type your message here`,n=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],r,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",t,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],n]},template:function(e,t){if(1&e&&(S(0,"div")(1,"button",0),U("click",function(){return t.switchChatVisibility()}),T(2,K_t,2,0,"ng-container",1),T(3,X_t,1,1,"ng-template",null,2,dn),P(),T(5,evt,5,2,"div",3),T(6,nvt,14,5,"form",4),P()),2&e){const n=ln(4);_(2),y("ngIf",t.visible)("ngIfElse",n),_(3),y("ngIf",t.visible),_(1),y("ngIf",t.visible)}},dependencies:[Wt,Nt,m6,mc,P3,p6,qS,Q7,X7,S0,j_t],encapsulation:2})),Au);ey=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],ey);let U3e=(()=>{var r;class e{constructor(n,i,o){u(this,"router",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"selectedGame",void 0),this.router=n,this.currentGameService=i,this.messageDisplayer=o}pickGame(n){this.selectedGame=n}navigateToOnlineGameCreation(){var n=this;return M(function*(){const i=n.currentGameService.canUserCreate();i.isSuccess()?yield n.router.navigate(["/play",n.selectedGame]):n.messageDisplayer.criticalMessage(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Gn),G(uo),G(Ut))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),U("pickGame",function(s){return i.pickGame(s)}),P(),S(1,"button",1),U("click",function(){return i.navigateToOnlineGameCreation()}),se(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[pR],encapsulation:2})),e})();var Iu;function ivt(r,e){if(1&r&&(Bt(0),lt(1),Gt()),2&r){const t=p().$implicit;_(1),An(t.data.playerOne.name)}}function ovt(r,e){1&r&&(Bt(0),se(1,27),Gt())}function svt(r,e){if(1&r){const t=pe();S(0,"tr",22),U("click",function(){const o=te(t).$implicit;return ne(p(2).joinGame(o))}),S(1,"td",23),lt(2),P(),S(3,"td",23),lt(4),P(),S(5,"td",23),T(6,ivt,2,1,"ng-container",24),T(7,ovt,2,0,"ng-template",null,25,dn),P(),S(9,"td",26),lt(10),P()()}if(2&r){const t=e.$implicit,n=e.index,i=ln(8);Dn("id","part_",n,""),_(2),An(t.data.typeGame),_(2),An(t.data.playerZero.name),_(2),y("ngIf",t.data.playerOne)("ngIfElse",i),_(4),An(t.data.turn+1)}}function avt(r,e){if(1&r&&(S(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),se(6,17),P(),S(7,"th",16),se(8,18),P(),S(9,"th",16),se(10,19),P(),S(11,"th",16),se(12,20),P()()(),S(13,"tbody"),T(14,svt,11,6,"tr",21),P()()()()),2&r){const t=p();_(14),y("ngForOf",t.activeParts)}}function cvt(r,e){1&r&&(S(0,"div",28),F(1,"app-online-game-selection",29),P())}function lvt(r,e){1&r&&(S(0,"div",30)(1,"div",31)(2,"div",32),F(3,"app-chat",33),P()()()),2&r&&(_(3),y("turn",-1))}let mR=(Iu=class{constructor(e,t,n,i){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"activePartsService",void 0),u(this,"currentGameService",void 0),u(this,"activeParts",[]),u(this,"activePartsSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"currentTab","games"),u(this,"createTabClasses",[]),this.router=e,this.messageDisplayer=t,this.activePartsService=n,this.currentGameService=i}ngOnInit(){this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){this.activePartsSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}joinGame(e){var t=this;return M(function*(){const n=e.id,i=e.data.typeGame,s=t.currentGameService.canUserJoin(n,null!=e.data.beginning);s.isSuccess()?yield t.router.navigate(["/play",i,n]):t.messageDisplayer.criticalMessage(s.getReason())})()}selectTab(e){if("create"===e){const t=this.currentGameService.canUserCreate();t.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(t.getReason())}else this.currentTab=e}},u(Iu,"\u0275fac",function(e){return new(e||Iu)(G(Gn),G(Ut),G(q_t),G(uo))}),u(Iu,"\u0275cmp",je({type:Iu,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let r,e,t,n,i,o,s,a;return r=$localize`Games`,e=$localize`Create`,t=$localize`Chat`,n=$localize`Game`,i=$localize`First player`,o=$localize`Second player`,s=$localize`Turn`,a=$localize`Waiting for opponent`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],r,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],t,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],n,i,o,s,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],[1,"td","turn"],a,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],[1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),U("click",function(){return t.selectTab("games")}),se(4,3),P()(),S(5,"li",4)(6,"a",5),U("click",function(){return t.selectTab("create")}),se(7,6),P()(),S(8,"li",7)(9,"a",8),U("click",function(){return t.selectTab("chat")}),se(10,9),P()()()(),T(11,avt,15,1,"div",10),T(12,cvt,2,0,"div",11),T(13,lvt,4,1,"div",12)),2&e&&(_(6),y("ngClass",t.createTabClasses),_(5),y("ngIf","games"===t.currentTab),_(1),y("ngIf","create"===t.currentTab),_(1),y("ngIf","chat"===t.currentTab))},dependencies:[Ft,Wt,Nt,ey,U3e],encapsulation:2})),Iu);mR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],mR);let uvt=(()=>{var r;class e{constructor(){}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",je({type:r,selectors:[["app-account"]],decls:11,vars:0,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`If you forgot your password or want to change it, click on the following button:`,i=$localize`Reset password`,[[1,"hero-body"],[1,"title"],t,[1,"box"],[1,"block","level-left"],[1,"level-item"],n,["id","reset","routerLink","/reset-password",1,"button","is-primary","level-item","is-small"],i]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),se(2,2),P()(),S(3,"div",3)(4,"p",1),lt(5,"Resetting password"),P(),S(6,"div",4)(7,"p",5),se(8,6),P(),S(9,"button",7),se(10,8),P()()())},dependencies:[yc],encapsulation:2})),e})(),W3e=(()=>{var r;class e{constructor(n){u(this,"route",void 0),u(this,"message",void 0),this.route=n,this.message=n.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(xo))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1),se(2,2),P(),S(3,"div",3),lt(4),P()()),2&n&&(_(4),An(i.message))},encapsulation:2})),e})();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const hvt=new Error("request for lock canceled");class gvt{constructor(e,t=hvt){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t,n)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:n}),this._dispatch()})}runExclusive(e,t=1){return function(r,e,t,n){return new(t||(t=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(d){s(d)}}function c(f){try{l(n.throw(f))}catch(d){s(d)}}function l(f){f.done?o(f.value):function i(o){return o instanceof t?o:new t(function(s){s(o)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[n,i]=yield this.acquire(t);try{return yield e(n)}finally{i()}})}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach(e=>e.forEach(t=>t.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const n=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!n)continue;const i=this._value,o=t;this._value-=t,t=this._value+1,n.resolve([i,this._newReleaser(o)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach(t=>t()),this._weightedWaiters[e-1]=[])}}class _vt{constructor(e){this._semaphore=new gvt(1,e)}acquire(){return function(r,e,t,n){return new(t||(t=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(d){s(d)}}function c(f){try{l(n.throw(f))}catch(d){s(d)}}function l(f){f.done?o(f.value):function i(o){return o instanceof t?o:new t(function(s){s(o)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[,e]=yield this._semaphore.acquire();return e})}runExclusive(e){return this._semaphore.runExclusive(()=>e())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}let j3e=(()=>{var r;class e{constructor(){u(this,"requestAwaitingReply",g.empty()),u(this,"lastDeniedRequest",g.empty()),u(this,"forbiddenRequests",new dt)}onGameStart(){this.requestAwaitingReply=g.empty(),this.lastDeniedRequest=g.empty(),this.forbiddenRequests=new dt}onReceivedMove(){this.forbiddenRequests=new dt,this.lastDeniedRequest=g.empty()}onReceivedRequest(n){q.assert(this.requestAwaitingReply.isAbsent(),"Should not receive two requests in a row!"),this.requestAwaitingReply=g.of(n)}onReceivedReply(n,i){var o=this;return M(function*(){switch(o.requestAwaitingReply=g.empty(),n.reply){case"Accept":return!0;case"Reject":return n.player===i.getOpponent().value&&(o.lastDeniedRequest=g.of(n.requestType),o.forbiddenRequests.add(n.requestType)),!1}})()}canMakeRequest(n){return!(this.requestAwaitingReply.isPresent()||this.forbiddenRequests.contains(n))}getRequestAwaitingReplyFrom(n){return this.requestAwaitingReply.isPresent()&&this.requestAwaitingReply.get().player===n.getOpponent().value?g.of(this.requestAwaitingReply.get().requestType):g.empty()}getCurrentRequest(){return this.requestAwaitingReply}deniedRequest(){return this.lastDeniedRequest}}return r=e,u(e,"requestInfos",{TakeBack:{requestType:"TakeBack",textForRequest:()=>$localize`Ask to take back one move`,textForReply:()=>$localize`Your opponent is asking for a take back.`,name:()=>$localize`take back`,icon:Qx},Draw:{requestType:"Draw",textForRequest:()=>$localize`Propose a draw`,textForReply:()=>$localize`Your opponent is proposing a draw.`,name:()=>$localize`draw`,icon:Bne},Rematch:{requestType:"Rematch",textForRequest:()=>$localize`Propose a rematch`,textForReply:()=>$localize`Your opponent is proposing a rematch.`,name:()=>$localize`rematch`,icon:S1e}}),u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Cvt=(()=>{var r;class e{constructor(){u(this,"turnClocks",void 0),u(this,"globalClocks",void 0),u(this,"allClocks",void 0),u(this,"configRoom",g.empty()),u(this,"takenGlobalTime",[0,0]),u(this,"extraGlobalTime",[0,0]),u(this,"availableTurnTime",[0,0]),u(this,"lastMoveStartTimestamp",g.empty())}setClocks(n,i){this.turnClocks=n,this.globalClocks=i,this.allClocks=n.concat(i)}onGameStart(n){this.configRoom=g.of(n);for(const i of I.PLAYERS)this.takenGlobalTime[i.value]=0,this.extraGlobalTime[i.value]=0,this.availableTurnTime[i.value]=this.getMoveDurationInMs(),this.globalClocks[i.value].setDuration(this.getPartDurationInMs()),this.turnClocks[i.value].setDuration(this.getMoveDurationInMs());for(const i of this.allClocks)i.start(),i.pause()}getPartDurationInMs(){return 1e3*this.configRoom.get().totalPartDuration}getMoveDurationInMs(){return 1e3*this.configRoom.get().maximalMoveDuration}onReceivedAction(n){switch(n.action){case"AddTurnTime":this.addTurnTime(I.of(n.player));break;case"AddGlobalTime":this.addGlobalTime(I.of(n.player));break;case"StartGame":this.lastMoveStartTimestamp=g.of(n.time);break;case"EndGame":this.onGameEnd()}}onReceivedMove(n){const i=I.of(n.player),o=n.time,s=this.getMillisecondsElapsedSinceLastMoveStart(o);this.lastMoveStartTimestamp=g.of(o),this.takenGlobalTime[i.value]+=s,this.availableTurnTime[i.value]-=s;const a=i.getOpponent();this.availableTurnTime[a.value]=this.getMoveDurationInMs();const c=this.getPartDurationInMs()-this.takenGlobalTime[a.value];this.globalClocks[a.value].changeDuration(c)}getMillisecondsElapsedSinceLastMoveStart(n){return xae(this.lastMoveStartTimestamp.get(),n)}onGameEnd(){for(const n of this.allClocks)n.isStarted()&&n.stop();this.updateClocks()}beforeEventsBatch(n){!1===n&&this.pauseAllClocks()}afterEventsBatch(n,i,o){if(this.updateClocks(),!1===n){const s=this.getMillisecondsElapsedSinceLastMoveStart(o);this.turnClocks[i.value].subtract(s),this.globalClocks[i.value].subtract(s),this.resumeClocks(i)}}resumeClocks(n){this.turnClocks[n.value].resume(),this.globalClocks[n.value].resume()}addTurnTime(n){this.availableTurnTime[n.getOpponent().value]+=3e4}addGlobalTime(n){this.extraGlobalTime[n.getOpponent().value]+=3e5}updateClocks(){for(const n of I.PLAYERS){this.turnClocks[n.value].changeDuration(this.availableTurnTime[n.value]);const i=this.getPartDurationInMs()+this.extraGlobalTime[n.value]-this.takenGlobalTime[n.value];this.globalClocks[n.value].changeDuration(i)}}pauseAllClocks(){for(const n of this.allClocks)!1===n.isIdle()&&n.pause()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function Xd(r){return jr((e,t)=>{jo(r).subscribe(pr(t,()=>t.complete(),Eo)),!t.closed&&e.subscribe(t)})}let yvt=(()=>{var r;class e{transform(n){const i=n%60,o=(n-i)%3600/60,s=(n-60*o-i)/3600,a=[];if(s>1?a.push($localize`${s} hours`):1===s&&a.push($localize`1 hour`),o>1?a.push($localize`${o} minutes`):1===o&&a.push($localize`1 minute`),i>1?a.push($localize`${i} seconds`):1===i&&a.push($localize`1 second`),0===a.length)return $localize`0 seconds`;if(1===a.length)return a[0];{const c=a.slice(0,-1).join(", "),l=a.slice(-1)[0];return $localize`${c} and ${l}`}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",Mi({name:"humanDuration",type:r,pure:!0})),e})();var C4,Qd;function Evt(r,e){if(1&r&&(Bt(0),lt(1),Gt()),2&r){const t=p(3);_(1),An(t.viewInfo.chosenOpponent)}}function Svt(r,e){1&r&&se(0,44)}function Pvt(r,e){if(1&r&&(S(0,"div",45)(1,"div",8)(2,"label",46),Bt(3),se(4,47),Gt(),S(5,"output"),lt(6),ga(7,"humanDuration"),P()(),S(8,"div",37),F(9,"input",48),P()(),S(10,"div",8)(11,"label",49),Ao(12,50),F(13,"output"),ga(14,"humanDuration"),Io(),P(),S(15,"div",37),F(16,"input",51),P()()()),2&r){const t=p(3);_(6),An(hc(7,2,t.viewInfo.maximalMoveDuration||0)),_(8),Bn(hc(14,4,t.viewInfo.totalPartDuration||0)),jn(12)}}function Tvt(r,e){1&r&&(S(0,"div"),Ao(1,52),F(2,"br"),Io(),P())}function Ovt(r,e){1&r&&(S(0,"button",64),se(1,65),P())}function bvt(r,e){if(1&r){const t=pe();S(0,"tr",60),U("click",function(){const o=te(t).$implicit;return ne(p(4).selectOpponent(o))}),S(1,"td",61),lt(2),P(),S(3,"td",62),T(4,Ovt,2,0,"button",63),P()()}if(2&r){const t=e.$implicit,n=p(4);Dn("id","presenceOf_",t,""),y("ngClass",n.viewInfo.candidateClasses[t]),_(1),y("id",n.viewInfo.chosenOpponent===t?"selected_"+t:"candidate_"+t),_(1),An(t),_(2),y("ngIf",n.viewInfo.chosenOpponent!==t)}}function wvt(r,e){if(1&r&&(Bt(0),se(1,53),Gt(),S(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),se(7,57),P(),S(8,"th",56),se(9,58),P()()(),S(10,"tbody"),T(11,bvt,5,5,"tr",59),P()()()),2&r){const t=p(3);_(11),y("ngForOf",t.viewInfo.candidates)}}function Nvt(r,e){if(1&r){const t=pe();S(0,"button",66),U("click",function(){return te(t),ne(p(3).changeConfig())}),se(1,67),P()}}function Avt(r,e){if(1&r){const t=pe();S(0,"div")(1,"h1",4),se(2,5),P(),S(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),se(7,10),P(),S(8,"div",11)(9,"button",12),U("click",function(){return te(t),ne(p(2).selectFirstPlayer("RANDOM"))}),se(10,13),P(),S(11,"button",14),U("click",function(){return te(t),ne(p(2).selectFirstPlayer("CREATOR"))}),se(12,15),P(),S(13,"button",16),U("click",function(){return te(t),ne(p(2).selectFirstPlayer("CHOSEN_PLAYER"))}),T(14,Evt,2,1,"ng-container",17),T(15,Svt,1,0,"ng-template",null,18,dn),P()()(),S(17,"div",8)(18,"label",9),se(19,19),P(),S(20,"div",11)(21,"div",20),U("click",function(){return te(t),ne(p(2).selectPartType("STANDARD"))}),S(22,"div",21)(23,"span"),se(24,22),P()(),S(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),Bt(29),se(30,26),Gt(),S(31,"strong"),lt(32),ga(33,"humanDuration"),P(),F(34,"br"),Bt(35),Ao(36,27),F(37,"strong"),ga(38,"humanDuration"),Io(),Gt(),P()()()()(),S(39,"div",28),U("click",function(){return te(t),ne(p(2).selectPartType("BLITZ"))}),S(40,"div",21)(41,"span"),se(42,29),P()(),S(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),Bt(47),se(48,30),Gt(),S(49,"strong"),lt(50),ga(51,"humanDuration"),P(),F(52,"br"),Bt(53),Ao(54,31),F(55,"strong"),ga(56,"humanDuration"),Io(),Gt(),P()()()()(),S(57,"button",32),U("click",function(){return te(t),ne(p(2).selectPartType("CUSTOM"))}),se(58,33),P()()(),T(59,Pvt,17,6,"div",34),S(60,"div",8)(61,"label",35),se(62,36),P(),S(63,"div",37),T(64,Tvt,3,0,"div",17),T(65,wvt,12,1,"ng-template",null,38,dn),P()()(),S(67,"div",8)(68,"div",11)(69,"button",39),U("click",function(){return te(t),ne(p(2).proposeConfig())}),se(70,40),P(),T(71,Nvt,2,0,"button",41),S(72,"button",42),U("click",function(){return te(t),ne(p(2).cancelGameCreation())}),se(73,43),P()()()()()}if(2&r){const t=ln(16),n=ln(66),i=p(2);_(3),y("formGroup",i.configFormGroup),_(1),y("disabled",!i.viewInfo.canEditConfig),_(5),y("ngClass",i.viewInfo.firstPlayerClasses.RANDOM),_(2),y("ngClass",i.viewInfo.firstPlayerClasses.CREATOR),_(2),y("ngClass",i.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),_(1),y("ngIf",i.viewInfo.chosenOpponent)("ngIfElse",t),_(7),y("ngClass",i.viewInfo.partTypeClasses.STANDARD),_(11),An(hc(33,19,i.partType.NORMAL_MOVE_DURATION)),_(6),Bn(hc(38,21,i.partType.NORMAL_PART_DURATION)),jn(36),_(1),y("ngClass",i.viewInfo.partTypeClasses.BLITZ),_(11),An(hc(51,23,i.partType.BLITZ_MOVE_DURATION)),_(6),Bn(hc(56,25,i.partType.BLITZ_PART_DURATION)),jn(54),_(1),y("ngClass",i.viewInfo.partTypeClasses.CUSTOM),_(2),y("ngIf",i.viewInfo.showCustomTime),_(5),y("ngIf",0===i.viewInfo.candidates.length)("ngIfElse",n),_(5),y("disabled",!i.viewInfo.canProposeConfig),_(2),y("ngIf",i.viewInfo.canReviewConfig)}}function Ivt(r,e){if(1&r&&(S(0,"div",74)(1,"p"),Ao(2,75),F(3,"br"),Io(),P()()),2&r){const t=p(3);_(3),Bn(t.viewInfo.creator),jn(2)}}function kvt(r,e){if(1&r&&(S(0,"span"),se(1,81),P()),2&r){const t=p(4);_(1),Bn(t.viewInfo.creator),jn(1)}}function xvt(r,e){1&r&&(S(0,"span"),se(1,82),P())}function Lvt(r,e){1&r&&(S(0,"span"),se(1,83),P())}function Rvt(r,e){if(1&r){const t=pe();S(0,"div",74)(1,"p"),se(2,76),P(),S(3,"ul")(4,"li"),T(5,kvt,2,1,"span",2),T(6,xvt,2,0,"span",2),T(7,Lvt,2,0,"span",2),P(),S(8,"li"),Ao(9,77),F(10,"strong"),ga(11,"humanDuration"),Io(),P(),S(12,"li"),Ao(13,78),F(14,"strong"),ga(15,"humanDuration"),Io(),P()(),S(16,"button",79),U("click",function(){return te(t),ne(p(3).acceptConfig())}),se(17,80),P()()}if(2&r){const t=p(3);_(2),Bn(t.viewInfo.creator)(t.viewInfo.partTypeName),jn(2),_(3),y("ngIf","CREATOR"===t.viewInfo.firstPlayer),_(1),y("ngIf","CHOSEN_PLAYER"===t.viewInfo.firstPlayer),_(1),y("ngIf","RANDOM"===t.viewInfo.firstPlayer),_(4),Bn(hc(11,7,t.viewInfo.maximalMoveDuration||0)),jn(9),_(4),Bn(hc(15,9,t.viewInfo.totalPartDuration||0)),jn(13)}}function zvt(r,e){if(1&r&&(S(0,"div")(1,"div",68)(2,"div",69)(3,"p"),se(4,70),P()(),S(5,"div",71),T(6,Ivt,4,1,"div",72),T(7,Rvt,18,11,"ng-template",null,73,dn),P()()()),2&r){const t=ln(8),n=p(2);_(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function Dvt(r,e){if(1&r&&(Bt(0),se(1,86),Gt()),2&r){const t=p(3);_(1),Bn(t.viewInfo.creator),jn(1)}}function Hvt(r,e){if(1&r&&se(0,87),2&r){const t=p(3);Bn(t.viewInfo.creator)(t.viewInfo.chosenOpponent),jn(0)}}function Vvt(r,e){if(1&r&&(S(0,"div",68)(1,"div",69)(2,"p"),se(3,84),P()(),S(4,"div",71)(5,"p"),T(6,Dvt,2,1,"ng-container",17),T(7,Hvt,1,2,"ng-template",null,85,dn),P()()()),2&r){const t=ln(8),n=p(2);_(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function Fvt(r,e){if(1&r&&(S(0,"div",1),T(1,Avt,74,27,"div",2),T(2,zvt,9,2,"div",2),T(3,Vvt,9,2,"div",3),P()),2&r){const t=p();_(1),y("ngIf",t.viewInfo.userIsCreator),_(1),y("ngIf",t.viewInfo.userIsChosenOpponent),_(1),y("ngIf",t.viewInfo.userIsObserver)}}let _R=(Qd=C4=class{constructor(e,t,n,i,o,s,a,c,l,f){u(this,"router",void 0),u(this,"actRoute",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"gameService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),u(this,"userService",void 0),u(this,"formBuilder",void 0),u(this,"messageDisplayer",void 0),u(this,"partType",cr),u(this,"partId",void 0),u(this,"gameStartNotification",new N1),u(this,"gameStarted",!1),u(this,"viewInfo",{userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]}),u(this,"currentConfigRoom",null),u(this,"candidates",[]),u(this,"ngUnsubscribe",new So),u(this,"allUserInterval",g.empty()),u(this,"ownTokenInterval",g.empty()),u(this,"lastToken",void 0),u(this,"selfSubscription",new Sn),u(this,"configRoomSubscription",new Sn),u(this,"candidatesSubscription",new Sn),u(this,"configFormGroup",void 0),u(this,"allDocDeleted",!1),this.router=e,this.actRoute=t,this.connectedUserService=n,this.currentGameService=i,this.gameService=o,this.configRoomService=s,this.chatService=a,this.userService=c,this.formBuilder=l,this.messageDisplayer=f}ngOnInit(){var e=this;return M(function*(){e.checkInputs(),e.createForms();const t=yield e.configRoomService.joinGame(e.partId);if(t.isFailure()){const n=t.getReason();e.messageDisplayer.criticalMessage(n)}else yield e.startSendingPresenceTokens(),e.subscribeToConfigRoomDoc(),e.subscribeToFormElements()})()}checkInputs(){const e=this.connectedUserService.user;Fe(e.isPresent(),"PartCreationComponent should not be called without connected user"),Fe(e.get()!==g0.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),Fe(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[L2.RANDOM.value,W7.required],maximalMoveDuration:[cr.NORMAL_MOVE_DURATION,W7.required],partType:["STANDARD",W7.required],totalPartDuration:[cr.NORMAL_PART_DURATION,W7.required],chosenOpponent:["",W7.required]})}updateUserDocWithCurrentGame(e){const t=this.getUserRoleInPart(e),n={id:this.partId,opponent:this.getOpponent(),typeGame:q.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:t};return this.currentGameService.updateCurrentGame(n)}getUserRoleInPart(e){const t=this.connectedUserService.user.get().id;return t===e.creator.id?"Creator":t===e.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let e=null;return e=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:q.getNonNullable(this.currentConfigRoom?.creator),e}subscribeToConfigRoomDoc(){var e=this;const t=function(){var i=M(function*(o){yield e.onCurrentConfigRoomUpdate(o)});return function(s){return i.apply(this,arguments)}}(),n=function(){var i=M(function*(o){yield e.onCandidatesUpdate(o)});return function(s){return i.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,t),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,n)}getForm(e){return q.getNonNullable(this.configFormGroup.get(e))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(Xd(this.ngUnsubscribe)).subscribe(e=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[e]=["is-selected"],this.viewInfo.chosenOpponent=e;const t=q.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=t!==ci.CONFIG_PROPOSED.value&&""!==e}),this.getForm("partType").valueChanges.pipe(Xd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[e]=["is-primary","is-selected"],this.viewInfo.partType=e,this.viewInfo.showCustomTime="CUSTOM"===e}),this.getForm("maximalMoveDuration").valueChanges.pipe(Xd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.maximalMoveDuration=e}),this.getForm("totalPartDuration").valueChanges.pipe(Xd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.totalPartDuration=e}),this.getForm("firstPlayer").valueChanges.pipe(Xd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[e]=["is-primary","is-selected"],this.viewInfo.firstPlayer=e})}updateViewInfo(){const e=q.getNonNullable(this.currentConfigRoom),t=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=e.partStatus===ci.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==ci.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(e),this.viewInfo.userIsChosenOpponent=t.id===e.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==ci.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator.name,this.viewInfo.candidates=this.candidates.map(n=>n.name),this.userIsCreator(e)?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenOpponent?.name,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??e.totalPartDuration;let t=this.viewInfo.chosenOpponent;null==t||""===t?t=e.chosenOpponent?.name??"":!1===this.candidates.some(i=>i.name===t)&&(t=""),this.getForm("chosenOpponent").setValue(t)}selectFirstPlayer(e){this.getForm("firstPlayer").setValue(e)}selectPartType(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(cr.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(cr.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(cr.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(cr.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}selectOpponent(e){var t=this;return M(function*(){const n=t.getUserFromName(e);yield Promise.all([t.currentGameService.updateCurrentGame({opponent:n}),t.configRoomService.setChosenOpponent(t.partId,n)])})()}getUserFromName(e){const t=this.candidates.find(n=>n.name===e);return q.getNonNullable(t)}changeConfig(){var e=this;return M(function*(){return e.configRoomService.reviewConfig(e.partId)})()}proposeConfig(){var e=this;return M(function*(){const t=e.getForm("chosenOpponent").value,n=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,o=e.getForm("firstPlayer").value,s=e.getForm("totalPartDuration").value,a=e.getUserFromName(t);return e.configRoomService.proposeConfig(e.partId,a,cr.of(n),i,L2.of(o),s)})()}cancelGameCreation(){var e=this;return M(function*(){e.allDocDeleted=!0,yield e.currentGameService.removeCurrentGame(),Ae.display("PartCreationComponent","cancelGameCreation","observed part removed"),yield e.chatService.deleteChat(e.partId),Ae.display("PartCreationComponent","cancelGameCreation","chat deleted"),yield e.gameService.deletePart(e.partId),Ae.display("PartCreationComponent","cancelGameCreation","chat and part deleted"),yield e.configRoomService.deleteConfigRoom(e.partId,e.candidates),Ae.display("PartCreationComponent","cancelGameCreation","chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(e){var t=this;return M(function*(){if(e.isAbsent())return Ae.display("PartCreationComponent","onCurrentConfigRoomUpdate","LAST UPDATE : the game is cancelled"),t.onGameCanceled();{const n=e.get();if(t.chosenOpponentJustLeft(n)&&t.userIsCreator(n)){const o=q.getNonNullable(t.currentConfigRoom),s=q.getNonNullable(o.chosenOpponent).name;t.messageDisplayer.infoMessage($localize`${s} left the game, please pick another opponent.`),yield t.currentGameService.updateCurrentGame({opponent:null})}let i=!1;t.userJustChosenAsOpponent(n)&&(yield t.updateUserDocWithCurrentGame(n),i=!0),t.currentConfigRoom=n,t.allUserInterval.isAbsent()&&(Fe(!1===i,"Expected currentGameUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield t.updateUserDocWithCurrentGame(t.currentConfigRoom),yield t.observeNeededPlayers()),t.updateViewInfo(),t.isGameStarted(t.currentConfigRoom)&&(Ae.display("PartCreationComponent","onCurrentConfigRoomUpdate","the game has started"),t.onGameStarted())}})()}onCandidatesUpdate(e){var t=this;return M(function*(){t.candidates=e,t.updateViewInfo()})()}userJustChosenAsOpponent(e){if(this.isGameStarted(e))return!1;const t=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==t&&e.chosenOpponent?.id===t}chosenOpponentJustLeft(e){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent)}onGameCanceled(){var e=this;return M(function*(){e.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield e.router.navigate(["/lobby"])})()}isGameStarted(e){return Fe(null!=e,"configRoom should not be null (isGameStarted)"),q.getNonNullable(e).partStatus===ci.PART_STARTED.value}onGameStarted(){const e=q.getNonNullable(this.currentConfigRoom);this.gameStartNotification.emit(e),this.gameStarted=!0}observeNeededPlayers(){var e=this;return M(function*(){const t=q.getNonNullable(e.currentConfigRoom);Fe(e.allUserInterval.isAbsent(),"Cannot observe players multiple times"),e.allUserInterval=g.of(window.setInterval(M(function*(){const n=e.lastToken;e.userIsCreator(t)?yield e.checkCandidatesTokensFreshness(n):yield e.checkCreatorTokenFreshness(n)}),Qd.TOKEN_INTERVAL))})()}userIsCreator(e){return this.connectedUserService.user.get().id===e.creator.id}checkCreatorTokenFreshness(e){var t=this;return M(function*(){const n=q.getNonNullable(t.currentConfigRoom);(yield t.didUserTimeout(n.creator.id,e))&&(yield t.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var e=this;return M(function*(){Fe(!1===e.isGameStarted(e.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),Fe(!1===e.allDocDeleted,"Should not delete doc twice"),yield e.cancelGameCreation()})()}checkCandidatesTokensFreshness(e){var t=this;return M(function*(){for(const n of t.candidates)(yield t.didUserTimeout(n.id,e))&&(yield t.removeCandidateFromLobby(n))})()}didUserTimeout(e,t){var n=this;return M(function*(){const i=yield n.userService.getUserLastUpdateTime(e);return i.isAbsent()?(u2.logError("PartCreationComponent","found no user while observing "+e+" !"),!0):xae(i.get(),t)>Qd.TOKEN_TIMEOUT})()}removeCandidateFromLobby(e){var t=this;return M(function*(){const n=q.getNonNullable(t.currentConfigRoom);return e.id===n.chosenOpponent?.id&&(yield t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId)),t.configRoomService.removeCandidate(t.partId,e)})()}startSendingPresenceTokens(){var e=this;return M(function*(){yield e.connectedUserService.sendPresenceToken(),Fe(e.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),e.ownTokenInterval=g.of(window.setInterval(()=>{e.connectedUserService.sendPresenceToken()},Qd.TOKEN_INTERVAL));const t=e.connectedUserService.user.get().id;e.selfSubscription=e.userService.observeUserOnServer(t,n=>{Fe(n.isPresent(),"connected user should exist"),e.lastToken=q.getNonNullable(n.get().lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=g.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return this.gameService.acceptConfig(this.partId,q.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var e=this;return M(function*(){if(e.ngUnsubscribe.next(),e.ngUnsubscribe.complete(),e.configRoomSubscription.unsubscribe(),e.candidatesSubscription.unsubscribe(),e.stopSendingPresenceTokensAndObservingUsersIfNeeded(),e.connectedUserService.user.isAbsent())return;const t=e.connectedUserService.user.get();!0!==e.gameStarted&&(null===e.currentConfigRoom?Ae.display("PartCreationComponent","ngOnDestroy","there is no part here"):!0===e.allDocDeleted?Ae.display("PartCreationComponent","ngOnDestroy","part has already been deleted"):t.id===e.currentConfigRoom.creator.id?(Ae.display("PartCreationComponent","ngOnDestroy","you(creator) about to cancel creation."),yield e.cancelGameCreation()):(Ae.display("PartCreationComponent","ngOnDestroy","you are about to cancel game joining"),yield e.currentGameService.removeCurrentGame(),yield e.configRoomService.cancelJoining(e.partId)))})()}},u(C4,"TOKEN_INTERVAL",5e3),u(C4,"TOKEN_TIMEOUT",1e4),u(C4,"\u0275fac",function(e){return new(e||C4)(G(Gn),G(xo),G(ar),G(uo),G(Z5),G(sd),G(W5),G(q5),G(Age),G(Ut))}),u(C4,"\u0275cmp",je({type:C4,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let r,e,t,n,i,o,s,a,c,l,f,d,m,E,w,L,z,$,B,de,_e,xe,nt,gt,Mn,Et,q2,D0,$l,e3,nh,rh,ft,Ot,xt,Nn;return r=$localize`Game creation`,e=$localize`First player`,t=$localize`Random`,n=$localize`You`,i=$localize`Game type`,o=$localize`Standard`,s=$localize`Maximal turn duration: `,a=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,c=$localize`Blitz`,l=$localize`Maximal turn duration: `,f=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,d=$localize`Custom`,m=$localize`Opponents`,E=$localize`Propose configuration`,w=$localize`Cancel game`,L=$localize`The opponent`,z=$localize`Maximal turn duration: `,$=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,B=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,de=$localize`Click on the opponent against which you would like to play.`,_e=$localize`Name`,xe=$localize`Actions`,nt=$localize`Pick`,gt=$localize`Change configuration`,Mn=$localize`Configuration proposal`,Et=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,q2=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,D0=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,$l=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,e3=$localize`Accept and start`,nh=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,rh=$localize`you play first`,ft=$localize`the first player is selected randomly`,Ot=$localize`One moment...`,xt=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,Nn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],r,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],e,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],t,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],n,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],i,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],o,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],s,a,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],c,l,f,["id","partTypeCustom",1,"button",3,"ngClass","click"],d,["id","customTime",4,"ngIf"],[1,"label"],m,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],E,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],w,L,["id","customTime"],["for","maximalMoveDuration",1,"label"],z,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],B,de,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],_e,xe,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],nt,["id","reviewConfig",1,"button",3,"click"],gt,[1,"message","is-primary"],[1,"message-header"],Mn,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],Et,q2,D0,$l,["id","acceptConfig",1,"button","is-primary",3,"click"],e3,nh,rh,ft,Ot,["proposalSent",""],xt,Nn]},template:function(e,t){1&e&&T(0,Fvt,4,3,"div",0),2&e&&y("ngIf",t.viewInfo)},dependencies:[Ft,Wt,Nt,m6,mc,gg,P3,p6,_6,D8,yvt],encapsulation:2})),C4);var Ka,z0;function Bvt(r,e){if(1&r){const t=pe();S(0,"button",3),U("click",function(){return te(t),ne(p().addTime())}),se(1,4),P()}if(2&r){const t=p();_(1),Bn(t.timeToAdd),jn(1)}}_R=Qd=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],_R);let vR=(z0=Ka=class{constructor(){u(this,"debugName",void 0),u(this,"timeToAdd",void 0),u(this,"dangerTimeLimit",void 0),u(this,"active",void 0),u(this,"canAddTime",void 0),u(this,"remainingMs",void 0),u(this,"displayedSec",void 0),u(this,"displayedMinute",void 0),u(this,"timeoutHandleGlobal",null),u(this,"timeoutHandleSec",null),u(this,"isPaused",!0),u(this,"isSet",!1),u(this,"started",!1),u(this,"startTime",void 0),u(this,"outOfTimeAction",new N1),u(this,"addTimeToOpponent",new N1),u(this,"cssClasses",z0.SAFE_TIME)}setDuration(e){q.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){q.assert(this.isPaused,"Should not change duration of a clock while it is running"),this.remainingMs=e,this.displayDuration()}subtract(e){this.changeDuration(this.remainingMs-e)}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){q.assert(this.isSet,"Should not start a chrono that has not been set!"),q.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){q.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){q.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),q.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){q.assert(this.started,"Should only stop chrono that are started!"),!1===this.isPaused&&this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?z0.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?z0.DANGER_TIME_ODD:z0.DANGER_TIME_EVEN:z0.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}},u(Ka,"DANGER_TIME_EVEN","has-background-danger has-text-white"),u(Ka,"DANGER_TIME_ODD","has-background-warning has-text-white"),u(Ka,"PASSIVE_STYLE","has-text-passive is-italic"),u(Ka,"SAFE_TIME",""),u(Ka,"\u0275fac",function(e){return new(e||Ka)}),u(Ka,"\u0275cmp",je({type:Ka,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let r;return r=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],r]},template:function(e,t){1&e&&(S(0,"div",0)(1,"p",1),lt(2),ga(3,"number"),P(),T(4,Bvt,2,1,"button",2),P()),2&e&&(y("ngClass",t.getTimeClass()),_(2),fE("",t.displayedMinute,":",t$(3,4,t.displayedSec,"2.0-0"),""),_(2),y("ngIf",t.canAddTime))},dependencies:[Ft,Nt,VB],encapsulation:2})),Ka);var ku;vR=z0=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],vR);const Uvt=["chronoZeroGlobal"],Wvt=["chronoOneGlobal"],qvt=["chronoZeroTurn"],jvt=["chronoOneTurn"];function Zvt(r,e){if(1&r){const t=pe();S(0,"app-part-creation",5,6),U("gameStartNotification",function(i){return te(t),ne(p().startGame(i))}),P()}2&r&&y("partId",p().currentPartId)}function Yvt(r,e){1&r&&(Bt(0),S(1,"span",39),se(2,40),P(),Gt())}function Kvt(r,e){if(1&r&&(S(0,"span",41),se(1,42),P()),2&r){const t=p(4);_(1),Bn(null==t.currentPlayer?null:t.currentPlayer.name),jn(1)}}function Xvt(r,e){if(1&r&&(S(0,"p",36),T(1,Yvt,3,0,"ng-container",37),T(2,Kvt,2,1,"ng-template",null,38,dn),P()),2&r){const t=ln(3),n=p(3);_(1),y("ngIf",(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name)("ngIfElse",t)}}function Qvt(r,e){if(1&r&&(S(0,"div",32)(1,"p",33),se(2,34),P(),T(3,Xvt,4,2,"p",35),P()),2&r){const t=p(2);_(2),Bn(t.currentPart.getTurn()+1),jn(2),_(1),y("ngIf",!1===t.endGame)}}function Jvt(r,e){if(1&r&&(S(0,"p",43),lt(1),P()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ZERO)),_(1),An(t.players[0].get().name)}}function eCt(r,e){if(1&r&&(S(0,"p",44),se(1,45),P()),2&r){const t=p(2);_(1),Bn(t.gameComponent.scores.get()[0]),jn(1)}}function tCt(r,e){if(1&r&&(S(0,"p",46),lt(1),P()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ONE)),_(1),An(t.players[1].get().name)}}function nCt(r,e){if(1&r&&(S(0,"p",47),se(1,48),P()),2&r){const t=p(2);_(1),Bn(t.gameComponent.scores.get()[1]),jn(1)}}function rCt(r,e){1&r&&(S(0,"div")(1,"p",50),se(2,51),P()())}function iCt(r,e){1&r&&(S(0,"p",55),se(1,56),P())}function oCt(r,e){1&r&&(S(0,"p",57),se(1,58),P())}function sCt(r,e){1&r&&(S(0,"p",59),se(1,60),P())}function aCt(r,e){if(1&r&&(S(0,"div"),T(1,iCt,2,0,"p",52),T(2,oCt,2,0,"p",53),T(3,sCt,2,0,"p",54),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getDrawAccepter().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getDrawAccepter().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function cCt(r,e){1&r&&(S(0,"p",64),se(1,65),P())}function lCt(r,e){1&r&&(S(0,"p",66),se(1,67),P())}function uCt(r,e){if(1&r&&(S(0,"p",68),se(1,69),P()),2&r){const t=p(4);_(1),Bn(t.currentPart.getWinner().get().name),jn(1)}}function fCt(r,e){if(1&r&&(S(0,"div"),T(1,cCt,2,0,"p",61),T(2,lCt,2,0,"p",62),T(3,uCt,2,1,"p",63),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function dCt(r,e){if(1&r&&(S(0,"p",64),se(1,70),P()),2&r){const t=p(4);_(1),Bn(t.currentPart.getLoser().get().name),jn(1)}}function hCt(r,e){1&r&&(S(0,"p",68),se(1,71),P())}function pCt(r,e){if(1&r&&(S(0,"p",68),se(1,72),P()),2&r){const t=p(4);_(1),Bn(t.currentPart.getLoser().get().name),jn(1)}}function gCt(r,e){if(1&r&&(S(0,"div"),T(1,dCt,2,1,"p",61),T(2,hCt,2,0,"p",63),T(3,pCt,2,1,"p",63),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function mCt(r,e){1&r&&(S(0,"p",74),se(1,75),P())}function _Ct(r,e){if(1&r&&(S(0,"p",74),se(1,76),P()),2&r){const t=p(4);_(1),Bn(t.currentPart.getLoser().get().name),jn(1)}}function vCt(r,e){if(1&r&&(S(0,"div"),T(1,mCt,2,0,"p",73),T(2,_Ct,2,1,"p",73),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying()||t.currentPart.getWinner().get().name===t.getPlayer().name)}}function CCt(r,e){if(1&r&&(S(0,"div",49),F(1,"hr"),T(2,rCt,3,0,"div",27),T(3,aCt,4,3,"div",27),T(4,fCt,4,3,"div",27),T(5,gCt,4,3,"div",27),T(6,vCt,3,2,"div",27),P()),2&r){const t=p(2);_(2),y("ngIf",t.currentPart.isHardDraw()),_(1),y("ngIf",t.currentPart.isAgreedDraw()),_(1),y("ngIf",t.currentPart.isWin()),_(1),y("ngIf",t.currentPart.isTimeout()),_(1),y("ngIf",t.currentPart.isResign())}}function yCt(r,e){if(1&r){const t=pe();Bt(0),S(1,"button",85),U("click",function(){const o=te(t).$implicit;return ne(p(4).propose(o))}),lt(2),F(3,"fa-icon",86),P(),Gt()}if(2&r){const t=e.$implicit,n=p(4);_(1),Dn("id","propose",t,""),y("disabled",!1===n.requestAvailable(t)),_(1),P2("",n.requestInfos[t].textForRequest(),"\xa0\xa0"),_(1),y("icon",n.requestInfos[t].icon)}}function MCt(r,e){if(1&r){const t=pe();Bt(0),S(1,"button",80),U("click",function(){return te(t),ne(p(3).resign())}),se(2,81),P(),S(3,"button",82),U("click",function(){return te(t),ne(p(3).gameComponent.pass())}),se(4,83),P(),T(5,yCt,4,4,"ng-container",84),Gt()}if(2&r){const t=p(3);_(1),y("disabled",!1===t.canResign()),_(2),y("disabled",!1===t.canPass()),_(2),y("ngForOf",t.allRequests)}}function ECt(r,e){if(1&r){const t=pe();S(0,"div",87)(1,"p"),lt(2),F(3,"fa-icon",86),P(),S(4,"button",88),U("click",function(){return te(t),ne(p(3).accept())}),se(5,89),P(),S(6,"button",90),U("click",function(){return te(t),ne(p(3).reject())}),se(7,91),P()()}if(2&r){const t=p(3);_(2),P2(" ",t.requestInfos[t.requestAwaitingReplyFromUs().get()].textForReply(),"\xa0\xa0 "),_(1),y("icon",t.requestInfos[t.requestAwaitingReplyFromUs().get()].icon)}}function SCt(r,e){if(1&r&&(S(0,"div",92)(1,"p")(2,"span"),Ao(3,93),F(4,"fa-icon",86),Io(),P()()()),2&r){const t=p(3);_(4),y("icon",t.requestInfos[t.deniedRequest().get()].icon),Bn(t.requestInfos[t.deniedRequest().get()].name()),jn(3)}}function PCt(r,e){if(1&r&&(S(0,"div",94)(1,"p")(2,"span"),Ao(3,95),F(4,"fa-icon",86),Io(),P()()()),2&r){const t=p(3);_(4),y("icon",t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].icon),Bn(t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].name()),jn(3)}}function TCt(r,e){if(1&r&&(Bt(0),T(1,MCt,6,3,"ng-container",37),T(2,ECt,8,2,"ng-template",null,77,dn),T(4,SCt,5,2,"div",78),T(5,PCt,5,2,"div",79),Gt()),2&r){const t=ln(3),n=p(2);_(1),y("ngIf",!1===n.mustReply())("ngIfElse",t),_(3),y("ngIf",n.deniedRequest().isPresent()),_(1),y("ngIf",n.requestAwaitingReplyFromOpponent().isPresent())}}function OCt(r,e){1&r&&(S(0,"button",96),se(1,97),P())}function bCt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"div",8)(2,"div",9),T(3,Qvt,4,2,"div",10),S(4,"div",11),T(5,Jvt,2,2,"p",12),T(6,eCt,2,1,"p",13),S(7,"app-count-down",14,15),U("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(t),ne(p().addGlobalTime())}),P(),S(9,"app-count-down",16,17),U("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(t),ne(p().addTurnTime())}),P()(),S(11,"p",18),se(12,19),P(),S(13,"div",11),T(14,tCt,2,2,"p",20),T(15,nCt,2,1,"p",21),S(16,"app-count-down",22,23),U("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(t),ne(p().addGlobalTime())}),P(),S(18,"app-count-down",24,25),U("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(t),ne(p().addTurnTime())}),P()(),F(20,"hr"),T(21,CCt,7,5,"div",26),T(22,TCt,6,4,"ng-container",27),T(23,OCt,2,0,"button",28),P()(),S(24,"div",29)(25,"div",30),F(26,"div",null,31),P()()()}if(2&r){const t=p();_(3),y("ngIf",null!==t.currentPart),_(2),y("ngIf",t.players[0].isPresent()),_(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),_(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),_(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),_(5),y("ngIf",t.players[1].isPresent()),_(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),_(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),_(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),_(3),y("ngIf",t.endGame&&null!==t.currentPart),_(1),y("ngIf",t.isPlaying()),_(1),y("ngIf",t.endGame),_(1),y("ngClass",t.getBoardHighlight())}}let wCt=(()=>{class r{}return u(r,"NO_MATCHING_PART",()=>$localize`The game you tried to join does not exist.`),r})(),CR=(ku=class extends JC{constructor(e,t,n,i,o,s,a,c,l,f){super(e,t,n,i),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"gameService",void 0),u(this,"gameEventService",void 0),u(this,"timeManager",void 0),u(this,"requestManager",void 0),u(this,"chronoZeroGlobal",void 0),u(this,"chronoOneGlobal",void 0),u(this,"chronoZeroTurn",void 0),u(this,"chronoOneTurn",void 0),u(this,"currentPart",null),u(this,"currentPartId",void 0),u(this,"gameStarted",!1),u(this,"opponent",null),u(this,"authUser",void 0),u(this,"currentPlayer",null),u(this,"configRoom",void 0),u(this,"currentGame",g.empty()),u(this,"userLinkedToThisPart",!0),u(this,"routerEventsSubscription",void 0),u(this,"userSubscription",void 0),u(this,"opponentSubscription",new Sn),u(this,"partSubscription",new Sn),u(this,"gameEventsSubscription",new Sn),u(this,"currentGameSubscription",new Sn),u(this,"OFFLINE_FONT_COLOR",{color:"lightgrey"}),u(this,"globalTimeMessage",$localize`5 minutes`),u(this,"turnTimeMessage",$localize`30 seconds`),u(this,"requestInfos",j3e.requestInfos),u(this,"allRequests",["TakeBack","Draw","Rematch"]),this.currentGameService=o,this.userService=s,this.gameService=a,this.gameEventService=c,this.timeManager=l,this.requestManager=f}extractPartIdFromURL(){return q.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return q.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}redirectIfPartOrGameIsInvalid(){var e=this;return M(function*(){const t=e.extractGameNameFromURL();if(Nu.ALL_GAMES().some(i=>i.urlName===t)){if((yield e.gameService.getPartValidity(e.currentPartId,t)).isFailure()){e.routerEventsSubscription.unsubscribe();const o=wCt.NO_MATCHING_PART();yield e.router.navigate(["/notFound",o],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=R0.NO_MATCHING_GAME(t);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return M(function*(){e.routerEventsSubscription=e.router.events.subscribe(function(){var t=M(function*(n){n instanceof F4&&(yield e.setCurrentPartIdOrRedirect())});return function(n){return t.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(t=>{e.authUser=t}),yield e.setCurrentPartIdOrRedirect(),e.currentGameSubscription=e.currentGameService.subscribeToCurrentGame(function(){var t=M(function*(n){yield e.onCurrentGameUpdate(n)});return function(n){return t.apply(this,arguments)}}())})()}onCurrentGameUpdate(e){var t=this;return M(function*(){if(e.isPresent()){const n=e.get();"Observer"===n.role||n.id===t.currentPartId?t.currentGame=e:(t.userLinkedToThisPart=!1,yield t.router.navigate(["/lobby"]))}else t.currentGame=g.empty()})()}startGame(e){var t=this;return M(function*(){q.assert(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(M(function*(){const n=yield t.afterViewInit();t.timeManager.setClocks([t.chronoZeroTurn,t.chronoOneTurn],[t.chronoZeroGlobal,t.chronoOneGlobal]),q.assert(n,"Game should be created successfully, otherwise part-creation would have redirected"),yield t.startPart()}),2)})()}startPart(){var e=this;return M(function*(){const t=(yield e.gameService.getPart(e.currentPartId)).get();e.currentPart=new hv(e.currentPartId,t),e.partSubscription=e.gameService.subscribeToChanges(e.currentPartId,function(){var n=M(function*(i){q.assert(i.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.currentPart=new hv(e.currentPartId,i.get())});return function(i){return n.apply(this,arguments)}}()),e.subscribeToEvents()})()}onGameStart(){var e=this;return M(function*(){yield e.initializePlayersDatas(e.currentPart);const t=e.gameComponent.getTurn();q.assert(0===t,"turn should always be 0 upon game start"),e.timeManager.onGameStart(e.configRoom),e.requestManager.onGameStart()})()}subscribeToEvents(){var e=this;const t=new _vt,n=function(){var i=M(function*(o){yield t.runExclusive(M(function*(){const s=o.filter(c=>"Move"===c.eventType).length;let a=0;e.beforeEventsBatch();for(const c of o)switch(c.eventType){case"Move":const l=a+1===s;yield e.onReceivedMove(c,l),a+=1;break;case"Request":e.requestManager.onReceivedRequest(c);break;case"Reply":(yield e.requestManager.onReceivedReply(c,e.role))&&(yield e.handleReply(c));break;default:q.expectToBe(c.eventType,"Action","Event should be an action"),e.timeManager.onReceivedAction(c),"EndGame"===c.action?yield e.onGameEnd():"StartGame"===c.action&&(yield e.onGameStart())}yield e.afterEventsBatch()}))});return function(s){return i.apply(this,arguments)}}();this.gameEventsSubscription=this.gameEventService.subscribeToEvents(this.currentPartId,n)}handleReply(e){var t=this;return M(function*(){switch(e.requestType){case"TakeBack":const n=I.of(e.player);yield t.takeBackToPreviousPlayerTurn(n.getOpponent());break;case"Rematch":yield t.router.navigate(["/nextGameLoading"]);const i=t.extractGameNameFromURL();yield t.router.navigate(["/play",i,e.data])}})()}onGameEnd(){var e=this;return M(function*(){yield e.currentGameService.removeCurrentGame(),e.endGame=!0})()}onReceivedMove(e,t){var n=this;return M(function*(){const i=n.gameComponent.rules,o=n.gameComponent.getTurn(),s=n.gameComponent.encoder.decode(e.move),a=i.isLegal(s,n.gameComponent.getState()),c="We received an incorrect db move: "+s.toString()+" at turn "+o+'because "'+a.getReasonOr("")+'"';q.assert(a.isSuccess(),c);const l=i.choose(n.gameComponent.node,s);if(q.assert(l.isPresent(),"Chosen move should be legal after all checks, but it is not!"),n.gameComponent.node=l.get(),n.role===K.NONE)yield n.updateBoardAndShowLastMove(t);else{const f=o%2!==n.role.value;yield n.updateBoardAndShowLastMove(f&&t)}n.currentPlayer=n.players[n.gameComponent.getTurn()%2].get(),n.timeManager.onReceivedMove(e),n.requestManager.onReceivedMove()})()}beforeEventsBatch(){this.timeManager.beforeEventsBatch(this.endGame)}afterEventsBatch(){var e=this;return M(function*(){const t=I.ofTurn(e.gameComponent.getTurn()),n=yield e.userService.getServerTime(e.connectedUserService.user.get().id);e.timeManager.afterEventsBatch(e.endGame,t,n)})()}takeBackToPreviousPlayerTurn(e){var t=this;return M(function*(){t.gameComponent.node=t.gameComponent.node.mother.get(),t.gameComponent.getCurrentPlayer()!==e&&(q.assert(t.gameComponent.getTurn()>0,"Should not allow player that never played to take back"),t.gameComponent.node=t.gameComponent.node.mother.get()),t.currentPlayer=t.players[t.gameComponent.getTurn()%2].get(),0===t.gameComponent.getTurn()?yield t.updateBoardAndShowLastMove(!1):yield t.updateBoardAndShowLastMove(!0)})()}canResign(){return q.assert(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}requestAvailable(e){switch(e){case"TakeBack":return this.canAskTakeBack();case"Draw":return this.canProposeDraw();default:return q.expectToBe(e,"Rematch"),this.endGame}}mustReply(){return this.requestAwaitingReplyFromUs().isPresent()}requestAwaitingReplyFromUs(){return q.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role)}requestAwaitingReplyFromOpponent(){return q.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role.getOpponent())}deniedRequest(){return this.requestManager.deniedRequest()}canPass(){return q.assert(this.isPlaying(),"Non playing should not call canPass"),!this.endGame&&this.currentPlayer?.name===this.getPlayer().name&&this.gameComponent.canPass}canAskTakeBack(){return q.assert(this.isPlaying(),"Non playing should not call canAskTakeBack"),q.assert(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(!0===this.endGame||q.getNonNullable(this.currentPart).data.turn<=this.role.value)&&this.requestManager.canMakeRequest("TakeBack")}canProposeDraw(){return q.assert(this.isPlaying(),"Non playing should not call canProposeDraw"),!this.endGame&&this.requestManager.canMakeRequest("Draw")}initializePlayersDatas(e){var t=this;return M(function*(){t.players=[g.of(e.data.playerZero),g.ofNullable(e.data.playerOne)],q.assert(null!=e.data.playerOne,"should not initializePlayersDatas when players data is not received"),t.currentPlayer=t.players[e.data.turn%2].get();const n=yield t.setRealObserverRole();if(n.isPresent()){const i=o=>{q.assert(o.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent=n.get()};t.opponentSubscription=t.userService.observeUserOnServer(n.get().id,i)}})()}setRealObserverRole(){var e=this;return M(function*(){let t=g.empty();return e.players[0].equalsValue(e.getPlayer())?(yield e.setRole(I.ZERO),t=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(yield e.setRole(I.ONE),t=e.players[0]):yield e.setRole(K.NONE),yield e.currentGameService.updateCurrentGame({...e.currentGame.get(),role:e.role===K.NONE?"Observer":"Player"}),t})()}onLegalUserMove(e){var t=this;return M(function*(){if(!t.mustReply()){const n=t.gameComponent.rules.isLegal(e,t.gameComponent.node.gameState);q.assert(n.isSuccess(),"onLegalUserMove called with an illegal move");const i=t.gameComponent.rules.applyLegalMove(e,t.gameComponent.node.gameState,n.get()),o=new Di(i,g.of(t.gameComponent.node),g.of(e)),s=t.gameComponent.rules.getGameStatus(o),a=t.gameComponent.encoder.encode(e);return yield t.gameService.addMove(t.currentPartId,t.role,a),t.updatePartWithStatusAndScores(s,t.gameComponent.scores)}t.gameComponent.message(R0.MUST_ANSWER_REQUEST())})()}updatePartWithStatusAndScores(e,t){var n=this;return M(function*(){return e.isEndGame?e===ve.DRAW?yield n.gameService.drawPart(n.currentPartId,n.role,t):(q.assert(e.winner.isPlayer(),"Non-draw end games should have a winner"),n.notifyVictory(e.winner,t)):n.gameService.updatePart(n.currentPartId,t)})()}notifyTimeoutVictory(e,t){var n=this;return M(function*(){const i=n.role;yield n.gameService.notifyTimeout(n.currentPartId,i,e,t)})()}notifyVictory(e,t){var n=this;return M(function*(){const i=q.getNonNullable(n.currentPart),o=n.players[0].get(),s=n.players[1].get();n.currentPart=e===I.ONE?i.setWinnerAndLoser(s,o):i.setWinnerAndLoser(o,s);const a=n.role;yield n.gameService.endPartWithVictory(n.currentPartId,a,n.currentPart.getWinner().get(),n.currentPart.getLoser().get(),t)})()}resign(){var e=this;return M(function*(){const t=e.role,n=e.getPlayer(),i=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,t,i,n)})()}reachedOutOfTime(e){var t=this;return M(function*(){if(!1===t.isPlaying())return;const n=q.getNonNullable(t.opponent);e===t.role?yield t.notifyTimeoutVictory(n,t.authUser.toMinimalUser()):yield t.notifyTimeoutVictory(t.authUser.toMinimalUser(),n)})()}propose(e){var t=this;return M(function*(){q.assert(t.role.isPlayer(),"cannot propose request if not player");const n=t.role;switch(e){case"Rematch":return t.gameService.proposeRematch(t.currentPartId,n);case"Draw":return t.gameService.proposeDraw(t.currentPartId,n);default:return q.expectToBe(e,"TakeBack"),t.gameService.askTakeBack(t.currentPartId,n)}})()}accept(){var e=this;return M(function*(){q.assert(e.role.isPlayer(),"cannot accept request if not player");const t=e.role,n=q.getNonNullable(e.currentPart),i=e.requestManager.getCurrentRequest().get().requestType;switch(i){case"Rematch":return e.gameService.acceptRematch(n,t);case"Draw":return e.gameService.acceptDraw(n.id,t);default:return q.expectToBe(i,"TakeBack"),e.gameService.acceptTakeBack(n.id,n.data.turn,t)}})()}reject(){var e=this;return M(function*(){q.assert(e.role.isPlayer(),"cannot reject request if not player");const t=e.role,n=e.requestManager.getCurrentRequest().get().requestType;switch(n){case"Rematch":return e.gameService.rejectRematch(e.currentPartId,t);case"Draw":return e.gameService.refuseDraw(e.currentPartId,t);default:return q.expectToBe(n,"TakeBack"),e.gameService.refuseTakeBack(e.currentPartId,t)}})()}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===I.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}addGlobalTime(){return this.gameService.addGlobalTime(this.currentPartId,this.role)}addTurnTime(){return this.gameService.addTurnTime(this.currentPartId,this.role)}onCancelMove(e){var t=this;return M(function*(){if(t.gameComponent.node.move.isPresent()){const n=t.gameComponent.node.move.get();yield t.gameComponent.showLastMove(n)}})()}ngOnDestroy(){var e=this;return M(function*(){e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.currentGameSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&e.connectedUserService.user.isPresent()&&(yield e.currentGameService.removeCurrentGame()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe(),e.gameEventsSubscription.unsubscribe())})()}},u(ku,"\u0275fac",function(e){return new(e||ku)(G(xo),G(ar),G(Gn),G(Ut),G(uo),G(q5),G(Z5),G(Zk),G(Cvt),G(j3e))}),u(ku,"\u0275cmp",je({type:ku,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){if(1&e&&(N4(Uvt,5),N4(Wvt,5),N4(qvt,5),N4(jvt,5)),2&e){let n;v3(n=C3())&&(t.chronoZeroGlobal=n.first),v3(n=C3())&&(t.chronoOneGlobal=n.first),v3(n=C3())&&(t.chronoZeroTurn=n.first),v3(n=C3())&&(t.chronoOneTurn=n.first)}},features:[Qe],decls:5,vars:4,consts:function(){let r,e,t,n,i,o,s,a,c,l,f,d,m,E,w,L,z,$,B,de,_e,xe,nt,gt,Mn;return r=$localize`vs.`,e=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,t=$localize`It is your turn.`,n=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`Draw`,a=$localize`You agreed to draw.`,c=$localize`Your draw proposal has been accepted.`,l=$localize`Players agreed to draw.`,f=$localize`You won.`,d=$localize`You lost.`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,E=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,w=$localize`You reached your time limit.`,L=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,z=$localize`You resigned.`,$=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,B=$localize`Resign`,de=$localize`Pass a turn`,_e=$localize`Accept`,xe=$localize`Reject`,nt=$localize`Your ${"\ufffd0\ufffd"}:INTERPOLATION: request has been rejected.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,gt=$localize`Your request for a ${"\ufffd0\ufffd"}:INTERPOLATION: has been sent.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,Mn=$localize`Go back to the game list`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],r,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],["class","block","id","winnerIndicator",4,"ngIf"],[4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],t,["id","opponentTurn"],n,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],o,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],s,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],a,["id","yourOpponentAgreedToDrawIndicator",1,"title"],c,["id","playersAgreedToDraw",1,"title"],l,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],f,["id","youLostIndicator",1,"title"],d,[1,"title"],m,E,w,L,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],z,$,["replyButtons",""],["id","requestRejected","class","notification is-danger",4,"ngIf"],["id","requestAwaitingReply","class","notification",4,"ngIf"],["id","resign",1,"button","is-fullwidth","mb-1","is-danger",3,"disabled","click"],B,["id","pass",1,"button","is-fullwidth","mb-1","is-success",3,"disabled","click"],de,[4,"ngFor","ngForOf"],[1,"button","is-fullwidth","mb-1",3,"id","disabled","click"],[3,"icon"],[1,"notification"],["id","accept",1,"button","is-fullwidth","mb-1","is-success",3,"click"],_e,["id","reject",1,"button","is-fullwidth","mb-1","is-danger",3,"click"],xe,["id","requestRejected",1,"notification","is-danger"],nt,["id","requestAwaitingReply",1,"notification"],gt,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],Mn]},template:function(e,t){1&e&&(T(0,Zvt,2,1,"app-part-creation",0),T(1,bCt,28,25,"div",1),S(2,"div",2)(3,"div",3),F(4,"app-chat",4),P()()),2&e&&(y("ngIf",!1===t.gameStarted),_(1),y("ngIf",t.gameStarted),_(3),y("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},dependencies:[Ft,Wt,Nt,yc,S0,ey,_R,vR],encapsulation:2})),ku);var Hl,yR;function ACt(r,e){if(1&r&&(S(0,"option",26),lt(1),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),An(t.name)}}function ICt(r,e){if(1&r&&(S(0,"option",26),se(1,30),P()),2&r){const t=e.$implicit;y("value",t),_(1),Bn(t),jn(1)}}CR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],CR);const kCt=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function xCt(r,e){if(1&r){const t=pe();S(0,"select",27),U("ngModelChange",function(i){return te(t),ne(p(2).aiDepths[0]=i)})("change",function(){te(t);const i=p(2);return ne(i.updatePlayer(i.Player.ZERO))}),S(1,"option",28),se(2,29),P(),T(3,ICt,2,2,"option",17),P()}2&r&&(y("ngModel",p(2).aiDepths[0]),_(3),y("ngForOf",_1(2,kCt)))}function LCt(r,e){if(1&r&&(S(0,"p",31),se(1,32),P()),2&r){const t=p(2);_(1),Bn(t.gameComponent.scores.get()[0]),jn(1)}}function RCt(r,e){if(1&r&&(S(0,"option",26),lt(1),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),An(t.name)}}function zCt(r,e){if(1&r&&(S(0,"option",26),se(1,35),P()),2&r){const t=e.$implicit;y("value",t),_(1),Bn(t),jn(1)}}const DCt=function(){return[1,2,3,4,5,6,7,8,9,10]};function HCt(r,e){if(1&r){const t=pe();S(0,"select",33),U("ngModelChange",function(i){return te(t),ne(p(2).aiDepths[1]=i)})("change",function(){te(t);const i=p(2);return ne(i.updatePlayer(i.Player.ONE))}),S(1,"option",28),se(2,34),P(),T(3,zCt,2,2,"option",17),P()}2&r&&(y("ngModel",p(2).aiDepths[1]),_(3),y("ngForOf",_1(2,DCt)))}function VCt(r,e){if(1&r&&(S(0,"p",36),se(1,37),P()),2&r){const t=p(2);_(1),Bn(t.gameComponent.scores.get()[1]),jn(1)}}function FCt(r,e){if(1&r&&(S(0,"h4",41),lt(1),P()),2&r){const t=p(3);_(1),An(t.winnerMessage.get())}}function $Ct(r,e){1&r&&(S(0,"h4",42),se(1,43),P())}function BCt(r,e){if(1&r&&(S(0,"div",38),T(1,FCt,2,1,"h4",39),T(2,$Ct,2,0,"h4",40),P()),2&r){const t=p(2);_(1),y("ngIf",t.winnerMessage.isPresent()),_(1),y("ngIf",t.winnerMessage.isAbsent())}}function GCt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"div",8)(2,"p",9),se(3,10),P()(),S(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),U("change",function(){te(t);const i=p();return ne(i.updatePlayer(i.Player.ZERO))})("ngModelChange",function(i){return te(t),ne(p().playerSelection[0]=i)}),S(8,"option",15),se(9,16),P(),T(10,ACt,2,2,"option",17),P()(),S(11,"div",13),T(12,xCt,4,3,"select",18),P(),T(13,LCt,2,1,"p",19),P(),S(14,"div",20)(15,"div",13)(16,"select",21),U("change",function(){te(t);const i=p();return ne(i.updatePlayer(i.Player.ONE))})("ngModelChange",function(i){return te(t),ne(p().playerSelection[1]=i)}),S(17,"option",15),se(18,22),P(),T(19,RCt,2,2,"option",17),P()(),S(20,"div",13),T(21,HCt,4,3,"select",23),P(),T(22,VCt,2,1,"p",24),P()(),T(23,BCt,3,2,"div",25),P()}if(2&r){const t=p();_(3),Bn(t.gameComponent.getTurn()+1),jn(3),_(4),y("ngModel",t.playerSelection[0]),_(3),y("ngForOf",t.gameComponent.availableMinimaxes),_(2),y("ngIf",!1===t.players[0].equalsValue("human")),_(1),y("ngIf",t.gameComponent.scores.isPresent()),_(3),y("ngModel",t.playerSelection[1]),_(3),y("ngForOf",t.gameComponent.availableMinimaxes),_(2),y("ngIf",!1===t.players[1].equalsValue("human")),_(1),y("ngIf",t.gameComponent.scores.isPresent()),_(1),y("ngIf",t.endGame)}}function UCt(r,e){if(1&r){const t=pe();S(0,"button",50),U("click",function(){return te(t),ne(p(2).gameComponent.pass())}),se(1,51),P()}}function WCt(r,e){if(1&r){const t=pe();S(0,"button",52),U("click",function(){return te(t),ne(p(2).takeBack())}),se(1,53),P()}}function qCt(r,e){if(1&r&&(Bt(0),lt(1),F(2,"br"),Gt()),2&r){const t=e.$implicit,n=p(3);_(1),P2(" ",t.name+": "+t.getBoardValue(n.gameComponent.node)," ")}}function jCt(r,e){if(1&r&&(S(0,"div",54),T(1,qCt,3,1,"ng-container",55),lt(2),F(3,"br"),lt(4),F(5,"br"),P()),2&r){const t=p(2);_(1),y("ngForOf",t.gameComponent.availableMinimaxes),_(1),P2(" Created ",t.getCreatedNodes()," nodes."),_(2),P2(" Minimax time: ",t.getMinimaxTime(),"ms.")}}function ZCt(r,e){if(1&r){const t=pe();S(0,"div",44),T(1,UCt,2,0,"button",45),T(2,WCt,2,0,"button",46),S(3,"button",47),U("click",function(){return te(t),ne(p().restartGame())}),se(4,48),P(),T(5,jCt,6,3,"div",49),P()}if(2&r){const t=p();_(1),y("ngIf",!1===t.endGame&&t.gameComponent.canPass),_(1),y("ngIf",t.canTakeBack()),_(3),y("ngIf",t.gameComponent.node.move.isPresent()&&t.displayAIMetrics)}}let MR=(yR=Hl=class extends JC{constructor(e,t,n,i,o){super(e,t,n,i),u(this,"cdr",void 0),u(this,"aiDepths",["0","0"]),u(this,"playerSelection",["human","human"]),u(this,"winnerMessage",g.empty()),u(this,"displayAIMetrics",!1),this.cdr=o,this.players=[g.of(this.playerSelection[0]),g.of(this.playerSelection[1])],this.role=I.ZERO}getCreatedNodes(){return rC.createdNodes}getMinimaxTime(){return rC.minimaxTime}ngAfterViewInit(){var e=this;window.setTimeout(M(function*(){(yield e.afterViewInit())&&(yield e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){var t=this;return M(function*(){t.players[e.value]=g.of(t.playerSelection[e.value]),"human"===t.playerSelection[1]&&"human"!==t.playerSelection[0]?yield t.setRole(I.ONE):yield t.setRole(I.ZERO),t.proposeAIToPlay()})()}onLegalUserMove(e){var t=this;return M(function*(){t.gameComponent.node=t.gameComponent.rules.choose(t.gameComponent.node,e).get(),yield t.updateBoard(!1),t.proposeAIToPlay(),t.cdr.detectChanges()})()}updateBoard(e){var t=this;return M(function*(){yield t.updateBoardAndShowLastMove(e);const n=t.gameComponent.rules.getGameStatus(t.gameComponent.node);if(!0===n.isEndGame&&(t.endGame=!0,n.winner.isPlayer())){const i=$localize`Player ${n.winner.value+1}`,s=n.winner.getOpponent().value;t.winnerMessage=t.players[n.winner.value].equalsValue("human")?t.players[s].equalsValue("human")?g.of($localize`${i} won`):g.of($localize`You won`):t.players[s].equalsValue("human")?g.of($localize`You lost`):g.of($localize`${t.players[n.winner.value].get()} (Player ${n.winner.value+1}) won`)}})()}proposeAIToPlay(){var e=this;const t=this.getPlayingAI();t.isPresent()&&window.setTimeout(M(function*(){yield e.doAIMove(t.get())}),yR.AI_TIMEOUT)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.node).isEndGame)return g.empty();const e=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[e]?g.empty():g.ofNullable(this.gameComponent.availableMinimaxes.find(t=>this.players[e].equalsValue(t.name)))}doAIMove(e){var t=this;return M(function*(){const n=t.gameComponent.rules;Fe(n.getGameStatus(t.gameComponent.node)===ve.ONGOING,"AI should not try to play when game is over!");const s=Number.parseInt(t.aiDepths[t.gameComponent.node.gameState.turn%2%2]),a=t.gameComponent.node.findBestMove(s,e,!0),c=n.choose(t.gameComponent.node,a);return c.isPresent()?(t.gameComponent.node=c.get(),yield t.updateBoard(!0),t.cdr.detectChanges(),t.proposeAIToPlay(),b.SUCCESS):(t.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),u2.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()}))})()}canTakeBack(){return this.players[0].equalsValue("human")?this.gameComponent.getTurn()>0:!!this.players[1].equalsValue("human")&&this.gameComponent.getTurn()>1}takeBack(){var e=this;return M(function*(){e.gameComponent.node=e.gameComponent.node.mother.get(),e.isAITurn()&&(q.assert(e.gameComponent.node.mother.isPresent(),"Cannot take back in first turn when AI is Player.ZERO"),e.gameComponent.node=e.gameComponent.node.mother.get()),yield e.updateBoardAndShowLastMove(!1)})()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){var e=this;return M(function*(){e.gameComponent.node=e.gameComponent.rules.getInitialNode(),e.gameComponent.hideLastMove(),yield e.gameComponent.updateBoard(!1),e.endGame=!1,e.winnerMessage=g.empty(),e.proposeAIToPlay()})()}getPlayer(){return"human"}onCancelMove(e){var t=this;return M(function*(){if(t.gameComponent.node.move.isPresent()){const n=t.gameComponent.node.move.get();yield t.gameComponent.showLastMove(n)}})()}},u(Hl,"AI_TIMEOUT",1e3),u(Hl,"\u0275fac",function(e){return new(e||Hl)(G(xo),G(ar),G(Gn),G(Ut),G(y3))}),u(Hl,"\u0275cmp",je({type:Hl,selectors:[["app-local-game-wrapper"]],features:[Qe],decls:8,vars:3,consts:function(){let r,e,t,n,i,o,s,a,c,l,f,d,m;return r=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,t=$localize`Human`,n=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`Pick the level`,a=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,c=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,l=$localize`Draw`,f=$localize`Start a new game`,d=$localize`Pass a turn`,m=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],r,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],t,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],n,i,["id","scoreOne",1,"block"],o,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],s,a,["id","scoreZero",1,"block"],c,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],l,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],f,["id","AIMetrics",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],d,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],m,["id","AIMetrics"],[4,"ngFor","ngForOf"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"div",1),T(2,GCt,24,10,"div",2),T(3,ZCt,6,3,"div",3),P(),S(4,"div",4)(5,"div",5),F(6,"div",null,6),P()()()),2&e&&(_(2),y("ngIf",t.gameComponent),_(1),y("ngIf",t.gameComponent),_(1),y("ngClass",t.getBoardHighlight()))},dependencies:[Ft,Wt,Nt,J7,ef,mg,P3,Q7],encapsulation:2,changeDetection:0})),Hl);MR=yR=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],MR);let Z3e=(()=>{class r{}return u(r,"STEP_FINISHED",()=>$localize`Step finished!`),u(r,"INFORMATIONAL_STEP",()=>$localize`This step is not expecting any move from your part.`),r})();var xu;function KCt(r,e){if(1&r&&(S(0,"div",21)(1,"div",22),se(2,23),P(),F(3,"div",24),P()),2&r){const t=p();_(3),y("innerHTML",t.currentReason.get(),d7)}}function XCt(r,e){if(1&r){const t=pe();S(0,"button",25),U("click",function(){return te(t),ne(p().retry())}),se(1,26),P()}}function QCt(r,e){1&r&&(Bt(0),se(1,31),Gt())}function JCt(r,e){1&r&&(Bt(0),se(1,32),Gt())}function eyt(r,e){if(1&r&&T(0,JCt,2,0,"ng-container",28),2&r){p();const t=ln(5),n=p();y("ngIf",n.stepFinished&&n.stepFinished[n.stepIndex])("ngIfElse",t)}}function tyt(r,e){1&r&&(Bt(0),se(1,33),Gt())}function nyt(r,e){if(1&r){const t=pe();S(0,"button",27),U("click",function(){return te(t),ne(p().next())}),T(1,QCt,2,0,"ng-container",28),T(2,eyt,1,2,"ng-template",null,29,dn),T(4,tyt,2,0,"ng-template",null,30,dn),P()}if(2&r){const t=ln(3),n=p();_(1),y("ngIf",n.steps[n.stepIndex]&&n.steps[n.stepIndex].isInformation())("ngIfElse",t)}}function ryt(r,e){if(1&r){const t=pe();S(0,"button",34),U("click",function(){return te(t),ne(p().start())}),se(1,35),P()}}function iyt(r,e){if(1&r){const t=pe();S(0,"button",36),U("click",function(){return te(t),ne(p().playLocally())}),se(1,37),P()}}function oyt(r,e){if(1&r){const t=pe();S(0,"button",38),U("click",function(){return te(t),ne(p().createGame())}),se(1,39),P()}}function syt(r,e){if(1&r){const t=pe();S(0,"button",40),U("click",function(){return te(t),ne(p().showSolution())}),se(1,41),P()}}function ayt(r,e){if(1&r&&(Bt(0),S(1,"option",43),lt(2),P(),Gt()),2&r){const t=p(),n=t.index,i=t.$implicit;_(1),Dn("id","step_",n,""),y("value",n),_(1),An(i.title)}}function cyt(r,e){1&r&&(Bt(0),lt(1,"v "),Gt())}function lyt(r,e){1&r&&lt(0,"x ")}function uyt(r,e){if(1&r&&(S(0,"option",44),T(1,cyt,2,0,"ng-container",28),T(2,lyt,1,0,"ng-template",null,45,dn),S(4,"span",46),lt(5),P()()),2&r){const t=ln(3),n=p(),i=n.index,o=n.$implicit,s=p();y("value",i),_(1),y("ngIf",s.stepFinished[i])("ngIfElse",t),_(3),Dn("id","step_",i,""),_(1),An(o.title)}}function fyt(r,e){if(1&r&&(Bt(0),T(1,ayt,3,3,"ng-container",28),T(2,uyt,6,5,"ng-template",null,42,dn),Gt()),2&r){const t=e.index,n=ln(3),i=p();_(1),y("ngIf",t===i.stepIndex)("ngIfElse",n)}}let ER=(xu=class extends JC{constructor(e,t,n,i,o){super(e,o,t,n),u(this,"cdr",void 0),u(this,"COMPLETED_TUTORIAL_MESSAGE",$localize`Congratulations, you completed the tutorial.`),u(this,"steps",[]),u(this,"successfulSteps",0),u(this,"stepIndex",-1),u(this,"currentMessage",""),u(this,"currentReason",g.empty()),u(this,"moveAttemptMade",!1),u(this,"stepFinished",[]),u(this,"tutorialOver",!1),this.cdr=i,this.role=I.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return M(function*(){(yield e.afterViewInit())&&(yield e.start())})()}start(){var e=this;return M(function*(){const t=e.gameComponent.tutorial;yield e.startTutorial(t)})()}startTutorial(e){var t=this;return M(function*(){t.steps=e,t.tutorialOver=!1,t.stepFinished=t.getCompletionArray(),t.successfulSteps=0,yield t.showStep(0)})()}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){var t=this;return M(function*(){const n=e.target;yield t.showStep(Number.parseInt(n.value,10))})()}showStep(e){var t=this;return M(function*(){t.moveAttemptMade=!1,t.stepFinished[e]=!1,t.updateSuccessCount(),t.stepIndex=e;const n=t.steps[t.stepIndex];t.currentMessage=n.instruction,t.currentReason=g.empty(),t.gameComponent.node=new Di(n.state,g.empty(),n.previousMove),yield t.setRole(t.gameComponent.getCurrentPlayer()),t.cdr.detectChanges()})()}onLegalUserMove(e){var t=this;return M(function*(){const n=t.steps[t.stepIndex],i=t.gameComponent.rules.choose(t.gameComponent.node,e);if(q.assert(i.isPresent(),"It should be impossible to call onLegalUserMove with an illegal move"),t.gameComponent.node=i.get(),yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,n.isPredicate()){const o=t.gameComponent.getPreviousState(),s=t.gameComponent.getState(),a=q.getNonNullable(n.predicate)(e,o,s);a.isSuccess()?t.showStepSuccess(n.getSuccessMessage()):t.currentReason=g.of(a.getReason())}else if(n.isAnyMove())Ae.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(n.getSuccessMessage());else if(n.isMove()){const o=n;o.acceptedMoves.some(s=>s.equals(e))?(Ae.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(o.getSuccessMessage())):(Ae.display("TutorialGameWrapperComponent","onLegalUserMove","not the move that was awaited."),t.currentReason=g.of(o.getFailureMessage()))}else q.assert(n.isClick(),"Here, we should have a click");t.cdr.detectChanges()})()}retry(){var e=this;return M(function*(){e.moveAttemptMade=!1,yield e.showStep(e.stepIndex)})()}canUserPlay(e){var t=this;return M(function*(){if(t.currentReason=g.empty(),t.stepFinished[t.stepIndex]||t.moveAttemptMade)return b.failure(Z3e.STEP_FINISHED());const n=t.steps[t.stepIndex];return n.isClick()?(yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,q.getNonNullable(n.acceptedClicks).some(i=>i===e)?t.showStepSuccess(n.getSuccessMessage()):t.currentMessage=n.getFailureMessage(),b.SUCCESS):n.isMove()||n.isPredicate()||n.isAnyMove()?b.SUCCESS:b.failure(Z3e.INFORMATIONAL_STEP())})()}onCancelMove(e){var t=this;return M(function*(){void 0!==e&&(t.currentReason=g.of(e)),t.cdr.detectChanges()})()}showStepSuccess(e){this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const t of this.stepFinished)t&&e++;this.successfulSteps=e}next(){var e=this;return M(function*(){if(e.steps[e.stepIndex].isInformation()&&(e.stepFinished[e.stepIndex]=!0,e.updateSuccessCount()),e.stepFinished.length===e.successfulSteps)e.currentMessage=e.COMPLETED_TUTORIAL_MESSAGE,e.tutorialOver=!0;else{let t=(e.stepIndex+1)%e.steps.length;for(;!0===e.stepFinished[t];)t=(t+1)%e.steps.length;yield e.showStep(t)}})()}showSolution(){var e=this;return M(function*(){const t=e.steps[e.stepIndex];q.assert(t.hasSolution(),"step must have solution");const n=t,i=n.getSolution();i instanceof Ri?(yield e.showStep(e.stepIndex),e.gameComponent.node=e.gameComponent.rules.choose(e.gameComponent.node,i).get(),yield e.updateBoardAndShowLastMove(!0)):(yield e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=n.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return M(function*(){const t=q.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",t])})()}createGame(){var e=this;return M(function*(){const t=q.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",t])})()}getPlayer(){return"tutorial-player"}},u(xu,"\u0275fac",function(e){return new(e||xu)(G(xo),G(Gn),G(Ut),G(y3),G(ar))}),u(xu,"\u0275cmp",je({type:xu,selectors:[["app-tutorial-game-wrapper"]],features:[Qe],decls:23,vars:15,consts:function(){let r,e,t,n,i,o,s,a,c;return r=$localize`Failure`,e=$localize`Try again`,t=$localize`Ok`,n=$localize`Continue`,i=$localize`Skip`,o=$localize`Try again`,s=$localize`Play locally`,a=$localize`Create an online game`,c=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],r,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],t,n,i,["id","restartButton",1,"button",3,"click"],o,["id","playLocallyButton",1,"button",3,"click"],s,["id","playOnlineButton",1,"button",3,"click"],a,["id","showSolutionButton",1,"button",3,"click"],c,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"div",1)(2,"div",2),F(3,"progress",3),S(4,"div",4)(5,"p",5),lt(6),P(),F(7,"p",6),P(),T(8,KCt,4,1,"div",7),S(9,"div",8),T(10,XCt,2,0,"button",9),T(11,nyt,6,2,"button",10),T(12,ryt,2,0,"button",11),T(13,iyt,2,0,"button",12),T(14,oyt,2,0,"button",13),T(15,syt,2,0,"button",14),S(16,"div",15)(17,"select",16),U("change",function(i){return t.changeStep(i)}),T(18,fyt,4,2,"ng-container",17),P()()()()(),S(19,"div",18)(20,"div",19),F(21,"div",null,20),P()()()),2&e&&(_(3),k("value",t.successfulSteps)("max",t.getNumberOfSteps()),_(3),dE("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),_(1),y("innerHTML",t.currentMessage,d7),_(1),y("ngIf",t.currentReason.isPresent()),_(2),y("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),_(1),y("ngIf",!1===t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),_(3),y("ngForOf",t.steps),_(1),y("ngClass",t.getBoardHighlight()))},dependencies:[Ft,Wt,Nt,J7,ef],encapsulation:2,changeDetection:0})),xu);function dyt(r,e){if(1&r&&(S(0,"div",35)(1,"div",36),se(2,37),P(),S(3,"div",38),lt(4),P()()),2&r){const t=p();_(4),An(t.errorMessage)}}ER=function(r,e,t,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(s=r[a])&&(o=(i<3?s(o):i>3?s(e,t,o):s(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o}([Ae.log],ER);const hyt=function(){return["/login"]};let pyt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"faEye",Ux),u(this,"errorMessage",void 0),u(this,"registrationForm",new z4({email:new rs,username:new rs,password:new rs})),this.connectedUserService=n,this.router=i}registerWithEmail(){var n=this;return M(function*(){const i=n.registrationForm.value.username,o=n.registrationForm.value.email,s=n.registrationForm.value.password;if(null==i||null==o||null==s)n.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const a=yield n.connectedUserService.doRegister(i,o,s);if(a.isSuccess()){const c=yield n.connectedUserService.sendEmailVerification();c.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=c.getReason()}else n.errorMessage=a.getReason()}})()}registerWithGoogle(){var n=this;return M(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=i.getReason()})()}getPasswordHelpClass(){const n=this.registrationForm.value.password;return null==n||""===n?"":n.length<6?"is-danger":"is-success"}canRegister(){const n=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===n||n.length<6)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(ar),G(Gn))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,n,i,o,s,a,c,l,f,d,m,E,w,L;return t=$localize`Registering`,n=$localize`Email`,i=$localize`Email`,o=$localize`A confirmation email will be sent to validate your account.`,s=$localize`Username`,a=$localize`Username`,c=$localize`Password`,l=$localize`Password`,f=$localize`The password should be at least 6 characters long`,d=$localize`Register`,m=$localize`Register with Google`,E=$localize`Have an account?`,w=$localize`Log in`,L=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input"],[1,"help"],o,["for","username",1,"label"],s,["id","username","formControlName","username","name","username","placeholder",a,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",l,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],f,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],d,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],E,[3,"routerLink"],w,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],L,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),se(2,2),P(),S(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),se(7,7),P()(),S(8,"div",8)(9,"div",9)(10,"div",10),F(11,"input",11),S(12,"p",12),se(13,13),P()()()()(),S(14,"div",4)(15,"div",5)(16,"label",14),se(17,15),P()(),S(18,"div",8)(19,"div",9)(20,"div",10),F(21,"input",16),P()()()(),S(22,"div",4)(23,"div",5)(24,"label",17),se(25,18),P()(),S(26,"div",8)(27,"div",9)(28,"div",19),F(29,"input",20),S(30,"span",21),F(31,"fa-icon",22),P(),S(32,"p",23),se(33,24),P()()()()(),S(34,"div",4),F(35,"div",5),S(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),U("click",function(){return i.registerWithEmail()}),se(40,26),P()()()()(),S(41,"div",4),F(42,"div",5),S(43,"div",27),T(44,dyt,5,1,"div",28),P()(),S(45,"div",4),F(46,"div",5),S(47,"div",8)(48,"button",29),U("click",function(){return i.registerWithGoogle()}),se(49,30),P()()(),S(50,"p",31),Bt(51),se(52,32),Gt(),lt(53,"\xa0 "),S(54,"a",33),se(55,34),P()()()()),2&n&&(_(3),y("formGroup",i.registrationForm),_(28),y("icon",i.faEye),_(1),y("ngClass",i.getPasswordHelpClass()),_(7),y("disabled",!i.canRegister()),_(5),y("ngIf",i.errorMessage),_(10),y("routerLink",_1(6,hyt)))},dependencies:[Ft,Nt,yc,m6,mc,P3,p6,C6,_6,D8,S0,gR,G3e],encapsulation:2})),e})(),gyt=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}playLocally(){var n=this;return M(function*(){yield n.router.navigate(["local/"+n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Gn))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),U("pickGame",function(s){return i.pickGame(s)}),P(),S(1,"button",1),U("click",function(){return i.playLocally()}),se(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[pR],encapsulation:2})),e})(),myt=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}launchTutorial(){var n=this;return M(function*(){yield n.router.navigate(["/tutorial/",n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Gn))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),U("pickGame",function(s){return i.pickGame(s)}),P(),S(1,"button",1),U("click",function(){return i.launchTutorial()}),se(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[pR],encapsulation:2})),e})(),_yt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",je({type:r,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(S(0,"p"),se(1,0),P())},encapsulation:2})),e})();var SR,PR,Jd,TR;function Cyt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessQueenComponent.HEPTAGON)}}function yyt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function Myt(r,e){if(1&r&&(A(),F(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function Eyt(r,e){if(1&r&&(Bt(0),A(),F(1,"circle",6)(2,"circle",6)(3,"circle",6),Gt()),2&r){const t=p();_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(3)),_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function Syt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",7)(2,"circle",7)(3,"circle",7),P()),2&r){const t=p();_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.45*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),k("cx",.45*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),k("cx",.55*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function Pyt(r,e){if(1&r&&(A(),S(0,"g",8),F(1,"circle",9)(2,"circle",9)(3,"circle",9),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE-3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE+3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}class Vl{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessQueenComponent",Vl),u(this,"MartianChessComponent",Mo),u(this,"horizontalDotsRadius",Mo.SPACE_SIZE/15)}}function Oyt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessDroneComponent.PENTAGON)}}function byt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function wyt(r,e){if(1&r&&(A(),F(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function Nyt(r,e){if(1&r&&(Bt(0),A(),F(1,"circle",6)(2,"circle",6),Gt()),2&r){const t=p();_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function Ayt(r,e){if(1&r&&(A(),S(0,"g",7),F(1,"circle",8)(2,"circle",8),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),k("cx",.4*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),k("cx",.6*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function Iyt(r,e){if(1&r&&(A(),S(0,"g",7),F(1,"circle",9)(2,"circle",9),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE-2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE+2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}SR=Vl,u(Vl,"HEPTAGON",Mo.getRegularPolygon(7)),u(Vl,"EIGHT_POINTED_STAR",Mo.getNPointedStar(8,0)),u(Vl,"\u0275fac",function(e){return new(e||SR)}),u(Vl,"\u0275cmp",je({type:SR,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,Cyt,1,3,"polygon",0),T(1,yyt,1,3,"polygon",0),T(2,Myt,1,5,"circle",1),T(3,Eyt,4,9,"ng-container",2),T(4,Syt,4,9,"g",2),T(5,Pyt,4,10,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Fl{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",Mo),u(this,"MartianChessDroneComponent",Fl),u(this,"horizontalDotsRadius",Mo.SPACE_SIZE/15)}}function xyt(r,e){if(1&r&&(A(),F(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessPawnComponent.TRIANGLE)}}function Lyt(r,e){if(1&r&&(A(),F(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function Ryt(r,e){if(1&r&&(A(),F(0,"circle",6)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function zyt(r,e){if(1&r&&(A(),F(0,"circle",7)),2&r){const t=p();k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE+t.getConcreteTriangleYOffset())("r",t.MartianChessComponent.getRadius(1))}}function Dyt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p();k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function Hyt(r,e){if(1&r&&(A(),S(0,"g",9),F(1,"circle",10),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}PR=Fl,u(Fl,"FOUR_POINTED_STAR_VERTICAL",Mo.getNPointedStar(4,0)),u(Fl,"PENTAGON",Mo.getRegularPolygon(5)),u(Fl,"\u0275fac",function(e){return new(e||PR)}),u(Fl,"\u0275cmp",je({type:PR,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,Oyt,1,3,"polygon",0),T(1,byt,1,3,"polygon",0),T(2,wyt,1,5,"circle",1),T(3,Nyt,3,6,"ng-container",2),T(4,Ayt,3,7,"g",3),T(5,Iyt,3,7,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Xa{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",Mo),u(this,"MartianChessPawnComponent",Xa),u(this,"horizontalDotsRadius",Mo.SPACE_SIZE/15)}static getTriangle(){return Mo.getRegularPolygon(3,Xa.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const t=Mo.getRegularPolygonCoords(3).map(c=>c.y);return(t.reduce((c,l)=>Math.min(c,l))+(100-t.reduce((c,l)=>Math.max(c,l))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?Xa.TRIANGLE_Y_OFFSET:0}}function Fyt(r,e){if(1&r&&(A(),F(0,"text",8)),2&r){const t=p();Oi("id","height_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("innerHTML",t.coord.z,d7)}}function $yt(r,e){if(1&r&&(A(),F(0,"polyline",9)),2&r){const t=p();y("ngClass",t.pieceClasses),k("points",t.getUpperHorizontalLine())}}function Byt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"polyline",10)(2,"polyline",11),P()),2&r){const t=p();_(1),y("ngClass",t.pieceClasses),k("points",t.getMiddleHorizontalLine()),_(1),y("ngClass",t.pieceClasses),k("points",t.getLowerHorizontalLine())}}function Gyt(r,e){if(1&r&&(A(),F(0,"polyline",12)),2&r){const t=p();y("ngClass",t.pieceClasses),k("points",t.getLeftDiagonalLine())}}function Uyt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"polyline",13)(2,"polyline",14),P()),2&r){const t=p();_(1),y("ngClass",t.pieceClasses),k("points",t.getMiddleDiagonalLine()),_(1),y("ngClass",t.pieceClasses),k("points",t.getRighterDiagonalLine())}}function Wyt(r,e){if(1&r&&(A(),F(0,"polyline",15)),2&r){const t=p();y("ngClass",t.pieceClasses),k("points",t.getLeftVerticalLine())}}function qyt(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p();y("ngClass",t.pieceClasses),k("points",t.getMiddleVerticalLine())}}function jyt(r,e){if(1&r&&(A(),F(0,"polyline",17)),2&r){const t=p();y("ngClass",t.pieceClasses),k("points",t.getRighterVerticalLine())}}Jd=Xa,u(Xa,"FOUR_POINTED_STAR_DIAGONAL",Mo.getNPointedStar(4,45)),u(Xa,"TRIANGLE_Y_OFFSET",Jd.yOffsetForVerticalCentering()),u(Xa,"TRIANGLE",Jd.getTriangle()),u(Xa,"\u0275fac",function(e){return new(e||Jd)}),u(Xa,"\u0275cmp",je({type:Jd,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,xyt,1,3,"polygon",0),T(1,Lyt,1,3,"polygon",0),T(2,Ryt,1,5,"circle",1),T(3,zyt,1,3,"circle",2),T(4,Dyt,1,3,"circle",3),T(5,Hyt,2,4,"g",4)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class eh{constructor(){u(this,"coord",void 0),u(this,"move",void 0),u(this,"pieceClasses",void 0),u(this,"mode",void 0),u(this,"mustDisplayHeight",void 0)}mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(e=>"victory-stroke"===e)||this.pieceClasses.some(e=>"last-move-stroke"===e)}get3DIsoSquarePoints(){const e=this.getParallelogramPoints();return this.mapCoordToPoints([e[0],e[1],e[4],e[6],e[5],e[2],e[0]])}getParallelogramPoints(){const e=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,t=this.mode.parallelogramHeight,n=this.mode.offsetRatio*this.mode.parallelogramHeight,i=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,o=e,a=e-n,c=t,l=-n,f=t;return[new C(0,0),new C(o,0),new C(l,f),new C(a,c),new C(o,0+i),new C(l,f+i),new C(a,c+i)]}mapCoordToPoints(e){return e.map(t=>t.x+" "+t.y).join(" ")}getUpperHorizontalLineCoords(){const e=this.getParallelogramPoints(),t=e[0],n=e[1],o=new St(-1*this.mode.offsetRatio*$n.STROKE_WIDTH,$n.STROKE_WIDTH),s=t.getNext(o),a=n.getNext(o);return[t,n,a,s]}getUpperHorizontalLine(){const e=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(e)}getMiddleHorizontalCoords(){const e=this.getParallelogramPoints(),t=e[2],n=e[3],o=new St(-1*this.mode.offsetRatio*$n.STROKE_WIDTH,$n.STROKE_WIDTH);return[t.getNext(o,-1),n.getNext(o,-1),n,t]}getMiddleHorizontalLine(){const e=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(e)}getLowerHorizontalLine(){const e=this.getParallelogramPoints(),t=e[5],n=e[6],i=new St(0,$n.STROKE_WIDTH),o=t.getNext(i,-1),s=n.getNext(i,-1);return this.mapCoordToPoints([o,s,n,t])}getLeftDiagonalLine(){const e=this.getParallelogramPoints(),t=e[0],n=e[2],o=new St($n.STROKE_WIDTH,0),s=t.getNext(o,1),a=n.getNext(o,1);return this.mapCoordToPoints([t,s,a,n])}getMiddleDiagonalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[3],o=new St($n.STROKE_WIDTH,0),s=t.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,t,n,a])}getRighterDiagonalLine(){const e=this.getParallelogramPoints(),t=e[4],n=e[6],o=new St(0,$n.STROKE_WIDTH),s=t.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,t,n,a])}getLeftVerticalLine(){const e=this.getParallelogramPoints(),t=e[2],n=e[5],o=new St($n.STROKE_WIDTH,0),s=t.getNext(o,1),a=n.getNext(o,1);return this.mapCoordToPoints([t,s,a,n])}getMiddleVerticalLine(){const e=this.getParallelogramPoints(),t=e[3],n=e[6],o=new St($n.STROKE_WIDTH,0),s=t.getNext(o,-1),a=n.getNext(o,-1);return this.mapCoordToPoints([s,t,n,a])}getRighterVerticalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[4],s=new St($n.STROKE_WIDTH,-$n.STROKE_WIDTH/this.mode.offsetRatio),a=t.getNext(s,-1),c=n.getNext(s,-1);return this.mapCoordToPoints([a,t,n,c])}getOtherCoord(){Fe(null!=this.move,"Move should be set before calling getOtherCoord");const e=this.move;return e.getZero().equals(this.coord)?e.getOne():e.getZero()}isLeftHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x-1}}isRightHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x+1}}isTopHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y-1}}isBottomHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y+1}}}TR=eh,u(eh,"STROKE_OFFSET",$n.STROKE_WIDTH/2),u(eh,"\u0275fac",function(e){return new(e||TR)}),u(eh,"\u0275cmp",je({type:TR,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(e,t){1&e&&(A(),F(0,"polyline",0),T(1,Fyt,1,4,"text",1),T(2,$yt,1,2,"polyline",2),T(3,Byt,3,4,"g",3),T(4,Gyt,1,2,"polyline",4),T(5,Uyt,3,4,"g",3),T(6,Wyt,1,2,"polyline",5),T(7,qyt,1,2,"polyline",6),T(8,jyt,1,2,"polyline",7)),2&e&&(Oi("id","tile_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("ngClass",t.pieceClasses),k("points",t.get3DIsoSquarePoints()),_(1),y("ngIf",t.mustDisplayHeight),_(1),y("ngIf",!1===t.isBottomHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isTopHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isRightHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isLeftHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isBottomHalf()||t.isLeftHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isBottomHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isTopHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()))},dependencies:[Ft,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));const th_firebaseConfig={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"};let OR=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"userSubscription",void 0),this.connectedUserService=n}canActivate(){var n=this;return M(function*(){const i=yield new Promise(o=>{n.userSubscription=n.connectedUserService.subscribeToUser(function(){var s=M(function*(a){return o(yield n.evaluateUserPermission(a))});return function(a){return s.apply(this,arguments)}}())});return n.userSubscription.unsubscribe(),i})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(ar))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Lu=(()=>{var r;class e extends OR{static evaluateUserPermission(n,i){return M(function*(){return!1===i.isConnected()?n.parseUrl("/login"):!1!==i.verified||n.parseUrl("/verify-account")})()}constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return e.evaluateUserPermission(i.router,n)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(ar),Pe(Gn))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),bR=(()=>{var r;class e{constructor(n,i){u(this,"currentGameService",void 0),u(this,"router",void 0),u(this,"currentGameSubscription",g.empty()),this.currentGameService=n,this.router=i}canActivate(n){var i=this;return M(function*(){const o=yield i.currentGameService.getCurrentGame();if(o.isAbsent())return!0;const s=o.get();return n.params.id===s.id||i.router.parseUrl("/play/"+s.typeGame+"/"+s.id)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(uo),Pe(Gn))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Zyt=(()=>{var r;class e extends OR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return!1===n.isConnected()?i.router.parseUrl("/login"):!n.verified||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(ar),Pe(Gn))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Yyt=(()=>{var r;class e extends OR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return!1===n.isConnected()||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(ar),Pe(Gn))}),u(e,"\u0275prov",He({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function Kyt(r,e){1&r&&(S(0,"p",20),se(1,21),P())}function Xyt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"p",8),se(2,9),P(),S(3,"div",10)(4,"p",11),se(5,12),P(),S(6,"button",13),U("click",function(){return te(t),ne(p().finalizeEmailVerification())}),se(7,14),P()(),S(8,"div",15)(9,"p",11),se(10,16),P(),S(11,"button",17),U("click",function(){return te(t),ne(p().sendEmailVerification())}),se(12,18),P()(),T(13,Kyt,2,0,"p",19),P()}if(2&r){const t=p();_(2),Bn(t.emailAddress),jn(2),_(11),y("ngIf",t.success)}}function Qyt(r,e){if(1&r){const t=pe();S(0,"div",24)(1,"div",8),se(2,25),P(),S(3,"form",26)(4,"div",27)(5,"div",28),F(6,"input",29),P(),S(7,"div",28)(8,"button",30),U("click",function(){te(t);const i=p(2);return ne(i.pickUsername(i.usernameForm.value))}),se(9,31),P()()()()()}if(2&r){const t=p(2);_(3),y("formGroup",t.usernameForm)}}const Jyt=function(){return["/lobby"]};function eMt(r,e){1&r&&(S(0,"div",32),Ao(1,33),F(2,"a",34),Io(),P()),2&r&&(_(2),y("routerLink",_1(1,Jyt)))}function tMt(r,e){if(1&r&&(Bt(0),T(1,Qyt,10,1,"div",22),T(2,eMt,3,2,"div",23),Gt()),2&r){const t=p();_(1),y("ngIf",!t.success),_(1),y("ngIf",t.success)}}function nMt(r,e){if(1&r&&(S(0,"div",35)(1,"div",36),lt(2),P()()),2&r){const t=p();_(2),An(t.errorMessage)}}let rMt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"verificationType",null),u(this,"success",!1),u(this,"triedToFinalize",!1),u(this,"errorMessage",void 0),u(this,"emailAddress",void 0),u(this,"userSubscription",void 0),u(this,"usernameForm",new z4({username:new rs})),this.connectedUserService=n,this.router=i}ngOnInit(){var n=this;return M(function*(){n.userSubscription=n.connectedUserService.subscribeToUser(function(){var i=M(function*(o){n.emailAddress=o.email.get(),o.username.isAbsent()?n.verificationType="enter-username":(n.verificationType="send-email",!0===n.triedToFinalize&&!1===o.verified&&(n.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===o.verified&&(yield n.router.navigate(["/lobby"])))});return function(o){return i.apply(this,arguments)}}())})()}pickUsername(n){var i=this;return M(function*(){const o=yield i.connectedUserService.setUsername(n.username);o.isSuccess()?i.success=!0:i.errorMessage=o.getReason()})()}sendEmailVerification(){var n=this;return M(function*(){const i=yield n.connectedUserService.sendEmailVerification();i.isSuccess()?n.success=!0:n.errorMessage=i.getReason()})()}finalizeEmailVerification(){var n=this;return M(function*(){n.triedToFinalize=!0,yield n.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(ar),G(Gn))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,n,i,o,s,a,c,l,f,d,m;return t=$localize`Account verification`,n=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,i=$localize`Once you have verified your email, click on the following button:`,o=$localize`Finalize email verification`,s=$localize`If you have not received the verification email, click on the following button:`,a=$localize`Send verification email again`,c=$localize`The email has been sent`,l=$localize`In order to finalize your account, you must choose a username.`,f=$localize`Username`,d=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],n,[1,"block","level-left"],[1,"level-item"],i,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],o,[1,"level-left"],s,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],a,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],l,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",f,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],d,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2),se(3,3),P(),T(4,Xyt,14,2,"div",4),T(5,tMt,3,2,"ng-container",5),P(),T(6,nMt,3,1,"div",6),P()),2&n&&(_(4),y("ngIf","send-email"===i.verificationType),_(1),y("ngIf","enter-username"===i.verificationType),_(1),y("ngIf",i.errorMessage))},dependencies:[Nt,yc,m6,mc,P3,p6,C6,_6,D8],encapsulation:2})),e})();function iMt(r,e){1&r&&(S(0,"p",17),se(1,18),P())}function oMt(r,e){if(1&r&&(S(0,"div",19)(1,"div",20),se(2,21),P(),S(3,"div",22),lt(4),P()()),2&r){const t=p();_(4),An(t.errorMessage.get())}}const sMt=function(){return{standalone:!0}};let aMt=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"success",!1),u(this,"errorMessage",g.empty()),u(this,"email",""),this.connectedUserService=n}resetPassword(){var n=this;return M(function*(){Fe(""!==n.email,"No email was entered, but it should not be possible to submit the form then!"),n.errorMessage=g.empty(),n.success=!1;const i=yield n.connectedUserService.sendPasswordResetEmail(n.email);i.isSuccess()?n.success=!0:n.errorMessage=g.of(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(ar))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-reset-password"]],decls:17,vars:6,consts:function(){let t,n,i,o,s,a,c;return t=$localize`Password reset`,n=$localize`Email`,i=$localize`Email`,o=$localize`An email will be sent with instruction to reset your password.`,s=$localize`Reset password`,a=$localize`The email has been sent, please follow the instructions from that email.`,c=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],o,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],s,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],a,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],c,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),se(2,2),P(),S(3,"div",3)(4,"div",4)(5,"label",5),se(6,6),P()(),S(7,"div",7)(8,"div",8)(9,"div",9)(10,"input",10),U("ngModelChange",function(s){return i.email=s}),P(),S(11,"p",11),se(12,12),P(),T(13,iMt,2,0,"p",13),P()()()(),S(14,"button",14),U("click",function(){return i.resetPassword()}),se(15,15),P(),T(16,oMt,5,1,"div",16),P()),2&n&&(_(10),y("ngModel",i.email)("ngModelOptions",_1(5,sMt)),_(3),y("ngIf",i.success),_(1),y("disabled",""===i.email),_(2),y("ngIf",i.errorMessage.isPresent()))},dependencies:[Nt,mc,P3,C6,Q7,gR],encapsulation:2})),e})();function cMt(r,e){if(1&r&&(S(0,"option",13),lt(1),P()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentTheme),_(1),P2(" ",t.name," ")}}function lMt(r,e){if(1&r&&(S(0,"option",13),lt(1),P()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentLanguage),_(1),P2(" ",t.name," ")}}let uMt=(()=>{var r;class e{constructor(n,i){u(this,"userSettingsService",void 0),u(this,"availableLanguages",[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}]),u(this,"availableThemes",[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}]),u(this,"currentTheme",void 0),u(this,"currentLanguage",void 0),this.userSettingsService=n,this.currentTheme=i.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(n){this.userSettingsService.changeLanguage(n.target.value),this.reload()}changeTheme(n){this.userSettingsService.changeTheme(n.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G($ee),G(_v))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`Theme`,i=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],n,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],i,["id","language",3,"change"],[3,"value","selected"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),se(2,2),P(),S(3,"div",3)(4,"label",4),se(5,5),P(),S(6,"div",6)(7,"div",7)(8,"select",8),U("change",function(s){return i.changeTheme(s)}),T(9,cMt,2,3,"option",9),P()()()(),S(10,"div",3)(11,"label",10),se(12,11),P(),S(13,"div",6)(14,"div",7)(15,"select",12),U("change",function(s){return i.changeLanguage(s)}),T(16,lMt,2,3,"option",9),P()()()()()),2&n&&(_(9),y("ngForOf",i.availableThemes),_(7),y("ngForOf",i.availableLanguages))},dependencies:[Wt,J7,ef],encapsulation:2})),e})(),fMt=(()=>{var r;class e{constructor(n,i,o,s,a,c){u(this,"route",void 0),u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"gameService",void 0),this.route=n,this.router=i,this.connectedUserService=o,this.currentGameService=s,this.messageDisplayer=a,this.gameService=c}ngOnInit(){var n=this;return M(function*(){yield n.createGameAndRedirectOrShowError(n.extractGameFromURL())})()}extractGameFromURL(){return q.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(n){var i=this;return M(function*(){if(Fe(i.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===i.gameExists(n))return yield i.router.navigate(["/notFound",R0.NO_MATCHING_GAME(n)],{skipLocationChange:!0}),!1;const s=i.currentGameService.canUserCreate();if(s.isSuccess()){const a=yield i.gameService.createPartConfigRoomAndChat(n);return yield i.router.navigate(["/play",n,a]),!0}return i.messageDisplayer.infoMessage(s.getReason()),yield i.router.navigate(["/lobby"]),!1})()}gameExists(n){return g.ofNullable(Nu.ALL_GAMES().find(o=>o.urlName===n)).isPresent()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(xo),G(Gn),G(ar),G(uo),G(Ut),G(Z5))}),u(e,"\u0275cmp",je({type:r,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(S(0,"p"),se(1,0),P())},encapsulation:2})),e})();!function ehe(r,e,t){(function Bue(r,e,t){"string"!=typeof e&&(t=e,e=r[w1.LocaleId]),e=e.toLowerCase().replace(/_/g,"-"),A8[e]=r,t&&(A8[e][w1.ExtraData]=t)})(r,e,t)}(Aye);const dMt=[{path:"login",component:W_t},{path:"lobby",component:mR,canActivate:[Lu]},{path:"account",component:uvt,canActivate:[Lu]},{path:"settings",component:uMt},{path:"register",component:pyt,canActivate:[Yyt]},{path:"reset-password",component:aMt},{path:"notFound/:message",component:W3e},{path:"nextGameLoading",component:_yt,canActivate:[Lu]},{path:"verify-account",component:rMt,canActivate:[Zyt]},{path:"play",component:U3e,canActivate:[Lu,bR]},{path:"play/:compo",component:fMt,canActivate:[Lu,bR]},{path:"play/:compo/:id",component:CR,canActivate:[Lu,bR]},{path:"local",component:gyt},{path:"local/:compo",component:MR},{path:"tutorial",component:myt},{path:"tutorial/:compo",component:ER},{path:"",component:x_t},{path:"demo",component:$_t},{path:"**",component:W3e}];class wR{static app(){return function TAe(r,...e){return{ngModule:PAe,providers:[{provide:mA,useFactory:SAe(r),multi:!0,deps:[o1,J2,pA,...e]}]}}(()=>OAe(th_firebaseConfig))}static firestore(){return function bLe(r,...e){return{ngModule:OLe,providers:[{provide:Uk,useFactory:SLe(r),multi:!0,deps:[o1,J2,pA,gA,[new to,JJ],[new to,DA],...e]}]}}(()=>{const e=LLe();e.toJSON();return e})}static auth(){return function fLe(r,...e){return{ngModule:uLe,providers:[{provide:Gk,useFactory:aLe(r),multi:!0,deps:[o1,J2,pA,gA,[new to,DA],...e]}]}}(()=>{const e=pLe();return e})}}let hMt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275mod",yi({type:r,bootstrap:[u7t]})),u(e,"\u0275inj",Y2({providers:[ar,Z5,Zk,sd,q5,W5,_v,{provide:pc,useValue:ad.getLocale()}],imports:[wR.app(),wR.firestore(),wR.auth(),oG,rme,Ove.forRoot(dMt,{useHash:!1}),kge,Ige,wye,OWe]})),e})();wy(Mo,function(){return[Ft,Wt,Nt,Vl,Fl,Xa]},[]),wy($n,function(){return[Ft,Wt,Nt,eh]},[]);var pMt=Ss(522);function Y3e(){Epe().bootstrapModule(hMt).catch(r=>console.error(r))}const K3e=ad.getLocale();"en"!==K3e?fetch("/assets/"+K3e+".json").then(r=>r.ok?r.json():{locale:"en",translations:{}}).then(r=>{(0,pMt.XJ)(r.translations),$localize.locale=r.locale,Y3e()}).catch(function(r){console.log(r)}):Y3e()},1:function(Ru,V0){!function(Ss){"use strict";function En(ht,ot){var zt=Object.keys(ht);if(Object.getOwnPropertySymbols){var Ln=Object.getOwnPropertySymbols(ht);ot&&(Ln=Ln.filter(function(Ar){return Object.getOwnPropertyDescriptor(ht,Ar).enumerable})),zt.push.apply(zt,Ln)}return zt}function Ps(ht){for(var ot,zt=1;zt<arguments.length;zt++)ot=null==arguments[zt]?{}:arguments[zt],zt%2?En(Object(ot),!0).forEach(function(Ln){Gl(ht,Ln,ot[Ln])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ht,Object.getOwnPropertyDescriptors(ot)):En(Object(ot)).forEach(function(Ln){Object.defineProperty(ht,Ln,Object.getOwnPropertyDescriptor(ot,Ln))});return ht}function n3(ht,ot){if(!(ht instanceof ot))throw new TypeError("Cannot call a class as a function")}function r3(ht,ot){for(var zt,Ln=0;Ln<ot.length;Ln++)(zt=ot[Ln]).enumerable=zt.enumerable||!1,zt.configurable=!0,"value"in zt&&(zt.writable=!0),Object.defineProperty(ht,zt.key,zt)}function Sn(ht,ot,zt){return ot&&r3(ht.prototype,ot),zt&&r3(ht,zt),ht}function Gl(ht,ot,zt){return ot in ht?Object.defineProperty(ht,ot,{value:zt,enumerable:!0,configurable:!0,writable:!0}):ht[ot]=zt,ht}function i3(){var ht;return null!==(ht=F0)&&void 0!==ht?ht:document}var Ul={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},Eo=Ps({},Ul),Ts={},F0=null,zu=function(ht,ot,zt,Ln,Ar){return"top-left"===ht?"left:".concat(Ln,";top:").concat(ot,";text-align:left;align-items:flex-start;"):"top-right"===ht?"right:".concat(Ar,";top:").concat(ot,";text-align:right;align-items:flex-end;"):"top-center"===ht?"top:".concat(ot,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===ht?"left:".concat(Ln,";bottom:").concat(zt,";text-align:left;align-items:flex-start;"):"bottom-right"===ht?"right:".concat(Ar,";bottom:").concat(zt,";text-align:right;align-items:flex-end;"):"bottom-center"===ht?"bottom:".concat(zt,";left:0;right:0;text-align:center;align-items:center;"):"center"===ht?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},Wl=function(){function ht(ot){var zt=this;n3(this,ht),this.element=i3().createElement("div"),this.opacity=ot.opacity,this.type=ot.type,this.animate=ot.animate,this.dismissible=ot.dismissible,this.closeOnClick=ot.closeOnClick,this.message=ot.message,this.duration=ot.duration,this.pauseOnHover=ot.pauseOnHover,this.offsetTop=ot.offsetTop,this.offsetBottom=ot.offsetBottom,this.offsetLeft=ot.offsetLeft,this.offsetRight=ot.offsetRight,this.extraClasses=ot.extraClasses;var Ln="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),Ar=["notification",this.extraClasses];if(this.type&&Ar.push(this.type),this.animate&&this.animate.in){var s3="animate__".concat(this.animate.in),Ci=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";Ar.push("animate__animated ".concat(s3," ").concat(Ci)),this.onAnimationEnd(function(){return zt.element.classList.remove(s3)})}if(this.element.className=Ar.join(" "),this.dismissible){var j2=i3().createElement("button");j2.className="delete",j2.addEventListener("click",function(){zt.destroy()}),this.element.insertAdjacentElement("afterbegin",j2)}else Ln+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){zt.destroy()}),this.element.setAttribute("style",Ln),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var ql=new aa(function(){zt.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){ql.pause()}),this.element.addEventListener("mouseout",function(){ql.resume()}))}return Sn(ht,[{key:"destroy",value:function(){var ot=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){ot.removeParent(ot.element.parentNode),ot.element.remove(),delete Ts.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete Ts.position)}},{key:"removeParent",value:function(ot){ot&&1>=ot.children.length&&ot.remove()}},{key:"onAnimationEnd",value:function(){var ot=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},zt={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var Ln in zt)if(void 0!==this.element.style[Ln]){this.element.addEventListener(zt[Ln],function(){return ot()});break}}}]),ht}(),aa=function(){function ht(ot,zt){n3(this,ht),this.remaining=zt,this.callback=ot,this.resume()}return Sn(ht,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),ht}();Ss.resetDefaults=function(){Eo=Ps({},Ul)},Ss.setDefaults=function(ht){Eo=Ps(Ps({},Ul),ht)},Ss.setDoc=function Qa(ht){for(var ot in Ts)Ts[ot].remove();Ts={},F0=ht},Ss.toast=function y4(ht){if(!ht.message)throw new Error("message is required");var ot=Ps(Ps({},Eo),ht),zt=new Wl(ot),Ln=function o3(ht,ot,zt,Ln,Ar,s3){if(Ts.position)return Ts.position;var Ci=i3().createElement("div");return Ci.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+zu(ot,zt,Ln,Ar,s3)),ht.appendChild(Ci),Ts.position=Ci,Ci}(ot.appendTo||i3().body,ot.position||Eo.position,ot.offsetTop||Eo.offsetTop,ot.offsetBottom||Eo.offsetBottom,ot.offsetLeft||Eo.offsetLeft,ot.offsetRight||Eo.offsetRight);if(ot.single)for(var Ar=Ln.lastElementChild;Ar;)Ln.removeChild(Ar),Ar=Ln.lastElementChild;Ln.appendChild(zt.element)},Object.defineProperty(Ss,"__esModule",{value:!0})}(V0)},522:(Ru,V0,Ss)=>{"use strict";Ss.d(V0,{XJ:()=>Fu,pQ:()=>Bu});const En=":",Ps="|",n3="@@",r3="\u241f";class Sn{static zero(){return new Sn([0])}static one(){return new Sn([1])}constructor(re){this.digits=re}clone(){return new Sn(this.digits.slice())}add(re){const me=this.clone();return me.addToSelf(re),me}addToSelf(re){const me=Math.max(this.digits.length,re.digits.length);let Se=0;for(let Ke=0;Ke<me;Ke++){let st=Se;Ke<this.digits.length&&(st+=this.digits[Ke]),Ke<re.digits.length&&(st+=re.digits[Ke]),st>=10?(this.digits[Ke]=st-10,Se=1):(this.digits[Ke]=st,Se=0)}Se>0&&(this.digits[me]=1)}toString(){let re="";for(let me=this.digits.length-1;me>=0;me--)re+=this.digits[me];return re}}class Gl{constructor(re){this.powerOfTwos=[re]}getValue(){return this.powerOfTwos[0]}multiplyBy(re){const me=Sn.zero();return this.multiplyByAndAddTo(re,me),me}multiplyByAndAddTo(re,me){for(let Se=0;0!==re;re>>>=1,Se++)if(1&re){const Ke=this.getMultipliedByPowerOfTwo(Se);me.addToSelf(Ke)}}getMultipliedByPowerOfTwo(re){for(let me=this.powerOfTwos.length;me<=re;me++){const Se=this.powerOfTwos[me-1];this.powerOfTwos[me]=Se.add(Se)}return this.powerOfTwos[re]}}class i3{constructor(re){this.base=re,this.exponents=[new Gl(Sn.one())]}toThePowerOf(re){for(let me=this.exponents.length;me<=re;me++){const Se=this.exponents[me-1].multiplyBy(this.base);this.exponents[me]=new Gl(Se)}return this.exponents[re]}}let o3;function zt(ae){o3??=new TextEncoder;const re=o3.encode(ae),me=new DataView(re.buffer,re.byteOffset,re.byteLength);let Se=Ar(me,re.length,0),Ke=Ar(me,re.length,102072);return 0==Se&&(0==Ke||1==Ke)&&(Se^=319790063,Ke^=-1801410264),[Se,Ke]}function Ar(ae,re,me){let Se=2654435769,Ke=2654435769,st=0;const n2=re-12;for(;st<=n2;st+=12){Se+=ae.getUint32(st,!0),Ke+=ae.getUint32(st+4,!0);const e1=s3(Se,Ke,me+=ae.getUint32(st+8,!0));Se=e1[0],Ke=e1[1],me=e1[2]}const Jn=re-st;return me+=re,Jn>=4?(Se+=ae.getUint32(st,!0),st+=4,Jn>=8?(Ke+=ae.getUint32(st,!0),st+=4,Jn>=9&&(me+=ae.getUint8(st++)<<8),Jn>=10&&(me+=ae.getUint8(st++)<<16),11===Jn&&(me+=ae.getUint8(st++)<<24)):(Jn>=5&&(Ke+=ae.getUint8(st++)),Jn>=6&&(Ke+=ae.getUint8(st++)<<8),7===Jn&&(Ke+=ae.getUint8(st++)<<16))):(Jn>=1&&(Se+=ae.getUint8(st++)),Jn>=2&&(Se+=ae.getUint8(st++)<<8),3===Jn&&(Se+=ae.getUint8(st++)<<16)),s3(Se,Ke,me)[2]}function s3(ae,re,me){return ae-=re,ae-=me,re-=me,re-=ae^=me>>>13,me-=ae,me-=re^=ae<<8,ae-=re,ae-=me^=re>>>13,re-=me,re-=ae^=me>>>12,me-=ae,me-=re^=ae<<16,ae-=re,ae-=me^=re>>>5,re-=me,re-=ae^=me>>>3,me-=ae,me-=re^=ae<<10,[ae,re,me^=re>>>15]}function j2(ae,re){return ql(ae,re)[1]}function ql(ae,re){const me=(65535&ae)+(65535&re),Se=(ae>>>16)+(re>>>16)+(me>>>16);return[Se>>>16,Se<<16|65535&me]}const T1=new i3(256);function ny(ae,re,me,Se,Ke=[]){const st={},n2={},Jn={},e1=function ry(ae,re){const{text:me,block:Se}=So(ae,re);if(void 0===Se)return{text:me};{const[Ke,...st]=Se.split(r3),[n2,Jn]=Ke.split(n3,2);let[e1,E2]=n2.split(Ps,2);return void 0===E2&&(E2=e1,e1=void 0),""===E2&&(E2=void 0),{text:me,meaning:e1,description:E2,customId:Jn,legacyIds:st}}}(ae[0],ae.raw[0]),E2=[e1.text],M4=[];let jl=e1.text;for(let qo=1;qo<ae.length;qo++){const{messagePart:Zl,placeholderName:Zr=ah(qo),associatedMessageId:Yl}=iy(ae[qo],ae.raw[qo]);jl+=`{$${Zr}}${Zl}`,void 0!==re&&(st[Zr]=re[qo-1],n2[Zr]=Ke[qo-1]),M4.push(Zr),void 0!==Yl&&(Jn[Zr]=Yl),E2.push(Zl)}const Wo=e1.customId||function Ln(ae,re=""){let me=zt(ae);if(re){const st=zt(re);me=function Du(ae,re){const me=ae[0],Ke=re[0],n2=ql(ae[1],re[1]),Jn=n2[0],e1=n2[1];return[j2(j2(me,Ke),Jn),e1]}(function Vu(ae,re){const me=ae[0],Se=ae[1];return[me<<re|Se>>>32-re,Se<<re|me>>>32-re]}(me,1),st)}return function sh(ae,re){const me=T1.toThePowerOf(0).multiplyBy(re);return T1.toThePowerOf(4).multiplyByAndAddTo(ae,me),me.toString()}(2147483647&me[0],me[1])}(jl,e1.meaning||""),B0=e1.legacyIds?e1.legacyIds.filter(qo=>qo!==Wo):[];return{id:Wo,legacyIds:B0,substitutions:st,substitutionLocations:n2,text:jl,customId:e1.customId,meaning:e1.meaning||"",description:e1.description||"",messageParts:E2,messagePartLocations:Se,placeholderNames:M4,associatedMessageIds:Jn,location:me}}function iy(ae,re){const{text:me,block:Se}=So(ae,re);if(void 0===Se)return{messagePart:me};{const[Ke,st]=Se.split(n3);return{messagePart:me,placeholderName:Ke,associatedMessageId:st}}}function So(ae,re){if(re.charAt(0)!==En)return{text:ae};{const me=Yi(ae,re);return{block:ae.substring(1,me),text:ae.substring(me+1)}}}function ah(ae){return 1===ae?"PH":"PH_"+(ae-1)}function Yi(ae,re){for(let me=1,Se=1;me<ae.length;me++,Se++)if("\\"===re[Se])Se++;else if(ae[me]===En)return me;throw new Error(`Unterminated $localize metadata block in "${re}".`)}class ch extends Error{constructor(re){super(`No translation found for ${lh(re)}.`),this.parsedMessage=re,this.type="MissingTranslationError"}}function $0(ae,re){return Object.defineProperty(ae,"raw",{value:re}),ae}function lh(ae){const re=ae.meaning&&` - "${ae.meaning}"`,me=ae.legacyIds&&ae.legacyIds.length>0?` [${ae.legacyIds.map(Se=>`"${Se}"`).join(", ")}]`:"";return`"${ae.id}"${me} ("${ae.text}"${re})`}function Fu(ae){$localize.translate||($localize.translate=sy),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(ae).forEach(re=>{$localize.TRANSLATIONS[re]=function oy(ae){const re=ae.split(/{\$([^}]*)}/),me=[re[0]],Se=[];for(let st=1;st<re.length-1;st+=2)Se.push(re[st]),me.push(`${re[st+1]}`);const Ke=me.map(st=>st.charAt(0)===En?"\\"+st:st);return{text:ae,messageParts:$0(me,Ke),placeholderNames:Se}}(ae[re])})}function sy(ae,re){try{return function pr(ae,re,me){const Se=ny(re,me);let Ke=ae[Se.id];if(void 0!==Se.legacyIds)for(let st=0;st<Se.legacyIds.length&&void 0===Ke;st++)Ke=ae[Se.legacyIds[st]];if(void 0===Ke)throw new ch(Se);return[Ke.messageParts,Ke.placeholderNames.map(st=>{if(Se.substitutions.hasOwnProperty(st))return Se.substitutions[st];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${lh(Se)}.\nThe translation contains a placeholder with name ${st}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,ae,re)}catch(me){return console.warn(me.message),[ae,re]}}const Bu=function(ae,...re){if(Bu.translate){const Se=Bu.translate(ae,re);ae=Se[0],re=Se[1]}let me=ay(ae[0],ae.raw[0]);for(let Se=1;Se<ae.length;Se++)me+=re[Se-1]+ay(ae[Se],ae.raw[Se]);return me},AR=":";function ay(ae,re){return re.charAt(0)===AR?ae.substring(Yi(ae,re)+1):ae}}},Ru=>{Ru(Ru.s=4590)}]);