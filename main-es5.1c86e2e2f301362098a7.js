!function(){var e,t,n,r,i,a,o,s,u,c,l,h,f,d,v,p,g,y,m,k,_,w,C,b,E,S,P,O,T,I,x,A,R,N,M,D,L,F,B,U,V,z,H,G,q,$,W,j,Z,Y,K,J,Q,X,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,he,fe,de,ve,pe,ge,ye,me,ke,_e,we,Ce,be,Ee,Se,Pe,Oe,Te,Ie,xe,Ae,Re,Ne,Me,De,Le,Fe,Be,Ue,Ve,ze,He,Ge,qe,$e,We,je,Ze,Ye,Ke,Je,Qe,Xe,et,tt,nt,rt,it,at,ot,st,ut,ct,lt,ht,ft,dt,vt,pt,gt,yt,mt,kt,_t,wt,Ct,bt,Et,St,Pt,Ot,Tt,It,xt,At,Rt,Nt,Mt,Dt,Lt,Ft,Bt,Ut,Vt,zt,Ht,Gt,qt,$t,Wt,jt,Zt,Yt,Kt,Jt,Qt,Xt,en,tn,nn,rn,an,on,sn,un,cn,ln,hn,fn,dn,vn,pn,gn,yn,mn,kn,_n,wn,Cn,bn,En,Sn,Pn,On,Tn,In,xn,An,Rn,Nn,Mn,Dn,Ln,Fn,Bn,Un,Vn,zn,Hn,Gn,qn,$n,Wn,jn,Zn,Yn,Kn,Jn,Qn,Xn,er,tr,nr,rr,ir,ar,or,sr,ur,cr,lr,hr,fr,dr,vr,pr,gr,yr,mr,kr,_r,wr,Cr,br,Er,Sr,Pr,Or,Tr,Ir,xr,Ar,Rr,Nr,Mr,Dr,Lr,Fr,Br,Ur,Vr,zr,Hr,Gr,qr,$r,Wr,jr,Zr,Yr,Kr,Jr,Qr,Xr,ei,ti,ni,ri,ii,ai,oi,si,ui,ci,li,hi,fi,di,vi,pi,gi,yi,mi,ki,_i,wi,Ci,bi,Ei,Si,Pi,Oi,Ti,Ii,xi,Ai,Ri,Ni,Mi,Di,Li,Fi,Bi,Ui,Vi,zi,Hi,Gi,qi,$i,Wi,ji,Zi,Yi,Ki,Ji,Qi,Xi,ea,ta,na,ra,ia,aa,oa,sa,ua,ca,la,ha,fa,da,va,pa,ga,ya,ma,ka,_a,wa,Ca,ba,Ea,Sa,Pa,Oa,Ta,Ia,xa,Aa,Ra,Na,Ma,Da,La,Fa,Ba,Ua,Va,za,Ha,Ga,qa,$a,Wa,ja,Za,Ya,Ka,Ja,Qa,Xa,eo,to,no,ro,io,ao,oo,so,uo,co,lo,ho,fo,vo,po,go,yo,mo,ko,_o,wo,Co,bo,Eo,So,Po,Oo,To,Io,xo,Ao,Ro,No,Mo,Do,Lo,Fo,Bo,Uo,Vo,zo,Ho,Go,qo,$o,Wo,jo,Zo,Yo,Ko,Jo,Qo,Xo,es,ts,ns,rs,is,as,os,ss,us,cs,ls,hs,fs,ds,vs,ps,gs,ys,ms,ks,_s,ws,Cs,bs,Es,Ss,Ps,Os,Ts,Is,xs,As,Rs,Ns,Ms,Ds,Ls,Fs,Bs,Us,Vs,zs,Hs,Gs,qs,$s,Ws,js,Zs,Ys,Ks,Js,Qs,Xs,eu,tu,nu,ru,iu,au,ou,su,uu,cu,lu,hu,fu,du,vu,pu,gu,yu,mu,ku,_u,wu,Cu,bu,Eu,Su,Pu,Ou,Tu,Iu,xu,Au,Ru,Nu,Mu,Du,Lu,Fu,Bu,Uu,Vu,zu,Hu,Gu,qu,$u,Wu,ju,Zu,Yu,Ku,Ju,Qu,Xu,ec,tc,nc,rc,ic,ac,oc,sc,uc,cc,lc,hc,fc,dc,vc,pc,gc,yc,mc,kc,_c,wc,Cc,bc,Ec,Sc,Pc,Oc,Tc,Ic,xc,Ac,Rc,Nc,Mc,Dc,Lc,Fc,Bc,Uc,Vc,zc,Hc,Gc,qc,$c,Wc,jc,Zc,Yc,Kc,Jc,Qc,Xc,el,tl,nl,rl,il,al,ol,sl,ul,cl,ll,hl,fl,dl,vl,pl,gl,yl,ml,kl,_l,wl,Cl,bl,El,Sl,Pl,Ol,Tl,Il,xl,Al,Rl,Nl,Ml,Dl,Ll,Fl,Bl,Ul,Vl,zl,Hl,Gl,ql,$l,Wl,jl,Zl,Yl,Kl,Jl,Ql,Xl,eh,th,nh,rh,ih,ah,oh,sh,uh,ch,lh,hh,fh,dh,vh,ph,gh,yh,mh,kh,_h,wh,Ch,bh,Eh,Sh,Ph,Oh,Th,Ih,xh,Ah,Rh,Nh,Mh,Dh,Lh,Fh,Bh,Uh,Vh,zh,Hh,Gh,qh,$h,Wh,jh,Zh,Yh,Kh,Jh,Qh,Xh,ef,tf,nf,rf,af,of,sf,uf,cf,lf,hf,ff,df,vf,pf,gf,yf,mf,kf,_f,wf,Cf,bf,Ef,Sf,Pf,Of,Tf,If,xf,Af,Rf,Nf,Mf,Df,Lf,Ff,Bf,Uf,Vf,zf,Hf,Gf,qf,$f,Wf,jf,Zf,Yf,Kf,Jf,Qf,Xf,ed,td,nd,rd,id,ad,od,sd,ud,cd,ld,hd,fd,dd,vd,pd,gd,yd,md,kd,_d,wd,Cd,bd,Ed,Sd,Pd,Od,Td,Id,xd,Ad,Rd,Nd,Md,Dd,Ld,Fd,Bd,Ud,Vd,zd,Hd,Gd,qd,$d,Wd,jd,Zd,Yd,Kd,Jd,Qd,Xd,ev,tv,nv,rv,iv,av,ov,sv,uv,cv,lv,hv,fv,dv,vv,pv,gv,yv,mv,kv,_v,wv,Cv,bv,Ev,Sv,Pv,Ov,Tv,Iv,xv,Av,Rv,Nv,Mv,Dv,Lv;function Fv(e){return qv(e)||rp(e)||ap(e)||Gv()}function Bv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Uv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bv(Object(n),!0).forEach(function(t){zv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Vv(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function zv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hv(e,t){return qv(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||ap(e,t)||Gv()}function Gv(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qv(e){if(Array.isArray(e))return e}function $v(e){var t="function"==typeof Map?new Map:void 0;return($v=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Wv(e,arguments,tp(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Kv(r,e)})(e)}function Wv(e,t,n){return(Wv=ep()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Kv(i,n.prototype),i}).apply(null,arguments)}function jv(){return(jv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Zv(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function Zv(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tp(e)););return e}function Yv(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kv(e,t)}function Kv(e,t){return(Kv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jv(e){var t=ep();return function(){var n,r=tp(e);if(t){var i=tp(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Qv(this,n)}}function Qv(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Xv(e)}function Xv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ep(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function tp(e){return(tp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function np(e){return function(e){if(Array.isArray(e))return op(e)}(e)||rp(e)||ap(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rp(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ip(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ap(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ap(e,t){if(e){if("string"==typeof e)return op(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?op(e,t):void 0}}function op(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function up(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cp(e,t,n){return t&&up(e.prototype,t),n&&up(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,a;!function(o){if("object"==typeof e.exports){var s=o(0,t);void 0!==s&&(e.exports=s)}else i=[n,t],void 0!==(a="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=a)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++){var i;n=null!==(i=arguments[r])&&void 0!==i?i:{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e;return null!==(e=h)&&void 0!==e?e:document}var u={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},u),l={},h=null,f=function(){function e(t){var n=this;r(this,e),this.element=s().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),a=["notification",this.extraClasses];if(this.type&&a.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),u=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";a.push("animate__animated ".concat(o," ").concat(u)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=a.join(" "),this.dismissible){var c=s().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var l=new d(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){l.pause()}),this.element.addEventListener("mouseout",function(){l.resume()}))}return a(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete l.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete l.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),d=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return a(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},u)},e.setDefaults=function(e){c=n(n({},u),e)},e.setDoc=function(e){for(var t in l)l[t].remove();l={},h=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new f(t),i=function(e,t,n,r,i,a){if(l.position)return l.position;var o=s().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,a)),e.appendChild(o),l.position=o,o}(t.appendTo||s().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var a=i.lastElementChild;a;)i.removeChild(a),a=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},6676:function(e,t){!function(e){"use strict";function t(e){return Array.prototype.slice.call(e)}function n(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function r(e,t,r){var i,a=new Promise(function(a,o){n(i=e[t].apply(e,r)).then(a,o)});return a.request=i,a}function i(e,t,n){var i=r(e,t,n);return i.then(function(e){if(e)return new l(e,i.request)})}function a(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function o(e,t,n,i){i.forEach(function(i){i in n.prototype&&(e.prototype[i]=function(){return r(this[t],i,arguments)})})}function s(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})})}function u(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return i(this[t],r,arguments)})})}function c(e){this._index=e}function l(e,t){this._cursor=e,this._request=t}function h(e){this._store=e}function f(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function d(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new f(n)}function v(e){this._db=e}a(c,"_index",["name","keyPath","multiEntry","unique"]),o(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),a(l,"_cursor",["direction","key","primaryKey","value"]),o(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(e){e in IDBCursor.prototype&&(l.prototype[e]=function(){var t=this,r=arguments;return Promise.resolve().then(function(){return t._cursor[e].apply(t._cursor,r),n(t._request).then(function(e){if(e)return new l(e,t._request)})})})}),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},a(h,"_store",["name","keyPath","indexNames","autoIncrement"]),o(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(h,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},a(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},a(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["deleteObjectStore","close"]),v.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},a(v,"_db",["name","version","objectStoreNames"]),s(v,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[h,c].forEach(function(n){e in n.prototype&&(n.prototype[e.replace("open","iterate")]=function(){var n=t(arguments),r=n[n.length-1],i=this._store||this._index,a=i[e].apply(i,n.slice(0,-1));a.onsuccess=function(){r(a.result)}})})}),[c,h].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise(function(i){n.iterateCursor(e,function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)})})})}),e.openDb=function(e,t,n){var i=r(indexedDB,"open",[e,t]),a=i.request;return a&&(a.onupgradeneeded=function(e){n&&n(new d(a.result,e.oldVersion,a.transaction))}),i.then(function(e){return new v(e)})},e.deleteDb=function(e){return r(indexedDB,"deleteDatabase",[e])},Object.defineProperty(e,"__esModule",{value:!0})}(t)},7701:function(Bv,Gv,qv){"use strict";var Zv,Kv;function ep(e){return"function"==typeof e}function rp(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ap=rp(function(e){return function(t){e(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t}});function op(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var up,lp=function(){function e(t){sp(this,e),this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return cp(e,[{key:"unsubscribe",value:function(){var e;if(!this.closed){this.closed=!0;var t=this._parentage;if(t)if(this._parentage=null,Array.isArray(t)){var n,r=ip(t);try{for(r.s();!(n=r.n()).done;){var i;n.value.remove(this)}}catch(h){r.e(h)}finally{r.f()}}else t.remove(this);var a=this.initialTeardown;if(ep(a))try{a()}catch(i){e=i instanceof ap?i.errors:[i]}var o=this._teardowns;if(o){this._teardowns=null;var s,u=ip(o);try{for(u.s();!(s=u.n()).done;){var c=s.value;try{dp(c)}catch(f){var l;e=null!==(l=e)&&void 0!==l?l:[],f instanceof ap?e=[].concat(np(e),np(f.errors)):e.push(f)}}}catch(h){u.e(h)}finally{u.f()}}if(e)throw new ap(e)}}},{key:"add",value:function(t){var n;if(t&&t!==this)if(this.closed)dp(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}},{key:"_hasParent",value:function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)}},{key:"_addParent",value:function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}},{key:"_removeParent",value:function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&op(t,e)}},{key:"remove",value:function(t){var n=this._teardowns;n&&op(n,t),t instanceof e&&t._removeParent(this)}}]),e}();lp.EMPTY=((up=new lp).closed=!0,up);var hp=lp.EMPTY;function fp(e){return e instanceof lp||e&&"closed"in e&&ep(e.remove)&&ep(e.add)&&ep(e.unsubscribe)}function dp(e){ep(e)?e():e.unsubscribe()}var vp=null,pp=null,gp=void 0,yp=!1,mp=!1,kp={setTimeout:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=kp.delegate;return((null==e?void 0:e.setTimeout)||setTimeout).apply(void 0,arguments)}),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=kp.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)}),delegate:void 0};function _p(e){kp.setTimeout(function(){if(!vp)throw e;vp(e)})}function wp(){}var Cp=bp("C",void 0,void 0);function bp(e,t,n){return{kind:e,value:t,error:n}}var Ep=null;function Sp(e){if(yp){var t=!Ep;if(t&&(Ep={errorThrown:!1,error:null}),e(),t){var n=Ep,r=n.errorThrown,i=n.error;if(Ep=null,r)throw i}}else e()}var Pp=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).isStopped=!1,e?(r.destination=e,fp(e)&&e.add(Xv(r))):r.destination=Ap,r}return cp(n,[{key:"next",value:function(e){this.isStopped?xp(bp("N",e,void 0),this):this._next(e)}},{key:"error",value:function(e){this.isStopped?xp(bp("E",void 0,e),this):(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped?xp(Cp,this):(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,jv(tp(n.prototype),"unsubscribe",this).call(this),this.destination=null)}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){try{this.destination.error(e)}finally{this.unsubscribe()}}},{key:"_complete",value:function(){try{this.destination.complete()}finally{this.unsubscribe()}}}],[{key:"create",value:function(e,t,n){return new Op(e,t,n)}}]),n}(lp),Op=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a,o,s;if(sp(this,n),o=t.call(this),ep(e))s=e;else if(e){var u,c;s=(u=e).next,r=u.error,i=u.complete,Xv(o)&&mp?(c=Object.create(e)).unsubscribe=function(){return o.unsubscribe()}:c=e,s=null==s?void 0:s.bind(c),r=null==r?void 0:r.bind(c),i=null==i?void 0:i.bind(c)}return o.destination={next:s?Tp(s):wp,error:Tp(null!==(a=r)&&void 0!==a?a:Ip),complete:i?Tp(i):wp},Qv(o)}return cp(n)}(Pp);function Tp(e,t){return function(){try{e.apply(void 0,arguments)}catch(t){yp?function(e){yp&&Ep&&(Ep.errorThrown=!0,Ep.error=e)}(t):_p(t)}}}function Ip(e){throw e}function xp(e,t){var n=pp;n&&kp.setTimeout(function(){return n(e,t)})}var Ap={closed:!0,next:wp,error:Ip,complete:wp},Rp="function"==typeof Symbol&&Symbol.observable||"@@observable";function Np(e){return e}var Mp=function(){var e=function(){function e(t){sp(this,e),t&&(this._subscribe=t)}return cp(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this,i=function(e){return e&&e instanceof Pp||function(e){return e&&ep(e.next)&&ep(e.error)&&ep(e.complete)}(e)&&fp(e)}(e)?e:new Op(e,t,n);return Sp(function(){var e=r.operator,t=r.source;i.add(e?e.call(i,t):t?r._subscribe(i):r._trySubscribe(i))}),i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){e.error(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=Dp(t))(function(t,r){var i=new Op({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})}},{key:"_subscribe",value:function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}},{key:Rp,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return 0===e.length?Np:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=Dp(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),e}();return e.create=function(t){return new e(t)},e}();function Dp(e){var t;return null!==(t=null!=e?e:gp)&&void 0!==t?t:Promise}var Lp=rp(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Fp=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.call(this)).closed=!1,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return cp(n,[{key:"lift",value:function(e){var t=new Bp(this,this);return t.operator=e,t}},{key:"_throwIfClosed",value:function(){if(this.closed)throw new Lp}},{key:"next",value:function(e){var t=this;Sp(function(){if(t._throwIfClosed(),!t.isStopped){var n,r=ip(t.observers.slice());try{for(r.s();!(n=r.n()).done;){n.value.next(e)}}catch(i){r.e(i)}finally{r.f()}}})}},{key:"error",value:function(e){var t=this;Sp(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})}},{key:"complete",value:function(){var e=this;Sp(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})}},{key:"unsubscribe",value:function(){this.isStopped=this.closed=!0,this.observers=null}},{key:"observed",get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}},{key:"_trySubscribe",value:function(e){return this._throwIfClosed(),jv(tp(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}},{key:"_innerSubscribe",value:function(e){var t=this.hasError,n=this.isStopped,r=this.observers;return t||n?hp:(r.push(e),new lp(function(){return op(r,e)}))}},{key:"_checkFinalizedStatuses",value:function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()}},{key:"asObservable",value:function(){var e=new Mp;return e.source=this,e}}]),n}(Mp);return e.create=function(e,t){return new Bp(e,t)},e}(),Bp=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).destination=e,i.source=r,i}return cp(n,[{key:"next",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}},{key:"error",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}},{key:"complete",value:function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}},{key:"_subscribe",value:function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:hp}}]),n}(Fp);function Up(e){return ep(null==e?void 0:e.lift)}function Vp(e){return function(t){if(Up(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var zp=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o){var s,u,c,l;return sp(this,n),(l=t.call(this,e)).onFinalize=o,l._next=r?function(t){try{r(t)}catch(n){e.error(n)}}:jv((s=Xv(l),tp(n.prototype)),"_next",s),l._error=a?function(t){try{a(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:jv((u=Xv(l),tp(n.prototype)),"_error",u),l._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:jv((c=Xv(l),tp(n.prototype)),"_complete",c),l}return cp(n,[{key:"unsubscribe",value:function(){var e,t=this.closed;jv(tp(n.prototype),"unsubscribe",this).call(this),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}]),n}(Pp);function Hp(e,t){return Vp(function(n,r){var i=0;n.subscribe(new zp(r,function(n){r.next(e.call(t,n,i++))}))})}function Gp(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function qp(e){return this instanceof qp?(this.v=e,this):new qp(e)}function $p(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof qp?Promise.resolve(e.value.v).then(u,c):l(a[0][2],e)}(i[e](t))}catch(n){l(a[0][3],n)}}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function Wp(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}var jp=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Zp(e){return ep(null==e?void 0:e.then)}function Yp(e){return ep(e[Rp])}function Kp(e){return Symbol.asyncIterator&&ep(null==e?void 0:e[Symbol.asyncIterator])}function Jp(e){return new TypeError("You provided ".concat(null!==e&&"object"==typeof e?"an invalid object":"'".concat(e,"'")," where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable."))}var Qp="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Xp(e){return ep(null==e?void 0:e[Qp])}function eg(e){return $p(this,arguments,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getReader(),t.prev=1;case 2:return t.next=4,qp(n.read());case 4:if(r=t.sent,i=r.value,!r.done){t.next=11;break}return t.next=10,qp(void 0);case 10:return t.abrupt("return",t.sent);case 11:return t.next=13,qp(i);case 13:return t.next=15,t.sent;case 15:t.next=2;break;case 17:return t.prev=17,n.releaseLock(),t.finish(17);case 20:case"end":return t.stop()}},t,null,[[1,,17,20]])}))}function tg(e){return ep(null==e?void 0:e.getReader)}function ng(e){if(e instanceof Mp)return e;if(null!=e){if(Yp(e))return function(e){return new Mp(function(t){var n=e[Rp]();if(ep(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(jp(e))return function(e){return new Mp(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(Zp(e))return function(e){return new Mp(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,_p)})}(e);if(Kp(e))return rg(e);if(Xp(e))return function(e){return new Mp(function(t){var n,r=ip(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.next(i),t.closed)return}}catch(a){r.e(a)}finally{r.f()}t.complete()})}(e);if(tg(e))return function(e){return rg(eg(e))}(e)}throw Jp(e)}function rg(e){return new Mp(function(t){(function(e,t){var n,r,i,a;return function(e,t,n,r){return new(n||(n=Promise))(function(t,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function o(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,o)}s((r=r.apply(e,[])).next())})}(this,0,void 0,regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,n=Wp(e);case 2:return o.next=4,n.next();case 4:if((r=o.sent).done){o.next=9;break}if(t.next(r.value),!t.closed){o.next=7;break}return o.abrupt("return");case 7:o.next=2;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),i={error:o.t0};case 14:if(o.prev=14,o.prev=15,o.t1=r&&!r.done&&(a=n.return),!o.t1){o.next=20;break}return o.next=20,a.call(n);case 20:if(o.prev=20,!i){o.next=23;break}throw i.error;case 23:return o.finish(20);case 24:return o.finish(14);case 25:t.complete();case 26:case"end":return o.stop()}},o,null,[[0,11,14,25],[15,,20,24]])}))})(e,t).catch(function(e){return t.error(e)})})}function ig(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function ag(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return ep(t)?ag(function(n,r){return Hp(function(e,i){return t(n,e,r,i)})(ng(e(n,r)))},n):("number"==typeof t&&(n=t),Vp(function(t,r){return function(e,t,n,r,i,a,o,s){var u=[],c=0,l=0,h=!1,f=function(){h&&!u.length&&!c&&t.complete()},d=function e(i){c++;var a=!1;ng(n(i,l++)).subscribe(new zp(t,function(e){t.next(e)},function(){a=!0},void 0,function(){if(a)try{for(c--;u.length&&c<r;){var n=u.shift();e(n)}f()}catch(n){t.error(n)}}))};return e.subscribe(new zp(t,function(e){return c<r?d(e):u.push(e)},function(){h=!0,f()})),function(){}}(t,r,e,n)}))}function og(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return ag(Np,e)}var sg=new Mp(function(e){return e.complete()});function ug(e){return e[e.length-1]}function cg(e){return ep(ug(e))?e.pop():void 0}function lg(e){return function(e){return e&&ep(e.schedule)}(ug(e))?e.pop():void 0}function hg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Vp(function(n,r){n.subscribe(new zp(r,function(n){return ig(r,e,function(){return r.next(n)},t)},function(){return ig(r,e,function(){return r.complete()},t)},function(n){return ig(r,e,function(){return r.error(n)},t)}))})}function fg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Vp(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function dg(e,t){if(!e)throw new Error("Iterable cannot be null");return new Mp(function(n){ig(n,t,function(){var r=e[Symbol.asyncIterator]();ig(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function vg(e,t){return t?function(e,t){if(null!=e){if(Yp(e))return function(e,t){return ng(e).pipe(fg(t),hg(t))}(e,t);if(jp(e))return function(e,t){return new Mp(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(Zp(e))return function(e,t){return ng(e).pipe(fg(t),hg(t))}(e,t);if(Kp(e))return dg(e,t);if(Xp(e))return function(e,t){return new Mp(function(n){var r;return ig(n,t,function(){r=e[Qp](),ig(n,t,function(){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(a){return void n.error(a)}t?n.complete():n.next(e)},0,!0)}),function(){return ep(null==r?void 0:r.return)&&r.return()}})}(e,t);if(tg(e))return function(e,t){return dg(eg(e),t)}(e,t)}throw Jp(e)}(e,t):ng(e)}function pg(e){return e<=0?function(){return sg}:Vp(function(t,n){var r=0;t.subscribe(new zp(n,function(t){++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function gg(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return!0===t?(e(),null):!1===t?null:t.apply(void 0,r).pipe(pg(1)).subscribe(function(){return e()})}function yg(e){for(var t in e)if(e[t]===yg)return t;throw Error("Could not find renamed property on target object.")}function mg(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function kg(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(kg).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function _g(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var wg=yg({__forward_ref__:yg});function Cg(e){return e.__forward_ref__=Cg,e.toString=function(){return kg(this())},e}function bg(e){return Eg(e)?e():e}function Eg(e){return"function"==typeof e&&e.hasOwnProperty(wg)&&e.__forward_ref__===Cg}var Sg=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,r))).code=e,i}return cp(n)}($v(Error));function Pg(e){return"string"==typeof e?e:null==e?"":String(e)}function Og(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Pg(e)}function Tg(e,t){var n=t?" in ".concat(t):"";throw new Sg("201","No provider for ".concat(Og(e)," found").concat(n))}function Ig(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat(e)+(null==r?"":" [Expected=> ".concat(n," ").concat(r," ").concat(t," <=Actual]")))}function xg(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Ag(e){return{providers:e.providers||[],imports:e.imports||[]}}function Rg(e){return Ng(e,Lg)||Ng(e,Bg)}function Ng(e,t){return e.hasOwnProperty(t)?e[t]:null}function Mg(e){return e&&(e.hasOwnProperty(Fg)||e.hasOwnProperty(Ug))?e[Fg]:null}var Dg,Lg=yg({"\u0275prov":yg}),Fg=yg({"\u0275inj":yg}),Bg=yg({ngInjectableDef:yg}),Ug=yg({ngInjectorDef:yg}),Vg=((Vg=Vg||{})[Vg.Default=0]="Default",Vg[Vg.Host=1]="Host",Vg[Vg.Self=2]="Self",Vg[Vg.SkipSelf=4]="SkipSelf",Vg[Vg.Optional=8]="Optional",Vg);function zg(e){var t=Dg;return Dg=e,t}function Hg(e,t,n){var r=Rg(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Vg.Optional?null:void 0!==t?t:void Tg(kg(e),"Injector")}function Gg(e){return{toString:e}.toString()}var qg=((qg=qg||{})[qg.OnPush=0]="OnPush",qg[qg.Default=1]="Default",qg),$g=(($g=$g||{})[$g.Emulated=0]="Emulated",$g[$g.None=2]="None",$g[$g.ShadowDom=3]="ShadowDom",$g),Wg="undefined"!=typeof globalThis&&globalThis,jg="undefined"!=typeof window&&window,Zg="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Yg=Wg||"undefined"!=typeof global&&global||jg||Zg,Kg={},Jg=[],Qg=yg({"\u0275cmp":yg}),Xg=yg({"\u0275dir":yg}),ey=yg({"\u0275pipe":yg}),ty=yg({"\u0275mod":yg}),ny=yg({"\u0275loc":yg}),ry=yg({"\u0275fac":yg}),iy=yg({__NG_ELEMENT_ID__:yg}),ay=0;function oy(e){return Gg(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===qg.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Jg,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||$g.Emulated,id:"c",styles:e.styles||Jg,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,a=e.pipes;return n.id+=ay++,n.inputs=hy(e.inputs,t),n.outputs=hy(e.outputs),i&&i.forEach(function(e){return e(n)}),n.directiveDefs=r?function(){return("function"==typeof r?r():r).map(sy)}:null,n.pipeDefs=a?function(){return("function"==typeof a?a():a).map(uy)}:null,n})}function sy(e){return vy(e)||function(e){return e[Xg]||null}(e)}function uy(e){return function(e){return e[ey]||null}(e)}var cy={};function ly(e){return Gg(function(){var t={type:e.type,bootstrap:e.bootstrap||Jg,declarations:e.declarations||Jg,imports:e.imports||Jg,exports:e.exports||Jg,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(cy[e.id]=e.type),t})}function hy(e,t){if(null==e)return Kg;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=i;Array.isArray(i)&&(a=i[1],i=i[0]),n[i]=r,t&&(t[i]=a)}return n}var fy=oy;function dy(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function vy(e){return e[Qg]||null}function py(e,t){var n=e[ty]||null;if(!n&&!0===t)throw new Error("Type ".concat(kg(e)," does not have '\u0275mod' property."));return n}function gy(e){return Array.isArray(e)&&"object"==typeof e[1]}function yy(e){return Array.isArray(e)&&!0===e[1]}function my(e){return 0!=(8&e.flags)}function ky(e){return 2==(2&e.flags)}function _y(e){return 1==(1&e.flags)}function wy(e){return null!==e.template}function Cy(e){return 0!=(512&e[2])}function by(e,t){return e.hasOwnProperty(ry)?e[ry]:null}var Ey=function(){function e(t,n,r){sp(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return cp(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function Sy(){return Py}function Py(e){return e.type.prototype.ngOnChanges&&(e.setInput=Ty),Oy}function Oy(){var e=xy(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===Kg)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function Ty(e,t,n,r){var i=xy(e)||function(e,t){return e[Iy]=t}(e,{previous:Kg,current:null}),a=i.current||(i.current={}),o=i.previous,s=this.declaredInputs[n],u=o[s];a[s]=new Ey(u&&u.currentValue,t,o===Kg),e[r]=t}Sy.ngInherit=!0;var Iy="__ngSimpleChanges__";function xy(e){return e[Iy]||null}var Ay,Ry="http://www.w3.org/2000/svg";function Ny(){return void 0!==Ay?Ay:"undefined"!=typeof document?document:void 0}function My(e){return!!e.listen}var Dy={createRenderer:function(e,t){return Ny()}};function Ly(e){for(;Array.isArray(e);)e=e[0];return e}function Fy(e,t){return Ly(t[e])}function By(e,t){return Ly(t[e.index])}function Uy(e,t){return e.data[t]}function Vy(e,t){return e[t]}function zy(e,t){var n=t[e];return gy(n)?n:n[0]}function Hy(e){return 4==(4&e[2])}function Gy(e){return 128==(128&e[2])}function qy(e,t){return null==t?null:e[t]}function $y(e){e[18]=0}function Wy(e,t){e[5]+=t;for(var n=e,r=e[3];null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}var jy={lFrame:km(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Zy(){return jy.bindingsEnabled}function Yy(){return jy.lFrame.lView}function Ky(){return jy.lFrame.tView}function Jy(e){return jy.lFrame.contextLView=e,e[8]}function Qy(){for(var e=Xy();null!==e&&64===e.type;)e=e.parent;return e}function Xy(){return jy.lFrame.currentTNode}function em(){var e=jy.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function tm(e,t){var n=jy.lFrame;n.currentTNode=e,n.isParent=t}function nm(){return jy.lFrame.isParent}function rm(){jy.lFrame.isParent=!1}function im(){return jy.isInCheckNoChangesMode}function am(e){jy.isInCheckNoChangesMode=e}function om(){var e=jy.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function sm(){return jy.lFrame.bindingIndex}function um(){return jy.lFrame.bindingIndex++}function cm(e){var t=jy.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function lm(e){jy.lFrame.inI18n=e}function hm(e,t){var n=jy.lFrame;n.bindingIndex=n.bindingRootIndex=e,fm(t)}function fm(e){jy.lFrame.currentDirectiveIndex=e}function dm(){return jy.lFrame.currentQueryIndex}function vm(e){jy.lFrame.currentQueryIndex=e}function pm(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function gm(e,t,n){if(n&Vg.SkipSelf){for(var r=t,i=e;!(null!==(r=r.parent)||n&Vg.Host||(r=pm(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}var a=jy.lFrame=mm();return a.currentTNode=t,a.lView=e,!0}function ym(e){var t=mm(),n=e[1];jy.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function mm(){var e=jy.lFrame,t=null===e?null:e.child;return null===t?km(e):t}function km(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function _m(){var e=jy.lFrame;return jy.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var wm=_m;function Cm(){var e=_m();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function bm(){return jy.lFrame.selectedIndex}function Em(e){jy.lFrame.selectedIndex=e}function Sm(){var e=jy.lFrame;return Uy(e.tView,e.selectedIndex)}function Pm(){jy.lFrame.currentNamespace=Ry}function Om(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n].type.prototype,a=i.ngAfterContentInit,o=i.ngAfterContentChecked,s=i.ngAfterViewInit,u=i.ngAfterViewChecked,c=i.ngOnDestroy;a&&(e.contentHooks||(e.contentHooks=[])).push(-n,a),o&&((e.contentHooks||(e.contentHooks=[])).push(n,o),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function Tm(e,t,n){Am(e,t,3,n)}function Im(e,t,n,r){(3&e[2])===n&&Am(e,t,n,r)}function xm(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function Am(e,t,n,r){for(var i=null!=r?r:-1,a=t.length-1,o=0,s=void 0!==r?65535&e[18]:0;s<a;s++)if("number"==typeof t[s+1]){if(o=t[s],null!=r&&o>=r)break}else t[s]<0&&(e[18]+=65536),(o<i||-1==i)&&(Rm(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function Rm(e,t,n,r){var i=n[r]<0,a=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(o)}finally{}}}else try{a.call(o)}finally{}}var Nm=cp(function e(t,n,r){sp(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r});function Mm(e,t,n){for(var r=My(e),i=0;i<n.length;){var a=n[i];if("number"==typeof a){if(0!==a)break;i++;var o=n[i++],s=n[i++],u=n[i++];r?e.setAttribute(t,s,u,o):t.setAttributeNS(o,s,u)}else{var c=a,l=n[++i];Lm(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),i++}}return i}function Dm(e){return 3===e||4===e||6===e}function Lm(e){return 64===e.charCodeAt(0)}function Fm(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||Bm(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function Bm(e,t,n,r,i){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var u=e[a];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(e[a+1]=i));if(r===e[a+1])return void(e[a+2]=i)}a++,null!==r&&a++,null!==i&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==r&&e.splice(a++,0,r),null!==i&&e.splice(a++,0,i)}function Um(e){return-1!==e}function Vm(e){return 32767&e}function zm(e,t){for(var n=function(e){return e>>16}(e),r=t;n>0;)r=r[15],n--;return r}var Hm=!0;function Gm(e){var t=Hm;return Hm=e,t}var qm=0;function $m(e,t){var n=jm(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,Wm(r.data,e),Wm(t,null),Wm(r.blueprint,null));var i=Zm(e,t),a=e.injectorIndex;if(Um(i))for(var o=Vm(i),s=zm(i,t),u=s[1].data,c=0;c<8;c++)t[a+c]=s[o+c]|u[o+c];return t[a+8]=i,a}function Wm(e,t){e.push(0,0,0,0,0,0,0,0,t)}function jm(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Zm(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,r=null,i=t;null!==i;){var a=i[1],o=a.type;if(null===(r=2===o?a.declTNode:1===o?i[6]:null))return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function Ym(e,t,n){!function(e,t,n){var r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(iy)&&(r=n[iy]),null==r&&(r=n[iy]=qm++);var i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function Km(e,t,n){if(n&Vg.Optional)return e;Tg(t,"NodeInjector")}function Jm(e,t,n,r){if(n&Vg.Optional&&void 0===r&&(r=null),0==(n&(Vg.Self|Vg.Host))){var i=e[9],a=zg(void 0);try{return i?i.get(t,r,n&Vg.Optional):Hg(t,r,n&Vg.Optional)}finally{zg(a)}}return Km(r,t,n)}function Qm(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Vg.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(iy)?e[iy]:void 0;return"number"==typeof t?t>=0?255&t:ek:t}(n);if("function"==typeof a){if(!gm(t,e,r))return r&Vg.Host?Km(i,n,r):Jm(t,n,r,i);try{var o=a(r);if(null!=o||r&Vg.Optional)return o;Tg(n)}finally{wm()}}else if("number"==typeof a){var s=null,u=jm(e,t),c=-1,l=r&Vg.Host?t[16][6]:null;for((-1===u||r&Vg.SkipSelf)&&(-1!==(c=-1===u?Zm(e,t):t[u+8])&&ak(r,!1)?(s=t[1],u=Vm(c),t=zm(c,t)):u=-1);-1!==u;){var h=t[1];if(ik(a,u,h.data)){var f=tk(u,t,n,s,r,l);if(f!==Xm)return f}-1!==(c=t[u+8])&&ak(r,t[1].data[u+8]===l)&&ik(a,u,t)?(s=h,u=Vm(c),t=zm(c,t)):u=-1}}}return Jm(t,n,r,i)}var Xm={};function ek(){return new ok(Qy(),Yy())}function tk(e,t,n,r,i,a){var o=t[1],s=o.data[e+8],u=nk(s,o,n,null==r?ky(s)&&Hm:r!=o&&0!=(3&s.type),i&Vg.Host&&a===s);return null!==u?rk(t,o,u,s):Xm}function nk(e,t,n,r,i){for(var a=e.providerIndexes,o=t.data,s=1048575&a,u=e.directiveStart,c=a>>20,l=i?s+c:e.directiveEnd,h=r?s:s+c;h<l;h++){var f=o[h];if(h<u&&n===f||h>=u&&f.type===n)return h}if(i){var d=o[u];if(d&&wy(d)&&d.type===n)return u}return null}function rk(e,t,n,r){var i=e[n],a=t.data;if(function(e){return e instanceof Nm}(i)){var o=i;o.resolving&&function(e,t){throw new Sg("200","Circular dependency in DI detected for ".concat(e))}(Og(a[n]));var s=Gm(o.canSeeViewProviders);o.resolving=!0;var u=o.injectImpl?zg(o.injectImpl):null;gm(e,r,Vg.Default);try{i=e[n]=o.factory(void 0,a,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.type.prototype,i=r.ngOnChanges,a=r.ngOnInit,o=r.ngDoCheck;if(i){var s=Py(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,a[n],t)}finally{null!==u&&zg(u),Gm(s),o.resolving=!1,wm()}}return i}function ik(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function ak(e,t){return!(e&Vg.Self||e&Vg.Host&&t)}var ok=function(){function e(t,n){sp(this,e),this._tNode=t,this._lView=n}return cp(e,[{key:"get",value:function(e,t,n){return Qm(this._tNode,this._lView,e,n,t)}}]),e}();function sk(e){return Gg(function(){for(var t=e.prototype.constructor,n=t[ry]||uk(t),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;i&&i!==r;){var a=i[ry]||uk(i);if(a&&a!==n)return a;i=Object.getPrototypeOf(i)}return function(e){return new e}})}function uk(e){return Eg(e)?function(){var t=uk(bg(e));return t&&t()}:by(e)}function ck(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var r=n.length,i=0;i<r;){var a=n[i];if(Dm(a))break;if(0===a)i+=2;else if("number"==typeof a)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(a===t)return n[i+1];i+=2}}return null}(Qy(),e)}var lk="__parameters__";function hk(e,t,n){return Gg(function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var a=Wv(i,t);return o.annotation=a,o;function o(e,t,n){for(var r=e.hasOwnProperty(lk)?e[lk]:Object.defineProperty(e,lk,{value:[]})[lk];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(a),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var fk=function(){function e(t,n){sp(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=xg({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return cp(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),dk=new fk("AnalyzeForEntryComponents"),vk=Function;function pk(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),pk(r,t)):t!==e&&t.push(r)}return t}function gk(e,t){e.forEach(function(e){return Array.isArray(e)?gk(e,t):t(e)})}function yk(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function mk(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function kk(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function _k(e,t,n){var r=Ck(e,t);return r>=0?e[1|r]=n:function(e,t,n,r){var i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r=~r,t,n),r}function wk(e,t){var n=Ck(e,t);if(n>=0)return e[1|n]}function Ck(e,t){return function(e,t,n){for(var r=0,i=e.length>>1;i!==r;){var a=r+(i-r>>1),o=e[a<<1];if(t===o)return a<<1;o>t?i=a:r=a+1}return~(i<<1)}(e,t)}var bk,Ek={},Sk="__NG_DI_FLAG__",Pk="ngTempTokenPath",Ok=/\n/gm,Tk="__source",Ik=yg({provide:String,useValue:yg});function xk(e){var t=bk;return bk=e,t}function Ak(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vg.Default;if(void 0===bk)throw new Error("inject() must be called from an injection context");return null===bk?Hg(e,void 0,t):bk.get(e,t&Vg.Optional?null:void 0,t)}function Rk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vg.Default;return(Dg||Ak)(bg(e),t)}function Nk(e){for(var t=[],n=0;n<e.length;n++){var r=bg(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,a=Vg.Default,o=0;o<r.length;o++){var s=r[o],u=Dk(s);"number"==typeof u?-1===u?i=s.token:a|=u:i=s}t.push(Rk(i,a))}else t.push(Rk(r))}return t}function Mk(e,t){return e[Sk]=t,e.prototype[Sk]=t,e}function Dk(e){return e[Sk]}function Lk(e,t,n,r){var i=e[Pk];throw t[Tk]&&i.unshift(t[Tk]),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=kg(t);if(Array.isArray(t))i=t.map(kg).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):kg(s)))}i="{".concat(a.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(Ok,"\n  "))}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[Pk]=null,e}var Fk,Bk,Uk=Mk(hk("Inject",function(e){return{token:e}}),-1),Vk=Mk(hk("Optional"),8),zk=Mk(hk("SkipSelf"),4);function Hk(e){var t;return(null===(t=function(){if(void 0===Fk&&(Fk=null,Yg.trustedTypes))try{Fk=Yg.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Fk}())||void 0===t?void 0:t.createHTML(e))||e}function Gk(e){var t;return(null===(t=function(){if(void 0===Bk&&(Bk=null,Yg.trustedTypes))try{Bk=Yg.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Bk}())||void 0===t?void 0:t.createHTML(e))||e}var qk=function(){function e(t){sp(this,e),this.changingThisBreaksApplicationSecurity=t}return cp(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),$k=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(qk),Wk=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(qk),jk=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(qk),Zk=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(qk),Yk=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(qk);function Kk(e){return e instanceof qk?e.changingThisBreaksApplicationSecurity:e}function Jk(e,t){var n=Qk(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function Qk(e){return e instanceof qk&&e.getTypeName()||null}function Xk(e){var t=new t_(e);return function(){try{return!!(new window.DOMParser).parseFromString(Hk(""),"text/html")}catch(e){return!1}}()?new e_(t):t}var e_=function(){function e(t){sp(this,e),this.inertDocumentHelper=t}return cp(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(Hk(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),t_=function(){function e(t){if(sp(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var r=this.inertDocument.createElement("body");n.appendChild(r)}}return cp(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Hk(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=Hk(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;("xmlns:ns1"===r||0===r.indexOf("ns1:"))&&e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),n_=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,r_=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function i_(e){return(e=String(e)).match(n_)||e.match(r_)?e:"unsafe:"+e}function a_(e){return(e=String(e)).split(",").map(function(e){return i_(e.trim())}).join(", ")}function o_(e){var t,n={},r=ip(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function s_(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var u_,c_=o_("area,br,col,hr,img,wbr"),l_=o_("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),h_=o_("rp,rt"),f_=s_(c_,s_(l_,o_("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),s_(h_,o_("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),s_(h_,l_)),d_=o_("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),v_=o_("srcset"),p_=s_(d_,v_,o_("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),o_("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),g_=o_("script,style,template"),y_=function(){function e(){sp(this,e),this.sanitizedSomething=!1,this.buf=[]}return cp(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!f_.hasOwnProperty(t))return this.sanitizedSomething=!0,!g_.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n=e.attributes,r=0;r<n.length;r++){var i=n.item(r),a=i.name,o=a.toLowerCase();if(p_.hasOwnProperty(o)){var s=i.value;d_[o]&&(s=i_(s)),v_[o]&&(s=a_(s)),this.buf.push(" ",a,'="',__(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();f_.hasOwnProperty(t)&&!c_.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(__(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),m_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,k_=/([^\#-~ |!])/g;function __(e){return e.replace(/&/g,"&amp;").replace(m_,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(k_,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function w_(e,t){var n=null;try{u_=u_||Xk(e);var r=t?String(t):"";n=u_.getInertBodyElement(r);var i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=u_.getInertBodyElement(r)}while(r!==a);return Hk((new y_).sanitizeChildren(C_(n)||n))}finally{if(n)for(var o=C_(n)||n;o.firstChild;)o.removeChild(o.firstChild)}}function C_(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var b_=((b_=b_||{})[b_.NONE=0]="NONE",b_[b_.HTML=1]="HTML",b_[b_.STYLE=2]="STYLE",b_[b_.SCRIPT=3]="SCRIPT",b_[b_.URL=4]="URL",b_[b_.RESOURCE_URL=5]="RESOURCE_URL",b_);function E_(e){var t=P_();return t?Gk(t.sanitize(b_.HTML,e)||""):Jk(e,"HTML")?Gk(Kk(e)):w_(Ny(),Pg(e))}function S_(e){var t=P_();return t?t.sanitize(b_.URL,e)||"":Jk(e,"URL")?Kk(e):i_(Pg(e))}function P_(){var e=Yy();return e&&e[12]}var O_="__ngContext__";function T_(e,t){e[O_]=t}function I_(e){var t=function(e){return e[O_]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function x_(e){return e.ngOriginalError}function A_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var R_=function(){function e(){sp(this,e),this._console=console}return cp(e,[{key:"handleError",value:function(e){var t,n=this._findOriginalError(e),r=this._findContext(e),i=(t=e)&&t.ngErrorLogger||A_;i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}},{key:"_findContext",value:function(e){return e?function(e){return e.ngDebugContext}(e)||this._findContext(x_(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=e&&x_(e);t&&x_(t);)t=x_(t);return t||null}}]),e}(),N_=/^>|^->|<!--|-->|--!>|<!-$/g,M_=/(<|>)/,D_=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Yg);function L_(e){return e instanceof Function?e():e}var F_,B_=((B_=B_||{})[B_.Important=1]="Important",B_[B_.DashCase=2]="DashCase",B_);function U_(e,t){return F_(e,t)}function V_(e){var t=e[3];return yy(t)?t[3]:t}function z_(e){return G_(e[13])}function H_(e){return G_(e[4])}function G_(e){for(;null!==e&&!yy(e);)e=e[4];return e}function q_(e,t,n,r,i){if(null!=r){var a,o=!1;yy(r)?a=r:gy(r)&&(o=!0,r=r[0]);var s=Ly(r);0===e&&null!==n?null==i?nw(t,n,s):tw(t,n,s,i||null,!0):1===e&&null!==n?tw(t,n,s,i||null,!0):2===e?vw(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,r,i){var a=n[7];a!==Ly(n)&&q_(t,e,r,a,i);for(var o=10;o<n.length;o++){var s=n[o];gw(s[1],s,e,t,r,a)}}(t,e,a,n,i)}}function $_(e,t){return My(e)?e.createText(t):e.createTextNode(t)}function W_(e,t,n){My(e)?e.setValue(t,n):t.textContent=n}function j_(e,t){return e.createComment(function(e){return e.replace(N_,function(e){return e.replace(M_,"\u200b$1\u200b")})}(t))}function Z_(e,t,n){return My(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function Y_(e,t){var n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,Wy(i,-1)),n.splice(r,1)}function K_(e,t){if(!(e.length<=10)){var n=10+t,r=e[n];if(r){var i=r[17];null!==i&&i!==e&&Y_(i,r),t>0&&(e[n-1][4]=r[4]);var a=mk(e,10+t);!function(e,t){gw(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);var o=a[19];null!==o&&o.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function J_(e,t){if(!(256&t[2])){var n=t[11];My(n)&&n.destroyNode&&gw(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return Q_(e[1],e);for(;t;){var n=null;if(gy(t))n=t[13];else{var r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)gy(t)&&Q_(t[1],t),t=t[3];null===t&&(t=e),gy(t)&&Q_(t[1],t),n=t&&t[4]}t=n}}(t)}}function Q_(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];if(!(i instanceof Nm)){var a=n[r+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2){var s=i[a[o]],u=a[o+1];try{u.call(s)}finally{}}else try{a.call(i)}finally{}}}}(e,t),function(e,t){var n=e.cleanup,r=t[7],i=-1;if(null!==n)for(var a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var o=n[a+1],s="function"==typeof o?o(t):Ly(t[o]),u=r[i=n[a+2]],c=n[a+3];"boolean"==typeof c?s.removeEventListener(n[a],u,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),a+=2}else{var l=r[i=n[a+1]];n[a].call(l)}if(null!==r){for(var h=i+1;h<r.length;h++)r[h]();t[7]=null}}(e,t),1===t[1].type&&My(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&yy(t[3])){n!==t[3]&&Y_(n,t);var r=t[19];null!==r&&r.detachView(e)}}}function X_(e,t,n){return ew(e,t.parent,n)}function ew(e,t,n){for(var r=t;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){var i=e.data[r.directiveStart].encapsulation;if(i===$g.None||i===$g.Emulated)return null}return By(r,n)}function tw(e,t,n,r,i){My(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function nw(e,t,n){My(e)?e.appendChild(t,n):t.appendChild(n)}function rw(e,t,n,r,i){null!==r?tw(e,t,n,r,i):nw(e,t,n)}function iw(e,t){return My(e)?e.parentNode(t):t.parentNode}function aw(e,t,n){return uw(e,t,n)}function ow(e,t,n){return 40&e.type?By(e,n):null}var sw,uw=ow;function cw(e,t){uw=e,sw=t}function lw(e,t,n,r){var i=X_(e,r,t),a=t[11],o=aw(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(var s=0;s<n.length;s++)rw(a,i,n[s],o,!1);else rw(a,i,n,o,!1);void 0!==sw&&sw(a,r,t,n,i)}function hw(e,t){if(null!==t){var n=t.type;if(3&n)return By(t,e);if(4&n)return dw(-1,e[t.index]);if(8&n){var r=t.child;if(null!==r)return hw(e,r);var i=e[t.index];return yy(i)?dw(-1,i):Ly(i)}if(32&n)return U_(t,e)()||Ly(e[t.index]);var a=fw(e,t);return null!==a?Array.isArray(a)?a[0]:hw(V_(e[16]),a):hw(e,t.next)}return null}function fw(e,t){return null!==t?e[16][6].projection[t.projection]:null}function dw(e,t){var n=10+e+1;if(n<t.length){var r=t[n],i=r[1].firstChild;if(null!==i)return hw(r,i)}return t[7]}function vw(e,t,n){var r=iw(e,t);r&&function(e,t,n,r){My(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function pw(e,t,n,r,i,a,o){for(;null!=n;){var s=r[n.index],u=n.type;if(o&&0===t&&(s&&T_(Ly(s),r),n.flags|=4),64!=(64&n.flags))if(8&u)pw(e,t,n.child,r,i,a,!1),q_(t,e,i,s,a);else if(32&u){for(var c=U_(n,r),l=void 0;l=c();)q_(t,e,i,l,a);q_(t,e,i,s,a)}else 16&u?yw(e,t,r,n,i,a):q_(t,e,i,s,a);n=o?n.projectionNext:n.next}}function gw(e,t,n,r,i,a){pw(n,r,e.firstChild,t,i,a,!1)}function yw(e,t,n,r,i,a){var o=n[16],s=o[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)q_(t,e,i,s[u],a);else pw(e,t,s,o[3],i,a,!0)}function mw(e,t,n){My(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function kw(e,t,n){My(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function _w(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var a=t.length;if(i+a===r||e.charCodeAt(i+a)<=32)return i}n=i+1}}var ww="ng-template";function Cw(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==_w((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function bw(e){return 4===e.type&&e.value!==ww}function Ew(e,t,n){return t===(4!==e.type||n?e.value:ww)}function Sw(e,t,n){for(var r=4,i=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(Dm(e[t]))return t;return e.length}(i),o=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!Ew(e,u,n)||""===u&&1===t.length){if(Pw(r))return!1;o=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!Cw(e.attrs,c,n)){if(Pw(r))return!1;o=!0}continue}var l=Ow(8&r?"class":u,i,bw(e),n);if(-1===l){if(Pw(r))return!1;o=!0;continue}if(""!==c){var h;h=l>a?"":i[l+1].toLowerCase();var f=8&r?h:null;if(f&&-1!==_w(f,c,0)||2&r&&c!==h){if(Pw(r))return!1;o=!0}}}}else{if(!o&&!Pw(r)&&!Pw(u))return!1;if(o&&Pw(u))continue;o=!1,r=u|1&r}}return Pw(r)||o}function Pw(e){return 0==(1&e)}function Ow(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var a=!1;i<t.length;){var o=t[i];if(o===e)return i;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function Tw(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(Sw(e,t[r],n))return!0;return!1}function Iw(e,t){return e?":not("+t.trim()+")":t}function xw(e){for(var t=e[0],n=1,r=2,i="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&r){var s=e[++n];i+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!Pw(o)&&(t+=Iw(a,i),i=""),r=o,a=a||!Pw(r);n++}return""!==i&&(t+=Iw(a,i)),t}var Aw={};function Rw(e){Nw(Ky(),Yy(),bm()+e,im())}function Nw(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&Tm(t,i,n)}else{var a=e.preOrderHooks;null!==a&&Im(t,a,0,n)}Em(n)}function Mw(e,t){return e<<17|t<<2}function Dw(e){return e>>17&32767}function Lw(e){return 2|e}function Fw(e){return(131068&e)>>2}function Bw(e,t){return-131069&e|t<<2}function Uw(e){return 1|e}function Vw(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1];if(-1!==a){var o=e.data[a];vm(i),o.contentQueries(2,t[a],a)}}}function zw(e,t,n,r,i,a,o,s,u,c){var l=t.blueprint.slice();return l[0]=i,l[2]=140|r,$y(l),l[3]=l[15]=e,l[8]=n,l[10]=o||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=a,l[16]=2==t.type?e[16]:l,l}function Hw(e,t,n,r,i){var a=e.data[t];if(null===a)a=Gw(e,t,n,r,i),jy.lFrame.inI18n&&(a.flags|=64);else if(64&a.type){a.type=n,a.value=r,a.attrs=i;var o=em();a.injectorIndex=null===o?-1:o.injectorIndex}return tm(a,!0),a}function Gw(e,t,n,r,i){var a=Xy(),o=nm(),s=e.data[t]=function(e,t,n,r,i,a){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?a:a&&a.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=s),null!==a&&(o?null==a.child&&null!==s.parent&&(a.child=s):null===a.next&&(a.next=s)),s}function qw(e,t,n,r){if(0===n)return-1;for(var i=t.length,a=0;a<n;a++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function $w(e,t,n){ym(t);try{var r=e.viewQuery;null!==r&&CC(1,r,n);var i=e.template;null!==i&&Zw(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Vw(e,t),e.staticViewQueries&&CC(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)yC(e,t[n])}(t,a)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,Cm()}}function Ww(e,t,n,r){var i=t[2];if(256!=(256&i)){ym(t);var a=im();try{$y(t),function(e){jy.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&Zw(e,t,n,2,r);var o=3==(3&i);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&Tm(t,s,null)}else{var u=e.preOrderHooks;null!==u&&Im(t,u,0,null),xm(t,0)}if(function(e){for(var t=z_(e);null!==t;t=H_(t))if(t[2])for(var n=t[9],r=0;r<n.length;r++){var i=n[r],a=i[3];0==(1024&i[2])&&Wy(a,1),i[2]|=1024}}(t),function(e){for(var t=z_(e);null!==t;t=H_(t))for(var n=10;n<t.length;n++){var r=t[n],i=r[1];Gy(r)&&Ww(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&Vw(e,t),!a)if(o){var c=e.contentCheckHooks;null!==c&&Tm(t,c)}else{var l=e.contentHooks;null!==l&&Im(t,l,1),xm(t,1)}!function(e,t){var n=e.hostBindingOpCodes;if(null!==n)try{for(var r=0;r<n.length;r++){var i=n[r];if(i<0)Em(~i);else{var a=i,o=n[++r],s=n[++r];hm(o,a),s(2,t[a])}}}finally{Em(-1)}}(e,t);var h=e.components;null!==h&&function(e,t){for(var n=0;n<t.length;n++)pC(e,t[n])}(t,h);var f=e.viewQuery;if(null!==f&&CC(2,f,r),!a)if(o){var d=e.viewCheckHooks;null!==d&&Tm(t,d)}else{var v=e.viewHooks;null!==v&&Im(t,v,2),xm(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Wy(t[3],-1))}finally{Cm()}}}function jw(e,t,n,r){var i=t[10],a=!im(),o=Hy(t);try{a&&!o&&i.begin&&i.begin(),o&&$w(e,t,r),Ww(e,t,n,r)}finally{a&&!o&&i.end&&i.end()}}function Zw(e,t,n,r,i){var a=bm(),o=2&r;try{Em(-1),o&&t.length>20&&Nw(e,t,20,im()),n(r,i)}finally{Em(a)}}function Yw(e,t,n){if(my(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var a=e.data[i];a.contentQueries&&a.contentQueries(1,n[i],i)}}function Kw(e,t,n){!Zy()||(function(e,t,n,r){var i=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||$m(n,t),T_(r,t);for(var o=n.initialInputs,s=i;s<a;s++){var u=e.data[s],c=wy(u);c&&lC(t,n,u);var l=rk(t,e,s,n);T_(l,t),null!==o&&fC(0,s-i,l,u,0,o),c&&(zy(n.index,t)[8]=l)}}(e,t,n,By(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,a=n.index,o=jy.lFrame.currentDirectiveIndex;try{Em(a);for(var s=r;s<i;s++){var u=e.data[s],c=t[s];fm(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&aC(u,c)}}finally{Em(-1),fm(o)}}(e,t,n))}function Jw(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:By,r=t.localNames;if(null!==r)for(var i=t.index+1,a=0;a<r.length;a+=2){var o=r[a+1],s=-1===o?n(t,e):e[o];e[i++]=s}}function Qw(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Xw(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Xw(e,t,n,r,i,a,o,s,u,c){var l=20+r,h=l+i,f=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:Aw);return n}(l,h),d="function"==typeof c?c():c;return f[1]={type:e,blueprint:f,template:n,queries:null,viewQuery:s,declTNode:t,data:f.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function eC(e,t,n,r){var i=EC(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&SC(e).push(r,i.length-1))}function tC(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function nC(e,t,n,r,i,a,o,s){var u,c=By(t,n),l=t.inputs;!s&&null!=l&&(u=l[r])?(OC(e,n,u,r,i),ky(t)&&function(e,t){var n=zy(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,My(a)?a.setProperty(c,r,i):Lm(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function rC(e,t,n,r){var i=!1;if(Zy()){var a=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var a=0;a<r.length;a++){var o=r[a];Tw(n,o.selectors,!1)&&(i||(i=[]),Ym($m(n,t),e,o.type),wy(o)?(oC(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==a){i=!0,uC(n,e.data.length,a.length);for(var s=0;s<a.length;s++){var u=a[s];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,h=qw(e,t,a.length,null),f=0;f<a.length;f++){var d=a[f];n.mergedAttrs=Fm(n.mergedAttrs,d.hostAttrs),cC(e,n,t,h,d),sC(h,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);var v=d.type.prototype;!c&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),!l&&(v.ngOnChanges||v.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),h++}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,a=[],o=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs,h=null===i||bw(t)?null:dC(l,i);a.push(h),o=tC(l,u,o),s=tC(c.outputs,u,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var a=n[t[i+1]];if(null==a)throw new Sg("301","Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],a)}}(n,r,o)}return n.mergedAttrs=Fm(n.mergedAttrs,n.attrs),i}function iC(e,t,n,r,i,a){var o=a.hostBindings;if(o){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=u&&s.push(u),s.push(r,i,o)}}function aC(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function oC(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function sC(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;wy(t)&&(n[""]=e)}}function uC(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function cC(e,t,n,r,i){e.data[r]=i;var a=i.factory||(i.factory=by(i.type)),o=new Nm(a,wy(i),null);e.blueprint[r]=o,n[r]=o,iC(e,t,0,r,qw(e,n,i.hostVars,Aw),i)}function lC(e,t,n){var r=By(t,e),i=Qw(n),a=e[10],o=mC(e,zw(e,i,null,n.onPush?64:16,r,t,a,a.createRenderer(r,n),null,null));e[t.index]=o}function hC(e,t,n,r,i,a,o){if(null==a)My(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{var s=null==o?Pg(a):o(a,r||"",i);My(e)?e.setAttribute(t,i,s,n):n?t.setAttributeNS(n,i,s):t.setAttribute(i,s)}}function fC(e,t,n,r,i,a){var o=a[t];if(null!==o)for(var s=r.setInput,u=0;u<o.length;){var c=o[u++],l=o[u++],h=o[u++];null!==s?r.setInput(n,h,c,l):n[l]=h}}function dC(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function vC(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function pC(e,t){var n=zy(t,e);if(Gy(n)){var r=n[1];80&n[2]?Ww(r,n,r.template,n[8]):n[5]>0&&gC(n)}}function gC(e){for(var t=z_(e);null!==t;t=H_(t))for(var n=10;n<t.length;n++){var r=t[n];if(1024&r[2]){var i=r[1];Ww(i,r,i.template,r[8])}else r[5]>0&&gC(r)}var a=e[1].components;if(null!==a)for(var o=0;o<a.length;o++){var s=zy(a[o],e);Gy(s)&&s[5]>0&&gC(s)}}function yC(e,t){var n=zy(t,e),r=n[1];(function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),$w(r,n,n[8])}function mC(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function kC(e){for(;e;){e[2]|=64;var t=V_(e);if(Cy(e)&&!t)return e;e=t}return null}function _C(e,t,n){var r=t[10];r.begin&&r.begin();try{Ww(e,t,e.template,n)}catch(i){throw PC(t,i),i}finally{r.end&&r.end()}}function wC(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=I_(n),i=r[1];jw(i,r,i.template,n)}}(e[8])}function CC(e,t,n){vm(0),t(e,n)}var bC=Promise.resolve(null);function EC(e){return e[7]||(e[7]=[])}function SC(e){return e.cleanup||(e.cleanup=[])}function PC(e,t){var n=e[9],r=n?n.get(R_,null):null;r&&r.handleError(t)}function OC(e,t,n,r,i){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],u=t[o],c=e.data[o];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function TC(e,t,n){var r=Fy(t,e);W_(e[11],r,n)}function IC(e,t,n){var r=n?e.styles:null,i=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?i=_g(i,s):2==a&&(r=_g(r,s+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}var xC,AC=new fk("INJECTOR",-1),RC=function(){function e(){sp(this,e)}return cp(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ek;if(t===Ek){var n=new Error("NullInjectorError: No provider for ".concat(kg(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),NC=new fk("Set Injector scope."),MC={},DC={};function LC(){return void 0===xC&&(xC=new RC),xC}function FC(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new BC(e,n,t||LC(),r)}var BC=function(){function e(t,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;sp(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&gk(n,function(e){return i.processProvider(e,t,n)}),gk([t],function(e){return i.processInjectorType(e,[],o)}),this.records.set(AC,zC(void 0,this));var s=this.records.get(NC);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:kg(t))}return cp(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ek,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vg.Default;this.assertNotDestroyed();var r,i=xk(this),a=zg(void 0);try{if(!(n&Vg.SkipSelf)){var o=this.records.get(e);if(void 0===o){var s=("function"==typeof(r=e)||"object"==typeof r&&r instanceof fk)&&Rg(e);o=s&&this.injectableDefInScope(s)?zC(UC(e),MC):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&Vg.Self?LC():this.parent).get(e,t=n&Vg.Optional&&t===Ek?null:t)}catch(u){if("NullInjectorError"===u.name){if((u[Pk]=u[Pk]||[]).unshift(kg(e)),i)throw u;return Lk(u,e,"R3InjectorError",this.source)}throw u}finally{zg(a),xk(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(kg(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=bg(e)))return!1;var i=Mg(e),a=null==i&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(i=Mg(a)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(o);try{gk(i.imports,function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,i=t.providers;gk(i,function(e){return r.processProvider(e,n,i||Jg)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(o);var h=by(o)||function(){return new o};this.records.set(o,zC(h,MC));var f=i.providers;if(null!=f&&!s){var d=e;gk(f,function(e){return r.processProvider(e,d,f)})}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r=GC(e=bg(e))?e:bg(e&&e.provide),i=function(e,t,n){return HC(e)?zC(void 0,e.useValue):zC(VC(e),MC)}(e);if(GC(e)||!0!==e.multi)this.records.get(r);else{var a=this.records.get(r);a||((a=zC(void 0,MC,!0)).factory=function(){return Nk(a.multi)},this.records.set(r,a)),r=e,a.multi.push(e)}this.records.set(r,i)}},{key:"hydrate",value:function(e,t){return t.value===MC&&(t.value=DC,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}},{key:"injectableDefInScope",value:function(e){if(!e.providedIn)return!1;var t=bg(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}]),e}();function UC(e){var t=Rg(e),n=null!==t?t.factory:by(e);if(null!==n)return n;if(e instanceof fk)throw new Error("Token ".concat(kg(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=kk(t,"?");throw new Error("Can't resolve all parameters for ".concat(kg(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[Lg]||e[Bg]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function VC(e,t,n){var r;if(GC(e)){var i=bg(e);return by(i)||UC(i)}if(HC(e))r=function(){return bg(e.useValue)};else if(function(e){return!(!e||!e.useFactory)}(e))r=function(){return e.useFactory.apply(e,np(Nk(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return Rk(bg(e.useExisting))};else{var a=bg(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return by(a)||UC(a);r=function(){return Wv(a,np(Nk(e.deps)))}}return r}function zC(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function HC(e){return null!==e&&"object"==typeof e&&Ik in e}function GC(e){return"function"==typeof e}var qC=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=FC(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},$C=function(){var e=function(){function e(){sp(this,e)}return cp(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?qC(e,t,""):qC(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=Ek,e.NULL=new RC,e.\u0275prov=xg({token:e,providedIn:"any",factory:function(){return Rk(AC)}}),e.__NG_ELEMENT_ID__=-1,e}();function WC(e,t){Om(I_(e)[1],Qy())}function jC(e){for(var t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0,r=[e];t;){var i=void 0;if(wy(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);var a=e;a.inputs=ZC(e.inputs),a.declaredInputs=ZC(e.declaredInputs),a.outputs=ZC(e.outputs);var o=i.hostBindings;o&&JC(e,o);var s=i.viewQuery,u=i.contentQueries;if(s&&YC(e,s),u&&KC(e,u),mg(e.inputs,i.inputs),mg(e.declaredInputs,i.declaredInputs),mg(e.outputs,i.outputs),wy(i)&&i.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(i.data.animation)}}var l=i.features;if(l)for(var h=0;h<l.length;h++){var f=l[h];f&&f.ngInherit&&f(e),f===jC&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=Fm(i.hostAttrs,n=Fm(n,i.hostAttrs))}}(r)}function ZC(e){return e===Kg?{}:e===Jg?[]:e}function YC(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function KC(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,i){t(e,r,i),n(e,r,i)}:t}function JC(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var QC=null;function XC(){if(!QC){var e=Yg.Symbol;if(e&&e.iterator)QC=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(QC=r)}}return QC}var eb=function(){function e(t){sp(this,e),this.wrapped=t}return cp(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function tb(e){return!!nb(e)&&(Array.isArray(e)||!(e instanceof Map)&&XC()in e)}function nb(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function rb(e,t,n){return e[t]=n}function ib(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function ab(e,t,n,r){var i=ib(e,t,n);return ib(e,t+1,r)||i}function ob(e,t,n,r){var i=Yy();return ib(i,um(),t)&&(Ky(),function(e,t,n,r,i,a){var o=By(e,t);hC(t[11],o,a,e.value,n,r,i)}(Sm(),i,e,t,n,r)),ob}function sb(e,t,n,r){return ib(e,um(),n)?t+Pg(n)+r:Aw}function ub(e,t,n,r,i,a){var o=ab(e,sm(),n,i);return cm(2),o?t+Pg(n)+r+Pg(i)+a:Aw}function cb(e,t,n,r,i,a,o,s){var u=function(e,t,n,r,i){var a=ab(e,t,n,r);return ib(e,t+2,i)||a}(e,sm(),n,i,o);return cm(3),u?t+Pg(n)+r+Pg(i)+a+Pg(o)+s:Aw}function lb(e,t,n,r,i,a,o,s){var u=Yy(),c=Ky(),l=e+20,h=c.firstCreatePass?function(e,t,n,r,i,a,o,s,u){var c=t.consts,l=Hw(t,e,4,o||null,qy(c,s));rC(t,n,l,qy(c,u)),Om(t,l);var h=l.tViews=Xw(2,l,r,i,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),h.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,a,o):c.data[l];tm(h,!1);var f=u[11].createComment("");lw(c,u,f,h),T_(f,u),mC(u,u[l]=vC(f,u,f,h)),_y(h)&&Kw(c,u,h),null!=o&&Jw(u,h,s)}function hb(e){return Vy(jy.lFrame.contextLView,20+e)}function fb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vg.Default,n=Yy();return null===n?Rk(e,t):Qm(Qy(),n,bg(e),t)}function db(e,t,n){var r=Yy();return ib(r,um(),t)&&nC(Ky(),Sm(),r,e,t,r[11],n,!1),db}function vb(e,t,n,r,i){var a=i?"class":"style";OC(e,n,t.inputs[a],a,r)}function pb(e,t,n,r){var i=Yy(),a=Ky(),o=20+e,s=i[11],u=i[o]=Z_(s,t,jy.lFrame.currentNamespace),c=a.firstCreatePass?function(e,t,n,r,i,a,o){var s=t.consts,u=Hw(t,e,2,i,qy(s,a));return rC(t,n,u,qy(s,o)),null!==u.attrs&&IC(u,u.attrs,!1),null!==u.mergedAttrs&&IC(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,a,i,0,t,n,r):a.data[o];tm(c,!0);var l=c.mergedAttrs;null!==l&&Mm(s,u,l);var h=c.classes;null!==h&&kw(s,u,h);var f=c.styles;null!==f&&mw(s,u,f),64!=(64&c.flags)&&lw(a,i,u,c),0===jy.lFrame.elementDepthCount&&T_(u,i),jy.lFrame.elementDepthCount++,_y(c)&&(Kw(a,i,c),Yw(a,c,i)),null!==r&&Jw(i,c)}function gb(){var e=Qy();nm()?rm():tm(e=e.parent,!1);var t=e;jy.lFrame.elementDepthCount--;var n=Ky();n.firstCreatePass&&(Om(n,e),my(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&vb(n,t,Yy(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&vb(n,t,Yy(),t.stylesWithoutHost,!1)}function yb(e,t,n,r){pb(e,t,n,r),gb()}function mb(e,t,n){var r=Yy(),i=Ky(),a=e+20,o=i.firstCreatePass?function(e,t,n,r,i){var a=t.consts,o=qy(a,r),s=Hw(t,e,8,"ng-container",o);return null!==o&&IC(s,o,!0),rC(t,n,s,qy(a,i)),null!==t.queries&&t.queries.elementStart(t,s),s}(a,i,r,t,n):i.data[a];tm(o,!0);var s=r[a]=r[11].createComment("");lw(i,r,s,o),T_(s,r),_y(o)&&(Kw(i,r,o),Yw(i,o,r)),null!=n&&Jw(r,o)}function kb(){var e=Qy(),t=Ky();nm()?rm():tm(e=e.parent,!1),t.firstCreatePass&&(Om(t,e),my(e)&&t.queries.elementEnd(e))}function _b(){return Yy()}function wb(e){return!!e&&"function"==typeof e.then}var Cb=function(e){return!!e&&"function"==typeof e.subscribe};function bb(e,t,n,r){var i=Yy(),a=Ky(),o=Qy();return function(e,t,n,r,i,a,o,s){var u=_y(r),c=e.firstCreatePass&&SC(e),l=t[8],h=EC(t),f=!0;if(3&r.type||s){var d=By(r,t),v=s?s(d):d,p=h.length,g=s?function(e){return s(Ly(e[r.index]))}:r.index;if(My(n)){var y=null;if(!s&&u&&(y=function(e,t,n,r){var i=e.cleanup;if(null!=i)for(var a=0;a<i.length-1;a+=2){var o=i[a];if(o===n&&i[a+1]===r){var s=t[7],u=i[a+2];return s.length>u?s[u]:null}"string"==typeof o&&(a+=2)}return null}(e,t,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=a,y.__ngLastListenerFn__=a,f=!1;else{a=Sb(r,t,l,a,!1);var m=n.listen(v,i,a);h.push(a,m),c&&c.push(i,g,p,p+1)}}else a=Sb(r,t,l,a,!0),v.addEventListener(i,a,o),h.push(a),c&&c.push(i,g,p,o)}else a=Sb(r,t,l,a,!1);var k,_=r.outputs;if(f&&null!==_&&(k=_[i])){var w=k.length;if(w)for(var C=0;C<w;C+=2){var b=t[k[C]][k[C+1]].subscribe(a),E=h.length;h.push(a,b),c&&c.push(i,r.index,E,-(E+1))}}}(a,i,i[11],o,e,t,!!n,r),bb}function Eb(e,t,n,r){try{return!1!==n(r)}catch(i){return PC(e,i),!1}}function Sb(e,t,n,r,i){return function n(a){if(a===Function)return r;var o=2&e.flags?zy(e.index,t):t;0==(32&t[2])&&kC(o);for(var s=Eb(t,0,r,a),u=n.__ngNextListenerFn__;u;)s=Eb(t,0,u,a)&&s,u=u.__ngNextListenerFn__;return i&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function Pb(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(jy.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,jy.lFrame.contextLView))[8]}(e)}function Ob(e,t,n){return Tb(e,"",t,"",n),Ob}function Tb(e,t,n,r,i){var a=Yy(),o=sb(a,t,n,r);return o!==Aw&&nC(Ky(),Sm(),a,e,o,a[11],i,!1),Tb}function Ib(e,t,n,r,i,a,o){var s=Yy(),u=ub(s,t,n,r,i,a);return u!==Aw&&nC(Ky(),Sm(),s,e,u,s[11],o,!1),Ib}function xb(e,t,n,r,i,a,o,s,u){var c=Yy(),l=cb(c,t,n,r,i,a,o,s);return l!==Aw&&nC(Ky(),Sm(),c,e,l,c[11],u,!1),xb}function Ab(e,t,n,r,i){for(var a=e[n+1],o=null===t,s=r?Dw(a):Fw(a),u=!1;0!==s&&(!1===u||o);){var c=e[s+1];Rb(e[s],t)&&(u=!0,e[s+1]=r?Uw(c):Lw(c)),s=r?Dw(c):Fw(c)}u&&(e[n+1]=r?Lw(a):Uw(a))}function Rb(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Ck(e,t)>=0}function Nb(e,t){return function(e,t,n,r){var i=Yy(),a=Ky(),o=cm(2);a.firstUpdatePass&&function(e,t,n,r){var i=e.data;if(null===i[n+1]){var a=i[bm()],o=function(e,t){return t>=e.expandoStartIndex}(e,n);(function(e,t){return 0!=(16&e.flags)})(a)&&null===t&&!o&&(t=!1),function(e,t,n,r,i,a){var o=t.classBindings,s=Dw(o),u=Fw(o);e[r]=n;var c,l=!1;if(Array.isArray(n)){var h=n;(null===(c=h[1])||Ck(h,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var f=Dw(e[s+1]);e[r+1]=Mw(f,s),0!==f&&(e[f+1]=Bw(e[f+1],r)),e[s+1]=function(e,t){return 131071&e|t<<17}(e[s+1],r)}else e[r+1]=Mw(s,0),0!==s&&(e[s+1]=Bw(e[s+1],r)),s=r;else e[r+1]=Mw(u,0),0===s?s=r:e[u+1]=Bw(e[u+1],r),u=r;l&&(e[r+1]=Lw(e[r+1])),Ab(e,c,r,!0),Ab(e,c,r,!1),function(e,t,n,r,i){var a=e.residualClasses;null!=a&&"string"==typeof t&&Ck(a,t)>=0&&(n[r+1]=Uw(n[r+1]))}(t,c,e,r),o=Mw(s,u),t.classBindings=o}(i,a,t=function(e,t,n,r){var i=function(e){var t=jy.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),a=t.residualClasses;if(null===i)0===t.classBindings&&(n=Db(n=Mb(null,e,t,n,r),t.attrs,r),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=Mb(i,e,t,n,r),null===a){var s=function(e,t,n){var r=t.classBindings;if(0!==Fw(r))return e[Dw(r)]}(e,t);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[Dw(t.classBindings)]=r}(e,t,0,s=Db(s=Mb(null,e,t,s[1],r),t.attrs,r))}else a=function(e,t,n){for(var r,i=t.directiveEnd,a=1+t.directiveStylingLast;a<i;a++)r=Db(r,e[a].hostAttrs,true);return Db(r,t.attrs,true)}(e,t)}return void 0!==a&&(t.residualClasses=a),n}(i,a,t,r),n,o)}}(a,e,o,true),t!==Aw&&ib(i,o,t)&&function(e,t,n,r,i,a,o,s){if(3&t.type){var u=e.data,c=u[s+1];Fb(function(e){return 1==(1&e)}(c)?Lb(u,t,n,i,Fw(c),o):void 0)||(Fb(a)||function(e){return 2==(2&e)}(c)&&(a=Lb(u,null,n,i,s,o)),function(e,t,n,r,i){var a=My(e);i?a?e.addClass(n,r):n.classList.add(r):a?e.removeClass(n,r):n.classList.remove(r)}(r,0,Fy(bm(),n),i,a))}}(a,a.data[bm()],i,i[11],e,i[o+1]=function(e,t){return null==e||"object"==typeof e&&(e=kg(Kk(e))),e}(t),true,o)}(e,t),Nb}function Mb(e,t,n,r,i){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(r=Db(r,(a=t[s]).hostAttrs,i),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function Db(e,t,n){var r=n?1:2,i=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),_k(e,o,!!n||t[++a]))}return void 0===e?null:e}function Lb(e,t,n,r,i,a){for(var o,s=null===t;i>0;){var u=e[i],c=Array.isArray(u),l=c?u[1]:u,h=null===l,f=n[i+1];f===Aw&&(f=h?Jg:void 0);var d=h?wk(f,r):l===r?f:void 0;if(c&&!Fb(d)&&(d=wk(u,r)),Fb(d)&&(o=d,s))return o;var v=e[i+1];i=s?Dw(v):Fw(v)}if(null!==t){var p=a?t.residualClasses:t.residualStyles;null!=p&&(o=wk(p,r))}return o}function Fb(e){return void 0!==e}function Bb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Yy(),r=Ky(),i=e+20,a=r.firstCreatePass?Hw(r,i,1,t,null):r.data[i],o=n[i]=$_(n[11],t);lw(r,n,o,a),tm(a,!1)}function Ub(e){return Vb("",e,""),Ub}function Vb(e,t,n){var r=Yy(),i=sb(r,e,t,n);return i!==Aw&&TC(r,bm(),i),Vb}function zb(e,t,n,r,i){var a=Yy(),o=ub(a,e,t,n,r,i);return o!==Aw&&TC(a,bm(),o),zb}function Hb(e,t,n,r,i,a,o){var s=Yy(),u=cb(s,e,t,n,r,i,a,o);return u!==Aw&&TC(s,bm(),u),Hb}function Gb(e,t,n){var r=Yy();return ib(r,um(),t)&&nC(Ky(),Sm(),r,e,t,r[11],n,!0),Gb}var qb=void 0,$b=["en",[["a","p"],["AM","PM"],qb],[["AM","PM"],qb,qb],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],qb,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],qb,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",qb,"{1} 'at' {0}",qb],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],Wb={};function jb(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=Yb(t);if(n)return n;var r=t.split("-")[0];if(n=Yb(r))return n;if("en"===r)return $b;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function Zb(e){return jb(e)[Kb.PluralCase]}function Yb(e){return e in Wb||(Wb[e]=Yg.ng&&Yg.ng.common&&Yg.ng.common.locales&&Yg.ng.common.locales[e]),Wb[e]}var Kb=((Kb=Kb||{})[Kb.LocaleId=0]="LocaleId",Kb[Kb.DayPeriodsFormat=1]="DayPeriodsFormat",Kb[Kb.DayPeriodsStandalone=2]="DayPeriodsStandalone",Kb[Kb.DaysFormat=3]="DaysFormat",Kb[Kb.DaysStandalone=4]="DaysStandalone",Kb[Kb.MonthsFormat=5]="MonthsFormat",Kb[Kb.MonthsStandalone=6]="MonthsStandalone",Kb[Kb.Eras=7]="Eras",Kb[Kb.FirstDayOfWeek=8]="FirstDayOfWeek",Kb[Kb.WeekendRange=9]="WeekendRange",Kb[Kb.DateFormat=10]="DateFormat",Kb[Kb.TimeFormat=11]="TimeFormat",Kb[Kb.DateTimeFormat=12]="DateTimeFormat",Kb[Kb.NumberSymbols=13]="NumberSymbols",Kb[Kb.NumberFormats=14]="NumberFormats",Kb[Kb.CurrencyCode=15]="CurrencyCode",Kb[Kb.CurrencySymbol=16]="CurrencySymbol",Kb[Kb.CurrencyName=17]="CurrencyName",Kb[Kb.Currencies=18]="Currencies",Kb[Kb.Directionality=19]="Directionality",Kb[Kb.PluralCase=20]="PluralCase",Kb[Kb.ExtraData=21]="ExtraData",Kb),Jb=["zero","one","two","few","many"],Qb="en-US",Xb={marker:"element"},eE={marker:"ICU"},tE=((tE=tE||{})[tE.SHIFT=2]="SHIFT",tE[tE.APPEND_EAGERLY=1]="APPEND_EAGERLY",tE[tE.COMMENT=2]="COMMENT",tE),nE=Qb;function rE(e){(function(e,t){null==e&&Ig("Expected localeId to be defined",e,null,"!=")})(e),"string"==typeof e&&(nE=e.toLowerCase().replace(/_/g,"-"))}function iE(e,t,n){var r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?ow(e,0,n):Ly(n[i])}function aE(e,t,n,r,i){var a=t.insertBeforeIndex;if(Array.isArray(a)){var o=r,s=null;if(3&t.type||(s=o,o=i),null!==o&&0==(2&t.flags))for(var u=1;u<a.length;u++)tw(e,o,n[a[u]],s,!1)}}function oE(e,t){if(e.push(t),e.length>1)for(var n=e.length-2;n>=0;n--){var r=e[n];sE(r)||uE(r,t)&&null===cE(r)&&lE(r,t.index)}}function sE(e){return!(64&e.type)}function uE(e,t){return sE(t)||e.index>t.index}function cE(e){var t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function lE(e,t){var n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(cw(iE,aE),e.insertBeforeIndex=t)}function hE(e,t){var n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function fE(e,t,n){var r=Gw(e,n,64,null,null);return oE(t,r),r}function dE(e,t){var n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function vE(e){return e>>>17}function pE(e){return(131070&e)>>>1}var gE=0,yE=0;function mE(e,t,n,r){for(var i,a=n[11],o=null,s=0;s<t.length;s++){var u=t[s];if("string"==typeof u){var c=t[++s];null===n[c]&&(n[c]=$_(a,u))}else if("number"==typeof u)switch(1&u){case 0:var l=vE(u),h=void 0,f=void 0;if(null===o&&(o=l,i=iw(a,r)),l===o?(h=r,f=i):(h=null,f=Ly(n[l])),null!==f){var d=pE(u);tw(a,f,n[d],h,!1);var v=hE(e,d);if(null!==v&&"object"==typeof v){var p=dE(v,n);null!==p&&mE(e,v.create[p],n,n[v.anchorIdx])}}break;case 1:var g=t[++s],y=t[++s];hC(a,Fy(u>>>1,n),null,null,g,y,null);break;default:throw new Error('Unable to determine the type of mutate operation for "'.concat(u,'"'))}else switch(u){case eE:var m=t[++s],k=t[++s];null===n[k]&&T_(n[k]=j_(a,m),n);break;case Xb:var _=t[++s],w=t[++s];null===n[w]&&T_(n[w]=Z_(a,_,null),n)}}}function kE(e,t,n,r,i){for(var a=0;a<n.length;a++){var o=n[a],s=n[++a];if(o&i)for(var u="",c=a+1;c<=a+s;c++){var l=n[c];if("string"==typeof l)u+=l;else if("number"==typeof l)if(l<0)u+=Pg(t[r-l]);else{var h=l>>>2;switch(3&l){case 1:var f=n[++c],d=n[++c],v=e.data[h];"string"==typeof v?hC(t[11],t[h],null,v,f,u,d):nC(e,v,t,f,u,t[11],d,!1);break;case 0:var p=t[h];null!==p&&W_(t[11],p,u);break;case 2:wE(e,hE(e,h),t,u);break;case 3:_E(e,hE(e,h),r,t)}}}else{var g=n[a+1];if(g>0&&3==(3&g)){var y=hE(e,g>>>2);t[y.currentCaseLViewIndex]<0&&_E(e,y,r,t)}}a+=s}}function _E(e,t,n,r){var i=r[t.currentCaseLViewIndex];if(null!==i){var a=gE;i<0&&(i=r[t.currentCaseLViewIndex]=~i,a=-1),kE(e,r,t.update[i],n,a)}}function wE(e,t,n,r){var i=function(e,t){var n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:var r=function(e,t){var n=Zb(t)(parseInt(e,10)),r=Jb[n];return void 0!==r?r:"other"}(t,nE);-1===(n=e.cases.indexOf(r))&&"other"!==r&&(n=e.cases.indexOf("other"));break;case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(dE(t,n)!==i&&(CE(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){var a=n[t.anchorIdx];a&&mE(e,t.create[i],n,a)}}function CE(e,t,n){var r=dE(t,n);if(null!==r)for(var i=t.remove[r],a=0;a<i.length;a++){var o=i[a];if(o>0){var s=Fy(o,n);null!==s&&vw(n[11],s)}else CE(e,hE(e,~o),n)}}function bE(){var e,t,n=[],r=-1;function i(e,n){r=0;var i=dE(e,n);t=null!==i?e.remove[i]:Jg}function a(){if(r<t.length){var o=t[r++];return o>0?e[o]:(n.push(r,t),i(e[1].data[~o],e),a())}return 0===n.length?null:(t=n.pop(),r=n.pop(),a())}return function(t,r){for(e=r;n.length;)n.pop();return i(t.value,r),a}}var EE=/\ufffd(\d+):?\d*\ufffd/gi,SE=/\ufffd(\d+)\ufffd/,PE=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,OE=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,TE=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,IE=/\uE500/g;function xE(e,t,n,r,i,a,o){var s=qw(e,r,1,null),u=s<<tE.SHIFT,c=em();t===c&&(c=null),null===c&&(u|=tE.APPEND_EAGERLY),o&&(u|=tE.COMMENT,function(e){void 0===F_&&(F_=e())}(bE)),i.push(u,null===a?"":a);var l=Gw(e,s,o?32:1,null===a?"":a,null);oE(n,l);var h=l.index;return tm(l,!1),null!==c&&t!==c&&function(e,t){var n=e.insertBeforeIndex;null===n?(cw(iE,aE),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){true!=e&&Ig("Expecting array here",e,true,"==")}(Array.isArray(n)),n.push(t))}(c,h),l}function AE(e,t,n,r,i,a,o){var s=o.match(EE),u=xE(e,t,n,a,r,s?null:o,!1);s&&RE(i,o,u.index,null,0,null)}function RE(e,t,n,r,i,a){var o=e.length,s=o+1;e.push(null,null);for(var u=o+2,c=t.split(EE),l=0,h=0;h<c.length;h++){var f=c[h];if(1&h){var d=i+parseInt(f,10);e.push(-1-d),l|=NE(d)}else""!==f&&e.push(f)}return e.push(n<<2|(r?1:0)),r&&e.push(r,a),e[o]=l,e[s]=e.length-u,l}function NE(e){return 1<<Math.min(e,31)}function ME(e){for(var t,n,r="",i=0,a=!1;null!==(t=OE.exec(e));)a?t[0]==="\ufffd/*".concat(n,"\ufffd")&&(i=t.index,a=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],a=!0);return r+=e.substr(i)}function DE(e,t,n,r,i,a){var o=0,s={type:i.type,currentCaseLViewIndex:qw(e,t,1,null),anchorIdx:a,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(NE(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,a),function(e,t,n){var r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,a,s);for(var u=i.values,c=0;c<u.length;c++){for(var l=u[c],h=[],f=0;f<l.length;f++){var d=l[f];if("string"!=typeof d){var v=h.push(d)-1;l[f]="\x3c!--\ufffd".concat(v,"\ufffd--\x3e")}}o=BE(e,s,t,n,r,i.cases[c],l.join(""),h)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,a)}function LE(e){for(var t=[],n=[],r=1,i=0,a=FE(e=e.replace(PE,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""})),o=0;o<a.length;){var s=a[o++].trim();1===r&&(s=s.replace(/\s*(?:=)?(\w+)\s*/,"$1")),s.length&&t.push(s);var u=FE(a[o++]);t.length>n.length&&n.push(u)}return{type:r,mainBinding:i,cases:t,values:n}}function FE(e){if(!e)return[];var t,n=0,r=[],i=[],a=/[{}]/g;for(a.lastIndex=0;t=a.exec(e);){var o=t.index;if("}"==t[0]){if(r.pop(),0==r.length){var s=e.substring(n,o);PE.test(s)?i.push(LE(s)):i.push(s),n=o+1}}else{if(0==r.length){var u=e.substring(n,o);i.push(u),n=o+1}r.push("{")}}var c=e.substring(n);return i.push(c),i}function BE(e,t,n,r,i,a,o,s){var u=[],c=[],l=[];t.cases.push(a),t.create.push(u),t.remove.push(c),t.update.push(l);var h=Xk(Ny()).getInertBodyElement(o),f=C_(h)||h;return f?UE(e,t,n,r,u,c,l,f,i,s,0):0}function UE(e,t,n,r,i,a,o,s,u,c,l){for(var h=0,f=s.firstChild;f;){var d=qw(e,n,1,null);switch(f.nodeType){case Node.ELEMENT_NODE:var v=f,p=v.tagName.toLowerCase();if(f_.hasOwnProperty(p)){HE(i,Xb,p,u,d),e.data[d]=p;for(var g=v.attributes,y=0;y<g.length;y++){var m=g.item(y),k=m.name.toLowerCase();m.value.match(EE)?p_.hasOwnProperty(k)&&RE(o,m.value,d,m.name,0,d_[k]?i_:v_[k]?a_:null):GE(i,d,m)}h=UE(e,t,n,r,i,a,o,f,d,c,l+1)|h,VE(a,d,l)}break;case Node.TEXT_NODE:var _=f.textContent||"",w=_.match(EE);HE(i,null,w?"":_,u,d),VE(a,d,l),w&&(h=RE(o,_,d,null,0,null)|h);break;case Node.COMMENT_NODE:var C=SE.exec(f.textContent||"");if(C){var b=c[parseInt(C[1],10)];HE(i,eE,"",u,d),DE(e,n,r,u,b,d),zE(a,d,l)}}f=f.nextSibling}return h}function VE(e,t,n){0===n&&e.push(t)}function zE(e,t,n){0===n&&(e.push(~t),e.push(t))}function HE(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function GE(e,t,n){e.push(t<<1|1,n.name,n.value)}function qE(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=Ky(),i=Yy(),a=20+e,o=qy(r.consts,t),s=em();r.firstCreatePass&&function(e,t,n,r,i,a){for(var o=em(),s=[],u=[],c=[[]],l=function(e){return e.replace(IE," ")}(i=function(e,t){if(function(e){return-1===e}(t))return ME(e);var n=e.indexOf(":".concat(t,"\ufffd"))+2+t.toString().length,r=e.search(new RegExp("\ufffd\\/\\*\\d+:".concat(t,"\ufffd")));return ME(e.substring(n,r))}(i,a)).split(TE),h=0;h<l.length;h++){var f=l[h];if(0==(1&h))for(var d=FE(f),v=0;v<d.length;v++){var p=d[v];if(0==(1&v)){var g=p;""!==g&&AE(e,o,c[0],s,u,n,g)}else{var y=p;if("object"!=typeof y)throw new Error('Unable to parse ICU expression in "'.concat(i,'" message.'));DE(e,n,u,t,y,xE(e,o,c[0],n,s,"",!0).index)}}else{var m=47===f.charCodeAt(0),k=(f.charCodeAt(m?1:0),20+Number.parseInt(f.substring(m?2:1)));if(m)c.shift(),tm(em(),!1);else{var _=fE(e,c[0],k);c.unshift([]),tm(_,!0)}}}e.data[r]={create:s,update:u}}(r,null===s?0:s.index,i,a,o,n);var u=r.data[a],c=ew(r,s===i[6]?null:s,i);(function(e,t,n,r){for(var i=e[11],a=0;a<t.length;a++){var o=t[a++],s=t[a],u=(o&tE.COMMENT)===tE.COMMENT,c=(o&tE.APPEND_EAGERLY)===tE.APPEND_EAGERLY,l=o>>>tE.SHIFT,h=e[l];null===h&&(h=e[l]=u?i.createComment(s):$_(i,s)),c&&null!==n&&tw(i,n,h,r,!1)}})(i,u.create,c,s&&8&s.type?i[s.index]:null),lm(!0)}function $E(){lm(!1)}function WE(e,t,n){qE(e,t,n),$E()}function jE(e){return function(e){e&&(gE|=1<<Math.min(yE,31)),yE++}(ib(Yy(),um(),e)),jE}function ZE(e){!function(e,t,n){if(yE>0){var r=e.data[n];kE(e,t,Array.isArray(r)?r:r.update,sm()-yE-1,gE)}gE=0,yE=0}(Ky(),Yy(),e+20)}function YE(e,t,n,r,i){if(e=bg(e),Array.isArray(e))for(var a=0;a<e.length;a++)YE(e[a],t,n,r,i);else{var o=Ky(),s=Yy(),u=GC(e)?e:bg(e.provide),c=VC(e),l=Qy(),h=1048575&l.providerIndexes,f=l.directiveStart,d=l.providerIndexes>>20;if(GC(e)||!e.multi){var v=new Nm(c,i,fb),p=QE(u,t,i?h:h+d,f);-1===p?(Ym($m(l,s),o,u),KE(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(v),s.push(v)):(n[p]=v,s[p]=v)}else{var g=QE(u,t,h+d,f),y=QE(u,t,h,h+d),m=g>=0&&n[g],k=y>=0&&n[y];if(i&&!k||!i&&!m){Ym($m(l,s),o,u);var _=function(e,t,n,r,i){var a=new Nm(e,n,fb);return a.multi=[],a.index=t,a.componentProviders=0,JE(a,i,r&&!n),a}(i?eS:XE,n.length,i,r,c);!i&&k&&(n[y].providerFactory=_),KE(o,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(_),s.push(_)}else KE(o,e,g>-1?g:y,JE(n[i?y:g],c,!i&&r));!i&&r&&k&&n[y].componentProviders++}}}function KE(e,t,n,r){var i=GC(t);if(i||function(e){return!!e.useClass}(t)){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[r,a]):o[s+1].push(r,a)}else o.push(n,a)}}}function JE(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function QE(e,t,n,r){for(var i=n;i<r;i++)if(t[i]===e)return i;return-1}function XE(e,t,n,r){return tS(this.multi,[])}function eS(e,t,n,r){var i,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=rk(n,n[1],this.providerFactory.index,r);tS(a,i=s.slice(0,o));for(var u=o;u<s.length;u++)i.push(s[u])}else tS(a,i=[]);return i}function tS(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function nS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=Ky();if(r.firstCreatePass){var i=wy(e);YE(n,r.data,r.blueprint,i,!0),YE(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}}var rS=cp(function e(){sp(this,e)}),iS=function(){function e(){sp(this,e)}return cp(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(kg(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),aS=function(){var e=cp(function e(){sp(this,e)});return e.NULL=new iS,e}();function oS(){}function sS(e,t){return new cS(By(e,t))}var uS=function(){return sS(Qy(),Yy())},cS=function(){var e=cp(function e(t){sp(this,e),this.nativeElement=t});return e.__NG_ELEMENT_ID__=uS,e}();function lS(e){return e instanceof cS?e.nativeElement:e}var hS=cp(function e(){sp(this,e)}),fS=function(){var e=cp(function e(){sp(this,e)});return e.__NG_ELEMENT_ID__=function(){return dS()},e}(),dS=function(){var e=Yy(),t=zy(Qy().index,e);return function(e){return e[11]}(gy(t)?t:e)},vS=function(){var e=cp(function e(){sp(this,e)});return e.\u0275prov=xg({token:e,providedIn:"root",factory:function(){return null}}),e}(),pS=cp(function e(t){sp(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}),gS=new pS("12.2.16"),yS=function(){function e(){sp(this,e)}return cp(e,[{key:"supports",value:function(e){return tb(e)}},{key:"create",value:function(e){return new kS(e)}}]),e}(),mS=function(e,t){return t},kS=function(){function e(t){sp(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||mS}return cp(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var a=!n||t&&t.currentIndex<bS(n,r,i)?t:n,o=bS(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)r++;else{i||(i=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var h=l<i.length?i[l]:i[l]=0,f=h+l;c<=f&&f<u&&(i[l]=h+1)}i[a.previousIndex]=c-u}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!tb(e))throw new Error("Error trying to diff '".concat(kg(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==a&&Object.is(a.trackById,i)?(o&&(a=this._verifyReinsertion(a,r,i,s)),Object.is(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[XC()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==a&&Object.is(a.trackById,i)?(o&&(a=t._verifyReinsertion(a,e,i,n)),Object.is(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,i,n),o=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new _S(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new CS),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new CS),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),_S=cp(function e(t,n){sp(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}),wS=function(){function e(){sp(this,e),this._head=null,this._tail=null}return cp(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),CS=function(){function e(){sp(this,e),this.map=new Map}return cp(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new wS,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function bS(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var ES=function(){function e(){sp(this,e)}return cp(e,[{key:"supports",value:function(e){return e instanceof Map||nb(e)}},{key:"create",value:function(){return new SS}}]),e}(),SS=function(){function e(){sp(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return cp(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||nb(e)))throw new Error("Error trying to diff '".concat(kg(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var a=new PS(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),PS=cp(function e(t){sp(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null});function OS(){return new TS([new yS])}var TS=function(){var e=function(){function e(t){sp(this,e),this.factories=t}return cp(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(null!=t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||OS())},deps:[[e,new zk,new Vk]]}}}]),e}();return e.\u0275prov=xg({token:e,providedIn:"root",factory:OS}),e}();function IS(){return new xS([new ES])}var xS=function(){var e=function(){function e(t){sp(this,e),this.factories=t}return cp(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||IS())},deps:[[e,new zk,new Vk]]}}}]),e}();return e.\u0275prov=xg({token:e,providedIn:"root",factory:IS}),e}();function AS(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var a=t[n.index];if(null!==a&&r.push(Ly(a)),yy(a))for(var o=10;o<a.length;o++){var s=a[o],u=s[1].firstChild;null!==u&&AS(s[1],s,u,r)}var c=n.type;if(8&c)AS(e,t,n.child,r);else if(32&c)for(var l=U_(n,t),h=void 0;h=l();)r.push(h);else if(16&c){var f=fw(t,n);if(Array.isArray(f))r.push.apply(r,np(f));else{var d=V_(t[16]);AS(d[1],d,f,r,!0)}}n=i?n.projectionNext:n.next}return r}var RS=function(){function e(t,n){sp(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return cp(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return AS(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(e){this._lView[8]=e}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(yy(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&(K_(e,n),mk(t,n))}this._attachedToViewContainer=!1}J_(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){eC(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){kC(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){_C(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){am(!0);try{_C(e,t,n)}finally{am(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,gw(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),NS=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e))._view=e,r}return cp(n,[{key:"detectChanges",value:function(){wC(this._view)}},{key:"checkNoChanges",value:function(){!function(e){am(!0);try{wC(e)}finally{am(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(RS),MS=function(e){return function(e,t,n){if(ky(e)&&!n){var r=zy(e.index,t);return new RS(r,r)}return 47&e.type?new RS(t[16],t):null}(Qy(),Yy(),16==(16&e))},DS=function(){var e=cp(function e(){sp(this,e)});return e.__NG_ELEMENT_ID__=MS,e}(),LS=[new ES],FS=new TS([new yS]),BS=new xS(LS),US=function(){return HS(Qy(),Yy())},VS=function(){var e=cp(function e(){sp(this,e)});return e.__NG_ELEMENT_ID__=US,e}(),zS=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this))._declarationLView=e,a._declarationTContainer=r,a.elementRef=i,a}return cp(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=zw(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),$w(t,n,e),new RS(n)}}]),n}(VS);function HS(e,t){return 4&e.type?new zS(t,e,sS(e,t)):null}var GS=cp(function e(){sp(this,e)}),qS=cp(function e(){sp(this,e)}),$S=function(){return KS(Qy(),Yy())},WS=function(){var e=cp(function e(){sp(this,e)});return e.__NG_ELEMENT_ID__=$S,e}(),jS=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this))._lContainer=e,a._hostTNode=r,a._hostLView=i,a}return cp(n,[{key:"element",get:function(){return sS(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new ok(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=Zm(this._hostTNode,this._hostLView);if(Um(e)){var t=zm(e,this._hostLView),n=Vm(e);return new ok(t[1].data[n+8],t)}return new ok(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=ZS(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var a=n||this.parentInjector;if(!i&&null==e.ngModule&&a){var o=a.get(GS,null);o&&(i=o)}var s=e.create(a,r,void 0,i);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var r=e._lView,i=r[1];if(yy(r[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=r[3],s=new n(o,o[6],o[3]);s.detach(s.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,r){var i=10+r,a=n.length;r>0&&(n[i-1][4]=t),r<a-10?(t[4]=n[i],yk(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,r,c,u);var l=dw(u,c),h=r[11],f=iw(h,c[7]);return null!==f&&function(e,t,n,r,i,a){r[0]=i,r[6]=t,gw(e,r,n,1,i,a)}(i,c[6],h,r,f,l),e.attachToViewContainerRef(),yk(YS(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=ZS(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=K_(this._lContainer,t);n&&(mk(YS(this._lContainer),t),J_(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=K_(this._lContainer,t);return n&&null!=mk(YS(this._lContainer),t)?new RS(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!=e?e:this.length+t}}]),n}(WS);function ZS(e){return e[8]}function YS(e){return e[8]||(e[8]=[])}function KS(e,t){var n,r=t[e.index];if(yy(r))n=r;else{var i;if(8&e.type)i=Ly(r);else{var a=t[11];i=a.createComment("");var o=By(e,t);tw(a,iw(a,o),i,function(e,t){return My(e)?e.nextSibling(t):t.nextSibling}(a,o),!1)}t[e.index]=n=vC(r,t,i,e),mC(t,n)}return new jS(n,e,t)}var JS={},QS=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).ngModule=e,r}return cp(n,[{key:"resolveComponentFactory",value:function(e){var t=vy(e);return new tP(t,this.ngModule)}}]),n}(aS);function XS(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var eP=new fk("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return D_}}),tP=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(xw).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return cp(n,[{key:"inputs",get:function(){return XS(this.componentDef.inputs)}},{key:"outputs",get:function(){return XS(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,r){var i,a,o=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var a=e.get(n,JS,i);return a!==JS||r===JS?a:t.get(n,r,i)}}}(e,r.injector):e,s=o.get(hS,Dy),u=o.get(vS,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",h=n?function(e,t,n){if(My(e))return e.selectRootElement(t,n===$g.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):Z_(s.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?Ry:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),f=this.componentDef.onPush?576:528,d={components:[],scheduler:D_,clean:bC,playerHandler:null,flags:0},v=Xw(0,null,null,1,0,null,null,null,null,null),p=zw(null,v,d,f,null,null,s,c,u,o);ym(p);try{var g=function(e,t,n,r,i,a){var o=n[1];n[20]=e;var s=Hw(o,20,2,"#host",null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(IC(s,u,!0),null!==e&&(Mm(i,e,u),null!==s.classes&&kw(i,e,s.classes),null!==s.styles&&mw(i,e,s.styles)));var c=r.createRenderer(e,t),l=zw(n,Qw(t),null,t.onPush?64:16,n[20],s,r,c,null,null);return o.firstCreatePass&&(Ym($m(s,n),o,t.type),oC(o,s),uC(s,n.length,1)),mC(n,l),n[20]=l}(h,this.componentDef,p,s,c);if(h)if(n)Mm(c,h,["ng-version",gS.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var a=e[r];if("string"==typeof a)2===i?""!==a&&t.push(a,e[++r]):8===i&&n.push(a);else{if(!Pw(i))break;i=a}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),m=y.attrs,k=y.classes;m&&Mm(c,h,m),k&&k.length>0&&kw(c,h,k.join(" "))}if(a=Uy(v,20),void 0!==t)for(var _=a.projection=[],w=0;w<this.ngContentSelectors.length;w++){var C=t[w];_.push(null!=C?Array.from(C):null)}i=function(e,t,n,r,i){var a=n[1],o=function(e,t,n){var r=Qy();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),cC(e,r,t,qw(e,t,1,null),n));var i=rk(t,e,r.directiveStart,r);T_(i,t);var a=By(r,t);return a&&T_(a,t),i}(a,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(function(e){return e(o,t)}),t.contentQueries){var s=Qy();t.contentQueries(1,o,s.directiveStart)}var u=Qy();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Em(u.index),iC(n[1],u,0,u.directiveStart,u.directiveEnd,t),aC(t,o)),o}(g,this.componentDef,p,d,[WC]),$w(v,p,null)}finally{Cm()}return new nP(this.componentType,i,sS(a,p),p,a)}}]),n}(rS),nP=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o){var s;return sp(this,n),(s=t.call(this)).location=i,s._rootLView=a,s._tNode=o,s.instance=r,s.hostView=s.changeDetectorRef=new NS(a),s.componentType=e,s}return cp(n,[{key:"injector",get:function(){return new ok(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return cp(function e(){sp(this,e)})}()),rP=new Map,iP=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;sp(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=Xv(i),i.destroyCbs=[],i.componentFactoryResolver=new QS(Xv(i));var a=py(e),o=e[ny]||null;return o&&rE(o),i._bootstrapComponents=L_(a.bootstrap),i._r3Injector=FC(e,r,[{provide:GS,useValue:Xv(i)},{provide:aS,useValue:i.componentFactoryResolver}],kg(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return cp(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$C.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vg.Default;return e===$C||e===GS||e===AC?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(GS),aP=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).moduleType=e,null!==py(e)&&function(e){var t=new Set;!function e(n){var r=py(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(kg(t)," vs ").concat(kg(t.name)))}(i,rP.get(i),n),rP.set(i,n));var a,o=ip(L_(r.imports));try{for(o.s();!(a=o.n()).done;){var s=a.value;t.has(s)||(t.add(s),e(s))}}catch(u){o.e(u)}finally{o.f()}}(e)}(e),r}return cp(n,[{key:"create",value:function(e){return new iP(this.moduleType,e)}}]),n}(qS);function oP(e,t,n){var r=om()+e,i=Yy();return i[r]===Aw?rb(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function sP(e,t,n,r){return lP(Yy(),om(),e,t,n,r)}function uP(e,t,n,r,i){return hP(Yy(),om(),e,t,n,r,i)}function cP(e,t){var n=e[t];return n===Aw?void 0:n}function lP(e,t,n,r,i,a){var o=t+n;return ib(e,o,i)?rb(e,o+1,a?r.call(a,i):r(i)):cP(e,o+1)}function hP(e,t,n,r,i,a,o){var s=t+n;return ab(e,s,i,a)?rb(e,s+2,o?r.call(o,i,a):r(i,a)):cP(e,s+2)}function fP(e,t){var n,r=Ky(),i=e+20;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new Sg("302","The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var a=n.factory||(n.factory=by(n.type)),o=zg(fb);try{var s=Gm(!1),u=a();return Gm(s),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(r,Yy(),i,u),u}finally{zg(o)}}function dP(e,t,n){var r=e+20,i=Yy(),a=Vy(i,r);return pP(i,vP(i,r)?lP(i,om(),t,a.transform,n,a):a.transform(n))}function vP(e,t){return e[1].data[t].pure}function pP(e,t){return eb.isWrapped(t)&&(t=eb.unwrap(t),e[sm()]=Aw),t}function gP(e){return function(t){setTimeout(e,void 0,t)}}var yP=function(e){Yv(n,e);var t=Jv(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return sp(this,n),(e=t.call(this)).__isAsync=r,e}return cp(n,[{key:"emit",value:function(e){jv(tp(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var i,a,o,s=e,u=t||function(){return null},c=r;if(e&&"object"==typeof e){var l=e;s=null===(i=l.next)||void 0===i?void 0:i.bind(l),u=null===(a=l.error)||void 0===a?void 0:a.bind(l),c=null===(o=l.complete)||void 0===o?void 0:o.bind(l)}this.__isAsync&&(u=gP(u),s&&(s=gP(s)),c&&(c=gP(c)));var h=jv(tp(n.prototype),"subscribe",this).call(this,{next:s,error:u,complete:c});return e instanceof lp&&e.add(h),h}}]),n}(Fp);function mP(){return this._results[XC()]()}var kP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];sp(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=XC(),r=e.prototype;r[n]||(r[n]=mP)}return cp(e,[{key:"changes",get:function(){return this._changes||(this._changes=new yP)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){var n=this;n.dirty=!1;var r=pk(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],a=t[r];if(n&&(i=n(i),a=n(a)),a!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}();Symbol;var _P=function(){function e(t){sp(this,e),this.queryList=t,this.matches=null}return cp(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),wP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];sp(this,e),this.queries=t}return cp(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[],a=0;a<r;a++){var o=n.getByIndex(a);i.push(this.queries[o.indexInDeclarationView].clone())}return new e(i)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==RP(e,t).matches&&this.queries[t].setDirty()}}]),e}(),CP=cp(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;sp(this,e),this.predicate=t,this.flags=n,this.read=r}),bP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];sp(this,e),this.queries=t}return cp(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,a=this.getByIndex(r).embeddedTView(t,i);a&&(a.indexInDeclarationView=r,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),EP=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;sp(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return cp(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];this.matchTNodeWithReadOption(e,t,SP(t,i)),this.matchTNodeWithReadOption(e,t,nk(t,e,i,!1,!1))}else n===VS?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,nk(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===cS||r===WS||r===VS&&4&t.type)this.addMatch(t.index,-2);else{var i=nk(t,e,r,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function SP(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function PP(e,t,n,r){return-1===n?function(e,t){return 11&e.type?sS(e,t):4&e.type?HS(e,t):null}(t,e):-2===n?function(e,t,n){return n===cS?sS(t,e):n===VS?HS(t,e):n===WS?KS(t,e):void 0}(e,t,r):rk(e,e[1],n,t)}function OP(e,t,n,r){var i=t[19].queries[r];if(null===i.matches){for(var a=e.data,o=n.matches,s=[],u=0;u<o.length;u+=2){var c=o[u];s.push(c<0?null:PP(t,a[c],o[u+1],n.metadata.read))}i.matches=s}return i.matches}function TP(e,t,n,r){var i=e.queries.getByIndex(n),a=i.matches;if(null!==a)for(var o=OP(e,t,i,n),s=0;s<a.length;s+=2){var u=a[s];if(u>0)r.push(o[s/2]);else{for(var c=a[s+1],l=t[-u],h=10;h<l.length;h++){var f=l[h];f[17]===f[3]&&TP(f[1],f,c,r)}if(null!==l[9])for(var d=l[9],v=0;v<d.length;v++){var p=d[v];TP(p[1],p,c,r)}}}return r}function IP(e){var t=Yy(),n=Ky(),r=dm();vm(r+1);var i=RP(n,r);if(e.dirty&&Hy(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{var a=i.crossesNgTemplate?TP(n,t,r,[]):OP(n,t,i,r);e.reset(a,lS),e.notifyOnChanges()}return!0}return!1}function xP(e,t,n){var r=Ky();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new bP),e.queries.track(new EP(t,-1))}(r,new CP(e,t,n)),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){var r=new kP(4==(4&n));eC(e,t,r,r.destroy),null===t[19]&&(t[19]=new wP),t[19].queries.push(new _P(r))}(r,Yy(),t)}function AP(){return e=Yy(),t=dm(),e[19].queries[t].queryList;var e,t}function RP(e,t){return e.queries.getByIndex(t)}function NP(e,t){return HS(e,t)}var MP=new fk("Application Initializer"),DP=function(){var e=function(){function e(t){var n=this;sp(this,e),this.appInits=t,this.resolve=oS,this.reject=oS,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return cp(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=function(n){var r=e.appInits[n]();if(wb(r))t.push(r);else if(Cb(r)){var i=new Promise(function(e,t){r.subscribe({complete:e,error:t})});t.push(i)}},i=0;i<this.appInits.length;i++)r(i);Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(MP,8))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),LP=new fk("AppId"),FP={provide:LP,useFactory:function(){return"".concat(BP()).concat(BP()).concat(BP())},deps:[]};function BP(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var UP=new fk("Platform Initializer"),VP=new fk("Platform ID"),zP=new fk("appBootstrapListener"),HP=function(){var e=function(){function e(){sp(this,e)}return cp(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),GP=new fk("LocaleId"),qP=new fk("DefaultCurrencyCode"),$P=cp(function e(t,n){sp(this,e),this.ngModuleFactory=t,this.componentFactories=n}),WP=function(e){return new aP(e)},jP=WP,ZP=function(e){return Promise.resolve(WP(e))},YP=function(e){var t=WP(e),n=L_(py(e).declarations).reduce(function(e,t){var n=vy(t);return n&&e.push(new tP(n)),e},[]);return new $P(t,n)},KP=YP,JP=function(e){return Promise.resolve(YP(e))},QP=function(){var e=function(){function e(){sp(this,e),this.compileModuleSync=jP,this.compileModuleAsync=ZP,this.compileModuleAndAllComponentsSync=KP,this.compileModuleAndAllComponentsAsync=JP}return cp(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),XP=Promise.resolve(0);function eO(e){"undefined"==typeof Zone?XP.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var tO=function(){function e(t){var n=t.enableLongStackTrace,r=void 0!==n&&n,i=t.shouldCoalesceEventChangeDetection,a=void 0!==i&&i,o=t.shouldCoalesceRunChangeDetection,s=void 0!==o&&o;if(sp(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new yP(!1),this.onMicrotaskEmpty=new yP(!1),this.onStable=new yP(!1),this.onError=new yP(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!s&&a,u.shouldCoalesceRunChangeDetection=s,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function(){var e=Yg.requestAnimationFrame,t=Yg.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){var t=function(){!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Yg,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,iO(e),e.isCheckStableRunning=!0,rO(e),e.isCheckStableRunning=!1},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),iO(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(n,r,i,a,o,s){try{return aO(e),n.invokeTask(i,a,o,s)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),oO(e)}},onInvoke:function(n,r,i,a,o,s,u){try{return aO(e),n.invoke(i,a,o,s,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),oO(e)}},onHasTask:function(t,n,r,i){t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,iO(e),rO(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,n,r,i){return t.handleError(r,i),e.runOutsideAngular(function(){return e.onError.emit(i)}),!1}})}(u)}return cp(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,e,nO,oS,oS);try{return i.runTask(a,t,n)}finally{i.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),nO={};function rO(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function iO(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function aO(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function oO(e){e._nesting--,rO(e)}var sO,uO=function(){function e(){sp(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new yP,this.onMicrotaskEmpty=new yP,this.onStable=new yP,this.onError=new yP}return cp(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),cO=function(){var e=function(){function e(t){var n=this;sp(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return cp(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){tO.assertNotInAngularZone(),eO(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())eO(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(tO))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),lO=function(){var e=function(){function e(){sp(this,e),this._applications=new Map,hO.addToWindow(this)}return cp(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return hO.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),hO=new(function(){function e(){sp(this,e)}return cp(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),fO=!0,dO=!1,vO=new fk("AllowMultipleToken"),pO=cp(function e(t,n){sp(this,e),this.name=t,this.token=n});function gO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new fk(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=yO();if(!a||a.injector.get(vO,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var o=n.concat(t).concat({provide:i,useValue:!0},{provide:NC,useValue:"platform"});!function(e){if(sO&&!sO.destroyed&&!sO.injector.get(vO,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");sO=e.get(mO);var t=e.get(UP,null);t&&t.forEach(function(e){return e()})}($C.create({providers:o,name:r}))}return function(e){var t=yO();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function yO(){return sO&&!sO.destroyed?sO:null}var mO=function(){var e=function(){function e(t){sp(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return cp(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n=this,r=function(e,t){return"noop"===e?new uO:("zone.js"===e?void 0:e)||new tO({enableLongStackTrace:(dO=!0,fO),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)})}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),i=[{provide:tO,useValue:r}];return r.run(function(){var a=$C.create({providers:i,parent:n.injector,name:e.moduleType.name}),o=e.create(a),s=o.injector.get(R_,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.runOutsideAngular(function(){var e=r.onError.subscribe({next:function(e){s.handleError(e)}});o.onDestroy(function(){wO(n._modules,o),e.unsubscribe()})}),function(e,r,i){try{var a=((s=o.injector.get(DP)).runInitializers(),s.donePromise.then(function(){return rE(o.injector.get(GP,Qb)||Qb),n._moduleDoBootstrap(o),o}));return wb(a)?a.catch(function(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}):a}catch(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}var s}(s,r)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=kO({},n);return function(e,t,n){var r=new aP(n);return Promise.resolve(r)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(_O);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(kg(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk($C))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}();function kO(e,t){return Array.isArray(t)?t.reduce(kO,e):Object.assign(Object.assign({},e),t)}var _O=function(){var e=function(){function e(t,n,r,i,a){var o=this;sp(this,e),this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){o._zone.run(function(){o.tick()})}});var s=new Mp(function(e){o._stable=o._zone.isStable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks,o._zone.runOutsideAngular(function(){e.next(o._stable),e.complete()})}),u=new Mp(function(e){var t;o._zone.runOutsideAngular(function(){t=o._zone.onStable.subscribe(function(){tO.assertNotInAngularZone(),eO(function(){!o._stable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks&&(o._stable=!0,e.next(!0))})})});var n=o._zone.onUnstable.subscribe(function(){tO.assertInAngularZone(),o._stable&&(o._stable=!1,o._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=lg(t),i=function(e,t){return"number"==typeof ug(e)?e.pop():1/0}(t),a=t;return a.length?1===a.length?ng(a[0]):og(i)(vg(a,r)):sg}(s,u.pipe(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connector,n=void 0===t?function(){return new Fp}:t,r=e.resetOnError,i=void 0===r||r,a=e.resetOnComplete,o=void 0===a||a,s=e.resetOnRefCountZero,u=void 0===s||s;return function(e){var t=null,r=null,a=null,s=0,c=!1,l=!1,h=function(){null==r||r.unsubscribe(),r=null},f=function(){h(),t=a=null,c=l=!1},d=function(){var e=t;f(),null==e||e.unsubscribe()};return Vp(function(e,v){var p;s++,!l&&!c&&h();var g=a=null!==(p=a)&&void 0!==p?p:n();v.add(function(){0===--s&&!l&&!c&&(r=gg(d,u))}),g.subscribe(v),t||(t=new Op({next:function(e){return g.next(e)},error:function(e){l=!0,h(),r=gg(f,i,e),g.error(e)},complete:function(){c=!0,h(),r=gg(f,o),g.complete()}}),vg(e).subscribe(t))})(e)}}()))}return cp(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof rS?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(GS),a=n.create($C.NULL,[],t||n.selector,i),o=a.location.nativeElement,s=a.injector.get(cO,null),u=s&&a.injector.get(lO);return s&&u&&u.registerApplication(o,s),a.onDestroy(function(){r.detachView(a.hostView),wO(r.components,a),u&&u.unregisterApplication(o)}),this._loadComponent(a),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=ip(this._views);try{for(n.s();!(t=n.n()).done;){var r;t.value.detectChanges()}}catch(i){n.e(i)}finally{n.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;wO(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(zP,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(tO),Rk($C),Rk(R_),Rk(aS),Rk(DP))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}();function wO(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var CO=cp(function e(){sp(this,e)}),bO=cp(function e(){sp(this,e)}),EO={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},SO=function(){var e=function(){function e(t,n){sp(this,e),this._compiler=t,this._config=n||EO}return cp(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,n=Hv(e.split("#"),2),r=n[0],i=n[1];return void 0===i&&(i="default"),qv(8255)(r).then(function(e){return e[i]}).then(function(e){return PO(e,r,i)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=Hv(e.split("#"),2),n=t[0],r=t[1],i="NgFactory";return void 0===r&&(r="default",i=""),qv(8255)(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then(function(e){return e[r+i]}).then(function(e){return PO(e,n,r)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(QP),Rk(bO,8))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}();function PO(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var OO=gO(null,"core",[{provide:VP,useValue:"unknown"},{provide:mO,deps:[$C]},{provide:lO,deps:[]},{provide:HP,deps:[]}]),TO=[{provide:_O,useClass:_O,deps:[tO,$C,R_,aS,DP]},{provide:eP,deps:[tO],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:DP,useClass:DP,deps:[[new Vk,MP]]},{provide:QP,useClass:QP,deps:[]},FP,{provide:TS,useFactory:function(){return FS},deps:[]},{provide:xS,useFactory:function(){return BS},deps:[]},{provide:GP,useFactory:function(e){return rE(e=e||"undefined"!=typeof $localize&&$localize.locale||Qb),e},deps:[[new Uk(GP),new Vk,new zk]]},{provide:qP,useValue:"USD"}],IO=function(){var e=cp(function e(t){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)(Rk(_O))},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({providers:TO}),e}(),xO=null;function AO(){return xO}var RO=new fk("DocumentToken"),NO=function(){var e=function(){function e(){sp(this,e)}return cp(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({factory:MO,token:e,providedIn:"platform"}),e}();function MO(){return Rk(LO)}var DO=new fk("Location Initialized"),LO=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this))._doc=e,r._init(),r}return cp(n,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return AO().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){var t=AO().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),function(){return t.removeEventListener("popstate",e)}}},{key:"onHashChange",value:function(e){var t=AO().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),function(){return t.removeEventListener("hashchange",e)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){FO()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){FO()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(e)}},{key:"getState",value:function(){return this._history.state}}]),n}(NO);return e.\u0275fac=function(t){return new(t||e)(Rk(RO))},e.\u0275prov=xg({factory:BO,token:e,providedIn:"platform"}),e}();function FO(){return!!window.history.pushState}function BO(){return new LO(Rk(RO))}function UO(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function VO(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function zO(e){return e&&"?"!==e[0]?"?"+e:e}var HO=function(){var e=function(){function e(){sp(this,e)}return cp(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({factory:GO,token:e,providedIn:"root"}),e}();function GO(e){var t=Rk(RO).location;return new $O(Rk(NO),t&&t.origin||"")}var qO=new fk("appBaseHref"),$O=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;if(sp(this,n),(i=t.call(this))._platformLocation=e,i._removeListenerFns=[],null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,Qv(i)}return cp(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return UO(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+zO(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+zO(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+zO(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(HO);return e.\u0275fac=function(t){return new(t||e)(Rk(NO),Rk(qO,8))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),WO=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this))._platformLocation=e,i._baseHref="",i._removeListenerFns=[],null!=r&&(i._baseHref=r),i}return cp(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=UO(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+zO(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+zO(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(HO);return e.\u0275fac=function(t){return new(t||e)(Rk(NO),Rk(qO,8))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),jO=function(){var e=function(){function e(t,n){var r=this;sp(this,e),this._subject=new yP,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=VO(YO(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return cp(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+zO(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,YO(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+zO(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+zO(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformStrategy).historyGo)||void 0===t||t.call(e,n)}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(HO),Rk(NO))},e.normalizeQueryParams=zO,e.joinWithSlash=UO,e.stripTrailingSlash=VO,e.\u0275prov=xg({factory:ZO,token:e,providedIn:"root"}),e}();function ZO(){return new jO(Rk(HO),Rk(NO))}function YO(e){return e.replace(/\/index.html$/,"")}var KO=((KO=KO||{})[KO.Decimal=0]="Decimal",KO[KO.Percent=1]="Percent",KO[KO.Currency=2]="Currency",KO[KO.Scientific=3]="Scientific",KO),JO=((JO=JO||{})[JO.Zero=0]="Zero",JO[JO.One=1]="One",JO[JO.Two=2]="Two",JO[JO.Few=3]="Few",JO[JO.Many=4]="Many",JO[JO.Other=5]="Other",JO),QO=((QO=QO||{})[QO.Format=0]="Format",QO[QO.Standalone=1]="Standalone",QO),XO=((XO=XO||{})[XO.Narrow=0]="Narrow",XO[XO.Abbreviated=1]="Abbreviated",XO[XO.Wide=2]="Wide",XO[XO.Short=3]="Short",XO),eT=((eT=eT||{})[eT.Short=0]="Short",eT[eT.Medium=1]="Medium",eT[eT.Long=2]="Long",eT[eT.Full=3]="Full",eT),tT=((tT=tT||{})[tT.Decimal=0]="Decimal",tT[tT.Group=1]="Group",tT[tT.List=2]="List",tT[tT.PercentSign=3]="PercentSign",tT[tT.PlusSign=4]="PlusSign",tT[tT.MinusSign=5]="MinusSign",tT[tT.Exponential=6]="Exponential",tT[tT.SuperscriptingExponent=7]="SuperscriptingExponent",tT[tT.PerMille=8]="PerMille",tT[tT.Infinity=9]="Infinity",tT[tT.NaN=10]="NaN",tT[tT.TimeSeparator=11]="TimeSeparator",tT[tT.CurrencyDecimal=12]="CurrencyDecimal",tT[tT.CurrencyGroup=13]="CurrencyGroup",tT);function nT(e,t){return uT(jb(e)[Kb.DateFormat],t)}function rT(e,t){return uT(jb(e)[Kb.TimeFormat],t)}function iT(e,t){return uT(jb(e)[Kb.DateTimeFormat],t)}function aT(e,t){var n=jb(e),r=n[Kb.NumberSymbols][t];if(void 0===r){if(t===tT.CurrencyDecimal)return n[Kb.NumberSymbols][tT.Decimal];if(t===tT.CurrencyGroup)return n[Kb.NumberSymbols][tT.Group]}return r}var oT=Zb;function sT(e){if(!e[Kb.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[Kb.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function uT(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function cT(e){var t=Hv(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var lT=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,hT={},fT=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,dT=((dT=dT||{})[dT.Short=0]="Short",dT[dT.ShortGMT=1]="ShortGMT",dT[dT.Long=2]="Long",dT[dT.Extended=3]="Extended",dT),vT=((vT=vT||{})[vT.FullYear=0]="FullYear",vT[vT.Month=1]="Month",vT[vT.Date=2]="Date",vT[vT.Hours=3]="Hours",vT[vT.Minutes=4]="Minutes",vT[vT.Seconds=5]="Seconds",vT[vT.FractionalSeconds=6]="FractionalSeconds",vT[vT.Day=7]="Day",vT),pT=((pT=pT||{})[pT.DayPeriods=0]="DayPeriods",pT[pT.Days=1]="Days",pT[pT.Months=2]="Months",pT[pT.Eras=3]="Eras",pT);function gT(e,t,n,r){var i=function(e){if(IT(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){var t=Hv(e.split("-").map(function(e){return+e}),3),n=t[0],r=t[1],i=void 0===r?1:r,a=t[2];return yT(n,i-1,void 0===a?1:a)}var o,s=parseFloat(e);if(!isNaN(e-s))return new Date(s);if(o=e.match(lT))return function(e){var t=new Date(0),n=0,r=0,i=e[8]?t.setUTCFullYear:t.setFullYear,a=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return a.call(t,o,s,u,c),t}(o)}var u=new Date(e);if(!IT(u))throw new Error('Unable to convert "'.concat(e,'" into a date'));return u}(e);t=mT(n,t)||t;for(var a,o=[];t;){if(!(a=fT.exec(t))){o.push(t);break}var s=(o=o.concat(a.slice(1))).pop();if(!s)break;t=s}var u=i.getTimezoneOffset();r&&(u=TT(r,u),i=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(TT(t,r)-r))}(i,r));var c="";return o.forEach(function(e){var t=function(e){if(OT[e])return OT[e];var t;switch(e){case"G":case"GG":case"GGG":t=CT(pT.Eras,XO.Abbreviated);break;case"GGGG":t=CT(pT.Eras,XO.Wide);break;case"GGGGG":t=CT(pT.Eras,XO.Narrow);break;case"y":t=wT(vT.FullYear,1,0,!1,!0);break;case"yy":t=wT(vT.FullYear,2,0,!0,!0);break;case"yyy":t=wT(vT.FullYear,3,0,!1,!0);break;case"yyyy":t=wT(vT.FullYear,4,0,!1,!0);break;case"Y":t=PT(1);break;case"YY":t=PT(2,!0);break;case"YYY":t=PT(3);break;case"YYYY":t=PT(4);break;case"M":case"L":t=wT(vT.Month,1,1);break;case"MM":case"LL":t=wT(vT.Month,2,1);break;case"MMM":t=CT(pT.Months,XO.Abbreviated);break;case"MMMM":t=CT(pT.Months,XO.Wide);break;case"MMMMM":t=CT(pT.Months,XO.Narrow);break;case"LLL":t=CT(pT.Months,XO.Abbreviated,QO.Standalone);break;case"LLLL":t=CT(pT.Months,XO.Wide,QO.Standalone);break;case"LLLLL":t=CT(pT.Months,XO.Narrow,QO.Standalone);break;case"w":t=ST(1);break;case"ww":t=ST(2);break;case"W":t=ST(1,!0);break;case"d":t=wT(vT.Date,1);break;case"dd":t=wT(vT.Date,2);break;case"c":case"cc":t=wT(vT.Day,1);break;case"ccc":t=CT(pT.Days,XO.Abbreviated,QO.Standalone);break;case"cccc":t=CT(pT.Days,XO.Wide,QO.Standalone);break;case"ccccc":t=CT(pT.Days,XO.Narrow,QO.Standalone);break;case"cccccc":t=CT(pT.Days,XO.Short,QO.Standalone);break;case"E":case"EE":case"EEE":t=CT(pT.Days,XO.Abbreviated);break;case"EEEE":t=CT(pT.Days,XO.Wide);break;case"EEEEE":t=CT(pT.Days,XO.Narrow);break;case"EEEEEE":t=CT(pT.Days,XO.Short);break;case"a":case"aa":case"aaa":t=CT(pT.DayPeriods,XO.Abbreviated);break;case"aaaa":t=CT(pT.DayPeriods,XO.Wide);break;case"aaaaa":t=CT(pT.DayPeriods,XO.Narrow);break;case"b":case"bb":case"bbb":t=CT(pT.DayPeriods,XO.Abbreviated,QO.Standalone,!0);break;case"bbbb":t=CT(pT.DayPeriods,XO.Wide,QO.Standalone,!0);break;case"bbbbb":t=CT(pT.DayPeriods,XO.Narrow,QO.Standalone,!0);break;case"B":case"BB":case"BBB":t=CT(pT.DayPeriods,XO.Abbreviated,QO.Format,!0);break;case"BBBB":t=CT(pT.DayPeriods,XO.Wide,QO.Format,!0);break;case"BBBBB":t=CT(pT.DayPeriods,XO.Narrow,QO.Format,!0);break;case"h":t=wT(vT.Hours,1,-12);break;case"hh":t=wT(vT.Hours,2,-12);break;case"H":t=wT(vT.Hours,1);break;case"HH":t=wT(vT.Hours,2);break;case"m":t=wT(vT.Minutes,1);break;case"mm":t=wT(vT.Minutes,2);break;case"s":t=wT(vT.Seconds,1);break;case"ss":t=wT(vT.Seconds,2);break;case"S":t=wT(vT.FractionalSeconds,1);break;case"SS":t=wT(vT.FractionalSeconds,2);break;case"SSS":t=wT(vT.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=bT(dT.Short);break;case"ZZZZZ":t=bT(dT.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=bT(dT.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=bT(dT.Long);break;default:return null}return OT[e]=t,t}(e);c+=t?t(i,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function yT(e,t,n){var r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function mT(e,t){var n=function(e){return jb(e)[Kb.LocaleId]}(e);if(hT[n]=hT[n]||{},hT[n][t])return hT[n][t];var r="";switch(t){case"shortDate":r=nT(e,eT.Short);break;case"mediumDate":r=nT(e,eT.Medium);break;case"longDate":r=nT(e,eT.Long);break;case"fullDate":r=nT(e,eT.Full);break;case"shortTime":r=rT(e,eT.Short);break;case"mediumTime":r=rT(e,eT.Medium);break;case"longTime":r=rT(e,eT.Long);break;case"fullTime":r=rT(e,eT.Full);break;case"short":var i=mT(e,"shortTime"),a=mT(e,"shortDate");r=kT(iT(e,eT.Short),[i,a]);break;case"medium":var o=mT(e,"mediumTime"),s=mT(e,"mediumDate");r=kT(iT(e,eT.Medium),[o,s]);break;case"long":var u=mT(e,"longTime"),c=mT(e,"longDate");r=kT(iT(e,eT.Long),[u,c]);break;case"full":var l=mT(e,"fullTime"),h=mT(e,"fullDate");r=kT(iT(e,eT.Full),[l,h])}return r&&(hT[n][t]=r),r}function kT(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function _T(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,a=n));for(var o=String(e);o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),a+o}function wT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(a,o){var s=function(e,t){switch(e){case vT.FullYear:return t.getFullYear();case vT.Month:return t.getMonth();case vT.Date:return t.getDate();case vT.Hours:return t.getHours();case vT.Minutes:return t.getMinutes();case vT.Seconds:return t.getSeconds();case vT.FractionalSeconds:return t.getMilliseconds();case vT.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,a);if((n>0||s>-n)&&(s+=n),e===vT.Hours)0===s&&-12===n&&(s=12);else if(e===vT.FractionalSeconds)return function(e,t){return _T(e,3).substr(0,t)}(s,t);var u=aT(o,tT.MinusSign);return _T(s,t,u,r,i)}}function CT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:QO.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,a){return function(e,t,n,r,i,a){switch(n){case pT.Months:return function(e,t,n){var r=jb(e),i=uT([r[Kb.MonthsFormat],r[Kb.MonthsStandalone]],t);return uT(i,n)}(t,i,r)[e.getMonth()];case pT.Days:return function(e,t,n){var r=jb(e),i=uT([r[Kb.DaysFormat],r[Kb.DaysStandalone]],t);return uT(i,n)}(t,i,r)[e.getDay()];case pT.DayPeriods:var o=e.getHours(),s=e.getMinutes();if(a){var u=function(e){var t=jb(e);return sT(t),(t[Kb.ExtraData][2]||[]).map(function(e){return"string"==typeof e?cT(e):[cT(e[0]),cT(e[1])]})}(t),c=function(e,t,n){var r=jb(e);sT(r);var i=uT([r[Kb.ExtraData][0],r[Kb.ExtraData][1]],t)||[];return uT(i,n)||[]}(t,i,r),l=u.findIndex(function(e){if(Array.isArray(e)){var t=Hv(e,2),n=t[0],r=t[1],i=o>=n.hours&&s>=n.minutes,a=o<r.hours||o===r.hours&&s<r.minutes;if(n.hours<r.hours){if(i&&a)return!0}else if(i||a)return!0}else if(e.hours===o&&e.minutes===s)return!0;return!1});if(-1!==l)return c[l]}return function(e,t,n){var r=jb(e),i=uT([r[Kb.DayPeriodsFormat],r[Kb.DayPeriodsStandalone]],t);return uT(i,n)}(t,i,r)[o<12?0:1];case pT.Eras:return function(e,t){return uT(jb(e)[Kb.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(i,a,e,t,n,r)}}function bT(e){return function(t,n,r){var i=-1*r,a=aT(n,tT.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case dT.Short:return(i>=0?"+":"")+_T(o,2,a)+_T(Math.abs(i%60),2,a);case dT.ShortGMT:return"GMT"+(i>=0?"+":"")+_T(o,1,a);case dT.Long:return"GMT"+(i>=0?"+":"")+_T(o,2,a)+":"+_T(Math.abs(i%60),2,a);case dT.Extended:return 0===r?"Z":(i>=0?"+":"")+_T(o,2,a)+":"+_T(Math.abs(i%60),2,a);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function ET(e){return yT(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function ST(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i;if(t){var a=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+a)/7)}else{var s=ET(n),u=function(e){var t=yT(e,0,1).getDay();return yT(e,0,1+(t<=4?4:11)-t)}(s.getFullYear()),c=s.getTime()-u.getTime();i=1+Math.round(c/6048e5)}return _T(i,e,aT(r,tT.MinusSign))}}function PT(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return _T(ET(n).getFullYear(),e,aT(r,tT.MinusSign),t)}}var OT={};function TT(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function IT(e){return e instanceof Date&&!isNaN(e.valueOf())}var xT=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function AT(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var RT=cp(function e(){sp(this,e)}),NT=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).locale=e,r}return cp(n,[{key:"getPluralCategory",value:function(e,t){switch(oT(t||this.locale)(e)){case JO.Zero:return"zero";case JO.One:return"one";case JO.Two:return"two";case JO.Few:return"few";case JO.Many:return"many";default:return"other"}}}]),n}(RT);return e.\u0275fac=function(t){return new(t||e)(Rk(GP))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}();function MT(e,t){t=encodeURIComponent(t);var n,r=ip(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.indexOf("="),o=Hv(-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var DT=function(){var e=function(){function e(t,n,r,i){sp(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return cp(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(tb(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(kg(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(TS),fb(xS),fb(cS),fb(fS))},e.\u0275dir=fy({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e}(),LT=function(){function e(t,n,r,i){sp(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return cp(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),FT=function(){var e=function(){function e(t,n,r){sp(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return cp(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(n){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'. NgFor only supports binding to Iterables such as Arrays."))}}if(this._differ){var t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new LT(null,t._ngForOf,-1,-1),null===i?void 0:i),o=new BT(e,a);n.push(o)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new BT(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,a=this._viewContainer.length;i<a;i++){var o=this._viewContainer.get(i);o.context.index=i,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(WS),fb(VS),fb(TS))},e.\u0275dir=fy({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e}(),BT=cp(function e(t,n){sp(this,e),this.record=t,this.view=n}),UT=function(){var e=function(){function e(t,n){sp(this,e),this._viewContainer=t,this._context=new VT,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return cp(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){zT("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){zT("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(WS),fb(VS))},e.\u0275dir=fy({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e}(),VT=cp(function e(){sp(this,e),this.$implicit=null,this.ngIf=null});function zT(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(kg(t),"'."))}var HT=function(){var e=function(){function e(t){sp(this,e),this._locale=t}return cp(e,[{key:"transform",value:function(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!1;if(isFinite(e)){var c=function(e){var t,n,r,i,a,o=Math.abs(e)+"",s=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(a=o.length))t=[0],n=1;else{for(a--;"0"===o.charAt(a);)a--;for(n-=r,t=[],i=0;r<=a;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),s=n-1,n=1),{digits:t,exponent:s,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,h=t.minFrac,f=t.maxFrac;if(a){var d=a.match(xT);if(null===d)throw new Error("".concat(a," is not a valid digit info"));var v=d[1],p=d[3],g=d[5];null!=v&&(l=AT(v)),null!=p&&(h=AT(p)),null!=g?f=AT(g):null!=p&&h>f&&(f=h)}!function(e,t,n){if(t>n)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(n,")."));var r=e.digits,i=r.length-e.integerLen,a=Math.min(Math.max(t,i),n),o=a+e.integerLen,s=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(var u=o;u<r.length;u++)r[u]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=a+1),r[0]=0;for(var c=1;c<o;c++)r[c]=0}if(s>=5)if(o-1<0){for(var l=0;l>o;l--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,a);i++)r.push(0);var h=0!==a,f=t+e.integerLen,d=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,h&&(0===r[n]&&n>=f?r.pop():h=!1),t>=10?1:0},0);d&&(r.unshift(d),e.integerLen++)}(c,h,f);var y=c.digits,m=c.integerLen,k=c.exponent,_=[];for(u=y.every(function(e){return!e});m<l;m++)y.unshift(0);for(;m<0;m++)y.unshift(0);m>0?_=y.splice(m,y.length):(_=y,y=[0]);var w=[];for(y.length>=t.lgSize&&w.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)w.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&w.unshift(y.join("")),s=w.join(aT(n,r)),_.length&&(s+=aT(n,i)+_.join("")),k&&(s+=aT(n,tT.Exponential)+"+"+k)}else s=aT(n,tT.Infinity);return s=e<0&&!u?t.negPre+s+t.negSuf:t.posPre+s+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],a=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=o[0],u=o[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?n.minFrac=n.maxFrac=c+1:"#"===l?n.maxFrac=c+1:n.posSuf+=l}var h=s.split(",");if(n.gSize=h[1]?h[1].length:0,n.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,a){var f=i.length-n.posPre.length-n.posSuf.length,d=a.indexOf("#");n.negPre=a.substr(0,d).replace(/'/g,""),n.negSuf=a.substr(d+f).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return jb(e)[Kb.NumberFormats][t]}(t,KO.Decimal),aT(t,tT.MinusSign)),t,tT.Group,tT.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),r,n)}catch(i){throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(kg(e),"'"))}(e,i.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(GP,16))},e.\u0275pipe=dy({name:"number",type:e,pure:!0}),e}(),GT=function(){var e=cp(function e(){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({providers:[{provide:RT,useClass:NT}]}),e}(),qT=function(){var e=cp(function e(){sp(this,e)});return e.\u0275prov=xg({token:e,providedIn:"root",factory:function(){return new $T(Rk(RO),window)}}),e}(),$T=function(){function e(t,n){sp(this,e),this.document=t,this.window=n,this.offset=function(){return[0,0]}}return cp(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;i;){var a=i.shadowRoot;if(a){var o=a.getElementById(t)||a.querySelector('[name="'.concat(t,'"]'));if(o)return o}i=r.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=WT(this.window.history)||WT(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(t){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function WT(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var jT,ZT=cp(function e(){sp(this,e)}),YT=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getBaseHref",value:function(e){var t=(KT=KT||document.querySelector("base"))?KT.getAttribute("href"):null;return null==t?null:function(e){(jT=jT||document.createElement("a")).setAttribute("href",e);var t=jT.pathname;return"/"===t.charAt(0)?t:"/".concat(t)}(t)}},{key:"resetBaseElement",value:function(){KT=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(e){return MT(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,xO||(xO=e)}}]),n}(function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).supportsDOMEvents=!0,e}return cp(n)}(function(){return cp(function e(){sp(this,e)})}())),KT=null,JT=new fk("TRANSITION_ID"),QT=[{provide:MP,useFactory:function(e,t,n){return function(){n.get(DP).donePromise.then(function(){for(var n=AO(),r=t.querySelectorAll('style[ng-transition="'.concat(e,'"]')),i=0;i<r.length;i++)n.remove(r[i])})}},deps:[JT,RO,$C],multi:!0}],XT=function(){function e(){sp(this,e)}return cp(e,[{key:"addToWindow",value:function(e){Yg.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Yg.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Yg.getAllAngularRootElements=function(){return e.getAllRootElements()},Yg.frameworkStabilizers||(Yg.frameworkStabilizers=[]),Yg.frameworkStabilizers.push(function(e){var t=Yg.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){var r;return null==t?null:null!==(r=e.getTestability(t))&&void 0!==r?r:n?AO().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,hO=t}}]),e}(),eI=function(){var e=function(){function e(){sp(this,e)}return cp(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),tI=new fk("EventManagerPlugins"),nI=function(){var e=function(){function e(t,n){var r=this;sp(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return cp(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(tI),Rk(tO))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),rI=function(){function e(t){sp(this,e),this._doc=t}return cp(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=AO().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),iI=function(){var e=function(){function e(){sp(this,e),this._stylesSet=new Set}return cp(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),aI=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Map,r._hostNodes.set(e.head,[]),r}return cp(n,[{key:"_addStylesToHost",value:function(e,t,n){var r=this;e.forEach(function(e){var i=r._doc.createElement("style");i.textContent=e,n.push(t.appendChild(i))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(oI),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n,r){t._addStylesToHost(e,r,n)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(oI)})}}]),n}(iI);return e.\u0275fac=function(t){return new(t||e)(Rk(RO))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}();function oI(e){AO().remove(e)}var sI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},uI=/%COMP%/g;function cI(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?cI(e,i,n):(i=i.replace(uI,e),n.push(i))}return n}function lI(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var hI=function(){var e=function(){function e(t,n,r){sp(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new fI(t)}return cp(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case $g.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new dI(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case $g.ShadowDom:return new vI(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=cI(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(nI),Rk(aI),Rk(LP))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),fI=function(){function e(t){sp(this,e),this.eventManager=t,this.data=Object.create(null)}return cp(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(sI[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=sI[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=sI[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&(B_.DashCase|B_.Important)?e.style.setProperty(t,n,r&B_.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&B_.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,lI(n)):this.eventManager.addEventListener(e,t,lI(n))}}]),e}(),dI=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;sp(this,n),(o=t.call(this,e)).component=i;var s=cI(a+"-"+i.id,i.styles,[]);return r.addStyles(s),o.contentAttr="_ngcontent-%COMP%".replace(uI,a+"-"+i.id),o.hostAttr=function(e){return"_nghost-%COMP%".replace(uI,e)}(a+"-"+i.id),o}return cp(n,[{key:"applyToHost",value:function(e){jv(tp(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=jv(tp(n.prototype),"createElement",this).call(this,e,t);return jv(tp(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(fI),vI=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;sp(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=i,o.shadowRoot=i.attachShadow({mode:"open"}),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=cI(a.id,a.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return cp(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return jv(tp(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return jv(tp(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return jv(tp(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(jv(tp(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(fI),pI=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){return sp(this,n),t.call(this,e)}return cp(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(rI);return e.\u0275fac=function(t){return new(t||e)(Rk(RO))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),gI=["alt","control","meta","shift"],yI={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},mI={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},kI={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},_I=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){return sp(this,n),t.call(this,e)}return cp(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),a=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return AO().onAndCancel(e,i.domEventName,a)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),a="";if(gI.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),a+=e+".")}),a+=i,0!=t.length||0===i.length)return null;var o={};return o.domEventName=r,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&mI.hasOwnProperty(t)&&(t=mI[t]))}return yI[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),gI.forEach(function(r){r!=n&&kI[r](e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded(function(){return t(i)})}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),n}(rI);return e.\u0275fac=function(t){return new(t||e)(Rk(RO))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),wI=function(){var e=cp(function e(){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({factory:function(){return Rk(CI)},token:e,providedIn:"root"}),e}(),CI=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this))._doc=e,r}return cp(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case b_.NONE:return t;case b_.HTML:return Jk(t,"HTML")?Kk(t):w_(this._doc,String(t)).toString();case b_.STYLE:return Jk(t,"Style")?Kk(t):t;case b_.SCRIPT:if(Jk(t,"Script"))return Kk(t);throw new Error("unsafe value used in a script context");case b_.URL:return Qk(t),Jk(t,"URL")?Kk(t):i_(String(t));case b_.RESOURCE_URL:if(Jk(t,"ResourceURL"))return Kk(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return function(e){return new $k(e)}(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return function(e){return new Wk(e)}(e)}},{key:"bypassSecurityTrustScript",value:function(e){return function(e){return new jk(e)}(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return function(e){return new Zk(e)}(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return function(e){return new Yk(e)}(e)}}]),n}(wI);return e.\u0275fac=function(t){return new(t||e)(Rk(RO))},e.\u0275prov=xg({factory:function(){return function(e){return new CI(e.get(RO))}(Rk(AC))},token:e,providedIn:"root"}),e}(),bI=gO(OO,"browser",[{provide:VP,useValue:"browser"},{provide:UP,useValue:function(){YT.makeCurrent(),XT.init()},multi:!0},{provide:RO,useFactory:function(){return e=document,Ay=e,document;var e},deps:[]}]),EI=[[],{provide:NC,useValue:"root"},{provide:R_,useFactory:function(){return new R_},deps:[]},{provide:tI,useClass:pI,multi:!0,deps:[RO,tO,VP]},{provide:tI,useClass:_I,multi:!0,deps:[RO]},[],{provide:hI,useClass:hI,deps:[nI,aI,LP]},{provide:hS,useExisting:hI},{provide:iI,useExisting:aI},{provide:aI,useClass:aI,deps:[RO]},{provide:cO,useClass:cO,deps:[tO]},{provide:nI,useClass:nI,deps:[tI,tO]},{provide:ZT,useClass:eI,deps:[]},[]],SI=function(){var e=function(){function e(t){if(sp(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return cp(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:LP,useValue:t.appId},{provide:JT,useExisting:LP},QT]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(e,12))},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({providers:EI,imports:[GT,IO]}),e}();"undefined"!=typeof window&&window;var PI=Array.isArray,OI=Object.getPrototypeOf,TI=Object.prototype,II=Object.keys;function xI(e){if(1===e.length){var t=e[0];if(PI(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&OI(e)===TI}(t)){var n=II(t);return{args:n.map(function(e){return t[e]}),keys:n}}}return{args:e,keys:null}}var AI=Array.isArray;function RI(e){return Hp(function(t){return function(e,t){return AI(t)?e.apply(void 0,np(t)):e(t)}(e,t)})}function NI(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}var MI=function(){var e=function(){function e(t,n){sp(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return cp(e,[{key:"setProperty",value:function(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"setDisabledState",value:function(e){this.setProperty("disabled",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(fS),fb(cS))},e.\u0275dir=fy({type:e}),e}(),DI=function(){var e,t=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n)}(MI);return t.\u0275fac=function(n){return(e||(e=sk(t)))(n||t)},t.\u0275dir=fy({type:t,features:[jC]}),t}(),LI=new fk("NgValueAccessor"),FI={provide:LI,useExisting:Cg(function(){return UI}),multi:!0},BI=new fk("CompositionEventMode"),UI=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r))._compositionMode=i,a._composing=!1,null==a._compositionMode&&(a._compositionMode=!function(){var e=AO()?AO().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}()),a}return cp(n,[{key:"writeValue",value:function(e){this.setProperty("value",null!=e?e:"")}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),n}(MI);return e.\u0275fac=function(t){return new(t||e)(fb(fS),fb(cS),fb(BI,8))},e.\u0275dir=fy({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&bb("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[nS([FI]),jC]}),e}();function VI(e){return null==e||0===e.length}function zI(e){return null!=e&&"number"==typeof e.length}var HI=new fk("NgValidators"),GI=new fk("NgAsyncValidators"),qI=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,$I=function(){function e(){sp(this,e)}return cp(e,null,[{key:"min",value:function(e){return function(e){return function(t){if(VI(t.value)||VI(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}(e)}},{key:"max",value:function(e){return function(e){return function(t){if(VI(t.value)||VI(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}(e)}},{key:"required",value:function(e){return WI(e)}},{key:"requiredTrue",value:function(e){return function(e){return!0===e.value?null:{required:!0}}(e)}},{key:"email",value:function(e){return function(e){return VI(e.value)||qI.test(e.value)?null:{email:!0}}(e)}},{key:"minLength",value:function(e){return function(e){return function(t){return VI(t.value)||!zI(t.value)?null:t.value.length<e?{minlength:{requiredLength:e,actualLength:t.value.length}}:null}}(e)}},{key:"maxLength",value:function(e){return jI(e)}},{key:"pattern",value:function(e){return function(e){return e?("string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),function(e){if(VI(e.value))return null;var r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}):ZI;var t,n}(e)}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){return ex(e)}},{key:"composeAsync",value:function(e){return nx(e)}}]),e}();function WI(e){return VI(e.value)?{required:!0}:null}function jI(e){return function(t){return zI(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}}function ZI(e){return null}function YI(e){return null!=e}function KI(e){var t=wb(e)?vg(e):e;return Cb(t),t}function JI(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function QI(e,t){return t.map(function(t){return t(e)})}function XI(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function ex(e){if(!e)return null;var t=e.filter(YI);return 0==t.length?null:function(e){return JI(QI(e,t))}}function tx(e){return null!=e?ex(XI(e)):null}function nx(e){if(!e)return null;var t=e.filter(YI);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=cg(t),i=xI(t),a=i.args,o=i.keys,s=new Mp(function(e){var t=a.length;if(t)for(var n=new Array(t),r=t,i=t,s=function(t){var s=!1;ng(a[t]).subscribe(new zp(e,function(e){s||(s=!0,i--),n[t]=e},function(){return r--},void 0,function(){(!r||!s)&&(i||e.next(o?NI(o,n):n),e.complete())}))},u=0;u<t;u++)s(u);else e.complete()});return r?s.pipe(RI(r)):s}(QI(e,t).map(KI)).pipe(Hp(JI))}}function rx(e){return null!=e?nx(XI(e)):null}function ix(e,t){return null===e?[t]:Array.isArray(e)?[].concat(np(e),[t]):[e,t]}function ax(e){return e._rawValidators}function ox(e){return e._rawAsyncValidators}function sx(e){return e?Array.isArray(e)?e:[e]:[]}function ux(e,t){return Array.isArray(e)?e.includes(t):e===t}function cx(e,t){var n=sx(t);return sx(e).forEach(function(e){ux(n,e)||n.push(e)}),n}function lx(e,t){return sx(t).filter(function(t){return!ux(e,t)})}var hx=function(){var e=function(){function e(){sp(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return cp(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=tx(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=rx(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=fy({type:e}),e}(),fx=function(){var e,t=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(hx);return t.\u0275fac=function(n){return(e||(e=sk(t)))(n||t)},t.\u0275dir=fy({type:t,features:[jC]}),t}(),dx=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return cp(n)}(hx),vx=function(){function e(t){sp(this,e),this._cd=t}return cp(e,[{key:"is",value:function(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}]),e}(),px=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){return sp(this,n),t.call(this,e)}return cp(n)}(vx);return e.\u0275fac=function(t){return new(t||e)(fb(dx,2))},e.\u0275dir=fy({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&Nb("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[jC]}),e}(),gx=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){return sp(this,n),t.call(this,e)}return cp(n)}(vx);return e.\u0275fac=function(t){return new(t||e)(fb(fx,10))},e.\u0275dir=fy({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&Nb("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[jC]}),e}();function yx(e,t){return[].concat(np(t.path),[e])}function mx(e,t){wx(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&bx(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&bx(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function kx(e,t){var n=function(){};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),Cx(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(function(){}))}function _x(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function wx(e,t){var n=ax(e);null!==t.validator?e.setValidators(ix(n,t.validator)):"function"==typeof n&&e.setValidators([n]);var r=ox(e);null!==t.asyncValidator?e.setAsyncValidators(ix(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);var i=function(){return e.updateValueAndValidity()};_x(t._rawValidators,i),_x(t._rawAsyncValidators,i)}function Cx(e,t){var n=!1;if(null!==e){if(null!==t.validator){var r=ax(e);if(Array.isArray(r)&&r.length>0){var i=r.filter(function(e){return e!==t.validator});i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){var a=ox(e);if(Array.isArray(a)&&a.length>0){var o=a.filter(function(e){return e!==t.asyncValidator});o.length!==a.length&&(n=!0,e.setAsyncValidators(o))}}}var s=function(){};return _x(t._rawValidators,s),_x(t._rawAsyncValidators,s),n}function bx(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Ex(e,t){wx(e,t)}function Sx(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function Px(e,t){e._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function Ox(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===UI?n=e:function(e){return Object.getPrototypeOf(e.constructor)===DI}(e)?r=e:i=e}),i||r||n||null):null;var n,r,i}function Tx(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var Ix="VALID",xx="INVALID",Ax="PENDING",Rx="DISABLED";function Nx(e){return(Fx(e)?e.validators:e)||null}function Mx(e){return Array.isArray(e)?tx(e):e||null}function Dx(e,t){return(Fx(t)?t.asyncValidators:e)||null}function Lx(e){return Array.isArray(e)?rx(e):e||null}function Fx(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var Bx=function(){function e(t,n){sp(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=Mx(this._rawValidators),this._composedAsyncValidatorFn=Lx(this._rawAsyncValidators)}return cp(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return this.status===Ix}},{key:"invalid",get:function(){return this.status===xx}},{key:"pending",get:function(){return this.status==Ax}},{key:"disabled",get:function(){return this.status===Rx}},{key:"enabled",get:function(){return this.status!==Rx}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=Mx(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=Lx(e)}},{key:"addValidators",value:function(e){this.setValidators(cx(e,this._rawValidators))}},{key:"addAsyncValidators",value:function(e){this.setAsyncValidators(cx(e,this._rawAsyncValidators))}},{key:"removeValidators",value:function(e){this.setValidators(lx(e,this._rawValidators))}},{key:"removeAsyncValidators",value:function(e){this.setAsyncValidators(lx(e,this._rawAsyncValidators))}},{key:"hasValidator",value:function(e){return ux(this._rawValidators,e)}},{key:"hasAsyncValidator",value:function(e){return ux(this._rawAsyncValidators,e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status=Ax,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=Rx,this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=Ix,this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ix||this.status===Ax)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?Rx:Ix}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status=Ax,this._hasOwnPendingAsyncValidator=!0;var n=KI(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;var r=e;return t.forEach(function(e){r=r instanceof Vx?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof zx&&r.at(e)||null}),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new yP,this.statusChanges=new yP}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?Rx:this.errors?xx:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ax)?Ax:this._anyControlsHaveStatus(xx)?xx:Ix}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){Fx(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),Ux=function(e){Yv(n,e);var t=Jv(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return sp(this,n),(e=t.call(this,Nx(i),Dx(a,i)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(i),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!e.asyncValidator}),e}return cp(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){Tx(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){Tx(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(Bx),Vx=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,Nx(r),Dx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return cp(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"removeControl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof Ux?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var r=t.controls[n];r&&e(r,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var r=n[t],i=this.controls[r];if(this.contains(r)&&e(i))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(Bx),zx=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,Nx(r),Dx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return cp(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"insert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof Ux?e.value:e.getRawValue()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=ip(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(Bx),Hx={provide:fx,useExisting:Cg(function(){return qx})},Gx=Promise.resolve(null),qx=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new yP,i.form=new Vx({},tx(e),rx(r)),i}return cp(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;Gx.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),mx(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;Gx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),Tx(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;Gx.then(function(){var n=t._findContainer(e.path),r=new Vx({});Ex(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;Gx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;Gx.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Px(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(fx);return e.\u0275fac=function(t){return new(t||e)(fb(HI,10),fb(GI,10))},e.\u0275dir=fy({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&bb("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[nS([Hx]),jC]}),e}(),$x={provide:dx,useExisting:Cg(function(){return jx})},Wx=Promise.resolve(null),jx=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this)).control=new Ux,o._registered=!1,o.update=new yP,o._parent=e,o._setValidators(r),o._setAsyncValidators(i),o.valueAccessor=Ox(0,a),o}return cp(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),Sx(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?yx(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){mx(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;Wx.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;Wx.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}}]),n}(dx);return e.\u0275fac=function(t){return new(t||e)(fb(fx,9),fb(HI,10),fb(GI,10),fb(LI,10))},e.\u0275dir=fy({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[nS([$x]),jC,Sy]}),e}(),Zx=function(){var e=cp(function e(){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=fy({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e}(),Yx=function(){var e=cp(function e(){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({}),e}(),Kx={provide:LI,useExisting:Cg(function(){return Jx}),multi:!0},Jx=function(){var e,t=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"writeValue",value:function(e){this.setProperty("value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),n}(DI);return t.\u0275fac=function(n){return(e||(e=sk(t)))(n||t)},t.\u0275dir=fy({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&bb("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[nS([Kx]),jC]}),t}(),Qx=new fk("NgModelWithFormControlWarning"),Xx={provide:fx,useExisting:Cg(function(){return eA})},eA=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).validators=e,i.asyncValidators=r,i.submitted=!1,i._onCollectionChange=function(){return i._updateDomValue()},i.directives=[],i.form=null,i.ngSubmit=new yP,i._setValidators(e),i._setAsyncValidators(r),i}return cp(n,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}},{key:"ngOnDestroy",value:function(){this.form&&(Cx(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(function(){}))}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return mx(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){kx(e.control||null,e,!1),Tx(this.directives,e)}},{key:"addFormGroup",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormGroup",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormArray",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,Px(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach(function(t){var n=t.control,r=e.form.get(t.path);n!==r&&(kx(n||null,t),r instanceof Ux&&(mx(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_setUpFormContainer",value:function(e){var t=this.form.get(e.path);Ex(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"_cleanUpFormContainer",value:function(e){if(this.form){var t=this.form.get(e.path);t&&function(e,t){return Cx(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}},{key:"_updateRegistrations",value:function(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(function(){})}},{key:"_updateValidators",value:function(){wx(this.form,this),this._oldForm&&Cx(this._oldForm,this)}},{key:"_checkFormPresent",value:function(){}}]),n}(fx);return e.\u0275fac=function(t){return new(t||e)(fb(HI,10),fb(GI,10))},e.\u0275dir=fy({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&bb("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[nS([Xx]),jC,Sy]}),e}(),tA={provide:dx,useExisting:Cg(function(){return nA})},nA=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o){var s;return sp(this,n),(s=t.call(this))._ngModelWarningConfig=o,s._added=!1,s.update=new yP,s._ngModelWarningSent=!1,s._parent=e,s._setValidators(r),s._setAsyncValidators(i),s.valueAccessor=Ox(0,a),s}return cp(n,[{key:"isDisabled",set:function(e){}},{key:"ngOnChanges",value:function(e){this._added||this._setUpControl(),Sx(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"path",get:function(){return yx(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"_checkParentType",value:function(){}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}]),n}(dx);return e.\u0275fac=function(t){return new(t||e)(fb(fx,13),fb(HI,10),fb(GI,10),fb(LI,10),fb(Qx,8))},e.\u0275dir=fy({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[nS([tA]),jC,Sy]}),e._ngModelWarningSentOnce=!1,e}(),rA={provide:LI,useExisting:Cg(function(){return aA}),multi:!0};function iA(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var aA=function(){var e,t=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return cp(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);var n=iA(t,e);this.setProperty("value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(DI);return t.\u0275fac=function(n){return(e||(e=sk(t)))(n||t)},t.\u0275dir=fy({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&bb("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[nS([rA]),jC]}),t}(),oA=function(){var e=function(){function e(t,n,r){sp(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return cp(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(iA(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(cS),fb(fS),fb(aA,9))},e.\u0275dir=fy({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),sA={provide:LI,useExisting:Cg(function(){return cA}),multi:!0};function uA(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var cA=function(){var e,t=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return cp(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(void 0!==n.selectedOptions)for(var i=n.selectedOptions,a=0;a<i.length;a++){var o=i.item(a),s=t._getOptionValue(o.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var h=t._getOptionValue(l.value);r.push(h)}}t.value=r,e(r)}}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(DI);return t.\u0275fac=function(n){return(e||(e=sk(t)))(n||t)},t.\u0275dir=fy({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&bb("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[nS([sA]),jC]}),t}(),lA=function(){var e=function(){function e(t,n,r){sp(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return cp(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(uA(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(uA(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(cS),fb(fS),fb(cA,9))},e.\u0275dir=fy({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),hA={provide:HI,useExisting:Cg(function(){return fA}),multi:!0},fA=function(){var e=function(){function e(){sp(this,e),this._required=!1}return cp(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?WI(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=fy({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&ob("required",t.required?"":null)},inputs:{required:"required"},features:[nS([hA])]}),e}(),dA={provide:HI,useExisting:Cg(function(){return vA}),multi:!0},vA=function(){var e=function(){function e(){sp(this,e),this._validator=ZI}return cp(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return this.enabled()?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){this._validator=this.enabled()?jI(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):ZI}},{key:"enabled",value:function(){return null!=this.maxlength}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=fy({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&ob("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[nS([dA]),Sy]}),e}(),pA=function(){var e=cp(function e(){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({imports:[[Yx]]}),e}(),gA=function(){var e=cp(function e(){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({imports:[pA]}),e}(),yA=function(){var e=function(){function e(){sp(this,e)}return cp(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:Qx,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({imports:[pA]}),e}(),mA=function(){var e=function(){function e(){sp(this,e)}return cp(e,[{key:"group",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),i=null,a=null;return null!=n&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(n)?(i=null!=n.validators?n.validators:null,a=null!=n.asyncValidators?n.asyncValidators:null,t=null!=n.updateOn?n.updateOn:void 0):(i=null!=n.validator?n.validator:null,a=null!=n.asyncValidator?n.asyncValidator:null)),new Vx(r,{asyncValidators:a,updateOn:t,validators:i})}},{key:"control",value:function(e,t,n){return new Ux(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map(function(e){return r._createControl(e)});return new zx(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._createControl(e[r])}),n}},{key:"_createControl",value:function(e){return e instanceof Ux||e instanceof Vx||e instanceof zx?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({factory:function(){return new e},token:e,providedIn:yA}),e}();function kA(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vg(t,lg(t))}function _A(e,t){return ep(t)?ag(e,t,1):ag(e,1)}function wA(e,t){return Vp(function(n,r){var i=0;n.subscribe(new zp(r,function(n){return e.call(t,n,i++)&&r.next(n)}))})}var CA=cp(function e(){sp(this,e)}),bA=cp(function e(){sp(this,e)}),EA=function(){function e(t){var n=this;sp(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),a=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(a):n.headers.set(i,[a])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return cp(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,np(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var a=this.headers.get(t);if(!a)return;0===(a=a.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),SA=function(){function e(){sp(this,e)}return cp(e,[{key:"encodeKey",value:function(e){return TA(e)}},{key:"encodeValue",value:function(e){return TA(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),PA=/%(\d[a-f0-9])/gi,OA={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function TA(e){return encodeURIComponent(e).replace(PA,function(e,t){var n;return null!==(n=OA[t])&&void 0!==n?n:e})}function IA(e){return"".concat(e)}var xA=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(sp(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new SA,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),i=Hv(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),a=i[0],o=i[1],s=n.get(a)||[];s.push(o),n.set(a,s)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}return cp(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(IA(t.value)),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(IA(t.value));-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}(),AA=function(){function e(){sp(this,e),this.map=new Map}return cp(e,[{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"get",value:function(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}},{key:"delete",value:function(e){return this.map.delete(e),this}},{key:"keys",value:function(){return this.map.keys()}}]),e}();function RA(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function NA(e){return"undefined"!=typeof Blob&&e instanceof Blob}function MA(e){return"undefined"!=typeof FormData&&e instanceof FormData}var DA=function(){function e(t,n,r,i){var a;if(sp(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new EA),this.context||(this.context=new AA),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new xA,this.urlWithParams=n}return cp(e,[{key:"serializeBody",value:function(){return null===this.body?null:RA(this.body)||NA(this.body)||MA(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof xA?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||MA(this.body)?null:NA(this.body)?this.body.type||null:RA(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof xA?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.method||this.method,i=n.url||this.url,a=n.responseType||this.responseType,o=void 0!==n.body?n.body:this.body,s=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,u=void 0!==n.reportProgress?n.reportProgress:this.reportProgress,c=n.headers||this.headers,l=n.params||this.params,h=null!==(t=n.context)&&void 0!==t?t:this.context;return void 0!==n.setHeaders&&(c=Object.keys(n.setHeaders).reduce(function(e,t){return e.set(t,n.setHeaders[t])},c)),n.setParams&&(l=Object.keys(n.setParams).reduce(function(e,t){return e.set(t,n.setParams[t])},l)),new e(r,i,o,{params:l,headers:c,context:h,reportProgress:u,responseType:a,withCredentials:s})}}]),e}(),LA=((LA=LA||{})[LA.Sent=0]="Sent",LA[LA.UploadProgress=1]="UploadProgress",LA[LA.ResponseHeader=2]="ResponseHeader",LA[LA.DownloadProgress=3]="DownloadProgress",LA[LA.Response=4]="Response",LA[LA.User=5]="User",LA),FA=cp(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";sp(this,e),this.headers=t.headers||new EA,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}),BA=function(e){Yv(n,e);var t=Jv(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return sp(this,n),(e=t.call(this,r)).type=LA.ResponseHeader,e}return cp(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(FA),UA=function(e){Yv(n,e);var t=Jv(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return sp(this,n),(e=t.call(this,r)).type=LA.Response,e.body=void 0!==r.body?r.body:null,e}return cp(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(FA),VA=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return cp(n)}(FA);function zA(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var HA=function(){var e=function(){function e(t){sp(this,e),this.handler=t}return cp(e,[{key:"request",value:function(e,t){var n,r,i,a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof DA?n=e:(r=o.headers instanceof EA?o.headers:new EA(o.headers),o.params&&(i=o.params instanceof xA?o.params:new xA({fromObject:o.params})),n=new DA(e,t,void 0!==o.body?o.body:null,{headers:r,context:o.context,params:i,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials}));var s=kA(n).pipe(_A(function(e){return a.handler.handle(e)}));if(e instanceof DA||"events"===o.observe)return s;var u=s.pipe(wA(function(e){return e instanceof UA}));switch(o.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(Hp(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(Hp(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(Hp(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));case"json":default:return u.pipe(Hp(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(o.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new xA).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,zA(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,zA(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,zA(n,t))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(CA))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),GA=function(){function e(t,n){sp(this,e),this.next=t,this.interceptor=n}return cp(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),qA=new fk("HTTP_INTERCEPTORS"),$A=function(){var e=function(){function e(){sp(this,e)}return cp(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),WA=/^\)\]\}',?\n/,jA=function(){var e=function(){function e(t){sp(this,e),this.xhrFactory=t}return cp(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Mp(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var a=e.responseType.toLowerCase();r.responseType="json"!==a?a:"text"}var o=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new EA(r.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new BA({headers:i,status:t,statusText:n,url:a})},c=function(){var t=u(),i=t.headers,a=t.status,o=t.statusText,s=t.url,c=null;204!==a&&(c=void 0===r.response?r.responseText:r.response),0===a&&(a=c?200:0);var l=a>=200&&a<300;if("json"===e.responseType&&"string"==typeof c){var h=c;c=c.replace(WA,"");try{c=""!==c?JSON.parse(c):null}catch(f){c=h,l&&(l=!1,c={error:f,text:c})}}l?(n.next(new UA({body:c,headers:i,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new VA({error:c,headers:i,status:a,statusText:o,url:s||void 0}))},l=function(e){var t=u().url,i=new VA({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},h=!1,f=function(t){h||(n.next(u()),h=!0);var i={type:LA.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&!!r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:LA.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),r.addEventListener("timeout",l),r.addEventListener("abort",l),e.reportProgress&&(r.addEventListener("progress",f),null!==o&&r.upload&&r.upload.addEventListener("progress",d)),r.send(o),n.next({type:LA.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("abort",l),r.removeEventListener("load",c),r.removeEventListener("timeout",l),e.reportProgress&&(r.removeEventListener("progress",f),null!==o&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(ZT))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),ZA=new fk("XSRF_COOKIE_NAME"),YA=new fk("XSRF_HEADER_NAME"),KA=cp(function e(){sp(this,e)}),JA=function(){var e=function(){function e(t,n,r){sp(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return cp(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=MT(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(RO),Rk(VP),Rk(ZA))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),QA=function(){var e=function(){function e(t,n){sp(this,e),this.tokenService=t,this.headerName=n}return cp(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(KA),Rk(YA))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),XA=function(){var e=function(){function e(t,n){sp(this,e),this.backend=t,this.injector=n,this.chain=null}return cp(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(qA,[]);this.chain=t.reduceRight(function(e,t){return new GA(e,t)},this.backend)}return this.chain.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(bA),Rk($C))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),eR=function(){var e=function(){function e(){sp(this,e)}return cp(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:QA,useClass:$A}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:ZA,useValue:t.cookieName}:[],t.headerName?{provide:YA,useValue:t.headerName}:[]]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({providers:[QA,{provide:qA,useExisting:QA,multi:!0},{provide:KA,useClass:JA},{provide:ZA,useValue:"XSRF-TOKEN"},{provide:YA,useValue:"X-XSRF-TOKEN"}]}),e}(),tR=function(){var e=cp(function e(){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({providers:[HA,{provide:CA,useClass:XA},jA,{provide:bA,useExisting:jA}],imports:[[eR.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e}(),nR=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this))._value=e,r}return cp(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=jv(tp(n.prototype),"_subscribe",this).call(this,e);return!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){var e=this.hasError,t=this.thrownError,n=this._value;if(e)throw t;return this._throwIfClosed(),n}},{key:"next",value:function(e){jv(tp(n.prototype),"next",this).call(this,this._value=e)}}]),n}(Fp);function rR(e,t,n){e?ig(n,e,t):t()}var iR=rp(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function aR(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return og(1)(vg(t,lg(t)))}function oR(e){return new Mp(function(t){ng(e()).subscribe(t)})}function sR(){return Vp(function(e,t){var n=null;e._refCount++;var r=new zp(t,void 0,void 0,void 0,function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()}});e.subscribe(r),r.closed||(n=e.connect())})}var uR=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._subject=null,i._refCount=0,i._connection=null,Up(e)&&(i.lift=e.lift),i}return cp(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"_teardown",value:function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()}},{key:"connect",value:function(){var e=this,t=this._connection;if(!t){t=this._connection=new lp;var n=this.getSubject();t.add(this.source.subscribe(new zp(n,void 0,function(){e._teardown(),n.complete()},function(t){e._teardown(),n.error(t)},function(){return e._teardown()}))),t.closed&&(this._connection=null,t=lp.EMPTY)}return t}},{key:"refCount",value:function(){return sR()(this)}}]),n}(Mp);function cR(e,t){return Vp(function(n,r){var i=null,a=0,o=!1,s=function(){return o&&!i&&r.complete()};n.subscribe(new zp(r,function(n){null==i||i.unsubscribe();var o=0,u=a++;ng(e(n,u)).subscribe(i=new zp(r,function(e){return r.next(t?t(n,e,u,o++):e)},function(){i=null,s()}))},function(){o=!0,s()}))})}function lR(e,t,n,r,i){return function(a,o){var s=n,u=t,c=0;a.subscribe(new zp(o,function(t){var n=c++;u=s?e(u,t,n):(s=!0,t),r&&o.next(u)},i&&function(){s&&o.next(u),o.complete()}))}}function hR(e,t){return Vp(lR(e,t,arguments.length>=2,!0))}function fR(e){return Vp(function(t,n){var r,i=null,a=!1;i=t.subscribe(new zp(n,void 0,void 0,function(o){r=ng(e(o,fR(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function dR(e){return e<=0?function(){return sg}:Vp(function(t,n){var r=[];t.subscribe(new zp(n,function(t){r.push(t),e<r.length&&r.shift()},function(){var e,t=ip(r);try{for(t.s();!(e=t.n()).done;){var i=e.value;n.next(i)}}catch(a){t.e(a)}finally{t.f()}n.complete()},void 0,function(){r=null}))})}function vR(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pR;return Vp(function(t,n){var r=!1;t.subscribe(new zp(n,function(e){r=!0,n.next(e)},function(){return r?n.complete():n.error(e())}))})}function pR(){return new iR}function gR(e){return Vp(function(t,n){var r=!1;t.subscribe(new zp(n,function(e){r=!0,n.next(e)},function(){r||n.next(e),n.complete()}))})}function yR(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?wA(function(t,n){return e(t,n,r)}):Np,pg(1),n?gR(t):vR(function(){return new iR}))}}function mR(e,t,n){var r=ep(e)||t||n?{next:e,error:t,complete:n}:e;return r?Vp(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(new zp(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):Np}var kR=cp(function e(t,n){sp(this,e),this.id=t,this.url=n}),_R=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return sp(this,n),(i=t.call(this,e,r)).navigationTrigger=a,i.restoredState=o,i}return cp(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(kR),wR=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a}return cp(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(kR),CR=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r)).reason=i,a}return cp(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(kR),bR=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r)).error=i,a}return cp(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(kR),ER=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return cp(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kR),SR=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return cp(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kR),PR=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o){var s;return sp(this,n),(s=t.call(this,e,r)).urlAfterRedirects=i,s.state=a,s.shouldActivate=o,s}return cp(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(kR),OR=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return cp(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kR),TR=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return cp(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(kR),IR=function(){function e(t){sp(this,e),this.route=t}return cp(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),xR=function(){function e(t){sp(this,e),this.route=t}return cp(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),AR=function(){function e(t){sp(this,e),this.snapshot=t}return cp(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),RR=function(){function e(t){sp(this,e),this.snapshot=t}return cp(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),NR=function(){function e(t){sp(this,e),this.snapshot=t}return cp(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),MR=function(){function e(t){sp(this,e),this.snapshot=t}return cp(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),DR=function(){function e(t,n,r){sp(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return cp(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),LR="primary",FR=function(){function e(t){sp(this,e),this.params=t||{}}return cp(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function BR(e){return new FR(e)}var UR="ngNavigationCancelingError";function VR(e){var t=Error("NavigationCancelingError: "+e);return t[UR]=!0,t}function zR(e,t,n){var r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},a=0;a<r.length;a++){var o=r[a],s=e[a];if(o.startsWith(":"))i[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function HR(e,t){var n,r=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!r||!i||r.length!=i.length)return!1;for(var a=0;a<r.length;a++)if(!GR(e[n=r[a]],t[n]))return!1;return!0}function GR(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=np(e).sort(),r=np(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function qR(e){return Array.prototype.concat.apply([],e)}function $R(e){return e.length>0?e[e.length-1]:null}function WR(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function jR(e){return Cb(e)?e:wb(e)?vg(Promise.resolve(e)):kA(e)}var ZR={exact:function e(t,n,r){if(!rN(t.segments,n.segments)||!XR(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(var i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:JR},YR={exact:function(e,t){return HR(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return GR(e[n],t[n])})},ignored:function(){return!0}};function KR(e,t,n){return ZR[n.paths](e.root,t.root,n.matrixParams)&&YR[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function JR(e,t,n){return QR(e,t,t.segments,n)}function QR(e,t,n,r){if(e.segments.length>n.length){var i=e.segments.slice(0,n.length);return!(!rN(i,n)||t.hasChildren()||!XR(i,n,r))}if(e.segments.length===n.length){if(!rN(e.segments,n)||!XR(e.segments,n,r))return!1;for(var a in t.children)if(!e.children[a]||!JR(e.children[a],t.children[a],r))return!1;return!0}var o=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(rN(e.segments,o)&&XR(e.segments,o,r)&&e.children[LR])&&QR(e.children[LR],t,s,r)}function XR(e,t,n){return t.every(function(t,r){return YR[n](e[r].parameters,t.parameters)})}var eN=function(){function e(t,n,r){sp(this,e),this.root=t,this.queryParams=n,this.fragment=r}return cp(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=BR(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return oN.serialize(this)}}]),e}(),tN=function(){function e(t,n){var r=this;sp(this,e),this.segments=t,this.children=n,this.parent=null,WR(n,function(e,t){return e.parent=r})}return cp(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return sN(this)}}]),e}(),nN=function(){function e(t,n){sp(this,e),this.path=t,this.parameters=n}return cp(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=BR(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return vN(this)}}]),e}();function rN(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}var iN=cp(function e(){sp(this,e)}),aN=function(){function e(){sp(this,e)}return cp(e,[{key:"parse",value:function(e){var t=new kN(e);return new eN(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t;return"".concat("/".concat(uN(e.root,!0)),function(e){var t=Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return"".concat(lN(t),"=").concat(lN(e))}).join("&"):"".concat(lN(t),"=").concat(lN(n))}).filter(function(e){return!!e});return t.length?"?".concat(t.join("&")):""}(e.queryParams)).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),oN=new aN;function sN(e){return e.segments.map(function(e){return vN(e)}).join("/")}function uN(e,t){if(!e.hasChildren())return sN(e);if(t){var n=e.children[LR]?uN(e.children[LR],!1):"",r=[];return WR(e.children,function(e,t){t!==LR&&r.push("".concat(t,":").concat(uN(e,!1)))}),r.length>0?"".concat(n,"(").concat(r.join("//"),")"):n}var i=function(e,t){var n=[];return WR(e.children,function(e,r){r===LR&&(n=n.concat(t(e,r)))}),WR(e.children,function(e,r){r!==LR&&(n=n.concat(t(e,r)))}),n}(e,function(t,n){return n===LR?[uN(e.children[LR],!1)]:["".concat(n,":").concat(uN(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children[LR]?"".concat(sN(e),"/").concat(i[0]):"".concat(sN(e),"/(").concat(i.join("//"),")")}function cN(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function lN(e){return cN(e).replace(/%3B/gi,";")}function hN(e){return cN(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function fN(e){return decodeURIComponent(e)}function dN(e){return fN(e.replace(/\+/g,"%20"))}function vN(e){return"".concat(hN(e.path)).concat(function(e){return Object.keys(e).map(function(t){return";".concat(hN(t),"=").concat(hN(e[t]))}).join("")}(e.parameters))}var pN=/^[^\/()?;=#]+/;function gN(e){var t=e.match(pN);return t?t[0]:""}var yN=/^[^=?&#]+/,mN=/^[^?&#]+/,kN=function(){function e(t){sp(this,e),this.url=t,this.remaining=t}return cp(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new tN([],{}):new tN([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[LR]=new tN(e,t)),n}},{key:"parseSegment",value:function(){var e=gN(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new nN(fN(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=gN(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=gN(this.remaining);r&&(n=r,this.capture(n))}e[fN(t)]=fN(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(yN);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(mN);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=dN(t),a=dN(n);if(e.hasOwnProperty(i)){var o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(a)}else e[i]=a}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=gN(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=LR);var a=this.parseChildren();t[i]=1===Object.keys(a).length?a[LR]:new tN([],a),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),_N=function(){function e(t){sp(this,e),this._root=t}return cp(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=wN(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=wN(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=CN(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return CN(e,this._root).map(function(e){return e.value})}}]),e}();function wN(e,t){if(e===t.value)return t;var n,r=ip(t.children);try{for(r.s();!(n=r.n()).done;){var i=wN(e,n.value);if(i)return i}}catch(a){r.e(a)}finally{r.f()}return null}function CN(e,t){if(e===t.value)return[t];var n,r=ip(t.children);try{for(r.s();!(n=r.n()).done;){var i=CN(e,n.value);if(i.length)return i.unshift(t),i}}catch(a){r.e(a)}finally{r.f()}return[]}var bN=function(){function e(t,n){sp(this,e),this.value=t,this.children=n}return cp(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function EN(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var SN=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e)).snapshot=r,AN(Xv(i),e),i}return cp(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(_N);function PN(e,t){var n=function(e,t){var n=new IN([],{},{},"",{},LR,t,null,e.root,-1,{});return new xN("",new bN(n,[]))}(e,t),r=new nR([new nN("",{})]),i=new nR({}),a=new nR({}),o=new nR({}),s=new nR(""),u=new ON(r,i,o,s,a,LR,t,n.root);return u.snapshot=n.root,new SN(new bN(u,[]),n)}var ON=function(){function e(t,n,r,i,a,o,s,u){sp(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=u}return cp(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(Hp(function(e){return BR(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Hp(function(e){return BR(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function TN(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],a=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var IN=function(){function e(t,n,r,i,a,o,s,u,c,l,h){sp(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=h}return cp(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=BR(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=BR(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),xN=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,r)).url=e,AN(Xv(i),r),i}return cp(n,[{key:"toString",value:function(){return RN(this._root)}}]),n}(_N);function AN(e,t){t.value._routerState=e,t.children.forEach(function(t){return AN(e,t)})}function RN(e){var t=e.children.length>0?" { ".concat(e.children.map(RN).join(", ")," } "):"";return"".concat(e.value).concat(t)}function NN(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,HR(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),HR(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!HR(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),HR(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function MN(e,t){return HR(e.params,t.params)&&function(e,t){return rN(e,t)&&e.every(function(e,n){return HR(e.parameters,t[n].parameters)})}(e.url,t.url)&&!(!e.parent!=!t.parent)&&(!e.parent||MN(e.parent,t.parent))}function DN(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){var r=n.value;r._futureSnapshot=t.value;var i=function(e,t,n){return t.children.map(function(t){var r,i=ip(n.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(e.shouldReuseRoute(t.value,a.value.snapshot))return DN(e,t,a)}}catch(o){i.e(o)}finally{i.f()}return DN(e,t)})}(e,t,n);return new bN(r,i)}if(e.shouldAttach(t.value)){var a=e.retrieve(t.value);if(null!==a){var o=a.route;return LN(t,o),o}}var s=function(e){return new ON(new nR(e.url),new nR(e.params),new nR(e.queryParams),new nR(e.fragment),new nR(e.data),e.outlet,e.component,e)}(t.value),u=t.children.map(function(t){return DN(e,t)});return new bN(s,u)}function LN(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var n=0;n<e.children.length;++n)LN(e.children[n],t.children[n])}function FN(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function BN(e){return"object"==typeof e&&null!=e&&e.outlets}function UN(e,t,n,r,i){var a={};return r&&WR(r,function(e,t){a[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new eN(n.root===e?t:VN(n.root,e,t),a,i)}function VN(e,t,n){var r={};return WR(e.children,function(e,i){r[i]=e===t?n:VN(e,t,n)}),new tN(e.segments,r)}var zN=function(){function e(t,n,r){if(sp(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&FN(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(BN);if(i&&i!==$R(r))throw new Error("{outlets:{}} has to be the last command")}return cp(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),HN=cp(function e(t,n,r){sp(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r});function GN(e,t,n){if(e||(e=new tN([],{})),0===e.segments.length&&e.hasChildren())return qN(e,t,n);var r=function(e,t,n){for(var r=0,i=t,a={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return a;var o=e.segments[i],s=n[r];if(BN(s))break;var u="".concat(s),c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!ZN(u,c,o))return a;r+=2}else{if(!ZN(u,{},o))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var a=new tN(e.segments.slice(0,r.pathIndex),{});return a.children[LR]=new tN(e.segments.slice(r.pathIndex),e.children),qN(a,0,i)}return r.match&&0===i.length?new tN(e.segments,{}):r.match&&!e.hasChildren()?$N(e,t,n):r.match?qN(e,0,i):$N(e,t,n)}function qN(e,t,n){if(0===n.length)return new tN(e.segments,{});var r=function(e){return BN(e[0])?e[0].outlets:zv({},LR,e)}(n),i={};return WR(r,function(n,r){"string"==typeof n&&(n=[n]),null!==n&&(i[r]=GN(e.children[r],t,n))}),WR(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new tN(e.segments,i)}function $N(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){var a=n[i];if(BN(a)){var o=WN(a.outlets);return new tN(r,o)}if(0===i&&FN(n[0]))r.push(new nN(e.segments[t].path,jN(n[0]))),i++;else{var s=BN(a)?a.outlets[LR]:"".concat(a),u=i<n.length-1?n[i+1]:null;s&&u&&FN(u)?(r.push(new nN(s,jN(u))),i+=2):(r.push(new nN(s,{})),i++)}}return new tN(r,{})}function WN(e){var t={};return WR(e,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(t[n]=$N(new tN([],{}),0,e))}),t}function jN(e){var t={};return WR(e,function(e,n){return t[n]="".concat(e)}),t}function ZN(e,t,n){return e==n.path&&HR(t,n.parameters)}var YN=function(){function e(t,n,r,i){sp(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return cp(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),NN(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=EN(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),WR(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=EN(e),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];this.deactivateRouteAndItsChildren(i[s],r)}n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=EN(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new MR(e.value.snapshot))}),e.children.length&&this.forwardEvent(new RR(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(NN(r),r===i)if(r.component){var a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),KN(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function KN(e){NN(e.value),e.children.forEach(KN)}var JN=cp(function e(t,n){sp(this,e),this.routes=t,this.module=n});function QN(e){return"function"==typeof e}function XN(e){return e instanceof eN}var eM=Symbol("INITIAL_VALUE");function tM(){return cR(function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=lg(t),i=cg(t),a=xI(t),o=a.args,s=a.keys;if(0===o.length)return vg([],r);var u=new Mp(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Np;return function(r){rR(t,function(){for(var i=e.length,a=new Array(i),o=i,s=i,u=function(i){rR(t,function(){var u=vg(e[i],t),c=!1;u.subscribe(new zp(r,function(e){a[i]=e,c||(c=!0,s--),s||r.next(n(a.slice()))},function(){--o||r.complete()}))},r)},c=0;c<i;c++)u(c)},r)}}(o,r,s?function(e){return NI(s,e)}:Np));return i?u.pipe(RI(i)):u}(e.map(function(e){return e.pipe(pg(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=lg(t);return Vp(function(e,n){(r?aR(t,e,r):aR(t,e)).subscribe(n)})}(eM))})).pipe(hR(function(e,t){var n=!1;return t.reduce(function(e,r,i){return e!==eM?e:(r===eM&&(n=!0),n||!1!==r&&i!==t.length-1&&!XN(r)?e:r)},e)},eM),wA(function(e){return e!==eM}),Hp(function(e){return XN(e)?e:!0===e}),pg(1))})}var nM=function(){var e=cp(function e(){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=oy({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&yb(0,"router-outlet")},directives:function(){return[XM]},encapsulation:2}),e}();function rM(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];iM(r,aM(t,r))}}function iM(e,t){e.children&&rM(e.children,t)}function aM(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function oM(e){var t=e.children&&e.children.map(oM),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==LR&&(n.component=nM),n}function sM(e){return e.outlet||LR}function uM(e,t){var n=e.filter(function(e){return sM(e)===t});return n.push.apply(n,np(e.filter(function(e){return sM(e)!==t}))),n}var cM={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function lM(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},cM):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var i=(t.matcher||zR)(n,e,t);if(!i)return Object.assign({},cM);var a={};WR(i.posParams,function(e,t){a[t]=e.path});var o=i.consumed.length>0?Object.assign(Object.assign({},a),i.consumed[i.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function hM(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(n.length>0&&function(e,t,n){return n.some(function(n){return fM(e,t,n)&&sM(n)!==LR})}(e,n,r)){var a=new tN(t,function(e,t,n,r){var i={};i[LR]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var a,o=ip(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&sM(s)!==LR){var u=new tN([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,i[sM(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return i}(e,t,r,new tN(n,e.children)));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(function(n){return fM(e,t,n)})}(e,n,r)){var o=new tN(e.segments,function(e,t,n,r,i,a){var o,s={},u=ip(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(fM(e,n,c)&&!i[sM(c)]){var l=new tN([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===a?e.segments.length:t.length,s[sM(c)]=l}}}catch(h){u.e(h)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new tN(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function fM(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function dM(e,t,n,r){return!!(sM(e)===r||r!==LR&&fM(t,n,e))&&("**"===e.path||lM(t,e,n).matched)}function vM(e,t,n){return 0===t.length&&!e.children[n]}var pM=cp(function e(t){sp(this,e),this.segmentGroup=t||null}),gM=cp(function e(t){sp(this,e),this.urlTree=t});function yM(e){return new Mp(function(t){return t.error(new pM(e))})}function mM(e){return new Mp(function(t){return t.error(new gM(e))})}function kM(e){return new Mp(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var _M=function(){function e(t,n,r,i,a){sp(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=t.get(GS)}return cp(e,[{key:"apply",value:function(){var e=this,t=hM(this.urlTree.root,[],[],this.config).segmentGroup,n=new tN(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,LR).pipe(Hp(function(t){return e.createUrlTree(wM(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(fR(function(t){if(t instanceof gM)return e.allowRedirects=!1,e.match(t.urlTree);throw t instanceof pM?e.noMatchError(t):t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,LR).pipe(Hp(function(n){return t.createUrlTree(wM(n),e.queryParams,e.fragment)})).pipe(fR(function(e){throw e instanceof pM?t.noMatchError(e):e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new tN([],zv({},LR,e)):e;return new eN(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Hp(function(e){return new tN([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){for(var r=this,i=[],a=0,o=Object.keys(n.children);a<o.length;a++){var s=o[a];"primary"===s?i.unshift(s):i.push(s)}return vg(i).pipe(_A(function(i){var a=n.children[i],o=uM(t,i);return r.expandSegmentGroup(e,o,a,i).pipe(Hp(function(e){return{segment:e,outlet:i}}))}),hR(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?wA(function(t,n){return e(t,n,r)}):Np,dR(1),n?gR(t):vR(function(){return new iR}))}}())}},{key:"expandSegment",value:function(e,t,n,r,i,a){var o=this;return vg(n).pipe(_A(function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,i,a).pipe(fR(function(e){if(e instanceof pM)return kA(null);throw e}))}),yR(function(e){return!!e}),fR(function(e,n){if(e instanceof iR||"EmptyError"===e.name){if(vM(t,r,i))return kA(new tN([],{}));throw new pM(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,a,o){return dM(r,t,i,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a):yM(t):yM(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?mM(a):this.lineralizeSegments(n,a).pipe(ag(function(n){var a=new tN(n,{});return i.expandSegment(e,a,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){var o=this,s=lM(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,h=s.positionalParamSegments;if(!u)return yM(t);var f=this.applyRedirectCommands(c,r.redirectTo,h);return r.redirectTo.startsWith("/")?mM(f):this.lineralizeSegments(r,f).pipe(ag(function(r){return o.expandSegment(e,t,n,r.concat(i.slice(l)),a,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r,i){var a=this;if("**"===n.path)return n.loadChildren?(n._loadedConfig?kA(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(Hp(function(e){return n._loadedConfig=e,new tN(r,{})})):kA(new tN(r,{}));var o=lM(t,n,r),s=o.matched,u=o.consumedSegments,c=o.lastChild;if(!s)return yM(t);var l=r.slice(c);return this.getChildConfig(e,n,r).pipe(ag(function(e){var r=e.module,o=e.routes,s=hM(t,u,l,o),c=s.segmentGroup,h=s.slicedSegments,f=new tN(c.segments,c.children);if(0===h.length&&f.hasChildren())return a.expandChildren(r,o,f).pipe(Hp(function(e){return new tN(u,e)}));if(0===o.length&&0===h.length)return kA(new tN(u,{}));var d=sM(n)===i;return a.expandSegment(r,f,o,h,d?LR:i,!0).pipe(Hp(function(e){return new tN(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?kA(new JN(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?kA(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(ag(function(n){return n?r.configLoader.load(e.injector,t).pipe(Hp(function(e){return t._loadedConfig=e,e})):(i=t,new Mp(function(e){return e.error(VR("Cannot load children because the guard of the route \"path: '".concat(i.path,"'\" returned false")))}));var i})):kA(new JN([],e))}},{key:"runCanLoadGuards",value:function(e,t,n){var r=this,i=t.canLoad;return i&&0!==i.length?kA(i.map(function(r){var i,a,o=e.get(r);if((a=o)&&QN(a.canLoad))i=o.canLoad(t,n);else{if(!QN(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return jR(i)})).pipe(tM(),mR(function(e){if(XN(e)){var t=VR('Redirecting to "'.concat(r.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),Hp(function(e){return!0===e})):kA(!0)}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return kA(n);if(r.numberOfChildren>1||!r.children[LR])return kM(e.redirectTo);r=r.children[LR]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new eN(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return WR(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,a=this.createSegments(e,t.segments,n,r),o={};return WR(t.children,function(t,a){o[a]=i.createSegmentGroup(e,t,n,r)}),new tN(a,o)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,i=ip(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.path===e.path)return t.splice(r),a;r++}}catch(o){i.e(o)}finally{i.f()}return e}}]),e}();function wM(e){for(var t={},n=0,r=Object.keys(e.children);n<r.length;n++){var i=r[n],a=wM(e.children[i]);(a.segments.length>0||a.hasChildren())&&(t[i]=a)}return function(e){if(1===e.numberOfChildren&&e.children[LR]){var t=e.children[LR];return new tN(e.segments.concat(t.segments),t.children)}return e}(new tN(e.segments,t))}var CM=cp(function e(t){sp(this,e),this.path=t,this.route=this.path[this.path.length-1]}),bM=cp(function e(t,n){sp(this,e),this.component=t,this.route=n});function EM(e,t,n){var r=e._root;return PM(r,t?t._root:null,n,[r.value])}function SM(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function PM(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=EN(t);return e.children.forEach(function(e){(function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=e.value,o=t?t.value:null,s=n?n.getContext(e.value.outlet):null;if(o&&a.routeConfig===o.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!rN(e.url,t.url);case"pathParamsOrQueryParamsChange":return!rN(e.url,t.url)||!HR(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!MN(e,t)||!HR(e.queryParams,t.queryParams);case"paramsChange":default:return!MN(e,t)}}(o,a,a.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new CM(r)):(a.data=o.data,a._resolvedData=o._resolvedData),PM(e,t,a.component?s?s.children:null:n,r,i),u&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new bM(s.outlet.component,o))}else o&&OM(t,s,i),i.canActivateChecks.push(new CM(r)),PM(e,null,a.component?s?s.children:null:n,r,i)})(e,a[e.value.outlet],n,r.concat([e.value]),i),delete a[e.value.outlet]}),WR(a,function(e,t){return OM(e,n.getContext(t),i)}),i}function OM(e,t,n){var r=EN(e),i=e.value;WR(r,function(e,r){OM(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new bM(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var TM=cp(function e(){sp(this,e)});function IM(e){return new Mp(function(t){return t.error(e)})}var xM=function(){function e(t,n,r,i,a,o){sp(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return cp(e,[{key:"recognize",value:function(){var e=hM(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,LR);if(null===t)return null;var n=new IN([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},LR,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new bN(n,t),i=new xN(this.url,r);return this.inheritParamsAndData(i._root),i}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=TN(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,i=Object.keys(t.children);r<i.length;r++){var a=i[r],o=t.children[a],s=uM(e,a),u=this.processSegmentGroup(s,o,a);if(null===u)return null;n.push.apply(n,np(u))}var c=AM(n);return c.sort(function(e,t){return e.value.outlet===LR?-1:t.value.outlet===LR?1:e.value.outlet.localeCompare(t.value.outlet)}),c}},{key:"processSegment",value:function(e,t,n,r){var i,a=ip(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this.processSegmentAgainstRoute(o,t,n,r);if(null!==s)return s}}catch(u){a.e(u)}finally{a.f()}return vM(t,n,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo||!dM(e,t,n,r))return null;var i,a=[],o=[];if("**"===e.path){var s=n.length>0?$R(n).parameters:{};i=new IN(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,MM(e),sM(e),e.component,e,RM(t),NM(t)+n.length,DM(e))}else{var u=lM(t,e,n);if(!u.matched)return null;a=u.consumedSegments,o=n.slice(u.lastChild),i=new IN(a,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,MM(e),sM(e),e.component,e,RM(t),NM(t)+a.length,DM(e))}var c,l=(c=e).children?c.children:c.loadChildren?c._loadedConfig.routes:[],h=hM(t,a,o,l.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),f=h.segmentGroup,d=h.slicedSegments;if(0===d.length&&f.hasChildren()){var v=this.processChildren(l,f);return null===v?null:[new bN(i,v)]}if(0===l.length&&0===d.length)return[new bN(i,[])];var p=sM(e)===r,g=this.processSegment(l,f,d,p?LR:r);return null===g?null:[new bN(i,g)]}}]),e}();function AM(e){var t,n=[],r=new Set,i=ip(e);try{var a=function(){var e,i=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(i))return n.push(i),"continue";var a=n.find(function(e){return i.value.routeConfig===e.value.routeConfig});void 0!==a?((e=a.children).push.apply(e,np(i.children)),r.add(a)):n.push(i)};for(i.s();!(t=i.n()).done;)a()}catch(l){i.e(l)}finally{i.f()}var o,s=ip(r);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=AM(u.children);n.push(new bN(u.value,c))}}catch(l){s.e(l)}finally{s.f()}return n.filter(function(e){return!r.has(e)})}function RM(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function NM(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function MM(e){return e.data||{}}function DM(e){return e.resolve||{}}function LM(e){return cR(function(t){var n=e(t);return n?vg(n).pipe(Hp(function(){return t})):kA(t)})}var FM=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n)}(function(){function e(){sp(this,e)}return cp(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),BM=new fk("ROUTES"),UM=function(){function e(t,n,r,i){sp(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return cp(e,[{key:"load",value:function(e,t){var n=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren).pipe(Hp(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new JN(qR(i.injector.get(BM,void 0,Vg.Self|Vg.Optional)).map(oM),i)}),fR(function(e){throw t._loader$=void 0,e}));return t._loader$=new uR(r,function(){return new Fp}).pipe(sR()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?vg(this.loader.load(e)):jR(e()).pipe(ag(function(e){return e instanceof qS?kA(e):vg(t.compiler.compileModuleAsync(e))}))}}]),e}(),VM=cp(function e(){sp(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new zM,this.attachRef=null}),zM=function(){function e(){sp(this,e),this.contexts=new Map}return cp(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new VM,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),HM=function(){function e(){sp(this,e)}return cp(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function GM(e){throw e}function qM(e,t,n){return t.parse("/")}function $M(e,t){return kA(null)}var WM={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},jM={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ZM=function(){var e=function(){function e(t,n,r,i,a,o,s,u){var c=this;sp(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Fp,this.errorHandler=GM,this.malformedUriErrorHandler=qM,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:$M,afterPreactivation:$M},this.urlHandlingStrategy=new HM,this.routeReuseStrategy=new FM,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(GS),this.console=a.get(HP);var l=a.get(tO);this.isNgZoneEnabled=l instanceof tO&&tO.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new eN(new tN([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new UM(o,s,function(e){return c.triggerEvent(new IR(e))},function(e){return c.triggerEvent(new xR(e))}),this.routerState=PN(this.currentUrlTree,this.rootComponentType),this.transitions=new nR({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return cp(e,[{key:"browserPageId",get:function(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}},{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(wA(function(e){return 0!==e.id}),Hp(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),cR(function(e){var r=!1,i=!1;return kA(e).pipe(mR(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),cR(function(e){var r=t.browserUrlTree.toString(),a=!t.navigated||e.extractedUrl.toString()!==r||r!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||a)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return YM(e.source)&&(t.browserUrlTree=e.extractedUrl),kA(e).pipe(cR(function(e){var r=t.transitions.getValue();return n.next(new _R(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?sg:Promise.resolve(e)}),function(e,t,n,r){return cR(function(i){return function(e,t,n,r,i){return new _M(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(Hp(function(e){return Object.assign(Object.assign({},i),{urlAfterRedirects:e})}))})}(t.ngModule.injector,t.configLoader,t.urlSerializer,t.config),mR(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,n,r,a,o){return ag(function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var s=new xM(e,t,n,r,a,o).recognize();return null===s?IM(new TM):kA(s)}catch(i){return IM(i)}}(e,n,r.urlAfterRedirects,(s=r.urlAfterRedirects,t.serializeUrl(s)),a,o).pipe(Hp(function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})}));var s})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),mR(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,e),t.browserUrlTree=e.urlAfterRedirects);var r=new ER(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(a&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var o=e.id,s=e.extractedUrl,u=e.source,c=e.restoredState,l=e.extras,h=new _R(o,t.serializeUrl(s),u,c);n.next(h);var f=PN(s,t.rootComponentType).snapshot;return kA(Object.assign(Object.assign({},e),{targetSnapshot:f,urlAfterRedirects:s,extras:Object.assign(Object.assign({},l),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),sg}),LM(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),mR(function(e){var n=new SR(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),Hp(function(e){return Object.assign(Object.assign({},e),{guards:EM(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return ag(function(n){var r=n.targetSnapshot,i=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?kA(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return vg(e).pipe(ag(function(e){return function(e,t,n,r,i){var a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?kA(a.map(function(a){var o,s=SM(a,t,i);if(function(e){return e&&QN(e.canDeactivate)}(s))o=jR(s.canDeactivate(e,t,n,r));else{if(!QN(s))throw new Error("Invalid CanDeactivate guard");o=jR(s(e,t,n,r))}return o.pipe(yR())})).pipe(tM()):kA(!0)}(e.component,e.route,n,t,r)}),yR(function(e){return!0!==e},!0))}(s,r,i,e).pipe(ag(function(n){return n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return vg(t).pipe(_A(function(t){return aR(function(e,t){return null!==e&&t&&t(new AR(e)),kA(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new NR(e)),kA(!0)}(t.route,r),function(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return oR(function(){return kA(t.guards.map(function(i){var a,o=SM(i,t.node,n);if(function(e){return e&&QN(e.canActivateChild)}(o))a=jR(o.canActivateChild(r,e));else{if(!QN(o))throw new Error("Invalid CanActivateChild guard");a=jR(o(r,e))}return a.pipe(yR())})).pipe(tM())})});return kA(i).pipe(tM())}(e,t.path,n),function(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;return r&&0!==r.length?kA(r.map(function(r){return oR(function(){var i,a=SM(r,t,n);if(function(e){return e&&QN(e.canActivate)}(a))i=jR(a.canActivate(t,e));else{if(!QN(a))throw new Error("Invalid CanActivate guard");i=jR(a(t,e))}return i.pipe(yR())})})).pipe(tM()):kA(!0)}(e,t.route,n))}),yR(function(e){return!0!==e},!0))}(r,o,e,t):kA(n)}),Hp(function(e){return Object.assign(Object.assign({},n),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),mR(function(e){if(XN(e.guardsResult)){var n=VR('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}var r=new PR(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)}),wA(function(e){return!!e.guardsResult||(t.restoreHistory(e),t.cancelNavigationTransition(e,""),!1)}),LM(function(e){if(e.guards.canActivateChecks.length)return kA(e).pipe(mR(function(e){var n=new OR(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),cR(function(e){var n=!1;return kA(e).pipe(function(e,t){return ag(function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;if(!i.length)return kA(n);var a=0;return vg(i).pipe(_A(function(n){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return kA({});var a={};return vg(i).pipe(ag(function(i){return function(e,t,n,r){var i=SM(e,t,r);return jR(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(mR(function(e){a[i]=e}))}),dR(1),ag(function(){return Object.keys(a).length===i.length?kA(a):sg}))}(e._resolve,e,t,r).pipe(Hp(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),TN(e,n).resolve),null}))}(n.route,r,e,t)}),mR(function(){return a++}),dR(1),ag(function(e){return a===i.length?kA(n):sg}))})}(t.paramsInheritanceStrategy,t.ngModule.injector),mR({next:function(){return n=!0},complete:function(){n||(t.restoreHistory(e),t.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),mR(function(e){var n=new TR(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),LM(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),Hp(function(e){var n=function(e,t,n){var r=DN(e,t._root,n?n._root:void 0);return new SN(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})}),mR(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,e),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,n){return Hp(function(r){return new YN(t,r.targetRouterState,r.currentRouterState,n).activate(e),r})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),mR({next:function(){r=!0},complete:function(){r=!0}}),function(e){return Vp(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}(function(){var n;if(!r&&!i){var a="Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId);"replace"===t.canceledNavigationResolution?(t.restoreHistory(e),t.cancelNavigationTransition(e,a)):t.cancelNavigationTransition(e,a)}(null===(n=t.currentNavigation)||void 0===n?void 0:n.id)===e.id&&(t.currentNavigation=null)}),fR(function(r){if(i=!0,function(e){return e&&e[UR]}(r)){var a=XN(r.url);a||(t.navigated=!0,t.restoreHistory(e,!0));var o=new CR(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),a?setTimeout(function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree),i={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||YM(e.source)};t.scheduleNavigation(n,"imperative",null,i,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.restoreHistory(e,!0);var s=new bR(e.id,t.serializeUrl(e.extractedUrl),r);n.next(s);try{e.resolve(t.errorHandler(r))}catch(o){e.reject(o)}}return sg}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,n)&&setTimeout(function(){var t=n.source,r=n.state,i=n.urlTree,a={replaceUrl:!0};if(r){var o=Object.assign({},r);delete o.navigationId,delete o.\u0275routerPageId,0!==Object.keys(o).length&&(a.state=o)}e.scheduleNavigation(i,t,r,a)},0),e.lastLocationChangeInfo=n}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){rM(e),this.config=e.map(oM),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,a=t.queryParamsHandling,o=t.preserveFragment,s=n||this.routerState.root,u=o?this.currentUrlTree.fragment:i,c=null;switch(a){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return UN(t.root,t.root,t,r,i);var a=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new zN(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var a={};return WR(r.outlets,function(e,t){a[t]="string"==typeof e?e.split("/"):e}),[].concat(np(e),[{outlets:a}])}if(r.segmentPath)return[].concat(np(e),[r.segmentPath])}return"string"!=typeof r?[].concat(np(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(np(e),[r])},[]);return new zN(n,t,r)}(n);if(a.toRoot())return UN(t.root,new tN([],{}),t,r,i);var o=function(e,t,n){if(e.isAbsolute)return new HN(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){var r=n.snapshot._urlSegment;return new HN(r,r===t.root,0)}var i=FN(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,a=n;a>i;){if(a-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new HN(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(a,t,e),s=o.processChildren?qN(o.segmentGroup,o.index,a.commands):GN(o.segmentGroup,o.index,a.commands);return UN(o.segmentGroup,s,t,r,i)}(s,this.currentUrlTree,e,c,null!=u?u:null)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},n=XN(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){var n;if(n=!0===t?Object.assign({},WM):!1===t?Object.assign({},jM):t,XN(e))return KR(this.currentUrlTree,e,n);var r=this.parseUrl(e);return KR(this.currentUrlTree,r,n)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.currentPageId=t.targetPageId,e.events.next(new wR(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ".concat(t))})}},{key:"scheduleNavigation",value:function(e,t,n,r,i){var a,o;if(this.disposed)return Promise.resolve(!1);var s,u,c,l=this.getTransition(),h=YM(t)&&l&&!YM(l.source),f=(this.lastSuccessfulId===l.id||this.currentNavigation?l.rawUrl:l.urlAfterRedirects).toString()===e.toString();if(h&&f)return Promise.resolve(!0);i?(s=i.resolve,u=i.reject,c=i.promise):c=new Promise(function(e,t){s=e,u=t});var d,v=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),d=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):d=0,this.setTransition({id:v,targetPageId:d,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t){var n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}},{key:"restoreHistory",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var i=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(t=this.currentNavigation)||void 0===t?void 0:t.finalUrl)||0===i?this.currentUrlTree===(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)&&0===i&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(e,t){var n=new CR(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}},{key:"generateNgRouterState",value:function(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(vk),Rk(iN),Rk(zM),Rk(jO),Rk($C),Rk(CO),Rk(QP),Rk(void 0))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}();function YM(e){return"imperative"!==e}var KM=function(){var e=function(){function e(t,n,r,i,a){sp(this,e),this.router=t,this.route=n,this.commands=[],this.onChanges=new Fp,null==r&&i.setAttribute(a.nativeElement,"tabindex","0")}return cp(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:QM(this.skipLocationChange),replaceUrl:QM(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:QM(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(ZM),fb(ON),ck("tabindex"),fb(fS),fb(cS))},e.\u0275dir=fy({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&bb("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Sy]}),e}(),JM=function(){var e=function(){function e(t,n,r){var i=this;sp(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.onChanges=new Fp,this.subscription=t.events.subscribe(function(e){e instanceof wR&&i.updateTargetUrlAndHref()})}return cp(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:QM(this.skipLocationChange),replaceUrl:QM(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:QM(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(ZM),fb(ON),fb(HO))},e.\u0275dir=fy({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&bb("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(Gb("href",t.href,S_),ob("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Sy]}),e}();function QM(e){return""===e||!!e}var XM=function(){var e=function(){function e(t,n,r,i,a){sp(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new yP,this.deactivateEvents=new yP,this.name=i||LR,t.onChildOutletCreated(this.name,this)}return cp(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new eD(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(zM),fb(WS),fb(aS),ck("name"),fb(DS))},e.\u0275dir=fy({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e}(),eD=function(){function e(t,n,r){sp(this,e),this.route=t,this.childContexts=n,this.parent=r}return cp(e,[{key:"get",value:function(e,t){return e===ON?this.route:e===zM?this.childContexts:this.parent.get(e,t)}}]),e}(),tD=cp(function e(){sp(this,e)}),nD=function(){function e(){sp(this,e)}return cp(e,[{key:"preload",value:function(e,t){return kA(null)}}]),e}(),rD=function(){var e=function(){function e(t,n,r,i,a){sp(this,e),this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new UM(n,r,function(e){return t.triggerEvent(new IR(e))},function(e){return t.triggerEvent(new xR(e))})}return cp(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(wA(function(e){return e instanceof wR}),_A(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(GS);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],i=ip(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?r.push(this.preloadConfig(e,a)):a.children&&r.push(this.processRoutes(e,a.children))}}catch(s){i.e(s)}finally{i.f()}return vg(r).pipe(og(),Hp(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?kA(t._loadedConfig):n.loader.load(e.injector,t)).pipe(ag(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(ZM),Rk(CO),Rk(QP),Rk($C),Rk(tD))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),iD=function(){var e=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};sp(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return cp(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof _R?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof wR&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof DR&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new DR(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(ZM),Rk(qT),Rk(void 0))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),aD=new fk("ROUTER_CONFIGURATION"),oD=new fk("ROUTER_FORROOT_GUARD"),sD=[jO,{provide:iN,useClass:aN},{provide:ZM,useFactory:function(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new ZM(null,e,t,n,r,i,a,qR(o));return u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(s,l),s.enableTracing&&l.events.subscribe(function(e){var t,n;null===(t=console.group)||void 0===t||t.call(console,"Router Event: ".concat(e.constructor.name)),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),l},deps:[iN,zM,jO,$C,CO,QP,BM,aD,[function(){return cp(function e(){sp(this,e)})}(),new Vk],[function(){return cp(function e(){sp(this,e)})}(),new Vk]]},zM,{provide:ON,useFactory:function(e){return e.routerState.root},deps:[ZM]},{provide:CO,useClass:SO},rD,nD,function(){function e(){sp(this,e)}return cp(e,[{key:"preload",value:function(e,t){return t().pipe(fR(function(){return kA(null)}))}}]),e}(),{provide:aD,useValue:{enableTracing:!1}}];function uD(){return new pO("Router",ZM)}var cD=function(){var e=function(){function e(t,n){sp(this,e)}return cp(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[sD,dD(t),{provide:oD,useFactory:fD,deps:[[ZM,new Vk,new zk]]},{provide:aD,useValue:n||{}},{provide:HO,useFactory:hD,deps:[NO,[new Uk(qO),new Vk],aD]},{provide:iD,useFactory:lD,deps:[ZM,qT,aD]},{provide:tD,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:nD},{provide:pO,multi:!0,useFactory:uD},[vD,{provide:MP,multi:!0,useFactory:pD,deps:[vD]},{provide:yD,useFactory:gD,deps:[vD]},{provide:zP,multi:!0,useExisting:yD}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[dD(t)]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(oD,8),Rk(ZM,8))},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({}),e}();function lD(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new iD(e,t,n)}function hD(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new WO(e,t):new $O(e,t)}function fD(e){return"guarded"}function dD(e){return[{provide:dk,multi:!0,useValue:e},{provide:BM,multi:!0,useValue:e}]}var vD=function(){var e=function(){function e(t){sp(this,e),this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Fp}return cp(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(DO,Promise.resolve(null)).then(function(){if(e.destroyed)return Promise.resolve(!0);var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(ZM),i=e.injector.get(aD);return"disabled"===i.initialNavigation?(r.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(r.hooks.afterPreactivation=function(){return e.initNavigation?kA(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()):t(!0),n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(aD),n=this.injector.get(rD),r=this.injector.get(iD),i=this.injector.get(ZM),a=this.injector.get(_O);e===a.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk($C))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}();function pD(e){return e.appInitializer.bind(e)}function gD(e){return e.bootstrapListener.bind(e)}var yD=new fk("Router Initializer"),mD=cp(function e(){sp(this,e)}),kD="*";function _D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function wD(e){return{type:6,styles:e,offset:null}}function CD(e){Promise.resolve(null).then(e)}var bD=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;sp(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return cp(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;CD(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this._started=!1}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),ED=function(){function e(t){var n=this;sp(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,i=0,a=0,o=this.players.length;0==o?CD(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++r==o&&n._onFinish()}),e.onDestroy(function(){++i==o&&n._onDestroy()}),e.onStart(function(){++a==o&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return cp(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function SD(){return"undefined"!=typeof window&&void 0!==window.document}function PD(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function OD(e){switch(e.length){case 0:return new bD;case 1:return e[0];default:return new ED(e)}}function TD(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],u=-1,c=null;if(r.forEach(function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach(function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),s){case"!":s=i[n];break;case kD:s=a[n];break;default:s=t.normalizeStyleValue(n,r,s,o)}l[r]=s}),r||s.push(l),c=l,u=n}),o.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(o.join(l)))}return s}function ID(e,t,n,r){switch(t){case"start":e.onStart(function(){return r(n&&xD(n,"start",e))});break;case"done":e.onDone(function(){return r(n&&xD(n,"done",e))});break;case"destroy":e.onDestroy(function(){return r(n&&xD(n,"destroy",e))})}}function xD(e,t,n){var r,i=AD(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null!==(r=n.totalTime)&&void 0!==r?r:e.totalTime,!!n.disabled),a=e._data;return null!=a&&(i._data=a),i}function AD(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!o}}function RD(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function ND(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var MD=function(e,t){return!1},DD=function(e,t){return!1},LD=function(e,t,n){return[]},FD=PD();(FD||"undefined"!=typeof Element)&&(MD=SD()?function(e,t){for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:function(e,t){return e.contains(t)},DD=function(){if(FD||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:DD}(),LD=function(e,t,n){var r=[];if(n)for(var i=e.querySelectorAll(t),a=0;a<i.length;a++)r.push(i[a]);else{var o=e.querySelector(t);o&&r.push(o)}return r});var BD=null,UD=!1;function VD(e){BD||(BD=("undefined"!=typeof document?document.body:null)||{},UD=!!BD.style&&"WebkitAppearance"in BD.style);var t=!0;return BD.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in BD.style)&&UD&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in BD.style)),t}var zD=DD,HD=MD,GD=LD;function qD(e){var t={};return Object.keys(e).forEach(function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}var $D=function(){var e=function(){function e(){sp(this,e)}return cp(e,[{key:"validateStyleProperty",value:function(e){return VD(e)}},{key:"matchesElement",value:function(e,t){return zD(e,t)}},{key:"containsElement",value:function(e,t){return HD(e,t)}},{key:"query",value:function(e,t,n){return GD(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,i){return new bD(n,r)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),WD=function(){var e=cp(function e(){sp(this,e)});return e.NOOP=new $D,e}(),jD="ng-enter",ZD="ng-leave",YD="ng-trigger",KD=".ng-trigger",JD="ng-animating",QD=".ng-animating";function XD(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:eL(parseFloat(t[1]),t[2])}function eL(e,t){switch(t){case"s":return 1e3*e;default:return e}}function tL(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,i=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=eL(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(i=eL(parseFloat(s),o[4]));var u=o[5];u&&(a=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:i,easing:a}}(e,t,n)}function nL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function rL(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else nL(e,n);return n}function iL(e,t,n){return n?t+":"+n+";":""}function aL(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=iL(0,r,e.style.getPropertyValue(r))}for(var i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=iL(0,pL(i),e.style[i]));e.setAttribute("style",t)}function oL(e,t,n){e.style&&(Object.keys(t).forEach(function(r){var i=vL(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),PD()&&aL(e))}function sL(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=vL(t);e.style[n]=""}),PD()&&aL(e))}function uL(e){return Array.isArray(e)?1==e.length?e[0]:_D(e):e}var cL=new RegExp("{{\\s*(.+?)\\s*}}","g");function lL(e){var t=[];if("string"==typeof e){for(var n;n=cL.exec(e);)t.push(n[1]);cL.lastIndex=0}return t}function hL(e,t,n){var r=e.toString(),i=r.replace(cL,function(e,r){var i=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()});return i==r?e:i}function fL(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var dL=/-+([a-z0-9])/g;function vL(e){return e.replace(dL,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function pL(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function gL(e,t){return 0===e||0===t}function yL(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var i=t[0],a=[];if(r.forEach(function(e){i.hasOwnProperty(e)||a.push(e),i[e]=n[e]}),a.length)for(var o=function(){var n=t[s];a.forEach(function(t){n[t]=kL(e,t)})},s=1;s<t.length;s++)o()}return t}function mL(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function kL(e,t){return window.getComputedStyle(e)[t]}function _L(e,t){var n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=i[1],o=i[2],s=i[3];t.push(bL(a,s)),"<"==o[0]&&("*"!=a||"*"!=s)&&t.push(bL(s,a))}(e,n,t)}):n.push(e),n}var wL=new Set(["true","1"]),CL=new Set(["false","0"]);function bL(e,t){var n=wL.has(e)||CL.has(e),r=wL.has(t)||CL.has(t);return function(i,a){var o="*"==e||e==i,s="*"==t||t==a;return!o&&n&&"boolean"==typeof i&&(o=i?wL.has(e):CL.has(e)),!s&&r&&"boolean"==typeof a&&(s=a?wL.has(t):CL.has(t)),o&&s}}var EL=new RegExp("s*:selfs*,?","g");function SL(e,t,n){return new PL(e).build(t,n)}var PL=function(){function e(t){sp(this,e),this._driver=t}return cp(e,[{key:"build",value:function(e,t){var n=new OL(t);return this._resetContextStyleTimingState(n),mL(this,uL(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,i=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,a.push(n.visitState(s,t))}),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:a,transitions:o,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var i=new Set,a=r||{};if(n.styles.forEach(function(e){if(TL(e)){var t=e;Object.keys(t).forEach(function(e){lL(t[e]).forEach(function(e){a.hasOwnProperty(e)||i.add(e)})})}}),i.size){var o=fL(i.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n=mL(this,uL(e.animation),t);return{type:1,matchers:_L(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:IL(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return mL(n,e,t)}),options:IL(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,i=0,a=e.steps.map(function(e){t.currentTime=r;var a=mL(n,e,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:a,options:IL(e.options)}}},{key:"visitAnimate",value:function(e,t){var n=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return xL(tL(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var i=xL(0,0,"");return i.dynamic=!0,i.strValue=r,i}return xL((n=n||tL(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;var r,i=e.styles?e.styles:wD({});if(5==i.type)r=this.visitKeyframes(i,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};n.easing&&(s.easing=n.easing),a=wD(s)}t.currentTime+=n.duration+n.delay;var u=this.visitStyle(a,t);u.isEmptyStep=o,r=u}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?e==kD?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var r=!1,i=null;return n.forEach(function(e){if(TL(e)){var t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(var a in t)if(t[a].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,i=t.currentTime,a=t.currentTime;r&&a>0&&(a-=r.duration+r.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(r){if(n._driver.validateStyleProperty(r)){var o=t.collectedStyles[t.currentQuerySelector],s=o[r],u=!0;s&&(a!=i&&a>=s.startTime&&i<=s.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(s.startTime,'ms" and "').concat(s.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(i,'ms"')),u=!1),a=s.startTime),u&&(o[r]={startTime:a,endTime:i}),t.options&&function(e,t,n){var r=t.params||{},i=lL(e);i.length&&i.forEach(function(e){r.hasOwnProperty(e)||n.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})}(e[r],t.options,t.errors)}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,a=[],o=!1,s=!1,u=0,c=e.steps.map(function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(TL(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(TL(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,o=o||l<u,u=l,a.push(l),r});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,h=0;i>0&&i<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(h=1/(l-1));var f=l-1,d=t.currentTime,v=t.currentAnimateTimings,p=v.duration;return c.forEach(function(e,i){var o=h>0?i==f?1:h*i:a[i],s=o*p;t.currentTime=d+v.delay+s,v.duration=s,n._validateStyleAst(e,t),e.offset=o,r.styles.push(e)}),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:mL(this,uL(e.animation),t),options:IL(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:IL(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:IL(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var i=Hv(function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(EL,"")),[e=e.replace(/@\*/g,KD).replace(/@\w+/g,function(e){return KD+"-"+e.substr(1)}).replace(/:animating/g,QD),t]}(e.selector),2),a=i[0],o=i[1];t.currentQuerySelector=n.length?n+" "+a:a,RD(t.collectedStyles,t.currentQuerySelector,{});var s=mL(this,uL(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:a,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:s,originalSelector:e.selector,options:IL(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:tL(e.timings,t.errors,!0);return{type:12,animation:mL(this,uL(e.animation),t),timings:n,options:null}}}]),e}(),OL=cp(function e(t){sp(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null});function TL(e){return!Array.isArray(e)&&"object"==typeof e}function IL(e){return e?(e=nL(e)).params&&(e.params=function(e){return e?nL(e):null}(e.params)):e={},e}function xL(e,t,n){return{duration:e,delay:t,easing:n}}function AL(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:o,subTimeline:s}}var RL=function(){function e(){sp(this,e),this._map=new Map}return cp(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,np(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),NL=new RegExp(":enter","g"),ML=new RegExp(":leave","g");function DL(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new LL).buildKeyframes(e,t,n,r,i,a,o,s,u,c)}var LL=function(){function e(){sp(this,e)}return cp(e,[{key:"buildKeyframes",value:function(e,t,n,r,i,a,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new RL;var l=new BL(e,t,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([a],null,l.errors,s),mL(this,n,l);var h=l.timelines.filter(function(e){return e.containsAnimation()});if(h.length&&Object.keys(o).length){var f=h[h.length-1];f.allowOnlyTimelineStyles()||f.setStyles([o],null,l.errors,s)}return h.length?h.map(function(e){return e.buildKeyframes()}):[AL(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,i=null!=n.duration?XD(n.duration):null,a=null!=n.delay?XD(n.delay):null;return 0!==i&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,i,a);r=Math.max(r,n.duration+n.delay)}),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),mL(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,i=t,a=e.options;if(a&&(a.params||a.delay)&&((i=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=FL);var o=XD(a.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(function(e){return mL(n,e,i)}),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],i=t.currentTimeline.currentTime,a=e.options&&e.options.delay?XD(e.options.delay):0;e.steps.forEach(function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),mL(n,o,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(i),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return tL(t.params?hL(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(function(e){a.forwardTime((e.offset||0)*i),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+i),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,i=e.options||{},a=i.delay?XD(i.delay):0;a&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=FL);var o=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach(function(r,i){t.currentQueryIndex=i;var s=t.createSubContext(e.options,r);a&&s.delayNextStep(a),r===t.element&&(u=s.currentTimeline),mL(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,i=e.timings,a=Math.abs(i.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;mL(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),FL={},BL=function(){function e(t,n,r,i,a,o,s,u){sp(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=FL,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new UL(this._driver,n,0),s.push(this.currentTimeline)}return cp(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,i=this.options;null!=r.duration&&(i.duration=XD(r.duration)),null!=r.delay&&(i.delay=XD(r.delay));var a=r.params;if(a){var o=i.params;o||(o=this.options.params={}),Object.keys(a).forEach(function(e){(!t||!o.hasOwnProperty(e))&&(o[e]=hL(a[e],o,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,a=new e(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=FL,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new VL(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,i,a){var o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(NL,"."+this._enterClassName)).replace(ML,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,np(s))}return!i&&0==o.length&&a.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),UL=function(){function e(t,n,r,i){sp(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return cp(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||kD,t._currentKeyframe[e]=kD}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var i=this;t&&(this._previousKeyframe.easing=t);var a=r&&r.params||{},o=function(e,t){var n,r={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){r[e]=kD}):rL(e,!1,r)}),r}(e,this._globalTimelineStyles);Object.keys(o).forEach(function(e){var t=hL(o[e],a,n);i._pendingStyles[e]=t,i._localTimelineStyles.hasOwnProperty(e)||(i._backFill[e]=i._globalTimelineStyles.hasOwnProperty(e)?i._globalTimelineStyles[e]:kD),i._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var r=t._styleSummary[n],i=e._styleSummary[n];(!r||i.time>r.time)&&t._updateStyle(n,i.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach(function(a,o){var s=rL(a,!0);Object.keys(s).forEach(function(e){var r=s[e];"!"==r?t.add(e):r==kD&&n.add(e)}),r||(s.offset=o/e.duration),i.push(s)});var a=t.size?fL(t.values()):[],o=n.size?fL(n.values()):[];if(r){var s=i[0],u=nL(s);s.offset=0,u.offset=1,i=[s,u]}return AL(this.element,i,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),VL=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return sp(this,n),(u=t.call(this,e,r,s.delay)).keyframes=i,u.preStyleProps=a,u.postStyleProps=o,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return cp(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,i=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=r+n,s=n/o,u=rL(e[0],!1);u.offset=0,a.push(u);var c=rL(e[0],!1);c.offset=zL(s),a.push(c);for(var l=e.length-1,h=1;h<=l;h++){var f=rL(e[h],!1);f.offset=zL((n+f.offset*r)/o),a.push(f)}r=o,n=0,i="",e=a}return AL(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(UL);function zL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var HL=cp(function e(){sp(this,e)}),GL=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"normalizePropertyName",value:function(e,t){return vL(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var i="",a=n.toString().trim();if(qL[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+i}}]),n}(HL),qL=function(e){var t={};return e.forEach(function(e){return t[e]=!0}),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function $L(e,t,n,r,i,a,o,s,u,c,l,h,f){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:o,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:h,errors:f}}var WL={},jL=function(){function e(t,n,r){sp(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return cp(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,i){return e.some(function(e){return e(t,n,r,i)})}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],i=this._stateStyles[e],a=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,r,i,a,o,s,u,c){var l=[],h=this.ast.options&&this.ast.options.params||WL,f=this.buildStyles(n,o&&o.params||WL,l),d=s&&s.params||WL,v=this.buildStyles(r,d,l),p=new Set,g=new Map,y=new Map,m="void"===r,k={params:Object.assign(Object.assign({},h),d)},_=c?[]:DL(e,t,this.ast.animation,i,a,f,v,k,u,l),w=0;if(_.forEach(function(e){w=Math.max(e.duration+e.delay,w)}),l.length)return $L(t,this._triggerName,n,r,m,f,v,[],[],g,y,w,l);_.forEach(function(e){var n=e.element,r=RD(g,n,{});e.preStyleProps.forEach(function(e){return r[e]=!0});var i=RD(y,n,{});e.postStyleProps.forEach(function(e){return i[e]=!0}),n!==t&&p.add(n)});var C=fL(p.values());return $L(t,this._triggerName,n,r,m,f,v,_,C,g,y,w)}}]),e}(),ZL=function(){function e(t,n,r){sp(this,e),this.styles=t,this.defaultParams=n,this.normalizer=r}return cp(e,[{key:"buildStyles",value:function(e,t){var n=this,r={},i=nL(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach(function(e){var o=a[e];o.length>1&&(o=hL(o,i,t));var s=n.normalizer.normalizePropertyName(e,t);o=n.normalizer.normalizeStyleValue(e,s,o,t),r[s]=o})}}),r}}]),e}(),YL=function(){function e(t,n,r){var i=this;sp(this,e),this.name=t,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states={},n.states.forEach(function(e){i.states[e.name]=new ZL(e.style,e.options&&e.options.params||{},r)}),KL(this.states,"true","1"),KL(this.states,"false","0"),n.transitions.forEach(function(e){i.transitionFactories.push(new jL(t,e,i.states))}),this.fallbackTransition=function(e,t,n){return new jL(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},t)}(t,this.states)}return cp(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find(function(i){return i.match(e,t,n,r)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function KL(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var JL=new RL,QL=function(){function e(t,n,r){sp(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return cp(e,[{key:"register",value:function(e,t){var n=[],r=SL(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,i=TD(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=DL(this._driver,t,o,jD,ZD,{},{},i,JL,a)).forEach(function(e){var t=RD(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: ".concat(a.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=r._driver.computeStyle(t,n,kD)})});var u=OD(n.map(function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return r.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,r){var i=AD(t,"","","");return ID(this._getPlayer(e),n,i,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),XL="ng-animate-queued",eF="ng-animate-disabled",tF=".ng-animate-disabled",nF=[],rF={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},iF={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},aF="__ng_removed",oF=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";sp(this,e),this.namespaceId=r;var i=t&&t.hasOwnProperty("value");if(this.value=null!==(n=i?t.value:t)&&void 0!==n?n:null,i){var a=nL(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return cp(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),sF="void",uF=new oF(sF),cF=function(){function e(t,n,r){sp(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,yF(n,this._hostClassName)}return cp(e,[{key:"listen",value:function(e,t,n,r){var i,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=RD(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);var u=RD(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(yF(e,YD),yF(e,YD+"-"+t),u[t]=uF),function(){a._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete u[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new hF(this.id,t,e),s=this._engine.statesByElement.get(e);s||(yF(e,YD),yF(e,YD+"-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new oF(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=uF),c.value===sF||u.value!==c.value){var l=RD(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()});var h=a.matchTransition(u.value,c.value,e,c.params),f=!1;if(!h){if(!i)return;h=a.fallbackTransition,f=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:h,fromState:u,toState:c,player:o,isFallbackTransition:f}),f||(yF(e,XL),o.onStart(function(){mF(e,XL)})),o.onDone(function(){var t=r.players.indexOf(o);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var i=n.indexOf(o);i>=0&&n.splice(i,1)}}),this.players.push(o),l.push(o),o}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(u.params,c.params)){var d=[],v=a.matchStyles(u.value,u.params,d),p=a.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush(function(){sL(e,v),oL(e,p)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,r){t._elementListeners.set(r,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,r=this._engine.driver.query(e,KD,!0);r.forEach(function(e){if(!e[aF]){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return r.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var i=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach(function(t){if(i._triggers[t]){var n=i.trigger(e,t,sF,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&OD(o).onDone(function(){return i._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){var i=new Set;n.forEach(function(n){var a=n.name;if(!i.has(a)){i.add(a);var o=t._triggers[a].fallbackTransition,s=r[a]||uF,u=new oF(sF),c=new hF(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:s,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var i=!1;if(r.totalAnimations){var a=r.players.length?r.playersByQueriedElement.get(e):[];if(a&&a.length)i=!0;else for(var o=e;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{var s=e[aF];(!s||s===rF)&&(r.afterFlush(function(){return n.clearElementCache(e)}),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){yF(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(r){var i=r.player;if(!i.destroyed){var a=r.element,o=t._elementListeners.get(a);o&&o.forEach(function(t){if(t.name==r.triggerName){var n=AD(a,r.triggerName,r.fromState.value,r.toState.value);n._data=e,ID(r.player,t.phase,n,t.callback)}}),i.markedForDestroy?t._engine.afterFlush(function(){i.destroy()}):n.push(r)}}),this._queue=[],n.sort(function(e,n){var r=e.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),lF=function(){function e(t,n,r){sp(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return cp(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new cF(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return r.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=n[r[i]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,r){if(fF(t)){var i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(fF(t)){var i=t[aF];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),yF(e,eF)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),mF(e,eF))}},{key:"removeNode",value:function(e,t,n,r){if(fF(t)){var i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t[aF]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,i){return fF(t)?this._fetchNamespace(e).listen(t,n,r,i):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,KD,!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,QD,!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return OD(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e[aF];if(n&&n.setForRemoval){if(e[aF]=rF,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,tF)&&this.markElementAsDisabled(e,!1),this.driver.query(e,tF,!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)yF(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,t)}finally{for(var a=0;a<i.length;a++)i[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?OD(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new RL,i=[],a=new Map,o=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])});var h=this.bodyNode,f=Array.from(this.statesByElement.keys()),d=pF(f,this.collectedEnterElements),v=new Map,p=0;d.forEach(function(e,t){var n=jD+p++;v.set(t,n),e.forEach(function(e){return yF(e,n)})});for(var g=[],y=new Set,m=new Set,k=0;k<this.collectedLeaveElements.length;k++){var _=this.collectedLeaveElements[k],w=_[aF];w&&w.setForRemoval&&(g.push(_),y.add(_),w.hasAnimation?this.driver.query(_,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):m.add(_))}var C=new Map,b=pF(f,Array.from(y));b.forEach(function(e,t){var n=ZD+p++;C.set(t,n),e.forEach(function(e){return yF(e,n)})}),e.push(function(){d.forEach(function(e,t){var n=v.get(t);e.forEach(function(e){return mF(e,n)})}),b.forEach(function(e,t){var n=C.get(t);e.forEach(function(e){return mF(e,n)})}),g.forEach(function(e){n.processLeaveNode(e)})});for(var E=[],S=[],P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(t).forEach(function(e){var t=e.player,a=e.element;if(E.push(t),n.collectedEnterElements.length){var l=a[aF];if(l&&l.setForMove)return void t.destroy()}var f=!h||!n.driver.containsElement(h,a),d=C.get(a),p=v.get(a),g=n._buildInstruction(e,r,p,d,f);if(g.errors&&g.errors.length)S.push(g);else{if(f)return t.onStart(function(){return sL(a,g.fromStyles)}),t.onDestroy(function(){return oL(a,g.toStyles)}),void i.push(t);if(e.isFallbackTransition)return t.onStart(function(){return sL(a,g.fromStyles)}),t.onDestroy(function(){return oL(a,g.toStyles)}),void i.push(t);g.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(a,g.timelines),o.push({instruction:g,player:t,element:a}),g.queriedElements.forEach(function(e){return RD(s,e,[]).push(t)}),g.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach(function(e){return r.add(e)})}}),g.postStyleProps.forEach(function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach(function(e){return r.add(e)})})}});if(S.length){var O=[];S.forEach(function(e){O.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return O.push("- ".concat(e,"\n"))})}),E.forEach(function(e){return e.destroy()}),this.reportError(O)}var T=new Map,I=new Map;o.forEach(function(e){var t=e.element;r.has(t)&&(I.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,T))}),i.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){RD(T,t,[]).push(e),e.destroy()})});var x=g.filter(function(e){return wF(e,u,c)}),A=new Map;vF(A,this.driver,m,c,kD).forEach(function(e){wF(e,u,c)&&x.push(e)});var R=new Map;d.forEach(function(e,t){vF(R,n.driver,new Set(e),u,"!")}),x.forEach(function(e){var t=A.get(e),n=R.get(e);A.set(e,Object.assign(Object.assign({},t),n))});var N=[],M=[],D={};o.forEach(function(e){var t=e.element,o=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return o.onDestroy(function(){return oL(t,s.toStyles)}),o.disabled=!0,o.overrideTotalTime(s.totalTime),void i.push(o);var u=D;if(I.size>1){for(var c=t,h=[];c=c.parentNode;){var f=I.get(c);if(f){u=f;break}h.push(c)}h.forEach(function(e){return I.set(e,u)})}var d=n._buildAnimation(o.namespaceId,s,T,a,R,A);if(o.setRealPlayer(d),u===D)N.push(o);else{var v=n.playersByElement.get(u);v&&v.length&&(o.parentPlayer=OD(v)),i.push(o)}}else sL(t,s.fromStyles),o.onDestroy(function(){return oL(t,s.toStyles)}),M.push(o),l.has(t)&&i.push(o)}),M.forEach(function(e){var t=a.get(e.element);if(t&&t.length){var n=OD(t);e.setRealPlayer(n)}}),i.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var L=0;L<g.length;L++){var F=g[L],B=F[aF];if(mF(F,ZD),!B||!B.hasAnimation){var U=[];if(s.size){var V=s.get(F);V&&V.length&&U.push.apply(U,np(V));for(var z=this.driver.query(F,QD,!0),H=0;H<z.length;H++){var G=s.get(z[H]);G&&G.length&&U.push.apply(U,np(G))}}var q=U.filter(function(e){return!e.destroyed});q.length?kF(this,F,q):this.processLeaveNode(F)}}return g.length=0,N.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),N}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t[aF];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,i){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var u=!i||i==sF;s.forEach(function(e){e.queued||!u&&e.triggerName!=r||a.push(e)})}}return(n||r)&&(a=a.filter(function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)})),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,i=this,a=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=ip(t.timelines);try{var c=function(){var e=r.value.element,u=e!==a,c=RD(n,e,[]);i._getPreviousPlayers(e,u,o,s,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}sL(a,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,i,a){var o=this,s=t.triggerName,u=t.element,c=[],l=new Set,h=new Set,f=t.timelines.map(function(t){var f=t.element;l.add(f);var d=f[aF];if(d&&d.removedBeforeQueried)return new bD(t.duration,t.delay);var v=f!==u,p=function(e){var t=[];return _F(e,t),t}((n.get(f)||nF).map(function(e){return e.getRealPlayer()})).filter(function(e){return!!e.element&&e.element===f}),g=i.get(f),y=a.get(f),m=TD(0,o._normalizer,0,t.keyframes,g,y),k=o._buildPlayer(t,m,p);if(t.subTimeline&&r&&h.add(f),v){var _=new hF(e,s,f);_.setRealPlayer(k),c.push(_)}return k});c.forEach(function(e){RD(o.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var a=r.indexOf(n);r.splice(a,1)}0==r.length&&delete e[t]}return r}(o.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return yF(e,JD)});var d=OD(f);return d.onDestroy(function(){l.forEach(function(e){return mF(e,JD)}),oL(u,t.toStyles)}),h.forEach(function(e){RD(r,e,[]).push(d)}),d}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new bD(e.duration,e.delay)}}]),e}(),hF=function(){function e(t,n,r){sp(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new bD,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return cp(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return ID(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){RD(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function fF(e){return e&&1===e.nodeType}function dF(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function vF(e,t,n,r,i){var a=[];n.forEach(function(e){return a.push(dF(e))});var o=[];r.forEach(function(n,r){var a={};n.forEach(function(e){var n=a[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[aF]=iF,o.push(r))}),e.set(r,a)});var s=0;return n.forEach(function(e){return dF(e,a[s++])}),o}function pF(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var r=new Set(t),i=new Map;function a(e){if(!e)return 1;var t=i.get(e);if(t)return t;var o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:a(o),i.set(e,t),t}return t.forEach(function(e){var t=a(e);1!==t&&n.get(t).push(e)}),n}var gF="$$classes";function yF(e,t){if(e.classList)e.classList.add(t);else{var n=e[gF];n||(n=e[gF]={}),n[t]=!0}}function mF(e,t){if(e.classList)e.classList.remove(t);else{var n=e[gF];n&&delete n[t]}}function kF(e,t,n){OD(n).onDone(function(){return e.processLeaveNode(t)})}function _F(e,t){for(var n=0;n<e.length;n++){var r=e[n];r instanceof ED?_F(r.players,t):t.push(r)}}function wF(e,t,n){var r=n.get(e);if(!r)return!1;var i=t.get(e);return i?r.forEach(function(e){return i.add(e)}):t.set(e,r),n.delete(e),!0}var CF=function(){function e(t,n,r){var i=this;sp(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new lF(t,n,r),this._timelineEngine=new QL(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return i.onRemovalComplete(e,t)}}return cp(e,[{key:"registerTrigger",value:function(e,t,n,r,i){var a=e+"-"+r,o=this._triggerCache[a];if(!o){var s=[],u=SL(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t,n){return new YL(e,t,n)}(r,u,this._normalizer),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,r,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var i=Hv(ND(n),2),a=i[0],o=i[1];this._timelineEngine.command(a,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,i){if("@"==n.charAt(0)){var a=Hv(ND(n),2),o=a[0],s=a[1];return this._timelineEngine.listen(o,t,s,i)}return this._transitionEngine.listen(e,t,n,r,i)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function bF(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=SF(t[0]),t.length>1&&(r=SF(t[t.length-1]))):t&&(n=SF(t)),n||r?new EF(e,n,r):null}var EF=function(){var e=function(){function e(t,n,r){sp(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}return cp(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&oL(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(oL(this._element,this._initialStyles),this._endStyles&&(oL(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(sL(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(sL(this._element,this._endStyles),this._endStyles=null),oL(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function SF(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];PF(i)&&((t=t||{})[i]=e[i])}return t}function PF(e){return"display"===e||"position"===e}var OF="animation",TF="animationend",IF=function(){function e(t,n,r,i,a,o,s){var u=this;sp(this,e),this._element=t,this._name=n,this._duration=r,this._delay=i,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return cp(e,[{key:"apply",value:function(){(function(e,t){var n=DF(e,"").trim();n.length&&(function(e,t){for(var n=0,r=0;r<e.length;r++)","===e.charAt(r)&&n++}(n),t="".concat(n,", ").concat(t)),MF(e,"",t)})(this._element,"".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name)),NF(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){xF(this._element,this._name,"paused")}},{key:"resume",value:function(){xF(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=AF(this._element,this._name);this._position=e*this._duration,MF(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),NF(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var n=DF(e,"").split(","),r=RF(n,t);r>=0&&(n.splice(r,1),MF(e,"",n.join(",")))}(this._element,this._name))}}]),e}();function xF(e,t,n){MF(e,"PlayState",n,AF(e,t))}function AF(e,t){var n=DF(e,"");return n.indexOf(",")>0?RF(n.split(","),t):RF([n],t)}function RF(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function NF(e,t,n){n?e.removeEventListener(TF,t):e.addEventListener(TF,t)}function MF(e,t,n,r){var i=OF+t;if(null!=r){var a=e.style[i];if(a.length){var o=a.split(",");o[r]=n,n=o.join(",")}}e.style[i]=n}function DF(e,t){return e.style[OF+t]||""}var LF=function(){function e(t,n,r,i,a,o,s,u){sp(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=a,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=i+a,this._buildStyler()}return cp(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new IF(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:kL(e.element,r))})}this.currentSnapshot=t}}]),e}(),FF=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=qD(r),i}return cp(n,[{key:"init",value:function(){var e=this;this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),jv(tp(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),jv(tp(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;!this._startingStyles||(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,jv(tp(n.prototype),"destroy",this).call(this))}}]),n}(bD),BF=function(){function e(){sp(this,e),this._count=0}return cp(e,[{key:"validateStyleProperty",value:function(e){return VD(e)}},{key:"matchesElement",value:function(e,t){return zD(e,t)}},{key:"containsElement",value:function(e,t){return HD(e,t)}},{key:"query",value:function(e,t,n){return GD(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return qD(e)});var r="@keyframes ".concat(t," {\n"),i="";n.forEach(function(e){i=" ";var t=parseFloat(e.offset);r+="".concat(i).concat(100*t,"% {\n"),i+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(t,": ").concat(n,";\n"))}}),r+="".concat(i,"}\n")}),r+="}\n";var a=document.createElement("style");return a.textContent=r,a}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=a.filter(function(e){return e instanceof LF}),s={};gL(n,r)&&o.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=yL(e,t,s));if(0==n)return new FF(e,u);var c="gen_css_kf_"+this._count++,l=this.buildKeyframeElement(e,c,t);(function(e){var t,n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(l);var h=bF(e,t),f=new LF(e,t,c,n,r,i,u,h);return f.onDestroy(function(){var e;(e=l).parentNode.removeChild(e)}),f}}]),e}(),UF=function(){function e(t,n,r,i){sp(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return cp(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:kL(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),VF=function(){function e(){sp(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(zF().toString()),this._cssKeyframesDriver=new BF}return cp(e,[{key:"validateStyleProperty",value:function(e){return VD(e)}},{key:"matchesElement",value:function(e,t){return zD(e,t)}},{key:"containsElement",value:function(e,t){return HD(e,t)}},{key:"query",value:function(e,t,n){return GD(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,a);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=a.filter(function(e){return e instanceof UF});gL(n,r)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return u[e]=t[e]})});var l=bF(e,t=yL(e,t=t.map(function(e){return rL(e,!1)}),u));return new UF(e,t,s,l)}}]),e}();function zF(){return SD()&&Element.prototype.animate||{}}var HF=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this))._nextAnimationId=0,i._renderer=e.createRenderer(r.body,{id:"0",encapsulation:$g.None,styles:[],data:{animation:[]}}),i}return cp(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?_D(e):e;return $F(this._renderer,null,t,"register",[n]),new GF(t,this._renderer)}}]),n}(mD);return e.\u0275fac=function(t){return new(t||e)(Rk(hS),Rk(RO))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),GF=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this))._id=e,i._renderer=r,i}return cp(n,[{key:"create",value:function(e,t){return new qF(this._id,e,t||{},this._renderer)}}]),n}(function(){return cp(function e(){sp(this,e)})}()),qF=function(){function e(t,n,r,i){sp(this,e),this.id=t,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return cp(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return $F(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset"),this._started=!1}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function $F(e,t,n,r,i){return e.setProperty(t,"@@".concat(n,":").concat(r),i)}var WF="@.disabled",jF=function(){var e=function(){function e(t,n,r){sp(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return cp(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var i=this._rendererCache.get(r);return i||(i=new ZF("",r,this.engine),this._rendererCache.set(r,i)),i}var a=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);return t.data.animation.forEach(function t(r){Array.isArray(r)?r.forEach(t):n.engine.registerTrigger(a,o,e,r.name,r)}),new YF(this,o,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return t(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var t=Hv(e,2);(0,t[0])(t[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(hS),Rk(CF),Rk(tO))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),ZF=function(){function e(t,n,r){sp(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return cp(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&t==WF?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),YF=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this,r,i,a)).factory=e,o.namespaceId=r,o}return cp(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==WF?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r=this;if("@"==t.charAt(0)){var i,a=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),o=t.substr(1),s="";return"@"!=o.charAt(0)&&(o=(i=Hv(function(e){var t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(o),2))[0],s=i[1]),this.engine.listen(this.namespaceId,a,o,s,function(e){r.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}]),n}(ZF),KF=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){return sp(this,n),t.call(this,e.body,r,i)}return cp(n,[{key:"ngOnDestroy",value:function(){this.flush()}}]),n}(CF);return e.\u0275fac=function(t){return new(t||e)(Rk(RO),Rk(WD),Rk(HL))},e.\u0275prov=xg({token:e,factory:e.\u0275fac}),e}(),JF=new fk("AnimationModuleType"),QF=[{provide:mD,useClass:HF},{provide:HL,useFactory:function(){return new GL}},{provide:CF,useClass:KF},{provide:hS,useFactory:function(e,t,n){return new jF(e,t,n)},deps:[hI,CF,tO]}],XF=[{provide:WD,useFactory:function(){return"function"==typeof zF()?new VF:new BF}},{provide:JF,useValue:"BrowserAnimations"}].concat(QF),eB=[{provide:WD,useClass:$D},{provide:JF,useValue:"NoopAnimations"}].concat(QF),tB=function(){var e=function(){function e(){sp(this,e)}return cp(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:t.disableAnimations?eB:XF}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({providers:XF,imports:[SI]}),e}(),nB=qv(9575),rB=qv.n(nB);function iB(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function aB(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){iB(a,r,i,o,s,"next",e)}function s(e){iB(a,r,i,o,s,"throw",e)}o(void 0)})}}var oB=function(){function e(){sp(this,e)}return cp(e,null,[{key:"expectToBe",value:function(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error("A default switch case did not observe the correct value, expected ".concat(t,", but got ").concat(e," instead."))}},{key:"expectToBeMultiple",value:function(e,t){var n,r=!1,i=ip(t);try{for(i.s();!(n=i.n()).done;){if(e===n.value){r=!0;break}}}catch(a){i.e(a)}finally{i.f()}if(!1===r)throw new Error("A default switch case did not observe the correct value, expected a value among ".concat(t,", but got ").concat(e," instead."))}},{key:"getNonNullable",value:function(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}]),e}();function sB(e,t){e&&console.log(t)}function uB(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);for(var n=e,r=t,i=0,a=Object.keys(n);i<a.length;i++){var o=a[i];if(!(o in r))return!1;if(!1===uB(n[o],r[o]))return!1}return!0}return e===t}function cB(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(var t in e)if(null!=e[t]&&!1===cB(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function lB(e,t){if(cB(e)&&cB(t))return uB(e,t);throw new Error("Comparing non comparable objects: ".concat(e.constructor.name," and ").concat(t.constructor.name))}var hB=function(){function e(t){sp(this,e),this.value=t}return cp(e,[{key:"isPresent",value:function(){return null!=this.value}},{key:"isAbsent",value:function(){return null==this.value}},{key:"get",value:function(){if(this.isPresent())return this.value;throw new Error("Value is absent")}},{key:"getOrElse",value:function(e){return this.isPresent()?this.value:e}},{key:"equals",value:function(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&lB(this.value,e.value)}},{key:"equalsValue",value:function(t){return this.equals(e.of(t))}},{key:"toString",value:function(){return this.isAbsent()?"MGPOptional.empty()":"MGPOptional.of(".concat(this.value,")")}},{key:"map",value:function(t){return this.isPresent()?e.of(t(this.get())):e.empty()}}],[{key:"of",value:function(t){return new e(t)}},{key:"ofNullable",value:function(t){return null==t?e.empty():e.of(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),fB=function(e,t){if(!e)throw dB(t)},dB=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},vB=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},pB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,h=63&c;u||(h=64,o||(l=64)),r.push(n[a>>2],n[(3&a)<<4|s>>4],n[l],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(vB(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();r.push(a<<2|o>>4),64!==s&&(r.push(o<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},gB=function(e){var t=vB(e);return pB.encodeByteArray(t,!0)},yB=function(e){return gB(e).replace(/\./g,"")},mB=function(e){try{return pB.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function kB(e){return _B(void 0,e)}function _B(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)!t.hasOwnProperty(n)||!wB(n)||(e[n]=_B(e[n],t[n]));return e}function wB(e){return"__proto__"!==e}var CB=function(){function e(){var t=this;sp(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return cp(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}}}]),e}();function bB(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[yB(JSON.stringify({alg:"none",type:"JWT"})),yB(JSON.stringify(a)),""].join(".")}function EB(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function SB(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(EB())}function PB(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function OB(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function TB(){var e=EB();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function IB(){return"object"==typeof indexedDB}function xB(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function AB(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}var RB=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(Xv(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(Xv(a),NB.prototype.create),a}return cp(n)}($v(Error)),NB=function(){function e(t,n,r){sp(this,e),this.service=t,this.serviceName=n,this.errors=r}return cp(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(MB,function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error";return new RB(n,"".concat(this.serviceName,": ").concat(i," (").concat(n,")."),t)}}]),e}(),MB=/\{\$([^}]+)}/g;function DB(e){return JSON.parse(e)}function LB(e){return JSON.stringify(e)}var FB=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=DB(mB(a[0])||""),n=DB(mB(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(o){}return{header:t,claims:n,data:r,signature:i}};function BB(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function UB(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function VB(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function zB(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function HB(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(GB(s)&&GB(u)){if(!HB(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function GB(e){return null!==e&&"object"==typeof e}function qB(e){for(var t=[],n=function(){var e=Hv(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function $B(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=Hv(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}}),t}function WB(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var jB=function(){function e(){sp(this,e),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return cp(e,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var a=16;a<80;a++){var o=n[a-3]^n[a-8]^n[a-14]^n[a-16];n[a]=4294967295&(o<<1|o>>>31)}for(var s,u,c=this.chain_[0],l=this.chain_[1],h=this.chain_[2],f=this.chain_[3],d=this.chain_[4],v=0;v<80;v++){v<40?v<20?(s=f^l&(h^f),u=1518500249):(s=l^h^f,u=1859775393):v<60?(s=l&h|f&(l|h),u=2400959708):(s=l^h^f,u=3395469782);var p=(c<<5|c>>>27)+s+d+u+n[v]&4294967295;d=f,f=h,h=4294967295&(l<<30|l>>>2),l=c,c=p}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[a]=e.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<t;)if(i[a]=e[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var a=24;a>=0;a-=8)e[r]=this.chain_[i]>>a&255,++r;return e}}]),e}(),ZB=function(){function e(t,n){var r=this;sp(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(e){r.error(e)})}return cp(e,[{key:"next",value:function(e){this.forEachObserver(function(t){t.next(e)})}},{key:"error",value:function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)}},{key:"complete",value:function(){this.forEachObserver(function(e){e.complete()}),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=YB),void 0===r.error&&(r.error=YB),void 0===r.complete&&(r.complete=YB);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))}}]),e}();function YB(){}function KB(e,t){return"".concat(e," failed: ").concat(t," argument ")}var JB=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function QB(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function XB(e){return e&&e._delegate?e._delegate:e}var eU=function(){function e(t,n,r){sp(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return cp(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),tU="[DEFAULT]",nU=function(){function e(t,n){sp(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return cp(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new CB;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:tU})}catch(u){}var t,n=ip(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=Hv(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tU;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(e.instances.values()),t.next=3,Promise.all([].concat(np(n.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()})),np(n.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))));case 3:case"end":return t.stop()}},t)}))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tU;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tU;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=ip(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=Hv(i.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(a)}}catch(l){o.e(l)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=ip(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(o){}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===tU?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tU;return this.component?this.component.multipleInstances?e:tU:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}(),rU=function(){function e(t){sp(this,e),this.name=t,this.providers=new Map}return cp(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new nU(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),iU=[],aU=function(){return(e=aU||(aU={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",aU;var e}(),oU={debug:aU.DEBUG,verbose:aU.VERBOSE,info:aU.INFO,warn:aU.WARN,error:aU.ERROR,silent:aU.SILENT},sU=aU.INFO,uU=(zv(Zv={},aU.DEBUG,"log"),zv(Zv,aU.VERBOSE,"log"),zv(Zv,aU.INFO,"info"),zv(Zv,aU.WARN,"warn"),zv(Zv,aU.ERROR,"error"),Zv),cU=function(e,t){var n;if(!(t<e.logLevel)){var r=(new Date).toISOString(),i=uU[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(n=console)[i].apply(n,["[".concat(r,"]  ").concat(e.name,":")].concat(o))}},lU=function(){function e(t){sp(this,e),this.name=t,this._logLevel=sU,this._logHandler=cU,this._userLogHandler=null,iU.push(this)}return cp(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in aU))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?oU[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,aU.DEBUG].concat(t)),this._logHandler.apply(this,[this,aU.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,aU.VERBOSE].concat(t)),this._logHandler.apply(this,[this,aU.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,aU.INFO].concat(t)),this._logHandler.apply(this,[this,aU.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,aU.WARN].concat(t)),this._logHandler.apply(this,[this,aU.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,aU.ERROR].concat(t)),this._logHandler.apply(this,[this,aU.ERROR].concat(t))}}]),e}(),hU=function(){function e(t){sp(this,e),this.container=t}return cp(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(function(e){return e}).join(" ")}}]),e}(),fU="@firebase/app",dU=new lU("@firebase/app"),vU="[DEFAULT]",pU=(zv(Kv={},fU,"fire-core"),zv(Kv,"@firebase/app-compat","fire-core-compat"),zv(Kv,"@firebase/analytics","fire-analytics"),zv(Kv,"@firebase/analytics-compat","fire-analytics-compat"),zv(Kv,"@firebase/app-check","fire-app-check"),zv(Kv,"@firebase/app-check-compat","fire-app-check-compat"),zv(Kv,"@firebase/auth","fire-auth"),zv(Kv,"@firebase/auth-compat","fire-auth-compat"),zv(Kv,"@firebase/database","fire-rtdb"),zv(Kv,"@firebase/database-compat","fire-rtdb-compat"),zv(Kv,"@firebase/functions","fire-fn"),zv(Kv,"@firebase/functions-compat","fire-fn-compat"),zv(Kv,"@firebase/installations","fire-iid"),zv(Kv,"@firebase/installations-compat","fire-iid-compat"),zv(Kv,"@firebase/messaging","fire-fcm"),zv(Kv,"@firebase/messaging-compat","fire-fcm-compat"),zv(Kv,"@firebase/performance","fire-perf"),zv(Kv,"@firebase/performance-compat","fire-perf-compat"),zv(Kv,"@firebase/remote-config","fire-rc"),zv(Kv,"@firebase/remote-config-compat","fire-rc-compat"),zv(Kv,"@firebase/storage","fire-gcs"),zv(Kv,"@firebase/storage-compat","fire-gcs-compat"),zv(Kv,"@firebase/firestore","fire-fst"),zv(Kv,"@firebase/firestore-compat","fire-fst-compat"),zv(Kv,"fire-js","fire-js"),zv(Kv,"firebase","fire-js-all"),Kv),gU=new Map,yU=new Map;function mU(e,t){try{e.container.addComponent(t)}catch(n){dU.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function kU(e){var t=e.name;if(yU.has(t))return dU.debug("There were multiple attempts to register component ".concat(t,".")),!1;yU.set(t,e);var n,r=ip(gU.values());try{for(r.s();!(n=r.n()).done;){mU(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function _U(e,t){return e.container.getProvider(t)}var wU=new NB("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."}),CU=function(){function e(t,n,r){var i=this;sp(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new eU("app",function(){return i},"PUBLIC"))}return cp(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw wU.create("app-deleted",{appName:this._name})}}]),e}(),bU="9.6.6";function EU(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vU,t=gU.get(e);if(!t)throw wU.create("no-app",{appName:e});return t}function SU(){return Array.from(gU.values())}function PU(e,t,n){var r,i=null!==(r=pU[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void dU.warn(s.join(" "))}kU(new eU("".concat(i,"-version"),function(){return{library:i,version:t}},"VERSION"))}kU(new eU("platform-logger",function(e){return new hU(e)},"PRIVATE")),PU(fU,"0.7.16",""),PU(fU,"0.7.16","esm2017"),PU("fire-js",""),PU("firebase","9.6.6","app");var OU=qv(6676),TU="@firebase/installations",IU="w:0.5.5",xU="FIS_v2",AU=new NB("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function RU(e){return e instanceof RB&&e.code.includes("request-failed")}function NU(e){var t=e.projectId;return"https://firebaseinstallations.googleapis.com/v1/projects/".concat(t,"/installations")}function MU(e){return{token:e.token,requestStatus:2,expiresIn:zU(e.expiresIn),creationTime:Date.now()}}function DU(e,t){return LU.apply(this,arguments)}function LU(){return(LU=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return r=e.sent.error,e.abrupt("return",AU.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status}));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function FU(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function BU(e,t){var n=t.refreshToken,r=FU(e);return r.append("Authorization",function(e){return"".concat(xU," ").concat(e)}(n)),r}function UU(e){return VU.apply(this,arguments)}function VU(){return(VU=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,e.abrupt("return",n.status>=500&&n.status<600?t():n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function zU(e){return Number(e.replace("s","000"))}function HU(e,t){return GU.apply(this,arguments)}function GU(){return(GU=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.fid,i=NU(t),a={method:"POST",headers:FU(t),body:JSON.stringify({fid:r,authVersion:xU,appId:t.appId,sdkVersion:IU})},e.next=5,UU(function(){return fetch(i,a)});case 5:if(!(o=e.sent).ok){e.next=11;break}return e.next=9,o.json();case 9:return s=e.sent,e.abrupt("return",{fid:s.fid||r,registrationStatus:2,refreshToken:s.refreshToken,authToken:MU(s.authToken)});case 11:return e.next=13,DU("Create Installation",o);case 13:throw e.sent;case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function qU(e){return new Promise(function(t){setTimeout(t,e)})}var $U=/^[cdef][\w-]{21}$/;function WU(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return function(e){return btoa(String.fromCharCode.apply(String,np(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return $U.test(t)?t:""}catch(n){return""}}function jU(e){return"".concat(e.appName,"!").concat(e.appId)}var ZU=new Map;function YU(e,t){var n=jU(e);KU(n,t),function(e,t){var n=(!JU&&"BroadcastChannel"in self&&((JU=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){KU(e.data.key,e.data.fid)}),JU);n&&n.postMessage({key:e,fid:t}),0===ZU.size&&JU&&(JU.close(),JU=null)}(n,t)}function KU(e,t){var n=ZU.get(e);if(n){var r,i=ip(n);try{for(i.s();!(r=i.n()).done;){(0,r.value)(t)}}catch(a){i.e(a)}finally{i.f()}}}var JU=null,QU="firebase-installations-store",XU=null;function eV(){return XU||(XU=(0,OU.openDb)("firebase-installations-database",1,function(e){switch(e.oldVersion){case 0:e.createObjectStore(QU)}})),XU}function tV(e,t){return nV.apply(this,arguments)}function nV(){return(nV=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=jU(t),e.next=3,eV();case 3:return i=e.sent.transaction(QU,"readwrite"),a=i.objectStore(QU),e.next=7,a.get(r);case 7:return o=e.sent,e.next=10,a.put(n,r);case 10:return e.next=12,i.complete;case 12:return(!o||o.fid!==n.fid)&&YU(t,n.fid),e.abrupt("return",n);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function rV(e){return iV.apply(this,arguments)}function iV(){return(iV=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=jU(t),e.next=3,eV();case 3:return r=e.sent.transaction(QU,"readwrite"),e.next=6,r.objectStore(QU).delete(n);case 6:return e.next=8,r.complete;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function aV(e,t){return oV.apply(this,arguments)}function oV(){return(oV=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=jU(t),e.next=3,eV();case 3:return i=e.sent.transaction(QU,"readwrite"),a=i.objectStore(QU),e.next=7,a.get(r);case 7:if(o=e.sent,void 0!==(s=n(o))){e.next=14;break}return e.next=12,a.delete(r);case 12:e.next=16;break;case 14:return e.next=16,a.put(s,r);case 16:return e.next=18,i.complete;case 18:return s&&(!o||o.fid!==s.fid)&&YU(t,s.fid),e.abrupt("return",s);case 20:case"end":return e.stop()}},e)}))).apply(this,arguments)}function sV(e){return uV.apply(this,arguments)}function uV(){return(uV=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,aV(t,function(e){var r=cV(e),i=lV(t,r);return n=i.registrationPromise,i.installationEntry});case 2:if(""!==(r=e.sent).fid){e.next=10;break}return e.next=6,n;case 6:e.t1=e.sent,e.t0={installationEntry:e.t1},e.next=11;break;case 10:e.t0={installationEntry:r,registrationPromise:n};case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function cV(e){return pV(e||{fid:WU(),registrationStatus:0})}function lV(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(AU.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(e,t){return hV.apply(this,arguments)}(e,n)}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:fV(e)}:{installationEntry:t}}function hV(){return(hV=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=tV,e.t1=t,e.next=5,HU(t,n);case 5:return e.t2=e.sent,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 9:if(e.prev=9,e.t3=e.catch(0),!RU(e.t3)||409!==e.t3.customData.serverCode){e.next=16;break}return e.next=14,rV(t);case 14:e.next=18;break;case 16:return e.next=18,tV(t,{fid:n.fid,registrationStatus:0});case 18:throw e.t3;case 19:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}function fV(e){return dV.apply(this,arguments)}function dV(){return(dV=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vV(t);case 2:n=e.sent;case 3:if(1!==n.registrationStatus){e.next=11;break}return e.next=6,qU(100);case 6:return e.next=8,vV(t);case 8:n=e.sent;case 9:e.next=3;break;case 11:if(0!==n.registrationStatus){e.next=18;break}return e.next=14,sV(t);case 14:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",a||i);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}function vV(e){return aV(e,function(e){if(!e)throw AU.create("installation-not-found");return pV(e)})}function pV(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function gV(e,t){return yV.apply(this,arguments)}function yV(){return(yV=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appConfig,i=t.platformLoggerProvider,a=mV(r,n),o=BU(r,n),(s=i.getImmediate({optional:!0}))&&o.append("x-firebase-client",s.getPlatformInfoString()),u={method:"POST",headers:o,body:JSON.stringify({installation:{sdkVersion:IU}})},e.next=6,UU(function(){return fetch(a,u)});case 6:if(!(c=e.sent).ok){e.next=13;break}return e.t0=MU,e.next=11,c.json();case 11:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 13:return e.next=15,DU("Generate Auth Token",c);case 15:throw e.sent;case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function mV(e,t){var n=t.fid;return"".concat(NU(e),"/").concat(n,"/authTokens:generate")}function kV(e){return _V.apply(this,arguments)}function _V(){return(_V=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.next=3,aV(t.appConfig,function(e){if(!PV(e))throw AU.create("not-registered");var i=e.authToken;if(!n&&OV(i))return e;if(1===i.requestStatus)return r=wV(t,n),e;if(!navigator.onLine)throw AU.create("app-offline");var a=TV(e);return r=EV(t,a),a});case 3:if(i=e.sent,!r){e.next=10;break}return e.next=7,r;case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=i.authToken;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function wV(e,t){return CV.apply(this,arguments)}function CV(){return(CV=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bV(t.appConfig);case 2:r=e.sent;case 3:if(1!==r.authToken.requestStatus){e.next=11;break}return e.next=6,qU(100);case 6:return e.next=8,bV(t.appConfig);case 8:r=e.sent;case 9:e.next=3;break;case 11:return i=r.authToken,e.abrupt("return",0===i.requestStatus?kV(t,n):i);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function bV(e){return aV(e,function(e){if(!PV(e))throw AU.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function EV(e,t){return SV.apply(this,arguments)}function SV(){return(SV=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,gV(t,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{authToken:r}),e.next=7,tV(t.appConfig,i);case 7:return e.abrupt("return",r);case 10:if(e.prev=10,e.t0=e.catch(0),RU(e.t0)&&(401===e.t0.customData.serverCode||404===e.t0.customData.serverCode)){e.next=18;break}return a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),e.next=16,tV(t.appConfig,a);case 16:e.next=20;break;case 18:return e.next=20,rV(t.appConfig);case 20:throw e.t0;case 21:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}function PV(e){return void 0!==e&&2===e.registrationStatus}function OV(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function TV(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function IV(){return(IV=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,sV(n.appConfig);case 3:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",(a?a.catch(console.error):kV(n).catch(console.error),i.fid));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xV(){return(xV=aB(regeneratorRuntime.mark(function e(t){var n,r,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],r=t,e.next=4,AV(r.appConfig);case 4:return e.next=6,kV(r,n);case 6:return e.abrupt("return",e.sent.token);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function AV(e){return RV.apply(this,arguments)}function RV(){return(RV=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sV(t);case 2:if(n=e.sent,r=n.registrationPromise,e.t0=r,!e.t0){e.next=8;break}return e.next=8,r;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function NV(e){return AU.create("missing-app-config-values",{valueName:e})}var MV="installations";kU(new eU(MV,function(e){var t=e.getProvider("app").getImmediate();return{app:t,appConfig:function(e){if(!e||!e.options)throw NV("App Configuration");if(!e.name)throw NV("App Name");for(var t=0,n=["projectId","apiKey","appId"];t<n.length;t++){var r=n[t];if(!e.options[r])throw NV(r)}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),platformLoggerProvider:_U(t,"platform-logger"),_delete:function(){return Promise.resolve()}}},"PUBLIC")),kU(new eU("installations-internal",function(e){var t=_U(e.getProvider("app").getImmediate(),MV).getImmediate();return{getId:function(){return function(e){return IV.apply(this,arguments)}(t)},getToken:function(e){return function(e){return xV.apply(this,arguments)}(t,e)}}},"PRIVATE")),PU(TU,"0.5.5"),PU(TU,"0.5.5","esm2017");var DV="@firebase/remote-config",LV=new NB("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),FV=function(){function e(t,n,r,i){sp(this,e),this.client=t,this.storage=n,this.storageCache=r,this.logger=i}return cp(e,[{key:"isCachedDataFresh",value:function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: ".concat(n,". Cache max age millis (minimumFetchIntervalMillis setting): ").concat(e,". Is cache hit: ").concat(r,".")),r}},{key:"fetch",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);case 2:if(r=n.sent,i=Hv(r,2),a=i[0],!(o=i[1])||!t.isCachedDataFresh(e.cacheMaxAgeMillis,a)){n.next=8;break}return n.abrupt("return",o);case 8:return e.eTag=o&&o.eTag,n.next=11,t.client.fetch(e);case 11:return s=n.sent,u=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===s.status&&u.push(t.storage.setLastSuccessfulFetchResponse(s)),n.next=16,Promise.all(u);case 16:return n.abrupt("return",s);case 17:case"end":return n.stop()}},n)}))()}}]),e}();function BV(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.languages&&e.languages[0]||e.language}var UV=function(){function e(t,n,r,i,a,o){sp(this,e),this.firebaseInstallations=t,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=a,this.appId=o}return cp(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l,h,f,d,v,p,g,y,m,k;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]);case 2:return r=n.sent,i=Hv(r,2),a=i[0],o=i[1],s="".concat(window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com","/v1/projects/").concat(t.projectId,"/namespaces/").concat(t.namespace,":fetch?key=").concat(t.apiKey),u={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},c={sdk_version:t.sdkVersion,app_instance_id:a,app_instance_id_token:o,app_id:t.appId,language_code:BV()},l={method:"POST",headers:u,body:JSON.stringify(c)},h=fetch(s,l),f=new Promise(function(t,n){e.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)})}),n.prev=12,n.next=15,Promise.race([h,f]);case 15:return n.next=17,h;case 17:d=n.sent,n.next=24;break;case 20:throw n.prev=20,n.t0=n.catch(12),v="fetch-client-network","AbortError"===n.t0.name&&(v="fetch-timeout"),LV.create(v,{originalErrorMessage:n.t0.message});case 24:if(p=d.status,g=d.headers.get("ETag")||void 0,200!==d.status){n.next=37;break}return n.prev=27,n.next=30,d.json();case 30:k=n.sent,n.next=36;break;case 33:throw n.prev=33,n.t1=n.catch(27),LV.create("fetch-client-parse",{originalErrorMessage:n.t1.message});case 36:y=k.entries,m=k.state;case 37:if("INSTANCE_STATE_UNSPECIFIED"===m?p=500:"NO_CHANGE"===m?p=304:("NO_TEMPLATE"===m||"EMPTY_CONFIG"===m)&&(y={}),304===p||200===p){n.next=39;break}throw LV.create("fetch-status",{httpStatus:p});case 39:return n.abrupt("return",{status:p,eTag:g,config:y});case 40:case"end":return n.stop()}},n,null,[[12,20],[27,33]])}))()})}]),e}(),VV=function(){function e(t,n){sp(this,e),this.client=t,this.storage=n}return cp(e,[{key:"fetch",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.getThrottleMetadata();case 2:if(n.t0=n.sent,n.t0){n.next=5;break}n.t0={backoffCount:0,throttleEndTimeMillis:Date.now()};case 5:return r=n.t0,n.abrupt("return",t.attemptFetch(e,r));case 7:case"end":return n.stop()}},n)}))()}},{key:"attemptFetch",value:function(e,t){var n=t.throttleEndTimeMillis,r=t.backoffCount,i=this;return aB(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(LV.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,n);case 2:return t.prev=2,t.next=5,i.client.fetch(e);case 5:return a=t.sent,t.next=8,i.storage.deleteThrottleMetadata();case 8:return t.abrupt("return",a);case 11:if(t.prev=11,t.t0=t.catch(2),function(e){if(!(e instanceof RB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t.t0)){t.next=15;break}throw t.t0;case 15:return o={throttleEndTimeMillis:Date.now()+QB(r),backoffCount:r+1},t.next=18,i.storage.setThrottleMetadata(o);case 18:return t.abrupt("return",i.attemptFetch(e,o));case 19:case"end":return t.stop()}},t,null,[[2,11]])}))()}}]),e}(),zV=function(){function e(t,n,r,i,a){sp(this,e),this.app=t,this._client=n,this._storageCache=r,this._storage=i,this._logger=a,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return cp(e,[{key:"fetchTimeMillis",get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}},{key:"lastFetchStatus",get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}]),e}();function HV(e,t){var n=e.target.error||void 0;return LV.create(t,{originalErrorMessage:n&&n.message})}var GV="app_namespace_store",qV=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Promise(function(e,t){try{var r=indexedDB.open("firebase_remote_config",1);r.onerror=function(e){t(HV(e,"storage-open"))},r.onsuccess=function(t){e(t.target.result)},r.onupgradeneeded=function(e){var t=e.target.result;switch(e.oldVersion){case 0:t.createObjectStore(GV,{keyPath:"compositeKey"})}}}catch(n){t(LV.create("storage-open",{originalErrorMessage:n}))}});sp(this,e),this.appId=t,this.appName=n,this.namespace=r,this.openDbPromise=i}return cp(e,[{key:"getLastFetchStatus",value:function(){return this.get("last_fetch_status")}},{key:"setLastFetchStatus",value:function(e){return this.set("last_fetch_status",e)}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.get("last_successful_fetch_timestamp_millis")}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.set("last_successful_fetch_timestamp_millis",e)}},{key:"getLastSuccessfulFetchResponse",value:function(){return this.get("last_successful_fetch_response")}},{key:"setLastSuccessfulFetchResponse",value:function(e){return this.set("last_successful_fetch_response",e)}},{key:"getActiveConfig",value:function(){return this.get("active_config")}},{key:"setActiveConfig",value:function(e){return this.set("active_config",e)}},{key:"getActiveConfigEtag",value:function(){return this.get("active_config_etag")}},{key:"setActiveConfigEtag",value:function(e){return this.set("active_config_etag",e)}},{key:"getThrottleMetadata",value:function(){return this.get("throttle_metadata")}},{key:"setThrottleMetadata",value:function(e){return this.set("throttle_metadata",e)}},{key:"deleteThrottleMetadata",value:function(){return this.delete("throttle_metadata")}},{key:"get",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a=r.transaction([GV],"readonly").objectStore(GV),o=t.createCompositeKey(e);try{var s=a.get(o);s.onerror=function(e){i(HV(e,"storage-get"))},s.onsuccess=function(e){var t=e.target.result;n(t?t.value:void 0)}}catch(s){i(LV.create("storage-get",{originalErrorMessage:s&&s.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"set",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.openDbPromise;case 2:return i=r.sent,r.abrupt("return",new Promise(function(r,a){var o=i.transaction([GV],"readwrite").objectStore(GV),s=n.createCompositeKey(e);try{var u=o.put({compositeKey:s,value:t});u.onerror=function(e){a(HV(e,"storage-set"))},u.onsuccess=function(){r()}}catch(u){a(LV.create("storage-set",{originalErrorMessage:u&&u.message}))}}));case 4:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a=r.transaction([GV],"readwrite").objectStore(GV),o=t.createCompositeKey(e);try{var s=a.delete(o);s.onerror=function(e){i(HV(e,"storage-delete"))},s.onsuccess=function(){n()}}catch(s){i(LV.create("storage-delete",{originalErrorMessage:s&&s.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"createCompositeKey",value:function(e){return[this.appId,this.appName,this.namespace,e].join()}}]),e}(),$V=function(){function e(t){sp(this,e),this.storage=t}return cp(e,[{key:"getLastFetchStatus",value:function(){return this.lastFetchStatus}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.lastSuccessfulFetchTimestampMillis}},{key:"getActiveConfig",value:function(){return this.activeConfig}},{key:"loadFromStorage",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),t.next=5,n;case 5:return(a=t.sent)&&(e.lastFetchStatus=a),t.next=9,r;case 9:return(o=t.sent)&&(e.lastSuccessfulFetchTimestampMillis=o),t.next=13,i;case 13:(s=t.sent)&&(e.activeConfig=s);case 15:case"end":return t.stop()}},t)}))()}},{key:"setLastFetchStatus",value:function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}},{key:"setActiveConfig",value:function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}]),e}();function WV(){return(WV=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(IB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,xB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}kU(new eU("remote-config",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw LV.create("registration-window");if(!IB())throw LV.create("indexed-db-unavailable");var a=r.options,o=a.projectId,s=a.apiKey,u=a.appId;if(!o)throw LV.create("registration-project-id");if(!s)throw LV.create("registration-api-key");if(!u)throw LV.create("registration-app-id");var c=new qV(u,r.name,n=n||"firebase"),l=new $V(c),h=new lU(DV);h.logLevel=aU.ERROR;var f=new UV(i,bU,n,o,s,u),d=new VV(f,c),v=new FV(d,c,l,h),p=new zV(r,v,l,c,h);return function(e){var t=XB(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0}))}(p),p},"PUBLIC").setMultipleInstances(!0)),PU(DV,"0.3.4"),PU(DV,"0.3.4","esm2017");var jV="/firebase-messaging-sw.js",ZV="/firebase-cloud-messaging-push-scope",YV="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",KV="google.c.a.c_id",JV="google.c.a.c_l",QV="google.c.a.ts",XV="google.c.a.e",ez=(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(ez||(ez={})),ez);function tz(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,np(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function nz(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var rz="fcm_token_details_db",iz="fcm_token_object_Store";function az(e){return oz.apply(this,arguments)}function oz(){return(oz=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="databases"in indexedDB,!e.t0){e.next=5;break}return e.next=4,indexedDB.databases();case 4:e.t0=!e.sent.map(function(e){return e.name}).includes(rz);case 5:if(!e.t0){e.next=7;break}return e.abrupt("return",null);case 7:return n=null,e.next=10,(0,OU.openDb)(rz,5,function(){var e=aB(regeneratorRuntime.mark(function e(r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.oldVersion<2)&&r.objectStoreNames.contains(iz)){e.next=2;break}return e.abrupt("return");case 2:return a=r.transaction.objectStore(iz),e.next=5,a.index("fcmSenderId").get(t);case 5:return o=e.sent,e.next=8,a.clear();case 8:if(!o){e.next=17;break}if(2!==r.oldVersion){e.next=16;break}if((s=o).auth&&s.p256dh&&s.endpoint){e.next=13;break}return e.abrupt("return");case 13:n={token:s.fcmToken,createTime:null!==(i=s.createTime)&&void 0!==i?i:Date.now(),subscriptionOptions:{auth:s.auth,p256dh:s.p256dh,endpoint:s.endpoint,swScope:s.swScope,vapidKey:"string"==typeof s.vapidKey?s.vapidKey:tz(s.vapidKey)}},e.next=17;break;case 16:3===r.oldVersion?n={token:(u=o).fcmToken,createTime:u.createTime,subscriptionOptions:{auth:tz(u.auth),p256dh:tz(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:tz(u.vapidKey)}}:4===r.oldVersion&&(n={token:(c=o).fcmToken,createTime:c.createTime,subscriptionOptions:{auth:tz(c.auth),p256dh:tz(c.p256dh),endpoint:c.endpoint,swScope:c.swScope,vapidKey:tz(c.vapidKey)}});case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 10:return e.sent.close(),e.next=13,(0,OU.deleteDb)(rz);case 13:return e.next=15,(0,OU.deleteDb)("fcm_vapid_details_db");case 15:return e.next=17,(0,OU.deleteDb)("undefined");case 17:return e.abrupt("return",sz(n)?n:null);case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}function sz(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}var uz="firebase-messaging-store",cz=null;function lz(){return cz||(cz=(0,OU.openDb)("firebase-messaging-database",1,function(e){switch(e.oldVersion){case 0:e.createObjectStore(uz)}})),cz}function hz(e){return fz.apply(this,arguments)}function fz(){return(fz=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=yz(t),e.next=3,lz();case 3:return e.next=5,e.sent.transaction(uz).objectStore(uz).get(n);case 5:if(!(r=e.sent)){e.next=8;break}return e.abrupt("return",r);case 8:return e.next=10,az(t.appConfig.senderId);case 10:if(!(i=e.sent)){e.next=15;break}return e.next=14,dz(t,i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function dz(e,t){return vz.apply(this,arguments)}function vz(){return(vz=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=yz(t),e.next=3,lz();case 3:return i=e.sent.transaction(uz,"readwrite"),e.next=6,i.objectStore(uz).put(n,r);case 6:return e.next=8,i.complete;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function pz(e){return gz.apply(this,arguments)}function gz(){return(gz=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=yz(t),e.next=3,lz();case 3:return r=e.sent.transaction(uz,"readwrite"),e.next=6,r.objectStore(uz).delete(n);case 6:return e.next=8,r.complete;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function yz(e){return e.appConfig.appId}var mz=new NB("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function kz(e,t){return _z.apply(this,arguments)}function _z(){return(_z=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pz(t);case 2:return r=e.sent,i=Tz(n),a={method:"POST",headers:r,body:JSON.stringify(i)},e.prev=5,e.next=8,fetch(Sz(t.appConfig),a);case 8:return e.next=10,e.sent.json();case 10:o=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),mz.create("token-subscribe-failed",{errorInfo:e.t0});case 16:if(!o.error){e.next=18;break}throw mz.create("token-subscribe-failed",{errorInfo:o.error.message});case 18:if(o.token){e.next=20;break}throw mz.create("token-subscribe-no-token");case 20:return e.abrupt("return",o.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])}))).apply(this,arguments)}function wz(e,t){return Cz.apply(this,arguments)}function Cz(){return(Cz=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pz(t);case 2:return r=e.sent,i=Tz(n.subscriptionOptions),a={method:"PATCH",headers:r,body:JSON.stringify(i)},e.prev=5,e.next=8,fetch("".concat(Sz(t.appConfig),"/").concat(n.token),a);case 8:return e.next=10,e.sent.json();case 10:o=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),mz.create("token-update-failed",{errorInfo:e.t0});case 16:if(!o.error){e.next=18;break}throw mz.create("token-update-failed",{errorInfo:o.error.message});case 18:if(o.token){e.next=20;break}throw mz.create("token-update-no-token");case 20:return e.abrupt("return",o.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])}))).apply(this,arguments)}function bz(e,t){return Ez.apply(this,arguments)}function Ez(){return(Ez=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pz(t);case 2:return e.t0=e.sent,r={method:"DELETE",headers:e.t0},e.prev=4,e.next=7,fetch("".concat(Sz(t.appConfig),"/").concat(n),r);case 7:return e.next=9,e.sent.json();case 9:if(!(i=e.sent).error){e.next=12;break}throw mz.create("token-unsubscribe-failed",{errorInfo:i.error.message});case 12:e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(4),mz.create("token-unsubscribe-failed",{errorInfo:e.t1});case 17:case"end":return e.stop()}},e,null,[[4,14]])}))).apply(this,arguments)}function Sz(e){var t=e.projectId;return"https://fcmregistrations.googleapis.com/v1/projects/".concat(t,"/registrations")}function Pz(e){return Oz.apply(this,arguments)}function Oz(){return(Oz=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appConfig,r=t.installations,e.next=3,r.getToken();case 3:return i=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(i)}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Tz(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==YV&&(a.web.applicationPubKey=i),a}function Iz(e){return xz.apply(this,arguments)}function xz(){return(xz=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fz(t.swRegistration,t.vapidKey);case 2:return n=e.sent,r={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:n.endpoint,auth:tz(n.getKey("auth")),p256dh:tz(n.getKey("p256dh"))},e.next=6,hz(t.firebaseDependencies);case 6:if(!(i=e.sent)){e.next=19;break}if(!Uz(i.subscriptionOptions,r)){e.next=10;break}return e.abrupt("return",Date.now()>=i.createTime+6048e5?Nz(t,{token:i.token,createTime:Date.now(),subscriptionOptions:r}):i.token);case 10:return e.prev=10,e.next=13,bz(t.firebaseDependencies,i.token);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.warn(e.t0);case 18:case 19:return e.abrupt("return",Dz(t.firebaseDependencies,r));case 20:case"end":return e.stop()}},e,null,[[10,15]])}))).apply(this,arguments)}function Az(e){return Rz.apply(this,arguments)}function Rz(){return(Rz=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hz(t.firebaseDependencies);case 2:if(n=e.sent,e.t0=n,!e.t0){e.next=9;break}return e.next=7,bz(t.firebaseDependencies,n.token);case 7:return e.next=9,pz(t.firebaseDependencies);case 9:return e.next=11,t.swRegistration.pushManager.getSubscription();case 11:return r=e.sent,e.abrupt("return",!r||r.unsubscribe());case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Nz(e,t){return Mz.apply(this,arguments)}function Mz(){return(Mz=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,wz(t.firebaseDependencies,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{token:r,createTime:Date.now()}),e.next=7,dz(t.firebaseDependencies,i);case 7:return e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,Az(t);case 14:throw e.t0;case 15:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}function Dz(e,t){return Lz.apply(this,arguments)}function Lz(){return(Lz=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kz(t,n);case 2:return e.t0=e.sent,e.t1=Date.now(),e.t2=n,r={token:e.t0,createTime:e.t1,subscriptionOptions:e.t2},e.next=8,dz(t,r);case 8:return e.abrupt("return",r.token);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Fz(e,t){return Bz.apply(this,arguments)}function Bz(){return(Bz=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:nz(n)});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Uz(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function Vz(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i)}}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){if(t.fcmOptions){e.fcmOptions={};var n=t.fcmOptions.link;n&&(e.fcmOptions.link=n);var r=t.fcmOptions.analytics_label;r&&(e.fcmOptions.analyticsLabel=r)}}(t,e),t}function zz(e){return"object"==typeof e&&!!e&&KV in e}function Hz(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function Gz(e){return mz.create("missing-app-config-values",{valueName:e})}Hz("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Hz("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var qz=function(){function e(t,n,r){sp(this,e),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var i=function(e){if(!e||!e.options)throw Gz("App Configuration Object");if(!e.name)throw Gz("App Name");for(var t=e.options,n=0,r=["projectId","apiKey","appId","messagingSenderId"];n<r.length;n++){var i=r[n];if(!t[i])throw Gz(i)}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:n,analyticsProvider:r}}return cp(e,[{key:"_delete",value:function(){return Promise.resolve()}}]),e}();function $z(e){return Wz.apply(this,arguments)}function Wz(){return(Wz=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register(jV,{scope:ZV});case 3:t.swRegistration=e.sent,t.swRegistration.update().catch(function(){}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),mz.create("failed-service-worker-registration",{browserErrorMessage:e.t0.message});case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function jz(e,t){return Zz.apply(this,arguments)}function Zz(){return(Zz=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!n&&!t.swRegistration,!e.t0){e.next=4;break}return e.next=4,$z(t);case 4:if(!n&&t.swRegistration){e.next=8;break}if(n instanceof ServiceWorkerRegistration){e.next=7;break}throw mz.create("invalid-sw-registration");case 7:t.swRegistration=n;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Yz(e,t){return Kz.apply(this,arguments)}function Kz(){return(Kz=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n?t.vapidKey=n:t.vapidKey||(t.vapidKey=YV);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Jz(){return(Jz=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw mz.create("only-available-in-window");case 2:if(e.t0="default"===Notification.permission,!e.t0){e.next=6;break}return e.next=6,Notification.requestPermission();case 6:if("granted"===Notification.permission){e.next=8;break}throw mz.create("permission-blocked");case 8:return e.next=10,Yz(t,null==n?void 0:n.vapidKey);case 10:return e.next=12,jz(t,null==n?void 0:n.serviceWorkerRegistration);case 12:return e.abrupt("return",Iz(t));case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Qz(e,t,n){return Xz.apply(this,arguments)}function Xz(){return(Xz=aB(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=eH(n),e.next=3,t.firebaseDependencies.analyticsProvider.get();case 3:e.sent.logEvent(i,{message_id:r[KV],message_name:r[JV],message_time:r[QV],message_device_time:Math.floor(Date.now()/1e3)});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function eH(e){switch(e){case ez.NOTIFICATION_CLICKED:return"notification_open";case ez.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function tH(){return(tH=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.data).isFirebaseMessaging){e.next=3;break}return e.abrupt("return");case 3:if(t.onMessageHandler&&r.messageType===ez.PUSH_RECEIVED&&("function"==typeof t.onMessageHandler?t.onMessageHandler(Vz(r)):t.onMessageHandler.next(Vz(r))),i=r.data,e.t0=zz(i)&&"1"===i[XV],!e.t0){e.next=9;break}return e.next=9,Qz(t,r.messageType,i);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var nH="@firebase/messaging";function rH(){return(rH=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xB();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",!1);case 8:return e.abrupt("return","undefined"!=typeof window&&IB()&&AB()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"));case 9:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}kU(new eU("messaging",function(e){var t=new qz(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",function(e){return function(e,t){return tH.apply(this,arguments)}(t,e)}),t},"PUBLIC")),kU(new eU("messaging-internal",function(e){var t=e.getProvider("messaging").getImmediate();return{getToken:function(e){return function(e,t){return Jz.apply(this,arguments)}(t,e)}}},"PRIVATE")),PU(nH,"0.9.8"),PU(nH,"0.9.8","esm2017");var iH="analytics",aH="firebase_id",oH="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",sH="https://www.googletagmanager.com/gtag/js",uH=new lU("@firebase/analytics");function cH(e){return Promise.all(e.map(function(e){return e.catch(function(e){return e})}))}function lH(e,t){var n=document.createElement("script");n.src="".concat(sH,"?l=").concat(e,"&id=").concat(t),n.async=!0,document.head.appendChild(n)}function hH(e,t,n,r,i,a){return fH.apply(this,arguments)}function fH(){return(fH=aB(regeneratorRuntime.mark(function e(t,n,r,i,a,o){var s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i[a],e.prev=1,!s){e.next=7;break}return e.next=5,n[s];case 5:e.next=14;break;case 7:return e.next=9,cH(r);case 9:if(u=e.sent.find(function(e){return e.measurementId===a}),e.t0=u,!e.t0){e.next=14;break}return e.next=14,n[u.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),uH.error(e.t1);case 19:t("config",a,o);case 20:case"end":return e.stop()}},e,null,[[1,16]])}))).apply(this,arguments)}function dH(e,t,n,r,i){return vH.apply(this,arguments)}function vH(){return(vH=aB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,u,c,l,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=[],!a||!a.send_to){e.next=26;break}return s=a.send_to,Array.isArray(s)||(s=[s]),e.next=7,cH(r);case 7:u=e.sent,c=ip(s),e.prev=9,h=function(){var e=l.value,t=u.find(function(t){return t.measurementId===e}),r=t&&n[t.appId];if(!r)return o=[],"break";o.push(r)},c.s();case 12:if((l=c.n()).done){e.next=18;break}if("break"!==h()){e.next=16;break}return e.abrupt("break",18);case 16:e.next=12;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return 0===o.length&&(o=Object.values(n)),e.next=29,Promise.all(o);case 29:t("event",i,a||{}),e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),uH.error(e.t1);case 35:case"end":return e.stop()}},e,null,[[0,32],[9,20,23,26]])}))).apply(this,arguments)}function pH(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(sH))return r}return null}var gH=new NB("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),yH=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;sp(this,e),this.throttleMetadata=t,this.intervalMillis=n}return cp(e,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),e}());function mH(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function kH(e){return _H.apply(this,arguments)}function _H(){return(_H=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appId,i=t.apiKey,a={method:"GET",headers:mH(i)},o=oH.replace("{app-id}",r),e.next=6,fetch(o,a);case 6:if(200===(s=e.sent).status||304===s.status){e.next=19;break}return u="",e.prev=9,e.next=12,s.json();case 12:c=e.sent,(null===(n=c.error)||void 0===n?void 0:n.message)&&(u=c.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw gH.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 19:return e.abrupt("return",s.json());case 20:case"end":return e.stop()}},e,null,[[9,16]])}))).apply(this,arguments)}function wH(e){return CH.apply(this,arguments)}function CH(){return(CH=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:yH,r=l.length>2?l[2]:void 0,i=t.options,a=i.appId,o=i.apiKey,s=i.measurementId,a){e.next=5;break}throw gH.create("no-app-id");case 5:if(o){e.next=9;break}if(!s){e.next=8;break}return e.abrupt("return",{measurementId:s,appId:a});case 8:throw gH.create("no-api-key");case 9:return u=n.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new OH,e.abrupt("return",(setTimeout(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.abort();case 1:case"end":return e.stop()}},e)})),void 0!==r?r:6e4),bH({appId:a,apiKey:o,measurementId:s},u,c,n)));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function bH(e,t,n){return EH.apply(this,arguments)}function EH(){return(EH=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,h,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.throttleEndTimeMillis,a=n.backoffCount,o=f.length>3&&void 0!==f[3]?f[3]:yH,s=t.appId,u=t.measurementId,e.prev=3,e.next=6,SH(r,i);case 6:e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(3),!u){e.next=12;break}return e.abrupt("return",(uH.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(u,' provided in the "measurementId" field in the local Firebase config. [').concat(e.t0.message,"]")),{appId:s,measurementId:u}));case 12:throw e.t0;case 13:return e.prev=13,e.next=16,kH(t);case 16:return c=e.sent,e.abrupt("return",(o.deleteThrottleMetadata(s),c));case 20:if(e.prev=20,e.t1=e.catch(13),PH(e.t1)){e.next=26;break}if(o.deleteThrottleMetadata(s),!u){e.next=25;break}return e.abrupt("return",(uH.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(u,' provided in the "measurementId" field in the local Firebase config. [').concat(e.t1.message,"]")),{appId:s,measurementId:u}));case 25:throw e.t1;case 26:return l=503===Number(e.t1.customData.httpStatus)?QB(a,o.intervalMillis,30):QB(a,o.intervalMillis),h={throttleEndTimeMillis:Date.now()+l,backoffCount:a+1},e.abrupt("return",(o.setThrottleMetadata(s,h),uH.debug("Calling attemptFetch again in ".concat(l," millis")),bH(t,h,r,o)));case 28:case"end":return e.stop()}},e,null,[[3,8],[13,20]])}))).apply(this,arguments)}function SH(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(gH.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function PH(e){if(!(e instanceof RB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var OH=function(){function e(){sp(this,e),this.listeners=[]}return cp(e,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach(function(e){return e()})}}]),e}();function TH(){return IH.apply(this,arguments)}function IH(){return(IH=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(IB()){e.next=2;break}return e.abrupt("return",(uH.warn(gH.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1));case 2:return e.prev=2,e.next=5,xB();case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",(uH.warn(gH.create("indexeddb-unavailable",{errorInfo:e.t0}).message),!1));case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,null,[[2,7]])}))).apply(this,arguments)}function xH(){return(xH=aB(regeneratorRuntime.mark(function e(t,n,r,i,a,o,s){var u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(c=wH(t)).then(function(e){r[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&uH.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,") does not match the measurement ID fetched from the server (").concat(e.measurementId,"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config."))}).catch(function(e){return uH.error(e)}),n.push(c),l=TH().then(function(e){if(e)return i.getId()}),e.next=5,Promise.all([c,l]);case 5:return h=e.sent,f=Hv(h,2),d=f[0],v=f[1],pH()||lH(o,d.measurementId),a("js",new Date),p=null!==(u=null==s?void 0:s.config)&&void 0!==u?u:{},e.abrupt("return",(p.origin="firebase",p.update=!0,null!=v&&(p[aH]=v),a("config",d.measurementId,p),d.measurementId));case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}var AH,RH,NH=function(){function e(t){sp(this,e),this.app=t}return cp(e,[{key:"_delete",value:function(){return delete MH[this.app.options.appId],Promise.resolve()}}]),e}(),MH={},DH=[],LH={},FH="dataLayer",BH=!1;function UH(){return(UH=aB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=4;break}t("event",r,i),e.next=8;break;case 4:return e.next=6,n;case 6:o=e.sent,t("event",r,Object.assign(Object.assign({},i),{send_to:o}));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function VH(){return(VH=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!PB()&&AB()&&IB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,xB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var zH="@firebase/analytics";kU(new eU(iH,function(e,t){var n=t.options;return function(e,t,n){!function(){var e=[];if(PB()&&e.push("This is a browser extension environment."),AB()||e.push("Cookies are not available."),e.length>0){var t=e.map(function(e,t){return"(".concat(t+1,") ").concat(e)}).join(" "),n=gH.create("invalid-analytics-context",{errorInfo:t});uH.warn(n.message)}}();var r=e.options.appId;if(!r)throw gH.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw gH.create("no-api-key");uH.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '.concat(e.options.measurementId,' provided in the "measurementId" field in the local Firebase config.'))}if(null!=MH[r])throw gH.create("already-exists",{id:r});if(!BH){!function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(FH);var i=function(e,t,n,r,i){var a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(a=window[i]),window[i]=function(e,t,n,r){function i(){return(i=aB(regeneratorRuntime.mark(function i(a,o,s){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,"event"!==a){i.next=6;break}return i.next=4,dH(e,t,n,o,s);case 4:i.next=12;break;case 6:if("config"!==a){i.next=11;break}return i.next=9,hH(e,t,n,r,o,s);case 9:i.next=12;break;case 11:e("set",o);case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),uH.error(i.t0);case 17:case"end":return i.stop()}},i,null,[[0,14]])}))).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(MH,DH,LH,FH,"gtag"),a=i.wrappedGtag,o=i.gtagCore;RH=a,AH=o,BH=!0}return MH[r]=function(e,t,n,r,i,a,o){return xH.apply(this,arguments)}(e,DH,LH,t,AH,FH,n),new NH(e)}(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),kU(new eU("analytics-internal",function(e){try{var t=e.getProvider(iH).getImmediate();return{logEvent:function(e,n,r){return function(e,t,n,r){e=XB(e),function(e,t,n,r,i){return UH.apply(this,arguments)}(RH,MH[e.app.options.appId],t,n,r).catch(function(e){return uH.error(e)})}(t,e,n,r)}}}catch(t){throw gH.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),PU(zH,"0.7.5"),PU(zH,"0.7.5","esm2017");var HH=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this)}return cp(n,[{key:"schedule",value:function(e){return this}}]),n}(lp),GH={setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=GH.delegate;return((null==e?void 0:e.setInterval)||setInterval).apply(void 0,arguments)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=GH.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)}),delegate:void 0},qH=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return cp(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return GH.setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!=n&&this.delay===n&&!1===this.pending)return t;GH.clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}},{key:"unsubscribe",value:function(){if(!this.closed){var e=this.id,t=this.scheduler,r=t.actions;this.work=this.state=this.scheduler=null,this.pending=!1,op(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,jv(tp(n.prototype),"unsubscribe",this).call(this)}}}]),n}(HH),$H={now:function(){return($H.delegate||Date).now()},delegate:void 0},WH=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;sp(this,e),this.schedulerActionCtor=t,this.now=n}return cp(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.schedulerActionCtor(this,e).schedule(n,t)}}]),e}();WH.now=$H.now;var jH=function(e){Yv(n,e);var t=Jv(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:WH.now;return sp(this,n),(r=t.call(this,e,i)).actions=[],r._active=!1,r._scheduled=void 0,r}return cp(n,[{key:"flush",value:function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(WH),ZH=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n)}(jH))(function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return cp(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?jv(tp(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?jv(tp(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=r&&r>0||null==r&&this.delay>0?jv(tp(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(qH)),YH=new jH(qH),KH=new pS("7.2.0"),JH="__angularfire_symbol__analyticsIsSupported",QH="__angularfire_symbol__remoteConfigIsSupported",XH="__angularfire_symbol__messagingIsSupported";function eG(e,t,n){if(t){if(1===t.length)return t[0];var r=t.filter(function(e){return e.app===n});if(1===r.length)return r[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[JH]||(globalThis[JH]=function(){return VH.apply(this,arguments)}().then(function(e){return globalThis.__angularfire_symbol__analyticsIsSupportedValue=e})),globalThis[XH]||(globalThis[XH]=function(){return rH.apply(this,arguments)}().then(function(e){return globalThis.__angularfire_symbol__messagingIsSupportedValue=e})),globalThis[QH]||(globalThis[QH]=function(){return WV.apply(this,arguments)}().then(function(e){return globalThis.__angularfire_symbol__remoteConfigIsSupportedValue=e}));var tG=function(e,t){var n=t?[t]:SU(),r=[];return n.forEach(function(t){t.container.getProvider(e).instances.forEach(function(e){r.includes(e)||r.push(e)})}),r};function nG(){}var rG=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ZH;sp(this,e),this.zone=t,this.delegate=n}return cp(e,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(e,t,n){var r=this.zone;return this.delegate.schedule(function(t){var n=this;r.runGuarded(function(){e.apply(n,[t])})},t,n)}}]),e}(),iG=function(){function e(t){sp(this,e),this.zone=t,this.task=null}return cp(e,[{key:"call",value:function(e,t){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",nG,{},nG,nG)}),t.pipe(mR({next:n,complete:n,error:n})).subscribe(e).add(n)}},{key:"unscheduleTask",value:function(){var e=this;setTimeout(function(){null!=e.task&&"scheduled"===e.task.state&&(e.task.invoke(),e.task=null)},10)}}]),e}(),aG=function(){var e=cp(function e(t){sp(this,e),this.ngZone=t,this.outsideAngular=t.runOutsideAngular(function(){return new rG(Zone.current)}),this.insideAngular=t.run(function(){return new rG(Zone.current,YH)}),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)});return e.\u0275fac=function(t){return new(t||e)(Rk(tO))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function oG(){var e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function sG(e){return oG().ngZone.runOutsideAngular(function(){return e()})}function uG(e){return oG().ngZone.run(function(){return e()})}function cG(e){return oG(),function(e){return function(t){return(t=t.lift(new iG(e.ngZone))).pipe(fg(e.outsideAngular),hg(e.insideAngular))}}(oG())(e)}var lG=function(e,t){var n=void 0;return function(){var r=arguments;return t&&setTimeout(function(){"scheduled"===t.state&&t.invoke()},10),uG(function(){return e.apply(n,r)})}},hG=function(e,t){return function(){for(var n,r=arguments,i=this,a=0;a<arguments.length;a++)"function"==typeof arguments[a]&&(t&&(n||(n=uG(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",nG,{},nG,nG)}))),arguments[a]=lG(arguments[a],n));var o=sG(function(){return e.apply(i,r)});if(!t){if(o instanceof Mp){var s=oG();return o.pipe(fg(s.outsideAngular),hg(s.insideAngular))}return uG(function(){return o})}return o instanceof Mp?o.pipe(cG):o instanceof Promise?uG(function(){return new Promise(function(e,t){return o.then(function(t){return uG(function(){return e(t)})},function(e){return uG(function(){return t(e)})})})}):"function"==typeof o&&n?function(){return setTimeout(function(){n&&"scheduled"===n.state&&n.invoke()},10),o.apply(this,arguments)}:uG(function(){return o})}},fG=cp(function e(t){return sp(this,e),t}),dG=cp(function e(){return sp(this,e),SU()}),vG=new fk("angularfire2._apps"),pG={provide:fG,useFactory:function(e){return e&&1===e.length?e[0]:new fG(EU())},deps:[[new Vk,vG]]},gG={provide:dG,deps:[[new Vk,vG]]};function yG(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new fG(r)}}var mG=function(){var e=cp(function e(t){sp(this,e),PU("angularfire",KH.full,"core"),PU("angularfire",KH.full,"app"),PU("angular",gS.full,t.toString())});return e.\u0275fac=function(t){return new(t||e)(Rk(VP))},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({providers:[pG,gG]}),e}(),kG=hG(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"!=typeof t&&(t={name:t});var n=Object.assign({name:vU,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw wU.create("bad-app-name",{appName:String(r)});var i=gU.get(r);if(i){if(HB(e,i.options)&&HB(n,i.config))return i;throw wU.create("duplicate-app",{appName:r})}var a,o=new rU(r),s=ip(yU.values());try{for(s.s();!(a=s.n()).done;){var u=a.value;o.addComponent(u)}}catch(l){s.e(l)}finally{s.f()}var c=new CU(e,n,o);return gU.set(r,c),c},!0),_G=new Map,wG={activated:!1,tokenObservers:[]},CG={initialized:!1,enabled:!1};function bG(e){return _G.get(e)||wG}function EG(e,t){_G.set(e,t)}function SG(){return CG}var PG=function(){function e(t,n,r,i,a){if(sp(this,e),this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}return cp(e,[{key:"start",value:function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(function(){})}},{key:"stop",value:function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}},{key:"isRunning",value:function(){return!!this.pending}},{key:"process",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stop(),n.prev=1,t.pending=new CB,n.next=5,function(e){return new Promise(function(t){setTimeout(t,e)})}(t.getNextRun(e));case 5:return t.pending.resolve(),n.next=8,t.pending.promise;case 8:return t.pending=new CB,n.next=11,t.operation();case 11:return t.pending.resolve(),n.next=14,t.pending.promise;case 14:t.process(!0).catch(function(){}),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(1),t.retryPolicy(n.t0)?t.process(!1).catch(function(){}):t.stop();case 20:case"end":return n.stop()}},n,null,[[1,17]])}))()}},{key:"getNextRun",value:function(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}]),e}(),OG=new NB("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function TG(e){if(!bG(e).activated)throw OG.create("use-before-activation",{appName:e.name})}function IG(e,t){return xG.apply(this,arguments)}function xG(){return(xG=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.url,i=t.body,a={"Content-Type":"application/json"},(o=n.getImmediate({optional:!0}))&&(a["X-Firebase-Client"]=o.getPlatformInfoString()),s={method:"POST",body:JSON.stringify(i),headers:a},e.prev=4,e.next=7,fetch(r,s);case 7:u=e.sent,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(4),OG.create("fetch-network-error",{originalErrorMessage:e.t0.message});case 13:if(200===u.status){e.next=15;break}throw OG.create("fetch-status-error",{httpStatus:u.status});case 15:return e.prev=15,e.next=18,u.json();case 18:c=e.sent,e.next=24;break;case 21:throw e.prev=21,e.t1=e.catch(15),OG.create("fetch-parse-error",{originalErrorMessage:e.t1.message});case 24:if((l=c.ttl.match(/^([\d.]+)(s)$/))&&l[2]&&!isNaN(Number(l[1]))){e.next=27;break}throw OG.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: ".concat(c.ttl)});case 27:return h=1e3*Number(l[1]),f=Date.now(),e.abrupt("return",{token:c.attestationToken,expireTimeMillis:f+h,issuedAtTimeMillis:f});case 29:case"end":return e.stop()}},e,null,[[4,10],[15,21]])}))).apply(this,arguments)}function AG(e,t){var n=e.options,r=n.projectId,i=n.appId,a=n.apiKey;return{url:"https://content-firebaseappcheck.googleapis.com/v1beta/projects/".concat(r,"/apps/").concat(i,":exchangeDebugToken?key=").concat(a),body:{debug_token:t}}}var RG="firebase-app-check-store",NG=null;function MG(){return NG||(NG=new Promise(function(e,t){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(t){e(t.target.result)},n.onerror=function(e){var n;t(OG.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(e){var t=e.target.result;switch(e.oldVersion){case 0:t.createObjectStore(RG,{keyPath:"compositeKey"})}}}catch(n){t(OG.create("storage-open",{originalErrorMessage:n.message}))}}))}function DG(){return(DG=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,MG();case 2:return r=e.sent.transaction(RG,"readwrite"),i=r.objectStore(RG).put({compositeKey:t,value:n}),e.abrupt("return",new Promise(function(e,t){i.onsuccess=function(t){e()},r.onerror=function(e){var n;t(OG.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var LG=new lU("@firebase/app-check");function FG(e,t){return IB()?function(e,t){return function(e,t){return DG.apply(this,arguments)}(function(e){return"".concat(e.options.appId,"-").concat(e.name)}(e),t)}(e,t).catch(function(e){LG.warn("Failed to write token to IndexedDB. Error: ".concat(e))}):Promise.resolve()}function BG(){return SG().enabled}function UG(){return VG.apply(this,arguments)}function VG(){return(VG=aB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=SG()).enabled||!t.token){e.next=3;break}return e.abrupt("return",t.token.promise);case 3:throw Error("\n            Can't get debug token in production mode.\n        ");case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var zG={error:"UNKNOWN_ERROR"};function HG(e){return pB.encodeString(JSON.stringify(e),!1)}function GG(e){return qG.apply(this,arguments)}function qG(){return(qG=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h.length>1&&void 0!==h[1]&&h[1],TG(r=t.app),i=bG(r),o=i.token){e.next=10;break}return e.next=8,i.cachedTokenPromise;case 8:(s=e.sent)&&ZG(s)&&(o=s);case 10:if(n||!o||!ZG(o)){e.next=12;break}return e.abrupt("return",{token:o.token});case 12:if(c=!1,!BG()){e.next=33;break}if(e.t0=i.exchangeTokenPromise,e.t0){e.next=26;break}return e.t1=IG,e.t2=AG,e.t3=r,e.next=21,UG();case 21:e.t4=e.sent,e.t5=(0,e.t2)(e.t3,e.t4),e.t6=t.platformLoggerProvider,i.exchangeTokenPromise=(0,e.t1)(e.t5,e.t6).then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0;case 26:return e.next=28,i.exchangeTokenPromise;case 28:return l=e.sent,e.next=31,FG(r,l);case 31:return EG(r,Object.assign(Object.assign({},i),{token:l})),e.abrupt("return",{token:l.token});case 33:return e.prev=33,i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0),e.next=37,i.exchangeTokenPromise;case 37:o=e.sent,e.next=43;break;case 40:e.prev=40,e.t7=e.catch(33),"appCheck/throttled"===e.t7.code?LG.warn(e.t7.message):LG.error(e.t7),a=e.t7;case 43:if(!o){e.next=50;break}return u={token:o.token},EG(r,Object.assign(Object.assign({},i),{token:o})),e.next=48,FG(r,o);case 48:e.next=51;break;case 50:u=YG(a);case 51:return c&&jG(r,u),e.abrupt("return",u);case 53:case"end":return e.stop()}},e,null,[[33,40]])}))).apply(this,arguments)}function $G(e,t){var n=bG(e),r=n.tokenObservers.filter(function(e){return e.next!==t});0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),EG(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function WG(e){var t=e.app,n=bG(t),r=n.tokenRefresher;r||(r=function(e){var t=e.app;return new PG(aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!bG(t).token){n.next=6;break}return n.next=3,GG(e,!0);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,GG(e);case 8:n.t0=n.sent;case 9:if(!(r=n.t0).error){n.next=12;break}throw r.error;case 12:case"end":return n.stop()}},n)})),function(){return!0},function(){var e=bG(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,e.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(e),EG(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function jG(e,t){var n,r=ip(bG(e).tokenObservers);try{for(r.s();!(n=r.n()).done;){var i=n.value;try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch(a){}}}catch(o){r.e(o)}finally{r.f()}}function ZG(e){return e.expireTimeMillis-Date.now()>0}function YG(e){return{token:HG(zG),error:e}}var KG=function(){function e(t,n){sp(this,e),this.app=t,this.platformLoggerProvider=n}return cp(e,[{key:"_delete",value:function(){var e,t=ip(bG(this.app).tokenObservers);try{for(t.s();!(e=t.n()).done;){var n=e.value;$G(this.app,n.next)}}catch(r){t.e(r)}finally{t.f()}return Promise.resolve()}}]),e}(),JG="app-check-internal";kU(new eU("app-check",function(e){return function(e,t){return new KG(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("platform-logger"))},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider(JG).initialize()})),kU(new eU(JG,function(e){return function(e){return{getToken:function(t){return GG(e,t)},addTokenListener:function(t){return function(e,t,n,r){var i=e.app,a=bG(i),o={next:n,error:void 0,type:"INTERNAL"};if(EG(i,Object.assign(Object.assign({},a),{tokenObservers:[].concat(np(a.tokenObservers),[o])})),a.token&&ZG(a.token)){var s=a.token;Promise.resolve().then(function(){n({token:s.token}),WG(e)}).catch(function(){})}a.cachedTokenPromise.then(function(){return WG(e)})}(e,0,t)},removeTokenListener:function(t){return $G(e.app,t)}}}(e.getProvider("app-check").getImmediate())},"PUBLIC").setInstantiationMode("EXPLICIT")),PU("@firebase/app-check","0.5.3");var QG=cp(function e(){return sp(this,e),tG("app-check")});"undefined"!=typeof window&&window;var XG=new NB("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),eq=new lU("@firebase/auth");function tq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];eq.logLevel<=aU.ERROR&&eq.error.apply(eq,["Auth (9.6.6): ".concat(e)].concat(n))}function nq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw oq.apply(void 0,[e].concat(n))}function rq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return oq.apply(void 0,[e].concat(n))}function iq(e,t,n){var r=Object.assign(Object.assign({},{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),zv({},t,n));return new NB("auth","Firebase",r).create(t,{appName:e.name})}function aq(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&nq(e,"argument-error"),iq(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.Did you pass a reference from a different Auth SDK?"))}function oq(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!=typeof e){var i,a=n[0],o=np(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(np(o)))}return XG.create.apply(XG,[e].concat(n))}function sq(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e)throw oq.apply(void 0,[t].concat(r))}function uq(e){var t="INTERNAL ASSERTION FAILED: "+e;throw tq(t),new Error(t)}function cq(e,t){e||uq(t)}var lq=new Map;function hq(e){cq(e instanceof Function,"Expected a class definition");var t=lq.get(e);return t?(cq(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,lq.set(e,t),t)}function fq(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function dq(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var vq=function(){function e(t,n){sp(this,e),this.shortDelay=t,this.longDelay=n,cq(n>t,"Short delay should be less than long delay!"),this.isMobile=SB()||OB()}return cp(e,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===dq()||"https:"===dq()||PB()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function pq(e,t){cq(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var gq=function(){function e(){sp(this,e)}return cp(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void uq("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void uq("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void uq("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),yq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},mq=new vq(3e4,6e4);function kq(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function _q(e,t,n,r){return wq.apply(this,arguments)}function wq(){return(wq=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",Cq(t,a,aB(regeneratorRuntime.mark(function e(){var a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),s=qB(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=5,t._getAdditionalHeaders();case 5:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),gq.fetch()(Pq(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},a))));case 7:case"end":return e.stop()}},e)}))));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Cq(e,t,n){return bq.apply(this,arguments)}function bq(){return(bq=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,h,f,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},yq),n),e.prev=2,a=new Oq(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw Tq(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=15;break}return e.abrupt("return",s);case 15:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),l=Hv(c,2),h=l[0],f=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==h){e.next=18;break}throw Tq(t,"credential-already-in-use",s);case 18:if("EMAIL_EXISTS"!==h){e.next=20;break}throw Tq(t,"email-already-in-use",s);case 20:if(d=i[h]||h.toLowerCase().replace(/[_\s]+/g,"-"),!f){e.next=23;break}throw iq(t,d,f);case 23:nq(t,d),e.next=31;break;case 26:if(e.prev=26,e.t0=e.catch(2),!(e.t0 instanceof RB)){e.next=30;break}throw e.t0;case 30:nq(t,"network-request-failed");case 31:case"end":return e.stop()}},e,null,[[2,26]])}))).apply(this,arguments)}function Eq(e,t,n,r){return Sq.apply(this,arguments)}function Sq(){return(Sq=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,_q(t,n,r,i,a);case 3:return o=e.sent,e.abrupt("return",("mfaPendingCredential"in o&&nq(t,"multi-factor-auth-required",{_serverResponse:o}),o));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Pq(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?pq(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var Oq=function(){function e(t){var n=this;sp(this,e),this.auth=t,this.timer=null,this.promise=new Promise(function(e,t){n.timer=setTimeout(function(){return t(rq(n.auth,"network-request-failed"))},mq.get())})}return cp(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function Tq(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=rq(e,t,r);return i.customData._tokenResponse=n,i}function Iq(){return(Iq=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_q(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xq(e,t){return Aq.apply(this,arguments)}function Aq(){return(Aq=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_q(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Rq(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function Nq(){return(Nq=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=XB(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,sq((a=Dq(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"==typeof a.firebase?a.firebase:void 0,s=null==o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:Rq(Mq(a.auth_time)),issuedAtTime:Rq(Mq(a.iat)),expirationTime:Rq(Mq(a.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null});case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Mq(e){return 1e3*Number(e)}function Dq(e){var t=Hv(e.split("."),3),n=t[0],r=t[1],i=t[2];if(void 0===n||void 0===r||void 0===i)return tq("JWT malformed, contained fewer than 3 sections"),null;try{var a=mB(r);return a?JSON.parse(a):(tq("Failed to decode base64 JWT payload"),null)}catch(a){return tq("Caught error parsing JWT payload as JSON",a),null}}function Lq(e,t){return Fq.apply(this,arguments)}function Fq(){return(Fq=aB(regeneratorRuntime.mark(function e(t,n){var r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),e.t1=e.t0 instanceof RB&&Bq(e.t0)&&t.auth.currentUser===t,!e.t1){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}},e,null,[[3,9]])}))).apply(this,arguments)}function Bq(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}var Uq=function(){function e(t){sp(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return cp(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(this.isRunning){var n=this.getInterval(e);this.timerId=setTimeout(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.iteration();case 2:case"end":return e.stop()}},e)})),n)}}},{key:"iteration",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.user.getIdToken(!0);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",void("auth/network-request-failed"===t.t0.code&&e.schedule(!0)));case 8:e.schedule();case 9:case"end":return t.stop()}},t,null,[[0,5]])}))()}}]),e}(),Vq=function(){function e(t,n){sp(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return cp(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=Rq(this.lastLoginAt),this.creationTime=Rq(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function zq(e){return Hq.apply(this,arguments)}function Hq(){return(Hq=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,Lq(t,xq(r,{idToken:i}));case 6:sq(null==(a=e.sent)?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?$q(o.providerUserInfo):[],u=qq(t.providerData,s),c=!!t.isAnonymous&&!(t.email&&o.passwordHash||(null==u?void 0:u.length)),l={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Vq(o.createdAt,o.lastLoginAt),isAnonymous:c},Object.assign(t,l);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Gq(){return(Gq=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=XB(t),e.next=3,zq(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function qq(e,t){return[].concat(np(e.filter(function(e){return!t.some(function(t){return t.providerId===e.providerId})})),np(t))}function $q(e){return e.map(function(e){var t=e.providerId,n=Gp(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function Wq(){return(Wq=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Cq(t,{},aB(regeneratorRuntime.mark(function e(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=qB({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,s=Pq(t,a,"/v1/token","key=".concat(o)),e.next=7,t._getAdditionalHeaders();case 7:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/x-www-form-urlencoded",gq.fetch()(s,{method:"POST",headers:u,body:r})));case 9:case"end":return e.stop()}},e)})));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var jq=function(){function e(){sp(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return cp(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){sq(e.idToken,"internal-error"),sq(void 0!==e.idToken,"internal-error"),sq(void 0!==e.refreshToken,"internal-error");var t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){var t=Dq(e);return sq(t,"internal-error"),sq(void 0!==t.exp,"internal-error"),sq(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sq(!n.accessToken||n.refreshToken,e,"user-token-expired"),!t&&n.accessToken&&!n.isExpired){r.next=12;break}if(!n.refreshToken){r.next=8;break}return r.next=5,n.refresh(e,n.refreshToken);case 5:r.t1=n.accessToken,r.next=9;break;case 8:r.t1=null;case 9:r.t0=r.t1,r.next=13;break;case 12:r.t0=n.accessToken;case 13:return r.abrupt("return",r.t0);case 14:case"end":return r.stop()}},r)}))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e,t){return Wq.apply(this,arguments)}(e,t);case 2:i=r.sent,a=i.accessToken,o=i.refreshToken,s=i.expiresIn,n.updateTokensAndExpiration(a,o,Number(s));case 7:case"end":return r.stop()}},r)}))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return uq("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(sq("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(sq("string"==typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(sq("number"==typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function Zq(e,t){sq("string"==typeof e||void 0===e,"internal-error",{appName:t})}var Yq=function(){function e(t){sp(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=Gp(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Uq(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?np(a.providerData):[],this.metadata=new Vq(a.createdAt||void 0,a.lastLoginAt||void 0)}return cp(e,[{key:"getIdToken",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Lq(t,t.stsTokenManager.getToken(t.auth,e));case 2:if(sq(r=n.sent,t.auth,"internal-error"),n.t0=t.accessToken!==r,!n.t0){n.next=10;break}return t.accessToken=r,n.next=9,t.auth._persistUserIfCurrent(t);case 9:t.auth._notifyListenersIfCurrent(t);case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n)}))()}},{key:"getIdTokenResult",value:function(e){return function(e){return Nq.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return Gq.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(sq(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(function(e){return Object.assign({},e)}),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){sq(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!1,e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),r.t0=t,!r.t0){r.next=6;break}return r.next=6,zq(n);case 6:return r.next=8,n.auth._persistUserIfCurrent(n);case 8:i&&n.auth._notifyListenersIfCurrent(n);case 9:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getIdToken();case 2:return n=t.sent,t.next=5,Lq(e,function(e,t){return Iq.apply(this,arguments)}(e.auth,{idToken:n}));case 5:return e.stsTokenManager.clearRefreshToken(),t.abrupt("return",e.auth.signOut());case 7:case"end":return t.stop()}},t)}))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(e){return Object.assign({},e)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,s,u,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,y=null!==(c=n.createdAt)&&void 0!==c?c:void 0,m=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,_=n.emailVerified,w=n.isAnonymous,C=n.providerData,b=n.stsTokenManager;sq(k&&b,t,"internal-error");var E=jq.fromJSON(this.name,b);sq("string"==typeof k,t,"internal-error"),Zq(h,t.name),Zq(f,t.name),sq("boolean"==typeof _,t,"internal-error"),sq("boolean"==typeof w,t,"internal-error"),Zq(d,t.name),Zq(v,t.name),Zq(p,t.name),Zq(g,t.name),Zq(y,t.name),Zq(m,t.name);var S=new e({uid:k,auth:t,email:f,emailVerified:_,displayName:h,isAnonymous:w,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:y,lastLoginAt:m});return C&&Array.isArray(C)&&(S.providerData=C.map(function(e){return Object.assign({},e)})),g&&(S._redirectEventId=g),S}},{key:"_fromIdTokenResponse",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(a=new jq).updateFromServerResponse(n),o=new e({uid:n.localId,auth:t,stsTokenManager:a,isAnonymous:r}),i.next=5,zq(o);case 5:return i.abrupt("return",o);case 6:case"end":return i.stop()}},i)}))()}}]),e}(),Kq=function(){var e=function(){function e(){sp(this,e),this.type="NONE",this.storage={}}return cp(e,[{key:"_isAvailable",value:function(){return aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}))()}},{key:"_set",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n.storage[e]=t;case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.storage[e],n.abrupt("return",void 0===r?null:r);case 2:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:delete t.storage[e];case 1:case"end":return n.stop()}},n)}))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();return e.type="NONE",e}();function Jq(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var Qq=function(){function e(t,n,r){sp(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=Jq(this.userKey,a.apiKey,o),this.fullPersistenceKey=Jq("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return cp(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.persistence._get(e.fullUserKey);case 2:return n=t.sent,t.abrupt("return",n?Yq._fromJSON(e.auth,n):null);case 4:case"end":return t.stop()}},t)}))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.persistence!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.getCurrentUser();case 4:return r=n.sent,n.next=7,t.removeCurrentUser();case 7:return t.persistence=e,n.abrupt("return",r?t.setCurrentUser(r):void 0);case 9:case"end":return n.stop()}},n)}))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return aB(regeneratorRuntime.mark(function i(){var a,o,s,u,c,l,h,f,d,v;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n.length){i.next=2;break}return i.abrupt("return",new e(hq(Kq),t,r));case 2:return i.next=4,Promise.all(n.map(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:a=i.sent.filter(function(e){return e}),o=a[0]||hq(Kq),s=Jq(r,t.config.apiKey,t.name),u=null,c=ip(n),i.prev=9,c.s();case 11:if((l=c.n()).done){i.next=27;break}return h=l.value,i.prev=13,i.next=16,h._get(s);case 16:if(!(f=i.sent)){i.next=21;break}return d=Yq._fromJSON(t,f),h!==o&&(u=d),o=h,i.abrupt("break",27);case 21:i.next=25;break;case 23:i.prev=23,i.t0=i.catch(13);case 25:i.next=11;break;case 27:i.next=32;break;case 29:i.prev=29,i.t1=i.catch(9),c.e(i.t1);case 32:return i.prev=32,c.f(),i.finish(32);case 35:if(v=a.filter(function(e){return e._shouldAllowMigration}),!o._shouldAllowMigration||!v.length){i.next=47;break}if(o=v[0],i.t3=u,!i.t3){i.next=42;break}return i.next=42,o._set(s,u.toJSON());case 42:return i.next=44,Promise.all(n.map(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()));case 44:i.t2=new e(o,t,r),i.next=48;break;case 47:i.t2=new e(o,t,r);case 48:return i.abrupt("return",i.t2);case 49:case"end":return i.stop()}},i,null,[[9,29,32,35],[13,23]])}))()}}]),e}();function Xq(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(r$(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(e$(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(a$(t))return"Blackberry";if(o$(t))return"Webos";if(t$(t))return"Safari";if((t.includes("chrome/")||n$(t))&&!t.includes("edge/"))return"Chrome";if(i$(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function e$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EB();return/firefox\//i.test(e)}function t$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EB(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function n$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EB();return/crios\//i.test(e)}function r$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EB();return/iemobile/i.test(e)}function i$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EB();return/android/i.test(e)}function a$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EB();return/blackberry/i.test(e)}function o$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EB();return/webos/i.test(e)}function s$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EB();return/iphone|ipad|ipod/i.test(e)}function u$(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EB();return s$(e)||i$(e)||o$(e)||a$(e)||/windows phone/i.test(e)||r$(e)}function c$(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Xq(EB());break;case"Worker":t="".concat(Xq(EB()),"-").concat(e);break;default:t=e}return"".concat(t,"/JsCore/9.6.6/").concat(n.length?n.join(","):"FirebaseCore-web")}var l$=function(){function e(t,n){sp(this,e),this.app=t,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new f$(this),this.idTokenSubscription=new f$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=XG,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=n.sdkClientVersion}return cp(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=hq(t)),this._initializationPromise=this.queue(aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!n._deleted,!r.t0){r.next=6;break}return r.next=4,Qq.create(n,e);case 4:n.persistenceManager=r.sent,r.t0=!n._deleted;case 6:if(!r.t0){r.next=19;break}if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t1=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted&&(n._isInitialized=!0);case 19:case"end":return r.stop()}},r,null,[[8,13]])}))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._deleted){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.assertedPersistence.getCurrentUser();case 4:if(n=t.sent,!e.currentUser&&!n){t.next=13;break}if(!e.currentUser||!n||e.currentUser.uid!==n.uid){t.next=11;break}return e._currentUser._assign(n),t.next=10,e.currentUser.getIdToken();case 10:return t.abrupt("return",void t.sent);case 11:return t.next=13,e._updateCurrentUser(n);case 13:case"end":return t.stop()}},t)}))()}},{key:"initializeCurrentUser",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.getCurrentUser();case 2:if(i=n.sent,!e||!t.config.authDomain){n.next=12;break}return n.next=6,t.getOrInitRedirectPersistenceManager();case 6:return a=null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId,o=null==i?void 0:i._redirectEventId,n.next=10,t.tryRedirectSignIn(e);case 10:s=n.sent,(!a||a===o)&&(null==s?void 0:s.user)&&(i=s.user);case 12:if(!i){n.next=24;break}if(!i._redirectEventId){n.next=20;break}return sq(t._popupRedirectResolver,t,"argument-error"),n.next=17,t.getOrInitRedirectPersistenceManager();case 17:n.t1=t.redirectUser&&t.redirectUser._redirectEventId===i._redirectEventId?t.directlySetCurrentUser(i):t.reloadAndSetCurrentUserOrClear(i),n.next=21;break;case 20:n.t1=t.reloadAndSetCurrentUserOrClear(i);case 21:n.t0=n.t1,n.next=25;break;case 24:n.t0=t.directlySetCurrentUser(null);case 25:return n.abrupt("return",n.t0);case 26:case"end":return n.stop()}},n)}))()}},{key:"tryRedirectSignIn",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,t._popupRedirectResolver._completeRedirectFn(t,e,!0);case 4:r=n.sent,n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(1),n.next=11,t._setRedirectUser(null);case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}},n,null,[[1,7]])}))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,zq(e);case 3:n.next=9;break;case 5:if(n.prev=5,n.t0=n.catch(0),"auth/network-request-failed"===n.t0.code){n.next=9;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 9:return n.abrupt("return",t.directlySetCurrentUser(e));case 10:case"end":return n.stop()}},n,null,[[0,5]])}))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e._deleted=!0;case 1:case"end":return t.stop()}},t)}))()}},{key:"updateCurrentUser",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e?XB(e):null,n.abrupt("return",(r&&sq(r.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(r&&r._clone(t))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_updateCurrentUser",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t._deleted){n.next=2;break}return n.abrupt("return",(e&&sq(t.tenantId===e.tenantId,t,"tenant-id-mismatch"),t.queue(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.directlySetCurrentUser(e);case 2:t.notifyAuthListeners();case 3:case"end":return n.stop()}},n)})))));case 2:case"end":return n.stop()}},n)}))()}},{key:"signOut",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.redirectPersistenceManager||e._popupRedirectResolver,!t.t0){t.next=4;break}return t.next=4,e._setRedirectUser(null);case 4:return t.abrupt("return",e._updateCurrentUser(null));case 5:case"end":return t.stop()}},t)}))()}},{key:"setPersistence",value:function(e){var t=this;return this.queue(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(hq(e));case 2:case"end":return n.stop()}},n)})))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new NB("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getOrInitRedirectPersistenceManager(t);case 2:return i=r.sent,r.abrupt("return",null===e?i.removeCurrentUser():i.setCurrentUser(e));case 4:case"end":return r.stop()}},r)}))()}},{key:"getOrInitRedirectPersistenceManager",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.redirectPersistenceManager){n.next=9;break}return sq(r=e&&hq(e)||t._popupRedirectResolver,t,"argument-error"),n.next=5,Qq.create(t,[hq(r._redirectPersistence)],"redirectUser");case 5:return t.redirectPersistenceManager=n.sent,n.next=8,t.redirectPersistenceManager.getCurrentUser();case 8:t.redirectUser=n.sent;case 9:return n.abrupt("return",t.redirectPersistenceManager);case 10:case"end":return n.stop()}},n)}))()}},{key:"_redirectUserForId",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t._isInitialized,!n.t0){n.next=4;break}return n.next=4,t.queue(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})));case 4:return n.abrupt("return",(null===(r=t._currentUser)||void 0===r?void 0:r._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null);case 5:case"end":return n.stop()}},n)}))()}},{key:"_persistUserIfCurrent",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.currentUser){n.next=2;break}return n.abrupt("return",t.queue(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.directlySetCurrentUser(e));case 1:case"end":return n.stop()}},n)}))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return sq(o,this,"internal-error"),o.then(function(){return a(i.currentUser)}),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,!e){n.next=7;break}return n.next=5,t.assertedPersistence.setCurrentUser(e);case 5:n.next=9;break;case 7:return n.next=9,t.assertedPersistence.removeCurrentUser();case 9:case"end":return n.stop()}},n)}))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return sq(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=c$(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={"X-Client-Version":e.clientVersion},t.abrupt("return",(e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId),n));case 2:case"end":return t.stop()}},t)}))()}}]),e}();function h$(e){return XB(e)}var f$=function(){function e(t){var n,r=this;sp(this,e),this.auth=t,this.observer=null,this.addObserver=(n=new ZB(function(e){return r.observer=e},void 0)).subscribe.bind(n)}return cp(e,[{key:"next",get:function(){return sq(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function d$(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function v$(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var p$=function(){function e(t,n){sp(this,e),this.providerId=t,this.signInMethod=n}return cp(e,[{key:"toJSON",value:function(){return uq("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return uq("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return uq("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return uq("not implemented")}}]),e}();function g$(){return(g$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_q(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y$(){return(y$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Eq(t,"POST","/v1/accounts:signInWithPassword",kq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m$(e,t){return k$.apply(this,arguments)}function k$(){return(k$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_q(t,"POST","/v1/accounts:sendOobCode",kq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _$(e,t){return w$.apply(this,arguments)}function w$(){return(w$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m$(t,n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function C$(e,t){return b$.apply(this,arguments)}function b$(){return(b$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m$(t,n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function E$(){return(E$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Eq(t,"POST","/v1/accounts:signInWithEmailLink",kq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function S$(){return(S$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Eq(t,"POST","/v1/accounts:signInWithEmailLink",kq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var P$=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return sp(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return cp(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.signInMethod,n.next="password"===n.t0?3:"emailLink"===n.t0?4:5;break;case 3:return n.abrupt("return",function(e,t){return y$.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password}));case 4:return n.abrupt("return",function(e,t){return E$.apply(this,arguments)}(e,{email:t._email,oobCode:t._password}));case 5:nq(e,"internal-error");case 6:case"end":return n.stop()}},n)}))()}},{key:"_linkToIdToken",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.signInMethod,r.next="password"===r.t0?3:"emailLink"===r.t0?4:5;break;case 3:return r.abrupt("return",function(e,t){return g$.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password}));case 4:return r.abrupt("return",function(e,t){return S$.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password}));case 5:nq(e,"internal-error");case 6:case"end":return r.stop()}},r)}))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(p$);function O$(e,t){return T$.apply(this,arguments)}function T$(){return(T$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Eq(t,"POST","/v1/accounts:signInWithIdp",kq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var I$=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return cp(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return O$(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,O$(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,O$(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=qB(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):nq("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=Gp(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(p$),x$=function(){function e(t){var n,r,i,a,o,s;sp(this,e);var u=$B(WB(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=u.mode)&&void 0!==i?i:null);sq(c&&l&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=l,this.continueUrl=null!==(a=u.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return cp(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=$B(WB(e)).link,n=t?$B(WB(t)).deep_link_id:null,r=$B(WB(e)).deep_link_id;return(r?$B(WB(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}(),A$=function(){var e=function(){function e(){sp(this,e),this.providerId=e.PROVIDER_ID}return cp(e,null,[{key:"credential",value:function(e,t){return P$._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=x$.parseLink(t);return sq(n,"argument-error"),P$._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e}(),R$=function(){function e(t){sp(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return cp(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),N$=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).scopes=[],e}return cp(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return np(this.scopes)}}]),n}(R$),M$=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return cp(n,null,[{key:"credential",value:function(e,t){return I$._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(N$);return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}();function D$(e,t){return L$.apply(this,arguments)}function L$(){return(L$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Eq(t,"POST","/v1/accounts:signUp",kq(t,n)));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var F$=function(){function e(t){sp(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return cp(e,null,[{key:"_fromIdTokenResponse",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return aB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Yq._fromIdTokenResponse(t,r,i);case 2:return o=a.sent,s=B$(r),a.abrupt("return",new e({user:o,providerId:s,_tokenResponse:r,operationType:n}));case 5:case"end":return a.stop()}},a)}))()}},{key:"_forOperation",value:function(t,n,r){return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t._updateTokensIfNecessary(r,!0);case 2:return a=B$(r),i.abrupt("return",new e({user:t,providerId:a,_tokenResponse:r,operationType:n}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function B$(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var U$=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o,s;return sp(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(Xv(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return cp(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(RB);function V$(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(function(n){throw"auth/multi-factor-auth-required"===n.code?U$._fromErrorAndOperation(e,n,t,r):n})}function z$(e,t){return H$.apply(this,arguments)}function H$(){return(H$=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=Lq,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",F$._forOperation(t,"link",i));case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function G$(){return(G$=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]&&c[2],i=t.auth,a="reauthenticate",e.prev=2,e.next=5,Lq(t,V$(i,a,n,t),r);case 5:return sq((o=e.sent).idToken,i,"internal-error"),sq(s=Dq(o.idToken),i,"internal-error"),u=s.sub,e.abrupt("return",(sq(t.uid===u,i,"user-mismatch"),F$._forOperation(t,a,o)));case 13:throw e.prev=13,e.t0=e.catch(2),"auth/user-not-found"===(null==e.t0?void 0:e.t0.code)&&nq(i,"user-mismatch"),e.t0;case 16:case"end":return e.stop()}},e,null,[[2,13]])}))).apply(this,arguments)}function q$(e,t){return $$.apply(this,arguments)}function $$(){return($$=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i="signIn",e.next=4,V$(t,i,n);case 4:return a=e.sent,e.next=7,F$._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,e.t0=r,e.t0){e.next=12;break}return e.next=12,t._updateCurrentUser(o.user);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function W$(){return(W$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",q$(h$(t),n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j$(e,t,n){var r;sq((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),sq(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(sq(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(sq(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function Z$(){return(Z$=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=XB(t),a={requestType:"PASSWORD_RESET",email:n},r&&j$(i,a,r),e.next=4,C$(i,a);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Y$(){return(Y$=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=h$(t),e.next=3,D$(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,F$._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function K$(){return(K$=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=XB(t),e.next=3,t.getIdToken();case 3:return e.t0=e.sent,i={requestType:"VERIFY_EMAIL",idToken:e.t0},n&&j$(r.auth,i,n),e.next=8,_$(r.auth,i);case 8:if(a=e.sent,o=a.email,e.t1=o!==t.email,!e.t1){e.next=14;break}return e.next=14,t.reload();case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function J$(e,t){return Q$.apply(this,arguments)}function Q$(){return(Q$=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_q(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function X$(){return(X$=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=XB(t),e.next=6,a.getIdToken();case 6:return e.t0=e.sent,e.t1=r,e.t2=i,e.t3=!0,o={idToken:e.t0,displayName:e.t1,photoUrl:e.t2,returnSecureToken:e.t3},e.next=13,Lq(a,J$(a.auth,o));case 13:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(u=a.providerData.find(function(e){return"password"===e.providerId}))&&(u.displayName=a.displayName,u.photoURL=a.photoURL),e.next=19,a._updateTokensIfNecessary(s);case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}new WeakMap;var eW="__sak",tW=function(){function e(t,n){sp(this,e),this.storageRetriever=t,this.type=n}return cp(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(eW,"1"),this.storage.removeItem(eW),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}(),nW=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.call(this,function(){return window.localStorage},"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=EB();return t$(e)||s$(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=u$(),e._shouldAllowMigration=!0,e}return cp(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);!n&&t.localCache[r]===e||t.notifyListeners(r,e)},o=this.storage.getItem(r);TB()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys(function(e,n,r){t.notifyListeners(e,r)})}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t&&JSON.parse(t))}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(function(){e.forAllChangedKeys(function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)})},1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(e,t){var r=this,i=this;return aB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,jv(tp(n.prototype),"_set",r).call(i,e,t);case 2:i.localCache[e]=JSON.stringify(t);case 3:case"end":return a.stop()}},a)}))()}},{key:"_get",value:function(e){var t=this,r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,jv(tp(n.prototype),"_get",t).call(r,e);case 2:return a=i.sent,i.abrupt("return",(r.localCache[e]=JSON.stringify(a),a));case 4:case"end":return i.stop()}},i)}))()}},{key:"_remove",value:function(e){var t=this,r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,jv(tp(n.prototype),"_remove",t).call(r,e);case 2:delete r.localCache[e];case 3:case"end":return i.stop()}},i)}))()}}]),n}(tW);return e.type="LOCAL",e}(),rW=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.call(this,function(){return window.sessionStorage},"SESSION")}return cp(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(tW);return e.type="SESSION",e}(),iW=function(){var e=function(){function e(t){sp(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return cp(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(r=e).data,a=i.eventId,o=i.eventType,s=i.data,null==(u=t.handlersMap[o])?void 0:u.size){n.next=3;break}return n.abrupt("return");case 3:return r.ports[0].postMessage({status:"ack",eventId:a,eventType:o}),c=Array.from(u).map(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r.origin,s));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.next=7,function(e){return Promise.all(e.map((t=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=!0,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",{fulfilled:e.t0,value:e.t1});case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t2});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return t.apply(this,arguments)})));var t}(c);case 7:l=n.sent,r.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:l});case 9:case"end":return n.stop()}},n)}))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find(function(e){return e.isListeningto(t)});if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();return e.receivers=[],e}();function aW(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}var oW=function(){function e(t){sp(this,e),this.target=t,this.handlers=new Set}return cp(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=this;return aB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a="undefined"!=typeof MessageChannel?new MessageChannel:null){i.next=3;break}throw new Error("connection_unavailable");case 3:return i.abrupt("return",new Promise(function(i,u){var c=aW("",20);a.port1.start();var l=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:a,onMessage:function(e){var t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),o=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),i(t.data.response);break;default:clearTimeout(l),clearTimeout(o),u(new Error("invalid_response"))}}},r.handlers.add(s),a.port1.addEventListener("message",s.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[a.port2])}).finally(function(){s&&r.removeMessageHandler(s)}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function sW(){return window}function uW(){return void 0!==sW().WorkerGlobalScope&&"function"==typeof sW().importScripts}function cW(){return(cW=aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return e.abrupt("return",e.sent.active);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var lW="firebaseLocalStorageDb",hW="firebaseLocalStorage",fW="fbase_key",dW=function(){function e(t){sp(this,e),this.request=t}return cp(e,[{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.request.addEventListener("success",function(){t(e.request.result)}),e.request.addEventListener("error",function(){n(e.request.error)})})}}]),e}();function vW(e,t){return e.transaction([hW],t?"readwrite":"readonly").objectStore(hW)}function pW(){var e=indexedDB.open(lW,1);return new Promise(function(t,n){e.addEventListener("error",function(){n(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(hW,{keyPath:fW})}catch(r){n(r)}}),e.addEventListener("success",aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.result).objectStoreNames.contains(hW)){n.next=5;break}t(r),n.next=13;break;case 5:return r.close(),n.next=8,function(){var e=indexedDB.deleteDatabase(lW);return new dW(e).toPromise()}();case 8:return n.t0=t,n.next=11,pW();case 11:n.t1=n.sent,(0,n.t0)(n.t1);case 13:case"end":return n.stop()}},n)})))})}function gW(e,t,n){return yW.apply(this,arguments)}function yW(){return(yW=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=vW(t,!0).put((zv(i={},fW,n),zv(i,"value",r),i)),e.abrupt("return",new dW(a).toPromise());case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function mW(){return(mW=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=vW(t,!1).get(n),e.next=3,new dW(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function kW(e,t){var n=vW(e,!0).delete(t);return new dW(n).toPromise()}var _W=function(){var e=function(){function e(){sp(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return cp(e,[{key:"_openDb",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.db,t.t0){t.next=5;break}return t.next=4,pW();case 4:e.db=t.sent;case 5:return t.abrupt("return",e.db);case 6:case"end":return t.stop()}},t)}))()}},{key:"_withRetries",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=0;case 1:return n.prev=1,n.next=4,t._openDb();case 4:return i=n.sent,n.next=7,e(i);case 7:return n.abrupt("return",n.sent);case 10:if(n.prev=10,n.t0=n.catch(1),!(r++>3)){n.next=14;break}throw n.t0;case 14:t.db&&(t.db.close(),t.db=void 0);case 15:n.next=1;break;case 17:case"end":return n.stop()}},n,null,[[1,10]])}))()}},{key:"initializeServiceWorkerMessaging",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",uW()?e.initializeReceiver():e.initializeSender());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeReceiver",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.receiver=iW._getInstance(uW()?self:null),e.receiver._subscribe("keyChanged",function(){var t=aB(regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._poll();case 2:return t.t0=t.sent.includes(r.key),t.abrupt("return",{keyProcessed:t.t0});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeSender",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){return cW.apply(this,arguments)}();case 2:if(e.activeServiceWorker=t.sent,e.activeServiceWorker){t.next=5;break}return t.abrupt("return");case 5:return e.sender=new oW(e.activeServiceWorker),t.next=8,e.sender._send("ping",{},800);case 8:!(i=t.sent)||(null===(n=i[0])||void 0===n?void 0:n.fulfilled)&&(null===(r=i[0])||void 0===r?void 0:r.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0);case 10:case"end":return t.stop()}},t)}))()}},{key:"notifyServiceWorker",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.sender||!t.activeServiceWorker||function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()!==t.activeServiceWorker){n.next=8;break}return n.prev=1,n.next=4,t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])}))()}},{key:"_isAvailable",value:function(){return aB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,pW();case 5:return t=e.sent,e.next=8,gW(t,eW,"1");case 8:return e.next=10,kW(t,eW);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,null,[[0,13]])}))()}},{key:"_withPendingWrite",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pendingWrites++,n.prev=1,n.next=4,e();case 4:return n.prev=4,t.pendingWrites--,n.finish(4);case 7:case"end":return n.stop()}},n,null,[[1,,4,7]])}))()}},{key:"_set",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n._withRetries(function(n){return gW(n,e,t)});case 2:return n.localCache[e]=t,r.abrupt("return",n.notifyServiceWorker(e));case 4:case"end":return r.stop()}},r)}))));case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return function(e,t){return mW.apply(this,arguments)}(t,e)});case 2:return r=n.sent,n.abrupt("return",(t.localCache[e]=r,r));case 4:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._withPendingWrite(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return kW(t,e)});case 2:return delete t.localCache[e],n.abrupt("return",t.notifyServiceWorker(e));case 4:case"end":return n.stop()}},n)}))));case 1:case"end":return n.stop()}},n)}))()}},{key:"_poll",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._withRetries(function(e){var t=vW(e,!1).getAll();return new dW(t).toPromise()});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",[]);case 5:if(0===e.pendingWrites){t.next=7;break}return t.abrupt("return",[]);case 7:r=[],i=new Set,a=ip(n);try{for(a.s();!(o=a.n()).done;)s=o.value,u=s.fbase_key,c=s.value,i.add(u),JSON.stringify(e.localCache[u])!==JSON.stringify(c)&&(e.notifyListeners(u,c),r.push(u))}catch(d){a.e(d)}finally{a.f()}for(l=0,h=Object.keys(e.localCache);l<h.length;l++)f=h[l],e.localCache[f]&&!i.has(f)&&(e.notifyListeners(f,null),r.push(f));return t.abrupt("return",r);case 12:case"end":return t.stop()}},t)}))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}},t)})),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();return e.type="LOCAL",e}();function wW(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}function CW(e,t){return t?hq(t):(sq(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}wW("rcb"),new vq(3e4,6e4);var bW=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,"custom","custom")).params=e,r}return cp(n,[{key:"_getIdTokenResponse",value:function(e){return O$(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return O$(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return O$(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(p$);function EW(e){return q$(e.auth,new bW(e),e.bypassAuthState)}function SW(e){var t=e.auth,n=e.user;return sq(n,t,"internal-error"),function(e,t){return G$.apply(this,arguments)}(n,new bW(e),e.bypassAuthState)}function PW(e){return OW.apply(this,arguments)}function OW(){return(OW=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,r=t.user,e.abrupt("return",(sq(r,n,"internal-error"),z$(r,new bW(t),t.bypassAuthState)));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var TW=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];sp(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return cp(e,[{key:"execute",value:function(){var e,t=this;return new Promise((e=aB(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.pendingPromise={resolve:n,reject:r},e.prev=1,e.next=4,t.resolver._initialize(t.auth);case 4:return t.eventManager=e.sent,e.next=7,t.onExecution();case 7:t.eventManager.registerConsumer(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t.reject(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])})),function(t,n){return e.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.urlResponse,i=e.sessionId,a=e.postBody,o=e.tenantId,s=e.error,u=e.type,!s){n.next=3;break}return n.abrupt("return",void t.reject(s));case 3:return c={auth:t.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:a||void 0,user:t.user,bypassAuthState:t.bypassAuthState},n.prev=4,n.t0=t,n.next=8,t.getIdpTask(u)(c);case 8:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=15;break;case 12:n.prev=12,n.t2=n.catch(4),t.reject(n.t2);case 15:case"end":return n.stop()}},n,null,[[4,12]])}))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return EW;case"linkViaPopup":case"linkViaRedirect":return PW;case"reauthViaPopup":case"reauthViaRedirect":return SW;default:nq(this.auth,"internal-error")}}},{key:"resolve",value:function(e){cq(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){cq(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),IW=new vq(2e3,1e4);function xW(){return(xW=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=h$(t),aq(t,n,R$),a=CW(i,r),e.abrupt("return",new AW(i,"signInViaPopup",n,a).executeNotNull());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var AW=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o){var s;return sp(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=Xv(s),s}return cp(n,[{key:"executeNotNull",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.execute();case 2:return n=t.sent,t.abrupt("return",(sq(n,e.auth,"internal-error"),n));case 4:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return cq(1===e.filter.length,"Popup operations only handle one event"),n=aW(),t.next=4,e.resolver._openPopup(e.auth,e.provider,e.filter[0],n);case 4:e.authWindow=t.sent,e.authWindow.associatedEvent=n,e.resolver._originValidation(e.auth).catch(function(t){e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,function(t){t||e.reject(rq(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation();case 9:case"end":return t.stop()}},t)}))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(rq(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;e.pollId=(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?window.setTimeout(function(){e.pollId=null,e.reject(rq(e.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,IW.get())}()}}]),n}(TW);return e.currentPopupAction=null,e}(),RW=new Map,NW=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return sp(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return cp(n,[{key:"execute",value:function(){var e=this,t=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=RW.get(t.auth._key())){r.next=20;break}return r.prev=2,r.next=5,function(e,t){return MW.apply(this,arguments)}(t.resolver,t.auth);case 5:if(!r.sent){r.next=11;break}return r.next=8,jv(tp(n.prototype),"execute",e).call(t);case 8:r.t0=r.sent,r.next=12;break;case 11:r.t0=null;case 12:a=r.t0,i=function(){return Promise.resolve(a)},r.next=19;break;case 16:r.prev=16,r.t1=r.catch(2),i=function(){return Promise.reject(r.t1)};case 19:RW.set(t.auth._key(),i);case 20:return r.abrupt("return",(t.bypassAuthState||RW.set(t.auth._key(),function(){return Promise.resolve(null)}),i()));case 21:case"end":return r.stop()}},r,null,[[2,16]])}))()}},{key:"onAuthEvent",value:function(e){var t=this,r=function(){return jv(tp(n.prototype),"onAuthEvent",t)},i=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("signInViaRedirect"!==e.type){t.next=2;break}return t.abrupt("return",r().call(i,e));case 2:if("unknown"===e.type){t.next=12;break}if(!e.eventId){t.next=10;break}return t.next=6,i.auth._redirectUserForId(e.eventId);case 6:if(!(n=t.sent)){t.next=9;break}return t.abrupt("return",(i.user=n,r().call(i,e)));case 9:i.resolve(null);case 10:t.next=13;break;case 12:i.resolve(null);case 13:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){return aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()}},{key:"cleanUp",value:function(){}}]),n}(TW);function MW(){return(MW=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=LW(n),i=DW(t),e.next=3,i._isAvailable();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,i._get(r);case 7:return e.t0=e.sent,a="true"===e.t0,e.next=11,i._remove(r);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function DW(e){return hq(e._redirectPersistence)}function LW(e){return Jq("pendingRedirect",e.config.apiKey,e.name)}function FW(e,t){return BW.apply(this,arguments)}function BW(){return(BW=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=h$(t),a=CW(i,n),e.next=5,new NW(i,a,r).execute();case 5:if(o=e.sent,e.t0=o&&!r,!e.t0){e.next=13;break}return delete o.user._redirectEventId,e.next=11,i._persistUserIfCurrent(o.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}var UW=function(){function e(t){sp(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return cp(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach(function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zW(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!zW(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(rq(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(VW(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(VW(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function VW(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(function(e){return e}).join("-")}function zW(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function HW(e){return GW.apply(this,arguments)}function GW(){return(GW=aB(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",_q(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var qW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$W=/^https?/;function WW(){return(WW=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,HW(t);case 4:n=e.sent,r=n.authorizedDomains,i=ip(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!jW(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:nq(t,"unauthorized-domain");case 29:case"end":return e.stop()}},e,null,[[7,22,25,28],[11,16]])}))).apply(this,arguments)}function jW(e){var t=fq(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!$W.test(r))return!1;if(qW.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var ZW=new vq(3e4,6e4);function YW(){var e=sW().___jsl;if(null==e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=np(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var KW=null;function JW(e){return KW=KW||function(e){return new Promise(function(t,n){var r,i,a;function o(){YW(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){YW(),n(rq(e,"network-request-failed"))},timeout:ZW.get()})}if(null===(i=null===(r=sW().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=sW().gapi)||void 0===a?void 0:a.load)){var s=wW("iframefcb");return sW()[s]=function(){gapi.load?o():n(rq(e,"network-request-failed"))},function(e){return new Promise(function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=rq("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}("https://apis.google.com/js/api.js?onload=".concat(s)).catch(function(e){return n(e)})}o()}}).catch(function(e){throw KW=null,e})}(e)}var QW=new vq(5e3,15e3),XW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ej=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function tj(e){var t=e.config;sq(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?pq(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:bU},i=ej.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(qB(r).slice(1))}function nj(){return(nj=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,JW(t);case 2:return n=e.sent,r=sW().gapi,e.abrupt("return",(sq(r,t,"internal-error"),n.open({where:document.body,url:tj(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:XW,dontclear:!0},function(e){return new Promise((n=aB(regeneratorRuntime.mark(function n(r,i){var a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){sW().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=rq(t,"network-request-failed"),o=sW().setTimeout(function(){i(a)},QW.get()),e.ping(s).then(s,function(){i(a)});case 5:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)}));var n})));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var rj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ij=function(){function e(t){sp(this,e),this.window=t,this.associatedEvent=null}return cp(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function aj(e,t,n,r,i,a){sq(e.config.authDomain,e,"auth-domain-config-required"),sq(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:bU,eventId:i};if(t instanceof R$){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",VB(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var s=0,u=Object.entries(a||{});s<u.length;s++){var c=Hv(u[s],2),l=c[0],h=c[1];o[l]=h}}if(t instanceof N$){var f=t.getScopes().filter(function(e){return""!==e});f.length>0&&(o.scopes=f.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,v=0,p=Object.keys(d);v<p.length;v++){var g=p[v];void 0===d[g]&&delete d[g]}return"".concat(function(e){var t=e.config;return t.emulator?pq(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/__/auth/handler")}(e),"?").concat(qB(d).slice(1))}var oj="webStorageSupport",sj=function(){function e(){sp(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rW,this._completeRedirectFn=FW}return cp(e,[{key:"_openPopup",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return cq(null===(o=i.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()"),s=aj(e,t,n,fq(),r),a.abrupt("return",function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},rj),{width:r.toString(),height:i.toString(),top:a,left:o}),c=EB().toLowerCase();n&&(s=n$(c)?"_blank":n),e$(c)&&(t=t||"http://localhost",u.scrollbars="yes");var l=Object.entries(u).reduce(function(e,t){var n=Hv(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")},"");if(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EB();return s$(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new ij(null);var h=window.open(t||"",s,l);sq(h,e,"popup-blocked");try{h.focus()}catch(f){}return new ij(h)}(e,s,aW()));case 3:case"end":return a.stop()}},a)}))()}},{key:"_openRedirect",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i._originValidation(e);case 2:return function(e){sW().location.href=e}(aj(e,t,n,fq(),r)),a.abrupt("return",new Promise(function(){}));case 4:case"end":return a.stop()}},a)}))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(cq(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(function(){delete t.eventManagers[n]}),o}},{key:"initAndGetManager",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,function(e){return nj.apply(this,arguments)}(e);case 2:return r=n.sent,i=new UW(e),n.abrupt("return",(r.register("authEvent",function(t){return sq(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:i.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=r,i));case 5:case"end":return n.stop()}},n)}))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(oj,{type:oj},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[oj];void 0!==i&&t(!!i),nq(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return WW.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return u$()||t$()||s$()}}]),e}(),uj="@firebase/auth",cj=function(){function e(t){sp(this,e),this.auth=t,this.internalListeners=new Map}return cp(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.assertAuthConfigured(),n.next=3,t.auth._initializationPromise;case 3:if(!t.auth.currentUser){n.next=10;break}return n.next=6,t.auth.currentUser.getIdToken(e);case 6:n.t1=n.sent,n.t0={accessToken:n.t1},n.next=11;break;case 10:n.t0=null;case 11:return n.abrupt("return",n.t0);case 12:case"end":return n.stop()}},n)}))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged(function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){sq(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();!function(e){kU(new eU("auth",function(t,n){var r=n.options,i=t.getProvider("app").getImmediate(),a=i.options,o=a.apiKey,s=a.authDomain;return function(t){sq(o&&!o.includes(":"),"invalid-api-key",{appName:t.name}),sq(!(null==s?void 0:s.includes(":")),"argument-error",{appName:t.name});var n={apiKey:o,authDomain:s,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:c$(e)},i=new l$(t,n);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(hq);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(i,r),i}(i)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider("auth-internal").initialize()})),kU(new eU("auth-internal",function(e){var t=h$(e.getProvider("auth").getImmediate());return new cj(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),PU(uj,"0.19.8",void 0),PU(uj,"0.19.8","esm2017")}("Browser");var lj=cp(function e(t){return sp(this,e),t}),hj=cp(function e(){return sp(this,e),tG("auth")}),fj=new fk("angularfire2.auth-instances");function dj(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new lj(r)}}var vj,pj={provide:hj,deps:[[new Vk,fj]]},gj={provide:lj,useFactory:function(e,t){var n=eG("auth",e,t);return n&&new lj(n)},deps:[[new Vk,fj],fG]},yj=function(){var e=cp(function e(){sp(this,e),PU("angularfire",KH.full,"auth")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({providers:[gj,pj]}),e}(),mj=hG(function(e,t,n){var r=h$(e);sq(r._canInitEmulator,r,"emulator-config-failed"),sq(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var i=!!(null==n?void 0:n.disableWarnings),a=d$(t),o=function(e){var t=d$(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){var a=i[1];return{host:a,port:v$(r.substr(a.length+1))}}var o=Hv(r.split(":"),2);return{host:o[0],port:v$(o[1])}}(t),s=o.host,u=o.port;r.config.emulator={url:"".concat(a,"//").concat(s).concat(null===u?"":":".concat(u),"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:u,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()},!0),kj=hG(function(e,t,n){return Y$.apply(this,arguments)},!0),_j=hG(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EU(),t=_U(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){var n=_U(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(HB(n.getOptions(),null!=t?t:{}))return r;nq(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:sj,persistence:[_W,nW,rW]})},!0),wj=hG(function(e,t,n,r){return XB(e).onAuthStateChanged(t,n,r)},!0),Cj=hG(function(e,t){return K$.apply(this,arguments)},!0),bj=hG(function(e,t,n){return Z$.apply(this,arguments)},!0),Ej=hG(function(e,t,n){return function(e,t){return W$.apply(this,arguments)}(XB(e),A$.credential(t,n))},!0),Sj=hG(function(e,t,n){return xW.apply(this,arguments)},!0),Pj=hG(function(e,t){return X$.apply(this,arguments)},!0),Oj="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Tj={},Ij=Ij||{},xj=Oj||self;function Aj(){}function Rj(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Nj(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Mj="closure_uid_"+(1e9*Math.random()>>>0),Dj=0;function Lj(e,t,n){return e.call.apply(e.bind,arguments)}function Fj(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Bj(e,t,n){return(Bj=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Lj:Fj).apply(null,arguments)}function Uj(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Vj(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function zj(){this.s=this.s,this.o=this.o}var Hj={};zj.prototype.s=!1,zj.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,Mj)&&e[Mj]||(e[Mj]=++Dj)}(this);delete Hj[e]}},zj.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Gj=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},qj=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function $j(e){return Array.prototype.concat.apply([],arguments)}function Wj(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function jj(e){return/^[\s\xa0]*$/.test(e)}var Zj,Yj=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Kj(e,t){return-1!=e.indexOf(t)}function Jj(e,t){return e<t?-1:e>t?1:0}e:{var Qj=xj.navigator;if(Qj){var Xj=Qj.userAgent;if(Xj){Zj=Xj;break e}}Zj=""}function eZ(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function tZ(e){var t={};for(var n in e)t[n]=e[n];return t}var nZ="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rZ(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<nZ.length;a++)n=nZ[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function iZ(e){return iZ[" "](e),e}iZ[" "]=Aj;var aZ,oZ=Kj(Zj,"Opera"),sZ=Kj(Zj,"Trident")||Kj(Zj,"MSIE"),uZ=Kj(Zj,"Edge"),cZ=uZ||sZ,lZ=Kj(Zj,"Gecko")&&!(Kj(Zj.toLowerCase(),"webkit")&&!Kj(Zj,"Edge"))&&!(Kj(Zj,"Trident")||Kj(Zj,"MSIE"))&&!Kj(Zj,"Edge"),hZ=Kj(Zj.toLowerCase(),"webkit")&&!Kj(Zj,"Edge");function fZ(){var e=xj.document;return e?e.documentMode:void 0}e:{var dZ="",vZ=function(){var e=Zj;return lZ?/rv:([^\);]+)(\)|;)/.exec(e):uZ?/Edge\/([\d\.]+)/.exec(e):sZ?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):hZ?/WebKit\/(\S+)/.exec(e):oZ?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(vZ&&(dZ=vZ?vZ[1]:""),sZ){var pZ=fZ();if(null!=pZ&&pZ>parseFloat(dZ)){aZ=String(pZ);break e}}aZ=dZ}var gZ={};var yZ=xj.document&&sZ&&(fZ()||parseInt(aZ,10))||void 0,mZ=function(){if(!xj.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{xj.addEventListener("test",Aj,t),xj.removeEventListener("test",Aj,t)}catch(n){}return e}();function kZ(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function _Z(e,t){if(kZ.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(lZ){e:{try{iZ(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:wZ[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&_Z.Z.h.call(this)}}kZ.prototype.h=function(){this.defaultPrevented=!0},Vj(_Z,kZ);var wZ={2:"touch",3:"pen",4:"mouse"};_Z.prototype.h=function(){_Z.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var CZ="closure_listenable_"+(1e6*Math.random()|0),bZ=0;function EZ(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++bZ,this.ca=this.fa=!1}function SZ(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function PZ(e){this.src=e,this.g={},this.h=0}function OZ(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=Gj(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(SZ(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function TZ(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}PZ.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=TZ(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new EZ(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var IZ="closure_lm_"+(1e6*Math.random()|0),xZ={};function AZ(e,t,n,r,i){if(r&&r.once)return NZ(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)AZ(e,t[a],n,r,i);return null}return n=VZ(n),e&&e[CZ]?e.N(t,n,Nj(r)?!!r.capture:!!r,i):RZ(e,t,n,!1,r,i)}function RZ(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=Nj(i)?!!i.capture:!!i,s=BZ(e);if(s||(e[IZ]=s=new PZ(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){var e=FZ;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)mZ||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(LZ(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function NZ(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)NZ(e,t[a],n,r,i);return null}return n=VZ(n),e&&e[CZ]?e.O(t,n,Nj(r)?!!r.capture:!!r,i):RZ(e,t,n,!0,r,i)}function MZ(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)MZ(e,t[a],n,r,i);else r=Nj(r)?!!r.capture:!!r,n=VZ(n),e&&e[CZ]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=TZ(a=e.g[t],n,r,i))&&(SZ(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--))):e&&(e=BZ(e))&&(t=e.g[t.toString()],e=-1,t&&(e=TZ(t,n,r,i)),(n=-1<e?t[e]:null)&&DZ(n))}function DZ(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[CZ])OZ(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(LZ(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=BZ(t))?(OZ(n,e),0==n.h&&(n.src=null,t[IZ]=null)):SZ(e)}}}function LZ(e){return e in xZ?xZ[e]:xZ[e]="on"+e}function FZ(e,t){if(e.ca)e=!0;else{t=new _Z(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&DZ(e),e=n.call(r,t)}return e}function BZ(e){return(e=e[IZ])instanceof PZ?e:null}var UZ="__closure_events_fn_"+(1e9*Math.random()>>>0);function VZ(e){return"function"==typeof e?e:(e[UZ]||(e[UZ]=function(t){return e.handleEvent(t)}),e[UZ])}function zZ(){zj.call(this),this.i=new PZ(this),this.P=this,this.I=null}function HZ(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new kZ(t,e);else if(t instanceof kZ)t.target=t.target||e;else{var i=t;rZ(t=new kZ(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=GZ(o,r,!0,t)&&i}if(i=GZ(o=t.g=e,r,!0,t)&&i,i=GZ(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=GZ(o=t.g=n[a],r,!1,t)&&i}function GZ(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&OZ(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}Vj(zZ,zj),zZ.prototype[CZ]=!0,zZ.prototype.removeEventListener=function(e,t,n,r){MZ(this,e,t,n,r)},zZ.prototype.M=function(){if(zZ.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)SZ(n[r]);delete t.g[e],t.h--}}this.I=null},zZ.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},zZ.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var qZ=xj.JSON.stringify;function $Z(){var e=QZ,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var WZ,jZ=new(function(){function e(t,n){sp(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return cp(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())(function(){return new ZZ},function(e){return e.reset()}),ZZ=function(){function e(){sp(this,e),this.next=this.g=this.h=null}return cp(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function YZ(e){xj.setTimeout(function(){throw e},0)}function KZ(e,t){WZ||function(){var e=xj.Promise.resolve(void 0);WZ=function(){e.then(XZ)}}(),JZ||(WZ(),JZ=!0),QZ.add(e,t)}var JZ=!1,QZ=new(function(){function e(){sp(this,e),this.h=this.g=null}return cp(e,[{key:"add",value:function(e,t){var n=jZ.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}());function XZ(){for(var e;e=$Z();){try{e.h.call(e.g)}catch(n){YZ(n)}var t=jZ;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}JZ=!1}function eY(e,t){zZ.call(this),this.h=e||1,this.g=t||xj,this.j=Bj(this.kb,this),this.l=Date.now()}function tY(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function nY(e,t,n){if("function"==typeof e)n&&(e=Bj(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Bj(e.handleEvent,e)}return 2147483647<Number(t)?-1:xj.setTimeout(e,t||0)}function rY(e){e.g=nY(function(){e.g=null,e.i&&(e.i=!1,rY(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}Vj(eY,zZ),(vj=eY.prototype).da=!1,vj.S=null,vj.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),HZ(this,"tick"),this.da&&(tY(this),this.start()))}},vj.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},vj.M=function(){eY.Z.M.call(this),tY(this),delete this.g};var iY=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return cp(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:rY(this)}},{key:"M",value:function(){jv(tp(n.prototype),"M",this).call(this),this.g&&(xj.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(zj);function aY(e){zj.call(this),this.h=e,this.g={}}Vj(aY,zj);var oY=[];function sY(e,t,n,r){Array.isArray(n)||(n&&(oY[0]=n.toString()),n=oY);for(var i=0;i<n.length;i++){var a=AZ(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function uY(e){eZ(e.g,function(e,t){this.g.hasOwnProperty(t)&&DZ(e)},e),e.g={}}function cY(){this.g=!0}function lY(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return qZ(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}aY.prototype.M=function(){aY.Z.M.call(this),uY(this)},aY.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},cY.prototype.Aa=function(){this.g=!1},cY.prototype.info=function(){};var hY={},fY=null;function dY(){return fY=fY||new zZ}function vY(e){kZ.call(this,hY.Ma,e)}function pY(e){var t=dY();HZ(t,new vY(t,e))}function gY(e,t){kZ.call(this,hY.STAT_EVENT,e),this.stat=t}function yY(e){var t=dY();HZ(t,new gY(t,e))}function mY(e,t){kZ.call(this,hY.Na,e),this.size=t}function kY(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return xj.setTimeout(function(){e()},t)}hY.Ma="serverreachability",Vj(vY,kZ),hY.STAT_EVENT="statevent",Vj(gY,kZ),hY.Na="timingevent",Vj(mY,kZ);var _Y={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},wY={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function CY(){}function bY(){}CY.prototype.h=null;var EY,SY={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function PY(){kZ.call(this,"d")}function OY(){kZ.call(this,"c")}function TY(){}function IY(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new aY(this),this.P=AY,this.W=new eY(e=cZ?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new xY}function xY(){this.i=null,this.g="",this.h=!1}Vj(PY,kZ),Vj(OY,kZ),Vj(TY,CY),TY.prototype.g=function(){return new XMLHttpRequest},TY.prototype.i=function(){return{}},EY=new TY;var AY=45e3,RY={},NY={};function MY(e,t,n){e.K=1,e.v=rK(JY(t)),e.s=n,e.U=!0,DY(e,null)}function DY(e,t){e.F=Date.now(),UY(e),e.A=JY(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),gK(n.h,"t",r),e.C=0,n=e.l.H,e.h=new xY,e.g=gJ(e.l,n?t:null,!e.s),0<e.O&&(e.L=new iY(Bj(e.Ia,e,e.g),e.O)),sY(e.V,e.g,"readystatechange",e.gb),t=e.H?tZ(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),pY(1),function(e,t,n,r,i,a){e.info(function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function LY(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function FY(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=BY(e,n))==NY){4==t&&(e.o=4,yY(14),i=!1),lY(e.j,e.m,null,"[Incomplete Response]");break}if(r==RY){e.o=4,yY(15),lY(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}lY(e.j,e.m,r,null),qY(e,r)}LY(e)&&r!=NY&&r!=RY&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,yY(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),uJ(t),t.L=!0,yY(11))):(lY(e.j,e.m,n,"[Invalid Chunked Response]"),GY(e),HY(e))}function BY(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?NY:(n=Number(t.substring(n,r)),isNaN(n)?RY:(r+=1)+n>t.length?NY:(t=t.substr(r,n),e.C=r+n,t))}function UY(e){e.Y=Date.now()+e.P,VY(e,e.P)}function VY(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=kY(Bj(e.eb,e),t)}function zY(e){e.B&&(xj.clearTimeout(e.B),e.B=null)}function HY(e){0==e.l.G||e.I||hJ(e.l,e)}function GY(e){zY(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,tY(e.W),uY(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function qY(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||CK(n.i,e)))if(n.I=e.N,!e.J&&CK(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=kY(Bj(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;lJ(n),XK(n)}sJ(n),yY(18)}if(1>=wK(n.i)&&n.ka){try{n.ka()}catch(y){}n.ka=void 0}}else dJ(n,11)}else if((e.J||n.g==e)&&lJ(n),!jj(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(Kj(l,"spdy")||Kj(l,"quic")||Kj(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(bK(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,nK(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=pJ(r,r.H?r.la:null,r.W),d.J){EK(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(zY(v),UY(v)),r.g=d}else oJ(r);0<n.l.length&&nJ(n)}else"stop"!=a[0]&&"close"!=a[0]||dJ(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?dJ(n,7):QK(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}pY(4)}catch(m){}}function $Y(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Rj(e)||"string"==typeof e)qj(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(Rj(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(Rj(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function WY(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof WY)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function jY(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];ZY(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)ZY(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function ZY(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(vj=IY.prototype).setTimeout=function(e){this.P=e},vj.gb=function(e){e=e.target;var t=this.L;t&&3==jK(e)?t.l():this.Ia(e)},vj.Ia=function(e){try{if(e==this.g)e:{var t=jK(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||cZ||this.g&&(this.h.h||this.g.ga()||ZK(this.g)))){this.I||4!=t||7==n||pY(8==n||0>=r?3:2),zY(this);var i=this.g.ba();this.N=i;t:if(LY(this)){var a=ZK(this.g);e="";var o=a.length,s=4==jK(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){GY(this),HY(this);var u="";break t}this.h.i=new xj.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!jj(c)){var h=c;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,yY(12),GY(this),HY(this);break e}lY(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,qY(this,i)}this.U?(FY(this,t,u),cZ&&this.i&&3==t&&(sY(this.V,this.W,"tick",this.fb),this.W.start())):(lY(this.j,this.m,u,null),qY(this,u)),4==t&&GY(this),this.i&&!this.I&&(4==t?hJ(this.l,this):(this.i=!1,UY(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,yY(12)):(this.o=0,yY(13)),GY(this),HY(this)}}}catch(f){}},vj.fb=function(){if(this.g){var e=jK(this.g),t=this.g.ga();this.C<t.length&&(zY(this),FY(this,e,t),this.i&&4!=e&&UY(this))}},vj.cancel=function(){this.I=!0,GY(this)},vj.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(pY(3),yY(17)),GY(this),this.o=2,HY(this)):VY(this,this.Y-e)},(vj=WY.prototype).R=function(){jY(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},vj.T=function(){return jY(this),this.g.concat()},vj.get=function(e,t){return ZY(this.h,e)?this.h[e]:t},vj.set=function(e,t){ZY(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},vj.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var YY=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function KY(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof KY){this.g=void 0!==t?t:e.g,QY(this,e.j),this.s=e.s,XY(this,e.i),eK(this,e.m),this.l=e.l,t=e.h;var n=new fK;n.i=t.i,t.g&&(n.g=new WY(t.g),n.h=t.h),tK(this,n),this.o=e.o}else e&&(n=String(e).match(YY))?(this.g=!!t,QY(this,n[1]||"",!0),this.s=iK(n[2]||""),XY(this,n[3]||"",!0),eK(this,n[4]),this.l=iK(n[5]||"",!0),tK(this,n[6]||"",!0),this.o=iK(n[7]||"")):(this.g=!!t,this.h=new fK(null,this.g))}function JY(e){return new KY(e)}function QY(e,t,n){e.j=n?iK(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function XY(e,t,n){e.i=n?iK(t,!0):t}function eK(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function tK(e,t,n){t instanceof fK?(e.h=t,function(e,t){t&&!e.j&&(dK(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(vK(this,t),gK(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=aK(t,lK)),e.h=new fK(t,e.g))}function nK(e,t,n){e.h.set(t,n)}function rK(e){return nK(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function iK(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function aK(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,oK),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function oK(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}KY.prototype.toString=function(){var e=[],t=this.j;t&&e.push(aK(t,sK,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(aK(t,sK,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(aK(n,"/"==n.charAt(0)?cK:uK,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",aK(n,hK)),e.join("")};var sK=/[#\/\?@]/g,uK=/[#\?:]/g,cK=/[#\?]/g,lK=/[#\?@]/g,hK=/#/g;function fK(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function dK(e){e.g||(e.g=new WY,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function vK(e,t){dK(e),t=yK(e,t),ZY(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,ZY((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&jY(e)))}function pK(e,t){return dK(e),t=yK(e,t),ZY(e.g.h,t)}function gK(e,t,n){vK(e,t),0<n.length&&(e.i=null,e.g.set(yK(e,t),Wj(n)),e.h+=n.length)}function yK(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function mK(e){this.l=e||kK,e=xj.PerformanceNavigationTiming?0<(e=xj.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(xj.g&&xj.g.Ea&&xj.g.Ea()&&xj.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(vj=fK.prototype).add=function(e,t){dK(this),this.i=null,e=yK(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},vj.forEach=function(e,t){dK(this),this.g.forEach(function(n,r){qj(n,function(n){e.call(t,n,r,this)},this)},this)},vj.T=function(){dK(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},vj.R=function(e){dK(this);var t=[];if("string"==typeof e)pK(this,e)&&(t=$j(t,this.g.get(yK(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=$j(t,e[n])}return t},vj.set=function(e,t){return dK(this),this.i=null,pK(this,e=yK(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},vj.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},vj.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var kK=10;function _K(e){return!!e.h||!!e.g&&e.g.size>=e.j}function wK(e){return e.h?1:e.g?e.g.size:0}function CK(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function bK(e,t){e.g?e.g.add(t):e.h=t}function EK(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function SK(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=ip(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return Wj(e.i)}function PK(){}function OK(){this.g=new PK}function TK(e,t,n){var r=n||"";try{$Y(e,function(e,n){var i=e;Nj(e)&&(i=qZ(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function IK(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function xK(e){this.l=e.$b||null,this.j=e.ib||!1}function AK(e,t){zZ.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=RK,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}mK.prototype.cancel=function(){if(this.i=SK(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=ip(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},PK.prototype.stringify=function(e){return xj.JSON.stringify(e,void 0)},PK.prototype.parse=function(e){return xj.JSON.parse(e,void 0)},Vj(xK,CY),xK.prototype.g=function(){return new AK(this.l,this.j)},xK.prototype.i=function(e){return function(){return e}}({}),Vj(AK,zZ);var RK=0;function NK(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function MK(e){e.readyState=4,e.l=null,e.j=null,e.A=null,DK(e)}function DK(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(vj=AK.prototype).open=function(e,t){if(this.readyState!=RK)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,DK(this)},vj.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||xj).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},vj.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,MK(this)),this.readyState=RK},vj.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,DK(this)),this.g&&(this.readyState=3,DK(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==xj.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;NK(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},vj.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?MK(this):DK(this),3==this.readyState&&NK(this)}},vj.Ua=function(e){this.g&&(this.response=this.responseText=e,MK(this))},vj.Ta=function(e){this.g&&(this.response=e,MK(this))},vj.ha=function(){this.g&&MK(this)},vj.setRequestHeader=function(e,t){this.v.append(e,t)},vj.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},vj.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(AK.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var LK=xj.JSON.parse;function FK(e){zZ.call(this),this.headers=new WY,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=BK,this.K=this.L=!1}Vj(FK,zZ);var BK="",UK=/^https?$/i,VK=["POST","PUT"];function zK(e){return"content-type"==e.toLowerCase()}function HK(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,GK(e),$K(e)}function GK(e){e.D||(e.D=!0,HZ(e,"complete"),HZ(e,"error"))}function qK(e){if(e.h&&void 0!==Ij&&(!e.C[1]||4!=jK(e)||2!=e.ba()))if(e.v&&4==jK(e))nY(e.Fa,0,e);else if(HZ(e,"readystatechange"),4==jK(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(YY)[1]||null;if(!a&&xj.self&&xj.self.location){var o=xj.self.location.protocol;a=o.substr(0,o.length-1)}i=!UK.test(a?a.toLowerCase():"")}t=i}if(t)HZ(e,"complete"),HZ(e,"success");else{e.m=6;try{var s=2<jK(e)?e.g.statusText:""}catch(u){s=""}e.j=s+" ["+e.ba()+"]",GK(e)}}finally{$K(e)}}}function $K(e,t){if(e.g){WK(e);var n=e.g,r=e.C[0]?Aj:null;e.g=null,e.C=null,t||HZ(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function WK(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(xj.clearTimeout(e.A),e.A=null)}function jK(e){return e.g?e.g.readyState:0}function ZK(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case BK:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function YK(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return eZ(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):nK(e,t,n))}function KK(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function JK(e){this.za=0,this.l=[],this.h=new cY,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=KK("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=KK("baseRetryDelayMs",5e3,e),this.$a=KK("retryDelaySeedMs",1e4,e),this.Ya=KK("forwardChannelMaxRetries",2,e),this.ra=KK("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new mK(e&&e.concurrentRequestLimit),this.Ca=new OK,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function QK(e){if(eJ(e),3==e.G){var t=e.V++,n=JY(e.F);nK(n,"SID",e.J),nK(n,"RID",t),nK(n,"TYPE","terminate"),iJ(e,n),(t=new IY(e,e.h,t,void 0)).K=2,t.v=rK(JY(n)),n=!1,xj.navigator&&xj.navigator.sendBeacon&&(n=xj.navigator.sendBeacon(t.v.toString(),"")),!n&&xj.Image&&((new Image).src=t.v,n=!0),n||(t.g=gJ(t.l,null),t.g.ea(t.v)),t.F=Date.now(),UY(t)}vJ(e)}function XK(e){e.g&&(uJ(e),e.g.cancel(),e.g=null)}function eJ(e){XK(e),e.u&&(xj.clearTimeout(e.u),e.u=null),lJ(e),e.i.cancel(),e.m&&("number"==typeof e.m&&xj.clearTimeout(e.m),e.m=null)}function tJ(e,t){e.l.push(new(function(){return cp(function e(t,n){sp(this,e),this.h=t,this.g=n})}())(e.Za++,t)),3==e.G&&nJ(e)}function nJ(e){_K(e.i)||e.m||(e.m=!0,KZ(e.Ha,e),e.C=0)}function rJ(e,t){var n;n=t?t.m:e.V++;var r=JY(e.F);nK(r,"SID",e.J),nK(r,"RID",n),nK(r,"AID",e.U),iJ(e,r),e.o&&e.s&&YK(r,e.o,e.s),n=new IY(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=aJ(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),bK(e.i,n),MY(n,r,t)}function iJ(e,t){e.j&&$Y({},function(e,n){nK(t,n,e)})}function aJ(e,t,n){n=Math.min(e.l.length,n);var r=e.j?Bj(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{TK(l,o,"req"+c+"_")}catch(h){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function oJ(e){e.g||e.u||(e.Y=1,KZ(e.Ga,e),e.A=0)}function sJ(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=kY(Bj(e.Ga,e),fJ(e,e.A)),e.A++,0))}function uJ(e){null!=e.B&&(xj.clearTimeout(e.B),e.B=null)}function cJ(e){e.g=new IY(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=JY(e.oa);nK(t,"RID","rpc"),nK(t,"SID",e.J),nK(t,"CI",e.N?"0":"1"),nK(t,"AID",e.U),iJ(e,t),nK(t,"TYPE","xmlhttp"),e.o&&e.s&&YK(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=rK(JY(t)),n.s=null,n.U=!0,DY(n,e)}function lJ(e){null!=e.v&&(xj.clearTimeout(e.v),e.v=null)}function hJ(e,t){var n=null;if(e.g==t){lJ(e),uJ(e),e.g=null;var r=2}else{if(!CK(e.i,t))return;n=t.D,EK(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;HZ(r=dY(),new mY(r,n,t,i)),nJ(e)}else oJ(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(wK(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=kY(Bj(e.Ha,e,t),fJ(e,e.C)),e.C++,0)))}(e,t)||2==r&&sJ(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:dJ(e,5);break;case 4:dJ(e,10);break;case 3:dJ(e,6);break;default:dJ(e,2)}}function fJ(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function dJ(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=Bj(e.jb,e);n||(n=new KY("//www.google.com/images/cleardot.gif"),xj.location&&"http"==xj.location.protocol||QY(n,"https"),rK(n)),function(e,t){var n=new cY;if(xj.Image){var r=new Image;r.onload=Uj(IK,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Uj(IK,n,r,"TestLoadImage: error",!1,t),r.onabort=Uj(IK,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Uj(IK,n,r,"TestLoadImage: timeout",!1,t),xj.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else yY(2);e.G=0,e.j&&e.j.va(t),vJ(e),eJ(e)}function vJ(e){e.G=0,e.I=-1,e.j&&((0!=SK(e.i).length||0!=e.l.length)&&(e.i.i.length=0,Wj(e.l),e.l.length=0),e.j.ua())}function pJ(e,t,n){var r=function(e){return e instanceof KY?JY(e):new KY(e,void 0)}(n);if(""!=r.i)t&&XY(r,t+"."+r.i),eK(r,r.m);else{var i=xj.location;r=function(e,t,n,r){var i=new KY(null,void 0);return e&&QY(i,e),t&&XY(i,t),n&&eK(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&eZ(e.aa,function(e,t){nK(r,t,e)}),n=e.sa,(t=e.D)&&n&&nK(r,t,n),nK(r,"VER",e.ma),iJ(e,r),r}function gJ(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new FK(n&&e.Ba&&!e.qa?new xK({ib:!0}):e.qa)).L=e.H,t}function yJ(){}function mJ(){if(sZ&&!(10<=Number(yZ)))throw Error("Environmental error: no available transport.")}function kJ(e,t){zZ.call(this),this.g=new JK(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!jj(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!jj(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new CJ(this)}function _J(e){PY.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function wJ(){OY.call(this),this.status=1}function CJ(e){this.g=e}(vj=FK.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():EY.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:EY),this.g.onreadystatechange=Bj(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void HK(this,a)}e=n||"";var i=new WY(this.headers);r&&$Y(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=zK,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=xj.FormData&&e instanceof xj.FormData,!(0<=Gj(VK,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{WK(this),0<this.B&&((this.K=function(e){return sZ&&function(){return e=gZ,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=Yj(String(aZ)).split("."),n=Yj("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=Jj(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||Jj(0==a[2].length,0==o[2].length)||Jj(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Bj(this.pa,this)):this.A=nY(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){HK(this,a)}},vj.pa=function(){void 0!==Ij&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,HZ(this,"timeout"),this.abort(8))},vj.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,HZ(this,"complete"),HZ(this,"abort"),$K(this))},vj.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),$K(this,!0)),FK.Z.M.call(this)},vj.Fa=function(){this.s||(this.F||this.v||this.l?qK(this):this.cb())},vj.cb=function(){qK(this)},vj.ba=function(){try{return 2<jK(this)?this.g.status:-1}catch(e){return-1}},vj.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},vj.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),LK(t)}},vj.Da=function(){return this.m},vj.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(vj=JK.prototype).ma=8,vj.G=1,vj.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},vj.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new IY(this,this.h,e,void 0),n=this.s;if(this.P&&(n?rZ(n=tZ(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=aJ(this,t,r),nK(i=JY(this.F),"RID",e),nK(i,"CVER",22),this.D&&nK(i,"X-HTTP-Session-Id",this.D),iJ(this,i),this.o&&n&&YK(i,this.o,n),bK(this.i,t),this.Ra&&nK(i,"TYPE","init"),this.ja?(nK(i,"$req",r),nK(i,"SID","null"),t.$=!0,MY(t,i,null)):MY(t,i,r),this.G=2}}else 3==this.G&&(e?rJ(this,e):0==this.l.length||_K(this.i)||rJ(this))},vj.Ga=function(){if(this.u=null,cJ(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=kY(Bj(this.bb,this),e)}},vj.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,yY(10),XK(this),cJ(this))},vj.ab=function(){null!=this.v&&(this.v=null,XK(this),sJ(this),yY(19))},vj.jb=function(e){e?(this.h.info("Successfully pinged google.com"),yY(2)):(this.h.info("Failed to ping google.com"),yY(1))},(vj=yJ.prototype).xa=function(){},vj.wa=function(){},vj.va=function(){},vj.ua=function(){},vj.Oa=function(){},mJ.prototype.g=function(e,t){return new kJ(e,t)},Vj(kJ,zZ),kJ.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),KZ(Bj(e.hb,e,t))),yY(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=pJ(e,null,e.W),nJ(e)},kJ.prototype.close=function(){QK(this.g)},kJ.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,tJ(this.g,t)}else this.v?((t={}).__data__=qZ(e),tJ(this.g,t)):tJ(this.g,e)},kJ.prototype.M=function(){this.g.j=null,delete this.j,QK(this.g),delete this.g,kJ.Z.M.call(this)},Vj(_J,PY),Vj(wJ,OY),Vj(CJ,yJ),CJ.prototype.xa=function(){HZ(this.g,"a")},CJ.prototype.wa=function(e){HZ(this.g,new _J(e))},CJ.prototype.va=function(e){HZ(this.g,new wJ(e))},CJ.prototype.ua=function(){HZ(this.g,"b")},mJ.prototype.createWebChannel=mJ.prototype.g,kJ.prototype.send=kJ.prototype.u,kJ.prototype.open=kJ.prototype.m,kJ.prototype.close=kJ.prototype.close,_Y.NO_ERROR=0,_Y.TIMEOUT=8,_Y.HTTP_ERROR=6,wY.COMPLETE="complete",bY.EventType=SY,SY.OPEN="a",SY.CLOSE="b",SY.ERROR="c",SY.MESSAGE="d",zZ.prototype.listen=zZ.prototype.N,FK.prototype.listenOnce=FK.prototype.O,FK.prototype.getLastError=FK.prototype.La,FK.prototype.getLastErrorCode=FK.prototype.Da,FK.prototype.getStatus=FK.prototype.ba,FK.prototype.getResponseJson=FK.prototype.Qa,FK.prototype.getResponseText=FK.prototype.ga,FK.prototype.send=FK.prototype.ea;var bJ=Tj.createWebChannelTransport=function(){return new mJ},EJ=Tj.getStatEventTarget=function(){return dY()},SJ=Tj.ErrorCode=_Y,PJ=Tj.EventType=wY,OJ=Tj.Event=hY,TJ=Tj.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},IJ=Tj.FetchXmlHttpFactory=xK,xJ=Tj.WebChannel=bY,AJ=Tj.XhrIo=FK,RJ="@firebase/firestore",NJ=function(){function e(t){sp(this,e),this.uid=t}return cp(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();NJ.UNAUTHENTICATED=new NJ(null),NJ.GOOGLE_CREDENTIALS=new NJ("google-credentials-uid"),NJ.FIRST_PARTY=new NJ("first-party-uid"),NJ.MOCK_USER=new NJ("mock-user");var MJ="9.6.5",DJ=new lU("@firebase/firestore");function LJ(){return DJ.logLevel}function FJ(e){if(DJ.logLevel<=aU.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(VJ);DJ.debug.apply(DJ,["Firestore (".concat(MJ,"): ").concat(e)].concat(np(i)))}}function BJ(e){if(DJ.logLevel<=aU.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(VJ);DJ.error.apply(DJ,["Firestore (".concat(MJ,"): ").concat(e)].concat(np(i)))}}function UJ(e){if(DJ.logLevel<=aU.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(VJ);DJ.warn.apply(DJ,["Firestore (".concat(MJ,"): ").concat(e)].concat(np(i)))}}function VJ(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function zJ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(MJ,") INTERNAL ASSERTION FAILED: ")+e;throw BJ(t),new Error(t)}function HJ(e,t){e||zJ()}function GJ(e,t){return e}var qJ={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},$J=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return cp(n)}(RB),WJ=cp(function e(){var t=this;sp(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),jJ=cp(function e(t,n){sp(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),ZJ=function(){function e(){sp(this,e)}return cp(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(NJ.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}(),YJ=function(){function e(t){sp(this,e),this.token=t,this.changeListener=null}return cp(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable(function(){return t(n.token.user)})}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),KJ=function(){function e(t){sp(this,e),this.t=t,this.currentUser=NJ.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return cp(e,[{key:"start",value:function(e,t){var n=this,r=this,i=this.i,a=function(e){return n.i!==i?(i=n.i,t(e)):Promise.resolve()},o=new WJ;this.o=function(){n.i++,n.currentUser=n.u(),o.resolve(),o=new WJ,e.enqueueRetryable(function(){return a(n.currentUser)})};var s=function(){var t=o;e.enqueueRetryable(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(r.currentUser);case 4:case"end":return e.stop()}},e)})))},u=function(e){FJ("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),s()};this.t.onInit(function(e){return u(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(FJ("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new WJ)}},0),s()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(FJ("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(HJ("string"==typeof n.accessToken),new jJ(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return HJ(null===e||"string"==typeof e),new NJ(e)}}]),e}(),JJ=cp(function e(t,n,r){sp(this,e),this.type="FirstParty",this.user=NJ.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}),QJ=function(){function e(t,n,r){sp(this,e),this.h=t,this.l=n,this.m=r}return cp(e,[{key:"getToken",value:function(){return Promise.resolve(new JJ(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(NJ.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),XJ=cp(function e(t){sp(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),eQ=function(){function e(t){sp(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null}return cp(e,[{key:"start",value:function(e,t){var n=this;this.o=function(n){e.enqueueRetryable(function(){return null!=(e=n).error&&FJ("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message)),t(e.token);var e})};var r=function(e){FJ("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit(function(e){return r(e)}),setTimeout(function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):FJ("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(function(e){return e?(HJ("string"==typeof e.token),new XJ(e.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}(),tQ=function(){function e(t,n){var r=this;sp(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.p(e)},this.T=function(e){return n.writeSequenceNumber(e)})}return cp(e,[{key:"p",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.T&&this.T(e),e}}]),e}();function nQ(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}tQ.I=-1;var rQ=function(){function e(){sp(this,e)}return cp(e,null,[{key:"A",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=nQ(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function iQ(e,t){return e<t?-1:e>t?1:0}function aQ(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}var oQ=function(){function e(t,n){if(sp(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new $J(qJ.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new $J(qJ.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new $J(qJ.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new $J(qJ.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return cp(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?iQ(this.nanoseconds,e.nanoseconds):iQ(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),sQ=function(){function e(t){sp(this,e),this.timestamp=t}return cp(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new oQ(0,0))}}]),e}();function uQ(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function cQ(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function lQ(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var hQ=function(){function e(t,n,r){sp(this,e),void 0===n?n=0:n>t.length&&zJ(),void 0===r?r=t.length-n:r>t.length-n&&zJ(),this.segments=t,this.offset=n,this.len=r}return cp(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),fQ=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new $J(qJ.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,np(s.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(hQ),dQ=/^[_a-zA-Z][_a-zA-Z0-9]*$/,vQ=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return dQ.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new $J(qJ.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new $J(qJ.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new $J(qJ.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new $J(qJ.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(hQ),pQ=function(){function e(t){sp(this,e),this.fields=t,t.sort(vQ.comparator)}return cp(e,[{key:"covers",value:function(e){var t,n=ip(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return aQ(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}]),e}(),gQ=function(e){function t(e){sp(this,t),this.binaryString=e}return cp(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return btoa(this.binaryString)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return iQ(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();gQ.EMPTY_BYTE_STRING=new gQ("");var yQ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mQ(e){if(HJ(!!e),"string"==typeof e){var t=0,n=yQ.exec(e);if(HJ(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:kQ(e.seconds),nanos:kQ(e.nanos)}}function kQ(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function _Q(e){return"string"==typeof e?gQ.fromBase64String(e):gQ.fromUint8Array(e)}function wQ(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function CQ(e){var t=e.mapValue.fields.__previous_value__;return wQ(t)?CQ(t):t}function bQ(e){var t=mQ(e.mapValue.fields.__local_write_time__.timestampValue);return new oQ(t.seconds,t.nanos)}function EQ(e){return null==e}function SQ(e){return 0===e&&1/e==-1/0}var PQ=function(){function e(t){sp(this,e),this.path=t}return cp(e,[{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"isEqual",value:function(e){return null!==e&&0===fQ.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(fQ.fromString(t))}},{key:"fromName",value:function(t){return new e(fQ.fromString(t).popFirst(5))}},{key:"comparator",value:function(e,t){return fQ.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new fQ(t.slice()))}}]),e}();function OQ(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?wQ(e)?4:10:zJ()}function TQ(e,t){if(e===t)return!0;var n,r=OQ(e);if(r!==OQ(t))return!1;switch(r){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return bQ(e).isEqual(bQ(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=mQ(e.timestampValue),r=mQ(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,_Q(e.bytesValue).isEqual(_Q(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return kQ(e.geoPointValue.latitude)===kQ(t.geoPointValue.latitude)&&kQ(e.geoPointValue.longitude)===kQ(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return kQ(e.integerValue)===kQ(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=kQ(e.doubleValue),r=kQ(t.doubleValue);return n===r?SQ(n)===SQ(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return aQ(e.arrayValue.values||[],t.arrayValue.values||[],TQ);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(uQ(n)!==uQ(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!TQ(n[i],r[i])))return!1;return!0}(e,t);default:return zJ()}}function IQ(e,t){return void 0!==(e.values||[]).find(function(e){return TQ(e,t)})}function xQ(e,t){if(e===t)return 0;var n,r,i,a,o=OQ(e),s=OQ(t);if(o!==s)return iQ(o,s);switch(o){case 0:return 0;case 1:return iQ(e.booleanValue,t.booleanValue);case 2:return r=t,i=kQ((n=e).integerValue||n.doubleValue),a=kQ(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return AQ(e.timestampValue,t.timestampValue);case 4:return AQ(bQ(e),bQ(t));case 5:return iQ(e.stringValue,t.stringValue);case 6:return function(e,t){var n=_Q(e),r=_Q(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=iQ(n[i],r[i]);if(0!==a)return a}return iQ(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=iQ(kQ(e.latitude),kQ(t.latitude));return 0!==n?n:iQ(kQ(e.longitude),kQ(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=xQ(n[i],r[i]);if(a)return a}return iQ(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=iQ(r[o],a[o]);if(0!==s)return s;var u=xQ(n[r[o]],i[a[o]]);if(0!==u)return u}return iQ(r.length,a.length)}(e.mapValue,t.mapValue);default:throw zJ()}}function AQ(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return iQ(e,t);var n=mQ(e),r=mQ(t),i=iQ(n.seconds,r.seconds);return 0!==i?i:iQ(n.nanos,r.nanos)}function RQ(e){return NQ(e)}function NQ(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(t=e.timestampValue,n=mQ(t),"time(".concat(n.seconds,",").concat(n.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?_Q(e.bytesValue).toBase64():"referenceValue"in e?PQ.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo(".concat((r=e.geoPointValue).latitude,",").concat(r.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=ip(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=NQ(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=ip(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(NQ(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):zJ();var t,n,r}function MQ(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function DQ(e){return!!e&&"integerValue"in e}function LQ(e){return!!e&&"arrayValue"in e}function FQ(e){return!!e&&"nullValue"in e}function BQ(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function UQ(e){return!!e&&"mapValue"in e}function VQ(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return cQ(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=VQ(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=VQ(e.arrayValue.values[r]);return n}return Object.assign({},e)}var zQ=function(){function e(t){sp(this,e),this.value=t}return cp(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!UQ(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=VQ(t)}},{key:"setAll",value:function(e){var t=this,n=vQ.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=VQ(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());UQ(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return TQ(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];UQ(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){cQ(t,function(t,n){return e[t]=n});var r,i=ip(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(VQ(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function HQ(e){var t=[];return cQ(e.fields,function(e,n){var r=new vQ([e]);if(UQ(n)){var i=HQ(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=ip(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)}),new pQ(t)}var GQ=function(){function e(t,n,r,i,a){sp(this,e),this.key=t,this.documentType=n,this.version=r,this.data=i,this.documentState=a}return cp(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=zQ.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=zQ.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,sQ.min(),zQ.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,zQ.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,zQ.empty(),2)}}]),e}(),qQ=cp(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;sp(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.R=null});function $Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new qQ(e,t,n,r,i,a,o)}function WQ(e){var t=GJ(e);if(null===t.R){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return function(e){return e.field.canonicalString()+e.op.toString()+RQ(e.value)}(e)}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return(t=e).field.canonicalString()+t.dir;var t}).join(","),EQ(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=aX(t.startAt)),t.endAt&&(n+="|ub:",n+=aX(t.endAt)),t.R=n}return t.R}function jQ(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!sX(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(a=t.filters[r]).op||!i.field.isEqual(a.field)||!TQ(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!cX(e.startAt,t.startAt)&&cX(e.endAt,t.endAt)}function ZQ(e){return PQ.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var YQ=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return cp(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.v(xQ(t,this.value)):null!==t&&OQ(this.value)===OQ(t)&&this.v(xQ(t,this.value))}},{key:"v",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return zJ()}}},{key:"V",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.P(e,t,r):new KQ(e,t,r):"array-contains"===t?new eX(e,r):"in"===t?new tX(e,r):"not-in"===t?new nX(e,r):"array-contains-any"===t?new rX(e,r):new n(e,t,r)}},{key:"P",value:function(e,t,n){return"in"===t?new JQ(e,n):new QQ(e,n)}}]),n}(function(){return cp(function e(){sp(this,e)})}()),KQ=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r,i)).key=PQ.fromName(i.referenceValue),a}return cp(n,[{key:"matches",value:function(e){var t=PQ.comparator(e.key,this.key);return this.v(t)}}]),n}(YQ),JQ=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e,"in",r)).keys=XQ(0,r),i}return cp(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(YQ),QQ=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e,"not-in",r)).keys=XQ(0,r),i}return cp(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(YQ);function XQ(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return PQ.fromName(e.referenceValue)})}var eX=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,"array-contains",r)}return cp(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return LQ(t)&&IQ(t.arrayValue,this.value)}}]),n}(YQ),tX=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,"in",r)}return cp(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&IQ(this.value.arrayValue,t)}}]),n}(YQ),nX=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,"not-in",r)}return cp(n,[{key:"matches",value:function(e){if(IQ(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!IQ(this.value.arrayValue,t)}}]),n}(YQ),rX=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,"array-contains-any",r)}return cp(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!LQ(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return IQ(t.value.arrayValue,e)})}}]),n}(YQ),iX=cp(function e(t,n){sp(this,e),this.position=t,this.before=n});function aX(e){return"".concat(e.before?"b":"a",":").concat(e.position.map(function(e){return RQ(e)}).join(","))}var oX=cp(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";sp(this,e),this.field=t,this.dir=n});function sX(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function uX(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?PQ.comparator(PQ.fromName(o.referenceValue),n.key):xQ(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function cX(e,t){if(null===e)return null===t;if(null===t||e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!TQ(e.position[n],t.position[n]))return!1;return!0}var lX=cp(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;sp(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.S=null,this.D=null});function hX(e){return new lX(e)}function fX(e){return!EQ(e.limit)&&"F"===e.limitType}function dX(e){return!EQ(e.limit)&&"L"===e.limitType}function vX(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function pX(e){var t,n=ip(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.V())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function gX(e){return null!==e.collectionGroup}function yX(e){var t=GJ(e);if(null===t.S){t.S=[];var n=pX(t),r=vX(t);if(null!==n&&null===r)n.isKeyField()||t.S.push(new oX(n)),t.S.push(new oX(vQ.keyField(),"asc"));else{var i,a=!1,o=ip(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.S.push(s),s.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.S.push(new oX(vQ.keyField(),u))}}}return t.S}function mX(e){var t=GJ(e);if(!t.D)if("F"===t.limitType)t.D=$Q(t.path,t.collectionGroup,yX(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=ip(yX(t));try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(new oX(a.field,"desc"===a.dir?"asc":"desc"))}}catch(u){i.e(u)}finally{i.f()}var o=t.endAt?new iX(t.endAt.position,!t.endAt.before):null,s=t.startAt?new iX(t.startAt.position,!t.startAt.before):null;t.D=$Q(t.path,t.collectionGroup,r,t.filters,t.limit,o,s)}return t.D}function kX(e,t,n){return new lX(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function _X(e,t){return jQ(mX(e),mX(t))&&e.limitType===t.limitType}function wX(e){return"".concat(WQ(mX(e)),"|lt:").concat(e.limitType)}function CX(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(RQ(t.value));var t}).join(", "),"]")),EQ(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t}).join(", "),"]")),e.startAt&&(t+=", startAt: "+aX(e.startAt)),e.endAt&&(t+=", endAt: "+aX(e.endAt)),"Target(".concat(t,")")}(mX(e)),"; limitType=").concat(e.limitType,")")}function bX(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):PQ.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=ip(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=ip(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&(r=t,!((n=e).startAt&&!uX(n.startAt,yX(n),r)||n.endAt&&uX(n.endAt,yX(n),r)));var n,r}function EX(e){return function(t,n){var r,i=!1,a=ip(yX(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=SX(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(u){a.e(u)}finally{a.f()}return 0}}function SX(e,t,n){var r,i,a,o,s=e.field.isKeyField()?PQ.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),o=i.data.field(r),null!==a&&null!==o?xQ(a,o):zJ());switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return zJ()}}function PX(e,t){if(e.C){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:SQ(t)?"-0":t}}function OX(e){return{integerValue:""+e}}var TX=cp(function e(){sp(this,e),this._=void 0});function IX(e,t,n){return e instanceof RX?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof NX?MX(e,t):e instanceof DX?LX(e,t):function(e,t){var n=AX(e,t),r=BX(n)+BX(e.N);return DQ(n)&&DQ(e.N)?OX(r):PX(e.k,r)}(e,t);var r,i,a}function xX(e,t,n){return e instanceof NX?MX(e,t):e instanceof DX?LX(e,t):n}function AX(e,t){return e instanceof FX?DQ(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}var RX=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n)}(TX),NX=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).elements=e,r}return cp(n)}(TX);function MX(e,t){var n,r=UX(t),i=ip(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return TQ(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var DX=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).elements=e,r}return cp(n)}(TX);function LX(e,t){var n,r=UX(t),i=ip(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!TQ(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var FX=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).k=e,i.N=r,i}return cp(n)}(TX);function BX(e){return kQ(e.integerValue||e.doubleValue)}function UX(e){return LQ(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var VX=cp(function e(t,n){sp(this,e),this.field=t,this.transform=n}),zX=cp(function e(t,n){sp(this,e),this.version=t,this.transformResults=n}),HX=function(){function e(t,n){sp(this,e),this.updateTime=t,this.exists=n}return cp(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function GX(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var qX=cp(function e(){sp(this,e)});function $X(e,t,n){var r,i,a,o,s;e instanceof KX?(i=t,a=n,o=(r=e).value.clone(),s=XX(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):e instanceof JX?function(e,t,n){if(GX(e.precondition,t)){var r=XX(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(QX(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function WX(e,t,n){var r;e instanceof KX?function(e,t,n){if(GX(e.precondition,t)){var r=e.value.clone(),i=e1(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(YX(t),r).setHasLocalMutations()}}(e,t,n):e instanceof JX?function(e,t,n){if(GX(e.precondition,t)){var r=e1(e.fieldTransforms,n,t),i=t.data;i.setAll(QX(e)),i.setAll(r),t.convertToFoundDocument(YX(t),i).setHasLocalMutations()}}(e,t,n):GX(e.precondition,r=t)&&r.convertToNoDocument(sQ.min())}function jX(e,t){var n,r=null,i=ip(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=AX(a.transform,o||null);null!=s&&(null==r&&(r=zQ.empty()),r.set(a.field,s))}}catch(u){i.e(u)}finally{i.f()}return r||null}function ZX(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&aQ(n,r,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof NX&&r instanceof NX||n instanceof DX&&r instanceof DX?aQ(n.elements,r.elements,TQ):n instanceof FX&&r instanceof FX?TQ(n.N,r.N):n instanceof RX&&r instanceof RX);var n,r}(e,t)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}function YX(e){return e.isFoundDocument()?e.version:sQ.min()}var KX=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return sp(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return cp(n)}(qX),JX=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return sp(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return cp(n)}(qX);function QX(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function XX(e,t,n){var r=new Map;HJ(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,xX(o,s,n[i]))}return r}function e1(e,t,n){var r,i=new Map,a=ip(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);i.set(o.field,IX(s,u,t))}}catch(c){a.e(c)}finally{a.f()}return i}var t1,n1,r1=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return cp(n)}(qX),i1=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return cp(n)}(qX),a1=cp(function e(t){sp(this,e),this.count=t});function o1(e){switch(e){default:return zJ();case qJ.CANCELLED:case qJ.UNKNOWN:case qJ.DEADLINE_EXCEEDED:case qJ.RESOURCE_EXHAUSTED:case qJ.INTERNAL:case qJ.UNAVAILABLE:case qJ.UNAUTHENTICATED:return!1;case qJ.INVALID_ARGUMENT:case qJ.NOT_FOUND:case qJ.ALREADY_EXISTS:case qJ.PERMISSION_DENIED:case qJ.FAILED_PRECONDITION:case qJ.ABORTED:case qJ.OUT_OF_RANGE:case qJ.UNIMPLEMENTED:case qJ.DATA_LOSS:return!0}}function s1(e){if(void 0===e)return BJ("GRPC error has no .code"),qJ.UNKNOWN;switch(e){case t1.OK:return qJ.OK;case t1.CANCELLED:return qJ.CANCELLED;case t1.UNKNOWN:return qJ.UNKNOWN;case t1.DEADLINE_EXCEEDED:return qJ.DEADLINE_EXCEEDED;case t1.RESOURCE_EXHAUSTED:return qJ.RESOURCE_EXHAUSTED;case t1.INTERNAL:return qJ.INTERNAL;case t1.UNAVAILABLE:return qJ.UNAVAILABLE;case t1.UNAUTHENTICATED:return qJ.UNAUTHENTICATED;case t1.INVALID_ARGUMENT:return qJ.INVALID_ARGUMENT;case t1.NOT_FOUND:return qJ.NOT_FOUND;case t1.ALREADY_EXISTS:return qJ.ALREADY_EXISTS;case t1.PERMISSION_DENIED:return qJ.PERMISSION_DENIED;case t1.FAILED_PRECONDITION:return qJ.FAILED_PRECONDITION;case t1.ABORTED:return qJ.ABORTED;case t1.OUT_OF_RANGE:return qJ.OUT_OF_RANGE;case t1.UNIMPLEMENTED:return qJ.UNIMPLEMENTED;case t1.DATA_LOSS:return qJ.DATA_LOSS;default:return zJ()}}(n1=t1||(t1={}))[n1.OK=0]="OK",n1[n1.CANCELLED=1]="CANCELLED",n1[n1.UNKNOWN=2]="UNKNOWN",n1[n1.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n1[n1.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n1[n1.NOT_FOUND=5]="NOT_FOUND",n1[n1.ALREADY_EXISTS=6]="ALREADY_EXISTS",n1[n1.PERMISSION_DENIED=7]="PERMISSION_DENIED",n1[n1.UNAUTHENTICATED=16]="UNAUTHENTICATED",n1[n1.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n1[n1.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n1[n1.ABORTED=10]="ABORTED",n1[n1.OUT_OF_RANGE=11]="OUT_OF_RANGE",n1[n1.UNIMPLEMENTED=12]="UNIMPLEMENTED",n1[n1.INTERNAL=13]="INTERNAL",n1[n1.UNAVAILABLE=14]="UNAVAILABLE",n1[n1.DATA_LOSS=15]="DATA_LOSS";var u1=function(){function e(t,n){sp(this,e),this.comparator=t,this.root=n||l1.EMPTY}return cp(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,l1.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,l1.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new c1(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new c1(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new c1(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new c1(this.root,e,this.comparator,!0)}}]),e}(),c1=function(){function e(t,n,r,i){sp(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return cp(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),l1=function(){function e(t,n,r,i,a){sp(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return cp(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw zJ();var e=this.left.check();if(e!==this.right.check())throw zJ();return e+(this.isRed()?0:1)}}]),e}();l1.EMPTY=null,l1.RED=!0,l1.BLACK=!1,l1.EMPTY=new(function(){function e(){sp(this,e),this.size=0}return cp(e,[{key:"key",get:function(){throw zJ()}},{key:"value",get:function(){throw zJ()}},{key:"color",get:function(){throw zJ()}},{key:"left",get:function(){throw zJ()}},{key:"right",get:function(){throw zJ()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new l1(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var h1=function(){function e(t){sp(this,e),this.comparator=t,this.data=new u1(this.comparator)}return cp(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new f1(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new f1(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),f1=function(){function e(t){sp(this,e),this.iter=t}return cp(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}(),d1=new u1(PQ.comparator);function v1(){return d1}var p1=new u1(PQ.comparator);function g1(){return p1}var y1=new u1(PQ.comparator),m1=new h1(PQ.comparator);function k1(){for(var e=m1,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var _1=new h1(iQ);function w1(){return _1}var C1=function(){function e(t,n,r,i,a){sp(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return cp(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,b1.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(sQ.min(),r,w1(),v1(),k1())}}]),e}(),b1=function(){function e(t,n,r,i,a){sp(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return cp(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(gQ.EMPTY_BYTE_STRING,n,k1(),k1(),k1())}}]),e}(),E1=cp(function e(t,n,r,i){sp(this,e),this.$=t,this.removedTargetIds=n,this.key=r,this.O=i}),S1=cp(function e(t,n){sp(this,e),this.targetId=t,this.M=n}),P1=cp(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gQ.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;sp(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),O1=function(){function e(){sp(this,e),this.F=0,this.L=x1(),this.B=gQ.EMPTY_BYTE_STRING,this.U=!1,this.q=!0}return cp(e,[{key:"current",get:function(){return this.U}},{key:"resumeToken",get:function(){return this.B}},{key:"K",get:function(){return 0!==this.F}},{key:"j",get:function(){return this.q}},{key:"W",value:function(e){e.approximateByteSize()>0&&(this.q=!0,this.B=e)}},{key:"G",value:function(){var e=k1(),t=k1(),n=k1();return this.L.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:zJ()}}),new b1(this.B,this.U,e,t,n)}},{key:"H",value:function(){this.q=!1,this.L=x1()}},{key:"J",value:function(e,t){this.q=!0,this.L=this.L.insert(e,t)}},{key:"Y",value:function(e){this.q=!0,this.L=this.L.remove(e)}},{key:"X",value:function(){this.F+=1}},{key:"Z",value:function(){this.F-=1}},{key:"tt",value:function(){this.q=!0,this.U=!0}}]),e}(),T1=function(){function e(t){sp(this,e),this.et=t,this.nt=new Map,this.st=v1(),this.it=I1(),this.rt=new h1(iQ)}return cp(e,[{key:"ot",value:function(e){var t,n=ip(e.$);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.O&&e.O.isFoundDocument()?this.ct(r,e.O):this.at(r,e.key,e.O)}}catch(s){n.e(s)}finally{n.f()}var i,a=ip(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.at(o,e.key,e.O)}}catch(s){a.e(s)}finally{a.f()}}},{key:"ut",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.ht(n);switch(e.state){case 0:t.lt(n)&&r.W(e.resumeToken);break;case 1:r.Z(),r.K||r.H(),r.W(e.resumeToken);break;case 2:r.Z(),r.K||t.removeTarget(n);break;case 3:t.lt(n)&&(r.tt(),r.W(e.resumeToken));break;case 4:t.lt(n)&&(t.ft(n),r.W(e.resumeToken));break;default:zJ()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.nt.forEach(function(e,r){n.lt(r)&&t(r)})}},{key:"dt",value:function(e){var t=e.targetId,n=e.M.count,r=this.wt(t);if(r){var i=r.target;if(ZQ(i))if(0===n){var a=new PQ(i.path);this.at(t,a,GQ.newNoDocument(a,sQ.min()))}else HJ(1===n);else this._t(t)!==n&&(this.ft(t),this.rt=this.rt.add(t))}}},{key:"gt",value:function(e){var t=this,n=new Map;this.nt.forEach(function(r,i){var a=t.wt(i);if(a){if(r.current&&ZQ(a.target)){var o=new PQ(a.target.path);null!==t.st.get(o)||t.yt(i,o)||t.at(i,o,GQ.newNoDocument(o,e))}r.j&&(n.set(i,r.G()),r.H())}});var r=k1();this.it.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.wt(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))});var i=new C1(e,n,this.rt,this.st,r);return this.st=v1(),this.it=I1(),this.rt=new h1(iQ),i}},{key:"ct",value:function(e,t){if(this.lt(e)){var n=this.yt(e,t.key)?2:0;this.ht(e).J(t.key,n),this.st=this.st.insert(t.key,t),this.it=this.it.insert(t.key,this.Tt(t.key).add(e))}}},{key:"at",value:function(e,t,n){if(this.lt(e)){var r=this.ht(e);this.yt(e,t)?r.J(t,1):r.Y(t),this.it=this.it.insert(t,this.Tt(t).delete(e)),n&&(this.st=this.st.insert(t,n))}}},{key:"removeTarget",value:function(e){this.nt.delete(e)}},{key:"_t",value:function(e){var t=this.ht(e).G();return this.et.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"X",value:function(e){this.ht(e).X()}},{key:"ht",value:function(e){var t=this.nt.get(e);return t||(t=new O1,this.nt.set(e,t)),t}},{key:"Tt",value:function(e){var t=this.it.get(e);return t||(t=new h1(iQ),this.it=this.it.insert(e,t)),t}},{key:"lt",value:function(e){var t=null!==this.wt(e);return t||FJ("WatchChangeAggregator","Detected inactive target",e),t}},{key:"wt",value:function(e){var t=this.nt.get(e);return t&&t.K?null:this.et.Et(e)}},{key:"ft",value:function(e){var t=this;this.nt.set(e,new O1),this.et.getRemoteKeysForTarget(e).forEach(function(n){t.at(e,n,null)})}},{key:"yt",value:function(e,t){return this.et.getRemoteKeysForTarget(e).has(t)}}]),e}();function I1(){return new u1(PQ.comparator)}function x1(){return new u1(PQ.comparator)}var A1={asc:"ASCENDING",desc:"DESCENDING"},R1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},N1=cp(function e(t,n){sp(this,e),this.databaseId=t,this.C=n});function M1(e,t){return e.C?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function D1(e,t){return e.C?t.toBase64():t.toUint8Array()}function L1(e,t){return M1(e,t.toTimestamp())}function F1(e){return HJ(!!e),sQ.fromTimestamp((t=mQ(e),new oQ(t.seconds,t.nanos)));var t}function B1(e,t){return(n=e,new fQ(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function U1(e){var t=fQ.fromString(e);return HJ(a0(t)),t}function V1(e,t){return B1(e.databaseId,t.path)}function z1(e,t){var n=U1(t);if(n.get(1)!==e.databaseId.projectId)throw new $J(qJ.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new $J(qJ.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new PQ(q1(n))}function H1(e,t){return B1(e.databaseId,t)}function G1(e){return new fQ(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function q1(e){return HJ(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function $1(e,t,n){return{name:V1(e,t),fields:n.value.mapValue.fields}}function W1(e,t){return{documents:[H1(e,t.path)]}}function j1(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=H1(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=H1(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(BQ(e.value))return{unaryFilter:{field:e0(e.field),op:"IS_NAN"}};if(FQ(e.value))return{unaryFilter:{field:e0(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(BQ(e.value))return{unaryFilter:{field:e0(e.field),op:"IS_NOT_NAN"}};if(FQ(e.value))return{unaryFilter:{field:e0(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:e0(e.field),op:X1(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return{field:e0((t=e).field),direction:Q1(t.dir)};var t})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s=(o=t.limit,e.C||EQ(o)?o:{value:o});return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=K1(t.startAt)),t.endAt&&(n.structuredQuery.endAt=K1(t.endAt)),n}function Z1(e){var t=function(e){var t=U1(e);return 4===t.length?fQ.emptyPath():q1(t)}(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){HJ(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=Y1(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(e){return new oX(t0((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));var u=null;n.limit&&(u=function(e){var t;return EQ(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=J1(n.startAt));var l=null;return n.endAt&&(l=J1(n.endAt)),function(e,t,n,r,i,a,o,s){return new lX(e,t,n,r,i,"F",o,s)}(t,i,s,o,u,0,c,l)}function Y1(e){return e?void 0!==e.unaryFilter?[r0(e)]:void 0!==e.fieldFilter?[n0(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return Y1(e)}).reduce(function(e,t){return e.concat(t)}):zJ():[]}function K1(e){return{before:e.before,values:e.position}}function J1(e){return new iX(e.values||[],!!e.before)}function Q1(e){return A1[e]}function X1(e){return R1[e]}function e0(e){return{fieldPath:e.canonicalString()}}function t0(e){return vQ.fromServerFormat(e.fieldPath)}function n0(e){return YQ.create(t0(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return zJ()}}(e.fieldFilter.op),e.fieldFilter.value)}function r0(e){switch(e.unaryFilter.op){case"IS_NAN":var t=t0(e.unaryFilter.field);return YQ.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=t0(e.unaryFilter.field);return YQ.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=t0(e.unaryFilter.field);return YQ.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=t0(e.unaryFilter.field);return YQ.create(i,"!=",{nullValue:"NULL_VALUE"});default:return zJ()}}function i0(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function a0(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function o0(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=u0(t)),t=s0(e.get(n),t);return u0(t)}function s0(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=a}}return n}function u0(e){return e+"\x01\x01"}var c0=cp(function e(t,n,r){sp(this,e),this.ownerId=t,this.allowTabSynchronization=n,this.leaseTimestampMs=r});c0.store="owner",c0.key="owner";var l0=cp(function e(t,n,r){sp(this,e),this.userId=t,this.lastAcknowledgedBatchId=n,this.lastStreamToken=r});l0.store="mutationQueues",l0.keyPath="userId";var h0=cp(function e(t,n,r,i,a){sp(this,e),this.userId=t,this.batchId=n,this.localWriteTimeMs=r,this.baseMutations=i,this.mutations=a});h0.store="mutations",h0.keyPath="batchId",h0.userMutationsIndex="userMutationsIndex",h0.userMutationsKeyPath=["userId","batchId"];var f0=function(){function e(){sp(this,e)}return cp(e,null,[{key:"prefixForUser",value:function(e){return[e]}},{key:"prefixForPath",value:function(e,t){return[e,o0(t)]}},{key:"key",value:function(e,t,n){return[e,o0(t),n]}}]),e}();f0.store="documentMutations",f0.PLACEHOLDER=new f0;var d0=cp(function e(t,n,r,i,a,o){sp(this,e),this.unknownDocument=t,this.noDocument=n,this.document=r,this.hasCommittedMutations=i,this.readTime=a,this.parentPath=o});d0.store="remoteDocuments",d0.readTimeIndex="readTimeIndex",d0.readTimeIndexPath="readTime",d0.collectionReadTimeIndex="collectionReadTimeIndex",d0.collectionReadTimeIndexPath=["parentPath","readTime"];var v0=cp(function e(t){sp(this,e),this.byteSize=t});v0.store="remoteDocumentGlobal",v0.key="remoteDocumentGlobalKey";var p0=cp(function e(t,n,r,i,a,o,s){sp(this,e),this.targetId=t,this.canonicalId=n,this.readTime=r,this.resumeToken=i,this.lastListenSequenceNumber=a,this.lastLimboFreeSnapshotVersion=o,this.query=s});p0.store="targets",p0.keyPath="targetId",p0.queryTargetsIndexName="queryTargetsIndex",p0.queryTargetsKeyPath=["canonicalId","targetId"];var g0=cp(function e(t,n,r){sp(this,e),this.targetId=t,this.path=n,this.sequenceNumber=r});g0.store="targetDocuments",g0.keyPath=["targetId","path"],g0.documentTargetsIndex="documentTargetsIndex",g0.documentTargetsKeyPath=["path","targetId"];var y0=cp(function e(t,n,r,i){sp(this,e),this.highestTargetId=t,this.highestListenSequenceNumber=n,this.lastRemoteSnapshotVersion=r,this.targetCount=i});y0.key="targetGlobalKey",y0.store="targetGlobal";var m0=cp(function e(t,n){sp(this,e),this.collectionId=t,this.parent=n});m0.store="collectionParents",m0.keyPath=["collectionId","parent"];var k0=cp(function e(t,n,r,i){sp(this,e),this.clientId=t,this.updateTimeMs=n,this.networkEnabled=r,this.inForeground=i});k0.store="clientMetadata",k0.keyPath="clientId";var _0=cp(function e(t,n,r){sp(this,e),this.bundleId=t,this.createTime=n,this.version=r});_0.store="bundles",_0.keyPath="bundleId";var w0=cp(function e(t,n,r){sp(this,e),this.name=t,this.readTime=n,this.bundledQuery=r});w0.store="namedQueries",w0.keyPath="name";var C0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",b0=function(){function e(t){var n=this;sp(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return cp(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&zJ(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(n){return e.reject(n)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=ip(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}}]),e}();function E0(e){return"IndexedDbTransactionError"===e.name}var S0=function(){function e(t,n,r,i){sp(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return cp(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&$X(i,e,n[r])}}},{key:"applyToLocalView",value:function(e){var t,n=ip(this.baseMutations);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.key.isEqual(e.key)&&WX(r,e,this.localWriteTime)}}catch(s){n.e(s)}finally{n.f()}var i,a=ip(this.mutations);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.key.isEqual(e.key)&&WX(o,e,this.localWriteTime)}}catch(s){a.e(s)}finally{a.f()}}},{key:"applyToLocalDocumentSet",value:function(e){var t=this;this.mutations.forEach(function(n){var r=e.get(n.key),i=r;t.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(sQ.min())})}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},k1())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&aQ(this.mutations,e.mutations,function(e,t){return ZX(e,t)})&&aQ(this.baseMutations,e.baseMutations,function(e,t){return ZX(e,t)})}}]),e}(),P0=function(){function e(t,n,r,i){sp(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return cp(e,null,[{key:"from",value:function(t,n,r){HJ(t.mutations.length===r.length);for(var i=y1,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),O0=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:sQ.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:sQ.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:gQ.EMPTY_BYTE_STRING;sp(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return cp(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),T0=cp(function e(t){sp(this,e),this.Gt=t});function I0(e){var t=Z1({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?kX(t,t.limit,"L"):t}var x0=function(){function e(){sp(this,e),this.zt=new A0}return cp(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.zt.add(t),b0.resolve()}},{key:"getCollectionParents",value:function(e,t){return b0.resolve(this.zt.getEntries(t))}}]),e}(),A0=function(){function e(){sp(this,e),this.index={}}return cp(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new h1(fQ.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new h1(fQ.comparator)).toArray()}}]),e}(),R0=function(){function e(t,n,r){sp(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return cp(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();R0.DEFAULT_COLLECTION_PERCENTILE=10,R0.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,R0.DEFAULT=new R0(41943040,R0.DEFAULT_COLLECTION_PERCENTILE,R0.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),R0.DISABLED=new R0(-1,0,0);var N0=function(){function e(t){sp(this,e),this.se=t}return cp(e,[{key:"next",value:function(){return this.se+=2,this.se}}],[{key:"ie",value:function(){return new e(0)}},{key:"re",value:function(){return new e(-1)}}]),e}();function M0(e){return D0.apply(this,arguments)}function D0(){return(D0=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===qJ.FAILED_PRECONDITION&&t.message===C0){e.next=2;break}throw t;case 2:FJ("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}var L0=function(){function e(t,n){sp(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={}}return cp(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=ip(n);try{for(i.s();!(r=i.n()).done;){var a=Hv(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(u){i.e(u)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1}},{key:"forEach",value:function(e){cQ(this.inner,function(t,n){var r,i=ip(n);try{for(i.s();!(r=i.n()).done;){var a=Hv(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(u){i.e(u)}finally{i.f()}})}},{key:"isEmpty",value:function(){return lQ(this.inner)}}]),e}(),F0=function(){function e(t,n,r){sp(this,e),this.Je=t,this.An=n,this.Jt=r}return cp(e,[{key:"Rn",value:function(e,t){var n=this;return this.An.getAllMutationBatchesAffectingDocumentKey(e,t).next(function(r){return n.bn(e,t,r)})}},{key:"bn",value:function(e,t,n){return this.Je.getEntry(e,t).next(function(e){var t,r=ip(n);try{for(r.s();!(t=r.n()).done;){t.value.applyToLocalView(e)}}catch(i){r.e(i)}finally{r.f()}return e})}},{key:"Pn",value:function(e,t){e.forEach(function(e,n){var r,i=ip(t);try{for(i.s();!(r=i.n()).done;){r.value.applyToLocalView(n)}}catch(a){i.e(a)}finally{i.f()}})}},{key:"vn",value:function(e,t){var n=this;return this.Je.getEntries(e,t).next(function(t){return n.Vn(e,t).next(function(){return t})})}},{key:"Vn",value:function(e,t){var n=this;return this.An.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){return n.Pn(t,e)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return PQ.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.Sn(e,t.path):gX(t)?this.Dn(e,t,n):this.Cn(e,t,n);var r}},{key:"Sn",value:function(e,t){return this.Rn(e,new PQ(t)).next(function(e){var t=g1();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"Dn",value:function(e,t,n){var r=this,i=t.collectionGroup,a=g1();return this.Jt.getCollectionParents(e,i).next(function(o){return b0.forEach(o,function(o){var s,u,c=(s=t,u=o.child(i),new lX(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.Cn(e,c,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"Cn",value:function(e,t,n){var r,i,a=this;return this.Je.getDocumentsMatchingQuery(e,t,n).next(function(n){return r=n,a.An.getAllMutationBatchesAffectingQuery(e,t)}).next(function(t){return i=t,a.Nn(e,i,r).next(function(e){r=e;var t,n=ip(i);try{for(n.s();!(t=n.n()).done;){var a,o=t.value,s=ip(o.mutations);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u.key,l=r.get(c);null==l&&(l=GQ.newInvalidDocument(c),r=r.insert(c,l)),WX(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}catch(h){s.e(h)}finally{s.f()}}}catch(h){n.e(h)}finally{n.f()}})}).next(function(){return r.forEach(function(e,n){bX(t,n)||(r=r.remove(e))}),r})}},{key:"Nn",value:function(e,t,n){var r,i=k1(),a=ip(t);try{for(a.s();!(r=a.n()).done;){var o,s=ip(r.value.mutations);try{for(s.s();!(o=s.n()).done;){var u=o.value;u instanceof JX&&null===n.get(u.key)&&(i=i.add(u.key))}}catch(l){s.e(l)}finally{s.f()}}}catch(l){a.e(l)}finally{a.f()}var c=n;return this.Je.getEntries(e,i).next(function(e){return e.forEach(function(e,t){t.isFoundDocument()&&(c=c.insert(e,t))}),c})}}]),e}(),B0=function(){function e(t,n,r,i){sp(this,e),this.targetId=t,this.fromCache=n,this.kn=r,this.xn=i}return cp(e,null,[{key:"$n",value:function(t,n){var r,i=k1(),a=k1(),o=ip(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),U0=function(){function e(){sp(this,e)}return cp(e,[{key:"On",value:function(e){this.Mn=e}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i,a=this;return 0===(i=t).filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.explicitOrderBy.length||1===i.explicitOrderBy.length&&i.explicitOrderBy[0].field.isKeyField())||n.isEqual(sQ.min())?this.Fn(e,t):this.Mn.vn(e,r).next(function(i){var o=a.Ln(t,i);return(fX(t)||dX(t))&&a.Bn(t.limitType,o,r,n)?a.Fn(e,t):(LJ()<=aU.DEBUG&&FJ("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),CX(t)),a.Mn.getDocumentsMatchingQuery(e,t,n).next(function(e){return o.forEach(function(t){e=e.insert(t.key,t)}),e}))})}},{key:"Ln",value:function(e,t){var n=new h1(EX(e));return t.forEach(function(t,r){bX(e,r)&&(n=n.add(r))}),n}},{key:"Bn",value:function(e,t,n,r){if(n.size!==t.size)return!0;var i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Fn",value:function(e,t){return LJ()<=aU.DEBUG&&FJ("QueryEngine","Using full collection scan to execute query:",CX(t)),this.Mn.getDocumentsMatchingQuery(e,t,sQ.min())}}]),e}(),V0=function(){function e(t,n,r,i){sp(this,e),this.persistence=t,this.Un=n,this.k=i,this.qn=new u1(iQ),this.Kn=new L0(function(e){return WQ(e)},jQ),this.jn=sQ.min(),this.An=t.getMutationQueue(r),this.Qn=t.getRemoteDocumentCache(),this.He=t.getTargetCache(),this.Wn=new F0(this.Qn,this.An,this.persistence.getIndexManager()),this.Ye=t.getBundleCache(),this.Un.On(this.Wn)}return cp(e,[{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.qn)})}}]),e}();function z0(e,t){return H0.apply(this,arguments)}function H0(){return(H0=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=GJ(t),i=r.An,a=r.Wn,e.next=4,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.An.getAllMutationBatches(e).next(function(o){return t=o,i=r.persistence.getMutationQueue(n),a=new F0(r.Qn,i,r.persistence.getIndexManager()),i.getAllMutationBatches(e)}).next(function(n){var r,i=[],o=[],s=k1(),u=ip(t);try{for(u.s();!(r=u.n()).done;){var c=r.value;i.push(c.batchId);var l,h=ip(c.mutations);try{for(h.s();!(l=h.n()).done;){var f=l.value;s=s.add(f.key)}}catch(k){h.e(k)}finally{h.f()}}}catch(k){u.e(k)}finally{u.f()}var d,v=ip(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(p.batchId);var g,y=ip(p.mutations);try{for(y.s();!(g=y.n()).done;){var m=g.value;s=s.add(m.key)}}catch(k){y.e(k)}finally{y.f()}}}catch(k){v.e(k)}finally{v.f()}return a.vn(e,s).next(function(e){return{Gn:e,removedBatchIds:i,addedBatchIds:o}})})});case 4:return o=e.sent,e.abrupt("return",(r.An=i,r.Wn=a,r.Un.On(r.Wn),o));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function G0(e,t){var n=GJ(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r,i,a,o,s,u,c,l=t.batch.keys(),h=n.Qn.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,o=h,s=a.batch,u=s.keys(),c=b0.resolve(),u.forEach(function(e){c=c.next(function(){return o.getEntry(i,e)}).next(function(t){var n=a.docVersions.get(e);HJ(null!==n),t.version.compareTo(n)<0&&(s.applyToRemoteDocument(t,a),t.isValidDocument()&&o.addEntry(t,a.commitVersion))})}),c.next(function(){return r.An.removeMutationBatch(i,s)})).next(function(){return h.apply(e)}).next(function(){return n.An.performConsistencyCheck(e)}).next(function(){return n.Wn.vn(e,l)})})}function q0(e){var t=GJ(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.He.getLastRemoteSnapshotVersion(e)})}function $0(e,t){var n=GJ(e),r=t.snapshotVersion,i=n.qn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.Qn.newChangeBuffer({trackRemovals:!0});i=n.qn;var o=[];t.targetChanges.forEach(function(a,s){var u=i.get(s);if(u){o.push(n.He.removeMatchingKeys(e,a.removedDocuments,s).next(function(){return n.He.addMatchingKeys(e,a.addedDocuments,s)}));var c,l,h,f=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?f=f.withResumeToken(gQ.EMPTY_BYTE_STRING,sQ.min()).withLastLimboFreeSnapshotVersion(sQ.min()):a.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(a.resumeToken,r)),i=i.insert(s,f),l=f,h=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&o.push(n.He.updateTargetData(e,f))}});var s=v1();if(t.documentUpdates.forEach(function(r,i){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n,r,i){var a=k1();return n.forEach(function(e){return a=a.add(e)}),t.getEntries(e,a).next(function(e){var i=v1();return n.forEach(function(n,a){var o=e.get(n),s=r;a.isNoDocument()&&a.version.isEqual(sQ.min())?(t.removeEntry(n,s),i=i.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a,s),i=i.insert(n,a)):FJ("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)}),i})}(e,a,t.documentUpdates,r).next(function(e){s=e})),!r.isEqual(sQ.min())){var u=n.He.getLastRemoteSnapshotVersion(e).next(function(t){return n.He.setTargetsMetadata(e,e.currentSequenceNumber,r)});o.push(u)}return b0.waitFor(o).next(function(){return a.apply(e)}).next(function(){return n.Wn.Vn(e,s)}).next(function(){return s})}).then(function(e){return n.qn=i,e})}function W0(e,t){var n=GJ(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.An.getNextMutationBatchAfterBatchId(e,t)})}function j0(e,t){var n=GJ(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.He.getTargetData(e,t).next(function(i){return i?(r=i,b0.resolve(r)):n.He.allocateTargetId(e).next(function(i){return r=new O0(t,i,0,e.currentSequenceNumber),n.He.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.qn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.qn=n.qn.insert(e.targetId,e),n.Kn.set(t,e.targetId)),e})}function Z0(e,t,n){return Y0.apply(this,arguments)}function Y0(){return(Y0=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=GJ(t),a=i.qn.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),E0(e.t1)){e.next=12;break}throw e.t1;case 12:FJ("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.qn=i.qn.remove(n),i.Kn.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}function K0(e,t,n){var r=GJ(e),i=sQ.min(),a=k1();return r.persistence.runTransaction("Execute query","readonly",function(e){return(o=r,s=e,u=mX(t),c=GJ(o),l=c.Kn.get(u),void 0!==l?b0.resolve(c.qn.get(l)):c.He.getTargetData(s,u)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.He.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Un.getDocumentsMatchingQuery(e,t,n?i:sQ.min(),n?a:k1())}).next(function(e){return{documents:e,zn:a}});var o,s,u,c,l})}var J0=function(){function e(t){sp(this,e),this.k=t,this.Xn=new Map,this.Zn=new Map}return cp(e,[{key:"getBundleMetadata",value:function(e,t){return b0.resolve(this.Xn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Xn.set(t.id,{id:(n=t).id,version:n.version,createTime:F1(n.createTime)}),b0.resolve()}},{key:"getNamedQuery",value:function(e,t){return b0.resolve(this.Zn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Zn.set(t.name,{name:(n=t).name,query:I0(n.bundledQuery),readTime:F1(n.readTime)}),b0.resolve();var n}}]),e}(),Q0=function(){function e(){sp(this,e),this.ts=new h1(X0.es),this.ns=new h1(X0.ss)}return cp(e,[{key:"isEmpty",value:function(){return this.ts.isEmpty()}},{key:"addReference",value:function(e,t){var n=new X0(e,t);this.ts=this.ts.add(n),this.ns=this.ns.add(n)}},{key:"rs",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.os(new X0(e,t))}},{key:"cs",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"us",value:function(e){var t=this,n=new PQ(new fQ([])),r=new X0(n,e),i=new X0(n,e+1),a=[];return this.ns.forEachInRange([r,i],function(e){t.os(e),a.push(e.key)}),a}},{key:"hs",value:function(){var e=this;this.ts.forEach(function(t){return e.os(t)})}},{key:"os",value:function(e){this.ts=this.ts.delete(e),this.ns=this.ns.delete(e)}},{key:"ls",value:function(e){var t=new PQ(new fQ([])),n=new X0(t,e),r=new X0(t,e+1),i=k1();return this.ns.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new X0(e,0),n=this.ts.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),X0=function(){function e(t,n){sp(this,e),this.key=t,this.fs=n}return cp(e,null,[{key:"es",value:function(e,t){return PQ.comparator(e.key,t.key)||iQ(e.fs,t.fs)}},{key:"ss",value:function(e,t){return iQ(e.fs,t.fs)||PQ.comparator(e.key,t.key)}}]),e}(),e2=function(){function e(t,n){sp(this,e),this.Jt=t,this.referenceDelegate=n,this.An=[],this.ds=1,this.ws=new h1(X0.es)}return cp(e,[{key:"checkEmpty",value:function(e){return b0.resolve(0===this.An.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.ds;this.ds++;var a=new S0(i,t,n,r);this.An.push(a);var o,s=ip(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.ws=this.ws.add(new X0(u.key,i)),this.Jt.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return b0.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return b0.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this.gs(t+1),r=n<0?0:n;return b0.resolve(this.An.length>r?this.An[r]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return b0.resolve(0===this.An.length?-1:this.ds-1)}},{key:"getAllMutationBatches",value:function(e){return b0.resolve(this.An.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new X0(t,0),i=new X0(t,Number.POSITIVE_INFINITY),a=[];return this.ws.forEachInRange([r,i],function(e){var t=n._s(e.fs);a.push(t)}),b0.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new h1(iQ);return t.forEach(function(e){var t=new X0(e,0),i=new X0(e,Number.POSITIVE_INFINITY);n.ws.forEachInRange([t,i],function(e){r=r.add(e.fs)})}),b0.resolve(this.ys(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;PQ.isDocumentKey(i)||(i=i.child(""));var a=new X0(new PQ(i),0),o=new h1(iQ);return this.ws.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.fs)),!0)},a),b0.resolve(this.ys(o))}},{key:"ys",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t._s(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;HJ(0===this.ps(t.batchId,"removed")),this.An.shift();var r=this.ws;return b0.forEach(t.mutations,function(i){var a=new X0(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ws=r})}},{key:"ee",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new X0(t,0),r=this.ws.firstAfterOrEqual(n);return b0.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return b0.resolve()}},{key:"ps",value:function(e,t){return this.gs(e)}},{key:"gs",value:function(e){return 0===this.An.length?0:e-this.An[0].batchId}},{key:"_s",value:function(e){var t=this.gs(e);return t<0||t>=this.An.length?null:this.An[t]}}]),e}(),t2=function(){function e(t,n){sp(this,e),this.Jt=t,this.Ts=n,this.docs=new u1(PQ.comparator),this.size=0}return cp(e,[{key:"addEntry",value:function(e,t,n){var r=t.key,i=this.docs.get(r),a=i?i.size:0,o=this.Ts(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o,readTime:n}),this.size+=o-a,this.Jt.addToCollectionParentIndex(e,r.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return b0.resolve(n?n.document.mutableCopy():GQ.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=v1();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():GQ.newInvalidDocument(e))}),b0.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){for(var r=v1(),i=new PQ(t.path.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value,c=u.document,l=u.readTime;if(!t.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||bX(t,c)&&(r=r.insert(c.key,c.mutableCopy()))}return b0.resolve(r)}},{key:"Es",value:function(e,t){return b0.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new n2(this)}},{key:"getSize",value:function(e){return b0.resolve(this.size)}}]),e}(),n2=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).De=e,r}return cp(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(t.De.addEntry(e,i.document,t.getReadTime(r))):t.De.removeEntry(r)}),b0.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.De.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.De.getEntries(e,t)}}]),n}(function(){function e(){sp(this,e),this.changes=new L0(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return cp(e,[{key:"getReadTime",value:function(e){var t=this.changes.get(e);return t?t.readTime:sQ.min()}},{key:"addEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}},{key:"removeEntry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.assertNotApplied(),this.changes.set(e,{document:GQ.newInvalidDocument(e),readTime:t})}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?b0.resolve(n.document):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}()),r2=function(){function e(t){sp(this,e),this.persistence=t,this.Is=new L0(function(e){return WQ(e)},jQ),this.lastRemoteSnapshotVersion=sQ.min(),this.highestTargetId=0,this.As=0,this.Rs=new Q0,this.targetCount=0,this.bs=N0.ie()}return cp(e,[{key:"forEachTarget",value:function(e,t){return this.Is.forEach(function(e,n){return t(n)}),b0.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return b0.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return b0.resolve(this.As)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.bs.next(),b0.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.As&&(this.As=t),b0.resolve()}},{key:"ae",value:function(e){this.Is.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.bs=new N0(t),this.highestTargetId=t),e.sequenceNumber>this.As&&(this.As=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.ae(t),this.targetCount+=1,b0.resolve()}},{key:"updateTargetData",value:function(e,t){return this.ae(t),b0.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Is.delete(t.target),this.Rs.us(t.targetId),this.targetCount-=1,b0.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Is.forEach(function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Is.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),b0.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return b0.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Is.get(t)||null;return b0.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Rs.rs(t,n),b0.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Rs.cs(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),b0.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Rs.us(t),b0.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Rs.ls(t);return b0.resolve(n)}},{key:"containsKey",value:function(e,t){return b0.resolve(this.Rs.containsKey(t))}}]),e}(),i2=function(){function e(t,n){var r=this;sp(this,e),this.Ps={},this.Be=new tQ(0),this.Ue=!1,this.Ue=!0,this.referenceDelegate=t(this),this.He=new r2(this),this.Jt=new x0,this.Je=new t2(this.Jt,function(e){return r.referenceDelegate.vs(e)}),this.k=new T0(n),this.Ye=new J0(this.k)}return cp(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Ue=!1,Promise.resolve()}},{key:"started",get:function(){return this.Ue}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(){return this.Jt}},{key:"getMutationQueue",value:function(e){var t=this.Ps[e.toKey()];return t||(t=new e2(this.Jt,this.referenceDelegate),this.Ps[e.toKey()]=t),t}},{key:"getTargetCache",value:function(){return this.He}},{key:"getRemoteDocumentCache",value:function(){return this.Je}},{key:"getBundleCache",value:function(){return this.Ye}},{key:"runTransaction",value:function(e,t,n){var r=this;FJ("MemoryPersistence","Starting transaction:",e);var i=new a2(this.Be.next());return this.referenceDelegate.Vs(),n(i).next(function(e){return r.referenceDelegate.Ss(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Ds",value:function(e,t){return b0.or(Object.values(this.Ps).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),a2=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return cp(n)}(function(){function e(){sp(this,e),this.onCommittedListeners=[]}return cp(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}()),o2=function(){function e(t){sp(this,e),this.persistence=t,this.Cs=new Q0,this.Ns=null}return cp(e,[{key:"xs",get:function(){if(this.Ns)return this.Ns;throw zJ()}},{key:"addReference",value:function(e,t,n){return this.Cs.addReference(n,t),this.xs.delete(n.toString()),b0.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Cs.removeReference(n,t),this.xs.add(n.toString()),b0.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.xs.add(t.toString()),b0.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Cs.us(t.targetId).forEach(function(e){return n.xs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.xs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Vs",value:function(){this.Ns=new Set}},{key:"Ss",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return b0.forEach(this.xs,function(r){var i=PQ.fromPath(r);return t.$s(e,i).next(function(e){e||n.removeEntry(i)})}).next(function(){return t.Ns=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next(function(e){e?n.xs.delete(t.toString()):n.xs.add(t.toString())})}},{key:"vs",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return b0.or([function(){return b0.resolve(n.Cs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ds(e,t)}])}}],[{key:"ks",value:function(t){return new e(t)}}]),e}(),s2=function(){function e(){sp(this,e),this.activeTargetIds=w1()}return cp(e,[{key:"Fs",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Ls",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Ms",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),u2=function(){function e(){sp(this,e),this.pi=new s2,this.Ti={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return cp(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.pi.Fs(e),this.Ti[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.Ti[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.pi.Ls(e)}},{key:"isLocalQueryTarget",value:function(e){return this.pi.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.Ti[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.pi.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.pi.activeTargetIds.has(e)}},{key:"start",value:function(){return this.pi=new s2,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(){}}]),e}(),c2=function(){function e(){sp(this,e)}return cp(e,[{key:"Ei",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),l2=function(){function e(){var t=this;sp(this,e),this.Ii=function(){return t.Ai()},this.Ri=function(){return t.bi()},this.Pi=[],this.vi()}return cp(e,[{key:"Ei",value:function(e){this.Pi.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Ii),window.removeEventListener("offline",this.Ri)}},{key:"vi",value:function(){window.addEventListener("online",this.Ii),window.addEventListener("offline",this.Ri)}},{key:"Ai",value:function(){FJ("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=ip(this.Pi);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"bi",value:function(){FJ("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=ip(this.Pi);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"Pt",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),h2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},f2=function(){function e(t){sp(this,e),this.Vi=t.Vi,this.Si=t.Si}return cp(e,[{key:"Di",value:function(e){this.Ci=e}},{key:"Ni",value:function(e){this.ki=e}},{key:"onMessage",value:function(e){this.xi=e}},{key:"close",value:function(){this.Si()}},{key:"send",value:function(e){this.Vi(e)}},{key:"$i",value:function(){this.Ci()}},{key:"Oi",value:function(e){this.ki(e)}},{key:"Mi",value:function(e){this.xi(e)}}]),e}(),d2=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return cp(n,[{key:"Ki",value:function(e,t,n,r){return new Promise(function(i,a){var o=new AJ;o.listenOnce(PJ.COMPLETE,function(){try{switch(o.getLastErrorCode()){case SJ.NO_ERROR:var t=o.getResponseJson();FJ("Connection","XHR received:",JSON.stringify(t)),i(t);break;case SJ.TIMEOUT:FJ("Connection",'RPC "'+e+'" timed out'),a(new $J(qJ.DEADLINE_EXCEEDED,"Request time out"));break;case SJ.HTTP_ERROR:var n=o.getStatus();if(FJ("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(qJ).indexOf(c)>=0?c:qJ.UNKNOWN);a(new $J(s,r.message))}else a(new $J(qJ.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new $J(qJ.UNAVAILABLE,"Connection failed."));break;default:zJ()}}finally{FJ("Connection",'RPC "'+e+'" completed.')}var u,c});var s=JSON.stringify(r);o.send(t,"POST",s,n,15)})}},{key:"Qi",value:function(e,t,n){var r=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=bJ(),a=EJ(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new IJ({})),this.qi(o.initMessageHeaders,t,n),SB()||OB()||EB().indexOf("Electron/")>=0||TB()||EB().indexOf("MSAppHost/")>=0||PB()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");FJ("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,h=new f2({Vi:function(e){l?FJ("Connection","Not sending because WebChannel is closed:",e):(c||(FJ("Connection","Opening WebChannel transport."),u.open(),c=!0),FJ("Connection","WebChannel sending:",e),u.send(e))},Si:function(){return u.close()}}),f=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(t){setTimeout(function(){throw t},0)}})};return f(u,xJ.EventType.OPEN,function(){l||FJ("Connection","WebChannel transport opened.")}),f(u,xJ.EventType.CLOSE,function(){l||(l=!0,FJ("Connection","WebChannel transport closed"),h.Oi())}),f(u,xJ.EventType.ERROR,function(e){l||(l=!0,UJ("Connection","WebChannel transport errored:",e),h.Oi(new $J(qJ.UNAVAILABLE,"The operation could not be completed")))}),f(u,xJ.EventType.MESSAGE,function(e){var t;if(!l){var n=e.data[0];HJ(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){FJ("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=t1[e];if(void 0!==t)return s1(t)}(a),s=i.message;void 0===o&&(o=qJ.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,h.Oi(new $J(o,s)),u.close()}else FJ("Connection","WebChannel received:",n),h.Mi(n)}}),f(a,OJ.STAT_EVENT,function(e){e.stat===TJ.PROXY?FJ("Connection","Detected buffering proxy"):e.stat===TJ.NOPROXY&&FJ("Connection","Detected no buffering proxy")}),setTimeout(function(){h.$i()},0),h}}]),n}(function(){function e(t){sp(this,e),this.databaseInfo=t,this.databaseId=t.databaseId,this.Fi=(t.ssl?"https":"http")+"://"+t.host,this.Li="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return cp(e,[{key:"Bi",value:function(e,t,n,r,i){var a=this.Ui(e,t);FJ("RestConnection","Sending: ",a,n);var o={};return this.qi(o,r,i),this.Ki(e,a,o,n).then(function(e){return FJ("RestConnection","Received: ",e),e},function(t){throw UJ("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t})}},{key:"ji",value:function(e,t,n,r,i){return this.Bi(e,t,n,r,i)}},{key:"qi",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+MJ,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(function(t,n){return e[n]=t}),n&&n.headers.forEach(function(t,n){return e[n]=t})}},{key:"Ui",value:function(e,t){return"".concat(this.Fi,"/v1/").concat(t,":").concat(h2[e])}}]),e}());function v2(){return"undefined"!=typeof document?document:null}function p2(e){return new N1(e,!0)}var g2=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;sp(this,e),this.Me=t,this.timerId=n,this.Wi=r,this.Gi=i,this.zi=a,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}return cp(e,[{key:"reset",value:function(){this.Hi=0}},{key:"Xi",value:function(){this.Hi=this.zi}},{key:"Zi",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Hi+this.tr()),r=Math.max(0,Date.now()-this.Yi),i=Math.max(0,n-r);i>0&&FJ("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Hi," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Ji=this.Me.enqueueAfterDelay(this.timerId,i,function(){return t.Yi=Date.now(),e()}),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}},{key:"er",value:function(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}},{key:"cancel",value:function(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}},{key:"tr",value:function(){return(Math.random()-.5)*this.Hi}}]),e}(),y2=function(){function e(t,n,r,i,a,o,s,u){sp(this,e),this.Me=t,this.nr=r,this.sr=i,this.ir=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.rr=0,this.cr=null,this.ar=null,this.stream=null,this.ur=new g2(t,n)}return cp(e,[{key:"hr",value:function(){return 1===this.state||5===this.state||this.lr()}},{key:"lr",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.dr()}},{key:"stop",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.hr(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}},t)}))()}},{key:"wr",value:function(){this.state=0,this.ur.reset()}},{key:"_r",value:function(){var e=this;this.lr()&&null===this.cr&&(this.cr=this.Me.enqueueAfterDelay(this.nr,6e4,function(){return e.mr()}))}},{key:"gr",value:function(e){this.yr(),this.stream.send(e)}},{key:"mr",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.lr()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}},t)}))()}},{key:"yr",value:function(){this.cr&&(this.cr.cancel(),this.cr=null)}},{key:"pr",value:function(){this.ar&&(this.ar.cancel(),this.ar=null)}},{key:"close",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.yr(),n.pr(),n.ur.cancel(),n.rr++,4!==e?n.ur.reset():t&&t.code===qJ.RESOURCE_EXHAUSTED?(BJ(t.toString()),BJ("Using maximum backoff delay to prevent overloading the backend."),n.ur.Xi()):t&&t.code===qJ.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Tr(),n.stream.close(),n.stream=null),n.state=e,r.next=9,n.listener.Ni(t);case 9:case"end":return r.stop()}},r)}))()}},{key:"Tr",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Er(this.rr),n=this.rr;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=Hv(t,2),i=r[0],a=r[1];e.rr===n&&e.Ir(i,a)},function(n){t(function(){var t=new $J(qJ.UNKNOWN,"Fetching auth token failed: "+n.message);return e.Ar(t)})})}},{key:"Ir",value:function(e,t){var n=this,r=this.Er(this.rr);this.stream=this.Rr(e,t),this.stream.Di(function(){r(function(){return n.state=2,n.ar=n.Me.enqueueAfterDelay(n.sr,1e4,function(){return n.lr()&&(n.state=3),Promise.resolve()}),n.listener.Di()})}),this.stream.Ni(function(e){r(function(){return n.Ar(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"dr",value:function(){var e=this;this.state=5,this.ur.Zi(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"Ar",value:function(e){return FJ("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Er",value:function(e){var t=this;return function(n){t.Me.enqueueAndForget(function(){return t.rr===e?n():(FJ("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),m2=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s){var u;return sp(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).k=o,u}return cp(n,[{key:"Rr",value:function(e,t){return this.ir.Qi("Listen",e,t)}},{key:"onMessage",value:function(e){this.ur.reset();var t=function(e,t){var n,r;if("targetChange"in t){var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:zJ(),a=t.targetChange.targetIds||[],o=function(e,t){return e.C?(HJ(void 0===t||"string"==typeof t),gQ.fromBase64String(t||"")):(HJ(void 0===t||t instanceof Uint8Array),gQ.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?qJ.UNKNOWN:s1(e.code);return new $J(t,e.message||"")}(s);n=new P1(i,a,o,u||null)}else if("documentChange"in t){var c=t.documentChange,l=z1(e,c.document.name),h=F1(c.document.updateTime),f=new zQ({mapValue:{fields:c.document.fields}}),d=GQ.newFoundDocument(l,h,f);n=new E1(c.targetIds||[],c.removedTargetIds||[],d.key,d)}else if("documentDelete"in t){var v=t.documentDelete,p=z1(e,v.document),g=v.readTime?F1(v.readTime):sQ.min(),y=GQ.newNoDocument(p,g);n=new E1([],v.removedTargetIds||[],y.key,y)}else if("documentRemove"in t){var m=t.documentRemove,k=z1(e,m.document);n=new E1([],m.removedTargetIds||[],k,null)}else{if(!("filter"in t))return zJ();var _=t.filter,w=new a1(_.count||0);n=new S1(_.targetId,w)}return n}(this.k,e),n=function(e){if(!("targetChange"in e))return sQ.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?sQ.min():t.readTime?F1(t.readTime):sQ.min()}(e);return this.listener.br(t,n)}},{key:"Pr",value:function(e){var t,n,r,i,a={};a.database=G1(this.k),a.addTarget=(t=this.k,i=(n=e).target,(r=ZQ(i)?{documents:W1(t,i)}:{query:j1(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=D1(t,n.resumeToken):n.snapshotVersion.compareTo(sQ.min())>0&&(r.readTime=M1(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return zJ()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);o&&(a.labels=o),this.gr(a)}},{key:"vr",value:function(e){var t={};t.database=G1(this.k),t.removeTarget=e,this.gr(t)}}]),n}(y2),k2=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s){var u;return sp(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).k=o,u.Vr=!1,u}return cp(n,[{key:"Sr",get:function(){return this.Vr}},{key:"start",value:function(){this.Vr=!1,this.lastStreamToken=void 0,jv(tp(n.prototype),"start",this).call(this)}},{key:"Tr",value:function(){this.Vr&&this.Dr([])}},{key:"Rr",value:function(e,t){return this.ir.Qi("Write",e,t)}},{key:"onMessage",value:function(e){if(HJ(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Vr){this.ur.reset();var t=function(e,t){return e&&e.length>0?(HJ(void 0!==t),e.map(function(e){return function(e,t){var n=F1(e.updateTime?e.updateTime:t);return n.isEqual(sQ.min())&&(n=F1(t)),new zX(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=F1(e.commitTime);return this.listener.Cr(n,t)}return HJ(!e.writeResults||0===e.writeResults.length),this.Vr=!0,this.listener.Nr()}},{key:"kr",value:function(){var e={};e.database=G1(this.k),this.gr(e)}},{key:"Dr",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return function(e,t){var n,r;if(t instanceof KX)n={update:$1(e,t.key,t.value)};else if(t instanceof r1)n={delete:V1(e,t.key)};else if(t instanceof JX)n={update:$1(e,t.key,t.data),updateMask:i0(t.fieldMask)};else{if(!(t instanceof i1))return zJ();n={verify:V1(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof RX)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof NX)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof DX)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof FX)return{fieldPath:t.field.canonicalString(),increment:n.N};throw zJ()}(0,e)})),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:L1(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:zJ()),n}(t.k,e)})};this.gr(n)}}]),n}(y2),_2=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.ir=i,o.k=a,o.$r=!1,o}return cp(n,[{key:"Or",value:function(){if(this.$r)throw new $J(qJ.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"Bi",value:function(e,t,n){var r=this;return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=Hv(i,2),o=a[0],s=a[1];return r.ir.Bi(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===qJ.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new $J(qJ.UNKNOWN,e.toString())})}},{key:"ji",value:function(e,t,n){var r=this;return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=Hv(i,2),o=a[0],s=a[1];return r.ir.ji(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===qJ.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new $J(qJ.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.$r=!0}}]),n}(function(){return cp(function e(){sp(this,e)})}()),w2=function(){function e(t,n){sp(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.Mr=0,this.Fr=null,this.Lr=!0}return cp(e,[{key:"Br",value:function(){var e=this;0===this.Mr&&(this.Ur("Unknown"),this.Fr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.Fr=null,e.qr("Backend didn't respond within 10 seconds."),e.Ur("Offline"),Promise.resolve()}))}},{key:"Kr",value:function(e){"Online"===this.state?this.Ur("Unknown"):(this.Mr++,this.Mr>=1&&(this.jr(),this.qr("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.Ur("Offline")))}},{key:"set",value:function(e){this.jr(),this.Mr=0,"Online"===e&&(this.Lr=!1),this.Ur(e)}},{key:"Ur",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"qr",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.Lr?(BJ(t),this.Lr=!1):FJ("OnlineStateTracker",t)}},{key:"jr",value:function(){null!==this.Fr&&(this.Fr.cancel(),this.Fr=null)}}]),e}(),C2=cp(function e(t,n,r,i,a){sp(this,e);var o=this;this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Qr=[],this.Wr=new Map,this.Gr=new Set,this.zr=[],this.Hr=a,this.Hr.Ei(function(e){r.enqueueAndForget(aB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=N2(o),!e.t0){e.next=5;break}return FJ("RemoteStore","Restarting streams for network reachability change."),e.next=5,(t=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=GJ(t)).Gr.add(4),e.next=4,S2(n);case 4:return n.Jr.set("Unknown"),n.Gr.delete(4),e.next=8,b2(n);case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})(o);case 5:case"end":return e.stop()}},e)})))}),this.Jr=new w2(r,i)});function b2(e){return E2.apply(this,arguments)}function E2(){return(E2=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!N2(t)){e.next=18;break}n=ip(t.zr),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])}))).apply(this,arguments)}function S2(e){return P2.apply(this,arguments)}function P2(){return(P2=aB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=ip(t.zr),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])}))).apply(this,arguments)}function O2(e,t){var n=GJ(e);n.Wr.has(t.targetId)||(n.Wr.set(t.targetId,t),R2(n)?A2(n):s3(n).lr()&&I2(n,t))}function T2(e,t){var n=GJ(e),r=s3(n);n.Wr.delete(t),r.lr()&&x2(n,t),0===n.Wr.size&&(r.lr()?r._r():N2(n)&&n.Jr.set("Unknown"))}function I2(e,t){e.Yr.X(t.targetId),s3(e).Pr(t)}function x2(e,t){e.Yr.X(t),s3(e).vr(t)}function A2(e){e.Yr=new T1({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},Et:function(t){return e.Wr.get(t)||null}}),s3(e).start(),e.Jr.Br()}function R2(e){return N2(e)&&!s3(e).hr()&&e.Wr.size>0}function N2(e){return 0===GJ(e).Gr.size}function M2(e){e.Yr=void 0}function D2(e){return L2.apply(this,arguments)}function L2(){return(L2=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.Wr.forEach(function(e,n){I2(t,e)});case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function F2(e,t){return B2.apply(this,arguments)}function B2(){return(B2=aB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:M2(t),R2(t)?(t.Jr.Kr(n),A2(t)):t.Jr.set("Unknown");case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U2(e,t,n){return V2.apply(this,arguments)}function V2(){return(V2=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.Jr.set("Online"),!(n instanceof P1&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,(a=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=ip(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.Wr.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.Wr.delete(o),t.Yr.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])})),function(e,t){return a.apply(this,arguments)})(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),FJ("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,z2(t,e.t0);case 11:e.next=29;break;case 13:if(n instanceof E1?t.Yr.ot(n):n instanceof S1?t.Yr.dt(n):t.Yr.ut(n),r.isEqual(sQ.min())){e.next=29;break}return e.prev=14,e.next=17,q0(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.Yr.gt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.Wr.get(r);i&&e.Wr.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.Wr.get(t);if(n){e.Wr.set(t,n.withResumeToken(gQ.EMPTY_BYTE_STRING,n.snapshotVersion)),x2(e,t);var r=new O0(n.target,t,1,n.sequenceNumber);I2(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 22:e.next=29;break;case 24:return e.prev=24,e.t2=e.catch(14),FJ("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,z2(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])}))).apply(this,arguments)}function z2(e,t,n){return H2.apply(this,arguments)}function H2(){return(H2=aB(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(E0(n)){e.next=2;break}throw n;case 2:return t.Gr.add(1),e.next=5,S2(t);case 5:t.Jr.set("Offline"),r||(r=function(){return q0(t.localStore)}),t.asyncQueue.enqueueRetryable(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return FJ("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.Gr.delete(1),e.next=6,b2(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function G2(e,t){return t().catch(function(n){return z2(e,n,t)})}function q2(e){return $2.apply(this,arguments)}function $2(){return($2=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=GJ(t),r=u3(n),i=n.Qr.length>0?n.Qr[n.Qr.length-1].batchId:-1;case 2:if(!W2(n)){e.next=19;break}return e.prev=3,e.next=6,W0(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.Qr.length&&r._r(),e.abrupt("break",19);case 10:i=a.batchId,j2(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,z2(n,e.t0);case 17:e.next=2;break;case 19:Z2(n)&&Y2(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])}))).apply(this,arguments)}function W2(e){return N2(e)&&e.Qr.length<10}function j2(e,t){e.Qr.push(t);var n=u3(e);n.lr()&&n.Sr&&n.Dr(t.mutations)}function Z2(e){return N2(e)&&!u3(e).hr()&&e.Qr.length>0}function Y2(e){u3(e).start()}function K2(e){return J2.apply(this,arguments)}function J2(){return(J2=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u3(t).kr();case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Q2(e){return X2.apply(this,arguments)}function X2(){return(X2=aB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=u3(t),r=ip(t.Qr);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Dr(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function e3(e,t,n){return t3.apply(this,arguments)}function t3(){return(t3=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.Qr.shift(),a=P0.from(i,n,r),e.next=3,G2(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,q2(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function n3(e,t){return r3.apply(this,arguments)}function r3(){return(r3=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&u3(t).Sr,!e.t0){e.next=4;break}return e.next=4,(r=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!o1(i=n.code)||i===qJ.ABORTED){e.next=7;break}return r=t.Qr.shift(),u3(t).wr(),e.next=5,G2(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,q2(t);case 7:case"end":return e.stop()}},e)})),function(e,t){return r.apply(this,arguments)})(t,n);case 4:Z2(t)&&Y2(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function i3(e,t){return a3.apply(this,arguments)}function a3(){return(a3=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=GJ(t)).asyncQueue.verifyOperationInProgress(),FJ("RemoteStore","RemoteStore received new credentials"),i=N2(r),r.Gr.add(3),e.next=6,S2(r);case 6:return i&&r.Jr.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.Gr.delete(3),e.next=12,b2(r);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function o3(){return(o3=aB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=GJ(t),!n){e.next=7;break}return r.Gr.delete(2),e.next=5,b2(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.Gr.add(2),e.next=12,S2(r);case 12:r.Jr.set("Unknown");case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function s3(e){return e.Xr||(e.Xr=(t=e.datastore,n=e.asyncQueue,r={Di:D2.bind(null,e),Ni:F2.bind(null,e),br:U2.bind(null,e)},(i=GJ(t)).Or(),new m2(n,i.ir,i.authCredentials,i.appCheckCredentials,i.k,r)),e.zr.push(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.Xr.wr(),R2(e)?A2(e):e.Jr.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.Xr.stop();case 6:M2(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.Xr;var t,n,r,i}function u3(e){return e.Zr||(e.Zr=(t=e.datastore,n=e.asyncQueue,r={Di:K2.bind(null,e),Ni:n3.bind(null,e),Nr:Q2.bind(null,e),Cr:e3.bind(null,e)},(i=GJ(t)).Or(),new k2(n,i.ir,i.authCredentials,i.appCheckCredentials,i.k,r)),e.zr.push(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.Zr.wr(),t.next=4,q2(e);case 4:t.next=9;break;case 6:return t.next=8,e.Zr.stop();case 8:e.Qr.length>0&&(FJ("RemoteStore","Stopping write stream with ".concat(e.Qr.length," pending writes")),e.Qr=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.Zr;var t,n,r,i}var c3=function(){function e(t,n,r,i,a){sp(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new WJ,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return cp(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new $J(qJ.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function l3(e,t){if(BJ("AsyncQueue","".concat(t,": ").concat(e)),E0(e))return new $J(qJ.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var h3=function(){function e(t){sp(this,e),this.comparator=t?function(e,n){return t(e,n)||PQ.comparator(e.key,n.key)}:function(e,t){return PQ.comparator(e.key,t.key)},this.keyedMap=g1(),this.sortedSet=new u1(this.comparator)}return cp(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),f3=function(){function e(){sp(this,e),this.eo=new u1(PQ.comparator)}return cp(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.eo.get(t);n?0!==e.type&&3===n.type?this.eo=this.eo.insert(t,e):3===e.type&&1!==n.type?this.eo=this.eo.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.eo=this.eo.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.eo=this.eo.remove(t):1===e.type&&2===n.type?this.eo=this.eo.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):zJ():this.eo=this.eo.insert(t,e)}},{key:"no",value:function(){var e=[];return this.eo.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),d3=function(){function e(t,n,r,i,a,o,s,u){sp(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return cp(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_X(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach(function(e){a.push({type:0,doc:e})}),new e(t,n,h3.emptySet(n),a,r,i,!0,!1)}}]),e}(),v3=cp(function e(){sp(this,e),this.so=void 0,this.listeners=[]}),p3=cp(function e(){sp(this,e),this.queries=new L0(function(e){return wX(e)},_X),this.onlineState="Unknown",this.io=new Set});function g3(e,t){return y3.apply(this,arguments)}function y3(){return(y3=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=GJ(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new v3),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.so=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=l3(e.t0,"Initialization of query '".concat(CX(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(i,o),o.listeners.push(n),n.ro(r.onlineState),o.so&&n.oo(o.so)&&C3(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])}))).apply(this,arguments)}function m3(e,t){return k3.apply(this,arguments)}function k3(){return(k3=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=GJ(t),i=n.query,a=!1,(o=r.queries.get(i))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _3(e,t){var n,r=GJ(e),i=!1,a=ip(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.queries.get(o.query);if(s){var u,c=ip(s.listeners);try{for(c.s();!(u=c.n()).done;){u.value.oo(o)&&(i=!0)}}catch(l){c.e(l)}finally{c.f()}s.so=o}}}catch(l){a.e(l)}finally{a.f()}i&&C3(r)}function w3(e,t,n){var r=GJ(e),i=r.queries.get(t);if(i){var a,o=ip(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function C3(e){e.io.forEach(function(e){e.next()})}var b3=function(){function e(t,n,r){sp(this,e),this.query=t,this.co=n,this.ao=!1,this.uo=null,this.onlineState="Unknown",this.options=r||{}}return cp(e,[{key:"oo",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=ip(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new d3(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.ao?this.ho(e)&&(this.co.next(e),a=!0):this.lo(e,this.onlineState)&&(this.fo(e),a=!0),this.uo=e,a}},{key:"onError",value:function(e){this.co.error(e)}},{key:"ro",value:function(e){this.onlineState=e;var t=!1;return this.uo&&!this.ao&&this.lo(this.uo,e)&&(this.fo(this.uo),t=!0),t}},{key:"lo",value:function(e,t){return!e.fromCache||!(this.options.wo&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}},{key:"ho",value:function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.uo&&this.uo.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}},{key:"fo",value:function(e){e=d3.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.ao=!0,this.co.next(e)}}]),e}(),E3=cp(function e(t){sp(this,e),this.key=t}),S3=cp(function e(t){sp(this,e),this.key=t}),P3=function(){function e(t,n){sp(this,e),this.query=t,this.To=n,this.Eo=null,this.current=!1,this.Io=k1(),this.mutatedKeys=k1(),this.Ao=EX(t),this.Ro=new h3(this.Ao)}return cp(e,[{key:"bo",get:function(){return this.To}},{key:"Po",value:function(e,t){var n=this,r=t?t.vo:new f3,i=t?t.Ro:this.Ro,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u=fX(this.query)&&i.size===this.query.limit?i.last():null,c=dX(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),h=bX(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),v=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),v=!0):n.Vo(l,h)||(r.track({type:2,doc:h}),v=!0,(u&&n.Ao(h,u)>0||c&&n.Ao(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),v=!0):l&&!h&&(r.track({type:1,doc:l}),v=!0,(u||c)&&(s=!0)),v&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))}),fX(this.query)||dX(this.query))for(;o.size>this.query.limit;){var l=fX(this.query)?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Ro:o,vo:r,Bn:s,mutatedKeys:a}}},{key:"Vo",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Ro;this.Ro=e.Ro,this.mutatedKeys=e.mutatedKeys;var a=e.vo.no();a.sort(function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return zJ()}})(n)-a(i)||r.Ao(e.doc,t.doc);var n,i,a}),this.So(n);var o=t?this.Do():[],s=0===this.Io.size&&this.current?1:0,u=s!==this.Eo;return this.Eo=s,0!==a.length||u?{snapshot:new d3(this.query,e.Ro,i,a,e.mutatedKeys,0===s,u,!1),Co:o}:{Co:o}}},{key:"ro",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ro:this.Ro,vo:new f3,mutatedKeys:this.mutatedKeys,Bn:!1},!1)):{Co:[]}}},{key:"No",value:function(e){return!this.To.has(e)&&!!this.Ro.has(e)&&!this.Ro.get(e).hasLocalMutations}},{key:"So",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.To=t.To.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.To=t.To.delete(e)}),this.current=e.current)}},{key:"Do",value:function(){var e=this;if(!this.current)return[];var t=this.Io;this.Io=k1(),this.Ro.forEach(function(t){e.No(t.key)&&(e.Io=e.Io.add(t.key))});var n=[];return t.forEach(function(t){e.Io.has(t)||n.push(new S3(t))}),this.Io.forEach(function(e){t.has(e)||n.push(new E3(e))}),n}},{key:"ko",value:function(e){this.To=e.zn,this.Io=k1();var t=this.Po(e.documents);return this.applyChanges(t,!0)}},{key:"xo",value:function(){return d3.fromInitialDocuments(this.query,this.Ro,this.mutatedKeys,0===this.Eo)}}]),e}(),O3=cp(function e(t,n,r){sp(this,e),this.query=t,this.targetId=n,this.view=r}),T3=cp(function e(t){sp(this,e),this.key=t,this.$o=!1}),I3=function(){function e(t,n,r,i,a,o){sp(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Oo={},this.Mo=new L0(function(e){return wX(e)},_X),this.Fo=new Map,this.Lo=new Set,this.Bo=new u1(PQ.comparator),this.Uo=new Map,this.qo=new Q0,this.Ko={},this.jo=new Map,this.Qo=N0.re(),this.onlineState="Unknown",this.Wo=void 0}return cp(e,[{key:"isPrimaryClient",get:function(){return!0===this.Wo}}]),e}();function x3(e,t){return A3.apply(this,arguments)}function A3(){return(A3=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i4(t),!(o=r.Mo.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.xo(),e.next=15;break;case 6:return e.next=8,j0(r.localStore,mX(n));case 8:return s=e.sent,u=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,e.next=13,R3(r,n,i,"current"===u);case 13:a=e.sent,r.isPrimaryClient&&O2(r.remoteStore,s);case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function R3(e,t,n,r){return N3.apply(this,arguments)}function N3(){return(N3=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.Go=function(e,n,r){return(i=aB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Po(r),e.t0=a.Bn,!e.t0){e.next=6;break}return e.next=5,K0(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.Po(t,a)});case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(K3(t,n.targetId,s.Co),s.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,K0(t.localStore,n,!0);case 3:return a=e.sent,o=new P3(n,a.zn),s=o.Po(a.documents),u=b1.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(s,t.isPrimaryClient,u),K3(t,r,c.Co),l=new O3(n,r,o),e.abrupt("return",(t.Mo.set(n,l),t.Fo.has(r)?t.Fo.get(r).push(n):t.Fo.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function M3(e,t){return D3.apply(this,arguments)}function D3(){return(D3=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=GJ(t),i=r.Mo.get(n),!((a=r.Fo.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.Fo.set(i.targetId,a.filter(function(e){return!_X(e,n)})),void r.Mo.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,Z0(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),T2(r.remoteStore,i.targetId),Z3(r,i.targetId)}).catch(M0);case 9:e.next=14;break;case 11:return Z3(r,i.targetId),e.next=14,Z0(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L3(){return(L3=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=a4(t),e.prev=1,e.next=4,function(e,t){var n,r=GJ(e),i=oQ.now(),a=t.reduce(function(e,t){return e.add(t.key)},k1());return r.persistence.runTransaction("Locally write mutations","readwrite",function(e){return r.Wn.vn(e,a).next(function(a){n=a;var o,s=[],u=ip(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=jX(c,n.get(c.key));null!=l&&s.push(new JX(c.key,l,HQ(l.value.mapValue),HX.exists(!0)))}}catch(h){u.e(h)}finally{u.f()}return r.An.addMutationBatch(e,i,s,t)})}).then(function(e){return e.applyToLocalDocumentSet(n),{batchId:e.batchId,changes:n}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),s=i,u=a.batchId,c=r,l=void 0,(l=s.Ko[s.currentUser.toKey()])||(l=new u1(iQ)),l=l.insert(u,c),s.Ko[s.currentUser.toKey()]=l,e.next=9,X3(i,a.changes);case 9:return e.next=11,q2(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=l3(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}var s,u,c,l},e,null,[[1,13]])}))).apply(this,arguments)}function F3(e,t){return B3.apply(this,arguments)}function B3(){return(B3=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=GJ(t),e.prev=1,e.next=4,$0(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.Uo.get(t);n&&(HJ(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.$o=!0:e.modifiedDocuments.size>0?HJ(n.$o):e.removedDocuments.size>0&&(HJ(n.$o),n.$o=!1))}),e.next=8,X3(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,M0(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])}))).apply(this,arguments)}function U3(e,t,n){var r=GJ(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Mo.forEach(function(e,n){var r=n.view.ro(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=GJ(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=ip(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.ro(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}}),r&&C3(n)}(r.eventManager,t),i.length&&r.Oo.br(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function V3(e,t,n){return z3.apply(this,arguments)}function z3(){return(z3=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=GJ(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.Uo.get(n),!(o=a&&a.key)){e.next=14;break}return s=(s=new u1(PQ.comparator)).insert(o,GQ.newNoDocument(o,sQ.min())),u=k1().add(o),c=new C1(sQ.min(),new Map,new h1(iQ),s,u),e.next=9,F3(i,c);case 9:i.Bo=i.Bo.remove(o),i.Uo.delete(n),Q3(i),e.next=16;break;case 14:return e.next=16,Z0(i.localStore,n,!1).then(function(){return Z3(i,n,r)}).catch(M0);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function H3(e,t){return G3.apply(this,arguments)}function G3(){return(G3=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=GJ(t),i=n.batch.batchId,e.prev=1,e.next=4,G0(r.localStore,n);case 4:return a=e.sent,j3(r,i,null),W3(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,X3(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,M0(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function q3(e,t,n){return $3.apply(this,arguments)}function $3(){return($3=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=GJ(t),e.prev=1,e.next=4,function(e,t){var n=GJ(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.An.lookupMutationBatch(e,t).next(function(t){return HJ(null!==t),r=t.keys(),n.An.removeMutationBatch(e,t)}).next(function(){return n.An.performConsistencyCheck(e)}).next(function(){return n.Wn.vn(e,r)})})}(i.localStore,n);case 4:return a=e.sent,j3(i,n,r),W3(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,X3(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,M0(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function W3(e,t){(e.jo.get(t)||[]).forEach(function(e){e.resolve()}),e.jo.delete(t)}function j3(e,t,n){var r=GJ(e),i=r.Ko[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.Ko[r.currentUser.toKey()]=i}}function Z3(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=ip(e.Fo.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.Mo.delete(a),n&&e.Oo.zo(a,n)}}catch(o){i.e(o)}finally{i.f()}e.Fo.delete(t),e.isPrimaryClient&&e.qo.us(t).forEach(function(t){e.qo.containsKey(t)||Y3(e,t)})}function Y3(e,t){e.Lo.delete(t.path.canonicalString());var n=e.Bo.get(t);null!==n&&(T2(e.remoteStore,n),e.Bo=e.Bo.remove(t),e.Uo.delete(n),Q3(e))}function K3(e,t,n){var r,i=ip(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof E3?(e.qo.addReference(a.key,t),J3(e,a)):a instanceof S3?(FJ("SyncEngine","Document no longer in limbo: "+a.key),e.qo.removeReference(a.key,t),e.qo.containsKey(a.key)||Y3(e,a.key)):zJ()}}catch(o){i.e(o)}finally{i.f()}}function J3(e,t){var n=t.key,r=n.path.canonicalString();e.Bo.get(n)||e.Lo.has(r)||(FJ("SyncEngine","New document in limbo: "+n),e.Lo.add(r),Q3(e))}function Q3(e){for(;e.Lo.size>0&&e.Bo.size<e.maxConcurrentLimboResolutions;){var t=e.Lo.values().next().value;e.Lo.delete(t);var n=new PQ(fQ.fromString(t)),r=e.Qo.next();e.Uo.set(r,new T3(n)),e.Bo=e.Bo.insert(n,r),O2(e.remoteStore,new O0(mX(hX(n.path)),r,2,tQ.I))}}function X3(e,t,n){return e4.apply(this,arguments)}function e4(){return(e4=aB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=GJ(t),a=[],o=[],s=[],e.t0=i.Mo.isEmpty(),e.t0){e.next=9;break}return i.Mo.forEach(function(e,t){s.push(i.Go(t,n,r).then(function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=B0.$n(t.targetId,e);o.push(n)}}))}),e.next=6,Promise.all(s);case 6:return i.Oo.br(a),e.next=9,(u=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=GJ(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return b0.forEach(n,function(t){return b0.forEach(t.kn,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return b0.forEach(t.xn,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),E0(e.t0)){e.next=10;break}throw e.t0;case 10:FJ("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=ip(n);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.targetId,o.fromCache||(u=r.qn.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),r.qn=r.qn.insert(s,c))}catch(l){i.e(l)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])})),function(e,t){return u.apply(this,arguments)})(i.localStore,o);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function t4(e,t){return n4.apply(this,arguments)}function n4(){return(n4=aB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=GJ(t)).currentUser.isEqual(n)){e.next=12;break}return FJ("SyncEngine","User change. New user:",n.toKey()),e.next=5,z0(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,(a=r).jo.forEach(function(e){e.forEach(function(e){e.reject(new $J(qJ.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.jo.clear(),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=12,X3(r,i.Gn);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function r4(e,t){var n=GJ(e),r=n.Uo.get(t);if(r&&r.$o)return k1().add(r.key);var i=k1(),a=n.Fo.get(t);if(!a)return i;var o,s=ip(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.Mo.get(u);i=i.unionWith(c.view.bo)}}catch(l){s.e(l)}finally{s.f()}return i}function i4(e){var t=GJ(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=F3.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=r4.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=V3.bind(null,t),t.Oo.br=_3.bind(null,t.eventManager),t.Oo.zo=w3.bind(null,t.eventManager),t}function a4(e){var t=GJ(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=H3.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=q3.bind(null,t),t}var o4=function(){function e(){sp(this,e),this.synchronizeTabs=!1}return cp(e,[{key:"initialize",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.k=p2(e.databaseInfo.databaseId),t.sharedClientState=t.Jo(e),t.persistence=t.Yo(e),n.next=5,t.persistence.start();case 5:t.gcScheduler=t.Xo(e),t.localStore=t.Zo(e);case 7:case"end":return n.stop()}},n)}))()}},{key:"Xo",value:function(e){return null}},{key:"Zo",value:function(e){return function(e,t,n,r){return new V0(e,t,n,r)}(this.persistence,new U0,e.initialUser,this.k)}},{key:"Yo",value:function(e){return new i2(o2.ks,this.k)}},{key:"Jo",value:function(e){return new u2}},{key:"terminate",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}},t)}))()}}]),e}(),s4=function(){function e(){sp(this,e)}return cp(e,[{key:"initialize",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=n.localStore,r.t0){r.next=12;break}return n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=function(e){return U3(n.syncEngine,e,1)},n.remoteStore.remoteSyncer.handleCredentialChange=t4.bind(null,n.syncEngine),r.next=12,function(e,t){return o3.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient);case 12:case"end":return r.stop()}},r)}))()}},{key:"createEventManager",value:function(e){return new p3}},{key:"createDatastore",value:function(e){var t=p2(e.databaseInfo.databaseId),n=new d2(e.databaseInfo);return new _2(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return U3(o.syncEngine,e,0)},a=l2.Pt()?new l2:new c2,new C2(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=e.initialUser,s=e.maxConcurrentLimboResolutions,u=t,c=new I3(n,r,i,a,o,s),u&&(c.Wo=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(e=aB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=GJ(t),FJ("RemoteStore","RemoteStore shutting down."),n.Gr.add(5),e.next=5,S2(n);case 5:n.Hr.shutdown(),n.Jr.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}(),u4=function(){function e(t){sp(this,e),this.observer=t,this.muted=!1}return cp(e,[{key:"next",value:function(e){this.observer.next&&this.ec(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.ec(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"nc",value:function(){this.muted=!0}},{key:"ec",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),c4=function(){function e(t,n,r,i){var a=this;sp(this,e);var o,s=this;this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=NJ.UNAUTHENTICATED,this.clientId=rQ.A(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,(o=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return FJ("FirestoreClient","Received user=",t.uid),e.next=3,s.authCredentialListener(t);case 3:s.user=t;case 4:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})),this.appCheckCredentials.start(r,function(e){return FJ("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)})}return cp(e,[{key:"getConfiguration",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}},t)}))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new $J(qJ.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new WJ;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=l3(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function l4(e,t){return h4.apply(this,arguments)}function h4(){return(h4=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),FJ("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,z0(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f4(e,t){return d4.apply(this,arguments)}function d4(){return(d4=aB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,v4(t);case 3:return r=e.sent,FJ("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return i3(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return i3(n.remoteStore,t)}),t.onlineComponents=n;case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v4(e){return p4.apply(this,arguments)}function p4(){return(p4=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return FJ("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,l4(t,new o4);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g4(e){return y4.apply(this,arguments)}function y4(){return(y4=aB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return FJ("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,f4(t,new s4);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m4(e){return k4.apply(this,arguments)}function k4(){return(k4=aB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g4(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=x3.bind(null,n.syncEngine),r.onUnlisten=M3.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var _4=cp(function e(t,n,r,i,a,o,s,u){sp(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u}),w4=function(){function e(t,n){sp(this,e),this.projectId=t,this.database=n||"(default)"}return cp(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}]),e}(),C4=new Map;function b4(e,t,n){if(!n)throw new $J(qJ.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function E4(e){if(!PQ.isDocumentKey(e))throw new $J(qJ.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function S4(e){if(PQ.isDocumentKey(e))throw new $J(qJ.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function P4(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":zJ()}function O4(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new $J(qJ.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=P4(e);throw new $J(qJ.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var T4=function(){function e(t){var n;if(sp(this,e),void 0===t.host){if(void 0!==t.ssl)throw new $J(qJ.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new $J(qJ.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new $J(qJ.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return cp(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),I4=function(){function e(t,n,r){sp(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new T4({}),this._settingsFrozen=!1,t instanceof w4?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new $J(qJ.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new w4(e.options.projectId)}(t))}return cp(e,[{key:"app",get:function(){if(!this._app)throw new $J(qJ.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new $J(qJ.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new T4(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new ZJ;switch(e.type){case"gapi":var t=e.client;return HJ(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new QJ(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new $J(qJ.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=C4.get(e))&&(FJ("ComponentProvider","Removing Datastore"),C4.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}();var x4=function(){function e(t,n,r){sp(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return cp(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new R4(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),A4=function(){function e(t,n,r){sp(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return cp(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),R4=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r,hX(i)))._path=i,a.type="collection",a}return cp(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new x4(this.firestore,null,new PQ(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(A4);function N4(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=XB(e),1===arguments.length&&(t=rQ.A()),b4("doc","path",t),e instanceof I4){var a=fQ.fromString.apply(fQ,[t].concat(r));return E4(a),new x4(e,null,new PQ(a))}if(!(e instanceof x4||e instanceof R4))throw new $J(qJ.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(fQ.fromString.apply(fQ,[t].concat(r)));return E4(o),new x4(e.firestore,e instanceof R4?e.converter:null,new PQ(o))}var M4=function(){function e(){var t=this;sp(this,e),this.mc=Promise.resolve(),this.gc=[],this.yc=!1,this.Tc=[],this.Ec=null,this.Ic=!1,this.Ac=!1,this.Rc=[],this.ur=new g2(this,"async_queue_retry"),this.bc=function(){var e=v2();e&&FJ("AsyncQueue","Visibility state changed to "+e.visibilityState),t.ur.er()};var n=v2();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.bc)}return cp(e,[{key:"isShuttingDown",get:function(){return this.yc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Pc(),this.vc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.yc){this.yc=!0,this.Ac=e||!1;var t=v2();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.bc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Pc(),this.yc)return new Promise(function(){});var n=new WJ;return this.vc(function(){return t.yc&&t.Ac?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.gc.push(e),t.Vc()})}},{key:"Vc",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.gc.length){t.next=14;break}return t.prev=1,t.next=4,e.gc[0]();case 4:e.gc.shift(),e.ur.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),E0(t.t0)){t.next=12;break}throw t.t0;case 12:FJ("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.gc.length>0&&e.ur.Zi(function(){return e.Vc()});case 14:case"end":return t.stop()}},t,null,[[1,8]])}))()}},{key:"vc",value:function(e){var t=this,n=this.mc.then(function(){return t.Ic=!0,e().catch(function(e){throw t.Ec=e,t.Ic=!1,BJ("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e;var n,r}).then(function(e){return t.Ic=!1,e})});return this.mc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Pc(),this.Rc.indexOf(e)>-1&&(t=0);var i=c3.createAndSchedule(this,e,t,n,function(e){return r.Sc(e)});return this.Tc.push(i),i}},{key:"Pc",value:function(){this.Ec&&zJ()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Dc",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.mc,t.next=3,n;case 3:if(n!==e.mc){t.next=0;break}case 4:case"end":return t.stop()}},t)}))()}},{key:"Cc",value:function(e){var t,n=ip(this.Tc);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Nc",value:function(e){var t=this;return this.Dc().then(function(){t.Tc.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=ip(t.Tc);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.Dc()})}},{key:"kc",value:function(e){this.Rc.push(e)}},{key:"Sc",value:function(e){var t=this.Tc.indexOf(e);this.Tc.splice(t,1)}}]),e}();function D4(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var a=i[r];if(a in n&&"function"==typeof n[a])return!0}return!1}(e)}var L4=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new M4,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return cp(n,[{key:"_terminate",value:function(){return this._firestoreClient||B4(this),this._firestoreClient.terminate()}}]),n}(I4);function F4(e){return e._firestoreClient||B4(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function B4(e){var t,n,r,i=e._freezeSettings(),a=(n=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new _4(e._databaseId,n,e._persistenceKey,(r=i).host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams));e._firestoreClient=new c4(e._authCredentials,e._appCheckCredentials,e._queue,a)}var U4=function(){function e(){sp(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new $J(qJ.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vQ(n)}return cp(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}(),V4=function(){function e(t){sp(this,e),this._byteString=t}return cp(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(gQ.fromBase64String(t))}catch(n){throw new $J(qJ.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}},{key:"fromUint8Array",value:function(t){return new e(gQ.fromUint8Array(t))}}]),e}(),z4=cp(function e(t){sp(this,e),this._methodName=t}),H4=function(){function e(t,n){if(sp(this,e),!isFinite(t)||t<-90||t>90)throw new $J(qJ.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new $J(qJ.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return cp(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return iQ(this._lat,e._lat)||iQ(this._long,e._long)}}]),e}(),G4=/^__.*__$/,q4=function(){function e(t,n,r){sp(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return cp(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new JX(e,this.data,this.fieldMask,t,this.fieldTransforms):new KX(e,this.data,t,this.fieldTransforms)}}]),e}(),$4=function(){function e(t,n,r){sp(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return cp(e,[{key:"toMutation",value:function(e,t){return new JX(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function W4(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw zJ()}}var j4=function(){function e(t,n,r,i,a,o){sp(this,e),this.settings=t,this.databaseId=n,this.k=r,this.ignoreUndefinedProperties=i,void 0===a&&this.xc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return cp(e,[{key:"path",get:function(){return this.settings.path}},{key:"$c",get:function(){return this.settings.$c}},{key:"Oc",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.k,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"Mc",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Oc({path:n,Fc:!1});return r.Lc(e),r}},{key:"Bc",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Oc({path:n,Fc:!1});return r.xc(),r}},{key:"Uc",value:function(e){return this.Oc({path:void 0,Fc:!0})}},{key:"qc",value:function(e){return o5(e,this.settings.methodName,this.settings.Kc||!1,this.path,this.settings.jc)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.Lc(this.path.get(e))}},{key:"Lc",value:function(e){if(0===e.length)throw this.qc("Document fields must not be empty");if(W4(this.$c)&&G4.test(e))throw this.qc('Document fields cannot begin and end with "__"')}}]),e}(),Z4=function(){function e(t,n,r){sp(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.k=r||p2(t)}return cp(e,[{key:"Qc",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new j4({$c:e,methodName:t,jc:n,path:vQ.emptyPath(),Fc:!1,Kc:r},this.databaseId,this.k,this.ignoreUndefinedProperties)}}]),e}();function Y4(e){var t=e._freezeSettings(),n=p2(e._databaseId);return new Z4(e._databaseId,!!t.ignoreUndefinedProperties,n)}function K4(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.Qc(a.merge||a.mergeFields?2:0,t,n,i);n5("Data must be an object, but it was:",o,r);var s,u,c=e5(r,o);if(a.merge)s=new pQ(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l,h=[],f=ip(a.mergeFields);try{for(f.s();!(l=f.n()).done;){var d=l.value,v=r5(t,d,n);if(!o.contains(v))throw new $J(qJ.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));s5(h,v)||h.push(v)}}catch(p){f.e(p)}finally{f.f()}s=new pQ(h),u=o.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=o.fieldTransforms;return new q4(new zQ(c),s,u)}var J4=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.$c)throw e.qc(1===e.$c?"".concat(this._methodName,"() can only appear at the top level of your update data"):"".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(z4),Q4=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"_toFieldTransform",value:function(e){return new VX(e.path,new RX)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(z4);function X4(e,t){if(t5(e=XB(e)))return n5("Unsupported field value:",t,e),e5(e,t);if(e instanceof z4)return function(e,t){if(!W4(t.$c))throw t.qc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.qc("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Fc&&4!==t.$c)throw t.qc("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=ip(e);try{for(a.s();!(n=a.n()).done;){var o=X4(n.value,t.Uc(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=XB(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!SQ(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?OX(t):PX(e,t)}(t.k,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=oQ.fromDate(e);return{timestampValue:M1(t.k,n)}}if(e instanceof oQ){var r=new oQ(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:M1(t.k,r)}}if(e instanceof H4)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof V4)return{bytesValue:D1(t.k,e._byteString)};if(e instanceof x4){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.qc("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:B1(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.qc("Unsupported field value: ".concat(P4(e)))}(e,t)}function e5(e,t){var n={};return lQ(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):cQ(e,function(e,r){var i=X4(r,t.Mc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function t5(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof oQ||e instanceof H4||e instanceof V4||e instanceof x4||e instanceof z4)}function n5(e,t,n){if(!t5(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){var r=P4(n);throw t.qc("an object"===r?e+" a custom object":e+" "+r)}var i}function r5(e,t,n){if((t=XB(t))instanceof U4)return t._internalPath;if("string"==typeof t)return a5(e,t);throw o5("Field path arguments must be of type string or ",e,!1,void 0,n)}var i5=new RegExp("[~\\*/\\[\\]]");function a5(e,t,n){if(t.search(i5)>=0)throw o5("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return Wv(U4,np(t.split(".")))._internalPath}catch(r){throw o5("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function o5(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new $J(qJ.INVALID_ARGUMENT,s+e+u)}function s5(e,t){return e.some(function(e){return e.isEqual(t)})}var u5=function(){function e(t,n,r,i,a){sp(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return cp(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new x4(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new c5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(l5("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),c5=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"data",value:function(){return jv(tp(n.prototype),"data",this).call(this)}}]),n}(u5);function l5(e,t){return"string"==typeof t?a5(e,t):t instanceof U4?t._internalPath:t._delegate._internalPath}var h5=function(){function e(t,n){sp(this,e),this.hasPendingWrites=t,this.fromCache=n}return cp(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),f5=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s){var u;return sp(this,n),(u=t.call(this,e,r,i,a,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return cp(n,[{key:"exists",value:function(){return jv(tp(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new d5(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(l5("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(u5),d5=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jv(tp(n.prototype),"data",this).call(this,e)}}]),n}(f5),v5=function(){function e(t,n,r,i){sp(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new h5(i.hasPendingWrites,i.fromCache),this.query=r}return cp(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new d5(n._firestore,n._userDataWriter,r.key,r,new h5(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new $J(qJ.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new d5(e._firestore,e._userDataWriter,t.doc.key,t.doc,new h5(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new d5(e._firestore,e._userDataWriter,t.doc.key,t.doc,new h5(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:p5(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function p5(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return zJ()}}function g5(e){if(dX(e)&&0===e.explicitOrderBy.length)throw new $J(qJ.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var y5=cp(function e(){sp(this,e)});var m5=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this)).zc=e,a.Hc=r,a.Jc=i,a.type="where",a}return cp(n,[{key:"_apply",value:function(e){var t,n,r,i=Y4(e.firestore),a=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new $J(qJ.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){C5(o,a);var u,c=[],l=ip(o);try{for(l.s();!(u=l.n()).done;){var h=u.value;c.push(w5(r,e,h))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=w5(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||C5(o,a),s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return X4(n,e.Qc(r?4:3,t))}(n,"where",o,"in"===a||"not-in"===a);var f=YQ.create(i,a,s);return function(e,t){if(t.V()){var n=pX(e);if(null!==n&&!n.isEqual(t.field))throw new $J(qJ.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=vX(e);null!==r&&b5(0,t.field,r)}var i=function(e,t){var n,r=ip(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new $J(qJ.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter."):"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,f),f}(e._query,0,i,e.firestore._databaseId,this.zc,this.Hc,this.Jc);return new A4(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new lX(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(y5);var k5=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).zc=e,i.Yc=r,i.type="orderBy",i}return cp(n,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new $J(qJ.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new $J(qJ.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new oX(t,n);return function(e,t){if(null===vX(e)){var n=pX(e);null!==n&&b5(0,n,t.field)}}(e,r),r}(e._query,this.zc,this.Yc);return new A4(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new lX(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(y5);var _5=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this)).type=e,a.Xc=r,a.Zc=i,a}return cp(n,[{key:"_apply",value:function(e){return new A4(e.firestore,e.converter,kX(e._query,this.Xc,this.Zc))}}]),n}(y5);function w5(e,t,n){if("string"==typeof(n=XB(n))){if(""===n)throw new $J(qJ.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gX(t)&&-1!==n.indexOf("/"))throw new $J(qJ.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(fQ.fromString(n));if(!PQ.isDocumentKey(r))throw new $J(qJ.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return MQ(e,new PQ(r))}if(n instanceof x4)return MQ(e,n._key);throw new $J(qJ.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(P4(n),"."))}function C5(e,t){if(!Array.isArray(e)||0===e.length)throw new $J(qJ.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new $J(qJ.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function b5(e,t,n){if(!n.isEqual(t))throw new $J(qJ.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}function E5(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var S5=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).firestore=e,r}return cp(n,[{key:"convertBytes",value:function(e){return new V4(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new x4(this.firestore,null,t)}}]),n}(function(){function e(){sp(this,e)}return cp(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(OQ(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kQ(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_Q(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw zJ()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return cQ(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new H4(kQ(e.latitude),kQ(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=CQ(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(bQ(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=mQ(e);return new oQ(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=fQ.fromString(e);HJ(a0(n));var r=new w4(n.get(1),n.get(3)),i=new PQ(n.popFirst(5));return r.isEqual(t)||BJ("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}());function P5(e,t){return n=F4(e),r=t,i=new WJ,n.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n){return L3.apply(this,arguments)},e.next=3,function(e){return g4(e).then(function(e){return e.syncEngine})}(n);case 3:return e.t1=e.sent,e.t2=r,e.t3=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}},e)}))),i.promise;var n,r,i}function O5(e,t,n){var r=n.docs.get(t._key),i=new S5(e);return new f5(e,i,t._key,r,new h5(n.hasPendingWrites,n.fromCache),t.converter)}function T5(){return new Q4("serverTimestamp")}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];MJ="9.6.6",kU(new eU("firestore",function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new L4(i,new KJ(e.getProvider("auth-internal")),new eQ(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC")),PU(RJ,"3.4.4",e),PU(RJ,"3.4.4","esm2017")}();var I5=cp(function e(t){return sp(this,e),t}),x5=new fk("angularfire2.firestore-instances");function A5(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new I5(r)}}var R5={provide:cp(function e(){return sp(this,e),tG("firestore")}),deps:[[new Vk,x5]]},N5={provide:I5,useFactory:function(e,t){var n=eG("firestore",e,t);return n&&new I5(n)},deps:[[new Vk,x5],fG]},M5=function(){var e=cp(function e(){sp(this,e),PU("angularfire",KH.full,"fst")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({providers:[N5,R5]}),e}(),D5=hG(function(e,t){var n=O4(e.firestore,L4),r=N4(e),i=E5(e.converter,t);return P5(n,[K4(Y4(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,HX.exists(!1))]).then(function(){return r})},!0),L5=hG(function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=XB(e),b4("collection","path",t),e instanceof I4){var a=fQ.fromString.apply(fQ,[t].concat(r));return S4(a),new R4(e,null,a)}if(!(e instanceof x4||e instanceof R4))throw new $J(qJ.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(fQ.fromString.apply(fQ,[t].concat(r)));return S4(o),new R4(e.firestore,null,o)},!0),F5=hG(function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=O4(e,I4))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&UJ("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,s;if("string"==typeof i.mockUserToken)o=i.mockUserToken,s=NJ.MOCK_USER;else{o=bB(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new $J(qJ.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new NJ(u)}e._authCredentials=new YJ(new jJ(o,s))}},!0),B5=hG(function(e){return P5(O4(e.firestore,L4),[new r1(e._key,HX.none())])},!0),U5=hG(N4,!0),V5=hG(function(e){e=O4(e,x4);var t=O4(e.firestore,L4);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new WJ;return e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new u4({next:function(a){t.enqueueAndForget(function(){return m3(e,o)});var s=a.docs.has(n);!s&&a.fromCache?i.reject(new $J(qJ.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new $J(qJ.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new b3(hX(n.path),a,{includeMetadataChanges:!0,wo:!0});return g3(e,o)},i.next=3,m4(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(F4(t),e._key).then(function(n){return O5(t,e,n)})},!0),z5=hG(function(e){e=O4(e,A4);var t=O4(e.firestore,L4),n=F4(t),r=new S5(t);return g5(e._query),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new WJ;return e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new u4({next:function(n){t.enqueueAndForget(function(){return m3(e,o)}),n.fromCache&&"server"===r.source?i.reject(new $J(qJ.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new b3(n,a,{includeMetadataChanges:!0,wo:!0});return g3(e,o)},i.next=3,m4(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(n,e._query).then(function(n){return new v5(t,r,e,n)})},!0),H5=hG(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EU();return _U(e,"firestore").getImmediate()},!0),G5=hG(function(e){return function(e,t){if(t<=0)throw new $J(qJ.INVALID_ARGUMENT,"Function ".concat("limit","() requires a positive number, but it was: ").concat(t,"."))}(0,e),new _5("limit",e,"F")},!0),q5=hG(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=XB(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||D4(n[u])||(s=n[u],u++);var c,l,h,f={includeMetadataChanges:s.includeMetadataChanges};if(D4(n[u])){var d=n[u];n[u]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[u+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof x4)l=O4(e.firestore,L4),h=hX(e._key.path),c={next:function(t){n[u]&&n[u](O5(l,e,t))},error:n[u+1],complete:n[u+2]};else{var v=O4(e,A4);l=O4(v.firestore,L4),h=v._query;var p=new S5(l);c={next:function(e){n[u]&&n[u](new v5(l,p,v,e))},error:n[u+1],complete:n[u+2]},g5(e._query)}return function(e,t,n,r){var i=new u4(r),a=new b3(t,i,n);return e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=g3,t.next=3,m4(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.nc(),e.asyncQueue.enqueueAndForget(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=m3,t.next=3,m4(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(F4(l),h,f,c)},!0),$5=hG(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=l5("orderBy",e);return new k5(r,n)},!0),W5=hG(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e},!0),j5=hG(function(e,t,n){e=O4(e,x4);var r=O4(e.firestore,L4),i=E5(e.converter,t,n);return P5(r,[K4(Y4(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,HX.none())])},!0),Z5=hG(function(e,t,n){e=O4(e,x4);for(var r,i=O4(e.firestore,L4),a=Y4(i),o=arguments.length,s=new Array(o>3?o-3:0),u=3;u<o;u++)s[u-3]=arguments[u];return r="string"==typeof(t=XB(t))||t instanceof U4?function(e,t,n,r,i,a){var o=e.Qc(1,t,n),s=[r5(t,r,n)],u=[i];if(a.length%2!=0)throw new $J(qJ.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(r5(t,a[c])),u.push(a[c+1]);for(var l=[],h=zQ.empty(),f=s.length-1;f>=0;--f)if(!s5(l,s[f])){var d=s[f],v=u[f];v=XB(v);var p=o.Bc(d);if(v instanceof J4)l.push(d);else{var g=X4(v,p);null!=g&&(l.push(d),h.set(d,g))}}var y=new pQ(l);return new $4(h,y,o.fieldTransforms)}(a,"updateDoc",e._key,t,n,s):function(e,t,n,r){var i=e.Qc(1,t,n);n5("Data must be an object, but it was:",i,r);var a=[],o=zQ.empty();cQ(r,function(e,r){var s=a5(t,e,n);r=XB(r);var u=i.Bc(s);if(r instanceof J4)a.push(s);else{var c=X4(r,u);null!=c&&(a.push(s),o.set(s,c))}});var s=new pQ(a);return new $4(o,s,i.fieldTransforms)}(a,"updateDoc",e._key,t),P5(i,[r.toMutation(e._key,HX.exists(!0))])},!0),Y5=hG(function(e,t,n){var r=t,i=l5("where",e);return new m5(i,r,n)},!0),K5=function(){var e=function(){function e(t,n){sp(this,e),this.collectionName=t,this.firestore=n,this.subDAOs={},this.collection=L5(n,this.collectionName).withConverter({fromFirestore:function(e){return e.data()},toFirestore:function(e){return e}})}return cp(e,[{key:"create",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,D5(t.collection,e);case 2:return n.abrupt("return",n.sent.id);case 3:case"end":return n.stop()}},n)}))()}},{key:"read",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,V5(U5(t.collection,e));case 2:return r=n.sent,n.abrupt("return",r.exists()?hB.of(oB.getNonNullable(r.data())):hB.empty());case 4:case"end":return n.stop()}},n)}))()}},{key:"exists",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.read(e);case 2:return n.abrupt("return",n.sent.isPresent());case 3:case"end":return n.stop()}},n)}))()}},{key:"update",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Z5(U5(n.collection,e),t));case 1:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){return B5(U5(this.collection,e))}},{key:"set",value:function(t,n){return sB(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),j5(U5(this.collection,t),n)}},{key:"subscribeToChanges",value:function(e,t){return q5(U5(this.collection,e),function(e){t(hB.ofNullable(e.data()))})}},{key:"findWhere",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.constructQuery(e,t,n),i.next=3,z5(a);case 3:return i.abrupt("return",i.sent.docs.map(function(e){return{id:e.id,data:e.data()}}));case 4:case"end":return i.stop()}},i)}))()}},{key:"observingWhere",value:function(t,n,r){var i=this,a=this.constructQuery(t,r);return q5(a,function(t){var r=[],a=[],o=[];t.docChanges().forEach(function(e){var t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":a.push(t);break;case"removed":o.push(t)}}),r.length>0&&(sB(e.VERBOSE,"firebase gave us "+r.length+" NEW "+i.collectionName),n.onDocumentCreated(r)),a.length>0&&(sB(e.VERBOSE,"firebase gave us "+a.length+" MODIFIED "+i.collectionName),n.onDocumentModified(a)),o.length>0&&(sB(e.VERBOSE,"firebase gave us "+o.length+" DELETED "+i.collectionName),n.onDocumentDeleted(o))})}},{key:"constructQuery",value:function(e,t,n){var r=W5(this.collection);null!=t&&(r=W5(r,$5(t))),null!=n&&(r=W5(r,G5(n)));var i,a=ip(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;r=W5(r,Y5(o[0],o[1],o[2]))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"subCollectionDAO",value:function(t,n){var r="".concat(this.collection.path,"/").concat(t,"/").concat(n);if(r in this.subDAOs)return this.subDAOs[r];var i=new(function(e){Yv(n,e);var t=Jv(n);function n(e){return sp(this,n),t.call(this,r,e)}return cp(n)}(e))(this.firestore);return this.subDAOs[r]=i,i}}]),e}();return e.VERBOSE=!1,e}(),J5=function(){function e(){sp(this,e)}return cp(e,[{key:"equals",value:function(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&lB(this.get(),e.get())}}],[{key:"success",value:function(e){return new Q5(e)}},{key:"failure",value:function(e){return new X5(e)}}]),e}(),Q5=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).value=e,r}return cp(n,[{key:"isSuccess",value:function(){return!0}},{key:"isFailure",value:function(){return!1}},{key:"get",value:function(){return this.value}},{key:"getReason",value:function(){throw new Error("Cannot get failure reason from a success")}},{key:"getReasonOr",value:function(e){return e}},{key:"toOptional",value:function(){return hB.of(this.value)}},{key:"toString",value:function(){return"MGPFallible.success(".concat(this.value,")")}}]),n}(J5),X5=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).reason=e,r}return cp(n,[{key:"isSuccess",value:function(){return!1}},{key:"isFailure",value:function(){return!0}},{key:"get",value:function(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}},{key:"getReason",value:function(){return this.reason}},{key:"getReasonOr",value:function(e){return this.getReason()}},{key:"toOptional",value:function(){return hB.empty()}},{key:"toString",value:function(){return"MGPFallible.failure(".concat(this.reason,")")}}]),n}(J5),e6=function(){function e(t){sp(this,e),this.reason=t}return cp(e,[{key:"isFailure",value:function(){return!1===this.isSuccess()}},{key:"isSuccess",value:function(){return null==this.reason}},{key:"getReason",value:function(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}},{key:"toFallible",value:function(e){return this.isSuccess()?J5.success(e):J5.failure(this.getReason())}},{key:"toFailedFallible",value:function(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return J5.failure(this.getReason())}}],[{key:"ofFallible",value:function(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}},{key:"failure",value:function(t){return new e(t)}}]),e}();e6.SUCCESS=new e6(null);var t6=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){return sp(this,n),t.call(this,"errors",e)}return cp(n,[{key:"findErrors",value:function(e,t,n,r){return this.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}}]),n}(K5);return e.\u0275fac=function(t){return new(t||e)(Rk(I5))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),n6=qv(5378),r6=function(){var e=function(){function e(){sp(this,e)}return cp(e,[{key:"infoMessage",value:function(e){this.message(e,"is-info")}},{key:"gameMessage",value:function(e){this.message(e,"is-warning")}},{key:"criticalMessage",value:function(e){this.message(e,"is-danger")}},{key:"message",value:function(e,t){(0,n6.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),i6=function(){function t(e,n,r){sp(this,t),this.errorDAO=e,this.router=n,this.messageDisplayer=r,t.setSingletonInstance(this)}return cp(t,[{key:"logError",value:function(t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s,u,c,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.messageDisplayer.criticalMessage($localize(e||(e=Vv(["An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible."])))),o=i.router.url,a.next=4,i.errorDAO.findErrors(t,o,n,r);case 4:if(0!==(s=a.sent).length){a.next=12;break}return u={component:t,route:o,message:n,firstEncounter:T5(),lastEncounter:T5(),occurences:1},null!=r&&(u.data=r),a.next=10,i.errorDAO.create(u);case 10:a.next=15;break;case 12:return c=s[0].id,l=s[0].data,a.next=15,i.errorDAO.update(c,{lastEncounter:T5(),occurences:l.occurences+1});case 15:case"end":return a.stop()}},a)}))()}}],[{key:"setSingletonInstance",value:function(e){t.singleton=hB.of(e)}},{key:"logErrorAndFail",value:function(e,n,r){throw t.logError(e,n,r),new Error("".concat(e,": ").concat(n," (extra data: ").concat(JSON.stringify(r),")"))}},{key:"logError",value:function(e,t,n){if(this.singleton.isAbsent())throw new Error("".concat(e,": ").concat(t," (extra data: ").concat(JSON.stringify(n),")"));return this.singleton.get().logError(e,t,n),e6.failure(e+": "+t)}}]),t}();function a6(e,t){if(!1===e)throw i6.logError("Assertion failure",t),new Error("Assertion failure: ".concat(t))}i6.singleton=hB.empty(),i6.\u0275fac=function(e){return new(e||i6)(Rk(t6),Rk(ZM),Rk(r6))},i6.\u0275prov=xg({token:i6,factory:i6.\u0275fac,providedIn:"root"});var o6=cp(function e(t){sp(this,e),this.value=t});o6.HARD_DRAW=new o6(0),o6.RESIGN=new o6(1),o6.ESCAPE=new o6(2),o6.VICTORY=new o6(3),o6.TIMEOUT=new o6(4),o6.UNACHIEVED=new o6(5),o6.AGREED_DRAW_BY_ZERO=new o6(6),o6.AGREED_DRAW_BY_ONE=new o6(7);var s6=function(){function e(t,n){sp(this,e),this.id=t,this.data=n}return cp(e,[{key:"getTurn",value:function(){return this.data.turn}},{key:"isHardDraw",value:function(){return this.data.result===o6.HARD_DRAW.value}},{key:"isAgreedDraw",value:function(){return this.data.result===o6.AGREED_DRAW_BY_ZERO.value||this.data.result===o6.AGREED_DRAW_BY_ONE.value}},{key:"getDrawAccepter",value:function(){return this.data.result===o6.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(a6(this.data.result===o6.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),oB.getNonNullable(this.data.playerOne))}},{key:"isWin",value:function(){return this.data.result===o6.VICTORY.value}},{key:"isTimeout",value:function(){return this.data.result===o6.TIMEOUT.value}},{key:"isResign",value:function(){return this.data.result===o6.RESIGN.value}},{key:"getWinner",value:function(){return hB.ofNullable(this.data.winner)}},{key:"getLoser",value:function(){return hB.ofNullable(this.data.loser)}},{key:"setWinnerAndLoser",value:function(t,n){return new e(this.id,Uv(Uv({},this.data),{},{winner:t,loser:n}))}}]),e}(),u6=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),r=t.call(this,"parties",e),sB(n.VERBOSE,"PartDAO.constructor"),r}return cp(n,[{key:"updateAndBumpIndex",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(r=Uv(Uv({},r),{},{lastUpdate:{index:n+1,player:t.value}}),i.update(e,r)));case 1:case"end":return a.stop()}},a)}))()}},{key:"observeActiveParts",value:function(e){return this.observingWhere([["result","==",o6.UNACHIEVED.value]],e)}},{key:"userHasActivePart",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.findWhere([["playerZero","==",e],["result","==",o6.UNACHIEVED.value]]);case 2:return r=n.sent,n.next=5,t.findWhere([["playerOne","==",e],["result","==",o6.UNACHIEVED.value]]);case 5:return i=n.sent,n.abrupt("return",r.length>0||i.length>0);case 7:case"end":return n.stop()}},n)}))()}}]),n}(K5);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Rk(I5))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),c6=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),r=t.call(this,"chats",e),sB(n.VERBOSE,"ChatDAO.constructor"),r}return cp(n,[{key:"addMessage",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.subCollectionDAO(e,"messages").create(t));case 1:case"end":return r.stop()}},r)}))()}},{key:"getLastMessages",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.subCollectionDAO(e,"messages").findWhere([],"postedTime",t));case 1:case"end":return r.stop()}},r)}))()}},{key:"subscribeToMessages",value:function(e,t){return this.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}}]),n}(K5);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Rk(I5))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),l6=function(){var e=cp(function e(){sp(this,e)});return e.CANNOT_SEND_MESSAGE=function(){return $localize(t||(t=Vv(["You're not allowed to send a message here."])))},e.FORBIDDEN_MESSAGE=function(){return $localize(n||(n=Vv(["This message is forbidden."])))},e}(),h6=function(){var e=function(){function e(t){sp(this,e),this.chatDAO=t,this.followedChatId=hB.empty(),sB(e.VERBOSE,"ChatService.constructor")}return cp(e,[{key:"startObserving",value:function(t,n){sB(e.VERBOSE,"ChatService.startObserving "+t),this.followedChatId.isAbsent()?(sB(e.VERBOSE,"[start watching chat "+t),this.followedChatId=hB.of(t),this.followedChatUnsubscribe=this.chatDAO.subscribeToMessages(t,n)):this.followedChatId.equalsValue(t)?i6.logErrorAndFail("ChatService","Already observing same chat",{chatId:t}):i6.logErrorAndFail("ChatService","Already observing another chat",{chatId:t,followedChatId:this.followedChatId.get()})}},{key:"stopObserving",value:function(){if(!this.isObserving())throw new Error("ChatService.stopObserving should not be called if not observing");sB(e.VERBOSE,"stopped watching chat "+this.followedChatId+"]"),this.followedChatId=hB.empty(),this.followedChatUnsubscribe()}},{key:"isObserving",value:function(){return this.followedChatId.isPresent()}},{key:"deleteChat",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(sB(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"createNewChat",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chatDAO.set(e,{}));case 1:case"end":return n.stop()}},n)}))()}},{key:"sendMessage",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!r.followedChatId.isAbsent()){i.next=2;break}return i.abrupt("return",e6.failure("Cannot send message if not observing chat"));case 2:if(a=r.followedChatId.get(),!1!==r.userCanSendMessage(e.name,a)){i.next=5;break}return i.abrupt("return",e6.failure(l6.CANNOT_SEND_MESSAGE()));case 5:if(!r.isForbiddenMessage(t)){i.next=7;break}return i.abrupt("return",e6.failure(l6.FORBIDDEN_MESSAGE()));case 7:return o={content:t,sender:e,postedTime:T5(),currentTurn:n},i.next=10,r.chatDAO.addMessage(a,o);case 10:return i.abrupt("return",e6.SUCCESS);case 11:case"end":return i.stop()}},i)}))()}},{key:"userCanSendMessage",value:function(e,t){return""!==e}},{key:"isForbiddenMessage",value:function(e){return""===e}},{key:"ngOnDestroy",value:function(){this.isObserving()&&this.stopObserving()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Rk(c6))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),f6=cp(function e(t,n,r){sp(this,e),this.onDocumentCreated=t,this.onDocumentModified=n,this.onDocumentDeleted=r}),d6=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),r=t.call(this,n.COLLECTION_NAME,e),sB(n.VERBOSE,"UserDAO.constructor"),r}return cp(n,[{key:"usernameIsAvailable",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.findWhere([["username","==",e]]);case 2:return n.t0=n.sent.length,n.abrupt("return",0===n.t0);case 4:case"end":return n.stop()}},n)}))()}},{key:"setUsername",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.update(e,{username:t});case 2:case"end":return r.stop()}},r)}))()}},{key:"markVerified",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.update(e,{verified:!0});case 2:case"end":return n.stop()}},n)}))()}},{key:"observeUserByUsername",value:function(e,t){return this.observingWhere([["username","==",e]],t)}},{key:"observeActiveUsers",value:function(e){return this.observingWhere([["state","==","online"],["verified","==",!0]],e)}},{key:"updatePresenceToken",value:function(e){return this.update(e,{last_changed:T5()})}}]),n}(K5);return e.VERBOSE=!1,e.COLLECTION_NAME="joueurs",e.\u0275fac=function(t){return new(t||e)(Rk(I5))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),v6=function(){var e=function(){function e(t){sp(this,e),this.userDAO=t,this.activeUsersBS=new nR([]),this.activeUsersObs=this.activeUsersBS.asObservable()}return cp(e,[{key:"startObserving",value:function(){var t=this;sB(e.VERBOSE,"ActiveUsersService.startObservingActiveUsers");var n=new f6(function(n){var r;sB(e.VERBOSE,"our DAO gave us "+n.length+" new user(s)");var i=(r=t.activeUsersBS.value).concat.apply(r,np(n));t.activeUsersBS.next(t.sort(i))},function(n){var r=t.activeUsersBS.value;sB(e.VERBOSE,"our DAO updated "+n.length+" user(s)");var i,a=ip(n);try{var o=function(){var e=i.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)}),r=t.sort(r)};for(a.s();!(i=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}t.activeUsersBS.next(r)},function(e){var n=t.activeUsersBS.value.filter(function(t){return!e.some(function(e){return e.id===t.id})});t.activeUsersBS.next(t.sort(n))});this.unsubscribe=this.userDAO.observeActiveUsers(n)}},{key:"stopObserving",value:function(){this.unsubscribe(),this.activeUsersBS.next([])}},{key:"sort",value:function(e){return e.sort(function(e,t){var n=oB.getNonNullable(e.data).last_changed,r=oB.getNonNullable(n).seconds,i=oB.getNonNullable(t.data).last_changed;return r-oB.getNonNullable(i).seconds})}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Rk(d6))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),p6=function(){var e=function(){function e(t,n){sp(this,e),this.activeUsersService=t,this.userDAO=n}return cp(e,[{key:"getActiveUsersObs",value:function(){return this.activeUsersService.startObserving(),this.activeUsersService.activeUsersObs}},{key:"unSubFromActiveUsersObs",value:function(){this.activeUsersService.stopObserving()}},{key:"observeUserByUsername",value:function(e,t){return this.userDAO.observeUserByUsername(e,t)}},{key:"observeUser",value:function(e,t){return this.userDAO.subscribeToChanges(e,t)}},{key:"getUserLastChanged",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.read(e);case 2:if(!(r=n.sent).isAbsent()){n.next=5;break}return n.abrupt("return",hB.empty());case 5:return i=r.get().last_changed,n.abrupt("return",(a6(null!=i,"should not receive a last_changed equal to null"),hB.of(i)));case 7:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(v6),Rk(d6))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),g6=function(e){Yv(n,e);var t=Jv(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$H;return sp(this,n),(e=t.call(this))._bufferSize=r,e._windowTime=i,e._timestampProvider=a,e._buffer=[],e._infiniteTimeWindow=!0,e._infiniteTimeWindow=i===1/0,e._bufferSize=Math.max(1,r),e._windowTime=Math.max(1,i),e}return cp(n,[{key:"next",value:function(e){var t=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,a=this._timestampProvider,o=this._windowTime;t||(r.push(e),!i&&r.push(a.now()+o)),this._trimBuffer(),jv(tp(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t}},{key:"_trimBuffer",value:function(){var e=this._bufferSize,t=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var a=t.now(),o=0,s=1;s<n.length&&n[s]<=a;s+=2)o=s;o&&n.splice(0,o+1)}}}]),n}(Fp),y6="@firebase/database",m6="",k6=function(){function e(t){sp(this,e),this.domStorage_=t,this.prefix_="firebase:"}return cp(e,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),LB(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:DB(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),e}(),_6=function(){function e(){sp(this,e),this.cache_={},this.isInMemoryStorage=!0}return cp(e,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return BB(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),e}(),w6=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new k6(t)}}catch(n){}return new _6},C6=w6("localStorage"),b6=w6("sessionStorage"),E6=new lU("@firebase/database"),S6=function(){var e=1;return function(){return e++}}(),P6=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,fB(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new jB;n.update(t);var r=n.digest();return pB.encodeByteArray(r)},O6=function e(){for(var t="",n=0;n<arguments.length;n++){var r=n<0||arguments.length<=n?void 0:arguments[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=e.apply(null,r):t+="object"==typeof r?LB(r):r,t+=" "}return t},T6=null,I6=!0,x6=function(){if(!0===I6&&(I6=!1,null===T6&&!0===b6.get("logging_enabled")&&(fB(!0,"Can't turn on custom loggers persistently."),E6.logLevel=aU.VERBOSE,T6=E6.log.bind(E6))),T6){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=O6.apply(null,t);T6(r)}},A6=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];x6.apply(void 0,[e].concat(n))}},R6=function(){var e="FIREBASE INTERNAL ERROR: "+O6.apply(void 0,arguments);E6.error(e)},N6=function(){var e="FIREBASE FATAL ERROR: ".concat(O6.apply(void 0,arguments));throw E6.error(e),new Error(e)},M6=function(){var e="FIREBASE WARNING: "+O6.apply(void 0,arguments);E6.warn(e)},D6=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},L6="[MIN_NAME]",F6="[MAX_NAME]",B6=function(e,t){if(e===t)return 0;if(e===L6||t===F6)return-1;if(t===L6||e===F6)return 1;var n=W6(e),r=W6(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},U6=function(e,t){return e===t?0:e<t?-1:1},V6=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+LB(t))},z6=function e(t){if("object"!=typeof t||null===t)return LB(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=LB(n[a]),i+=":",i+=e(t[n[a]]);return i+="}"},H6=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)r.push(e.substring(i,i+t>n?n:i+t));return r};function G6(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var q6=function(e){fB(!D6(e),"Invalid JSON number");var t,n,r,i,a,o=1023;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,1-o)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},$6=new RegExp("^-?(0*)\\d{1,10}$"),W6=function(e){if($6.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},j6=function(e){try{e()}catch(t){setTimeout(function(){throw M6("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},Z6=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},Y6=function(){function e(t,n){var r=this;sp(this,e),this.appName_=t,this.appCheckProvider=n,this.appCheck=null==n?void 0:n.getImmediate({optional:!0}),this.appCheck||null==n||n.get().then(function(e){return r.appCheck=e})}return cp(e,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise(function(n,r){setTimeout(function(){t.appCheck?t.getToken(e).then(n,r):n(null)},0)})}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(function(t){return t.addTokenListener(e)})}},{key:"notifyForInvalidToken",value:function(){M6('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" are invalid. This usually indicates your app was not initialized correctly.'))}}]),e}(),K6=function(){function e(t,n,r){var i=this;sp(this,e),this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(function(e){return i.auth_=e})}return cp(e,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(x6("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):new Promise(function(n,r){setTimeout(function(){t.auth_?t.getToken(e).then(n,r):n(null)},0)})}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(function(t){return t.addAuthTokenListener(e)})}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then(function(t){return t.removeAuthTokenListener(e)})}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',M6(e)}}]),e}(),J6=function(){var e=function(){function e(t){sp(this,e),this.accessToken=t}return cp(e,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),e}();return e.OWNER="owner",e}(),Q6=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,X6="long_polling",e8=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];sp(this,e),this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=C6.get("host:"+t)||this._host}return cp(e,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&C6.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){return"".concat(this.secure?"https://":"http://").concat(this.host,"/").concat(this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"")}}]),e}();function t8(e,t,n){var r;if(fB("string"==typeof t,"typeof type must == string"),fB("object"==typeof n,"typeof params must == object"),"websocket"===t)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==X6)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return G6(n,function(e,t){i.push(e+"="+t)}),r+i.join("&")}var n8=function(){function e(){sp(this,e),this.counters_={}}return cp(e,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;BB(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return kB(this.counters_)}}]),e}(),r8={},i8={};function a8(e){var t=e.toString();return r8[t]||(r8[t]=new n8),r8[t]}var o8=function(){function e(t){sp(this,e),this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return cp(e,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){var n=this,r=function(){var e=n.pendingResponses[n.currentResponseNum];delete n.pendingResponses[n.currentResponseNum];for(var t=function(t){e[t]&&j6(function(){n.onMessage_(e[t])})},r=0;r<e.length;++r)t(r);if(n.currentResponseNum===n.closeAfterResponse)return n.onClose&&(n.onClose(),n.onClose=null),"break";n.currentResponseNum++};for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}}}]),e}(),s8=function(){function e(t,n,r,i,a,o,s){var u=this;sp(this,e),this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=A6(t),this.stats_=a8(n),this.urlFn=function(e){return u.appCheckToken&&(e.ac=u.appCheckToken),t8(n,X6,e)}}return cp(e,[{key:"open",value:function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new o8(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!n.isClosed_){n.scriptTagHolder=new u8(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1],o=t[2];t[3],t[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===i)n.id=a,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,a)},function(){n.onClosed_()},n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&Q6.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,function(){})}})}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=LB(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=gB(t),r=H6(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},{key:"incrementIncomingBytes_",value:function(e){var t=LB(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){e.forceAllow_=!0}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!(!e.forceAllow_&&(e.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}}]),e}(),u8=function(){function e(t,n,r,i){sp(this,e),this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=S6(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(a='<script>document.domain="'+document.domain+'";<\/script>');var o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(s){x6("frame writing exception"),s.stack&&x6(s.stack),x6(s)}}return cp(e,[{key:"close",value:function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),r()})}},{key:"addTag",value:function(e,t){var n=this;setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;(!e||"loaded"===e||"complete"===e)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){x6("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}},Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||x6("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),e}(),c8=null;"undefined"!=typeof MozWebSocket?c8=MozWebSocket:"undefined"!=typeof WebSocket&&(c8=WebSocket);var l8=function(){var e=function(){function e(t,n,r,i,a,o,s){sp(this,e),this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=A6(this.connId),this.stats_=a8(n),this.connURL=e.connectionURL_(n,o,s,i),this.nodeAdmin=n.nodeAdmin}return cp(e,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,C6.set("previous_websocket_failure",!0);try{this.mySock=new c8(this.connURL,[],{headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}})}catch(i){this.log_("Error instantiating WebSocket.");var r=i.message||i.data;return r&&this.log_(r),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){C6.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=DB(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(fB(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=LB(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=H6(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r){var i={v:"5"};return"undefined"!=typeof location&&location.hostname&&Q6.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),t8(e,"websocket",i)}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==c8&&!e.forceDisallow_}},{key:"previouslyFailed",value:function(){return C6.isInMemoryStorage||!0===C6.get("previous_websocket_failure")}}]),e}();return e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),h8=function(){function e(t){sp(this,e),this.initTransports_(t)}return cp(e,[{key:"initTransports_",value:function(t){var n=l8&&l8.isAvailable(),r=n&&!l8.previouslyFailed();if(t.webSocketOnly&&(n||M6("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[l8];else{var i,a=this.transports_=[],o=ip(e.ALL_TRANSPORTS);try{for(o.s();!(i=o.n()).done;){var s=i.value;s&&s.isAvailable()&&a.push(s)}}catch(u){o.e(u)}finally{o.f()}}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[s8,l8]}}]),e}(),f8=function(){function e(t,n,r,i,a,o,s,u,c,l){sp(this,e),this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=A6("c:"+this.id+":"),this.transportManager_=new h8(n),this.log_("Connection created"),this.start_()}return cp(e,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=Z6(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){this.sendData_({t:"d",d:e})}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=V6("t",e),n=V6("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=V6("t",e),n=V6("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=V6("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?R6("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):R6("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&M6("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Z6(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Z6(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(C6.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),e}(),d8=function(){function e(){sp(this,e)}return cp(e,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),e}(),v8=function(){function e(t){sp(this,e),this.allowedEvents_=t,this.listeners_={},fB(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return cp(e,[{key:"trigger",value:function(e){if(Array.isArray(this.listeners_[e])){for(var t=np(this.listeners_[e]),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0;a<t.length;a++)t[a].callback.apply(t[a].context,r)}}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){fB(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)}}]),e}(),p8=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.call(this,["online"])).online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!SB()&&(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return cp(n,[{key:"getInitialEvent",value:function(e){return fB("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new n}}]),n}(v8),g8=function(){function e(t,n){if(sp(this,e),void 0===n){this.pieces_=t.split("/");for(var r=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}return cp(e,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),e}();function y8(){return new g8("")}function m8(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function k8(e){return e.pieces_.length-e.pieceNum_}function _8(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new g8(e.pieces_,t)}function w8(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function C8(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function b8(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new g8(t,0)}function E8(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof g8)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var a=t.split("/"),o=0;o<a.length;o++)a[o].length>0&&n.push(a[o]);return new g8(n,0)}function S8(e){return e.pieceNum_>=e.pieces_.length}function P8(e,t){var n=m8(e),r=m8(t);if(null===n)return t;if(n===r)return P8(_8(e),_8(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function O8(e,t){for(var n=C8(e,0),r=C8(t,0),i=0;i<n.length&&i<r.length;i++){var a=B6(n[i],r[i]);if(0!==a)return a}return n.length===r.length?0:n.length<r.length?-1:1}function T8(e,t){if(k8(e)!==k8(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function I8(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(k8(e)>k8(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var x8=cp(function e(t,n){sp(this,e),this.errorPrefix_=n,this.parts_=C8(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=JB(this.parts_[r]);A8(this)});function A8(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+R8(e))}function R8(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var N8,M8,D8=function(e){Yv(n,e);var t=Jv(n);function n(){var e,r,i;return sp(this,n),e=t.call(this,["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(i="visibilitychange",r="hidden"):void 0!==document.mozHidden?(i="mozvisibilitychange",r="mozHidden"):void 0!==document.msHidden?(i="msvisibilitychange",r="msHidden"):void 0!==document.webkitHidden&&(i="webkitvisibilitychange",r="webkitHidden")),e.visible_=!0,i&&document.addEventListener(i,function(){var t=!document[r];t!==e.visible_&&(e.visible_=t,e.trigger("visible",t))},!1),e}return cp(n,[{key:"getInitialEvent",value:function(e){return fB("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new n}}]),n}(v8),L8=1e3,F8=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s,u,c){var l;if(sp(this,n),(l=t.call(this)).repoInfo_=e,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=o,l.authTokenProvider_=s,l.appCheckTokenProvider_=u,l.authOverride_=c,l.id=n.nextPersistentConnectionId_++,l.log_=A6("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=L8,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.appCheckToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.invalidAppCheckTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return D8.getInstance().on("visible",l.onVisible_,Xv(l)),-1===e.host.indexOf("fblocal")&&p8.getInstance().on("online",l.onOnline_,Xv(l)),Qv(l)}return cp(n,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(LB(i)),fB(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){var t=this;this.initConnection_();var n=new CB,r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var e=t.outstandingGets_[a];void 0===e||i!==e||(delete t.outstandingGets_[a],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(a),n.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),fB(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),fB(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}},{key:"sendListen_",value:function(e){var t=this,r=e.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=r._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,function(o){var s=o.d,u=o.s;n.warnOnListenWarnings_(s,r),(t.listens.get(i)&&t.listens.get(i).get(a))===e&&(t.log_("listen response",o),"ok"!==u&&t.removeListen_(i,a),e.onComplete&&e.onComplete(u,s))})}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){(e&&40===e.length||function(e){var t=FB(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},function(){})}},{key:"tryAuth",value:function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=function(e){var t=FB(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)})}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),fB(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var a={p:t,d:n};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)})}},{key:"reportStats",value:function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,function(e){"ok"!==e.s&&t.log_("reportStats","Error sending stats: "+e.d)})}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+LB(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):R6("Unrecognized action received from server: "+LB(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;fB(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=L8,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=L8,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=L8),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var r,i,a,o,s,u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.shouldReconnect_()){t.next=21;break}return e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null,r=e.onDataMessage_.bind(e),i=e.onReady_.bind(e),a=e.onRealtimeDisconnect_.bind(e),o=e.id+":"+n.nextConnectionId_++,s=e.lastSessionId,u=!1,c=null,l=function(){c?c.close():(u=!0,a())},e.realtime_={close:l,sendRequest:function(e){fB(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(e)}},h=e.forceTokenRefresh_,e.forceTokenRefresh_=!1,t.prev=8,t.next=11,Promise.all([e.authTokenProvider_.getToken(h),e.appCheckTokenProvider_.getToken(h)]);case 11:f=t.sent,d=Hv(f,2),v=d[0],p=d[1],u?x6("getToken() completed but was canceled"):(x6("getToken() completed. Creating connection."),e.authToken_=v&&v.accessToken,e.appCheckToken_=p&&p.token,c=new f8(o,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,r,i,a,function(t){M6(t+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")},s)),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(8),e.log_("Failed to get token: "+t.t0),u||(e.repoInfo_.nodeAdmin&&M6(t.t0),l());case 21:case"end":return t.stop()}},t,null,[[8,18]])}))()}},{key:"interrupt",value:function(e){x6("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){x6("Resuming connection for reason: "+e),delete this.interruptReasons_[e],VB(this.interruptReasons_)&&(this.reconnectDelay_=L8,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map(function(e){return z6(e)}).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new g8(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){x6("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){x6("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e,t=ip(this.listens.values());try{for(t.s();!(e=t.n()).done;){var n,r=ip(e.value.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this.sendListen_(i)}}catch(u){r.e(u)}finally{r.f()}}}catch(u){t.e(u)}finally{t.f()}for(var a=0;a<this.outstandingPuts_.length;a++)this.outstandingPuts_[a]&&this.sendPut_(a);for(;this.onDisconnectRequestQueue_.length;){var o=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(o.action,o.pathString,o.data,o.onComplete)}for(var s=0;s<this.outstandingGets_.length;s++)this.outstandingGets_[s]&&this.sendGet_(s)}},{key:"sendConnectStats_",value:function(){var e={};e["sdk.js."+m6.replace(/\./g,"-")]=1,SB()?e["framework.cordova"]=1:OB()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=p8.getInstance().currentlyOnline();return VB(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"==typeof e&&BB(e,"w")){var n=UB(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();M6("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ".concat(r," at ").concat(i," to your security rules for better performance."))}}}}]),n}(d8);return e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(),B8=function(){function e(t,n){sp(this,e),this.name=t,this.node=n}return cp(e,null,[{key:"Wrap",value:function(t,n){return new e(t,n)}}]),e}(),U8=function(){function e(){sp(this,e)}return cp(e,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new B8(L6,e),r=new B8(L6,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return B8.MIN}}]),e}(),V8=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"compare",value:function(e,t){return B6(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw dB("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return B8.MIN}},{key:"maxPost",value:function(){return new B8(F6,N8)}},{key:"makePost",value:function(e,t){return fB("string"==typeof e,"KeyIndex indexValue must always be a string."),new B8(e,N8)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return N8},set:function(e){N8=e}}]),n}(U8),z8=new V8,H8=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;sp(this,e),this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=n?r(t.key,n):1,i&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return cp(e,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),e}(),G8=function(){var e=function(){function e(t,n,r,i,a){sp(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:q8.EMPTY_NODE,this.right=null!=a?a:q8.EMPTY_NODE}return cp(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return q8.EMPTY_NODE;var e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return q8.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight_",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),e}();return e.RED=!0,e.BLACK=!1,e}(),q8=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.EMPTY_NODE;sp(this,e),this.comparator_=t,this.root_=n}return cp(e,[{key:"insert",value:function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,G8.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,G8.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new H8(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new H8(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new H8(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new H8(this.root_,null,this.comparator_,!0,e)}}]),e}();function $8(e,t){return B6(e.name,t.name)}function W8(e,t){return B6(e,t)}q8.EMPTY_NODE=new(function(){function e(){sp(this,e)}return cp(e,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new G8(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),e}());var j8,Z8,Y8,K8,J8,Q8=function(e){return"number"==typeof e?"number:"+q6(e):"string:"+e},X8=function(e){if(e.isLeafNode()){var t=e.val();fB("string"==typeof t||"number"==typeof t||"object"==typeof t&&BB(t,".sv"),"Priority must be a string or number.")}else fB(e===M8||e.isEmpty(),"priority of unexpected type.");fB(e===M8||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},e7=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.__childrenNodeConstructor.EMPTY_NODE;sp(this,e),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,fB(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),X8(this.priorityNode_)}return cp(e,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(t){return new e(this.value_,t)}},{key:"getImmediateChild",value:function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(t){return S8(t)?this:".priority"===m8(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(t,n){var r=m8(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(fB(".priority"!==r||1===k8(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(_8(t),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Q8(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?q6(this.value_):this.value_,this.lazyHash_=P6(e)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(fB(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}},{key:"compareToLeafNode_",value:function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return fB(i>=0,"Unknown leaf type: "+n),fB(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return j8},set:function(e){j8=e}}]),e}();return e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}(),t7=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?B6(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return B8.MIN}},{key:"maxPost",value:function(){return new B8(F6,new e7("[PRIORITY-POST]",Y8))}},{key:"makePost",value:function(e,t){var n=Z8(e);return new B8(t,new e7("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),n}(U8)),n7=Math.log(2),r7=function(){function e(t){var n=this;sp(this,e),this.count=parseInt(Math.log(t+1)/n7,10),this.current_=this.count-1;var r=parseInt(Array(n.count+1).join("1"),2);this.bits_=t+1&r}return cp(e,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),e}(),i7=function(e,t,n,r){e.sort(t);var i=function t(r,i){var a,o,s=i-r;if(0===s)return null;if(1===s)return a=e[r],o=n?n(a):a,new G8(o,a.node,G8.BLACK,null,null);var u=parseInt(s/2,10)+r,c=t(r,u),l=t(u+1,i);return a=e[u],o=n?n(a):a,new G8(o,a.node,G8.BLACK,c,l)},a=function(t){for(var r=null,a=null,o=e.length,s=function(t,r){var a=o-t,s=o;o-=t;var c=i(a+1,s),l=e[a],h=n?n(l):l;u(new G8(h,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(a=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?s(h,G8.BLACK):(s(h,G8.BLACK),s(h,G8.RED))}return a}(new r7(e.length));return new q8(r||t,a)},a7={},o7=function(){function e(t,n){sp(this,e),this.indexes_=t,this.indexSet_=n}return cp(e,[{key:"get",value:function(e){var t=UB(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof q8?t:null}},{key:"hasIndex",value:function(e){return BB(this.indexSet_,e.toString())}},{key:"addIndex",value:function(t,n){fB(t!==z8,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,o=n.getIterator(B8.Wrap),s=o.getNext();s;)a=a||t.isDefinedOn(s.node),i.push(s),s=o.getNext();r=a?i7(i,t.getCompare()):a7;var u=t.toString(),c=Object.assign({},this.indexSet_);c[u]=t;var l=Object.assign({},this.indexes_);return l[u]=r,new e(l,c)}},{key:"addToIndexes",value:function(t,n){var r=this;return new e(zB(this.indexes_,function(e,i){var a=UB(r.indexSet_,i);if(fB(a,"Missing index implementation for "+i),e===a7){if(a.isDefinedOn(t.node)){for(var o=[],s=n.getIterator(B8.Wrap),u=s.getNext();u;)u.name!==t.name&&o.push(u),u=s.getNext();return o.push(t),i7(o,a.getCompare())}return a7}var c=n.get(t.name),l=e;return c&&(l=l.remove(new B8(t.name,c))),l.insert(t,t.node)}),this.indexSet_)}},{key:"removeFromIndexes",value:function(t,n){return new e(zB(this.indexes_,function(e){if(e===a7)return e;var r=n.get(t.name);return r?e.remove(new B8(t.name,r)):e}),this.indexSet_)}}],[{key:"Default",get:function(){return fB(a7&&t7,"ChildrenNode.ts has not been loaded"),K8=K8||new e({".priority":a7},{".priority":t7})}}]),e}(),s7=function(){var e=function(){function e(t,n,r){sp(this,e),this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&X8(this.priorityNode_),this.children_.isEmpty()&&fB(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return cp(e,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||J8}},{key:"updatePriority",value:function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?J8:t}},{key:"getChild",value:function(e){var t=m8(e);return null===t?this:this.getImmediateChild(t).getChild(_8(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(t,n){if(fB(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r,i,a=new B8(t,n);n.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(a,this.children_)):(r=this.children_.insert(t,n),i=this.indexMap_.addToIndexes(a,this.children_));var o=r.isEmpty()?J8:this.priorityNode_;return new e(r,o,i)}},{key:"updateChild",value:function(e,t){var n=m8(e);if(null===n)return t;fB(".priority"!==m8(e)||1===k8(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(_8(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(t){if(this.isEmpty())return null;var n={},r=0,i=0,a=!0;if(this.forEachChild(t7,function(o,s){n[o]=s.val(t),r++,a&&e.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1}),!t&&a&&i<2*r){var o=[];for(var s in n)o[s]=n[s];return o}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Q8(this.getPriority().val())+":"),this.forEachChild(t7,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":P6(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new B8(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new B8(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new B8(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,B8.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,B8.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===u7?-1:0}},{key:"withIndex",value:function(t){if(t===z8||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===z8||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(t7),r=t.getIterator(t7),i=n.getNext(),a=r.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=n.getNext(),a=r.getNext()}return null===i&&null===a}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===z8?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return J8||(J8=new e(new q8(W8),null,o7.Default))}}]),e}();return e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),u7=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.call(this,new q8(W8),s7.EMPTY_NODE,o7.Default)}return cp(n,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return s7.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),n}(s7));function c7(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return s7.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),fB(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new e7(e,c7(t));if(e instanceof Array){var n=s7.EMPTY_NODE;return G6(e,function(t,r){if(BB(e,t)&&"."!==t.substring(0,1)){var i=c7(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(t,i))}}),n.updatePriority(c7(t))}var r=[],i=!1;if(G6(e,function(e,t){if("."!==e.substring(0,1)){var n=c7(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new B8(e,n)))}}),0===r.length)return s7.EMPTY_NODE;var a=i7(r,$8,function(e){return e.name},W8);if(i){var o=i7(r,t7.getCompare());return new s7(a,c7(t),new o7({".priority":o},{".priority":t7}))}return new s7(a,c7(t),o7.Default)}Object.defineProperties(B8,{MIN:{value:new B8(L6,s7.EMPTY_NODE)},MAX:{value:new B8(F6,u7)}}),V8.__EMPTY_NODE=s7.EMPTY_NODE,e7.__childrenNodeConstructor=s7,function(e){M8=e}(u7),function(e){Y8=e}(u7),function(e){Z8=e}(c7);var l7=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).indexPath_=e,fB(!S8(e)&&".priority"!==m8(e),"Can't create PathIndex with empty path or .priority key"),r}return cp(n,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?B6(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=c7(e),r=s7.EMPTY_NODE.updateChild(this.indexPath_,n);return new B8(t,r)}},{key:"maxPost",value:function(){var e=s7.EMPTY_NODE.updateChild(this.indexPath_,u7);return new B8(F6,e)}},{key:"toString",value:function(){return C8(this.indexPath_,0).join("/")}}]),n}(U8),h7=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?B6(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return B8.MIN}},{key:"maxPost",value:function(){return B8.MAX}},{key:"makePost",value:function(e,t){var n=c7(e);return new B8(t,n)}},{key:"toString",value:function(){return".value"}}]),n}(U8));function f7(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var d7=function(){function e(){sp(this,e),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=t7}return cp(e,[{key:"hasStart",value:function(){return this.startSet_}},{key:"hasStartAfter",value:function(){return this.startAfterSet_}},{key:"hasEndBefore",value:function(){return this.endBeforeSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return fB(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return fB(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:L6}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return fB(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return fB(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:F6}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return fB(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===t7}},{key:"copy",value:function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}]),e}();function v7(e){var t,n={};return e.isDefault()||(e.index_===t7?t="$priority":e.index_===h7?t="$value":e.index_===z8?t="$key":(fB(e.index_ instanceof l7,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=LB(t),e.startSet_&&(n.startAt=LB(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+LB(e.indexStartName_))),e.endSet_&&(n.endAt=LB(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+LB(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function p7(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==t7&&(t.i=e.index_.toString()),t}var g7=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this)).repoInfo_=e,o.onDataUpdate_=r,o.authTokenProvider_=i,o.appCheckTokenProvider_=a,o.log_=A6("p:rest:"),o.listens_={},o}return cp(n,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,r,i){var a=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var s=n.getListenId_(e,r),u={};this.listens_[s]=u;var c=v7(e._queryParams);this.restRequest_(o+".json",c,function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&a.onDataUpdate_(o,n,!1,r),UB(a.listens_,s)===u)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})}},{key:"unlisten",value:function(e,t){var r=n.getListenId_(e,t);delete this.listens_[r]}},{key:"get",value:function(e){var t=this,n=v7(e._queryParams),r=e._path.toString(),i=new CB;return this.restRequest_(r+".json",n,function(e,n){var a=n;404===e&&(a=null,e=null),null===e?(t.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(function(i){var a=Hv(i,2),o=a[0],s=a[1];o&&o.accessToken&&(n.auth=o.accessToken),s&&s.token&&(n.ac=s.token);var u=(t.repoInfo_.secure?"https://":"http://")+t.repoInfo_.host+e+"?ns="+t.repoInfo_.namespace+qB(n);t.log_("Sending REST request for "+u);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(r&&4===c.readyState){t.log_("REST Response for "+u+" received. status:",c.status,"response:",c.responseText);var e=null;if(c.status>=200&&c.status<300){try{e=DB(c.responseText)}catch(n){M6("Failed to parse JSON response for "+u+": "+c.responseText)}r(null,e)}else 401!==c.status&&404!==c.status&&M6("Got unsuccessful REST response for "+u+" Status: "+c.status),r(c.status);r=null}},c.open("GET",u,!0),c.send()})}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(fB(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),n}(d8),y7=function(){function e(){sp(this,e),this.rootNode_=s7.EMPTY_NODE}return cp(e,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),e}();function m7(){return{value:null,children:new Map}}function k7(e,t,n){if(S8(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=m8(t);e.children.has(r)||e.children.set(r,m7()),k7(e.children.get(r),t=_8(t),n)}}function _7(e,t){if(S8(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(t7,function(t,n){k7(e,new g8(t),n)}),_7(e,t)}if(e.children.size>0){var r=m8(t);return t=_8(t),e.children.has(r)&&_7(e.children.get(r),t)&&e.children.delete(r),0===e.children.size}return!0}function w7(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(function(e,n){t(n,e)})}(e,function(e,r){w7(r,new g8(t.toString()+"/"+e),n)})}var C7=function(){function e(t){sp(this,e),this.collection_=t,this.last_=null}return cp(e,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&G6(this.last_,function(e,n){t[e]=t[e]-n}),this.last_=e,t}}]),e}(),b7=function(){function e(t,n){sp(this,e),this.server_=n,this.statsToReport_={},this.statsListener_=new C7(t);var r=1e4+2e4*Math.random();Z6(this.reportStats_.bind(this),Math.floor(r))}return cp(e,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;G6(t,function(t,i){i>0&&BB(e.statsToReport_,t)&&(n[t]=i,r=!0)}),r&&this.server_.reportStats(n),Z6(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),e}(),E7=(function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(E7||(E7={})),E7);function S7(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}var P7,O7=function(){function e(t,n,r){sp(this,e),this.path=t,this.affectedTree=n,this.revert=r,this.type=E7.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return cp(e,[{key:"operationForChild",value:function(t){if(S8(this.path)){if(null!=this.affectedTree.value)return fB(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new g8(t));return new e(y8(),n,this.revert)}return fB(m8(this.path)===t,"operationForChild called for unrelated child."),new e(_8(this.path),this.affectedTree,this.revert)}}]),e}(),T7=function(){function e(t,n,r){sp(this,e),this.source=t,this.path=n,this.snap=r,this.type=E7.OVERWRITE}return cp(e,[{key:"operationForChild",value:function(t){return S8(this.path)?new e(this.source,y8(),this.snap.getImmediateChild(t)):new e(this.source,_8(this.path),this.snap)}}]),e}(),I7=function(){function e(t,n,r){sp(this,e),this.source=t,this.path=n,this.children=r,this.type=E7.MERGE}return cp(e,[{key:"operationForChild",value:function(t){if(S8(this.path)){var n=this.children.subtree(new g8(t));return n.isEmpty()?null:n.value?new T7(this.source,y8(),n.value):new e(this.source,y8(),n)}return fB(m8(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,_8(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),e}(),x7=function(){function e(t,n,r){sp(this,e),this.node_=t,this.fullyInitialized_=n,this.filtered_=r}return cp(e,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(S8(e))return this.isFullyInitialized()&&!this.filtered_;var t=m8(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),e}();function A7(e,t,n,r,i,a){var o=r.filter(function(e){return e.type===n});o.sort(function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw dB("Should only compare child_ events.");var r=new B8(t.childName,t.snapshotNode),i=new B8(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)}),o.forEach(function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach(function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))})})}function R7(e,t){return{eventCache:e,serverCache:t}}function N7(e,t,n,r){return R7(new x7(t,n,r),e.serverCache)}function M7(e,t,n,r){return R7(e.eventCache,new x7(t,n,r))}function D7(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function L7(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var F7=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(P7||(P7=new q8(U6)),P7);sp(this,e),this.value=t,this.children=n}return cp(e,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:y8(),value:this.value};if(S8(e))return null;var n=m8(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(_8(e),t);return null!=i?{path:E8(new g8(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})}},{key:"subtree",value:function(t){if(S8(t))return this;var n=m8(t),r=this.children.get(n);return null!==r?r.subtree(_8(t)):new e(null)}},{key:"set",value:function(t,n){if(S8(t))return new e(n,this.children);var r=m8(t),i=(this.children.get(r)||new e(null)).set(_8(t),n),a=this.children.insert(r,i);return new e(this.value,a)}},{key:"remove",value:function(t){if(S8(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=m8(t),r=this.children.get(n);if(r){var i,a=r.remove(_8(t));return i=a.isEmpty()?this.children.remove(n):this.children.insert(n,a),null===this.value&&i.isEmpty()?new e(null):new e(this.value,i)}return this}},{key:"get",value:function(e){if(S8(e))return this.value;var t=m8(e),n=this.children.get(t);return n?n.get(_8(e)):null}},{key:"setTree",value:function(t,n){if(S8(t))return n;var r,i=m8(t),a=(this.children.get(i)||new e(null)).setTree(_8(t),n);return r=a.isEmpty()?this.children.remove(i):this.children.insert(i,a),new e(this.value,r)}},{key:"fold",value:function(e){return this.fold_(y8(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(E8(e,r),t)}),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,y8(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(S8(e))return null;var i=m8(e),a=this.children.get(i);return a?a.findOnPath_(_8(e),E8(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,y8(),t)}},{key:"foreachOnPath_",value:function(t,n,r){if(S8(t))return this;this.value&&r(n,this.value);var i=m8(t),a=this.children.get(i);return a?a.foreachOnPath_(_8(t),E8(n,i),r):new e(null)}},{key:"foreach",value:function(e){this.foreach_(y8(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal(function(n,r){r.foreach_(E8(e,n),t)}),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal(function(t,n){n.value&&e(t,n.value)})}}],[{key:"fromObject",value:function(t){var n=new e(null);return G6(t,function(e,t){n=n.set(new g8(e),t)}),n}}]),e}(),B7=function(){function e(t){sp(this,e),this.writeTree_=t}return cp(e,null,[{key:"empty",value:function(){return new e(new F7(null))}}]),e}();function U7(e,t,n){if(S8(t))return new B7(new F7(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,a=r.value,o=P8(i,t);return a=a.updateChild(o,n),new B7(e.writeTree_.set(i,a))}var s=new F7(n),u=e.writeTree_.setTree(t,s);return new B7(u)}function V7(e,t,n){var r=e;return G6(n,function(e,n){r=U7(r,E8(t,e),n)}),r}function z7(e,t){if(S8(t))return B7.empty();var n=e.writeTree_.setTree(t,new F7(null));return new B7(n)}function H7(e,t){return null!=G7(e,t)}function G7(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(P8(n.path,t)):null}function q7(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(t7,function(e,n){t.push(new B8(e,n))}):e.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new B8(e,n.value))}),t}function $7(e,t){if(S8(t))return e;var n=G7(e,t);return new B7(null!=n?new F7(n):e.writeTree_.subtree(t))}function W7(e){return e.writeTree_.isEmpty()}function j7(e,t){return Z7(y8(),e.writeTree_,t)}function Z7(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal(function(t,i){".priority"===t?(fB(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Z7(E8(e,t),i,n)}),!n.getChild(e).isEmpty()&&null!==r&&(n=n.updateChild(E8(e,".priority"),r)),n}function Y7(e,t){return o9(t,e)}function K7(e,t){if(e.snap)return I8(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&I8(E8(e.path,n),t))return!0;return!1}function J7(e){return e.visible}function Q7(e,t,n){for(var r=B7.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,s=void 0;if(a.snap)I8(n,o)?r=U7(r,s=P8(n,o),a.snap):I8(o,n)&&(s=P8(o,n),r=U7(r,y8(),a.snap.getChild(s)));else{if(!a.children)throw dB("WriteRecord should have .snap or .children");if(I8(n,o))r=V7(r,s=P8(n,o),a.children);else if(I8(o,n))if(S8(s=P8(o,n)))r=V7(r,y8(),a.children);else{var u=UB(a.children,m8(s));if(u){var c=u.getChild(_8(s));r=U7(r,y8(),c)}}}}}return r}function X7(e,t,n,r,i){if(r||i){var a=$7(e.visibleWrites,t);return!i&&W7(a)?n:i||null!=n||H7(a,y8())?j7(Q7(e.allWrites,function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(I8(e.path,t)||I8(t,e.path))},t),n||s7.EMPTY_NODE):null}var o=G7(e.visibleWrites,t);if(null!=o)return o;var s=$7(e.visibleWrites,t);return W7(s)?n:null!=n||H7(s,y8())?j7(s,n||s7.EMPTY_NODE):null}function e9(e,t,n,r){return X7(e.writeTree,e.treePath,t,n,r)}function t9(e,t){return function(e,t,n){var r=s7.EMPTY_NODE,i=G7(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(t7,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(n){var a=$7(e.visibleWrites,t);return n.forEachChild(t7,function(e,t){var n=j7($7(a,new g8(e)),t);r=r.updateImmediateChild(e,n)}),q7(a).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return q7($7(e.visibleWrites,t)).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}(e.writeTree,e.treePath,t)}function n9(e,t,n,r){return function(e,t,n,r,i){fB(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=E8(t,n);if(H7(e.visibleWrites,a))return null;var o=$7(e.visibleWrites,a);return W7(o)?i.getChild(n):j7(o,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function r9(e,t){return function(e,t){return G7(e.visibleWrites,t)}(e.writeTree,E8(e.treePath,t))}function i9(e,t,n){return function(e,t,n,r){var i=E8(t,n),a=G7(e.visibleWrites,i);return null!=a?a:r.isCompleteForChild(n)?j7($7(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function a9(e,t){return o9(E8(e.treePath,t),e.writeTree)}function o9(e,t){return{treePath:e,writeTree:t}}var s9,u9,c9=function(){function e(){sp(this,e),this.changeMap=new Map}return cp(e,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;fB("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),fB(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,f7(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,function(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,function(e,t){return{type:"child_added",snapshotNode:t,childName:e}}(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw dB("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,f7(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),e}(),l9=new(function(){function e(){sp(this,e)}return cp(e,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),e}()),h9=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;sp(this,e),this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}return cp(e,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new x7(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return i9(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:L7(this.viewCache_),i=function(e,t,n,r,i,a){return function(e,t,n,r,i,a,o){var s,u=$7(e.visibleWrites,t),c=G7(u,y8());if(null!=c)s=c;else{if(null==n)return[];s=j7(u,n)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=o.getCompare(),f=a?s.getReverseIteratorFrom(r,o):s.getIteratorFrom(r,o),d=f.getNext();d&&l.length<1;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(e.writeTree,e.treePath,t,n,0,i,a)}(this.writes_,r,t,0,n,e);return 0===i.length?null:i[0]}}]),e}();function f9(e,t,n,r,i,a){var o,s,u=t.eventCache;if(null!=r9(r,n))return t;if(S8(n))if(fB(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=L7(t),l=t9(r,c instanceof s7?c:s7.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,a)}else{var h=e9(r,L7(t));o=e.filter.updateFullNode(t.eventCache.getNode(),h,a)}else{var f=m8(n);if(".priority"===f){fB(1===k8(n),"Can't have a priority with additional path components");var d=u.getNode(),v=n9(r,n,d,s=t.serverCache.getNode());o=null!=v?e.filter.updatePriority(d,v):u.getNode()}else{var p,g=_8(n);if(u.isCompleteForChild(f)){s=t.serverCache.getNode();var y=n9(r,n,u.getNode(),s);p=null!=y?u.getNode().getImmediateChild(f).updateChild(g,y):u.getNode().getImmediateChild(f)}else p=i9(r,f,t.serverCache);o=null!=p?e.filter.updateChild(u.getNode(),f,p,g,i,a):u.getNode()}}return N7(t,o,u.isFullyInitialized()||S8(n),e.filter.filtersNodes())}function d9(e,t,n,r,i,a,o,s){var u,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(S8(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=m8(n);if(!c.isCompleteForPath(n)&&k8(n)>1)return t;var d=_8(n),v=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?l.updatePriority(c.getNode(),v):l.updateChild(c.getNode(),f,v,d,l9,null)}var p=M7(t,u,c.isFullyInitialized()||S8(n),l.filtersNodes());return f9(e,p,n,i,new h9(i,p,a),s)}function v9(e,t,n,r,i,a,o){var s,u,c=t.eventCache,l=new h9(i,t,a);if(S8(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),s=N7(t,u,!0,e.filter.filtersNodes());else{var h=m8(n);if(".priority"===h)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=N7(t,u,c.isFullyInitialized(),c.isFiltered());else{var f,d=_8(n),v=c.getNode().getImmediateChild(h);if(S8(d))f=r;else{var p=l.getCompleteChild(h);f=null!=p?".priority"===w8(d)&&p.getChild(b8(d)).isEmpty()?p:p.updateChild(d,r):s7.EMPTY_NODE}s=v.equals(f)?t:N7(t,e.filter.updateChild(c.getNode(),h,f,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return s}function p9(e,t){return e.eventCache.isCompleteForChild(t)}function g9(e,t,n){return n.foreach(function(e,n){t=t.updateChild(e,n)}),t}function y9(e,t,n,r,i,a,o,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,c=t;u=S8(n)?r:new F7(null).setTree(n,r);var l=t.serverCache.getNode();return u.children.inorderTraversal(function(n,r){if(l.hasChild(n)){var u=g9(0,t.serverCache.getNode().getImmediateChild(n),r);c=d9(e,c,new g8(n),u,i,a,o,s)}}),u.children.inorderTraversal(function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=g9(0,t.serverCache.getNode().getImmediateChild(n),r);c=d9(e,c,new g8(n),h,i,a,o,s)}}),c}function m9(e,t){var n=L7(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!S8(t)&&!n.getImmediateChild(m8(t)).isEmpty())?n.getChild(t):null}function k9(e,t,n,r){t.type===E7.MERGE&&null!==t.source.queryId&&(fB(L7(e.viewCache_),"We should always have a full cache before handling merges"),fB(D7(e.viewCache_),"Missing event cache, even though we have a server cache"));var i=e.viewCache_,a=function(e,t,n,r,i){var a,o,s=new c9;if(n.type===E7.OVERWRITE){var u=n;u.source.fromUser?a=v9(e,t,u.path,u.snap,r,i,s):(fB(u.source.fromServer,"Unknown source."),o=u.source.tagged||t.serverCache.isFiltered()&&!S8(u.path),a=d9(e,t,u.path,u.snap,r,i,o,s))}else if(n.type===E7.MERGE){var c=n;c.source.fromUser?a=function(e,t,n,r,i,a,o){var s=t;return r.foreach(function(r,u){var c=E8(n,r);p9(t,m8(c))&&(s=v9(e,s,c,u,i,a,o))}),r.foreach(function(r,u){var c=E8(n,r);p9(t,m8(c))||(s=v9(e,s,c,u,i,a,o))}),s}(e,t,c.path,c.children,r,i,s):(fB(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=y9(e,t,c.path,c.children,r,i,o,s))}else if(n.type===E7.ACK_USER_WRITE){var l=n;a=l.revert?function(e,t,n,r,i,a){var o;if(null!=r9(r,n))return t;var s,u=new h9(r,t,i),c=t.eventCache.getNode();if(S8(n)||".priority"===m8(n)){var l;if(t.serverCache.isFullyInitialized())l=e9(r,L7(t));else{var h=t.serverCache.getNode();fB(h instanceof s7,"serverChildren would be complete if leaf node"),l=t9(r,h)}l=l,s=e.filter.updateFullNode(c,l,a)}else{var f=m8(n),d=i9(r,f,t.serverCache);null==d&&t.serverCache.isCompleteForChild(f)&&(d=c.getImmediateChild(f)),(s=null!=d?e.filter.updateChild(c,f,d,_8(n),u,a):t.eventCache.getNode().hasChild(f)?e.filter.updateChild(c,f,s7.EMPTY_NODE,_8(n),u,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&((o=e9(r,L7(t))).isLeafNode()&&(s=e.filter.updateFullNode(s,o,a)))}return o=t.serverCache.isFullyInitialized()||null!=r9(r,y8()),N7(t,s,o,e.filter.filtersNodes())}(e,t,l.path,r,i,s):function(e,t,n,r,i,a,o){if(null!=r9(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(S8(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return d9(e,t,n,u.getNode().getChild(n),i,a,s,o);if(S8(n)){var c=new F7(null);return u.getNode().forEachChild(z8,function(e,t){c=c.set(new g8(e),t)}),y9(e,t,n,c,i,a,s,o)}return t}var l=new F7(null);return r.foreach(function(e,t){var r=E8(n,e);u.isCompleteForPath(r)&&(l=l.set(e,u.getNode().getChild(r)))}),y9(e,t,n,l,i,a,s,o)}(e,t,l.path,l.affectedTree,r,i,s)}else{if(n.type!==E7.LISTEN_COMPLETE)throw dB("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var a=t.serverCache;return f9(e,M7(t,a.getNode(),a.isFullyInitialized()||S8(n),a.isFiltered()),n,r,l9,i)}(e,t,n.path,r,s)}var h=s.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=D7(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(function(e){return{type:"value",snapshotNode:e}}(D7(t)))}}(t,a,h),{viewCache:a,changes:h}}(e.processor_,i,t,n,r);return function(e,t){fB(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),fB(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}(e.processor_,a.viewCache),fB(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=a.viewCache,function(e,t,n,r){return function(e,t,n,r){var i=[],a=[];return t.forEach(function(t){"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push(function(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}(t.childName,t.snapshotNode))}),A7(e,i,"child_removed",t,r,n),A7(e,i,"child_added",t,r,n),A7(e,i,"child_moved",a,r,n),A7(e,i,"child_changed",t,r,n),A7(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,e.eventRegistrations_)}(e,a.changes,a.viewCache.eventCache.getNode())}function _9(e,t,n,r){var i=t.source.queryId;if(null!==i){var a=e.views.get(i);return fB(null!=a,"SyncTree gave us an op for an invalid query."),k9(a,t,n,r)}var o,s=[],u=ip(e.views.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;s=s.concat(k9(c,t,n,r))}}catch(l){u.e(l)}finally{u.f()}return s}function w9(e,t){var n,r=null,i=ip(e.views.values());try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r||m9(a,t)}}catch(o){i.e(o)}finally{i.f()}return r}var C9=cp(function e(t){sp(this,e),this.listenProvider_=t,this.syncPointTree_=new F7(null),this.pendingWriteTree_={visibleWrites:B7.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map});function b9(e,t,n,r,i){return function(e,t,n,r,i){fB(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=U7(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?O9(e,new T7({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function E9(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){var n=e.allWrites.findIndex(function(e){return e.writeId===t});fB(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,o=e.allWrites.length-1;i&&o>=0;){var s=e.allWrites[o];s.visible&&(o>=n&&K7(s,r.path)?i=!1:I8(r.path,s.path)&&(a=!0)),o--}return!!i&&(a?(function(e){e.visibleWrites=Q7(e.allWrites,J7,y8()),e.lastWriteId=e.allWrites.length>0?e.allWrites[e.allWrites.length-1].writeId:-1}(e),!0):(r.snap?e.visibleWrites=z7(e.visibleWrites,r.path):G6(r.children,function(t){e.visibleWrites=z7(e.visibleWrites,E8(r.path,t))}),!0))}(e.pendingWriteTree_,t)){var i=new F7(null);return null!=r.snap?i=i.set(y8(),!0):G6(r.children,function(e){i=i.set(new g8(e),!0)}),O9(e,new O7(r.path,i,n))}return[]}function S9(e,t,n){return O9(e,new T7({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function P9(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,function(e,n){var r=w9(n,P8(e,t));if(r)return r});return X7(r,t,i,n,!0)}function O9(e,t){return T9(t,e.syncPointTree_,null,Y7(e.pendingWriteTree_,y8()))}function T9(e,t,n,r){if(S8(e.path))return I9(e,t,n,r);var i=t.get(y8());null==n&&null!=i&&(n=w9(i,y8()));var a=[],o=m8(e.path),s=e.operationForChild(o),u=t.children.get(o);if(u&&s){var c=n?n.getImmediateChild(o):null,l=a9(r,o);a=a.concat(T9(s,u,c,l))}return i&&(a=a.concat(_9(i,e,r,n))),a}function I9(e,t,n,r){var i=t.get(y8());null==n&&null!=i&&(n=w9(i,y8()));var a=[];return t.children.inorderTraversal(function(t,i){var o=n?n.getImmediateChild(t):null,s=a9(r,t),u=e.operationForChild(t);u&&(a=a.concat(I9(u,i,o,s)))}),i&&(a=a.concat(_9(i,e,r,n))),a}function x9(e,t){return e.tagToQueryMap.get(t)}function A9(e){var t=e.indexOf("$");return fB(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new g8(e.substr(0,t))}}function R9(e,t,n){var r=e.syncPointTree_.get(t);return fB(r,"Missing sync point for query tag that we're tracking"),_9(r,n,Y7(e.pendingWriteTree_,t),null)}var N9=function(){function e(t){sp(this,e),this.node_=t}return cp(e,[{key:"getImmediateChild",value:function(t){return new e(this.node_.getImmediateChild(t))}},{key:"node",value:function(){return this.node_}}]),e}(),M9=function(){function e(t,n){sp(this,e),this.syncTree_=t,this.path_=n}return cp(e,[{key:"getImmediateChild",value:function(t){var n=E8(this.path_,t);return new e(this.syncTree_,n)}},{key:"node",value:function(){return P9(this.syncTree_,this.path_)}}]),e}(),D9=function(e,t,n){return e&&"object"==typeof e?(fB(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?L9(e[".sv"],t,n):"object"==typeof e[".sv"]?F9(e[".sv"],t):void fB(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},L9=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:fB(!1,"Unexpected server value: "+e)}},F9=function(e,t,n){e.hasOwnProperty("increment")||fB(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&fB(!1,"Unexpected increment value: "+r);var i=t.node();if(fB(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!=typeof a?r:a+r},B9=function(e,t,n){return U9(e,new N9(t),n)};function U9(e,t,n){var r,i=e.getPriority().val(),a=D9(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,s=D9(o.getValue(),t,n);return s!==o.getValue()||a!==o.getPriority().val()?new e7(s,c7(a)):e}var u=e;return r=u,a!==u.getPriority().val()&&(r=r.updatePriority(new e7(a))),u.forEachChild(t7,function(e,i){var a=U9(i,t.getImmediateChild(e),n);a!==i&&(r=r.updateImmediateChild(e,a))}),r}var V9=cp(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};sp(this,e),this.name=t,this.parent=n,this.node=r});function z9(e,t){for(var n=t instanceof g8?t:new g8(t),r=e,i=m8(n);null!==i;){var a=UB(r.node.children,i)||{children:{},childCount:0};r=new V9(i,r,a),i=m8(n=_8(n))}return r}function H9(e){return e.node.value}function G9(e,t){e.node.value=t,Z9(e)}function q9(e){return e.node.childCount>0}function $9(e,t){G6(e.node.children,function(n,r){t(new V9(n,e,r))})}function W9(e,t,n,r){n&&!r&&t(e),$9(e,function(e){W9(e,t,!0,r)}),n&&r&&t(e)}function j9(e){return new g8(null===e.parent?e.name:j9(e.parent)+"/"+e.name)}function Z9(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===H9(e)&&!q9(e)}(n),i=BB(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Z9(e)):!r&&!i&&(e.node.children[t]=n.node,e.node.childCount++,Z9(e))}(e.parent,e.name,e)}var Y9=/[\[\].#$\/\u0000-\u001F\u007F]/,K9=/[\[\].#$\u0000-\u001F\u007F]/,J9=10485760,Q9=function(e){return"string"==typeof e&&0!==e.length&&!Y9.test(e)},X9=function(e){return"string"==typeof e&&0!==e.length&&!K9.test(e)},eee=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!D6(e)||e&&"object"==typeof e&&BB(e,".sv")},tee=function(e,t,n,r){r&&void 0===t||nee(KB(e,"value"),t,n)},nee=function e(t,n,r){var i=r instanceof g8?new x8(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+R8(i));if("function"==typeof n)throw new Error(t+"contains a function "+R8(i)+" with contents = "+n.toString());if(D6(n))throw new Error(t+"contains "+n.toString()+" "+R8(i));if("string"==typeof n&&n.length>J9/3&&JB(n)>J9)throw new Error(t+"contains a string greater than "+J9+" utf8 bytes "+R8(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var a=!1,o=!1;if(G6(n,function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(o=!0,!Q9(n)))throw new Error(t+" contains an invalid key ("+n+") "+R8(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=JB(t),A8(e)})(i,n),e(t,r,i),function(e){var t=e.parts_.pop();e.byteLength_-=JB(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)}),a&&o)throw new Error(t+' contains ".value" child '+R8(i)+" in addition to actual children.")}},ree=function(e,t,n,r){if(!(r&&void 0===n||X9(n)))throw new Error(KB(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},iee=function(e,t){if(".info"===m8(t))throw new Error(e+" failed = Can't modify data under /.info/")},aee=cp(function e(){sp(this,e),this.eventLists_=[],this.recursionDepth_=0});function oee(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],a=i.getPath();null!==n&&!T8(a,n.path)&&(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(i)}n&&e.eventLists_.push(n)}function see(e,t,n){oee(e,n),function(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];i&&(t(i.path)?(uee(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}(e,function(e){return I8(e,t)||I8(t,e)})}function uee(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();T6&&x6("event: "+n.toString()),j6(r)}}}var cee=function(){function e(t,n,r,i){sp(this,e),this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new aee,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=m7(),this.transactionQueueTree_=new V9,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return cp(e,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),e}();function lee(e){var t=e.infoData_.getNode(new g8(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function hee(e){return function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e}({timestamp:lee(e)})}function fee(e,t,n,r,i){e.dataUpdateCount++;var a=new g8(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(i)if(r){var s=zB(n,function(e){return c7(e)});o=function(e,t,n,r){var i=x9(e,r);if(i){var a=A9(i),o=a.path,s=a.queryId,u=P8(o,t),c=F7.fromObject(n);return R9(e,o,new I7(S7(s),u,c))}return[]}(e.serverSyncTree_,a,s,i)}else{var u=c7(n);o=function(e,t,n,r){var i=x9(e,r);if(null!=i){var a=A9(i),o=a.path,s=a.queryId,u=P8(o,t);return R9(e,o,new T7(S7(s),u,n))}return[]}(e.serverSyncTree_,a,u,i)}else if(r){var c=zB(n,function(e){return c7(e)});o=function(e,t,n){var r=F7.fromObject(n);return O9(e,new I7({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,c)}else{var l=c7(n);o=S9(e.serverSyncTree_,a,l)}var h=a;o.length>0&&(h=Cee(e,a)),see(e.eventQueue_,h,o)}function dee(e,t){vee(e,"connected",t),!1===t&&function(e){mee(e,"onDisconnectEvents");var t=hee(e),n=m7();w7(e.onDisconnect_,y8(),function(r,i){var a=function(e,t,n,r){return U9(t,new M9(n,e),r)}(r,i,e.serverSyncTree_,t);k7(n,r,a)});var r=[];w7(n,y8(),function(t,n){r=r.concat(S9(e.serverSyncTree_,t,n));var i=Oee(e,t);Cee(e,i)}),e.onDisconnect_=m7(),see(e.eventQueue_,y8(),r)}(e)}function vee(e,t,n){var r=new g8("/.info/"+t),i=c7(n);e.infoData_.updateSnapshot(r,i);var a=S9(e.infoSyncTree_,r,i);see(e.eventQueue_,r,a)}function pee(e){return e.nextWriteId_++}function gee(e,t,n){e.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&_7(e.onDisconnect_,t),kee(0,n,r,i)})}function yee(e,t,n,r){var i=c7(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),function(n,a){"ok"===n&&k7(e.onDisconnect_,t,i),kee(0,r,n,a)})}function mee(e){for(var t="",n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.persistentConnection_&&(t=e.persistentConnection_.id+":"),x6.apply(void 0,[t].concat(r))}function kee(e,t,n,r){t&&j6(function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var a=new Error(i);a.code=e,t(a)}})}function _ee(e,t,n){return P9(e.serverSyncTree_,t,n)||s7.EMPTY_NODE}function wee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||Pee(e,t),H9(t)){var n=Eee(e,t);fB(n.length>0,"Sending zero length transaction queue"),n.every(function(e){return 0===e.status})&&function(e,t,n){for(var r=n.map(function(e){return e.currentWriteId}),i=_ee(e,t,r),a=i,o=i.hash(),s=0;s<n.length;s++){var u=n[s];fB(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=P8(t,u.path);a=a.updateChild(c,u.currentOutputSnapshotRaw)}var l=a.val(!0),h=t;e.server_.put(h.toString(),l,function(r){mee(e,"transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var a=[],o=function(t){n[t].status=2,i=i.concat(E9(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&a.push(function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)}),n[t].unwatcher()},s=0;s<n.length;s++)o(s);Pee(e,z9(e.transactionQueueTree_,t)),wee(e,e.transactionQueueTree_),see(e.eventQueue_,t,i);for(var u=0;u<a.length;u++)j6(a[u])}else{if("datastale"===r)for(var c=0;c<n.length;c++)n[c].status=3===n[c].status?4:0;else{M6("transaction at "+h.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}Cee(e,t)}},o)}(e,j9(t),n)}else q9(t)&&$9(t,function(t){wee(e,t)})}function Cee(e,t){var n=bee(e,t),r=j9(n);return function(e,t,n){if(0!==t.length){for(var r=[],i=[],a=t.filter(function(e){return 0===e.status}).map(function(e){return e.currentWriteId}),o=function(o){var s=t[o],u=P8(n,s.path),c=void 0,l=!1;if(fB(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)l=!0,c=s.abortReason,i=i.concat(E9(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=25)l=!0,c="maxretry",i=i.concat(E9(e.serverSyncTree_,s.currentWriteId,!0));else{var h=_ee(e,s.path,a);s.currentInputSnapshot=h;var f=t[o].update(h.val());if(void 0!==f){nee("transaction failed: Data returned ",f,s.path);var d=c7(f);"object"==typeof f&&null!=f&&BB(f,".priority")||(d=d.updatePriority(h.getPriority()));var v=s.currentWriteId,p=hee(e),g=B9(d,h,p);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=g,s.currentWriteId=pee(e),a.splice(a.indexOf(v),1),i=(i=i.concat(b9(e.serverSyncTree_,s.path,g,s.currentWriteId,s.applyLocally))).concat(E9(e.serverSyncTree_,v,!0))}else l=!0,c="nodata",i=i.concat(E9(e.serverSyncTree_,s.currentWriteId,!0))}see(e.eventQueue_,n,i),i=[],l&&(t[o].status=2,setTimeout(t[o].unwatcher,Math.floor(0)),t[o].onComplete&&r.push("nodata"===c?function(){return t[o].onComplete(null,!1,t[o].currentInputSnapshot)}:function(){return t[o].onComplete(new Error(c),!1,null)}))},s=0;s<t.length;s++)o(s);Pee(e,e.transactionQueueTree_);for(var u=0;u<r.length;u++)j6(r[u]);wee(e,e.transactionQueueTree_)}}(e,Eee(e,n),r),r}function bee(e,t){var n,r=e.transactionQueueTree_;for(n=m8(t);null!==n&&void 0===H9(r);)r=z9(r,n),n=m8(t=_8(t));return r}function Eee(e,t){var n=[];return See(e,t,n),n.sort(function(e,t){return e.order-t.order}),n}function See(e,t,n){var r=H9(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);$9(t,function(t){See(e,t,n)})}function Pee(e,t){var n=H9(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,G9(t,n.length>0?n:void 0)}$9(t,function(t){Pee(e,t)})}function Oee(e,t){var n=j9(bee(e,t)),r=z9(e.transactionQueueTree_,t);return function(e,t,n){for(var r=e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,function(t){Tee(e,t)}),Tee(e,r),W9(r,function(t){Tee(e,t)}),n}function Tee(e,t){var n=H9(t);if(n){for(var r=[],i=[],a=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?(fB(a===o-1,"All SENT items should be at beginning of queue."),a=o,n[o].status=3,n[o].abortReason="set"):(fB(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(E9(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===a?G9(t,void 0):n.length=a+1,see(e.eventQueue_,j9(t),i);for(var s=0;s<r.length;s++)j6(r[s])}}var Iee=function(e,t){var n=xee(e),r=n.namespace;return"firebase.com"===n.domain&&N6(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==n.domain&&N6("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&M6("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new e8(n.host,n.secure,r,t,"ws"===n.scheme||"wss"===n.scheme,"",r!==n.subdomain),path:new g8(n.pathString)}},xee=function(e){var t="",n="",r="",i="",a="",o=!0,s="https",u=443;if("string"==typeof e){var c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}t+="/"+i}return t}(e.substring(l,h)));var f=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n,r=ip(e.split("&"));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(0!==i.length){var a=i.split("=");2===a.length?t[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):M6("Invalid query segment '".concat(i,"' in query '").concat(e,"'"))}}}catch(o){r.e(o)}finally{r.f()}return t}(e.substring(Math.min(e.length,h)));(c=t.indexOf(":"))>=0?(o="https"===s||"wss"===s,u=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var v=t.indexOf(".");r=t.substring(0,v).toLowerCase(),n=t.substring(v+1),a=r}"ns"in f&&(a=f.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:o,scheme:s,pathString:i,namespace:a}},Aee=function(){function e(t,n){sp(this,e),this._repo=t,this._path=n}return cp(e,[{key:"cancel",value:function(){var e=new CB;return gee(this._repo,this._path,e.wrapCallback(function(){})),e.promise}},{key:"remove",value:function(){iee("OnDisconnect.remove",this._path);var e=new CB;return yee(this._repo,this._path,null,e.wrapCallback(function(){})),e.promise}},{key:"set",value:function(e){iee("OnDisconnect.set",this._path),tee("OnDisconnect.set",e,this._path,!1);var t=new CB;return yee(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise}},{key:"setWithPriority",value:function(e,t){iee("OnDisconnect.setWithPriority",this._path),tee("OnDisconnect.setWithPriority",e,this._path,!1),function(e,t,n){if(D6(t))throw new Error(KB(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!eee(t))throw new Error(KB(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}("OnDisconnect.setWithPriority",t);var n=new CB;return function(e,t,n,r,i){var a=c7(n,r);e.server_.onDisconnectPut(t.toString(),a.val(!0),function(n,r){"ok"===n&&k7(e.onDisconnect_,t,a),kee(0,i,n,r)})}(this._repo,this._path,e,t,n.wrapCallback(function(){})),n.promise}},{key:"update",value:function(e){iee("OnDisconnect.update",this._path),function(e,t,n,r){var i=KB("OnDisconnect.update","values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var a=[];G6(t,function(e,t){var r=new g8(e);if(nee(i,t,E8(n,r)),".priority"===w8(r)&&!eee(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)}),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=C8(r=t[n]),a=0;a<i.length;a++)if((".priority"!==i[a]||a!==i.length-1)&&!Q9(i[a]))throw new Error(e+"contains an invalid key ("+i[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(O8);var o=null;for(n=0;n<t.length;n++){if(r=t[n],null!==o&&I8(o,r))throw new Error(e+"contains a path "+o.toString()+" that is ancestor of another path "+r.toString());o=r}}(i,a)}(0,e,this._path);var t=new CB;return function(e,t,n,r){if(VB(n))return x6("onDisconnect().update() called with empty data.  Don't do anything."),void kee(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,function(i,a){"ok"===i&&G6(n,function(n,r){var i=c7(r);k7(e.onDisconnect_,E8(t,n),i)}),kee(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise}}]),e}(),Ree=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,r,new d7,!1)}return cp(n,[{key:"parent",get:function(){var e=b8(this._path);return null===e?null:new n(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),n}(function(){function e(t,n,r,i){sp(this,e),this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=i}return cp(e,[{key:"key",get:function(){return S8(this._path)?null:w8(this._path)}},{key:"ref",get:function(){return new Ree(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=p7(this._queryParams),t=z6(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return p7(this._queryParams)}},{key:"isEqual",value:function(t){if(!((t=XB(t))instanceof e))return!1;var n=this._repo===t._repo,r=T8(this._path,t._path);return n&&r&&this._queryIdentifier===t._queryIdentifier}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),e}());(function(e){fB(!s9,"__referenceConstructor has already been defined"),s9=e})(Ree),function(e){fB(!u9,"__referenceConstructor has already been defined"),u9=e}(Ree);var Nee={};var Mee=function(){function e(t,n){sp(this,e),this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}return cp(e,[{key:"_repo",get:function(){return this._instanceStarted||(function(e,t,n){if(e.stats_=a8(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new g7(e.repoInfo_,function(t,n,r,i){fee(e,t,n,r,i)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(function(){return dee(e,!0)},0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{LB(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new F8(e.repoInfo_,t,function(t,n,r,i){fee(e,t,n,r,i)},function(t){dee(e,t)},function(t){!function(e,t){G6(t,function(t,n){vee(e,t,n)})}(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(function(t){e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(function(t){e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=function(e,t){var n=e.toString();return i8[n]||(i8[n]=t()),i8[n]}(e.repoInfo_,function(){return new b7(e.stats_,e.server_)}),e.infoData_=new y7,e.infoSyncTree_=new C9({startListening:function(t,n,r,i){var a=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(a=S9(e.infoSyncTree_,t._path,o),setTimeout(function(){i("ok")},0)),a},stopListening:function(){}}),vee(e,"connected",!1),e.serverSyncTree_=new C9({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,function(n,r){var a=i(n,r);see(e.eventQueue_,t._path,a)}),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new Ree(this._repo,y8())),this._rootInternal}},{key:"_delete",value:function(){return null!==this._rootInternal&&(function(e,t){var n=Nee[t];(!n||n[e.key]!==e)&&N6("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&N6("Cannot call "+e+" on a deleted database.")}}]),e}();var Dee={".sv":"timestamp"};function Lee(){return Dee}F8.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},F8.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},m6="9.6.6",kU(new eU("database",function(e,t){var n=t.instanceIdentifier;return function(e,t,n,r,i){var a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||N6("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),x6("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,s,u=Iee(a,i),c=u.repoInfo;"undefined"!=typeof process&&(s=process.env.FIREBASE_DATABASE_EMULATOR_HOST),s?(o=!0,a="http://".concat(s,"?ns=").concat(c.namespace),c=(u=Iee(a,i)).repoInfo):o=!u.repoInfo.secure;var l=i&&o?new J6(J6.OWNER):new K6(e.name,e.options,t);(function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Q9(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),X9(e)}(n))throw new Error(KB("Invalid Firebase Database URL","url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})(0,u),S8(u.path)||N6("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=Nee[t.name];i||(i={},Nee[t.name]=i);var a=i[e.toURLString()];return a&&N6("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new cee(e,!1,n,r),i[e.toURLString()]=a,a}(c,e,l,new Y6(e.name,n));return new Mee(h,e)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)},"PUBLIC").setMultipleInstances(!0)),PU(y6,"0.12.5",void 0),PU(y6,"0.12.5","esm2017");var Fee=cp(function e(t){return sp(this,e),t}),Bee=new fk("angularfire2.database-instances");function Uee(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new Fee(r)}}var Vee={provide:cp(function e(){return sp(this,e),tG("database")}),deps:[[new Vk,Bee]]},zee={provide:Fee,useFactory:function(e,t){var n=eG("database",e,t);return n&&new Fee(n)},deps:[[new Vk,Bee],fG]},Hee=function(){var e=cp(function e(){sp(this,e),PU("angularfire",KH.full,"rtdb")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({providers:[zee,Vee]}),e}(),Gee=hG(function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=XB(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&N6("Cannot call useEmulator() after instance has already been initialized.");var i,a=e._repoInternal;if(a.repoInfo_.nodeAdmin)r.mockUserToken&&N6('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new J6(J6.OWNER);else if(r.mockUserToken){var o="string"==typeof r.mockUserToken?r.mockUserToken:bB(r.mockUserToken,e.app.options.projectId);i=new J6(o)}!function(e,t,n,r){e.repoInfo_=new e8("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(a,t,n,i)},!0),qee=hG(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EU(),t=arguments.length>1?arguments[1]:void 0;return _U(e,"database").getImmediate({identifier:t})},!0),$ee=hG(function(e){return e=XB(e),new Aee(e._repo,e._path)},!0),Wee=hG(function(e,t){return(e=XB(e))._checkNotDeleted("ref"),void 0!==t?function(e,t){return null===m8((e=XB(e))._path)?((n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ree("child","path",n,!1)):ree("child","path",t,!1),new Ree(e._repo,E8(e._path,t));var n}(e._root,t):e._root},!0),jee=hG(function(e,t){e=XB(e),iee("set",e._path),tee("set",t,e._path,!1);var n=new CB;return function(e,t,n,r,i){mee(e,"set",{path:t.toString(),value:n,priority:null});var a=hee(e),o=c7(n,null),s=P9(e.serverSyncTree_,t),u=B9(o,s,a),c=pee(e),l=b9(e.serverSyncTree_,t,u,c,!0);oee(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),function(n,r){var a="ok"===n;a||M6("set at "+t+" failed: "+n);var o=E9(e.serverSyncTree_,c,!a);see(e.eventQueue_,t,o),kee(0,i,n,r)});var h=Oee(e,t);Cee(e,h),see(e.eventQueue_,h,[])}(e._repo,e._path,t,0,n.wrapCallback(function(){})),n.promise},!0),Zee=function(){function e(t){sp(this,e),this.db=t}return cp(e,[{key:"setOffline",value:function(t){return jee(Wee(this.db,"/status/"+t),e.OFFLINE)}},{key:"launchAutomaticPresenceUpdate",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=Wee(n.db,"/status/"+t),r.next=3,jee(i,e.ONLINE);case 3:return r.next=5,$ee(i).set(e.OFFLINE);case 5:case"end":return r.stop()}},r)}))()}}]),e}();Zee.OFFLINE={last_changed:Lee()},Zee.ONLINE={last_changed:Lee()},Zee.\u0275fac=function(e){return new(e||Zee)(Rk(Fee))},Zee.\u0275prov=xg({token:Zee,factory:Zee.\u0275fac,providedIn:"root"});var Yee=function(){function e(){sp(this,e)}return cp(e,null,[{key:"createUserWithEmailAndPassword",value:function(e,t,n){return kj(e,t,n)}},{key:"sendEmailVerification",value:function(e){return Cj(e)}},{key:"sendPasswordResetEmail",value:function(e,t){return bj(e,t)}},{key:"signInWithEmailAndPassword",value:function(e,t,n){return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ej(e,t,n);case 2:return r.abrupt("return",r.sent.user);case 3:case"end":return r.stop()}},r)}))()}},{key:"signInWithPopup",value:function(e,t){return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Sj(e,t);case 2:return n.abrupt("return",n.sent.user);case 3:case"end":return n.stop()}},n)}))()}},{key:"updateProfile",value:function(e,t){return Pj(e,t)}}]),e}(),Kee=function(){function e(t,n,r,i){sp(this,e),this.id=t,this.email=n,this.username=r,this.verified=i}return cp(e,[{key:"isConnected",value:function(){return this.email.isPresent()}},{key:"toMinimalUser",value:function(){return{id:this.id,name:this.username.get()}}}]),e}();Kee.NOT_CONNECTED=new Kee("",hB.empty(),hB.empty(),!1);var Jee=function(){var e=function(){function e(t,n,r){sp(this,e);var i,a=this;this.userDAO=t,this.auth=n,this.connectivityDAO=r,this.user=hB.empty(),this.userUnsubscribe=hB.empty(),sB(e.VERBOSE,"ConnectedUserService constructor"),this.userRS=new g6(1),this.userObs=this.userRS.asObservable(),this.unsubscribeFromAuth=wj(this.auth,(i=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n){t.next=4;break}sB(e.VERBOSE,"User is not connected"),a.userUnsubscribe.isPresent()&&a.userUnsubscribe.get()(),a.userRS.next(Kee.NOT_CONNECTED),a.user=hB.empty(),t.next=8;break;case 4:return a6(a.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),t.next=7,a.connectivityDAO.launchAutomaticPresenceUpdate(n.uid);case 7:a.userUnsubscribe=hB.of(a.userDAO.subscribeToChanges(n.uid,function(t){if(t.isPresent()){var r=t.get().username;sB(e.VERBOSE,"User ".concat(r," is connected, and the verified status is ").concat(a.emailVerified(n)));var i=!0===a.emailVerified(n)&&null!=r;if(!0===i&&!1===t.get().verified)return a.userDAO.markVerified(n.uid);var o=new Kee(n.uid,hB.ofNullable(n.email),hB.ofNullable(r),i);a.user=hB.of(o),a.userRS.next(o)}}));case 8:case"end":return t.stop()}},t)})),function(e){return i.apply(this,arguments)}))}return cp(e,[{key:"emailVerified",value:function(e){return e.emailVerified}},{key:"sendPasswordResetEmail",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Yee.sendPasswordResetEmail(t.auth,e);case 3:return n.abrupt("return",e6.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",e6.failure(t.mapFirebaseError(n.t0)));case 9:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"doRegister",value:function(t,n,i){var a=this;return aB(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return sB(e.VERBOSE,"ConnectedUserService.doRegister("+n+")"),o.next=3,a.userDAO.usernameIsAvailable(t);case 3:if(!o.sent){o.next=7;break}o.t0=a.registerAfterUsernameCheck(t,n,i),o.next=8;break;case 7:o.t0=J5.failure($localize(r||(r=Vv(["This username is already in use."]))));case 8:return o.abrupt("return",o.t0);case 9:case"end":return o.stop()}},o)}))()}},{key:"registerAfterUsernameCheck",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Yee.createUserWithEmailAndPassword(r.auth,t,n);case 3:return a=i.sent,o=oB.getNonNullable(a.user),i.next=7,r.createUser(o.uid,e);case 7:return i.abrupt("return",J5.success(o));case 10:return i.prev=10,i.t0=i.catch(0),i.abrupt("return",J5.failure(r.mapFirebaseError(i.t0)));case 13:case"end":return i.stop()}},i,null,[[0,10]])}))()}},{key:"mapFirebaseError",value:function(e){switch(e.code){case"auth/email-already-in-use":return $localize(i||(i=Vv(["This email address is already in use."])));case"auth/invalid-email":return $localize(a||(a=Vv(["This email address is invalid."])));case"auth/user-not-found":case"auth/wrong-password":return $localize(o||(o=Vv(["You have entered invalid credentials."])));case"auth/invalid-credential":return $localize(s||(s=Vv(["The credential is invalid or has expired, please try again."])));case"auth/weak-password":return $localize(u||(u=Vv(["Your password is too weak, please use a stronger password."])));case"auth/too-many-requests":return $localize(c||(c=Vv(["There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later."])));case"auth/popup-closed-by-user":return $localize(l||(l=Vv(["You closed the authentication popup without finalizing your log in."])));case"auth/popup-blocked":return $localize(h||(h=Vv(["The authentication popup was blocked. Try again after disabling popup blocking."])));default:return i6.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}},{key:"sendEmailVerification",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(sB(e.VERBOSE,"ConnectedUserService.sendEmailVerification()"),(r=hB.ofNullable(t.auth.currentUser)).isPresent()){n.next=4;break}return n.abrupt("return",i6.logError("ConnectedUserService","Unlogged users cannot request for email verification"));case 4:if(!t.emailVerified(r.get())){n.next=6;break}return n.abrupt("return",i6.logError("ConnectedUserService","Verified users should not ask email verification after being verified"));case 6:return n.prev=6,n.next=9,Yee.sendEmailVerification(r.get());case 9:return n.abrupt("return",e6.SUCCESS);case 12:return n.prev=12,n.t0=n.catch(6),n.abrupt("return",e6.failure(t.mapFirebaseError(n.t0)));case 15:case"end":return n.stop()}},n,null,[[6,12]])}))()}},{key:"doEmailLogin",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return sB(e.VERBOSE,"ConnectedUserService.doEmailLogin("+t+")"),i.prev=1,i.next=4,Yee.signInWithEmailAndPassword(r.auth,t,n);case 4:return i.abrupt("return",e6.SUCCESS);case 7:return i.prev=7,i.t0=i.catch(1),i.abrupt("return",e6.failure(r.mapFirebaseError(i.t0)));case 10:case"end":return i.stop()}},i,null,[[1,7]])}))()}},{key:"createUser",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t){r.next=5;break}return r.next=3,n.userDAO.set(e,{verified:!1});case 3:r.next=7;break;case 5:return r.next=7,n.userDAO.set(e,{username:t,verified:!1});case 7:case"end":return r.stop()}},r)}))()}},{key:"doGoogleLogin",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e6,t.next=3,e.registerOrLoginWithGoogle();case 3:return t.t1=t.sent,t.abrupt("return",t.t0.ofFallible.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t)}))()}},{key:"registerOrLoginWithGoogle",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new M$).addScope("profile"),n.addScope("email"),t.next=5,Yee.signInWithPopup(e.auth,n);case 5:return r=t.sent,t.t0=!1,t.next=9,e.userDAO.exists(r.uid);case 9:if(t.t1=t.sent,t.t2=t.t0===t.t1,!t.t2){t.next=14;break}return t.next=14,e.createUser(r.uid);case 14:return t.abrupt("return",J5.success(r));case 17:return t.prev=17,t.t3=t.catch(0),t.abrupt("return",J5.failure(e.mapFirebaseError(t.t3)));case 20:case"end":return t.stop()}},t,null,[[0,17]])}))()}},{key:"disconnect",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=hB.ofNullable(e.auth.currentUser)).isPresent()){t.next=8;break}return r=n.get().uid,t.next=5,e.connectivityDAO.setOffline(r);case 5:return t.next=7,e.auth.signOut();case 7:return t.abrupt("return",e6.SUCCESS);case 8:return t.abrupt("return",e6.failure("Cannot disconnect a non-connected user"));case 9:case"end":return t.stop()}},t)}))()}},{key:"getUserObs",value:function(){return this.userObs}},{key:"setUsername",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e){n.next=2;break}return n.abrupt("return",e6.failure($localize(f||(f=Vv(["Your username may not be empty."])))));case 2:return n.prev=2,n.t0=!1,n.next=6,t.userDAO.usernameIsAvailable(e);case 6:if(n.t1=n.sent,n.t0!==n.t1){n.next=9;break}return n.abrupt("return",e6.failure($localize(d||(d=Vv(["This username is already in use, please select a different one."])))));case 9:return r=oB.getNonNullable(t.auth.currentUser),n.next=12,Yee.updateProfile(r,{displayName:e});case 12:return n.next=14,t.userDAO.setUsername(r.uid,e);case 14:return n.next=16,t.userDAO.markVerified(r.uid);case 16:return n.next=18,t.reloadUser();case 18:return n.abrupt("return",e6.SUCCESS);case 21:return n.prev=21,n.t2=n.catch(2),n.abrupt("return",e6.failure(t.mapFirebaseError(n.t2)));case 24:case"end":return n.stop()}},n,null,[[2,21]])}))()}},{key:"setPicture",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=oB.getNonNullable(t.auth.currentUser),n.next=4,Yee.updateProfile(r,{photoURL:e});case 4:return n.abrupt("return",e6.SUCCESS);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",e6.failure(t.mapFirebaseError(n.t0)));case 10:case"end":return n.stop()}},n,null,[[0,7]])}))()}},{key:"reloadUser",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=oB.getNonNullable(e.auth.currentUser),t.next=3,n.getIdToken(!0);case 3:return t.next=5,n.reload();case 5:case"end":return t.stop()}},t)}))()}},{key:"updateObservedPart",value:function(e){return a6(this.user.isPresent(),"Should not call updateObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:e})}},{key:"removeObservedPart",value:function(){return a6(this.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:null})}},{key:"sendPresenceToken",value:function(){return a6(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userDAO.updatePresenceToken(this.user.get().id)}},{key:"ngOnDestroy",value:function(){this.userUnsubscribe.isPresent()&&this.userUnsubscribe.get()(),this.unsubscribeFromAuth()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Rk(d6),Rk(lj),Rk(Zee))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Qee=function(){function e(t){sp(this,e),this.value=t}return cp(e,null,[{key:"of",value:function(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return a6("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}]),e}();Qee.CREATOR=new Qee("CREATOR"),Qee.RANDOM=new Qee("RANDOM"),Qee.CHOSEN_PLAYER=new Qee("CHOSEN_PLAYER");var Xee=function(){function e(t){sp(this,e),this.value=t}return cp(e,null,[{key:"of",value:function(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}]),e}();Xee.STANDARD=new Xee("STANDARD"),Xee.BLITZ=new Xee("BLITZ"),Xee.CUSTOM=new Xee("CUSTOM"),Xee.NORMAL_MOVE_DURATION=120,Xee.NORMAL_PART_DURATION=1800,Xee.BLITZ_MOVE_DURATION=30,Xee.BLITZ_PART_DURATION=900;var ete=cp(function e(t){sp(this,e),this.value=t});ete.PART_CREATED=new ete(0),ete.CONFIG_PROPOSED=new ete(2),ete.PART_STARTED=new ete(3),ete.PART_FINISHED=new ete(4);var tte=cp(function e(){sp(this,e)}),nte=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"encode",value:function(e){return this.encodeMove(e)}},{key:"decode",value:function(e){return a6(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}],[{key:"disjunction3",value:function(e,t,r,i,a){return new(function(n){Yv(s,n);var o=Jv(s);function s(){return sp(this,s),o.apply(this,arguments)}return cp(s,[{key:"encodeMove",value:function(n){return i(n)?{type:"T1",encoded:e.encode(n)}:a(n)?{type:"T2",encoded:t.encode(n)}:{type:"T3",encoded:r.encode(n)}}},{key:"decodeMove",value:function(n){var i=oB.getNonNullable(n).type,a=oB.getNonNullable(n).encoded;return"T1"===i?e.decode(a):"T2"===i?t.decode(a):r.decode(a)}}]),s}(n))}}]),n}(tte),rte=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"shift",value:function(){return this.maxValue()+1}},{key:"encodeMove",value:function(e){return this.encodeNumber(e)}},{key:"decodeMove",value:function(e){return a6("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}],[{key:"ofN",value:function(e,t,r){return new(function(n){Yv(a,n);var i=Jv(a);function a(){return sp(this,a),i.apply(this,arguments)}return cp(a,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(e){return t(e)}},{key:"decodeNumber",value:function(e){return r(e)}}]),a}(n))}},{key:"tuple",value:function(e,t,r){return new(function(n){Yv(a,n);var i=Jv(a);function a(){return sp(this,a),i.apply(this,arguments)}return cp(a,[{key:"maxValue",value:function(){var t=0;return Object.keys(e).forEach(function(n){t=t*e[n].shift()+e[n].maxValue()}),t}},{key:"encodeNumber",value:function(n){var r=t(n),i=0;return Object.keys(r).forEach(function(t){i=i*e[t].shift()+e[t].encode(r[t])}),i}},{key:"decodeNumber",value:function(t){var n={},i=t;return Object.keys(e).reverse().forEach(function(t){var r=i%e[t].shift();i=(i-r)/e[t].shift(),n[t]=e[t].decode(r)}),r(n)}}]),a}(n))}},{key:"disjunction",value:function(e,t,r){return new(function(n){Yv(a,n);var i=Jv(a);function a(){return sp(this,a),i.apply(this,arguments)}return cp(a,[{key:"maxValue",value:function(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}},{key:"encodeNumber",value:function(n){return r(n)?2*e.encodeNumber(n):2*t.encodeNumber(n)+1}},{key:"decodeNumber",value:function(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}]),a}(n))}},{key:"numberEncoder",value:function(e){return new(function(t){Yv(r,t);var n=Jv(r);function r(){return sp(this,r),n.apply(this,arguments)}return cp(r,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}},{key:"decodeNumber",value:function(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}]),r}(n))}}]),n}(nte);rte.booleanEncoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 1}},{key:"encodeNumber",value:function(e){return e?1:0}},{key:"decodeNumber",value:function(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}}]),n}(rte));var ite=function(){function e(){sp(this,e),this.value=2}return cp(e,[{key:"isPlayer",value:function(){return!1}},{key:"toString",value:function(){return"PlayerNone"}},{key:"equals",value:function(e){return this===e}}]),e}();ite.NONE=new ite;var ate,ote=function(){function e(t){sp(this,e),this.value=t}return cp(e,[{key:"isPlayer",value:function(){return!0}},{key:"toString",value:function(){return"Player "+this.value}},{key:"equals",value:function(e){return this===e}},{key:"getScoreModifier",value:function(){return 0===this.value?-1:1}},{key:"getPreVictory",value:function(){return this.getVictoryValue()-this.getScoreModifier()}},{key:"getDefeatValue",value:function(){return this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}},{key:"getVictoryValue",value:function(){return this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}},{key:"getOpponent",value:function(){switch(this){case e.ZERO:return e.ONE;default:return oB.expectToBe(this,e.ONE),e.ZERO}}}],[{key:"of",value:function(t){switch(t){case 0:return e.ZERO;default:return oB.expectToBe(t,1),e.ONE}}},{key:"fromTurn",value:function(t){return t%2==0?e.ZERO:e.ONE}}]),e}();ote.numberEncoder=rte.ofN(2,function(e){return e.value},function(e){return 2===e?ate.NONE:ote.of(e)}),ote.ZERO=new ote(0),ote.ONE=new ote(1),function(e){e.ZERO=ote.ZERO,e.ONE=ote.ONE,e.NONE=ite.NONE}(ate||(ate={}));var ste=function(){function e(){sp(this,e)}return cp(e,null,[{key:"rematchAccepted",value:function(e,t){return ute("RematchAccepted",{typeGame:e,partId:t})}},{key:"getPlayer",value:function(e){return ote.of(oB.getNonNullable(e.data).player)}},{key:"getTypeGame",value:function(e){return oB.getNonNullable(e.data).typeGame}},{key:"getPartId",value:function(e){return oB.getNonNullable(e.data).partId}}]),e}();function ute(e,t){return{code:e,data:t}}function cte(e){return function(t){return ute(e,{player:t.value})}}ste.drawProposed=cte("DrawProposed"),ste.drawAccepted=ute("DrawAccepted",{}),ste.drawRefused=cte("DrawRefused"),ste.takeBackAsked=cte("TakeBackAsked"),ste.takeBackRefused=cte("TakeBackRefused"),ste.takeBackAccepted=cte("TakeBackAccepted"),ste.rematchProposed=cte("RematchProposed"),ste.addTurnTime=cte("AddTurnTime"),ste.addGlobalTime=cte("AddGlobalTime");var lte=function(){function e(){sp(this,e)}return cp(e,null,[{key:"mapBiArray",value:function(e,t){for(var n=[],r=0;r<e.length;){n[r]=[];for(var i=0;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}},{key:"createTable",value:function(e,t,n){for(var r=[],i=t-1;i>=0;){r[i]=[];for(var a=e-1;a>=0;)r[i][a]=n,a--;i--}return r}},{key:"copyBiArray",value:function(t){for(var n=[],r=0;r<t.length;)n[r]=e.copyImmutableArray(t[r]),r++;return n}},{key:"copyImmutableArray",value:function(e){for(var t=[],n=0;n<e.length;)t[n]=e[n],n++;return t}},{key:"sortByDescending",value:function(e,t){e.sort(function(e,n){var r=t(e),i=t(n);return r<i?1:r>i?-1:0})}},{key:"compareArray",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!1===lB(e[n],t[n]))return!1;return!0}},{key:"compareTable",value:function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!1===e.compareArray(t[r],n[r]))return!1;return!0}}]),e}(),hte=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),r=t.call(this,"joiners",e),sB(n.VERBOSE,"JoinerDAO.constructor"),r}return cp(n)}(K5);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Rk(I5))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),fte=function(){var e=function(){function e(t){sp(this,e),this.joinerDAO=t,this.joinerUnsubscribe=hB.empty(),sB(e.VERBOSE,"JoinerService.constructor")}return cp(e,[{key:"subscribeToChanges",value:function(e,t){this.observedJoinerId=e,this.joinerUnsubscribe=hB.of(this.joinerDAO.subscribeToChanges(e,t))}},{key:"unsubscribe",value:function(){a6(this.joinerUnsubscribe.isPresent(),"JoinerService cannot unsubscribe if no joiner is observed"),this.joinerUnsubscribe.get()(),this.joinerUnsubscribe=hB.empty()}},{key:"createInitialJoiner",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(sB(e.VERBOSE,"JoinerService.createInitialJoiner("+t.id+", "+n+")"),r.set(n,{candidates:[],chosenOpponent:null,firstPlayer:Qee.RANDOM.value,partType:Xee.STANDARD.value,partStatus:ete.PART_CREATED.value,maximalMoveDuration:Xee.NORMAL_MOVE_DURATION,totalPartDuration:Xee.NORMAL_PART_DURATION,creator:t})));case 1:case"end":return i.stop()}},i)}))()}},{key:"joinGame",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return sB(e.VERBOSE,"JoinerService.joinGame("+t+", "+n.id+")"),i.next=3,r.joinerDAO.read(t);case 3:if(!(a=i.sent).isAbsent()){i.next=6;break}return i.abrupt("return",e6.failure(e.GAME_DOES_NOT_EXIST()));case 6:if(!(o=lte.copyImmutableArray(a.get().candidates)).some(function(e){return e.id===n.id})){i.next=11;break}i.t0=e6.failure(e.USER_ALREADY_IN_GAME()),i.next=17;break;case 11:if(i.t1=n.id===a.get().creator.id,i.t1){i.next=16;break}return o[o.length]=n,i.next=16,r.joinerDAO.update(t,{candidates:o});case 16:i.t0=e6.SUCCESS;case 17:return i.abrupt("return",i.t0);case 18:case"end":return i.stop()}},i)}))()}},{key:"cancelJoining",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(e.VERBOSE,"JoinerService.cancelJoining("+t.name+"); this.observedJoinerId = "+n.observedJoinerId),null!=n.observedJoinerId){r.next=2;break}throw new Error("cannot cancel joining when not observing a joiner");case 2:return r.next=4,n.joinerDAO.read(n.observedJoinerId);case 4:if((i=r.sent).isAbsent()){r.next=15;break}if(o=i.get(),s=lte.copyImmutableArray(o.candidates),u=s.findIndex(function(e){return e.id===t.id}),c=o.chosenOpponent,l=o.partStatus,s.splice(u,1),(null===(a=c)||void 0===a?void 0:a.id)!==t.id){r.next=12;break}c=null,l=ete.PART_CREATED.value,r.next=14;break;case 12:if(-1!==u){r.next=14;break}throw new Error("someone that was not candidate nor ChosenOpponent just left the chat: "+t.name);case 14:return r.abrupt("return",n.joinerDAO.update(n.observedJoinerId,{chosenOpponent:c,partStatus:l,candidates:s}));case 15:case"end":return r.stop()}},r)}))()}},{key:"updateCandidates",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(sB(e.VERBOSE,"JoinerService.reviewConfig"),a6(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),n.joinerDAO.update(n.observedJoinerId,{candidates:t})));case 1:case"end":return r.stop()}},r)}))()}},{key:"deleteJoiner",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(sB(e.VERBOSE,"JoinerService.deleteJoiner(); this.observedJoinerId = "+t.observedJoinerId),a6(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.delete(t.observedJoinerId)));case 1:case"end":return n.stop()}},n)}))()}},{key:"proposeConfig",value:function(t,n,r,i,a){var o=this;return aB(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(sB(e.VERBOSE,{joinerService_proposeConfig:{maximalMoveDuration:r,firstPlayer:i,totalPartDuration:a}}),sB(e.VERBOSE,"this.followedJoinerId: "+o.observedJoinerId),a6(null!=o.observedJoinerId,"JoinerService is not observing a joiner"),o.joinerDAO.update(o.observedJoinerId,{partStatus:ete.CONFIG_PROPOSED.value,chosenOpponent:t,partType:n.value,maximalMoveDuration:r,totalPartDuration:a,firstPlayer:i.value})));case 1:case"end":return s.stop()}},s)}))()}},{key:"setChosenOpponent",value:function(t){return sB(e.VERBOSE,"JoinerService.setChosenOpponent(".concat(t.name,")")),a6(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(this.observedJoinerId,{chosenOpponent:t})}},{key:"reviewConfig",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(sB(e.VERBOSE,"JoinerService.reviewConfig"),a6(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.update(t.observedJoinerId,{partStatus:ete.PART_CREATED.value})));case 1:case"end":return n.stop()}},n)}))()}},{key:"reviewConfigAndRemoveChosenOpponentAndUpdateCandidates",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(sB(e.VERBOSE,"JoinerService.reviewConfig"),a6(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),n.joinerDAO.update(n.observedJoinerId,{partStatus:ete.PART_CREATED.value,candidates:t,chosenOpponent:null})));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(){return sB(e.VERBOSE,"JoinerService.acceptConfig"),a6(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(this.observedJoinerId,{partStatus:ete.PART_STARTED.value})}},{key:"createJoiner",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(sB(e.VERBOSE,"JoinerService.create("+JSON.stringify(t)+")"),n.joinerDAO.create(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"readJoinerById",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"JoinerService.readJoinerById("+t+")"),r.next=3,n.joinerDAO.read(t);case 3:return r.abrupt("return",r.sent.get());case 4:case"end":return r.stop()}},r)}))()}},{key:"set",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(sB(e.VERBOSE,"JoinerService.set("+t+", "+JSON.stringify(n)+")"),r.joinerDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"updateJoinerById",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(sB(e.VERBOSE,{joinerService_updateJoinerById:{partId:t,update:n}}),r.joinerDAO.update(t,n)));case 1:case"end":return i.stop()}},i)}))()}}]),e}();return e.VERBOSE=!1,e.USER_ALREADY_IN_GAME=function(){return $localize(v||(v=Vv(["You cannot join this game because you are already in another one."])))},e.GAME_DOES_NOT_EXIST=function(){return $localize(p||(p=Vv(["Game does not exist"])))},e.\u0275fac=function(t){return new(t||e)(Rk(hte))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),dte=function(){var e=function(){function e(t,n,r){sp(this,e),this.partDAO=t,this.joinerService=n,this.chatService=r,this.followedPartId=hB.empty(),sB(e.VERBOSE,"GameService.constructor")}return cp(e,[{key:"getPartValidity",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.partDAO.read(e);case 2:return i=r.sent,r.abrupt("return",i.isAbsent()?e6.failure("NONEXISTENT_PART"):i.get().typeGame===t?e6.SUCCESS:e6.failure("WRONG_GAME_TYPE"));case 4:case"end":return r.stop()}},r)}))()}},{key:"createUnstartedPart",value:function(t,n){return sB(e.VERBOSE,"GameService.createPart("+t.name+", "+n+")"),this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:n,playerZero:t.name,turn:-1,result:o6.UNACHIEVED.value,listMoves:[]})}},{key:"createChat",value:function(t){return sB(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}},{key:"createPartJoinerAndChat",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return sB(e.VERBOSE,"GameService.createGame(".concat(t.id,", ").concat(n,")")),i.next=3,r.createUnstartedPart(t,n);case 3:return a=i.sent,i.next=6,r.joinerService.createInitialJoiner(t,a);case 6:return i.next=8,r.createChat(a);case 8:return i.abrupt("return",a);case 9:case"end":return i.stop()}},i)}))()}},{key:"startGameWithConfig",value:function(t,n,r,i){sB(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));var a=this.getStartingConfig(i);return this.partDAO.updateAndBumpIndex(t,n,r,a)}},{key:"getStartingConfig",value:function(e){var t,n,r=Qee.of(e.firstPlayer);return r===Qee.RANDOM&&(r=Math.random()<.5?Qee.CREATOR:Qee.CHOSEN_PLAYER),r===Qee.CREATOR?(t=e.creator.name,n=oB.getNonNullable(e.chosenOpponent).name):(t=oB.getNonNullable(e.chosenOpponent).name,n=e.creator.name),{playerZero:t,playerOne:n,turn:0,beginning:T5(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}},{key:"deletePart",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(sB(e.VERBOSE,"GameService.deletePart("+t+")"),n.partDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return sB(e.VERBOSE,{gameService_acceptConfig:{partId:t,joiner:n}}),i.next=3,r.joinerService.acceptConfig();case 3:return i.abrupt("return",r.startGameWithConfig(t,ote.ONE,0,n));case 4:case"end":return i.stop()}},i)}))()}},{key:"startObserving",value:function(t,n){if(!this.followedPartId.isAbsent())throw new Error("GameService.startObserving should not be called while already observing a game");sB(e.VERBOSE,"[start watching part "+t),this.followedPartId=hB.of(t),this.followedPartUnsubscribe=this.partDAO.subscribeToChanges(t,n)}},{key:"resign",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:o6.RESIGN.value,request:null})}},{key:"notifyTimeout",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:o6.TIMEOUT.value,request:null})}},{key:"sendRequest",value:function(e,t,n,r){return this.partDAO.updateAndBumpIndex(e,t,n,{request:r})}},{key:"proposeDraw",value:function(e,t,n){return this.sendRequest(e,n,t,ste.drawProposed(n))}},{key:"acceptDraw",value:function(e,t,n){return this.partDAO.updateAndBumpIndex(e,n,t,{result:(n===ote.ZERO?o6.AGREED_DRAW_BY_ZERO:o6.AGREED_DRAW_BY_ONE).value,request:null})}},{key:"refuseDraw",value:function(e,t,n){return this.sendRequest(e,n,t,ste.drawRefused(n))}},{key:"proposeRematch",value:function(e,t,n){return this.sendRequest(e,n,t,ste.rematchProposed(n))}},{key:"acceptRematch",value:function(t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return sB(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t}),o=oB.getNonNullable(t.data),a.next=4,i.joinerService.readJoinerById(t.id);case 4:return s=a.sent,u=o.playerZero===s.creator.name?Qee.CHOSEN_PLAYER:Qee.CREATOR,c=Uv(Uv({},s),{},{candidates:[],firstPlayer:u.value,partStatus:ete.PART_STARTED.value}),a.next=9,i.joinerService.createJoiner(c);case 9:return l=a.sent,h=i.getStartingConfig(c),f=Uv({lastUpdate:{index:0,player:r.value},typeGame:o.typeGame,result:o6.UNACHIEVED.value,listMoves:[]},h),a.next=14,i.partDAO.set(l,f);case 14:return a.next=16,i.createChat(l);case 16:return a.abrupt("return",i.sendRequest(t.id,r,n,ste.rematchAccepted(o.typeGame,l)));case 17:case"end":return a.stop()}},a)}))()}},{key:"askTakeBack",value:function(e,t,n){return this.sendRequest(e,n,t,ste.takeBackAsked(n))}},{key:"acceptTakeBack",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a6(ste.getPlayer(oB.getNonNullable(t.data.request))!==n,"Illegal to accept your own request"),o=ste.takeBackAccepted(n),(s=t.data.listMoves.slice(0,t.data.listMoves.length-1)).length%2===n.value&&(s=s.slice(0,s.length-1)),u={request:o,listMoves:s,turn:s.length,lastUpdateTime:T5(),remainingMsForZero:oB.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:oB.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index,a.next=7,i.partDAO.updateAndBumpIndex(e,n,c,u);case 7:return a.abrupt("return",a.sent);case 8:case"end":return a.stop()}},a)}))()}},{key:"refuseTakeBack",value:function(e,t,n){var r=ste.takeBackRefused(n);return this.partDAO.updateAndBumpIndex(e,n,t,{request:r})}},{key:"addGlobalTime",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o={request:ste.addGlobalTime(r.getOpponent())},o=r===ote.ZERO?Uv(Uv({},o),{},{remainingMsForOne:oB.getNonNullable(n.remainingMsForOne)+3e5}):Uv(Uv({},o),{},{remainingMsForZero:oB.getNonNullable(n.remainingMsForZero)+3e5}),a.next=4,i.partDAO.updateAndBumpIndex(e,r,t,o);case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},a)}))()}},{key:"addTurnTime",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={request:ste.addTurnTime(e.getOpponent())},i.next=3,r.partDAO.updateAndBumpIndex(n,e,t,a);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"stopObserving",value:function(){sB(e.VERBOSE,"GameService.stopObserving();"),this.followedPartId=hB.empty(),this.followedPartUnsubscribe()}},{key:"updateDBBoard",value:function(t,n,r,i,a,o,s,u){var c=this;return aB(regeneratorRuntime.mark(function l(){var h,f,d,v,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return sB(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:a,msToSubstract:i,notifyDraw:o,winner:s,loser:u}}),l.next=3,c.partDAO.read(t);case 3:return h=l.sent.get(),f=h.lastUpdate.index,d=h.turn+1,(v=lte.copyImmutableArray(h.listMoves))[v.length]=r,p={listMoves:v,turn:d,request:null,lastUpdateTime:T5()},p=c.updateScore(p,a),p=c.substractMs(p,h,i),null!=s?p=Uv(Uv({},p),{},{winner:s,loser:u,result:o6.VICTORY.value}):!0===o&&(p=Uv(Uv({},p),{},{result:o6.HARD_DRAW.value})),l.next=14,c.partDAO.updateAndBumpIndex(t,n,f,p);case 14:return l.abrupt("return",l.sent);case 15:case"end":return l.stop()}},l)}))()}},{key:"updateScore",value:function(e,t){return void 0!==t?Uv(Uv({},e),{},{scorePlayerZero:t[0],scorePlayerOne:t[1]}):e}},{key:"substractMs",value:function(e,t,n){return n[0]>0?Uv(Uv({},e),{},{remainingMsForZero:oB.getNonNullable(t.remainingMsForZero)-n[0]}):n[1]>0?Uv(Uv({},e),{},{remainingMsForOne:oB.getNonNullable(t.remainingMsForOne)-n[1]}):e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Rk(u6),Rk(fte),Rk(h6))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),vte=function(){function e(){sp(this,e)}return cp(e,null,[{key:"getNavigatorLanguage",value:function(){return navigator.language}},{key:"getLocale",value:function(){var t=(localStorage.getItem("locale")||e.getNavigatorLanguage()||"fr").slice(0,2).toLowerCase();return["en","fr"].some(function(e){return e===t})?t:"fr"}}]),e}(),pte=function(){var e=function(){function e(){sp(this,e)}return cp(e,[{key:"changeTheme",value:function(e){localStorage.setItem("theme",e)}},{key:"getTheme",value:function(){return hB.ofNullable(localStorage.getItem("theme"))}},{key:"changeLanguage",value:function(e){localStorage.setItem("locale",e.toLowerCase())}},{key:"getLanguage",value:function(){return vte.getLocale()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),gte=function(){var e=function(){function e(t,n){sp(this,e),this.document=t,this.userSettingsService=n,this.availableThemes=["dark","light"];var r=this.getStoredTheme();r.isPresent()?this.loadTheme(r.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}return cp(e,[{key:"getStoredTheme",value:function(){var e=this.userSettingsService.getTheme();if(e.isPresent()){var t=e.get();if(this.availableThemes.some(function(e){return e===t}))return hB.of(t)}return hB.empty()}},{key:"loadTheme",value:function(e){this.loadStyle(e+".css"),this.theme=e}},{key:"loadStyle",value:function(e){var t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{var r=this.document.createElement("link");r.id="theme",r.rel="stylesheet",r.href="".concat(e),t.appendChild(r)}}},{key:"getTheme",value:function(){return this.theme}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(RO),Rk(pte))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),yte={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},mte={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},kte={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},_te={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},wte={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},Cte={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]};function bte(e){return(bte="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ete(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ste(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Ete(e,t,n[t])})}return e}function Pte(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){i=!0,a=u}finally{try{!r&&null!=s.return&&s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Ote={},Tte={};try{"undefined"!=typeof window&&(Ote=window),"undefined"!=typeof document&&(Tte=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(Ime){}var Ite=(Ote.navigator||{}).userAgent,xte=void 0===Ite?"":Ite,Ate=Ote,Rte=Tte,Nte=!!Rte.documentElement&&!!Rte.head&&"function"==typeof Rte.addEventListener&&"function"==typeof Rte.createElement,Mte=(~xte.indexOf("MSIE")||xte.indexOf("Trident/"),"___FONT_AWESOME___"),Dte="svg-inline--fa",Lte=[1,2,3,4,5,6,7,8,9,10],Fte=Lte.concat([11,12,13,14,15,16,17,18,19,20]),Bte={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},Ute=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",Bte.GROUP,Bte.SWAP_OPACITY,Bte.PRIMARY,Bte.SECONDARY].concat(Lte.map(function(e){return"".concat(e,"x")})).concat(Fte.map(function(e){return"w-".concat(e)})),Ate.FontAwesomeConfig||{});Rte&&"function"==typeof Rte.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=Pte(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=Rte.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(Ute[n]=r)});var Vte=Ste({},{familyPrefix:"fa",replacementClass:Dte,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},Ute);Vte.autoReplaceSvg||(Vte.observeMutations=!1);var zte=Ste({},Vte);Ate.FontAwesomeConfig=zte;var Hte=Ate||{};Hte[Mte]||(Hte[Mte]={}),Hte[Mte].styles||(Hte[Mte].styles={}),Hte[Mte].hooks||(Hte[Mte].hooks={}),Hte[Mte].shims||(Hte[Mte].shims=[]);var Gte=Hte[Mte],qte=[];Nte&&((Rte.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Rte.readyState)||Rte.addEventListener("DOMContentLoaded",function e(){Rte.removeEventListener("DOMContentLoaded",e),qte.map(function(e){return e()})}));var $te,Wte="pending",jte="fulfilled",Zte="rejected",Yte=function(){},Kte="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,Jte="undefined"==typeof setImmediate?setTimeout:setImmediate,Qte=[];function Xte(){for(var e=0;e<Qte.length;e++)Qte[e][0](Qte[e][1]);Qte=[],$te=!1}function ene(e,t){Qte.push([e,t]),$te||($te=!0,Jte(Xte,0))}function tne(e){var t=e.owner,n=t._state,r=t._data,i=e[n],a=e.then;if("function"==typeof i){n=jte;try{r=i(r)}catch(o){ane(a,o)}}nne(a,r)||(n===jte&&rne(a,r),n===Zte&&ane(a,r))}function nne(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===bte(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?ine(e,r):rne(e,r))},function(t){n||(n=!0,ane(e,t))}),!0}}catch(i){return n||ane(e,i),!0}return!1}function rne(e,t){(e===t||!nne(e,t))&&ine(e,t)}function ine(e,t){e._state===Wte&&(e._state="settled",e._data=t,ene(sne,e))}function ane(e,t){e._state===Wte&&(e._state="settled",e._data=t,ene(une,e))}function one(e){e._then=e._then.forEach(tne)}function sne(e){e._state=jte,one(e)}function une(e){e._state=Zte,one(e),!e._handled&&Kte&&global.process.emit("unhandledRejection",e._data,e)}function cne(e){global.process.emit("rejectionHandled",e)}function lne(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof lne))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){ane(t,e)}try{e(function(e){rne(t,e)},n)}catch(r){n(r)}}(e,this)}lne.prototype={constructor:lne,_state:Wte,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(Yte),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===Zte&&Kte&&ene(cne,this)),this._state===jte||this._state===Zte?ene(tne,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},lne.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new lne(function(t,n){var r=[],i=0;function a(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),n):r[s]=o;i||t(r)})},lne.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new lne(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},lne.resolve=function(e){return e&&"object"===bte(e)&&e.constructor===lne?e:new lne(function(t){t(e)})},lne.reject=function(e){return new lne(function(t,n){n(e)})};var hne={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function fne(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function dne(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function vne(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function pne(e){return e.size!==hne.size||e.x!==hne.x||e.y!==hne.y||e.rotate!==hne.rotate||e.flipX||e.flipY}function gne(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(a," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var yne={x:0,y:0,width:"100%",height:"100%"};function mne(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function kne(e){return"g"===e.tag?e.children:[e]}function _ne(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,a=e.iconName,o=e.transform,s=e.symbol,u=e.title,c=e.maskId,l=e.titleId,h=e.extra,f=e.watchable,d=void 0!==f&&f,v=r.found?r:n,p=v.width,g=v.height,y="fak"===i,m=y?"":"fa-w-".concat(Math.ceil(p/g*16)),k=[zte.replacementClass,a?"".concat(zte.familyPrefix,"-").concat(a):"",m].filter(function(e){return-1===h.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(h.classes).join(" "),_={children:[],attributes:Ste({},h.attributes,{"data-prefix":i,"data-icon":a,class:k,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(g)})},w=y&&!~h.classes.indexOf("fa-fw")?{width:"".concat(p/g*16*.0625,"em")}:{};d&&(_.attributes["data-fa-i2svg"]=""),u&&_.children.push({tag:"title",attributes:{id:_.attributes["aria-labelledby"]||"title-".concat(l||fne())},children:[u]});var C=Ste({},_,{prefix:i,iconName:a,main:n,mask:r,maskId:c,transform:o,symbol:s,styles:Ste({},w,h.styles)}),b=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,a=e.maskId,o=r.icon,s=i.icon,u=gne({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:Ste({},yne,{fill:"white"})},l=o.children?{children:o.children.map(mne)}:{},h={tag:"g",attributes:Ste({},u.inner),children:[mne(Ste({tag:o.tag,attributes:Ste({},o.attributes,u.path)},l))]},f={tag:"g",attributes:Ste({},u.outer),children:[h]},d="mask-".concat(a||fne()),v="clip-".concat(a||fne()),p={tag:"mask",attributes:Ste({},yne,{id:d,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,f]},g={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:kne(s)},p]};return t.push(g,{tag:"rect",attributes:Ste({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(d,")")},yne)}),{children:t,attributes:n}}(C):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,a=vne(e.styles);if(a.length>0&&(n.style=a),pne(i)){var o=gne({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:Ste({},o.outer),children:[{tag:"g",attributes:Ste({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:Ste({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(C),E=b.attributes;return C.children=b.children,C.attributes=E,s?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Ste({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(zte.familyPrefix,"-").concat(t):r}),children:n}]}]}(C):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,a=e.styles,o=e.transform;if(pne(o)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=vne(Ste({},a,{"transform-origin":"".concat(s.x+o.x/16,"em ").concat(s.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(C)}var wne=function(e,t,n,r){var i,a,o,s=Object.keys(e),u=s.length,c=void 0!==r?function(e,t){return function(n,r,i,a){return e.call(t,n,r,i,a)}}(t,r):t;for(void 0===n?(i=1,o=e[s[0]]):(i=0,o=n);i<u;i++)o=c(o,e[a=s[i]],a,e);return o};function Cne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,a=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof Gte.hooks.addPack||i?Gte.styles[e]=Ste({},Gte.styles[e]||{},a):Gte.hooks.addPack(e,a),"fas"===e&&Cne("fa",t)}var bne=Gte.styles,Ene=Gte.shims,Sne=function(){var e=function(e){return wne(bne,function(t,n,r){return t[r]=wne(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in bne;wne(Ene,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function Pne(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function One(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,a=void 0===i?[]:i;return"string"==typeof e?dne(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(dne(e[n]),'" ')},"").trim()}(r),">").concat(a.map(One).join(""),"</").concat(t,">")}function Tne(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}Sne(),(Tne.prototype=Object.create(Error.prototype)).constructor=Tne;var Ine={fill:"currentColor"},xne={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},Ane=(Ste({},Ine,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),Ste({},xne,{attributeName:"opacity"}));function Rne(e){var t=e[0],n=e[1],r=Pte(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(zte.familyPrefix,"-").concat(Bte.GROUP)},children:[{tag:"path",attributes:{class:"".concat(zte.familyPrefix,"-").concat(Bte.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(zte.familyPrefix,"-").concat(Bte.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}function Nne(){zte.autoAddCss&&!Fne&&(function(e){if(e&&Nte){var t=Rte.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=Rte.head.childNodes,r=null,i=n.length-1;i>-1;i--){var a=n[i],o=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=a)}Rte.head.insertBefore(t,r)}}(function(){var e="fa",t=Dte,n=zte.familyPrefix,r=zte.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var a=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(a,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(s,".".concat(r))}return i}()),Fne=!0)}function Mne(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return One(e)})}}),Object.defineProperty(e,"node",{get:function(){if(Nte){var t=Rte.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function Dne(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return Pne(Lne.definitions,n,r)||Pne(Gte.styles,n,r)}Ste({},Ine,{cx:"256",cy:"364",r:"28"}),Ste({},xne,{attributeName:"r",values:"28;14;28;28;14;28;"}),Ste({},Ane,{values:"1;0;1;1;0;1;"}),Ste({},Ine,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),Ste({},Ane,{values:"1;0;0;0;0;1;"}),Ste({},Ine,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),Ste({},Ane,{values:"0;0;1;1;0;0;"});var Lne=new(function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=Ste({},e.definitions[t]||{},i[t]),Cne(t,i[t]),Sne()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,a=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][a]=o}),e}}]),e}()),Fne=!1,Bne=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:Dne(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:Dne(i||{})),e(r,Ste({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?hne:n,i=t.symbol,a=void 0!==i&&i,o=t.mask,s=void 0===o?null:o,u=t.maskId,c=void 0===u?null:u,l=t.title,h=void 0===l?null:l,f=t.titleId,d=void 0===f?null:f,v=t.classes,p=void 0===v?[]:v,g=t.attributes,y=void 0===g?{}:g,m=t.styles,k=void 0===m?{}:m;if(e){var _=e.prefix,w=e.iconName,C=e.icon;return Mne(Ste({type:"icon"},e),function(){return Nne(),zte.autoA11y&&(h?y["aria-labelledby"]="".concat(zte.replacementClass,"-title-").concat(d||fne()):(y["aria-hidden"]="true",y.focusable="false")),_ne({icons:{main:Rne(C),mask:s?Rne(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:_,iconName:w,transform:Ste({},hne,r),symbol:a,title:h,maskId:c,titleId:d,extra:{attributes:y,styles:k,classes:p}})})}}),Une=["*"],Vne=function(e){var t,n=(zv(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip},"fa-".concat(e.size),null!==e.size),zv(t,"fa-rotate-".concat(e.rotate),null!==e.rotate),zv(t,"fa-pull-".concat(e.pull),null!==e.pull),zv(t,"fa-stack-".concat(e.stackItemSize),null!=e.stackItemSize),t);return Object.keys(n).map(function(e){return n[e]?e:null}).filter(function(e){return e})},zne=function(){var e=cp(function e(){sp(this,e),this.defaultPrefix="fas",this.fallbackIcon=null});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Hne=function(){var e=function(){function e(){sp(this,e),this.definitions={}}return cp(e,[{key:"addIcons",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];a.prefix in this.definitions||(this.definitions[a.prefix]={}),this.definitions[a.prefix][a.iconName]=a;var o,s=ip(a.icon[2]);try{for(s.s();!(o=s.n()).done;){var u=o.value;"string"==typeof u&&(this.definitions[a.prefix][u]=a)}}catch(c){s.e(c)}finally{s.f()}}}},{key:"addIconPacks",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=o[a],n=Object.keys(t).map(function(e){return t[e]});e.addIcons.apply(e,np(n))},a=0,o=n;a<o.length;a++)i()}},{key:"getIconDefinition",value:function(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Gne=function(){var e=function(){function e(){sp(this,e),this.stackItemSize="1x"}return cp(e,[{key:"ngOnChanges",value:function(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=fy({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[Sy]}),e}(),qne=function(){var e=function(){function e(t,n){sp(this,e),this.renderer=t,this.elementRef=n}return cp(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}},{key:"ngOnChanges",value:function(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,"fa-".concat(e.size.currentValue)),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,"fa-".concat(e.size.previousValue)))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(fS),fb(cS))},e.\u0275cmp=oy({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[Sy],ngContentSelectors:Une,decls:1,vars:0,template:function(e,t){1&e&&(function(e){var t=Yy()[16][6];if(!t.projection)for(var n=t.projection=kk(1,null),r=n.slice(),i=t.child;null!==i;){r[0]?r[0].projectionNext=i:n[0]=i,r[0]=i,i=i.next}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=Yy(),i=Ky(),a=Hw(i,20+e,16,null,n||null);null===a.projection&&(a.projection=t),rm(),64!=(64&a.flags)&&function(e,t,n){yw(t[11],0,t,n,X_(e,n,t),aw(n.parent||t[6],n,t))}(i,r,a)}(0))},encapsulation:2}),e}(),$ne=function(){var e=function(){function e(t,n,r,i,a){sp(this,e),this.sanitizer=t,this.config=n,this.iconLibrary=r,this.stackItem=i,this.classes=[],null!=a&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}return cp(e,[{key:"ngOnChanges",value:function(e){var t;if(null==this.icon&&null==this.config.fallbackIcon)return function(){throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")}();var n;if(n=null!==(t=this.icon)&&void 0!==t?t:this.config.fallbackIcon,e){var r=this.findIconDefinition(n);if(null!=r){var i=this.buildParams();this.renderIcon(r,i)}}}},{key:"render",value:function(){this.ngOnChanges({})}},{key:"findIconDefinition",value:function(e){var t,n,r,i,a=(n=e,r=this.config.defaultPrefix,void 0!==(i=n).prefix&&void 0!==i.iconName?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:r,iconName:n}:void 0);return"icon"in a?a:null!==(t=this.iconLibrary.getIconDefinition(a.prefix,a.iconName))&&void 0!==t?t:(function(e){throw new Error("Could not find icon with iconName=".concat(e.iconName," and prefix=").concat(e.prefix," in the icon library."))}(a),null)}},{key:"buildParams",value:function(){var e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(this.transform):this.transform;return{title:this.title,transform:t,classes:[].concat(np(Vne(e)),np(this.classes)),mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}},{key:"renderIcon",value:function(e,t){var n=Bne(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(wI),fb(zne),fb(Hne),fb(Gne,8),fb(qne,8))},e.\u0275cmp=oy({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(Gb("innerHTML",t.renderedIconHTML,E_),ob("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[Sy],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),Wne=function(){var e=cp(function e(){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e}),e.\u0275inj=Ag({}),e}();function jne(e,t){if(1&e){var n=_b();mb(0),pb(1,"div",9),pb(2,"a",10),Bb(3),gb(),pb(4,"div",12),pb(5,"a",24),bb("click",function(){return Jy(n),Pb().logout()}),WE(6,25),gb(),gb(),gb(),kb()}if(2&e){var r=Pb();Rw(3),Ub(r.username)}}var Zne=function(){return["/register"]},Yne=function(){return["/login"]};function Kne(e,t){1&e&&(pb(0,"div",26),pb(1,"a",27),pb(2,"strong"),WE(3,28),gb(),gb(),pb(4,"a",29),WE(5,30),gb(),gb()),2&e&&(Rw(1),db("routerLink",oP(2,Zne)),Rw(3),db("routerLink",oP(3,Yne)))}var Jne=function(){return["/"]},Qne=function(){return["/play"]},Xne=function(){return["/lobby"]},ere=function(){return["/local"]},tre=function(){return["/tutorial"]},nre=function(){return["/settings"]},rre=function(){var e=function(){function e(t,n,r){sp(this,e),this.router=t,this.connectedUserService=n,this.userService=r,this.username="connecting...",this.faCog=mte,this.showMenu=!1}return cp(e,[{key:"ngOnInit",value:function(){var e=this;this.userSub=this.connectedUserService.getUserObs().subscribe(function(t){e.username=t.username.isPresent()?t.username.get():t.email.getOrElse("")})}},{key:"logout",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.disconnect();case 2:return t.next=4,e.router.navigate(["/"]);case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(ZM),fb(Jee),fb(p6))},e.\u0275cmp=oy({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){return[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],$localize(g||(g=Vv(["Home"]))),[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],$localize(y||(y=Vv(["Play online"]))),[1,"navbar-dropdown"],$localize(m||(m=Vv(["Create a game"]))),$localize(k||(k=Vv(["Join a game"]))),$localize(_||(_=Vv(["Play offline"]))),$localize(w||(w=Vv(["Create a game"]))),$localize(C||(C=Vv(["Learn the rules"]))),[1,"navbar-end"],["data-tooltip",$localize(b||(b=Vv(["Settings"]))),1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["connect",""],["id","logout",1,"navbar-item",3,"click"],$localize(E||(E=Vv(["Log out"]))),[1,"buttons"],[1,"button","is-primary",3,"routerLink"],$localize(S||(S=Vv(["Register"]))),[1,"button","is-light",3,"routerLink"],$localize(P||(P=Vv(["Log in"])))]},template:function(e,t){if(1&e&&(pb(0,"nav",0),pb(1,"div",1),pb(2,"a",2),yb(3,"img",3),gb(),pb(4,"a",4),bb("click",function(){return t.showMenu=!t.showMenu}),yb(5,"span",5),yb(6,"span",5),yb(7,"span",5),gb(),gb(),pb(8,"div",6),bb("click",function(){return t.showMenu=!t.showMenu}),pb(9,"div",7),pb(10,"a",2),WE(11,8),gb(),pb(12,"div",9),pb(13,"a",10),WE(14,11),gb(),pb(15,"div",12),pb(16,"a",2),WE(17,13),gb(),pb(18,"a",2),WE(19,14),gb(),gb(),gb(),pb(20,"div",9),pb(21,"a",10),WE(22,15),gb(),pb(23,"div",12),pb(24,"a",2),WE(25,16),gb(),pb(26,"a",2),WE(27,17),gb(),gb(),gb(),gb(),pb(28,"div",18),pb(29,"a",19),yb(30,"fa-icon",20),gb(),pb(31,"div",21),lb(32,jne,7,1,"ng-container",22),lb(33,Kne,6,4,"ng-template",null,23,NP),gb(),gb(),gb(),gb()),2&e){var n=hb(34);Rw(2),db("routerLink",oP(12,Jne)),Rw(2),db("ngClass",t.showMenu?"is-active":""),Rw(4),db("ngClass",t.showMenu?"is-active":""),Rw(2),db("routerLink",oP(13,Jne)),Rw(6),db("routerLink",oP(14,Qne)),Rw(2),db("routerLink",oP(15,Xne)),Rw(6),db("routerLink",oP(16,ere)),Rw(2),db("routerLink",oP(17,tre)),Rw(3),db("routerLink",oP(18,nre)),Rw(1),db("icon",t.faCog),Rw(2),db("ngIf",t.username)("ngIfElse",n)}},directives:[JM,DT,$ne,UT],encapsulation:2}),e}(),ire=function(){var e=cp(function e(t,n){sp(this,e),this._themeService=t,this._errorLoggerService=n});return e.\u0275fac=function(t){return new(t||e)(fb(gte),fb(i6))},e.\u0275cmp=oy({type:e,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"container","mt-2"]],template:function(e,t){1&e&&(yb(0,"app-header"),pb(1,"main",0),yb(2,"router-outlet"),gb())},directives:[rre,XM],encapsulation:2}),e}(),are=function(){function e(t,n){sp(this,e),this.x=t,this.y=n}return cp(e,[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),ore=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"isDown",value:function(){return 1===this.y}},{key:"isUp",value:function(){return-1===this.y}},{key:"isLeft",value:function(){return-1===this.x}},{key:"isRight",value:function(){return 1===this.x}},{key:"toInt",value:function(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}},{key:"toString",value:function(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}]),n}(are),sre=function(){function e(){sp(this,e)}return cp(e,[{key:"of",value:function(e,t){var n,r=ip(this.all);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.x===e&&i.y===t)return J5.success(i)}}catch(a){r.e(a)}finally{r.f()}return J5.failure("Invalid x and y in direction construction")}},{key:"fromDelta",value:function(e,t){return 0===e&&0===t?J5.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):J5.failure("Invalid delta for direction: ".concat(e,", ").concat(t))}},{key:"fromMove",value:function(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}},{key:"fromString",value:function(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return J5.failure("Invalid direction string ".concat(e))}}},{key:"fromInt",value:function(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return J5.failure("Invalid int direction: ".concat(e))}}}]),e}(),ure=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,r)}return cp(n,[{key:"isDiagonal",value:function(){return 0!==this.x&&0!==this.y}},{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(ore);ure.UP=new ure(0,-1),ure.UP_RIGHT=new ure(1,-1),ure.RIGHT=new ure(1,0),ure.DOWN_RIGHT=new ure(1,1),ure.DOWN=new ure(0,1),ure.DOWN_LEFT=new ure(-1,1),ure.LEFT=new ure(-1,0),ure.UP_LEFT=new ure(-1,-1),ure.factory=new(function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).all=[ure.UP,ure.UP_RIGHT,ure.RIGHT,ure.DOWN_RIGHT,ure.DOWN,ure.DOWN_LEFT,ure.LEFT,ure.UP_LEFT],e}return cp(n)}(sre)),ure.DIRECTIONS=ure.factory.all,ure.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return a6("string"==typeof e,"Invalid encoded direction"),ure.factory.fromString(e).get()}}]),n}(tte));var cre=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,r)}return cp(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(ore);cre.UP=new cre(0,-1),cre.RIGHT=new cre(1,0),cre.DOWN=new cre(0,1),cre.LEFT=new cre(-1,0),cre.factory=new(function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).all=[cre.UP,cre.RIGHT,cre.DOWN,cre.LEFT],e}return cp(n,[{key:"of",value:function(e,t){return 0===e&&-1===t?J5.success(cre.UP):1===e&&0===t?J5.success(cre.RIGHT):0===e&&1===t?J5.success(cre.DOWN):-1===e&&0===t?J5.success(cre.LEFT):J5.failure("Invalid orthogonal from x and y")}}]),n}(sre)),cre.ORTHOGONALS=cre.factory.all,cre.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return a6("string"==typeof e,"Invalid encoded orthogonal"),cre.factory.fromString(e).get()}}]),n}(tte));var lre=function(){function e(t,n){sp(this,e),this.x=t,this.y=n}return cp(e,[{key:"getNext",value:function(t,n){var r;return new e(this.x+(n=null!==(r=n)&&void 0!==r?r:1)*t.x,this.y+n*t.y)}},{key:"getPrevious",value:function(e,t){var n;return this.getNext(e,-(t=null!==(n=t)&&void 0!==n?n:1))}},{key:"getLeft",value:function(t){return new e(this.x+t.y,this.y+-t.x)}},{key:"getRight",value:function(t){return new e(this.x+-t.y,this.y+t.x)}},{key:"getOpposite",value:function(){return new e(-this.x,-this.y)}},{key:"isInRange",value:function(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}},{key:"isNotInRange",value:function(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}},{key:"getDirectionToward",value:function(e){return ure.factory.fromMove(this,e)}},{key:"getOrthogonalDistance",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"getDistance",value:function(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}},{key:"isHexagonallyAlignedWith",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}},{key:"isAlignedWith",value:function(e){var t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}},{key:"getVectorToward",value:function(t){return new e(t.x-this.x,t.y-this.y)}},{key:"getMinimalVectorToward",value:function(e){return this.getVectorToward(e).toVector()}},{key:"getCoordsToward",value:function(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];for(var t=this.getDirectionToward(e).get(),n=this.getNext(t,1),r=[];!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}},{key:"toVector",value:function(){for(var t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n),i=this.x,a=this.y,o=2;o<=r;)i%o==0&&a%o==0?(i/=o,a/=o):o++;return new e(i,a)}},{key:"isBetween",value:function(e,t){var n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y}},{key:"compareTo",value:function(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}],[{key:"numberEncoder",value:function(t,n){return rte.tuple([rte.numberEncoder(t),rte.numberEncoder(n)],function(e){return[e.x,e.y]},function(t){return new e(t[0],t[1])})}}]),e}();lre.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"encode",value:function(e){return{x:e.x,y:e.y}}},{key:"decode",value:function(e){var t=e;return a6(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new lre(t.x,t.y)}}]),n}(tte));var hre=function(){var e=function(){function e(t){sp(this,e),this.messageDisplayer=t,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=hB.empty(),this.imagesLocation="assets/images/"}return cp(e,[{key:"message",value:function(e){this.messageDisplayer.gameMessage(e)}},{key:"cancelMove",value:function(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?e6.SUCCESS:(this.messageDisplayer.gameMessage(e),e6.failure(e))}},{key:"cancelMoveAttempt",value:function(){}},{key:"getPlayerClass",value:function(e){switch(e){case ote.ZERO:return"player0";case ote.ONE:return"player1";default:return oB.expectToBe(e,ate.NONE),""}}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i6.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name}));case 1:case"end":return t.stop()}},t)}))()}},{key:"getTurn",value:function(){return this.rules.node.gameState.turn}},{key:"getCurrentPlayer",value:function(){return this.rules.node.gameState.getCurrentPlayer()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"range",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),fre=function(){var e,t=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getHexaCoordsBy",value:function(e,t){var n=new lre(e,t);return this.getHexaCoordsAt(n)}},{key:"getHexaCoordsAt",value:function(e){var t,n="",r=this.hexaLayout.getHexaCoordsAt(e),i=ip(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;n+=a.x+" "+a.y+" "}}catch(o){i.e(o)}finally{i.f()}return n+=r[0].x+" "+r[0].y}},{key:"getCenterBy",value:function(e,t){var n=new lre(e,t);return this.getCenterAt(n)}},{key:"getCenterAt",value:function(e){return this.hexaLayout.getCenterAt(e)}}]),n}(hre);return t.\u0275fac=function(n){return(e||(e=sk(t)))(n||t)},t.\u0275cmp=oy({type:t,selectors:[["ng-component"]],features:[jC],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),dre=function(){function e(t){sp(this,e),this.value=t}return cp(e,[{key:"equals",value:function(e){return this===e}},{key:"is",value:function(e){return this.value===e.value}},{key:"isPlayer",value:function(){return this===e.ZERO||this===e.ONE}}],[{key:"from",value:function(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.NONE.value:return e.NONE;default:throw new Error("FourStatePiece has no value matching "+t)}}},{key:"ofPlayer",value:function(t){switch(t){case ote.ZERO:return e.ZERO;default:return oB.expectToBe(t,ote.ONE),e.ONE}}}]),e}();dre.ZERO=new dre(ote.ZERO.value),dre.ONE=new dre(ote.ONE.value),dre.EMPTY=new dre(ate.NONE.value),dre.NONE=new dre(3);var vre=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,r)}return cp(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}],[{key:"getAngle",value:function(e){switch(e){case n.UP:return 0;case n.UP_RIGHT:return 60;case n.RIGHT:return 120;case n.DOWN:return 180;case n.DOWN_LEFT:return 240;default:return oB.expectToBe(e,n.LEFT),300}}}]),n}(ore);vre.UP=new vre(0,-1),vre.LEFT=new vre(-1,0),vre.UP_RIGHT=new vre(1,-1),vre.DOWN_LEFT=new vre(-1,1),vre.RIGHT=new vre(1,0),vre.DOWN=new vre(0,1),vre.factory=new(function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).all=[vre.UP,vre.UP_RIGHT,vre.RIGHT,vre.DOWN,vre.DOWN_LEFT,vre.LEFT],e}return cp(n)}(sre)),vre.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){switch(e){case vre.UP:return 0;case vre.UP_RIGHT:return 1;case vre.RIGHT:return 2;case vre.DOWN:return 3;case vre.DOWN_LEFT:return 4;default:return 5}}},{key:"decodeNumber",value:function(e){return a6(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),vre.factory.all[e]}}]),n}(rte));var pre=function(){function e(t,n,r){sp(this,e),this.size=t,this.origin=n,this.orientation=r}return cp(e,[{key:"getCenterAt",value:function(e){var t=this.orientation.conversionMatrix;return new lre(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}},{key:"getCornerOffset",value:function(e){var t=2*Math.PI*(this.orientation.startAngle+e)/6;return new lre(this.size*Math.cos(t),this.size*Math.sin(t))}},{key:"getHexaCoordsAt",value:function(e){for(var t=this.getCenterAt(e),n=[],r=0;r<6;r+=1){var i=this.getCornerOffset(r);n.push(new lre(t.x+i.x,t.y+i.y))}return n}}]),e}(),gre=cp(function e(){sp(this,e)}),yre=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.call(this)).startAngle=.5,e.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],e.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3],e}return cp(n)}(gre);yre.INSTANCE=new yre;var mre=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.call(this)).startAngle=0,e.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],e.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3],e}return cp(n,[{key:"isOnBorder",value:function(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}},{key:"isOnTopRightBorder",value:function(e,t){return 0===t.y}},{key:"isOnRightBorder",value:function(e,t){return t.x===e.width-1}},{key:"isOnLeftBorder",value:function(e,t){return 0===t.x}},{key:"isOnBottomLeftBorder",value:function(e,t){return t.y===e.height-1}},{key:"isOnTopLeftBorder",value:function(e,t){return null!=e.excludedCases[t.y]?t.x===e.excludedCases[t.y]:t.y===e.excludedCases.length&&0===t.x}},{key:"isOnBottomRightBorder",value:function(e,t){return null!=e.excludedCases[e.height-1-t.y]?e.width-1-t.x===e.excludedCases[e.height-1-t.y]:e.height-1-t.y===e.excludedCases.length&&t.x===e.width-1}},{key:"getAllBorders",value:function(e){var t=this,n=[];return e.forEachCoord(function(r,i){t.isOnBorder(e,r)&&n.push(r)}),n}},{key:"isTopCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}},{key:"isTopLeftCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isTopRightCorner",value:function(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}},{key:"isBottomCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}},{key:"isBottomLeftCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isBottomRightCorner",value:function(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}]),n}(gre);mre.INSTANCE=new mre;var kre=function(){var e=cp(function e(){sp(this,e)});return e.CANNOT_CHOOSE_OPPONENT_PIECE=function(){return $localize(O||(O=Vv(["You cannot pick a piece of the opponent."])))},e.MUST_CLICK_ON_EMPTY_SPACE=function(){return $localize(T||(T=Vv(["You must click on an empty space."])))},e.CANNOT_SELF_CAPTURE=function(){return $localize(I||(I=Vv(["Your landing space should be empty or contain a piece of the opponent."])))},e.MUST_CHOOSE_PLAYER_PIECE=function(){return $localize(x||(x=Vv(["You must pick one of your pieces."])))},e.CANNOT_PASS=function(){return $localize(A||(A=Vv(["You cannot pass your turn."])))},e.MUST_LAND_ON_EMPTY_SPACE=function(){return $localize(R||(R=Vv(["You must drop your piece on an empty space."])))},e.MUST_PASS=function(){return $localize(N||(N=Vv(["You must pass your turn."])))},e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=function(){return $localize(M||(M=Vv(["You have selected an empty space, you must select one of your own pieces."])))},e.MOVE_CANNOT_BE_STATIC=function(){return $localize(D||(D=Vv(["You must choose different starting and ending coordinates."])))},e}(),_re=function(){function e(t,n){sp(this,e),this.ruler=t,this.name=n}return cp(e,[{key:"toString",value:function(){return this.name}}]),e}(),wre=function(){function e(t){sp(this,e),this.value=t}return cp(e,[{key:"toString",value:function(){return""+this.value}}],[{key:"fromWinner",value:function(t){return t.isPlayer()?new e(t.getVictoryValue()):new e(0)}}]),e}(),Cre=function(){function e(){sp(this,e)}return cp(e,null,[{key:"toComparableObjectSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return t.equals(e)})||t.push(e)}),t}},{key:"toComparableSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return lB(t,e)})||t.push(e)}),t}}]),e}(),bre=function(e){function t(e){sp(this,t),this.values=void 0===e?[]:Cre.toComparableSet(e)}return cp(t,[{key:"equals",value:function(e){if(e.size()!==this.size())return!1;var t,n=ip(this);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===e.contains(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"toString",value:function(){var e,t="",n=ip(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=null==r?"null, ":r.toString()+", "}}catch(i){n.e(i)}finally{n.f()}return"["+t.slice(0,-2)+"]"}},{key:"add",value:function(e){return!this.contains(e)&&(this.values.push(e),!0)}},{key:"union",value:function(e){var t,n=ip(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"contains",value:function(e){var t,n=ip(this.values);try{for(n.s();!(t=n.n()).done;){if(lB(t.value,e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"size",value:function(){return this.values.length}},{key:"toList",value:function(){var e,t=[],n=ip(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getAnyElement",value:function(){return this.size()>0?hB.of(this.values[0]):hB.empty()}},{key:Symbol.iterator,value:function(){return this.values.values()}}]),t}(),Ere=function(){function e(t){sp(this,e),this.turn=t}return cp(e,[{key:"getCurrentPlayer",value:function(){return ote.fromTurn(this.turn)}},{key:"getCurrentOpponent",value:function(){return this.turn%2==1?ote.ZERO:ote.ONE}}]),e}(),Sre=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,r)).board=e,i}return cp(n,[{key:"getPieceAt",value:function(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}},{key:"isOnBoard",value:function(e){return e.isInRange(this.board[0].length,this.board.length)}},{key:"getPieceAtXY",value:function(e,t){return this.getPieceAt(new lre(e,t))}},{key:"forEachCoord",value:function(e){var t,n=ip(this.getCoordsAndContents());try{for(n.s();!(t=n.n()).done;){var r=Hv(t.value,2);e(r[0],r[1])}}catch(i){n.e(i)}finally{n.f()}}},{key:"getCoordsAndContents",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new lre(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}},{key:"getCopiedBoard",value:function(){return lte.copyBiArray(this.board)}}]),n}(Ere),Pre=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"isInBoard",value:function(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==dre.NONE}},{key:"isPiece",value:function(e){return this.getPieceAt(e).isPlayer()}},{key:"getScores",value:function(){for(var e=[14,14],t=0;t<9;t++)for(var n=0;n<9;n++)this.getPieceAtXY(n,t)===dre.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===dre.ONE&&(e[0]=e[0]-1);return e}}],[{key:"getInitialState",value:function(){var e=dre.EMPTY,t=dre.NONE,r=dre.ZERO,i=dre.ONE;return new n([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}}]),n}(Sre),Ore=cp(function e(){sp(this,e)}),Tre=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).coord=new lre(e,r),i}return cp(n)}(Ore),Ire=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;if(sp(this,n),(a=t.call(this,e.x,e.y)).dir=r,a.lastPiece=i,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!");return Qv(a)}return cp(n,[{key:"toString",value:function(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}},{key:"isSingleCoord",value:function(){return this.lastPiece.isAbsent()}},{key:"equals",value:function(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}],[{key:"fromSingleCoord",value:function(e,t){try{return J5.success(new n(e,t,hB.empty()))}catch(r){return J5.failure(r.message)}}},{key:"fromDoubleCoord",value:function(e,t,r){var i=[e,t];lte.sortByDescending(i,n.sortCoord);var a=i[1].getDirectionToward(i[0]).get(),o=vre.factory.fromDelta(a.x,a.y);if(o.isFailure())return J5.failure("Invalid direction");var s=o.get();return i[1].getDistance(i[0])>2?J5.failure("Distance between first coord and last coord is too great"):s.equals(r)?n.fromSingleCoord(i[1],r):s.getOpposite().equals(r)?n.fromSingleCoord(i[0],r):J5.success(new n(i[1],r,hB.of(i[0])))}},{key:"sortCoord",value:function(e){return 9*e.y+e.x}}]),n}(Tre);Ire.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 104831}},{key:"encodeNumber",value:function(e){var t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;var n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}},{key:"decodeNumber",value:function(e){var t=e%8;e=(e-t)/8;var n=vre.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;var a=new lre(i,r);if(0===e)return Ire.fromSingleCoord(a,n).get();var o=(e=(e-1)/2)%9,s=(e=(e-o)/9)%9;e=(e-s)/9;var u=new lre(s,o);return Ire.fromDoubleCoord(a,u,n).get()}}]),n}(rte));var xre=(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(xre||(xre={})),xre),Are=function(){function e(){sp(this,e),this.map=[],this.isImmutable=!1}return cp(e,[{key:"makeImmutable",value:function(){this.isImmutable=!0}},{key:"get",value:function(e){var t,n=ip(this.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(lB(r.key,e))return hB.of(r.value)}}catch(i){n.e(i)}finally{n.f()}return hB.empty()}},{key:"forEach",value:function(e){for(var t=0;t<this.map.length;t++)e(this.getByIndex(t))}},{key:"getByIndex",value:function(e){return this.map[e]}},{key:"putAll",value:function(e){this.checkImmutability("putAll");var t,n=ip(e.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r.key,r.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"checkImmutability",value:function(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}},{key:"put",value:function(e,t){this.checkImmutability("put");var n,r=ip(this.map);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(lB(i.key,e)){var a=i.value;return i.value=t,hB.of(a)}}}catch(o){r.e(o)}finally{r.f()}return this.map.push({key:e,value:t}),hB.empty()}},{key:"containsKey",value:function(e){return this.map.some(function(t){return lB(t.key,e)})}},{key:"size",value:function(){return this.map.length}},{key:"listKeys",value:function(){return this.map.map(function(e){return e.key})}},{key:"getKeySet",value:function(){return new bre(this.listKeys())}},{key:"filter",value:function(t){var n,r=new e,i=ip(this.map);try{for(i.s();!(n=i.n()).done;){var a=n.value;t(a.key,a.value)&&r.set(a.key,a.value)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"replace",value:function(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}},{key:"set",value:function(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}},{key:"delete",value:function(e){this.checkImmutability("delete");for(var t=0;t<this.map.length;t++)if(lB(this.map[t].key,e)){var n=this.map[t].value,r=this.map.slice(0,t),i=this.map.slice(t+1);return this.map=r.concat(i),n}throw new Error('No Value to delete for key "'+e.toString()+'"!')}},{key:"getCopy",value:function(){var e,t=new this.constructor,n=ip(this.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.set(r,this.get(r).get())}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"equals",value:function(e){var t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;var r,i=ip(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this.get(a).get(),s=e.get(a);if(a6(s.isPresent(),"value is absent in a map even though its key is present!"),!1===lB(o,s.get()))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}}]),e}(),Rre=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"reverse",value:function(){var e,t=new n,r=ip(this.listKeys());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.get(i).get();if(t.containsKey(a))t.get(a).get().add(i);else{var o=new bre;o.add(i),t.set(a,o)}}}catch(s){r.e(s)}finally{r.f()}return t}}]),n}(Are),Nre=function(){var e=cp(function e(){sp(this,e)});return e.createdNodes=0,e.minimaxTime=0,e}(),Mre=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hB.empty(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:hB.empty(),i=arguments.length>3?arguments[3]:void 0;if(sp(this,e),this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=hB.empty(),this.hopedValue=new Are,this.ownValue=new Are,this.possibleMoves=new Are,this.ownValue=new Are,null!=i){var a=i.getBoardValue(this);this.ownValue.set(i.name,a),this.hopedValue.set(i.name,a.value)}Nre.createdNodes++,sB(e.VERBOSE||!1,"creating "+this.myToString())}return cp(e,[{key:"findBestMove",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(new Date).getTime(),a=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);a.gameState.turn>this.gameState.turn+1;)a=a.mother.get(),e--;return Nre.minimaxTime+=(new Date).getTime()-i,a.move.get()}},{key:"alphaBeta",value:function(t,n,r,i,a,o){if(t<1)return sB(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return sB(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;var s=this.getPossibleMoves(i);a6(s.length>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=hB.of([]));var u,c,l=[],h=this.gameState.getCurrentPlayer(),f=h===ote.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,d=h===ote.ZERO?function(e,t){return e<t}:function(e,t){return e>t},v=ip(s);try{for(v.s();!(u=v.n()).done;){var p=u.value,g=this.getOrCreateChild(p,i).alphaBeta(t-1,n,r,i,a,o),y=g.getHopedValue(i);if(d(y,f)||0===l.length?(f=y,l=[g]):y===f&&l.push(g),o&&d(f,h===ote.ZERO?n:r))break;h===ote.ZERO?r=Math.min(f,r):n=Math.max(f,n)}}catch(k){v.e(k)}finally{v.f()}var m=(c=a?l[Math.floor(Math.random()*l.length)]:l[0]).hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),m),c}},{key:"getPossibleMoves",value:function(e){var t=this.possibleMoves.get(e.name);if(t.isAbsent()){var n=e.getListMoves(this);return this.possibleMoves.set(e.name,new bre(n)),n}return t.get().toList()}},{key:"getOrCreateChild",value:function(t,n){var r=this.getSonByMove(t);if(r.isAbsent()){var i=n.ruler.isLegal(t,this.gameState);a6(i.isSuccess(),"The minimax has accepted an illegal move, this should not happen.");var a=n.ruler.applyLegalMove(t,this.gameState,i.get());r=hB.of(new e(a,hB.of(this),hB.of(t),n)),this.childs.get().push(r.get())}return r.get()}},{key:"getSonByMove",value:function(e){a6(this.childs.isPresent(),"Cannot get son of uncalculated node");var t,n=ip(this.childs.get());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.move.isPresent()&&r.move.equalsValue(e))return hB.of(r)}}catch(i){n.e(i)}finally{n.f()}return hB.empty()}},{key:"getInitialNode",value:function(){for(var e=this;e.mother.isPresent();)e=e.mother.get();return e}},{key:"getHopedValue",value:function(e){return this.hopedValue.get(e.name).get()}},{key:"getOwnValue",value:function(e){var t=this.ownValue.get(e.name);if(t.isAbsent()){var n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}},{key:"myToString",value:function(){var e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}},{key:"hasMoves",value:function(){return this.childs.isPresent()}},{key:"countDescendants",value:function(){if(this.childs.isAbsent())return 0;var e,t=this.childs.get().length,n=ip(this.childs.get());try{for(n.s();!(e=n.n()).done;){t+=e.value.countDescendants()}}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"getScoreStatus",value:function(t){var n=!1;return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(sB(e.VERBOSE||n,"VICTORY"),xre.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(sB(e.VERBOSE||n,"PRE_VICTORY_MIN"),xre.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(sB(e.VERBOSE||n,"PRE_VICTORY_MAX"),xre.PRE_VICTORY):(sB(e.VERBOSE||n,"DEFAULT"),xre.DEFAULT)}}]),e}();Mre.VERBOSE=!1,Mre.minimaxes=new Are;var Dre=function(){function e(t,n){sp(this,e),this.isEndGame=t,this.winner=n}return cp(e,[{key:"toBoardValue",value:function(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}],[{key:"getVictory",value:function(t){return t===ote.ZERO?e.ZERO_WON:e.ONE_WON}},{key:"getDefeat",value:function(t){return t===ote.ZERO?e.ONE_WON:e.ZERO_WON}}]),e}();Dre.ZERO_WON=new Dre(!0,ote.ZERO),Dre.ONE_WON=new Dre(!0,ote.ONE),Dre.DRAW=new Dre(!0,ate.NONE),Dre.ONGOING=new Dre(!1,ate.NONE);var Lre=function(){function e(t){sp(this,e),this.stateType=t,this.setInitialBoard()}return cp(e,[{key:"choose",value:function(e){var t=!1;sB(t,"Rules.choose: "+e.toString()+" was proposed");var n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){sB(t,"Rules.choose: current node has moves");var r=this.node.getSonByMove(e);if(r.isPresent())return a6(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),sB(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(sB(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return sB(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;sB(t,"Rules.choose: Move is legal, let's apply it");var i=this.applyLegalMove(e,this.node.gameState,n.get()),a=new Mre(i,hB.of(this.node),hB.of(e));return this.node=a,!0}},{key:"setInitialBoard",value:function(){if(null==this.node){var e=this.stateType.getInitialState();Mre.ruler=this,this.node=new Mre(e)}else this.node=this.node.getInitialNode()}},{key:"applyMoves",value:function(e,t,n){var r,i=0,a=ip(e);try{for(a.s();!(r=a.n()).done;){var o=n(r.value),s=this.isLegal(o,t);a6(s.isSuccess(),"Can't create state from invalid moves ("+i+"): "+s.toString()+"."),t=this.applyLegalMove(o,t,s.get()),i++}}catch(u){a.e(u)}finally{a.f()}return t}}]),e}(),Fre=function(){var e=cp(function e(){sp(this,e)});return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=function(){return $localize(L||(L=Vv(["You cannot move more than 3 of your pieces!"])))},e.NOT_ENOUGH_PIECE_TO_PUSH=function(){return $localize(F||(F=Vv(["You don't have enough pieces to push that group!"])))},e.CANNOT_PUSH_YOUR_OWN_PIECES=function(){return $localize(B||(B=Vv(["You cannot push this piece because it is blocked by one of yours!"])))},e.MUST_ONLY_TRANSLATE_YOUR_PIECES=function(){return $localize(U||(U=Vv(["This line contains pieces of your opponent or empty spaces, which is forbidden."])))},e.TRANSLATION_IMPOSSIBLE=function(){return $localize(V||(V=Vv(["This move is impossible, some landing spaces are occupied."])))},e.LINE_AND_COORD_NOT_ALIGNED=function(){return $localize(z||(z=Vv(["This space is not aligned with the current line."])))},e}(),Bre=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){return new Pre(n,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toFailedFallible():e.isSingleCoord()?n.isLegalPush(e,t):n.isLegalSideStep(e,t)}},{key:"getFirstPieceValidity",value:function(e,t){var n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?e6.failure(kre.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===dre.ofPlayer(t.getCurrentOpponent())?e6.failure(kre.CANNOT_CHOOSE_OPPONENT_PIECE()):e6.SUCCESS}},{key:"isLegalPush",value:function(e,t){var r=1,i=e.coord.getNext(e.dir),a=dre.ofPlayer(t.getCurrentPlayer()),o=dre.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=o;r<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===a;)r++,i=i.getNext(e.dir);return r>3?J5.failure(Fre.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(i)||(s[i.y][i.x]=a,t.getPieceAt(i)===o)?J5.success(s):n.isLegalRealPush(i,e,t,r,s)}},{key:"isLegalRealPush",value:function(e,t,n,r,i){for(var a=0,o=dre.ofPlayer(n.getCurrentOpponent()),s=dre.ofPlayer(n.getCurrentPlayer());a<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)a++,e=e.getNext(t.dir);return a>=r?J5.failure(Fre.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===dre.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===s)?J5.failure(Fre.CANNOT_PUSH_YOUR_OWN_PIECES()):J5.success(i)}},{key:"isLegalSideStep",value:function(e,t){var n=e.lastPiece.get(),r=e.coord.getDirectionToward(n).get();n=n.getNext(r);for(var i=e.coord,a=dre.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==a)return J5.failure(Fre.MUST_ONLY_TRANSLATE_YOUR_PIECES());var s=i.getNext(e.dir);if(o[i.y][i.x]=dre.EMPTY,s.isInRange(9,9)){if(t.isPiece(s))return J5.failure(Fre.TRANSLATION_IMPOSSIBLE());t.getPieceAt(s)===dre.EMPTY&&(o[s.y][s.x]=a)}i=i.getNext(r)}return J5.success(o)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getScores();return t[0]>5?Dre.ZERO_WON:t[1]>5?Dre.ONE_WON:Dre.ONGOING}}]),n}(Lre),Ure=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<9;i++)for(var a=0;a<9;a++){var o=new lre(a,i);if(!1!==n.getPieceAt(o).is(r)){var s,u=ip(vre.factory.all);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=Ire.fromSingleCoord(o,c).get();if(this.isAcceptablePush(l,n)){t.push(l);var h,f=ip(vre.factory.all);try{for(f.s();!(h=f.n()).done;)for(var d=h.value,v=1;v<=2&&!d.equals(c);v++){var p=o.getNext(d,v);if(!p.isInRange(9,9))break;var g=Ire.fromDoubleCoord(o,p,c).get();Bre.isLegal(g,n).isSuccess()&&t.push(g)}}catch(y){f.e(y)}finally{f.f()}}}}catch(y){u.e(y)}finally{u.f()}}}return new bre(t).toList()}},{key:"isAcceptablePush",value:function(e,t){var n=t.getScores(),r=Bre.isLegal(e,t);if(r.isSuccess()){var i=t.getCurrentOpponent().value;return!(new Pre(r.get(),t.turn+1).getScores()[i]>n[i])}return!1}},{key:"getBoardValue",value:function(e){var t=Bre.getGameStatus(e);if(t.isEndGame)return new wre(t.toBoardValue());var n=e.gameState.getScores();return new wre(n[1]-n[0])}}]),n}(_re),Vre=function(){function e(t,n,r){sp(this,e),this.title=t,this.instruction=n,this.state=r,this.previousMove=hB.empty()}return cp(e,[{key:"isMove",value:function(){return!1}},{key:"isAnyMove",value:function(){return!1}},{key:"isClick",value:function(){return!1}},{key:"isPredicate",value:function(){return!1}},{key:"isInformation",value:function(){return!1}},{key:"hasSolution",value:function(){return!1}},{key:"withPreviousMove",value:function(e){return this.previousMove=hB.of(e),this}}],[{key:"fromMove",value:function(e,t,n,r,i,a){return new Hre(e,t,n,r,i,a)}},{key:"forClick",value:function(e,t,n,r,i,a){return new qre(e,t,n,r,i,a)}},{key:"anyMove",value:function(e,t,n,r,i){return new Gre(e,t,n,r,i)}},{key:"fromPredicate",value:function(e,t,n,r,i,a){return new $re(e,t,n,r,i,a)}},{key:"informational",value:function(e,t,n){return new Wre(e,t,n)}}]),e}(),zre=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o){var s;return sp(this,n),(s=t.call(this,e,r,i)).solution=a,s.successMessage=o,s}return cp(n,[{key:"hasSolution",value:function(){return!0}},{key:"getSolution",value:function(){return this.solution}},{key:"getSuccessMessage",value:function(){return this.successMessage}}]),n}(Vre),Hre=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s){var u;return sp(this,n),(u=t.call(this,e,r,i,a[0],o)).acceptedMoves=a,u.failureMessage=s,a6(a.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational"),u}return cp(n,[{key:"isMove",value:function(){return!0}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(zre),Gre=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o){return sp(this,n),t.call(this,e,r,i,a,o)}return cp(n,[{key:"isAnyMove",value:function(){return!0}}]),n}(zre),qre=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s){var u;return sp(this,n),(u=t.call(this,e,r,i)).acceptedClicks=a,u.successMessage=o,u.failureMessage=s,u}return cp(n,[{key:"isClick",value:function(){return!0}},{key:"getSuccessMessage",value:function(){return this.successMessage}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Vre),$re=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s){var u;return sp(this,n),(u=t.call(this,e,r,i,a,s)).predicate=o,u}return cp(n,[{key:"isPredicate",value:function(){return!0}}]),n}(zre),Wre=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"isInformation",value:function(){return!0}}]),n}(Vre),jre=dre.EMPTY,Zre=dre.NONE,Yre=dre.ZERO,Kre=dre.ONE,Jre=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(H||(H=Vv(["Initial board and goal of the game"]))),$localize(G||(G=Vv(["At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!"]))),Pre.getInitialState()),Vre.anyMove($localize(q||(q=Vv(["Moving a piece"]))),$localize($||($=Vv(["At each turn, move one, two, or three pieces either along their line, or on their side.\n        For your moves you can therefore choose between up to 6 directions.\n        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).\n        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>\n        You're playing Dark, make any move!"]))),Pre.getInitialState(),Ire.fromSingleCoord(new lre(2,6),vre.UP).get(),$localize(W||(W=Vv(["Congratulations!"])))),Vre.fromMove($localize(j||(j=Vv(["Pushing"]))),$localize(Z||(Z=Vv(["To push one opponent piece, you must move at least two of your pieces.\n        To push two opponent pieces, you must move three of your pieces.\n        If one of your pieces is in the way, it will be impossible to push.\n        You cannot move more than three pieces.<br/><br/>\n        Only one push towards the right is possible here, find it. (You're playing Dark)."]))),new Pre([[Zre,Zre,Zre,Zre,jre,Yre,Yre,Kre,Kre],[Zre,Zre,Zre,jre,jre,jre,jre,jre,jre],[Zre,Zre,jre,Yre,Yre,Yre,Kre,Yre,jre],[Zre,jre,jre,jre,jre,jre,jre,jre,jre],[jre,jre,jre,jre,Yre,Yre,Yre,Kre,Kre],[jre,jre,jre,jre,jre,jre,jre,jre,Zre],[jre,jre,jre,jre,Yre,Kre,jre,Zre,Zre],[jre,jre,jre,Yre,jre,jre,Zre,Zre,Zre],[jre,jre,Yre,jre,jre,Zre,Zre,Zre,Zre]],0),[Ire.fromSingleCoord(new lre(4,4),vre.RIGHT).get()],$localize(Y||(Y=Vv(["Congratulations! You know everything you need to start a game!"]))),$localize(K||(K=Vv(["Failed!"]))))]});function Qre(e,t){if(1&e){var n=_b();Pm(),pb(0,"circle",6),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onPieceClick(e,t)}),gb()}if(2&e){var r=Pb(2).index,i=Pb().index,a=Pb();Ib("id","piece_",r,"_",i,""),db("ngClass",a.getPieceClasses(r,i)),ob("cx",a.getCenterBy(r,i).x)("cy",a.getCenterBy(r,i).y)("r",.5*a.SPACE_SIZE)}}function Xre(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"polyline",4),bb("click",function(){Jy(n);var e=Pb().index,t=Pb().index;return Pb().onCaseClick(e,t)}),gb(),lb(2,Qre,1,6,"circle",5),gb()}if(2&e){var r=Pb(),i=r.index,a=r.$implicit,o=Pb().index,s=Pb();Rw(1),Ib("id","case_",i,"_",o,""),db("ngClass",s.getSquareClasses(i,o)),ob("points",s.getHexaCoordsBy(i,o)),Rw(1),db("ngIf",s.isPiece(a))}}function eie(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Xre,3,5,"g",3),gb()),2&e){var n=t.$implicit,r=Pb(2);Rw(1),db("ngIf",r.isBoard(n))}}function tie(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,eie,2,1,"g",1),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function nie(e,t){1&e&&(Pm(),pb(0,"marker",7),yb(1,"polygon",8),gb()),2&e&&Tb("id","arrowhead_",t.$implicit.dir.toString(),"")}function rie(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),yb(1,"line",9),pb(2,"line",10),bb("click",function(){var e=Jy(n).$implicit;return Pb().chooseDirection(e.dir)}),gb(),pb(3,"polygon",11),bb("click",function(){var e=Jy(n).$implicit;return Pb().chooseDirection(e.dir)}),gb(),gb()}if(2&e){var r=t.$implicit;Rw(1),Tb("id","line_start_",r.dir.toString(),""),ob("x1",r.startCenter.x)("y1",r.startCenter.y)("x2",r.middle.x)("y2",r.middle.y),Rw(1),Tb("id","line_end_",r.dir.toString(),""),ob("x1",r.middle.x)("y1",r.middle.y)("x2",r.landingCenter.x)("y2",r.landingCenter.y),Rw(1),Tb("id","direction_",r.dir.toString(),""),ob("transform",r.transformation)}}var iie=cp(function e(t,n,r,i,a,o){sp(this,e),this.startCenter=t,this.middle=n,this.landingCenter=r,this.landing=i,this.dir=a,this.transformation=o}),aie=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).moveds=[],r.directions=[],r.selecteds=[],r.rules=new Bre(Pre),r.availableMinimaxes=[new Ure(r.rules,"Dummy")],r.encoder=Ire.encoder,r.tutorial=(new Jre).tutorial,r.scores=hB.of([0,0]),r.SPACE_SIZE=30,r.hexaLayout=new pre(r.SPACE_SIZE,new lre(-8*r.SPACE_SIZE,2*r.SPACE_SIZE),yre.INSTANCE),r.updateBoard(),r}return cp(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.rules.node.gameState.getCopiedBoard(),this.scores=hB.of(this.rules.node.gameState.getScores())}},{key:"hidePreviousMove",value:function(){this.moveds=[]}},{key:"cancelMoveAttempt",value:function(){this.directions=[],this.selecteds=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}},{key:"showPushingMove",value:function(e){var t=this.rules.node.mother.get().gameState,n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}},{key:"showSideStepMove",value:function(e){var t=e.lastPiece.get(),n=e.coord.getDirectionToward(t).get();t=t.getNext(n);for(var r=e.coord;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}},{key:"onPieceClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#piece_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.rules.node.gameState.getCurrentOpponent(),r.abrupt("return",n.hexaBoard[t][e].is(a)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"opponentClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.tryChoosingDirection(e,t);case 2:if(!r.sent.isSuccess()){r.next=6;break}r.t0=e6.SUCCESS,r.next=7;break;case 6:r.t0=n.cancelMove(kre.CANNOT_CHOOSE_OPPONENT_PIECE());case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.selecteds=[new lre(e,t)],n.showPossibleDirections(),e6.SUCCESS));case 1:case"end":return r.stop()}},r)}))()}},{key:"showPossibleDirections",value:function(){this.directions=[],this.showDirection(1===this.selecteds.length)}},{key:"showDirection",value:function(e){var t,n=this.rules.node.gameState,r=dre.ofPlayer(n.getCurrentPlayer()),i=this.selecteds[0],a=this.selecteds[this.selecteds.length-1],o=ip(vre.factory.all);try{for(o.s();!(t=o.n()).done;){var s,u=t.value,c=i.getNext(u,1);if(n.isOnBoard(c)&&n.getPieceAt(c)===r){if(e)continue;if(c=a.getNext(u,1),n.isOnBoard(c)&&n.getPieceAt(c)===r)continue}if(s=e?Ire.fromSingleCoord(i,u).get():Ire.fromDoubleCoord(i,a,u).get(),this.rules.isLegal(s,n).isSuccess()){var l=this.getCenterAt(i),h=this.getCenterAt(c),f=this.getMiddleOfArrow(u,c,h),d=h.x+" "+h.y,v=vre.getAngle(u)+150,p=new iie(l,f,h,c,u,"rotate("+v+" "+d+") translate("+d+")");this.directions.push(p)}}}catch(g){o.e(g)}finally{o.f()}}},{key:"getMiddleOfArrow",value:function(e,t,n){var r=t.getPrevious(e),i=this.getCenterAt(r);return new lre(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}},{key:"isBoard",value:function(e){return e!==dre.NONE}},{key:"isPiece",value:function(e){return e!==dre.EMPTY}},{key:"secondClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.selecteds[0],!(a=new lre(e,t)).equals(i)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),e6.SUCCESS));case 3:if(!1!==a.isHexagonallyAlignedWith(i)){r.next=5;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 5:if(!((o=a.getDistance(i))>2)){r.next=8;break}return r.abrupt("return",n.cancelMove(Fre.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 8:for(s=i.getDirectionToward(a).get(),n.selecteds=[i],u=0;u<o;u++)n.selecteds.push(i.getNext(s,u+1));if(3!==n.selecteds.length){r.next=15;break}if(c=n.selecteds[1],l=n.rules.node.gameState.getCurrentPlayer(),!1!==n.hexaBoard[c.y][c.x].is(l)){r.next=15;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 15:return r.abrupt("return",(n.showPossibleDirections(),e6.SUCCESS));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new lre(e,t),a=n.selecteds[0],!i.equals(a)){r.next=3;break}return r.abrupt("return",n.deselectExtremity(!0));case 3:return o=n.selecteds[n.selecteds.length-1],r.abrupt("return",i.equals(o)?n.deselectExtremity(!1):3===n.selecteds.length&&i.equals(n.selecteds[1])?(n.cancelMoveAttempt(),e6.SUCCESS):n.tryExtension(i,a,o));case 5:case"end":return r.stop()}},r)}))()}},{key:"tryExtension",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=ure.factory.fromMove(t,e)).isSuccess()){i.next=6;break}if(o=ure.factory.fromMove(n,e),!a.equals(o)){i.next=6;break}return s=t.getDistance(e),u=n.getDistance(e),i.abrupt("return",2===Math.max(s,u)?(r.selecteds.push(e),lte.sortByDescending(r.selecteds,Ire.sortCoord),r.showPossibleDirections(),e6.SUCCESS):r.cancelMove(Fre.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 6:return c=r.cancelMove(Fre.LINE_AND_COORD_NOT_ALIGNED()),i.next=9,r.firstClick(e.x,e.y);case 9:return i.abrupt("return",c);case 10:case"end":return i.stop()}},i)}))()}},{key:"deselectExtremity",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),e6.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#direction_"+e.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t._chooseDirection(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"_chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.node.gameState,a=t.selecteds[0],n.abrupt("return",(i=1===t.selecteds.length?Ire.fromSingleCoord(a,e).get():Ire.fromDoubleCoord(a,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(i,r,t.scores.get())));case 3:case"end":return n.stop()}},n)}))()}},{key:"onCaseClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#case_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.tryChoosingDirection(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"tryChoosingDirection",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new lre(e,t),a=ip(n.directions),r.prev=2,a.s();case 4:if((o=a.n()).done){r.next=10;break}if(!(s=o.value).landing.equals(i)){r.next=8;break}return r.abrupt("return",n._chooseDirection(s.dir));case 8:r.next=4;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),a.e(r.t0);case 15:return r.prev=15,a.f(),r.finish(15);case 18:return r.abrupt("return",e6.failure("not a direction"));case 19:case"end":return r.stop()}},r,null,[[2,12,15,18]])}))()}},{key:"getSquareClasses",value:function(e,t){var n=new lre(e,t),r=[];return this.moveds.some(function(e){return e.equals(n)})&&r.push("moved"),r}},{key:"getPieceClasses",value:function(e,t){var n=new lre(e,t),r=ote.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(function(e){return e.equals(n)})&&i.push("highlighted"),i}}]),n}(fre);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-abalone"]],features:[jC],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,tie,2,1,"g",1),pb(2,"defs"),lb(3,nie,2,1,"marker",2),gb(),lb(4,rie,4,12,"g",1),gb()),2&e&&(Rw(1),db("ngForOf",t.hexaBoard),Rw(2),db("ngForOf",t.directions),Rw(1),db("ngForOf",t.directions))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),oie=function(){function e(t){sp(this,e),this.x=t}return cp(e,[{key:"equals",value:function(e){return this.x===e.x}}],[{key:"from",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return a6(3===t,"Invalid Apagos Coord "+t),e.THREE}}}]),e}();oie.ZERO=new oie(0),oie.ONE=new oie(1),oie.TWO=new oie(2),oie.THREE=new oie(3);var sie=function(){var e=cp(function e(){sp(this,e)});return e.PIECE_SHOULD_MOVE_DOWNWARD=function(){return $localize(J||(J=Vv(["Pieces should only move downward!"])))},e.CANNOT_LAND_ON_A_FULL_SQUARE=function(){return $localize(Q||(Q=Vv(["That square is already full, you cannot put a piece in it!"])))},e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=function(){return $localize(X||(X=Vv(["You have no pieces in that square, select one that contains at least one of your pieces!"])))},e.NO_PIECE_REMAINING_TO_DROP=function(){return $localize(ee||(ee=Vv(["There are no remaining pieces of that color to drop!"])))},e.NO_POSSIBLE_TRANSFER_REMAINS=function(){return $localize(te||(te=Vv(["There is no possible transfer from that square!"])))},e}(),uie=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this)).landing=e,a.piece=r,a.starting=i,a}return cp(n,[{key:"isDrop",value:function(){return this.piece.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}},{key:"equals",value:function(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}],[{key:"drop",value:function(e,t){return oB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(hB.empty())}))}},{key:"transfer",value:function(e,t){if(e.x<=t.x)return J5.failure(sie.PIECE_SHOULD_MOVE_DOWNWARD());var r=oB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(t)&&n.piece.equals(hB.empty())&&n.starting.equals(hB.of(e))}));return J5.success(r)}}]),n}(Ore);uie.ALL_MOVES=[new uie(oie.ZERO,hB.of(ote.ZERO),hB.empty()),new uie(oie.ONE,hB.of(ote.ZERO),hB.empty()),new uie(oie.TWO,hB.of(ote.ZERO),hB.empty()),new uie(oie.THREE,hB.of(ote.ZERO),hB.empty()),new uie(oie.ZERO,hB.of(ote.ONE),hB.empty()),new uie(oie.ONE,hB.of(ote.ONE),hB.empty()),new uie(oie.TWO,hB.of(ote.ONE),hB.empty()),new uie(oie.THREE,hB.of(ote.ONE),hB.empty()),new uie(oie.TWO,hB.empty(),hB.of(oie.THREE)),new uie(oie.ONE,hB.empty(),hB.of(oie.THREE)),new uie(oie.ZERO,hB.empty(),hB.of(oie.THREE)),new uie(oie.ONE,hB.empty(),hB.of(oie.TWO)),new uie(oie.ZERO,hB.empty(),hB.of(oie.TWO)),new uie(oie.ZERO,hB.empty(),hB.of(oie.ONE))],uie.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return uie.ALL_MOVES.length}},{key:"encodeNumber",value:function(e){var t=uie.ALL_MOVES.findIndex(function(t){return t.equals(e)});return a6(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}},{key:"decodeNumber",value:function(e){return a6(e<uie.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),uie.ALL_MOVES[e]}}]),n}(rte));var cie=function(){function e(t){sp(this,e),this.containing=t}return cp(e,[{key:"isFull",value:function(){return this.count(ote.ZERO)+this.count(ote.ONE)>=this.count(ate.NONE)}},{key:"count",value:function(e){return this.containing.get(e).get()}},{key:"addPiece",value:function(t){var n=this.count(ote.ZERO),r=this.count(ote.ONE),i=this.count(ate.NONE);return t===ote.ZERO?n++:r++,e.from(n,r,i).get()}},{key:"substractPiece",value:function(t){var n=this.count(ote.ZERO),r=this.count(ote.ONE),i=this.count(ate.NONE);return t===ote.ZERO?n--:r--,e.from(n,r,i).get()}},{key:"getDominatingPlayer",value:function(){var e=this.count(ote.ZERO),t=this.count(ote.ONE);return e>t?ote.ZERO:t>e?ote.ONE:ate.NONE}},{key:"equals",value:function(e){return this.containing.equals(e.containing)}}],[{key:"from",value:function(t,n,r){if(t+n>r)return J5.failure("invalid starting space");var i=new Are;i.set(ote.ZERO,t),i.set(ote.ONE,n),i.set(ate.NONE,r),i.makeImmutable();var a=new e(i);return J5.success(a)}}]),e}(),lie=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e)).board=r,a.remaining=i,a.remaining.makeImmutable(),a}return cp(n,[{key:"getPieceAt",value:function(e){return this.board[e.x]}},{key:"updateAt",value:function(e,t){for(var r=[],i=0;i<4;i++)r.push(e.x===i?t:this.board[i]);var a=this.getRemainingCopy();return new n(this.turn,r,a)}},{key:"getRemainingCopy",value:function(){return this.remaining.getCopy()}},{key:"getRemaining",value:function(e){return this.remaining.get(e).get()}},{key:"equals",value:function(e){return this.turn===e.turn&&lte.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}},{key:"fromRepresentation",value:function(e,t,r,i){for(var a=[],o=0;o<4;o++){var s=cie.from(t[0][o],t[1][o],t[2][o]).get();a.push(s)}var u=new Are;return u.set(ote.ZERO,r),u.set(ote.ONE,i),new n(e,a,u)}}]),n}(Ere);return e.PIECES_PER_PLAYER=10,e}(),hie=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);var i=new lie(t.turn+1,t.board,n),a=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(a);if(e.landing===oie.THREE)return i.updateAt(e.landing,o);var s=oie.from(e.landing.x+1),u=i.getPieceAt(s);return i.updateAt(e.landing,u).updateAt(s,o)}},{key:"applyLegalTransfer",value:function(e,t){var n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),a=t.getPieceAt(e.landing).addPiece(n),o=t.updateAt(r,i);return o=o.updateAt(e.landing,a),new lie(o.turn+1,o.board,o.remaining)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.landing).isFull()?J5.failure(sie.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}},{key:"isLegalDrop",value:function(e,t){return t.getRemaining(e.piece.get())<=0?J5.failure(sie.NO_PIECE_REMAINING_TO_DROP()):J5.success(void 0)}},{key:"isLegalSlideDown",value:function(e,t){var n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?J5.failure(sie.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):J5.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=0;n<4;n++)if(!1===t.getPieceAt(oie.from(n)).isFull())return Dre.ONGOING;var r=t.getPieceAt(oie.THREE).getDominatingPlayer();return a6(r.isPlayer(),"winner can only be a player if the game is finished"),Dre.getVictory(r)}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=hB.of(new n(lie))),this.singleton.get()}}]),n}(Lre);hie.singleton=hB.empty();var fie=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t=e.gameState;return uie.ALL_MOVES.filter(function(e){return hie.get().isLegal(e,t).isSuccess()})}},{key:"getBoardValue",value:function(e){var t=hie.get().getGameStatus(e);if(t.isEndGame)return wre.fromWinner(t.winner);var n=e.gameState.board[3].getDominatingPlayer();return n.isPlayer()?new wre(n.getScoreModifier()):new wre(0)}}]),n}(_re),die=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(ne||(ne=Vv(["Initial board and goal of the game"]))),$localize(re||(re=Vv(["At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!"]))),lie.getInitialState()),Vre.anyMove($localize(ie||(ie=Vv(["Drop"]))),$localize(ae||(ae=Vv(["There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You play Light.<br/><br/>Drop a piece on one of those three squares."]))),lie.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),uie.drop(oie.ZERO,ote.ZERO),$localize(oe||(oe=Vv(["Congratulations!"])))),Vre.fromPredicate($localize(se||(se=Vv(["Transfer"]))),$localize(ue||(ue=Vv(["The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!"]))),lie.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),uie.transfer(oie.TWO,oie.ZERO).get(),function(e,t){return e.isDrop()?e6.failure($localize(ce||(ce=Vv(["This move is a drop, please do a transfer!"])))):e6.SUCCESS},$localize(le||(le=Vv(["Congratulations!"])))),Vre.fromPredicate($localize(he||(he=Vv(["Victory"]))),$localize(fe||(fe=Vv(["When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!"]))),lie.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),uie.drop(oie.TWO,ote.ONE),function(e,t){return e.isDrop()?e.piece.equalsValue(ote.ONE)?e6.SUCCESS:e6.failure($localize(de||(de=Vv(["You actively made your opponent win!"])))):e6.failure($localize(ve||(ve=Vv(["Wrong choice, your opponent will win in the next turn no matter which piece is dropped!"]))))},$localize(pe||(pe=Vv(["Congratulations!"]))))]});function vie(e,t){if(1&e&&(Pm(),yb(0,"circle",5)),2&e){var n=t.$implicit,r=Pb();ob("cx",(n+1)*r.PIECE_RADIUS)("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function pie(e,t){if(1&e){var n=_b();Pm(),pb(0,"polygon",7),bb("click",function(){Jy(n);var e=Pb().index,t=Pb();return t.onArrowClick(e,t.PlayerOrNone.ZERO)}),gb()}if(2&e){var r=Pb().index,i=Pb();Tb("id","dropArrow_zero_",r,""),db("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ZERO)),ob("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.PlayerOrNone.ZERO))}}function gie(e,t){if(1&e){var n=_b();Pm(),pb(0,"polygon",7),bb("click",function(){Jy(n);var e=Pb().index,t=Pb();return t.onArrowClick(e,t.PlayerOrNone.ONE)}),gb()}if(2&e){var r=Pb().index,i=Pb();Tb("id","dropArrow_one_",r,""),db("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ONE)),ob("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.PlayerOrNone.ONE))}}function yie(e,t){if(1&e){var n=_b();Pm(),mb(0),pb(1,"circle",8),bb("click",function(){Jy(n);var e=Pb().index;return Pb().onSquareClick(e)}),gb(),kb()}if(2&e){var r=t.$implicit,i=Pb(),a=i.index,o=i.$implicit,s=Pb();Rw(1),xb("id","square_",a,"_piece_",r,"_out_of_",o.count(s.PlayerOrNone.NONE),""),db("ngClass",s.getPieceClasses(a,r,o)),ob("cx",s.getCircleCenter(a,r,o).x)("cy",s.getCircleCenter(a,r,o).y)}}function mie(e,t){if(1&e){var n=_b();Pm(),mb(0),lb(1,pie,1,4,"polygon",6),lb(2,gie,1,4,"polygon",6),pb(3,"rect",7),bb("click",function(){var e=Jy(n).index;return Pb().onSquareClick(e)}),gb(),lb(4,yie,2,6,"ng-container",3),kb()}if(2&e){var r=t.$implicit,i=t.index,a=Pb();Rw(1),db("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ZERO)),Rw(1),db("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ONE)),Rw(1),Tb("id","square_",i,""),db("ngClass",a.getSquareClasses(i)),ob("x",i*a.SPACE_SIZE)("y",(5-i)*a.SPACE_SIZE*.25)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Rw(1),db("ngForOf",a.range(r.count(a.PlayerOrNone.NONE)))}}function kie(e,t){if(1&e&&(Pm(),yb(0,"circle",9)),2&e){var n=t.$implicit,r=Pb();ob("cx",4*r.SPACE_SIZE-(n+1)*r.PIECE_RADIUS)("cy",2.25*r.SPACE_SIZE+3*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}var _ie=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).PlayerOrNone=ate,r.ARROW_COORD=n.getArrowCoord(),r.PIECES_PER_PLAYER=lie.PIECES_PER_PLAYER,r.selectedPiece=hB.empty(),r.leftPiece=hB.empty(),r.droppedPiece=hB.empty(),r.displayableArrow=[],r.rules=new hie(lie),r.availableMinimaxes=[new fie(r.rules,"ApagosDummyMinimax")],r.encoder=uie.encoder,r.tutorial=(new die).tutorial,r.PIECE_RADIUS=200/(r.PIECES_PER_PLAYER+1),r.updateBoard(),r}return cp(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=hB.empty(),this.showPossibleDrops()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.board,this.remainingZero=e.remaining.get(ote.ZERO).get(),this.remainingOne=e.remaining.get(ote.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}},{key:"hideLastMove",value:function(){this.movedSquare=[],this.droppedPiece=hB.empty(),this.leftPiece=hB.empty(),this.selectedPiece=hB.empty()}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}},{key:"showLastDrop",value:function(e){var t=e.piece.get(),n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));var r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=hB.of({square:n,piece:r})}},{key:"getLowestPlayerPiece",value:function(e,t){var n=e.count(t);return t===ote.ZERO?n-1:e.count(ate.NONE)-n}},{key:"showLastTransfer",value:function(e){var t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=hB.of({square:r,piece:i});var a=e.landing.x,o=this.getLowestPlayerPiece(this.board[a],n);this.droppedPiece=hB.of({square:a,piece:o})}},{key:"showPossibleDrops",value:function(){this.displayableArrow=[];for(var e=this.rules.node.gameState,t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(ote.ZERO).get()>0&&this.displayableArrow.push({x:t,player:ote.ZERO}),e.remaining.get(ote.ONE).get()>0&&this.displayableArrow.push({x:t,player:ote.ONE}))}},{key:"getCircleCenter",value:function(e,t,n){var r=e*this.SPACE_SIZE+.5*this.SPACE_SIZE,i=(5-e)*this.SPACE_SIZE*.25+.5*this.SPACE_SIZE;if(1===n.count(ate.NONE))return new lre(r,i);var a=n.count(ate.NONE),o=2*t*Math.PI/a-Math.PI/2,s=.3*this.SPACE_SIZE,u=s*Math.cos(o),c=s*Math.sin(o);return new lre(r+u,i+c)}},{key:"canDisplayArrow",value:function(e,t){return this.displayableArrow.some(function(n){return n.x===e&&n.player.equals(t)})}},{key:"getArrowClasses",value:function(e,t){return[this.getPlayerClass(t)]}},{key:"getArrowTransform",value:function(e,t){var n=t===ote.ZERO?0:.5*this.SPACE_SIZE;return"translate("+(n+=e*this.SPACE_SIZE)+", "+(3-e)*this.SPACE_SIZE*.25+")"}},{key:"getSquareClasses",value:function(e){var t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected"):this.movedSquare.includes(e)&&t.push("last-move"),t}},{key:"onArrowClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#dropArrow_"+(t===ote.ZERO?"zero":"one")+"_"+e)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=oie.from(e),n.selectedPiece.isPresent()?(s=n.selectedPiece.get().square,o=uie.transfer(oie.from(s),a).get()):o=uie.drop(a,t),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 6:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e,t,n){var r={square:e,piece:t},i=[],a=n.count(ote.ZERO),o=n.count(ote.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected");else if(this.droppedPiece.equalsValue(r))i.push("last-move");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.rules.node.gameState.getCurrentOpponent()===ote.ZERO?a++:o++}var s=n.count(ate.NONE)-(o+a),u=this.getPieceColor(t,a,s);return""!==u&&i.push(u),i}},{key:"getPieceColor",value:function(e,t,n){return e<t?"player0":e>=t+n?"player1":""}},{key:"onSquareClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.selectedPiece.isPresent()||t.selectedPiece.get().square!==e){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),e6.SUCCESS));case 5:return i=t.rules.node.gameState.getCurrentPlayer(),a=t.board[e],n.abrupt("return",a.count(i)<=0?t.cancelMove(sie.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=hB.of({square:e,piece:t.getLowestPlayerPiece(a,i)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(sie.NO_POSSIBLE_TRANSFER_REMAINS()):e6.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"showAndGetPossibleTranfers",value:function(){this.displayableArrow=[];for(var e=this.selectedPiece.get().square-1,t=this.rules.node.gameState.getCurrentPlayer();0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}}],[{key:"getArrowCoord",value:function(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}}]),n}(hre);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-apagos"]],features:[jC],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-8 -8 416 350","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player0",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],["class","base mid-stroke player1",4,"ngFor","ngForOf"],[1,"base","mid-stroke","player0"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","player1"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,vie,1,3,"circle",1),pb(2,"g",2),lb(3,mie,5,9,"ng-container",3),gb(),lb(4,kie,1,3,"circle",4),gb()),2&e&&(Rw(1),db("ngForOf",t.range(t.remainingZero)),Rw(1),ob("transform","translate(0, "+2*t.PIECE_RADIUS+")"),Rw(1),db("ngForOf",t.board),Rw(1),db("ngForOf",t.range(t.remainingOne)))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),wie=function(){var e,t=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n)}(hre);return t.\u0275fac=function(n){return(e||(e=sk(t)))(n||t)},t.\u0275cmp=oy({type:t,selectors:[["ng-component"]],features:[jC],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),Cie=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r)).captured=i,a}return cp(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}}],[{key:"getInitialState",value:function(){return new n(lte.createTable(6,2,4),0,[0,0])}}]),n}(Sre),bie=function(){var e=cp(function e(){sp(this,e)});return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=function(){return $localize(ge||(ge=Vv(["You cannot distribute from the opponent's home."])))},e.MUST_CHOOSE_NONEMPTY_HOUSE=function(){return $localize(ye||(ye=Vv(["You should choose a non-empty house to distribute."])))},e.SHOULD_DISTRIBUTE=function(){return $localize(me||(me=Vv(["You should distribute but you do not."])))},e}(),Eie=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,r){sB(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:t});var i=e.x,a=t.getCurrentPlayer().value,o=t.getCurrentPlayer().getOpponent().value,s=t.getCopiedBoard(),u=n.distribute(i,a,s);if(u.y===a)return new Cie(s,t.turn+1,t.captured);var c=[0,0],l=lte.copyBiArray(s);return c[a]=n.capture(u.x,o,a,s),c[a]>0&&n.isStarving(o,s)&&(s=l,c=[0,0]),n.isStarving(a,s)&&!1===n.canDistribute(o,s)&&(c[o]+=n.mansoon(o,s)),c[0]+=t.captured[0],c[1]+=t.captured[1],new Cie(s,t.turn+1,c)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"mansoon",value:function(e,t){var n=0,r=0;do{n+=t[e][r],t[e][r]=0,r++}while(r<6);return n}},{key:"isLegal",value:function(e,t){var r=t.getCurrentPlayer().value,i=t.getCurrentPlayer().getOpponent().value,a=e.x;if(0===t.getPieceAtXY(a,r))return J5.failure(bie.MUST_CHOOSE_NONEMPTY_HOUSE());var o=n.isStarving(i,t.board),s=!1===n.doesDistribute(a,r,t.board);return o&&s?J5.failure(bie.SHOULD_DISTRIBUTE()):J5.success(void 0)}},{key:"doesDistribute",value:function(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}},{key:"canDistribute",value:function(e,t){for(var r=0;r<6;r++)if(n.doesDistribute(r++,e,t))return!0;return!1}},{key:"isStarving",value:function(e,t){var n=0;do{if(t[e][n++]>0)return!1}while(n<6);return!0}},{key:"distribute",value:function(e,t,n){var r=e,i=t,a=n[t][e];for(n[t][e]=0;a>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,a--);return new lre(e,t)}},{key:"capture",value:function(e,t,n,r){a6(t!==n,"AwaleRules.capture called with wrong values of x and player");var i=r[t][e];if(i<2||i>3)return 0;var a=0,o=-1,s=-1;0===n&&(o=1,s=6);do{a+=i,r[t][e]=0,i=r[t][e+=o]}while(e!==s&&(2===i||3===i));return a}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captured[0]>24?Dre.ZERO_WON:t.captured[1]>24?Dre.ONE_WON:24===t.captured[0]&&24===t.captured[1]?Dre.DRAW:Dre.ONGOING}}]),n}(Lre);return e.VERBOSE=!1,e}(),Sie=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).x=e,r}return cp(n,[{key:"equals",value:function(e){return e===this||e.x===this.x}},{key:"toString",value:function(){return"AwaleMove("+this.x+")"}}],[{key:"from",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;default:return a6(5===e,"Invalid x for AwaleMove: "+e),n.FIVE}}}]),n}(Ore);Sie.ZERO=new Sie(0),Sie.ONE=new Sie(1),Sie.TWO=new Sie(2),Sie.THREE=new Sie(3),Sie.FOUR=new Sie(4),Sie.FIVE=new Sie(5),Sie.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return Sie.from(e)}}]),n}(rte));var Pie=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState,i=r.turn%2,a=0;do{0!==r.getPieceAtXY(a,i)&&(t=Sie.from(a),Eie.isLegal(t,r).isSuccess()&&(t=Sie.from(a),n.push(t))),a++}while(a<6);return this.orderMoves(e,n)}},{key:"orderMoves",value:function(e,t){var n=e.gameState.getCurrentPlayer().value,r=e.gameState.getCurrentPlayer().getOpponent().value;return lte.sortByDescending(t,function(t){var i,a=e.gameState.getCopiedBoard(),o=a[n][t.x],s=Eie.distribute(t.x,n,a),u=0;return s.y===n?(i=0,o<=6&&(u=10)):i=Eie.capture(s.x,r,n,a),100*i+u-o}),t}},{key:"getBoardValue",value:function(e){var t=Eie.getGameStatus(e);if(t.isEndGame)return wre.fromWinner(t.winner);var n=e.gameState.getCapturedCopy();return new wre(n[1]-n[0])}}]),n}(_re),Oie=cp(function e(){sp(this,e),this.tutorial=[Vre.anyMove($localize(ke||(ke=Vv(["Sowing"]))),$localize(_e||(_e=Vv(["Awal\xe9 is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.\n         Let's see how seeds are sown.\n         As you're playing first, the 6 houses on the top are yours.<br/><br>\n         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house."]))),Cie.getInitialState(),Sie.ZERO,$localize(we||(we=Vv(["Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.\n        This is how seeds are sown:\n        one by one from the house next to the one they come from, clockwise."])))),Vre.anyMove($localize(Ce||(Ce=Vv(["Big sowing"]))),$localize(be||(be=Vv(["You are now the second player (on the bottom).\n        When there are enough seeds to make a full turn, something else happens.<br/><br/>\n        Sow the house that contains 12 seeds."]))),new Cie([[0,0,0,0,0,0],[0,12,0,0,0,0]],1,[0,0]),Sie.ONE,$localize(Ee||(Ee=Vv(["See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds)."])))),Vre.fromMove($localize(Se||(Se=Vv(["Simple capture"]))),$localize(Pe||(Pe=Vv(["After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.\n         Then, the player looks at the preceding house:\n         if it is still in the opponent's side and contains two or three seeds, they are also captured.\n         This continues until we reach either the player's side or a house containing neither two nor three seeds.<br/><br/>\n         You are the second player, try to capture some pieces!"]))),new Cie([[1,0,0,0,1,0],[1,0,0,0,1,0]],1,[0,0]),[Sie.ZERO],$localize(Oe||(Oe=Vv(["Well done! This was a simple capture, now let us see how to make multiple captures."]))),$localize(Te||(Te=Vv(["Failed. Try again and sow from the leftmost house."])))),Vre.fromMove($localize(Ie||(Ie=Vv(["Multiple captures"]))),$localize(xe||(xe=Vv(["By sowing from your leftmost house, you will change the number of seeds in a house from 2 to 3, and from the preceding house from 1 to 2.\n        As these are consecutive houses, all seeds in them will be captured.<br/><br/>\n        Capture them."]))),new Cie([[2,1,0,0,1,0],[2,0,0,0,1,0]],1,[0,0]),[Sie.ZERO],$localize(Ae||(Ae=Vv(["Nice, you win 3 points from the first house, and 2 from the second!"]))),$localize(Re||(Re=Vv(["Failed. Try again."])))),Vre.fromMove($localize(Ne||(Ne=Vv(["Interrupted capture"]))),$localize(Me||(Me=Vv(["By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>\n        Do it."]))),new Cie([[1,0,1,0,0,1],[3,0,0,0,1,0]],1,[0,0]),[Sie.ZERO],$localize(De||(De=Vv(["Notice that because the second house was not capturable, the captured was interrupted and you have not captured the first house."]))),$localize(Le||(Le=Vv(["Failed. Try again."])))),Vre.fromMove($localize(Fe||(Fe=Vv(["Capture on the other side only"]))),$localize(Be||(Be=Vv(["Try to capture the two leftmost houses of the opponent."]))),new Cie([[2,2,0,0,1,0],[1,3,0,0,0,0]],1,[0,0]),[Sie.ONE],$localize(Ue||(Ue=Vv(["Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!"]))),$localize(Ve||(Ve=Vv(["You have only captured one house, try again!"])))),Vre.fromMove($localize(ze||(ze=Vv(["Do not starve"]))),$localize(He||(He=Vv(["You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>\n        Try it."]))),new Cie([[1,1,1,1,1,0],[5,0,0,1,0,0]],1,[0,0]),[Sie.ZERO],$localize(Ge||(Ge=Vv(["Sadly, you cannot capture here, otherwise the opponent could not play after you.\n        When this happens, the move can be made, but no capture takes place!"]))),$localize(qe||(qe=Vv(["Failed. Try again."])))),Vre.anyMove($localize($e||($e=Vv(["Feeding is mandatory"]))),$localize(We||(We=Vv(["You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>\n        Go ahead!"]))),new Cie([[0,0,0,0,0,0],[0,1,2,4,4,5]],1,[0,0]),Sie.THREE,$localize(je||(je=Vv(["Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.\n        It is often a good way to have easy captures!"])))),Vre.anyMove($localize(Ze||(Ze=Vv(["End of the game"]))),$localize(Ye||(Ye=Vv(["A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>\n         Sow the house on the top right."]))),new Cie([[0,0,0,0,0,1],[0,1,2,3,4,4]],0,[0,0]),Sie.FIVE,$localize(Ke||(Ke=Vv(["Also, as soon as on player cannot play, the other player captures all the seeds in its own side.\n         Here, it was the first player's turn, and the second player has taken all the remaining seeds."]))))]});function Tie(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"circle",4),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(2,"text",5),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onClick(e,t)}),Bb(3),gb(),gb()}if(2&e){var r=t.$implicit,i=t.index,a=Pb().index,o=Pb();Rw(1),Ib("id","click_",i,"_",a,""),db("ngClass",o.getSquareClasses(i,a)),ob("cx",50+100*i)("cy",50+120*a),Rw(1),ob("x",50+100*i)("y",66+120*a),Rw(1),Vb(" ",r," ")}}function Iie(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Tie,4,8,"g",2),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}var xie=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).last=hB.empty(),r.captured=[],r.moved=[],r.scores=hB.of([0,0]),r.rules=new Eie(Cie),r.availableMinimaxes=[new Pie(r.rules,"AwaleMinimax")],r.encoder=Sie.encoder,r.tutorial=(new Oie).tutorial,r.updateBoard(),r}return cp(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.scores=hB.of(e.getCapturedCopy()),this.hidePreviousMove();var t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){var n=e.getCurrentOpponent().value;this.last=hB.of(new lre(t.get().x,n)),this.showPreviousMove()}else this.last=hB.empty()}},{key:"hidePreviousMove",value:function(){this.captured=[],this.moved=[]}},{key:"showPreviousMove",value:function(){for(var e=this.rules.node.mother.get().gameState,t=0;t<=1;t++)for(var n=0;n<=5;n++){var r=new lre(n,t),i=this.board[t][n],a=e.getPieceAt(r);this.last.equalsValue(r)||(i<a?this.captured.push(r):i>a&&this.moved.push(r))}}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(t===n.rules.node.gameState.getCurrentPlayer().value){r.next=5;break}return r.abrupt("return",n.cancelMove(bie.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME()));case 5:return n.last=hB.empty(),a=Sie.from(e),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 8:case"end":return r.stop()}},r)}))()}},{key:"getSquareClasses",value:function(e,t){var n=new lre(e,t);return this.captured.some(function(e){return e.equals(n)})?["captured"]:this.last.equalsValue(n)?["moved","highlighted"]:this.moved.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(wie);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-awale-component"]],features:[jC],decls:4,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"click"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),yb(1,"rect",1),lb(2,Iie,2,1,"g",2),yb(3,"line",3),gb()),2&e&&(Rw(2),db("ngForOf",t.board))},directives:[FT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Aie=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;if(sp(this,n),i=t.call(this,e.x,e.y),e.equals(r))throw new Error(kre.MOVE_CANNOT_BE_STATIC());return i.end=r,Qv(i)}return cp(n,[{key:"length",value:function(){return this.coord.getDistance(this.end)}},{key:"getDirection",value:function(){return ure.factory.fromMove(this.coord,this.end)}}],[{key:"getEncoder",value:function(e,t,n){return new(function(r){Yv(a,r);var i=Jv(a);function a(){var n;return sp(this,a),(n=i.apply(this,arguments)).shiftAX=t,n.shiftDY=n.shiftAX*e,n.shiftDX=n.shiftDY*t,n}return cp(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new lre((r-=r%1)%e,i);r/=e;var o=(r-=r%1)%t;r/=t;var s=new lre((r-=r%1)%e,o);return n(s,a)}}]),a}(rte))}}]),n}(Tre),Rie=function(){var e=cp(function e(){sp(this,e)});return e.LANDING_ON_OCCUPIED_CASE=function(){return $localize(Je||(Je=Vv(["You cannot land on an occupied square."])))},e.THRONE_IS_LEFT_FOR_GOOD=function(){return $localize(Qe||(Qe=Vv(["Once you left the central throne, you cannot return to it."])))},e.SOLDIERS_CANNOT_SIT_ON_THRONE=function(){return $localize(Xe||(Xe=Vv(["Soldiers cannot sit on the throne."])))},e.SOMETHING_IN_THE_WAY=function(){return $localize(et||(et=Vv(["Something is in the way."])))},e.MOVE_MUST_BE_ORTHOGONAL=function(){return $localize(tt||(tt=Vv(["Tafl moves must be orthogonal."])))},e}(),Nie=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;if(sp(this,n),i=t.call(this,e,r),e.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(r.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+r.toString()+".");var a=e.getDirectionToward(r);if(a.isFailure()||a.get().isDiagonal())throw new Error(Rie.MOVE_MUST_BE_ORTHOGONAL());return Qv(i)}return cp(n,[{key:"equals",value:function(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"TaflMove("+this.coord+"->"+this.end+")"}}]),n}(Aie),Mie=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getMaximalDistance",value:function(){return 7}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return J5.success(r)}catch(r){return J5.failure(r.message)}}}]),n}(Nie);Mie.encoder=Aie.getEncoder(7,7,Mie.of);var Die={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:ote.ZERO},Lie=function(){function e(t,n){sp(this,e),this.owner=t,this.king=n}return cp(e,[{key:"isKing",value:function(){return this.king}},{key:"getOwner",value:function(){return this.owner}}]),e}();Lie.UNOCCUPIED=new Lie(ate.NONE,!1),Lie.PLAYER_ONE_KING=new Lie(ote.ONE,!0),Lie.INVADERS=new Lie(ote.ZERO,!1),Lie.DEFENDERS=new Lie(ote.ONE,!1);var Fie=cp(function e(t){sp(this,e),this.value=t});Fie.NONE=new Fie("NONE"),Fie.OPPONENT=new Fie("OPPONENT"),Fie.PLAYER=new Fie("PLAYER");var Bie=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"isCentralThrone",value:function(e){return e.equals(this.getCentralThrone())}},{key:"getCentralThrone",value:function(){var e=(this.board.length-1)/2;return new lre(e,e)}},{key:"getRelativeOwner",value:function(e,t){var n=this.getAbsoluteOwner(t);return n===ate.NONE?Fie.NONE:e===n?Fie.PLAYER:Fie.OPPONENT}},{key:"getAbsoluteOwner",value:function(e){return this.getPieceAt(e).getOwner()}}]),n}(Sre),Uie=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Lie.UNOCCUPIED,t=Lie.INVADERS,r=Lie.DEFENDERS;return new n([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,Lie.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}]),n}(Bie),Vie=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e)).config=r,a.generateMove=i,a}return cp(n,[{key:"isLegal",value:function(e,t){sB(n.VERBOSE,{tablutRules_isLegal:{move:e,state:t}});var r=t.getCurrentPlayer(),i=this.getMoveValidity(r,e,t);return i.isFailure()?J5.failure(i.getReason()):J5.success(void 0)}},{key:"getMoveValidity",value:function(e,t,n){var r=n.getRelativeOwner(e,t.coord);if(r===Fie.NONE)return e6.failure(kre.MUST_CHOOSE_PLAYER_PIECE());if(r===Fie.OPPONENT)return e6.failure(kre.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==Fie.NONE)return e6.failure(Rie.LANDING_ON_OCCUPIED_CASE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return e6.failure(Rie.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return e6.failure(Rie.THRONE_IS_LEFT_FOR_GOOD())}for(var i=t.coord.getDirectionToward(t.end).get(),a=t.coord.getOrthogonalDistance(t.end),o=t.coord.getNext(i),s=1;s<a;s++){if(n.getPieceAt(o)!==Lie.UNOCCUPIED)return e6.failure(Rie.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return e6.SUCCESS}},{key:"isThrone",value:function(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}},{key:"isExternalThrone",value:function(e){var t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}},{key:"tryCapture",value:function(e,t,n,r){var i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===Fie.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):hB.empty()}},{key:"captureKing",value:function(e,t,n,r){var i=t.getNext(n),a=this.getSurroundings(i,n,e,r),o=a.backCoord,s=a.back,u=a.backInRange,c=a.left,l=a.leftCoord,h=a.right,f=a.rightCoord;return!1===u?this.captureKingAgainstTheWall(c,h,i):s===Fie.NONE&&this.isThrone(r,o)?this.captureKingAgainstThrone(o,i,c,h):s===Fie.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,h,f):hB.empty()}},{key:"getSurroundings",value:function(e,t,n,r){var i=e.getNext(t),a=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=a?r.getRelativeOwner(n,i):Fie.NONE,s=e.getLeft(t),u=s.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,s):Fie.NONE,c=e.getRight(t),l=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):Fie.NONE;return{backCoord:i,back:o,backInRange:a,leftCoord:s,left:u,rightCoord:c,right:l}}},{key:"captureKingAgainstTheWall",value:function(e,t,r){var i=e===Fie.PLAYER?1:0;return 2===(i+=t===Fie.PLAYER?1:0)&&this.config.BORDER_CAN_SURROUND_KING?(sB(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),hB.of(r)):hB.empty()}},{key:"captureKingAgainstThrone",value:function(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return hB.of(t)}else{var i=r===Fie.PLAYER,a=n===Fie.PLAYER||i;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&a)return hB.of(t)}return hB.empty()}},{key:"capturePawn",value:function(e,t,r,i){var a=!1,o=t.getNext(r),s=o.getNext(r),u=Fie.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(u=i.getRelativeOwner(e,s)),u===Fie.NONE?!1===this.isThrone(i,s)?(sB(n.VERBOSE||a,"cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),hB.empty()):(sB(n.VERBOSE||a,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),hB.of(o)):u===Fie.PLAYER?(sB(n.VERBOSE||a,"pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),hB.of(o)):(sB(n.VERBOSE||a,"no captures; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),hB.empty())}},{key:"captureKingWithAtLeastASandwich",value:function(e,t,r,i,a,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return hB.of(t);var s=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,i),c=r===Fie.PLAYER||u&&s,l=this.isThrone(e,o);return c&&(a===Fie.PLAYER||l&&s)?(sB(n.VERBOSE||!1,"king captured by 4 invaders"),hB.of(t)):hB.empty()}},{key:"kingTouchCentralThrone",value:function(e,t){var n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}},{key:"applyLegalMove",value:function(e,t){sB(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:t}});var r=t.turn,i=t.getCopiedBoard(),a=t.getCurrentPlayer(),o=e.coord,s=e.end;i[s.y][s.x]=i[o.y][o.x],i[o.y][o.x]=Lie.UNOCCUPIED;var u,c=ip(cre.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=this.tryCapture(a,e.end,l,t);h.isPresent()&&(i[h.get().y][h.get().x]=Lie.UNOCCUPIED)}}catch(f){c.e(f)}finally{c.f()}return t.from(i,r+1)}},{key:"getGameStatus",value:function(e){var t=this.getWinner(e.gameState);return t.isPresent()?Dre.getVictory(t.get()):Dre.ONGOING}},{key:"getWinner",value:function(e){var t=!1,n=this.getKingCoord(e);if(n.isAbsent())return sB(t,"The king is dead, victory to invader"),hB.of(this.getInvader());var r=n.get();return this.isExternalThrone(r)?(sB(t,"The king escape, victory to defender"),hB.of(this.getDefender())):this.isPlayerImmobilized(ote.ZERO,e)?(sB(t,"Zero has no move, victory to one"),hB.of(ote.ONE)):this.isPlayerImmobilized(ote.ONE,e)?(sB(t,"One has no move, victory to zero"),hB.of(ote.ZERO)):(sB(t,"no victory"),hB.empty())}},{key:"getKingCoord",value:function(e){sB(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(var t=0;t<this.config.WIDTH;t++)for(var r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return hB.of(new lre(r,t));return hB.empty()}},{key:"getInvader",value:function(){return this.config.INVADER}},{key:"getDefender",value:function(){return this.config.INVADER.getOpponent()}},{key:"isPlayerImmobilized",value:function(e,t){return 0===this.getPlayerListMoves(e,t).length}},{key:"getPlayerListMoves",value:function(e,t){var r=[],i=this.getPlayerListPawns(e,t);sB(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:t}});var a,o=ip(i);try{for(o.s();!(a=o.n()).done;){var s,u=a.value,c=ip(this.getPossibleDestinations(u,t));try{for(c.s();!(s=c.n()).done;){var l=s.value,h=this.generateMove(u,l);r.push(h)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return r}},{key:"getPlayerListPawns",value:function(e,t){for(var n=[],r=0;r<this.config.WIDTH;r++)for(var i=0;i<this.config.WIDTH;i++){var a=new lre(i,r);t.getAbsoluteOwner(a)===e&&n.push(a)}return n}},{key:"getPossibleDestinations",value:function(e,t){var n,r,i=[],a=ip(cre.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=e.getNext(o,1);for(var s=!1;n.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(n)===ate.NONE?this.isExternalThrone(n)?t.getPieceAt(e).isKing()&&i.push(n):t.isCentralThrone(n)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&i.push(n):i.push(n):s=!0,n=n.getNext(o,1)}}catch(u){a.e(u)}finally{a.f()}return i}}]),n}(Lre);return e.VERBOSE=!1,e}(),zie=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.call(this,Uie,Die,Mie.of)}return cp(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Mre.ruler=this.singleton,n.singleton}}]),n}(Vie),Hie=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e)).VERBOSE=r,a.generateMove=i,a.NONE=Lie.UNOCCUPIED,a.captureds=[],a.chosen=new lre(-1,-1),a.lastMove=hB.empty(),a}return cp(n,[{key:"getViewBox",value:function(){var e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}},{key:"updateBoard",value:function(){sB(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.rules.node.gameState.getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove()}},{key:"showPreviousMove",value:function(){var e,t=this.rules.node.mother.get().gameState,n=this.rules.node.gameState.getCurrentOpponent(),r=ip(cre.ORTHOGONALS);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.lastMove.get().end.getNext(i,1);if(a.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){var o=t.getRelativeOwner(n,a)===Fie.OPPONENT,s=this.rules.node.gameState.getPieceAt(a)===Lie.UNOCCUPIED;o&&s&&this.captureds.push(a)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")"),i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):-1===n.chosen.x?n.choosePiece(e,t):n.chooseDestination(e,t));case 3:case"end":return r.stop()}},r)}))()}},{key:"chooseDestination",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"TaflComponent.chooseDestination"),i=n.chosen,a=new lre(e,t),!(o=n.generateMove(i,a)).isSuccess()){r.next=9;break}return n.cancelMove(),r.next=6,n.chooseMove(o.get(),n.rules.node.gameState);case 6:r.t0=r.sent,r.next=10;break;case 9:r.t0=n.cancelMove(o.getReason());case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return sB(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t][e]===Lie.UNOCCUPIED?this.cancelMove(kre.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e,t)?(this.chosen=new lre(e,t),sB(this.VERBOSE,"selected piece = ("+e+", "+t+")"),e6.SUCCESS):this.cancelMove(kre.CANNOT_CHOOSE_OPPONENT_PIECE())}},{key:"pieceBelongToCurrentPlayer",value:function(e,t){var n=this.rules.node.gameState,r=n.getCurrentPlayer(),i=new lre(e,t);return n.getRelativeOwner(r,i)===Fie.PLAYER}},{key:"cancelMoveAttempt",value:function(){this.chosen=new lre(-1,-1)}},{key:"isThrone",value:function(e,t){return this.rules.isThrone(this.rules.node.gameState,new lre(e,t))}},{key:"isCentralThrone",value:function(e,t){return!1===this.rules.node.gameState.isCentralThrone(new lre(e,t))}},{key:"getPieceClasses",value:function(e,t){var n=[],r=new lre(e,t),i=this.rules.node.gameState.getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equals(r)&&n.push("selected"),n}},{key:"getRectClasses",value:function(e,t){var n=[],r=new lre(e,t);if(this.captureds.some(function(e){return e.equals(r)}))n.push("captured");else if(this.lastMove.isPresent()){var i=this.lastMove.get().coord,a=this.lastMove.get().end;(r.equals(i)||r.equals(a))&&n.push("moved")}return n}},{key:"getClickables",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++)this.isClickable(n,t)&&e.push(new lre(n,t));return e}},{key:"isClickable",value:function(e,t){return this.pieceBelongToCurrentPlayer(e,t)}},{key:"isInvader",value:function(e,t){return this.board[t][e]===Lie.INVADERS}},{key:"isKing",value:function(e,t){return this.board[t][e].isKing()}},{key:"getKingPolyline",value:function(e,t){return 85+100*e+" "+(85+100*t)+" "+(30+100*e)+" "+(30+100*t)+" "+(50+100*e)+" "+(10+100*t)+" "+(70+100*e)+" "+(30+100*t)+" "+(15+100*e)+" "+(85+100*t)}}]),n}(wie),Gie=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){sB(!1,{TaflMinimax_getListMoves:{node:e}});var t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}},{key:"orderMoves",value:function(e,t){var n=this,r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?lte.sortByDescending(t,function(e){return-e.end.getOrthogonalDistance(r)}):lte.sortByDescending(t,function(e){return e.coord.equals(r)?n.ruler.isExternalThrone(e.end)?2:1:0}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new wre(n.get().getVictoryValue());var r=this.ruler.getPlayerListPawns(ote.ZERO,t).length,i=this.ruler.getPlayerListPawns(ote.ONE,t).length,a=[1,2][this.ruler.config.INVADER.value];a*=ote.ZERO.getScoreModifier();var o=[2,1][this.ruler.config.INVADER.value];return o*=ote.ONE.getScoreModifier(),new wre(r*a+i*o)}}]),n}(_re),qie=function(){function e(t,n){sp(this,e),this.directThreats=t,this.mover=n}return cp(e,[{key:"equals",value:function(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}]),e}(),$ie=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,new bre([e]),r)).directThreat=e,i.mover=r,i}return cp(n)}(qie),Wie=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"toFields",value:function(e){return[[e.y],e.x]}}]),n}(function(e,t){Yv(r,e);var n=Jv(r);function r(e){var t;if(sp(this,r),(t=n.call(this)).map=[],t.values=[],void 0!==e){var i,a=ip(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.add(o)}}catch(s){a.e(s)}finally{a.f()}}return Qv(t)}return cp(r,[{key:"add",value:function(e){var t,n=this.toFields(e),r=this.map,i=ip(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;void 0===r[a]&&(r[a]=[]),r=r[a]}}catch(s){i.e(s)}finally{i.f()}var o=n[1];return void 0===r[o]&&(r[o]=!0,this.values.push(e),!0)}},{key:"contains",value:function(e){var t,n=this.toFields(e),r=this.map,i=ip(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0===r[a])return!1;r=r[a]}}catch(o){i.e(o)}finally{i.f()}return void 0!==r[n[1]]}},{key:t,value:function(){return this.values.values()}}]),r}(bre,Symbol.iterator)),jie=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e,r)).width=i.ruler.config.WIDTH,i.maxInfluence=16*(2*i.width-2),i.scoreByThreatenedPiece=16*i.maxInfluence+1,i.scoreBySafePiece=16*i.scoreByThreatenedPiece+1,i}return cp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new wre(t.toBoardValue());for(var n=e.gameState,r=Lie.UNOCCUPIED,i=0,a=this.getPiecesMap(n),o=this.getThreatMap(n,a),s=this.filterThreatMap(o,n),u=0,c=[ote.ZERO,ote.ONE];u<c.length;u++){var l,h=c[u],f=ip(a.get(h).get());try{for(f.s();!(l=f.n()).done;){var d=l.value;if(s.get(d).isPresent())i+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=h.getScoreModifier()*this.scoreBySafePiece;var v,p=0,g=ip(cre.ORTHOGONALS);try{for(g.s();!(v=g.n()).done;)for(var y=v.value,m=d.getNext(y,1);m.isInRange(this.width,this.width)&&n.getPieceAt(m)===r;)p++,m=m.getNext(y,1)}catch(k){g.e(k)}finally{g.f()}i+=p*h.getScoreModifier()}}}catch(k){f.e(k)}finally{f.f()}}return new wre(i)}},{key:"getPiecesMap",value:function(e){for(var t=Lie.UNOCCUPIED,n=new Are,r=[],i=[],a=0;a<this.width;a++)for(var o=0;o<this.width;o++){var s=new lre(o,a);e.getPieceAt(s)!==t&&(e.getAbsoluteOwner(s)===ote.ZERO?r.push(s):i.push(s))}return n.set(ote.ZERO,new Wie(r)),n.set(ote.ONE,new Wie(i)),n}},{key:"getThreatMap",value:function(e,t){for(var n=new Are,r=0,i=[ote.ZERO,ote.ONE];r<i.length;r++){var a,o=i[r],s=ip(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreats(u,e);this.isThreatReal(u,e,c)&&n.set(u,new bre(c))}}catch(l){s.e(l)}finally{s.f()}}return n}},{key:"getThreats",value:function(e,t){var n=t.getAbsoluteOwner(e);a6(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");var r,i=n.getOpponent(),a=[],o=ip(cre.ORTHOGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=e.getPrevious(s,1);if(this.isAThreat(u,t,i)){var c,l=[],h=ip(cre.ORTHOGONALS);try{for(h.s();!(c=h.n()).done;){var f=c.value;if(f!==s.getOpposite()){for(var d=e.getNext(s,1);d.isInRange(this.width,this.width)&&t.getPieceAt(d)===Lie.UNOCCUPIED;)d=d.getNext(f);d.isInRange(this.width,this.width)&&t.getAbsoluteOwner(d)===i&&!1===e.getNext(s,1).equals(d)&&l.push(d)}}}catch(v){h.e(v)}finally{h.f()}a.push(new $ie(u,new Wie(l)))}}}catch(v){o.e(v)}finally{o.f()}return a}},{key:"isAThreat",value:function(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==ote.ONE&&t.getPieceAt(e)!==Lie.UNOCCUPIED))}},{key:"isThreatReal",value:function(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;var r,i=ip(n);try{for(i.s();!(r=i.n()).done;){if(r.value.mover.size()>0)return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new Are,i=e.listKeys(),a=i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentPlayer()}),o=new Wie(i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentOpponent()})),s=ip(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),h=[],f=ip(l);try{for(f.s();!(u=f.n()).done;){var d=u.value;if(!1===o.contains(d.directThreat)){var v,p=[],g=ip(d.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(C){g.e(C)}finally{g.f()}p.length>0&&h.push(new $ie(d.directThreat,new Wie(p)))}}}catch(C){f.e(C)}finally{f.f()}h.length>0&&r.set(c,new bre(h))}}catch(C){s.e(C)}finally{s.f()}var m,k=ip(o);try{for(k.s();!(m=k.n()).done;){var _=m.value,w=e.get(_).get();r.set(_,w)}}catch(C){k.e(C)}finally{k.f()}return r}}]),n}(Gie),Zie=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new wre(t.toBoardValue());for(var r=e.gameState,i=this.ruler.config.WIDTH,a=Lie.UNOCCUPIED,o=0,s=this.getPiecesMap(r),u=this.getThreatMap(r,s),c=this.filterThreatMap(u,r),l=0,h=[ote.ZERO,ote.ONE];l<h.length;l++){var f,d=h[l],v=new Wie,p=ip(s.get(d).get());try{for(p.s();!(f=p.n()).done;){var g=f.value;if(c.get(g).isPresent())o+=d.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE;else{o+=d.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;var y,m=ip(cre.ORTHOGONALS);try{for(m.s();!(y=m.n()).done;)for(var k=y.value,_=g.getNext(k,1);_.isInRange(i,i)&&r.getPieceAt(_)===a;)v.add(_),_=_.getNext(k,1)}catch(S){m.e(S)}finally{m.f()}}}}catch(S){p.e(S)}finally{p.f()}var w,C=ip(v);try{for(C.s();!(w=C.n()).done;){var b=w.value,E=n.CONTROL_VALUE[b.y][b.x];o+=d.getScoreModifier()*E}}catch(S){C.e(S)}finally{C.f()}}return new wre(o)}}]),n}(jie);Zie.SCORE_BY_THREATENED_PIECE=530,Zie.SCORE_BY_SAFE_PIECE=16*Zie.SCORE_BY_THREATENED_PIECE+1,Zie.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Yie=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new wre(t.toBoardValue());for(var n=e.gameState,r=this.ruler.config.WIDTH,i=Lie.UNOCCUPIED,a=0,o=0,s=0,u=this.getPiecesMap(n),c=this.getThreatMap(n,u),l=this.filterThreatMap(c,n),h=0,f=[ote.ZERO,ote.ONE];h<f.length;h++){var d,v=f[h],p=new Wie,g=ip(u.get(v).get());try{for(g.s();!(d=g.n()).done;){var y=d.value;if(l.get(y).isPresent())o+=v.getScoreModifier();else{a+=v.getScoreModifier();var m,k=ip(cre.ORTHOGONALS);try{for(k.s();!(m=k.n()).done;)for(var _=m.value,w=y.getNext(_,1);w.isInRange(r,r)&&n.getPieceAt(w)===i;)p.add(w),w=w.getNext(_,1)}catch(O){k.e(O)}finally{k.f()}}}}catch(O){g.e(O)}finally{g.f()}var C,b=ip(p);try{for(b.s();!(C=b.n()).done;){var E=C.value,S=Zie.CONTROL_VALUE[E.y][E.x];s+=v.getScoreModifier()*S}}catch(O){b.e(O)}finally{b.f()}}var P=this.getStepForEscape(n);return new wre(531*P*17*17+531*a*17+531*o+s)}},{key:"getStepForEscape",value:function(e){var t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}},{key:"_getStepForEscape",value:function(e,t,n,r){var i=this,a=this.getNextGen(e,n,r);return 0===a.length?hB.empty():a.some(function(e){return i.ruler.isExternalThrone(e)})?hB.of(t):(t++,r.push.apply(r,np(a)),this._getStepForEscape(e,t,a,r))}},{key:"getNextGen",value:function(e,t,n){var r,i=this,a=[],o=ip(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=ip(cre.ORTHOGONALS);try{var l=function(){for(var t=s.value,r=u.getNext(t,1);r.isInRange(i.ruler.config.WIDTH,i.ruler.config.WIDTH)&&e.getPieceAt(r)===Lie.UNOCCUPIED;)n.every(function(e){return!1===e.equals(r)})&&a.push(r),r=r.getNext(t,1)};for(c.s();!(s=c.n()).done;)l()}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return a}}]),n}(Zie);Yie.SCORE_BY_THREATENED_PIECE=530,Yie.SCORE_BY_SAFE_PIECE=16*Zie.SCORE_BY_THREATENED_PIECE+1,Yie.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Kie=Lie.UNOCCUPIED,Jie=Lie.INVADERS,Qie=Lie.DEFENDERS,Xie=Lie.PLAYER_ONE_KING,eae=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(nt||(nt=Vv(["Goal of the game"]))),$localize(rt||(rt=Vv(["Brandhub is the Irish version of the family of viking strategy game called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Uie.getInitialState()),Vre.anyMove($localize(it||(it=Vv(["Moving"]))),$localize(at||(at=Vv(["All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, he can't go back on it, nor can the other pieces.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Uie.getInitialState(),Mie.of(new lre(3,1),new lre(1,1)),$localize(ot||(ot=Vv(["Congratulations!"])))),Vre.fromMove($localize(st||(st=Vv(["Capturing a soldier (1/2)"]))),$localize(ut||(ut=Vv(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Uie([[Kie,Kie,Kie,Jie,Kie,Kie,Kie],[Kie,Kie,Kie,Jie,Kie,Kie,Kie],[Jie,Kie,Kie,Qie,Kie,Kie,Kie],[Kie,Kie,Qie,Xie,Qie,Jie,Jie],[Kie,Kie,Jie,Kie,Kie,Kie,Kie],[Kie,Kie,Kie,Qie,Kie,Jie,Kie],[Kie,Kie,Kie,Jie,Kie,Kie,Kie]],1),[Mie.of(new lre(3,5),new lre(2,5))],$localize(ct||(ct=Vv(["Congratulations, that will teach him a lesson!"]))),$localize(lt||(lt=Vv(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Vre.fromMove($localize(ht||(ht=Vv(["Capturing a soldier (2/2)"]))),$localize(ft||(ft=Vv(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Uie([[Kie,Kie,Kie,Jie,Kie,Kie,Kie],[Kie,Kie,Jie,Kie,Kie,Kie,Kie],[Kie,Kie,Kie,Qie,Kie,Kie,Kie],[Jie,Qie,Kie,Kie,Qie,Jie,Jie],[Kie,Qie,Kie,Kie,Kie,Kie,Kie],[Kie,Jie,Kie,Xie,Kie,Jie,Kie],[Kie,Kie,Kie,Jie,Kie,Kie,Kie]],12),[Mie.of(new lre(2,1),new lre(3,1)),Mie.of(new lre(3,0),new lre(3,1))],$localize(dt||(dt=Vv(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(vt||(vt=Vv(["Failed, you did not do the expected move."])))),Vre.fromMove($localize(pt||(pt=Vv(["Capturing the king on his throne"]))),$localize(gt||(gt=Vv(["To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king."]))),new Uie([[Kie,Kie,Kie,Kie,Kie,Kie,Kie],[Kie,Kie,Kie,Qie,Kie,Kie,Kie],[Kie,Kie,Kie,Jie,Kie,Kie,Kie],[Kie,Jie,Kie,Xie,Jie,Kie,Kie],[Kie,Kie,Kie,Jie,Kie,Kie,Kie],[Kie,Qie,Kie,Kie,Kie,Kie,Kie],[Kie,Kie,Kie,Kie,Kie,Kie,Kie]],72),[Mie.of(new lre(1,3),new lre(2,3))],$localize(yt||(yt=Vv(["Congratulations, you won!"]))),$localize(mt||(mt=Vv(["Failed, you let the king run away."])))),Vre.fromMove($localize(kt||(kt=Vv(["Capturing the king next to his throne"]))),$localize(_t||(_t=Vv(["Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king."]))),new Uie([[Kie,Kie,Jie,Kie,Kie,Kie,Kie],[Kie,Kie,Kie,Jie,Kie,Kie,Kie],[Kie,Kie,Kie,Xie,Jie,Kie,Kie],[Kie,Jie,Qie,Kie,Qie,Kie,Kie],[Kie,Kie,Kie,Jie,Kie,Kie,Kie],[Kie,Kie,Kie,Kie,Kie,Kie,Kie],[Kie,Kie,Kie,Kie,Kie,Kie,Kie]],72),[Mie.of(new lre(2,0),new lre(2,2))],$localize(wt||(wt=Vv(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Ct||(Ct=Vv(["Failed!"])))),Vre.fromMove($localize(bt||(bt=Vv(["Capturing the king far from his throne"]))),$localize(Et||(Et=Vv(["When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king."]))),new Uie([[Kie,Kie,Kie,Kie,Kie,Kie,Kie],[Kie,Kie,Kie,Kie,Kie,Kie,Kie],[Kie,Jie,Kie,Jie,Kie,Kie,Kie],[Jie,Kie,Kie,Kie,Qie,Kie,Kie],[Kie,Kie,Kie,Qie,Kie,Kie,Kie],[Kie,Kie,Kie,Kie,Kie,Kie,Kie],[Kie,Xie,Kie,Jie,Kie,Kie,Kie]],72),[Mie.of(new lre(3,6),new lre(2,6))],$localize(St||(St=Vv(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Pt||(Pt=Vv(["Failed!"]))))]});function tae(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",6),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb()}if(2&e){var r=Pb(2).index,i=Pb().index,a=Pb();ob("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function nae(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",7),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb()}if(2&e){var r=Pb(2).index,i=Pb().index,a=Pb();ob("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function rae(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,tae,1,1,"polyline",4),lb(2,nae,1,1,"ng-template",null,5,NP),gb()),2&e){var n=hb(3),r=Pb().index,i=Pb().index,a=Pb();Rw(1),db("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function iae(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"line",11),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(2,"line",11),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(3,"line",11),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(4,"line",11),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(5,"line",11),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),gb()}if(2&e){var r=Pb(2).index,i=Pb().index,a=Pb();Rw(1),ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.05*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.95*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE)}}function aae(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"polyline",13),bb("click",function(){Jy(n);var e=Pb(3).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),gb()}if(2&e){var r=Pb(3).index,i=Pb().index,a=Pb();Rw(1),ob("points",a.getKingPolyline(r,i))}}function oae(e,t){if(1&e){var n=_b();Pm(),pb(0,"line",11),bb("click",function(){Jy(n);var e=Pb(3).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(1,"line",11),bb("click",function(){Jy(n);var e=Pb(3).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(2,"line",11),bb("click",function(){Jy(n);var e=Pb(3).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(3,"line",11),bb("click",function(){Jy(n);var e=Pb(3).index,t=Pb().index;return Pb().onClick(e,t)}),gb()}if(2&e){var r=Pb(3).index,i=Pb().index,a=Pb();ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.04*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.5*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.96*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.5*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE)}}function sae(e,t){if(1&e&&(Pm(),lb(0,aae,2,1,"g",9),lb(1,oae,4,16,"ng-template",null,12,NP)),2&e){var n=hb(2),r=Pb(2).index,i=Pb().index;db("ngIf",Pb().isKing(r,i))("ngIfElse",n)}}function uae(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"circle",8),bb("click",function(){Jy(n);var e=Pb().index,t=Pb().index;return Pb().onClick(e,t)}),gb(),lb(2,iae,6,20,"g",9),lb(3,sae,3,2,"ng-template",null,10,NP),gb()}if(2&e){var r=hb(4),i=Pb().index,a=Pb().index,o=Pb();Rw(1),db("ngClass",o.getPieceClasses(i,a)),ob("r",(o.SPACE_SIZE-o.STROKE_WIDTH)/2)("cx",o.SPACE_SIZE*i+.5*o.SPACE_SIZE)("cy",o.SPACE_SIZE*a+.5*o.SPACE_SIZE),Rw(1),db("ngIf",o.isInvader(i,a))("ngIfElse",r)}}function cae(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",2),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),lb(2,rae,4,2,"g",3),lb(3,uae,5,6,"g",3),gb()}if(2&e){var r=t.index,i=Pb().index,a=Pb();Rw(1),Ib("id","click_",r,"_",i,""),db("ngClass",a.getRectClasses(r,i)),ob("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Rw(1),db("ngIf",a.board[i][r]===a.NONE&&a.isThrone(r,i)),Rw(1),db("ngIf",a.board[i][r]!==a.NONE)}}function lae(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,cae,4,9,"g",1),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function hae(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",14),bb("click",function(){var e=Jy(n).$implicit;return Pb().onClick(e.x,e.y)}),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb();Rw(1),Ib("id","click_",r.x,"_",r.y,""),ob("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var fae=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e,!1,Mie.from)).rules=zie.get(),r.availableMinimaxes=[new Gie(r.rules,"DummyBot"),new jie(r.rules,"Piece > Influence"),new Zie(r.rules,"Piece > Control"),new Yie(r.rules,"Escape > Piece > Control")],r.encoder=Mie.encoder,r.tutorial=(new eae).tutorial,r}return cp(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(Hie);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-brandhub"]],features:[jC],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",3,"click",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base",3,"click"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base",3,"click"],[1,"base",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"click"],["soldierDefender",""],[1,"base","no-fill",3,"click"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,lae,2,1,"g",1),lb(2,hae,2,6,"g",1),gb()),2&e&&(ob("viewBox",t.getViewBox()),Rw(1),db("ngForOf",t.board),Rw(1),db("ngForOf",t.getClickables()))},directives:[FT,DT,UT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),dae=function(){var e,t=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).SPACE_SIZE=50,e}return cp(n,[{key:"getTriangleCornerCoords",value:function(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}},{key:"getTriangleCoordinate",value:function(e,t){return this.getTriangleCornerCoords(e,t).map(function(e){return e.x+","+e.y}).reduce(function(e,t){return e+","+t})}},{key:"getDownwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new lre(.5*this.SPACE_SIZE*e,i);return[o,new lre(n,a),new lre(r,i),o]}},{key:"getUpwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new lre(.5*this.SPACE_SIZE*e,a);return[o,new lre(n,i),new lre(r,a),o]}},{key:"getPyramidCoordinate",value:function(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}},{key:"getDownwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}},{key:"getUpwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}}]),n}(hre);return t.\u0275fac=function(n){return(e||(e=sk(t)))(n||t)},t.\u0275cmp=oy({type:t,selectors:[["ng-component"]],features:[jC],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),vae=function(){var e=cp(function e(){sp(this,e)});return e.INVALID_DISTANCE=function(){return $localize(Ot||(Ot=Vv(["Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is."])))},e.NOT_ENOUGH_TILES_TO_EXCHANGE=function(){return $localize(Tt||(Tt=Vv(["You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it."])))},e.FIRST_CLICK_SHOULD_NOT_BE_NULL=function(){return $localize(It||(It=Vv(["Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles."])))},e.CANNOT_CAPTURE_FROM_EMPTY=function(){return $localize(xt||(xt=Vv(["You cannot capture from an empty space."])))},e.CANNOT_CAPTURE_OWN_PIECES=function(){return $localize(At||(At=Vv(["You cannot capture your own pieces."])))},e}(),pae=function(){function e(t,n){sp(this,e),this.direction=t,this.str=n}return cp(e,[{key:"toInt",value:function(){var t=this;return e.STEPS.findIndex(function(e){return e.direction.equals(t.direction)})}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return this.str}}],[{key:"fromCoords",value:function(t,n){var r=t.getVectorToward(n),i=e.STEPS.findIndex(function(e){return e.direction.equals(r)});if(-1===i)throw new Error(vae.INVALID_DISTANCE());return e.STEPS[i]}}]),e}();pae.LEFT=new pae(new are(-2,0),"LEFT"),pae.UP_LEFT=new pae(ure.UP_LEFT,"UP_LEFT"),pae.UP_RIGHT=new pae(ure.UP_RIGHT,"UP_RIGHT"),pae.RIGHT=new pae(new are(2,0),"RIGHT"),pae.DOWN_LEFT=new pae(ure.DOWN_LEFT,"DOWN_LEFT"),pae.DOWN_RIGHT=new pae(ure.DOWN_RIGHT,"DOWN_RIGHT"),pae.STEPS=[pae.LEFT,pae.UP_LEFT,pae.UP_RIGHT,pae.RIGHT,pae.DOWN_LEFT,pae.DOWN_RIGHT];var gae=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this)).start=e,o.step=r,o.landingCoord=i,o.capture=a,o}return cp(n,[{key:"isTileExchange",value:function(){return this.capture.isPresent()}},{key:"toString",value:function(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}},{key:"equals",value:function(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}],[{key:"fromMovement",value:function(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");var r=new lre(e.x+t.direction.x,e.y+t.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new n(hB.of(e),hB.of(t),hB.of(r),hB.empty())}},{key:"fromTilesExchange",value:function(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new n(hB.empty(),hB.empty(),hB.empty(),hB.of(e))}},{key:"fromCoordToCoord",value:function(e,t){var r=pae.fromCoords(e,t);return n.fromMovement(e,r)}}]),n}(Ore);gae.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 1035}},{key:"encodeNumber",value:function(e){if(e.isTileExchange()){var t=e.capture.get().y;return 10*e.capture.get().x+t}var n=e.start.get().y,r=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*r+n}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?gae.fromTilesExchange(new lre(n,t)):gae.fromMovement(new lre(n,t),pae.STEPS[e-1])}}]),n}(rte));var yae=function(){function e(){sp(this,e)}return cp(e,null,[{key:"getNeighbors",value:function(e){var t=new lre(e.x-1,e.y),n=new lre(e.x+1,e.y);return(e.x+e.y)%2==1?[t,n,new lre(e.x,e.y-1)]:[t,n,new lre(e.x,e.y+1)]}},{key:"getFakeNeighbors",value:function(e){return new lre(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}},{key:"getCommonNeighbor",value:function(t,n){for(var r=e.getNeighbors(t),i=e.getNeighbors(n),a=0;a<r.length;){for(var o=r[a],s=0;s<i.length;){if(o.equals(i[s]))return hB.of(o);s++}a++}return hB.empty()}}]),e}(),mae=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getEmptyNeighboors",value:function(e,t){return n.getEmptyNeighbors(this.board,e,t)}}],[{key:"getEmptyNeighbors",value:function(e,t,n){var r,i=[],a=ip(yae.getNeighbors(t));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o)}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(Sre),kae=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this,e,r)).tiles=i,o.captures=a,o}return cp(n,[{key:"applyLegalMovement",value:function(e){sB(n.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});var t=e.start.get(),r=e.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=dre.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=dre.EMPTY,new n(i,this.turn,this.tiles,this.captures)}},{key:"doMovementCaptures",value:function(e){sB(n.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});var t,r=this,i=ip(this.getCapturedNeighbors(e.landingCoord.get()));try{for(i.s();!(t=i.n()).done;){var a=t.value;r=r.capture(a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"getCapturedNeighbors",value:function(e){var t=this,n=this.getCurrentOpponent();return yae.getNeighbors(e).filter(function(e){return!e.isNotInRange(15,10)&&!!t.getPieceAt(e).is(n)&&t.isSurrounded(e)})}},{key:"isSurrounded",value:function(e){return 0===this.getEmptyNeighboors(e,dre.EMPTY).length}},{key:"capture",value:function(e){sB(n.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});var t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return sB(n.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=dre.EMPTY,r[this.getCurrentPlayer().value]+=1,new n(t,this.turn,this.tiles,r)}},{key:"removeTilesIfNeeded",value:function(e,t){sB(n.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,tile:e,countTiles:t}});var r=this,i=n.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,t);var a,o=ip(n.getPresentNeighboorEntrances(i));try{for(o.s();!(a=o.n()).done;){var s=a.value,u=r.getPieceAt(s);u===dre.EMPTY?r=r.removeTilesIfNeeded(s,t):u.is(this.getCurrentOpponent())&&r.isSurrounded(s)&&(r=r.capture(s))}}catch(c){o.e(c)}finally{o.f()}}return r}},{key:"isTileEmpty",value:function(e){a6(this.getPieceAt(e)!==dre.NONE,"Should not call isTileEmpty on removed tile");for(var t=0;t<2;t++)for(var n=0;n<3;n++){var r=e.getNext(new are(n,t),1);if(this.getPieceAt(r)!==dre.EMPTY)return!1}return!0}},{key:"isDeconnectable",value:function(e){var t=this.getPresentNeighboorTilesRelativeIndexes(e);if(t.length>3)return!1;for(var n=0,r=1;r<t.length;r++)!1===this.areNeighboor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighboor(t[0],t[t.length-1])&&(n+=1),n<=1}},{key:"areNeighboor",value:function(e,t){return e+1===t||0===e&&5===t}},{key:"getPresentNeighboorTilesRelativeIndexes",value:function(e){for(var t=[],r=hB.empty(),i=0;i<6;i++){var a=e.getNext(n.NEIGHBOORS_TILES_DIRECTIONS[i],1);a.isInRange(15,10)&&this.getPieceAt(a)!==dre.NONE&&(r.isAbsent()&&(r=hB.of(i)),t.push(i-r.get()))}return t}},{key:"deconnectTile",value:function(e,t){sB(n.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});for(var r=this.getCopiedBoard(),i=e.x,a=e.y,o=0;o<2;o++)for(var s=0;s<3;s++)r[a+o][i+s]=dre.NONE;var u=[this.tiles[0],this.tiles[1]];return t&&(u[this.getCurrentPlayer().value]+=1),new n(r,this.turn,u,this.captures)}},{key:"getLegalLandings",value:function(e){var t,n=[],r=ip(pae.STEPS);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.getNext(i.direction,1);this.isOnBoard(a)&&this.getPieceAt(a)===dre.EMPTY&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPiecesByFreedom",value:function(){for(var e=[[0,0,0,0],[0,0,0,0]],t=0;t<10;t++)for(var n=0;n<15;n++){var r=this.board[t][n];if(r.isPlayer()){var i=this.getEmptyNeighboors(new lre(n,t),dre.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}],[{key:"getTilesUpperLeftCoord",value:function(e){var t=e.x-e.x%3,n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new lre(t,n)}},{key:"getPresentNeighboorEntrances",value:function(e){return[new lre(e.x+1,e.y-1),new lre(e.x+3,e.y+0),new lre(e.x+3,e.y+1),new lre(e.x+1,e.y+2),new lre(e.x-1,e.y+1),new lre(e.x-1,e.y+0)].filter(n.isInRange)}},{key:"getInitialState",value:function(){var e=dre.EMPTY,t=dre.NONE,r=dre.ZERO,i=dre.ONE;return new n([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,i,e,i,e,e,r,e,r,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,i,e,i,e,e,r,e,r,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}}]),n}(mae);kae.VERBOSE=!1,kae.NEIGHBOORS_TILES_DIRECTIONS=[new are(0,-2),new are(3,-1),new are(3,1),new are(0,2),new are(-3,1),new are(-3,-1)],kae.isInRange=function(e){return e.isInRange(15,10)};var _ae=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}},{key:"applyLegalTileExchange",value:function(e,t){var r=t.getCopiedBoard(),i=e.capture.get();r[i.y][i.x]=dre.EMPTY;var a=[t.captures[0],t.captures[1]];a[t.getCurrentPlayer().value]+=1;var o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;var s=new kae(r,t.turn,o,a),u=s.removeTilesIfNeeded(i,!1),c=new kae(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return sB(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:t,afterCapture:s,afterTileRemoval:u,resultingState:c}}),c}},{key:"applyLegalMovement",value:function(e,t){var r=t.applyLegalMovement(e),i=r.removeTilesIfNeeded(e.start.get(),!0),a=i.doMovementCaptures(e),o=new kae(a.board,t.turn+1,a.tiles,a.captures);return sB(n.VERBOSE,{ab_state:t,afterMovement:r,afterTilesRemoved:i,afterCaptures:a,resultingState:o}),o}},{key:"isLegal",value:function(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}},{key:"isLegalTileExchange",value:function(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return J5.failure(vae.NOT_ENOUGH_TILES_TO_EXCHANGE());var n=t.getPieceAt(e.capture.get());return n===dre.NONE||n===dre.EMPTY?J5.failure(vae.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?J5.failure(vae.CANNOT_CAPTURE_OWN_PIECES()):J5.success(void 0)}},{key:"isLegalMovement",value:function(e,t){if(t.getPieceAt(e.start.get())===dre.NONE){var n="Cannot start with a coord outside the board "+e.start.get().toString()+".";return J5.failure(n)}if(t.getPieceAt(e.landingCoord.get())===dre.NONE){var r="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return J5.failure(r)}var i=t.getPieceAt(e.start.get());return i===dre.EMPTY?J5.failure(kre.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.is(t.getCurrentOpponent())?J5.failure(kre.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?J5.failure(kre.MUST_LAND_ON_EMPTY_SPACE()):J5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captures[0]>=18?Dre.ZERO_WON:t.captures[1]>=18?Dre.ONE_WON:Dre.ONGOING}}]),n}(Lre);return e.VERBOSE=!1,e}(),wae=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}},{key:"getListExchanges",value:function(e){var t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=dre.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(var a=0;a<10;a++)for(var o=0;o<15;o++){var s=new lre(o,a);if(n.getPieceAt(s)===i){var u=gae.fromTilesExchange(s);t.push(u)}}return t}},{key:"getListMovement",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<10;i++)for(var a=0;a<15;a++){var o=new lre(a,i);if(n.getPieceAt(o).is(r)){var s,u=ip(n.getLegalLandings(o));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=gae.fromCoordToCoord(o,c);t.push(l)}}catch(h){u.e(h)}finally{u.f()}}}return t}},{key:"getBoardValue",value:function(e){var t=_ae.getGameStatus(e);if(t.isEndGame)return wre.fromWinner(t.winner);var n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new wre(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}},{key:"getPiecesScore",value:function(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}},{key:"getPlayerPiecesScore",value:function(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}},{key:"putCaptureFirst",value:function(e,t){var n=this;return lte.sortByDescending(t,function(t){return n.moveCapturesList(e,t).length}),t}},{key:"moveCapturesList",value:function(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}]),n}(_re),Cae=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getBoardValue",value:function(e){var t=_ae.getGameStatus(e);if(t.isEndGame)return wre.fromWinner(t.winner);for(var r=e.gameState,i=this.getPiecesMap(r),a=this.getThreatMap(r,i),o=this.filterThreatMap(a,r),s=0,u=0,c=[ote.ZERO,ote.ONE];u<c.length;u++){var l,h=c[u],f=ip(i.get(h).get());try{for(f.s();!(l=f.n()).done;){var d=l.value;o.get(d).isPresent()?s+=h.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:s+=h.getScoreModifier()*n.SCORE_BY_SAFE_PIECE}}catch(v){f.e(v)}finally{f.f()}}return s+=r.tiles[1]-r.tiles[0],new wre(s)}},{key:"getPiecesMap",value:function(e){for(var t=new Are,n=[],r=[],i=0;i<10;i++)for(var a=0;a<15;a++){var o=new lre(a,i),s=e.getPieceAt(o);s===dre.ZERO?n.push(o):s===dre.ONE&&r.push(o)}return t.set(ote.ZERO,new Wie(n)),t.set(ote.ONE,new Wie(r)),t}},{key:"getThreatMap",value:function(e,t){for(var n=new Are,r=0,i=[ote.ZERO,ote.ONE];r<i.length;r++){var a,o=i[r],s=ip(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreat(u,e);c.isPresent()&&n.set(u,c.get())}}catch(l){s.e(l)}finally{s.f()}}return n}},{key:"getThreat",value:function(e,t){var n,r=ote.of(t.getPieceAt(e).value).getOpponent(),i=hB.empty(),a=[],o=ip(yae.getNeighbors(e).filter(function(e){return e.isInRange(15,10)}));try{for(o.s();!(n=o.n()).done;){var s=n.value,u=t.getPieceAt(s);if(u.is(r))a.push(s);else if(u===dre.EMPTY){if(i.isPresent())return hB.empty();i=hB.of(s)}}}catch(d){o.e(d)}finally{o.f()}if(i.isPresent()){var c,l=[],h=ip(pae.STEPS);try{var f=function(){var e=c.value,n=i.get().getNext(e.direction,1);n.isInRange(15,10)&&t.getPieceAt(n).is(r)&&a.every(function(e){return!1===e.equals(n)})&&l.push(n)};for(h.s();!(c=h.n()).done;)f()}catch(d){h.e(d)}finally{h.f()}if(l.length>0)return hB.of(new qie(new Wie(a),new Wie(l)))}return hB.empty()}},{key:"filterThreatMap",value:function(e,t){var n,r=new Are,i=e.listKeys(),a=i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentPlayer())}),o=new Wie(i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentOpponent())})),s=ip(a);try{for(s.s();!(n=s.n()).done;){var u=n.value,c=e.get(u).get();a6(1===c.directThreats.size(),"oldThreat must contain exactly one direct threat");var l=c.directThreats.getAnyElement().get(),h=hB.empty();if(!1===o.contains(l)){var f,d=[],v=ip(c.mover);try{for(v.s();!(f=v.n()).done;){var p=f.value;!1===o.contains(p)&&d.push(p)}}catch(_){v.e(_)}finally{v.f()}d.length>0&&(h=hB.of(new qie(c.directThreats,new Wie(d))))}h.isPresent()&&r.set(u,h.get())}}catch(_){s.e(_)}finally{s.f()}var g,y=ip(o);try{for(y.s();!(g=y.n()).done;){var m=g.value,k=e.get(m).get();r.set(m,k)}}catch(_){y.e(_)}finally{y.f()}return r}}]),n}(wae);return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e}(),bae=dre.EMPTY,Eae=dre.NONE,Sae=dre.ZERO,Pae=dre.ONE,Oae=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(Rt||(Rt=Vv(["Board and goal of the game"]))),$localize(Nt||(Nt=Vv(["Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.\n         The triangles are the spaces on which pieces move during the game.\n         The tiles can be removed from the board (you will see how later).\n         The dark pieces belong to the first player and can only move on the dark spaces,\n         while the light pieces belong to the second player and can only move on the light spaces.\n         The goal of the game is to capture all of the opponent's pieces."]))),kae.getInitialState()),Vre.anyMove($localize(Mt||(Mt=Vv(["Move"]))),$localize(Dt||(Dt=Vv(["To move a piece, you need to:\n        <ol>\n          <li>Click on one of your pieces.</li>\n          <li>Click on one of the triangular space highlighted in yellow.</li>\n        </ol>\n        You can pass through the opponent's pieces.\n        You're playing first, hence you're playing Dark.<br/><br/>\n        Perform any move."]))),kae.getInitialState(),gae.fromCoordToCoord(new lre(3,5),new lre(5,5)),$localize(Lt||(Lt=Vv(["Congratulations! Let's see captures now."])))),Vre.fromMove($localize(Ft||(Ft=Vv(["Capture"]))),$localize(Bt||(Bt=Vv(["Every piece has three neighboring triangular spaces (2 on the sides).\n        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!\n        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>\n        You're playing Light, make a capture."]))),new kae([[Eae,Eae,Eae,Eae,Eae,Eae,Sae,bae,Sae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Sae,bae,bae,bae,bae,bae,Sae,bae,bae,Eae,Eae,Eae],[bae,Pae,bae,Pae,Sae,Pae,bae,bae,Sae,bae,bae,Pae,bae,Pae,bae],[Pae,bae,bae,bae,bae,bae,bae,bae,bae,bae,Pae,bae,bae,bae,Pae],[bae,Pae,bae,Pae,bae,bae,bae,bae,bae,bae,bae,Pae,bae,Pae,bae],[bae,Sae,bae,Sae,bae,bae,bae,bae,bae,bae,bae,Sae,bae,Sae,bae],[Sae,bae,bae,bae,Sae,bae,bae,bae,bae,bae,Sae,bae,bae,bae,Sae],[bae,Sae,bae,Sae,bae,bae,Pae,bae,Pae,bae,bae,Sae,bae,Sae,bae],[Eae,Eae,Eae,bae,bae,Pae,bae,bae,bae,Pae,bae,bae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Pae,bae,Pae,Eae,Eae,Eae,Eae,Eae,Eae]],3,[0,0],[0,0]),[gae.fromCoordToCoord(new lre(5,2),new lre(4,1)),gae.fromCoordToCoord(new lre(3,4),new lre(4,3))],$localize(Ut||(Ut=Vv(["Congratulations!"]))),$localize(Vt||(Vt=Vv(["Failed, you have not captured any piece."])))),Vre.fromMove($localize(zt||(zt=Vv(["Gain a tile"]))),$localize(Ht||(Ht=Vv(["When a tile is empty, it can become removable from the board.\n        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.\n        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.\n        For example, here, the topmost dark piece will not disconnect its tile when leaving it.\n        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>\n        Perform a move that lets you gain two tiles."]))),new kae([[Eae,Eae,Eae,Eae,Eae,Eae,bae,bae,bae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Pae,bae,bae,Eae,Eae,Eae,Eae,Eae,Eae],[bae,bae,bae,Eae,Eae,Eae,bae,bae,bae,Eae,Eae,Eae,Eae,Eae,Eae],[bae,bae,Pae,bae,bae,bae,bae,Sae,bae,Eae,Eae,Eae,Eae,Eae,Eae],[bae,bae,bae,Pae,bae,bae,bae,bae,bae,Eae,Eae,Eae,Eae,Eae,Eae],[bae,bae,bae,bae,bae,bae,bae,bae,bae,bae,bae,Sae,Eae,Eae,Eae],[bae,bae,Sae,bae,bae,Pae,bae,bae,bae,bae,Sae,bae,bae,bae,Sae],[bae,bae,bae,bae,bae,bae,Pae,bae,Pae,bae,bae,Sae,bae,Sae,bae],[Eae,Eae,Eae,bae,bae,Pae,bae,bae,bae,Pae,bae,bae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Pae,bae,Pae,Eae,Eae,Eae,Eae,Eae,Eae]],2,[0,0],[0,0]),[gae.fromCoordToCoord(new lre(2,6),new lre(4,6)),gae.fromCoordToCoord(new lre(2,6),new lre(3,5)),gae.fromCoordToCoord(new lre(2,6),new lre(3,7))],$localize(Gt||(Gt=Vv(["Congratulations!"]))),$localize(qt||(qt=Vv(["Failed, you have not gained the two tiles that you could, try again!"])))),Vre.fromMove($localize($t||($t=Vv(["Exchanging a tile"]))),$localize(Wt||(Wt=Vv(["When you have a tile, you can see it on the left of the board.\n        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.\n        This will cost you two tiles.\n        If any tiles are removed during that turn, nobody will get them.<br/><br/>\n        Gain some time and capture the last piece!"]))),new kae([[Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,bae,bae,Sae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,bae,bae,bae,bae,bae,bae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,bae,bae,bae,Pae,bae,Pae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,bae,bae,Pae,bae,bae,bae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Pae,bae,Pae,Eae,Eae,Eae,Eae,Eae,Eae]],1,[0,2],[0,0]),[gae.fromTilesExchange(new lre(5,5))],$localize(jt||(jt=Vv(["Congratulations!"]))),$localize(Zt||(Zt=Vv(["It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!"])))),Vre.fromMove($localize(Yt||(Yt=Vv(["Special capture"]))),$localize(Kt||(Kt=Vv(["When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!\n        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>\n        A move that demonstrate both of these things can be done on this board by Light. Try it!"]))),new kae([[Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,bae,bae,Sae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,bae,bae,Sae,bae,bae,bae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,bae,Sae,Pae,bae,Pae,bae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,bae,Pae,Sae,bae,bae,bae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,bae,bae,Pae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae],[Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae,Eae]],1,[0,0],[0,0]),[gae.fromCoordToCoord(new lre(7,6),new lre(6,5)),gae.fromCoordToCoord(new lre(7,6),new lre(8,5))],$localize(Jt||(Jt=Vv(["Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.\n        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space."]))),$localize(Qt||(Qt=Vv(["Failed!"]))))]});function Tae(e,t){if(1&e&&(Pm(),yb(0,"polygon",13)),2&e){var n=Pb().index,r=Pb().index,i=Pb();db("ngClass",i.getPyramidClass(n,r)),ob("points",i.getPyramidCoordinate(n,r))}}function Iae(e,t){if(1&e&&(Pm(),yb(0,"polygon",15)),2&e){var n=Pb(2).index,r=Pb().index,i=Pb();db("ngClass",i.getEmptyClass(n,r)),ob("points",i.getTriangleCoordinate(n,r))}}function xae(e,t){if(1&e&&(Pm(),lb(0,Iae,1,2,"polygon",14)),2&e){var n=Pb().index,r=Pb().index;db("ngIf",Pb().isEmptyCase(n,r))}}function Aae(e,t){if(1&e&&(Pm(),yb(0,"polygon",16)),2&e){var n=Pb().index,r=Pb().index,i=Pb();Ib("id","dark_line_",n,"_",r,""),ob("points",i.getLineCoordinate(n,r))}}function Rae(e,t){if(1&e&&(Pm(),yb(0,"polygon",17)),2&e){var n=Pb().index,r=Pb().index,i=Pb();Ib("id","dark_line_",n,"_",r,""),ob("points",i.getLineCoordinate(n,r))}}function Nae(e,t){if(1&e){var n=_b();Pm(),pb(0,"g",8),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onClick(e,t)}),lb(1,Tae,1,2,"polygon",9),lb(2,xae,1,1,"ng-template",null,10,NP),lb(4,Aae,1,3,"polygon",11),lb(5,Rae,1,3,"polygon",12),gb()}if(2&e){var r=t.$implicit,i=t.index,a=hb(3),o=Pb().index,s=Pb();Ib("id","click_",i,"_",o,""),Rw(1),db("ngIf",s.isPyramid(i,o))("ngIfElse",a),Rw(3),db("ngIf",r!==s.NONE),Rw(1),db("ngIf",r!==s.NONE)}}function Mae(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Nae,6,6,"g",7),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function Dae(e,t){if(1&e&&(Pm(),yb(0,"polygon",18)),2&e){var n=t.$implicit;ob("points",Pb().getTriangleCoordinate(n.x,n.y))}}function Lae(e,t){if(1&e&&(Pm(),yb(0,"polygon",19)),2&e){var n=Pb();ob("points",n.getTriangleCoordinate(n.lastStart.get().x,n.lastStart.get().y))}}function Fae(e,t){if(1&e&&(Pm(),yb(0,"polygon",19)),2&e){var n=Pb();ob("points",n.getTriangleCoordinate(n.lastEnd.get().x,n.lastEnd.get().y))}}function Bae(e,t){if(1&e&&(Pm(),yb(0,"polygon",20)),2&e){var n=Pb();ob("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function Uae(e,t){if(1&e&&(Pm(),pb(0,"g",21),yb(1,"polygon",22),pb(2,"text",23),Bb(3),gb(),gb()),2&e){var n=Pb();Rw(1),ob("points",n.getTilesCountCoordinate(0,0))("stroke",n.lastTurnWasTilesExchange(0)?"yellow":"black"),Rw(1),ob("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+0*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),Rw(1),Ub(n.tiles[0])}}function Vae(e,t){if(1&e&&(Pm(),pb(0,"g",24),yb(1,"polygon",25),pb(2,"text",26),Bb(3),gb(),gb()),2&e){var n=Pb();Rw(1),ob("points",n.getTilesCountCoordinate(0,9))("stroke",n.lastTurnWasTilesExchange(1)?"yellow":"black"),Rw(1),ob("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+9*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),Rw(1),Ub(n.tiles[1])}}var zae=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).tiles=[0,0],r.NONE=dre.NONE,r.chosenCoord=hB.empty(),r.lastStart=hB.empty(),r.lastEnd=hB.empty(),r.highlights=[],r.scores=hB.of([0,0]),r.rules=new _ae(kae),r.availableMinimaxes=[new wae(r.rules,"Normal"),new Cae(r.rules,"Piece > Threat > Tiles")],r.encoder=gae.encoder,r.tutorial=(new Oae).tutorial,r.SPACE_SIZE=70,r.updateBoard(),r}return cp(n,[{key:"updateBoard",value:function(){this.chosenCoord=hB.empty(),this.state=this.rules.node.gameState,this.scores=hB.of(this.state.captures),this.tiles=this.state.tiles;var e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=hB.empty(),this.lastEnd=hB.empty()),this.board=this.rules.node.gameState.board}},{key:"showHighlight",value:function(){this.highlights=this.state.getLegalLandings(this.chosenCoord.get())}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=hB.empty(),this.highlights=[]}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new lre(e,t),r.abrupt("return",n.chosenCoord.isAbsent()?n.firstClick(a):n.secondClick(a));case 5:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.state.getPieceAt(e)).is(t.state.getCurrentOpponent())){n.next=4;break}return i=gae.fromTilesExchange(e),n.abrupt("return",t.chooseMove(i,t.state,t.state.captures));case 4:return n.abrupt("return",r.is(t.state.getCurrentPlayer())?(t.chosenCoord=hB.of(e),t.showHighlight(),e6.SUCCESS):t.cancelMove(vae.FIRST_CLICK_SHOULD_NOT_BE_NULL()));case 5:case"end":return n.stop()}},n)}))()}},{key:"secondClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.equals(t.chosenCoord.get())){n.next=2;break}return n.abrupt("return",(t.cancelMoveAttempt(),e6.SUCCESS));case 2:if(!t.highlights.some(function(t){return t.equals(e)})){n.next=5;break}return r=gae.fromCoordToCoord(t.chosenCoord.get(),e),n.abrupt("return",t.chooseMove(r,t.state,t.state.captures));case 5:return n.abrupt("return",t.cancelMove(vae.INVALID_DISTANCE()));case 6:case"end":return n.stop()}},n)}))()}},{key:"isPyramid",value:function(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}},{key:"wasOpponent",value:function(e,t){var n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}},{key:"getPyramidClass",value:function(e,t){var n=this.board[t][e];return n===dre.ZERO?this.getPlayerClass(ote.ZERO):n===dre.ONE?this.getPlayerClass(ote.ONE):"captured"}},{key:"isEmptyCase",value:function(e,t){return this.board[t][e]===dre.EMPTY||this.wasRemoved(e,t)}},{key:"wasRemoved",value:function(e,t){var n=this.rules.node.mother;if(this.board[t][e]===dre.NONE&&n.isPresent()){var r=n.get().gameState.getPieceAtXY(e,t);return r===dre.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}},{key:"getEmptyClass",value:function(e,t){return this.board[t][e]===dre.EMPTY?(e+t)%2==1?"background":"background2":"captured2"}},{key:"getTilesCountCoordinate",value:function(e,t){var n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}},{key:"getLineCoordinate",value:function(e,t){var n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}},{key:"mustShowTilesOf",value:function(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}},{key:"lastTurnWasTilesExchange",value:function(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}]),n}(dae);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-coerceo"]],features:[jC],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill highlighted",4,"ngFor","ngForOf"],["class","base no-fill last-move",4,"ngIf"],["class","base no-fill selected",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptyCase",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","last-move"],[1,"base","no-fill","selected"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,Mae,2,1,"g",1),lb(2,Dae,1,1,"polygon",2),lb(3,Lae,1,1,"polygon",3),lb(4,Fae,1,1,"polygon",3),lb(5,Bae,1,1,"polygon",4),lb(6,Uae,4,6,"g",5),lb(7,Vae,4,6,"g",6),gb()),2&e&&(ob("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),Rw(1),db("ngForOf",t.board),Rw(1),db("ngForOf",t.highlights),Rw(1),db("ngIf",t.lastStart.isPresent()),Rw(1),db("ngIf",t.lastEnd.isPresent()),Rw(1),db("ngIf",t.chosenCoord.isPresent()),Rw(1),db("ngIf",t.mustShowTilesOf(0)),Rw(1),db("ngIf",t.mustShowTilesOf(1)))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Hae=function(){var e=cp(function e(){sp(this,e)});return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=function(){return $localize(Xt||(Xt=Vv(["Your piece should land on a neighboring square."])))},e.CANNOT_DROP_AFTER_TURN_40=function(){return $localize(en||(en=Vv(["You cannot drop a piece during the moving phase."])))},e.CANNOT_MOVE_BEFORE_TURN_40=function(){return $localize(tn||(tn=Vv(["You cannot move a piece before both players have dropped all of their pieces."])))},e.MUST_JUMP_OVER_PIECES=function(){return $localize(nn||(nn=Vv(["A jump must be made over a piece, not over an empty square."])))},e.MUST_DROP_IN_CENTRAL_ZONE=function(){return $localize(rn||(rn=Vv(["A drop must occur in the central zone of the board."])))},e.INVALID_JUMP=function(){return $localize(an||(an=Vv(["A jump must land two squares from its original position, and be done in a straight line in any direction."])))},e.SAME_LOCATION_VISITED_IN_JUMP=function(){return $localize(on||(on=Vv(["You are visiting the same location twice in a move, you are not allowed to do so."])))},e}(),Gae=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"isShelter",value:function(e){return 0===e.x||e.x===n.WIDTH-1?n.SHELTERS_INDICES.some(function(t){return e.y===t}):(0===e.y||e.y===n.HEIGHT-1)&&n.SHELTERS_INDICES.some(function(t){return e.x===t})}},{key:"isCentralZone",value:function(e){return e.x>=n.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=n.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=n.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=n.CENTRAL_ZONE_BOTTOM_RIGHT.y}},{key:"isDropPhase",value:function(){return this.turn<40}},{key:"getSidePieces",value:function(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}],[{key:"getInitialState",value:function(){return new n(lte.createTable(n.WIDTH,n.HEIGHT,ate.NONE),0)}}]),n}(Sre);Gae.WIDTH=17,Gae.HEIGHT=17,Gae.CENTRAL_ZONE_TOP_LEFT=new lre(4,6),Gae.CENTRAL_ZONE_BOTTOM_RIGHT=new lre(12,10),Gae.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],Gae.ALL_SHELTERS=new bre(Gae.SHELTERS_INDICES.flatMap(function(e){return[new lre(e,0),new lre(e,Gae.HEIGHT-1),new lre(0,e),new lre(Gae.WIDTH-1,e)]})).toList();var qae=function(e){Yv(n,e);var t=Jv(n);function n(e){return sp(this,n),t.call(this,e.x,e.y)}return cp(n,[{key:"toString",value:function(){return"ConspirateursMoveDrop(".concat(this.coord.toString(),")")}},{key:"equals",value:function(e){return!!e.isDrop()&&this.coord.equals(e.coord)}},{key:"isDrop",value:function(){return!0}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e){return e.isInRange(Gae.WIDTH,Gae.HEIGHT)?J5.success(new n(e)):J5.failure("Move out of board")}}]),n}(Tre);qae.encoder=function(){function e(){sp(this,e)}return cp(e,null,[{key:"getEncoder",value:function(e,t,n){return new(function(r){Yv(a,r);var i=Jv(a);function a(){var e;return sp(this,a),(e=i.apply(this,arguments)).shiftX=t,e}return cp(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftX+e.coord.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new lre((r-=r%1)%e,i);return n(a)}}]),a}(rte))}}]),e}().getEncoder(Gae.WIDTH,Gae.HEIGHT,function(e){return qae.of(e).get()});var $ae=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,r)}return cp(n,[{key:"toString",value:function(){return"ConspirateursMoveSimple(".concat(this.coord.toString()," -> ").concat(this.end.toString(),")")}},{key:"equals",value:function(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!0}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e,t){return e.isInRange(Gae.WIDTH,Gae.HEIGHT)&&t.isInRange(Gae.WIDTH,Gae.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?J5.success(new n(e,t)):J5.failure(Hae.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):J5.failure("Move out of board")}}]),n}(Aie);$ae.encoder=Aie.getEncoder(Gae.WIDTH,Gae.HEIGHT,function(e,t){return $ae.of(e,t).get()});var Wae=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).coords=e,r}return cp(n,[{key:"addJump",value:function(e){var t=lte.copyImmutableArray(this.coords);return t.push(e),n.of(t)}},{key:"getStartingCoord",value:function(){return this.coords[0]}},{key:"getEndingCoord",value:function(){return this.coords[this.coords.length-1]}},{key:"getLandingCoords",value:function(){return this.coords.slice(1)}},{key:"getJumpedOverCoords",value:function(){for(var e=[],t=1;t<this.coords.length;t++){var n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}},{key:"toString",value:function(){return"ConspirateursMoveJump(".concat(this.coords.map(function(e){return e.toString()}).reduce(function(e,t){return e+" -> "+t}),")")}},{key:"equals",value:function(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!0}}],[{key:"of",value:function(e){if(e.length<2)return J5.failure("ConspirateursMoveJump requires at least one jump, so two coords");var t,r=ip(e);try{for(r.s();!(t=r.n()).done;){if(t.value.isNotInRange(Gae.WIDTH,Gae.HEIGHT))return J5.failure("Move out of board")}}catch(a){r.e(a)}finally{r.f()}for(var i=1;i<e.length;i++)if(e[i-1].getDirectionToward(e[i]).isFailure()||2!==e[i-1].getDistance(e[i]))return J5.failure(Hae.INVALID_JUMP());return new Wie(e).size()===e.length?J5.success(new n(e)):J5.failure(Hae.SAME_LOCATION_VISITED_IN_JUMP())}}]),n}(Ore);Wae.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).coordEncoder=lre.numberEncoder(Gae.WIDTH,Gae.HEIGHT),e}return cp(n,[{key:"encodeMove",value:function(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}},{key:"decodeMove",value:function(e){a6(null!=oB.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");var t=oB.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return Wae.of(t).get()}}]),n}(nte));var jae=nte.disjunction3(qae.encoder,$ae.encoder,Wae.encoder,function(e){return e.isDrop()},function(e){return e.isSimple()}),Zae=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.call(this,Gae)}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=ate.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{var i=e.getStartingCoord(),a=e.getEndingCoord();r[i.y][i.x]=ate.NONE,r[a.y][a.x]=t.getCurrentPlayer()}return new Gae(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}},{key:"dropLegality",value:function(e,t){return t.turn>=40?J5.failure(Hae.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?J5.failure(kre.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?J5.failure(Hae.MUST_DROP_IN_CENTRAL_ZONE()):J5.success(void 0)}},{key:"simpleMoveLegality",value:function(e,t){return t.turn<40?J5.failure(Hae.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?J5.failure(kre.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end).isPlayer()?J5.failure(kre.MUST_LAND_ON_EMPTY_SPACE()):J5.success(void 0)}},{key:"jumpLegality",value:function(e,t){if(t.turn<40)return J5.failure(Hae.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return J5.failure(kre.MUST_CHOOSE_PLAYER_PIECE());var n,r=ip(e.getJumpedOverCoords());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.getPieceAt(i)===ate.NONE)return J5.failure(Hae.MUST_JUMP_OVER_PIECES())}}catch(u){r.e(u)}finally{r.f()}var a,o=ip(e.getLandingCoords());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t.getPieceAt(s).isPlayer())return J5.failure(kre.MUST_LAND_ON_EMPTY_SPACE())}}catch(u){o.e(u)}finally{o.f()}return J5.success(void 0)}},{key:"jumpTargetsFrom",value:function(e){for(var t=[],n=0,r=[new lre(e.x+2,e.y),new lre(e.x-2,e.y),new lre(e.x,e.y+2),new lre(e.x,e.y-2),new lre(e.x+2,e.y+2),new lre(e.x+2,e.y-2),new lre(e.x-2,e.y+2),new lre(e.x-2,e.y-2)];n<r.length;n++){var i=r[n];Wae.of([e,i]).isSuccess()&&t.push(i)}return t}},{key:"nextJumps",value:function(e,t){var n,r=e.getEndingCoord(),i=[],a=ip(this.jumpTargetsFrom(r));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"jumpHasPossibleNextTargets",value:function(e,t){return this.nextJumps(e,t).length>0}},{key:"getGameStatus",value:function(e){var t,n=e.gameState,r=[0,0],i=ip(Gae.ALL_SHELTERS);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.getPieceAt(a);if(o.isPlayer()&&(r[o.value]+=1,20===r[o.value]))return Dre.getVictory(o)}}catch(s){i.e(s)}finally{i.f()}return Dre.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=hB.of(new n)),n.singleton.get()}}]),n}(Lre);Zae.singleton=hB.empty();var Yae=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}},{key:"getListMovesDrop",value:function(e){for(var t=[],n=Gae.CENTRAL_ZONE_TOP_LEFT,r=Gae.CENTRAL_ZONE_BOTTOM_RIGHT,i=n.y;i<=r.y;i++)for(var a=n.x;a<=r.x;a++)e.getPieceAtXY(a,i)===ate.NONE&&t.push(qae.of(new lre(a,i)).get());return t}},{key:"getListMovesAfterDrop",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<Gae.HEIGHT;r++)for(var i=0;i<Gae.WIDTH;i++){var a=new lre(i,r);e.getPieceAt(a)===n&&(t=(t=t.concat(this.getListSimpleMoves(e,a))).concat(this.getListJumps(e,a)))}return t}},{key:"getListSimpleMoves",value:function(e,t){for(var n=[],r=0,i=[new lre(t.x+1,t.y),new lre(t.x-1,t.y),new lre(t.x,t.y+1),new lre(t.x,t.y-1),new lre(t.x+1,t.y+1),new lre(t.x+1,t.y-1),new lre(t.x-1,t.y+1),new lre(t.x-1,t.y-1)];r<i.length;r++){var a=i[r],o=$ae.of(t,a);o.isSuccess()&&Zae.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}},{key:"getListJumps",value:function(e,t){var n,r=new bre,i=ip(Zae.get().jumpTargetsFrom(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=Wae.of([t,a]).get();Zae.get().jumpLegality(o,e).isSuccess()&&(r.add(o),r.union(this.getListJumpStartingFrom(e,o)))}}catch(s){i.e(s)}finally{i.f()}return r.toList()}},{key:"getListJumpStartingFrom",value:function(e,t){var n,r=Zae.get().nextJumps(t,e),i=new bre(r),a=ip(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.union(this.getListJumpStartingFrom(e,o))}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=0,r=new Are;r.set(ote.ZERO,0),r.set(ote.ONE,0);for(var i=0;i<Gae.HEIGHT;i++)for(var a=0;a<Gae.WIDTH;a++){var o=new lre(a,i),s=t.getPieceAt(o);if(s.isPlayer())if(t.isShelter(o)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new wre(s.getVictoryValue())}else{var u,c=100,l=ip(Gae.ALL_SHELTERS);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(t.getPieceAt(h)===ate.NONE){var f=o.getOrthogonalDistance(h);c=Math.min(c,f)}}}catch(d){l.e(d)}finally{l.f()}n-=s.getScoreModifier()*c}}return new wre(n)}}]),n}(_re),Kae=ate.NONE,Jae=ote.ZERO,Qae=ote.ONE,Xae=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(sn||(sn=Vv(["Board and aim of the game"]))),$localize(un||(un=Vv(["Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially."]))),Gae.getInitialState()),Vre.anyMove($localize(cn||(cn=Vv(["Initial phase"]))),$localize(ln||(ln=Vv(["In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone."]))),Gae.getInitialState(),qae.of(new lre(7,7)).get(),$localize(hn||(hn=Vv(["Congratulations!"])))),Vre.fromPredicate($localize(fn||(fn=Vv(["Simple move"]))),$localize(dn||(dn=Vv(["Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move."]))),new Gae([[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Jae,Jae,Qae,Qae,Jae,Jae,Qae,Jae,Qae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Jae,Qae,Jae,Qae,Jae,Jae,Jae,Jae,Qae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Jae,Qae,Kae,Kae,Kae,Kae,Kae,Qae,Jae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Qae,Jae,Jae,Qae,Qae,Qae,Jae,Jae,Jae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Qae,Jae,Qae,Qae,Qae,Qae,Qae,Qae,Jae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae]],40),$ae.of(new lre(4,6),new lre(3,5)).get(),function(e,t){return e.isSimple()?e6.SUCCESS:e6.failure($localize(vn||(vn=Vv(["You have made a jump, not a simple move. Try again!"]))))},$localize(pn||(pn=Vv(["Congratulations!"])))),Vre.fromPredicate($localize(gn||(gn=Vv(["Jumps"]))),$localize(yn||(yn=Vv(["The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful)."]))),new Gae([[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Jae,Jae,Qae,Qae,Jae,Jae,Qae,Jae,Qae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Jae,Qae,Jae,Qae,Jae,Jae,Jae,Jae,Qae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Jae,Qae,Kae,Kae,Kae,Kae,Kae,Qae,Jae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Qae,Jae,Jae,Qae,Qae,Qae,Jae,Jae,Jae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Qae,Jae,Qae,Qae,Qae,Qae,Qae,Qae,Jae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae]],40),Wae.of([new lre(6,7),new lre(6,5)]).get(),function(e,t){return e.isJump()?e6.SUCCESS:e6.failure($localize(mn||(mn=Vv(["You have not performed a jump. Try again!"]))))},$localize(kn||(kn=Vv(["Congratulations!"])))),Vre.fromMove($localize(_n||(_n=Vv(["Chaining jumps in a single move"]))),$localize(wn||(wn=Vv(["Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it."]))),new Gae([[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Qae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Qae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Qae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Jae,Jae,Kae,Qae,Jae,Jae,Qae,Jae,Qae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Jae,Kae,Jae,Qae,Jae,Jae,Jae,Jae,Qae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Jae,Qae,Kae,Kae,Kae,Kae,Kae,Qae,Jae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Qae,Jae,Jae,Qae,Qae,Qae,Jae,Jae,Jae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Qae,Jae,Qae,Qae,Qae,Qae,Qae,Qae,Jae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae],[Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae,Kae]],40),[Wae.of([new lre(8,6),new lre(6,4),new lre(6,2),new lre(6,0)]).get()],$localize(Cn||(Cn=Vv(["Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does."]))),$localize(bn||(bn=Vv(["You have not performed a triple jump. Try again!"]))))]});function eoe(e,t){if(1&e){var n=_b();Pm(),pb(0,"rect",9),bb("click",function(){Jy(n);var e=Pb().$implicit;return Pb(2).onClick(e.coord)}),gb()}if(2&e){var r=Pb().$implicit,i=Pb(2);ob("x",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.x+i.STROKE_WIDTH)("y",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE-3*i.STROKE_WIDTH)("height",i.SPACE_SIZE-3*i.STROKE_WIDTH)}}function toe(e,t){if(1&e){var n=_b();Pm(),pb(0,"circle",6),bb("click",function(){Jy(n);var e=Pb().$implicit;return Pb(2).onClick(e.coord)}),gb()}if(2&e){var r=Pb(),i=r.index,a=r.$implicit,o=Pb().index,s=Pb();Ib("id","piece_",i,"_",o,""),db("ngClass",a.pieceClasses),ob("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function noe(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",6),bb("click",function(){var e=Jy(n).$implicit;return Pb(2).onClick(e.coord)}),gb(),lb(2,eoe,1,4,"rect",7),lb(3,toe,1,6,"circle",8),gb()}if(2&e){var r=t.$implicit,i=t.index,a=Pb().index,o=Pb();Rw(1),Ib("id","click_",i,"_",a,""),db("ngClass",r.squareClasses),ob("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Rw(1),db("ngIf",r.isShelter),Rw(1),db("ngIf",r.hasPiece)}}function roe(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,noe,4,9,"g",1),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function ioe(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",10),bb("click",function(){var e=Jy(n).$implicit;return Pb().onClick(e)}),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb();Rw(1),db("ngClass",i.viewInfo.boardInfo[r.y][r.x].shelterClasses),ob("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function aoe(e,t){if(1&e&&(Pm(),yb(0,"circle",11)),2&e){var n=t.$implicit,r=Pb();Tb("id","sidePiece_0_",n,""),ob("cx",-r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function ooe(e,t){if(1&e&&(Pm(),yb(0,"circle",12)),2&e){var n=t.$implicit,r=Pb();Tb("id","sidePiece_1_",n,""),ob("cx",1715+r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function soe(e,t){if(1&e&&(Pm(),yb(0,"rect",13)),2&e){var n=Pb();ob("x",n.SPACE_SIZE*n.CENTRAL_ZONE_START.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.CENTRAL_ZONE_START.y+n.STROKE_WIDTH)("width",n.CENTRAL_ZONE_SIZE.x*n.SPACE_SIZE)("height",n.CENTRAL_ZONE_SIZE.y*n.SPACE_SIZE)}}var uoe=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).ALL_SHELTERS=Gae.ALL_SHELTERS,r.CENTRAL_ZONE_START=Gae.CENTRAL_ZONE_TOP_LEFT,r.CENTRAL_ZONE_SIZE=new are(Gae.CENTRAL_ZONE_BOTTOM_RIGHT.x-Gae.CENTRAL_ZONE_TOP_LEFT.x+1,Gae.CENTRAL_ZONE_BOTTOM_RIGHT.y-Gae.CENTRAL_ZONE_TOP_LEFT.y+1),r.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},r.selected=hB.empty(),r.jumpInConstruction=hB.empty(),r.PIECE_RADIUS=.5*(r.SPACE_SIZE-2*r.STROKE_WIDTH),r.rules=Zae.get(),r.availableMinimaxes=[new Yae(r.rules,"ConspirateursMinimax")],r.encoder=jae,r.tutorial=(new Xae).tutorial,r}return cp(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"updateViewInfo",value:function(){var e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(var t=0;t<Gae.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(var n=0;n<Gae.WIDTH;n++){var r=new lre(n,t),i=e.getPieceAt(r),a={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(a)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}},{key:"updateOccupiedShelters",value:function(){var e,t=ip(Gae.ALL_SHELTERS);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.viewInfo.boardInfo[n.y][n.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("highlighted")}}catch(i){t.e(i)}finally{t.f()}}},{key:"updateSelected",value:function(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){var e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;var r,i=ip(e.coords);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.boardInfo[a.y][a.x].squareClasses.push("moved")}}catch(s){i.e(s)}finally{i.f()}}else{var o=this.selected.get();this.viewInfo.boardInfo[o.y][o.x].pieceClasses.push("selected")}}},{key:"updateVictory",value:function(){var e=this.getState(),t=Zae.get().getGameStatus(this.rules.node);if(!0===t.isEndGame){var n,r=ip(Gae.ALL_SHELTERS);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.getPieceAt(i)===t.winner&&this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("victory")}}catch(a){r.e(a)}finally{r.f()}}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved");else{this.viewInfo.lastMoveArrow="";var t,n=ip(e.coords);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}catch(i){n.e(i)}finally{n.f()}}}},{key:"cancelMoveAttempt",value:function(){this.jumpInConstruction=hB.empty(),this.selected=hB.empty(),this.updateBoard()}},{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if((i=t.getState()).getPieceAt(e)!==t.getCurrentPlayer()){n.next=6;break}return n.abrupt("return",(t.selected=hB.of(e),t.jumpInConstruction=hB.empty(),t.updateViewInfo(),e6.SUCCESS));case 6:if(!t.jumpInConstruction.isPresent()){n.next=8;break}return n.abrupt("return",t.constructJump(e));case 8:if(!t.selected.isPresent()){n.next=10;break}return n.abrupt("return",t.selectNextCoord(e));case 10:if(!i.isDropPhase()){n.next=13;break}return a=qae.of(e),n.abrupt("return",(a6(a.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(a.get(),i)));case 13:return n.abrupt("return",t.cancelMove(kre.MUST_CHOOSE_PLAYER_PIECE()));case 14:case"end":return n.stop()}},n)}))()}},{key:"constructJump",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.jumpInConstruction.get(),i=t.getState(),!e.equals(r.getEndingCoord())){n.next=3;break}return n.abrupt("return",t.chooseMove(r,i));case 3:if(!(a=r.addJump(e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(a.getReason()));case 6:return o=t.rules.jumpLegality(a.get(),i),n.abrupt("return",o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(a.get()));case 8:case"end":return n.stop()}},n)}))()}},{key:"updateJump",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),n.abrupt("return",t.rules.jumpHasPossibleNextTargets(e,r)?(t.jumpInConstruction=hB.of(e),t.updateViewInfo(),e6.SUCCESS):t.chooseMove(e,r));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectNextCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.selected.get(),!(i=$ae.of(r,e)).isSuccess()){n.next=3;break}return n.abrupt("return",t.chooseMove(i.get(),t.getState()));case 3:return a=Wae.of([r,e]),n.abrupt("return",a.isFailure()?t.cancelMove(a.getReason()):t.updateJump(a.get()));case 5:case"end":return n.stop()}},n)}))()}}]),n}(hre);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-conspirateurs"]],features:[jC],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1",3,"id",4,"ngFor","ngForOf"],["class","base no-fill highlighted mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0",3,"id"],[1,"base","mid-stroke","player1",3,"id"],[1,"base","no-fill","highlighted","mid-stroke"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,roe,2,1,"g",1),lb(2,ioe,2,5,"g",1),lb(3,aoe,1,4,"circle",2),lb(4,ooe,1,4,"circle",3),lb(5,soe,1,4,"rect",4),yb(6,"polyline",5),gb()),2&e&&(Rw(1),db("ngForOf",t.viewInfo.boardInfo),Rw(1),db("ngForOf",t.ALL_SHELTERS),Rw(1),db("ngForOf",t.range(t.viewInfo.sidePieces[0])),Rw(1),db("ngForOf",t.range(t.viewInfo.sidePieces[1])),Rw(1),db("ngIf",t.viewInfo.dropPhase),Rw(1),ob("points",t.viewInfo.lastMoveArrow))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),coe=function(){function e(t,n){sp(this,e),this.owner=t,this.otherPieceType=n}return cp(e,[{key:"toString",value:function(){return"DiamPiece(".concat(this.owner,", ").concat(this.otherPieceType,")")}}],[{key:"of",value:function(t,n){return t===ote.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===ote.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}}]),e}();coe.encoder=rte.tuple([ote.numberEncoder,rte.booleanEncoder],function(e){return[e.owner,e.otherPieceType]},function(e){return coe.of(e[0],e[1])}),coe.EMPTY=new coe(ate.NONE,!1),coe.ZERO_FIRST=new coe(ote.ZERO,!1),coe.ZERO_SECOND=new coe(ote.ZERO,!0),coe.ONE_FIRST=new coe(ote.ONE,!1),coe.ONE_SECOND=new coe(ote.ONE,!0),coe.PLAYER_PIECES=[coe.ZERO_FIRST,coe.ZERO_SECOND,coe.ONE_FIRST,coe.ONE_SECOND];var loe=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;if(sp(this,n),(i=t.call(this)).target=e,i.piece=r,r===coe.EMPTY)throw new Error("Cannot drop an empty piece");return Qv(i)}return cp(n,[{key:"isDrop",value:function(){return!0}},{key:"getTarget",value:function(){return this.target}},{key:"equals",value:function(e){return!(this.target!==e.target||this.piece!==e.piece)}},{key:"toString",value:function(){return"DiamMoveDrop(".concat(this.target,", ").concat(this.piece,")")}}]),n}(Ore);loe.encoder=rte.tuple([rte.numberEncoder(7),coe.encoder],function(e){return[e.target,e.piece]},function(e){return new loe(e[0],e[1])});var hoe=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this)).start=e,i.moveDirection=r,i}return cp(n,[{key:"isDrop",value:function(){return!1}},{key:"getTarget",value:function(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}},{key:"equals",value:function(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}},{key:"toString",value:function(){return"DiamMoveShift(".concat(this.start,", ").concat(this.moveDirection,")")}}],[{key:"fromRepresentation",value:function(e,t){return new n(new lre(e.x,3-e.y),t)}}]),n}(Ore);hoe.encoder=rte.tuple([lre.numberEncoder(8,4),rte.booleanEncoder],function(e){return[e.start,"clockwise"===e.moveDirection]},function(e){return new hoe(e[0],e[1]?"clockwise":"counterclockwise")});var foe=rte.disjunction(loe.encoder,hoe.encoder,function(e){return e.isDrop()}),doe=function(){var e=cp(function e(){sp(this,e)});return e.NO_MORE_PIECES_OF_THIS_TYPE=function(){return $localize(En||(En=Vv(["You do not have any pieces of this type anymore."])))},e.SPACE_IS_FULL=function(){return $localize(Sn||(Sn=Vv(["You cannot play here: this space is already full."])))},e.TARGET_STACK_TOO_HIGH=function(){return $localize(Pn||(Pn=Vv(["You cannot add more pieces to the target stack, as it will contain more than 4 pieces."])))},e.MUST_SHIFT_TO_NEIGHBOR=function(){return $localize(On||(On=Vv(["To perform a shift, you must move the pieces to a neighboring space."])))},e.MUST_SELECT_PIECE_FIRST=function(){return $localize(Tn||(Tn=Vv(["You must first select either a piece from the side, or a stack of pieces to shift on the board."])))},e}(),voe=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,i)).remainingPieces=r,a}return cp(n,[{key:"getRemainingPiecesOf",value:function(e){return this.remainingPieces[n.pieceIndex(e)]}},{key:"getStackHeight",value:function(e){for(var t=0,r=0;r<n.HEIGHT&&this.getPieceAtXY(e,r)!==coe.EMPTY;r++)t++;return t}}],[{key:"getInitialState",value:function(){var e=coe.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}},{key:"fromRepresentation",value:function(e,t){for(var r=e.reverse(),i=[4,4,4,4],a=0;a<n.HEIGHT;a++)for(var o=0;o<n.WIDTH;o++){var s=r[a][o];r[a][o]!==coe.EMPTY&&i[n.pieceIndex(s)]--}return a6(i.every(function(e){return e>=0}),"Invalid DiamState representation uses too many pieces"),new n(r,i,t)}},{key:"pieceIndex",value:function(e){switch(e){case coe.ZERO_FIRST:return 0;case coe.ZERO_SECOND:return 1;case coe.ONE_FIRST:return 2;default:return oB.expectToBe(e,coe.ONE_SECOND),3}}}]),n}(Sre);return e.WIDTH=8,e.HEIGHT=4,e}(),poe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.call(this,voe)}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=lte.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;var r=lte.copyImmutableArray(t.remainingPieces);return r[voe.pieceIndex(e.piece)]-=1,new voe(n,r,t.turn+1)}},{key:"applyLegalShift",value:function(e,t){for(var n=lte.copyBiArray(t.board),r=e.getTarget(),i=t.getStackHeight(r),a=e.start.y;a<voe.HEIGHT&&t.getPieceAtXY(e.start.x,a)!==coe.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,a),n[a][e.start.x]=coe.EMPTY,i++,a++;return new voe(n,t.remainingPieces,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}},{key:"isDropLegal",value:function(e,t){return e.piece.owner!==t.getCurrentPlayer()?J5.failure(kre.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?J5.failure(doe.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}},{key:"dropHeightValidity",value:function(e,t){return t.getStackHeight(e.target)===voe.HEIGHT?J5.failure(doe.SPACE_IS_FULL()):J5.success(void 0)}},{key:"isShiftLegal",value:function(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?J5.failure(kre.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}},{key:"shiftHeightValidity",value:function(e,t){var n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>voe.HEIGHT?J5.failure(doe.TARGET_STACK_TOO_HIGH()):J5.success(void 0)}},{key:"getGameStatus",value:function(e){var t=this.findHighestAlignment(e.gameState);if(t.isPresent()){var n=e.gameState.getPieceAt(t.get());return a6(n.owner.isPlayer(),"highest alignment is owned by a player"),Dre.getVictory(n.owner)}return Dre.ONGOING}},{key:"findHighestAlignment",value:function(e){for(var t=0;t<voe.WIDTH/2;t++)for(var n=voe.HEIGHT-1;n>0;n--){var r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+voe.WIDTH/2,n);if(r!==coe.EMPTY&&r===i)return hB.of(new lre(t,n))}return hB.empty()}},{key:"pieceCanMove",value:function(e,t){return!!this.isShiftLegal(new hoe(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new hoe(t,"counterclockwise"),e).isSuccess()}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=hB.of(new n)),n.singleton.get()}}]),n}(Lre);poe.singleton=hB.empty();var goe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}},{key:"getListShifts",value:function(e){var t,n=[],r=ip(this.getShiftSources(e));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0,o=[new hoe(i,"clockwise"),new hoe(i,"counterclockwise")];a<o.length;a++){var s=o[a];poe.get().shiftHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"getListDrops",value:function(e){for(var t=this.getRemainingPiecesForCurrentPlayer(e),n=[],r=0;r<voe.WIDTH;r++){var i,a=ip(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=new loe(r,o);poe.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){a.e(u)}finally{a.f()}}return n}},{key:"getRemainingPiecesForCurrentPlayer",value:function(e){var t,n=[],r=ip(coe.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.currentPlayerCanDropPiece(e,i)&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"currentPlayerCanDropPiece",value:function(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}},{key:"getShiftSources",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<voe.HEIGHT;r++)for(var i=0;i<voe.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new lre(i,r));return t}},{key:"getBoardValue",value:function(e){var t=poe.get().getGameStatus(e);return new wre(t.isEndGame?t.toBoardValue():0)}}]),n}(_re),yoe=coe.EMPTY,moe=coe.ZERO_FIRST,koe=coe.ZERO_SECOND,_oe=coe.ONE_FIRST,woe=coe.ONE_SECOND,Coe=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(In||(In=Vv(["Initial board and player pieces"]))),$localize(xn||(xn=Vv(["Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right."]))),voe.getInitialState()),Vre.fromMove($localize(An||(An=Vv(["Goal of the game"]))),$localize(Rn||(Rn=Vv(["At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!"]))),voe.fromRepresentation([[yoe,yoe,yoe,yoe,yoe,yoe,yoe,yoe],[yoe,yoe,yoe,yoe,yoe,yoe,yoe,yoe],[yoe,yoe,yoe,yoe,_oe,yoe,yoe,yoe],[moe,yoe,yoe,yoe,moe,yoe,yoe,yoe]],3),[new loe(0,coe.ONE_FIRST)],$localize(Nn||(Nn=Vv(["Congratulations, you won!"]))),$localize(Mn||(Mn=Vv(["Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board."])))),Vre.fromMove($localize(Dn||(Dn=Vv(["Types of move"]))),$localize(Ln||(Ln=Vv(["You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more  than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board."]))),voe.fromRepresentation([[yoe,yoe,yoe,yoe,yoe,yoe,yoe,yoe],[yoe,yoe,yoe,yoe,woe,yoe,yoe,yoe],[yoe,yoe,yoe,yoe,moe,yoe,yoe,yoe],[_oe,yoe,yoe,yoe,koe,yoe,yoe,yoe]],4),[hoe.fromRepresentation(new lre(4,3),"counterclockwise"),hoe.fromRepresentation(new lre(4,3),"clockwise"),hoe.fromRepresentation(new lre(4,2),"counterclockwise"),hoe.fromRepresentation(new lre(4,2),"clockwise")],$localize(Fn||(Fn=Vv(["Congratulations!"]))),$localize(Bn||(Bn=Vv(["Failed, try to move one of your piece that is already on the board."])))),Vre.fromMove($localize(Un||(Un=Vv(["Special case"]))),$localize(Vn||(Vn=Vv(["It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!"]))),voe.fromRepresentation([[yoe,yoe,yoe,yoe,moe,yoe,yoe,yoe],[yoe,yoe,yoe,yoe,woe,yoe,yoe,moe],[yoe,yoe,yoe,yoe,moe,yoe,yoe,woe],[yoe,_oe,yoe,yoe,koe,yoe,yoe,_oe]],8),[hoe.fromRepresentation(new lre(4,2),"counterclockwise")],$localize(zn||(zn=Vv(["Congratulations!"]))),$localize(Hn||(Hn=Vv(["Failed, try to shift a stack of pieces to the left."]))))]});function boe(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"path",6),bb("click",function(){var e=Jy(n).$implicit;return Pb().onSpaceClick(e)}),gb(),pb(2,"path",7),bb("click",function(){var e=Jy(n).$implicit;return Pb().onSpaceClick(e)}),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb();Rw(1),Tb("id","click_",r,""),db("ngClass",i.viewInfo.boardInfo[r].spaceClasses),ob("d",i.BOARD_PATHS[r]),Rw(1),db("ngClass",i.viewInfo.boardInfo[r].spaceClasses),ob("d",i.DECORATION_PATHS[r])}}function Eoe(e,t){if(1&e){var n=_b();Pm(),pb(0,"g",9),bb("click",function(){var e=Jy(n).$implicit,t=Pb().$implicit;return Pb().onPieceInGameClick(t,e.y)}),yb(1,"use",10),yb(2,"use",11),gb()}if(2&e){var r=t.$implicit;Ib("id","click_",Pb().$implicit,"_",r.y,""),db("ngClass",r.foregroundClasses),Rw(1),db("ngClass",r.backgroundClasses),ob("x",r.drawPosition.x)("y",r.drawPosition.y),Rw(1),ob("x",r.drawPosition.x)("y",r.drawPosition.y)}}function Soe(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Eoe,3,8,"g",8),gb()),2&e){var n=t.$implicit,r=Pb();Rw(1),db("ngForOf",r.viewInfo.boardInfo[n].pieces)}}function Poe(e,t){if(1&e){var n=_b();Pm(),pb(0,"g",12),bb("click",function(){var e=Jy(n).$implicit;return Pb().onRemainingPieceClick(e.actualPiece)}),yb(1,"use",10),yb(2,"use",11),gb()}if(2&e){var r=t.$implicit;Ib("id","piece_",r.actualPiece.owner.value,"_",r.actualPiece.otherPieceType?1:0,""),db("ngClass",r.foregroundClasses),Rw(1),db("ngClass",r.backgroundClasses),ob("x",r.drawPosition.x)("y",r.drawPosition.y),Rw(1),ob("x",r.drawPosition.x)("y",r.drawPosition.y)}}var Ooe=function(){return[0,1,2,3,4,5,6,7]},Toe=function(){return[2,1,3,0,4,7,5,6]},Ioe=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],r.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],r.selected=hB.empty(),r.viewInfo={boardInfo:[],remainingPieces:[]},r.rules=poe.get(),r.availableMinimaxes=[new goe(r.rules,"DiamDummyMinimax")],r.encoder=foe,r.tutorial=(new Coe).tutorial,r}return cp(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"onSpaceClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#click_"+e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClickAfterCheck",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selected.isPresent()){n.next=14;break}if("pieceFromReserve"!==(r=t.selected.get()).type){n.next=6;break}i=new loe(e,r.piece),n.next=13;break;case 6:if((r.position.x+1)%voe.WIDTH!==e){n.next=10;break}i=new hoe(r.position,"clockwise"),n.next=13;break;case 10:if((r.position.x+(voe.WIDTH-1))%voe.WIDTH===e){n.next=12;break}return n.abrupt("return",t.cancelMove(doe.MUST_SHIFT_TO_NEIGHBOR()));case 12:i=new hoe(r.position,"counterclockwise");case 13:return n.abrupt("return",t.chooseMove(i,t.getState()));case 14:return n.abrupt("return",t.cancelMove(doe.MUST_SELECT_PIECE_FIRST()));case 15:case"end":return n.stop()}},n)}))()}},{key:"onPieceInGameClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.getState().getPieceAtXY(e,t).owner===n.getCurrentPlayer()?(n.selected=hB.of({type:"pieceFromBoard",position:new lre(e,t)}),n.updateViewInfo(),e6.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(kre.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return r.stop()}},r)}))()}},{key:"onRemainingPieceClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay(t.getPieceId(e)),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):e.owner===t.getCurrentPlayer()?(t.selected=hB.of({type:"pieceFromReserve",piece:e}),t.updateViewInfo(),e6.SUCCESS):t.cancelMove(kre.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return n.stop()}},n)}))()}},{key:"getPieceId",value:function(e){return"#piece_"+e.owner.value+"_"+(e.otherPieceType?1:0)}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"getLastMovedFromDrop",value:function(e,t){var n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),a=this.getDrawPositionOnBoard(r,i),o=new lre(r,i);return[{start:hB.empty(),end:o,startDrawPosition:n,endDrawPosition:a}]}},{key:"getLastMovedFromShift",value:function(e,t){for(var n=e.start.x,r=e.getTarget(),i=t.getStackHeight(r),a=[],o=e.start.y;o<voe.HEIGHT&&t.getPieceAtXY(n,o)!==coe.EMPTY;o++,i++)a.push({start:hB.of(new lre(n,o)),end:new lre(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return a}},{key:"updateViewInfo",value:function(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}},{key:"updateBoardInfo",value:function(){for(var e=0;e<voe.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}},{key:"showLastMove",value:function(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}},{key:"showLastMoveOnSpaces",value:function(){var e=this.rules.node.move;a6(e.isPresent(),"showLastMoveOnSpaces called without a last move");for(var t=e.get(),n=0;n<voe.WIDTH;n++){var r=[];t.isDrop()?t.getTarget()===n&&r.push("moved"):(t.getTarget()===n||t.start.x===n)&&r.push("moved"),this.viewInfo.boardInfo[n].spaceClasses=r}}},{key:"showLastMoveOnPieces",value:function(){var e=this.rules.node.move;a6(e.isPresent(),"showLastMoveOnPieces called without a last move");var t,n=e.get(),r=this.getPreviousState(),i=ip(n.isDrop()?this.getLastMovedFromDrop(n,r):this.getLastMovedFromShift(n,r));try{for(i.s();!(t=i.n()).done;){var a=t.value;this.viewInfo.boardInfo[a.end.x].pieces[a.end.y].foregroundClasses.push("last-move")}}catch(o){i.e(o)}finally{i.f()}}},{key:"updateRemainingPiecesInfo",value:function(){var e=this.getCurrentPlayer();this.viewInfo.remainingPieces=[];var t,n=this.isPlayerTurn(),r=ip(coe.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.getState().getRemainingPiecesOf(i),o=0;o<a;o++){var s=[];this.isTopPieceOfReserveAndSelected(o,a,i)&&s.push("selected"),n&&o===a-1&&i.owner===e&&s.push("clickable-hover"),this.viewInfo.remainingPieces.push({backgroundClasses:["player"+i.owner.value+(i.otherPieceType?"-alternate":"")],foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(i,o),actualPiece:i})}}catch(u){r.e(u)}finally{r.f()}}},{key:"isTopPieceOfReserveAndSelected",value:function(e,t,n){if(this.selected.isPresent()){var r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}},{key:"getDrawPositionRemainingPiece",value:function(e,t){var r,i;return r=e.owner===ote.ZERO?-100:600,i=e.otherPieceType?100:450,new lre(r,i).getNext(new are(0,-t*n.PIECE_HEIGHT))}},{key:"getPieces",value:function(e){for(var t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[],i=0;i<voe.HEIGHT;i++){var a=this.getState().getPieceAtXY(e,i),o=new lre(e,i);if(a!==coe.EMPTY){var s=[];this.pieceFromBoardIsSelected(e,i)&&s.push("selected"),this.isVictory(e,i,t)&&s.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&s.push("clickable-hover"),r.push({backgroundClasses:["player"+a.owner.value+(a.otherPieceType?"-alternate":"")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:a})}}return r}},{key:"pieceFromBoardIsSelected",value:function(e,t){if(this.selected.isPresent()){var n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}},{key:"isVictory",value:function(e,t,n){if(n.isPresent()){var r=n.get();return r.x%4==e%4&&r.y===t}return!1}},{key:"getDrawPositionOnBoard",value:function(e,t){return n.CENTER[e].getNext(new are(0,-t*n.PIECE_HEIGHT))}},{key:"cancelMoveAttempt",value:function(){this.selected=hB.empty(),this.updateBoard()}}]),n}(hre);Ioe.CENTER=[new lre(40,160),new lre(100,50),new lre(255,2),new lre(400,50),new lre(460,160),new lre(400,270),new lre(255,320),new lre(100,270)],Ioe.PIECE_HEIGHT=36,Ioe.\u0275fac=function(e){return new(e||Ioe)(fb(r6))},Ioe.\u0275cmp=oy({type:Ioe,selectors:[["app-diam"]],features:[jC],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),pb(1,"defs"),pb(2,"g",1),yb(3,"path",2),yb(4,"ellipse",3),gb(),gb(),lb(5,boe,3,5,"g",4),lb(6,Soe,2,1,"g",4),lb(7,Poe,3,8,"g",5),gb()),2&e&&(Rw(5),db("ngForOf",oP(3,Ooe)),Rw(1),db("ngForOf",oP(4,Toe)),Rw(1),db("ngForOf",t.viewInfo.remainingPieces))},directives:[FT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var xoe=function(){function e(t,n){sp(this,e),this.offset=t,this.constant=n}return cp(e,[{key:"toString",value:function(){return"Line(".concat(this.constant,", ").concat(this.offset,")")}},{key:"equals",value:function(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}},{key:"contains",value:function(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}},{key:"getDirection",value:function(){switch(this.constant){case"q":return vre.DOWN;case"r":return vre.RIGHT;case"s":return vre.DOWN_LEFT}}}],[{key:"fromTwoCoords",value:function(t,n){var r=t.x,i=n.x,a=t.y,o=n.y,s=r+a,u=i+o;return r===i&&a!==o&&s!==u?hB.of(e.constantQ(r)):r!==i&&a===o&&s!==u?hB.of(e.constantR(a)):r!==i&&a!==o&&s===u?hB.of(e.constantS(s)):hB.empty()}},{key:"constantQ",value:function(t){return new e(t,"q")}},{key:"constantR",value:function(t){return new e(t,"r")}},{key:"constantS",value:function(t){return new e(t,"s")}},{key:"areOnSameLine",value:function(t){if(t.length<2)return!0;var n=e.fromTwoCoords(t[0],t[1]);if(n.isAbsent())return!1;var r,i=n.get(),a=ip(t.slice(2));try{for(a.s();!(r=a.n()).done;){var o=r.value;if(!1===i.contains(o))return!1}}catch(s){a.e(s)}finally{a.f()}return!0}}]),e}(),Aoe=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s){var u;return sp(this,n),(u=t.call(this,r,e)).board=r,u.width=i,u.height=a,u.excludedCases=o,u.empty=s,a6(u.excludedCases.length<u.height/2+1,"Invalid excluded cases specification for HexagonalGameState."),u}return cp(n,[{key:"setAt",value:function(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}},{key:"equalsT",value:function(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedCases.length!==e.excludedCases.length)return!1;for(var n=0;n<this.excludedCases.length;n++)if(this.excludedCases[n]!==e.excludedCases[n])return!1;var r,i=ip(this.allCoords());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!1===t(this.getPieceAt(a),e.getPieceAt(a)))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"allCoords",value:function(){var e=[];return this.forEachCoord(function(t){e.push(t)}),e}},{key:"allLines",value:function(){for(var e=[],t=0;t<this.width;t++)e.push(xoe.constantQ(t));for(var n=0;n<this.height;n++)e.push(xoe.constantR(n));for(var r=this.excludedCases.length;r<this.height+this.excludedCases.length;r++)e.push(xoe.constantS(r));return e}},{key:"getEntranceOnLine",value:function(e){var t,n;switch(e.constant){case"q":return n=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new lre(e.offset,n));case"r":return t=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new lre(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new lre(e.offset,0):new lre(this.width-1,e.offset-this.width+1))}}},{key:"findEntranceFrom",value:function(e,t){for(var n=e.getDirection(),r=t,i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}var a=i6.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(a.getReason())}}],[{key:"neighbors",value:function(e,t){return[new lre(e.x+t,e.y-t),new lre(e.x+t,e.y),new lre(e.x-t,e.y+t),new lre(e.x-t,e.y),new lre(e.x,e.y+t),new lre(e.x,e.y-t)]}}]),n}(Sre),Roe=function(){function e(t,n,r){sp(this,e),this.owner=t,this.size=n,this.source=r}return cp(e,[{key:"getValue",value:function(){return e.encoder.encodeNumber(this)}},{key:"getOwner",value:function(){return this.owner}},{key:"belongsTo",value:function(e){return this.owner===e}},{key:"containsSource",value:function(){return this.source}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"getSize",value:function(){return this.size}},{key:"toString",value:function(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}],[{key:"append",value:function(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}}]),e}();Roe.sizeEncoder=rte.numberEncoder(49),Roe.encoder=rte.tuple([rte.booleanEncoder,ote.numberEncoder,Roe.sizeEncoder],function(e){return[e.source,e.owner,e.size]},function(e){return new Roe(e[1],e[2],e[0])}),Roe.MAX_SIZE=49,Roe.EMPTY=new Roe(ate.NONE,0,!1),Roe.NONE=new Roe(ate.NONE,-1,!1),Roe.PLAYER_ZERO=new Roe(ote.ZERO,1,!1),Roe.PLAYER_ONE=new Roe(ote.ONE,1,!1),Roe.SOURCE=new Roe(ate.NONE,1,!0);var Noe=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_CASES,Roe.EMPTY)).alreadyPassed=i,a}return cp(n,[{key:"getAllPieces",value:function(){for(var e=[],t=0;t<n.HEIGHT;t++)for(var r=0;r<n.WIDTH;r++){var i=new lre(r,t);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}},{key:"numberOfNeighbors",value:function(e){var t=this;return Aoe.neighbors(e,1).filter(function(e){return t.isOnBoard(e)&&!1===t.getPieceAt(e).isEmpty()}).length}},{key:"setAtUnsafe",value:function(e,t){var r=lte.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.alreadyPassed)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Roe.NONE}}],[{key:"balancedBoard",value:function(){var e=Roe.NONE,t=Roe.PLAYER_ZERO,n=Roe.PLAYER_ONE,r=Roe.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==Roe.NONE}},{key:"getInitialState",value:function(){return new n(n.balancedBoard(),0,!1)}}]),n}(Aoe);return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_CASES=[2,1],e}(),Moe=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,r)}return cp(n,[{key:"toString",value:function(){return this===n.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}},{key:"length",value:function(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}],[{key:"of",value:function(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return n.PASS;if(!Noe.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!Noe.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new n(e,t);if(e.x===t.x)return new n(e,t);if(e.x+e.y===t.x+t.y)return new n(e,t);throw new Error("Invalid move")}}]),n}(Aie);Moe.PASS=new Moe(new lre(-1,-1),new lre(-2,-2)),Moe.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 42148}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return Moe.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new Moe(new lre((e=e/16|0)%16,r),new lre(n,t))}}]),n}(rte));var Doe=function(){var e=cp(function e(){sp(this,e)});return e.NOT_PLAYER_PIECE=function(){return $localize(Gn||(Gn=Vv(["You must select a piece or a stack of your color."])))},e.EMPTY_STACK=function(){return $localize(qn||(qn=Vv(["You must select a stack."])))},e.TOO_MANY_NEIGHBORS=function(){return $localize($n||($n=Vv(["This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors."])))},e.CANT_REACH_TARGET=function(){return $localize(Wn||(Wn=Vv(["This stack cannot move because it could never land on another piece."])))},e.INVALID_MOVE_LENGTH=function(){return $localize(jn||(jn=Vv(["A stack must always be moved by as many spaces as there are pieces in the stack."])))},e.EMPTY_TARGET_STACK=function(){return $localize(Zn||(Zn=Vv(["The stack must land on an occupied space."])))},e}(),Loe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"isMovablePiece",value:function(e,t){a6(e.isOnBoard(t),"piece is not on the board");var r=e.getPieceAt(t);return r.getSize()<1?e6.failure(Doe.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?e6.failure(Doe.TOO_MANY_NEIGHBORS()):n.pieceHasTarget(e,t)?e6.SUCCESS:e6.failure(Doe.CANT_REACH_TARGET()):e6.failure(Doe.NOT_PLAYER_PIECE())}},{key:"canOnlyPass",value:function(e){return 0===n.getMovablePieces(e).length}},{key:"sourceCoords",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).containsSource()})}},{key:"markPiecesConnectedTo",value:function(e,t,n){var r=this;Aoe.neighbors(t,1).forEach(function(t){e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,r.markPiecesConnectedTo(e,t,n))})}},{key:"removeDisconnectedPieces",value:function(e){var t=this,n=lte.createTable(Noe.WIDTH,Noe.HEIGHT,!1);this.sourceCoords(e).forEach(function(r){n[r.y][r.x]=!0,t.markPiecesConnectedTo(e,r,n)});var r=e;return r.getAllPieces().forEach(function(e){n[e.y][e.x]||(r=r.setAt(e,Roe.EMPTY))}),r}},{key:"applyLegalMove",value:function(e,t,n){if(e===Moe.PASS)return new Noe(t.board,t.turn+1,!0);var r=t.getPieceAt(e.coord),i=t.getPieceAt(e.end),a=t.setAt(e.coord,Roe.EMPTY).setAt(e.end,Roe.append(r,i));return this.removeDisconnectedPieces(new Noe(a.board,t.turn+1,!1))}},{key:"isLegal",value:function(e,t){if(0===n.getMovablePieces(t).length)return e!==Moe.PASS||t.alreadyPassed?J5.failure(kre.MUST_PASS()):J5.success(void 0);if(e===Moe.PASS)return J5.failure(kre.CANNOT_PASS());var r=this.isMovablePiece(t,e.coord);if(r.isFailure())return r.toFailedFallible();var i=t.getPieceAt(e.coord);return e.length()!==i.getSize()?J5.failure(Doe.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?J5.failure(Doe.EMPTY_TARGET_STACK()):J5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getScores(t);return 0===n.getMovablePieces(t).length?r[0]>r[1]?Dre.ZERO_WON:r[0]<r[1]?Dre.ONE_WON:Dre.DRAW:Dre.ONGOING}},{key:"getMovablePieces",value:function(e){return n.getFreePieces(e).filter(function(t){return n.pieceHasTarget(e,t)})}},{key:"getFreePieces",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6})}},{key:"pieceHasTarget",value:function(e,t){var n=e.getPieceAt(t).getSize();return void 0!==Aoe.neighbors(t,n).find(function(t){return e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty()})}},{key:"pieceTargets",value:function(e,t){var n=e.getPieceAt(t).getSize();return Aoe.neighbors(t,n).filter(function(t){return e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty()})}},{key:"getScores",value:function(e){var t=0,n=0;return e.getAllPieces().map(function(r){var i=e.getPieceAt(r);i.belongsTo(ote.ZERO)?t+=i.getSize():i.belongsTo(ote.ONE)&&(n+=i.getSize())}),[t,n]}}]),n}(Lre),Foe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t=e.move,n=e.gameState,r=[];return Loe.getMovablePieces(n).forEach(function(e){return Loe.pieceTargets(n,e).forEach(function(t){var n=Moe.of(e,t);r.push(n)})}),0===r.length&&!1===t.equalsValue(Moe.PASS)&&r.push(Moe.PASS),r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Loe.getScores(t);return 0===Loe.getMovablePieces(t).length?new wre(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new wre(n[0]-n[1])}}]),n}(_re),Boe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t=e.gameState,r=jv(tp(n.prototype),"getListMoves",this).call(this,e),i=t.getCurrentPlayer().getOpponent();return lte.sortByDescending(r,function(e){a6(e!==Moe.PASS,"Cannot sort with DvonnMove.PASS");var n=t.getPieceAt(e.end);return n.belongsTo(i)?n.getSize():0}),r}},{key:"getBoardValue",value:function(e){var t=Loe.getGameStatus(e);if(t.isEndGame)return new wre(t.toBoardValue());var n=e.gameState,r=Loe.getScores(n),i=n.getAllPieces(),a=i.length,o=i.filter(function(e){return n.getPieceAt(e).belongsTo(ote.ZERO)}).length,s=i.filter(function(e){return n.getPieceAt(e).belongsTo(ote.ONE)}).length;return new wre((s*r[1]-o*r[0])/a)}}]),n}(Foe),Uoe=Roe.EMPTY,Voe=Roe.NONE,zoe=Roe.SOURCE,Hoe=Roe.PLAYER_ZERO,Goe=Roe.PLAYER_ONE,qoe=new Roe(ote.ZERO,2,!1),$oe=new Roe(ote.ONE,2,!1),Woe=new Roe(ote.ZERO,4,!1),joe=new Roe(ote.ONE,4,!1),Zoe=cp(function e(){sp(this,e),this.tutorial=[Vre.anyMove($localize(Yn||(Yn=Vv(["Moving"]))),$localize(Kn||(Kn=Vv(["At Dvonn, each hexagonal space contains a stack of pieces.\n        If no number is indicated on a stack, it means that it only contains one piece.\n        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.\n        The owner of a stack is the one that has a piece at the top of the stack.\n        Only the owner of a stack can move it.\n        A stack cannot be moved if it is surrounded by 6 other stacks.\n        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.\n        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.\n        Therefore, there are six possible directions.\n        The player with dark pieces starts.<br/><br/>\n        You're playing Dark, click on a stack and move it by one space."]))),Noe.getInitialState(),Moe.of(new lre(2,0),new lre(3,0)),$localize(Jn||(Jn=Vv(["Congratulations!"])))),Vre.fromPredicate($localize(Qn||(Qn=Vv(["Disconnection"]))),$localize(Xn||(Xn=Vv(['Pieces with a lightning strike are called "sources".\n        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>\n        You\'re playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!']))),new Noe([[Voe,Voe,Goe,zoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe],[Voe,Uoe,Hoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe],[Uoe,Uoe,joe,Uoe,Uoe,Uoe,Uoe,Goe,zoe,Uoe,Uoe],[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Voe],[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Voe,Voe]],0,!1),Moe.of(new lre(2,1),new lre(2,0)),function(e,t){return e.end.equals(new lre(3,0))?e6.failure($localize(er||(er=Vv(["You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it."])))):(a6(e.end.equals(new lre(2,0)),"player made an impossible move"),e6.SUCCESS)},$localize(tr||(tr=Vv(["Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!\n        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.\n        Disconnected stacks will not be visible at the next turn."])))),Vre.fromPredicate($localize(nr||(nr=Vv(["Moving on a source"]))),$localize(rr||(rr=Vv(["You are allowed to move your stacks on any other stack.\n        This means that you can take control of a source by moving one of your stack on top of it.\n        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>\n        You're playing Dark and you can take control of a source, do it!"]))),new Noe([[Voe,Voe,zoe,Goe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe],[Voe,Hoe,Hoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe],[Uoe,Goe,Hoe,Goe,Uoe,Uoe,Hoe,$oe,zoe,Uoe,Uoe],[Uoe,Uoe,Goe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Voe],[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Voe,Voe]],0,!1),Moe.of(new lre(2,1),new lre(2,0)),function(e,t){return e.end.equals(new lre(2,0))?e6.SUCCESS:e6.failure($localize(ir||(ir=Vv(["You have not taken possession of a source, try again."]))))},$localize(ar||(ar=Vv(["Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!"])))),Vre.informational($localize(or||(or=Vv(["Passing"]))),$localize(sr||(sr=Vv(["It can happen that you have no possible move to make.\n        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>\n        This is a situation that occurs here for Dark."]))),new Noe([[Voe,Voe,zoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe],[Voe,Uoe,qoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe],[Uoe,Uoe,$oe,Uoe,Uoe,Uoe,Uoe,$oe,zoe,Woe,Uoe],[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Voe],[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Voe,Voe]],0,!1)),Vre.fromMove($localize(ur||(ur=Vv(["End of the game"]))),$localize(cr||(cr=Vv(["When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>\n        Make your last move."]))),new Noe([[Voe,Voe,zoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe],[Voe,Uoe,Hoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe],[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,zoe,Woe,Uoe],[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Voe],[Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Uoe,Voe,Voe]],0,!1),[Moe.of(new lre(2,1),new lre(2,0))],$localize(lr||(lr=Vv(["Congratulations, you won 6 - 0!"]))),$localize(hr||(hr=Vv(["Bad idea, by moving on the source you would have won a point."]))))]});function Yoe(e,t){if(1&e&&(Pm(),yb(0,"circle",10)),2&e){var n=Pb().$implicit,r=Pb().$implicit,i=Pb();db("ngClass",i.getPieceClasses(n)),ob("cx",i.getCenterAt(r).x)("cy",i.getCenterAt(r).y)("r",i.SPACE_SIZE)}}function Koe(e,t){if(1&e&&(Pm(),yb(0,"polygon",11)),2&e){var n=Pb().$implicit,r=Pb().$implicit,i=Pb();ob("transform",1===n.getSize()?"translate("+(i.getCenterAt(r).x-18)+" "+(i.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(r).x-3)+" "+(i.getCenterAt(r).y-12)+") scale(0.07)")}}function Joe(e,t){if(1&e){var n=_b();Pm(),pb(0,"text",12),bb("click",function(){Jy(n);var e=Pb(2).$implicit;return Pb().onClick(e.x,e.y)}),Bb(1),gb()}if(2&e){var r=Pb().$implicit,i=Pb().$implicit,a=Pb();ob("x",r.containsSource()?a.getCenterAt(i).x-7:a.getCenterAt(i).x)("y",a.getCenterAt(i).y),Rw(1),Ub(r.getSize())}}function Qoe(e,t){if(1&e){var n=_b();Pm(),pb(0,"g",5),bb("click",function(){Jy(n);var e=Pb().$implicit;return Pb().onClick(e.x,e.y)}),yb(1,"polyline",6),lb(2,Yoe,1,4,"circle",7),lb(3,Koe,1,1,"polygon",8),lb(4,Joe,2,3,"text",9),gb()}if(2&e){var r=t.$implicit,i=Pb().$implicit,a=Pb();Ib("id","click_",i.x,"_",i.y,""),Rw(1),ob("points",a.getHexaCoordsAt(i)),Rw(1),db("ngIf",r.getSize()>0),Rw(1),db("ngIf",r.containsSource()),Rw(1),db("ngIf",r.getSize()>1)}}var Xoe=function(e){return[e]};function ese(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Qoe,5,6,"g",4),gb()),2&e){var n=t.$implicit,r=Pb();Rw(1),db("ngForOf",sP(1,Xoe,r.state.getPieceAt(n)))}}function tse(e,t){if(1&e&&(Pm(),pb(0,"text",16),Bb(1),gb()),2&e){var n=Pb().$implicit,r=Pb();ob("x",r.getCenterAt(n.coord).x)("y",r.getCenterAt(n.coord).y),Rw(1),Ub(n.caseContent.getSize())}}function nse(e,t){if(1&e&&(Pm(),pb(0,"g"),yb(1,"polyline",13),yb(2,"circle",14),lb(3,tse,2,3,"text",15),gb()),2&e){var n=t.$implicit,r=Pb();Rw(1),ob("points",r.getHexaCoordsAt(n.coord)),Rw(1),Ib("id","captured_",n.coord.x,"_",n.coord.y,""),db("ngClass",r.getPieceClasses(n.caseContent)),ob("cx",r.getCenterAt(n.coord).x)("cy",r.getCenterAt(n.coord).y)("r",r.SPACE_SIZE),Rw(1),db("ngIf",n.caseContent.getSize()>1)}}function rse(e,t){if(1&e&&(Pm(),mb(0),yb(1,"polyline",17),yb(2,"polyline",17),kb()),2&e){var n=Pb();Rw(1),ob("points",n.getHexaCoordsAt(n.lastMove.get().coord)),Rw(1),ob("points",n.getHexaCoordsAt(n.lastMove.get().end))}}function ise(e,t){if(1&e&&(Pm(),yb(0,"polyline",18)),2&e){var n=Pb();ob("points",n.getHexaCoordsAt(n.chosen.get()))}}var ase=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).lastMove=hB.empty(),r.chosen=hB.empty(),r.disconnecteds=[],r.rules=new Loe(Noe),r.availableMinimaxes=[new Foe(r.rules,"DvonnMinimax"),new Boe(r.rules,"DvonnMinimaxMaximizeStacks")],r.encoder=Moe.encoder,r.tutorial=(new Zoe).tutorial,r.SPACE_SIZE=30,r.canPass=!1,r.scores=hB.of(Loe.getScores(r.rules.node.gameState)),r.hexaLayout=new pre(1.5*r.SPACE_SIZE,new lre(-r.SPACE_SIZE,2*r.SPACE_SIZE),yre.INSTANCE),r.state=r.rules.node.gameState,r.hexaBoard=r.rules.node.gameState.board,r}return cp(n,[{key:"hideLastMove",value:function(){this.lastMove=hB.empty()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=hB.of(Loe.getScores(this.state))}},{key:"calculateDisconnecteds",value:function(){for(var e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState,n=0;n<t.board.length;n++)for(var r=0;r<t.board[n].length;r++){var i=new lre(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){var a=t.getPieceAt(i),o=e.getPieceAt(i);if(a.isEmpty()&&!o.isEmpty()){var s={coord:new lre(r,n),caseContent:o};this.disconnecteds.push(s)}}}}},{key:"cancelMoveAttempt",value:function(){this.chosen=hB.empty()}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a6(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),t.next=3,e.chooseMove(Moe.PASS,e.rules.node.gameState);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=5;break}r.t0=n.cancelMove(i.getReason()),r.next=18;break;case 5:if(!n.chosen.isAbsent()){r.next=9;break}r.t1=n.choosePiece(e,t),r.next=17;break;case 9:if(!n.chosen.equalsValue(new lre(e,t))){r.next=13;break}r.t2=(n.cancelMoveAttempt(),e6.SUCCESS),r.next=16;break;case 13:return r.next=15,n.chooseDestination(e,t);case 15:r.t2=r.sent;case 16:r.t1=r.t2;case 17:r.t0=r.t1;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=new lre(e,t),r=this.rules.isMovablePiece(this.rules.node.gameState,n);return r.isSuccess()?(this.chosen=hB.of(n),e6.SUCCESS):this.cancelMove(r.getReason())}},{key:"chooseDestination",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new lre(e,t),o=Moe.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e){if(e.containsSource()&&1===e.getSize())return["other-piece","dashed-stroke"];var t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"other-piece-stroke","dashed-stroke"]:[t]}}]),n}(fre);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-dvonn"]],features:[jC],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","other-piece-light","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"other-piece-light"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured"],[1,"base","mid-stroke","transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","selected"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,ese,2,3,"g",1),lb(2,nse,4,8,"g",1),lb(3,rse,3,2,"ng-container",2),lb(4,ise,1,1,"polyline",3),gb()),2&e&&(Rw(1),db("ngForOf",t.state.allCoords()),Rw(1),db("ngForOf",t.disconnecteds),Rw(1),db("ngIf",t.lastMove.isPresent()),Rw(1),db("ngIf",t.chosen.isPresent()))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ose=(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}(ose||(ose={})),ose),sse=function(){function e(t){sp(this,e),this.value=t}return cp(e,[{key:"getPlayer",value:function(){switch(this){case e.SMALL_BLACK:case e.MEDIUM_BLACK:case e.BIG_BLACK:return ote.ZERO;case e.SMALL_WHITE:case e.MEDIUM_WHITE:case e.BIG_WHITE:return ote.ONE;default:return ate.NONE}}},{key:"getSize",value:function(){switch(this){case e.BIG_BLACK:case e.BIG_WHITE:return ose.BIG;case e.MEDIUM_BLACK:case e.MEDIUM_WHITE:return ose.MEDIUM;case e.SMALL_BLACK:case e.SMALL_WHITE:return ose.SMALL;default:return oB.expectToBe(this,e.NONE),ose.NONE}}},{key:"belongsTo",value:function(e){return this.getPlayer()===e}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){switch(this){case e.BIG_BLACK:return"BIG_BLACK";case e.BIG_WHITE:return"BIG_WHITE";case e.MEDIUM_BLACK:return"MEDIUM_BLACK";case e.MEDIUM_WHITE:return"MEDIUM_WHITE";case e.SMALL_BLACK:return"SMALL_BLACK";case e.SMALL_WHITE:return"SMALL_WHITE";default:return oB.expectToBe(this,e.NONE),"NONE"}}}],[{key:"of",value:function(e){switch(e){case 0:return this.SMALL_BLACK;case 1:return this.SMALL_WHITE;case 2:return this.MEDIUM_BLACK;case 3:return this.MEDIUM_WHITE;case 4:return this.BIG_BLACK;case 5:return this.BIG_WHITE;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}},{key:"ofSizeAndPlayer",value:function(t,n){return n===ote.ZERO&&t===ose.BIG?e.BIG_BLACK:n===ote.ZERO&&t===ose.MEDIUM?e.MEDIUM_BLACK:n===ote.ZERO&&t===ose.SMALL?e.SMALL_BLACK:n===ote.ONE&&t===ose.BIG?e.BIG_WHITE:n===ote.ONE&&t===ose.MEDIUM?e.MEDIUM_WHITE:n===ote.ONE&&t===ose.SMALL?e.SMALL_WHITE:e.NONE}}]),e}();sse.SMALL_BLACK=new sse(0),sse.SMALL_WHITE=new sse(1),sse.MEDIUM_BLACK=new sse(2),sse.MEDIUM_WHITE=new sse(3),sse.BIG_BLACK=new sse(4),sse.BIG_WHITE=new sse(5),sse.NONE=new sse(6);var use=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r)).remainingPieces=i,a}return cp(n,[{key:"getRemainingPieces",value:function(){return lte.copyImmutableArray(this.remainingPieces)}},{key:"getRemainingPiecesOfPlayer",value:function(e){return this.getRemainingPieces().filter(function(t){return t.getPlayer()===e})}},{key:"pieceBelongsToCurrentPlayer",value:function(e){return e.belongsTo(this.getCurrentPlayer())}},{key:"isDroppable",value:function(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}},{key:"isInRemainingPieces",value:function(e){return this.remainingPieces.some(function(t){return t===e})}},{key:"getPlayerRemainingPieces",value:function(){var e=this;return this.remainingPieces.filter(function(t){return e.pieceBelongsToCurrentPlayer(t)})}}],[{key:"getInitialState",value:function(){var e=new cse(ate.NONE,ate.NONE,ate.NONE).encode(),t=lte.createTable(3,3,e);return new n(lte.mapBiArray(t,function(e){return cse.decode(e)}),0,[sse.BIG_BLACK,sse.BIG_BLACK,sse.BIG_WHITE,sse.BIG_WHITE,sse.MEDIUM_BLACK,sse.MEDIUM_BLACK,sse.MEDIUM_WHITE,sse.MEDIUM_WHITE,sse.SMALL_BLACK,sse.SMALL_BLACK,sse.SMALL_WHITE,sse.SMALL_WHITE])}}]),n}(Sre),cse=function(){function e(t,n,r){sp(this,e),this.small=t,this.medium=n,this.big=r}return cp(e,[{key:"isEmpty",value:function(){return this.small===ate.NONE&&this.medium===ate.NONE&&this.big===ate.NONE}},{key:"toList",value:function(){var e=[];return this.small.isPlayer()&&e.push(sse.ofSizeAndPlayer(ose.SMALL,this.small)),this.medium.isPlayer()&&e.push(sse.ofSizeAndPlayer(ose.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(sse.ofSizeAndPlayer(ose.BIG,this.big)),e}},{key:"toOrderedPieceNames",value:function(){var e=sse.ofSizeAndPlayer(ose.SMALL,this.small),t=sse.ofSizeAndPlayer(ose.MEDIUM,this.medium),n=sse.ofSizeAndPlayer(ose.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}},{key:"getBiggest",value:function(){return this.big===ote.ZERO?sse.BIG_BLACK:this.big===ote.ONE?sse.BIG_WHITE:this.medium===ote.ZERO?sse.MEDIUM_BLACK:this.medium===ote.ONE?sse.MEDIUM_WHITE:this.small===ote.ZERO?sse.SMALL_BLACK:this.small===ote.ONE?sse.SMALL_WHITE:sse.NONE}},{key:"tryToSuperposePiece",value:function(e){var t=this.getBiggest().getSize();if(e===sse.NONE)throw new Error("Cannot move NONE on a space");return e.getSize()>t?hB.of(this.put(e)):hB.empty()}},{key:"removeBiggest",value:function(){var t,n=this.getBiggest();if(n===sse.NONE)throw new Error("Cannot removed piece from empty space");var r=n.getSize();switch(r){case ose.BIG:t=new e(this.small,this.medium,ate.NONE);break;case ose.MEDIUM:t=new e(this.small,ate.NONE,ate.NONE);break;default:oB.expectToBe(r,ose.SMALL),t=new e(ate.NONE,ate.NONE,ate.NONE)}return{removedCase:t,removedPiece:n}}},{key:"put",value:function(t){if(t===sse.NONE)throw new Error("Cannot put NONE on space");var n=t.getPlayer(),r=t.getSize();switch(r){case ose.BIG:return new e(this.small,this.medium,n);case ose.MEDIUM:return a6(this.big===ate.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return oB.expectToBe(r,ose.SMALL),a6(this.big===ate.NONE,"Cannot put a piece on top of a bigger one"),a6(this.medium===ate.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}},{key:"encode",value:function(){return this.small.value+3*this.medium.value+9*this.big.value}},{key:"belongsTo",value:function(e){return this.getBiggest().getPlayer()===e}},{key:"toString",value:function(){var e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}],[{key:"decode",value:function(t){a6(t%1==0,"EncapsuleCase must be encoded as integer: "+t),a6(t>=0,"To small representation for EncapsuleCase: "+t),a6(t<=26,"To big representation for EncapsuleCase: "+t);var n=ote.numberEncoder.decodeNumber(t%3);t-=n.value;var r=ote.numberEncoder.decodeNumber((t/=3)%3);return t-=r.value,new e(n,r,ote.numberEncoder.decodeNumber(t/=3))}}]),e}();cse.EMPTY=new cse(ate.NONE,ate.NONE,ate.NONE);var lse=function(){var e=cp(function e(){sp(this,e)});return e.PIECE_OUT_OF_STOCK=function(){return $localize(fr||(fr=Vv(["You do not have pieces of this type anymore."])))},e.INVALID_PLACEMENT=function(){return $localize(dr||(dr=Vv(["You must put your piece on an empty square or on a smaller piece."])))},e.NOT_DROPPABLE=function(){return $localize(vr||(vr=Vv(["You must pick your piece among the remaining ones."])))},e.INVALID_PIECE_SELECTED=function(){return $localize(pr||(pr=Vv(["You must pick one of your remaining pieces or one piece on the board that is the biggest of its square."])))},e.SAME_DEST_AS_ORIGIN=function(){return $localize(gr||(gr=Vv(["You must select a different landing square than the square where the move originates from."])))},e.END_YOUR_MOVE=function(){return $localize(yr||(yr=Vv(["You are performing a move, you must select a landing square."])))},e}(),hse=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){var r,i=t.getCopiedBoard(),a=t.getRemainingPieces(),o=t.turn+1;if(i[e.landingCoord.y][e.landingCoord.x]=cse.decode(n.encode()),e.isDropping()){r=e.piece.get();var s=a.indexOf(r);a=a.slice(0,s).concat(a.slice(s+1))}else{var u=e.startingCoord.get(),c=i[u.y][u.x].encode(),l=cse.decode(c).removeBiggest();i[u.y][u.x]=cse.decode(l.removedCase.encode()),r=l.removedPiece}return new use(i,o,a)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isVictory",value:function(e){var t,r=e.getCopiedBoard(),i=ip(n.LINES);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.isVictoriousLine([r[a[0].y][a[0].x],r[a[1].y][a[1].x],r[a[2].y][a[2].x]]);if(o.isPresent())return o}}catch(s){i.e(s)}finally{i.f()}return hB.empty()}},{key:"isVictoriousLine",value:function(e){var t=e.map(function(e){return e.getBiggest()}).map(function(e){return e.getPlayer()});return t[0]===ate.NONE?hB.empty():t[0]===t[1]&&t[1]===t[2]?hB.of(t[0]):hB.empty()}},{key:"isLegal",value:function(e,t){var n;if(sB(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return J5.failure(kre.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return J5.failure(lse.PIECE_OUT_OF_STOCK())}else{var r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return J5.failure(kre.MUST_CHOOSE_PLAYER_PIECE())}var i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return i.isPresent()?J5.success(i.get()):J5.failure(lse.INVALID_PLACEMENT())}},{key:"getGameStatus",value:function(e){var t=n.isVictory(e.gameState);return t.isPresent()?Dre.getVictory(t.get()):Dre.ONGOING}}]),n}(Lre);hse.LINES=[[new lre(0,0),new lre(0,1),new lre(0,2)],[new lre(1,0),new lre(1,1),new lre(1,2)],[new lre(2,0),new lre(2,1),new lre(2,2)],[new lre(0,0),new lre(1,0),new lre(2,0)],[new lre(0,1),new lre(1,1),new lre(2,1)],[new lre(0,2),new lre(1,2),new lre(2,2)],[new lre(0,0),new lre(1,1),new lre(2,2)],[new lre(0,2),new lre(1,1),new lre(2,0)]];var fse=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this)).startingCoord=e,a.landingCoord=r,a.piece=i,a}return cp(n,[{key:"isDropping",value:function(){return this.startingCoord.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}},{key:"toString",value:function(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}],[{key:"fromMove",value:function(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new n(hB.of(e),t,hB.empty())}},{key:"fromDrop",value:function(e,t){return new n(hB.empty(),t,hB.of(e))}}]),n}(Ore);fse.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 161}},{key:"encodeNumber",value:function(e){var t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){return 18*e.piece.get().value+6*t+2*n+0}var r=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*r+6*t+2*n+1}},{key:"decodeNumber",value:function(e){var t=e%2;e-=t;var n=(e/=2)%3;e-=n;var r=(e/=3)%3;e-=r,e/=3;var i=new lre(r,n);if(0===t){var a=sse.of(e);return fse.fromDrop(a,i)}var o=e%3;e-=o;var s=new lre((e/=3)%3,o);return fse.fromMove(s,i)}}]),n}(rte));var dse=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getBoardValue",value:function(e){var t=hse.getGameStatus(e);return new wre(t.toBoardValue())}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),a=Cre.toComparableObjectSet(n.getPlayerRemainingPieces()),o=0;o<3;o++)for(var s=0;s<3;s++){var u,c=new lre(s,o),l=ip(a);try{for(l.s();!(u=l.n()).done;){var h=u.value,f=fse.fromDrop(h,c);hse.isLegal(f,n).isSuccess()&&t.push(f)}}catch(y){l.e(y)}finally{l.f()}if(r[o][s].belongsTo(i))for(var d=0;d<3;d++)for(var v=0;v<3;v++){var p=new lre(v,d);if(!p.equals(c)){var g=fse.fromMove(c,p);hse.isLegal(g,n).isSuccess()&&t.push(g)}}}return t}}]),n}(_re),vse=new cse(ate.NONE,ate.NONE,ate.NONE),pse=new cse(ote.ZERO,ate.NONE,ate.NONE),gse=new cse(ate.NONE,ote.ZERO,ate.NONE),yse=new cse(ate.NONE,ate.NONE,ote.ZERO),mse=new cse(ote.ONE,ate.NONE,ate.NONE),kse=new cse(ate.NONE,ate.NONE,ote.ONE),_se=new cse(ote.ONE,ote.ZERO,ate.NONE),wse=new cse(ote.ZERO,ote.ZERO,ate.NONE),Cse=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(mr||(mr=Vv(["Goal of the game"]))),$localize(kr||(kr=Vv(["The goal of Encapsule is to align three of your pieces.\n        Here, we have a victory of the dark player."]))),new use([[pse,mse,kse],[vse,gse,vse],[vse,vse,yse]],0,[sse.SMALL_BLACK,sse.MEDIUM_BLACK,sse.BIG_BLACK,sse.SMALL_WHITE,sse.MEDIUM_WHITE,sse.MEDIUM_WHITE,sse.BIG_WHITE])),Vre.anyMove($localize(_r||(_r=Vv(["Putting a piece"]))),$localize(wr||(wr=Vv(["This is the initial board. You're playing Dark.<br/><br/>\n        Pick one of your piece on the side of the board and put it on the board."]))),use.getInitialState(),fse.fromDrop(sse.SMALL_BLACK,new lre(1,1)),$localize(Cr||(Cr=Vv(["Congratulations!"])))),Vre.fromMove($localize(br||(br=Vv(["Moving"]))),$localize(Er||(Er=Vv(["Another possible action is to move one of your pieces that is already on the board.<br/><br/>\n        Click on your dark piece and then on any empty square of the board."]))),new use([[pse,kse,vse],[vse,vse,vse],[vse,vse,vse]],0,[]),[fse.fromMove(new lre(0,0),new lre(2,0)),fse.fromMove(new lre(0,0),new lre(0,1)),fse.fromMove(new lre(0,0),new lre(1,1)),fse.fromMove(new lre(0,0),new lre(2,1)),fse.fromMove(new lre(0,0),new lre(0,2)),fse.fromMove(new lre(0,0),new lre(1,2)),fse.fromMove(new lre(0,0),new lre(2,2))],$localize(Sr||(Sr=Vv(["Congratulations!"]))),$localize(Pr||(Pr=Vv(["Failed. Try again."])))),Vre.fromPredicate($localize(Or||(Or=Vv(["Particularity"]))),$localize(Tr||(Tr=Vv(['At Encapsule, pieces encapsulate each other.\n        It is therefore possible to have up to three pieces per square!\n        However, only the biggest piece of each square counts:\n        you cannot win with a piece that is "hidden" by a bigger piece.\n        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.\n        Finally, you cannot encapsulate a piece with a smaller piece.\n        You\'re playing Dark and you can win now in various ways.<br/><br/>\n        Try to win by making a move, and not by putting a new piece on the board.']))),new use([[_se,vse,mse],[wse,kse,kse],[vse,vse,vse]],0,[sse.MEDIUM_BLACK,sse.BIG_BLACK,sse.MEDIUM_WHITE,sse.MEDIUM_WHITE]),fse.fromMove(new lre(0,1),new lre(0,2)),function(e,t){if(e.landingCoord.equals(new lre(0,2))){if(e.isDropping())return e6.failure($localize(Ir||(Ir=Vv(["You won, but the exercise is to win while moving a piece!"]))));if(e.startingCoord.equalsValue(new lre(0,1)))return e6.SUCCESS}return e6.failure($localize(xr||(xr=Vv(["Failed. Try again."]))))},$localize(Ar||(Ar=Vv(["Congratulations!"]))))]});function bse(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"circle",5),bb("click",function(){var e=Jy(n),t=e.$implicit,r=e.index;return Pb().onPieceClick(0,t,r)}),gb(),gb()}if(2&e){var r=t.$implicit,i=t.index,a=Pb();Rw(1),Tb("id","piece_0_",r.toString(),""),db("ngClass",a.getSidePieceClasses(r,i)),ob("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(0,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}function Ese(e,t){if(1&e){var n=_b();Pm(),pb(0,"circle",8),bb("click",function(){Jy(n);var e=Pb().index,t=Pb().index;return Pb().onBoardClick(e,t)}),gb()}if(2&e){var r=t.$implicit,i=Pb().index,a=Pb().index,o=Pb();db("ngClass",o.getPieceClasses(r)),ob("r",o.getPieceRadius(r))("cx",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Sse(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",6),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onBoardClick(e,t)}),gb(),lb(2,Ese,1,4,"circle",7),gb()}if(2&e){var r=t.$implicit,i=t.index,a=Pb().index,o=Pb();Rw(1),Ib("id","click_",i,"_",a,""),db("ngClass",o.getRectClasses(i,a)),ob("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Rw(1),db("ngForOf",o.getListPieces(r))}}function Pse(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Sse,3,8,"g",2),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function Ose(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",9),bb("click",function(){var e=Jy(n).$implicit;return Pb().onBoardClick(e.x,e.y)}),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb();Rw(1),ob("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Tse(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"circle",5),bb("click",function(){var e=Jy(n),t=e.$implicit,r=e.index;return Pb().onPieceClick(1,t,r)}),gb(),gb()}if(2&e){var r=t.$implicit,i=t.index,a=Pb();Rw(1),Tb("id","piece_1_",r.toString(),""),db("ngClass",a.getSidePieceClasses(r,i)),ob("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(1,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}var Ise=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).INTER_PIECE_SPACE=20,r.lastLandingCoord=hB.empty(),r.lastStartingCoord=hB.empty(),r.chosenCoord=hB.empty(),r.chosenPiece=hB.empty(),r.remainingPieceLeftX=[],r.rules=new hse(use),r.availableMinimaxes=[new dse(r.rules,"EncapsuleMinimax")],r.encoder=fse.encoder,r.tutorial=(new Cse).tutorial,r.updateBoard(),r}return cp(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard();var e=this.rules.node.move;this.calculateLeftX(),e.isPresent()?(this.lastLandingCoord=hB.of(e.get().landingCoord),this.lastStartingCoord=e.get().startingCoord):(this.lastLandingCoord=hB.empty(),this.lastStartingCoord=hB.empty())}},{key:"getListPieces",value:function(e){return e.toList()}},{key:"getRemainingPieces",value:function(e){return this.rules.node.gameState.getRemainingPiecesOfPlayer(ote.of(e))}},{key:"onBoardClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new lre(e,t),o=n.rules.node.gameState,!n.chosenCoord.isAbsent()){r.next=9;break}if(n.chosenCoord=hB.of(a),!n.chosenPiece.isPresent()){r.next=8;break}return s=fse.fromDrop(n.chosenPiece.get(),a),r.abrupt("return",n.chooseMove(s,n.rules.node.gameState));case 8:return r.abrupt("return",!1===o.getPieceAt(a).belongsTo(o.getCurrentPlayer())?n.cancelMove(lse.INVALID_PIECE_SELECTED()):e6.SUCCESS);case 9:if(!n.chosenCoord.equalsValue(a)){r.next=11;break}return r.abrupt("return",n.cancelMove(lse.SAME_DEST_AS_ORIGIN()));case 11:return u=fse.fromMove(n.chosenCoord.get(),a),r.abrupt("return",n.chooseMove(u,n.rules.node.gameState));case 13:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=hB.empty(),this.chosenPiece=hB.empty(),this.chosenPieceIndex=-1}},{key:"onPieceClick",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.canUserPlay("#piece_"+e+"_"+t.toString()),i.abrupt("return",a.isFailure()?r.cancelMove(a.getReason()):!1===r.rules.node.gameState.isDroppable(t)?r.cancelMove(lse.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece=hB.of(t),r.chosenPieceIndex=n,e6.SUCCESS):r.cancelMove(lse.END_YOUR_MOVE()));case 2:case"end":return i.stop()}},i)}))()}},{key:"getRectClasses",value:function(e,t){return this.isSelected(e,t)?"moved":""}},{key:"isSelected",value:function(e,t){var n=new lre(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}},{key:"getPieceClasses",value:function(e){return[this.getPieceStrokeClass(e)]}},{key:"getPieceStrokeClass",value:function(e){var t=e.getPlayer();return a6(t.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+t.value+"-stroke"}},{key:"getPieceRadius",value:function(e){switch(e.getSize()){case ose.BIG:return 40;case ose.MEDIUM:return 30;default:return oB.expectToBe(e.getSize(),ose.SMALL),20}}},{key:"getHighlightedCases",value:function(){var e=[];return this.chosenCoord.isPresent()&&e.push(this.chosenCoord.get()),e}},{key:"getSidePieceClasses",value:function(e,t){var n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex===t&&n.push("clickable "),n}},{key:"isSelectedPiece",value:function(e){return this.chosenPiece.equalsValue(e)}},{key:"calculateLeftX",value:function(){this.remainingPieceLeftX=[];for(var e=0;e<=1;e++){this.remainingPieceLeftX.push([]);for(var t=this.getRemainingPieces(e),n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{var r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}},{key:"getPieceLeftX",value:function(e,t){return this.remainingPieceLeftX[e][t]}}]),n}(wie);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-encapsule"]],features:[jC],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingCasePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["remainingCasePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","highlighted",3,"click"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),pb(1,"g",null,1),lb(3,bse,2,5,"g",2),gb(),pb(4,"g",null,3),lb(6,Pse,2,1,"g",2),lb(7,Ose,2,4,"g",2),gb(),pb(8,"g",null,4),lb(10,Tse,2,5,"g",2),gb(),gb()),2&e&&(Rw(1),ob("transform","translate("+t.STROKE_WIDTH+", 0)"),Rw(2),db("ngForOf",t.getRemainingPieces(0)),Rw(1),ob("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),Rw(2),db("ngForOf",t.board),Rw(1),db("ngForOf",t.getHighlightedCases()),Rw(1),ob("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),Rw(2),db("ngForOf",t.getRemainingPieces(1)))},directives:[FT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),xse=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o){var s;if(sp(this,n),(s=t.call(this,e,r)).movedPieces=i,s.stepSize=a,s.direction=o,s.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+s.coord.toString()+".");if(i<1)throw new Error("Must select minimum one piece (got "+i+").");if(a<1)throw new Error("Step size must be minimum one (got "+a+").");if(a>i)throw new Error("Cannot move a phalanx further than its size (got step size "+a+" for "+i+" pieces).");return Qv(s)}return cp(n,[{key:"toString",value:function(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}]),n}(Tre);xse.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 122303}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%8;e-=t;var n=(e/=8)%7;e-=n;var r=(e/=7)%13;e-=r;var i=(e/=13)%12;e-=i;var a=e/=12,o=ure.factory.fromInt(t);return new xse(a,i,r+1,n+1,o.get())}}]),n}(rte));var Ase=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"count",value:function(e,t){for(var n=0,r=0;r<14;r++)this.board[t][r]===e&&n++;return n}},{key:"doesOwnPiece",value:function(e){for(var t=0;t<12;t++)for(var n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}],[{key:"getInitialState",value:function(){var e=ate.NONE,t=ote.ONE,r=ote.ZERO;return new n([[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r]],0)}}]),n}(Sre),Rse=function(){var e=cp(function e(){sp(this,e)});return e.PHALANX_IS_LEAVING_BOARD=function(){return $localize(Rr||(Rr=Vv(["The move distance of your phalanx puts it out of the board."])))},e.SOMETHING_IN_PHALANX_WAY=function(){return $localize(Nr||(Nr=Vv(["There is something in the way of your phalanx."])))},e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=function(){return $localize(Mr||(Mr=Vv(["Your phalanx must be bigger than the one you are capturing."])))},e.CASE_NOT_ALIGNED_WITH_SELECTED=function(){return $localize(Dr||(Dr=Vv(["This square is not aligned with the selected piece."])))},e.SINGLE_PIECE_MUST_MOVE_BY_ONE=function(){return $localize(Lr||(Lr=Vv(["A single piece can only move by one square."])))},e.SINGLE_PIECE_CANNOT_CAPTURE=function(){return $localize(Fr||(Fr=Vv(["A single piece cannot make a capture."])))},e.CASE_NOT_ALIGNED_WITH_PHALANX=function(){return $localize(Br||(Br=Vv(["This square is not aligned with the direction of the phalanx."])))},e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=function(){return $localize(Ur||(Ur=Vv(["A phalanx can't contain pieces outside of the board."])))},e.PHALANX_CANNOT_CONTAIN_EMPTY_CASE=function(){return $localize(Vr||(Vr=Vv(["A phalanx cannot contain an empty square."])))},e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=function(){return $localize(zr||(zr=Vv(["A phalanx cannot contain a piece of the opponent."])))},e}(),Nse=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){return new Ase(n,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.count(ote.ZERO,0),r=t.count(ote.ONE,11);if(t.turn%2==0){if(n>r)return Dre.ZERO_WON}else if(r>n)return Dre.ONE_WON;return!1===t.doesOwnPiece(ote.ZERO)?Dre.ONE_WON:!1===t.doesOwnPiece(ote.ONE)?Dre.ZERO_WON:Dre.ONGOING}}],[{key:"isLegal",value:function(e,t){var r=this.getPhalanxValidity(t,e);if(r.isFailure())return J5.failure(r.getReason());var i=this.getLandingStatus(t,e);if(i.isFailure())return i;var a=lte.copyBiArray(i.get()),o=t.getCurrentOpponent(),s=n.getCaptureValidity(t,a,e,o);return s.isFailure()?s:J5.success(s.get())}},{key:"getPhalanxValidity",value:function(e,t){for(var n=t.coord,r=0,i=e.getCurrentOpponent();r<t.movedPieces;){if(n.isNotInRange(14,12))return e6.failure(Rse.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());var a=e.getPieceAt(n);if(a===ate.NONE)return e6.failure(Rse.PHALANX_CANNOT_CONTAIN_EMPTY_CASE());if(a===i)return e6.failure(Rse.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),r++}return e6.SUCCESS}},{key:"getLandingStatus",value:function(e,t){for(var n=e.getCopiedBoard(),r=e.getCurrentPlayer(),i=t.coord,a=t.coord.getNext(t.direction,t.movedPieces),o=0;o+1<t.stepSize;){if(n[i.y][i.x]=ate.NONE,n[a.y][a.x]=r,a.isNotInRange(14,12))return J5.failure(Rse.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(a).isPlayer())return J5.failure(Rse.SOMETHING_IN_PHALANX_WAY());o++,a=a.getNext(t.direction,1),i=i.getNext(t.direction,1)}return a.isNotInRange(14,12)?J5.failure(Rse.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(a)===r?J5.failure(kre.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=ate.NONE,n[a.y][a.x]=r,J5.success(n))}},{key:"getCaptureValidity",value:function(e,t,n,r){for(var i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),a=0;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(a>0&&(t[i.y][i.x]=ate.NONE),++a>=n.movedPieces)return J5.failure(Rse.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return J5.success(t)}}]),n}(Lre),Mse=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t=n.getListMoves(e);return lte.sortByDescending(t,function(e){return e.stepSize}),t}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new wre(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}},{key:"getPieceCountPlusRowDomination",value:function(e){for(var t=0,n=0;n<12;n++){for(var r=0,i=[0,0],a=0;a<14;a++){var o=new lre(a,n),s=e.getPieceAt(o);if(s.isPlayer()){var u=s.getScoreModifier();t+=2002*u,i[s.value]=u,r+=u;for(var c=0,l=[ure.UP_LEFT,ure.UP,ure.UP_RIGHT];c<l.length;c++)for(var h=l[c],f=o.getNext(h,1);f.isInRange(14,12)&&e.getPieceAt(f)===s;)t+=1*u,f=f.getNext(h,1)}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce(function(e,t){return e+t})}return t}}],[{key:"getListMoves",value:function(e){for(var t,n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),i=ate.NONE,a=[],o=e.gameState,s=0;s<12;s++)for(var u=0;u<14;u++){var c=new lre(u,s);if(o.getPieceAt(c)===n){var l,h=ip(ure.DIRECTIONS);try{for(h.s();!(l=h.n()).done;){for(var f=l.value,d=1,v=c.getNext(f,1);v.isInRange(14,12)&&o.getPieceAt(v)===n;)d+=1,v=v.getNext(f,1);for(var p=1;v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===i;)t=new xse(u,s,d,p,f),a=this.addMove(a,t,o),p++,v=v.getNext(f,1);v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===r&&(t=new xse(u,s,d,p,f),a=this.addMove(a,t,o))}}catch(g){h.e(g)}finally{h.f()}}}return a}},{key:"addMove",value:function(e,t,n){return Nse.isLegal(t,n).isSuccess()&&e.push(t),e}}]),n}(_re),Dse=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t=Mse.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}},{key:"orderMovesByPhalanxSizeAndFilter",value:function(e,t){var n=this;return lte.sortByDescending(e,function(e){return e.movedPieces}),e.length>40?e.filter(function(e){return!!n.moveIsCapture(e,t)||e.movedPieces*Math.random()>1}):e}},{key:"moveIsCapture",value:function(e,t){var n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new wre(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}},{key:"getPieceCountThenSupportThenAdvancement",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=new lre(r,n),a=e.getPieceAt(i);if(a.isPlayer()){var o=void 0,s=void 0;a===ote.ZERO?(o=12-n,s=[ure.UP_LEFT,ure.UP,ure.UP_RIGHT]):(o=n+1,s=[ure.DOWN_LEFT,ure.DOWN,ure.DOWN_RIGHT]);var u=a.getScoreModifier();t+=o*u,t+=149629*u;var c,l=ip(s);try{for(l.s();!(c=l.n()).done;)for(var h=c.value,f=i.getNext(h,1);f.isInRange(14,12)&&e.getPieceAt(f)===a;)t+=337*u,f=f.getNext(h,1)}catch(d){l.e(d)}finally{l.f()}}}return t}}]),n}(_re),Lse=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).DOMINANCE_FACTOR=20,e.DEFENSE_FACTOR=5,e.TERRITORY_FACTOR=2,e.OFFENSE_FACTOR=10,e.CENTER_FACTOR=5,e.MOBILITY_FACTOR=.12,e}return cp(n,[{key:"getDominance",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new lre(r,n));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}},{key:"getDefense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new lre(n,11))===ote.ZERO&&(t+=ote.ZERO.getScoreModifier()),e.getPieceAt(new lre(n,0))===ote.ONE&&(t+=ote.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}},{key:"getTerritory",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new lre(r,n));if(i.isPlayer()){for(var a=-1;a<=1;a++)for(var o=-1;o<=1;o++){var s=new lre(r+a,n+o);if(s.isInRange(14,12)){var u=e.getPieceAt(s);(u===i||u===ate.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}},{key:"getOffense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new lre(n,0))===ote.ZERO&&(t+=ote.ZERO.getScoreModifier()),e.getPieceAt(new lre(n,11))===ote.ONE&&(t+=ote.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}},{key:"getCenter",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new lre(r,n));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}},{key:"getMobility",value:function(e){for(var t=0,n=0,r=0,i=0;i<12;i++)for(var a=0;a<14;a++){var o=new lre(a,i),s=e.getPieceAt(o);if(s.isPlayer()){var u,c=ip(ure.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){for(var l=u.value,h=1,f=o.getNext(l,1);f.isInRange(14,12)&&e.getPieceAt(f)===s;)h+=1,f=f.getNext(l,1);for(var d=1;f.isInRange(14,12)&&d<=h&&e.getPieceAt(f)===ate.NONE;)d++,f=f.getNext(l,1);t+=d*d*s.getScoreModifier(),s===ote.ZERO?n=Math.max(n,d):s===ote.ONE&&(r=Math.max(r,d))}}catch(v){c.e(v)}finally{c.f()}}}return(t+n*ote.ZERO.getScoreModifier()+r*ote.ONE.getScoreModifier())*this.MOBILITY_FACTOR}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new wre(n.toBoardValue());var r=this.getDominance(t),i=this.getDefense(t),a=this.getTerritory(t),o=this.getCenter(t),s=this.getOffense(t),u=this.getMobility(t);return new wre(r+i+a+o+s+u)}}]),n}(Mse),Fse=ate.NONE,Bse=ote.ZERO,Use=ote.ONE,Vse=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(Hr||(Hr=Vv(["Initial board"]))),$localize(Gr||(Gr=Vv(["This is the initial board of Epaminondas.\n        The top line is the starting line of Light.\n        The bottom line is the starting line of Dark."]))),Ase.getInitialState()),Vre.informational($localize(qr||(qr=Vv(["Goal of the game (1/2)"]))),$localize($r||($r=Vv(["After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line\n        than the number of pieces the opponent has on the player's starting line, the player wins.\n        Here, it's Dark's turn to play: Dark has therefore won."]))),new Ase([[Fse,Fse,Fse,Fse,Fse,Bse,Fse,Fse,Use,Use,Use,Use,Use,Use],[Fse,Fse,Fse,Fse,Fse,Bse,Fse,Fse,Fse,Fse,Fse,Fse,Use,Use],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Use,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Bse,Bse,Bse,Bse,Fse,Fse,Fse]],0)),Vre.informational($localize(Wr||(Wr=Vv(["Goal of the game (2/2)"]))),$localize(jr||(jr=Vv(["Here, it is Light's turn.\n        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line."]))),new Ase([[Fse,Fse,Fse,Fse,Fse,Bse,Fse,Fse,Fse,Fse,Use,Use,Use,Use],[Fse,Fse,Fse,Fse,Fse,Bse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Use,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Use,Use,Fse,Fse,Fse,Bse,Bse,Fse,Bse,Bse,Bse,Bse]],1)),Vre.fromPredicate($localize(Zr||(Zr=Vv(["Moving a piece"]))),$localize(Yr||(Yr=Vv(["Here is the starting board. Dark plays first.\n        Let's start with moving a single piece:\n        <ol>\n            <li>Click on a piece.</li>\n            <li>Click on a empty neighboring square.</li>\n        </ol>"]))),Ase.getInitialState(),new xse(0,10,1,1,ure.UP),function(e,t){return 1===e.movedPieces?e6.SUCCESS:e6.failure($localize(Kr||(Kr=Vv(["Congratulations, you are in advance. But this is not the exercise here, try again."]))))},$localize(Jr||(Jr=Vv(["This is how you move a single piece."])))),Vre.fromPredicate($localize(Qr||(Qr=Vv(["Moving a phalanx"]))),$localize(Xr||(Xr=Vv(["Let us now see how to move multiple pieces along a line, which is called a phalanx:\n        <ol>\n            <li>Click on the first piece of the phalanx.</li>\n            <li>Click on the last piece of the phalanx.</li>\n            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>\n        </ol><br/>\n        Move a phalanx!"]))),Ase.getInitialState(),new xse(0,11,2,1,ure.UP),function(e,t){return e.movedPieces>1?e6.SUCCESS:e6.failure($localize(ei||(ei=Vv(["Failed! You moved only one piece."]))))},$localize(ti||(ti=Vv(["Congratulations!\n        The moved pieces can be horizontally, vertically, or diagonally aligned.\n        The move should be made along this axis, forward or backwards.\n        There can be no opponent nor holes in the phalanx."])))),Vre.fromMove($localize(ni||(ni=Vv(["Capture"]))),$localize(ri||(ri=Vv(["In order to capture pieces of the opponent:\n        <ol>\n            <li>It must be aligned with the phalanx you are moving.</li>\n            <li>It must be strictly shorter than your phalanx.</li>\n            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>\n        </ol><br/>\n        Capture a phalanx."]))),new Ase([[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Use,Use,Use,Use,Use,Use],[Fse,Fse,Fse,Fse,Fse,Fse,Use,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Use,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Use,Fse,Use,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Use,Use,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Use,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Bse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Bse,Fse,Fse,Fse,Fse,Use,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Bse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Bse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse,Fse],[Fse,Fse,Fse,Fse,Fse,Fse,Fse,Bse,Bse,Bse,Bse,Bse,Bse,Bse]],0),[new xse(2,10,4,2,ure.UP)],$localize(ii||(ii=Vv(["Congratulations, you made it!\n        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment."]))),$localize(ai||(ai=Vv(["Failed, you have not captured the phalanx."]))))]});function zse(e,t){if(1&e){var n=_b();Pm(),pb(0,"circle",4),bb("click",function(){Jy(n);var e=Pb().index,t=Pb().index;return Pb().onClick(e,t)}),gb()}if(2&e){var r=Pb().index,i=Pb().index,a=Pb();db("ngClass",a.getPieceClasses(r,i)),ob("r",.5*(a.SPACE_SIZE-2*a.STROKE_WIDTH))("cx",a.SPACE_SIZE*r+a.STROKE_WIDTH+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i+a.STROKE_WIDTH+a.SPACE_SIZE/2)}}function Hse(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",2),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),lb(2,zse,1,4,"circle",3),gb()}if(2&e){var r=t.index,i=Pb().index,a=Pb();Rw(1),Ib("id","click_",r,"_",i,""),db("ngClass",a.getRectClasses(r,i)),ob("x",a.SPACE_SIZE*r+a.STROKE_WIDTH)("y",a.SPACE_SIZE*i+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Rw(1),db("ngIf",a.board[i][r]!==a.NONE)}}function Gse(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Hse,3,8,"g",1),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function qse(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",5),bb("click",function(){var e=Jy(n).$implicit;return Pb().onClick(e.x,e.y)}),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb();Rw(1),ob("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var $se=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).NONE=ate.NONE,r.firstPiece=hB.empty(),r.validExtensions=[],r.phalanxValidLandings=[],r.lastPiece=hB.empty(),r.phalanxDirection=hB.empty(),r.phalanxMiddles=[],r.moveds=[],r.captureds=[],r.rules=new Nse(Ase),r.availableMinimaxes=[new Mse(r.rules,"Normal"),new Dse(r.rules,"Positional"),new Lse(r.rules,"Attack")],r.encoder=xse.encoder,r.tutorial=(new Vse).tutorial,r.updateBoard(),r}return cp(n,[{key:"updateBoard",value:function(){this.firstPiece=hB.empty(),this.lastPiece=hB.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.rules.node.gameState.getCopiedBoard()}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=e.coord;this.moveds=[t];for(var n=1;n<e.stepSize+e.movedPieces;n++)t=t.getNext(e.direction,1),this.moveds.push(t);for(var r=this.rules.node.mother.get(),i=r.gameState.getCurrentOpponent();t.isInRange(14,12)&&r.gameState.getPieceAt(t)===i;)this.captureds.push(t),t=t.getNext(e.direction,1)}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=n.rules.node.gameState.getCurrentOpponent(),a=n.rules.node.gameState.getCurrentPlayer(),r.t0=n.board[t][e],r.next=r.t0===a?4:r.t0===i?5:6;break;case 4:return r.abrupt("return",(n.firstPiece=hB.of(new lre(e,t)),n.validExtensions=n.getValidExtensions(a),n.phalanxValidLandings=n.getPhalanxValidLandings(),e6.SUCCESS));case 5:return r.abrupt("return",n.cancelMove(kre.CANNOT_CHOOSE_OPPONENT_PIECE()));case 6:return r.abrupt("return",(oB.expectToBe(n.board[t][e],ate.NONE),n.cancelMove(kre.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())));case 7:case"end":return r.stop()}},r)}))()}},{key:"hidePreviousMove",value:function(){this.captureds=[],this.moveds=[]}},{key:"getValidExtensions",value:function(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}},{key:"getFirstPieceExtensions",value:function(e){var t,n=[],r=ip(ure.DIRECTIONS);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.firstPiece.get().getNext(i,1);a.isInRange(14,12)&&this.board[a.y][a.x]===e;)n.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPhalanxValidExtensions",value:function(e){var t=ure.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get(),n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();var i=this.firstPiece.get().getNext(t,1),a=this.getExtensionsToward(i,t,e);return r.concat(a)}},{key:"getExtensionsToward",value:function(e,t,n){for(var r=[];e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}},{key:"getPhalanxValidLandings",value:function(){if(this.lastPiece.isPresent()){var e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1,a=ure.factory.fromMove(e,t).get(),o=t.getNext(a,1),s=this.getLandingsToward(o,a,i);a=a.getOpposite();var u=e.getNext(a,1);return this.getLandingsToward(u,a,i).concat(s)}return this.getNeighbooringEmptyCases()}},{key:"getNeighbooringEmptyCases",value:function(){var e,t=[],n=ip(ure.DIRECTIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.firstPiece.get().getNext(r,1);i.isInRange(14,12)&&this.board[i.y][i.x]===ate.NONE&&t.push(i)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getLandingsToward",value:function(e,t,n){for(var r=this.rules.node.gameState.getCurrentPlayer(),i=this.rules.node.gameState.getCurrentOpponent(),a=[];e.isInRange(14,12)&&a.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&a.push(e),a;a.push(e),e=e.getNext(t,1)}return a}},{key:"getPhalanxLength",value:function(e,t,n){for(var r=0;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}},{key:"cancelMoveAttempt",value:function(){this.firstPiece=hB.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=hB.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}},{key:"secondClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new lre(e,t),a=n.firstPiece.get(),!i.equals(a)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),e6.SUCCESS));case 3:if(o=n.rules.node.gameState.getCurrentOpponent(),s=n.rules.node.gameState.getCurrentPlayer(),i.isAlignedWith(a)){r.next=6;break}return r.abrupt("return",n.cancelMove(Rse.CASE_NOT_ALIGNED_WITH_SELECTED()));case 6:u=i.getDistance(a),c=a.getDirectionToward(i).get(),r.t0=n.board[t][e],r.next=r.t0===ate.NONE?10:r.t0===o?11:12;break;case 10:return r.abrupt("return",1===u?n.tryMove(new xse(a.x,a.y,1,1,c)):n.cancelMove(Rse.SINGLE_PIECE_MUST_MOVE_BY_ONE()));case 11:return r.abrupt("return",n.cancelMove(Rse.SINGLE_PIECE_CANNOT_CAPTURE()));case 12:return oB.expectToBe(n.board[t][e],s),l=new xse(a.x,a.y,u,1,c),h=Nse.getPhalanxValidity(n.rules.node.gameState,l),r.abrupt("return",h.isFailure()?n.cancelMove(h.getReason()):(n.lastPiece=hB.of(i),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=a.getCoordsToward(i),n.phalanxDirection=hB.of(c),e6.SUCCESS));case 15:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,h,f,d,v,p;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.rules.node.gameState.getCurrentPlayer(),a=new lre(e,t),!n.firstPiece.equalsValue(a)){r.next=3;break}return r.abrupt("return",n.moveFirstPiece(i));case 3:if(!n.lastPiece.equalsValue(a)){r.next=5;break}return r.abrupt("return",n.moveLastPiece(i));case 5:if(o=n.firstPiece.get(),s=n.lastPiece.get(),a.isAlignedWith(o)){r.next=8;break}return r.abrupt("return",n.cancelMove(Rse.CASE_NOT_ALIGNED_WITH_PHALANX()));case 8:if(u=ure.factory.fromMove(o,s).get(),c=ure.factory.fromMove(o,a).get(),u===c.getOpposite()&&(n.firstPiece=hB.of(s),n.lastPiece=hB.of(o),u=c),u===c){r.next=12;break}return r.abrupt("return",n.cancelMove(Rse.CASE_NOT_ALIGNED_WITH_PHALANX()));case 12:if(n.board[t][e]!==i){r.next=16;break}return n.lastPiece=hB.of(a),l=n.firstPiece.get().getDistance(a)+1,h=new xse(n.firstPiece.get().x,n.firstPiece.get().y,l,1,u),f=Nse.getPhalanxValidity(n.rules.node.gameState,h),r.abrupt("return",f.isFailure()?n.cancelMove(f.getReason()):(n.phalanxMiddles=n.firstPiece.get().getCoordsToward(n.lastPiece.get()),n.validExtensions=n.getValidExtensions(i),n.phalanxValidLandings=n.getPhalanxValidLandings(),e6.SUCCESS));case 16:return d=n.firstPiece.get().getDistance(n.lastPiece.get())+1,v=n.lastPiece.get().getDistance(a),p=new xse(n.firstPiece.get().x,n.firstPiece.get().y,d,v,u),r.abrupt("return",n.tryMove(p));case 18:case"end":return r.stop()}},r)}))()}},{key:"moveFirstPiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.firstPiece=hB.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),!t.firstPiece.equals(t.lastPiece)){n.next=6;break}return n.next=4,t.moveOnlyPiece(e);case 4:n.next=7;break;case 6:t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e);case 7:return t.phalanxValidLandings=t.getPhalanxValidLandings(),n.abrupt("return",e6.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveLastPiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=hB.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),e6.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"moveOnlyPiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=hB.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=hB.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),e6.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e){var t=this.rules.node.gameState;return this.cancelMove(),this.chooseMove(e,t)}},{key:"getPieceClasses",value:function(e,t){var n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}},{key:"getPieceStrokeClasses",value:function(e,t){var n=new lre(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(function(e){return e.equals(n)})?["highlighted"]:[]}},{key:"getRectClasses",value:function(e,t){var n=new lre(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:this.moveds.some(function(e){return e.equals(n)})?["moved"]:[]}},{key:"getHighlightedCoords",value:function(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}},{key:"getCurrentPlayerPieces",value:function(){for(var e=[],t=this.rules.node.gameState.getCurrentPlayer(),n=0;n<this.board.length;n++)for(var r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new lre(r,n));return e}}]),n}(wie);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-epaminondas"]],features:[jC],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable",3,"click"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,Gse,2,1,"g",1),lb(2,qse,2,4,"g",1),gb()),2&e&&(Rw(1),db("ngForOf",t.board),Rw(1),db("ngForOf",t.getHighlightedCoords()))},directives:[FT,DT,UT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}();function Wse(e){return new(function(t){Yv(r,t);var n=Jv(r);function r(){return sp(this,r),n.apply(this,arguments)}return cp(r,[{key:"encode",value:function(t){return t.isPresent()?e.encode(t.get()):null}},{key:"decode",value:function(t){return null===t?hB.empty():hB.of(e.decode(t))}}]),r}(tte))}var jse=function(){function e(t){if(sp(this,e),t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===xoe.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=lte.copyImmutableArray(t).sort(function(e,t){if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate cases");return e.y>t.y?1:-1}return e.x>t.x?1:-1});var n,r=hB.empty(),i=ip(this.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(r.isPresent()&&1!==r.get().getDistance(a))throw new Error("Cannot create a GipfCapture with non-consecutive cases");r=hB.of(a)}}catch(o){i.e(o)}finally{i.f()}}return cp(e,[{key:"toString",value:function(){var e,t="",n=ip(this.capturedSpaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;""!==t&&(t+=","),t+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"size",value:function(){return this.capturedSpaces.length}},{key:"forEach",value:function(e){this.capturedSpaces.forEach(e)}},{key:"contains",value:function(e){for(var t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}},{key:"intersectsWith",value:function(e){return this.capturedSpaces.some(function(t){return e.contains(t)})}},{key:"getLine",value:function(){return xoe.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}},{key:"equals",value:function(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(var t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}]),e}();jse.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"encode",value:function(e){return e.capturedSpaces.map(function(e){return lre.encoder.encode(e)})}},{key:"decode",value:function(e){return new jse(e.map(function(e){return lre.encoder.decode(e)}))}}]),n}(tte));var Zse=function(){function e(t,n){sp(this,e),this.coord=t,this.direction=n}return cp(e,[{key:"toString",value:function(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}},{key:"equals",value:function(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}]),e}();Zse.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).optionalDirectionEncoder=Wse(vre.encoder),e}return cp(n,[{key:"encode",value:function(e){return{coord:lre.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}},{key:"decode",value:function(e){var t=e;return a6(null!=t.coord,"Invalid encoded GipfPlacement"),new Zse(lre.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}}]),n}(tte));var Yse=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this)).placement=e,a.initialCaptures=r,a.finalCaptures=i,a}return cp(n,[{key:"toString",value:function(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=ip(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"equals",value:function(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===lte.compareArray(this.initialCaptures,e.initialCaptures)||!1===lte.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}]),n}(Ore);Yse.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"encodeMove",value:function(e){var t={placement:Zse.encoder.encode(e.placement)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=jse.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=jse.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return a6(null!=t.placement,"Invalid encoded GipfMove"),new Yse(Zse.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",jse.encoder.decode),this.decodeArray(t,"finalCapture",jse.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(nte));var Kse=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this,r,e,7,7,[3,2,1],dre.EMPTY)).sidePieces=i,o.capturedPieces=a,o}return cp(n,[{key:"equals",value:function(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&lte.compareTable(this.board,e.board)}},{key:"getNumberOfPiecesToPlace",value:function(e){return this.sidePieces[e.value]}},{key:"getNumberOfPiecesCaptured",value:function(e){return this.capturedPieces[e.value]}},{key:"setAtUnsafe",value:function(e,t){var r=lte.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.sidePieces,this.capturedPieces)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==dre.NONE}}],[{key:"getInitialState",value:function(){var e=dre.EMPTY,t=dre.NONE,r=dre.ZERO,i=dre.ONE;return new n([[t,t,t,i,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,r,t,t,t]],0,[12,12],[0,0])}}]),n}(Aoe),Jse=function(){var e=cp(function e(){sp(this,e)});return e.CAPTURE_MUST_BE_ALIGNED=function(){return $localize(oi||(oi=Vv(["You can only capture when 4 or more of your pieces are aligned, and it is not the case."])))},e.INVALID_CAPTURED_PIECES=function(){return $localize(si||(si=Vv(["You must select a valid capture that contains 4 pieces or more."])))},e.MISSING_CAPTURES=function(){return $localize(ui||(ui=Vv(["There are still possible captures to be done."])))},e.PLACEMENT_NOT_ON_BORDER=function(){return $localize(ci||(ci=Vv(["Pieces must be inserted in spaces on the edge of the board."])))},e.INVALID_PLACEMENT_DIRECTION=function(){return $localize(li||(li=Vv(["You must select a valid placement direction."])))},e.PLACEMENT_WITHOUT_DIRECTION=function(){return $localize(hi||(hi=Vv(["You must select a placement with a direction alongside the insertion space."])))},e.PLACEMENT_ON_COMPLETE_LINE=function(){return $localize(fi||(fi=Vv(["You cannot place a piece on a complete line."])))},e.AMBIGUOUS_CAPTURE_COORD=function(){return $localize(di||(di=Vv(["This piece belongs to two captures. Please select another piece in the capture you'd like to make."])))},e.CLICK_FURTHER_THAN_ONE_COORD=function(){return $localize(vi||(vi=Vv(["You must click on an arrow to select your destination."])))},e.NO_DIRECTIONS_AVAILABLE=function(){return $localize(pi||(pi=Vv(["You cannot insert a piece here, as all lines are full. Select another space."])))},e}(),Qse=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){return new Kse(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}},{key:"getPiecesMoved",value:function(e,t,r){var i=n.applyCaptures(e,t);if(r.direction.isAbsent())return[r.coord];var a=r.direction.get(),o=[];o.push(r.coord);for(var s=r.coord.getNext(a);i.isOnBoard(s)&&i.getPieceAt(s)!==dre.EMPTY;)o.push(s),s=s.getNext(a);return a6(i.isOnBoard(s)&&i.getPieceAt(s)===dre.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(s),o}},{key:"isLegal",value:function(e,t){var r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toFailedFallible();var i=n.applyCaptures(t,e.initialCaptures),a=this.noMoreCapturesValidity(i);if(a.isFailure())return a.toFailedFallible();var o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toFailedFallible();var s=n.applyPlacement(i,e.placement),u=this.capturesValidity(s,e.finalCaptures);if(u.isFailure())return u.toFailedFallible();var c=n.applyCaptures(s,e.finalCaptures),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():J5.success(c)}},{key:"capturesValidity",value:function(e,t){var r,i=e,a=ip(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=this.captureValidity(i,o);if(s.isFailure())return s;i=n.applyCapture(i,o)}}catch(u){a.e(u)}finally{a.f()}return e6.SUCCESS}},{key:"captureValidity",value:function(e,t){var r=e.getCurrentPlayer(),i=n.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(i.isAbsent())return e6.failure(Jse.CAPTURE_MUST_BE_ALIGNED());var a=i.get();return n.getCapturable(e,a).equals(t)?e6.SUCCESS:e6.failure(Jse.INVALID_CAPTURED_PIECES())}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===n.getLinePortionsWithFourPiecesOfPlayer(e,t).length?e6.SUCCESS:e6.failure(Jse.MISSING_CAPTURES())}},{key:"placementValidity",value:function(e,t){var r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==dre.EMPTY){if(t.direction.isAbsent())return e6.failure(Jse.PLACEMENT_WITHOUT_DIRECTION());if(n.isLineComplete(e,t.coord,t.direction.get()))return e6.failure(Jse.PLACEMENT_ON_COMPLETE_LINE());var i,a=ip(n.getAllDirectionsForEntrance(e,t.coord));try{for(a.s();!(i=a.n()).done;){if(i.value===t.direction.get())return e6.SUCCESS}}catch(o){a.e(o)}finally{a.f()}return e6.failure(Jse.INVALID_PLACEMENT_DIRECTION())}return e6.SUCCESS}},{key:"placementCoordValidity",value:function(e,t){return mre.INSTANCE.isOnBorder(e,t)?e6.SUCCESS:e6.failure(Jse.PLACEMENT_NOT_ON_BORDER())}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getPlayerScore(t,ote.ZERO),i=n.getPlayerScore(t,ote.ONE);return r.isAbsent()?Dre.ONE_WON:i.isAbsent()?Dre.ZERO_WON:Dre.ONGOING}}],[{key:"applyCaptures",value:function(e,t){var r=e;return t.forEach(function(e){r=n.applyCapture(r,e)}),r}},{key:"applyCapture",value:function(e,t){var n=e.getCurrentPlayer(),r=e,i=[e.sidePieces[0],e.sidePieces[1]],a=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(function(t){var o=e.getPieceAt(t);r=r.setAt(t,dre.EMPTY),o.is(n)?i[n.value]+=1:a[n.value]+=1}),new Kse(r.board,e.turn,i,a)}},{key:"getPlacements",value:function(e){var t=[];return mre.INSTANCE.getAllBorders(e).forEach(function(r){e.getPieceAt(r)===dre.EMPTY?t.push(new Zse(r,hB.empty())):n.getAllDirectionsForEntrance(e,r).forEach(function(i){!1===n.isLineComplete(e,r,i)&&t.push(new Zse(r,hB.of(i)))})}),t}},{key:"isLineComplete",value:function(e,t,r){return n.nextGapInLine(e,t,r).isAbsent()}},{key:"nextGapInLine",value:function(e,t,n){for(var r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===dre.EMPTY)return hB.of(r);return hB.empty()}},{key:"applyPlacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e,i=dre.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){var a=t.coord;if(e.getPieceAt(a)!==dre.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(a,i)}else for(var o=t.coord;r.isOnBoard(o)&&i!==dre.EMPTY;o=o.getNext(t.direction.get())){var s=e.getPieceAt(o);r=r.setAt(o,i),i=s}var u=[e.sidePieces[0],e.sidePieces[1]];return u[n.value]-=1,new Kse(r.board,e.turn,u,e.capturedPieces)}},{key:"getAllDirectionsForEntrance",value:function(e,t){if(mre.INSTANCE.isTopLeftCorner(e,t))return[vre.RIGHT,vre.DOWN,vre.UP_RIGHT];if(mre.INSTANCE.isTopCorner(e,t))return[vre.DOWN,vre.DOWN_LEFT,vre.RIGHT];if(mre.INSTANCE.isTopRightCorner(e,t))return[vre.DOWN_LEFT,vre.DOWN,vre.LEFT];if(mre.INSTANCE.isBottomLeftCorner(e,t))return[vre.UP_RIGHT,vre.UP,vre.RIGHT];if(mre.INSTANCE.isBottomCorner(e,t))return[vre.UP,vre.LEFT,vre.UP_RIGHT];if(mre.INSTANCE.isBottomRightCorner(e,t))return[vre.LEFT,vre.UP,vre.DOWN_LEFT];if(mre.INSTANCE.isOnTopLeftBorder(e,t))return[vre.RIGHT,vre.DOWN];if(mre.INSTANCE.isOnLeftBorder(e,t))return[vre.UP_RIGHT,vre.RIGHT];if(mre.INSTANCE.isOnBottomLeftBorder(e,t))return[vre.UP,vre.UP_RIGHT];if(mre.INSTANCE.isOnBottomRightBorder(e,t))return[vre.LEFT,vre.UP];if(mre.INSTANCE.isOnRightBorder(e,t))return[vre.LEFT,vre.DOWN_LEFT];if(mre.INSTANCE.isOnTopRightBorder(e,t))return[vre.DOWN_LEFT,vre.DOWN];throw new Error("not a border")}},{key:"getLinePortionsWithFourPiecesOfPlayer",value:function(e,t){var r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithFourPiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithFourPiecesOfPlayer",value:function(e,t,n){for(var r=0,i=e.getEntranceOnLine(n),a=n.getDirection(),o=i,s=i;e.isOnBoard(s);s=s.getNext(a))if(e.getPieceAt(s).is(t)?(0===r&&(o=s),r+=1):r=0,4===r)return hB.of({0:o,1:s,2:a});return hB.empty()}},{key:"getCapturable",value:function(e,t){for(var n=[],r=t[0],i=t[1],a=t[2],o=a.getOpposite(),s=r.getNext(o);e.isOnBoard(s)&&e.getPieceAt(s)!==dre.EMPTY;)n.push(s),s=s.getNext(o);for(var u=r;!u.equals(i);u=u.getNext(a))n.push(u);for(var c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==dre.EMPTY;c=c.getNext(a))n.push(c);return new jse(n)}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),r=[];return n.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(function(t){r.push(n.getCapturable(e,t))}),r}},{key:"getPlayerScore",value:function(e,t){var r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===n.getPossibleCaptures(e).length)return hB.empty();var i=e.getNumberOfPiecesCaptured(t);return hB.of(r+3*i)}},{key:"isGameOver",value:function(e){var t=n.getPlayerScore(e,ote.ZERO),r=n.getPlayerScore(e,ote.ONE);return t.isAbsent()||r.isAbsent()}}]),n}(Lre),Xse=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getBoardValue",value:function(e){var t=e.gameState,n=Qse.getPlayerScore(t,ote.ZERO),r=Qse.getPlayerScore(t,ote.ONE);return n.isAbsent()?new wre(ote.ONE.getVictoryValue()):r.isAbsent()?new wre(ote.ZERO.getVictoryValue()):new wre(n.get()-r.get())}},{key:"getListMoves",value:function(e){return this.getListMoveFromState(e.gameState)}},{key:"getListMoveFromState",value:function(e){var t=this,n=[];return Qse.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(function(r){var i=Qse.applyCaptures(e,r);Qse.getPlacements(i).forEach(function(e){var a=Qse.applyPlacement(i,e);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new Yse(e,r,t);n.push(i)})})}),n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=Qse.getPossibleCaptures(e);return n.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}],[{key:"getPossibleCaptureCombinationsFromPossibleCaptures",value:function(e){var t=n.computeIntersections(e),r=[[]];return e.forEach(function(e,n){if(0===t[n].length)r.forEach(function(e){e.push(n)});else{var i,a=[],o=t[n].some(function(e){return e>n}),s=ip(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;!0===u.some(function(e){return t[n].some(function(t){return e===t})})?a.push(lte.copyImmutableArray(u)):o?(a.push(lte.copyImmutableArray(u)),u.push(n),a.push(lte.copyImmutableArray(u))):(u.push(n),a.push(lte.copyImmutableArray(u)))}}catch(c){s.e(c)}finally{s.f()}r=a}}),r.map(function(t){return t.map(function(t){return e[t]})})}},{key:"computeIntersections",value:function(e){var t=[];return e.forEach(function(n,r){t.push([]),e.forEach(function(e,i){r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}}]),n}(_re),eue=cp(function e(t,n,r,i,a,o){sp(this,e),this.source=t,this.destination=n,this.x1=r,this.y1=i,this.x2=a,this.y2=o}),tue=dre.NONE,nue=dre.EMPTY,rue=dre.ZERO,iue=dre.ONE,aue=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(gi||(gi=Vv(["Goal of the game"]))),$localize(yi||(yi=Vv(["The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.\n        This is the initial board.\n        Each player has 12 pieces on the side and 3 pieces on the board.\n        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.\n        The first player plays with the dark pieces, the second player plays with the light pieces."]))),Kse.getInitialState()),Vre.anyMove($localize(mi||(mi=Vv(["Pushing"]))),$localize(ki||(ki=Vv(["Pieces can only enter the board through the edges. To insert a new piece:\n        <ol>\n            <li>Click on a space on the edge of the board.</li>\n            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>\n        </ol>\n        You cannot push when a line is full.<br/><br/>\n        You're playing Dark, insert a piece."]))),Kse.getInitialState(),new Yse(new Zse(new lre(3,0),hB.of(vre.DOWN)),[],[]),$localize(_i||(_i=Vv(["Congratulations!"])))),Vre.fromMove($localize(wi||(wi=Vv(["Capture (1/3)"]))),$localize(Ci||(Ci=Vv(["To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.\n        There are multiple important aspects of a capture:\n        <ol>\n            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>\n            <li>As soon as there is an empty space on the line, the capture stops.</li>\n            <li>Your own pieces that are captured go back to your stock.\n                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>\n            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.\n                This means that a turn happens in three phases:\n                <ol type=\"A\">\n                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>\n                    <li>Make your insertion.</li>\n                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>\n                </ol>\n            </li>\n        </ol><br/>\n        You're playing Dark, you can make a capture, do it."]))),new Kse([[tue,tue,tue,rue,iue,nue,nue],[tue,tue,nue,nue,nue,nue,nue],[tue,nue,nue,nue,nue,nue,nue],[rue,rue,rue,nue,nue,nue,nue],[iue,nue,nue,nue,nue,nue,tue],[nue,nue,nue,iue,nue,tue,tue],[nue,nue,nue,iue,tue,tue,tue]],42,[8,8],[0,0]),[new Yse(new Zse(new lre(0,3),hB.of(vre.RIGHT)),[],[new jse([new lre(0,3),new lre(1,3),new lre(2,3),new lre(3,3)])])],$localize(bi||(bi=Vv(["Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.\n        Let's now see how captures can really be useful."]))),$localize(Ei||(Ei=Vv(["Failed!"])))),Vre.fromMove($localize(Si||(Si=Vv(["Capture (2/3)"]))),$localize(Pi||(Pi=Vv(["Here, there are three different ways of capturing.\n        <ol>\n          <li>One way does not capture any of your opponent's pieces.</li>\n          <li>Another way captures one of your opponent's pieces.</li>\n          <li>The last way captures two of your opponent's pieces.</li>\n        </ol>\n        <br/><br/>\n        Pick the last one."]))),new Kse([[tue,tue,tue,nue,nue,nue,nue],[tue,tue,nue,iue,nue,nue,nue],[tue,nue,nue,rue,nue,nue,nue],[rue,rue,rue,iue,nue,nue,nue],[nue,nue,nue,rue,nue,nue,tue],[nue,nue,nue,rue,nue,tue,tue],[nue,nue,nue,iue,tue,tue,tue]],42,[8,4],[2,3]),[new Yse(new Zse(new lre(0,3),hB.of(vre.RIGHT)),[],[new jse([new lre(3,1),new lre(3,2),new lre(3,3),new lre(3,4),new lre(3,5),new lre(3,6)])])],$localize(Oi||(Oi=Vv(["Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.\n        The most you can get is 3 per capture."]))),$localize(Ti||(Ti=Vv(["Failed, the best capture was taking 2 of your opponent's pieces"])))),Vre.fromMove($localize(Ii||(Ii=Vv(["Capture (3/3)"]))),$localize(xi||(xi=Vv(["Here, you must capture at the beginning of your turn.\n        This is due to a move of your opponent at the previous turn\n        (even though this is a fictitious board for pedagogical purpose).\n        After your capture, by performing the right move you can even capture two more of your opponent's pieces!\n        Keep it mind that the most useful in a capture is to take your opponent's pieces."]))),new Kse([[tue,tue,tue,rue,nue,nue,rue],[tue,tue,nue,rue,nue,nue,rue],[tue,rue,rue,nue,rue,iue,rue],[nue,nue,nue,rue,nue,nue,rue],[nue,nue,nue,rue,nue,nue,tue],[rue,rue,rue,iue,iue,tue,tue],[nue,nue,nue,rue,tue,tue,tue]],42,[8,4],[2,3]),[new Yse(new Zse(new lre(3,6),hB.of(vre.UP)),[new jse([new lre(6,0),new lre(6,1),new lre(6,2),new lre(6,3)])],[new jse([new lre(0,5),new lre(1,5),new lre(2,5),new lre(3,5),new lre(4,5)]),new jse([new lre(1,2),new lre(2,2),new lre(3,2),new lre(4,2),new lre(5,2)])]),new Yse(new Zse(new lre(4,6),hB.of(vre.UP)),[new jse([new lre(6,0),new lre(6,1),new lre(6,2),new lre(6,3)])],[new jse([new lre(0,5),new lre(1,5),new lre(2,5),new lre(3,5),new lre(4,5)]),new jse([new lre(3,0),new lre(3,1),new lre(3,2),new lre(3,3),new lre(3,4)])]),new Yse(new Zse(new lre(3,6),hB.of(vre.UP)),[new jse([new lre(6,0),new lre(6,1),new lre(6,2),new lre(6,3)])],[new jse([new lre(1,2),new lre(2,2),new lre(3,2),new lre(4,2),new lre(5,2)]),new jse([new lre(0,5),new lre(1,5),new lre(2,5),new lre(3,5),new lre(4,5)])])],$localize(Ai||(Ai=Vv(["Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces."]))),$localize(Ri||(Ri=Vv(["Failed, the best capture takes 2 of your opponent's pieces."]))))]});function oue(e,t){if(1&e&&(Pm(),yb(0,"circle",11)),2&e){var n=Pb().$implicit,r=Pb();db("ngClass",r.getPieceClass(n)),ob("cx",r.getCenterAt(n).x)("cy",r.getCenterAt(n).y)("r",r.SPACE_SIZE)}}function sue(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"g",8),bb("click",function(){var e=Jy(n).$implicit;return Pb().onClick(e)}),yb(2,"polyline",9),lb(3,oue,1,4,"circle",10),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb();Rw(1),Ib("id","click_",r.x,"_",r.y,""),Rw(1),Ib("id","case_",r.x,"_",r.y,""),db("ngClass",i.getSpaceClass(r)),ob("points",i.getHexaCoordsAt(r)),Rw(1),db("ngIf",i.isPiece(r))}}function uue(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",14),bb("click",function(){var e=Jy(n).$implicit;return Pb(2).onClick(e)}),gb()}if(2&e){var r=t.$implicit;ob("points",Pb(2).getHexaCoordsAt(r))}}function cue(e,t){if(1&e&&(Pm(),pb(0,"g",12),lb(1,uue,1,1,"polyline",13),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n.capturedSpaces)}}function lue(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"line",15),bb("click",function(){var e=Jy(n).$implicit;return Pb().onClick(e.destination)}),gb(),gb()}if(2&e){var r=t.$implicit;Rw(1),ob("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)}}function hue(e,t){if(1&e&&(Pm(),pb(0,"g"),yb(1,"circle",16),gb()),2&e){var n=t.$implicit,r=Pb().$implicit,i=Pb();Rw(1),Ib("id","piece_",r,"_",n,""),db("ngClass",i.getSidePieceClass(r)),ob("cx",10+n*i.SPACE_SIZE*.5)("cy",10+(i.SPACE_SIZE+10)*r)("r",.5*i.SPACE_SIZE)}}function fue(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,hue,2,6,"g",5),gb()),2&e){var n=t.$implicit,r=Pb();Rw(1),db("ngForOf",r.getPlayerSidePieces(n))}}function due(e,t){if(1&e&&(Pm(),yb(0,"line",17)),2&e){var n=Pb();ob("x1",n.inserted.get().x1)("y1",n.inserted.get().y1)("x2",n.inserted.get().x2)("y2",n.inserted.get().y2)}}var vue=function(){return[0,1]},pue=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).inserted=hB.empty(),r.arrows=[],r.captured=[],r.moved=[],r.movePhase=n.PHASE_PLACEMENT_COORD,r.possibleCaptures=[],r.initialCaptures=[],r.placement=hB.empty(),r.placementEntrance=hB.empty(),r.finalCaptures=[],r.scores=hB.of([0,0]),r.rules=new Qse(Kse),r.availableMinimaxes=[new Xse(r.rules,"GipfMinimax")],r.encoder=Yse.encoder,r.tutorial=(new aue).tutorial,r.SPACE_SIZE=40,r.constructedState=r.rules.node.gameState,r.hexaLayout=new pre(1.5*r.SPACE_SIZE,new lre(2*r.SPACE_SIZE,0),mre.INSTANCE),r}return cp(n,[{key:"updateBoard",value:function(){this.showLastMove(),this.cancelMoveAttempt(),this.moveToInitialCaptureOrPlacementPhase()}},{key:"showLastMove",value:function(){this.inserted=hB.empty();var e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){var t=e.get().placement;this.inserted=hB.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}},{key:"arrowTowards",value:function(e,t){var n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new eue(n,e,i.x,i.y,r.x,r.y)}},{key:"markCapture",value:function(e){var t=this;e.forEach(function(e){t.captured.push(e)})}},{key:"getAllCoords",value:function(){return this.constructedState.allCoords()}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.constructedState.getNumberOfPiecesToPlace(ote.of(e)),n=[],r=0;r<t;r+=1)n.push(r);return n}},{key:"isPiece",value:function(e){return this.getPiece(e)!==dre.EMPTY}},{key:"getPiece",value:function(e){return this.constructedState.getPieceAt(e)}},{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){r.next=3;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 3:r.t0=t.movePhase,r.next=r.t0===n.PHASE_INITIAL_CAPTURE||r.t0===n.PHASE_FINAL_CAPTURE?6:r.t0===n.PHASE_PLACEMENT_COORD?7:8;break;case 6:return r.abrupt("return",t.selectCapture(e));case 7:return r.abrupt("return",t.selectPlacementCoord(e));case 8:if(oB.expectToBe(t.movePhase,n.PHASE_PLACEMENT_DIRECTION),!1!==(a=t.placementEntrance.get()).isAlignedWith(e)){r.next=12;break}return r.abrupt("return",t.cancelMove(Jse.INVALID_PLACEMENT_DIRECTION()));case 12:if(1===a.getDistance(e)){r.next=14;break}return r.abrupt("return",t.cancelMove(Jse.CLICK_FURTHER_THAN_ONE_COORD()));case 14:return o=vre.factory.fromMove(a,e),r.abrupt("return",t.selectPlacementDirection(o.toOptional()));case 16:case"end":return r.stop()}},r)}))()}},{key:"selectCapture",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&i.push(t)}),!(i.length>1)){r.next=3;break}return r.abrupt("return",t.cancelMove(Jse.AMBIGUOUS_CAPTURE_COORD()));case 3:if(0!==i.length){r.next=5;break}return r.abrupt("return",t.cancelMove(Jse.MISSING_CAPTURES()));case 5:a=i[0],r.t0=(t.constructedState=Qse.applyCapture(t.constructedState,a),t.markCapture(a),t.possibleCaptures=Qse.getPossibleCaptures(t.constructedState),t.movePhase),r.next=r.t0===n.PHASE_INITIAL_CAPTURE?9:10;break;case 9:return r.abrupt("return",(t.initialCaptures.push(a),0===t.possibleCaptures.length?t.moveToPlacementPhase():e6.SUCCESS));case 10:return r.abrupt("return",(oB.expectToBe(t.movePhase,n.PHASE_FINAL_CAPTURE),t.finalCaptures.push(a),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):e6.SUCCESS));case 11:case"end":return r.stop()}},r)}))()}},{key:"moveToPlacementPhase",value:function(){return this.movePhase=n.PHASE_PLACEMENT_COORD,e6.SUCCESS}},{key:"moveToInitialCaptureOrPlacementPhase",value:function(){return this.possibleCaptures=Qse.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,e6.SUCCESS}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=Qse.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,e6.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}},{key:"computeArrows",value:function(e){this.arrows=[];var t,n=ip(Qse.getAllDirectionsForEntrance(this.constructedState,e));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===Qse.isLineComplete(this.constructedState,e,r)){var i=e.getNext(r),a=this.getCenterAt(e),o=this.getCenterAt(i);this.arrows.push(new eue(e,i,a.x,a.y,o.x,o.y))}}}catch(s){n.e(s)}finally{n.f()}}},{key:"selectPlacementCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.rules.placementCoordValidity(t.constructedState,e),r.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):(t.placementEntrance=hB.of(e),t.constructedState.getPieceAt(e)===dre.EMPTY?t.selectPlacementDirection(hB.empty()):(t.movePhase=n.PHASE_PLACEMENT_DIRECTION,t.computeArrows(e),0===t.arrows.length&&t.cancelMove(Jse.NO_DIRECTIONS_AVAILABLE()),e6.SUCCESS)));case 2:case"end":return r.stop()}},r)}))()}},{key:"selectPlacementDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.placement=hB.of(new Zse(t.placementEntrance.get(),e)),r=t.rules.placementValidity(t.constructedState,t.placement.get()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.arrows=[],t.constructedState=Qse.applyPlacement(t.constructedState,t.placement.get()),t.moveToFinalCapturePhaseOrTryMove()));case 3:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=new Yse(t,e,n),i.next=3,r.chooseMove(a,r.rules.node.gameState,r.scores.get());case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"cancelMoveAttempt",value:function(){var e=this;this.constructedState=this.rules.node.gameState,this.captured=[],this.moved=[];var t=this.rules.node.move;if(t.isPresent()){var n=t.get(),r=this.rules.node.mother.get().gameState;n.initialCaptures.forEach(function(t){return e.markCapture(t)}),n.finalCaptures.forEach(function(t){return e.markCapture(t)}),this.moved=this.rules.getPiecesMoved(r,n.initialCaptures,n.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=hB.empty(),this.placement=hB.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}},{key:"getSpaceClass",value:function(e){return this.captured.some(function(t){return t.equals(e)})?"captured":this.moved.some(function(t){return t.equals(e)})?"moved":""}},{key:"getPieceClass",value:function(e){var t=this.getPiece(e);return this.getPlayerClass(ote.of(t.value))}},{key:"getSidePieceClass",value:function(e){return this.getPlayerClass(ote.of(e))}}]),n}(fre);return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-gipf"]],features:[jC],decls:11,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -12 708 854","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved","moved-stroke"],[4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),pb(1,"defs"),pb(2,"marker",1),yb(3,"polygon",2),gb(),pb(4,"marker",3),yb(5,"polygon",4),gb(),gb(),lb(6,sue,4,7,"g",5),lb(7,cue,2,1,"g",6),lb(8,lue,2,4,"g",5),lb(9,fue,2,1,"g",5),lb(10,due,1,4,"line",7),gb()),2&e&&(Rw(6),db("ngForOf",t.getAllCoords()),Rw(1),db("ngForOf",t.possibleCaptures),Rw(1),db("ngForOf",t.arrows),Rw(1),db("ngForOf",oP(5,vue)),Rw(1),db("ngIf",t.inserted.isPresent()))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),gue=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"equals",value:function(e){return this===e||this.coord.equals(e.coord)}},{key:"toString",value:function(){return this===n.PASS?"GoMove.PASS":this===n.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Tre);gue.PASS=new gue(-1,0),gue.ACCEPT=new gue(-2,0),gue.PASS_NUMBER=-1,gue.ACCEPT_NUMBER=-2,gue.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 360}},{key:"encodeNumber",value:function(e){return 19*e.coord.y+e.coord.x}},{key:"decodeNumber",value:function(e){if(e===gue.PASS_NUMBER)return gue.PASS;var t=e%19;return new gue(t,(e-t)/19)}}]),n}(rte));var yue=function(){function e(t,n){sp(this,e),this.player=t,this.type=n}return cp(e,[{key:"equals",value:function(e){return e===this}},{key:"toString",value:function(){switch(this){case e.BLACK:return"GoPiece.BLACK";case e.WHITE:return"GoPiece.WHITE";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_BLACK:return"GoPiece.DEAD_BLACK";case e.DEAD_WHITE:return"GoPiece.DEAD_WHITE";case e.BLACK_TERRITORY:return"GoPiece.BLACK_TERRITORY";default:return a6(this===e.WHITE_TERRITORY,"Unexisting GoPiece"),"GoPiece.WHITE_TERRITORY"}}},{key:"isOccupied",value:function(){return[e.BLACK,e.WHITE,e.DEAD_BLACK,e.DEAD_WHITE].includes(this)}},{key:"isEmpty",value:function(){return[e.BLACK_TERRITORY,e.WHITE_TERRITORY,e.EMPTY].includes(this)}},{key:"isDead",value:function(){return[e.DEAD_BLACK,e.DEAD_WHITE].includes(this)}},{key:"isTerritory",value:function(){return[e.BLACK_TERRITORY,e.WHITE_TERRITORY].includes(this)}},{key:"getOwner",value:function(){return this.player}},{key:"nonTerritory",value:function(){return a6(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}],[{key:"pieceBelongTo",value:function(e,t){return t===e.player&&"territory"!==e.type}},{key:"ofPlayer",value:function(t){return t===ote.ZERO?e.BLACK:e.WHITE}}]),e}();yue.BLACK=new yue(ote.ZERO,"alive"),yue.WHITE=new yue(ote.ONE,"alive"),yue.EMPTY=new yue(ate.NONE,"empty"),yue.DEAD_BLACK=new yue(ote.ZERO,"dead"),yue.DEAD_WHITE=new yue(ote.ONE,"dead"),yue.BLACK_TERRITORY=new yue(ate.NONE,"territory"),yue.WHITE_TERRITORY=new yue(ate.NONE,"territory");var mue=(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(mue||(mue={})),mue),kue=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o){var s;return sp(this,n),(s=t.call(this,e,i)).captured=r,s.koCoord=a,s.phase=o,s}return cp(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}},{key:"copy",value:function(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}},{key:"isDead",value:function(e){return this.getPieceAt(e).isDead()}},{key:"isTerritory",value:function(e){return this.getPieceAt(e).isTerritory()}}],[{key:"getInitialState",value:function(){var e=n.getStartingBoard();return new n(e,[0,0],0,hB.empty(),mue.PLAYING)}},{key:"getStartingBoard",value:function(){return lte.createTable(n.WIDTH,n.HEIGHT,yue.EMPTY)}}]),n}(Sre);return e.WIDTH=13,e.HEIGHT=13,e}(),_ue=function(){var e=function(){function e(t){sp(this,e),this.color=t}return cp(e,[{key:"selfContains",value:function(e){return this.getCoords().some(function(t){return t.equals(e)})}}],[{key:"insertAsEntryPoint",value:function(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}]),e}();return e.VERBOSE=!1,e}(),wue=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s){var u;return sp(this,n),(u=t.call(this,e)).emptyCoords=r,u.blackCoords=i,u.whiteCoords=a,u.deadBlackCoords=o,u.deadWhiteCoords=s,u}return cp(n,[{key:"getCoords",value:function(){return this.color===yue.BLACK?this.blackCoords:this.color===yue.WHITE?this.whiteCoords:this.color===yue.DEAD_BLACK?this.deadBlackCoords:this.color===yue.DEAD_WHITE?this.deadWhiteCoords:this.emptyCoords}},{key:"contains",value:function(e){return this.blackCoords.concat(this.whiteCoords.concat(this.emptyCoords.concat(this.deadBlackCoords.concat(this.deadWhiteCoords)))).some(function(t){return t.equals(e)})}},{key:"addPawn",value:function(e,t){if(this.contains(e))throw new Error("This group already contains "+e);switch(t){case yue.BLACK:this.blackCoords=_ue.insertAsEntryPoint(this.blackCoords,e);break;case yue.WHITE:this.whiteCoords=_ue.insertAsEntryPoint(this.whiteCoords,e);break;case yue.DEAD_BLACK:this.deadBlackCoords=_ue.insertAsEntryPoint(this.deadBlackCoords,e);break;case yue.DEAD_WHITE:this.deadWhiteCoords=_ue.insertAsEntryPoint(this.deadWhiteCoords,e);break;default:oB.expectToBeMultiple(t,[yue.EMPTY,yue.BLACK_TERRITORY,yue.WHITE_TERRITORY]),this.emptyCoords=_ue.insertAsEntryPoint(this.emptyCoords,e)}}},{key:"isMonoWrapped",value:function(){return(0===this.emptyCoords.length?1:2)*(this.blackCoords.length+this.deadWhiteCoords.length===0?1:2)*(this.whiteCoords.length+this.deadBlackCoords.length===0?1:2)==4}},{key:"getWrapper",value:function(){var e=new Are;e.set(yue.EMPTY,this.emptyCoords.length),e.set(yue.BLACK,this.blackCoords.length+this.deadWhiteCoords.length),e.set(yue.WHITE,this.whiteCoords.length+this.deadBlackCoords.length),e.put(this.color.nonTerritory(),0);var t=e.filter(function(e,t){return t>0});if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}},{key:"getNeighboorsEntryPoint",value:function(){var e=[];return this.color!==yue.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==yue.BLACK&&this.blackCoords.length>0&&e.push(this.blackCoords[0]),this.color!==yue.WHITE&&this.whiteCoords.length>0&&e.push(this.whiteCoords[0]),this.color!==yue.DEAD_BLACK&&this.deadBlackCoords.length>0&&e.push(this.deadBlackCoords[0]),this.color!==yue.DEAD_WHITE&&this.deadWhiteCoords.length>0&&e.push(this.deadWhiteCoords[0]),e}}]),n}(_ue),Cue=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getNewInstance",value:function(e){return new wue(e,[],[],[],[],[])}},{key:"getDirections",value:function(){return cre.ORTHOGONALS}}]),n}(function(){function e(){sp(this,e)}return cp(e,[{key:"getGroupDatas",value:function(e,t){sB(_ue.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");var n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}},{key:"_getGroupDatas",value:function(e,t,n){sB(_ue.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});var r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color){var i,a=ip(this.getDirections());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getNext(o);s.isInRange(t[0].length,t.length)&&(n.contains(s)||(n=this._getGroupDatas(s,t,n)))}}catch(u){a.e(u)}finally{a.f()}}return n}}]),e}()),bue=function(){var e=cp(function e(){sp(this,e)});return e.ILLEGAL_KO=function(){return $localize(Ni||(Ni=Vv(["This move is a ko, you must play somewhere else before you can play in this intersection again."])))},e.CANNOT_PASS_AFTER_PASSED_PHASE=function(){return $localize(Mi||(Mi=Vv(["We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn."])))},e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=function(){return $localize(Di||(Di=Vv(["You cannot accept before the counting phase."])))},e.OCCUPIED_INTERSECTION=function(){return $localize(Li||(Li=Vv(["This intersection is already occupied."])))},e.CANNOT_COMMIT_SUICIDE=function(){return $localize(Fi||(Fi=Vv(["You cannot commit suicide."])))},e}(),Eue=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,r){return sB(n.VERBOSE,{applyLegalMove:{legalMove:e,state:t,status:r}}),n.isPass(e)?(sB(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(t)):n.isAccept(e)?(sB(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(t)):n.isLegalDeadMarking(e,t)?(sB(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,t)):(sB(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(t,e,r))}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=!1;if(sB(n.VERBOSE||r,{isLegal:{move:e,state:t}}),n.isPass(e)){var i=t.phase===mue.PLAYING,a=t.phase===mue.PASSED;return sB(n.VERBOSE||r,"GoRules.isLegal at "+t.phase+(i||a?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),i||a?J5.success([]):J5.failure(bue.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){var o=t.phase===mue.ACCEPT;return t.phase===mue.COUNTING||o?J5.success([]):J5.failure(bue.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,t.getCopiedBoard())?(sB(n.VERBOSE||r,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,t)?J5.success([]):J5.failure(bue.OCCUPIED_INTERSECTION())):(sB(n.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,t))}},{key:"getNewKo",value:function(e,t,n){if(1===n.length){var r=n[0],i=e.coord,a=t[i.y][i.x],o=(new Cue).getGroupDatas(i,t),s=o.emptyCoords,u=yue.pieceBelongTo(a,ote.ZERO)?o.blackCoords:o.whiteCoords;if(1===s.length&&s[0].equals(r)&&1===u.length)return hB.of(r)}return hB.empty()}},{key:"markTerritoryAndCount",value:function(e){sB(n.VERBOSE,{markTerritoryAndCount:{state:e}});var t,r=e.getCopiedBoard(),i=n.getTerritoryLikeGroup(e),a=e.getCapturedCopy(),o=ip(i);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.getWrapper();if(u===yue.WHITE){a[1]+=s.emptyCoords.length;var c,l=ip(s.getCoords());try{for(l.s();!(c=l.n()).done;){var h=c.value;r[h.y][h.x]=yue.WHITE_TERRITORY}}catch(p){l.e(p)}finally{l.f()}}else{a6(u===yue.BLACK,"territory should be wrapped by black or white, not by "+u.toString()),a[0]+=s.emptyCoords.length;var f,d=ip(s.getCoords());try{for(d.s();!(f=d.n()).done;){var v=f.value;r[v.y][v.x]=yue.BLACK_TERRITORY}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){o.e(p)}finally{o.f()}return new kue(r,a,e.turn,e.koCoord,e.phase)}},{key:"removeAndSubstractTerritory",value:function(e){for(var t,n=e.getCopiedBoard(),r=e.getCapturedCopy(),i=0;i<e.board.length;i++)for(var a=0;a<e.board[0].length;a++)(t=n[i][a])===yue.BLACK_TERRITORY?(n[i][a]=yue.EMPTY,r[0]=r[0]-1):t===yue.WHITE_TERRITORY&&(n[i][a]=yue.EMPTY,r[1]=r[1]-1);return new kue(n,r,e.turn,e.koCoord,e.phase)}},{key:"getEmptyZones",value:function(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),function(e){return e.isEmpty()})}},{key:"getGroupsDatasWhere",value:function(e,t){for(var n,r,i=[],a=new Cue,o=0;o<e.length;o++)for(var s=0;s<e[0].length;s++)n=new lre(s,o),t(e[o][s])&&(i.some(function(e){return e.selfContains(n)})||(r=a.getGroupDatas(n,e),i.push(r)));return i}},{key:"addDeadToScore",value:function(e){for(var t,n=e.getCapturedCopy(),r=n[1],i=n[0],a=0;a<e.board.length;a++)for(var o=0;o<e.board[0].length;o++)(t=e.getPieceAtXY(o,a))===yue.DEAD_BLACK?r++:t===yue.DEAD_WHITE&&i++;return[i,r]}},{key:"switchAliveness",value:function(e,t){var n=t.getCopiedBoard();a6(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");var r=(new Cue).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case yue.DEAD_BLACK:i[1]-=2*r.deadBlackCoords.length;var a,o=ip(r.deadBlackCoords);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s.y][s.x]=yue.BLACK}}catch(y){o.e(y)}finally{o.f()}break;case yue.DEAD_WHITE:i[0]-=2*r.deadWhiteCoords.length;var u,c=ip(r.deadWhiteCoords);try{for(c.s();!(u=c.n()).done;){var l=u.value;n[l.y][l.x]=yue.WHITE}}catch(y){c.e(y)}finally{c.f()}break;case yue.WHITE:i[0]+=2*r.whiteCoords.length;var h,f=ip(r.whiteCoords);try{for(f.s();!(h=f.n()).done;){var d=h.value;n[d.y][d.x]=yue.DEAD_WHITE}}catch(y){f.e(y)}finally{f.f()}break;default:oB.expectToBe(r.color,yue.BLACK),i[1]+=2*r.blackCoords.length;var v,p=ip(r.blackCoords);try{for(p.s();!(v=p.n()).done;){var g=v.value;n[g.y][g.x]=yue.DEAD_BLACK}}catch(y){p.e(y)}finally{p.f()}}return new kue(n,i,t.turn,t.koCoord,t.phase)}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.phase===mue.FINISHED?t.captured[0]>t.captured[1]?Dre.ZERO_WON:t.captured[1]>t.captured[0]?Dre.ONE_WON:Dre.DRAW:Dre.ONGOING}},{key:"isPass",value:function(e){return e.equals(gue.PASS)}},{key:"isAccept",value:function(e){return e.equals(gue.ACCEPT)}},{key:"isLegalDeadMarking",value:function(e,t){return n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===mue.COUNTING||t.phase===mue.ACCEPT)}},{key:"isLegalNormalMove",value:function(e,t){var r=t.getCopiedBoard();if(n.isKo(e,t))return J5.failure(bue.ILLEGAL_KO());[mue.COUNTING,mue.ACCEPT].includes(t.phase)&&(t=n.resurrectStones(t));var i=n.getCaptureState(e,t);if(Sue.isCapturing(i))return J5.success(i.capturedCoords);r[e.coord.y][e.coord.x]=t.turn%2==0?yue.BLACK:yue.WHITE;var a=0===(new Cue).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=yue.EMPTY,a?J5.failure(bue.CANNOT_COMMIT_SUICIDE()):J5.success([])}},{key:"isOccupied",value:function(e,t){return t[e.y][e.x].isOccupied()}},{key:"isKo",value:function(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}},{key:"getCaptureState",value:function(e,t){sB(n.VERBOSE||!1,{getCaptureState:{move:e,state:t}});var r,i,a=new Sue,o=ip(cre.ORTHOGONALS);try{for(o.s();!(i=o.n()).done;){var s=i.value;(r=n.getCapturedInDirection(e.coord,s,t)).length>0&&a.capturedCoords.every(function(e){return!r[0].equals(e)})&&(a.capturedCoords=a.capturedCoords.concat(r))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getCapturedInDirection",value:function(e,t,r){var i=r.getCopiedBoard(),a=e.getNext(t);if(a.isInRange(r.board[0].length,r.board.length)&&i[a.y][a.x]===(r.turn%2==0?yue.WHITE:yue.BLACK)){sB(n.VERBOSE||!1,"a group could be captured");var o=(new Cue).getGroupDatas(a,i);if(n.isCapturableGroup(o,r.koCoord))return sB(n.VERBOSE||!1,{neightbooringGroupCoord:o.getCoords(),message:"is capturable"}),o.getCoords()}return[]}},{key:"isCapturableGroup",value:function(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}},{key:"getTerritoryLikeGroup",value:function(e){return n.getEmptyZones(e).filter(function(e){return e.isMonoWrapped()})}},{key:"applyPass",value:function(e){var t,r,i=e.getCopiedBoard(),a=e.getCapturedCopy(),o=e.turn;return e.phase===mue.PASSED?(t=mue.COUNTING,r=new kue(i,a,o+1,hB.empty(),t),r=n.markTerritoryAndCount(r)):(a6(e.phase===mue.PLAYING,"Cannot pass in counting phase!"),t=mue.PASSED,r=new kue(i,a,o+1,hB.empty(),t)),r}},{key:"applyLegalAccept",value:function(e){var t,n=e.getCopiedBoard();return t=e.phase===mue.COUNTING?mue.ACCEPT:mue.FINISHED,new kue(n,e.getCapturedCopy(),e.turn+1,hB.empty(),t)}},{key:"applyNormalLegalMove",value:function(e,t,r){var i;sB(n.VERBOSE,{applyNormalLegal:{currentState:e,legalMove:t,status:status}}),i=[mue.COUNTING,mue.ACCEPT].includes(e.phase)?n.resurrectStones(e):e.copy();var a=t.coord.x,o=t.coord.y,s=i.getCopiedBoard(),u=i.turn,c=yue.ofPlayer(i.getCurrentPlayer()),l=u+1;s[o][a]=c;var h,f=ip(r);try{for(f.s();!(h=f.n()).done;){var d=h.value;s[d.y][d.x]=yue.EMPTY}}catch(g){f.e(g)}finally{f.f()}var v=n.getNewKo(t,s,r),p=i.getCapturedCopy();return p[c.player.value]+=r.length,new kue(s,p,l,v,mue.PLAYING)}},{key:"resurrectStones",value:function(e){for(var t=0;t<e.board.length;t++)for(var r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=n.switchAliveness(new lre(r,t),e));return n.removeAndSubstractTerritory(e)}},{key:"applyDeadMarkingMove",value:function(e,t){sB(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:t}});var r=n.removeAndSubstractTerritory(t),i=n.switchAliveness(e.coord,r),a=new kue(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,hB.empty(),mue.COUNTING);return n.markTerritoryAndCount(a)}}]),n}(Lre);return e.VERBOSE=!1,e}(),Sue=function(){function e(){sp(this,e),this.capturedCoords=[]}return cp(e,null,[{key:"isCapturing",value:function(e){return e.capturedCoords.length>0}}]),e}(),Pue=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){sB(Eue.VERBOSE||!1,"GoRules.getListMoves");var t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===mue.PLAYING||t.phase===mue.PASSED)return n.push(gue.PASS),n;sB(Eue.VERBOSE||!1,"GoRules.getListMoves in counting phase");var r=this.getCountingMovesList(t);return 0===r.length?[gue.ACCEPT]:r}},{key:"getPlayingMovesList",value:function(e){for(var t,n=[],r=0;r<e.board.length;r++)for(var i=0;i<e.board[0].length;i++)t=new gue(i,r),e.getPieceAt(t.coord)===yue.EMPTY&&Eue.isLegal(t,e).isSuccess()&&n.push(t);return n}},{key:"getCountingMovesList",value:function(e){var t,n=[],r=this.getCorrectBoard(e).getCopiedBoard(),i=ip(Eue.getGroupsDatasWhere(r,function(e){return e!==yue.EMPTY}));try{for(i.s();!(t=i.n()).done;){var a=t.value.getCoords()[0],o=r[a.y][a.x];if(e.getPieceAt(a)!==o){var s=new gue(a.x,a.y);return n.push(s),n}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getCorrectBoard",value:function(e){var t=this.mapBoard(e.getCopiedBoard(),function(e){return e===yue.BLACK?yue.DEAD_BLACK:e===yue.WHITE?yue.DEAD_WHITE:e.isTerritory()?yue.EMPTY:e}),n=new kue(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=Eue.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}},{key:"mapBoard",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}},{key:"setAliveUniqueWrapper",value:function(e,t){var n,r=e.copy(),i=ip(t);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=ip(o.deadBlackCoords.concat(o.deadWhiteCoords));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.isDead(u)&&(r=Eue.switchAliveness(u,r))}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Eue.getGameStatus(e);if(n.isEndGame)return new wre(n.toBoardValue());sB(Eue.VERBOSE||!1,"GoRules.getBoardValue");var r=Eue.markTerritoryAndCount(t),i=r.getCapturedCopy(),a=this.getDeadStones(r);return new wre(i[1]+2*a[0]-(i[0]+2*a[1]))}},{key:"getDeadStones",value:function(e){for(var t=[0,0],n=0;n<e.board.length;n++)for(var r=0;r<e.board[0].length;r++){var i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}]),n}(_re),Oue=yue.WHITE,Tue=yue.BLACK,Iue=yue.DEAD_WHITE,xue=yue.WHITE_TERRITORY,Aue=yue.BLACK_TERRITORY,Rue=yue.EMPTY,Nue=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(Bi||(Bi=Vv(["Preliminary information"]))),$localize(Ui||(Ui=Vv(["The game of Go is played on a board called a Goban, and the stones are placed on the intersections.\n        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.\n        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).\n        For this tutorial, we will use a smaller board for pedagogical purposes."]))),kue.getInitialState()),Vre.informational($localize(Vi||(Vi=Vv(["Goal of the game"]))),$localize(zi||(zi=Vv(["The goal of the game is to have the most points at the end of the game.\n        We call \"territories\" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.\n        Here, Dark has 9 territories on the left, and Light has 8 on the right.\n        The top part belongs to no one.\n        Each player's score at the end of the game is the sum of that player's territories and captures."]))),new kue([[Rue,Tue,Rue,Rue,Oue,Oue],[Rue,Tue,Rue,Rue,Oue,Rue],[Rue,Tue,Tue,Oue,Oue,Rue],[Rue,Rue,Tue,Oue,Rue,Rue],[Rue,Rue,Tue,Oue,Rue,Rue],[Rue,Rue,Tue,Oue,Rue,Rue]],[0,0],0,hB.empty(),mue.PLAYING)),Vre.fromMove($localize(Hi||(Hi=Vv(["Simple capture"]))),$localize(Gi||(Gi=Vv(["An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).\n        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.\n        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>\n        The light piece only has one liberty left, play there."]))),new kue([[Rue,Rue,Rue,Rue,Rue],[Rue,Rue,Tue,Rue,Rue],[Rue,Tue,Oue,Rue,Rue],[Rue,Rue,Tue,Rue,Rue],[Rue,Rue,Rue,Rue,Rue]],[0,0],0,hB.empty(),mue.PLAYING),[new gue(3,2)],$localize(qi||(qi=Vv(["Congratulations, you have earned one point."]))),$localize($i||($i=Vv(["Failed, try again by playing on one of the intersections directly next to the light stone."])))),Vre.fromMove($localize(Wi||(Wi=Vv(["Capturing multiple stones"]))),$localize(ji||(ji=Vv(["Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>\n        The light group here only has one liberty left, capture it."]))),new kue([[Rue,Tue,Rue,Rue,Rue],[Tue,Oue,Rue,Rue,Rue],[Tue,Oue,Oue,Tue,Rue],[Rue,Tue,Tue,Rue,Rue],[Rue,Rue,Rue,Rue,Rue]],[0,0],0,hB.empty(),mue.PLAYING),[new gue(2,1)],$localize(Zi||(Zi=Vv(["Congratulations, you have earned three points and formed a territory."]))),$localize(Yi||(Yi=Vv(["Failed, you have not captured the group. Play on the last liberty of that group."])))),Vre.informational($localize(Ki||(Ki=Vv(["Suicide"]))),$localize(Ji||(Ji=Vv(["In Go, suicide is forbidden.\n        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.\n        Here, the top left intersection is a suicide for Light.\n        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player."]))),new kue([[Rue,Tue,Rue,Rue,Rue],[Tue,Rue,Rue,Rue,Rue],[Tue,Rue,Rue,Rue,Oue],[Oue,Tue,Rue,Oue,Rue],[Rue,Oue,Rue,Oue,Tue]],[0,0],0,hB.empty(),mue.PLAYING)),Vre.informational($localize(Qi||(Qi=Vv(["Life and death (death)"]))),$localize(Xi||(Xi=Vv(["From the capture rule follows the life and death notion:\n        dead stones are stones that are definitely capturable (without losing anything else).\n        Alive stones are stones that can never be captured.\n        From the capture rule, Dark can play inside Light's territory and make a capture.\n        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).\n        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories."]))),new kue([[Rue,Rue,Rue,Rue,Rue],[Tue,Tue,Tue,Rue,Rue],[Oue,Oue,Tue,Rue,Rue],[Rue,Oue,Tue,Rue,Rue],[Oue,Oue,Tue,Rue,Rue]],[0,0],0,hB.empty(),mue.PLAYING)),Vre.informational($localize(ea||(ea=Vv(["Life and death (eyes)"]))),$localize(ta||(ta=Vv(["Here, Light cannot play on the top left, nor on the bottom left.\n        Light will never be able to capture Dark.\n        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive."]))),new kue([[Rue,Tue,Oue,Rue,Rue],[Oue,Tue,Oue,Rue,Rue],[Tue,Tue,Oue,Rue,Rue],[Oue,Tue,Oue,Rue,Rue],[Rue,Tue,Oue,Rue,Rue]],[0,0],0,hB.empty(),mue.PLAYING)),Vre.informational($localize(na||(na=Vv(["Seki"]))),$localize(ra||(ra=Vv(["If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.\n        Similarly, if Light plays on the middle line, Dark will capture Light.\n        In other words, there is no point in playing on the middle line.\n        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral."]))),new kue([[Rue,Oue,Tue,Rue,Oue,Tue,Rue],[Rue,Oue,Tue,Tue,Oue,Tue,Rue],[Rue,Oue,Tue,Tue,Oue,Tue,Rue],[Rue,Oue,Tue,Tue,Oue,Tue,Rue],[Rue,Oue,Tue,Oue,Oue,Tue,Rue],[Rue,Oue,Tue,Oue,Oue,Tue,Rue],[Rue,Oue,Tue,Rue,Oue,Tue,Rue]],[0,0],0,hB.empty(),mue.PLAYING)),Vre.fromMove($localize(ia||(ia=Vv(["Ko"]))),$localize(aa||(aa=Vv(["A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>\n        Capture the light stone."]))),new kue([[Rue,Rue,Rue,Rue,Rue,Rue,Rue],[Rue,Rue,Rue,Rue,Rue,Rue,Rue],[Rue,Rue,Rue,Tue,Oue,Rue,Rue],[Rue,Rue,Tue,Oue,Rue,Oue,Rue],[Rue,Rue,Rue,Tue,Oue,Rue,Rue],[Rue,Rue,Rue,Rue,Rue,Rue,Rue],[Rue,Rue,Rue,Rue,Rue,Rue,Rue]],[0,0],0,hB.empty(),mue.PLAYING),[new gue(4,3)],$localize(oa||(oa=Vv(["Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.\n        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.\n        This rule is called the Ko.\n        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after."]))),$localize(sa||(sa=Vv(["Failed!"])))),Vre.fromMove($localize(ua||(ua=Vv(["End of the game"]))),$localize(ca||(ca=Vv(["When a player feels that there is no advantage to putting a new stone, that player can pass a turn.\n        The game phase stops when both players pass consecutively, and we move on to the counting phase.\n        The dead groups are then marked by clicking on them.\n        Every intersection in a player's territory earns that player a point.\n        The winner is the one with most points.<br/><br/>\n        A last stone is dead, mark it."]))),new kue([[Oue,Tue,Tue,Tue,Tue,Tue,Aue,Aue,Aue],[Oue,Oue,Oue,Oue,Tue,Tue,Tue,Aue,Aue],[Oue,xue,Oue,Oue,Tue,Iue,Iue,Tue,Aue],[Tue,Oue,Oue,Oue,Oue,Tue,Aue,Aue,Aue],[Rue,Oue,xue,Oue,Tue,Tue,Iue,Tue,Aue],[Oue,xue,Oue,Oue,Tue,Tue,Tue,Tue,Tue],[Oue,Oue,Tue,Tue,Tue,Oue,Oue,Tue,Oue],[Tue,Tue,Tue,Oue,Oue,Oue,xue,Oue,Oue],[Aue,Aue,Tue,Tue,Tue,Oue,Oue,xue,xue]],[0,0],0,hB.empty(),mue.COUNTING),[new gue(0,3)],$localize(la||(la=Vv(["Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.\n        The intersections where the prisoners are count as Dark's territory\n        Light has 8 territories and 1 prisoner.\n        The end result is therefore 18 - 9 for Dark."]))),$localize(ha||(ha=Vv(["Failed, try again."]))))]});function Mue(e,t){if(1&e&&(Pm(),yb(0,"circle",10)),2&e){var n=Pb(2).index,r=Pb().index;ob("cx",25+50*n)("cy",25+50*r)("r",22)}}function Due(e,t){if(1&e){var n=_b();Pm(),pb(0,"line",11),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb()}if(2&e){var r=Pb(2).index,i=Pb().index;ob("x1",50*r)("y1",50*i)("x2",50+50*r)("y2",50+50*i)}}function Lue(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"circle",7),bb("click",function(){Jy(n);var e=Pb().index,t=Pb().index;return Pb().onClick(e,t)}),gb(),lb(2,Mue,1,3,"circle",8),lb(3,Due,1,4,"line",9),gb()}if(2&e){var r=Pb().index,i=Pb().index,a=Pb();Rw(1),db("ngClass",a.getSpaceClass(r,i)),ob("cx",25+50*r)("cy",25+50*i)("r",22),Rw(1),db("ngIf",a.isLastCase(r,i)),Rw(1),db("ngIf",a.isDead(r,i))}}function Fue(e,t){if(1&e){var n=_b();Pm(),pb(0,"circle",15),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb()}if(2&e){var r=Pb(2),i=r.index,a=r.$implicit,o=Pb().index,s=Pb();ob("cx",25+50*i)("cy",25+50*o)("r",10)("class",a===s.GoPiece.WHITE_TERRITORY?"player1":"player0")}}function Bue(e,t){if(1&e){var n=_b();Pm(),pb(0,"rect",12),bb("click",function(){Jy(n);var e=Pb().index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(1,"line",13),bb("click",function(){Jy(n);var e=Pb().index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(2,"line",13),bb("click",function(){Jy(n);var e=Pb().index,t=Pb().index;return Pb().onClick(e,t)}),gb(),lb(3,Fue,1,4,"circle",14)}if(2&e){var r=Pb().index,i=Pb().index,a=Pb();Ib("id","click_",r,"_",i,""),ob("x",50*r)("y",50*i),Rw(1),ob("x1",50*r)("y1",25+50*i)("x2",50+50*r)("y2",25+50*i),Rw(1),ob("x1",25+50*r)("y1",50*i)("x2",25+50*r)("y2",50+50*i),Rw(1),db("ngIf",a.isTerritory(r,i))}}function Uue(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Lue,4,6,"g",5),lb(2,Bue,4,13,"ng-template",null,6,NP),gb()),2&e){var n=t.index,r=hb(3),i=Pb().index,a=Pb();Rw(1),db("ngIf",a.caseIsFull(n,i))("ngIfElse",r)}}function Vue(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Uue,4,2,"g",2),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function zue(e,t){if(1&e&&(Pm(),yb(0,"rect",16)),2&e){var n=Pb();ob("x",12.5+50*n.ko.get().x)("y",12.5+50*n.ko.get().y)}}function Hue(e,t){if(1&e){var n=_b();Pm(),pb(0,"circle",17),bb("click",function(){var e=Jy(n).$implicit;return Pb().onClick(e.x,e.y)}),gb()}if(2&e){var r=t.$implicit;ob("cx",25+50*r.x)("cy",25+50*r.y)("r",7)}}var Gue=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).ko=hB.empty(),r.last=hB.empty(),r.captures=[],r.GoPiece=yue,r.scores=hB.of([0,0]),r.rules=new Eue(kue),r.availableMinimaxes=[new Pue(r.rules,"GoMinimax")],r.encoder=gue.encoder,r.tutorial=(new Nue).tutorial,r.canPass=!0,r.updateBoard(),r}return cp(n,[{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.last=hB.empty(),a=new gue(e,t),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){sB(n.VERBOSE,"updateBoard");var e=this.rules.node.gameState,t=this.rules.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=hB.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(function(e){return e.coord}),this.canPass=r!==mue.FINISHED}},{key:"showCaptures",value:function(){var e=this.rules.node.mother.get().gameState;this.captures=[];for(var t=0;t<this.board.length;t++)for(var n=0;n<this.board[0].length;n++){var r=new lre(n,t),i=!1===e.getPieceAt(r).isEmpty(),a=this.board[t][n]===yue.EMPTY,o=!1===this.ko.equalsValue(r);i&&a&&o&&this.captures.push(r)}}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.rules.node.gameState.phase,t.abrupt("return",n===mue.PLAYING||n===mue.PASSED?e.onClick(gue.PASS.coord.x,gue.PASS.coord.y):(a6(n===mue.COUNTING||n===mue.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(gue.ACCEPT.coord.x,gue.ACCEPT.coord.y)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getSpaceClass",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}},{key:"caseIsFull",value:function(e,t){return this.rules.node.gameState.getPieceAtXY(e,t)!==yue.EMPTY&&!this.isTerritory(e,t)}},{key:"isLastCase",value:function(e,t){if(this.last.isPresent()){var n=this.last.get();return e===n.x&&t===n.y}return!1}},{key:"isDead",value:function(e,t){return this.rules.node.gameState.isDead(new lre(e,t))}},{key:"isTerritory",value:function(e,t){return this.rules.node.gameState.isTerritory(new lre(e,t))}}]),n}(wie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-go"]],features:[jC],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke highlighted",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","highlighted"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured",3,"click"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),yb(1,"rect",1),lb(2,Vue,2,1,"g",2),lb(3,zue,1,2,"rect",3),lb(4,Hue,1,3,"circle",4),gb()),2&e&&(ob("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),Rw(1),ob("width",50*t.board.length)("height",50*t.board.length),Rw(1),db("ngForOf",t.board),Rw(1),db("ngIf",t.ko.isPresent()),Rw(1),db("ngForOf",t.captures))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),que=function(){function e(t,n,r){sp(this,e),this.value=t,this.name=n,this.rgb=r}return cp(e,null,[{key:"of",value:function(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return oB.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}]),e}();que.ANY=new que(0,"any","#000"),que.ORANGE=new que(1,"orange","#d67421"),que.BLUE=new que(2,"blue","#006bac"),que.PURPLE=new que(3,"purple","#6f3787"),que.PINK=new que(4,"pink","#d2719e"),que.YELLOW=new que(5,"yellow","#e2c200"),que.RED=new que(6,"red","#d23339"),que.GREEN=new que(7,"green","#009157"),que.BROWN=new que(8,"brown","#562500");var $ue=function(){function e(t,n){sp(this,e),this.player=t,this.color=n}return cp(e,[{key:"equals",value:function(e){return e.player===this.player&&e.color===this.color}},{key:"isEmpty",value:function(){return this.player.equals(ate.NONE)}},{key:"belongsTo",value:function(e){return this.player===e}}],[{key:"of",value:function(t,n){return new e(t,que.of(n))}},{key:"createPlayerColors",value:function(t){return{ORANGE:new e(t,que.ORANGE),BLUE:new e(t,que.BLUE),PURPLE:new e(t,que.PURPLE),PINK:new e(t,que.PINK),YELLOW:new e(t,que.YELLOW),RED:new e(t,que.RED),GREEN:new e(t,que.GREEN),BROWN:new e(t,que.BROWN)}}}]),e}();$ue.NONE=new $ue(ate.NONE,que.ANY),$ue.ZERO=$ue.createPlayerColors(ote.ZERO),$ue.ONE=$ue.createPlayerColors(ote.ONE);var Wue=function(){function e(){sp(this,e)}return cp(e,null,[{key:"getColorAt",value:function(t,n){return e.COLORS[n][t]}},{key:"getInitialBoard",value:function(){var e=$ue.NONE;return[[1,2,3,4,5,6,7,8].map(function(e){return $ue.of(ote.ONE,e)}),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(function(e){return $ue.of(ote.ZERO,e)})]}},{key:"isEmptyAt",value:function(e,t){return e[t.y][t.x].equals($ue.NONE)}},{key:"allPieceCoords",value:function(t){for(var n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){var a=new lre(i,r);e.isEmptyAt(t,a)||n.push(a)}return n}}]),e}();Wue.INITIAL=Wue.getInitialBoard(),Wue.SIZE=8,Wue.COLORS=lte.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],que.of);var jue=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,r)}return cp(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return this===n.PASS?"KamisadoMove(PASS)":"KamisadoMove("+this.coord+"->"+this.end+")"}}],[{key:"of",value:function(e,t){if(e.isNotInRange(Wue.SIZE,Wue.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(Wue.SIZE,Wue.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new n(e,t)}}]),n}(Aie);jue.PASS=new jue(new lre(-2,-2),new lre(-3,-3)),jue.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 34952}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return jue.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new jue(new lre((e=e/16|0)%16,r),new lre(n,t))}}]),n}(rte));var Zue=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o){var s;return sp(this,n),(s=t.call(this,lte.copyBiArray(o),e)).colorToPlay=r,s.coordToPlay=i,s.alreadyPassed=a,s}return cp(n,null,[{key:"getInitialState",value:function(){return new n(0,que.ANY,hB.empty(),!1,Wue.INITIAL)}}]),n}(Sre),Yue=function(){var e=cp(function e(){sp(this,e)});return e.NOT_RIGHT_COLOR=function(){return $localize(fa||(fa=Vv(["This piece is not of the color you have to play."])))},e.DIRECTION_NOT_ALLOWED=function(){return $localize(da||(da=Vv(["You can only move forward, orthogonally or diagonally."])))},e.MOVE_BLOCKED=function(){return $localize(va||(va=Vv(["This move is blocked by another piece."])))},e.PLAY_WITH_SELECTED_PIECE=function(){return $localize(pa||(pa=Vv(["You must play with the selected piece."])))},e}(),Kue=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"nextCoordToPlay",value:function(e,t){return hB.ofNullable(Wue.allPieceCoords(e.board).find(function(n){var r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}},{key:"applyLegalMove",value:function(e,t,n){if(e===jue.PASS){var r=this.nextCoordToPlay(t,t.colorToPlay);return new Zue(t.turn+1,t.colorToPlay,r,!0,t.board)}var i=e.coord,a=e.end,o=t.getCopiedBoard();o[a.y][a.x]=o[i.y][i.x],o[i.y][i.x]=$ue.NONE;var s=Wue.getColorAt(a.x,a.y),u=this.nextCoordToPlay(t,s);return new Zue(t.turn+1,s,u,!1,o)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=t.getCurrentPlayer();if(n.mustPass(t)&&t.alreadyPassed)return Dre.getDefeat(r);var i=Hv(n.getFurthestPiecePositions(t),2),a=i[0];return 7===i[1]?Dre.ONE_WON:0===a?Dre.ZERO_WON:Dre.ONGOING}}],[{key:"getColorMatchingPiece",value:function(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new lre(0,7),new lre(1,7),new lre(2,7),new lre(3,7),new lre(4,7),new lre(5,7),new lre(6,7),new lre(7,7)]}},{key:"getMovablePieces",value:function(e){var t=this;return n.getColorMatchingPiece(e).filter(function(n){var r,i=ip(t.playerDirections(e.getCurrentPlayer()));try{for(i.s();!(r=i.n()).done;){var a=r.value,o=n.getNext(a);if(e.isOnBoard(o)&&Wue.isEmptyAt(e.board,o))return!0}}catch(s){i.e(s)}finally{i.f()}return!1})}},{key:"playerDirections",value:function(e){return e===ote.ONE?[ure.DOWN,ure.DOWN_LEFT,ure.DOWN_RIGHT]:[ure.UP,ure.UP_LEFT,ure.UP_RIGHT]}},{key:"directionAllowedForPlayer",value:function(e,t){return t===ote.ZERO?e.y<0:e.y>0}},{key:"getListMovesFromState",value:function(e){var t=n.getMovablePieces(e);return 0===t.length?(a6(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[jue.PASS]):n.getListMovesFromNonBlockedState(e,t)}},{key:"getListMovesFromNonBlockedState",value:function(e,t){var r,i=[],a=e.getCurrentPlayer(),o=ip(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=ip(n.playerDirections(a));try{for(c.s();!(s=c.n()).done;)for(var l=s.value,h=1;h<Wue.SIZE;h++){var f=u.getNext(l,h);if(!e.isOnBoard(f)||!Wue.isEmptyAt(e.board,f))break;var d=jue.of(u,f);i.push(d)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){o.e(v)}finally{o.f()}return i}},{key:"mustPass",value:function(e){return 0===this.getMovablePieces(e).length}},{key:"getFurthestPiecePositions",value:function(e){var t=7,n=0;return Wue.allPieceCoords(e.board).forEach(function(r){var i=e.getPieceAt(r);a6(i!==$ue.NONE,"allPieceCoords failed to filter KamisadoPiece.NONE"),i.player===ote.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}},{key:"isLegal",value:function(e,t){var r=e.coord,i=e.end,a=t.colorToPlay;if(e===jue.PASS)return this.isLegalPass(t);if(n.isVictory(t))return J5.failure("You should never see this message");var o=t.getPieceAt(r);if(!o.belongsTo(t.getCurrentPlayer()))return J5.failure(kre.MUST_CHOOSE_PLAYER_PIECE());if(a!==que.ANY&&o.color!==a)return J5.failure(Yue.NOT_RIGHT_COLOR());if(!t.getPieceAt(i).isEmpty())return J5.failure(kre.MUST_CLICK_ON_EMPTY_SPACE());var s=ure.factory.fromMove(r,i);if(s.isFailure())return J5.failure(Yue.DIRECTION_NOT_ALLOWED());var u=s.get();if(!n.directionAllowedForPlayer(u,t.getCurrentPlayer()))return J5.failure(Yue.DIRECTION_NOT_ALLOWED());for(var c=r;!c.equals(i);)if(c=c.getNext(u),!t.getPieceAt(c).isEmpty())return J5.failure(Yue.MOVE_BLOCKED());return J5.success(void 0)}},{key:"isLegalPass",value:function(e){return this.mustPass(e)&&!e.alreadyPassed?J5.success(void 0):J5.failure(kre.CANNOT_PASS())}},{key:"isVictory",value:function(e){var t=Hv(this.getFurthestPiecePositions(e),2),n=t[0],r=t[1];return 0===n||7===r}}]),n}(Lre),Jue=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t=Kue.getListMovesFromState(e.gameState);return lte.sortByDescending(t,function(e){return e.length()}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=t.getCurrentPlayer();if(Kue.mustPass(t)&&t.alreadyPassed)return new wre(n.getDefeatValue());var r=Hv(Kue.getFurthestPiecePositions(t),2),i=r[0],a=r[1];return new wre(7===a?ote.ONE.getVictoryValue():0===i?ote.ZERO.getVictoryValue():a-(7-i))}}]),n}(_re),Que=$ue.NONE,Xue=$ue.ZERO.ORANGE,ece=$ue.ONE.ORANGE,tce=$ue.ZERO.BLUE,nce=$ue.ONE.BLUE,rce=$ue.ZERO.PURPLE,ice=$ue.ONE.PURPLE,ace=$ue.ZERO.PINK,oce=$ue.ONE.PINK,sce=$ue.ZERO.YELLOW,uce=$ue.ONE.YELLOW,cce=$ue.ZERO.RED,lce=$ue.ONE.RED,hce=$ue.ZERO.GREEN,fce=$ue.ONE.GREEN,dce=$ue.ZERO.BROWN,vce=$ue.ONE.BROWN,pce=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(ga||(ga=Vv(["Goal of the game"]))),$localize(ya||(ya=Vv(["At Kamisado, there are two ways to win the game:\n        either by moving one of your pieces on the opponent's starting line,\n        or by forcing the opponent to make a move that blocks the entire game.\n        Here, Dark wins because its brown piece is on Light's starting line, on the top left."]))),new Zue(5,que.ORANGE,hB.empty(),!1,[[dce,nce,ice,oce,uce,lce,fce,vce],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,ece,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,hce,cce,sce,ace,rce,tce,Xue]])).withPreviousMove(jue.of(new lre(0,7),new lre(0,0))),Vre.anyMove($localize(ma||(ma=Vv(["Initial board and initial move"]))),$localize(ka||(ka=Vv(["Here is the initial board.\n        At Kamisado, pieces can only move forward, vertically or diagonally.\n        You're playing first, with dark pieces, you can make your first move.<br/><br/>\n        Click on the piece of your choice and click on the landing square."]))),Zue.getInitialState(),jue.of(new lre(7,7),new lre(3,3)),$localize(_a||(_a=Vv(["Perfect! Note that each of your piece has a different color."])))),Vre.fromMove($localize(wa||(wa=Vv(["Moving"]))),$localize(Ca||(Ca=Vv(["Let us now consider the move of Light, after the blue piece has been moved by Dark.\n        All moves after the initial move must be made from the piece that corresponds to the color\n        of the square upon which the last move ended.\n        Here, the last move ended on the pink square, hence the pink piece must move.\n        It is already selected, you do not have to click on it.<br/><br/>\n        Move it on a blue square."]))),new Zue(1,que.PINK,hB.of(new lre(3,0)),!1,[[ece,nce,ice,oce,uce,lce,fce,vce],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,tce,Que],[Que,Que,Que,Que,Que,Que,Que,Que],[dce,hce,cce,sce,ace,rce,Que,Xue]]),[jue.of(new lre(3,0),new lre(3,6)),jue.of(new lre(3,0),new lre(4,1))],$localize(ba||(ba=Vv(["Congratulations!"]))),$localize(Ea||(Ea=Vv(["You have not moved your pink piece on a blue square!"])))).withPreviousMove(jue.of(new lre(6,7),new lre(6,5))),Vre.informational($localize(Sa||(Sa=Vv(["Stuck situation"]))),$localize(Pa||(Pa=Vv(["Dark moved to another pink square, hence you have to move your pink piece again.\n        However, your pink piece is stuck! In this case, you must pass your turn.\n        Dark will now have to play by moving its pink piece."]))),new Zue(1,que.PINK,hB.of(new lre(3,6)),!1,[[ece,nce,ice,Que,uce,lce,fce,vce],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,Que,tce],[Que,Que,Que,Que,Que,Que,Que,Que],[Que,Que,Que,oce,Que,Que,Que,Que],[dce,hce,cce,sce,ace,rce,Que,Xue]])).withPreviousMove(jue.of(new lre(6,5),new lre(7,4))),Vre.fromMove($localize(Oa||(Oa=Vv(["Victory by blocking"]))),$localize(Ta||(Ta=Vv(["At any time, if a player blocks the entire game, that player loses.\n        In other words, if a player forces its opponent to move a piece that the opponent cannot move,\n        and the player cannot move its own piece of the same color, then that player loses.\n        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>\n        Try to make this move."]))),new Zue(2,que.RED,hB.of(new lre(2,4)),!1,[[Que,nce,ice,Que,Que,lce,Que,Que],[Que,Que,Que,uce,Que,Que,Que,Que],[Que,Que,Que,oce,Que,ice,Que,Que],[Que,Que,Que,sce,Que,Que,Que,Que],[Que,Que,cce,Que,Que,Que,Que,Que],[Que,Que,Que,Que,Que,Que,fce,Que],[ece,Que,Que,Que,Que,ace,Que,vce],[dce,hce,Que,Que,Que,Que,tce,Xue]]),[jue.of(new lre(2,4),new lre(0,2))],$localize(Ia||(Ia=Vv(["Perfect!\n         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.\n         Your orange piece will be stuck and you will have to pass your turn.\n         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.\n         In this case, the last player to have moved a piece loses.\n         Here, your opponent will have moved its green piece last, you therefore win!"]))),$localize(xa||(xa=Vv(["Failed!"])))).withPreviousMove(jue.of(new lre(4,0),new lre(3,1)))]});function gce(e,t){if(1&e&&(Pm(),yb(0,"circle",8)),2&e){var n=Pb(),r=n.index,i=n.$implicit,a=Pb().index,o=Pb();ob("cx",o.SPACE_SIZE/2+r*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+a*o.SPACE_SIZE)("fill",o.pieceColor(i))("r",o.SPACE_SIZE/3)}}function yce(e,t){if(1&e&&(Pm(),yb(0,"rect",9)),2&e){var n=Pb(),r=n.$implicit,i=n.index,a=Pb().index,o=Pb();db("ngClass",o.piecePlayerClass(r)),ob("x",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+a*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(r)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(r)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)}}function mce(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"g",4),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onClick(e,t)}),yb(2,"rect",5),lb(3,gce,1,4,"circle",6),lb(4,yce,1,7,"rect",7),gb(),gb()}if(2&e){var r=t.$implicit,i=t.index,a=Pb().index,o=Pb();Rw(1),Ib("id","click_",i,"_",a,""),Rw(1),ob("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(i,a)),Rw(1),db("ngIf",r!==o.UNOCCUPIED),Rw(1),db("ngIf",r!==o.UNOCCUPIED)}}function kce(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,mce,5,9,"g",1),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function _ce(e,t){if(1&e&&(Pm(),pb(0,"g"),yb(1,"rect",10),yb(2,"rect",10),gb()),2&e){var n=Pb();Rw(1),ob("x",n.lastMove.get().coord.x*n.SPACE_SIZE)("y",n.lastMove.get().coord.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),Rw(1),ob("x",n.lastMove.get().end.x*n.SPACE_SIZE)("y",n.lastMove.get().end.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function wce(e,t){if(1&e&&(Pm(),yb(0,"circle",11)),2&e){var n=Pb();ob("cx",n.SPACE_SIZE/2+n.chosen.get().x*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+n.chosen.get().y*n.SPACE_SIZE)}}var Cce=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).UNOCCUPIED=$ue.NONE,r.lastMove=hB.empty(),r.chosen=hB.empty(),r.chosenAutomatically=!1,r.rules=new Kue(Zue),r.availableMinimaxes=[new Jue(r.rules,"KamisadoMinimax")],r.encoder=jue.encoder,r.tutorial=(new pce).tutorial,r.canPass=!1,r.updateBoard(),r}return cp(n,[{key:"backgroundColor",value:function(e,t){return Wue.getColorAt(e,t).rgb}},{key:"isPlayerZero",value:function(e){return e.player===ote.ZERO}},{key:"pieceColor",value:function(e){return e.color.rgb}},{key:"piecePlayerClass",value:function(e){return this.getPlayerClass(e.player)}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.canPass=Kue.mustPass(e),this.canPass||e.coordToPlay.isAbsent()?(this.chosenAutomatically=!1,this.chosen=hB.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(a6(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(jue.PASS,e.rules.node.gameState)));case 1:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new lre(e,t),!n.canPass){r.next=6;break}return r.abrupt("return",n.cancelMove(kre.MUST_PASS()));case 6:if(!n.chosen.isAbsent()){r.next=8;break}return r.abrupt("return",n.choosePiece(e,t));case 8:if(!1!==n.chosenAutomatically||!n.chosen.equalsValue(a)){r.next=10;break}return r.abrupt("return",(n.cancelMoveAttempt(),e6.SUCCESS));case 10:if(o=n.rules.node.gameState.getPieceAtXY(e,t),s=n.rules.node.gameState.getCurrentPlayer(),!o.belongsTo(s)){r.next=15;break}r.t0=n.chosenAutomatically?n.cancelMove(Yue.PLAY_WITH_SELECTED_PIECE()):(n.chosen=hB.of(a),e6.SUCCESS),r.next=18;break;case 15:return r.next=17,n.chooseDestination(e,t);case 17:r.t0=r.sent;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t),r=this.rules.node.gameState.getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(kre.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=hB.of(new lre(e,t)),e6.SUCCESS)}},{key:"chooseDestination",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new lre(e,t),o=jue.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenAutomatically||(this.chosen=hB.empty())}}]),n}(wie);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-kamisado"]],features:[jC],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","30","class","base mid-stroke no-fill highlighted",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",4,"ngIf"],["class","no-stroke",3,"ngClass",4,"ngIf"],[1,"base-no-fill"],[1,"no-stroke",3,"ngClass"],[1,"base","no-fill","mid-stroke","highlighted"],["r","30",1,"base","mid-stroke","no-fill","highlighted"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,kce,2,1,"g",1),lb(2,_ce,3,8,"g",2),lb(3,wce,1,2,"circle",3),gb()),2&e&&(ob("viewBox","-4 -4 "+8*t.SPACE_SIZE+" "+(8+8*t.SPACE_SIZE)),Rw(1),db("ngForOf",t.board),Rw(1),db("ngIf",t.lastMove.isPresent()),Rw(1),db("ngIf",t.chosen.isPresent()))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),bce=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,null,[{key:"getInitialState",value:function(){var e=ate.NONE,t=ote.ZERO,r=ote.ONE;return new n([[e,t,t,t,t,t,t,e],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[e,t,t,t,t,t,t,e]],0)}},{key:"isOnBoard",value:function(e){return e.isInRange(n.SIZE,n.SIZE)}}]),n}(Sre);return e.SIZE=8,e}(),Ece=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r)).direction=i,a.direction=ure.factory.fromMove(e,r).get(),a}return cp(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}],[{key:"of",value:function(e,t){var r=ure.factory.fromMove(e,t);return r.isFailure()?J5.failure(r.getReason()):e.isNotInRange(bce.SIZE,bce.SIZE)?J5.failure("start coord is not in range"):t.isNotInRange(bce.SIZE,bce.SIZE)?J5.failure("end coord is not in range"):J5.success(new n(e,t,r.get()))}}]),n}(Aie);Ece.encoder=Aie.getEncoder(bce.SIZE,bce.SIZE,function(e,t){return Ece.of(e,t).get()});var Sce=function(){var e=cp(function e(){sp(this,e)});return e.INVALID_MOVE_LENGTH=function(){return $localize(Aa||(Aa=Vv(["Your move should have a length equal to the number of pieces that exist on the same line."])))},e.CANNOT_JUMP_OVER_OPPONENT=function(){return $localize(Ra||(Ra=Vv(["You cannot jump over the opponent's pieces."])))},e.PIECE_CANNOT_MOVE=function(){return $localize(Na||(Na=Vv(["This piece has no possible move, select another one."])))},e.INVALID_DIRECTION=function(){return $localize(Ma||(Ma=Vv(["A move must be orthogonal or diagonal"])))},e}(),Pce=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=ate.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new bce(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=Hv(n.getNumberOfGroups(t),2),i=r[0],a=r[1];return 1===i&&a>1?Dre.ZERO_WON:i>1&&1===a?Dre.ONE_WON:Dre.ONGOING}}],[{key:"getListMovesFromState",value:function(e){var t=[];if(n.getVictory(e).isPresent())return t;for(var r=0;r<bce.SIZE;r++)for(var i=0;i<bce.SIZE;i++){var a=new lre(i,r);if(e.getPieceAt(a).isPlayer()){var o,s=ip(n.possibleTargets(e,a));try{for(s.s();!(o=s.n()).done;){var u=o.value,c=Ece.of(a,u).get();t.push(c)}}catch(l){s.e(l)}finally{s.f()}}}return t}},{key:"getNumberOfGroups",value:function(e){for(var t=lte.createTable(bce.SIZE,bce.SIZE,-1),r=[0,0],i=0,a=0;a<bce.SIZE;a++)for(var o=0;o<bce.SIZE;o++)if(-1===t[a][o]){var s=e.getPieceAt(new lre(o,a));s.isPlayer()&&(i+=1,n.markGroupStartingAt(e,t,new lre(o,a),i),r[s.value]+=1)}return r}},{key:"markGroupStartingAt",value:function(e,t,n,r){for(var i=[n],a=e.getPieceAt(n);i.length>0;){var o=oB.getNonNullable(i.pop());if(-1===t[o.y][o.x]){var s=e.getPieceAt(o);if(s===a){t[o.y][o.x]=r;var u,c=ip(ure.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=o.getNext(l);e.isOnBoard(h)&&i.push(h)}}catch(f){c.e(f)}finally{c.f()}}else s===ate.NONE&&(t[o.y][o.x]=0)}}}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?J5.failure(kre.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?J5.failure(Sce.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(function(e){return t.getPieceAt(e)===t.getCurrentOpponent()})?J5.failure(Sce.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?J5.failure(kre.CANNOT_SELF_CAPTURE()):J5.success(void 0)}},{key:"numberOfPiecesOnLine",value:function(e,t,r){var i,a=0,o=ip(n.getLineCoords(t,r));try{for(o.s();!(i=o.n()).done;){var s=i.value;e.getPieceAt(s).isPlayer()&&(a+=1)}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getLineCoords",value:function(e,t){for(var r=n.getEntranceAndForwardDirection(e,t),i=r[0],a=r[1],o=[];bce.isOnBoard(i);)o.push(i),i=i.getNext(a);return o}},{key:"getEntranceAndForwardDirection",value:function(e,t){switch(t){case ure.UP:case ure.DOWN:return[new lre(e.x,0),ure.DOWN];case ure.LEFT:case ure.RIGHT:return[new lre(0,e.y),ure.RIGHT];case ure.UP_RIGHT:case ure.DOWN_LEFT:return[new lre(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),ure.UP_RIGHT];default:return oB.expectToBeMultiple(t,[ure.UP_LEFT,ure.DOWN_RIGHT]),[new lre(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),ure.DOWN_RIGHT]}}},{key:"getVictory",value:function(e){var t=Hv(n.getNumberOfGroups(e),2),r=t[0],i=t[1];return 1===r&&1===i?hB.of(ate.NONE):1===r?hB.of(ote.ZERO):1===i?hB.of(ote.ONE):hB.empty()}},{key:"possibleTargets",value:function(e,t){var r,i=[],a=ip(ure.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.numberOfPiecesOnLine(e,t,o),u=t.getNext(o,s);if(e.isOnBoard(u)){var c=Ece.of(t,u).get();n.isLegal(c,e).isSuccess()&&i.push(u)}}}catch(l){a.e(l)}finally{a.f()}return i}}]),n}(Lre),Oce=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){return Pce.getListMovesFromState(e.gameState)}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Hv(Pce.getNumberOfGroups(t),2),r=n[0],i=n[1];return new wre(1===r&&i>1?ote.ZERO.getVictoryValue():r>1&&1===i?ote.ONE.getVictoryValue():100/r*ote.ZERO.getScoreModifier()+100/i*ote.ONE.getScoreModifier())}}]),n}(_re),Tce=ate.NONE,Ice=ote.ZERO,xce=ote.ONE,Ace=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(Da||(Da=Vv(["Goal of the game"]))),$localize(La||(La=Vv(["At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.\n        Here, Dark wins the game:\n        Dark's pieces are forming a single group, while Light's pieces form three groups."]))),new bce([[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce],[xce,Tce,Tce,Tce,Ice,Tce,Tce,xce],[Tce,Tce,Ice,Ice,xce,Tce,Tce,Tce],[Tce,Tce,Tce,Ice,Tce,Tce,Tce,Tce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce]],0)),Vre.anyMove($localize(Fa||(Fa=Vv(["Initial board and initial move"]))),$localize(Ba||(Ba=Vv(["Here is the initial board.\n         Moves can be made orthogonally or diagonally.\n         The length of a move is equal to the number of pieces that are on the line of the move.\n         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>\n         You're playing Dark, make the first move!"]))),bce.getInitialState(),Ece.of(new lre(1,7),new lre(1,5)).get(),$localize(Ua||(Ua=Vv(["Congratulations!"])))),Vre.fromMove($localize(Va||(Va=Vv(["Jumping"]))),$localize(za||(za=Vv(["During a move, it is possible to jump above your own pieces.\n        But it is forbidden to jump over the opponent's pieces.<br/><br/>\n        You're playing Dark, make a jump over one of your pieces on the following board."]))),new bce([[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce],[Tce,Tce,xce,Ice,Ice,Tce,Tce,Tce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,xce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Ice]],0),[Ece.of(new lre(3,1),new lre(6,1)).get()],$localize(Ha||(Ha=Vv(["Congratulations!"]))),$localize(Ga||(Ga=Vv(["Failed. You did not jump over one of your pieces."])))),Vre.fromMove($localize(qa||(qa=Vv(["Moving"]))),$localize($a||($a=Vv(["Here is a different board. Pick the dark piece in the middle (line 4, column 4)\n        and observe its possible moves.\n        Horizontally, this piece can move only of one square because it is the only piece on this line.\n        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.\n        But it can only go up, as below it the landing square is occupied by one of your pieces.\n        Diagonally, only one move is possible: on the diagonal that contains three pieces,\n        only in the direction where it does not jump over one of the opponent's pieces.\n        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>\n        Make one of these moves."]))),new bce([[Tce,Tce,Tce,Tce,Tce,Tce,xce,Tce],[Tce,Tce,Tce,Tce,Tce,Ice,Tce,Tce],[Tce,Tce,Tce,Tce,xce,Tce,Tce,Tce],[Tce,Tce,Tce,Ice,Tce,Tce,Tce,Tce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,xce],[Tce,Tce,Tce,Tce,Tce,xce,Tce,xce],[Tce,Tce,Tce,Ice,Tce,Tce,xce,xce],[Tce,Tce,Tce,Ice,Tce,Tce,Tce,Tce]],0),[Ece.of(new lre(3,3),new lre(3,0)).get(),Ece.of(new lre(3,3),new lre(0,0)).get(),Ece.of(new lre(3,3),new lre(2,3)).get(),Ece.of(new lre(3,3),new lre(4,3)).get()],$localize(Wa||(Wa=Vv(["Congratulations!"]))),$localize(ja||(ja=Vv(["Failed. This was not one of the expected moves."])))),Vre.fromMove($localize(Za||(Za=Vv(["Capturing"]))),$localize(Ya||(Ya=Vv(["If a move ends on an opponent's pieces, this one is captured and removed from the board.\n        However, a move cannot end on one of the player's pieces.\n        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!\n        If a player has only one piece, that player wins the game.<br/><br/>\n        On the following board, try to capture one piece with Dark."]))),new bce([[Tce,Ice,Tce,Ice,Ice,Ice,Ice,Tce],[xce,Tce,Tce,Tce,Tce,Tce,Tce,xce],[Tce,Tce,Ice,Tce,xce,Tce,Tce,Tce],[xce,Tce,Tce,Tce,Tce,Tce,Tce,xce],[xce,Tce,Tce,Tce,Tce,Tce,Tce,xce],[xce,Tce,Tce,Tce,Tce,Tce,Tce,xce],[xce,Tce,Tce,Tce,Tce,Tce,Tce,xce],[Tce,Ice,Ice,Ice,Ice,Ice,Ice,Tce]],0),[Ece.of(new lre(2,2),new lre(4,2)).get()],$localize(Ka||(Ka=Vv(["Congratulations!"]))),$localize(Ja||(Ja=Vv(["Failed!"])))),Vre.fromMove($localize(Qa||(Qa=Vv(["Tie"]))),$localize(Xa||(Xa=Vv(["In the special case where a move ends up connecting all pieces of both player, simultaneously,\n        then the game ends up with a tie.<br/><br/>\n        You're playing Dark, force the tie in one move."]))),new bce([[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce],[Ice,Tce,Tce,Ice,xce,Ice,Tce,Tce],[Tce,Tce,Tce,Ice,Tce,Tce,Tce,xce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,xce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,xce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,xce],[Tce,Tce,Tce,Tce,Tce,Tce,Tce,Tce]],0),[Ece.of(new lre(0,2),new lre(4,2)).get()],$localize(eo||(eo=Vv(["Congratulations!"]))),$localize(to||(to=Vv(["Failed!"]))))]});function Rce(e,t){if(1&e&&(Pm(),yb(0,"circle",5)),2&e){var n=Pb().index,r=Pb().index,i=Pb();db("ngClass",i.getPieceClasses(n,r)),ob("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)}}function Nce(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"g",2),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onClick(e,t)}),yb(2,"rect",3),lb(3,Rce,1,3,"circle",4),gb(),gb()}if(2&e){var r=t.$implicit,i=t.index,a=Pb().index,o=Pb();Rw(1),Ib("id","click_",i,"_",a,""),Rw(1),db("ngClass",o.getSquareClasses(i,a)),ob("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Rw(1),db("ngIf",r!==o.EMPTY)}}function Mce(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Nce,4,8,"g",1),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function Dce(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",6),bb("click",function(){var e=Jy(n).$implicit;return Pb().onClick(e.x,e.y)}),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb();Rw(1),ob("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}var Lce=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.EMPTY=ate.NONE,r.targets=[],r.selected=hB.empty(),r.lastMove=hB.empty(),r.captured=hB.empty(),r.rules=new Pce(bce),r.availableMinimaxes=[new Oce(r.rules,"LinesOfActionMinimax")],r.encoder=Ece.encoder,r.tutorial=(new Ace).tutorial,r.updateBoard(),r}return cp(n,[{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new lre(e,t),!n.selected.isPresent()){r.next=9;break}if(n.getState().getPieceAt(a)!==n.getState().getCurrentPlayer()){r.next=7;break}return r.abrupt("return",n.select(a));case 7:return o=Ece.of(n.selected.get(),new lre(e,t)),r.abrupt("return",o.isSuccess()?n.chooseMove(o.get(),n.rules.node.gameState):n.cancelMove(Sce.INVALID_DIRECTION()));case 9:return r.abrupt("return",n.select(a));case 10:case"end":return r.stop()}},r)}))()}},{key:"select",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(kre.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=hB.of(e),t.targets=Pce.possibleTargets(t.rules.node.gameState,t.selected.get()),0===t.targets.length?t.cancelMove(Sce.PIECE_CANNOT_MOVE()):e6.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"updateBoard",value:function(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?hB.of(e.end):hB.empty()}}},{key:"cancelMoveAttempt",value:function(){this.selected=hB.empty(),this.targets=[]}},{key:"getSquareClasses",value:function(e,t){var n=new lre(e,t);if(this.lastMove.isPresent()){var r=this.lastMove.get().coord,i=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured"];if(n.equals(r)||n.equals(i))return["moved"]}return[]}},{key:"getPieceClasses",value:function(e,t){var n=this.board[t][e],r=new lre(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected"),i}}]),n}(wie);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-linesofaction"]],features:[jC],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["r","40","class","base",3,"ngClass",4,"ngIf"],["r","40",1,"base",3,"ngClass"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,Mce,2,1,"g",1),lb(2,Dce,2,4,"g",1),gb()),2&e&&(Rw(1),db("ngForOf",t.board),Rw(1),db("ngForOf",t.targets))},directives:[FT,DT,UT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Fce=Number.MAX_SAFE_INTEGER,Bce=Number.MIN_SAFE_INTEGER,Uce=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,lte.copyBiArray(n.initialBoard),e)).turn=e,i.location=r,i}return cp(n,null,[{key:"getInitialState",value:function(){return new n(0,new lre(0,0))}}]),n}(Sre);Uce.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],Uce.BOARD_1=[[0,+Fce,-1,-1],[1,2,+Fce,-1],[+Bce,3,4,-1],[-1,+Bce,+Bce,-1]],Uce.BOARD_2=[[0,+Fce,-1,-1],[+Fce,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],Uce.BOARD_3=[[0,1,+Bce,-1],[1,+Bce,-1,-1],[+Bce,-1,-1,-1],[-1,-1,-1,-1]],Uce.BOARD_4=[[0,1,+Bce,-1],[1,+Bce,-1,-1],[+Bce,-1,-1,-1],[-1,-1,-1,1]],Uce.initialBoard=Uce.BOARD_0;var Vce=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=new lre(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new Uce(t.turn+1,r)}},{key:"isLegal",value:function(e,t){var n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?J5.failure("incorrect move"):J5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getPieceAt(t.location);return n===ote.ZERO.getVictoryValue()?Dre.ZERO_WON:n===ote.ONE.getVictoryValue()?Dre.ONE_WON:t.location.equals(new lre(3,3))?0===n?Dre.DRAW:n>0?Dre.ONE_WON:Dre.ZERO_WON:Dre.ONGOING}}]),n}(Lre),zce=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).right=e,r}return cp(n,[{key:"equals",value:function(e){return this===e||this.right===e.right}},{key:"toString",value:function(){return this.right?"Move RIGHT":"Move DOWN"}}]),n}(Ore);zce.RIGHT=new zce(!0),zce.DOWN=new zce(!1),zce.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 1}},{key:"decodeNumber",value:function(e){return 0===e?zce.RIGHT:zce.DOWN}},{key:"encodeNumber",value:function(e){return e.right?0:1}}]),n}(rte));var Hce=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getBoardValue",value:function(e){var t=Vce.getGameStatus(e);if(t.isEndGame)return new wre(t.toBoardValue());var n=e.gameState;return new wre(n.getPieceAt(n.location))}},{key:"getListMoves",value:function(e){var t=[],n=e.gameState;return n.location.x<3&&t.push(zce.RIGHT),n.location.y<3&&t.push(zce.DOWN),t}}]),n}(_re);function Gce(e,t){1&e&&(mb(0),Bb(1,"("),kb())}function qce(e,t){1&e&&(mb(0),Bb(1,")"),kb())}function $ce(e,t){if(1&e&&(pb(0,"td"),lb(1,Gce,2,0,"ng-container",3),Bb(2),lb(3,qce,2,0,"ng-container",3),gb()),2&e){var n=t.$implicit,r=t.index,i=Pb().index,a=Pb();Rw(1),db("ngIf",a.coord.x===r&&a.coord.y===i),Rw(1),Vb(" ",n," "),Rw(1),db("ngIf",a.coord.x===r&&a.coord.y===i)}}function Wce(e,t){if(1&e&&(pb(0,"tr"),lb(1,$ce,4,3,"td",0),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}var jce=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).coord=new lre(-1,-1),r.rules=new Vce(Uce),r.availableMinimaxes=[new Hce(r.rules,"MinimaxTestingMinimax")],r.encoder=zce.encoder,r}return cp(n,[{key:"chooseRight",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_right"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(zce.RIGHT,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"chooseDown",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_down"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(zce.DOWN,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.coord=e.location}}]),n}(wie);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-minimax-testing"]],features:[jC],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(pb(0,"table"),lb(1,Wce,2,1,"tr",0),pb(2,"div",1),bb("click",function(){return t.chooseRight()}),Bb(3," goRight "),gb(),pb(4,"div",2),bb("click",function(){return t.chooseDown()}),Bb(5," goDown "),gb(),pb(6,"div"),Bb(7),gb(),gb()),2&e&&(Rw(1),db("ngForOf",t.board),Rw(6),Vb(" ",t.coord," "))},directives:[FT,UT],encapsulation:2}),e}(),Zce=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,null,[{key:"getInitialState",value:function(){return new n(lte.createTable(7,6,ate.NONE),0)}}]),n}(Sre),Yce=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this)).x=e,r}return cp(n,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"P4Move("+this.x+")"}}],[{key:"of",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;case 5:return n.FIVE;case 6:return n.SIX;default:throw new Error("Invalid P4Move")}}}]),n}(Ore);Yce.ZERO=new Yce(0),Yce.ONE=new Yce(1),Yce.TWO=new Yce(2),Yce.THREE=new Yce(3),Yce.FOUR=new Yce(4),Yce.FIVE=new Yce(5),Yce.SIX=new Yce(6),Yce.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 6}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return Yce.of(e)}}]),n}(rte));var Kce=function(){var e=cp(function e(){sp(this,e)});return e.COLUMN_IS_FULL=function(){return $localize(no||(no=Vv(["Please put your piece in an incomplete column."])))},e}(),Jce=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,r){var i=e.x,a=t.getCopiedBoard(),o=n.getLowestUnoccupiedCase(a,i),s=t.turn;return a[o][i]=t.getCurrentPlayer(),new Zce(a,s+1)}},{key:"isLegal",value:function(e,t){return sB(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:t}),t.getPieceAtXY(e.x,0).isPlayer()?J5.failure(Kce.COLUMN_IS_FULL()):J5.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,r=0;r<7;r++)for(var i=5;i>=0&&t.board[i][r].isPlayer();i--){var a=n.getSquareScore(t.board,new lre(r,i));if(Mre.getScoreStatus(a)===xre.VICTORY)return Dre.getVictory(t.getCurrentOpponent())}return 42===t.turn?Dre.DRAW:Dre.ONGOING}}],[{key:"getVictoriousCoords",value:function(e){for(var t=[],r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new lre(r,i));(a===ote.ZERO.getVictoryValue()||a===ote.ONE.getVictoryValue())&&t.push(new lre(r,i))}return t}},{key:"getBoardValueFromScratch",value:function(e){sB(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});for(var t=0,r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new lre(r,i));if(Mre.getScoreStatus(a)!==xre.DEFAULT)return sB(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:a,coord:{x:r,y:i}}}),new wre(a);t+=a}return new wre(t)}},{key:"getLowestUnoccupiedCase",value:function(e,t){for(var n=0;n<6&&e[n][t]===ate.NONE;)n++;return n-1}},{key:"getNumberOfFreeSpacesAndAllies",value:function(e,t,n,r,i){for(var a=0,o=0,s=!0,u=new lre(t.x+n.x,t.y+n.y);u.isInRange(7,6)&&3!==a;){var c=e[u.y][u.x];if(c===r)return[a,o];c===i&&s?o++:s=!1,c!==r&&c!==i&&a++,u=u.getNext(n)}return[a,o]}},{key:"getOpponent",value:function(e,t){var n=e[t.y][t.x];return a6(n.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),n===ote.ONE?ote.ZERO:ote.ONE}},{key:"getSquareScore",value:function(e,t){sB(n.VERBOSE,"getSquareScore(board, "+t.x+", "+t.y+") called"),sB(n.VERBOSE,e);var r,i=0,a=n.getOpponent(e,t),o=a.getOpponent(),s=new Are,u=new Are,c=ip(ure.DIRECTIONS);try{for(c.s();!(r=c.n()).done;){var l=r.value,h=n.getNumberOfFreeSpacesAndAllies(e,t,l,a,o);s.set(l,h[0]),u.set(l,h[1])}}catch(y){c.e(y)}finally{c.f()}for(var f=0,d=[ure.UP,ure.UP_RIGHT,ure.RIGHT,ure.DOWN_RIGHT];f<d.length;f++){var v=d[f],p=u.get(v).get()+u.get(v.getOpposite()).get();if(p>2)return sB(n.VERBOSE,{text:"there is some kind of victory here ("+t.x+", "+t.y+")\nline allies : "+p+"\n",board:e}),o.getVictoryValue();var g=s.get(v).get()+s.get(v.getOpposite()).get();3===g?i+=2:g>3&&(i+=g-2)}return i*o.getScoreModifier()}},{key:"getListMoves",value:function(e){sB(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});for(var t=e.gameState,r=[],i=0;i<7;i++)if(t.getPieceAtXY(i,0)===ate.NONE){var a=Yce.of(i);r.push(a)}return r}},{key:"getBoardValue",value:function(e){return sB(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}}]),n}(Lre);return e.VERBOSE=!1,e}(),Qce=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){return Jce.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=e.gameState;return sB(Jce.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),Jce.getBoardValue(t)}}]),n}(_re),Xce=ote.ZERO,ele=ote.ONE,tle=ate.NONE,nle=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(ro||(ro=Vv(["Goal of the game"]))),$localize(io||(io=Vv(["The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.\n        The first player plays Dark, the second plays Light.\n        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally)."]))),Zce.getInitialState()),Vre.anyMove($localize(ao||(ao=Vv(["Dropping a piece"]))),$localize(oo||(oo=Vv(["Click on any space in any column."]))),Zce.getInitialState(),Yce.THREE,$localize(so||(so=Vv(["As you can see, the piece falls at the bottom of the column."])))),Vre.fromMove($localize(uo||(uo=Vv(["Victory"]))),$localize(co||(co=Vv(["You're playing Dark.\n        Place your piece so that you create a horizontal alignment of 4 of your pieces."]))),new Zce([[tle,tle,tle,tle,tle,tle,tle],[tle,tle,tle,tle,tle,tle,tle],[tle,tle,tle,tle,tle,tle,tle],[tle,tle,tle,ele,tle,tle,tle],[tle,tle,tle,ele,tle,tle,tle],[tle,tle,Xce,Xce,Xce,ele,tle]],0),[Yce.of(1)],$localize(lo||(lo=Vv(["You won!"]))),$localize(ho||(ho=Vv(["Failed, you have not aligned 4 pieces and missed an opportunity to win."])))),Vre.fromMove($localize(fo||(fo=Vv(["Other victory"]))),$localize(vo||(vo=Vv(["You can also align 4 pieces diagonally or vertically."]))),new Zce([[tle,tle,tle,tle,tle,tle,tle],[tle,tle,tle,tle,tle,tle,tle],[tle,tle,tle,tle,tle,tle,tle],[tle,tle,tle,Xce,ele,tle,tle],[tle,tle,Xce,Xce,ele,tle,tle],[tle,Xce,ele,Xce,Xce,tle,tle]],0),[Yce.of(3),Yce.of(4)],$localize(po||(po=Vv(["You won!"]))),$localize(go||(go=Vv(["Failed, you have not aligned 4 pieces and missed an opportunity to win."]))))]});function rle(e,t){if(1&e&&(Pm(),yb(0,"circle",6)),2&e){var n=Pb().index,r=Pb().index,i=Pb();db("ngClass",i.getSquareFillClass(n,r)),ob("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function ile(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",4),bb("click",function(){var e=Jy(n).index;return Pb(2).onClick(e)}),gb(),lb(2,rle,1,4,"circle",5),gb()}if(2&e){var r=t.$implicit,i=t.index,a=Pb().index,o=Pb();Rw(1),Tb("id","click_",i,""),ob("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Rw(1),db("ngIf",r!=o.EMPTY_CASE)}}function ale(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,ile,3,6,"g",1),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function ole(e,t){if(1&e&&(Pm(),yb(0,"rect",7)),2&e){var n=Pb();ob("x",n.SPACE_SIZE*n.last.get().x)("y",n.SPACE_SIZE*n.last.get().y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function sle(e,t){if(1&e&&(Pm(),yb(0,"rect",8)),2&e){var n=t.$implicit,r=Pb();Ib("id","victory_coord_",n.x,"_",n.y,""),ob("x",r.SPACE_SIZE*n.x)("y",r.SPACE_SIZE*n.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}var ule=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).EMPTY_CASE=ate.NONE,r.victoryCoords=[],r.rules=new Jce(Zce),r.availableMinimaxes=[new Qce(r.rules,"P4Minimax")],r.encoder=Yce.encoder,r.tutorial=(new nle).tutorial,r.updateBoard(),r}return cp(n,[{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=Yce.of(e),n.next=6,t.chooseMove(i,t.rules.node.gameState);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.victoryCoords=Jce.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move,t=Jce.getLowestUnoccupiedCase(this.rules.node.gameState.board,e.get().x)+1;this.last=hB.of(new lre(e.get().x,t))}},{key:"hideLastMove",value:function(){this.last=hB.empty()}},{key:"getSquareFillClass",value:function(e,t){return[this.getPlayerClass(this.board[t][e])]}}]),n}(wie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-p4"]],features:[jC],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[1,"base",3,"id","click"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,ale,2,1,"g",1),lb(2,ole,1,4,"rect",2),lb(3,sle,1,6,"rect",3),gb()),2&e&&(Rw(1),db("ngForOf",t.board),Rw(1),db("ngIf",t.last.isPresent()),Rw(1),db("ngForOf",t.victoryCoords))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),cle=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(sp(this,n),(a=t.call(this,e,r)).blockTurned=i,a.turnedClockwise=o,a.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+a.coord.toString());return Qv(a)}return cp(n,[{key:"toString",value:function(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}],[{key:"withRotation",value:function(e,t,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new n(e,t,hB.of(r),i)}},{key:"rotationless",value:function(e,t){return new n(e,t,hB.empty())}}]),n}(Tre);cle.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"encodeMove",value:function(e){var t={coord:lre.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}},{key:"decodeMove",value:function(e){var t=e,n=lre.encoder.decode(t.coord),r=hB.ofNullable(t.blockTurned);if(r.isPresent()){var i=t.turnedClockwise;return cle.withRotation(n.x,n.y,r.get(),i)}return cle.rotationless(n.x,n.y)}}]),n}(nte));var lle=function(){var e=cp(function e(){sp(this,e)});return e.CANNOT_ROTATE_NEUTRAL_BLOCK=function(){return $localize(yo||(yo=Vv(["If the quadrant to turn is neutral, please just use move without rotation."])))},e.MUST_CHOOSE_BLOCK_TO_ROTATE=function(){return $localize(mo||(mo=Vv(["No quadrant is neutral, you must pick a quadrant to rotate."])))},e}(),hle=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e,r)).neutralBlocks=i.getBlocksNeutralities(),i}return cp(n,[{key:"getBlocksNeutralities",value:function(){for(var e=[],t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}},{key:"getBlockNeutrality",value:function(e){var t=n.getBlockCenter(e),r=this.getPieceAt(t.getNext(ure.UP,1)),i=this.getPieceAt(t.getNext(ure.UP_LEFT,1));return this.getPieceAt(t.getNext(ure.RIGHT,1))===r&&this.getPieceAt(t.getNext(ure.DOWN,1))===r&&this.getPieceAt(t.getNext(ure.LEFT,1))===r&&this.getPieceAt(t.getNext(ure.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(ure.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(ure.DOWN_LEFT,1))===i}},{key:"applyLegalDrop",value:function(e){var t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new n(t,this.turn)}},{key:"applyLegalMove",value:function(e){var t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){var i=n.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise){var a,o=ip(n.ROTATION_MAP);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s[0].getNext(i),c=s[1].getNext(i),l=t.getPieceAt(u);r[c.y][c.x]=l}}catch(y){o.e(y)}finally{o.f()}}else{var h,f=ip(n.ROTATION_MAP);try{for(f.s();!(h=f.n()).done;){var d=h.value,v=d[1].getNext(i),p=d[0].getNext(i),g=t.getPieceAt(v);r[p.y][p.x]=g}}catch(y){f.e(y)}finally{f.f()}}}return new n(r,this.turn+1)}},{key:"blockIsNeutral",value:function(e){return this.neutralBlocks.includes(e)}}],[{key:"getInitialState",value:function(){return new n(lte.createTable(6,6,ate.NONE),0)}},{key:"getBlockCenter",value:function(e){return new lre(1+(e%2==0?0:3),1+(e<2?0:3))}}]),n}(Sre);hle.ROTATION_MAP=[[new lre(-1,-1),new lre(1,-1)],[new lre(0,-1),new lre(1,0)],[new lre(1,-1),new lre(1,1)],[new lre(1,0),new lre(0,1)],[new lre(1,1),new lre(-1,1)],[new lre(0,1),new lre(-1,0)],[new lre(-1,1),new lre(-1,-1)],[new lre(-1,0),new lre(0,-1)]];var fle=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).isPlayer())return J5.failure(kre.MUST_LAND_ON_EMPTY_SPACE());var n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return J5.failure(lle.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){var r=e.blockTurned.get();if(n.neutralBlocks.includes(r))return J5.failure(lle.CANNOT_ROTATE_NEUTRAL_BLOCK())}return J5.success(void 0)}},{key:"getVictoryCoords",value:function(e){var t,r=[],i=ip(n.VICTORY_SOURCE);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=e.getPieceAt(a[0]),s=[a[0]];if(o.isPlayer()){for(var u=a[0].getNext(a[1]),c=!0,l=0;l<3&&c;l++)e.getPieceAt(u)!==o?c=!1:(s.push(u),u=u.getNext(a[1]));if(c&&(e.getPieceAt(u)===o&&(s.push(u),r=r.concat(s)),a[2])){var h=a[0].getPrevious(a[1],1);e.getPieceAt(h)===o&&(s.push(h),r=r.concat(s))}}}}catch(f){i.e(f)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1],i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?Dre.DRAW:Dre.ZERO_WON:!0===r[1]?Dre.ONE_WON:36===t.turn?Dre.DRAW:Dre.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=hB.of(new n(hle))),n.singleton.get()}}]),n}(Lre);fle.singleton=hB.empty(),fle.VICTORY_SOURCE=[[new lre(1,0),new are(1,1),!1],[new lre(0,1),new are(1,1),!1],[new lre(4,0),new are(-1,1),!1],[new lre(5,1),new are(-1,1),!1],[new lre(1,1),new are(1,1),!0],[new lre(4,1),new are(-1,1),!0],[new lre(0,1),new are(0,1),!0],[new lre(1,1),new are(0,1),!0],[new lre(2,1),new are(0,1),!0],[new lre(3,1),new are(0,1),!0],[new lre(4,1),new are(0,1),!0],[new lre(5,1),new are(0,1),!0],[new lre(1,0),new are(1,0),!0],[new lre(1,1),new are(1,0),!0],[new lre(1,2),new are(1,0),!0],[new lre(1,3),new are(1,0),!0],[new lre(1,4),new are(1,0),!0],[new lre(1,5),new are(1,0),!0]];var dle=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return n.FIRST_TURN_MOVES;var i,a=ip(this.getLegalDrops(e.gameState));try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=cle.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(u),l=ip(this.getLegalRotations(c,r));try{for(l.s();!(o=l.n()).done;){var h=o.value;t.push(cle.withRotation(s.x,s.y,h[0],h[1]))}}catch(f){l.e(f)}finally{l.f()}0===c.neutralBlocks.length==0&&t.push(u)}}catch(f){a.e(f)}finally{a.f()}return t}},{key:"getLegalDrops",value:function(e){for(var t=[],n=0;n<6;n++)for(var r=0;r<6;r++){var i=new lre(r,n);e.getPieceAt(i)===ate.NONE&&t.push(i)}return t}},{key:"getLegalRotations",value:function(e,t){for(var n=0===e.neutralBlocks.length,r=[],i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}},{key:"getBoardValue",value:function(e){return new wre(fle.get().getGameStatus(e).toBoardValue())}}]),n}(_re);dle.FIRST_TURN_MOVES=[cle.rotationless(0,0),cle.rotationless(1,0),cle.rotationless(2,0),cle.rotationless(0,1),cle.rotationless(1,1),cle.rotationless(0,2)];var vle=ate.NONE,ple=ote.ONE,gle=ote.ZERO,yle=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(ko||(ko=Vv(["Initial board"]))),$localize(_o||(_o=Vv(["The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate."]))),hle.getInitialState()),Vre.informational($localize(wo||(wo=Vv(["Goal of the game"]))),$localize(Co||(Co=Vv(["The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins."]))),new hle([[gle,vle,vle,gle,ple,vle],[gle,ple,vle,vle,vle,vle],[gle,vle,ple,vle,vle,vle],[gle,vle,vle,vle,vle,ple],[gle,vle,vle,vle,ple,vle],[vle,vle,vle,vle,vle,vle]],10)).withPreviousMove(cle.withRotation(0,0,0,!1)),Vre.fromPredicate($localize(bo||(bo=Vv(["Simple move"]))),$localize(Eo||(Eo=Vv(["At their turn, players put a piece on the board and possibly rotate one quadrant.\n        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.\n        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>\n        Do it."]))),new hle([[vle,vle,vle,vle,vle,vle],[vle,gle,vle,vle,ple,vle],[vle,vle,vle,vle,vle,vle],[vle,vle,vle,vle,vle,vle],[vle,ple,vle,vle,gle,vle],[vle,vle,vle,vle,vle,vle]],10),cle.rotationless(2,2),function(e,t){return e.blockTurned.isPresent()?e6.failure($localize(So||(So=Vv(["You have made a move with a rotation. This tutorial step is about moves without rotations!"])))):e6.SUCCESS},$localize(Po||(Po=Vv(["Congratulations!"])))),Vre.fromPredicate($localize(Oo||(Oo=Vv(["Move with rotation"]))),$localize(To||(To=Vv(["After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>\n        Click on one of them and see the rotation!"]))),new hle([[vle,vle,vle,vle,vle,vle],[vle,gle,vle,vle,ple,vle],[vle,vle,vle,vle,vle,vle],[vle,vle,vle,vle,vle,vle],[vle,ple,vle,vle,gle,vle],[vle,vle,vle,vle,vle,vle]],10),cle.withRotation(0,0,0,!0),function(e,t){return e.blockTurned.isPresent()?e6.SUCCESS:e6.failure($localize(Io||(Io=Vv(["You made a move without rotation, try again!"]))))},$localize(xo||(xo=Vv(["Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation."]))))]});function mle(e,t){if(1&e){var n=_b();Pm(),mb(0),pb(1,"circle",9),bb("click",function(){var e=Jy(n).$implicit,t=Pb().$implicit,r=Pb().index,i=Pb().index;return Pb().onClick(3*r+e,3*i+t)}),gb(),kb()}if(2&e){var r=t.$implicit,i=Pb().$implicit,a=Pb(),o=a.index,s=a.$implicit,u=Pb(),c=u.index,l=u.$implicit,h=Pb();Rw(1),Ib("id","click_",3*o+r,"_",3*c+i,""),db("ngClass",h.getSquareClasses(3*o+r,3*c+i)),ob("cx",s+2*h.STROKE_WIDTH+(r+.5)*h.SPACE_SIZE)("cy",l+2*h.STROKE_WIDTH+(i+.5)*h.SPACE_SIZE)("r",(h.SPACE_SIZE-h.STROKE_WIDTH)/2)}}var kle=function(){return[0,1,2]};function _le(e,t){1&e&&(Pm(),mb(0),lb(1,mle,2,6,"ng-container",3),kb()),2&e&&(Rw(1),db("ngForOf",oP(1,kle)))}function wle(e,t){if(1&e&&(Pm(),mb(0),yb(1,"rect",8),lb(2,_le,2,2,"ng-container",3),kb()),2&e){var n=t.$implicit,r=t.index,i=Pb(),a=i.index,o=i.$implicit,s=Pb();Rw(1),db("ngClass",s.getBlockClasses(r,a)),ob("x",s.STROKE_WIDTH+n)("y",s.STROKE_WIDTH+o)("rx",3*s.STROKE_WIDTH)("ry",3*s.STROKE_WIDTH)("width",s.BLOCK_WIDTH)("height",s.BLOCK_WIDTH),Rw(1),db("ngForOf",oP(8,kle))}}var Cle=function(e){return[0,e]};function ble(e,t){if(1&e&&(Pm(),mb(0),lb(1,wle,3,9,"ng-container",3),kb()),2&e){var n=Pb();Rw(1),db("ngForOf",sP(1,Cle,n.BLOCK_SEPARATION))}}function Ele(e,t){if(1&e&&(Pm(),yb(0,"circle",10)),2&e){var n=Pb();Ib("id","currentDrop_",n.currentDrop.get().x,"_",n.currentDrop.get().y,""),db("ngClass",n.getPlayerClass(n.rules.node.gameState.getCurrentPlayer())),ob("cx",n.getCenter(n.currentDrop.get().x))("cy",n.getCenter(n.currentDrop.get().y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)}}function Sle(e,t){if(1&e){var n=_b();Pm(),pb(0,"path",11),bb("click",function(){var e=Jy(n).$implicit;return Pb().rotate(e)}),gb()}if(2&e){var r=t.$implicit,i=Pb();Ib("id","rotate_",r[1],"_",r[2]?"clockwise":"counterclockwise",""),ob("d",r[0])("stroke-width",2*i.STROKE_WIDTH)}}function Ple(e,t){if(1&e&&(Pm(),yb(0,"circle",12)),2&e){var n=t.$implicit,r=Pb();Ib("id","victoryCoord_",n.x,"_",n.y,""),db("ngClass",r.getSquareClasses(n.x,n.y)),ob("cx",r.getCenter(n.x))("cy",r.getCenter(n.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function Ole(e,t){if(1&e){var n=_b();Pm(),pb(0,"g",13),bb("click",function(){return Jy(n),Pb().skipRotation()}),yb(1,"circle",14),yb(2,"line",15),gb()}if(2&e){var r=Pb();Rw(1),ob("cx",r.BLOCK_SEPARATION)("cy",r.BLOCK_SEPARATION)("r",.75*r.SPACE_SIZE)("stroke-width",2*r.STROKE_WIDTH),Rw(1),ob("x1",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("y1",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("x2",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("y2",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("stroke-width",2*r.STROKE_WIDTH)}}var Tle=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).arrows=[],r.victoryCoords=[],r.rules=new fle(hle),r.availableMinimaxes=[new dle(r.rules,"PentagoMinimax")],r.encoder=cle.encoder,r.tutorial=(new yle).tutorial,r.BLOCK_WIDTH=3*r.SPACE_SIZE+2*r.STROKE_WIDTH,r.BLOCK_SEPARATION=r.BLOCK_WIDTH+2*r.STROKE_WIDTH,r.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*r.SPACE_SIZE,r.ARROWS=r.generateArrowsCoord(),r.updateBoard(),r}return cp(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.rules.node.gameState),this.showLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{var t=e.get();this.movedBlock=t.blockTurned;var n=new lre(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new lre(0,0))&&this.coordBelongToBlock(t)){var r;r=t.turnedClockwise?oB.getNonNullable(hle.ROTATION_MAP.find(function(e){return e[0].equals(n)}))[1]:oB.getNonNullable(hle.ROTATION_MAP.find(function(e){return e[1].equals(n)}))[0];var i=t.blockTurned.get();r=r.getNext(new are(i%2==0?1:4,i<2?1:4),1),this.lastDrop=hB.of(r)}else this.lastDrop=hB.of(t.coord)}}},{key:"coordBelongToBlock",value:function(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}},{key:"hidePreviousMove",value:function(){this.lastDrop=hB.empty(),this.movedBlock=hB.empty(),this.victoryCoords=[]}},{key:"generateArrowsCoord",value:function(){var e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}},{key:"cancelMoveAttempt",value:function(){this.arrows=[],this.currentDrop=hB.empty(),this.canSkipRotation=!1}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(!n.board[t][e].isPlayer()){r.next=5;break}return r.abrupt("return",n.cancelMove(kre.MUST_LAND_ON_EMPTY_SPACE()));case 5:if(a=cle.rotationless(e,t),o=n.rules.node.gameState,4!==(s=o.applyLegalDrop(a)).neutralBlocks.length){r.next=8;break}return r.abrupt("return",n.chooseMove(a,o));case 8:return u=n.rules.getGameStatus(n.rules.node),r.abrupt("return",(n.canSkipRotation=s.neutralBlocks.length>0&&!1===u.isEndGame,n.currentDrop=hB.of(new lre(e,t)),n.displayArrows(s.neutralBlocks),e6.SUCCESS));case 10:case"end":return r.stop()}},r)}))()}},{key:"getCenter",value:function(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}},{key:"displayArrows",value:function(e){var t=this;this.arrows=[];for(var n=function(n){if(!1===e.includes(n)){var r=t.ARROWS.filter(function(e){return e[1]===n});t.arrows=t.arrows.concat(r)}},r=0;r<4;r++)n(r)}},{key:"getBlockClasses",value:function(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved"]:[]}},{key:"getSquareClasses",value:function(e,t){var n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new lre(e,t))&&n.push("last-move"),n}},{key:"rotate",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"))).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=t.currentDrop.get(),a=cle.withRotation(i.x,i.y,e[1],e[2]),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 5:case"end":return n.stop()}},n)}))()}},{key:"skipRotation",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.canUserPlay("#skipRotation")).isFailure()){t.next=3;break}return t.abrupt("return",e.cancelMove(n.getReason()));case 3:return r=e.currentDrop.get(),i=cle.rotationless(r.x,r.y),t.abrupt("return",e.chooseMove(i,e.rules.node.gameState));case 5:case"end":return t.stop()}},t)}))()}}]),n}(wie);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-pentago"]],features:[jC],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),pb(1,"defs"),pb(2,"marker",1),yb(3,"polygon",2),gb(),gb(),lb(4,ble,2,3,"ng-container",3),lb(5,Ele,1,6,"circle",4),lb(6,Sle,1,4,"path",5),lb(7,Ple,1,7,"circle",6),lb(8,Ole,3,9,"g",7),gb()),2&e&&(Rw(4),db("ngForOf",sP(5,Cle,t.BLOCK_SEPARATION)),Rw(1),db("ngIf",t.currentDrop.isPresent()),Rw(1),db("ngForOf",t.arrows),Rw(1),db("ngForOf",t.victoryCoords),Rw(1),db("ngIf",t.canSkipRotation))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ile=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;if(sp(this,n),(a=t.call(this,e,r)).z=i,e<0||e>3)throw new Error("PylosCoord: Invalid X: ".concat(e,"."));if(r<0||r>3)throw new Error("PylosCoord: Invalid Y: ".concat(r,"."));if(i<0||i>3)throw new Error("PylosCoord: Invalid Z: ".concat(i,"."));var o=4-i;if(a.isNotInRange(o,o))throw new Error(a.toString()+" is not in range.");return Qv(a)}return cp(n,[{key:"toString",value:function(){return"PylosCoord"+this.toShortString()}},{key:"toShortString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"isUpperThan",value:function(e){return this.z>e.z}},{key:"getLowerPieces",value:function(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");var e=this.z-1;return[new n(this.x,this.y,e),new n(this.x+1,this.y,e),new n(this.x,this.y+1,e),new n(this.x+1,this.y+1,e)]}},{key:"getHigherPieces",value:function(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");var e=this.z+1,t=new lre(this.x-1,this.y-1),r=new lre(this.x,this.y-1),i=new lre(this.x-1,this.y),a=new lre(this.x,this.y),o=4-e;return[t,r,i,a].filter(function(e){return e.isInRange(o,o)}).map(function(t){return new n(t.x,t.y,e)})}},{key:"getNextValid",value:function(e){var t=new lre(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?hB.empty():hB.of(new n(t.x,t.y,this.z))}}],[{key:"encodeOptional",value:function(e){return e.isPresent()?n.encode(e.get())+1:0}},{key:"encode",value:function(e){return 16*e.x+4*e.y+e.z}},{key:"decodeToOptional",value:function(e){return 0===e?hB.empty():hB.of(n.decode(e-1))}},{key:"decode",value:function(e){var t=e%4;e-=t;var r=(e/=4)%4;return e-=r,new n(e/=4,r,t)}}]),n}(lre),xle=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this)).startingCoord=e,o.landingCoord=r,o.firstCapture=i,o.secondCapture=a,o}return cp(n,[{key:"isClimb",value:function(){return this.startingCoord.isPresent()}},{key:"toString",value:function(){var e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}},{key:"equals",value:function(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}],[{key:"fromClimb",value:function(e,t,r){var i=hB.of(e),a=n.checkCaptures(r),o=new n(i,t,a.firstCapture,a.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return o}},{key:"checkCaptures",value:function(e){var t=hB.empty(),n=hB.empty();if(e.length>0&&(t=hB.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=hB.of(e[1]),e[1].isUpperThan(e[0])&&(t=hB.of(e[1]),n=hB.of(e[0])),e.length>2)throw new Error("PylosMove: can't capture that much piece.")}return{firstCapture:t,secondCapture:n}}},{key:"fromDrop",value:function(e,t){var r=hB.empty(),i=n.checkCaptures(t);return new n(r,e,i.firstCapture,i.secondCapture)}},{key:"changeCapture",value:function(e,t){var r=n.checkCaptures(t);return new n(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}}]),n}(Ore);xle.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 17575999}},{key:"encodeNumber",value:function(e){var t=Ile.encode(e.landingCoord),n=Ile.encodeOptional(e.startingCoord),r=Ile.encodeOptional(e.firstCapture);return 270400*Ile.encodeOptional(e.secondCapture)+4160*r+64*n+t}},{key:"decodeNumber",value:function(e){var t=Ile.decode(e%64);e-=e%64;var n=Ile.decodeToOptional((e/=64)%65);e-=e%65;var r=Ile.decodeToOptional((e/=65)%65);e-=e%65;var i=Ile.decodeToOptional(e/=65);return new xle(n,t,r,i)}}]),n}(rte));var Ale=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,r)).boards=e,i}return cp(n,[{key:"getPieceAt",value:function(e){return this.boards[e.z][e.y][e.x]}},{key:"applyLegalMove",value:function(e){var t=[];return t.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&t.push({coord:e.startingCoord.get(),value:ate.NONE}),e.firstCapture.isPresent()&&t.push({coord:e.firstCapture.get(),value:ate.NONE}),e.secondCapture.isPresent()&&t.push({coord:e.secondCapture.get(),value:ate.NONE}),this.setBoardAts(t,this.turn+1)}},{key:"setBoardAts",value:function(e,t){var r,i=[lte.copyBiArray(this.boards[0]),lte.copyBiArray(this.boards[1]),lte.copyBiArray(this.boards[2]),lte.copyBiArray(this.boards[3])],a=ip(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.coord;i[s.z][s.y][s.x]=o.value}}catch(u){a.e(u)}finally{a.f()}return new n(i,t)}},{key:"isLandable",value:function(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;var t,n=ip(e.getLowerPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)===ate.NONE)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"isSupporting",value:function(e){if(3===e.z)return!1;var t,n=ip(e.getHigherPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r).isPlayer())return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getPiecesRepartition",value:function(){var e={};e[ate.NONE.value]=0,e[ote.ZERO.value]=0,e[ote.ONE.value]=0;for(var t=0;t<3;t++)for(var n=0;n<4-t;n++)for(var r=0;r<4-t;r++){var i=new Ile(r,n,t),a=this.getPieceAt(i);e[a.value]=1+e[a.value]}return e}}],[{key:"getInitialState",value:function(){return new n([lte.createTable(4,4,ate.NONE),lte.createTable(3,3,ate.NONE),lte.createTable(2,2,ate.NONE),[[ate.NONE]]],0)}}]),n}(Ere),Rle=function(){var e=cp(function e(){sp(this,e)});return e.MUST_MOVE_UPWARD=function(){return $localize(Ao||(Ao=Vv(["You must move your pieces upward."])))},e.SHOULD_HAVE_SUPPORTING_PIECES=function(){return $localize(Ro||(Ro=Vv(["Your piece must land on the board or on 4 other pieces."])))},e.CANNOT_LAND=function(){return $localize(No||(No=Vv(["You cannot land on this space."])))},e.CANNOT_CAPTURE=function(){return $localize(Mo||(Mo=Vv(["You cannot capture."])))},e.INVALID_FIRST_CAPTURE=function(){return $localize(Do||(Do=Vv(["Your first capture is invalid."])))},e.INVALID_SECOND_CAPTURE=function(){return $localize(Lo||(Lo=Vv(["Your second capture is invalid."])))},e}(),Nle=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.landingCoord).isPlayer())return J5.failure(kre.MUST_LAND_ON_EMPTY_SPACE());var r=t.getCurrentOpponent();if(e.startingCoord.isPresent()){var i=e.startingCoord.get(),a=t.getPieceAt(i);if(a===r)return J5.failure(kre.CANNOT_CHOOSE_OPPONENT_PIECE());if(a===ate.NONE)return J5.failure(kre.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.getHigherPieces().filter(function(n){return t.getPieceAt(n).isPlayer()||n.equals(e.landingCoord)}).length>0)return J5.failure(Rle.SHOULD_HAVE_SUPPORTING_PIECES())}if(!t.isLandable(e.landingCoord))return J5.failure(Rle.CANNOT_LAND());if(e.firstCapture.isPresent()){if(!1===n.canCapture(t,e.landingCoord))return J5.failure(Rle.CANNOT_CAPTURE());if(!n.isValidCapture(t,e,e.firstCapture.get()))return J5.failure(Rle.INVALID_FIRST_CAPTURE());if(e.secondCapture.isPresent()&&!n.isValidCapture(t,e,e.secondCapture.get()))return J5.failure(Rle.INVALID_SECOND_CAPTURE())}return J5.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getStateInfo",value:function(e){for(var t=[],n=[],r=0;r<3;r++)for(var i=0;i<4-r;i++)for(var a=0;a<4-r;a++){var o=new Ile(a,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}},{key:"getClimbingMoves",value:function(e){var t,n=[],r=ip(e.freeToMove);try{var i=function(){var r,i=t.value,a=ip(e.landable);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.isUpperThan(i)&&!1===o.getLowerPieces().some(function(e){return i.equals(e)})){var s=xle.fromClimb(i,o,[]);n.push(s)}}}catch(u){a.e(u)}finally{a.f()}};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getDropMoves",value:function(e){var t,n=[],r=ip(e.landable);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=xle.fromDrop(i,[]);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"canCapture",value:function(e,t){for(var n=e.getCurrentPlayer(),r=0,i=[cre.UP,cre.DOWN];r<i.length;r++){var a=i[r],o=t.getNextValid(a);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(var s=0,u=[cre.LEFT,cre.RIGHT];s<u.length;s++){var c=u[s],l=o.get().getNextValid(c);if(l.isPresent()&&e.getPieceAt(l.get())===n){var h=a.getOpposite(),f=l.get().getNextValid(h).get();if(e.getPieceAt(f)===n)return!0}}}return!1}},{key:"getPossibleCaptures",value:function(e,t,n){for(var r=[],i=(e=e.filter(function(e){return!1===t.equalsValue(e)})).concat(n),a=0;a<i.length;a++){var o=i[a];r.push([o]);for(var s=a+1;s<i.length;s++)r.push([i[s],o])}return r}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isValidCapture",value:function(e,t,n){var r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r||n.getHigherPieces().filter(function(n){return e.getPieceAt(n).isPlayer()&&!1===n.equals(t.firstCapture.get())}).length>0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getPiecesRepartition();return 15===t[ote.ZERO.value]?Dre.ONE_WON:15===t[ote.ONE.value]?Dre.ZERO_WON:Dre.ONGOING}}]),n}(Lre),Mle=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){return n.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=Nle.getGameStatus(e);if(t.isEndGame)return new wre(t.toBoardValue());var n=e.gameState.getPiecesRepartition();return new wre(n[ote.ZERO.value]-n[ote.ONE.value])}}],[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=[],i=Nle.getStateInfo(n),a=Nle.getClimbingMoves(i),o=Nle.getDropMoves(i),s=ip(a.concat(o));try{for(s.s();!(t=s.n()).done;){var u=t.value,c=[[]];Nle.canCapture(n,u.landingCoord)&&(c=Nle.getPossibleCaptures(i.freeToMove,u.startingCoord,u.landingCoord));var l,h=ip(c);try{for(h.s();!(l=h.n()).done;){var f=l.value,d=xle.changeCapture(u,f);r.push(d)}}catch(v){h.e(v)}finally{h.f()}}}catch(v){s.e(v)}finally{s.f()}return r}}]),n}(_re),Dle=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t=Mle.getListMoves(e);return this.orderMoves(t)}},{key:"orderMoves",value:function(e){return e.sort(function(e,t){var r=12*n.countStoneUsed(e),i=12*n.countStoneUsed(t);return r+n.sumMoveEmplacementByValue(e)-(i+n.sumMoveEmplacementByValue(t))})}}],[{key:"countStoneUsed",value:function(e){var t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}},{key:"sumMoveEmplacementByValue",value:function(e){var t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}]),n}(Mle),Lle=ate.NONE,Fle=ote.ZERO,Ble=ote.ONE,Ule=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(Fo||(Fo=Vv(["Goal of the game"]))),$localize(Bo||(Bo=Vv(["At Pylos, the goal is to be the last to play.\n        To do this, you have to save up your pieces.\n        As soon as a player puts its last piece, that player loses the game immediately.\n        Here is what the initial board looks like, it is a board of 4 x 4 squares.\n        This board will become a pyramid, little by little.\n        It will be filled by the pieces of your stock. Each player has 15 pieces."]))),Ale.getInitialState()),Vre.anyMove($localize(Uo||(Uo=Vv(["Dropping a piece"]))),$localize(Vo||(Vo=Vv(["When it is your turn, you can always drop one of your piece on an empty square.\n        The gray squares are where you can drop your pieces.<br/><br/>\n        Click on one of the squares to drop a piece there."]))),Ale.getInitialState(),xle.fromDrop(new Ile(1,1,0),[]),$localize(zo||(zo=Vv(["There you go, as simple as that."])))),Vre.fromMove($localize(Ho||(Ho=Vv(["Climbing"]))),$localize(Go||(Go=Vv(["When 4 pieces form a square, it is possible to put a fifth piece on top.\n        However, when that happens, you can save a piece by climbing instead of dropping a piece.\n        To climb:\n        <ol>\n            <li>Click on one of your free pieces, which should be lower than the landing square.</li>\n            <li>Click on an empty landing square, higher than your selected piece.</li>\n        </ol><br/>\n        Go ahead, climb!"]))),new Ale([[[Fle,Ble,Lle,Lle],[Ble,Fle,Lle,Lle],[Lle,Lle,Lle,Lle],[Lle,Lle,Lle,Fle]],[[Lle,Lle,Lle],[Lle,Lle,Lle],[Lle,Lle,Lle]],[[Lle,Lle],[Lle,Lle]],[[Lle]]],0),[xle.fromClimb(new Ile(3,3,0),new Ile(0,0,1),[])],$localize(qo||(qo=Vv(["Congratulations!<br/>\n        Some important notes:\n        <ol>\n            <li>You cannot move a piece that is directly below another one.</li>\n            <li>Of course, you cannot move the opponent's pieces.</li>\n            <li>You can only climb when the landing square is higher than the starting square.</li>\n        </ol>"]))),$localize($o||($o=Vv(["Failed!"])))),Vre.fromMove($localize(Wo||(Wo=Vv(["Square (1/2)"]))),$localize(jo||(jo=Vv(["When the piece you just moved or dropped is the fourth one of a square of your color,\n        you can choose anywhere on the board one or two of your pieces.\n        These pieces will be removed from the board, allowing you to save up one or two pieces.\n        A chosen piece must not be directly below another piece.\n        A chosen piece can be the piece you just placed.\n        You're playing Dark.<br/><br/>\n        Form a square, then click twice on one of the four pieces to remove only that one."]))),new Ale([[[Fle,Fle,Lle,Lle],[Lle,Fle,Lle,Lle],[Lle,Lle,Lle,Lle],[Lle,Lle,Lle,Lle]],[[Lle,Lle,Lle],[Lle,Lle,Lle],[Lle,Lle,Lle]],[[Lle,Lle],[Lle,Lle]],[[Lle]]],0),[xle.fromDrop(new Ile(0,1,0),[new Ile(0,0,0)]),xle.fromDrop(new Ile(0,1,0),[new Ile(0,1,0)]),xle.fromDrop(new Ile(0,1,0),[new Ile(1,0,0)]),xle.fromDrop(new Ile(0,1,0),[new Ile(1,1,0)])],$localize(Zo||(Zo=Vv(["Congratulations, you have saved up one piece."]))),$localize(Yo||(Yo=Vv(["Failed!"])))),Vre.fromPredicate($localize(Ko||(Ko=Vv(["Square (2/2)"]))),$localize(Jo||(Jo=Vv(["You're playing Dark.<br/><br/>\n        Do like in the previous step, but this time click on two different pieces."]))),new Ale([[[Fle,Fle,Lle,Lle],[Lle,Fle,Lle,Lle],[Lle,Lle,Lle,Lle],[Lle,Lle,Lle,Lle]],[[Lle,Lle,Lle],[Lle,Lle,Lle],[Lle,Lle,Lle]],[[Lle,Lle],[Lle,Lle]],[[Lle]]],0),xle.fromDrop(new Ile(0,1,0),[new Ile(0,0,0),new Ile(1,0,0)]),function(e,t){return e.secondCapture.isPresent()?e6.SUCCESS:e.firstCapture.isPresent()?e6.failure($localize(Qo||(Qo=Vv(["Failed, you only captured one piece."])))):e6.failure($localize(Xo||(Xo=Vv(["Failed, you did not capture any piece."]))))},$localize(es||(es=Vv(["Congratulations, you have saved up two pieces."]))))]});function Vle(e,t){if(1&e&&(Pm(),pb(0,"g"),yb(1,"circle",4),gb()),2&e){var n=t.$implicit,r=Pb().$implicit,i=Pb();Rw(1),Ib("id","piece_",r,"_",n,""),db("ngClass",i.getPlayerPieceClass(r)),ob("cx",.5*i.SPACE_SIZE+(800-i.SPACE_SIZE)/14*n)("cy",860+(i.SPACE_SIZE+10)*r)("r",.5*i.SPACE_SIZE)}}function zle(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Vle,2,6,"g",1),gb()),2&e){var n=t.$implicit,r=Pb();Rw(1),db("ngForOf",r.getPlayerSidePieces(n))}}function Hle(e,t){if(1&e){var n=_b();Pm(),pb(0,"circle",8),bb("click",function(){Jy(n);var e=Pb(2).$implicit,t=Pb().$implicit,r=Pb().$implicit;return Pb().onPieceClick(e,t,r)}),gb()}if(2&e){var r=Pb(2).$implicit,i=Pb().$implicit,a=Pb().$implicit,o=Pb();xb("id","piece_",r,"_",i,"_",a,""),db("ngClass",o.getPieceClasses(r,i,a)),ob("r",o.getPieceRadius(a)-o.STROKE_WIDTH)("cx",o.getPieceCx(r,i,a))("cy",o.getPieceCy(r,i,a))}}function Gle(e,t){if(1&e){var n=_b();Pm(),pb(0,"rect",8),bb("click",function(){Jy(n);var e=Pb(2).$implicit,t=Pb().$implicit,r=Pb().$implicit;return Pb().onDrop(e,t,r)}),gb()}if(2&e){var r=Pb(2).$implicit,i=Pb().$implicit,a=Pb().$implicit,o=Pb();xb("id","drop_",r,"_",i,"_",a,""),db("ngClass",o.getSquareClasses(r,i,a)),ob("width",2*o.getPieceRadius(a))("height",2*o.getPieceRadius(a))("x",o.getPieceCx(r,i,a)-o.getPieceRadius(a))("y",o.getPieceCy(r,i,a)-o.getPieceRadius(a))}}function qle(e,t){if(1&e&&(Pm(),mb(0),lb(1,Hle,1,7,"circle",6),lb(2,Gle,1,8,"ng-template",null,7,NP),kb()),2&e){var n=hb(3),r=Pb().$implicit,i=Pb().$implicit,a=Pb().$implicit,o=Pb();Rw(1),db("ngIf",o.isOccupied(r,i,a))("ngIfElse",n)}}function $le(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,qle,4,2,"ng-container",5),gb()),2&e){var n=t.$implicit,r=Pb().$implicit,i=Pb().$implicit,a=Pb();Rw(1),db("ngIf",a.isDrawable(n,r,i))}}function Wle(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,$le,2,1,"g",1),gb()),2&e){var n=Pb().$implicit,r=Pb();Rw(1),db("ngForOf",r.getLevelRange(n))}}function jle(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Wle,2,1,"g",1),gb()),2&e){var n=t.$implicit,r=Pb();Rw(1),db("ngForOf",r.getLevelRange(n))}}function Zle(e,t){if(1&e&&(Pm(),yb(0,"rect",9)),2&e){var n=Pb();xb("id","highCapture_",n.highCapture.get().x,"_",n.highCapture.get().y,"_",n.highCapture.get().z,""),ob("width",2*n.getPieceRadius(n.highCapture.get().z))("height",2*n.getPieceRadius(n.highCapture.get().z))("x",n.getPieceCx(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))("y",n.getPieceCy(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))}}var Yle=function(){return[0,1]},Kle=function(){return[0,1,2]},Jle=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).lastLandingCoord=hB.empty(),r.lastStartingCoord=hB.empty(),r.lastFirstCapture=hB.empty(),r.lastSecondCapture=hB.empty(),r.highCapture=hB.empty(),r.chosenStartingCoord=hB.empty(),r.chosenLandingCoord=hB.empty(),r.chosenFirstCapture=hB.empty(),r.lastMove=hB.empty(),r.remainingPieces={0:15,1:15},r.rules=new Nle(Ale),r.availableMinimaxes=[new Mle(r.rules,"PylosMinimax"),new Dle(r.rules,"PylosOrderedMinimax")],r.encoder=xle.encoder,r.tutorial=(new Ule).tutorial,r.SPACE_SIZE=r.getPieceRadius(0),r.updateBoard(),r}return cp(n,[{key:"getLevelRange",value:function(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return oB.expectToBe(e,2),[0,1]}}},{key:"isDrawable",value:function(e,t,n){var r=new Ile(e,t,n);return this.state.getPieceAt(r)!==ate.NONE||this.state.isLandable(r)}},{key:"onPieceClick",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#piece_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Ile(e,t,n),i.abrupt("return",r.state.getPieceAt(o)===r.state.getCurrentOpponent()?r.cancelMove(kre.CANNOT_CHOOSE_OPPONENT_PIECE()):r.chosenLandingCoord.isAbsent()?(r.chosenStartingCoord=hB.of(o),e6.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=hB.of(o),e6.SUCCESS):r.chosenFirstCapture.equalsValue(o)?r.concludeMoveWithCapture([r.chosenFirstCapture.get()]):r.concludeMoveWithCapture([r.chosenFirstCapture.get(),o]));case 5:case"end":return i.stop()}},i)}))()}},{key:"concludeMoveWithCapture",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(r=t.chosenStartingCoord.isAbsent()?xle.fromDrop(t.chosenLandingCoord.get(),e):xle.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(r,t.state)));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.cancelMove(),n.chooseMove(e,t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenStartingCoord=hB.empty(),this.chosenLandingCoord=hB.empty(),this.chosenFirstCapture=hB.empty()}},{key:"onDrop",value:function(e,t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#drop_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new Ile(e,t,n),i.abrupt("return",Nle.canCapture(r.state,o)?(r.chosenLandingCoord=hB.of(o),e6.SUCCESS):r.isCapturelessMoveFinished(o)?(r.chosenLandingCoord=hB.of(o),r.concludeMoveWithCapture([])):r.cancelMove(Rle.MUST_MOVE_UPWARD()));case 5:case"end":return i.stop()}},i)}))()}},{key:"isCapturelessMoveFinished",value:function(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}},{key:"getSquareClasses",value:function(e,t,n){var r=new Ile(e,t,n);if(this.lastMove.isPresent()){var i=this.lastMove.get();if(i.firstCapture.equalsValue(r)||i.secondCapture.equalsValue(r))return["captured"];if(r.equals(i.landingCoord)||i.startingCoord.equalsValue(r))return["moved"]}return[]}},{key:"getPieceRadius",value:function(e){return 90+5*e}},{key:"getPieceCx",value:function(e,t,n){return 100+100*n+200*e}},{key:"getPieceCy",value:function(e,t,n){return 100+100*n+200*t}},{key:"isOccupied",value:function(e,t,n){var r=new Ile(e,t,n),i=this.rules.node.gameState.getPieceAt(r).isPlayer(),a=this.chosenLandingCoord.equalsValue(r);return i||a}},{key:"getPieceClasses",value:function(e,t,n){var r=new Ile(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("highlighted"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected"),this.chosenFirstCapture.equalsValue(r)&&i.push("pre-captured"),i}},{key:"getPieceFillClass",value:function(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerPieceClass(this.state.getPieceAt(e).value)}},{key:"getPlayerPieceClass",value:function(e){return this.getPlayerClass(ote.of(e))}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.remainingPieces[e],n=[],r=0;r<t;r++)n.push(r);return n}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move;var e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=hB.empty(),this.lastMove.isPresent()?this.showLastMove():(this.lastLandingCoord=hB.empty(),this.lastStartingCoord=hB.empty(),this.lastFirstCapture=hB.empty(),this.lastSecondCapture=hB.empty(),this.chosenFirstCapture=hB.empty(),this.chosenStartingCoord=hB.empty(),this.chosenLandingCoord=hB.empty())}},{key:"showLastMove",value:function(){var e=this.lastMove.get();this.lastLandingCoord=hB.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.isDrawableCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}},{key:"isDrawableCoord",value:function(e){return this.isDrawable(e.x,e.y,e.z)}}]),n}(hre);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-pylos"]],features:[jC],decls:5,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 1021","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0","width","800","height","800",1,"base"],["class","base captured",3,"id",4,"ngIf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base",3,"id","ngClass","click"],[1,"base","captured",3,"id"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,zle,2,1,"g",1),yb(2,"rect",2),lb(3,jle,2,1,"g",1),lb(4,Zle,1,7,"rect",3),gb()),2&e&&(Rw(1),db("ngForOf",oP(3,Yle)),Rw(2),db("ngForOf",oP(4,Kle)),Rw(1),db("ngIf",t.highCapture.isPresent()))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Qle=function(){function e(t){sp(this,e),this.value=t}return cp(e,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"QuartoPiece("+this.value+")"}},{key:"isRectangle",value:function(){return this.value%4<2}}],[{key:"fromInt",value:function(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.NONE;throw new Error("Invalid piece ("+t+")")}}]),e}();Qle.AAAA=new Qle(0),Qle.AAAB=new Qle(1),Qle.AABA=new Qle(2),Qle.AABB=new Qle(3),Qle.ABAA=new Qle(4),Qle.ABAB=new Qle(5),Qle.ABBA=new Qle(6),Qle.ABBB=new Qle(7),Qle.BAAA=new Qle(8),Qle.BAAB=new Qle(9),Qle.BABA=new Qle(10),Qle.BABB=new Qle(11),Qle.BBAA=new Qle(12),Qle.BBAB=new Qle(13),Qle.BBBA=new Qle(14),Qle.BBBB=new Qle(15),Qle.NONE=new Qle(16),Qle.pieces=[Qle.AAAA,Qle.AAAB,Qle.AABA,Qle.AABB,Qle.ABAA,Qle.ABAB,Qle.ABBA,Qle.ABBB,Qle.BAAA,Qle.BAAB,Qle.BABA,Qle.BABB,Qle.BBAA,Qle.BBAB,Qle.BBBA,Qle.BBBB];var Xle=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r)).piece=i,a}return cp(n,[{key:"toString",value:function(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}},{key:"equals",value:function(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}]),n}(Tre);Xle.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 496}},{key:"encodeNumber",value:function(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}},{key:"decodeNumber",value:function(e){var t=e%32;e-=t;var n=(e/=32)%4;return e-=n,new Xle(e/=4,n,Qle.fromInt(t))}}]),n}(rte));var ehe=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,e,r)).pieceInHand=i,a}return cp(n,[{key:"getRemainingPieces",value:function(){var e,t=[],r=ip(Qle.pieces);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.isGivable(i,this.board,this.pieceInHand)&&t.push(i)}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"getInitialState",value:function(){return new n(lte.createTable(4,4,Qle.NONE),0,Qle.AAAA)}},{key:"isGivable",value:function(e,t,r){return e!==r&&!1===n.isAlreadyOnBoard(e,t)}},{key:"isAlreadyOnBoard",value:function(e,t){for(var n=0;n<4;n++)for(var r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}}]),n}(Sre),the=function(){var e=cp(function e(){sp(this,e)});return e.MUST_GIVE_A_PIECE=function(){return $localize(ts||(ts=Vv(["You must give a piece."])))},e.PIECE_ALREADY_ON_BOARD=function(){return $localize(ns||(ns=Vv(["That piece is already on the board."])))},e.CANNOT_GIVE_PIECE_IN_HAND=function(){return $localize(rs||(rs=Vv(["You cannot give the piece that was in your hands."])))},e}(),nhe=function(){function e(t){sp(this,e),this.subCriterion=[hB.empty(),hB.empty(),hB.empty(),hB.empty()],this.subCriterion[0]=hB.of(8==(8&t.value)),this.subCriterion[1]=hB.of(4==(4&t.value)),this.subCriterion[2]=hB.of(2==(2&t.value)),this.subCriterion[3]=hB.of(1==(1&t.value))}return cp(e,[{key:"mergeWith",value:function(e){for(var t=4,n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=hB.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}},{key:"mergeWithQuartoPiece",value:function(t){var n=new e(t);return this.mergeWith(n)}},{key:"areAllAbsent",value:function(){for(var e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}},{key:"match",value:function(e){for(var t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}},{key:"matchPiece",value:function(t){return this.match(new e(t))}},{key:"toString",value:function(){return"Criterion{"+this.subCriterion.map(function(e){return e.isPresent()?e.get()?"1":"0":"x"}).join(" ")+"}"}}]),e}(),rhe=function(){function e(t,n){sp(this,e),this.initialCoord=t,this.direction=n}return cp(e,[{key:"allCoords",value:function(){for(var e=[],t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}]),e}(),ihe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t).toFallible(void 0)}},{key:"applyLegalMove",value:function(e,t){var n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new ehe(n,t.turn+1,e.piece)}},{key:"getGameStatus",value:function(e){var t,r=e.gameState,i={score:xre.DEFAULT,sensitiveSquares:new Wie},a=ip(n.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=n.updateBoardStatus(o,r,i)).score===xre.VICTORY)return n.scoreToGameStatus(i.score,r.turn)}}catch(s){a.e(s)}finally{a.f()}return n.scoreToGameStatus(i.score,r.turn)}},{key:"getVictoriousCoords",value:function(e){var t,r=ip(n.lines);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.isThereAVictoriousLine(i,e))return i.allCoords()}}catch(a){r.e(a)}finally{r.f()}return[]}}],[{key:"isOccupied",value:function(e){return e!==Qle.NONE}},{key:"isLegal",value:function(e,t){var r=e.coord.x,i=e.coord.y,a=e.piece,o=t.getCopiedBoard(),s=t.pieceInHand;return n.isOccupied(o[i][r])?e6.failure(kre.MUST_LAND_ON_EMPTY_SPACE()):a===Qle.NONE?15===t.turn?e6.SUCCESS:e6.failure(the.MUST_GIVE_A_PIECE()):ehe.isAlreadyOnBoard(a,o)?e6.failure(the.PIECE_ALREADY_ON_BOARD()):s===a?e6.failure(the.CANNOT_GIVE_PIECE_IN_HAND()):e6.SUCCESS}},{key:"updateBoardStatus",value:function(e,t,n){return n.score===xre.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:xre.VICTORY,sensitiveSquares:new Wie}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}},{key:"isThereAVictoriousLine",value:function(e,t){for(var r=e.initialCoord,i=t.getPieceAt(r),a=new nhe(i),o=0;o<3&&!1!==n.isOccupied(i)&&!a.areAllAbsent();o++)r=r.getNext(e.direction,1),i=t.getPieceAt(r),a.mergeWithQuartoPiece(i);return!(!n.isOccupied(i)||a.areAllAbsent())}},{key:"searchForVictoryOrPreVictoryInLine",value:function(e,t,r){var i=n.getLineInfos(e,t,r);if(i.boardStatus.isPresent())return i.boardStatus.get();var a=i.commonCriterion,o=i.sensitiveCoord;if(a.isPresent()&&!1===a.get().areAllAbsent()){if(o.isAbsent())return{score:xre.VICTORY,sensitiveSquares:new Wie};a.get().matchPiece(t.pieceInHand)&&(r.score=xre.PRE_VICTORY);var s=o.get();r.sensitiveSquares.add(s)}return r}},{key:"getLineInfos",value:function(e,t,r){for(var i=hB.empty(),a=hB.empty(),o=e.initialCoord,s=0;s<4;s++){var u=t.getPieceAt(o);if(u===Qle.NONE){if(!i.isAbsent())return{sensitiveCoord:hB.of(o),commonCriterion:a,boardStatus:hB.of(r)};i=hB.of(o)}else a.isAbsent()?(a=hB.of(new nhe(u)),sB(n.VERBOSE,"set commonCrit to "+a.toString())):(a.get().mergeWithQuartoPiece(u),sB(n.VERBOSE,"update commonCrit: "+a.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:a,sensitiveCoord:i,boardStatus:hB.empty()}}},{key:"scoreToGameStatus",value:function(e,t){var n=ote.of(t%2);return e===xre.VICTORY?Dre.getDefeat(n):16===t?Dre.DRAW:Dre.ONGOING}}]),n}(Lre);ihe.VERBOSE=!1,ihe.lines=[new rhe(new lre(0,0),ure.DOWN),new rhe(new lre(1,0),ure.DOWN),new rhe(new lre(2,0),ure.DOWN),new rhe(new lre(3,0),ure.DOWN),new rhe(new lre(0,0),ure.RIGHT),new rhe(new lre(0,1),ure.RIGHT),new rhe(new lre(0,2),ure.RIGHT),new rhe(new lre(0,3),ure.RIGHT),new rhe(new lre(0,0),ure.DOWN_RIGHT),new rhe(new lre(0,3),ure.UP_RIGHT)];var ahe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),a=n.pieceInHand,o=0;o<4;o++)for(var s=0;s<4;s++)if(r[o][s]===Qle.NONE){if(n.getCopiedBoard()[o][s]=a,15===n.turn){var u=new Xle(s,o,Qle.NONE);return t.push(u),t}var c,l=ip(i);try{for(l.s();!(c=l.n()).done;){var h=c.value,f=new Xle(s,o,h);t.push(f)}}catch(d){l.e(d)}finally{l.f()}}return t}},{key:"getBoardValue",value:function(e){var t,r=e.gameState,i={score:xre.DEFAULT,sensitiveSquares:new Wie},a=ip(ihe.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=ihe.updateBoardStatus(o,r,i)).score===xre.VICTORY)break}}catch(s){a.e(s)}finally{a.f()}return n.scoreToBoardValue(i.score,r.turn)}}],[{key:"scoreToBoardValue",value:function(e,t){if(e===xre.DEFAULT)return new wre(0);var n=ote.of(t%2);return new wre(e===xre.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}]),n}(_re),ohe=Qle.AABA,she=Qle.AABB,uhe=Qle.ABAA,che=Qle.ABAB,lhe=Qle.ABBA,hhe=Qle.BAAA,fhe=Qle.BAAB,dhe=Qle.BABB,vhe=Qle.BBAA,phe=Qle.BBAB,ghe=Qle.BBBA,yhe=Qle.BBBB,mhe=Qle.NONE,khe=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(is||(is=Vv(["Goal of the game"]))),$localize(as||(as=Vv(["Quarto is an alignment game.\n        The goal is to align four pieces that have at least one common aspect:\n        <ul>\n          <li>their color (light or dark),</li>\n          <li>their size (big or small),</li>\n          <li>their pattern (empty or dotted),</li>\n          <li>their shape (round or square).</li>\n        </ul>\n        Here, we have a board with a victory by an alignment of dark pieces."]))),new ehe([[ghe,vhe,uhe,ohe],[mhe,mhe,mhe,mhe],[mhe,mhe,mhe,mhe],[mhe,mhe,mhe,mhe]],7,Qle.ABAB)),Vre.anyMove($localize(os||(os=Vv(["Placement"]))),$localize(ss||(ss=Vv(["Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,\n        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.\n        If you prefer, the order of these two steps can be reversed.\n        Keep in mind that the second click confirms the move.<br/><br/>\n        Make a move."]))),new ehe([[ghe,she,lhe,mhe],[mhe,mhe,mhe,mhe],[mhe,hhe,mhe,mhe],[mhe,mhe,mhe,mhe]],7,Qle.ABAA),new Xle(2,2,Qle.BAAB),$localize(us||(us=Vv(["Perfect!"])))),Vre.fromMove($localize(cs||(cs=Vv(["Situation"]))),$localize(ls||(ls=Vv(["We have here a tricky situation.<br/><br/>\n        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move."]))),new ehe([[yhe,ghe,phe,mhe],[uhe,dhe,vhe,mhe],[che,hhe,fhe,mhe],[mhe,mhe,mhe,mhe]],7,Qle.AABA),[new Xle(3,3,Qle.AABB)],$localize(hs||(hs=Vv(["Well done!"]))),$localize(fs||(fs=Vv(["Failed!"]))))]});function _he(e,t){if(1&e&&(Pm(),yb(0,"rect",11)),2&e){var n=Pb(2),r=n.$implicit,i=n.index,a=Pb().index,o=Pb();db("ngClass",o.getPieceClasses(r.value)),ob("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*a+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function whe(e,t){if(1&e&&(Pm(),yb(0,"circle",11)),2&e){var n=Pb(2),r=n.$implicit,i=n.index,a=Pb().index,o=Pb();db("ngClass",o.getPieceClasses(r.value)),ob("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function Che(e,t){if(1&e&&(Pm(),yb(0,"circle")),2&e){var n=Pb(2).index,r=Pb().index,i=Pb();ob("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function bhe(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,_he,1,5,"rect",9),lb(2,whe,1,4,"ng-template",null,10,NP),lb(4,Che,1,3,"circle",3),gb()),2&e){var n=hb(3),r=Pb().$implicit,i=Pb(2);Rw(1),db("ngIf",r.isRectangle())("ngIfElse",n),Rw(3),db("ngIf",i.pieceHasDot(r.value))}}function Ehe(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",8),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().chooseCoord(e,t)}),gb(),lb(2,bhe,5,3,"g",3),gb()}if(2&e){var r=t.$implicit,i=t.index,a=Pb().index,o=Pb();Rw(1),Ib("id","chooseCoord_",i,"_",a,""),db("ngClass",o.getSquareClasses(i,a)),ob("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Rw(1),db("ngIf",r!==o.EMPTY)}}function She(e,t){if(1&e&&(Pm(),pb(0,"g",null,7),lb(2,Ehe,3,8,"g",2),gb()),2&e){var n=t.$implicit;Rw(2),db("ngForOf",n)}}function Phe(e,t){if(1&e&&(Pm(),yb(0,"rect",15)),2&e){var n=Pb(2);db("ngClass",n.getPieceClasses(n.pieceInHand.value)),ob("x",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("y",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function Ohe(e,t){if(1&e&&(Pm(),yb(0,"circle",11)),2&e){var n=Pb(2);db("ngClass",n.getPieceClasses(n.pieceInHand.value)),ob("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",n.getPieceSize(n.pieceInHand.value))}}function The(e,t){if(1&e&&(Pm(),yb(0,"circle")),2&e){var n=Pb(2);ob("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",10)}}function Ihe(e,t){if(1&e&&(Pm(),pb(0,"g",null,12),yb(2,"rect",13),lb(3,Phe,1,5,"rect",14),lb(4,Ohe,1,4,"ng-template",null,10,NP),lb(6,The,1,3,"circle",3),gb()),2&e){var n=hb(5),r=Pb();ob("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),Rw(2),ob("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),Rw(1),db("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),Rw(3),db("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function xhe(e,t){if(1&e&&(Pm(),pb(0,"g",null,16),yb(2,"rect",17),gb()),2&e){var n=t.$implicit,r=Pb();Rw(2),ob("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+n.x*r.SPACE_SIZE+" "+n.y*r.SPACE_SIZE+")")}}function Ahe(e,t){if(1&e&&(Pm(),yb(0,"rect",11)),2&e){var n=Pb(2);db("ngClass",n.getPieceClasses(n.pieceInHand.value)),ob("x",0)("y",.75*n.SPACE_SIZE)("transform","translate("+-n.getPieceSize(n.pieceInHand.value)+", "+-n.getPieceSize(n.pieceInHand.value)+")")("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function Rhe(e,t){if(1&e&&(Pm(),yb(0,"circle",19)),2&e){var n=Pb(2);db("ngClass",n.getPieceClasses(n.pieceInHand.value)),ob("cy",.75*n.SPACE_SIZE)("r",n.getPieceSize(n.pieceInHand.value))}}function Nhe(e,t){1&e&&(Pm(),yb(0,"circle",20)),2&e&&ob("cy",.75*Pb(2).SPACE_SIZE)("r",10)}function Mhe(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Ahe,1,6,"rect",9),lb(2,Rhe,1,3,"ng-template",null,10,NP),lb(4,Nhe,1,2,"circle",18),gb()),2&e){var n=hb(3),r=Pb();Rw(1),db("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),Rw(3),db("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Dhe(e,t){if(1&e&&(Pm(),yb(0,"rect",27)),2&e){var n=Pb(2).index,r=Pb().index,i=Pb();ob("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Lhe(e,t){if(1&e&&(Pm(),yb(0,"rect",11)),2&e){var n=Pb(2).index,r=Pb().index,i=Pb();db("ngClass",i.getPieceClasses(4*r+n)),ob("x",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("y",i.SPACE_SIZE*r+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("width",2*i.getPieceSize(4*r+n))("height",2*i.getPieceSize(4*r+n))}}function Fhe(e,t){if(1&e&&(Pm(),yb(0,"circle",11)),2&e){var n=Pb(2).index,r=Pb().index,i=Pb();db("ngClass",i.getPieceClasses(4*r+n)),ob("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(4*r+n))}}function Bhe(e,t){if(1&e&&(Pm(),yb(0,"circle")),2&e){var n=Pb(2).index,r=Pb().index,i=Pb();ob("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function Uhe(e,t){if(1&e){var n=_b();Pm(),pb(0,"g",25),bb("click",function(){Jy(n);var e=Pb().index,t=Pb().index;return Pb().choosePiece(4*t+e)}),lb(1,Dhe,1,4,"rect",26),lb(2,Lhe,1,5,"rect",9),lb(3,Fhe,1,4,"ng-template",null,10,NP),lb(5,Bhe,1,3,"circle",3),gb()}if(2&e){var r=hb(4),i=Pb().index,a=Pb().index,o=Pb();Tb("id","choosePiece_",4*a+i,""),Rw(1),db("ngIf",o.pieceToGive.value===4*a+i),Rw(1),db("ngIf",(4*a+i)%4<2)("ngIfElse",r),Rw(3),db("ngIf",o.pieceHasDot(4*a+i))}}function Vhe(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Uhe,6,5,"g",24),gb()),2&e){var n=t.index,r=Pb().index,i=Pb();Rw(1),db("ngIf",i.isRemaining(4*r+n))}}function zhe(e,t){if(1&e&&(Pm(),pb(0,"g",null,21),yb(2,"rect",22,23),lb(4,Vhe,2,1,"g",2),gb()),2&e){var n=t.$implicit,r=Pb();ob("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),Rw(2),ob("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),Rw(2),db("ngForOf",n)}}var Hhe=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).EMPTY=Qle.NONE,r.chosen=hB.empty(),r.lastMove=hB.empty(),r.pieceInHand=Qle.NONE,r.pieceToGive=Qle.NONE,r.victoriousCoords=[],r.rules=new ihe(ehe),r.availableMinimaxes=[new ahe(r.rules,"QuartoMinimax")],r.encoder=Xle.encoder,r.tutorial=(new khe).tutorial,r.pieceInHand=r.rules.node.gameState.pieceInHand,r.updateBoard(),r}return cp(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=hB.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(function(e){return e.coord})}},{key:"chooseCoord",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#chooseCoord_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.hideLastMove(),n.board[t][e]!==Qle.NONE){r.next=11;break}if(n.showPieceInHandOnBoard(e,t),15!==n.rules.node.gameState.turn){r.next=7;break}return a=new Xle(e,t,Qle.NONE),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 7:if(n.pieceToGive!==Qle.NONE){r.next=9;break}return r.abrupt("return",e6.SUCCESS);case 9:return o=new Xle(e,t,n.pieceToGive),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 11:return r.abrupt("return",n.cancelMove(kre.MUST_CLICK_ON_EMPTY_SPACE()));case 12:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#choosePiece_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(t.hideLastMove(),t.pieceToGive=Qle.fromInt(e),!t.chosen.isAbsent()){n.next=5;break}return n.abrupt("return",e6.SUCCESS);case 5:return i=t.chosen.get(),a=new Xle(i.x,i.y,t.pieceToGive),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 7:case"end":return n.stop()}},n)}))()}},{key:"hideLastMove",value:function(){this.lastMove=hB.empty()}},{key:"cancelMoveAttempt",value:function(){this.hideLastMove(),this.pieceToGive=Qle.NONE}},{key:"showPieceInHandOnBoard",value:function(e,t){this.chosen=hB.of(new lre(e,t))}},{key:"isRemaining",value:function(e){return ehe.isGivable(Qle.fromInt(e),this.board,this.pieceInHand)}},{key:"getSquareClasses",value:function(e,t){var n=new lre(e,t);return this.lastMove.equalsValue(n)?["moved"]:[]}},{key:"getPieceClasses",value:function(e){var t=[];return t.push(e%2==0?"player0":"player1"),t}},{key:"getPieceSize",value:function(e){return e<8?40:25}},{key:"pieceHasDot",value:function(e){return e!==Qle.NONE.value&&e%8<4}}]),n}(wie);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-quarto"]],features:[jC],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],["chosenPiece",""],["id","highlight","x","0","y","0",1,"base","highlighted","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],[3,"id","click",4,"ngIf"],[3,"id","click"],["class","base highlighted",4,"ngIf"],[1,"base","highlighted"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),pb(1,"g",1),lb(2,She,3,1,"g",2),lb(3,Ihe,7,6,"g",3),lb(4,xhe,3,3,"g",2),pb(5,"g",null,4),yb(7,"rect",5,6),lb(9,Mhe,5,3,"g",3),gb(),lb(10,zhe,5,6,"g",2),gb(),gb()),2&e&&(ob("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),Rw(2),db("ngForOf",t.board),Rw(1),db("ngIf",t.chosen.isPresent()),Rw(1),db("ngForOf",t.victoriousCoords),Rw(1),ob("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),Rw(2),ob("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),Rw(2),db("ngIf",t.chosen.isAbsent()),Rw(1),db("ngForOf",t.board))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ghe=function(){var e=cp(function e(){sp(this,e)});return e.NO_INSIDE_CLICK=function(){return $localize(ds||(ds=Vv(["You must pick a space from the edge of the board."])))},e}(),qhe=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;sp(this,n),(a=t.call(this,e,r)).direction=i;var o=n.isValidCoord(a.coord);if(o.isFailure())throw new Error(o.getReason());if(0===e&&i===cre.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&i===cre.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===r&&i===cre.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===r&&i===cre.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.");return a}return cp(n,[{key:"toString",value:function(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}],[{key:"isValidCoord",value:function(e){return e.isNotInRange(5,5)?e6.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?e6.failure(Ghe.NO_INSIDE_CLICK()):e6.SUCCESS}}]),n}(Tre);qhe.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 128}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}},{key:"decodeNumber",value:function(e){var t=cre.factory.fromInt(e%4).get();e-=e%4;var n=(e/=4)%5;return e-=e%5,new qhe(e/=5,n,t)}}]),n}(rte));var $he=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e){for(var t=this.getCopiedBoard(),r=this.turn+1,i=e.coord,a=e.coord.getNext(e.direction);a.isInRange(5,5);)t[i.y][i.x]=t[a.y][a.x],i=i.getNext(e.direction),a=a.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new n(t,r)}}],[{key:"getInitialState",value:function(){return new n(lte.createTable(5,5,ate.NONE),0)}}]),n}(Sre),Whe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?J5.failure(kre.CANNOT_CHOOSE_OPPONENT_PIECE()):J5.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getLinesSums(t),i=n.getFullestLine(r[ote.ZERO.value]),a=n.getFullestLine(r[ote.ONE.value]),o=t.getCurrentPlayer();return 5===i&&(o===ote.ZERO||a<5)?Dre.ZERO_WON:5===a?Dre.ONE_WON:Dre.ONGOING}}],[{key:"getVerticalCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new lre(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new lre(4,r));return n}},{key:"getHorizontalCenterCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new lre(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new lre(r,4));return n}},{key:"getPossibleDirections",value:function(e){var t=[];return 0!==e.x&&t.push(cre.LEFT),0!==e.y&&t.push(cre.UP),4!==e.x&&t.push(cre.RIGHT),4!==e.y&&t.push(cre.DOWN),t}},{key:"getLinesSums",value:function(e){var t={};t[ote.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[ote.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(var n=0;n<5;n++)for(var r=0;r<5;r++){var i=e.getPieceAtXY(r,n);if(i.isPlayer()){var a=i.value;t[a].columns[r]=t[a].columns[r]+1,t[a].rows[n]=t[a].rows[n]+1,r===n&&(t[a].diagonals[0]=t[a].diagonals[0]+1),r+n===4&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}},{key:"getVictoriousCoords",value:function(e){for(var t=n.getLinesSums(e),r=[],i=0;i<2;i++){for(var a=0;a<5;a++){if(5===t[i].columns[a])for(var o=0;o<5;o++)r.push(new lre(a,o));if(5===t[i].rows[a])for(var s=0;s<5;s++)r.push(new lre(s,a))}if(5===t[i].diagonals[0])for(var u=0;u<5;u++)r.push(new lre(u,u));if(5===t[i].diagonals[1])for(var c=0;c<5;c++)r.push(new lre(c,4-c))}return r}},{key:"getFullestLine",value:function(e){var t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max.apply(Math,np(t))}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}}]),n}(Lre),jhe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t,n=[],r=Whe.getVerticalCoords(e),i=ip(Whe.getHorizontalCenterCoords(e).concat(r));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=ip(Whe.getPossibleDirections(o));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=new qhe(o.x,o.y,u);n.push(c)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Whe.getLinesSums(t),r=Whe.getFullestLine(n[ote.ZERO.value]),i=Whe.getFullestLine(n[ote.ONE.value]),a=t.getCurrentPlayer();return new wre(5===r&&(a===ote.ZERO||i<5)?ote.ZERO.getVictoryValue():5===i?ote.ONE.getVictoryValue():i-r)}}]),n}(_re),Zhe=function(){function e(){sp(this,e)}return cp(e,null,[{key:"getArrowTransform",value:function(e,t,n){var r,i,a;switch(n){case cre.UP:r=0,i=-1,a=-90;break;case cre.DOWN:r=0,i=1,a=90;break;case cre.LEFT:r=-1,i=0,a=180;break;default:oB.expectToBe(n,cre.RIGHT),r=1,i=0,a=0}return["translate(".concat(t.x*e+e/2+r*e/4," ").concat(t.y*e+e/2+i*e/4,")"),"scale(2.5)","rotate(".concat(a,")")].join(" ")}}]),e}(),Yhe=ate.NONE,Khe=ote.ZERO,Jhe=ote.ONE,Qhe=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(vs||(vs=Vv(["Goal of the game."]))),$localize(ps||(ps=Vv(["At Quixo, the goal is to align 5 of your pieces.\n        The first player plays with dark pieces, the second with light pieces.\n        The board is made of 25 spaces spread over a 5x5 square.\n        Every piece has a neutral side, a light side, and a dark side."]))),$he.getInitialState()),Vre.fromMove($localize(gs||(gs=Vv(["What a move looks like (without animation)"]))),$localize(ys||(ys=Vv(["When it is your turn:\n        <ol>\n            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.\n                You can only choose a piece from the edge of the board.</li>\n            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>\n        </ol>\n        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.\n        Once on the other side, all pieces will move by one space in the opposing direction.\n        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>\n        For example, take the bottom right neutral piece, and move it to the left (you're playing Light)."]))),new $he([[Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe],[Yhe,Yhe,Yhe,Yhe,Yhe],[Khe,Khe,Khe,Khe,Yhe]],1),[new qhe(4,4,cre.LEFT)],$localize(ms||(ms=Vv(["See how the four dark pieces have been moved one space to the right.\n        The neutral piece has been move 4 pieces to the left and has become light."]))),$localize(ks||(ks=Vv(["Failed!"])))),Vre.fromMove($localize(_s||(_s=Vv(["Victory"]))),$localize(ws||(ws=Vv(["You already know everything you need in order to play, but there is one last particularity.\n        If you create a line of 5 of your pieces, you win.\n        If you create a line of 5 of your opponent's pieces, you lose.\n        If you create both, you lose too!<br/><br/>\n        You can win with this board, try it.\n        You're playing Light."]))),new $he([[Yhe,Jhe,Yhe,Jhe,Jhe],[Yhe,Khe,Khe,Yhe,Khe],[Jhe,Jhe,Jhe,Khe,Jhe],[Khe,Yhe,Khe,Jhe,Jhe],[Jhe,Khe,Yhe,Jhe,Khe]],31),[new qhe(3,0,cre.DOWN)],$localize(Cs||(Cs=Vv(["Congratulations, you won!"]))),$localize(bs||(bs=Vv(["Failed!"]))))]});function Xhe(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"circle",4),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onBoardClick(e,t)}),gb(),gb()}if(2&e){var r=t.index,i=Pb().index,a=Pb();Rw(1),Ib("id","click_",r,"_",i,""),db("ngClass",a.getPieceClasses(r,i)),ob("cx",50+100*r)("cy",50+100*i)}}function efe(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Xhe,2,5,"g",2),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function tfe(e,t){if(1&e){var n=_b();Pm(),pb(0,"use",6),bb("click",function(){var e=Jy(n).$implicit;return Pb(2).chooseDirection(e)}),gb()}if(2&e){var r=t.$implicit,i=Pb(2);Tb("id","chooseDirection_",r,""),ob("transform",i.getArrowTransform(i.chosenCoord.get(),r))}}function nfe(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,tfe,1,2,"use",5),gb()),2&e){var n=Pb();Rw(1),db("ngForOf",n.getPossiblesDirections())}}var rfe=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).lastMoveCoord=hB.empty(),r.chosenCoord=hB.empty(),r.victoriousCoords=[],r.rules=new Whe($he),r.availableMinimaxes=[new jhe(r.rules,"QuixoMinimax")],r.encoder=qhe.encoder,r.tutorial=(new Qhe).tutorial,r.updateBoard(),r}return cp(n,[{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(function(e){return e.coord}),this.victoriousCoords=Whe.getVictoriousCoords(this.state)}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=hB.empty()}},{key:"getPieceClasses",value:function(e,t){var n=new lre(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move"),this.victoriousCoords.some(function(e){return e.equals(n)})&&r.push("victory-stroke"),r}},{key:"onBoardClick",value:function(e,t){var n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=new lre(e,t),i=qhe.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(kre.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord=hB.of(r),e6.SUCCESS)}},{key:"getPossiblesDirections",value:function(){var e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push("RIGHT"),0!==t.x&&e.push("LEFT"),4!==t.y&&e.push("DOWN"),0!==t.y&&e.push("UP"),e}},{key:"chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#chooseDirection_"+e)).isFailure()){n.next=5;break}n.t0=t.cancelMove(r.getReason()),n.next=9;break;case 5:return t.chosenDirection=cre.factory.fromString(e).get(),n.next=8,t.tryMove();case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new qhe(n.x,n.y,e.chosenDirection),t.abrupt("return",(e.cancelMove(),e.chooseMove(r,e.rules.node.gameState)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getArrowTransform",value:function(e,t){return Zhe.getArrowTransform(this.SPACE_SIZE,e,cre.factory.fromString(t).get())}}]),n}(wie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-quixo"]],features:[jC],decls:5,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 500 500","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -3.5, 10 0, 0 3.5"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","45",1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",3,"id","click"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),pb(1,"defs"),yb(2,"polygon",1),gb(),lb(3,efe,2,1,"g",2),lb(4,nfe,2,1,"g",3),gb()),2&e&&(Rw(3),db("ngForOf",t.board),Rw(1),db("ngIf",t.chosenCoord.isPresent()))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),ife=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"countScore",value:function(){for(var e=[0,0],t=0;t<n.BOARD_HEIGHT;t++)for(var r=0;r<n.BOARD_WIDTH;r++){var i=this.board[t][r];i.isPlayer()&&(e[i.value]+=1)}return e}}],[{key:"getInitialState",value:function(){var e=lte.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,ate.NONE);return e[3][3]=ote.ZERO,e[4][4]=ote.ZERO,e[3][4]=ote.ONE,e[4][3]=ote.ONE,new n(e,0)}},{key:"getNeighbooringPawnLike",value:function(e,t,n,r){for(var i,a=[],o=-1;o<2;o++)for(var s=-1;s<2;s++)(i=new lre(n+s,r+o)).isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&a.push(i);return a}}]),n}(Sre);return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e}(),afe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"equals",value:function(e){return e===this||e.coord.equals(this.coord)}},{key:"toString",value:function(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Tre);afe.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return(ife.BOARD_HEIGHT-1)*ife.BOARD_WIDTH+(ife.BOARD_WIDTH-1)}},{key:"encodeNumber",value:function(e){return e.coord.y*ife.BOARD_WIDTH+e.coord.x}},{key:"decodeNumber",value:function(e){var t=e%ife.BOARD_WIDTH;return new afe(t,(e-t)/ife.BOARD_WIDTH)}}]),n}(rte)),afe.PASS=new afe(-1,-1),afe.PASS_NUMBER=afe.encoder.encodeNumber(afe.PASS);var ofe=function(){var e=cp(function e(){sp(this,e)});return e.NO_ELEMENT_SWITCHED=function(){return $localize(Es||(Es=Vv(["Your move should switch at least one piece."])))},e}(),sfe=cp(function e(t,n){sp(this,e),this.move=t,this.switched=n}),ufe=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.turn,i=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(afe.PASS))return new ife(a,r+1);var o,s=ip(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.y][u.x]=i}}catch(c){s.e(c)}finally{s.f()}return a[e.coord.y][e.coord.x]=i,new ife(a,r+1)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}},{key:"isLegal",value:function(e,t){if(e.equals(afe.PASS))return n.playerCanOnlyPass(t)?J5.success([]):J5.failure(kre.MUST_PASS());if(t.getPieceAt(e.coord).isPlayer())return sB(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),J5.failure(kre.MUST_CLICK_ON_EMPTY_SPACE());var r=t.getCopiedBoard(),i=n.getAllSwitcheds(e,t.getCurrentPlayer(),r);return sB(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?J5.failure(ofe.NO_ELEMENT_SWITCHED()):J5.success(i)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;if(!1===n.isGameEnded(t))return Dre.ONGOING;var r=t.countScore(),i=r[1]-r[0];return i<0?Dre.ZERO_WON:i>0?Dre.ONE_WON:Dre.DRAW}},{key:"getAllSwitcheds",value:function(e,t,r){var i,a=[],o=t.getOpponent(),s=ip(ure.DIRECTIONS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=e.coord.getNext(u);if(c.isInRange(ife.BOARD_WIDTH,ife.BOARD_HEIGHT)&&r[c.y][c.x]===o){var l,h=ip(n.getSandwicheds(t,u,c,r));try{for(h.s();!(l=h.n()).done;){var f=l.value;a.push(f)}}catch(d){h.e(d)}finally{h.f()}}}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"getSandwicheds",value:function(e,t,n,r){for(var i=[n],a=n.getNext(t);a.isInRange(ife.BOARD_WIDTH,ife.BOARD_HEIGHT);){var o=r[a.y][a.x];if(o===e)return i;if(o===ate.NONE)return[];i.push(a),a=a.getNext(t)}return[]}},{key:"isGameEnded",value:function(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}},{key:"playerCanOnlyPass",value:function(e){var t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(afe.PASS)}},{key:"nextPlayerCantOnlyPass",value:function(e){var t=e.getCopiedBoard(),n=new ife(t,e.turn+1);return this.playerCanOnlyPass(n)}},{key:"getListMoves",value:function(e){for(var t,r=[],i=e.getCurrentPlayer(),a=e.getCurrentOpponent(),o=0;o<8;o++)for(var s=0;s<8;s++)if(e.getPieceAtXY(s,o)===ate.NONE&&(t=e.getCopiedBoard(),ife.getNeighbooringPawnLike(t,a,s,o).length>0)){var u=new afe(s,o),c=n.getAllSwitcheds(u,i,t);if(c.length>0){var l,h=ip(c);try{for(h.s();!(l=h.n()).done;){var f=l.value;a6(i!==e.getPieceAt(f),f+"was already switched!"),t[f.y][f.x]=i}}catch(d){h.e(d)}finally{h.f()}t[o][s]=i,r.push(new sfe(u,c.length))}}return 0===r.length&&r.push(new sfe(afe.PASS,0)),r}}]),n}(Lre);return e.VERBOSE=!1,e}(),cfe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getBoardValue",value:function(e){var t=ufe.getGameStatus(e);if(t.isEndGame)return wre.fromWinner(t.winner);for(var n=e.gameState.getCopiedBoard(),r=0,i=0,a=0;a<ife.BOARD_HEIGHT;a++)for(var o=0;o<ife.BOARD_WIDTH;o++){var s=(0===o||o===ife.BOARD_WIDTH-1?4:1)*(0===a||a===ife.BOARD_HEIGHT-1?4:1);n[a][o]===ote.ZERO&&(r+=s),n[a][o]===ote.ONE&&(i+=s)}return r*=ote.ZERO.getScoreModifier(),i*=ote.ONE.getScoreModifier(),new wre(i+r)}},{key:"getListMoves",value:function(e){var t=ufe.getListMoves(e.gameState);return lte.sortByDescending(t,function(e){return n.bestCoords.some(function(t){return e.move.coord.equals(t)})?100:e.switched}),t.map(function(e){return e.move})}}]),n}(_re);cfe.bestCoords=[new lre(0,0),new lre(0,ife.BOARD_HEIGHT-1),new lre(ife.BOARD_WIDTH-1,0),new lre(ife.BOARD_WIDTH-1,ife.BOARD_HEIGHT-1)];var lfe=ate.NONE,hfe=ote.ZERO,ffe=ote.ONE,dfe=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(Ss||(Ss=Vv(["Goal of the game"]))),$localize(Ps||(Ps=Vv(["At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.\n        When one piece is flipped, its owner changes.\n        The player owning the most pieces at the end of the game wins.\n        Here, Dark has 28 points and Light has 36, hence Light wins."]))),new ife([[hfe,hfe,hfe,hfe,hfe,hfe,hfe,hfe],[hfe,ffe,ffe,ffe,ffe,ffe,ffe,hfe],[hfe,ffe,ffe,ffe,ffe,ffe,ffe,hfe],[hfe,ffe,ffe,ffe,ffe,ffe,ffe,hfe],[hfe,ffe,ffe,ffe,ffe,ffe,ffe,hfe],[hfe,ffe,ffe,ffe,ffe,ffe,ffe,hfe],[hfe,ffe,ffe,ffe,ffe,ffe,ffe,hfe],[hfe,hfe,hfe,hfe,hfe,hfe,hfe,hfe]],60)),Vre.anyMove($localize(Os||(Os=Vv(["Capture (1/2)"]))),$localize(Ts||(Ts=Vv(["At the beginning of the game, pieces are placed as shown here.\n        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>\n        Do any move by clicking to put your piece\n        Dark plays first."]))),ife.getInitialState(),new afe(2,4),$localize(Is||(Is=Vv(["Congratulations!"])))),Vre.fromMove($localize(xs||(xs=Vv(["Capture (2/2)"]))),$localize(As||(As=Vv(["A move can also capture a bigger line, and more than one lines at a time\n        You're playing light here.<br/><br/>\n        Play on the bottom left to see an example."]))),new ife([[lfe,lfe,lfe,lfe,lfe,lfe,lfe,lfe],[lfe,lfe,lfe,lfe,lfe,lfe,lfe,lfe],[lfe,lfe,lfe,lfe,lfe,lfe,lfe,lfe],[lfe,lfe,lfe,lfe,ffe,lfe,lfe,lfe],[lfe,lfe,lfe,hfe,lfe,lfe,lfe,lfe],[lfe,lfe,hfe,lfe,lfe,lfe,lfe,lfe],[hfe,hfe,lfe,lfe,lfe,lfe,lfe,lfe],[lfe,hfe,ffe,hfe,ffe,hfe,lfe,lfe]],1),[new afe(0,7)],$localize(Rs||(Rs=Vv(["Congratulations!"]))),$localize(Ns||(Ns=Vv(["Lower and more to the left, please."])))),Vre.informational($localize(Ms||(Ms=Vv(["Passing a turn"]))),$localize(Ds||(Ds=Vv(["If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass\n        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way."]))),new ife([[ffe,hfe,hfe,hfe,hfe,hfe,ffe,hfe],[hfe,ffe,ffe,ffe,ffe,ffe,ffe,hfe],[hfe,ffe,ffe,ffe,ffe,ffe,ffe,hfe],[hfe,ffe,ffe,ffe,ffe,ffe,ffe,hfe],[hfe,ffe,ffe,ffe,ffe,ffe,ffe,hfe],[hfe,ffe,ffe,ffe,ffe,ffe,ffe,hfe],[ffe,ffe,ffe,ffe,ffe,ffe,lfe,lfe],[hfe,hfe,hfe,hfe,hfe,hfe,lfe,lfe]],60))]});function vfe(e,t){if(1&e&&(Pm(),yb(0,"circle",4)),2&e){var n=Pb().index,r=Pb().index,i=Pb();db("ngClass",i.getPieceClass(n,r)),ob("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)}}function pfe(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",2),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),lb(2,vfe,1,4,"circle",3),gb()}if(2&e){var r=t.index,i=Pb().index,a=Pb();Rw(1),Ib("id","click_",r,"_",i,""),db("ngClass",a.getRectClasses(r,i)),ob("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Rw(1),db("ngIf",a.board[i][r]!==a.NONE)}}function gfe(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,pfe,3,8,"g",1),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}var yfe=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).NONE=ate.NONE,r.lastMove=new lre(-2,-2),r.captureds=[],r.scores=hB.of([2,2]),r.rules=new ufe(ife),r.availableMinimaxes=[new cfe(r.rules,"ReversiMinimax")],r.encoder=afe.encoder,r.tutorial=(new dfe).tutorial,r.canPass=!1,r.updateBoard(),r}return cp(n,[{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new afe(e,t),r.next=6,n.chooseMove(a,n.rules.node.gameState,n.scores.get());case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new lre(-2,-2),this.scores=hB.of(e.countScore()),this.canPass=ufe.playerCanOnlyPass(e)}},{key:"showPreviousMove",value:function(){this.lastMove=this.rules.node.move.get().coord;var e,t=this.rules.node.gameState.getCurrentPlayer(),n=this.rules.node.gameState.getCurrentOpponent(),r=ip(ure.DIRECTIONS);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=this.lastMove.getNext(i,1);a.isInRange(ife.BOARD_WIDTH,ife.BOARD_HEIGHT)&&this.rules.node.gameState.getPieceAt(a)===n&&this.rules.node.mother.get().gameState.getPieceAt(a)===t;)this.captureds.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}}},{key:"getRectClasses",value:function(e,t){var n=new lre(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:n.equals(this.lastMove)?["moved"]:[]}},{key:"getPieceClass",value:function(e,t){return this.getPlayerClass(this.board[t][e])}},{key:"pass",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(a6(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(afe.PASS.coord.x,afe.PASS.coord.y)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(wie);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-reversi"]],features:[jC],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,gfe,2,1,"g",1),gb()),2&e&&(ob("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),Rw(1),db("ngForOf",t.board))},directives:[FT,DT,UT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),mfe=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,null,[{key:"getInitialState",value:function(){var e=dre.NONE,t=dre.ZERO,r=dre.ONE,i=dre.EMPTY;return new n([[e,e,t,r,i,i,i,t,r,e,e],[e,i,i,i,i,i,i,i,i,i,e],[r,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,r],[e,i,i,i,i,i,i,i,i,i,e],[e,e,r,t,i,i,i,r,t,e,e]],0)}}]),n}(mae);return e.HEIGHT=6,e.WIDTH=11,e}(),kfe=function(){var e=cp(function e(){sp(this,e)});return e.CAN_ONLY_REBOUND_ON_BLACK=function(){return $localize(Ls||(Ls=Vv(["You can only rebound on dark spaces."])))},e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=function(){return $localize(Fs||(Fs=Vv(["You can only rebound on empty spaces."])))},e.MUST_CHOOSE_PYRAMID_FIRST=function(){return $localize(Bs||(Bs=Vv(["You must pick one of your pyramids first."])))},e.MUST_CHOOSE_OWN_PYRAMID=function(){return $localize(Us||(Us=Vv(["You must pick one of your pyramids."])))},e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=function(){return $localize(Vs||(Vs=Vv(["Those two spaces are not neighbors."])))},e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=function(){return $localize(zs||(zs=Vv(["Those two spaces have no intermediary neighbor."])))},e}(),_fe=function(e){Yv(n,e);var t=Jv(n);function n(e,r){return sp(this,n),t.call(this,e,r)}return cp(n,[{key:"isSimpleStep",value:function(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"SaharaMove("+this.coord+"->"+this.end+")"}}],[{key:"checkDistanceAndLocation",value:function(e,t){var n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return e6.failure(kre.MOVE_CANNOT_BE_STATIC());if(1===n){var r=yae.getFakeNeighbors(e);if(t.equals(r))return e6.failure(kfe.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return e6.failure($localize(Hs||(Hs=Vv(["You can move one or two spaces, not ","."])),n));if((e.x+e.y)%2==0)return e6.failure(kfe.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return e6.failure(kfe.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return e6.SUCCESS}},{key:"from",value:function(e,t){if(!e.isInRange(mfe.WIDTH,mfe.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(mfe.WIDTH,mfe.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");var r=n.checkDistanceAndLocation(e,t);return r.isFailure()?r.toFailedFallible():J5.success(new n(e,t))}}]),n}(Aie);_fe.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 396*mfe.WIDTH+66*mfe.HEIGHT+6*mfe.WIDTH+mfe.HEIGHT}},{key:"encodeNumber",value:function(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){var t=e%6;e-=t;var n=(e/=6)%11;e-=n;var r=(e/=11)%6;return e-=r,_fe.from(new lre(e/=6,r),new lre(n,t)).get()}}]),n}(rte));var wfe=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,r){sB(n.VERBOSE,"Legal move "+e.toString()+" applied");var i=t.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=dre.EMPTY,new mfe(i,t.turn+1)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return J5.failure(kre.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==dre.EMPTY)return J5.failure(kre.MUST_LAND_ON_EMPTY_SPACE());var n=yae.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===dre.EMPTY?J5.success(void 0):J5.failure(kfe.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):J5.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getCopiedBoard(),r=n.getBoardValuesFor(t,ote.ZERO),i=n.getBoardValuesFor(t,ote.ONE);return n.getGameStatusFromFreedoms(r,i)}}],[{key:"getStartingCoords",value:function(e,t){for(var n=[],r=0;r<mfe.HEIGHT;r++)for(var i=0;i<mfe.WIDTH;i++)e[r][i].is(t)&&n.push(new lre(i,r));return n}},{key:"getBoardValuesFor",value:function(e,t){var r,i=[],a=ip(n.getStartingCoords(e,t));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=mae.getEmptyNeighbors(e,o,dre.EMPTY).length;if(0===s)return[0];i.push(s)}}catch(u){a.e(u)}finally{a.f()}return i.sort(function(e,t){return e-t})}},{key:"getGameStatusFromFreedoms",value:function(e,t){return 0===e[0]?Dre.ONE_WON:0===t[0]?Dre.ZERO_WON:Dre.ONGOING}}]),n}(Lre);return e.VERBOSE=!1,e}(),Cfe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),a=ip(wfe.getStartingCoords(r,i));try{for(a.s();!(t=a.n()).done;){var o,s=t.value,u=ip(mae.getEmptyNeighbors(r,s,dre.EMPTY));try{for(u.s();!(o=u.n()).done;){var c=o.value,l=_fe.from(s,c).get();if(r[c.y][c.x]=r[s.y][s.x],r[s.y][s.x]=dre.EMPTY,n.push(l),(c.y+c.x)%2==0){var h,f=ip(mae.getEmptyNeighbors(r,c,dre.EMPTY));try{for(f.s();!(h=f.n()).done;){var d=h.value;if(!d.equals(s)){var v=_fe.from(s,d).get();r[d.y][d.x]=r[c.y][c.x],r[c.y][c.x]=dre.EMPTY,n.push(v),r[c.y][c.x]=r[d.y][d.x],r[d.y][d.x]=dre.EMPTY}}}catch(p){f.e(p)}finally{f.f()}}r[s.y][s.x]=r[c.y][c.x],r[c.y][c.x]=dre.EMPTY}}catch(p){u.e(p)}finally{u.f()}}}catch(p){a.e(p)}finally{a.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState.getCopiedBoard(),n=wfe.getBoardValuesFor(t,ote.ZERO),r=wfe.getBoardValuesFor(t,ote.ONE),i=wfe.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return wre.fromWinner(i.winner);for(var a=0;a<6&&n[a]===r[a];)a++;return new wre(r[a%6]-n[a%6])}}]),n}(_re),bfe=dre.NONE,Efe=dre.ZERO,Sfe=dre.ONE,Pfe=dre.EMPTY,Ofe=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(Gs||(Gs=Vv(["Initial board"]))),$localize(qs||(qs=Vv(["S\xe2h\xe2r\xe2 is played on a board where each space is a triangle.\n        Each player has six pyramids."]))),mfe.getInitialState()),Vre.informational($localize($s||($s=Vv(["Goal of the game"]))),$localize(Ws||(Ws=Vv(["At S\xe2h\xe2r\xe2, the goal of the game is to immobilize one of the opponent's pyramids.\n        To do so, you have to occupy all neighboring space of that pyramid.\n        Here, Light has lost because its leftmost pyramid is immobilized."]))),new mfe([[bfe,bfe,Pfe,Pfe,Sfe,Pfe,Pfe,Efe,Sfe,bfe,bfe],[bfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,bfe],[Sfe,Efe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Efe],[Efe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Sfe],[bfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,Pfe,bfe],[bfe,bfe,Sfe,Efe,Pfe,Pfe,Pfe,Sfe,Efe,bfe,bfe]],3)),Vre.fromPredicate($localize(js||(js=Vv(["Simple step"]))),$localize(Zs||(Zs=Vv(["To immobilize your opponent, you have to move your pyramids.\n        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).\n        You're the first player, playing with the dark pyramids.\n        <ol>\n            <li>Click on one of your pyramids.</li>\n            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>\n        </ol><br/>\n        Do any simple step."]))),mfe.getInitialState(),_fe.from(new lre(2,0),new lre(2,1)).get(),function(e,t){return e.isSimpleStep()?e6.SUCCESS:e6.failure($localize(Ys||(Ys=Vv(["You have made a double step, which is good but it is the next exercise!"]))))},$localize(Ks||(Ks=Vv(["Congratulations!"])))),Vre.fromPredicate($localize(Js||(Js=Vv(["Double step"]))),$localize(Qs||(Qs=Vv(["When a pyramid shares its vertices with dark spaces, it can move one or two steps.\n        To do so:\n        <ol>\n            <li>Click on the pyramid to move.</li>\n            <li>Click on one of the 6 destinations that you can reach in two steps:\n                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.\n        </ol>"]))),mfe.getInitialState(),_fe.from(new lre(7,0),new lre(5,0)).get(),function(e,t){return e.isSimpleStep()?e6.failure($localize(Xs||(Xs=Vv(["Failed! You have made a single step."])))):e6.SUCCESS},$localize(eu||(eu=Vv(["Congratulations!"]))))]});function Tfe(e,t){if(1&e&&(Pm(),pb(0,"g"),yb(1,"polyline",6),gb()),2&e){var n=Pb().index,r=Pb().index,i=Pb();Rw(1),db("ngClass",i.getPlayerClassFor(n,r)),ob("points",i.getPyramidCoordinate(n,r))}}function Ife(e,t){if(1&e&&(Pm(),yb(0,"polyline",9)),2&e){var n=Pb(2).index,r=Pb().index;ob("points",Pb().getTriangleCoordinate(n,r))}}function xfe(e,t){if(1&e&&(Pm(),yb(0,"polyline",10)),2&e){var n=Pb(2).index,r=Pb().index;ob("points",Pb().getTriangleCoordinate(n,r))}}function Afe(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Ife,1,1,"polyline",7),lb(2,xfe,1,1,"polyline",8),gb()),2&e){var n=Pb().index,r=Pb().index;Rw(1),db("ngIf",(n+r)%2==1),Rw(1),db("ngIf",(n+r)%2==0)}}function Rfe(e,t){if(1&e){var n=_b();Pm(),pb(0,"g",5),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onClick(e,t)}),lb(1,Tfe,2,2,"g",2),lb(2,Afe,3,2,"g",2),gb()}if(2&e){var r=t.$implicit;Ib("id","click_",t.index,"_",Pb().index,""),Rw(1),db("ngIf",r.isPlayer()),Rw(1),db("ngIf",2===r.value)}}function Nfe(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Rfe,3,4,"g",4),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function Mfe(e,t){if(1&e&&(Pm(),mb(0),yb(1,"polyline",11),yb(2,"polyline",11),kb()),2&e){var n=Pb();Rw(1),ob("points",n.getTriangleCoordinate(n.lastCoord.get().x,n.lastCoord.get().y)),Rw(1),ob("points",n.getTriangleCoordinate(n.lastMoved.get().x,n.lastMoved.get().y))}}function Dfe(e,t){if(1&e&&(Pm(),yb(0,"polyline",12)),2&e){var n=Pb();ob("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}var Lfe=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).lastCoord=hB.empty(),r.lastMoved=hB.empty(),r.chosenCoord=hB.empty(),r.rules=new wfe(mfe),r.availableMinimaxes=[new Cfe(r.rules,"SaharaMinimax")],r.encoder=_fe.encoder,r.tutorial=(new Ofe).tutorial,r.updateBoard(),r}return cp(n,[{key:"cancelMoveAttempt",value:function(){this.chosenCoord=hB.empty()}},{key:"onClick",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.chosenCoord.isAbsent()?n.choosePiece(e,t):n.chooseLandingCoord(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return this.board[t][e]===dre.EMPTY?this.cancelMove(kfe.MUST_CHOOSE_PYRAMID_FIRST()):this.board[t][e].value===this.getTurn()%2?(this.chosenCoord=hB.of(new lre(e,t)),e6.SUCCESS):this.cancelMove(kfe.MUST_CHOOSE_OWN_PYRAMID())}},{key:"chooseLandingCoord",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new lre(e,t),a=n.rules.node.gameState.getCurrentPlayer(),o=dre.ofPlayer(a),n.board[t][e]!==o){r.next=3;break}return r.abrupt("return",(n.chosenCoord=hB.of(new lre(e,t)),e6.SUCCESS));case 3:if(!(s=_fe.from(n.chosenCoord.get(),i)).isFailure()){r.next=8;break}r.t0=n.cancelMove(s.getReason()),r.next=11;break;case 8:return r.next=10,n.chooseMove(s.get(),n.rules.node.gameState);case 10:r.t0=r.sent;case 11:return r.abrupt("return",r.t0);case 12:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.chosenCoord=hB.empty();var e=this.rules.node.move;this.lastCoord=e.map(function(e){return e.coord}),this.lastMoved=e.map(function(e){return e.end}),this.board=this.rules.node.gameState.board}},{key:"getPlayerClassFor",value:function(e,t){return this.getPlayerClass(ote.of(this.board[t][e].value))}}]),n}(dae);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-sahara"]],features:[jC],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill small-stroke selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],[1,"base","no-fill","small-stroke","highlighted"],[1,"base","no-fill","small-stroke","selected"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,Nfe,2,1,"g",1),lb(2,Mfe,3,2,"ng-container",2),lb(3,Dfe,1,1,"polyline",3),gb()),2&e&&(Rw(1),db("ngForOf",t.board),Rw(1),db("ngIf",t.lastMoved.isPresent()),Rw(1),db("ngIf",t.chosenCoord.isPresent()))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ffe=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this,e,r)).x=e,o.y=r,o.moveDirection=i,o.landingOrientation=a,o.checkValidity(),o}return cp(n,[{key:"checkValidity",value:function(){var e=this.coord.isInRange(5,5);if(this.isRotation()){if(!e)throw new Error("Cannot rotate piece outside the board: "+this.toString()+".")}else if(this.coord.getNext(this.moveDirection.get()).isNotInRange(5,5)){if(!e)throw new Error("SiamMove should end or start on the board: "+this.toString()+".");if(this.moveDirection.get()!==this.landingOrientation)throw new Error("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+this.toString()+".")}}},{key:"isRotation",value:function(){return this.moveDirection.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.moveDirection.equals(e.moveDirection))&&this.landingOrientation===e.landingOrientation}},{key:"toString",value:function(){var e=this.moveDirection.isAbsent()?"-":this.moveDirection.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}},{key:"isInsertion",value:function(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}]),n}(Tre);Ffe.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"maxValue",value:function(){return 2408}},{key:"encodeNumber",value:function(e){var t=e.coord.y+1,n=e.coord.x+1,r=e.moveDirection.isAbsent()?4:e.moveDirection.get().toInt();return 245*e.landingOrientation.toInt()+49*r+7*n+t}},{key:"decodeNumber",value:function(e){var t=e%7;e-=t;var n=(e/=7)%7;e-=n;var r=(e/=7)%5,i=4===r?hB.empty():cre.factory.fromInt(r).toOptional();e-=r;var a=cre.factory.fromInt(e/=5).get();return new Ffe(n-1,t-1,i,a)}}]),n}(rte));var Bfe=function(){function e(t){sp(this,e),this.value=t}return cp(e,[{key:"belongTo",value:function(e){return e===ote.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}},{key:"isEmptyOrMountain",value:function(){return 0===this.value||9===this.value}},{key:"isPiece",value:function(){return!this.isEmptyOrMountain()}},{key:"getOwner",value:function(){return 1<=this.value&&this.value<=4?ote.ZERO:5<=this.value&&this.value<=8?ote.ONE:ate.NONE}},{key:"getOptionalDirection",value:function(){switch(this.value){case 0:return hB.empty();case 1:case 5:return hB.of(cre.UP);case 2:case 6:return hB.of(cre.RIGHT);case 3:case 7:return hB.of(cre.DOWN);case 4:case 8:return hB.of(cre.LEFT);default:return oB.expectToBe(this.value,9),hB.empty()}}},{key:"getDirection",value:function(){return this.getOptionalDirection().get()}},{key:"toString",value:function(){switch(this.value){case 0:return"EMPTY";case 1:return"WHITE_UP";case 2:return"WHITE_RIGHT";case 3:return"WHITE_DOWN";case 4:return"WHITE_LEFT";case 5:return"BLACK_UP";case 6:return"BLACK_RIGHT";case 7:return"BLACK_DOWN";case 8:return"BLACK_LEFT";default:return oB.expectToBe(this.value,9),"MOUNTAIN"}}}],[{key:"decode",value:function(t){switch(t){case 0:return e.EMPTY;case 1:return e.WHITE_UP;case 2:return e.WHITE_RIGHT;case 3:return e.WHITE_DOWN;case 4:return e.WHITE_LEFT;case 5:return e.BLACK_UP;case 6:return e.BLACK_RIGHT;case 7:return e.BLACK_DOWN;case 8:return e.BLACK_LEFT;case 9:return e.MOUNTAIN}}},{key:"of",value:function(t,n){return n===ote.ZERO?t===cre.UP?e.WHITE_UP:t===cre.RIGHT?e.WHITE_RIGHT:t===cre.DOWN?e.WHITE_DOWN:e.WHITE_LEFT:t===cre.UP?e.BLACK_UP:t===cre.RIGHT?e.BLACK_RIGHT:t===cre.DOWN?e.BLACK_DOWN:e.BLACK_LEFT}}]),e}();Bfe.EMPTY=new Bfe(0),Bfe.WHITE_UP=new Bfe(1),Bfe.WHITE_RIGHT=new Bfe(2),Bfe.WHITE_DOWN=new Bfe(3),Bfe.WHITE_LEFT=new Bfe(4),Bfe.BLACK_UP=new Bfe(5),Bfe.BLACK_RIGHT=new Bfe(6),Bfe.BLACK_DOWN=new Bfe(7),Bfe.BLACK_LEFT=new Bfe(8),Bfe.MOUNTAIN=new Bfe(9);var Ufe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"countPlayerPawn",value:function(){for(var e=0,t=0;t<5;t++)for(var n=0;n<5;n++)this.board[t][n].belongTo(this.getCurrentPlayer())&&e++;return e}}],[{key:"getInitialState",value:function(){var e=lte.createTable(5,5,Bfe.EMPTY);return e[2][1]=Bfe.MOUNTAIN,e[2][2]=Bfe.MOUNTAIN,e[2][3]=Bfe.MOUNTAIN,new n(e,0)}}]),n}(Sre),Vfe=function(){var e=cp(function e(){sp(this,e)});return e.CANNOT_INSERT_WHEN_SELECTED=function(){return $localize(tu||(tu=Vv(["You cannot insert a piece when you have already selected a piece."])))},e.NO_REMAINING_PIECE_TO_INSERT=function(){return $localize(nu||(nu=Vv(["You cannot insert a piece, all your pieces are already on the board."])))},e.NOT_ENOUGH_FORCE_TO_PUSH=function(){return $localize(ru||(ru=Vv(["You do not have enough strength to push."])))},e.ILLEGAL_ROTATION=function(){return $localize(iu||(iu=Vv(["You cannot push and turn at the same time."])))},e.ILLEGAL_PUSH=function(){return $localize(au||(au=Vv(["Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board."])))},e}(),zfe=cp(function e(t,n){sp(this,e),this.resultingBoard=t,this.moved=n}),Hfe=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"isLegal",value:function(e,t){if(sB(n.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return J5.failure(kre.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return sB(n.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);var r;if(e.isInsertion()){sB(n.VERBOSE,"Move is insertion");var i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return J5.failure(i.legal.getReason());r=i.insertedPiece}else sB(n.VERBOSE,"Move is forward"),r=t.getPieceAt(e.coord);return n.isLegalForwarding(e,t,r)}},{key:"isLegalInsertion",value:function(e,t){var r=t.countPlayerPawn(),i=t.getCurrentPlayer(),a=r<5?e6.SUCCESS:e6.failure(Vfe.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:n.getInsertedPiece(e,i),legal:a}}},{key:"isLegalRotation",value:function(e,t){sB(n.VERBOSE,{isLegalRotation:{rotation:e,state:t}});var r=e.coord,i=t.getPieceAt(r),a=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return J5.failure(Vfe.ILLEGAL_ROTATION());var o=t.getCopiedBoard();return o[r.y][r.x]=Bfe.of(e.landingOrientation,a),J5.success(new zfe(o,[r]))}},{key:"applyLegalMove",value:function(e,t,n){var r=lte.copyBiArray(n.resultingBoard);return new Ufe(r,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=n.getMountainsRowsAndColumns(e.gameState),r=n.getWinner(e.gameState,e.move,t.nbMountain);return r.isPlayer()?Dre.getVictory(r):Dre.ONGOING}}],[{key:"getInsertedPiece",value:function(e,t){return Bfe.of(-1===e.x?cre.RIGHT:-1===e.y?cre.DOWN:5===e.x?cre.LEFT:cre.UP,t)}},{key:"isLegalForwarding",value:function(e,t,r){sB(n.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:r}});var i=[],a=Bfe.of(e.landingOrientation,t.getCurrentPlayer()),o=e.moveDirection.get(),s=e.coord.getNext(o);if(s.isInRange(5,5)&&t.getPieceAt(s)!==Bfe.EMPTY&&!1===n.isStraight(r,e))return sB(n.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),J5.failure(Vfe.ILLEGAL_PUSH());var u=hB.of(o),c=o.getOpposite(),l=0,h=t.getCopiedBoard();e.coord.isInRange(5,5)&&(h[e.coord.y][e.coord.x]=Bfe.EMPTY,i.push(e.coord));for(var f=s.isInRange(5,5)&&a!==Bfe.EMPTY;f;){u.equalsValue(o)?l++:u.equalsValue(c)&&l--,sB(n.VERBOSE,{totalForce:l,movingPiece:a,landingCoord:s});var d=h[s.y][s.x];d===Bfe.MOUNTAIN&&(l-=.9),h[s.y][s.x]=a,i.push(s),a=d,s=s.getNext(o),u=a.getOptionalDirection(),f=s.isInRange(5,5)&&a!==Bfe.EMPTY&&l>0}return s.isNotInRange(5,5)&&(sB(n.VERBOSE,"This movement would push "+a+" outside the board"),u.equalsValue(o)?l++:u.equalsValue(c)&&l--),l<=0?(sB(n.VERBOSE,"This move is an illegal push: "+h),J5.failure(Vfe.NOT_ENOUGH_FORCE_TO_PUSH())):(sB(n.VERBOSE,"This move is a legal push: "+h),J5.success(new zfe(h,i)))}},{key:"isStraight",value:function(e,t){var n=e.getDirection();return t.moveDirection.equalsValue(n)&&n===t.landingOrientation}},{key:"getBoardValueInfo",value:function(e,t){var r=n.getMountainsRowsAndColumns(t),i=r.rows,a=r.columns,o=n.getWinner(t,e,r.nbMountain);if(o.isPlayer())return o===ote.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};var s,u=n.getPushers(t,a,i),c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,h=t.getCurrentPlayer(),f=ip(u);try{for(f.s();!(s=f.n()).done;){var d=s.value;d.coord.isInRange(5,5)?t.getPieceAt(d.coord).belongTo(ote.ZERO)?c=Math.min(c,d.distance):l=Math.min(l,d.distance):h===ote.ZERO?c=Math.min(c,d.distance):l=Math.min(l,d.distance)}}catch(v){f.e(v)}finally{f.f()}return{shortestZero:c,shortestOne:l,boardValue:n.getScoreFromShortestDistances(c,l,h)}}},{key:"getScoreFromShortestDistances",value:function(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);var r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}},{key:"getMountainsRowsAndColumns",value:function(e){for(var t=[],n=[],r=0,i=0;i<5;i++)for(var a=0;a<5;a++)e.getPieceAtXY(a,i)===Bfe.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(a)||n.push(a),r++);return{rows:t,columns:n,nbMountain:r}}},{key:"getWinner",value:function(e,t,r){return 2===r?n.getPusher(e,t.get()):ate.NONE}},{key:"getPusher",value:function(e,t){var r=t.coord,i=(r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):n.getInsertedPiece(r,e.getCurrentOpponent())).getDirection(),a=n.getPusherCoord(e,i,r),o=e.getPieceAt(a).getOwner();return sB(n.VERBOSE,r.toString()+" belong to "+e.getCurrentOpponent().value+", "+a.toString()+" belong to "+o.value+", "+o.value+" win"),o}},{key:"getPusherCoord",value:function(e,t,n){for(var r=n.getNext(t),i=n;r.isInRange(5,5);){n=r,r=r.getNext(t);var a=e.getPieceAt(n);a!==Bfe.MOUNTAIN&&a.getDirection()===t&&(i=n)}return i}},{key:"getPushers",value:function(e,t,r){sB(n.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:r}});var i,a=[],o=[],s=ip(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=cre.DOWN,l=new lre(u,4);o.push({direction:c,fallingCoord:l}),c=cre.UP,l=new lre(u,0),o.push({direction:c,fallingCoord:l})}}catch(k){s.e(k)}finally{s.f()}var h,f=ip(r);try{for(f.s();!(h=f.n()).done;){var d=h.value,v=cre.LEFT,p=new lre(0,d);o.push({direction:v,fallingCoord:p}),v=cre.RIGHT,p=new lre(4,d),o.push({direction:v,fallingCoord:p})}}catch(k){f.e(k)}finally{f.f()}for(var g=0,y=o;g<y.length;g++){var m=y[g];a=n.addPotentialDirectionPusher(e,m.fallingCoord,m.direction,a)}return a}},{key:"addPotentialDirectionPusher",value:function(e,t,r,i){var a=n.getLineClosestPusher(e,t,r);if(a.isAbsent())return i;var o=a.get(),s=o.distance;return sB(n.VERBOSE,"new closest challenger"),i.push({coord:o.coord,distance:s}),i}},{key:"getLineClosestPusher",value:function(e,t,r){sB(n.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:r.toString()}});for(var i=r.getOpposite(),a=1,o=e.getPieceAt(t),s=t,u=hB.empty(),c=!1,l=!1,h=0;s.isInRange(5,5)&&!1===c;){var f=e.getPieceAt(s);if(f.isEmptyOrMountain())f===Bfe.MOUNTAIN?(h+=.9,l=!0):a++;else{var d=f.getDirection();d===r?l&&((h-=1)<=0&&(c=!0,s=s.getNext(r))):d===i?(h+=1,l||a++):l?(u=hB.of(s),o!==Bfe.EMPTY&&a++):a++}o=f,s=s.getPrevious(r)}if(!1===c&&u.isPresent())for(a++,h-=1;!1===s.equals(u.get());)s=s.getNext(r),a--;return s.isNotInRange(5,5)&&(h-=1,5===e.countPlayerPawn())||h>0?hB.empty():hB.of({distance:a,coord:s})}},{key:"getPushingInsertions",value:function(e){for(var t=[],n=e.gameState.getCurrentPlayer(),r=[],i=[],a=0;a<5;a++)r.push(new Ffe(-1,a,hB.of(cre.RIGHT),cre.RIGHT)),i.push(Bfe.of(cre.RIGHT,n)),r.push(new Ffe(5,a,hB.of(cre.LEFT),cre.LEFT)),i.push(Bfe.of(cre.LEFT,n)),r.push(new Ffe(a,-1,hB.of(cre.DOWN),cre.DOWN)),i.push(Bfe.of(cre.DOWN,n)),r.push(new Ffe(a,5,hB.of(cre.UP),cre.UP)),i.push(Bfe.of(cre.UP,n));for(var o=0;o<r.length;o++)this.isLegalForwarding(r[o],e.gameState,i[o]).isSuccess()&&t.push(r[o]);return t}},{key:"getDerapingInsertions",value:function(e){for(var t,n,r=[],i=e.gameState.getCurrentPlayer(),a=1;a<=3;a++)t=new Ffe(-1,a,hB.of(cre.RIGHT),cre.UP),n=Bfe.of(cre.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Ffe(-1,a,hB.of(cre.RIGHT),cre.DOWN),n=Bfe.of(cre.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new Ffe(5,a,hB.of(cre.LEFT),cre.UP),n=Bfe.of(cre.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Ffe(5,a,hB.of(cre.LEFT),cre.DOWN),n=Bfe.of(cre.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));for(var o=1;o<=3;o++)t=new Ffe(o,-1,hB.of(cre.DOWN),cre.LEFT),n=Bfe.of(cre.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Ffe(o,-1,hB.of(cre.DOWN),cre.RIGHT),n=Bfe.of(cre.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new Ffe(o,5,hB.of(cre.UP),cre.LEFT),n=Bfe.of(cre.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new Ffe(o,5,hB.of(cre.UP),cre.RIGHT),n=Bfe.of(cre.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));return r}},{key:"getCoordDirection",value:function(e,t,n){var r=new lre(e,t);return this.getInsertedPiece(r,n.getCurrentPlayer()).getDirection()}}]),n}(Lre);return e.VERBOSE=!1,e}(),Gfe=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getBoardValue",value:function(e){return new wre(Hfe.getBoardValueInfo(e.move,e.gameState).boardValue)}},{key:"getListMoves",value:function(e){for(var t,n=[],r=e.gameState.getCurrentPlayer(),i=0;i<5;i++)for(var a=0;a<5;a++)if((t=e.gameState.getPieceAtXY(a,i)).belongTo(r)){var o,s=t.getDirection(),u=ip(cre.ORTHOGONALS);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(c!==s){var l=e.gameState.getCopiedBoard(),h=new Ffe(a,i,hB.empty(),c);l[i][a]=Bfe.of(c,r),n.push(h)}var f,d=ip(new lre(a+c.x,i+c.y).isInRange(5,5)?cre.ORTHOGONALS:[c]);try{for(d.s();!(f=d.n()).done;){var v=f.value,p=new Ffe(a,i,hB.of(c),v);Hfe.isLegalForwarding(p,e.gameState,t).isSuccess()&&n.push(p)}}catch(g){d.e(g)}finally{d.f()}}}catch(g){u.e(g)}finally{u.f()}}return e.gameState.countPlayerPawn()<5&&(n=(n=n.concat(Hfe.getPushingInsertions(e))).concat(Hfe.getDerapingInsertions(e))),sB(Hfe.VERBOSE,{getListMovesResult:n}),n}}]),n}(_re),qfe=Bfe.EMPTY,$fe=Bfe.MOUNTAIN,Wfe=Bfe.WHITE_UP,jfe=Bfe.WHITE_LEFT,Zfe=Bfe.WHITE_RIGHT,Yfe=Bfe.WHITE_DOWN,Kfe=Bfe.BLACK_UP,Jfe=Bfe.BLACK_LEFT,Qfe=Bfe.BLACK_RIGHT,Xfe=Bfe.BLACK_DOWN,ede=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(ou||(ou=Vv(["Goal of the game"]))),$localize(su||(su=Vv(["The goal at Siam is to be the first to push a mountain out of the board.\n        The initial board contains three mountains, and no pieces are initially on the board.\n        During its turn, a player can do one of the following three actions:\n        <ol>\n            <li>Put a new piece on the board.</li>\n            <li>Change the orientation of one of its piece, and optionally move it.</li>\n            <li>Take one of its pieces out of the board.</li>\n        </ol>"]))),Ufe.getInitialState()),Vre.anyMove($localize(uu||(uu=Vv(["Inserting a piece"]))),$localize(cu||(cu=Vv(["Each player has 5 pieces in total.\n        As long as you do not have 5 pieces on the board, you can insert new pieces. To do so:\n        <ol>\n            <li>Click on one of the big arrows alongside the board.</li>\n            <li>Click on one of the small arrows that appeared on the landing square of your piece.\n                This is the direction in which your piece will be oriented.</li>\n        </ol><br/>\n        Insert a piece on the board."]))),Ufe.getInitialState(),new Ffe(2,-1,hB.of(cre.DOWN),cre.DOWN),$localize(lu||(lu=Vv(["Congratulations!"])))),Vre.fromMove($localize(hu||(hu=Vv(["Moving a piece"]))),$localize(fu||(fu=Vv(['We will distinguish here "moving" and "pushing".\n        A move is made from a piece\'s square to an empty neighboring square, horizontally or vertically.\n        During that move, you can also move the piece out of the board.\n        To move a piece:\n        <ol>\n            <li>Click on it.</li>\n            <li>Click on one of the 4 arrows to pick the direction in which it will move.\n                You can also click on the middle dot to change the piece\'s orientation without moving it.</li>\n            <li>Click on one of the 4 arrows on the landing square to pick its orientation.</li>\n        </ol><br/>\n        Try to move the piece that is on the board one square upwards and to orient it downwards.']))),new Ufe([[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,qfe,qfe,qfe],[qfe,$fe,$fe,$fe,qfe],[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,Wfe,qfe,qfe]],0),[new Ffe(2,4,hB.of(cre.UP),cre.DOWN)],$localize(du||(du=Vv(["Congratulations, you made a side-slip!"]))),$localize(vu||(vu=Vv(["Failed!"])))),Vre.fromMove($localize(pu||(pu=Vv(["Moving a piece out of the board"]))),$localize(gu||(gu=Vv(["To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>\n        Get that piece out of the board!"]))),new Ufe([[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,qfe,qfe,qfe],[qfe,$fe,$fe,$fe,qfe],[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,Wfe,qfe,qfe]],0),[new Ffe(2,4,hB.of(cre.DOWN),cre.DOWN)],$localize(yu||(yu=Vv(["Congratulations, even if in this context it was not a useful move."]))),$localize(mu||(mu=Vv(["Failed, the piece is still on the board."])))),Vre.fromMove($localize(ku||(ku=Vv(["Pushing"]))),$localize(_u||(_u=Vv(['When the landing square of your move is occupied, we use the term "push".\n        In order to push, multiple conditions must hold:\n        <ol>\n            <li>Your piece must already be oriented in the direction of the push.</li>\n            <li>The number of the pieces (opponent\'s or not) that are facing yours (called the resistants)\n                must be smaller than the number of pieces that are oriented in the same direction as the push, yourself included (the pushers).</li>\n            <li>The number of mountains on that line must be smaller or equal to the difference between the pushers and the resistants.</li>\n        </ol>\n        Your piece on the top right cannot push because there is one mountain too much.\n        Your piece on the bottom right can push.<br/><br/>\n        Do it.']))),new Ufe([[Zfe,$fe,$fe,Jfe,jfe],[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,qfe,$fe,qfe],[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,Qfe,Jfe,jfe]],0),[new Ffe(4,4,hB.of(cre.LEFT),cre.LEFT)],$localize(wu||(wu=Vv(["Congratulations!"]))),$localize(Cu||(Cu=Vv(["Failed!"])))),Vre.fromMove($localize(bu||(bu=Vv(["Victory"]))),$localize(Eu||(Eu=Vv(["The game ends when a mountain is pushed out of the board.\n        If you pushed it and nobody is in front of you, you're the winner.\n        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.\n        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>\n        You have two ways of ending the game here: you can either win, or lose. Choose correctly!"]))),new Ufe([[qfe,qfe,qfe,qfe,qfe],[qfe,qfe,qfe,qfe,qfe],[$fe,Kfe,jfe,qfe,Yfe],[qfe,qfe,qfe,qfe,Xfe],[qfe,qfe,qfe,qfe,$fe]],0),[new Ffe(2,2,hB.of(cre.LEFT),cre.LEFT)],$localize(Su||(Su=Vv(["Congratulations, you won!"]))),$localize(Pu||(Pu=Vv(["Failed, you lost."]))))]});function tde(e,t){if(1&e){var n=_b();Pm(),pb(0,"use",7),bb("click",function(){var e=Jy(n).$implicit;return Pb(3).insertAt(e.x,e.y)}),gb()}if(2&e){var r=t.$implicit,i=Pb(3);Ib("id","insertAt_",r.x,"_",r.y,""),ob("transform",i.getInsertionArrowTransform(r.x+1,r.y+1,r.dir))}}var nde=function(e,t){return{dir:"DOWN",x:e,y:t}},rde=function(e){return{dir:"UP",x:e,y:5}},ide=function(e,t){return{dir:"RIGHT",x:e,y:t}},ade=function(e){return{dir:"LEFT",x:5,y:e}},ode=function(e,t,n,r){return[e,t,n,r]};function sde(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,tde,1,3,"use",6),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",function(e,t,n,r,i,a,o){return function(e,t,n,r,i,a,o,s,u){var c=t+n;return function(e,t,n,r,i,a){var o=ab(e,t,n,r);return ab(e,t+2,i,a)||o}(e,c,i,a,o,s)?rb(e,c+4,u?r.call(u,i,a,o,s):r(i,a,o,s)):cP(e,c+4)}(Yy(),om(),e,t,n,r,i,a,o)}(11,ode,uP(1,nde,n,-1),sP(4,rde,n),uP(6,ide,-1,n),sP(9,ade,n)))}}var ude=function(){return[0,1,2,3,4]};function cde(e,t){1&e&&(Pm(),mb(0),lb(1,sde,2,16,"g",5),kb()),2&e&&(Rw(1),db("ngForOf",oP(1,ude)))}function lde(e,t){if(1&e){var n=_b();Pm(),pb(0,"use",13),bb("click",function(){var e=Jy(n).$implicit;return Pb(5).chooseDirection(e)}),gb()}if(2&e){var r=t.$implicit,i=Pb(3).index,a=Pb().index,o=Pb();Tb("id","chooseDirection_",r,""),ob("transform",o.getArrowTransform(i+1,a+1,r))}}var hde=function(){return["RIGHT","DOWN","LEFT","UP"]};function fde(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"circle",11),bb("click",function(){return Jy(n),Pb(4).chooseDirection("")}),gb(),lb(2,lde,1,2,"use",12),gb()}if(2&e){var r=Pb(2).index,i=Pb().index,a=Pb();Rw(1),ob("cx",(r+1)*a.SPACE_SIZE+a.SPACE_SIZE/2)("cy",(i+1)*a.SPACE_SIZE+a.SPACE_SIZE/2),Rw(1),db("ngForOf",oP(3,hde))}}function dde(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"use",10),bb("click",function(){Jy(n);var e=Pb().index,t=Pb().index;return Pb().clickPiece(e,t)}),gb(),lb(2,fde,3,4,"g",4),gb()}if(2&e){var r=Pb(),i=r.index,a=r.$implicit,o=Pb().index,s=Pb();Rw(1),Ib("id","clickPiece_",i,"_",o,""),db("ngClass",s.getPieceClasses(a)),ob("transform",s.getPieceTransform(i,o)),Rw(1),db("ngIf",s.choosingDirection(i,o))}}function vde(e,t){if(1&e&&(Pm(),yb(0,"use",14)),2&e){var n=Pb().index,r=Pb().index,i=Pb();ob("transform","translate("+(n+1)*i.SPACE_SIZE+" "+(r+1)*i.SPACE_SIZE+")")}}function pde(e,t){if(1&e){var n=_b();Pm(),pb(0,"use",13),bb("click",function(){var e=Jy(n).$implicit;return Pb(4).chooseOrientation(e)}),gb()}if(2&e){var r=t.$implicit,i=Pb(2).index,a=Pb().index,o=Pb();Tb("id","chooseOrientation_",r,""),ob("transform",o.getArrowTransform(i+1,a+1,r))}}function gde(e,t){1&e&&(Pm(),pb(0,"g"),lb(1,pde,1,2,"use",12),gb()),2&e&&(Rw(1),db("ngForOf",oP(1,hde)))}function yde(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",8),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().insertAt(e,t)}),gb(),lb(2,dde,3,5,"g",4),lb(3,vde,1,1,"use",9),lb(4,gde,2,2,"g",4),gb()}if(2&e){var r=t.$implicit,i=t.index,a=Pb().index,o=Pb();Rw(1),Ib("id","insertAt_",i,"_",a,""),db("ngClass",o.getSquareClasses(i,a)),ob("x",o.SPACE_SIZE*(i+1))("y",o.SPACE_SIZE*(a+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Rw(1),db("ngIf",r.isPiece()),Rw(1),db("ngIf",o.isMountain(r)),Rw(1),db("ngIf",o.choosingOrientation(i,a))}}function mde(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,yde,5,10,"g",5),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}var kde=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).lastMove=hB.empty(),r.chosenCoord=hB.empty(),r.landingCoord=hB.empty(),r.chosenDirection=hB.empty(),r.chosenOrientation=hB.empty(),r.movedPieces=[],r.rules=new Hfe(Ufe),r.availableMinimaxes=[new Gfe(r.rules,"SiamMinimax")],r.encoder=Ffe.encoder,r.tutorial=(new ede).tutorial,r.updateBoard(),r}return cp(n,[{key:"updateBoard",value:function(){if(sB(n.VERBOSE,"updateBoard"),this.board=this.rules.node.gameState.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=hB.empty(),this.chosenDirection=hB.empty(),this.landingCoord=hB.empty(),this.chosenOrientation=hB.empty()}},{key:"clickPiece",value:function(e,t){var n=this.canUserPlay("#clickPiece_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=this.board[t][e],i=this.rules.node.gameState.getCurrentOpponent();return r.getOwner()===i?this.cancelMove(kre.MUST_CHOOSE_PLAYER_PIECE()):(this.chosenCoord=hB.of(new lre(e,t)),e6.SUCCESS)}},{key:"chooseDirection",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"SiamComponent.chooseDirection("+e+")"),!(i=t.canUserPlay("#chooseDirection_"+e)).isFailure()){r.next=4;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 4:if(""!==e){r.next=8;break}t.chosenDirection=hB.empty(),t.landingCoord=t.chosenCoord,r.next=15;break;case 8:if(a=cre.factory.fromString(e).get(),t.chosenDirection=hB.of(a),t.landingCoord=hB.of(t.chosenCoord.get().getNext(a)),!t.landingCoord.get().isNotInRange(5,5)){r.next=15;break}return sB(n.VERBOSE,"orientation and direction should be the same: "+a),t.chosenOrientation=hB.of(a),r.next=14,t.tryMove();case 14:return r.abrupt("return",r.sent);case 15:return r.abrupt("return",e6.SUCCESS);case 16:case"end":return r.stop()}},r)}))()}},{key:"chooseOrientation",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"SiamComponent.chooseOrientation("+e+")"),!(i=t.canUserPlay("#chooseOrientation_"+e)).isFailure()){r.next=6;break}r.t0=t.cancelMove(i.getReason()),r.next=10;break;case 6:return t.chosenOrientation=hB.of(cre.factory.fromString(e).get()),r.next=9,t.tryMove();case 9:r.t0=r.sent;case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"insertAt",value:function(e,t){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(sB(n.VERBOSE,"SiamComponent.insertAt("+e+", "+t+")"),!(a=r.canUserPlay("#insertAt_"+e+"_"+t)).isFailure()){i.next=4;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 4:if(!r.chosenCoord.isPresent()){i.next=6;break}return i.abrupt("return",r.cancelMove(Vfe.CANNOT_INSERT_WHEN_SELECTED()));case 6:return r.chosenCoord=hB.of(new lre(e,t)),o=Hfe.getCoordDirection(e,t,r.rules.node.gameState),i.abrupt("return",(r.chosenDirection=hB.of(o),r.landingCoord=hB.of(r.chosenCoord.get().getNext(o)),e6.SUCCESS));case 9:case"end":return i.stop()}},i)}))()}},{key:"tryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Ffe(n.x,n.y,e.chosenDirection,e.chosenOrientation.get()),e.cancelMove(),t.next=4,e.chooseMove(r,e.rules.node.gameState);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}))()}},{key:"isMountain",value:function(e){return e===Bfe.MOUNTAIN}},{key:"choosingOrientation",value:function(e,t){var r=new lre(e,t);return!!(this.chosenCoord.isPresent()&&this.landingCoord.equalsValue(r)&&this.chosenOrientation.isAbsent())&&(sB(n.VERBOSE,"choosing orientation now"),!0)}},{key:"choosingDirection",value:function(e,t){var r=new lre(e,t);return!!(this.chosenCoord.equalsValue(r)&&this.chosenDirection.isAbsent()&&this.landingCoord.isAbsent()&&this.chosenOrientation.isAbsent())&&(sB(n.VERBOSE,"choosing direction now"),!0)}},{key:"getInsertionArrowTransform",value:function(e,t,n){var r="rotate(".concat(90*(cre.factory.fromString(n).get().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}},{key:"getPieceTransform",value:function(e,t){var n="rotate(".concat(90*(this.board[t][e].getDirection().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+(e+1)*this.SPACE_SIZE+", "+(t+1)*this.SPACE_SIZE+")",n].join(" ")}},{key:"getArrowTransform",value:function(e,t,n){return Zhe.getArrowTransform(this.SPACE_SIZE,new lre(e,t),cre.factory.fromString(n).get())}},{key:"getPieceClasses",value:function(e){return[this.getPlayerClass(e.getOwner())]}},{key:"getSquareClasses",value:function(e,t){var n=new lre(e,t);return this.movedPieces.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(wie);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-siam"]],features:[jC],decls:7,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 700 700","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 93, 90 50, 70 50, 70 7, 27.5 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngIf"],[4,"ngFor","ngForOf"],[0,"xlink","href","#arrow","class","base mid-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","click"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#mountain","fill","brown",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],["id","chooseDirection_","r","8",1,"arrow","selected-fill","no-stroke",3,"click"],[0,"xlink","href","#triangle","class","arrow selected-fill no-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"arrow","selected-fill","no-stroke",3,"id","click"],[0,"xlink","href","#mountain","fill","brown"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),pb(1,"defs"),yb(2,"polygon",1),yb(3,"polygon",2),yb(4,"polygon",3),gb(),lb(5,cde,2,2,"ng-container",4),lb(6,mde,2,1,"g",5),gb()),2&e&&(Rw(5),db("ngIf",t.isPlayerTurn()),Rw(1),db("ngForOf",t.board))},directives:[UT,FT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),_de=function(){var e=cp(function e(){sp(this,e)});return e.NO_MOVEMENT_BEFORE_TURN_40=function(){return $localize(Ou||(Ou=Vv(["You cannot move yet. Pick a space where you will put a new piece."])))},e.MUST_CUT=function(){return $localize(Tu||(Tu=Vv(["Several groups are of the same size, you must pick the one to keep."])))},e.CANNOT_CHOOSE_TO_KEEP=function(){return $localize(Iu||(Iu=Vv(["You cannot choose which part to keep when one is smaller than the other."])))},e.CAN_NO_LONGER_DROP=function(){return $localize(xu||(xu=Vv(["You cannot put new pieces anymore. Pick a piece to move."])))},e.MUST_CAPTURE_BIGGEST_GROUPS=function(){return $localize(Au||(Au=Vv(["You must choose one of the biggest groups to keep it."])))},e.CANNOT_KEEP_EMPTY_COORD=function(){return $localize(Ru||(Ru=Vv(["You cannot pick an empty space. Pick one of the biggest groups."])))},e.MUST_DROP_NEXT_TO_OTHER_PIECE=function(){return $localize(Nu||(Nu=Vv(["You must put this piece next to another piece."])))},e}(),wde=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;sp(this,n),(a=t.call(this,r)).pieces=e;var o=a.getCalculatedScale();return a.pieces=o.pieces,a.width=o.width,a.height=o.height,a.offset=null!=i?i:o.offset,a.pieces.makeImmutable(),a}return cp(n,[{key:"getCalculatedScale",value:function(){var e,t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=ip(this.pieces.listKeys());try{for(a.s();!(e=a.n()).done;){var o=e.value;t=Math.min(o.x,t),n=Math.max(o.x,n),r=Math.min(o.y,r),i=Math.max(o.y,i)}}catch(v){a.e(v)}finally{a.f()}var s=new Rre,u=new are(-t,-r);if(0!==t||0!==r){var c,l=ip(this.pieces.listKeys());try{for(l.s();!(c=l.n()).done;){var h=c.value,f=this.pieces.delete(h),d=h.getNext(u);s.set(d,f)}}catch(v){l.e(v)}finally{l.f()}}else s=this.pieces;return{width:n+1-t,height:i+1-r,pieces:s,offset:u}}},{key:"toRepresentation",value:function(){var e,t=lte.createTable(this.width,this.height,ate.NONE.value),n=ip(this.pieces.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.getPieceAt(r).value;t[r.y][r.x]=i}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"isIllegalLandingZone",value:function(e,t){return this.pieces.containsKey(e)?e6.failure(kre.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?e6.SUCCESS:e6.failure(_de.MUST_DROP_NEXT_TO_OTHER_PIECE())}},{key:"isCoordConnected",value:function(e,t){var n,r=ip(vre.factory.all);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e.getNext(i,1);if(this.pieces.containsKey(a)&&!1===t.equalsValue(a))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"isOnBoard",value:function(e){return this.pieces.containsKey(e)}},{key:"getPieceAt",value:function(e){return this.isOnBoard(e)?this.pieces.get(e).get():ate.NONE}},{key:"applyLegalDrop",value:function(e){var t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new n(t,this.turn+1)}},{key:"applyLegalDeplacement",value:function(e,t){var r=n.deplacePiece(this,e),i=new Rre;if(t.size()>0){i=new Rre;var a,o=ip(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.set(s,r.get(s).get())}}catch(u){o.e(u)}finally{o.f()}}else i=r.getCopy();return new n(i,this.turn+1)}},{key:"countPieces",value:function(){var e=this.pieces.reverse(),t=e.get(ote.ZERO).getOrElse(new Wie),n=e.get(ote.ONE).getOrElse(new Wie);return[t.size(),n.size()]}},{key:"switchPiece",value:function(e){var t=this.pieces.getCopy(),r=this.getPieceAt(e);if(r.isPlayer())return t.replace(e,r.getOpponent()),new n(t,this.turn,this.offset);i6.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}},{key:"equals",value:function(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation([[ote.ZERO.value],[ote.ONE.value]],0)}},{key:"fromRepresentation",value:function(e,t,r){for(var i=new Rre,a=0;a<e.length;a++)for(var o=0;o<e[0].length;o++)e[a][o]!==ate.NONE.value&&i.set(new lre(o,a),ote.of(e[a][o]));return new n(i,t,r)}},{key:"deplacePiece",value:function(e,t){var n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}},{key:"getGroups",value:function(e,t){var r,i=new Rre,a=0,o=ip(vre.factory.all);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=t.getNext(s,1);i=n.putCoordInGroup(e,u,i,""+a),a++}}catch(f){o.e(f)}finally{o.f()}for(var c=i.reverse(),l=new bre,h=0;h<c.size();h++)l.add(c.getByIndex(h).value);return l}},{key:"putCoordInGroup",value:function(e,t,r,i){if(e.get(t).isPresent()&&r.get(t).isAbsent()){r.set(t,i);var a,o=ip(vre.factory.all);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=t.getNext(s,1);r=n.putCoordInGroup(e,u,r,i)}}catch(c){o.e(c)}finally{o.f()}}return r}}]),n}(Ere),Cde=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;if(sp(this,n),(a=t.call(this)).start=e,a.landing=r,a.keep=i,e.equalsValue(r))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(i))throw new Error("Cannot keep starting coord, since it will always be empty after move!");return Qv(a)}return cp(n,[{key:"isDrop",value:function(){return this.start.isAbsent()}},{key:"isCut",value:function(){return this.keep.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}},{key:"equals",value:function(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}],[{key:"fromDrop",value:function(e){return new n(hB.empty(),e,hB.empty())}},{key:"fromMovement",value:function(e,t){return new n(hB.of(e),t,hB.empty())}},{key:"fromCut",value:function(e,t,r){return new n(hB.of(e),t,hB.of(r))}}]),n}(Ore);Cde.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"encodeMove",value:function(e){return{start:e.start.isPresent()?lre.encoder.encode(e.start.get()):null,landing:lre.encoder.encode(e.landing),keep:e.keep.isPresent()?lre.encoder.encode(e.keep.get()):null}}},{key:"decodeMove",value:function(e){var t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");var n=lre.encoder.decode(t.landing);if(null==t.start)return Cde.fromDrop(n);var r=lre.encoder.decode(t.start);if(null==t.keep)return Cde.fromMovement(r,n);var i=lre.encoder.decode(t.keep);return Cde.fromCut(r,n,i)}}]),n}(nte));var bde=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}},{key:"isLegal",value:function(e,t){sB(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});var r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):n.isLegalPhaseTwoMove(e,t)}},{key:"isLegalDrop",value:function(e,t){return!1===e.isDrop()?J5.failure(_de.NO_MOVEMENT_BEFORE_TURN_40()):J5.success(t.pieces.getKeySet())}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getCurrentOpponent(),r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return Dre.getVictory(n);if(t.turn>39){var i=t.countPieces(),a=i[0],o=i[1];return a<6&&o<6?a<o?Dre.ONE_WON:o<a?Dre.ZERO_WON:Dre.DRAW:a<6?Dre.getDefeat(ote.ZERO):o<6?Dre.getDefeat(ote.ONE):Dre.ONGOING}return Dre.ONGOING}},{key:"startSearchingVictorySources",value:function(){sB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"getShapeVictory",value:function(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();var n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(sB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(vre.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return[];var o=(e+i.length)%6;i.push(a),a=a.getNext(vre.factory.all[o],1)}return i}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=vre.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return[];s=!0,i=i.getOpposite(),a=a.getNext(i,o.length)}a=a.getNext(i,1)}return o}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=vre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.length%2==0&&(i=vre.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return a}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=vre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.push(o),a.length%2==0&&(i=vre.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return a}}],[{key:"getLegalLandings",value:function(e){var t,n=new Wie,r=ip(e.pieces.listKeys());try{for(r.s();!(t=r.n()).done;){var i,a=t.value,o=ip(vre.factory.all);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=a.getNext(s,1);e.getPieceAt(u)===ate.NONE&&n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n.toList()}},{key:"isLegalPhaseTwoMove",value:function(e,t){if(e.isDrop())return J5.failure(_de.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case ate.NONE:return J5.failure(kre.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return J5.failure(kre.CANNOT_CHOOSE_OPPONENT_PIECE())}var r=wde.deplacePiece(t,e),i=wde.getGroups(r,e.start.get());if(n.isSplit(i)){var a=this.getBiggerGroups(i);return 1===a.size()?e.keep.isPresent()?J5.failure(_de.CANNOT_CHOOSE_TO_KEEP()):J5.success(a.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,a,r)}return J5.success(new Wie)}},{key:"isSplit",value:function(e){return e.size()>1}},{key:"getBiggerGroups",value:function(e){var t,n=0,r=new bre,i=ip(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.size();o>n?(n=o,r=new bre([a])):o===n&&r.add(a)}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"moveKeepBiggerGroup",value:function(e,t,n){if(e.isAbsent())return J5.failure(_de.MUST_CUT());if(n.get(e.get()).isAbsent())return J5.failure(_de.CANNOT_KEEP_EMPTY_COORD());var r,i=e.get(),a=ip(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.contains(i))return J5.success(o)}}catch(s){a.e(s)}finally{a.f()}return J5.failure(_de.MUST_CAPTURE_BIGGEST_GROUPS())}}]),n}(Lre),Ede=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"calculateBoardValue",value:function(e,t){this.startSearchingVictorySources();for(var n={status:xre.DEFAULT,victory:hB.empty(),preVictory:hB.empty(),sum:0};this.hasNextVictorySource();){var r,i=this.getNextVictorySource();if((r=n.status===xre.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n)).status===xre.VICTORY)return r;n={status:r.status,victory:hB.empty(),preVictory:r.preVictory,sum:n.sum+r.sum}}return n}}]),n}(_re),Sde=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e)).value=e,i.preVictory=r,i}return cp(n)}(wre),Pde=function(e){Yv(n,e);var t=Jv(n);function n(){var e;return sp(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return cp(n,[{key:"getListMoves",value:function(e){var t=n.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(e,r);var i=bde.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getListDeplacement(e.gameState,i)}},{key:"createForcedDrop",value:function(e){sB(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});var t=[],n=Cde.fromDrop(e.preVictory.get());return t.push(n),t}},{key:"createForcedDeplacement",value:function(e,t){sB(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});var n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}},{key:"getDeplacementFrom",value:function(e,t,n){var r,i=[],a=ip(t);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,u=ip(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Cde.fromMovement(s,c);if(e.isCoordConnected(c,hB.of(s))){var h=wde.deplacePiece(e,l),f=wde.getGroups(h,l.start.get());if(bde.isSplit(f)){var d,v=ip(f);try{for(v.s();!(d=v.n()).done;){var p=d.value.getAnyElement().get(),g=Cde.fromCut(s,c,p);i.push(g)}}catch(y){v.e(y)}finally{v.f()}}else i.push(l)}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}return i}},{key:"getSafelyMovablePieceOrFirstOne",value:function(e){var t,n=e.gameState,r=n.pieces.reverse(),i=n.getCurrentPlayer(),a=r.get(i).get(),o=a.getAnyElement().get(),s=[],u=ip(a);try{for(u.s();!(t=u.n()).done;){var c=t.value;!1===this.isPieceBlockingAVictory(n,c)&&s.push(c)}}catch(l){u.e(l)}finally{u.f()}return new Wie(0===s.length?[o]:s)}},{key:"isPieceBlockingAVictory",value:function(e,t){var n=e.switchPiece(t),r=Cde.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===xre.VICTORY)return!0;return!1}},{key:"getListDrop",value:function(e){var t,n=[],r=ip(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=Cde.fromDrop(i);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getListDeplacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}},{key:"getBoardValue",value:function(e){var t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue(),a={status:xre.DEFAULT,victory:hB.empty(),preVictory:hB.empty(),sum:0};t.isPresent()&&(a=this.calculateBoardValue(t.get(),n));var o=hB.empty();if(a.status===xre.DEFAULT&&a.preVictory.isPresent()&&(o=hB.of(a.preVictory.get())),a.status===xre.VICTORY)return new Sde(i,hB.empty());if(n.turn>39){var s=n.countPieces(),u=s[0],c=s[1];return u<6&&c<6?new Sde(u<c?ote.ONE.getVictoryValue():c<u?ote.ZERO.getVictoryValue():0,hB.empty()):u<6?new Sde(ote.ZERO.getDefeatValue(),hB.empty()):c<6?new Sde(ote.ONE.getDefeatValue(),hB.empty()):new Sde(u-c,o)}return new Sde(a.status===xre.PRE_VICTORY?r.getPreVictory():a.sum*r.getScoreModifier(),o)}},{key:"startSearchingVictorySources",value:function(){sB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(sB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(vre.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return{status:xre.PRE_VICTORY,victory:hB.empty(),preVictory:hB.empty(),sum:0};var o=(e+i.length)%6;i.push(a),a=a.getNext(vre.factory.all[o],1)}return{status:xre.VICTORY,victory:hB.of(i),preVictory:hB.empty(),sum:0}}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=vre.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return{status:xre.PRE_VICTORY,victory:hB.empty(),preVictory:hB.empty(),sum:0};s=!0,i=i.getOpposite(),a=a.getNext(i,o.length-1)}a=a.getNext(i,1)}return{status:xre.VICTORY,victory:hB.of(o),preVictory:hB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=vre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:xre.PRE_VICTORY,victory:hB.empty(),preVictory:hB.empty(),sum:0};a.length%2==0&&(i=vre.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return{status:xre.VICTORY,victory:hB.of(a),preVictory:hB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){sB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=vre.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:xre.PRE_VICTORY,victory:hB.empty(),preVictory:hB.empty(),sum:0};a.push(o),a.length%2==0&&(i=vre.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return{status:xre.VICTORY,victory:hB.of(a),preVictory:hB.empty(),sum:0}}},{key:"getBoardInfo",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});var i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}},{key:"getBoardInfoForCircle",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=[t],o=t.getNext(vre.factory.all[e],1),s=0,u=hB.empty();a.length<6;){var c=n.getPieceAt(o);if(c===i)return r;var l=(e+a.length)%6;a.push(o);var h=vre.factory.all[l];c===ate.NONE?(s+=.16,u=hB.of(o)):s++,o=o.getNext(h,1)}return this.getBoardInfoResult(s,u,a,r)}},{key:"getBoardInfoResult",value:function(e,t,n,r){var i=r.preVictory;if(4.16===e){if(sB(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:xre.PRE_VICTORY,victory:hB.empty(),preVictory:hB.empty(),sum:0};i=t}else if(5===e)return{status:xre.VICTORY,victory:hB.of(n),preVictory:hB.empty(),sum:0};return{status:r.status,victory:hB.empty(),preVictory:i,sum:r.sum+e}}},{key:"getBoardInfoForLine",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=vre.factory.all[e],a=t.getPrevious(i,5),o=[],s=[],u=hB.empty(),c=0;c<6;c++){var l=this.updateEncounterAndReturnLastEmpty(n,a,s);l.isPresent()&&(u=l),o.push(a),a=a.getNext(i,1)}for(var h=r.status,f=r.preVictory,d=0,v=0;d<6;){var p=s.reduce(function(e,t){return e+t});if(6===p)return{status:xre.VICTORY,victory:hB.of(o),preVictory:hB.empty(),sum:0};5.16===p&&h===xre.DEFAULT&&(f.isPresent()?(a6(!1===f.equals(u),"Impossible to have point aligned with differents line to a same point"),h=xre.PRE_VICTORY):f=u),v=Math.max(v,p),(o=o.slice(1,6)).push(a),s=s.slice(1,6);var g=this.updateEncounterAndReturnLastEmpty(n,a,s);g.isPresent()&&(u=g),d++,a=a.getNext(i,1)}var y={status:h,victory:hB.of(o),preVictory:f,sum:v};return this.getBoardInfoResult(v,u,o,y)}},{key:"updateEncounterAndReturnLastEmpty",value:function(e,t,n){var r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),hB.empty();case ate.NONE:return n.push(.16),hB.of(t);default:return n.push(1),hB.empty()}}},{key:"getBoardInfoForTriangleCorner",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=vre.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=hB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===ate.NONE?(u+=.16,c=hB.of(s)):u++,o.length%2==0&&(a=vre.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}},{key:"getBoardInfoForTriangleEdge",value:function(e,t,n,r){sB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=vre.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=hB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===ate.NONE?(u+=.16,c=hB.of(s)):u++,o.push(s),o.length%2==0&&(a=vre.factory.all[(e+o.length)%6]),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}}],[{key:"get",value:function(){if(null==n.INSTANCE){var e=new bde(wde);n.INSTANCE=new n(e,"SixMinimax")}return n.INSTANCE}}]),n}(Ede),Ode=ate.NONE.value,Tde=ote.ZERO.value,Ide=ote.ONE.value,xde=function(){var e=cp(function e(){sp(this,e)});return e.MOVEMENT_NOT_DISCONNECTING=function(){return $localize(Mu||(Mu=Vv(["This move does not disconnect your opponent's pieces. Try again with another piece."])))},e.MOVEMENT_SELF_DISCONNECTING=function(){return $localize(Du||(Du=Vv(["You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!"])))},e}(),Ade=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(Lu||(Lu=Vv(["Six"]))),$localize(Fu||(Fu=Vv(["Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.\n        Each player has 21 pieces, with one for each player already on the board.\n        The goal of the game is to form one of the three winning shapes with your pieces."]))),wde.getInitialState()),Vre.fromMove($localize(Bu||(Bu=Vv(["Victory (line)"]))),$localize(Uu||(Uu=Vv(["On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>\n        Find the victory. You're playing Dark."]))),wde.fromRepresentation([[Tde,Ide,Ide,Ide,Ide,Tde],[Ode,Tde,Ide,Ode,Tde,Ode],[Ide,Ide,Tde,Ode,Ode,Ode],[Ode,Ode,Tde,Ode,Ode,Ode],[Ode,Tde,Ode,Ode,Ode,Ode],[Tde,Ode,Ode,Ode,Ode,Ode]],0),[Cde.fromDrop(new lre(3,2))],$localize(Vu||(Vu=Vv(["Congratulations!"]))),$localize(zu||(zu=Vv(["Failed!"])))),Vre.fromMove($localize(Hu||(Hu=Vv(["Victory (circle)"]))),$localize(Gu||(Gu=Vv(["On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),wde.fromRepresentation([[Ode,Ode,Ode,Ide,Ode,Ode],[Ode,Ode,Ide,Ide,Tde,Tde],[Ode,Ide,Ode,Tde,Ide,Ode],[Ide,Tde,Tde,Tde,Tde,Ide]],0),[Cde.fromDrop(new lre(5,2))],$localize(qu||(qu=Vv(["Congratulations! Note that if a piece is inside the circle, it does not change anything."]))),$localize($u||($u=Vv(["Failed!"])))),Vre.fromMove($localize(Wu||(Wu=Vv(["Victory (triangle)"]))),$localize(ju||(ju=Vv(["On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),wde.fromRepresentation([[Ode,Ode,Ode,Ide,Ode,Ode],[Ode,Tde,Ide,Tde,Tde,Tde],[Ode,Tde,Ode,Tde,Tde,Ode],[Ide,Ide,Ide,Ode,Ide,Ode]],0),[Cde.fromDrop(new lre(3,3))],$localize(Zu||(Zu=Vv(["Congratulations!"]))),$localize(Yu||(Yu=Vv(["Failed!"])))),Vre.fromPredicate($localize(Ku||(Ku=Vv(["Second phase"]))),$localize(Ju||(Ju=Vv(["After 40 turns, your pieces have all been placed and we move on to the second phase of the game.\n        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.\n        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>\n        You're playing Dark. Make a move that disconnects one of your opponent's pieces."]))),wde.fromRepresentation([[Ode,Ode,Ode,Ode,Ode,Ode,Ode,Ide,Ode],[Ode,Ode,Ode,Ode,Ode,Ode,Tde,Ode,Ode],[Ode,Ode,Ode,Ode,Tde,Tde,Tde,Ode,Ode],[Ode,Ode,Ode,Ode,Ide,Ide,Ode,Ide,Tde],[Ode,Tde,Ide,Ide,Tde,Tde,Ide,Ode,Ode],[Tde,Tde,Tde,Tde,Ide,Ide,Ide,Tde,Ode],[Ide,Ide,Tde,Ode,Ide,Ide,Tde,Ode,Ode],[Ode,Tde,Ode,Tde,Tde,Ode,Ode,Ode,Ode],[Ide,Ide,Ide,Ide,Ode,Ode,Ode,Ode,Ode],[Ode,Tde,Ode,Ide,Ode,Ode,Ode,Ode,Ode]],40),Cde.fromMovement(new lre(6,1),new lre(5,1)),function(e,t){var n=t.countPieces();return 19===n[0]?18===n[1]?e6.SUCCESS:e6.failure(xde.MOVEMENT_NOT_DISCONNECTING()):e6.failure(xde.MOVEMENT_SELF_DISCONNECTING())},$localize(Qu||(Qu=Vv(["Congratulations, your opponent now has one piece less and you're closer to victory!"])))),Vre.fromPredicate($localize(Xu||(Xu=Vv(["Victory by disconnection"]))),$localize(ec||(ec=Vv(["During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.\n        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.\n        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>\n        Here, you're playing Dark and you can win. Do it!"]))),wde.fromRepresentation([[Ode,Ode,Ode,Ode,Ode,Ide],[Ode,Ode,Ode,Ode,Tde,Ide],[Ode,Ode,Ode,Ide,Tde,Tde],[Ode,Ode,Tde,Ode,Ide,Tde],[Ide,Ide,Ode,Ode,Ode,Tde],[Tde,Ide,Ode,Ode,Ode,Ode],[Tde,Ode,Ode,Ode,Ode,Ode]],40),Cde.fromMovement(new lre(2,3),new lre(3,3)),function(e,t){return e.start.equalsValue(new lre(2,3))?e6.SUCCESS:e6.failure(xde.MOVEMENT_NOT_DISCONNECTING())},$localize(tc||(tc=Vv(["Congratulations, you won!"])))),Vre.fromPredicate($localize(nc||(nc=Vv(["Special disconnection"]))),$localize(rc||(rc=Vv(["During a disconnection, two or more groups could have the same size,\n        in which case you will have to click on the group you wish to keep.<br/><br/>\n        You're playing Dark, play such a move!"]))),wde.fromRepresentation([[Ode,Ode,Ode,Ode,Ode,Ide],[Ode,Ode,Ode,Ode,Tde,Ide],[Ode,Ode,Ode,Ide,Tde,Tde],[Tde,Ode,Tde,Ode,Ode,Ide],[Ide,Ide,Ode,Ode,Ode,Ode],[Tde,Tde,Ode,Ode,Ode,Ode],[Tde,Ode,Ode,Ode,Ode,Ode]],40),Cde.fromCut(new lre(2,3),new lre(2,5),new lre(2,5)),function(e,t){return e.keep.isAbsent()?e6.failure($localize(ic||(ic=Vv(["This move has not cut the board in two equal halves."])))):t.getPieceAt(e.landing.getNext(t.offset))===ate.NONE?e6.failure($localize(ac||(ac=Vv(["Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again."])))):e6.SUCCESS},$localize(oc||(oc=Vv(["Congratulations, you won!"]))))]});function Rde(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",10),bb("click",function(){var e=Jy(n).$implicit;return Pb().onPieceClick(e)}),gb()}if(2&e){var r=t.$implicit,i=Pb();Ib("id","piece_",r.x,"_",r.y,""),db("ngClass",i.getPieceClass(r)),ob("points",i.getHexaCoordsAt(r))}}function Nde(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",11),bb("click",function(){var e=Jy(n).$implicit;return Pb().onNeighborClick(e)}),gb()}if(2&e){var r=t.$implicit,i=Pb();Ib("id","neighbor_",r.x,"_",r.y,""),ob("points",i.getHexaCoordsAt(r))}}function Mde(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",10),bb("click",function(){Jy(n);var e=Pb();return e.onPieceClick(e.chosenLanding.get())}),gb()}if(2&e){var r=Pb();Ib("id","chosenLanding_",r.chosenLanding.get().x,"_",r.chosenLanding.get().y,""),db("ngClass",r.getPlayerClass(r.state.getCurrentPlayer())),ob("points",r.getHexaCoordsAt(r.chosenLanding.get()))}}function Dde(e,t){if(1&e&&(Pm(),yb(0,"polyline",12)),2&e){var n=t.$implicit,r=Pb();Ib("id","disconnected_",n.x,"_",n.y,""),ob("points",r.getHexaCoordsAt(n))}}function Lde(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",13),bb("click",function(){Jy(n);var e=Pb();return e.onNeighborClick(e.leftCoord.get())}),gb()}if(2&e){var r=Pb();Ib("id","leftCoord_",r.leftCoord.get().x,"_",r.leftCoord.get().y,""),ob("points",r.getHexaCoordsAt(r.leftCoord.get()))}}function Fde(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",14),bb("click",function(){Jy(n);var e=Pb();return e.onPieceClick(e.lastDrop.get())}),gb()}if(2&e){var r=Pb();Ib("id","lastDrop_",r.lastDrop.get().x,"_",r.lastDrop.get().y,""),ob("points",r.getHexaCoordsAt(r.lastDrop.get()))}}function Bde(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",15),bb("click",function(){Jy(n);var e=Pb();return e.onPieceClick(e.selectedPiece.get())}),gb()}if(2&e){var r=Pb();Ib("id","selectedPiece_",r.selectedPiece.get().x,"_",r.selectedPiece.get().y,""),db("ngClass",r.getSelectedPieceClass()),ob("points",r.getHexaCoordsAt(r.selectedPiece.get()))}}function Ude(e,t){if(1&e&&(Pm(),yb(0,"polyline",16)),2&e){var n=t.$implicit,r=Pb();Ib("id","victoryCoord_",n.x,"_",n.y,""),ob("points",r.getHexaCoordsAt(n))}}function Vde(e,t){if(1&e){var n=_b();Pm(),pb(0,"g",19),bb("click",function(){var e=Jy(n).$implicit;return Pb(2).onPieceClick(e)}),yb(1,"polyline",20),gb()}if(2&e){var r=t.$implicit,i=Pb(2);Rw(1),Ib("id","cuttable_",r.x,"_",r.y,""),ob("points",i.getHexaCoordsAt(r))}}function zde(e,t){if(1&e&&(Pm(),pb(0,"g",17),lb(1,Vde,2,3,"g",18),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}var Hde=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).disconnecteds=[],r.cuttableGroups=[],r.leftCoord=hB.empty(),r.lastDrop=hB.empty(),r.selectedPiece=hB.empty(),r.chosenLanding=hB.empty(),r.nextClickShouldSelectGroup=!1,r.rules=new bde(wde),r.availableMinimaxes=[new Pde(r.rules,"SixMinimax")],r.encoder=Cde.encoder,r.tutorial=(new Ade).tutorial,r.SPACE_SIZE=30,r.hexaLayout=new pre(1.5*r.SPACE_SIZE,new lre(2*r.SPACE_SIZE,0),mre.INSTANCE),r.updateBoard(),r}return cp(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=hB.empty(),this.chosenLanding=hB.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=hB.empty(),this.lastDrop=hB.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}},{key:"getViewBox",value:function(){var e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}},{key:"mapAbstractCoordToCornerCoords",value:function(){var e,t=this,n=[],r=ip(this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(function(e){return t.hexaLayout.getHexaCoordsAt(e)}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getLimits",value:function(e){var t,n=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=ip(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.x<i&&(i=s.x),s.y<a&&(a=s.y),n=Math.max(n,s.x),r=Math.max(r,s.y)}}catch(u){o.e(u)}finally{o.f()}return{minX:i,minY:a,maxX:n,maxY:r}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();this.lastDrop=hB.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?hB.of(e.start.get().getNext(this.state.offset,1)):hB.empty();var t=this.rules.node.gameState;this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}},{key:"getDisconnected",value:function(){var e,t=this,n=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.rules.node.gameState.pieces.listKeys(),i=[],a=ip(n);try{var o=function(){var n=e.value;!1===t.rules.node.move.get().start.equalsValue(n)&&!1===r.some(function(e){return e.equals(n.getNext(t.state.offset,1))})&&i.push(n.getNext(t.state.offset,1))};for(a.s();!(e=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}var s=this.lastDrop.get();return!1===this.pieces.some(function(e){return e.equals(s)})&&!1===r.some(function(e){return e.equals(s)})&&i.push(s),i}},{key:"getEmptyNeighbors",value:function(){var e=bde.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){var t=this.chosenLanding.get();e=e.filter(function(e){return!1===e.equals(t)})}return e}},{key:"getPieceClass",value:function(e){var t=this.rules.node.gameState.getPieceAt(e);return this.getPlayerClass(t)}},{key:"onPieceClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#piece_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.state.turn<40)){n.next=5;break}return n.abrupt("return",t.cancelMove(_de.NO_MOVEMENT_BEFORE_TURN_40()));case 5:if(!t.chosenLanding.isAbsent()){n.next=7;break}return n.abrupt("return",t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(kre.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=hB.of(e),e6.SUCCESS));case 7:return i=Cde.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e),n.abrupt("return",t.chooseMove(i,t.state));case 9:case"end":return n.stop()}},n)}))()}},{key:"onNeighborClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#neighbor_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.nextClickShouldSelectGroup){n.next=5;break}return n.abrupt("return",t.cancelMove(_de.MUST_CUT()));case 5:if(!(t.state.turn<40)){n.next=7;break}return n.abrupt("return",t.chooseMove(Cde.fromDrop(e),t.state));case 7:if(!t.selectedPiece.isAbsent()){n.next=9;break}return n.abrupt("return",t.cancelMove(_de.CAN_NO_LONGER_DROP()));case 9:return i=Cde.fromMovement(t.selectedPiece.get(),e),a=bde.isLegalPhaseTwoMove(i,t.state),n.abrupt("return",t.neededCutting(a)?(t.chosenLanding=hB.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,e6.SUCCESS):t.chooseMove(i,t.state));case 11:case"end":return n.stop()}},n)}))()}},{key:"neededCutting",value:function(e){return e.isFailure()&&e.getReason()===_de.MUST_CUT()}},{key:"moveVirtuallyPiece",value:function(){var e=this.selectedPiece.get();this.pieces=this.pieces.filter(function(t){return!1===t.equals(e)}),this.neighbors=this.getEmptyNeighbors()}},{key:"showCuttable",value:function(){var e=Cde.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=wde.deplacePiece(this.state,e),n=wde.getGroups(t,e.start.get()),r=bde.getBiggerGroups(n);this.cuttableGroups=[];var i,a=ip(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.cuttableGroups.push(o.toList())}}catch(s){a.e(s)}finally{a.f()}}},{key:"getSelectedPieceClass",value:function(){return this.chosenLanding.isPresent()?"moved":"selected"}}]),n}(fre);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-six"]],features:[jC],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured",3,"id",4,"ngFor","ngForOf"],["class","base round moved mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round highlighted mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured",3,"id"],[1,"base","round","moved","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","highlighted","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["stroke-linecap","round",1,"no-fill",3,"id"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,Rde,1,4,"polyline",1),lb(2,Nde,1,3,"polyline",2),lb(3,Mde,1,4,"polyline",3),lb(4,Dde,1,3,"polyline",4),lb(5,Lde,1,3,"polyline",5),lb(6,Fde,1,3,"polyline",6),lb(7,Bde,1,4,"polyline",7),lb(8,Ude,1,3,"polyline",8),lb(9,zde,2,1,"g",9),gb()),2&e&&(ob("viewBox",t.viewBox),Rw(1),db("ngForOf",t.pieces),Rw(1),db("ngForOf",t.neighbors),Rw(1),db("ngIf",t.chosenLanding.isPresent()),Rw(1),db("ngForOf",t.disconnecteds),Rw(1),db("ngIf",t.leftCoord.isPresent()),Rw(1),db("ngIf",t.lastDrop.isPresent()),Rw(1),db("ngIf",t.selectedPiece.isPresent()),Rw(1),db("ngForOf",t.victoryCoords),Rw(1),db("ngForOf",t.cuttableGroups))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Gde=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getMaximalDistance",value:function(){return 9}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return J5.success(r)}catch(r){return J5.failure(r.message)}}}]),n}(Nie);Gde.encoder=Aie.getEncoder(9,9,Gde.of);var qde={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:ote.ZERO},$de=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Lie.UNOCCUPIED,t=Lie.INVADERS,r=Lie.DEFENDERS;return new n([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,Lie.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}]),n}(Bie),Wde=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.call(this,$de,qde,Gde.of)}return cp(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Mre.ruler=this.singleton,n.singleton}}]),n}(Vie),jde=Lie.UNOCCUPIED,Zde=Lie.INVADERS,Yde=Lie.DEFENDERS,Kde=Lie.PLAYER_ONE_KING,Jde=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(sc||(sc=Vv(["Goal of the game"]))),$localize(uc||(uc=Vv(["Tablut is a strategy game that was played by the Vikings.\n        The goal of the game is different for each player.\n        The attacker plays first. Its pieces (dark) are close to the edges.\n        Its goal is to capture the king, which is in the center of the board.\n        The defender plays second. Its pieces (light) are in the middle.\n        Its goal is to move the king on one of the 4 thrones in the corners.\n        Note that the square in which the king starts, in the center of the board, is also a throne."]))),$de.getInitialState()),Vre.anyMove($localize(cc||(cc=Vv(["Moving"]))),$localize(lc||(lc=Vv(["All pieces move the same way.\n        Similarly to a rook in chess, a piece can move:\n        <ol>\n            <li>By as many squares as you want.</li>\n            <li>Without going over another piece or stopping on another piece.</li>\n            <li>Horizontally or vertically.</li>\n            <li>Only the king can land on a throne.</li>\n        </ol>\n        To move a piece, click on it and then on its landing square.<br/><br/>\n        You're playing Dark, do the first move."]))),$de.getInitialState(),Gde.of(new lre(4,1),new lre(1,1)),$localize(hc||(hc=Vv(["Congratulations!"])))),Vre.fromMove($localize(fc||(fc=Vv(["Capturing a soldier (1/2)"]))),$localize(dc||(dc=Vv(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new $de([[jde,jde,jde,Zde,Zde,Zde,jde,jde,jde],[jde,jde,jde,jde,Zde,jde,jde,jde,jde],[jde,jde,jde,jde,Yde,jde,jde,jde,jde],[jde,jde,jde,Zde,Yde,jde,jde,jde,Zde],[Zde,Zde,Yde,Yde,Kde,Yde,Yde,Zde,Zde],[jde,jde,jde,jde,Yde,jde,jde,jde,Zde],[jde,jde,jde,jde,Yde,jde,jde,jde,jde],[jde,jde,jde,jde,Zde,jde,jde,jde,jde],[jde,jde,jde,Zde,Zde,Zde,jde,jde,jde]],1),[Gde.of(new lre(2,4),new lre(2,3)),Gde.of(new lre(4,2),new lre(3,2))],$localize(vc||(vc=Vv(["Congratulations, that will teach him a lesson!"]))),$localize(pc||(pc=Vv(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Vre.fromMove($localize(gc||(gc=Vv(["Capturing a soldier (2/2)"]))),$localize(yc||(yc=Vv(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new $de([[jde,jde,jde,Zde,Zde,Zde,jde,jde,jde],[jde,jde,jde,jde,Zde,jde,jde,jde,jde],[jde,jde,jde,jde,Yde,jde,jde,jde,jde],[jde,jde,Yde,jde,Kde,jde,Yde,jde,Zde],[Zde,Zde,jde,Yde,jde,Yde,Yde,Zde,Zde],[jde,jde,jde,jde,Yde,jde,jde,jde,Zde],[jde,jde,jde,jde,Yde,jde,jde,jde,jde],[jde,jde,jde,jde,Zde,jde,jde,jde,jde],[jde,jde,jde,Zde,Zde,Zde,jde,jde,jde]],12),[Gde.of(new lre(1,4),new lre(2,4))],$localize(mc||(mc=Vv(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(kc||(kc=Vv(["Failed, you did not do the expected move."])))),Vre.fromMove($localize(_c||(_c=Vv(["Capturing the king (1/2)"]))),$localize(wc||(wc=Vv(["To capture the king, two soldiers are not enough.\n        For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.\n        This also works if the king is on the throne.<br/><br/>\n        Capture the king."]))),new $de([[jde,jde,jde,jde,jde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde],[jde,Zde,jde,jde,jde,jde,jde,jde,jde],[Zde,Kde,jde,Zde,jde,jde,jde,jde,jde],[jde,Zde,jde,jde,jde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde]],72),[Gde.of(new lre(3,4),new lre(2,4))],$localize(Cc||(Cc=Vv(["Congratulations, you won!"]))),$localize(bc||(bc=Vv(["Failed, you let the king run away."])))),Vre.fromMove($localize(Ec||(Ec=Vv(["Capturing the king (2/2)"]))),$localize(Sc||(Sc=Vv(["Another way to capture the king is to immobilize it against an edge of the board.\n        Note that the king cannot be captured next to a throne.<br/><br/>\n        Capture the king."]))),new $de([[jde,jde,Zde,Kde,Zde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde],[jde,jde,jde,Zde,jde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde],[jde,jde,jde,jde,jde,jde,jde,jde,jde]],72),[Gde.of(new lre(3,3),new lre(3,1))],$localize(Pc||(Pc=Vv(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Oc||(Oc=Vv(["Failed!"]))))]});function Qde(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",6),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb()}if(2&e){var r=Pb(2).index,i=Pb().index,a=Pb();ob("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function Xde(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",7),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb()}if(2&e){var r=Pb(2).index,i=Pb().index,a=Pb();ob("transform","translate("+r*a.SPACE_SIZE+" "+i*a.SPACE_SIZE+")")}}function eve(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Qde,1,1,"polyline",4),lb(2,Xde,1,1,"ng-template",null,5,NP),gb()),2&e){var n=hb(3),r=Pb().index,i=Pb().index,a=Pb();Rw(1),db("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function tve(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"line",11),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(2,"line",11),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(3,"line",11),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(4,"line",11),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(5,"line",11),bb("click",function(){Jy(n);var e=Pb(2).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),gb()}if(2&e){var r=Pb(2).index,i=Pb().index,a=Pb();Rw(1),ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.05*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.2*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.95*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.65*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.4*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.75*a.SPACE_SIZE)}}function nve(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"polyline",13),bb("click",function(){Jy(n);var e=Pb(3).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),gb()}if(2&e){var r=Pb(3).index,i=Pb().index,a=Pb();Rw(1),ob("points",a.getKingPolyline(r,i))}}function rve(e,t){if(1&e){var n=_b();Pm(),pb(0,"line",11),bb("click",function(){Jy(n);var e=Pb(3).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(1,"line",11),bb("click",function(){Jy(n);var e=Pb(3).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(2,"line",11),bb("click",function(){Jy(n);var e=Pb(3).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),pb(3,"line",11),bb("click",function(){Jy(n);var e=Pb(3).index,t=Pb().index;return Pb().onClick(e,t)}),gb()}if(2&e){var r=Pb(3).index,i=Pb().index,a=Pb();ob("x1",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.04*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.5*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.96*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.04*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.5*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.96*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.5*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE),Rw(1),ob("x1",a.SPACE_SIZE*r+.85*a.SPACE_SIZE)("y1",a.SPACE_SIZE*i+.15*a.SPACE_SIZE)("x2",a.SPACE_SIZE*r+.15*a.SPACE_SIZE)("y2",a.SPACE_SIZE*i+.85*a.SPACE_SIZE)}}function ive(e,t){if(1&e&&(Pm(),lb(0,nve,2,1,"g",9),lb(1,rve,4,16,"ng-template",null,12,NP)),2&e){var n=hb(2),r=Pb(2).index,i=Pb().index;db("ngIf",Pb().isKing(r,i))("ngIfElse",n)}}function ave(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"circle",8),bb("click",function(){Jy(n);var e=Pb().index,t=Pb().index;return Pb().onClick(e,t)}),gb(),lb(2,tve,6,20,"g",9),lb(3,ive,3,2,"ng-template",null,10,NP),gb()}if(2&e){var r=hb(4),i=Pb().index,a=Pb().index,o=Pb();Rw(1),db("ngClass",o.getPieceClasses(i,a)),ob("r",(o.SPACE_SIZE-o.STROKE_WIDTH)/2)("cx",o.SPACE_SIZE*i+.5*o.SPACE_SIZE)("cy",o.SPACE_SIZE*a+.5*o.SPACE_SIZE),Rw(1),db("ngIf",o.isInvader(i,a))("ngIfElse",r)}}function ove(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",2),bb("click",function(){var e=Jy(n).index,t=Pb().index;return Pb().onClick(e,t)}),gb(),lb(2,eve,4,2,"g",3),lb(3,ave,5,6,"g",3),gb()}if(2&e){var r=t.index,i=Pb().index,a=Pb();Rw(1),Ib("id","click_",r,"_",i,""),db("ngClass",a.getRectClasses(r,i)),ob("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Rw(1),db("ngIf",a.board[i][r]===a.NONE&&a.isThrone(r,i)),Rw(1),db("ngIf",a.board[i][r]!==a.NONE)}}function sve(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,ove,4,9,"g",1),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function uve(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",14),bb("click",function(){var e=Jy(n).$implicit;return Pb().onClick(e.x,e.y)}),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb();Rw(1),Ib("id","click_",r.x,"_",r.y,""),ob("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var cve=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e,!1,Gde.from)).rules=Wde.get(),r.availableMinimaxes=[new Gie(r.rules,"DummyBot"),new jie(r.rules,"Piece > Influence"),new Zie(r.rules,"Piece > Control"),new Yie(r.rules,"Escape > Piece > Control")],r.encoder=Gde.encoder,r.tutorial=(new Jde).tutorial,r.updateBoard(),r}return cp(n)}(Hie);return e.\u0275fac=function(t){return new(t||e)(fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["app-tablut"]],features:[jC],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",3,"click",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base",3,"click"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base",3,"click"],[1,"base",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"click"],["soldierDefender",""],[1,"base","no-fill",3,"click"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,sve,2,1,"g",1),lb(2,uve,2,6,"g",1),gb()),2&e&&(ob("viewBox",t.getViewBox()),Rw(1),db("ngForOf",t.board),Rw(1),db("ngForOf",t.getClickables()))},directives:[FT,DT,UT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),lve=cp(function e(){sp(this,e)});lve.PLACEMENT_AFTER_INITIAL_PHASE=function(){return $localize(Tc||(Tc=Vv(["You cannot put a new ring after the tenth turn."])))},lve.NO_MARKERS_IN_INITIAL_PHASE=function(){return $localize(Ic||(Ic=Vv(["You cannot put a marker in a ring before placing all of your rings."])))},lve.MISSING_CAPTURES=Jse.MISSING_CAPTURES,lve.MOVE_DIRECTION_INVALID=function(){return $localize(xc||(xc=Vv(["The direction of your move is invalid: a move is made along a straight line."])))},lve.CAN_ONLY_CAPTURE_YOUR_MARKERS=function(){return $localize(Ac||(Ac=Vv(["You can only capture your own markers."])))},lve.SHOULD_SELECT_PLAYER_RING=function(){return $localize(Rc||(Rc=Vv(["You must pick one of your own rings to move."])))},lve.SHOULD_END_MOVE_ON_EMPTY_SPACE=function(){return $localize(Nc||(Nc=Vv(["Your ring must land on an empty space."])))},lve.MOVE_SHOULD_NOT_PASS_ABOVE_RING=function(){return $localize(Mc||(Mc=Vv(["A ring can only jump over markers or empty spaces, not over another ring."])))},lve.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=function(){return $localize(Dc||(Dc=Vv(["Your ring must land on the first empty space after a group of markers."])))},lve.AMBIGUOUS_CAPTURE_COORD=Jse.AMBIGUOUS_CAPTURE_COORD,lve.CAPTURE_SHOULD_TAKE_RING=function(){return $localize(Lc||(Lc=Vv(["When you capture markers, you must take one of your ring as well by clicking on it."])))};var hve=function(){function e(t,n){sp(this,e),this.player=t,this.isRing=n}return cp(e,[{key:"equals",value:function(e){return this===e}},{key:"flip",value:function(){return a6(!1===this.isRing,"cannot flip a ring (it should never happen)"),a6(this.player.isPlayer(),"cannot flip a non-player piece"),e.of(this.player.getOpponent(),this.isRing)}},{key:"toString",value:function(){switch(this){case e.NONE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return oB.expectToBe(this,e.RING_ONE),"RING_ONE"}}}],[{key:"of",value:function(t,n){return t===ate.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}}]),e}();hve.encoder=rte.tuple([ote.numberEncoder,rte.booleanEncoder],function(e){return[e.player,e.isRing]},function(e){return hve.of(e[0],e[1])}),hve.NONE=new hve(ate.NONE,!1),hve.EMPTY=new hve(ate.NONE,!1),hve.MARKER_ZERO=new hve(ote.ZERO,!1),hve.MARKER_ONE=new hve(ote.ONE,!1),hve.MARKERS=[hve.MARKER_ZERO,hve.MARKER_ONE],hve.RING_ZERO=new hve(ote.ZERO,!0),hve.RING_ONE=new hve(ote.ONE,!0),hve.RINGS=[hve.RING_ZERO,hve.RING_ONE];var fve=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i){var a;return sp(this,n),(a=t.call(this,i,e,n.SIZE,n.SIZE,[6,4,3,2,1],hve.EMPTY)).sideRings=r,a}return cp(n,[{key:"isInitialPlacementPhase",value:function(){return this.turn<10}},{key:"countScores",value:function(){return this.turn<10?[0,0]:this.sideRings}},{key:"equals",value:function(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&lte.compareTable(this.board,e.board)}},{key:"getRingCoords",value:function(e){var t=[];return this.forEachCoord(function(n,r){r.isRing&&r.player===e&&t.push(n)}),t}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==hve.NONE}},{key:"setAtUnsafe",value:function(e,t){var r=lte.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.sideRings,this.turn)}}],[{key:"getInitialState",value:function(){var e=hve.EMPTY,t=hve.NONE;return new n([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}}]),n}(Aoe);return e.SIZE=11,e}(),dve=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;if(sp(this,n),i=t.call(this,e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");return i.ringTaken=hB.ofNullable(r),Qv(i)}return cp(n,[{key:"setRingTaken",value:function(e){return new n(this.capturedSpaces,e)}},{key:"equals",value:function(e){return!(!1===jv(tp(n.prototype),"equals",this).call(this,e)||!1===this.ringTaken.equals(e.ringTaken))}}],[{key:"of",value:function(e,t,r){for(var i=[],a=vre.factory.fromMove(e,t).get(),o=e;!1===o.equals(t);o=o.getNext(a))i.push(o);return i.push(t),new n(i,r)}}]),n}(jse);dve.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"encode",value:function(e){return{captured:e.capturedSpaces.map(function(e){return lre.encoder.encode(e)}),ringTaken:lre.encoder.encode(e.ringTaken.get())}}},{key:"decode",value:function(e){var t=e;return a6(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new dve(t.captured.map(function(e){return lre.encoder.decode(e)}),lre.encoder.decode(t.ringTaken))}}]),n}(tte));var vve=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a){var o;return sp(this,n),(o=t.call(this)).initialCaptures=e,o.start=r,o.end=i,o.finalCaptures=a,o}return cp(n,[{key:"isInitialPlacement",value:function(){return this.end.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===lte.compareArray(this.initialCaptures,e.initialCaptures)||!1===lte.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"toString",value:function(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=ip(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}}]),n}(Ore);vve.coordOptionalEncoder=Wse(lre.encoder),vve.encoder=new(function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"encodeMove",value:function(e){var t={moveStart:lre.encoder.encode(e.start),moveEnd:vve.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=dve.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=dve.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return a6(null!=t.moveStart,"Invalid encoded YinshMove"),new vve(this.decodeArray(t,"initialCapture",dve.encoder.decode),lre.encoder.decode(t.moveStart),vve.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",dve.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(nte));var pve=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return t.isEndGame?wre.fromWinner(t.winner):new wre(e.gameState.sideRings[0]*ote.ZERO.getScoreModifier()+e.gameState.sideRings[1]*ote.ONE.getScoreModifier())}},{key:"getListMoves",value:function(e){var t=this,n=[],r=e.gameState;if(r.isInitialPlacementPhase()){var i,a=ip(r.getCoordsAndContents());try{for(a.s();!(i=a.n()).done;){var o=Hv(i.value,2),s=o[0];o[1]===hve.EMPTY&&n.push(new vve([],s,hB.empty(),[]))}}catch(c){a.e(c)}finally{a.f()}}else{var u=this.ruler;this.getPossibleCaptureCombinations(r).forEach(function(e){var i=u.applyCaptures(r,e);t.getRingMoves(i).forEach(function(r){var a=u.applyRingMoveAndFlip(i,r.start,r.end);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new vve(e,r.start,hB.of(r.end),t);n.push(i)})})})}return n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return Xse.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(function(e){return function(){function e(){sp(this,e)}return cp(e,null,[{key:"getCombinations",value:function(e,t){var n=this;return a6(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(function(e){return n.getPermutations(e)}).reduce(function(e,t){return e.concat(t)})}},{key:"getPermutations",value:function(e){for(var t=e.length,n=[e.slice()],r=new Array(t).fill(0),i=1;i<t;)if(r[i]<i){var a=i%2&&r[i],o=e[i];e[i]=e[a],e[a]=o,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}},{key:"getSubsetsOfSize",value:function(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];for(var i=[];r<=e.length-n;){var a,o=e[r],s=ip(t(n-1,r+1));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.push(o),i.push(u)}}catch(c){s.e(c)}finally{s.f()}++r}return i}(t,0)}}]),e}().getCombinations(n,e.length).map(function(t){return e.map(function(e,n){return new dve(e.capturedSpaces,t[n])})})}).reduce(function(e,t){return e.concat(t)},[])}},{key:"getRingMoves",value:function(e){var t,n=this.ruler,r=[],i=ip(this.getRingCoords(e));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=ip(n.getRingTargets(e,o));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.push({start:o,end:u})}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getRingCoords",value:function(e){var t=e.getCurrentPlayer().value,n=[];return e.forEachCoord(function(e,r){r===hve.RINGS[t]&&n.push(e)}),n}}]),n}(_re),gve=function(e){Yv(n,e);var t=Jv(n);function n(){return sp(this,n),t.apply(this,arguments)}return cp(n,[{key:"applyLegalMove",value:function(e,t,n){return new fve(n.board,n.sideRings,n.turn+1)}},{key:"applyCaptures",value:function(e,t){var n=this,r=e;return t.forEach(function(e){r=n.applyCapture(r,e)}),r}},{key:"applyCapture",value:function(e,t){var n=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new fve(n,e.sideRings,e.turn),t.ringTaken.get())}},{key:"takeRing",value:function(e,t){var n=e.getCurrentPlayer().value,r=e.setAt(t,hve.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new fve(r,i,e.turn)}},{key:"applyCaptureWithoutTakingRing",value:function(e,t){return t.forEach(function(t){e=e.setAt(t,hve.EMPTY)}),e.board}},{key:"ringSelectionValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)===hve.RINGS[n]?e6.SUCCESS:e6.failure(lve.CAPTURE_SHOULD_TAKE_RING())}},{key:"applyRingMoveAndFlip",value:function(e,t,n){var r=e.getCurrentPlayer().value,i=e.setAt(t,hve.MARKERS[r]);i=i.setAt(n,hve.RINGS[r]);for(var a=vre.factory.fromMove(t,n).get(),o=t.getNext(a);!1===o.equals(n);o=o.getNext(a)){var s=i.getPieceAt(o);s!==hve.EMPTY&&(i=i.setAt(o,s.flip()))}return i}},{key:"isLegal",value:function(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return J5.failure(lve.NO_MARKERS_IN_INITIAL_PHASE());var n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();var r=this.applyCaptures(t,e.initialCaptures),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();var a=this.applyRingMoveAndFlip(r,e.start,e.end.get()),o=this.capturesValidity(a,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();var s=this.applyCaptures(a,e.finalCaptures),u=this.noMoreCapturesValidity(s);return u.isFailure()?u.toFailedFallible():J5.success(s)}},{key:"initialPlacementValidity",value:function(e,t){if(!0!==e.isInitialPlacementPhase())return J5.failure(lve.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==hve.EMPTY)return J5.failure(kre.MUST_CLICK_ON_EMPTY_SPACE());var n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;var i=e.setAt(t,hve.of(n,!0)).board,a=new fve(i,r,e.turn);return J5.success(a)}},{key:"moveStartValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==hve.RINGS[n]?e6.failure(lve.SHOULD_SELECT_PLAYER_RING()):e6.SUCCESS}},{key:"moveValidity",value:function(e,t,n){var r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==hve.EMPTY)return e6.failure(lve.SHOULD_END_MOVE_ON_EMPTY_SPACE());var i=vre.factory.fromMove(t,n);if(i.isFailure())return e6.failure(lve.MOVE_DIRECTION_INVALID());for(var a=i.get(),o=!1,s=t.getNext(a);!1===s.equals(n);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===hve.EMPTY){if(o)return e6.failure(lve.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(u.isRing)return e6.failure(lve.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return e6.SUCCESS}},{key:"capturesValidity",value:function(e,t){var n,r=e,i=ip(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.captureValidity(r,a);if(o.isFailure())return o;r=this.applyCapture(r,a)}}catch(s){i.e(s)}finally{i.f()}return e6.SUCCESS}},{key:"captureValidity",value:function(e,t){var n,r=e.getCurrentPlayer().value,i=ip(t.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(e.getPieceAt(a)!==hve.MARKERS[r])return e6.failure(lve.CAN_ONLY_CAPTURE_YOUR_MARKERS())}}catch(o){i.e(o)}finally{i.f()}return e.getPieceAt(t.ringTaken.get())!==hve.RINGS[r]?e6.failure(lve.CAPTURE_SHOULD_TAKE_RING()):e6.SUCCESS}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?e6.SUCCESS:e6.failure(lve.MISSING_CAPTURES())}},{key:"getLinePortionsWithAtLeastFivePiecesOfPlayer",value:function(e,t){var n=this,r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithAtLeastFivePiecesOfPlayer",value:function(e,t,n){var r,i=0,a=e.getEntranceOnLine(n),o=n.getDirection(),s=a;for(r=a;e.isOnBoard(r);r=r.getNext(o)){var u=e.getPieceAt(r);if(u.player===t&&!1===u.isRing)0===i&&(s=r),i+=1;else{if(i>=5)break;i=0}}return i>=5?hB.of({start:s,end:r,dir:o}):hB.empty()}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(function(e){for(var t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(dve.of(t,t.getNext(e.dir,4)))}),n}},{key:"getRingTargets",value:function(e,t){var n,r=[],i=ip(vre.factory.all);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,o=!1,s=t.getNext(a);e.isOnBoard(s);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===hve.EMPTY){if(r.push(s),o)break}else{if(u.isRing)break;o=!0}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){return e.gameState.isInitialPlacementPhase()?Dre.ONGOING:e.gameState.sideRings[0]>=3?Dre.ZERO_WON:e.gameState.sideRings[1]>=3?Dre.ONE_WON:Dre.ONGOING}}]),n}(Lre),yve=hve.EMPTY,mve=hve.NONE,kve=hve.MARKER_ZERO,_ve=hve.RING_ZERO,wve=hve.MARKER_ONE,Cve=hve.RING_ONE,bve=function(){var e=cp(function e(){sp(this,e)});return e.MUST_ALIGN_FIVE=function(){return $localize(Fc||(Fc=Vv(["Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time."])))},e.MUST_CAPTURE_TWO=function(){return $localize(Bc||(Bc=Vv(["Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again."])))},e}(),Eve=cp(function e(){sp(this,e),this.tutorial=[Vre.informational($localize(Uc||(Uc=Vv(["Goal of the game"]))),$localize(Vc||(Vc=Vv(["The goal at Yinsh is to capture three rings in total.\n        The rings taken are shown on the top left for the dark player,\n        and on the bottom right for the light player. Here, Dark won the game.\n        Note that on the board you have two types of pieces for each player:\n        rings (empty circles) and markers (full circles)."]))),new fve([[mve,mve,mve,mve,mve,mve,yve,yve,yve,yve,mve],[mve,mve,mve,mve,yve,yve,yve,yve,yve,yve,yve],[mve,mve,mve,kve,Cve,yve,yve,yve,yve,yve,yve],[mve,mve,yve,kve,yve,Cve,yve,wve,yve,yve,yve],[mve,yve,_ve,wve,yve,yve,Cve,kve,yve,yve,yve],[mve,yve,yve,kve,wve,yve,yve,yve,yve,yve,mve],[yve,yve,yve,kve,yve,yve,yve,Cve,yve,yve,mve],[yve,yve,yve,wve,kve,_ve,yve,yve,yve,mve,mve],[yve,yve,yve,yve,yve,yve,yve,yve,mve,mve,mve],[yve,yve,yve,yve,yve,yve,yve,mve,mve,mve,mve],[mve,yve,yve,yve,yve,mve,mve,mve,mve,mve,mve]],[3,1],20)),Vre.anyMove($localize(zc||(zc=Vv(["Initial board and placement phase"]))),$localize(Hc||(Hc=Vv(["The initial board is empty.\n        At the beginning of the game, each player puts one of its ring on the board at their turn.\n        This phase stops when all rings have been placed on the board.\n        Put one of your ring on the board by clicking the space where you want to place it."]))),new fve(fve.getInitialState().board,[5,5],0),new vve([],new lre(5,5),hB.empty(),[]),$localize(Gc||(Gc=Vv(["Congratulations!"])))),Vre.anyMove($localize(qc||(qc=Vv(["Putting a marker"]))),$localize($c||($c=Vv(["Once the initial phase is done and all rings are on the board, you need to place markers on the board.\n        To do so, put a marker in a ring by clicking on that ring.\n        Then, the ring must be moved in a straight line, in any direction.\n        A ring cannot pass through other rings during its move.\n        If it goes over a group of markers, your move must stop at the first empty space after that group.\n        All markers in the group are then flipped and their color change.<br/><br/>\n        You're playing Dark, do a move."]))),new fve([[mve,mve,mve,mve,mve,mve,yve,yve,yve,yve,mve],[mve,mve,mve,mve,yve,yve,yve,yve,yve,yve,yve],[mve,mve,mve,Cve,yve,yve,yve,yve,yve,yve,yve],[mve,mve,Cve,yve,yve,Cve,yve,yve,yve,yve,yve],[mve,yve,_ve,wve,yve,yve,Cve,yve,yve,yve,yve],[mve,yve,yve,wve,yve,yve,yve,yve,yve,yve,mve],[yve,yve,yve,yve,_ve,yve,yve,Cve,yve,yve,mve],[yve,yve,yve,yve,yve,_ve,yve,yve,yve,mve,mve],[yve,yve,yve,_ve,yve,yve,yve,mve,mve,mve,mve],[yve,yve,yve,yve,yve,yve,yve,mve,mve,mve,mve],[mve,yve,yve,yve,yve,mve,mve,mve,mve,mve,mve]],[0,0],20),new vve([],new lre(2,4),hB.of(new lre(4,4)),[]),$localize(Wc||(Wc=Vv(["Congratulations!"])))),Vre.fromPredicate($localize(jc||(jc=Vv(["Getting a ring by aligning 5 markers"]))),$localize(Zc||(Zc=Vv(["Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.\n        To do so, you need to align 5 markers of your color.\n        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.\n        You will then have one more point.\n        You must capture when you can.<br/><br/>\n        You're playing Dark, perform a capture!"]))),new fve([[mve,mve,mve,mve,mve,mve,yve,yve,yve,yve,mve],[mve,mve,mve,mve,yve,yve,yve,yve,yve,yve,yve],[mve,mve,mve,Cve,yve,yve,yve,yve,yve,yve,yve],[mve,mve,Cve,yve,yve,Cve,yve,yve,yve,yve,yve],[mve,yve,kve,kve,_ve,wve,wve,yve,yve,yve,yve],[mve,yve,yve,Cve,yve,yve,yve,yve,yve,yve,mve],[yve,yve,yve,yve,_ve,yve,yve,Cve,yve,yve,mve],[yve,yve,yve,yve,yve,_ve,yve,yve,yve,mve,mve],[yve,yve,yve,_ve,yve,yve,yve,_ve,mve,mve,mve],[yve,yve,yve,yve,yve,yve,yve,mve,mve,mve,mve],[mve,yve,yve,yve,yve,mve,mve,mve,mve,mve,mve]],[0,0],20),new vve([],new lre(4,4),hB.of(new lre(7,4)),[dve.of(new lre(2,4),new lre(6,4),new lre(7,4))]),function(e,t){return 1===t.sideRings[ote.ZERO.value]?e6.SUCCESS:e6.failure(bve.MUST_ALIGN_FIVE())},$localize(Yc||(Yc=Vv(["Congratulations!"])))),Vre.fromPredicate($localize(Kc||(Kc=Vv(["Compound captures"]))),$localize(Jc||(Jc=Vv(["During a turn, you could have to choose between multiple captures,\n        or you could even capture multiple times!\n        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>\n        Here, you can capture two rings, do it!"]))),new fve([[mve,mve,mve,mve,mve,mve,yve,yve,yve,yve,mve],[mve,mve,mve,mve,_ve,yve,yve,Cve,Cve,_ve,yve],[mve,mve,mve,_ve,yve,yve,wve,Cve,yve,_ve,yve],[mve,mve,yve,_ve,yve,yve,yve,yve,yve,Cve,yve],[mve,yve,yve,yve,yve,kve,yve,yve,Cve,yve,yve],[mve,yve,yve,yve,kve,kve,yve,wve,yve,yve,mve],[yve,yve,yve,kve,yve,kve,yve,yve,yve,yve,mve],[yve,yve,kve,yve,yve,kve,yve,yve,yve,mve,mve],[yve,kve,yve,yve,yve,kve,yve,yve,mve,mve,mve],[yve,yve,yve,yve,yve,kve,yve,mve,mve,mve,mve],[mve,yve,yve,yve,yve,mve,mve,mve,mve,mve,mve]],[0,0],10),new vve([dve.of(new lre(5,4),new lre(1,8),new lre(3,2)),dve.of(new lre(5,9),new lre(5,5),new lre(3,3))],new lre(4,1),hB.of(new lre(4,2)),[]),function(e,t){return 2===t.sideRings[ote.ZERO.value]?e6.SUCCESS:e6.failure(bve.MUST_CAPTURE_TWO())},$localize(Qc||(Qc=Vv(["Congratulations!"]))))]});function Sve(e,t){if(1&e&&(Pm(),yb(0,"circle",9)),2&e){var n=Pb(2).$implicit,r=Pb(2);ob("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringOuterSize)}}function Pve(e,t){if(1&e&&(Pm(),yb(0,"circle",10)),2&e){var n=Pb(2),r=n.index,i=n.$implicit,a=Pb().index,o=Pb();Ib("id","ring_",r,"_",a,""),db("ngClass",i.ringClasses),ob("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function Ove(e,t){if(1&e&&(Pm(),yb(0,"circle",9)),2&e){var n=Pb(2).$implicit,r=Pb(2);ob("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringInnerSize)}}function Tve(e,t){if(1&e&&(Pm(),yb(0,"circle",11)),2&e){var n=Pb(2),r=n.index,i=n.$implicit,a=Pb().index,o=Pb();Ib("id","marker_",r,"_",a,""),db("ngClass",i.markerClasses),ob("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function Ive(e,t){if(1&e){var n=_b();Pm(),pb(0,"g",3),bb("click",function(){Jy(n);var e=Pb().$implicit;return Pb(2).onClick(e.coord)}),yb(1,"polyline",4),pb(2,"g",5),lb(3,Sve,1,3,"circle",6),lb(4,Pve,1,6,"circle",7),lb(5,Ove,1,3,"circle",6),lb(6,Tve,1,6,"circle",8),gb(),gb()}if(2&e){var r=Pb(),i=r.index,a=r.$implicit,o=Pb().index;Ib("id","click_",i,"_",o,""),Rw(1),Ib("id","space_",i,"_",o,""),db("ngClass",a.spaceClasses),ob("points",a.coordinates),Rw(1),Ib("id","pieceGroup_",i,"_",o,""),db("ngClass",a.removedClass),Rw(1),db("ngIf",a.isRing),Rw(1),db("ngIf",a.isRing),Rw(1),db("ngIf",a.isRing),Rw(1),db("ngIf",a.isMarker)}}function xve(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Ive,7,13,"g",2),gb()),2&e){var n=t.$implicit;Rw(1),db("ngIf",null!=n)}}function Ave(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,xve,2,1,"g",1),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}function Rve(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"polyline",12),bb("click",function(){var e=Jy(n).$implicit;return Pb().onClick(e)}),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb();Rw(1),Ib("id","selected_",r.x,"_",r.y,""),ob("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Nve(e,t){if(1&e){var n=_b();Pm(),pb(0,"polyline",14),bb("click",function(){Jy(n);var e=Pb().$implicit;return Pb().onClick(e)}),gb()}if(2&e){var r=Pb().$implicit,i=Pb();Ib("id","selectable_",r.x,"_",r.y,""),ob("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Mve(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Nve,1,3,"polyline",13),gb()),2&e){var n=Pb();Rw(1),db("ngIf",n.isPlayerTurn())}}function Dve(e,t){if(1&e){var n=_b();Pm(),pb(0,"g"),pb(1,"rect",15),bb("click",function(){var e=Jy(n).$implicit;return Pb().onClick(e)}),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb();Rw(1),ob("x",i.viewInfo.spaceInfo[r.y][r.x].center.x-i.viewInfo.indicatorSize/2)("y",i.viewInfo.spaceInfo[r.y][r.x].center.y-i.viewInfo.indicatorSize/2)("width",i.viewInfo.indicatorSize)("height",i.viewInfo.indicatorSize)}}function Lve(e,t){if(1&e&&(Pm(),pb(0,"g"),yb(1,"circle",16),yb(2,"circle",9),yb(3,"circle",17),gb()),2&e){var n=t.index,r=Pb().$implicit,i=Pb();Rw(1),Ib("id","player_",r,"_sideRing_",n+1,""),ob("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringOuterSize),Rw(1),ob("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringInnerSize),Rw(1),db("ngClass",i.viewInfo.sideRingClass[r]),ob("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringMidSize)}}var Fve=function(){return[]};function Bve(e,t){if(1&e&&(Pm(),pb(0,"g"),lb(1,Lve,4,12,"g",1),gb()),2&e){var n=t.$implicit,r=Pb();Rw(1),db("ngForOf",oP(1,Fve).constructor(r.viewInfo.sideRings[n]))}}var Uve=function(){return[0,1]},Vve=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,e)).movePhase="MOVE_START",r.moveStart=hB.empty(),r.moveEnd=hB.empty(),r.currentlyMoved=[],r.currentCapture=hB.empty(),r.initialCaptures=[],r.finalCaptures=[],r.possibleCaptures=[],r.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:n.MARKER_SIZE,ringOuterSize:n.RING_OUTER_SIZE,ringMidSize:n.RING_MID_SIZE,ringInnerSize:n.RING_INNER_SIZE,indicatorSize:n.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},r.scores=hB.of([0,0]),r.rules=new gve(fve),r.availableMinimaxes=[new pve(r.rules,"YinshMinimax")],r.encoder=vve.encoder,r.tutorial=(new Eve).tutorial,r.hexaLayout=new pre(1.5*n.RING_OUTER_SIZE,new lre(2*n.RING_OUTER_SIZE,0),mre.INSTANCE),r.constructedState=r.rules.node.gameState,r.constructedState.allCoords().forEach(function(e){null==r.viewInfo.spaceInfo[e.y]&&(r.viewInfo.spaceInfo[e.y]=[]),r.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:r.getHexaCoordsAt(e),center:r.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}}),r}return cp(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.scores=hB.of(this.rules.node.gameState.countScores())}},{key:"updateViewInfo",value:function(){var e=this;this.constructedState.allCoords().forEach(function(t){e.viewInfo.spaceInfo[t.y][t.x].spaceClasses=e.getSpaceClasses(t);var n=e.constructedState.getPieceAt(t);e.viewInfo.spaceInfo[t.y][t.x].removedClass="",e.setRingInfo(t,n),e.setMarkerInfo(t,n)});for(var t=0,n=[ote.ZERO,ote.ONE];t<n.length;t++){var r=n[t];this.viewInfo.sideRings[r.value]=this.constructedState.sideRings[r.value]}switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];var i,a=ip(this.possibleCaptures);try{for(a.s();!(i=a.n()).done;){var o,s=ip(i.value.capturedSpaces);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.viewInfo.selectableCoords.push(u)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){a.e(c)}finally{a.f()}break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.rules.node.gameState.isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}},{key:"showCurrentMoveCaptures",value:function(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());var e,t=ip(this.initialCaptures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.markCurrentCapture(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=ip(this.finalCaptures);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.markCurrentCapture(a)}}catch(o){i.e(o)}finally{i.f()}}},{key:"getSpaceClasses",value:function(e){return this.currentlyMoved.some(function(t){return t.equals(e)})?["moved"]:[]}},{key:"setRingInfo",value:function(e,t){if(t.isRing){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[n+"-stroke"]}else this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[]}},{key:"setMarkerInfo",value:function(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==hve.EMPTY&&(!t.isRing||t.isRing&&this.moveStart.equalsValue(e))){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.rules.node.gameState,this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=hB.empty(),this.moveStart=hB.empty(),this.moveEnd=hB.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}},{key:"showLastMove",value:function(){var e=this,t=this.rules.node.move;if(t.isPresent()){var n=t.get();if(n.isInitialPlacement())this.viewInfo.spaceInfo[n.start.y][n.start.x].spaceClasses=["moved"];else{var r,i=ip(this.coordsBetween(n.start,n.end.get()));try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.spaceInfo[a.y][a.x].spaceClasses=["moved"]}}catch(s){i.e(s)}finally{i.f()}var o=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();n.initialCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)}),n.finalCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)})}}}},{key:"coordsBetween",value:function(e,t){for(var n=[],r=vre.factory.fromMove(e,t).get(),i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==hve.EMPTY&&n.push(i),n.push(t);return n}},{key:"showLastMoveCapture",value:function(e,t){var n,r=ip(e.capturedSpaces);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["captured"],t&&this.markRemovedMarker(i,this.rules.node.gameState.getCurrentPlayer().getOpponent())}}catch(a){r.e(a)}finally{r.f()}this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured"],t&&this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer().getOpponent())}},{key:"moveToInitialCaptureOrMovePhase",value:function(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),e6.SUCCESS}},{key:"onClick",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:n.t0=t.movePhase,n.next="INITIAL_CAPTURE_SELECT_FIRST"===n.t0||"FINAL_CAPTURE_SELECT_FIRST"===n.t0?6:"INITIAL_CAPTURE_SELECT_LAST"===n.t0||"FINAL_CAPTURE_SELECT_LAST"===n.t0?7:"INITIAL_CAPTURE_SELECT_RING"===n.t0||"FINAL_CAPTURE_SELECT_RING"===n.t0?8:"MOVE_START"===n.t0?9:"MOVE_END"===n.t0?10:11;break;case 6:return n.abrupt("return",t.selectCaptureFirstCoord(e));case 7:return n.abrupt("return",t.selectCaptureLastCoord(e));case 8:return n.abrupt("return",t.selectRing(e));case 9:return n.abrupt("return",t.selectMoveStart(e));case 10:return n.abrupt("return",t.selectMoveEnd(e));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectCaptureFirstCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),!(r.length>1)){n.next=5;break}t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r),n.next=8;break;case 5:if(0!==r.length){n.next=7;break}return n.abrupt("return",t.cancelMove(lve.MISSING_CAPTURES()));case 7:t.selectCapture(r[0]);case 8:return n.abrupt("return",e6.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveToCaptureSelectLast",value:function(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;var t,n=ip(e);try{for(n.s();!(t=n.n()).done;){var r,i=ip(t.value.capturedSpaces);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.selectableCoords.push(a)}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}switch(this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":this.movePhase="INITIAL_CAPTURE_SELECT_LAST";break;case"FINAL_CAPTURE_SELECT_FIRST":this.movePhase="FINAL_CAPTURE_SELECT_LAST"}}},{key:"selectCaptureLastCoord",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.abrupt("return",(t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),r.length>1?t.cancelMove(lve.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(lve.MISSING_CAPTURES()):t.selectCapture(r[0])));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectCapture",value:function(e){switch(this.currentCapture=hB.of(e),this.constructedState=new fve(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":this.movePhase="INITIAL_CAPTURE_SELECT_RING";break;case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.movePhase="FINAL_CAPTURE_SELECT_RING"}return this.updateViewInfo(),e6.SUCCESS}},{key:"markCurrentCapture",value:function(e){var t,n=ip(e.capturedSpaces);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.selectedCoords.push(r),this.markRemovedMarker(r,this.rules.node.gameState.getCurrentPlayer())}}catch(i){n.e(i)}finally{n.f()}e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer()))}},{key:"markRemovedMarker",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="transparent",this.setMarkerInfo(e,hve.MARKERS[t.value])}},{key:"markRemovedRing",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="transparent",this.setRingInfo(e,hve.RINGS[t.value])}},{key:"selectRing",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.rules.ringSelectionValidity(t.constructedState,e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:t.constructedState=t.rules.takeRing(t.constructedState,e),i=t.currentCapture.get().setRingTaken(e),n.t0=(t.currentCapture=hB.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase),n.next="INITIAL_CAPTURE_SELECT_RING"===n.t0?8:9;break;case 8:return n.abrupt("return",(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),e6.SUCCESS)));case 9:return n.abrupt("return",(oB.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),e6.SUCCESS)));case 10:case"end":return n.stop()}},n)}))()}},{key:"moveToMovePhase",value:function(){return this.movePhase="MOVE_START",this.updateViewInfo(),e6.SUCCESS}},{key:"tryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new vve(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures),t.next=3,e.chooseMove(n,e.rules.node.gameState,e.scores.get());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"selectMoveStart",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.constructedState.isInitialPlacementPhase()){n.next=3;break}return r=t.rules.initialPlacementValidity(t.constructedState,e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=hB.of(e),t.tryMove()));case 3:if(!(i=t.rules.moveStartValidity(t.constructedState,e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(i.getReason()));case 6:return t.moveStart=hB.of(e),t.movePhase="MOVE_END",t.updateViewInfo(),n.abrupt("return",e6.SUCCESS);case 8:case"end":return n.stop()}},n)}))()}},{key:"selectMoveEnd",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveEnd=hB.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.constructedState,t.moveStart.get(),e),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove()));case 2:case"end":return n.stop()}},n)}))()}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),e6.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(fre);function zve(e,t){if(1&e&&(pb(0,"option",5),Bb(1),gb()),2&e){var n=t.$implicit;db("value",n),Rw(1),Ub(n)}}Vve.RING_OUTER_SIZE=40,Vve.RING_MID_SIZE=34,Vve.RING_INNER_SIZE=28,Vve.MARKER_SIZE=Vve.RING_INNER_SIZE,Vve.INDICATOR_SIZE=10,Vve.\u0275fac=function(e){return new(e||Vve)(fb(r6))},Vve.\u0275cmp=oy({type:Vve,selectors:[["app-yinsh"]],features:[jC],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected",3,"id","click"],["pointer-events","fill","class","base no-fill capturable","stroke-linecap","round",3,"id","click",4,"ngIf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable",3,"id","click"],[1,"indicator",3,"click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(Pm(),pb(0,"svg",0),lb(1,Ave,2,1,"g",1),lb(2,Rve,2,3,"g",1),lb(3,Mve,2,1,"g",1),lb(4,Dve,2,4,"g",1),lb(5,Bve,2,2,"g",1),gb()),2&e&&(Rw(1),db("ngForOf",t.viewInfo.spaceInfo),Rw(1),db("ngForOf",t.viewInfo.selectedCoords),Rw(1),db("ngForOf",t.viewInfo.selectableCoords),Rw(1),db("ngForOf",t.viewInfo.targets),Rw(1),db("ngForOf",oP(5,Uve)))},directives:[FT,UT,DT],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Hve=function(){var e=cp(function e(){sp(this,e)});return e.ABALONE=function(){return $localize(Xc||(Xc=Vv(["Use simple mechanics to push 6 of the opponent's pieces out of the board!"])))},e.APAGOS=function(){return $localize(el||(el=Vv(["Very simple game, but, will you be able to win everytime?"])))},e.AWALE=function(){return $localize(tl||(tl=Vv(["The international version of the famous African strategy game!"])))},e.BRANDHUB=function(){return $localize(nl||(nl=Vv(["The Irish version of the Tafl game family!"])))},e.COERCEO=function(){return $localize(rl||(rl=Vv(["Get rid of all of your opponent's pieces on a board that shrinks little by little!"])))},e.CONSPIRATEURS=function(){return $localize(il||(il=Vv(["Hide all of your pieces before your opponent does, or risk to be discovered!"])))},e.DIAM=function(){return $localize(al||(al=Vv(["Drop your pieces and move them around to align two pieces of the same color across the board to win!"])))},e.DVONN=function(){return $localize(ol||(ol=Vv(["Stack your pieces and control as many stacks as you can to win!"])))},e.ENCAPSULE=function(){return $localize(sl||(sl=Vv(["An enhanced tic-tac-toe where piece can encapsule other and prevent them to win."])))},e.EPAMINONDAS=function(){return $localize(ul||(ul=Vv(["An antiquity-war inspired game. Be the first to pierce your opponent's lines!"])))},e.GIPF=function(){return $localize(cl||(cl=Vv(["A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!"])))},e.GO=function(){return $localize(ll||(ll=Vv(["The oldest strategy game still practiced widely. A territory control game."])))},e.KAMISADO=function(){return $localize(hl||(hl=Vv(["Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!"])))},e.LINES_OF_ACTION=function(){return $localize(fl||(fl=Vv(["Regroup your pieces to win. But your possible moves will often change!"])))},e.P4=function(){return $localize(dl||(dl=Vv(["The classical 4 in a row game!"])))},e.PENTAGO=function(){return $localize(vl||(vl=Vv(["Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!"])))},e.PYLOS=function(){return $localize(pl||(pl=Vv(["Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!"])))},e.QUARTO=function(){return $localize(gl||(gl=Vv(["Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!"])))},e.QUIXO=function(){return $localize(yl||(yl=Vv(["Align 5 of your pieces on a board where pieces slide!"])))},e.REVERSI=function(){return $localize(ml||(ml=Vv(["Sandwich your opponent's pieces to dominate the board!"])))},e.SAHARA=function(){return $localize(kl||(kl=Vv(["Immobilize one of your opponent's pyramids before your opponent does!"])))},e.SIAM=function(){return $localize(_l||(_l=Vv(["Be the first to push a mountain out of the board!"])))},e.SIX=function(){return $localize(wl||(wl=Vv(["Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!"])))},e.TABLUT=function(){return $localize(Cl||(Cl=Vv(["The Viking board game! Invaders must capture the king, defender must make him escape!"])))},e.YINSH=function(){return $localize(bl||(bl=Vv(["Align your pieces to score points, but beware, pieces can flip!"])))},e}(),Gve=function(){var e=cp(function e(t,n,r,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];sp(this,e),this.name=t,this.urlName=n,this.component=r,this.creationDate=i,this.description=a,this.display=o});return e.ALL_GAMES=function(){return[new e("MinimaxTesting","MinimaxTesting",jce,new Date("1970-01-01"),"",!1),new e($localize(El||(El=Vv(["Four in a Row"]))),"P4",ule,new Date("2018-08-28"),Hve.P4()),new e($localize(Sl||(Sl=Vv(["Awal\xe9"]))),"Awale",xie,new Date("2018-11-29"),Hve.AWALE()),new e($localize(Pl||(Pl=Vv(["Quarto"]))),"Quarto",Hhe,new Date("2018-12-09"),Hve.QUARTO()),new e($localize(Ol||(Ol=Vv(["Tablut"]))),"Tablut",cve,new Date("2018-12-27"),Hve.TABLUT()),new e($localize(Tl||(Tl=Vv(["Reversi"]))),"Reversi",yfe,new Date("2019-01-16"),Hve.REVERSI()),new e($localize(Il||(Il=Vv(["Go"]))),"Go",Gue,new Date("2019-12-21"),Hve.GO()),new e($localize(xl||(xl=Vv(["Encapsule"]))),"Encapsule",Ise,new Date("2019-12-30"),Hve.ENCAPSULE()),new e($localize(Al||(Al=Vv(["Siam"]))),"Siam",kde,new Date("2020-01-11"),Hve.SIAM()),new e($localize(Rl||(Rl=Vv(["Sahara"]))),"Sahara",Lfe,new Date("2020-02-29"),Hve.SAHARA()),new e($localize(Nl||(Nl=Vv(["Pylos"]))),"Pylos",Jle,new Date("2020-10-02"),Hve.PYLOS()),new e($localize(Ml||(Ml=Vv(["Kamisado"]))),"Kamisado",Cce,new Date("2020-10-03"),Hve.KAMISADO()),new e($localize(Dl||(Dl=Vv(["Quixo"]))),"Quixo",rfe,new Date("2020-10-15"),Hve.QUIXO()),new e($localize(Ll||(Ll=Vv(["Dvonn"]))),"Dvonn",ase,new Date("2020-10-21"),Hve.DVONN()),new e($localize(Fl||(Fl=Vv(["Epaminondas"]))),"Epaminondas",$se,new Date("2021-01-16"),Hve.EPAMINONDAS()),new e($localize(Bl||(Bl=Vv(["Gipf"]))),"Gipf",pue,new Date("2021-02-22"),Hve.GIPF()),new e($localize(Ul||(Ul=Vv(["Coerceo"]))),"Coerceo",zae,new Date("2021-03-21"),Hve.COERCEO()),new e($localize(Vl||(Vl=Vv(["Six"]))),"Six",Hde,new Date("2021-04-08"),Hve.SIX()),new e($localize(zl||(zl=Vv(["Lines of Action"]))),"LinesOfAction",Lce,new Date("2021-04-28"),Hve.LINES_OF_ACTION()),new e($localize(Hl||(Hl=Vv(["Pentago"]))),"Pentago",Tle,new Date("2021-05-23"),Hve.PENTAGO()),new e($localize(Gl||(Gl=Vv(["Abalone"]))),"Abalone",aie,new Date("2021-07-13"),Hve.ABALONE()),new e($localize(ql||(ql=Vv(["Yinsh"]))),"Yinsh",Vve,new Date("2021-07-31"),Hve.YINSH()),new e($localize($l||($l=Vv(["Apagos"]))),"Apagos",_ie,new Date("2021-11-04"),Hve.APAGOS()),new e($localize(Wl||(Wl=Vv(["Diam"]))),"Diam",Ioe,new Date("2021-11-30"),Hve.DIAM()),new e($localize(jl||(jl=Vv(["Brandhub"]))),"Brandhub",fae,new Date("2021-12-07"),Hve.BRANDHUB()),new e($localize(Zl||(Zl=Vv(["Conspirateurs"]))),"Conspirateurs",uoe,new Date("2021-12-30"),Hve.CONSPIRATEURS())].sort(function(e,t){return e.name.localeCompare(t.name)})},e}(),qve=function(){var e=function(){function e(){sp(this,e),this.gameNameList=Gve.ALL_GAMES().filter(function(e){return!0===e.display}).map(function(e){return e.urlName}),this.pickGame=new yP}return cp(e,[{key:"onChange",value:function(e){this.pickGame.emit(e.target.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=oy({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){return[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],$localize(Yl||(Yl=Vv(["Pick a game"]))),[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(pb(0,"div",0),pb(1,"select",1),bb("change",function(e){return t.onChange(e)}),pb(2,"option",2),WE(3,3),gb(),lb(4,zve,2,2,"option",4),gb(),gb()),2&e&&(Rw(4),db("ngForOf",t.gameNameList))},directives:[oA,lA,FT],encapsulation:2}),e}();function $ve(e,t){if(1&e){var n=_b();pb(0,"div",26),pb(1,"div",27),bb("click",function(){return Jy(n),Pb().closeInfo()}),gb(),pb(2,"div",28),pb(3,"header",29),pb(4,"p",30),Bb(5),gb(),pb(6,"button",31),bb("click",function(){return Jy(n),Pb().closeInfo()}),gb(),gb(),pb(7,"section",32),pb(8,"div",6),pb(9,"div",33),pb(10,"p",34),yb(11,"img",35),gb(),gb(),pb(12,"div",7),pb(13,"div",13),Bb(14),gb(),gb(),gb(),pb(15,"div",6),pb(16,"div",33),pb(17,"a",36),bb("click",function(){Jy(n);var e=Pb();return e.createGame(e.gameInfoDetails.get().urlName)}),yb(18,"fa-icon",37),Bb(19,"\xa0"),pb(20,"span"),WE(21,38),gb(),gb(),gb(),pb(22,"div",33),pb(23,"a",36),bb("click",function(){Jy(n);var e=Pb();return e.createLocalGame(e.gameInfoDetails.get().urlName)}),yb(24,"fa-icon",37),Bb(25,"\xa0"),pb(26,"span"),WE(27,39),gb(),gb(),gb(),pb(28,"div",33),pb(29,"a",36),bb("click",function(){Jy(n);var e=Pb();return e.createTutorial(e.gameInfoDetails.get().urlName)}),yb(30,"fa-icon",37),Bb(31,"\xa0"),pb(32,"span"),WE(33,40),gb(),gb(),gb(),gb(),gb(),gb(),gb()}if(2&e){var r=Pb();Rw(5),Ub(r.gameInfoDetails.get().name),Rw(6),Ib("src","assets/images/",r.theme,"/",r.gameInfoDetails.get().urlName,".png",S_),Rw(3),Vb(" ",r.gameInfoDetails.get().description," "),Rw(4),db("icon",r.iconOnlineGame),Rw(6),db("icon",r.iconLocalGame),Rw(6),db("icon",r.iconTutorial)}}function Wve(e,t){if(1&e){var n=_b();pb(0,"div",8),pb(1,"div",9),pb(2,"p",10),Bb(3),gb(),gb(),pb(4,"div",42),pb(5,"figure",34),pb(6,"img",43),bb("click",function(){var e=Jy(n).$implicit;return Pb(2).openInfo(e)}),gb(),pb(7,"figcaption",44),bb("click",function(){var e=Jy(n).$implicit;return Pb(2).openInfo(e)}),pb(8,"div",45),Bb(9,"?"),gb(),gb(),pb(10,"figcaption",46),pb(11,"a",47),bb("click",function(){var e=Jy(n).$implicit;return Pb(2).createGame(e.urlName)}),yb(12,"fa-icon",37),gb(),pb(13,"a",48),bb("click",function(){var e=Jy(n).$implicit;return Pb(2).createLocalGame(e.urlName)}),yb(14,"fa-icon",37),gb(),pb(15,"a",49),bb("click",function(){var e=Jy(n).$implicit;return Pb(2).createTutorial(e.urlName)}),yb(16,"fa-icon",37),gb(),gb(),gb(),gb(),pb(17,"div",50),Bb(18),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb(2);Rw(3),Ub(r.name),Rw(3),Tb("id","image_",r.urlName,""),Ib("src","assets/images/",i.theme,"/",r.urlName,".png",S_),Rw(5),Tb("id","playOnline_",r.urlName,""),Rw(1),db("icon",i.iconOnlineGame),Rw(1),Tb("id","playLocally_",r.urlName,""),Rw(1),db("icon",i.iconLocalGame),Rw(1),Tb("id","startTutorial_",r.urlName,""),Rw(1),db("icon",i.iconTutorial),Rw(2),Vb(" ",r.description," ")}}function jve(e,t){if(1&e&&(pb(0,"div",7),lb(1,Wve,19,11,"div",41),gb()),2&e){var n=t.$implicit;Rw(1),db("ngForOf",n)}}var Zve=function(){var e=function(){function e(t,n){sp(this,e),this.router=t,this.numberOfColumns=4,this.games=[],this.iconOnlineGame=wte,this.iconLocalGame=kte,this.iconTutorial=yte,this.gameInfoDetails=hB.empty(),this.theme=n.getTheme();for(var r=Gve.ALL_GAMES().filter(function(e){return!0===e.display}),i=0,a=0;a<r.length;a++)a<this.numberOfColumns&&this.games.push([]),this.games[i].push(r[a]),i=(i+1)%this.numberOfColumns}return cp(e,[{key:"createGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/play",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createLocalGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/local",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createTutorial",value:function(e){return this.router.navigate(["/tutorial",e])}},{key:"openInfo",value:function(e){this.gameInfoDetails=hB.of(e)}},{key:"closeInfo",value:function(){this.gameInfoDetails=hB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(ZM),fb(gte))},e.\u0275cmp=oy({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){return[[1,"hero"],[1,"hero-body"],[1,"title"],$localize(Kl||(Kl=Vv(["EveryBoard"]))),[1,"subtitle"],$localize(Jl||(Jl=Vv(["EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.",":LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn."])),"\ufffd#6\ufffd\ufffd/#6\ufffd"),[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],$localize(Ql||(Ql=Vv(["Play online"]))),[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(Xl||(Xl=Vv(["Create an online game"]))),["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],$localize(eh||(eh=Vv(["See the game list"]))),$localize(th||(th=Vv(["Play offline"]))),[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(nh||(nh=Vv(["Play"]))),["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],$localize(rh||(rh=Vv(["Learn"]))),["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],$localize(ih||(ih=Vv(["Play online"]))),$localize(ah||(ah=Vv(["Play offline"]))),$localize(oh||(oh=Vv(["Learn the rules"]))),["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",$localize(sh||(sh=Vv(["Play online"]))),1,"button",3,"id","click"],["data-tooltip",$localize(uh||(uh=Vv(["Play offline"]))),1,"button",3,"id","click"],["data-tooltip",$localize(ch||(ch=Vv(["Learn the rules"]))),1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(pb(0,"section",0),pb(1,"div",1),pb(2,"p",2),WE(3,3),gb(),pb(4,"p",4),qE(5,5),yb(6,"br"),$E(),gb(),gb(),pb(7,"div",6),pb(8,"div",7),pb(9,"div",8),pb(10,"header",9),pb(11,"p",10),WE(12,11),gb(),gb(),pb(13,"div",12),pb(14,"div",13),pb(15,"button",14),WE(16,15),gb(),pb(17,"button",16),WE(18,17),gb(),gb(),gb(),gb(),gb(),pb(19,"div",7),pb(20,"div",8),pb(21,"header",9),pb(22,"p",10),WE(23,18),gb(),gb(),pb(24,"div",12),pb(25,"div",19),pb(26,"button",20),WE(27,21),gb(),pb(28,"button",22),WE(29,23),gb(),gb(),gb(),gb(),gb(),gb(),lb(30,$ve,34,7,"div",24),pb(31,"div",6),lb(32,jve,2,1,"div",25),gb(),gb()),2&e&&(Rw(30),db("ngIf",t.gameInfoDetails.isPresent()),Rw(2),db("ngForOf",t.games))},directives:[KM,UT,FT,$ne],encapsulation:2}),e}(),Yve=function(){var e=function(){function e(t){sp(this,e),this.element=t}return cp(e,[{key:"ngAfterViewInit",value:function(){this.element.nativeElement.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(cS))},e.\u0275dir=fy({type:e,selectors:[["","autofocus",""]]}),e}(),Kve=function(){var e=function(){function e(t){var n=this;sp(this,e),this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",function(e){n.toggle()})}return cp(e,[{key:"toggle",value:function(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(cS))},e.\u0275dir=fy({type:e,selectors:[["","toggleVisibility",""]]}),e}();function Jve(e,t){if(1&e&&(pb(0,"div",29),pb(1,"div",30),WE(2,31),gb(),pb(3,"div",32),Bb(4),gb(),gb()),2&e){var n=Pb();Rw(4),Ub(n.errorMessage)}}var Qve=function(){return["/register"]},Xve=function(){return["/reset-password"]},epe=function(){var e=function(){function e(t,n){sp(this,e),this.router=t,this.connectedUserService=n,this.faEye=_te,this.loginForm=new Vx({email:new Ux,password:new Ux})}return cp(e,[{key:"ngOnInit",value:function(){var e,t=this;this.connectedUserService.getUserObs().subscribe((e=aB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n!==Kee.NOT_CONNECTED,!e.t0){e.next=4;break}return e.next=4,t.redirect();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"loginWithEmail",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.doEmailLogin(e.email,e.password);case 2:(r=n.sent).isFailure()&&(t.errorMessage=r.getReason());case 4:case"end":return n.stop()}},n)}))()}},{key:"loginWithGoogle",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.doGoogleLogin();case 2:(n=t.sent).isFailure()&&(e.errorMessage=n.getReason());case 4:case"end":return t.stop()}},t)}))()}},{key:"redirect",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/lobby"]));case 1:case"end":return t.stop()}},t)}))()}},{key:"canLogin",value:function(){return!(""===(this.loginForm.value.email||"")||""===(this.loginForm.value.password||""))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(ZM),fb(Jee))},e.\u0275cmp=oy({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){return[[1,"box"],[1,"title"],$localize(lh||(lh=Vv(["Log in"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(hh||(hh=Vv(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",$localize(fh||(fh=Vv(["Email"]))),"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],$localize(dh||(dh=Vv(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",$localize(vh||(vh=Vv(["Password"]))),"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(ph||(ph=Vv(["Log in"]))),["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(gh||(gh=Vv(["Log in with Google"]))),["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],$localize(yh||(yh=Vv(["No account?"]))),[3,"routerLink"],$localize(mh||(mh=Vv(["Register"]))),$localize(kh||(kh=Vv(["Forgot your password?"]))),$localize(_h||(_h=Vv(["Reset your password"]))),["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(wh||(wh=Vv(["Connection error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(pb(0,"div",0),pb(1,"p",1),WE(2,2),gb(),pb(3,"form",3),pb(4,"div",4),pb(5,"div",5),pb(6,"label",6),WE(7,7),gb(),gb(),pb(8,"div",8),pb(9,"div",9),pb(10,"div",10),yb(11,"input",11),gb(),gb(),gb(),gb(),pb(12,"div",4),pb(13,"div",5),pb(14,"label",12),WE(15,13),gb(),gb(),pb(16,"div",8),pb(17,"div",9),pb(18,"div",14),yb(19,"input",15),pb(20,"span",16),yb(21,"fa-icon",17),gb(),gb(),gb(),gb(),gb(),pb(22,"div",4),yb(23,"div",5),pb(24,"div",8),pb(25,"div",9),pb(26,"div",10),pb(27,"button",18),bb("click",function(){return t.loginWithEmail(t.loginForm.value)}),WE(28,19),gb(),gb(),gb(),gb(),gb(),pb(29,"div",4),yb(30,"div",5),pb(31,"div",8),pb(32,"div",9),pb(33,"div",10),pb(34,"button",20),bb("click",function(){return t.loginWithGoogle()}),WE(35,21),gb(),gb(),gb(),gb(),gb(),lb(36,Jve,5,1,"div",22),pb(37,"p",23),mb(38),WE(39,24),kb(),Bb(40,"\xa0 "),pb(41,"a",25),WE(42,26),gb(),gb(),pb(43,"p",23),mb(44),WE(45,27),kb(),Bb(46,"\xa0 "),pb(47,"a",25),WE(48,28),gb(),gb(),gb(),gb()),2&e&&(Rw(3),db("formGroup",t.loginForm),Rw(18),db("icon",t.faEye),Rw(6),db("disabled",!t.canLogin()),Rw(9),db("ngIf",t.errorMessage),Rw(5),db("routerLink",oP(6,Qve)),Rw(6),db("routerLink",oP(7,Xve)))},directives:[Zx,gx,eA,UI,px,nA,Yve,fA,$ne,Kve,UT,JM],encapsulation:2}),e}(),tpe=function(){var e=function(){function e(t){sp(this,e),this.partDAO=t,this.unsubscribe=hB.empty(),this.activePartsBS=new nR([]),this.activePartsObs=this.activePartsBS.asObservable()}return cp(e,[{key:"getActivePartsObs",value:function(){return this.activePartsObs}},{key:"startObserving",value:function(){var e=this;a6(this.unsubscribe.isAbsent(),"ActivePartsService: already observing");var t=new f6(function(t){var n,r=(n=e.activePartsBS.value).concat.apply(n,np(t));e.activePartsBS.next(r)},function(t){var n,r=e.activePartsBS.value,i=ip(t);try{var a=function(){var e=n.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}e.activePartsBS.next(r)},function(t){var n,r=[],i=ip(e.activePartsBS.value);try{var a=function(){var e=n.value;t.some(function(t){return t.id===e.id})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}e.activePartsBS.next(r)});this.unsubscribe=hB.of(this.partDAO.observeActiveParts(t))}},{key:"stopObserving",value:function(){a6(this.unsubscribe.isPresent(),"Cannot stop observing active parts when you have not started observing"),this.activePartsBS.next([]),this.unsubscribe.get()(),this.unsubscribe=hB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(u6))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),npe=function(){var e=function(){function e(t){sp(this,e),this.router=t}return cp(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"navigateToOnlineGameCreation",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/play",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(ZM))},e.\u0275cmp=oy({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Ch||(Ch=Vv(["Create an online game"])))]},template:function(e,t){1&e&&(pb(0,"app-pick-game",0),bb("pickGame",function(e){return t.pickGame(e)}),gb(),pb(1,"button",1),bb("click",function(){return t.navigateToOnlineGameCreation()}),WE(2,2),gb()),2&e&&(Rw(1),db("disabled",!t.selectedGame))},directives:[qve],encapsulation:2}),e}(),rpe=function(){var e=function(){function e(){sp(this,e)}return cp(e,[{key:"transform",value:function(e){return gT(1e3*e.seconds,"HH:mm:ss","en-US")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=dy({name:"firebaseDate",type:e,pure:!0}),e}(),ipe=["chatDiv"];function ape(e,t){1&e&&(mb(0),WE(1,5),kb())}function ope(e,t){1&e&&WE(0,6),2&e&&(jE(Pb().unreadMessagesText),ZE(0))}function spe(e,t){if(1&e){var n=_b();pb(0,"button",11),bb("click",function(){return Jy(n),Pb(2).scrollToBottom()}),Bb(1),gb()}if(2&e){var r=Pb(2);Rw(1),Vb("",r.unreadMessagesText," \u2193")}}function upe(e,t){if(1&e&&(pb(0,"p"),Bb(1),fP(2,"firebaseDate"),pb(3,"b",12),Bb(4),gb(),pb(5,"span",13),Bb(6),gb(),gb()),2&e){var n=t.$implicit;Rw(1),Vb(" [",dP(2,3,n.postedTime),"] "),Rw(3),Vb("",n.sender.name," : "),Rw(2),Ub(n.content)}}function cpe(e,t){if(1&e){var n=_b();pb(0,"div"),lb(1,spe,2,1,"button",7),pb(2,"div",8,9),bb("scroll",function(){return Jy(n),Pb().updateCurrentScrollPosition()}),lb(4,upe,7,5,"p",10),gb(),gb()}if(2&e){var r=Pb();Rw(1),db("ngIf",r.showUnreadMessagesButton),Rw(3),db("ngForOf",r.chat)}}var lpe=function(){return{standalone:!0}};function hpe(e,t){if(1&e){var n=_b();pb(0,"form",14),bb("onSubmit",function(){return Jy(n),Pb().sendMessage()}),pb(1,"div",15),pb(2,"div",16),pb(3,"input",17,18),bb("ngModelChange",function(e){return Jy(n),Pb().userMessage=e}),gb(),pb(5,"p",19),Bb(6),gb(),gb(),pb(7,"div",20),pb(8,"button",21),bb("click",function(){return Jy(n),Pb().sendMessage()}),yb(9,"fa-icon",22),gb(),gb(),gb(),pb(10,"div",23),pb(11,"p"),pb(12,"strong"),WE(13,24),gb(),gb(),gb(),gb()}if(2&e){var r=hb(4),i=Pb();Rw(3),db("ngModel",i.userMessage)("ngModelOptions",oP(4,lpe)),Rw(3),Vb("",r.value.length,"/128"),Rw(3),db("icon",i.faReply)}}var fpe=function(){var e=function(){function e(t,n){sp(this,e),this.chatService=t,this.connectedUserService=n,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=Cte,this.isNearBottom=!0,this.notYetScrolled=!0,sB(e.VERBOSE,"ChatComponent constructor")}return cp(e,[{key:"ngOnInit",value:function(){sB(e.VERBOSE,"ChatComponent.ngOnInit for chat ".concat(this.chatId)),a6(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}},{key:"ngAfterViewChecked",value:function(){this.scrollToBottomIfNeeded()}},{key:"loadChatContent",value:function(){var e=this,t=function(t){e.updateMessages(t.flatMap(function(e){return null==e.data.postedTime?[]:[e.data]}))},n=new f6(t,t,function(){});this.chatService.startObserving(this.chatId,n)}},{key:"updateMessages",value:function(e){this.chat=this.chat.concat(e);var t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}},{key:"updateUnreadMessagesText",value:function(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize(bh||(bh=Vv(["no new message"]))),this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize(Eh||(Eh=Vv(["1 new message"]))):$localize(Sh||(Sh=Vv([""," new messages"])),e)}},{key:"scrollToBottomIfNeeded",value:function(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}},{key:"updateCurrentScrollPosition",value:function(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}},{key:"scrollToBottom",value:function(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}},{key:"scrollTo",value:function(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}},{key:"sendMessage",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.userMessage,e.userMessage="",r=e.connectedUserService.user.get().toMinimalUser(),t.next=5,e.chatService.sendMessage(r,n,e.turn);case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.chatService.stopObserving()}},{key:"switchChatVisibility",value:function(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(h6),fb(Jee))},e.\u0275cmp=oy({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){var n;(1&e&&xP(ipe,5),2&e)&&(IP(n=AP())&&(t.chatDiv=n.first))},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){return[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],$localize(Ph||(Ph=Vv(["Hide chat"]))),$localize(Oh||(Oh=Vv(["Show chat (",":INTERPOLATION:)"])),"\ufffd0\ufffd"),["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",$localize(Th||(Th=Vv(["Type your message here"]))),"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],$localize(Ih||(Ih=Vv(["Be polite"])))]},template:function(e,t){if(1&e&&(pb(0,"div"),pb(1,"button",0),bb("click",function(){return t.switchChatVisibility()}),lb(2,ape,2,0,"ng-container",1),lb(3,ope,1,1,"ng-template",null,2,NP),gb(),lb(5,cpe,5,2,"div",3),lb(6,hpe,14,5,"form",4),gb()),2&e){var n=hb(4);Rw(2),db("ngIf",t.visible)("ngIfElse",n),Rw(3),db("ngIf",t.visible),Rw(1),db("ngIf",t.visible)}},directives:[UT,FT,Zx,gx,qx,UI,vA,px,jx,$ne],pipes:[rpe],encapsulation:2}),e}();function dpe(e,t){if(1&e&&(mb(0),Bb(1),kb()),2&e){var n=Pb().$implicit;Rw(1),Ub(n.data.playerOne)}}function vpe(e,t){1&e&&(mb(0),WE(1,26),kb())}function ppe(e,t){if(1&e){var n=_b();pb(0,"tr",22),bb("click",function(){var e=Jy(n).$implicit;return Pb(2).joinGame(e.id,e.data.typeGame)}),pb(1,"td",23),Bb(2),gb(),pb(3,"td",23),Bb(4),gb(),pb(5,"td",23),lb(6,dpe,2,1,"ng-container",24),lb(7,vpe,2,0,"ng-template",null,25,NP),gb(),pb(9,"td",23),Bb(10),gb(),gb()}if(2&e){var r=t.$implicit,i=t.index,a=hb(8);Tb("id","part_",i,""),Rw(2),Ub(r.data.typeGame),Rw(2),Ub(r.data.playerZero),Rw(2),db("ngIf",r.data.playerOne)("ngIfElse",a),Rw(4),Ub(r.data.turn)}}function gpe(e,t){if(1&e&&(pb(0,"div",13),pb(1,"div",14),pb(2,"table",15),pb(3,"thead"),pb(4,"tr"),pb(5,"th",16),WE(6,17),gb(),pb(7,"th",16),WE(8,18),gb(),pb(9,"th",16),WE(10,19),gb(),pb(11,"th",16),WE(12,20),gb(),gb(),gb(),pb(13,"tbody"),lb(14,ppe,11,6,"tr",21),gb(),gb(),gb(),gb()),2&e){var n=Pb();Rw(14),db("ngForOf",n.activeParts)}}function ype(e,t){1&e&&(pb(0,"div",27),yb(1,"app-online-game-selection",28),gb())}function mpe(e,t){if(1&e&&(pb(0,"li",39),Bb(1),fP(2,"firebaseDate"),gb()),2&e){var n=Pb().$implicit;Ob("id",n.data.username),Rw(1),zb("",n.data.username,": ",dP(2,3,n.data.last_changed),"")}}function kpe(e,t){if(1&e&&(mb(0),lb(1,mpe,3,5,"li",38),kb()),2&e){var n=t.$implicit;Rw(1),db("ngIf",n.data.last_changed)}}function _pe(e,t){if(1&e&&(pb(0,"div",29),pb(1,"div",30),pb(2,"div",31),yb(3,"app-chat",32),gb(),gb(),pb(4,"div",33),pb(5,"div",34),pb(6,"p"),WE(7,35),gb(),pb(8,"ul",36),lb(9,kpe,2,1,"ng-container",37),gb(),gb(),gb(),gb()),2&e){var n=Pb();Rw(3),db("turn",-1),Rw(6),db("ngForOf",n.activeUsers)}}var wpe=function(){var e=function(){function e(t,n,r){sp(this,e),this.router=t,this.userService=n,this.activePartsService=r,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}return cp(e,[{key:"ngOnInit",value:function(){var t=this;sB(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSub=this.userService.getActiveUsersObs().subscribe(function(e){t.activeUsers=e}),this.activePartsService.startObserving(),this.activePartsSub=this.activePartsService.getActivePartsObs().subscribe(function(e){t.activeParts=e})}},{key:"ngOnDestroy",value:function(){sB(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSub.unsubscribe(),this.activePartsService.stopObserving(),this.activePartsSub.unsubscribe(),this.userService.unSubFromActiveUsersObs()}},{key:"joinGame",value:function(e,t){var n=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.router.navigate(["/play",t,e]);case 2:case"end":return r.stop()}},r)}))()}},{key:"selectTab",value:function(e){this.currentTab=e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(ZM),fb(p6),fb(tpe))},e.\u0275cmp=oy({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){return[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],$localize(xh||(xh=Vv(["Games"]))),["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],$localize(Ah||(Ah=Vv(["Create"]))),["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],$localize(Rh||(Rh=Vv(["Chat"]))),["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Nh||(Nh=Vv(["Game"]))),$localize(Mh||(Mh=Vv(["First player"]))),$localize(Dh||(Dh=Vv(["Second player"]))),$localize(Lh||(Lh=Vv(["Turn"]))),[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],$localize(Fh||(Fh=Vv(["Waiting for opponent"]))),["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-9"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3"],["id","onlineUsers",1,"box"],$localize(Bh||(Bh=Vv(["Connected users:"]))),["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,t){1&e&&(pb(0,"div",0),pb(1,"ul"),pb(2,"li",1),pb(3,"a",2),bb("click",function(){return t.selectTab("games")}),WE(4,3),gb(),gb(),pb(5,"li",4),pb(6,"a",5),bb("click",function(){return t.selectTab("create")}),WE(7,6),gb(),gb(),pb(8,"li",7),pb(9,"a",8),bb("click",function(){return t.selectTab("chat")}),WE(10,9),gb(),gb(),gb(),gb(),lb(11,gpe,15,1,"div",10),lb(12,ype,2,0,"div",11),lb(13,_pe,10,2,"div",12)),2&e&&(Rw(11),db("ngIf","games"===t.currentTab),Rw(1),db("ngIf","create"===t.currentTab),Rw(1),db("ngIf","chat"===t.currentTab))},directives:[DT,UT,FT,npe,fpe],pipes:[rpe],encapsulation:2}),e}(),Cpe=function(){var e=cp(function e(t){var n;sp(this,e),this.route=t,this.message=null!==(n=t.snapshot.paramMap.get("message"))&&void 0!==n?n:$localize(Uh||(Uh=Vv(["This page does not exist."])))});return e.\u0275fac=function(t){return new(t||e)(fb(ON))},e.\u0275cmp=oy({type:e,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){return[[1,"message","is-danger"],[1,"message-header"],$localize(Vh||(Vh=Vv(["Not found"]))),[1,"message-body"]]},template:function(e,t){1&e&&(pb(0,"div",0),pb(1,"div",1),WE(2,2),gb(),pb(3,"div",3),Bb(4),gb(),gb()),2&e&&(Rw(4),Ub(t.message))},encapsulation:2}),e}();function bpe(e,t){}var Epe=function(){var e=cp(function e(t){sp(this,e),this.viewContainerRef=t,sB(e.VERBOSE,"GameIncluderComponent constructor")});return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(WS))},e.\u0275cmp=oy({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&lb(0,bpe,0,0,"ng-template")},encapsulation:2}),e}(),Spe=function(){var e=function(){function e(){sp(this,e)}return cp(e,null,[{key:"NO_MATCHING_GAME",value:function(e){return $localize(zh||(zh=Vv(["This game (",") does not exist."])),e)}}]),e}();return e.NOT_YOUR_TURN=function(){return $localize(Hh||(Hh=Vv(["It is not your turn!"])))},e.NO_CLONING_FEATURE=function(){return $localize(Gh||(Gh=Vv(["You cannot clone a game. This feature might be implemented later."])))},e}(),Ppe=function(){var e=function(){function e(t,n,r,i,a){sp(this,e),this.componentFactoryResolver=t,this.actRoute=n,this.connectedUserService=r,this.router=i,this.messageDisplayer=a,this.players=[hB.empty(),hB.empty()],this.endGame=!1,sB(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}return cp(e,[{key:"getMatchingComponent",value:function(t){return sB(e.VERBOSE,"GameWrapper.getMatchingComponent"),hB.ofNullable(Gve.ALL_GAMES().find(function(e){return e.urlName===t})).map(function(e){return e.component})}},{key:"afterGameIncluderViewInit",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return sB(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),n.next=3,t.createGameComponent();case 3:return r=n.sent,n.abrupt("return",(r&&t.gameComponent.rules.setInitialBoard(),r));case 5:case"end":return n.stop()}},n)}))()}},{key:"createGameComponent",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(sB(e.VERBOSE,"GameWrapper.createGameComponent"),r=oB.getNonNullable(t.actRoute.snapshot.paramMap.get("compo")),!(i=t.getMatchingComponent(r)).isAbsent()){n.next=6;break}return n.next=5,t.router.navigate(["/notFound",Spe.NO_MATCHING_GAME(r)],{skipLocationChange:!0});case 5:return n.abrupt("return",!1);case 6:return a6(null!=t.gameIncluder,"GameIncluder should be present"),a=t.componentFactoryResolver.resolveComponentFactory(i.get()),o=t.gameIncluder.viewContainerRef.createComponent(a),n.abrupt("return",(t.gameComponent=o.instance,t.gameComponent.chooseMove=function(e,n,r){return t.receiveValidMove(e,n,r)},t.gameComponent.canUserPlay=function(e){return t.onUserClick(e)},t.gameComponent.isPlayerTurn=function(){return t.isPlayerTurn()},t.gameComponent.cancelMoveOnWrapper=function(e){t.onCancelMove(e)},t.gameComponent.observerRole=t.observerRole,t.canPass=t.gameComponent.canPass,!0));case 9:case"end":return n.stop()}},n)}))()}},{key:"receiveValidMove",value:function(t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(sB(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),i.isPlayerTurn()){a.next=2;break}return a.abrupt("return",e6.failure(Spe.NOT_YOUR_TURN()));case 2:if(!i.endGame){a.next=4;break}return a.abrupt("return",e6.failure($localize(qh||(qh=Vv(["The game has ended."])))));case 4:if(!(o=i.gameComponent.rules.isLegal(t,n)).isFailure()){a.next=9;break}a.t0=(i.gameComponent.cancelMove(o.getReason()),e6.ofFallible(o)),a.next=14;break;case 9:return i.gameComponent.cancelMoveAttempt(),a.next=12,i.onLegalUserMove(t,r);case 12:sB(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),a.t0=e6.SUCCESS;case 14:return a.abrupt("return",a.t0);case 15:case"end":return a.stop()}},a)}))()}},{key:"onUserClick",value:function(e){if(this.observerRole===ate.NONE.value){var t=Spe.NO_CLONING_FEATURE();return e6.failure(t)}return this.isPlayerTurn()?e6.SUCCESS:e6.failure(Spe.NOT_YOUR_TURN())}},{key:"onCancelMove",value:function(e){}},{key:"isPlayerTurn",value:function(){if(this.observerRole===ate.NONE.value||null==this.gameComponent)return!1;var t=this.gameComponent.rules.node.gameState.turn,n=t%2,r=this.getPlayerName();return sB(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,username:r,observer:this.observerRole,areYouPlayer:this.players[n].equalsValue(r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}},{key:"getBoardHighlight",value:function(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.rules.node.gameState.turn%2+"-bg"]:[]}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(aS),fb(ON),fb(Jee),fb(ZM),fb(r6))},e.\u0275cmp=oy({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;(1&e&&xP(Epe,5),2&e)&&(IP(n=AP())&&(t.gameIncluder=n.first))},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),Ope=function(){function e(t,n,r){sp(this,e),this.added=t,this.modified=n,this.removed=r}return cp(e,[{key:"addNewKeys",value:function(e,t){var n,r=ip(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!=t[i]&&(this.added[i]=t[i])}}catch(a){r.e(a)}finally{r.f()}}},{key:"addCommonKeys",value:function(e,t,n){var r,i=ip(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.addCommonKey(a,n[a],t[a])}}catch(o){i.e(o)}finally{i.f()}}},{key:"addCommonKey",value:function(t,n,r){if(null==r)null!=n&&(this.removed[t]=n);else if(null==n)this.added[t]=r;else if(["string","boolean","number"].includes(typeof n))n!==r&&(this.modified[t]=r);else if(Array.isArray(n)){if(!Array.isArray(r))throw new Error("Thing should not change type");n.length===r.length?this.addCommonKeyList(t,n,r):this.modified[t]=r}else{a6("object"==typeof n,"ObjectDifference: expected JSON, but got a ".concat(typeof n," in ").concat(t)),a6("object"==typeof r,"ObjectDifference: expected JSON, but got a ".concat(typeof r," in ").concat(t));var i=e.from(n,r);i.countChanges()>0&&(this.modified[t]=i)}}},{key:"addCommonKeyList",value:function(t,n,r){for(var i=!0,a=0;i&&a<n.length;a++)typeof n[a]==typeof r[a]&&"object"==typeof n[a]?e.differs(n[a],r[a])&&(i=!1,this.modified[t]=r):n[a]!==r[a]&&(i=!1,this.modified[t]=r)}},{key:"addRemovedKeys",value:function(e,t){var n,r=ip(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.removed[i]=t[i]}}catch(a){r.e(a)}finally{r.f()}}},{key:"countChanges",value:function(){var e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}},{key:"isPresent",value:function(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}],[{key:"from",value:function(t,n){var r=new e({},{},{});if(null==t)return r.added=Uv({},n),r;if(null==n)return r.removed=Uv({},t),r;var i=Object.keys(t),a=Object.keys(n),o=i.filter(function(e){return!1===a.includes(e)}),s=i.filter(function(e){return a.includes(e)}),u=a.filter(function(e){return!1===i.includes(e)});return r.addNewKeys(u,n),r.addCommonKeys(s,n,t),r.addRemovedKeys(o,t),r}},{key:"differs",value:function(t,n){return e.from(t,n).countChanges()>0}}]),e}();function Tpe(e){return 1e3*e.seconds+e.nanoseconds/1e6}function Ipe(e,t){return Tpe(t)-Tpe(e)}function xpe(e){return Vp(function(t,n){ng(e).subscribe(new zp(n,function(){return n.complete()},wp)),!n.closed&&t.subscribe(n)})}var Ape=function(){var e=function(){function e(){sp(this,e)}return cp(e,[{key:"transform",value:function(e){var t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize($h||($h=Vv([""," hours"])),r)):1===r&&i.push($localize(Wh||(Wh=Vv(["1 hour"])))),n>1?i.push($localize(jh||(jh=Vv([""," minutes"])),n)):1===n&&i.push($localize(Zh||(Zh=Vv(["1 minute"])))),t>1?i.push($localize(Yh||(Yh=Vv([""," seconds"])),t)):1===t&&i.push($localize(Kh||(Kh=Vv(["1 second"])))),0===i.length)return $localize(Jh||(Jh=Vv(["0 seconds"])));if(1===i.length)return i[0];var a=i.slice(0,-1).join(", "),o=i.slice(-1)[0];return $localize(Qh||(Qh=Vv([""," and ",""])),a,o)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=dy({name:"humanDuration",type:e,pure:!0}),e}();function Rpe(e,t){if(1&e&&(mb(0),Bb(1),kb()),2&e){var n=Pb(3);Rw(1),Ub(n.viewInfo.chosenOpponent)}}function Npe(e,t){1&e&&WE(0,44)}function Mpe(e,t){if(1&e&&(pb(0,"div",45),pb(1,"div",8),pb(2,"label",46),mb(3),WE(4,47),kb(),pb(5,"output"),Bb(6),fP(7,"humanDuration"),gb(),gb(),pb(8,"div",37),yb(9,"input",48),gb(),gb(),pb(10,"div",8),pb(11,"label",49),qE(12,50),yb(13,"output"),fP(14,"humanDuration"),$E(),gb(),pb(15,"div",37),yb(16,"input",51),gb(),gb(),gb()),2&e){var n=Pb(3);Rw(6),Ub(dP(7,2,n.viewInfo.maximalMoveDuration||0)),Rw(8),jE(dP(14,4,n.viewInfo.totalPartDuration||0)),ZE(12)}}function Dpe(e,t){1&e&&(pb(0,"div"),qE(1,52),yb(2,"br"),$E(),gb())}function Lpe(e,t){1&e&&(pb(0,"button",64),WE(1,65),gb())}function Fpe(e,t){if(1&e){var n=_b();pb(0,"tr",60),bb("click",function(){var e=Jy(n).$implicit;return Pb(4).selectOpponent(e)}),pb(1,"td",61),Bb(2),gb(),pb(3,"td",62),lb(4,Lpe,2,0,"button",63),gb(),gb()}if(2&e){var r=t.$implicit,i=Pb(4);Tb("id","presenceOf_",r,""),db("ngClass",i.viewInfo.candidateClasses[r]),Rw(1),db("id",i.viewInfo.chosenOpponent===r?"selected_"+r:"candidate_"+r),Rw(1),Ub(r),Rw(2),db("ngIf",i.viewInfo.chosenOpponent!==r)}}function Bpe(e,t){if(1&e&&(mb(0),WE(1,53),kb(),pb(2,"div",54),pb(3,"table",55),pb(4,"thead"),pb(5,"tr"),pb(6,"th",56),WE(7,57),gb(),pb(8,"th",56),WE(9,58),gb(),gb(),gb(),pb(10,"tbody"),lb(11,Fpe,5,5,"tr",59),gb(),gb(),gb()),2&e){var n=Pb(3);Rw(11),db("ngForOf",n.viewInfo.candidates)}}function Upe(e,t){if(1&e){var n=_b();pb(0,"button",66),bb("click",function(){return Jy(n),Pb(3).changeConfig()}),WE(1,67),gb()}}function Vpe(e,t){if(1&e){var n=_b();pb(0,"div"),pb(1,"h1",4),WE(2,5),gb(),pb(3,"form",6),pb(4,"fieldset",7),pb(5,"div",8),pb(6,"label",9),WE(7,10),gb(),pb(8,"div",11),pb(9,"button",12),bb("click",function(){return Jy(n),Pb(2).selectFirstPlayer("RANDOM")}),WE(10,13),gb(),pb(11,"button",14),bb("click",function(){return Jy(n),Pb(2).selectFirstPlayer("CREATOR")}),WE(12,15),gb(),pb(13,"button",16),bb("click",function(){return Jy(n),Pb(2).selectFirstPlayer("CHOSEN_PLAYER")}),lb(14,Rpe,2,1,"ng-container",17),lb(15,Npe,1,0,"ng-template",null,18,NP),gb(),gb(),gb(),pb(17,"div",8),pb(18,"label",9),WE(19,19),gb(),pb(20,"div",11),pb(21,"div",20),bb("click",function(){return Jy(n),Pb(2).selectPartType("STANDARD")}),pb(22,"div",21),pb(23,"span"),WE(24,22),gb(),gb(),pb(25,"div",23),pb(26,"div",24),pb(27,"div",25),pb(28,"p"),mb(29),WE(30,26),kb(),pb(31,"strong"),Bb(32),fP(33,"humanDuration"),gb(),yb(34,"br"),mb(35),qE(36,27),yb(37,"strong"),fP(38,"humanDuration"),$E(),kb(),gb(),gb(),gb(),gb(),gb(),pb(39,"div",28),bb("click",function(){return Jy(n),Pb(2).selectPartType("BLITZ")}),pb(40,"div",21),pb(41,"span"),WE(42,29),gb(),gb(),pb(43,"div",23),pb(44,"div",24),pb(45,"div",25),pb(46,"p"),mb(47),WE(48,30),kb(),pb(49,"strong"),Bb(50),fP(51,"humanDuration"),gb(),yb(52,"br"),mb(53),qE(54,31),yb(55,"strong"),fP(56,"humanDuration"),$E(),kb(),gb(),gb(),gb(),gb(),gb(),pb(57,"button",32),bb("click",function(){return Jy(n),Pb(2).selectPartType("CUSTOM")}),WE(58,33),gb(),gb(),gb(),lb(59,Mpe,17,6,"div",34),pb(60,"div",8),pb(61,"label",35),WE(62,36),gb(),pb(63,"div",37),lb(64,Dpe,3,0,"div",17),lb(65,Bpe,12,1,"ng-template",null,38,NP),gb(),gb(),gb(),pb(67,"div",8),pb(68,"div",11),pb(69,"button",39),bb("click",function(){return Jy(n),Pb(2).proposeConfig()}),WE(70,40),gb(),lb(71,Upe,2,0,"button",41),pb(72,"button",42),bb("click",function(){return Jy(n),Pb(2).cancelGameCreation()}),WE(73,43),gb(),gb(),gb(),gb(),gb()}if(2&e){var r=hb(16),i=hb(66),a=Pb(2);Rw(3),db("formGroup",a.configFormGroup),Rw(1),db("disabled",!a.viewInfo.canEditConfig),Rw(5),db("ngClass",a.viewInfo.firstPlayerClasses.RANDOM),Rw(2),db("ngClass",a.viewInfo.firstPlayerClasses.CREATOR),Rw(2),db("ngClass",a.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),Rw(1),db("ngIf",a.viewInfo.chosenOpponent)("ngIfElse",r),Rw(7),db("ngClass",a.viewInfo.partTypeClasses.STANDARD),Rw(11),Ub(dP(33,19,a.partType.NORMAL_MOVE_DURATION)),Rw(6),jE(dP(38,21,a.partType.NORMAL_PART_DURATION)),ZE(36),Rw(1),db("ngClass",a.viewInfo.partTypeClasses.BLITZ),Rw(11),Ub(dP(51,23,a.partType.BLITZ_MOVE_DURATION)),Rw(6),jE(dP(56,25,a.partType.BLITZ_PART_DURATION)),ZE(54),Rw(1),db("ngClass",a.viewInfo.partTypeClasses.CUSTOM),Rw(2),db("ngIf",a.viewInfo.showCustomTime),Rw(5),db("ngIf",0===a.viewInfo.candidates.length)("ngIfElse",i),Rw(5),db("disabled",!a.viewInfo.canProposeConfig),Rw(2),db("ngIf",a.viewInfo.canReviewConfig)}}function zpe(e,t){if(1&e&&(pb(0,"div",74),pb(1,"p"),qE(2,75),yb(3,"br"),$E(),gb(),gb()),2&e){var n=Pb(3);Rw(3),jE(n.viewInfo.creator),ZE(2)}}function Hpe(e,t){if(1&e&&(pb(0,"span"),WE(1,81),gb()),2&e){var n=Pb(4);Rw(1),jE(n.viewInfo.creator),ZE(1)}}function Gpe(e,t){1&e&&(pb(0,"span"),WE(1,82),gb())}function qpe(e,t){1&e&&(pb(0,"span"),WE(1,83),gb())}function $pe(e,t){if(1&e){var n=_b();pb(0,"div",74),pb(1,"p"),WE(2,76),gb(),pb(3,"ul"),pb(4,"li"),lb(5,Hpe,2,1,"span",2),lb(6,Gpe,2,0,"span",2),lb(7,qpe,2,0,"span",2),gb(),pb(8,"li"),qE(9,77),yb(10,"strong"),fP(11,"humanDuration"),$E(),gb(),pb(12,"li"),qE(13,78),yb(14,"strong"),fP(15,"humanDuration"),$E(),gb(),gb(),pb(16,"button",79),bb("click",function(){return Jy(n),Pb(3).acceptConfig()}),WE(17,80),gb(),gb()}if(2&e){var r=Pb(3);Rw(2),jE(r.viewInfo.creator)(r.viewInfo.partTypeName),ZE(2),Rw(3),db("ngIf","CREATOR"===r.viewInfo.firstPlayer),Rw(1),db("ngIf","CHOSEN_PLAYER"===r.viewInfo.firstPlayer),Rw(1),db("ngIf","RANDOM"===r.viewInfo.firstPlayer),Rw(4),jE(dP(11,7,r.viewInfo.maximalMoveDuration||0)),ZE(9),Rw(4),jE(dP(15,9,r.viewInfo.totalPartDuration||0)),ZE(13)}}function Wpe(e,t){if(1&e&&(pb(0,"div"),pb(1,"div",68),pb(2,"div",69),pb(3,"p"),WE(4,70),gb(),gb(),pb(5,"div",71),lb(6,zpe,4,1,"div",72),lb(7,$pe,18,11,"ng-template",null,73,NP),gb(),gb(),gb()),2&e){var n=hb(8),r=Pb(2);Rw(6),db("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function jpe(e,t){if(1&e&&(mb(0),WE(1,86),kb()),2&e){var n=Pb(3);Rw(1),jE(n.viewInfo.creator),ZE(1)}}function Zpe(e,t){if(1&e&&WE(0,87),2&e){var n=Pb(3);jE(n.viewInfo.creator)(n.viewInfo.chosenOpponent),ZE(0)}}function Ype(e,t){if(1&e&&(pb(0,"div",68),pb(1,"div",69),pb(2,"p"),WE(3,84),gb(),gb(),pb(4,"div",71),pb(5,"p"),lb(6,jpe,2,1,"ng-container",17),lb(7,Zpe,1,2,"ng-template",null,85,NP),gb(),gb(),gb()),2&e){var n=hb(8),r=Pb(2);Rw(6),db("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Kpe(e,t){if(1&e&&(pb(0,"div",1),lb(1,Vpe,74,27,"div",2),lb(2,Wpe,9,2,"div",2),lb(3,Ype,9,2,"div",3),gb()),2&e){var n=Pb();Rw(1),db("ngIf",n.viewInfo.userIsCreator),Rw(1),db("ngIf",n.viewInfo.userIsChosenOpponent),Rw(1),db("ngIf",n.viewInfo.userIsObserver)}}var Jpe=function(){function e(t,n,r,i,a,o,s,u){sp(this,e),this.router=t,this.connectedUserService=n,this.gameService=r,this.joinerService=i,this.chatService=a,this.userService=o,this.formBuilder=s,this.messageDisplayer=u,this.partType=Xee,this.gameStartNotification=new yP,this.gameStarted=!1,this.gameExists=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentJoiner=null,this.ngUnsubscribe=new Fp,this.allUserInterval=hB.empty(),this.ownTokenInterval=hB.empty(),this.selfSubscription=function(){},this.allDocDeleted=!1,sB(e.VERBOSE,"PartCreationComponent constructed")}return cp(e,[{key:"ngOnInit",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return sB(e.VERBOSE,"PartCreationComponent.ngOnInit for "+t.connectedUserService.user.get().username.get()),t.checkInputs(),t.createForms(),r=t.connectedUserService.user.get().toMinimalUser(),n.next=4,t.joinerService.joinGame(t.partId,r);case 4:if(!(i=n.sent).isFailure()){n.next=10;break}a=i.getReason(),t.messageDisplayer.criticalMessage(a),n.next=18;break;case 10:return n.next=12,t.updateUserDocWithObservedPart();case 12:return n.next=14,t.startSendingPresenceTokens();case 14:t.gameExists=!0,t.subscribeToJoinerDoc(),t.subscribeToFormElements(),sB(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds");case 18:case"end":return n.stop()}},n)}))()}},{key:"checkInputs",value:function(){var e=this.connectedUserService.user;a6(e.isPresent()&&e.get()!==Kee.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),a6(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}},{key:"createForms",value:function(){this.configFormGroup=this.formBuilder.group({firstPlayer:[Qee.RANDOM.value,$I.required],maximalMoveDuration:[Xee.NORMAL_MOVE_DURATION,$I.required],partType:["STANDARD",$I.required],totalPartDuration:[Xee.NORMAL_PART_DURATION,$I.required],chosenOpponent:["",$I.required]})}},{key:"updateUserDocWithObservedPart",value:function(){return sB(e.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'"),this.connectedUserService.updateObservedPart(this.partId)}},{key:"subscribeToJoinerDoc",value:function(){var e,t=this;this.joinerService.subscribeToChanges(this.partId,(e=aB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCurrentJoinerUpdate(n);case 2:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"getForm",value:function(e){return oB.getNonNullable(this.configFormGroup.get(e))}},{key:"subscribeToFormElements",value:function(){var e=this;this.getForm("chosenOpponent").valueChanges.pipe(xpe(this.ngUnsubscribe)).subscribe(function(t){void 0!==e.viewInfo.chosenOpponent&&(e.viewInfo.candidateClasses[e.viewInfo.chosenOpponent]=[]),e.viewInfo.candidateClasses[t]=["is-selected"],e.viewInfo.chosenOpponent=t;var n=oB.getNonNullable(e.currentJoiner).partStatus;e.viewInfo.canProposeConfig=n!==ete.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(xpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.partTypeClasses[e.viewInfo.partType]=[],e.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],e.viewInfo.partType=t,e.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(xpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(xpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(xpe(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.firstPlayerClasses[e.viewInfo.firstPlayer]=[],e.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],e.viewInfo.firstPlayer=t})}},{key:"updateViewInfo",value:function(){var e,t,n=oB.getNonNullable(this.currentJoiner),r=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=n.partStatus===ete.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=n.partStatus!==ete.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=r.id===n.creator.id,this.viewInfo.userIsChosenOpponent=r.id===(null===(e=n.chosenOpponent)||void 0===e?void 0:e.id),this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=n.partStatus!==ete.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=n.creator.name,this.viewInfo.candidates=n.candidates.map(function(e){return e.name}),r.id===n.creator.id?this.setDataForCreator(n):(this.viewInfo.maximalMoveDuration=n.maximalMoveDuration,this.viewInfo.totalPartDuration=n.totalPartDuration,this.viewInfo.partType=n.partType,this.viewInfo.chosenOpponent=null===(t=n.chosenOpponent)||void 0===t?void 0:t.name,this.viewInfo.firstPlayer=n.firstPlayer),n.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize(Xh||(Xh=Vv(["custom"])));break;case"BLITZ":this.viewInfo.partTypeName=$localize(ef||(ef=Vv(["blitz"])));break;case"STANDARD":this.viewInfo.partTypeName=$localize(tf||(tf=Vv(["standard"])))}}},{key:"setDataForCreator",value:function(e){var t,n,r,i;this.viewInfo.maximalMoveDuration=null!==(t=this.viewInfo.maximalMoveDuration)&&void 0!==t?t:e.maximalMoveDuration,this.viewInfo.totalPartDuration=null!==(n=this.viewInfo.totalPartDuration)&&void 0!==n?n:e.totalPartDuration;var a=this.viewInfo.chosenOpponent;null==a||""===a?a=null!==(r=null===(i=e.chosenOpponent)||void 0===i?void 0:i.name)&&void 0!==r?r:"":!1===e.candidates.some(function(e){return e.name===a})&&(a=""),this.getForm("chosenOpponent").setValue(a)}},{key:"selectFirstPlayer",value:function(e){this.getForm("firstPlayer").setValue(e)}},{key:"selectPartType",value:function(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(Xee.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Xee.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(Xee.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Xee.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}},{key:"selectOpponent",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return sB(e.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")"),i=n.getUserFromName(t),r.abrupt("return",n.joinerService.setChosenOpponent(i));case 3:case"end":return r.stop()}},r)}))()}},{key:"getUserFromName",value:function(e){var t=oB.getNonNullable(this.currentJoiner).candidates.find(function(t){return t.name===e});return oB.getNonNullable(t)}},{key:"changeConfig",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.joinerService.reviewConfig());case 1:case"end":return t.stop()}},t)}))()}},{key:"proposeConfig",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,a=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,s=e.getUserFromName(n),t.abrupt("return",e.joinerService.proposeConfig(s,Xee.of(r),i,Qee.of(a),o));case 2:case"end":return t.stop()}},t)}))()}},{key:"cancelGameCreation",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.allDocDeleted=!0,n.next=3,t.connectedUserService.removeObservedPart();case 3:return sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),n.next=6,t.chatService.deleteChat(t.partId);case 6:return sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),n.next=9,t.joinerService.deleteJoiner();case 9:return sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and joiner deleted"),n.next=12,t.gameService.deletePart(t.partId);case 12:sB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, joiner, and part deleted");case 13:case"end":return n.stop()}},n)}))()}},{key:"onCurrentJoinerUpdate",value:function(t){var n=this;return aB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(e.VERBOSE,{PartCreationComponent_onCurrentJoinerUpdate:{before:JSON.stringify(n.currentJoiner),then:JSON.stringify(t)}}),!t.isAbsent()){r.next=2;break}return r.abrupt("return",(sB(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: LAST UPDATE : the game is cancelled"),n.onGameCancelled()));case 2:if(n.chosenOpponentJustLeft(t.get())&&(i=oB.getNonNullable(n.currentJoiner),a=oB.getNonNullable(i.chosenOpponent).name,n.messageDisplayer.infoMessage($localize(nf||(nf=Vv([""," left the game, please pick another opponent."])),a))),n.currentJoiner=t.get(),r.t0=n.allUserInterval.isAbsent(),!r.t0){r.next=8;break}return r.next=8,n.observeNeededPlayers();case 8:n.updateViewInfo(),n.isGameStarted()&&(sB(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: the game has started"),n.onGameStarted());case 10:case"end":return r.stop()}},r)}))()}},{key:"chosenOpponentJustLeft",value:function(e){return null!=this.currentJoiner&&null!=this.currentJoiner.chosenOpponent&&null==e.chosenOpponent}},{key:"onGameCancelled",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return sB(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize(rf||(rf=Vv(["The game has been canceled!"])))),n.next=4,t.router.navigate(["/lobby"]);case 4:case"end":return n.stop()}},n)}))()}},{key:"isGameStarted",value:function(){return oB.getNonNullable(this.currentJoiner).partStatus===ete.PART_STARTED.value}},{key:"onGameStarted",value:function(){var t=oB.getNonNullable(this.currentJoiner);sB(e.VERBOSE,{partCreationComponent_onGameStarted:{joiner:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,sB(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}},{key:"observeNeededPlayers",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=oB.getNonNullable(t.currentJoiner),i=t.connectedUserService.user.get().id,sB(e.VERBOSE,{PartCreationComponent_updateJoiner:{joiner:r}}),t.allUserInterval=hB.of(window.setInterval(aB(regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=oB.getNonNullable(t.currentJoiner),r=t.lastToken,i!==n.creator.id){e.next=6;break}return e.next=4,t.checkCandidatesTokensFreshness(r);case 4:e.next=8;break;case 6:return e.next=8,t.checkCreatorTokenFreshness(r);case 8:case"end":return e.stop()}},e)})),e.TOKEN_INTERVAL));case 2:case"end":return n.stop()}},n)}))()}},{key:"checkCreatorTokenFreshness",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=oB.getNonNullable(t.currentJoiner),n.next=3,t.didUserTimeout(r.creator.id,e);case 3:if(n.t0=n.sent,!n.t0){n.next=7;break}return n.next=7,t.destroyDocIfPartDidNotStart();case 7:case"end":return n.stop()}},n)}))()}},{key:"destroyDocIfPartDidNotStart",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a6(0==(oB.getNonNullable(e.currentJoiner).partStatus===ete.PART_STARTED.value),"Should not try to cancelGameCreation when part started!"),a6(!1===e.allDocDeleted,"Should not delete doc twice"),t.next=4,e.cancelGameCreation();case 4:case"end":return t.stop()}},t)}))()}},{key:"checkCandidatesTokensFreshness",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=oB.getNonNullable(t.currentJoiner),i=ip(r.candidates),n.prev=2,i.s();case 4:if((a=i.n()).done){n.next=14;break}return o=a.value,n.next=8,t.didUserTimeout(o.id,e);case 8:if(n.t0=n.sent,!n.t0){n.next=12;break}return n.next=12,t.removeCandidateFromLobby(o.id);case 12:n.next=4;break;case 14:n.next=19;break;case 16:n.prev=16,n.t1=n.catch(2),i.e(n.t1);case 19:return n.prev=19,i.f(),n.finish(19);case 22:case"end":return n.stop()}},n,null,[[2,16,19,22]])}))()}},{key:"didUserTimeout",value:function(t,n){var r=this;return aB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.userService.getUserLastChanged(t);case 2:return a=i.sent,i.abrupt("return",a.isAbsent()?(i6.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):Ipe(a.get(),n)>e.TOKEN_TIMEOUT);case 4:case"end":return i.stop()}},i)}))()}},{key:"startSendingPresenceTokens",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.sendPresenceToken();case 2:a6(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=hB.of(window.setInterval(function(){t.connectedUserService.sendPresenceToken()},e.TOKEN_INTERVAL)),r=t.connectedUserService.user.get().id,t.selfSubscription=t.userService.observeUser(r,function(e){a6(e.isPresent(),"connected user should exist");var n=e.get();null!=n.last_changed&&(t.lastToken=n.last_changed)});case 6:case"end":return n.stop()}},n)}))()}},{key:"stopSendingPresenceTokensAndObservingUsersIfNeeded",value:function(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=hB.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription()}},{key:"removeCandidateFromLobby",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a6(-1!==(i=oB.getNonNullable(t.currentJoiner)).candidates.findIndex(function(t){return t.id===e}),"PartCreationComponent: attempting to remove a user not in the lobby"),a=i.candidates.filter(function(t){return t.id!==e}),n.abrupt("return",(null===(r=i.chosenOpponent)||void 0===r?void 0:r.id)===e?t.joinerService.reviewConfigAndRemoveChosenOpponentAndUpdateCandidates(a):t.joinerService.updateCandidates(a));case 4:case"end":return n.stop()}},n)}))()}},{key:"acceptConfig",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(sB(e.VERBOSE,"PartCreationComponent.acceptConfig"),t.gameService.acceptConfig(t.partId,oB.getNonNullable(t.currentJoiner))));case 1:case"end":return n.stop()}},n)}))()}},{key:"ngOnDestroy",value:function(){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded(),t.gameExists&&t.joinerService.unsubscribe(),r=t.connectedUserService.user.get(),!0===t.gameStarted){n.next=18;break}if(null!==t.currentJoiner){n.next=5;break}return n.abrupt("return",void sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"));case 5:if(r.id!==t.currentJoiner.creator.id){n.next=11;break}return sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),n.next=9,t.cancelGameCreation();case 9:n.next=18;break;case 11:if(n.t0=!1===t.allDocDeleted,!n.t0){n.next=18;break}return sB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(joiner) about to cancel game joining"),n.next=16,t.connectedUserService.removeObservedPart();case 16:return n.next=18,t.joinerService.cancelJoining(r.toMinimalUser());case 18:case"end":return n.stop()}},n)}))()}}]),e}();function Qpe(e,t){if(1&e){var n=_b();pb(0,"button",3),bb("click",function(){return Jy(n),Pb().addTime()}),WE(1,4),gb()}if(2&e){var r=Pb();Rw(1),jE(r.timeToAdd),ZE(1)}}Jpe.VERBOSE=!1,Jpe.TOKEN_INTERVAL=5e3,Jpe.TOKEN_TIMEOUT=2*Jpe.TOKEN_INTERVAL,Jpe.\u0275fac=function(e){return new(e||Jpe)(fb(ZM),fb(Jee),fb(dte),fb(fte),fb(h6),fb(p6),fb(mA),fb(r6))},Jpe.\u0275cmp=oy({type:Jpe,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){return[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],$localize(af||(af=Vv(["Game creation"]))),[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],$localize(of||(of=Vv(["First player"]))),[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],$localize(sf||(sf=Vv(["Random"]))),["id","firstPlayerCreator",1,"button",3,"ngClass","click"],$localize(uf||(uf=Vv(["You"]))),["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],$localize(cf||(cf=Vv(["Game type"]))),["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],$localize(lf||(lf=Vv(["Standard"]))),["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],$localize(hf||(hf=Vv(["Maximal turn duration: "]))),$localize(ff||(ff=Vv(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#37\ufffd","\ufffd0\ufffd","\ufffd/#37\ufffd"),["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],$localize(df||(df=Vv(["Blitz"]))),$localize(vf||(vf=Vv(["Maximal turn duration: "]))),$localize(pf||(pf=Vv(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#55\ufffd","\ufffd0\ufffd","\ufffd/#55\ufffd"),["id","partTypeCustom",1,"button",3,"ngClass","click"],$localize(gf||(gf=Vv(["Custom"]))),["id","customTime",4,"ngIf"],[1,"label"],$localize(yf||(yf=Vv(["Opponents"]))),[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],$localize(mf||(mf=Vv(["Propose configuration"]))),["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],$localize(kf||(kf=Vv(["Cancel game"]))),$localize(_f||(_f=Vv(["The opponent"]))),["id","customTime"],["for","maximalMoveDuration",1,"label"],$localize(wf||(wf=Vv(["Maximal turn duration: "]))),["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$localize(Cf||(Cf=Vv(["Maximal game duration: ",":START_TAG_OUTPUT:",":INTERPOLATION: per player",":CLOSE_TAG_OUTPUT:"])),"\ufffd#13\ufffd","\ufffd0\ufffd","\ufffd/#13\ufffd"),["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],$localize(bf||(bf=Vv(["Potential opponents that join the game will appear here.",":LINE_BREAK:Wait for an opponent to join, so that you can pick one."])),"\ufffd#2\ufffd\ufffd/#2\ufffd"),$localize(Ef||(Ef=Vv(["Click on the opponent against which you would like to play."]))),["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Sf||(Sf=Vv(["Name"]))),$localize(Pf||(Pf=Vv(["Actions"]))),[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],$localize(Of||(Of=Vv(["Pick"]))),["id","reviewConfig",1,"button",3,"click"],$localize(Tf||(Tf=Vv(["Change configuration"]))),[1,"message","is-primary"],[1,"message-header"],$localize(If||(If=Vv(["Configuration proposal"]))),[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],$localize(xf||(xf=Vv(["You have been selected as the opponent.",":LINE_BREAK: ",":INTERPOLATION: is modifying the configuration."])),"\ufffd#3\ufffd\ufffd/#3\ufffd","\ufffd0\ufffd"),$localize(Af||(Af=Vv(["",":INTERPOLATION: proposes to play a ",":INTERPOLATION_1: game"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(Rf||(Rf=Vv(["a turn lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: ",":CLOSE_TAG_STRONG:"])),"\ufffd#10\ufffd","\ufffd0\ufffd","\ufffd/#10\ufffd"),$localize(Nf||(Nf=Vv(["the game lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#14\ufffd","\ufffd0\ufffd","\ufffd/#14\ufffd"),["id","acceptConfig",1,"button","is-primary",3,"click"],$localize(Mf||(Mf=Vv(["Accept and start"]))),$localize(Df||(Df=Vv(["",":INTERPOLATION: plays first"])),"\ufffd0\ufffd"),$localize(Lf||(Lf=Vv(["you play first"]))),$localize(Ff||(Ff=Vv(["the first player is selected randomly"]))),$localize(Bf||(Bf=Vv(["One moment..."]))),["proposalSent",""],$localize(Uf||(Uf=Vv(["",":INTERPOLATION: is configuring the game."])),"\ufffd0\ufffd"),$localize(Vf||(Vf=Vv(["",":INTERPOLATION: has proposed a configuration to ",":INTERPOLATION_1:."])),"\ufffd0\ufffd","\ufffd1\ufffd")]},template:function(e,t){1&e&&lb(0,Kpe,4,3,"div",0),2&e&&db("ngIf",t.viewInfo)},directives:[UT,Zx,gx,eA,DT,UI,Jx,px,nA,FT],pipes:[Ape],encapsulation:2});var Xpe=function(){var e=function(){function e(){sp(this,e),this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new yP,this.addTimeToOpponent=new yP,this.cssClasses=e.SAFE_TIME}return cp(e,[{key:"ngOnInit",value:function(){sB(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}},{key:"setDuration",value:function(t){if(sB(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}},{key:"changeDuration",value:function(e){var t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}},{key:"displayDuration",value:function(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}},{key:"start",value:function(){if(sB(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}},{key:"resume",value:function(){var t=this;if(sB(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();var n=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(function(){t.onEndReached()},n),this.countSeconds()}},{key:"onEndReached",value:function(){sB(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}},{key:"countSeconds",value:function(){var e=this;this.timeoutHandleSec=window.setTimeout(function(){e.updateShownTime()},1e3)}},{key:"isIdle",value:function(){return!1===this.started||this.isPaused}},{key:"pause",value:function(){if(sB(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}},{key:"stop",value:function(){if(sB(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}},{key:"isStarted",value:function(){return this.started}},{key:"getTimeClass",value:function(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}},{key:"updateShownTime",value:function(){var e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}},{key:"clearTimeouts",value:function(){sB(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}},{key:"addTime",value:function(){this.addTimeToOpponent.emit()}},{key:"ngOnDestroy",value:function(){this.clearTimeouts()}}]),e}();return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=oy({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){return[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],$localize(zf||(zf=Vv(["Add ",":INTERPOLATION:"])),"\ufffd0\ufffd")]},template:function(e,t){1&e&&(pb(0,"div",0),pb(1,"p",1),Bb(2),fP(3,"number"),gb(),lb(4,Qpe,2,1,"button",2),gb()),2&e&&(db("ngClass",t.getTimeClass()),Rw(2),zb("",t.displayedMinute,":",function(e,t,n,r){var i=Yy(),a=Vy(i,23);return pP(i,vP(i,23)?hP(i,om(),4,a.transform,n,r,a):a.transform(n,r))}(0,0,t.displayedSec,"2.0-0"),""),Rw(2),db("ngIf",t.canAddTime))},directives:[DT,UT],pipes:[HT],encapsulation:2}),e}(),ege=["partCreation"],tge=["chatComponent"],nge=["chronoZeroGlobal"],rge=["chronoOneGlobal"],ige=["chronoZeroTurn"],age=["chronoOneTurn"];function oge(e,t){if(1&e){var n=_b();pb(0,"app-part-creation",5,6),bb("gameStartNotification",function(e){return Jy(n),Pb().startGame(e)}),gb()}2&e&&db("partId",Pb().currentPartId)}function sge(e,t){1&e&&(mb(0),WE(1,40),kb())}function uge(e,t){if(1&e&&(mb(0),WE(1,41),kb()),2&e){var n=Pb(4);Rw(1),jE(n.currentPlayer),ZE(1)}}function cge(e,t){if(1&e&&(pb(0,"p",37),lb(1,sge,2,0,"ng-container",38),lb(2,uge,2,1,"ng-template",null,39,NP),gb()),2&e){var n=hb(3),r=Pb(3);Rw(1),db("ngIf",r.currentPlayer===r.getPlayerName())("ngIfElse",n)}}function lge(e,t){if(1&e&&(pb(0,"div",33),pb(1,"p",34),WE(2,35),gb(),lb(3,cge,4,2,"p",36),gb()),2&e){var n=Pb(2);Rw(2),jE(n.currentPart.getTurn()+1),ZE(2),Rw(1),db("ngIf",!1===n.endGame)}}function hge(e,t){if(1&e&&(pb(0,"p",42),Bb(1),gb()),2&e){var n=Pb(2);db("ngClass",n.getPlayerNameClass(0)),Rw(1),Ub(n.players[0].get())}}function fge(e,t){if(1&e&&(pb(0,"p",43),WE(1,44),gb()),2&e){var n=Pb(2);Rw(1),jE(n.gameComponent.scores.get()[0]),ZE(1)}}function dge(e,t){if(1&e&&(pb(0,"p",45),Bb(1),gb()),2&e){var n=Pb(2);db("ngClass",n.getPlayerNameClass(1)),Rw(1),Ub(n.players[1].get())}}function vge(e,t){if(1&e&&(pb(0,"p",46),WE(1,47),gb()),2&e){var n=Pb(2);Rw(1),jE(n.gameComponent.scores.get()[1]),ZE(1)}}function pge(e,t){if(1&e){var n=_b();pb(0,"button",56),bb("click",function(){return Jy(n),Pb(3).resign()}),WE(1,57),gb()}}function gge(e,t){if(1&e){var n=_b();pb(0,"button",58),bb("click",function(){return Jy(n),Pb(3).proposeDraw()}),WE(1,59),gb()}}function yge(e,t){if(1&e){var n=_b();pb(0,"button",60),bb("click",function(){return Jy(n),Pb(3).acceptDraw()}),WE(1,61),gb()}}function mge(e,t){if(1&e){var n=_b();pb(0,"button",62),bb("click",function(){return Jy(n),Pb(3).refuseDraw()}),WE(1,63),gb()}}function kge(e,t){if(1&e){var n=_b();pb(0,"button",64),bb("click",function(){return Jy(n),Pb(3).gameComponent.pass()}),WE(1,65),gb()}}function _ge(e,t){if(1&e){var n=_b();pb(0,"button",66),bb("click",function(){return Jy(n),Pb(3).acceptTakeBack()}),WE(1,67),gb()}}function wge(e,t){if(1&e){var n=_b();pb(0,"button",68),bb("click",function(){return Jy(n),Pb(3).refuseTakeBack()}),WE(1,69),gb()}}function Cge(e,t){if(1&e){var n=_b();pb(0,"button",70),bb("click",function(){return Jy(n),Pb(3).askTakeBack()}),WE(1,71),gb()}}function bge(e,t){if(1&e&&(mb(0),lb(1,pge,2,0,"button",48),lb(2,gge,2,0,"button",49),lb(3,yge,2,0,"button",50),lb(4,mge,2,0,"button",51),lb(5,kge,2,0,"button",52),lb(6,_ge,2,0,"button",53),lb(7,wge,2,0,"button",54),lb(8,Cge,2,0,"button",55),kb()),2&e){var n=Pb(2);Rw(1),db("ngIf",n.canResign()),Rw(1),db("ngIf",n.canProposeDraw()),Rw(1),db("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),Rw(1),db("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),Rw(1),db("ngIf",!1===n.endGame&&n.isPlaying()&&n.gameComponent.canPass&&n.currentPlayer===n.getPlayerName()),Rw(1),db("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),Rw(1),db("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),Rw(1),db("ngIf",!1===n.endGame&&!1===n.isOpponentWaitingForTakeBackResponse()&&n.canAskTakeBack())}}function Ege(e,t){1&e&&(pb(0,"div"),pb(1,"p",73),WE(2,74),gb(),gb())}function Sge(e,t){1&e&&(pb(0,"p",78),WE(1,79),gb())}function Pge(e,t){1&e&&(pb(0,"p",80),WE(1,81),gb())}function Oge(e,t){1&e&&(pb(0,"p",82),WE(1,83),gb())}function Tge(e,t){if(1&e&&(pb(0,"div"),lb(1,Sge,2,0,"p",75),lb(2,Pge,2,0,"p",76),lb(3,Oge,2,0,"p",77),gb()),2&e){var n=Pb(3);Rw(1),db("ngIf",n.currentPart.getDrawAccepter()===n.getPlayerName()),Rw(1),db("ngIf",n.currentPart.getDrawAccepter()!==n.getPlayerName()&&n.isPlaying()),Rw(1),db("ngIf",!1===n.isPlaying())}}function Ige(e,t){1&e&&(pb(0,"p",86),WE(1,87),gb())}function xge(e,t){1&e&&(pb(0,"p",88),WE(1,89),gb())}function Age(e,t){if(1&e&&(pb(0,"p",88),WE(1,90),gb()),2&e){var n=Pb(4);Rw(1),jE(n.currentPart.getWinner().get()),ZE(1)}}function Rge(e,t){if(1&e&&(pb(0,"div"),lb(1,Ige,2,0,"p",84),lb(2,xge,2,0,"p",85),lb(3,Age,2,1,"p",85),gb()),2&e){var n=Pb(3);Rw(1),db("ngIf",n.currentPart.getWinner().get()===n.getPlayerName()),Rw(1),db("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Rw(1),db("ngIf",!1===n.isPlaying())}}function Nge(e,t){if(1&e&&(pb(0,"p",86),WE(1,91),gb()),2&e){var n=Pb(4);Rw(1),jE(n.currentPart.getLoser().get()),ZE(1)}}function Mge(e,t){1&e&&(pb(0,"p",88),WE(1,92),gb())}function Dge(e,t){if(1&e&&(pb(0,"p",88),WE(1,93),gb()),2&e){var n=Pb(4);Rw(1),jE(n.currentPart.getLoser().get()),ZE(1)}}function Lge(e,t){if(1&e&&(pb(0,"div"),lb(1,Nge,2,1,"p",84),lb(2,Mge,2,0,"p",85),lb(3,Dge,2,1,"p",85),gb()),2&e){var n=Pb(3);Rw(1),db("ngIf",n.currentPart.getWinner().get()===n.getPlayerName()),Rw(1),db("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Rw(1),db("ngIf",!1===n.isPlaying())}}function Fge(e,t){1&e&&(pb(0,"p",95),WE(1,96),gb())}function Bge(e,t){if(1&e&&(pb(0,"p",95),WE(1,97),gb()),2&e){var n=Pb(4);Rw(1),jE(n.currentPart.getLoser().get()),ZE(1)}}function Uge(e,t){if(1&e&&(pb(0,"div"),lb(1,Fge,2,0,"p",94),lb(2,Bge,2,1,"p",94),gb()),2&e){var n=Pb(3);Rw(1),db("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Rw(1),db("ngIf",!1===n.isPlaying()||n.currentPart.getWinner().get()===n.getPlayerName())}}function Vge(e,t){if(1&e&&(pb(0,"div",72),yb(1,"hr"),lb(2,Ege,3,0,"div",26),lb(3,Tge,4,3,"div",26),lb(4,Rge,4,3,"div",26),lb(5,Lge,4,3,"div",26),lb(6,Uge,3,2,"div",26),gb()),2&e){var n=Pb(2);Rw(2),db("ngIf",n.currentPart.isHardDraw()),Rw(1),db("ngIf",n.currentPart.isAgreedDraw()),Rw(1),db("ngIf",n.currentPart.isWin()),Rw(1),db("ngIf",n.currentPart.isTimeout()),Rw(1),db("ngIf",n.currentPart.isResign())}}function zge(e,t){1&e&&(pb(0,"button",98),WE(1,99),gb())}function Hge(e,t){if(1&e){var n=_b();pb(0,"button",100),bb("click",function(){return Jy(n),Pb(2).proposeRematch()}),WE(1,101),gb()}}function Gge(e,t){if(1&e){var n=_b();pb(0,"button",102),bb("click",function(){return Jy(n),Pb(2).acceptRematch()}),WE(1,103),gb()}}function qge(e,t){if(1&e){var n=_b();pb(0,"div",7),pb(1,"div",8),pb(2,"div",9),lb(3,lge,4,2,"div",10),pb(4,"div",11),lb(5,hge,2,2,"p",12),lb(6,fge,2,1,"p",13),pb(7,"app-count-down",14,15),bb("outOfTimeAction",function(){return Jy(n),Pb().reachedOutOfTime(0)})("addTimeToOpponent",function(){return Jy(n),Pb().addGlobalTime()}),gb(),pb(9,"app-count-down",16,17),bb("outOfTimeAction",function(){return Jy(n),Pb().reachedOutOfTime(0)})("addTimeToOpponent",function(){return Jy(n),Pb().addTurnTime()}),gb(),gb(),pb(11,"p",18),WE(12,19),gb(),pb(13,"div",11),lb(14,dge,2,2,"p",20),lb(15,vge,2,1,"p",21),pb(16,"app-count-down",22,23),bb("outOfTimeAction",function(){return Jy(n),Pb().reachedOutOfTime(1)})("addTimeToOpponent",function(){return Jy(n),Pb().addGlobalTime()}),gb(),pb(18,"app-count-down",24,25),bb("outOfTimeAction",function(){return Jy(n),Pb().reachedOutOfTime(1)})("addTimeToOpponent",function(){return Jy(n),Pb().addTurnTime()}),gb(),gb(),yb(20,"hr"),lb(21,bge,9,8,"ng-container",26),lb(22,Vge,7,5,"div",27),lb(23,zge,2,0,"button",28),lb(24,Hge,2,0,"button",29),lb(25,Gge,2,0,"button",30),gb(),gb(),pb(26,"div",31),pb(27,"div",32),yb(28,"app-game-includer"),gb(),gb(),gb()}if(2&e){var r=Pb();Rw(3),db("ngIf",r.currentPart),Rw(2),db("ngIf",r.players[0].isPresent()),Rw(1),db("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),Rw(1),db("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",1===r.observerRole&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),Rw(2),db("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",1===r.observerRole&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),Rw(5),db("ngIf",r.players[1].isPresent()),Rw(1),db("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),Rw(1),db("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",0===r.observerRole&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),Rw(2),db("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",0===r.observerRole&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),Rw(3),db("ngIf",r.isPlaying()),Rw(1),db("ngIf",r.endGame),Rw(1),db("ngIf",r.endGame),Rw(1),db("ngIf",r.endGame&&r.isPlaying()&&!1===r.rematchProposed),Rw(1),db("ngIf",r.endGame&&r.isPlaying()&&r.rematchProposed&&r.opponentProposedRematch),Rw(1),db("ngClass",r.getBoardHighlight())}}var $ge=function(){var e=cp(function e(){sp(this,e)});return e.NO_MATCHING_PART=function(){return $localize(Hf||(Hf=Vv(["The game you tried to join does not exist."])))},e}(),Wge=cp(function e(t){sp(this,e),this.value=t});Wge.PRE_START_DOC=new Wge("PRE_START_DOC"),Wge.STARTING_DOC=new Wge("STARTING_DOC"),Wge.DUPLICATE=new Wge("DUPLICATE"),Wge.MOVE_WITHOUT_TIME=new Wge("MOVE_WITHOUT_TIME"),Wge.MOVE=new Wge("MOVE"),Wge.REQUEST=new Wge("REQUEST"),Wge.END_GAME=new Wge("END_GAME"),Wge.END_GAME_WITHOUT_TIME=new Wge("END_GAME_WITHOUT_TIME"),Wge.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Wge("ACCEPT_TAKE_BACK_WITHOUT_TIME");var jge=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s,u){var c;return sp(this,n),(c=t.call(this,e,r,o,i,a)).userService=s,c.gameService=u,c.gameStarted=!1,c.opponent=null,c.rematchProposed=!1,c.opponentProposedRematch=!1,c.hasUserPlayed=[!1,!1],c.msToSubstract=[0,0],c.opponentSubscription=hB.empty(),c.OFFLINE_FONT_COLOR={color:"lightgrey"},c.globalTimeMessage=$localize(Gf||(Gf=Vv(["5 minutes"]))),c.turnTimeMessage=$localize(qf||(qf=Vv(["30 seconds"]))),sB(n.VERBOSE,"OnlineGameWrapperComponent constructed"),c}return cp(n,[{key:"extractPartIdFromURL",value:function(){return oB.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}},{key:"extractGameNameFromURL",value:function(){return oB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}},{key:"isPlaying",value:function(){return this.observerRole===ote.ZERO.value||this.observerRole===ote.ONE.value}},{key:"getPlayer",value:function(){return ote.of(this.observerRole)}},{key:"getPlayerName",value:function(){return oB.getNonNullable(this.authUser.username.get())}},{key:"isPlayer",value:function(e){return this.observerRole===e.value}},{key:"isOpponent",value:function(e){return this.observerRole!==e.value}},{key:"redirectIfPartOrGameIsInvalid",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.extractGameNameFromURL(),!Gve.ALL_GAMES().some(function(e){return e.urlName===n})){t.next=11;break}return t.next=4,e.gameService.getPartValidity(e.currentPartId,n);case 4:if(!t.sent.isFailure()){t.next=9;break}return e.routerEventsSub.unsubscribe(),r=$ge.NO_MATCHING_PART(),t.next=9,e.router.navigate(["/notFound",r],{skipLocationChange:!0});case 9:t.next=15;break;case 11:return e.routerEventsSub.unsubscribe(),i=Spe.NO_MATCHING_GAME(n),t.next=15,e.router.navigate(["/notFound",i],{skipLocationChange:!0});case 15:case"end":return t.stop()}},t)}))()}},{key:"setCurrentPartIdOrRedirect",value:function(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}},{key:"ngOnInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSub=e.router.events.subscribe(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n instanceof wR,!t.t0){t.next=4;break}return t.next=4,e.setCurrentPartIdOrRedirect();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.userSub=e.connectedUserService.getUserObs().subscribe(function(t){e.authUser=t}),t.next=5,e.setCurrentPartIdOrRedirect();case 5:case"end":return t.stop()}},t)}))()}},{key:"startGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:sB(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),a6(!1===t.gameStarted,"Should not start already started game"),t.joiner=e,t.gameStarted=!0,window.setTimeout(aB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a6,e.next=3,t.afterGameIncluderViewInit();case 3:e.t1=e.sent,(0,e.t0)(e.t1,"Game should be created successfully, otherwise part-creation would have redirected"),t.startPart();case 6:case"end":return e.stop()}},e)})),1);case 1:case"end":return r.stop()}},r)}))()}},{key:"startPart",value:function(){var e,t=this;sB(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.gameService.startObserving(this.currentPartId,(e=aB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a6(n.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.next=3,t.onCurrentPartUpdate(n.get());case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"onCurrentPartUpdate",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new s6(t.currentPartId,e),sB(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:t.currentPart,then:e.data,before_part_turn:i.data.turn,before_state_turn:t.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),a=t.getUpdateType(i),o=e.turn,sB(n.VERBOSE,a===Wge.REQUEST?"UpdateType: Request("+oB.getNonNullable(i.data.request).code+") ("+o+")":"UpdateType: "+a.value+"("+o+")"),s=t.currentPart,r.t0=(t.currentPart=i,a),r.next=r.t0===Wge.REQUEST?8:r.t0===Wge.ACCEPT_TAKE_BACK_WITHOUT_TIME?11:r.t0===Wge.DUPLICATE?12:r.t0===Wge.END_GAME_WITHOUT_TIME?13:r.t0===Wge.END_GAME?14:r.t0===Wge.MOVE_WITHOUT_TIME?15:r.t0===Wge.MOVE?16:r.t0===Wge.PRE_START_DOC?17:19;break;case 8:return r.next=10,t.onRequest(oB.getNonNullable(i.data.request),s);case 10:return r.abrupt("return",r.sent);case 11:return r.abrupt("return",void(t.currentPart=s));case 12:return r.abrupt("return");case 13:return r.abrupt("return",void(t.currentPart=s));case 14:return r.abrupt("return",t.applyEndGame());case 15:return r.abrupt("return",void(t.currentPart=s));case 16:return r.abrupt("return",(t.msToSubstract=t.getLastUpdateTime(s,i,a),t.doNewMoves(i)));case 17:return u=null==t.currentPart||null!=t.currentPart.data.beginning,r.abrupt("return",void a6(null==s||null==s.data.beginning||u,"old part had no beginning time or new part has, we did not expect this!"));case 19:return r.abrupt("return",(a6(a===Wge.STARTING_DOC,"Unexpected update type "+a),t.setChronos(),t.setPlayersDatas(i),t.startCountDownFor(ote.ZERO)));case 20:case"end":return r.stop()}},r)}))()}},{key:"getUpdateType",value:function(e){var t=Ope.from(null!=this.currentPart?this.currentPart.data:null,e.data);sB(n.VERBOSE,{diff:t});var r=t.countChanges();if(0===r)return Wge.DUPLICATE;if(e.data.request){var i=null!=t.removed.lastUpdateTime;return"TakeBackAccepted"===e.data.request.code&&i?Wge.ACCEPT_TAKE_BACK_WITHOUT_TIME:Wge.REQUEST}if(this.isMove(t,r))return 1===e.data.turn?null==e.data.lastUpdateTime?Wge.MOVE_WITHOUT_TIME:Wge.MOVE:null==t.modified.lastUpdateTime?Wge.MOVE_WITHOUT_TIME:Wge.MOVE;if(null==e.data.beginning)return Wge.PRE_START_DOC;if(e.data.result!==o6.UNACHIEVED.value){var a=null==t.modified.lastUpdateTime;return null!=t.modified.turn&&a?Wge.END_GAME_WITHOUT_TIME:Wge.END_GAME}return a6(null!=e.data.beginning&&0===e.data.listMoves.length,"Unexpected update: "+JSON.stringify(t)),Wge.STARTING_DOC}},{key:"isMove",value:function(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+3}return!1}},{key:"getLastUpdateTime",value:function(e,t,n){var r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);a6(null!=r,"TODO: OLD_TIME WAS NULL, UNDO COMMENT AND TEST!"),a6(null!=i,"TODO UPDATE_TIME WAS NULL, UNDO COMMENT AND TEST!");var a=ote.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(oB.getNonNullable(r),oB.getNonNullable(i),n,a)}},{key:"getMoreRecentTime",value:function(e){var t;return null!==(t=e.data.lastUpdateTime)&&void 0!==t?t:e.data.beginning}},{key:"getTimeUsedForLastTurn",value:function(e,t,n,r){var i=Ipe(e,t),a=[0,0];return a[r.value]=i,a}},{key:"setChronos",value:function(){sB(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.joiner.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.joiner.maximalMoveDuration)}},{key:"didUserPlay",value:function(e){return this.hasUserPlayed[e.value]}},{key:"doNewMoves",value:function(e){this.switchPlayer();for(var t=lte.copyImmutableArray(e.data.listMoves),n=this.gameComponent.rules;n.node.gameState.turn<t.length;){var r=n.node.gameState.turn,i=this.gameComponent.encoder.decode(t[r]),a=n.isLegal(i,n.node.gameState),o="We received an incorrect db move: "+i.toString()+" in "+t+" at turn "+r+'because "'+a.getReasonOr("")+'"';a6(a.isSuccess(),o),n.choose(i)}this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get(),this.gameComponent.updateBoard()}},{key:"switchPlayer",value:function(){sB(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");var e=ote.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get();var t=e.getOpponent();this.didUserPlay(t)&&this.pauseCountDownsFor(t),this.didUserPlay(e)?(sB(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(e)):this.startCountDownFor(e)}},{key:"resetChronoFor",value:function(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}},{key:"applyEndGame",value:function(){var e=this.currentPart,t=ote.fromTurn(e.data.turn);this.endGame=!0,[o6.VICTORY,o6.HARD_DRAW].some(function(t){return t.value===e.data.result})?this.doNewMoves(this.currentPart):(a6(!0===[o6.RESIGN,o6.TIMEOUT,o6.HARD_DRAW,o6.AGREED_DRAW_BY_ZERO,o6.AGREED_DRAW_BY_ONE].some(function(t){return t.value===e.data.result}),"Unknown type of end game ("+e.data.result+")"),sB(n.VERBOSE,"endGame est true et winner est "+e.getWinner())),this.stopCountdownsFor(t)}},{key:"notifyDraw",value:function(e,t){this.endGame=!0;var n=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,n,e,[0,0],t,!0)}},{key:"notifyTimeoutVictory",value:function(e,t,n,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.endGame=!0,o=i.currentPart.setWinnerAndLoser(e,r),i.currentPart=o,a.next=5,i.gameService.notifyTimeout(i.currentPartId,t,n,e,r);case 5:case"end":return a.stop()}},a)}))()}},{key:"notifyVictory",value:function(e,t){sB(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");var r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);r===Dre.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(a6(r===Dre.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0;var i=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,i,e,[0,0],t,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}},{key:"canAskTakeBack",value:function(){return a6(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.observerRole||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.currentPart.data.request.data.player===this.getPlayer().getOpponent().value)&&this.getTakeBackRequester()===ate.NONE}},{key:"isOpponentWaitingForTakeBackResponse",value:function(){var e=this.getTakeBackRequester();return!!e.isPlayer()&&this.isOpponent(e)}},{key:"getTakeBackRequester",value:function(){if(null==this.currentPart)return ate.NONE;var e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?ste.getPlayer(e):ate.NONE}},{key:"canProposeDraw",value:function(){return a6(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&ste.getPlayer(this.currentPart.data.request)===this.getPlayer().getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===ate.NONE}},{key:"isOpponentWaitingForDrawResponse",value:function(){var e=this.getDrawRequester();return e!==ate.NONE&&this.isOpponent(e)}},{key:"getDrawRequester",value:function(){if(null==this.currentPart)return ate.NONE;var e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?ste.getPlayer(e):ate.NONE}},{key:"onRequest",value:function(e,t){var r=this;return aB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=(sB(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:t}),e.code),i.next="TakeBackAsked"===i.t0||"TakeBackRefused"===i.t0?3:"TakeBackAccepted"===i.t0?4:"RematchProposed"===i.t0?6:"RematchAccepted"===i.t0?10:"DrawProposed"===i.t0||"DrawRefused"===i.t0?15:"AddTurnTime"===i.t0?16:"AddGlobalTime"===i.t0?19:22;break;case 3:return i.abrupt("break",25);case 4:return r.takeBackTo(r.currentPart.data.turn),i.abrupt("break",25);case 6:return r.rematchProposed=!0,a=ste.getPlayer(e).getOpponent(),r.isPlayer(a)&&(sB(n.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0),i.abrupt("break",25);case 10:return i.next=12,r.router.navigate(["/nextGameLoading"]);case 12:return i.next=14,r.router.navigate(["/play",ste.getTypeGame(e),ste.getPartId(e)]);case 14:case 15:return i.abrupt("break",25);case 16:return 3e4,o=ote.of(e.data.player),r.addTurnTimeTo(o,3e4),i.abrupt("break",25);case 19:return 3e5,s=ote.of(e.data.player),r.addGlobalTimeTo(s,3e5),i.abrupt("break",25);case 22:return oB.expectToBe(e.code,"DrawAccepted","Unknown RequestType : "+e.code+" for "+JSON.stringify(e)),i.next=25,r.acceptDraw();case 25:case"end":return i.stop()}},i)}))()}},{key:"takeBackTo",value:function(e){if(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.rules.node.gameState.turn===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();var t=ote.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}},{key:"setPlayersDatas",value:function(e){var t=this;sB(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),this.players=[hB.of(e.data.playerZero),hB.ofNullable(e.data.playerOne)],a6(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[e.data.turn%2].get();var r=hB.empty();if(this.players[0].equalsValue(this.getPlayerName())?(this.observerRole=ote.ZERO.value,r=this.players[1]):this.players[1].equalsValue(this.getPlayerName())?(this.observerRole=ote.ONE.value,r=this.players[0]):this.observerRole=ate.NONE.value,r.isPresent()){var i=function(e){t.opponent=e[0].data},a=new f6(i,i,function(e){throw new Error("OnlineGameWrapper: Opponent was deleted, what sorcery is this: "+JSON.stringify(e))});this.opponentSubscription=hB.of(this.userService.observeUserByUsername(r.get(),a))}}},{key:"onLegalUserMove",value:function(e,t){var r=this;return aB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(sB(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),r.isOpponentWaitingForTakeBackResponse()){i.next=2;break}return i.abrupt("return",r.updateDBBoard(e,r.msToSubstract,t));case 2:r.gameComponent.message("You must answer to take back request");case 3:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(e,t,r){var i=this;return aB(regeneratorRuntime.mark(function a(){var o,s,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(o=i.gameComponent.encoder.encodeMove(e),sB(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+r+")"),i.gameComponent.rules.choose(e),!(s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node)).isEndGame){a.next=5;break}return a.abrupt("return",s===Dre.DRAW?i.notifyDraw(o,r):i.notifyVictory(o,r));case 5:return u=i.getPlayer(),a.abrupt("return",i.gameService.updateDBBoard(i.currentPartId,u,o,t,r));case 7:case"end":return a.stop()}},a)}))()}},{key:"resign",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getLastIndex(),r=e.getPlayer(),i=e.players[e.observerRole%2].get(),a=e.players[(e.observerRole+1)%2].get(),t.next=3,e.gameService.resign(e.currentPartId,n,r,a,i);case 3:case"end":return t.stop()}},t)}))()}},{key:"getLastIndex",value:function(){return this.currentPart.data.lastUpdate.index}},{key:"reachedOutOfTime",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(sB(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),i=t.getLastIndex(),a=t.getPlayer(),t.stopCountdownsFor(ote.of(e)),o=oB.getNonNullable(t.opponent),e!==t.observerRole){r.next=10;break}return s=oB.getNonNullable(o.username),r.next=8,t.notifyTimeoutVictory(s,a,i,t.getPlayerName());case 8:r.next=15;break;case 10:if(a6(!1===t.endGame,"time might be better handled in the future"),!t.opponentIsOffline()){r.next=15;break}return u=oB.getNonNullable(o.username),r.next=14,t.notifyTimeoutVictory(t.getPlayerName(),a,e,u);case 14:t.endGame=!0;case 15:case"end":return r.stop()}},r)}))()}},{key:"acceptRematch",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a6(e.isPlaying(),"Non playing should not call acceptRematch"),n=new s6(e.currentPartId,e.currentPart.data),t.next=4,e.gameService.acceptRematch(n,e.getLastIndex(),e.getPlayer());case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}},t)}))()}},{key:"proposeRematch",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a6(e.isPlaying(),"Non playing should not call proposeRematch"),t.next=3,e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.getPlayer());case 3:return t.abrupt("return",!0);case 4:case"end":return t.stop()}},t)}))()}},{key:"proposeDraw",value:function(){return this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"acceptDraw",value:function(){return this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"refuseDraw",value:function(){return this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"askTakeBack",value:function(){return this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"acceptTakeBack",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getPlayer(),t.next=3,e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,n,e.msToSubstract);case 3:e.msToSubstract=[0,0];case 4:case"end":return t.stop()}},t)}))()}},{key:"refuseTakeBack",value:function(){return this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"startCountDownFor",value:function(e){sB(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[e.value]=!0,e===ote.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}},{key:"resumeCountDownFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];sB(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===ote.ZERO?(this.chronoZeroGlobal.changeDuration(oB.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),t=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(oB.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),t=this.chronoOneTurn),r?(t.setDuration(1e3*this.joiner.maximalMoveDuration),t.start()):t.resume()}},{key:"pauseCountDownsFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];sB(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart.data.turn+")"),e===ote.ZERO?(this.chronoZeroGlobal.pause(),t=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),t=this.chronoOneTurn),r?t.stop():t.pause()}},{key:"stopCountdownsFor",value:function(e){sB(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===ote.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}},{key:"getPlayerNameClass",value:function(e){return this.opponentIsOffline()?"has-text-grey-light":0===e?"has-text-white":"has-text-black"}},{key:"opponentIsOffline",value:function(){return!1}},{key:"canResign",value:function(){return a6(this.isPlaying(),"Non playing should not call canResign"),!(!0===this.endGame||null==this.opponent)}},{key:"addGlobalTime",value:function(){var e=this.getPlayer(),t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}},{key:"addTurnTime",value:function(){var e=this.getPlayer();return this.gameService.addTurnTime(e,this.getLastIndex(),this.currentPartId)}},{key:"addTurnTimeTo",value:function(e,t){var n=ote.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===ote.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}},{key:"addGlobalTimeTo",value:function(e,t){e===ote.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}},{key:"ngOnDestroy",value:function(){this.routerEventsSub.unsubscribe(),this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.isPresent()&&this.opponentSubscription.get()(),this.gameService.stopObserving())}}]),n}(Ppe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(aS),fb(ON),fb(ZM),fb(r6),fb(Jee),fb(p6),fb(dte))},e.\u0275cmp=oy({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){var n;(1&e&&(xP(ege,5),xP(tge,5),xP(nge,5),xP(rge,5),xP(ige,5),xP(age,5)),2&e)&&(IP(n=AP())&&(t.partCreation=n.first),IP(n=AP())&&(t.chatComponent=n.first),IP(n=AP())&&(t.chronoZeroGlobal=n.first),IP(n=AP())&&(t.chronoOneGlobal=n.first),IP(n=AP())&&(t.chronoZeroTurn=n.first),IP(n=AP())&&(t.chronoOneTurn=n.first))},features:[jC],decls:5,vars:4,consts:function(){return[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],$localize($f||($f=Vv(["vs."]))),["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Wf||(Wf=Vv(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],$localize(jf||(jf=Vv(["It is your turn."]))),$localize(Zf||(Zf=Vv(["It is ",":INTERPOLATION:'s turn."])),"\ufffd0\ufffd"),["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],$localize(Yf||(Yf=Vv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],$localize(Kf||(Kf=Vv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Jf||(Jf=Vv(["Resign"]))),["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Qf||(Qf=Vv(["Propose a draw"]))),["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Xf||(Xf=Vv(["Accept draw"]))),["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(ed||(ed=Vv(["Reject draw"]))),["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(td||(td=Vv(["Pass a turn"]))),["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(nd||(nd=Vv(["Accept take back"]))),["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(rd||(rd=Vv(["Reject take back"]))),["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],$localize(id||(id=Vv(["Ask to take back one move"]))),["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$localize(ad||(ad=Vv(["Draw"]))),["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],$localize(od||(od=Vv(["You agreed to draw."]))),["id","yourOpponentAgreedToDrawIndicator",1,"title"],$localize(sd||(sd=Vv(["Your draw proposal has been accepted."]))),["id","playersAgreedToDraw",1,"title"],$localize(ud||(ud=Vv(["Players agreed to draw."]))),["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],$localize(cd||(cd=Vv(["You won."]))),[1,"title"],$localize(ld||(ld=Vv(["You lost."]))),$localize(hd||(hd=Vv(["",":INTERPOLATION: won."])),"\ufffd0\ufffd"),$localize(fd||(fd=Vv(["",":INTERPOLATION: has reached their time limit. You won."])),"\ufffd0\ufffd"),$localize(dd||(dd=Vv(["You reached your time limit."]))),$localize(vd||(vd=Vv(["",":INTERPOLATION: has reached their time limit."])),"\ufffd0\ufffd"),["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],$localize(pd||(pd=Vv(["You resigned."]))),$localize(gd||(gd=Vv(["",":INTERPOLATION: has resigned."])),"\ufffd0\ufffd"),["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],$localize(yd||(yd=Vv(["Go back to the game list"]))),["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(md||(md=Vv(["Propose to play again"]))),["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],$localize(kd||(kd=Vv(["Accept to play again"])))]},template:function(e,t){1&e&&(lb(0,oge,2,1,"app-part-creation",0),lb(1,qge,29,27,"div",1),pb(2,"div",2),pb(3,"div",3),yb(4,"app-chat",4),gb(),gb()),2&e&&(db("ngIf",!1===t.gameStarted),Rw(1),db("ngIf",t.gameStarted),Rw(3),db("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[UT,fpe,Jpe,Xpe,DT,Epe,KM],encapsulation:2}),e}();function Zge(e,t){if(1&e&&(pb(0,"option",25),Bb(1),gb()),2&e){var n=t.$implicit;db("value",n.name),Rw(1),Ub(n.name)}}function Yge(e,t){if(1&e&&(pb(0,"option",25),WE(1,29),gb()),2&e){var n=t.$implicit;db("value",n),Rw(1),jE(n),ZE(1)}}var Kge=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function Jge(e,t){if(1&e){var n=_b();pb(0,"select",26),bb("ngModelChange",function(e){return Jy(n),Pb(2).aiDepths[0]=e})("change",function(){return Jy(n),Pb(2).updatePlayer(0)}),pb(1,"option",27),WE(2,28),gb(),lb(3,Yge,2,2,"option",16),gb()}2&e&&(db("ngModel",Pb(2).aiDepths[0]),Rw(3),db("ngForOf",oP(2,Kge)))}function Qge(e,t){if(1&e&&(pb(0,"p",30),WE(1,31),gb()),2&e){var n=Pb(2);Rw(1),jE(n.gameComponent.scores.get()[0]),ZE(1)}}function Xge(e,t){if(1&e&&(pb(0,"option",25),Bb(1),gb()),2&e){var n=t.$implicit;db("value",n.name),Rw(1),Ub(n.name)}}function eye(e,t){if(1&e&&(pb(0,"option",25),WE(1,34),gb()),2&e){var n=t.$implicit;db("value",n),Rw(1),jE(n),ZE(1)}}function tye(e,t){if(1&e){var n=_b();pb(0,"select",32),bb("ngModelChange",function(e){return Jy(n),Pb(2).aiDepths[1]=e})("change",function(){return Jy(n),Pb(2).updatePlayer(1)}),pb(1,"option",27),WE(2,33),gb(),lb(3,eye,2,2,"option",16),gb()}2&e&&(db("ngModel",Pb(2).aiDepths[1]),Rw(3),db("ngForOf",oP(2,Kge)))}function nye(e,t){if(1&e&&(pb(0,"p",35),WE(1,36),gb()),2&e){var n=Pb(2);Rw(1),jE(n.gameComponent.scores.get()[1]),ZE(1)}}function rye(e,t){if(1&e&&(pb(0,"h4"),WE(1,40),gb()),2&e){var n=Pb(3);Rw(1),jE(n.winner.get()),ZE(1)}}function iye(e,t){1&e&&(pb(0,"h4",41),WE(1,42),gb())}function aye(e,t){if(1&e&&(pb(0,"div",37),lb(1,rye,2,1,"h4",38),lb(2,iye,2,0,"h4",39),gb()),2&e){var n=Pb(2);Rw(1),db("ngIf",n.winner.isPresent()),Rw(1),db("ngIf",n.winner.isAbsent())}}function oye(e,t){if(1&e){var n=_b();pb(0,"div",6),pb(1,"div",7),pb(2,"p",8),WE(3,9),gb(),gb(),pb(4,"div",10),pb(5,"div",11),pb(6,"div",12),pb(7,"select",13),bb("change",function(){return Jy(n),Pb().updatePlayer(0)})("ngModelChange",function(e){return Jy(n),Pb().playerSelection[0]=e}),pb(8,"option",14),WE(9,15),gb(),lb(10,Zge,2,2,"option",16),gb(),gb(),pb(11,"div",12),lb(12,Jge,4,3,"select",17),gb(),lb(13,Qge,2,1,"p",18),gb(),pb(14,"div",19),pb(15,"div",12),pb(16,"select",20),bb("change",function(){return Jy(n),Pb().updatePlayer(1)})("ngModelChange",function(e){return Jy(n),Pb().playerSelection[1]=e}),pb(17,"option",14),WE(18,21),gb(),lb(19,Xge,2,2,"option",16),gb(),gb(),pb(20,"div",12),lb(21,tye,4,3,"select",22),gb(),lb(22,nye,2,1,"p",23),gb(),gb(),lb(23,aye,3,2,"div",24),gb()}if(2&e){var r=Pb();Rw(3),jE(r.gameComponent.rules.node.gameState.turn+1),ZE(3),Rw(4),db("ngModel",r.playerSelection[0]),Rw(3),db("ngForOf",r.gameComponent.availableMinimaxes),Rw(2),db("ngIf",!1===r.players[0].equalsValue("human")),Rw(1),db("ngIf",r.gameComponent.scores.isPresent()),Rw(3),db("ngModel",r.playerSelection[1]),Rw(3),db("ngForOf",r.gameComponent.availableMinimaxes),Rw(2),db("ngIf",!1===r.players[1].equalsValue("human")),Rw(1),db("ngIf",r.gameComponent.scores.isPresent()),Rw(1),db("ngIf",r.endGame)}}function sye(e,t){if(1&e&&(mb(0),Bb(1),yb(2,"br"),kb()),2&e){var n=t.$implicit,r=Pb(3);Rw(1),Vb(" ",n.name+": "+n.getBoardValue(r.gameComponent.rules.node)," ")}}function uye(e,t){if(1&e&&(mb(0),lb(1,sye,3,1,"ng-container",48),Bb(2),yb(3,"br"),Bb(4),yb(5,"br"),kb()),2&e){var n=Pb(2);Rw(1),db("ngForOf",n.gameComponent.availableMinimaxes),Rw(1),Vb(" Created ",n.getCreatedNodes()," nodes."),Rw(2),Vb(" Minimax time: ",n.getMinimaxTime(),"ms.")}}function cye(e,t){if(1&e){var n=_b();pb(0,"button",49),bb("click",function(){return Jy(n),Pb(2).gameComponent.pass()}),WE(1,50),gb()}}function lye(e,t){if(1&e){var n=_b();pb(0,"button",51),bb("click",function(){return Jy(n),Pb(2).takeBack()}),WE(1,52),gb()}}function hye(e,t){if(1&e){var n=_b();pb(0,"div",43),lb(1,uye,6,3,"ng-container",38),lb(2,cye,2,0,"button",44),lb(3,lye,2,0,"button",45),pb(4,"button",46),bb("click",function(){return Jy(n),Pb().restartGame()}),WE(5,47),gb(),gb()}if(2&e){var r=Pb();Rw(1),db("ngIf",r.gameComponent.rules.node.move),Rw(1),db("ngIf",!1===r.endGame&&r.gameComponent.canPass),Rw(1),db("ngIf",r.canTakeBack())}}var fye=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s){var u;return sp(this,n),(u=t.call(this,e,r,i,a,o)).cdr=s,u.aiDepths=["0","0"],u.playerSelection=["human","human"],u.winner=hB.empty(),u.botTimeOut=1e3,u.players=[hB.of(u.playerSelection[0]),hB.of(u.playerSelection[1])],sB(n.VERBOSE,"LocalGameWrapper.constructor"),u}return cp(n,[{key:"getCreatedNodes",value:function(){return Nre.createdNodes}},{key:"getMinimaxTime",value:function(){return Nre.minimaxTime}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.afterGameIncluderViewInit();case 2:if(t.t0=t.sent,!t.t0){t.next=5;break}e.restartGame(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)})),1)}},{key:"updatePlayer",value:function(e){this.players[e]=hB.of(this.playerSelection[e]),this.proposeAIToPlay()}},{key:"onLegalUserMove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:sB(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),t.gameComponent.rules.choose(e),t.updateBoard(),t.proposeAIToPlay();case 1:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.gameComponent.updateBoard();var e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer()&&(this.winner=hB.of($localize(_d||(_d=Vv(["Player ",""])),e.winner.value+1))))}},{key:"proposeAIToPlay",value:function(){var e=this,t=this.getPlayingAI();t.isPresent()&&window.setTimeout(aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.doAIMove(t.get());case 2:case"end":return n.stop()}},n)})),this.botTimeOut)}},{key:"getPlayingAI",value:function(){var e=this;if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return hB.empty();var t=this.gameComponent.rules.node.gameState.turn%2;return"0"===this.aiDepths[t]?hB.empty():hB.ofNullable(this.gameComponent.availableMinimaxes.find(function(n){return e.players[t].equalsValue(n.name)}))}},{key:"doAIMove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a6((r=t.gameComponent.rules).getGameStatus(r.node)===Dre.ONGOING,"IA should not try to play when game is over!"),i=Number.parseInt(t.aiDepths[r.node.gameState.turn%2%2]),a=r.node.findBestMove(i,e,!0),n.abrupt("return",r.choose(a)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),e6.SUCCESS):(t.messageDisplayer.criticalMessage($localize(wd||(wd=Vv(["The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!"])))),i6.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()})));case 4:case"end":return n.stop()}},n)}))()}},{key:"canTakeBack",value:function(){return this.gameComponent.rules.node.gameState.turn>0}},{key:"takeBack",value:function(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}},{key:"isAITurn",value:function(){return this.getPlayingAI().isPresent()}},{key:"restartGame",value:function(){var e=this.gameComponent.rules.stateType.getInitialState();this.gameComponent.rules.node=new Mre(e),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=hB.empty(),this.proposeAIToPlay()}},{key:"getPlayerName",value:function(){return"human"}}]),n}(Ppe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(aS),fb(ON),fb(Jee),fb(ZM),fb(r6),fb(DS))},e.\u0275cmp=oy({type:e,selectors:[["app-local-game-wrapper"]],features:[jC],decls:7,vars:3,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Cd||(Cd=Vv(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],$localize(bd||(bd=Vv(["Human"]))),[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],$localize(Ed||(Ed=Vv(["Human"]))),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],$localize(Sd||(Sd=Vv(["Pick the level"]))),$localize(Pd||(Pd=Vv(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreOne",1,"block"],$localize(Od||(Od=Vv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],$localize(Td||(Td=Vv(["Pick the level"]))),$localize(Id||(Id=Vv(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreZero",1,"block"],$localize(xd||(xd=Vv(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],$localize(Ad||(Ad=Vv(["",":INTERPOLATION: won"])),"\ufffd0\ufffd"),["id","draw"],$localize(Rd||(Rd=Vv(["Draw"]))),[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],$localize(Nd||(Nd=Vv(["Start a new game"]))),[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],$localize(Md||(Md=Vv(["Pass a turn"]))),["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Dd||(Dd=Vv(["Take back move"])))]},template:function(e,t){1&e&&(pb(0,"div",0),pb(1,"div",1),lb(2,oye,24,10,"div",2),lb(3,hye,6,3,"div",3),gb(),pb(4,"div",4),pb(5,"div",5),yb(6,"app-game-includer"),gb(),gb(),gb()),2&e&&(Rw(2),db("ngIf",t.gameComponent),Rw(1),db("ngIf",t.gameComponent),Rw(1),db("ngClass",t.getBoardHighlight()))},directives:[UT,DT,Epe,aA,px,jx,oA,lA,FT],encapsulation:2,changeDetection:0}),e}(),dye=function(){var e=cp(function e(){sp(this,e)});return e.STEP_FINISHED=function(){return $localize(Ld||(Ld=Vv(["Step finished!"])))},e.INFORMATIONAL_STEP=function(){return $localize(Fd||(Fd=Vv(["This step is not expecting any move from your part."])))},e}();function vye(e,t){if(1&e&&(pb(0,"div",20),pb(1,"div",21),WE(2,22),gb(),pb(3,"div",23),Bb(4),gb(),gb()),2&e){var n=Pb();Rw(4),Ub(n.currentReason.get())}}function pye(e,t){if(1&e){var n=_b();pb(0,"button",24),bb("click",function(){return Jy(n),Pb().retry()}),WE(1,25),gb()}}function gye(e,t){1&e&&(mb(0),WE(1,30),kb())}function yye(e,t){1&e&&(mb(0),WE(1,31),kb())}function mye(e,t){if(1&e&&lb(0,yye,2,0,"ng-container",27),2&e){Pb();var n=hb(5),r=Pb();db("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",n)}}function kye(e,t){1&e&&(mb(0),WE(1,32),kb())}function _ye(e,t){if(1&e){var n=_b();pb(0,"button",26),bb("click",function(){return Jy(n),Pb().next()}),lb(1,gye,2,0,"ng-container",27),lb(2,mye,1,2,"ng-template",null,28,NP),lb(4,kye,2,0,"ng-template",null,29,NP),gb()}if(2&e){var r=hb(3),i=Pb();Rw(1),db("ngIf",i.steps[i.stepIndex]&&i.steps[i.stepIndex].isInformation())("ngIfElse",r)}}function wye(e,t){if(1&e){var n=_b();pb(0,"button",33),bb("click",function(){return Jy(n),Pb().start()}),WE(1,34),gb()}}function Cye(e,t){if(1&e){var n=_b();pb(0,"button",35),bb("click",function(){return Jy(n),Pb().playLocally()}),WE(1,36),gb()}}function bye(e,t){if(1&e){var n=_b();pb(0,"button",37),bb("click",function(){return Jy(n),Pb().createGame()}),WE(1,38),gb()}}function Eye(e,t){if(1&e){var n=_b();pb(0,"button",39),bb("click",function(){return Jy(n),Pb().showSolution()}),WE(1,40),gb()}}function Sye(e,t){if(1&e&&(mb(0),pb(1,"option",42),Bb(2),gb(),kb()),2&e){var n=Pb(),r=n.index,i=n.$implicit;Rw(1),Tb("id","step_",r,""),db("value",r),Rw(1),Ub(i.title)}}function Pye(e,t){1&e&&(mb(0),Bb(1,"v "),kb())}function Oye(e,t){1&e&&Bb(0,"x ")}function Tye(e,t){if(1&e&&(pb(0,"option",43),lb(1,Pye,2,0,"ng-container",27),lb(2,Oye,1,0,"ng-template",null,44,NP),pb(4,"span",45),Bb(5),gb(),gb()),2&e){var n=hb(3),r=Pb(),i=r.index,a=r.$implicit,o=Pb();db("value",i),Rw(1),db("ngIf",o.stepFinished[i])("ngIfElse",n),Rw(3),Tb("id","step_",i,""),Rw(1),Ub(a.title)}}function Iye(e,t){if(1&e&&(mb(0),lb(1,Sye,3,3,"ng-container",27),lb(2,Tye,6,5,"ng-template",null,41,NP),kb()),2&e){var n=t.index,r=hb(3),i=Pb();Rw(1),db("ngIf",n===i.stepIndex)("ngIfElse",r)}}var xye=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r,i,a,o,s){var u;return sp(this,n),(u=t.call(this,e,r,s,i,a)).cdr=o,u.connectedUserService=s,u.COMPLETED_TUTORIAL_MESSAGE=$localize(Bd||(Bd=Vv(["Congratulations, you completed the tutorial."]))),u.steps=[],u.successfulSteps=0,u.stepIndex=-1,u.currentMessage="",u.currentReason=hB.empty(),u.moveAttemptMade=!1,u.stepFinished=[],u.tutorialOver=!1,sB(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),u}return cp(n,[{key:"getNumberOfSteps",value:function(){return this.steps.length}},{key:"getCurrentStepTitle",value:function(){return this.steps.length>0?this.steps[this.stepIndex].title:""}},{key:"ngAfterViewInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sB(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),t.next=3,e.afterGameIncluderViewInit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}e.start();case 6:case"end":return t.stop()}},t)}))()}},{key:"start",value:function(){this.startTutorial(this.gameComponent.tutorial)}},{key:"startTutorial",value:function(e){sB(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}},{key:"getCompletionArray",value:function(){return this.steps.map(function(){return!1})}},{key:"changeStep",value:function(e){this.showStep(Number.parseInt(e.target.value,10))}},{key:"showStep",value:function(e){sB(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;var t=this.steps[this.stepIndex];this.currentMessage=t.instruction,this.currentReason=hB.empty(),this.gameComponent.rules.node=new Mre(t.state,hB.empty(),t.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}},{key:"onLegalUserMove",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:sB(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}}),i=t.steps[t.stepIndex],a6(t.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,i.isPredicate()?(a=t.gameComponent.rules.node.gameState,(o=oB.getNonNullable(i.predicate)(e,a)).isSuccess()?t.showStepSuccess(i.getSuccessMessage()):t.currentReason=hB.of(o.getReason())):i.isAnyMove()?(sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(i.getSuccessMessage())):(a6(i.isMove(),"cannot reach here with a click step"),(s=i).acceptedMoves.some(function(t){return t.equals(e)})?(sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(sB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),t.currentReason=hB.of(s.getFailureMessage()))),t.cdr.detectChanges();case 4:case"end":return r.stop()}},r)}))()}},{key:"retry",value:function(){sB(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}},{key:"onUserClick",value:function(e){var t=this;if(sB(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=hB.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return e6.failure(dye.STEP_FINISHED());var r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),oB.getNonNullable(r.acceptedClicks).some(function(t){return t===e})?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),e6.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(function(){t.cdr.detectChanges()},10),e6.SUCCESS):e6.failure(dye.INFORMATIONAL_STEP())}},{key:"onCancelMove",value:function(e){sB(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=hB.of(e)),this.cdr.detectChanges()}},{key:"showStepSuccess",value:function(e){sB(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}},{key:"updateSuccessCount",value:function(){var e,t=0,n=ip(this.stepFinished);try{for(n.s();!(e=n.n()).done;){e.value&&t++}}catch(r){n.e(r)}finally{n.f()}this.successfulSteps=t}},{key:"next",value:function(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{for(var e=(this.stepIndex+1)%this.steps.length;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}},{key:"showSolution",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:sB(n.VERBOSE,"tutorialGameWrapper.showSolution()"),a6((r=e.steps[e.stepIndex]).hasSolution(),"showSolution called on a step with no solution, this should not be reachable"),a=(i=r).getSolution(),e.showStep(e.stepIndex),e.gameComponent.rules.choose(a),e.gameComponent.updateBoard(),e.moveAttemptMade=!0,e.currentMessage=i.getSuccessMessage(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)}))()}},{key:"playLocally",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=oB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/local",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"createGame",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=oB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/play",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"getPlayerName",value:function(){return""}}]),n}(Ppe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(fb(aS),fb(ON),fb(ZM),fb(r6),fb(DS),fb(Jee))},e.\u0275cmp=oy({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[jC],decls:22,vars:15,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(Ud||(Ud=Vv(["Failure"]))),["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],$localize(Vd||(Vd=Vv(["Try again"]))),["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],$localize(zd||(zd=Vv(["Ok"]))),$localize(Hd||(Hd=Vv(["Continue"]))),$localize(Gd||(Gd=Vv(["Skip"]))),["id","restartButton",1,"button",3,"click"],$localize(qd||(qd=Vv(["Try again"]))),["id","playLocallyButton",1,"button",3,"click"],$localize($d||($d=Vv(["Play locally"]))),["id","playOnlineButton",1,"button",3,"click"],$localize(Wd||(Wd=Vv(["Create an online game"]))),["id","showSolutionButton",1,"button",3,"click"],$localize(jd||(jd=Vv(["See solution"]))),["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(pb(0,"div",0),pb(1,"div",1),pb(2,"div",2),yb(3,"progress",3),pb(4,"div",4),pb(5,"p",5),Bb(6),gb(),yb(7,"p",6),gb(),lb(8,vye,5,1,"div",7),pb(9,"div",8),lb(10,pye,2,0,"button",9),lb(11,_ye,6,2,"button",10),lb(12,wye,2,0,"button",11),lb(13,Cye,2,0,"button",12),lb(14,bye,2,0,"button",13),lb(15,Eye,2,0,"button",14),pb(16,"div",15),pb(17,"select",16),bb("change",function(e){return t.changeStep(e)}),lb(18,Iye,4,2,"ng-container",17),gb(),gb(),gb(),gb(),gb(),pb(19,"div",18),pb(20,"div",19),yb(21,"app-game-includer"),gb(),gb(),gb()),2&e&&(Rw(3),ob("value",t.successfulSteps)("max",t.getNumberOfSteps()),Rw(3),Hb("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),Rw(1),db("innerHTML",t.currentMessage,E_),Rw(1),db("ngIf",t.currentReason.isPresent()),Rw(2),db("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),Rw(1),db("ngIf",!1===t.tutorialOver),Rw(1),db("ngIf",t.tutorialOver),Rw(1),db("ngIf",t.tutorialOver),Rw(1),db("ngIf",t.tutorialOver),Rw(1),db("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),Rw(3),db("ngForOf",t.steps),Rw(1),db("ngClass",t.getBoardHighlight()))},directives:[UT,FT,DT,Epe,oA,lA],encapsulation:2,changeDetection:0}),e}();function Aye(e,t){if(1&e&&(pb(0,"div",35),pb(1,"div",36),WE(2,37),gb(),pb(3,"div",38),Bb(4),gb(),gb()),2&e){var n=Pb();Rw(4),Ub(n.errorMessage)}}var Rye=function(){return["/login"]},Nye=function(){var e=function(){function e(t,n){sp(this,e),this.authService=t,this.router=n,this.faEye=_te,this.registrationForm=new Vx({email:new Ux,username:new Ux,password:new Ux})}return cp(e,[{key:"registerWithEmail",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.registrationForm.value.username,r=e.registrationForm.value.email,i=e.registrationForm.value.password,null!=n&&null!=r&&null!=i){t.next=5;break}e.errorMessage=$localize(Zd||(Zd=Vv(["There are missing fields in the registration form, please check that you filled in all fields."]))),t.next=21;break;case 5:return t.next=7,e.authService.doRegister(n,r,i);case 7:if(!(a=t.sent).isSuccess()){t.next=20;break}return t.next=11,e.authService.sendEmailVerification();case 11:if(!(o=t.sent).isSuccess()){t.next=17;break}return t.next=15,e.router.navigate(["/verify-account"]);case 15:t.next=18;break;case 17:e.errorMessage=o.getReason();case 18:t.next=21;break;case 20:e.errorMessage=a.getReason();case 21:case"end":return t.stop()}},t)}))()}},{key:"registerWithGoogle",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.doGoogleLogin();case 2:if(!(n=t.sent).isSuccess()){t.next=8;break}return t.next=6,e.router.navigate(["/verify-account"]);case 6:t.next=9;break;case 8:e.errorMessage=n.getReason();case 9:case"end":return t.stop()}},t)}))()}},{key:"getPasswordHelpClass",value:function(){var e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}},{key:"canRegister",value:function(){var e=this.registrationForm.value.password||"";return!(""===(this.registrationForm.value.email||"")||""===(this.registrationForm.value.username||"")||""===e||e.length<6)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(Jee),fb(ZM))},e.\u0275cmp=oy({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){return[[1,"box"],[1,"title"],$localize(Yd||(Yd=Vv(["Registering"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(Kd||(Kd=Vv(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",$localize(Jd||(Jd=Vv(["Email"]))),"type","email","autofocus","","required","",1,"input"],[1,"help"],$localize(Qd||(Qd=Vv(["A confirmation email will be sent to validate your account."]))),["for","username",1,"label"],$localize(Xd||(Xd=Vv(["Username"]))),["id","username","formControlName","username","name","username","placeholder",$localize(ev||(ev=Vv(["Username"]))),"type","text","required","",1,"input"],["for","password",1,"label"],$localize(tv||(tv=Vv(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",$localize(nv||(nv=Vv(["Password"]))),"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],$localize(rv||(rv=Vv(["The password should be at least 6 characters long"]))),["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(iv||(iv=Vv(["Register"]))),[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(av||(av=Vv(["Register with Google"]))),[1,"help","level-right"],$localize(ov||(ov=Vv(["Have an account?"]))),[3,"routerLink"],$localize(sv||(sv=Vv(["Log in"]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(uv||(uv=Vv(["Registration error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(pb(0,"div",0),pb(1,"p",1),WE(2,2),gb(),pb(3,"form",3),pb(4,"div",4),pb(5,"div",5),pb(6,"label",6),WE(7,7),gb(),gb(),pb(8,"div",8),pb(9,"div",9),pb(10,"div",10),yb(11,"input",11),pb(12,"p",12),WE(13,13),gb(),gb(),gb(),gb(),gb(),pb(14,"div",4),pb(15,"div",5),pb(16,"label",14),WE(17,15),gb(),gb(),pb(18,"div",8),pb(19,"div",9),pb(20,"div",10),yb(21,"input",16),gb(),gb(),gb(),gb(),pb(22,"div",4),pb(23,"div",5),pb(24,"label",17),WE(25,18),gb(),gb(),pb(26,"div",8),pb(27,"div",9),pb(28,"div",19),yb(29,"input",20),pb(30,"span",21),yb(31,"fa-icon",22),gb(),pb(32,"p",23),WE(33,24),gb(),gb(),gb(),gb(),gb(),pb(34,"div",4),yb(35,"div",5),pb(36,"div",8),pb(37,"div",9),pb(38,"div",10),pb(39,"button",25),bb("click",function(){return t.registerWithEmail()}),WE(40,26),gb(),gb(),gb(),gb(),gb(),pb(41,"div",4),yb(42,"div",5),pb(43,"div",27),lb(44,Aye,5,1,"div",28),gb(),gb(),pb(45,"div",4),yb(46,"div",5),pb(47,"div",8),pb(48,"button",29),bb("click",function(){return t.registerWithGoogle()}),WE(49,30),gb(),gb(),gb(),pb(50,"p",31),mb(51),WE(52,32),kb(),Bb(53,"\xa0 "),pb(54,"a",33),WE(55,34),gb(),gb(),gb(),gb()),2&e&&(Rw(3),db("formGroup",t.registrationForm),Rw(28),db("icon",t.faEye),Rw(1),db("ngClass",t.getPasswordHelpClass()),Rw(7),db("disabled",!t.canRegister()),Rw(5),db("ngIf",t.errorMessage),Rw(10),db("routerLink",oP(6,Rye)))},directives:[Zx,gx,eA,UI,px,nA,Yve,fA,$ne,Kve,DT,UT,JM],encapsulation:2}),e}(),Mye=function(){var e=function(){function e(t){sp(this,e),this.router=t}return cp(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"playLocally",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["local/"+e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(ZM))},e.\u0275cmp=oy({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(cv||(cv=Vv(["Play offline"])))]},template:function(e,t){1&e&&(pb(0,"app-pick-game",0),bb("pickGame",function(e){return t.pickGame(e)}),gb(),pb(1,"button",1),bb("click",function(){return t.playLocally()}),WE(2,2),gb()),2&e&&(Rw(1),db("disabled",!t.selectedGame))},directives:[qve],encapsulation:2}),e}(),Dye=function(){var e=function(){function e(t){sp(this,e),this.router=t}return cp(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"launchTutorial",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/tutorial/",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(ZM))},e.\u0275cmp=oy({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(lv||(lv=Vv(["Learn the rules"])))]},template:function(e,t){1&e&&(pb(0,"app-pick-game",0),bb("pickGame",function(e){return t.pickGame(e)}),gb(),pb(1,"button",1),bb("click",function(){return t.launchTutorial()}),WE(2,2),gb()),2&e&&(Rw(1),db("disabled",!t.selectedGame))},directives:[qve],encapsulation:2}),e}(),Lye=function(){var e=cp(function e(){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=oy({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){return[$localize(hv||(hv=Vv(["The replay game is loading, please wait, it should not take long."])))]},template:function(e,t){1&e&&(pb(0,"p"),WE(1,0),gb())},encapsulation:2}),e}(),Fye={production:!0,test:!1,root:"/",firebaseConfig:{apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631"},useEmulators:!1},Bye=function(){var e=function(){function e(t){sp(this,e),this.authService=t}return cp(e,[{key:"canActivate",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){var n;e.userSub=e.authService.getUserObs().subscribe((n=aB(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.evaluateUserPermission(r).then(t);case 2:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}))}));case 1:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Rk(Jee))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Uye=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e)).router=r,i}return cp(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Bye);return e.\u0275fac=function(t){return new(t||e)(Rk(Jee),Rk(ZM))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Vye(e,t){1&e&&(pb(0,"p",20),WE(1,21),gb())}function zye(e,t){if(1&e){var n=_b();pb(0,"div",7),pb(1,"p",8),WE(2,9),gb(),pb(3,"div",10),pb(4,"p",11),WE(5,12),gb(),pb(6,"button",13),bb("click",function(){return Jy(n),Pb().finalizeEmailVerification()}),WE(7,14),gb(),gb(),pb(8,"div",15),pb(9,"p",11),WE(10,16),gb(),pb(11,"button",17),bb("click",function(){return Jy(n),Pb().sendEmailVerification()}),WE(12,18),gb(),gb(),lb(13,Vye,2,0,"p",19),gb()}if(2&e){var r=Pb();Rw(2),jE(r.emailAddress),ZE(2),Rw(11),db("ngIf",r.success)}}function Hye(e,t){if(1&e){var n=_b();pb(0,"div",24),pb(1,"div",8),WE(2,25),gb(),pb(3,"form",26),pb(4,"div",27),pb(5,"div",28),yb(6,"input",29),gb(),pb(7,"div",28),pb(8,"button",30),bb("click",function(){Jy(n);var e=Pb(2);return e.pickUsername(e.usernameForm.value)}),WE(9,31),gb(),gb(),gb(),gb(),gb()}if(2&e){var r=Pb(2);Rw(3),db("formGroup",r.usernameForm)}}var Gye=function(){return["/lobby"]};function qye(e,t){1&e&&(pb(0,"div",32),qE(1,33),yb(2,"a",34),$E(),gb()),2&e&&(Rw(2),db("routerLink",oP(1,Gye)))}function $ye(e,t){if(1&e&&(mb(0),lb(1,Hye,10,1,"div",22),lb(2,qye,3,2,"div",23),kb()),2&e){var n=Pb();Rw(1),db("ngIf",!n.success),Rw(1),db("ngIf",n.success)}}function Wye(e,t){if(1&e&&(pb(0,"div",35),pb(1,"div",36),Bb(2),gb(),gb()),2&e){var n=Pb();Rw(2),Ub(n.errorMessage)}}var jye=function(){var e=function(){function e(t,n){sp(this,e),this.authService=t,this.router=n,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new Vx({username:new Ux})}return cp(e,[{key:"ngOnInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.userSub=e.authService.getUserObs().subscribe(function(){var t=aB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.emailAddress=n.email.get(),!n.username.isAbsent()){t.next=5;break}e.verificationType="enter-username",t.next=11;break;case 5:if(e.verificationType="send-email",!0===e.triedToFinalize&&!1===n.verified&&(e.errorMessage=$localize(fv||(fv=Vv(["You have not verified your email! Click on the link in the verification email."])))),t.t0=!0===n.verified,!t.t0){t.next=11;break}return t.next=11,e.router.navigate(["/lobby"]);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"pickUsername",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authService.setUsername(e.username);case 2:(r=n.sent).isSuccess()?t.success=!0:t.errorMessage=r.getReason();case 4:case"end":return n.stop()}},n)}))()}},{key:"sendEmailVerification",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.sendEmailVerification();case 2:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=n.getReason();case 4:case"end":return t.stop()}},t)}))()}},{key:"finalizeEmailVerification",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.triedToFinalize=!0,t.next=3,e.authService.reloadUser();case 3:window.open(window.location.href,"_self");case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(Jee),fb(ZM))},e.\u0275cmp=oy({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){return[[1,"box"],[1,"message","is-info"],[1,"message-header"],$localize(dv||(dv=Vv(["Account verification"]))),["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],$localize(vv||(vv=Vv(["In order to finalize your account, you must click on the link that you should have received on your email address (",":INTERPOLATION:). The email could be in your spam folder."])),"\ufffd0\ufffd"),[1,"block","level-left"],[1,"level-item"],$localize(pv||(pv=Vv(["Once you have verified your email, click on the following button:"]))),["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],$localize(gv||(gv=Vv(["Finalize email verification"]))),[1,"level-left"],$localize(yv||(yv=Vv(["If you have not received the verification email, click on the following button:"]))),["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],$localize(mv||(mv=Vv(["Send verification email again"]))),["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],$localize(kv||(kv=Vv(["The email has been sent"]))),["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],$localize(_v||(_v=Vv(["In order to finalize your account, you must choose a username."]))),[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",$localize(wv||(wv=Vv(["Username"]))),"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],$localize(Cv||(Cv=Vv(["Pick username"]))),["id","success",1,"message-body"],$localize(bv||(bv=Vv(["Your account has now been finalized, you can go back to the ",":START_LINK:list of games",":CLOSE_LINK:."])),"\ufffd#2\ufffd","\ufffd/#2\ufffd"),[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(pb(0,"div",0),pb(1,"div",1),pb(2,"div",2),WE(3,3),gb(),lb(4,zye,14,2,"div",4),lb(5,$ye,3,2,"ng-container",5),gb(),lb(6,Wye,3,1,"div",6),gb()),2&e&&(Rw(4),db("ngIf","send-email"===t.verificationType),Rw(1),db("ngIf","enter-username"===t.verificationType),Rw(1),db("ngIf",t.errorMessage))},directives:[UT,Zx,gx,eA,UI,fA,px,nA,JM],encapsulation:2}),e}(),Zye=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e)).router=r,i}return cp(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Bye);return e.\u0275fac=function(t){return new(t||e)(Rk(Jee),Rk(ZM))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Yye=function(){var e=function(e){Yv(n,e);var t=Jv(n);function n(e,r){var i;return sp(this,n),(i=t.call(this,e)).router=r,i}return cp(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(Bye);return e.\u0275fac=function(t){return new(t||e)(Rk(Jee),Rk(ZM))},e.\u0275prov=xg({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function Kye(e,t){1&e&&(pb(0,"p",12),WE(1,13),gb())}function Jye(e,t){if(1&e&&(pb(0,"div",14),pb(1,"div",15),WE(2,16),gb(),pb(3,"div",17),Bb(4),gb(),gb()),2&e){var n=Pb();Rw(4),Ub(n.errorMessage.get())}}var Qye=function(){return{standalone:!0}},Xye=function(){var e=function(){function e(t){sp(this,e),this.authService=t,this.success=!1,this.errorMessage=hB.empty(),this.email=""}return cp(e,[{key:"resetPassword",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a6(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=hB.empty(),e.success=!1,t.next=3,e.authService.sendPasswordResetEmail(e.email);case 3:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=hB.of(n.getReason());case 5:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(Jee))},e.\u0275cmp=oy({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){return[[1,"box"],[1,"title"],$localize(Ev||(Ev=Vv(["Password reset"]))),[1,"field"],[1,"control"],["id","email","name","email","placeholder",$localize(Sv||(Sv=Vv(["Email"]))),"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],$localize(Pv||(Pv=Vv(["An email will be sent with instruction to reset your password."]))),["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],$localize(Ov||(Ov=Vv(["Reset password"]))),["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],$localize(Tv||(Tv=Vv(["The email has been sent, please follow the instructions from that email."]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(Iv||(Iv=Vv(["Error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(pb(0,"div",0),pb(1,"p",1),WE(2,2),gb(),pb(3,"div",3),pb(4,"div",4),pb(5,"input",5),bb("ngModelChange",function(e){return t.email=e}),gb(),pb(6,"p",6),WE(7,7),gb(),lb(8,Kye,2,0,"p",8),gb(),gb(),pb(9,"button",9),bb("click",function(){return t.resetPassword()}),WE(10,10),gb(),lb(11,Jye,5,1,"div",11),gb()),2&e&&(Rw(5),db("ngModel",t.email)("ngModelOptions",oP(5,Qye)),Rw(3),db("ngIf",t.success),Rw(1),db("disabled",""===t.email),Rw(2),db("ngIf",t.errorMessage.isPresent()))},directives:[UI,Yve,fA,px,jx,UT],encapsulation:2}),e}();function eme(e,t){if(1&e&&(pb(0,"option",13),Bb(1),gb()),2&e){var n=t.$implicit,r=Pb();db("value",n.value)("selected",n.value===r.currentTheme),Rw(1),Vb(" ",n.name," ")}}function tme(e,t){if(1&e&&(pb(0,"option",13),Bb(1),gb()),2&e){var n=t.$implicit,r=Pb();db("value",n.value)("selected",n.value===r.currentLanguage),Rw(1),Vb(" ",n.name," ")}}var nme=function(){var e=function(){function e(t,n){sp(this,e),this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize(xv||(xv=Vv(["Light"])))},{value:"dark",name:$localize(Av||(Av=Vv(["Dark"])))}],this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}return cp(e,[{key:"changeLanguage",value:function(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}},{key:"changeTheme",value:function(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}},{key:"reload",value:function(){window.open(window.location.href,"_self")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(pte),fb(gte))},e.\u0275cmp=oy({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){return[[1,"box"],[1,"title"],$localize(Rv||(Rv=Vv(["User settings"]))),[1,"field"],["for","theme",1,"label"],$localize(Nv||(Nv=Vv(["Theme"]))),[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],$localize(Mv||(Mv=Vv(["Language"]))),["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(pb(0,"div",0),pb(1,"p",1),WE(2,2),gb(),pb(3,"div",3),pb(4,"label",4),WE(5,5),gb(),pb(6,"div",6),pb(7,"div",7),pb(8,"select",8),bb("change",function(e){return t.changeTheme(e)}),lb(9,eme,2,3,"option",9),gb(),gb(),gb(),gb(),pb(10,"div",3),pb(11,"label",10),WE(12,11),gb(),pb(13,"div",6),pb(14,"div",7),pb(15,"select",12),bb("change",function(e){return t.changeLanguage(e)}),lb(16,tme,2,3,"option",9),gb(),gb(),gb(),gb(),gb()),2&e&&(Rw(9),db("ngForOf",t.availableThemes),Rw(7),db("ngForOf",t.availableLanguages))},directives:[FT,oA,lA],encapsulation:2}),e}(),rme=function(){var e=cp(function e(){sp(this,e)});return e.ALREADY_INGAME=function(){return $localize(Dv||(Dv=Vv(["You are already in a game. Finish it or cancel it first."])))},e}(),ime=function(){var e=function(){function e(t,n,r,i,a,o){sp(this,e),this.route=t,this.router=n,this.connectedUserService=r,this.messageDisplayer=i,this.partDAO=a,this.gameService=o}return cp(e,[{key:"ngOnInit",value:function(){var e=this;return aB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameAndRedirectOrShowError(e.extractGameFromURL());case 2:case"end":return t.stop()}},t)}))()}},{key:"extractGameFromURL",value:function(){return oB.getNonNullable(this.route.snapshot.paramMap.get("compo"))}},{key:"createGameAndRedirectOrShowError",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a6((r=t.connectedUserService.user.get()).isConnected(),"User must be connected and have a username to reach this page"),i=r.toMinimalUser(),!1!==t.gameExists(e)){n.next=7;break}return n.next=6,t.router.navigate(["/notFound",Spe.NO_MATCHING_GAME(e)],{skipLocationChange:!0});case 6:return n.abrupt("return",!1);case 7:return n.next=9,t.canCreateOnlineGame(i.name);case 9:if(!n.sent){n.next=16;break}return n.next=12,t.gameService.createPartJoinerAndChat(i,e);case 12:return a=n.sent,n.next=15,t.router.navigate(["/play",e,a]);case 15:return n.abrupt("return",!0);case 16:return t.messageDisplayer.infoMessage(rme.ALREADY_INGAME()),n.next=19,t.router.navigate(["/lobby"]);case 19:return n.abrupt("return",!1);case 20:case"end":return n.stop()}},n)}))()}},{key:"gameExists",value:function(e){return hB.ofNullable(Gve.ALL_GAMES().find(function(t){return t.urlName===e})).isPresent()}},{key:"canCreateOnlineGame",value:function(e){var t=this;return aB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=!1,n.next=3,t.partDAO.userHasActivePart(e);case 3:return n.t1=n.sent,n.abrupt("return",n.t0===n.t1);case 5:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(fb(ON),fb(ZM),fb(Jee),fb(r6),fb(u6),fb(dte))},e.\u0275cmp=oy({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){return[$localize(Lv||(Lv=Vv(["Creating online game, please wait, it should not take long."])))]},template:function(e,t){1&e&&(pb(0,"p"),WE(1,0),gb())},encapsulation:2}),e}();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[Kb.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),Wb[t]=e,n&&(Wb[t][Kb.ExtraData]=n)}(e,void 0,void 0)}(rB());var ame=[{path:"login",component:epe},{path:"lobby",component:wpe,canActivate:[Uye]},{path:"settings",component:nme},{path:"register",component:Nye,canActivate:[Yye]},{path:"reset-password",component:Xye,canActivate:[Yye]},{path:"notFound/:message",component:Cpe},{path:"nextGameLoading",component:Lye,canActivate:[Uye]},{path:"verify-account",component:jye,canActivate:[Zye]},{path:"play",component:npe,canActivate:[Uye]},{path:"play/:compo",component:ime,canActivate:[Uye]},{path:"play/:compo/:id",component:jge,canActivate:[Uye]},{path:"local",component:Mye},{path:"local/:compo",component:fye},{path:"tutorial",component:Dye},{path:"tutorial/:compo",component:xye},{path:"",component:Zve},{path:"**",component:Cpe}],ome=function(){function e(){sp(this,e)}return cp(e,null,[{key:"app",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:mG,providers:[{provide:vG,useFactory:yG(e),multi:!0,deps:[tO,$C,aG].concat(n)}]}}(function(){return Fye.useEmulators&&(Fye.firebaseConfig.databaseURL="http://localhost:9000?ns=default"),kG(Fye.firebaseConfig)})}},{key:"firestore",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:M5,providers:[{provide:x5,useFactory:A5(e),multi:!0,deps:[tO,$C,aG,dG,[new Vk,hj],[new Vk,QG]].concat(n)}]}}(function(){var e=H5(),t=e.toJSON().settings.host;return Fye.useEmulators&&"localhost:8080"!==t&&F5(e,"localhost",8080),e})}},{key:"database",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:Hee,providers:[{provide:Bee,useFactory:Uee(e),multi:!0,deps:[tO,$C,aG,dG,[new Vk,hj],[new Vk,QG]].concat(n)}]}}(function(){var e=qee();return Fye.useEmulators&&!1===e._instanceStarted&&Gee(e,"localhost",9e3),e})}},{key:"auth",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:yj,providers:[{provide:fj,useFactory:dj(e),multi:!0,deps:[tO,$C,aG,dG,[new Vk,QG]].concat(n)}]}}(function(){var e=_j();return Fye.useEmulators&&null==e.config.emulator&&mj(e,"http://localhost:9099",{disableWarnings:!0}),e})}}]),e}(),sme=function(){var e=cp(function e(){sp(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ly({type:e,bootstrap:[ire]}),e.\u0275inj=Ag({providers:[Jee,dte,fte,p6,h6,u6,gte,{provide:GP,useValue:vte.getLocale()}],imports:[[ome.app(),ome.firestore(),ome.auth(),ome.database(),SI,tR,cD.forRoot(ame,{useHash:!1}),yA,gA,tB,Wne]]}),e}();"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;var ume=function(){function e(t){sp(this,e),this.digits=t}return cp(e,[{key:"clone",value:function(){return new e(this.digits.slice())}},{key:"add",value:function(e){var t=this.clone();return t.addToSelf(e),t}},{key:"addToSelf",value:function(e){for(var t=Math.max(this.digits.length,e.digits.length),n=0,r=0;r<t;r++){var i=n;r<this.digits.length&&(i+=this.digits[r]),r<e.digits.length&&(i+=e.digits[r]),i>=10?(this.digits[r]=i-10,n=1):(this.digits[r]=i,n=0)}n>0&&(this.digits[t]=1)}},{key:"toString",value:function(){for(var e="",t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}],[{key:"zero",value:function(){return new e([0])}},{key:"one",value:function(){return new e([1])}}]),e}(),cme=function(){function e(t){sp(this,e),this.powerOfTwos=[t]}return cp(e,[{key:"getValue",value:function(){return this.powerOfTwos[0]}},{key:"multiplyBy",value:function(e){var t=ume.zero();return this.multiplyByAndAddTo(e,t),t}},{key:"multiplyByAndAddTo",value:function(e,t){for(var n=0;0!==e;e>>>=1,n++)if(1&e){var r=this.getMultipliedByPowerOfTwo(n);t.addToSelf(r)}}},{key:"getMultipliedByPowerOfTwo",value:function(e){for(var t=this.powerOfTwos.length;t<=e;t++){var n=this.powerOfTwos[t-1];this.powerOfTwos[t]=n.add(n)}return this.powerOfTwos[e]}}]),e}(),lme=function(){function e(t){sp(this,e),this.base=t,this.exponents=[new cme(ume.one())]}return cp(e,[{key:"toThePowerOf",value:function(e){for(var t=this.exponents.length;t<=e;t++){var n=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new cme(n)}return this.exponents[e]}}]),e}();function hme(e){var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){var i=e.charCodeAt(n+1);i>=56320&&i<=57343&&(n++,r=(r-55296<<10)+i-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e),n=fme(t,0),r=fme(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function fme(e,t){var n,r=2654435769,i=2654435769,a=e.length;for(n=0;n+12<=a;n+=12){var o=dme(r=pme(r,kme(e,n,vme.Little)),i=pme(i,kme(e,n+4,vme.Little)),t=pme(t,kme(e,n+8,vme.Little)));r=o[0],i=o[1],t=o[2]}return r=pme(r,kme(e,n,vme.Little)),i=pme(i,kme(e,n+4,vme.Little)),t=pme(t,a),dme(r,i,t=pme(t,kme(e,n+8,vme.Little)<<8))[2]}function dme(e,t,n){return e=yme(e,t),e=yme(e,n),e^=n>>>13,t=yme(t,n),t=yme(t,e),t^=e<<8,n=yme(n,e),n=yme(n,t),n^=t>>>13,e=yme(e,t),e=yme(e,n),e^=n>>>12,t=yme(t,n),t=yme(t,e),t^=e<<16,n=yme(n,e),n=yme(n,t),n^=t>>>5,e=yme(e,t),e=yme(e,n),e^=n>>>3,t=yme(t,n),t=yme(t,e),t^=e<<10,n=yme(n,e),n=yme(n,t),[e,t,n^=t>>>15]}var vme=((vme=vme||{})[vme.Little=0]="Little",vme[vme.Big=1]="Big",vme);function pme(e,t){return gme(e,t)[1]}function gme(e,t){var n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function yme(e,t){var n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function mme(e,t){return t>=e.length?0:e[t]}function kme(e,t,n){var r=0;if(n===vme.Big)for(var i=0;i<4;i++)r+=mme(e,t+i)<<24-8*i;else for(var a=0;a<4;a++)r+=mme(e,t+a)<<8*a;return r}var _me=new lme(256);function wme(e,t){if(":"!==t.charAt(0))return{text:e};var n=function(e,t){for(var n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error('Unterminated $localize metadata block in "'.concat(t,'".'))}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}function Cme(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});var bme=function(e){Yv(n,e);var t=Jv(n);function n(e){var r;return sp(this,n),(r=t.call(this,"No translation found for ".concat(Sme(e),"."))).parsedMessage=e,r.type="MissingTranslationError",r}return cp(n)}($v(Error));function Eme(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function Sme(e){var t=e.meaning&&' - "'.concat(e.meaning,'"'),n=e.legacyIds&&e.legacyIds.length>0?" [".concat(e.legacyIds.map(function(e){return'"'.concat(e,'"')}).join(", "),"]"):"";return'"'.concat(e.id,'"').concat(n,' ("').concat(e.text,'"').concat(t,")")}function Pme(e,t){try{return function(e,t,n){var r=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a={},o={},s=function(e,t){var n=wme(e,t),r=n.text,i=n.block;if(void 0===i)return{text:r};var a=Fv(i.split("\u241f")),o=a[0],s=a.slice(1),u=Hv(o.split("@@",2),2),c=u[0],l=u[1],h=Hv(c.split("|",2),2),f=h[0],d=h[1];return void 0===d&&(d=f,f=void 0),""===d&&(d=void 0),{text:r,meaning:f,description:d,customId:l,legacyIds:s}}(e[0],e.raw[0]),u=[s.text],c=[],l=s.text,h=1;h<e.length;h++){var f=wme(e[h],e.raw[h]),d=f.text,v=f.block,p=void 0===v?Cme(h):v;l+="{$".concat(p,"}").concat(d),void 0!==t&&(a[p]=t[h-1],o[p]=i[h-1]),c.push(p),u.push(d)}var g=s.customId||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=hme(e);if(t){var r=hme(t);n=function(e,t){var n=e[0],r=t[0],i=gme(e[1],t[1]),a=i[0],o=i[1];return[pme(pme(n,r),a),o]}(function(e,t){var n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),r)}return function(e,t){var n=_me.toThePowerOf(0).multiplyBy(t);return _me.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(l,s.meaning||""),y=s.legacyIds?s.legacyIds.filter(function(e){return e!==g}):[];return{id:g,legacyIds:y,substitutions:a,substitutionLocations:o,text:l,customId:s.customId,meaning:s.meaning||"",description:s.description||"",messageParts:u,messagePartLocations:r,placeholderNames:c,location:n}}(t,n),i=e[r.id];if(void 0!==r.legacyIds)for(var a=0;a<r.legacyIds.length&&void 0===i;a++)i=e[r.legacyIds[a]];if(void 0===i)throw new bme(r);return[i.messageParts,i.placeholderNames.map(function(e){if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error("There is a placeholder name mismatch with the translation provided for the message ".concat(Sme(r),".\nThe translation contains a placeholder with name ").concat(e,", which does not exist in the message."))})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function Ome(){Fye.production&&function(){if(dO)throw new Error("Cannot enable prod mode after platform setup.");fO=!1}(),bI().bootstrapModule(sme).catch(function(e){return console.error(e)})}var Tme=vte.getLocale();"en"!==Tme?fetch(Fye.root+"assets/"+Tme+".json").then(function(e){return e.ok?e.json():{locale:"en",translations:{}}}).then(function(e){(function(e){$localize.translate||($localize.translate=Pme),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(function(t){$localize.TRANSLATIONS[t]=function(e){for(var t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[],i=1;i<t.length-1;i+=2)r.push(t[i]),n.push("".concat(t[i+1]));var a=n.map(function(e){return":"===e.charAt(0)?"\\"+e:e});return{text:e,messageParts:Eme(n,a),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,Ome()}).catch(function(e){console.log(e)}):Ome()}},function(e){e(e.s=7701)}])}();