(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{5353:(Zh,F5,gc)=>{"use strict";function ln(n){return"function"==typeof n}function os(n){const e=n(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const W3=os(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,s)=>`${s+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function e3(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class H1{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const i of e)i.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(ln(r))try{r()}catch(i){t=i instanceof W3?i.errors:[i]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const i of s)try{_n(i)}catch(o){t=t??[],o instanceof W3?t=[...t,...o.errors]:t.push(o)}}if(t)throw new W3(t)}}add(t){var e;if(t&&t!==this)if(this.closed)_n(t);else{if(t instanceof H1){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&e3(e,t)}remove(t){const{_finalizers:e}=this;e&&e3(e,t),t instanceof H1&&t._removeParent(this)}}H1.EMPTY=(()=>{const n=new H1;return n.closed=!0,n})();const P8=H1.EMPTY;function t3(n){return n instanceof H1||n&&"closed"in n&&ln(n.remove)&&ln(n.add)&&ln(n.unsubscribe)}function _n(n){ln(n)?n():n.unsubscribe()}const mc={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},n3={setTimeout(n,t,...e){const{delegate:r}=n3;return r?.setTimeout?r.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=n3;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function j3(n){n3.setTimeout(()=>{const{onUnhandledError:t}=mc;if(!t)throw n;t(n)})}function go(){}const ni=T8("C",void 0,void 0);function T8(n,t,e){return{kind:n,value:t,error:e}}let r3=null;function gt(n){if(mc.useDeprecatedSynchronousErrorHandling){const t=!r3;if(t&&(r3={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:r}=r3;if(r3=null,e)throw r}}else n()}class rn extends H1{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,t3(t)&&t.add(this)):this.destination=$5}static create(t,e,r){return new ir(t,e,r)}next(t){this.isStopped?Kh(function Yh(n){return T8("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?Kh(function tl(n){return T8("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Kh(ni,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const i1=Function.prototype.bind;function Vs(n,t){return i1.call(n,t)}class kn{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(r){Z3(r)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(r){Z3(r)}else Z3(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){Z3(e)}}}class ir extends rn{constructor(t,e,r){let s;if(super(),ln(t)||!t)s={next:t??void 0,error:e??void 0,complete:r??void 0};else{let i;this&&mc.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&Vs(t.next,i),error:t.error&&Vs(t.error,i),complete:t.complete&&Vs(t.complete,i)}):s=t}this.destination=new kn(s)}}function Z3(n){mc.useDeprecatedSynchronousErrorHandling?function lt(n){mc.useDeprecatedSynchronousErrorHandling&&r3&&(r3.errorThrown=!0,r3.error=n)}(n):j3(n)}function Kh(n,t){const{onStoppedNotification:e}=mc;e&&n3.setTimeout(()=>e(n,t))}const $5={closed:!0,next:go,error:function B5(n){throw n},complete:go},c_="function"==typeof Symbol&&Symbol.observable||"@@observable";function nl(n){return n}function l_(n){return 0===n.length?nl:1===n.length?n[0]:function(e){return n.reduce((r,s)=>s(r),e)}}let yr=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,s){const i=function U5(n){return n&&n instanceof rn||function sT(n){return n&&ln(n.next)&&ln(n.error)&&ln(n.complete)}(n)&&t3(n)}(e)?e:new ir(e,r,s);return gt(()=>{const{operator:o,source:c}=this;i.add(o?o.call(i,c):c?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=Xh(r))((s,i)=>{const o=new ir({next:c=>{try{e(c)}catch(u){i(u),o.unsubscribe()}},error:i,complete:s});this.subscribe(o)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[c_](){return this}pipe(...e){return l_(e)(this)}toPromise(e){return new(e=Xh(e))((r,s)=>{let i;this.subscribe(o=>i=o,o=>s(o),()=>r(i))})}}return n.create=t=>new n(t),n})();function Xh(n){var t;return null!==(t=n??mc.Promise)&&void 0!==t?t:Promise}const iF=os(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let q2=(()=>{class n extends yr{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new Qh(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new iF}next(e){gt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){gt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){gt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:s,observers:i}=this;return r||s?P8:(this.currentObservers=null,i.push(e),new H1(()=>{this.currentObservers=null,e3(i,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:s,isStopped:i}=this;r?e.error(s):i&&e.complete()}asObservable(){const e=new yr;return e.source=this,e}}return n.create=(t,e)=>new Qh(t,e),n})();class Qh extends q2{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)}error(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:P8}}function u_(n){return ln(n?.lift)}function fr(n){return t=>{if(u_(t))return t.lift(function(e){try{return n(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function as(n,t,e,r,s){return new iT(n,t,e,r,s)}class iT extends rn{constructor(t,e,r,s,i,o){super(t),this.onFinalize=i,this.shouldUnsubscribe=o,this._next=e?function(c){try{e(c)}catch(u){t.error(u)}}:super._next,this._error=s?function(c){try{s(c)}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function vn(n,t){return fr((e,r)=>{let s=0;e.subscribe(as(r,i=>{r.next(n.call(t,i,s++))}))})}function q5(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(n);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(e[r[s]]=n[r[s]])}return e}function jr(n){return this instanceof jr?(this.v=n,this):new jr(n)}function r2(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=e.apply(n,t||[]),i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(E){r[E]&&(s[E]=function(b){return new Promise(function(k,U){i.push([E,b,k,U])>1||c(E,b)})})}function c(E,b){try{!function u(E){E.value instanceof jr?Promise.resolve(E.value.v).then(h,g):m(i[0][2],E)}(r[E](b))}catch(k){m(i[0][3],k)}}function h(E){c("next",E)}function g(E){c("throw",E)}function m(E,b){E(b),i.shift(),i.length&&c(i[0][0],i[0][1])}}function hT(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function d_(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=n[i]&&function(o){return new Promise(function(c,u){!function s(i,o,c,u){Promise.resolve(u).then(function(h){i({value:h,done:c})},o)}(c,u,(o=n[i](o)).done,o.value)})}}}const __=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function v_(n){return ln(n?.then)}function td(n){return ln(n[c_])}function C_(n){return Symbol.asyncIterator&&ln(n?.[Symbol.asyncIterator])}function _c(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const I1=function w8(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function vc(n){return ln(n?.[I1])}function Na(n){return r2(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:r,done:s}=yield jr(e.read());if(s)return yield jr(void 0);yield yield jr(r)}}finally{e.releaseLock()}})}function y_(n){return ln(n?.getReader)}function mo(n){if(n instanceof yr)return n;if(null!=n){if(td(n))return function rl(n){return new yr(t=>{const e=n[c_]();if(ln(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(__(n))return function s2(n){return new yr(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(v_(n))return function E_(n){return new yr(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,j3)})}(n);if(C_(n))return sl(n);if(vc(n))return function dT(n){return new yr(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(y_(n))return function nd(n){return sl(Na(n))}(n)}throw _c(n)}function sl(n){return new yr(t=>{(function pT(n,t){var e,r,s,i;return function cT(n,t,e,r){return new(e||(e=Promise))(function(i,o){function c(g){try{h(r.next(g))}catch(m){o(m)}}function u(g){try{h(r.throw(g))}catch(m){o(m)}}function h(g){g.done?i(g.value):function s(i){return i instanceof e?i:new e(function(o){o(i)})}(g.value).then(c,u)}h((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=hT(n);!(r=yield e.next()).done;)if(t.next(r.value),t.closed)return}catch(o){s={error:o}}finally{try{r&&!r.done&&(i=e.return)&&(yield i.call(e))}finally{if(s)throw s.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Hs(n,t,e,r=0,s=!1){const i=t.schedule(function(){e(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function He(n,t,e=1/0){return ln(t)?He((r,s)=>vn((i,o)=>t(r,i,s,o))(mo(n(r,s))),e):("number"==typeof t&&(e=t),fr((r,s)=>function Yo(n,t,e,r,s,i,o,c){const u=[];let h=0,g=0,m=!1;const E=()=>{m&&!u.length&&!h&&t.complete()},b=U=>h<r?k(U):u.push(U),k=U=>{i&&t.next(U),h++;let j=!1;mo(e(U,g++)).subscribe(as(t,oe=>{s?.(oe),i?b(oe):t.next(oe)},()=>{j=!0},void 0,()=>{if(j)try{for(h--;u.length&&h<r;){const oe=u.shift();o?Hs(t,o,()=>k(oe)):k(oe)}E()}catch(oe){t.error(oe)}}))};return n.subscribe(as(t,b,()=>{m=!0,E()})),()=>{c?.()}}(r,s,n,e)))}function il(n=1/0){return He(nl,n)}const Cc=new yr(n=>n.complete());function ol(n){return n[n.length-1]}function tn(n){return ln(ol(n))?n.pop():void 0}function Y3(n){return function b6(n){return n&&ln(n.schedule)}(ol(n))?n.pop():void 0}function al(n,t=0){return fr((e,r)=>{e.subscribe(as(r,s=>Hs(r,n,()=>r.next(s),t),()=>Hs(r,n,()=>r.complete(),t),s=>Hs(r,n,()=>r.error(s),t)))})}function yc(n,t=0){return fr((e,r)=>{r.add(n.schedule(()=>e.subscribe(r),t))})}function Z5(n,t){if(!n)throw new Error("Iterable cannot be null");return new yr(e=>{Hs(e,t,()=>{const r=n[Symbol.asyncIterator]();Hs(e,t,()=>{r.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function cs(n,t){return t?function b8(n,t){if(null!=n){if(td(n))return function j5(n,t){return mo(n).pipe(yc(t),al(t))}(n,t);if(__(n))return function Xo(n,t){return new yr(e=>{let r=0;return t.schedule(function(){r===n.length?e.complete():(e.next(n[r++]),e.closed||this.schedule())})})}(n,t);if(v_(n))return function O6(n,t){return mo(n).pipe(yc(t),al(t))}(n,t);if(C_(n))return Z5(n,t);if(vc(n))return function rd(n,t){return new yr(e=>{let r;return Hs(e,t,()=>{r=n[I1](),Hs(e,t,()=>{let s,i;try{({value:s,done:i}=r.next())}catch(o){return void e.error(o)}i?e.complete():e.next(s)},0,!0)}),()=>ln(r?.return)&&r.return()})}(n,t);if(y_(n))return function A6(n,t){return Z5(Na(n),t)}(n,t)}throw _c(n)}(n,t):mo(n)}function Y5(n,t,...e){if(!0===t)return void n();if(!1===t)return;const r=new ir({next:()=>{r.unsubscribe(),n()}});return mo(t(...e)).subscribe(r)}function P1(n){for(let t in n)if(n[t]===P1)return t;throw Error("Could not find renamed property on target object.")}function sd(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function j1(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(j1).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function O8(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const S_=P1({__forward_ref__:P1});function T1(n){return n.__forward_ref__=T1,n.toString=function(){return j1(this())},n}function sn(n){return N6(n)?n():n}function N6(n){return"function"==typeof n&&n.hasOwnProperty(S_)&&n.__forward_ref__===T1}class Ne extends Error{constructor(t,e){super(function s3(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}(t,e)),this.code=t}}function on(n){return"string"==typeof n?n:null==n?"":String(n)}function x6(n,t){throw new Ne(-201,!1)}function w1(n,t,e,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${e} ${r} ${t} <=Actual]`))}function et(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Zr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Dn(n){return b_(n,k6)||b_(n,cd)}function b_(n,t){return n.hasOwnProperty(t)?n[t]:null}function I8(n){return n&&(n.hasOwnProperty(Ee)||n.hasOwnProperty(ld))?n[Ee]:null}const k6=P1({\u0275prov:P1}),Ee=P1({\u0275inj:P1}),cd=P1({ngInjectableDef:P1}),ld=P1({ngInjectorDef:P1});var Yt=(()=>((Yt=Yt||{})[Yt.Default=0]="Default",Yt[Yt.Host=1]="Host",Yt[Yt.Self=2]="Self",Yt[Yt.SkipSelf=4]="SkipSelf",Yt[Yt.Optional=8]="Optional",Yt))();let ud;function Qo(n){const t=ud;return ud=n,t}function fd(n,t,e){const r=Dn(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&Yt.Optional?null:void 0!==t?t:void x6(j1(n))}function Q3(n){return{toString:n}.toString()}var Z2=(()=>((Z2=Z2||{})[Z2.OnPush=0]="OnPush",Z2[Z2.Default=1]="Default",Z2))(),F1=(()=>{return(n=F1||(F1={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",F1;var n})();const K1=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),K={},C1=[],J5=P1({\u0275cmp:P1}),hd=P1({\u0275dir:P1}),dd=P1({\u0275pipe:P1}),x8=P1({\u0275mod:P1}),i3=P1({\u0275fac:P1}),o3=P1({__NG_ELEMENT_ID__:P1});let yT=0;function ut(n){return Q3(()=>{const e=!0===n.standalone,r={},s={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Z2.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||C1,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||F1.Emulated,id:"c"+yT++,styles:n.styles||C1,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.dependencies,o=n.features;return s.inputs=gd(n.inputs,r),s.outputs=gd(n.outputs),o&&o.forEach(c=>c(s)),s.directiveDefs=i?()=>("function"==typeof i?i():i).map(pd).filter(e7):null,s.pipeDefs=i?()=>("function"==typeof i?i():i).map(a2).filter(e7):null,s})}function k8(n,t,e){const r=n.\u0275cmp;r.directiveDefs=()=>("function"==typeof t?t():t).map(pd),r.pipeDefs=()=>("function"==typeof e?e():e).map(a2)}function pd(n){return b1(n)||o2(n)}function e7(n){return null!==n}function oi(n){return Q3(()=>({type:n.type,bootstrap:n.bootstrap||C1,declarations:n.declarations||C1,imports:n.imports||C1,exports:n.exports||C1,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function gd(n,t){if(null==n)return K;const e={};for(const r in n)if(n.hasOwnProperty(r)){let s=n[r],i=s;Array.isArray(s)&&(i=s[1],s=s[0]),e[s]=r,t&&(t[s]=i)}return e}const qt=ut;function ai(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function b1(n){return n[J5]||null}function o2(n){return n[hd]||null}function a2(n){return n[dd]||null}function vo(n,t){const e=n[x8]||null;if(!e&&!0===t)throw new Error(`Type ${j1(n)} does not have '\u0275mod' property.`);return e}function Co(n){return Array.isArray(n)&&"object"==typeof n[1]}function Er(n){return Array.isArray(n)&&!0===n[1]}function K2(n){return 0!=(8&n.flags)}function na(n){return 2==(2&n.flags)}function ra(n){return 1==(1&n.flags)}function Ms(n){return null!==n.template}function V6(n){return 0!=(256&n[2])}function xa(n,t){return n.hasOwnProperty(i3)?n[i3]:null}class ST{constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function u2(){return k_}function k_(n){return n.type.prototype.ngOnChanges&&(n.setInput=L_),PT}function PT(){const n=o7(this),t=n?.current;if(t){const e=n.previous;if(e===K)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function L_(n,t,e,r){const s=o7(n)||function TT(n,t){return n[R_]=t}(n,{previous:K,current:null}),i=s.current||(s.current={}),o=s.previous,c=this.declaredInputs[e],u=o[c];i[c]=new ST(u&&u.currentValue,t,o===K),n[r]=t}u2.ngInherit=!0;const R_="__ngSimpleChanges__";function o7(n){return n[R_]||null}function Mr(n){for(;Array.isArray(n);)n=n[0];return n}function D8(n,t){return Mr(t[n])}function f2(n,t){return Mr(t[n.index])}function yd(n,t){return n.data[t]}function ul(n,t){return n[t]}function ki(n,t){const e=t[n];return Co(e)?e:e[0]}function B6(n){return 64==(64&n[2])}function c3(n,t){return null==t?null:n[t]}function H_(n){n[18]=0}function Ed(n,t){n[5]+=t;let e=n,r=n[3];for(;null!==r&&(1===t&&1===e[5]||-1===t&&0===e[5]);)r[5]+=t,e=r,r=r[3]}const un={lFrame:Od(null),bindingsEnabled:!0};function Md(){return un.bindingsEnabled}function De(){return un.lFrame.lView}function Qn(){return un.lFrame.tView}function he(n){return un.lFrame.contextLView=n,n[8]}function le(n){return un.lFrame.contextLView=null,n}function Vr(){let n=F_();for(;null!==n&&64===n.type;)n=n.parent;return n}function F_(){return un.lFrame.currentTNode}function fl(){const n=un.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}function Ec(n,t){const e=un.lFrame;e.currentTNode=n,e.isParent=t}function Yr(){return un.lFrame.isParent}function Sd(){un.lFrame.isParent=!1}function Li(){const n=un.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function Mc(){return un.lFrame.bindingIndex}function U6(){return un.lFrame.bindingIndex++}function ia(n){const t=un.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function h2(n){un.lFrame.inI18n=n}function RT(n,t){const e=un.lFrame;e.bindingIndex=e.bindingRootIndex=n,l3(t)}function l3(n){un.lFrame.currentDirectiveIndex=n}function wd(){return un.lFrame.currentQueryIndex}function V8(n){un.lFrame.currentQueryIndex=n}function $_(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function h7(n,t,e){if(e&Yt.SkipSelf){let s=t,i=n;for(;!(s=s.parent,null!==s||e&Yt.Host||(s=$_(i),null===s||(i=i[15],10&s.type))););if(null===s)return!1;t=s,n=i}const r=un.lFrame=bd();return r.currentTNode=t,r.lView=n,!0}function hl(n){const t=bd(),e=n[1];un.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function bd(){const n=un.lFrame,t=null===n?null:n.child;return null===t?Od(n):t}function Od(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function U_(){const n=un.lFrame;return un.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const H8=U_;function dl(){const n=U_();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function d2(){return un.lFrame.selectedIndex}function u3(n){un.lFrame.selectedIndex=n}function O1(){const n=un.lFrame;return yd(n.tView,n.selectedIndex)}function F(){un.lFrame.currentNamespace="svg"}function d3(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){const i=n.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:c,ngAfterViewInit:u,ngAfterViewChecked:h,ngOnDestroy:g}=i;o&&(n.contentHooks||(n.contentHooks=[])).push(-e,o),c&&((n.contentHooks||(n.contentHooks=[])).push(e,c),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,c)),u&&(n.viewHooks||(n.viewHooks=[])).push(-e,u),h&&((n.viewHooks||(n.viewHooks=[])).push(e,h),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,h)),null!=g&&(n.destroyHooks||(n.destroyHooks=[])).push(e,g)}}function ka(n,t,e){G_(n,t,3,e)}function B8(n,t,e,r){(3&n[2])===e&&G_(n,t,e,r)}function $8(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function G_(n,t,e,r){const i=r??-1,o=t.length-1;let c=0;for(let u=void 0!==r?65535&n[18]:0;u<o;u++)if("number"==typeof t[u+1]){if(c=t[u],null!=r&&c>=r)break}else t[u]<0&&(n[18]+=65536),(c<i||-1==i)&&(q_(n,e,t,u),n[18]=(4294901760&n[18])+u+2),u++}function q_(n,t,e,r){const s=e[r]<0,i=e[r+1],c=n[s?-e[r]:e[r]];if(s){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{i.call(c)}finally{}}}else try{i.call(c)}finally{}}class U8{constructor(t,e,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function Sc(n,t,e){let r=0;for(;r<e.length;){const s=e[r];if("number"==typeof s){if(0!==s)break;r++;const i=e[r++],o=e[r++],c=e[r++];n.setAttribute(t,o,c,i)}else{const i=s,o=e[++r];Z_(i)?n.setProperty(t,i,o):n.setAttribute(t,i,o),r++}}return r}function j_(n){return 3===n||4===n||6===n}function Z_(n){return 64===n.charCodeAt(0)}function W6(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){const s=t[r];"number"==typeof s?e=s:0===e||Nd(n,e,s,null,-1===e||2===e?t[++r]:null)}}return n}function Nd(n,t,e,r,s){let i=0,o=n.length;if(-1===t)o=-1;else for(;i<n.length;){const c=n[i++];if("number"==typeof c){if(c===t){o=-1;break}if(c>t){o=i-1;break}}}for(;i<n.length;){const c=n[i];if("number"==typeof c)break;if(c===e){if(null===r)return void(null!==s&&(n[i+1]=s));if(r===n[i+1])return void(n[i+2]=s)}i++,null!==r&&i++,null!==s&&i++}-1!==o&&(n.splice(o,0,t),i=o+1),n.splice(i++,0,e),null!==r&&n.splice(i++,0,r),null!==s&&n.splice(i++,0,s)}function Id(n){return-1!==n}function gl(n){return 32767&n}function ml(n,t){let e=function Y_(n){return n>>16}(n),r=t;for(;e>0;)r=r[15],e--;return r}let p7=!0;function s4(n){const t=p7;return p7=n,t}let K_=0;const p3={};function g7(n,t){const e=q8(n,t);if(-1!==e)return e;const r=t[1];r.firstCreatePass&&(n.injectorIndex=t.length,kd(r.data,n),kd(t,null),kd(r.blueprint,null));const s=Ra(n,t),i=n.injectorIndex;if(Id(s)){const o=gl(s),c=ml(s,t),u=c[1].data;for(let h=0;h<8;h++)t[i+h]=c[o+h]|u[o+h]}return t[i+8]=s,i}function kd(n,t){n.push(0,0,0,0,0,0,0,0,t)}function q8(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Ra(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,r=null,s=t;for(;null!==s;){if(r=J_(s),null===r)return-1;if(e++,s=s[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function j6(n,t,e){!function SF(n,t,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(o3)&&(r=e[o3]),null==r&&(r=e[o3]=K_++);const s=255&r;t.data[n+(s>>5)]|=1<<s}(n,t,e)}function Ld(n,t,e){if(e&Yt.Optional||void 0!==n)return n;x6()}function Rd(n,t,e,r){if(e&Yt.Optional&&void 0===r&&(r=null),0==(e&(Yt.Self|Yt.Host))){const s=n[9],i=Qo(void 0);try{return s?s.get(t,r,e&Yt.Optional):fd(t,r,e&Yt.Optional)}finally{Qo(i)}}return Ld(r,0,e)}function m7(n,t,e,r=Yt.Default,s){if(null!==n){if(1024&t[2]){const o=function _7(n,t,e,r,s){let i=n,o=t;for(;null!==i&&null!==o&&1024&o[2]&&!(256&o[2]);){const c=i4(i,o,e,r|Yt.Self,p3);if(c!==p3)return c;let u=i.parent;if(!u){const h=o[21];if(h){const g=h.get(e,p3,r);if(g!==p3)return g}u=J_(o),o=o[15]}i=u}return s}(n,t,e,r,p3);if(o!==p3)return o}const i=i4(n,t,e,r,p3);if(i!==p3)return i}return Rd(t,e,r,s)}function i4(n,t,e,r,s){const i=function W8(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(o3)?n[o3]:void 0;return"number"==typeof t?t>=0?255&t:Y6:t}(e);if("function"==typeof i){if(!h7(t,n,r))return r&Yt.Host?Ld(s,0,r):Rd(t,e,r,s);try{const o=i(r);if(null!=o||r&Yt.Optional)return o;x6()}finally{H8()}}else if("number"==typeof i){let o=null,c=q8(n,t),u=-1,h=r&Yt.Host?t[16][6]:null;for((-1===c||r&Yt.SkipSelf)&&(u=-1===c?Ra(n,t):t[c+8],-1!==u&&Q_(r,!1)?(o=t[1],c=gl(u),t=ml(u,t)):c=-1);-1!==c;){const g=t[1];if(X_(i,c,g.data)){const m=Dd(c,t,e,o,r,h);if(m!==p3)return m}u=t[c+8],-1!==u&&Q_(r,t[1].data[c+8]===h)&&X_(i,c,t)?(o=g,c=gl(u),t=ml(u,t)):c=-1}}return s}function Dd(n,t,e,r,s,i){const o=t[1],c=o.data[n+8],g=Kr(c,o,e,null==r?na(c)&&p7:r!=o&&0!=(3&c.type),s&Yt.Host&&i===c);return null!==g?Fs(t,o,g,c):p3}function Kr(n,t,e,r,s){const i=n.providerIndexes,o=t.data,c=1048575&i,u=n.directiveStart,g=i>>20,E=s?c+g:n.directiveEnd;for(let b=r?c:c+g;b<E;b++){const k=o[b];if(b<u&&e===k||b>=u&&k.type===e)return b}if(s){const b=o[u];if(b&&Ms(b)&&b.type===e)return u}return null}function Fs(n,t,e,r){let s=n[e];const i=t.data;if(function DT(n){return n instanceof U8}(s)){const o=s;o.resolving&&function A8(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new Ne(-200,`Circular dependency in DI detected for ${n}${e}`)}(function Vt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():on(n)}(i[e]));const c=s4(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?Qo(o.injectImpl):null;h7(n,r,Yt.Default);try{s=n[e]=o.factory(void 0,i,n,r),t.firstCreatePass&&e>=r.directiveStart&&function q6(n,t,e){const{ngOnChanges:r,ngOnInit:s,ngDoCheck:i}=t.type.prototype;if(r){const o=k_(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,o)}s&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,s),i&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,i),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,i))}(e,i[e],t)}finally{null!==u&&Qo(u),s4(c),o.resolving=!1,H8()}}return s}function X_(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function Q_(n,t){return!(n&Yt.Self||n&Yt.Host&&t)}class Z6{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,r){return m7(this._tNode,this._lView,t,r,e)}}function Y6(){return new Z6(Vr(),De())}function Sr(n){return Q3(()=>{const t=n.prototype.constructor,e=t[i3]||zd(t),r=Object.prototype;let s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==r;){const i=s[i3]||zd(s);if(i&&i!==e)return i;s=Object.getPrototypeOf(s)}return i=>new i})}function zd(n){return N6(n)?()=>{const t=zd(sn(n));return t&&t()}:xa(n)}function J_(n){const t=n[1],e=t.type;return 2===e?t.declTNode:1===e?n[6]:null}function j8(n){return function VT(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const r=e.length;let s=0;for(;s<r;){const i=e[s];if(j_(i))break;if(0===i)s+=2;else if("number"==typeof i)for(s++;s<r&&"string"==typeof e[s];)s++;else{if(i===t)return e[s+1];s+=2}}}return null}(Vr(),n)}const K6="__parameters__";function Cl(n,t,e){return Q3(()=>{const r=function v7(n){return function(...e){if(n){const r=n(...e);for(const s in r)this[s]=r[s]}}}(t);function s(...i){if(this instanceof s)return r.apply(this,i),this;const o=new s(...i);return c.annotation=o,c;function c(u,h,g){const m=u.hasOwnProperty(K6)?u[K6]:Object.defineProperty(u,K6,{value:[]})[K6];for(;m.length<=g;)m.push(null);return(m[g]=m[g]||[]).push(o),u}}return e&&(s.prototype=Object.create(e.prototype)),s.prototype.ngMetadataName=n,s.annotationCls=s,s})}class Dt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=et({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function p2(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let r=n[e];Array.isArray(r)?(t===n&&(t=n.slice(0,e)),p2(r,t)):t!==n&&t.push(r)}return t}function Da(n,t){n.forEach(e=>Array.isArray(e)?Da(e,t):t(e))}function g3(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function J6(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function yl(n,t){const e=[];for(let r=0;r<n;r++)e.push(t);return e}function g2(n,t,e){let r=m2(n,t);return r>=0?n[1|r]=e:(r=~r,function Hd(n,t,e,r){let s=n.length;if(s==t)n.push(e,r);else if(1===s)n.push(r,n[0]),n[0]=e;else{for(s--,n.push(n[s-1],n[s]);s>t;)n[s]=n[s-2],s--;n[t]=e,n[t+1]=r}}(n,r,t,e)),r}function ci(n,t){const e=m2(n,t);if(e>=0)return n[1|e]}function m2(n,t){return function E7(n,t,e){let r=0,s=n.length>>e;for(;s!==r;){const i=r+(s-r>>1),o=n[i<<e];if(t===o)return i<<e;o>t?s=i:r=i+1}return~(s<<e)}(n,t,1)}const X8={},Q8="__NG_DI_FLAG__",li="ngTempTokenPath",$T=/\n/gm,P7="__source";let J8;function t0(n){const t=J8;return J8=n,t}function UT(n,t=Yt.Default){if(void 0===J8)throw new Ne(-203,!1);return null===J8?fd(n,void 0,t):J8.get(n,t&Yt.Optional?null:void 0,t)}function Ve(n,t=Yt.Default){return(function hF(){return ud}()||UT)(sn(n),t)}function Hr(n,t=Yt.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),Ve(n,t)}function Gd(n){const t=[];for(let e=0;e<n.length;e++){const r=sn(n[e]);if(Array.isArray(r)){if(0===r.length)throw new Ne(900,!1);let s,i=Yt.Default;for(let o=0;o<r.length;o++){const c=r[o],u=ov(c);"number"==typeof u?-1===u?s=c.token:i|=u:s=c}t.push(Ve(s,i))}else t.push(Ve(r))}return t}function El(n,t){return n[Q8]=t,n.prototype[Q8]=t,n}function ov(n){return n[Q8]}const ui=El(Cl("Optional"),8),eu=El(Cl("SkipSelf"),4);let Qd,w7,b7;function cv(){return void 0!==Qd?Qd:typeof document<"u"?document:void 0}function c4(n){return function Jd(){if(void 0===w7&&(w7=null,K1.trustedTypes))try{w7=K1.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return w7}()?.createHTML(n)||n}function O7(n){return function e9(){if(void 0===b7&&(b7=null,K1.trustedTypes))try{b7=K1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return b7}()?.createHTML(n)||n}class l4{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class tw extends l4{getTypeName(){return"HTML"}}class nw extends l4{getTypeName(){return"Style"}}class rw extends l4{getTypeName(){return"Script"}}class uv extends l4{getTypeName(){return"URL"}}class fv extends l4{getTypeName(){return"ResourceURL"}}function Eo(n){return n instanceof l4?n.changingThisBreaksApplicationSecurity:n}function Mo(n,t){const e=function hv(n){return n instanceof l4&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function gv(n){const t=new zt(n);return function aw(){try{return!!(new window.DOMParser).parseFromString(c4(""),"text/html")}catch{return!1}}()?new mv(t):t}class mv{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(c4(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class zt{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const r=this.inertDocument.createElement("body");e.appendChild(r)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=c4(t),e;const r=this.inertDocument.createElement("body");return r.innerHTML=c4(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(t){const e=t.attributes;for(let s=e.length-1;0<s;s--){const o=e.item(s).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&t.removeAttribute(o)}let r=t.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const _v=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function la(n){return(n=String(n)).match(_v)?n:"unsafe:"+n}function Tc(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function ru(...n){const t={};for(const e of n)for(const r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}const vv=Tc("area,br,col,hr,img,wbr"),Cv=Tc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),A7=Tc("rp,rt"),su=ru(vv,ru(Cv,Tc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ru(A7,Tc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ru(A7,Cv)),N7=Tc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),I7=ru(N7,Tc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Tc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),cw=Tc("script,style,template");class lw{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,r=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let s=this.checkClobberedElement(e,e.nextSibling);if(s){e=s;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!su.hasOwnProperty(e))return this.sanitizedSomething=!0,!cw.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=t.attributes;for(let s=0;s<r.length;s++){const i=r.item(s),o=i.name,c=o.toLowerCase();if(!I7.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let u=i.value;N7[c]&&(u=la(u)),this.buf.push(" ",o,'="',Ev(u),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();su.hasOwnProperty(e)&&!vv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Ev(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const uw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,fw=/([^\#-~ |!])/g;function Ev(n){return n.replace(/&/g,"&amp;").replace(uw,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(fw,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let x7;function n9(n,t){let e=null;try{x7=x7||gv(n);let r=t?String(t):"";e=x7.getInertBodyElement(r);let s=5,i=r;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,r=i,i=e.innerHTML,e=x7.getInertBodyElement(r)}while(r!==i);return c4((new lw).sanitizeChildren(So(e)||e))}finally{if(e){const r=So(e)||e;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function So(n){return"content"in n&&function iu(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var X1=(()=>((X1=X1||{})[X1.NONE=0]="NONE",X1[X1.HTML=1]="HTML",X1[X1.STYLE=2]="STYLE",X1[X1.SCRIPT=3]="SCRIPT",X1[X1.URL=4]="URL",X1[X1.RESOURCE_URL=5]="RESOURCE_URL",X1))();function ou(n){const t=o0();return t?O7(t.sanitize(X1.HTML,n)||""):Mo(n,"HTML")?O7(Eo(n)):n9(cv(),on(n))}function m3(n){const t=o0();return t?t.sanitize(X1.URL,n)||"":Mo(n,"URL")?Eo(n):la(on(n))}function o0(){const n=De();return n&&n[12]}const uu=new Dt("ENVIRONMENT_INITIALIZER"),Sv=new Dt("INJECTOR",-1),Pv=new Dt("INJECTOR_DEF_TYPES");class Tv{get(t,e=X8){if(e===X8){const r=new Error(`NullInjectorError: No provider for ${j1(t)}!`);throw r.name="NullInjectorError",r}return e}}function fu(...n){return{\u0275providers:s9(0,n)}}function s9(n,...t){const e=[],r=new Set;let s;return Da(t,i=>{const o=i;_3(o,e,[],r)&&(s||(s=[]),s.push(o))}),void 0!==s&&wv(s,e),e}function wv(n,t){for(let e=0;e<n.length;e++){const{providers:s}=n[e];Da(s,i=>{t.push(i)})}}function _3(n,t,e,r){if(!(n=sn(n)))return!1;let s=null,i=I8(n);const o=!i&&b1(n);if(i||o){if(o&&!o.standalone)return!1;s=n}else{const u=n.ngModule;if(i=I8(u),!i)return!1;s=u}const c=r.has(s);if(o){if(c)return!1;if(r.add(s),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const h of u)_3(h,t,e,r)}}else{if(!i)return!1;{if(null!=i.imports&&!c){let h;r.add(s);try{Da(i.imports,g=>{_3(g,t,e,r)&&(h||(h=[]),h.push(g))})}finally{}void 0!==h&&wv(h,t)}if(!c){const h=xa(s)||(()=>new s);t.push({provide:s,useFactory:h,deps:C1},{provide:Pv,useValue:s,multi:!0},{provide:uu,useValue:()=>Ve(s),multi:!0})}const u=i.providers;null==u||c||Da(u,g=>{t.push(g)})}}return s!==n&&void 0!==n.providers}const hw=P1({provide:String,useValue:P1});function _2(n){return null!==n&&"object"==typeof n&&hw in n}function Pl(n){return"function"==typeof n}const o9=new Dt("Set Injector scope."),L7={},Av={};let a9;function u4(){return void 0===a9&&(a9=new Tv),a9}class Va{}class R7 extends Va{constructor(t,e,r,s){super(),this.parent=e,this.source=r,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,z7(t,o=>this.processProvider(o)),this.records.set(Sv,Tl(void 0,this)),s.has("environment")&&this.records.set(Va,Tl(void 0,this));const i=this.records.get(o9);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(Pv.multi,C1,Yt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=t0(this),r=Qo(void 0);try{return t()}finally{t0(e),Qo(r)}}get(t,e=X8,r=Yt.Default){this.assertNotDestroyed();const s=t0(this),i=Qo(void 0);try{if(!(r&Yt.SkipSelf)){let c=this.records.get(t);if(void 0===c){const u=function xv(n){return"function"==typeof n||"object"==typeof n&&n instanceof Dt}(t)&&Dn(t);c=u&&this.injectableDefInScope(u)?Tl(Po(t),L7):null,this.records.set(t,c)}if(null!=c)return this.hydrate(t,c)}return(r&Yt.Self?u4():this.parent).get(t,e=r&Yt.Optional&&e===X8?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[li]=o[li]||[]).unshift(j1(t)),s)throw o;return function GT(n,t,e,r){const s=n[li];throw t[P7]&&s.unshift(t[P7]),n.message=function Zn(n,t,e,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let s=j1(t);if(Array.isArray(t))s=t.map(j1).join(" -> ");else if("object"==typeof t){let i=[];for(let o in t)if(t.hasOwnProperty(o)){let c=t[o];i.push(o+":"+("string"==typeof c?JSON.stringify(c):j1(c)))}s=`{${i.join(", ")}}`}return`${e}${r?"("+r+")":""}[${s}]: ${n.replace($T,"\n  ")}`}("\n"+n.message,s,e,r),n.ngTokenPath=s,n[li]=null,n}(o,t,"R3InjectorError",this.source)}throw o}finally{Qo(i),t0(s)}}resolveInjectorInitializers(){const t=t0(this),e=Qo(void 0);try{const r=this.get(uu.multi,C1,Yt.Self);for(const s of r)s()}finally{t0(t),Qo(e)}}toString(){const t=[],e=this.records;for(const r of e.keys())t.push(j1(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ne(205,!1)}processProvider(t){let e=Pl(t=sn(t))?t:sn(t&&t.provide);const r=function pw(n){return _2(n)?Tl(void 0,n.useValue):Tl(D7(n),L7)}(t);if(Pl(t)||!0!==t.multi)this.records.get(e);else{let s=this.records.get(e);s||(s=Tl(void 0,L7,!0),s.factory=()=>Gd(s.multi),this.records.set(e,s)),e=t,s.multi.push(t)}this.records.set(e,r)}hydrate(t,e){return e.value===L7&&(e.value=Av,e.value=e.factory()),"object"==typeof e.value&&e.value&&function Iv(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=sn(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Po(n){const t=Dn(n),e=null!==t?t.factory:xa(n);if(null!==e)return e;if(n instanceof Dt)throw new Ne(204,!1);if(n instanceof Function)return function hu(n){const t=n.length;if(t>0)throw yl(t,"?"),new Ne(204,!1);const e=function O_(n){const t=n&&(n[k6]||n[cd]);if(t){const e=function ii(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new Ne(204,!1)}function D7(n,t,e){let r;if(Pl(n)){const s=sn(n);return xa(s)||Po(s)}if(_2(n))r=()=>sn(n.useValue);else if(function Ov(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...Gd(n.deps||[]));else if(function i9(n){return!(!n||!n.useExisting)}(n))r=()=>Ve(sn(n.useExisting));else{const s=sn(n&&(n.useClass||n.provide));if(!function Nv(n){return!!n.deps}(n))return xa(s)||Po(s);r=()=>new s(...Gd(n.deps))}return r}function Tl(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function gw(n){return!!n.\u0275providers}function z7(n,t){for(const e of n)Array.isArray(e)?z7(e,t):gw(e)?z7(e.\u0275providers,t):t(e)}class kv{}class Cw{resolveComponentFactory(t){throw function _w(n){const t=Error(`No component factory found for ${j1(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let a0=(()=>{class n{}return n.NULL=new Cw,n})();function RF(){return c0(Vr(),De())}function c0(n,t){return new v2(f2(n,t))}let v2=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=RF,n})();function V7(n){return n instanceof v2?n.nativeElement:n}class l0{}let To=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function yw(){const n=De(),e=ki(Vr().index,n);return(Co(e)?e:n)[11]}(),n})(),DF=(()=>{class n{}return n.\u0275prov=et({token:n,providedIn:"root",factory:()=>null}),n})();class u0{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Lv=new u0("14.2.10"),u9={};function h9(n){return n.ngOriginalError}class f0{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&h9(t);for(;e&&h9(e);)e=h9(e);return e||null}}const Aw=/^>|^->|<!--|-->|--!>|<!-$/g,Nw=/(<|>)/;const d9=new Map;let Vv=0;const $7="__ngContext__";function Vi(n,t){Co(t)?(n[$7]=t[20],function Dw(n){d9.set(n[20],n)}(t)):n[$7]=t}function Ha(n){return n instanceof Function?n():n}var y2=(()=>((y2=y2||{})[y2.Important=1]="Important",y2[y2.DashCase=2]="DashCase",y2))();let m9;function _9(n,t){return m9(n,t)}function gu(n){const t=n[3];return Er(t)?t[3]:t}function v9(n){return wc(n[13])}function C9(n){return wc(n[4])}function wc(n){for(;null!==n&&!Er(n);)n=n[4];return n}function wl(n,t,e,r,s){if(null!=r){let i,o=!1;Er(r)?i=r:Co(r)&&(o=!0,r=r[0]);const c=Mr(r);0===n&&null!==e?null==s?Jv(t,e,c):y3(t,e,c,s||null,!0):1===n&&null!==e?y3(t,e,c,s||null,!0):2===n?iC(t,c,o):3===n&&t.destroyNode(c),null!=i&&function rb(n,t,e,r,s){const i=e[7];i!==Mr(e)&&wl(t,n,r,i,s);for(let c=10;c<e.length;c++){const u=e[c];p0(u[1],u,n,t,r,i)}}(t,n,i,e,s)}}function y9(n,t){return n.createText(t)}function Yv(n,t,e){n.setValue(t,e)}function Zw(n,t){return n.createComment(function zv(n){return n.replace(Aw,t=>t.replace(Nw,"\u200b$1\u200b"))}(t))}function E9(n,t,e){return n.createElement(t,e)}function Kv(n,t){const e=n[9],r=e.indexOf(t),s=t[3];512&t[2]&&(t[2]&=-513,Ed(s,-1)),e.splice(r,1)}function M9(n,t){if(n.length<=10)return;const e=10+t,r=n[e];if(r){const s=r[17];null!==s&&s!==n&&Kv(s,r),t>0&&(n[e-1][4]=r[4]);const i=J6(n,10+t);!function Yw(n,t){p0(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const o=i[19];null!==o&&o.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function Xv(n,t){if(!(128&t[2])){const e=t[11];e.destroyNode&&p0(n,t,e,3,null,null),function Qw(n){let t=n[13];if(!t)return S9(n[1],n);for(;t;){let e=null;if(Co(t))e=t[13];else{const r=t[10];r&&(e=r)}if(!e){for(;t&&!t[4]&&t!==n;)Co(t)&&S9(t[1],t),t=t[3];null===t&&(t=n),Co(t)&&S9(t[1],t),e=t&&t[4]}t=e}}(t)}}function S9(n,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function tb(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let r=0;r<e.length;r+=2){const s=t[e[r]];if(!(s instanceof U8)){const i=e[r+1];if(Array.isArray(i))for(let o=0;o<i.length;o+=2){const c=s[i[o]],u=i[o+1];try{u.call(c)}finally{}}else try{i.call(s)}finally{}}}}(n,t),function P9(n,t){const e=n.cleanup,r=t[7];let s=-1;if(null!==e)for(let i=0;i<e.length-1;i+=2)if("string"==typeof e[i]){const o=e[i+1],c="function"==typeof o?o(t):Mr(t[o]),u=r[s=e[i+2]],h=e[i+3];"boolean"==typeof h?c.removeEventListener(e[i],u,h):h>=0?r[s=h]():r[s=-h].unsubscribe(),i+=2}else{const o=r[s=e[i+1]];e[i].call(o)}if(null!==r){for(let i=s+1;i<r.length;i++)(0,r[i])();t[7]=null}}(n,t),1===t[1].type&&t[11].destroy();const e=t[17];if(null!==e&&Er(t[3])){e!==t[3]&&Kv(e,t);const r=t[19];null!==r&&r.detachView(n)}!function zw(n){d9.delete(n[20])}(t)}}function Qv(n,t,e){return T9(n,t.parent,e)}function T9(n,t,e){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return e[0];if(2&r.flags){const s=n.data[r.directiveStart].encapsulation;if(s===F1.None||s===F1.Emulated)return null}return f2(r,e)}function y3(n,t,e,r,s){n.insertBefore(t,e,r,s)}function Jv(n,t,e){n.appendChild(t,e)}function E3(n,t,e,r,s){null!==r?y3(n,t,e,r,s):Jv(n,t,e)}function h0(n,t){return n.parentNode(t)}function nC(n,t,e){return sC(n,t,e)}function rC(n,t,e){return 40&n.type?f2(n,e):null}let w9,sC=rC;function G7(n,t){sC=n,w9=t}function mu(n,t,e,r){const s=Qv(n,r,t),i=t[11],c=nC(r.parent||t[6],r,t);if(null!=s)if(Array.isArray(e))for(let u=0;u<e.length;u++)E3(i,s,e[u],c,!1);else E3(i,s,e,c,!1);void 0!==w9&&w9(i,r,t,e,s)}function _u(n,t){if(null!==t){const e=t.type;if(3&e)return f2(t,n);if(4&e)return d0(-1,n[t.index]);if(8&e){const r=t.child;if(null!==r)return _u(n,r);{const s=n[t.index];return Er(s)?d0(-1,s):Mr(s)}}if(32&e)return _9(t,n)()||Mr(n[t.index]);{const r=bl(n,t);return null!==r?Array.isArray(r)?r[0]:_u(gu(n[16]),r):_u(n,t.next)}}return null}function bl(n,t){return null!==t?n[16][6].projection[t.projection]:null}function d0(n,t){const e=10+n+1;if(e<t.length){const r=t[e],s=r[1].firstChild;if(null!==s)return _u(r,s)}return t[7]}function iC(n,t,e){const r=h0(n,t);r&&function eC(n,t,e,r){n.removeChild(t,e,r)}(n,r,t,e)}function b9(n,t,e,r,s,i,o){for(;null!=e;){const c=r[e.index],u=e.type;if(o&&0===t&&(c&&Vi(Mr(c),r),e.flags|=4),64!=(64&e.flags))if(8&u)b9(n,t,e.child,r,s,i,!1),wl(t,n,s,c,i);else if(32&u){const h=_9(e,r);let g;for(;g=h();)wl(t,n,s,g,i);wl(t,n,s,c,i)}else 16&u?oC(n,t,r,e,s,i):wl(t,n,s,c,i);e=o?e.projectionNext:e.next}}function p0(n,t,e,r,s,i){b9(e,r,n.firstChild,t,s,i,!1)}function oC(n,t,e,r,s,i){const o=e[16],u=o[6].projection[r.projection];if(Array.isArray(u))for(let h=0;h<u.length;h++)wl(t,n,s,u[h],i);else b9(n,t,u,o[3],s,i,!0)}function vu(n,t,e){n.setAttribute(t,"style",e)}function q7(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function cC(n,t,e){let r=n.length;for(;;){const s=n.indexOf(t,e);if(-1===s)return s;if(0===s||n.charCodeAt(s-1)<=32){const i=t.length;if(s+i===r||n.charCodeAt(s+i)<=32)return s}e=s+1}}const lC="ng-template";function O9(n,t,e){let r=0;for(;r<n.length;){let s=n[r++];if(e&&"class"===s){if(s=n[r],-1!==cC(s.toLowerCase(),t,0))return!0}else if(1===s){for(;r<n.length&&"string"==typeof(s=n[r++]);)if(s.toLowerCase()===t)return!0;return!1}}return!1}function Cu(n){return 4===n.type&&n.value!==lC}function uC(n,t,e){return t===(4!==n.type||e?n.value:lC)}function sb(n,t,e){let r=4;const s=n.attrs||[],i=function ib(n){for(let t=0;t<n.length;t++)if(j_(n[t]))return t;return n.length}(s);let o=!1;for(let c=0;c<t.length;c++){const u=t[c];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!uC(n,u,e)||""===u&&1===t.length){if(Fa(r))return!1;o=!0}}else{const h=8&r?u:t[++c];if(8&r&&null!==n.attrs){if(!O9(n.attrs,h,e)){if(Fa(r))return!1;o=!0}continue}const m=fC(8&r?"class":u,s,Cu(n),e);if(-1===m){if(Fa(r))return!1;o=!0;continue}if(""!==h){let E;E=m>i?"":s[m+1].toLowerCase();const b=8&r?E:null;if(b&&-1!==cC(b,h,0)||2&r&&h!==E){if(Fa(r))return!1;o=!0}}}}else{if(!o&&!Fa(r)&&!Fa(u))return!1;if(o&&Fa(u))continue;o=!1,r=u|1&r}}return Fa(r)||o}function Fa(n){return 0==(1&n)}function fC(n,t,e,r){if(null===t)return-1;let s=0;if(r||!e){let i=!1;for(;s<t.length;){const o=t[s];if(o===n)return s;if(3===o||6===o)i=!0;else{if(1===o||2===o){let c=t[++s];for(;"string"==typeof c;)c=t[++s];continue}if(4===o)break;if(0===o){s+=4;continue}}s+=i?1:2}return-1}return function ob(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const r=n[e];if("number"==typeof r)return-1;if(r===t)return e;e++}return-1}(t,n)}function hC(n,t,e=!1){for(let r=0;r<t.length;r++)if(sb(n,t[r],e))return!0;return!1}function pC(n,t){e:for(let e=0;e<t.length;e++){const r=t[e];if(n.length===r.length){for(let s=0;s<n.length;s++)if(n[s]!==r[s])continue e;return!0}}return!1}function A9(n,t){return n?":not("+t.trim()+")":t}function ab(n){let t=n[0],e=1,r=2,s="",i=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&r){const c=n[++e];s+="["+o+(c.length>0?'="'+c+'"':"")+"]"}else 8&r?s+="."+o:4&r&&(s+=" "+o);else""!==s&&!Fa(o)&&(t+=A9(i,s),s=""),r=o,i=i||!Fa(r);e++}return""!==s&&(t+=A9(i,s)),t}const mn={};function T(n){mC(Qn(),De(),d2()+n,!1)}function mC(n,t,e,r){if(!r)if(3==(3&t[2])){const i=n.preOrderCheckHooks;null!==i&&ka(t,i,e)}else{const i=n.preOrderHooks;null!==i&&B8(t,i,0,e)}u3(e)}function k9(n,t=null,e=null,r){const s=CC(n,t,e,r);return s.resolveInjectorInitializers(),s}function CC(n,t=null,e=null,r,s=new Set){const i=[e||C1,fu(n)];return r=r||("object"==typeof n?void 0:j1(n)),new R7(i,t||u4(),r||null,s)}let fi=(()=>{class n{static create(e,r){if(Array.isArray(e))return k9({name:""},r,e,"");{const s=e.name??"";return k9({name:s},e.parent,e.providers,s)}}}return n.THROW_IF_NOT_FOUND=X8,n.NULL=new Tv,n.\u0275prov=et({token:n,providedIn:"any",factory:()=>Ve(Sv)}),n.__NG_ELEMENT_ID__=-1,n})();function Q(n,t=Yt.Default){const e=De();return null===e?Ve(n,t):m7(Vr(),e,sn(n),t)}function Y7(){throw new Error("invalid")}function K7(n,t){return n<<17|t<<2}function Ba(n){return n>>17&32767}function B9(n){return 2|n}function bc(n){return(131068&n)>>2}function Al(n,t){return-131069&n|t<<2}function $9(n){return 1|n}function xC(n,t){const e=n.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const s=e[r],i=e[r+1];if(-1!==i){const o=n.data[i];V8(s),o.contentQueries(2,t[i],i)}}}function tf(n,t,e,r,s,i,o,c,u,h,g){const m=t.blueprint.slice();return m[0]=s,m[2]=76|r,(null!==g||n&&1024&n[2])&&(m[2]|=1024),H_(m),m[3]=m[15]=n,m[8]=e,m[10]=o||n&&n[10],m[11]=c||n&&n[11],m[12]=u||n&&n[12]||null,m[9]=h||n&&n[9]||null,m[6]=i,m[20]=function ar(){return Vv++}(),m[21]=g,m[16]=2==t.type?n[16]:m,m}function m0(n,t,e,r,s){let i=n.data[t];if(null===i)i=nf(n,t,e,r,s),function oa(){return un.lFrame.inI18n}()&&(i.flags|=64);else if(64&i.type){i.type=e,i.value=r,i.attrs=s;const o=fl();i.injectorIndex=null===o?-1:o.injectorIndex}return Ec(i,!0),i}function nf(n,t,e,r,s){const i=F_(),o=Yr(),u=n.data[t]=function lB(n,t,e,r,s,i){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?i:i&&i.parent,e,t,r,s);return null===n.firstChild&&(n.firstChild=u),null!==i&&(o?null==i.child&&null!==u.parent&&(i.child=u):null===i.next&&(i.next=u)),u}function Nl(n,t,e,r){if(0===e)return-1;const s=t.length;for(let i=0;i<e;i++)t.push(r),n.blueprint.push(r),n.data.push(null);return s}function rf(n,t,e){hl(t);try{const r=n.viewQuery;null!==r&&ep(1,r,e);const s=n.template;null!==s&&kC(n,t,s,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&xC(n,t),n.staticViewQueries&&ep(2,n.viewQuery,e);const i=n.components;null!==i&&function kb(n,t){for(let e=0;e<t.length;e++)mB(n,t[e])}(t,i)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[2]&=-5,dl()}}function sf(n,t,e,r){const s=t[2];if(128!=(128&s)){hl(t);try{H_(t),function B_(n){return un.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&kC(n,t,e,2,r);const o=3==(3&s);if(o){const h=n.preOrderCheckHooks;null!==h&&ka(t,h,null)}else{const h=n.preOrderHooks;null!==h&&B8(t,h,0,null),$8(t,0)}if(function gB(n){for(let t=v9(n);null!==t;t=C9(t)){if(!t[2])continue;const e=t[9];for(let r=0;r<e.length;r++){const s=e[r],i=s[3];0==(512&s[2])&&Ed(i,1),s[2]|=512}}}(t),function Ub(n){for(let t=v9(n);null!==t;t=C9(t))for(let e=10;e<t.length;e++){const r=t[e],s=r[1];B6(r)&&sf(s,r,s.template,r[8])}}(t),null!==n.contentQueries&&xC(n,t),o){const h=n.contentCheckHooks;null!==h&&ka(t,h)}else{const h=n.contentHooks;null!==h&&B8(t,h,1),$8(t,1)}!function Y9(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const s=e[r];if(s<0)u3(~s);else{const i=s,o=e[++r],c=e[++r];RT(o,i),c(2,t[i])}}}finally{u3(-1)}}(n,t);const c=n.components;null!==c&&function xb(n,t){for(let e=0;e<t.length;e++)Gb(n,t[e])}(t,c);const u=n.viewQuery;if(null!==u&&ep(2,u,r),o){const h=n.viewCheckHooks;null!==h&&ka(t,h)}else{const h=n.viewHooks;null!==h&&B8(t,h,2),$8(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,Ed(t[3],-1))}finally{dl()}}}function kC(n,t,e,r,s){const i=d2(),o=2&r;try{u3(-1),o&&t.length>22&&mC(n,t,22,!1),e(r,s)}finally{u3(i)}}function LC(n,t,e){if(K2(t)){const s=t.directiveEnd;for(let i=t.directiveStart;i<s;i++){const o=n.data[i];o.contentQueries&&o.contentQueries(1,e[i],i)}}}function K9(n,t,e){!Md()||(function VC(n,t,e,r){const s=e.directiveStart,i=e.directiveEnd;n.firstCreatePass||g7(e,t),Vi(r,t);const o=e.initialInputs;for(let c=s;c<i;c++){const u=n.data[c],h=Ms(u);h&&Bb(t,e,u);const g=Fs(t,n,c,e);Vi(g,t),null!==o&&pB(0,c-s,g,u,0,o),h&&(ki(e.index,t)[8]=g)}}(n,t,e,f2(e,t)),128==(128&e.flags)&&function Vb(n,t,e){const r=e.directiveStart,s=e.directiveEnd,i=e.index,o=function Td(){return un.lFrame.currentDirectiveIndex}();try{u3(i);for(let c=r;c<s;c++){const u=n.data[c],h=t[c];l3(c),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&Hb(u,h)}}finally{u3(-1),l3(o)}}(n,t,e))}function _0(n,t,e=f2){const r=t.localNames;if(null!==r){let s=t.index+1;for(let i=0;i<r.length;i+=2){const o=r[i+1],c=-1===o?e(t,n):n[o];n[s++]=c}}}function RC(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=DC(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function DC(n,t,e,r,s,i,o,c,u,h){const g=22+r,m=g+s,E=function Lb(n,t){const e=[];for(let r=0;r<t;r++)e.push(r<n?null:mn);return e}(g,m),b="function"==typeof h?h():h;return E[1]={type:n,blueprint:E,template:e,queries:null,viewQuery:c,declTNode:t,data:E.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:b,incompleteFirstPass:!1}}function Db(n,t,e,r){const s=qC(t);null===e?s.push(r):(s.push(e),n.firstCreatePass&&WC(n).push(r,s.length-1))}function v0(n,t,e){for(let r in n)if(n.hasOwnProperty(r)){const s=n[r];(e=null===e?{}:e).hasOwnProperty(r)?e[r].push(t,s):e[r]=[t,s]}return e}function af(n,t){const r=t.directiveEnd,s=n.data,i=t.attrs,o=[];let c=null,u=null;for(let h=t.directiveStart;h<r;h++){const g=s[h],m=g.inputs,E=null===i||Cu(t)?null:$b(m,i);o.push(E),c=v0(m,h,c),u=v0(g.outputs,h,u)}null!==c&&(c.hasOwnProperty("class")&&(t.flags|=16),c.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=c,t.outputs=u}function wo(n,t,e,r,s,i,o,c){const u=f2(t,e);let g,h=t.inputs;!c&&null!=h&&(g=h[r])?(hf(n,e,g,r,s),na(t)&&zC(e,t.index)):3&t.type&&(r=function cf(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),s=null!=o?o(s,t.value||"",r):s,i.setProperty(u,r,s))}function zC(n,t){const e=ki(t,n);16&e[2]||(e[2]|=32)}function Il(n,t,e,r){let s=!1;if(Md()){const i=function HC(n,t,e){const r=n.directiveRegistry;let s=null;if(r)for(let i=0;i<r.length;i++){const o=r[i];hC(e,o.selectors,!1)&&(s||(s=[]),j6(g7(e,t),n,o.type),Ms(o)?(X9(n,e),s.unshift(o)):s.push(o))}return s}(n,t,e),o=null===r?null:{"":-1};if(null!==i){s=!0,FC(e,n.data.length,i.length);for(let g=0;g<i.length;g++){const m=i[g];m.providersResolver&&m.providersResolver(m)}let c=!1,u=!1,h=Nl(n,t,i.length,null);for(let g=0;g<i.length;g++){const m=i[g];e.mergedAttrs=W6(e.mergedAttrs,m.hostAttrs),BC(n,e,t,h,m),dB(h,m,o),null!==m.contentQueries&&(e.flags|=8),(null!==m.hostBindings||null!==m.hostAttrs||0!==m.hostVars)&&(e.flags|=128);const E=m.type.prototype;!c&&(E.ngOnChanges||E.ngOnInit||E.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),c=!0),!u&&(E.ngOnChanges||E.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),u=!0),h++}af(n,e)}o&&function Fb(n,t,e){if(t){const r=n.localNames=[];for(let s=0;s<t.length;s+=2){const i=e[t[s+1]];if(null==i)throw new Ne(-301,!1);r.push(t[s],i)}}}(e,r,o)}return e.mergedAttrs=W6(e.mergedAttrs,e.attrs),s}function lf(n,t,e,r,s,i){const o=i.hostBindings;if(o){let c=n.hostBindingOpCodes;null===c&&(c=n.hostBindingOpCodes=[]);const u=~t.index;(function zb(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(c)!=u&&c.push(u),c.push(r,s,o)}}function Hb(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function X9(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function dB(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;Ms(t)&&(e[""]=n)}}function FC(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function BC(n,t,e,r,s){n.data[r]=s;const i=s.factory||(s.factory=xa(s.type)),o=new U8(i,Ms(s),Q);n.blueprint[r]=o,e[r]=o,lf(n,t,0,r,Nl(n,e,s.hostVars,mn),s)}function Bb(n,t,e){const r=f2(t,n),s=RC(e),i=n[10],o=uf(n,tf(n,s,null,e.onPush?32:16,r,t,i,i.createRenderer(r,e),null,null,null));n[t.index]=o}function Oc(n,t,e,r,s,i){const o=f2(n,t);Q9(t[11],o,i,n.value,e,r,s)}function Q9(n,t,e,r,s,i,o){if(null==i)n.removeAttribute(t,s,e);else{const c=null==o?on(i):o(i,r||"",s);n.setAttribute(t,s,c,e)}}function pB(n,t,e,r,s,i){const o=i[t];if(null!==o){const c=r.setInput;for(let u=0;u<o.length;){const h=o[u++],g=o[u++],m=o[u++];null!==c?r.setInput(e,m,h,g):e[g]=m}}}function $b(n,t){let e=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;n.hasOwnProperty(s)&&(null===e&&(e=[]),e.push(s,n[s],t[r+1])),r+=2}else r+=2;else r+=4}return e}function $C(n,t,e,r){return new Array(n,!0,!1,t,null,0,r,e,null,null)}function Gb(n,t){const e=ki(t,n);if(B6(e)){const r=e[1];48&e[2]?sf(r,e,r.template,e[8]):e[5]>0&&J9(e)}}function J9(n){for(let r=v9(n);null!==r;r=C9(r))for(let s=10;s<r.length;s++){const i=r[s];if(B6(i))if(512&i[2]){const o=i[1];sf(o,i,o.template,i[8])}else i[5]>0&&J9(i)}const e=n[1].components;if(null!==e)for(let r=0;r<e.length;r++){const s=ki(e[r],n);B6(s)&&s[5]>0&&J9(s)}}function mB(n,t){const e=ki(t,n),r=e[1];(function qb(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(r,e),rf(r,e,e[8])}function uf(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function UC(n){for(;n;){n[2]|=32;const t=gu(n);if(V6(n)&&!t)return n;n=t}return null}function ff(n,t,e,r=!0){const s=t[10];s.begin&&s.begin();try{sf(n,t,n.template,e)}catch(o){throw r&&ZC(t,o),o}finally{s.end&&s.end()}}function ep(n,t,e){V8(0),t(n,e)}function qC(n){return n[7]||(n[7]=[])}function WC(n){return n.cleanup||(n.cleanup=[])}function ZC(n,t){const e=n[9],r=e?e.get(f0,null):null;r&&r.handleError(t)}function hf(n,t,e,r,s){for(let i=0;i<e.length;){const o=e[i++],c=e[i++],u=t[o],h=n.data[o];null!==h.setInput?h.setInput(u,s,r,c):u[c]=s}}function S3(n,t,e){const r=D8(t,n);Yv(n[11],r,e)}function Eu(n,t,e){let r=e?n.styles:null,s=e?n.classes:null,i=0;if(null!==t)for(let o=0;o<t.length;o++){const c=t[o];"number"==typeof c?i=c:1==i?s=O8(s,c):2==i&&(r=O8(r,c+": "+t[++o]+";"))}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=s:n.classesWithoutHost=s}function df(n,t,e,r,s=!1){for(;null!==e;){const i=t[e.index];if(null!==i&&r.push(Mr(i)),Er(i))for(let c=10;c<i.length;c++){const u=i[c],h=u[1].firstChild;null!==h&&df(u[1],u,h,r)}const o=e.type;if(8&o)df(n,t,e.child,r);else if(32&o){const c=_9(e,t);let u;for(;u=c();)r.push(u)}else if(16&o){const c=bl(t,e);if(Array.isArray(c))r.push(...c);else{const u=gu(t[16]);df(u[1],u,c,r,!0)}}e=s?e.projectionNext:e.next}return r}class pf{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return df(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Er(t)){const e=t[8],r=e?e.indexOf(this):-1;r>-1&&(M9(t,r),J6(e,r))}this._attachedToViewContainer=!1}Xv(this._lView[1],this._lView)}onDestroy(t){Db(this._lView[1],this._lView,null,t)}markForCheck(){UC(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){ff(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ne(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Xw(n,t){p0(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Ne(902,!1);this._appRef=t}}class jb extends pf{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;ff(t[1],t,t[8],!1)}checkNoChanges(){}get context(){return null}}class tp extends a0{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=b1(t);return new Mu(e,this.ngModule)}}function Zb(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class KC{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,r){const s=this.injector.get(t,u9,r);return s!==u9||e===u9?s:this.parentInjector.get(t,e,r)}}class Mu extends kv{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function cb(n){return n.map(ab).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Zb(this.componentDef.inputs)}get outputs(){return Zb(this.componentDef.outputs)}create(t,e,r,s){let i=(s=s||this.ngModule)instanceof Va?s:s?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const o=i?new KC(t,i):t,c=o.get(l0,null);if(null===c)throw new Ne(407,!1);const u=o.get(DF,null),h=c.createRenderer(null,this.componentDef),g=this.componentDef.selectors[0][0]||"div",m=r?function Rb(n,t,e){return n.selectRootElement(t,e===F1.ShadowDom)}(h,r,this.componentDef.encapsulation):E9(h,g,function YC(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(g)),E=this.componentDef.onPush?288:272,b=DC(0,null,null,1,0,null,null,null,null,null),k=tf(null,b,null,E,null,null,c,h,u,o,null);let U,j;hl(k);try{const oe=function Kb(n,t,e,r,s,i){const o=e[1];e[22]=n;const u=m0(o,22,2,"#host",null),h=u.mergedAttrs=t.hostAttrs;null!==h&&(Eu(u,h,!0),null!==n&&(Sc(s,n,h),null!==u.classes&&q7(s,n,u.classes),null!==u.styles&&vu(s,n,u.styles)));const g=r.createRenderer(n,t),m=tf(e,RC(t),null,t.onPush?32:16,e[22],u,r,g,i||null,null,null);return o.firstCreatePass&&(j6(g7(u,e),o,t.type),X9(o,u),FC(u,e.length,1)),uf(e,m),e[22]=m}(m,this.componentDef,k,c,h);if(m)if(r)Sc(h,m,["ng-version",Lv.full]);else{const{attrs:ye,classes:te}=function gC(n){const t=[],e=[];let r=1,s=2;for(;r<n.length;){let i=n[r];if("string"==typeof i)2===s?""!==i&&t.push(i,n[++r]):8===s&&e.push(i);else{if(!Fa(s))break;s=i}r++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);ye&&Sc(h,m,ye),te&&te.length>0&&q7(h,m,te.join(" "))}if(j=yd(b,22),void 0!==e){const ye=j.projection=[];for(let te=0;te<this.ngContentSelectors.length;te++){const ke=e[te];ye.push(null!=ke?Array.from(ke):null)}}U=function QC(n,t,e,r){const s=e[1],i=function hB(n,t,e){const r=Vr();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),BC(n,r,t,Nl(n,t,1,null),e),af(n,r));const s=Fs(t,n,r.directiveStart,r);Vi(s,t);const i=f2(r,t);return i&&Vi(i,t),s}(s,e,t);if(n[8]=e[8]=i,null!==r)for(const c of r)c(i,t);if(t.contentQueries){const c=Vr();t.contentQueries(1,i,c.directiveStart)}const o=Vr();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(u3(o.index),lf(e[1],o,0,o.directiveStart,o.directiveEnd,t),Hb(t,i)),i}(oe,this.componentDef,k,[d]),rf(b,k,null)}finally{dl()}return new Yb(this.componentType,U,c0(j,k),k,j)}}class Yb extends class mw{}{constructor(t,e,r,s,i){super(),this.location=r,this._rootLView=s,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new jb(s),this.componentType=t}setInput(t,e){const r=this._tNode.inputs;let s;if(null!==r&&(s=r[t])){const i=this._rootLView;hf(i[1],i,s,t,e),zC(i,this._tNode.index)}}get injector(){return new Z6(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function d(){const n=Vr();d3(De()[1],n)}function l(n){let t=function a(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const r=[n];for(;t;){let s;if(Ms(n))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Ne(903,!1);s=t.\u0275dir}if(s){if(e){r.push(s);const o=n;o.inputs=p(n.inputs),o.declaredInputs=p(n.declaredInputs),o.outputs=p(n.outputs);const c=s.hostBindings;c&&N(n,c);const u=s.viewQuery,h=s.contentQueries;if(u&&_(n,u),h&&M(n,h),sd(n.inputs,s.inputs),sd(n.declaredInputs,s.declaredInputs),sd(n.outputs,s.outputs),Ms(s)&&s.data.animation){const g=n.data;g.animation=(g.animation||[]).concat(s.data.animation)}}const i=s.features;if(i)for(let o=0;o<i.length;o++){const c=i[o];c&&c.ngInherit&&c(n),c===l&&(e=!1)}}t=Object.getPrototypeOf(t)}!function f(n){let t=0,e=null;for(let r=n.length-1;r>=0;r--){const s=n[r];s.hostVars=t+=s.hostVars,s.hostAttrs=W6(s.hostAttrs,e=W6(e,s.hostAttrs))}}(r)}function p(n){return n===K?{}:n===C1?[]:n}function _(n,t){const e=n.viewQuery;n.viewQuery=e?(r,s)=>{t(r,s),e(r,s)}:t}function M(n,t){const e=n.contentQueries;n.contentQueries=e?(r,s,i)=>{t(r,s,i),e(r,s,i)}:t}function N(n,t){const e=n.hostBindings;n.hostBindings=e?(r,s)=>{t(r,s),e(r,s)}:t}let se=null;function we(){if(!se){const n=K1.Symbol;if(n&&n.iterator)se=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const r=t[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(se=r)}}}return se}function Fe(n){return!!Ct(n)&&(Array.isArray(n)||!(n instanceof Map)&&we()in n)}function Ct(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Cn(n,t,e){return n[t]=e}function k1(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function E2(n,t,e,r){const s=k1(n,t,e);return k1(n,t+1,r)||s}function D(n,t,e,r){const s=De();return k1(s,U6(),t)&&(Qn(),Oc(O1(),s,n,t,e,r)),D}function h1(n,t,e,r){return k1(n,U6(),e)?t+on(e)+r:mn}function Bs(n,t,e,r,s,i){const c=E2(n,Mc(),e,s);return ia(2),c?t+on(e)+r+on(s)+i:mn}function ua(n,t,e,r,s,i,o,c){const h=function Ua(n,t,e,r,s){const i=E2(n,t,e,r);return k1(n,t+2,s)||i}(n,Mc(),e,s,o);return ia(3),h?t+on(e)+r+on(s)+i+on(o)+c:mn}function Su(n,t,e,r,s,i){const o=De(),c=h1(o,t,e,r);return c!==mn&&Oc(O1(),o,n,c,s,i),Su}function x(n,t,e,r,s,i,o,c){const u=De(),h=Qn(),g=n+22,m=h.firstCreatePass?function T4e(n,t,e,r,s,i,o,c,u){const h=t.consts,g=m0(t,n,4,o||null,c3(h,c));Il(t,e,g,c3(h,u)),d3(t,g);const m=g.tViews=DC(2,g,r,s,i,t.directiveRegistry,t.pipeRegistry,null,t.schemas,h);return null!==t.queries&&(t.queries.template(t,g),m.queries=t.queries.embeddedTView(g)),g}(g,h,u,t,e,r,s,i,o):h.data[g];Ec(m,!1);const E=u[11].createComment("");mu(h,u,E,m),Vi(E,u),uf(u,u[g]=$C(E,u,E,m)),ra(m)&&K9(h,u,m),null!=o&&_0(u,m,c)}function Fn(n){return ul(function u7(){return un.lFrame.contextLView}(),22+n)}function w(n,t,e){const r=De();return k1(r,U6(),t)&&wo(Qn(),O1(),r,n,t,r[11],e,!1),w}function Xb(n,t,e,r,s){const o=s?"class":"style";hf(n,e,t.inputs[o],o,r)}function O(n,t,e,r){const s=De(),i=Qn(),o=22+n,c=s[11],u=s[o]=E9(c,t,function h3(){return un.lFrame.currentNamespace}()),h=i.firstCreatePass?function b4e(n,t,e,r,s,i,o){const c=t.consts,h=m0(t,n,2,s,c3(c,i));return Il(t,e,h,c3(c,o)),null!==h.attrs&&Eu(h,h.attrs,!1),null!==h.mergedAttrs&&Eu(h,h.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,h),h}(o,i,s,0,t,e,r):i.data[o];Ec(h,!0);const g=h.mergedAttrs;null!==g&&Sc(c,u,g);const m=h.classes;null!==m&&q7(c,u,m);const E=h.styles;return null!==E&&vu(c,u,E),64!=(64&h.flags)&&mu(i,s,u,h),0===function AT(){return un.lFrame.elementDepthCount}()&&Vi(u,s),function NT(){un.lFrame.elementDepthCount++}(),ra(h)&&(K9(i,s,h),LC(i,h,s)),null!==r&&_0(s,h),O}function A(){let n=Vr();Yr()?Sd():(n=n.parent,Ec(n,!1));const t=n;!function IT(){un.lFrame.elementDepthCount--}();const e=Qn();return e.firstCreatePass&&(d3(e,n),K2(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function Ad(n){return 0!=(16&n.flags)}(t)&&Xb(e,t,De(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function G8(n){return 0!=(32&n.flags)}(t)&&Xb(e,t,De(),t.stylesWithoutHost,!1),A}function X(n,t,e,r){return O(n,t,e,r),A(),X}function hn(n,t,e){const r=De(),s=Qn(),i=n+22,o=s.firstCreatePass?function O4e(n,t,e,r,s){const i=t.consts,o=c3(i,r),c=m0(t,n,8,"ng-container",o);return null!==o&&Eu(c,o,!0),Il(t,e,c,c3(i,s)),null!==t.queries&&t.queries.elementStart(t,c),c}(i,s,r,t,e):s.data[i];Ec(o,!0);const c=r[i]=r[11].createComment("");return mu(s,r,c,o),Vi(c,r),ra(o)&&(K9(s,r,o),LC(s,o,r)),null!=e&&_0(r,o),hn}function dn(){let n=Vr();const t=Qn();return Yr()?Sd():(n=n.parent,Ec(n,!1)),t.firstCreatePass&&(d3(t,n),K2(n)&&t.queries.elementEnd(n)),dn}function Ae(){return De()}function np(n){return!!n&&"function"==typeof n.then}const Qb=function OB(n){return!!n&&"function"==typeof n.subscribe};function ee(n,t,e,r){const s=De(),i=Qn(),o=Vr();return function NB(n,t,e,r,s,i,o,c){const u=ra(r),g=n.firstCreatePass&&WC(n),m=t[8],E=qC(t);let b=!0;if(3&r.type||c){const j=f2(r,t),oe=c?c(j):j,ye=E.length,te=c?Ge=>c(Mr(Ge[r.index])):r.index;let ke=null;if(!c&&u&&(ke=function A4e(n,t,e,r){const s=n.cleanup;if(null!=s)for(let i=0;i<s.length-1;i+=2){const o=s[i];if(o===e&&s[i+1]===r){const c=t[7],u=s[i+2];return c.length>u?c[u]:null}"string"==typeof o&&(i+=2)}return null}(n,t,s,r.index)),null!==ke)(ke.__ngLastListenerFn__||ke).__ngNextListenerFn__=i,ke.__ngLastListenerFn__=i,b=!1;else{i=xB(r,t,m,i,!1);const Ge=e.listen(oe,s,i);E.push(i,Ge),g&&g.push(s,te,ye,ye+1)}}else i=xB(r,t,m,i,!1);const k=r.outputs;let U;if(b&&null!==k&&(U=k[s])){const j=U.length;if(j)for(let oe=0;oe<j;oe+=2){const Xe=t[U[oe]][U[oe+1]].subscribe(i),Bt=E.length;E.push(i,Xe),g&&g.push(s,r.index,Bt,-(Bt+1))}}}(i,s,s[11],o,n,t,0,r),ee}function IB(n,t,e,r){try{return!1!==e(r)}catch(s){return ZC(n,s),!1}}function xB(n,t,e,r,s){return function i(o){if(o===Function)return r;UC(2&n.flags?ki(n.index,t):t);let u=IB(t,0,r,o),h=i.__ngNextListenerFn__;for(;h;)u=IB(t,0,h,o)&&u,h=h.__ngNextListenerFn__;return s&&!1===u&&(o.preventDefault(),o.returnValue=!1),u}}function C(n=1){return function d7(n){return(un.lFrame.contextLView=function F8(n,t){for(;n>0;)t=t[15],n--;return t}(n,un.lFrame.contextLView))[8]}(n)}function N4e(n,t){let e=null;const r=function dC(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let s=0;s<t.length;s++){const i=t[s];if("*"!==i){if(null===r?hC(n,i,!0):pC(r,i))return s}else e=s}return e}function d1(n,t,e,r,s){const i=De(),o=h1(i,t,e,r);return o!==mn&&wo(Qn(),O1(),i,n,o,i[11],s,!1),d1}function Re(n,t,e,r,s,i,o){const c=De(),u=Bs(c,t,e,r,s,i);return u!==mn&&wo(Qn(),O1(),c,n,u,c[11],o,!1),Re}function Q2(n,t,e,r,s,i,o,c,u){const h=De(),g=ua(h,t,e,r,s,i,o,c);return g!==mn&&wo(Qn(),O1(),h,n,g,h[11],u,!1),Q2}function $B(n,t,e,r,s){const i=n[e+1],o=null===t;let c=r?Ba(i):bc(i),u=!1;for(;0!==c&&(!1===u||o);){const g=n[c+1];k4e(n[c],t)&&(u=!0,n[c+1]=r?$9(g):B9(g)),c=r?Ba(g):bc(g)}u&&(n[e+1]=r?B9(i):$9(i))}function k4e(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&m2(n,t)>=0}const hi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function UB(n){return n.substring(hi.key,hi.keyEnd)}function L4e(n){return n.substring(hi.value,hi.valueEnd)}function qB(n,t){const e=hi.textEnd;let r=hi.key=gf(n,t,e);return e===r?-1:(r=hi.keyEnd=function V4e(n,t,e){let r;for(;t<e&&(45===(r=n.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(n,r,e),r=jB(n,r,e),r=hi.value=gf(n,r,e),r=hi.valueEnd=function H4e(n,t,e){let r=-1,s=-1,i=-1,o=t,c=o;for(;o<e;){const u=n.charCodeAt(o++);if(59===u)return c;34===u||39===u?c=o=ZB(n,u,o,e):t===o-4&&85===i&&82===s&&76===r&&40===u?c=o=ZB(n,41,o,e):u>32&&(c=o),i=s,s=r,r=-33&u}return c}(n,r,e),jB(n,r,e))}function gf(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function jB(n,t,e,r){return(t=gf(n,t,e))<e&&t++,t}function ZB(n,t,e,r){let s=-1,i=e;for(;i<r;){const o=n.charCodeAt(i++);if(o==t&&92!==s)return i;s=92==o&&92===s?0:o}throw new Error}function JC(n,t){return function P3(n,t,e,r){const s=De(),i=Qn(),o=ia(2);i.firstUpdatePass&&XB(i,n,o,r),t!==mn&&k1(s,o,t)&&JB(i,i.data[d2()],s,s[11],n,s[o+1]=function Z4e(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=j1(Eo(n)))),n}(t,e),r,o)}(n,t,null,!0),JC}function S2(n){!function T3(n,t,e,r){const s=Qn(),i=ia(2);s.firstUpdatePass&&XB(s,null,i,r);const o=De();if(e!==mn&&k1(o,i,e)){const c=s.data[d2()];if(t$(c,r)&&!KB(s,i)){let u=r?c.classesWithoutHost:c.stylesWithoutHost;null!==u&&(e=O8(u,e||"")),Xb(s,c,o,e,r)}else!function j4e(n,t,e,r,s,i,o,c){s===mn&&(s=C1);let u=0,h=0,g=0<s.length?s[0]:null,m=0<i.length?i[0]:null;for(;null!==g||null!==m;){const E=u<s.length?s[u+1]:void 0,b=h<i.length?i[h+1]:void 0;let U,k=null;g===m?(u+=2,h+=2,E!==b&&(k=m,U=b)):null===m||null!==g&&g<m?(u+=2,k=g):(h+=2,k=m,U=b),null!==k&&JB(n,t,e,r,k,U,o,c),g=u<s.length?s[u]:null,m=h<i.length?i[h]:null}}(s,c,o,o[11],o[i+1],o[i+1]=function W4e(n,t,e){if(null==e||""===e)return C1;const r=[],s=Eo(e);if(Array.isArray(s))for(let i=0;i<s.length;i++)n(r,s[i],!0);else if("object"==typeof s)for(const i in s)s.hasOwnProperty(i)&&n(r,i,s[i]);else"string"==typeof s&&t(r,s);return r}(n,t,e),r,i)}}(QB,F4e,n,!1)}function F4e(n,t){for(let e=function D4e(n){return function WB(n){hi.key=0,hi.keyEnd=0,hi.value=0,hi.valueEnd=0,hi.textEnd=n.length}(n),qB(n,gf(n,0,hi.textEnd))}(t);e>=0;e=qB(t,e))QB(n,UB(t),L4e(t))}function KB(n,t){return t>=n.expandoStartIndex}function XB(n,t,e,r){const s=n.data;if(null===s[e+1]){const i=s[d2()],o=KB(n,e);t$(i,r)&&null===t&&!o&&(t=!1),t=function $4e(n,t,e,r){const s=function f7(n){const t=un.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let i=r?t.residualClasses:t.residualStyles;if(null===s)0===(r?t.classBindings:t.styleBindings)&&(e=rp(e=Jb(null,n,t,e,r),t.attrs,r),i=null);else{const o=t.directiveStylingLast;if(-1===o||n[o]!==s)if(e=Jb(s,n,t,e,r),null===i){let u=function U4e(n,t,e){const r=e?t.classBindings:t.styleBindings;if(0!==bc(r))return n[Ba(r)]}(n,t,r);void 0!==u&&Array.isArray(u)&&(u=Jb(null,n,t,u[1],r),u=rp(u,t.attrs,r),function G4e(n,t,e,r){n[Ba(e?t.classBindings:t.styleBindings)]=r}(n,t,r,u))}else i=function q4e(n,t,e){let r;const s=t.directiveEnd;for(let i=1+t.directiveStylingLast;i<s;i++)r=rp(r,n[i].hostAttrs,e);return rp(r,t.attrs,e)}(n,t,r)}return void 0!==i&&(r?t.residualClasses=i:t.residualStyles=i),e}(s,i,t,r),function I4e(n,t,e,r,s,i){let o=i?t.classBindings:t.styleBindings,c=Ba(o),u=bc(o);n[r]=e;let g,h=!1;if(Array.isArray(e)){const m=e;g=m[1],(null===g||m2(m,g)>0)&&(h=!0)}else g=e;if(s)if(0!==u){const E=Ba(n[c+1]);n[r+1]=K7(E,c),0!==E&&(n[E+1]=Al(n[E+1],r)),n[c+1]=function XF(n,t){return 131071&n|t<<17}(n[c+1],r)}else n[r+1]=K7(c,0),0!==c&&(n[c+1]=Al(n[c+1],r)),c=r;else n[r+1]=K7(u,0),0===c?c=r:n[u+1]=Al(n[u+1],r),u=r;h&&(n[r+1]=B9(n[r+1])),$B(n,g,r,!0),$B(n,g,r,!1),function x4e(n,t,e,r,s){const i=s?n.residualClasses:n.residualStyles;null!=i&&"string"==typeof t&&m2(i,t)>=0&&(e[r+1]=$9(e[r+1]))}(t,g,n,r,i),o=K7(c,u),i?t.classBindings=o:t.styleBindings=o}(s,i,t,e,o,r)}}function Jb(n,t,e,r,s){let i=null;const o=e.directiveEnd;let c=e.directiveStylingLast;for(-1===c?c=e.directiveStart:c++;c<o&&(i=t[c],r=rp(r,i.hostAttrs,s),i!==n);)c++;return null!==n&&(e.directiveStylingLast=c),r}function rp(n,t,e){const r=e?1:2;let s=-1;if(null!==t)for(let i=0;i<t.length;i++){const o=t[i];"number"==typeof o?s=o:s===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),g2(n,o,!!e||t[++i]))}return void 0===n?null:n}function QB(n,t,e){g2(n,t,Eo(e))}function JB(n,t,e,r,s,i,o,c){if(!(3&t.type))return;const u=n.data,h=u[c+1];ey(function wC(n){return 1==(1&n)}(h)?e$(u,t,e,s,bc(h),o):void 0)||(ey(i)||function Eb(n){return 2==(2&n)}(h)&&(i=e$(u,null,e,s,c,o)),function aC(n,t,e,r,s){if(t)s?n.addClass(e,r):n.removeClass(e,r);else{let i=-1===r.indexOf("-")?void 0:y2.DashCase;null==s?n.removeStyle(e,r,i):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),i|=y2.Important),n.setStyle(e,r,s,i))}}(r,o,D8(d2(),e),s,i))}function e$(n,t,e,r,s,i){const o=null===t;let c;for(;s>0;){const u=n[s],h=Array.isArray(u),g=h?u[1]:u,m=null===g;let E=e[s+1];E===mn&&(E=m?C1:void 0);let b=m?ci(E,r):g===r?E:void 0;if(h&&!ey(b)&&(b=ci(u,r)),ey(b)&&(c=b,o))return c;const k=n[s+1];s=o?Ba(k):bc(k)}if(null!==t){let u=i?t.residualClasses:t.residualStyles;null!=u&&(c=ci(u,r))}return c}function ey(n){return void 0!==n}function t$(n,t){return 0!=(n.flags&(t?16:32))}function Tt(n,t=""){const e=De(),r=Qn(),s=n+22,i=r.firstCreatePass?m0(r,s,1,t,null):r.data[s],o=e[s]=y9(e[11],t);mu(r,e,o,i),Ec(i,!1)}function a1(n){return Hi("",n,""),a1}function Hi(n,t,e){const r=De(),s=h1(r,n,t,e);return s!==mn&&S3(r,d2(),s),Hi}function eO(n,t,e,r,s){const i=De(),o=Bs(i,n,t,e,r,s);return o!==mn&&S3(i,d2(),o),eO}function tO(n,t,e,r,s,i,o){const c=De(),u=ua(c,n,t,e,r,s,i,o);return u!==mn&&S3(c,d2(),u),tO}function nO(n,t,e){const r=De();return k1(r,U6(),t)&&wo(Qn(),O1(),r,n,t,r[11],e,!0),nO}const Pu=void 0;var ple=["en",[["a","p"],["AM","PM"],Pu],[["AM","PM"],Pu,Pu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Pu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Pu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Pu,"{1} 'at' {0}",Pu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function dle(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===r?1:5}];let mf={};function Ao(n){const t=function mle(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=C$(t);if(e)return e;const r=t.split("-")[0];if(e=C$(r),e)return e;if("en"===r)return ple;throw new Ne(701,!1)}function C$(n){return n in mf||(mf[n]=K1.ng&&K1.ng.common&&K1.ng.common.locales&&K1.ng.common.locales[n]),mf[n]}var vt=(()=>((vt=vt||{})[vt.LocaleId=0]="LocaleId",vt[vt.DayPeriodsFormat=1]="DayPeriodsFormat",vt[vt.DayPeriodsStandalone=2]="DayPeriodsStandalone",vt[vt.DaysFormat=3]="DaysFormat",vt[vt.DaysStandalone=4]="DaysStandalone",vt[vt.MonthsFormat=5]="MonthsFormat",vt[vt.MonthsStandalone=6]="MonthsStandalone",vt[vt.Eras=7]="Eras",vt[vt.FirstDayOfWeek=8]="FirstDayOfWeek",vt[vt.WeekendRange=9]="WeekendRange",vt[vt.DateFormat=10]="DateFormat",vt[vt.TimeFormat=11]="TimeFormat",vt[vt.DateTimeFormat=12]="DateTimeFormat",vt[vt.NumberSymbols=13]="NumberSymbols",vt[vt.NumberFormats=14]="NumberFormats",vt[vt.CurrencyCode=15]="CurrencyCode",vt[vt.CurrencySymbol=16]="CurrencySymbol",vt[vt.CurrencyName=17]="CurrencyName",vt[vt.Currencies=18]="Currencies",vt[vt.Directionality=19]="Directionality",vt[vt.PluralCase=20]="PluralCase",vt[vt.ExtraData=21]="ExtraData",vt))();const _le=["zero","one","two","few","many"],_f="en-US",ty={marker:"element"},ny={marker:"ICU"};var ls=(()=>((ls=ls||{})[ls.SHIFT=2]="SHIFT",ls[ls.APPEND_EAGERLY=1]="APPEND_EAGERLY",ls[ls.COMMENT=2]="COMMENT",ls))();let y$=_f;function E$(n){(function _o(n,t){null==n&&w1(t,n,null,"!=")})(n,"Expected localeId to be defined"),"string"==typeof n&&(y$=n.toLowerCase().replace(/_/g,"-"))}function M$(n,t,e){const r=t.insertBeforeIndex,s=Array.isArray(r)?r[0]:r;return null===s?rC(n,0,e):Mr(e[s])}function S$(n,t,e,r,s){const i=t.insertBeforeIndex;if(Array.isArray(i)){let o=r,c=null;if(3&t.type||(c=o,o=s),null!==o&&0==(2&t.flags))for(let u=1;u<i.length;u++)y3(n,o,e[i[u]],c,!1)}}function P$(n,t){if(n.push(t),n.length>1)for(let e=n.length-2;e>=0;e--){const r=n[e];T$(r)||Ele(r,t)&&null===Mle(r)&&Sle(r,t.index)}}function T$(n){return!(64&n.type)}function Ele(n,t){return T$(t)||n.index>t.index}function Mle(n){const t=n.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function Sle(n,t){const e=n.insertBeforeIndex;Array.isArray(e)?e[0]=t:(G7(M$,S$),n.insertBeforeIndex=t)}function sp(n,t){const e=n.data[t];return null===e||"string"==typeof e?null:e.hasOwnProperty("currentCaseLViewIndex")?e:e.value}function wle(n,t,e){const r=nf(n,e,64,null,null);return P$(t,r),r}function ry(n,t){const e=t[n.currentCaseLViewIndex];return null===e?e:e<0?~e:e}function w$(n){return n>>>17}function b$(n){return(131070&n)>>>1}let ip=0,op=0;function A$(n,t,e,r){const s=e[11];let o,i=null;for(let c=0;c<t.length;c++){const u=t[c];if("string"==typeof u){const h=t[++c];null===e[h]&&(e[h]=y9(s,u))}else if("number"==typeof u)switch(1&u){case 0:const h=w$(u);let g,m;if(null===i&&(i=h,o=h0(s,r)),h===i?(g=r,m=o):(g=null,m=Mr(e[h])),null!==m){const U=b$(u);y3(s,m,e[U],g,!1);const oe=sp(n,U);if(null!==oe&&"object"==typeof oe){const ye=ry(oe,e);null!==ye&&A$(n,oe.create[ye],e,e[oe.anchorIdx])}}break;case 1:const b=t[++c],k=t[++c];Q9(s,D8(u>>>1,e),null,null,b,k,null)}else switch(u){case ny:const h=t[++c],g=t[++c];null===e[g]&&Vi(e[g]=Zw(s,h),e);break;case ty:const m=t[++c],E=t[++c];null===e[E]&&Vi(e[E]=E9(s,m,null),e)}}}function N$(n,t,e,r,s){for(let i=0;i<e.length;i++){const o=e[i],c=e[++i];if(o&s){let u="";for(let h=i+1;h<=i+c;h++){const g=e[h];if("string"==typeof g)u+=g;else if("number"==typeof g)if(g<0)u+=on(t[r-g]);else{const m=g>>>2;switch(3&g){case 1:const E=e[++h],b=e[++h],k=n.data[m];"string"==typeof k?Q9(t[11],t[m],null,k,E,u,b):wo(n,k,t,E,u,t[11],b,!1);break;case 0:const U=t[m];null!==U&&Yv(t[11],U,u);break;case 2:Ile(n,sp(n,m),t,u);break;case 3:I$(n,sp(n,m),r,t)}}}}else{const u=e[i+1];if(u>0&&3==(3&u)){const g=sp(n,u>>>2);t[g.currentCaseLViewIndex]<0&&I$(n,g,r,t)}}i+=c}}function I$(n,t,e,r){let s=r[t.currentCaseLViewIndex];if(null!==s){let i=ip;s<0&&(s=r[t.currentCaseLViewIndex]=~s,i=-1),N$(n,r,t.update[s],e,i)}}function Ile(n,t,e,r){const s=function xle(n,t){let e=n.cases.indexOf(t);if(-1===e)switch(n.type){case 1:{const r=function vle(n,t){const e=function v$(n){return Ao(n)[vt.PluralCase]}(t)(parseInt(n,10)),r=_le[e];return void 0!==r?r:"other"}(t,function yle(){return y$}());e=n.cases.indexOf(r),-1===e&&"other"!==r&&(e=n.cases.indexOf("other"));break}case 0:e=n.cases.indexOf("other")}return-1===e?null:e}(t,r);if(ry(t,e)!==s&&(x$(n,t,e),e[t.currentCaseLViewIndex]=null===s?null:~s,null!==s)){const o=e[t.anchorIdx];o&&A$(n,t.create[s],e,o)}}function x$(n,t,e){let r=ry(t,e);if(null!==r){const s=t.remove[r];for(let i=0;i<s.length;i++){const o=s[i];if(o>0){const c=D8(o,e);null!==c&&iC(e[11],c)}else x$(n,sp(n,~o),e)}}}function kle(){const n=[];let e,r,t=-1;function i(c,u){t=0;const h=ry(c,u);r=null!==h?c.remove[h]:C1}function o(){if(t<r.length){const c=r[t++];return c>0?e[c]:(n.push(t,r),i(e[1].data[~c],e),o())}return 0===n.length?null:(r=n.pop(),t=n.pop(),o())}return function s(c,u){for(e=u;n.length;)n.pop();return i(c.value,u),o}}const sy=/\ufffd(\d+):?\d*\ufffd/gi,Rle=/\ufffd(\d+)\ufffd/,L$=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,Dle=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,zle=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,Vle=/\uE500/g;function R$(n,t,e,r,s,i,o){const c=Nl(n,r,1,null);let u=c<<ls.SHIFT,h=fl();t===h&&(h=null),null===h&&(u|=ls.APPEND_EAGERLY),o&&(u|=ls.COMMENT,function jv(n){void 0===m9&&(m9=n())}(kle)),s.push(u,null===i?"":i);const g=nf(n,c,o?32:1,null===i?"":i,null);P$(e,g);const m=g.index;return Ec(g,!1),null!==h&&t!==h&&function Tle(n,t){let e=n.insertBeforeIndex;null===e?(G7(M$,S$),e=n.insertBeforeIndex=[null,t]):(function f1(n,t,e){n!=t&&w1(e,n,t,"==")}(Array.isArray(e),!0,"Expecting array here"),e.push(t))}(h,m),g}function Ble(n,t,e,r,s,i,o){const c=o.match(sy),u=R$(n,t,e,i,r,c?null:o,!1);c&&cp(s,o,u.index,null,0,null)}function cp(n,t,e,r,s,i){const o=n.length,c=o+1;n.push(null,null);const u=o+2,h=t.split(sy);let g=0;for(let m=0;m<h.length;m++){const E=h[m];if(1&m){const b=s+parseInt(E,10);n.push(-1-b),g|=D$(b)}else""!==E&&n.push(E)}return n.push(e<<2|(r?1:0)),r&&n.push(r,i),n[o]=g,n[c]=n.length-u,g}function D$(n){return 1<<Math.min(n,31)}function z$(n){let t,i,e="",r=0,s=!1;for(;null!==(t=Dle.exec(n));)s?t[0]===`\ufffd/*${i}\ufffd`&&(r=t.index,s=!1):(e+=n.substring(r,t.index+t[0].length),i=t[1],s=!0);return e+=n.slice(r),e}function V$(n,t,e,r,s,i){let o=0;const c={type:s.type,currentCaseLViewIndex:Nl(n,t,1,null),anchorIdx:i,cases:[],create:[],remove:[],update:[]};(function Yle(n,t,e){n.push(D$(t.mainBinding),2,-1-t.mainBinding,e<<2|2)})(e,s,i),function Ple(n,t,e){const r=n.data[t];null===r?n.data[t]=e:r.value=e}(n,i,c);const u=s.values;for(let h=0;h<u.length;h++){const g=u[h],m=[];for(let E=0;E<g.length;E++){const b=g[E];if("string"!=typeof b){const k=m.push(b)-1;g[E]=`\x3c!--\ufffd${k}\ufffd--\x3e`}}o=jle(n,c,t,e,r,s.cases[h],g.join(""),m)|o}o&&function Kle(n,t,e){n.push(t,1,e<<2|3)}(e,o,i)}function Wle(n){const t=[],e=[];let r=1,s=0;const i=rO(n=n.replace(L$,function(o,c,u){return r="select"===u?0:1,s=parseInt(c.slice(1),10),""}));for(let o=0;o<i.length;){let c=i[o++].trim();1===r&&(c=c.replace(/\s*(?:=)?(\w+)\s*/,"$1")),c.length&&t.push(c);const u=rO(i[o++]);t.length>e.length&&e.push(u)}return{type:r,mainBinding:s,cases:t,values:e}}function rO(n){if(!n)return[];let t=0;const e=[],r=[],s=/[{}]/g;let i;for(s.lastIndex=0;i=s.exec(n);){const c=i.index;if("}"==i[0]){if(e.pop(),0==e.length){const u=n.substring(t,c);L$.test(u)?r.push(Wle(u)):r.push(u),t=c+1}}else{if(0==e.length){const u=n.substring(t,c);r.push(u),t=c+1}e.push("{")}}const o=n.substring(t);return r.push(o),r}function jle(n,t,e,r,s,i,o,c){const u=[],h=[],g=[];t.cases.push(i),t.create.push(u),t.remove.push(h),t.update.push(g);const E=gv(cv()).getInertBodyElement(o),b=So(E)||E;return b?H$(n,t,e,r,u,h,g,b,s,c,0):0}function H$(n,t,e,r,s,i,o,c,u,h,g){let m=0,E=c.firstChild;for(;E;){const b=Nl(n,e,1,null);switch(E.nodeType){case Node.ELEMENT_NODE:const k=E,U=k.tagName.toLowerCase();if(su.hasOwnProperty(U)){sO(s,ty,U,u,b),n.data[b]=U;const te=k.attributes;for(let ke=0;ke<te.length;ke++){const Ge=te.item(ke),Xe=Ge.name.toLowerCase();Ge.value.match(sy)?I7.hasOwnProperty(Xe)&&cp(o,Ge.value,b,Ge.name,0,N7[Xe]?la:null):Xle(s,b,Ge)}m=H$(n,t,e,r,s,i,o,E,b,h,g+1)|m,F$(i,b,g)}break;case Node.TEXT_NODE:const j=E.textContent||"",oe=j.match(sy);sO(s,null,oe?"":j,u,b),F$(i,b,g),oe&&(m=cp(o,j,b,null,0,null)|m);break;case Node.COMMENT_NODE:const ye=Rle.exec(E.textContent||"");if(ye){const ke=h[parseInt(ye[1],10)];sO(s,ny,"",u,b),V$(n,e,r,u,ke,b),Zle(i,b,g)}}E=E.nextSibling}return m}function F$(n,t,e){0===e&&n.push(t)}function Zle(n,t,e){0===e&&(n.push(~t),n.push(t))}function sO(n,t,e,r,s){null!==t&&n.push(t),n.push(e,s,function ble(n,t,e){return n|t<<17|e<<1}(0,r,s))}function Xle(n,t,e){n.push(t<<1|1,e.name,e.value)}function ha(n,t,e=-1){const r=Qn(),s=De(),i=22+n,o=c3(r.consts,t),c=fl();r.firstCreatePass&&function Fle(n,t,e,r,s,i){const o=fl(),c=[],u=[],h=[[]];s=function qle(n,t){if(function Gle(n){return-1===n}(t))return z$(n);{const e=n.indexOf(`:${t}\ufffd`)+2+t.toString().length,r=n.search(new RegExp(`\ufffd\\/\\*\\d+:${t}\ufffd`));return z$(n.substring(e,r))}}(s,i);const g=function Hle(n){return n.replace(Vle," ")}(s).split(zle);for(let m=0;m<g.length;m++){let E=g[m];if(0==(1&m)){const b=rO(E);for(let k=0;k<b.length;k++){let U=b[k];if(0==(1&k)){const j=U;""!==j&&Ble(n,o,h[0],c,u,e,j)}else{const j=U;if("object"!=typeof j)throw new Error(`Unable to parse ICU expression in "${s}" message.`);V$(n,e,u,t,j,R$(n,o,h[0],e,c,"",!0).index)}}}else{const b=47===E.charCodeAt(0),U=(E.charCodeAt(b?1:0),22+Number.parseInt(E.substring(b?2:1)));if(b)h.shift(),Ec(fl(),!1);else{const j=wle(n,h[0],U);h.unshift([]),Ec(j,!0)}}}n.data[r]={create:c,update:u}}(r,null===c?0:c.index,s,i,o,e);const u=r.data[i],g=T9(r,c===s[6]?null:c,s);(function Nle(n,t,e,r){const s=n[11];for(let i=0;i<t.length;i++){const o=t[i++],c=t[i],u=(o&ls.COMMENT)===ls.COMMENT,h=(o&ls.APPEND_EAGERLY)===ls.APPEND_EAGERLY,g=o>>>ls.SHIFT;let m=n[g];null===m&&(m=n[g]=u?s.createComment(c):y9(s,c)),h&&null!==e&&y3(s,e,m,r,!1)}})(s,u.create,g,c&&8&c.type?s[c.index]:null),h2(!0)}function da(){h2(!1)}function ve(n,t,e){ha(n,t,e),da()}function y1(n){return function Ole(n){n&&(ip|=1<<Math.min(op,31)),op++}(k1(De(),U6(),n)),y1}function A1(n){!function Ale(n,t,e){if(op>0){const r=n.data[e];N$(n,t,Array.isArray(r)?r:r.update,Mc()-op-1,ip)}ip=0,op=0}(Qn(),De(),n+22)}function iO(n,t,e,r,s){if(n=sn(n),Array.isArray(n))for(let i=0;i<n.length;i++)iO(n[i],t,e,r,s);else{const i=Qn(),o=De();let c=Pl(n)?n:sn(n.provide),u=D7(n);const h=Vr(),g=1048575&h.providerIndexes,m=h.directiveStart,E=h.providerIndexes>>20;if(Pl(n)||!n.multi){const b=new U8(u,s,Q),k=aO(c,t,s?g:g+E,m);-1===k?(j6(g7(h,o),i,c),oO(i,n,t.length),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(b),o.push(b)):(e[k]=b,o[k]=b)}else{const b=aO(c,t,g+E,m),k=aO(c,t,g,g+E),U=b>=0&&e[b],j=k>=0&&e[k];if(s&&!j||!s&&!U){j6(g7(h,o),i,c);const oe=function f6e(n,t,e,r,s){const i=new U8(n,e,Q);return i.multi=[],i.index=t,i.componentProviders=0,$$(i,s,r&&!e),i}(s?u6e:l6e,e.length,s,r,u);!s&&j&&(e[k].providerFactory=oe),oO(i,n,t.length,0),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(oe),o.push(oe)}else oO(i,n,b>-1?b:k,$$(e[s?k:b],u,!s&&r));!s&&r&&j&&e[k].componentProviders++}}}function oO(n,t,e,r){const s=Pl(t),i=function dw(n){return!!n.useClass}(t);if(s||i){const u=(i?sn(t.useClass):t).prototype.ngOnDestroy;if(u){const h=n.destroyHooks||(n.destroyHooks=[]);if(!s&&t.multi){const g=h.indexOf(e);-1===g?h.push(e,[r,u]):h[g+1].push(r,u)}else h.push(e,u)}}}function $$(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function aO(n,t,e,r){for(let s=e;s<r;s++)if(t[s]===n)return s;return-1}function l6e(n,t,e,r){return cO(this.multi,[])}function u6e(n,t,e,r){const s=this.multi;let i;if(this.providerFactory){const o=this.providerFactory.componentProviders,c=Fs(e,e[1],this.providerFactory.index,r);i=c.slice(0,o),cO(s,i);for(let u=o;u<c.length;u++)i.push(c[u])}else i=[],cO(s,i);return i}function cO(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Fr(n,t=[]){return e=>{e.providersResolver=(r,s)=>function c6e(n,t,e){const r=Qn();if(r.firstCreatePass){const s=Ms(n);iO(e,r.data,r.blueprint,s,!0),iO(t,r.data,r.blueprint,s,!1)}}(r,s?s(n):n,t)}}class Tu{}class U${}class G$ extends Tu{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new tp(this);const r=vo(t);this._bootstrapComponents=Ha(r.bootstrap),this._r3Injector=CC(t,e,[{provide:Tu,useValue:this},{provide:a0,useValue:this.componentFactoryResolver}],j1(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class lO extends U${constructor(t){super(),this.moduleType=t}create(t){return new G$(this.moduleType,t)}}class d6e extends Tu{constructor(t,e,r){super(),this.componentFactoryResolver=new tp(this),this.instance=null;const s=new R7([...t,{provide:Tu,useValue:this},{provide:a0,useValue:this.componentFactoryResolver}],e||u4(),r,new Set(["environment"]));this.injector=s,s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function iy(n,t,e=null){return new d6e(n,t,e).injector}let p6e=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const r=s9(0,e.type),s=r.length>0?iy([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,s)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=et({token:n,providedIn:"environment",factory:()=>new n(Ve(Va))}),n})();function q$(n){n.getStandaloneInjector=t=>t.get(p6e).getOrCreateStandaloneInjector(n)}function J1(n,t,e){const r=Li()+n,s=De();return s[r]===mn?Cn(s,r,e?t.call(e):t()):function Q1(n,t){return n[t]}(s,r)}function w3(n,t,e,r){return Q$(De(),Li(),n,t,e,r)}function lp(n,t){const e=n[t];return e===mn?void 0:e}function Q$(n,t,e,r,s,i){const o=t+e;return k1(n,o,s)?Cn(n,o+1,i?r.call(i,s):r(s)):lp(n,o+1)}function b3(n,t){const e=Qn();let r;const s=n+22;e.firstCreatePass?(r=function I6e(n,t){if(t)for(let e=t.length-1;e>=0;e--){const r=t[e];if(n===r.name)return r}}(t,e.pipeRegistry),e.data[s]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(s,r.onDestroy)):r=e.data[s];const i=r.factory||(r.factory=xa(r.type)),o=Qo(Q);try{const c=s4(!1),u=i();return s4(c),function w4e(n,t,e,r){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=r}(e,De(),s,u),u}finally{Qo(o)}}function _4(n,t,e){const r=n+22,s=De(),i=ul(s,r);return up(s,r)?Q$(s,Li(),t,i.transform,e,i):i.transform(e)}function rU(n,t,e,r){const s=n+22,i=De(),o=ul(i,s);return up(i,s)?function J$(n,t,e,r,s,i,o){const c=t+e;return E2(n,c,s,i)?Cn(n,c+2,o?r.call(o,s,i):r(s,i)):lp(n,c+2)}(i,Li(),t,o.transform,e,r,o):o.transform(e,r)}function up(n,t){return n[1].data[t].pure}function fO(n){return t=>{setTimeout(n,void 0,t)}}const hr=class R6e extends q2{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,r){let s=t,i=e||(()=>null),o=r;if(t&&"object"==typeof t){const u=t;s=u.next?.bind(u),i=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(i=fO(i),s&&(s=fO(s)),o&&(o=fO(o)));const c=super.subscribe({next:s,error:i,complete:o});return t instanceof H1&&t.add(c),c}};function D6e(){return this._results[we()]()}class hO{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=we(),r=hO.prototype;r[e]||(r[e]=D6e)}get changes(){return this._changes||(this._changes=new hr)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const r=this;r.dirty=!1;const s=p2(t);(this._changesDetected=!function Vd(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++){let s=n[r],i=t[r];if(e&&(s=e(s),i=e(i)),i!==s)return!1}return!0}(r._results,s,e))&&(r._results=s,r.length=s.length,r.last=s[this.length-1],r.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let xl=(()=>{class n{}return n.__NG_ELEMENT_ID__=H6e,n})();const z6e=xl,V6e=class extends z6e{constructor(t,e,r){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(t,e){const r=this._declarationTContainer.tViews,s=tf(this._declarationLView,r,t,16,null,r.declTNode,null,null,null,null,e||null);s[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(s[19]=o.createEmbeddedView(r)),rf(r,s,t),new pf(s)}};function H6e(){return oy(Vr(),De())}function oy(n,t){return 4&n.type?new V6e(t,n,c0(n,t)):null}let Ga=(()=>{class n{}return n.__NG_ELEMENT_ID__=F6e,n})();function F6e(){return oU(Vr(),De())}const B6e=Ga,sU=class extends B6e{constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return c0(this._hostTNode,this._hostLView)}get injector(){return new Z6(this._hostTNode,this._hostLView)}get parentInjector(){const t=Ra(this._hostTNode,this._hostLView);if(Id(t)){const e=ml(t,this._hostLView),r=gl(t);return new Z6(e[1].data[r+8],e)}return new Z6(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=iU(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,r){let s,i;"number"==typeof r?s=r:null!=r&&(s=r.index,i=r.injector);const o=t.createEmbeddedView(e||{},i);return this.insert(o,s),o}createComponent(t,e,r,s,i){const o=t&&!function Ri(n){return"function"==typeof n}(t);let c;if(o)c=e;else{const m=e||{};c=m.index,r=m.injector,s=m.projectableNodes,i=m.environmentInjector||m.ngModuleRef}const u=o?t:new Mu(b1(t)),h=r||this.parentInjector;if(!i&&null==u.ngModule){const E=(o?h:this.parentInjector).get(Va,null);E&&(i=E)}const g=u.create(h,s,void 0,i);return this.insert(g.hostView,c),g}insert(t,e){const r=t._lView,s=r[1];if(function z8(n){return Er(n[3])}(r)){const g=this.indexOf(t);if(-1!==g)this.detach(g);else{const m=r[3],E=new sU(m,m[6],m[3]);E.detach(E.indexOf(t))}}const i=this._adjustIndex(e),o=this._lContainer;!function Jw(n,t,e,r){const s=10+r,i=e.length;r>0&&(e[s-1][4]=t),r<i-10?(t[4]=e[s],g3(e,10+r,t)):(e.push(t),t[4]=null),t[3]=e;const o=t[17];null!==o&&e!==o&&function eb(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(o,t);const c=t[19];null!==c&&c.insertView(n),t[2]|=64}(s,r,o,i);const c=d0(i,o),u=r[11],h=h0(u,o[7]);return null!==h&&function Kw(n,t,e,r,s,i){r[0]=s,r[6]=t,p0(n,r,e,1,s,i)}(s,o[6],u,r,h,c),t.attachToViewContainerRef(),g3(dO(o),i,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=iU(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),r=M9(this._lContainer,e);r&&(J6(dO(this._lContainer),e),Xv(r[1],r))}detach(t){const e=this._adjustIndex(t,-1),r=M9(this._lContainer,e);return r&&null!=J6(dO(this._lContainer),e)?new pf(r):null}_adjustIndex(t,e=0){return t??this.length+e}};function iU(n){return n[8]}function dO(n){return n[8]||(n[8]=[])}function oU(n,t){let e;const r=t[n.index];if(Er(r))e=r;else{let s;if(8&n.type)s=Mr(r);else{const i=t[11];s=i.createComment("");const o=f2(n,t);y3(i,h0(i,o),s,function tC(n,t){return n.nextSibling(t)}(i,o),!1)}t[n.index]=e=$C(r,t,s,n),uf(t,e)}return new sU(e,n,t)}class pO{constructor(t){this.queryList=t,this.matches=null}clone(){return new pO(this.queryList)}setDirty(){this.queryList.setDirty()}}class gO{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const r=null!==t.contentQueries?t.contentQueries[0]:e.length,s=[];for(let i=0;i<r;i++){const o=e.getByIndex(i);s.push(this.queries[o.indexInDeclarationView].clone())}return new gO(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==fU(t,e).matches&&this.queries[e].setDirty()}}class aU{constructor(t,e,r=null){this.predicate=t,this.flags=e,this.read=r}}class mO{constructor(t=[]){this.queries=t}elementStart(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let r=0;r<this.length;r++){const s=null!==e?e.length:0,i=this.getByIndex(r).embeddedTView(t,s);i&&(i.indexInDeclarationView=r,null!==e?e.push(i):e=[i])}return null!==e?new mO(e):null}template(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class _O{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new _O(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let s=0;s<r.length;s++){const i=r[s];this.matchTNodeWithReadOption(t,e,G6e(e,i)),this.matchTNodeWithReadOption(t,e,Kr(e,t,i,!1,!1))}else r===xl?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Kr(e,t,r,!1,!1))}matchTNodeWithReadOption(t,e,r){if(null!==r){const s=this.metadata.read;if(null!==s)if(s===v2||s===Ga||s===xl&&4&e.type)this.addMatch(e.index,-2);else{const i=Kr(e,t,s,!1,!1);null!==i&&this.addMatch(e.index,i)}else this.addMatch(e.index,r)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function G6e(n,t){const e=n.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===t)return e[r+1];return null}function W6e(n,t,e,r){return-1===e?function q6e(n,t){return 11&n.type?c0(n,t):4&n.type?oy(n,t):null}(t,n):-2===e?function j6e(n,t,e){return e===v2?c0(t,n):e===xl?oy(t,n):e===Ga?oU(t,n):void 0}(n,t,r):Fs(n,n[1],e,t)}function cU(n,t,e,r){const s=t[19].queries[r];if(null===s.matches){const i=n.data,o=e.matches,c=[];for(let u=0;u<o.length;u+=2){const h=o[u];c.push(h<0?null:W6e(t,i[h],o[u+1],e.metadata.read))}s.matches=c}return s.matches}function vO(n,t,e,r){const s=n.queries.getByIndex(e),i=s.matches;if(null!==i){const o=cU(n,t,s,e);for(let c=0;c<i.length;c+=2){const u=i[c];if(u>0)r.push(o[c/2]);else{const h=i[c+1],g=t[-u];for(let m=10;m<g.length;m++){const E=g[m];E[17]===E[3]&&vO(E[1],E,h,r)}if(null!==g[9]){const m=g[9];for(let E=0;E<m.length;E++){const b=m[E];vO(b[1],b,h,r)}}}}}return r}function v4(n){const t=De(),e=Qn(),r=wd();V8(r+1);const s=fU(e,r);if(n.dirty&&function V_(n){return 4==(4&n[2])}(t)===(2==(2&s.metadata.flags))){if(null===s.matches)n.reset([]);else{const i=s.crossesNgTemplate?vO(e,t,r,[]):cU(e,t,s,r);n.reset(i,V7),n.notifyOnChanges()}return!0}return!1}function y0(n,t,e){const r=Qn();r.firstCreatePass&&(function uU(n,t,e){null===n.queries&&(n.queries=new mO),n.queries.track(new _O(t,e))}(r,new aU(n,t,e),-1),2==(2&t)&&(r.staticViewQueries=!0)),function lU(n,t,e){const r=new hO(4==(4&e));Db(n,t,r,r.destroy),null===t[19]&&(t[19]=new gO),t[19].queries.push(new pO(r))}(r,De(),t)}function C4(){return function Z6e(n,t){return n[19].queries[t].queryList}(De(),wd())}function fU(n,t){return n.queries.getByIndex(t)}function Gn(n,t){return oy(n,t)}function cy(...n){}const ly=new Dt("Application Initializer");let uy=(()=>{class n{constructor(e){this.appInits=e,this.resolve=cy,this.reject=cy,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,s)=>{this.resolve=r,this.reject=s})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const i=this.appInits[s]();if(np(i))e.push(i);else if(Qb(i)){const o=new Promise((c,u)=>{i.subscribe({complete:c,error:u})});e.push(o)}}Promise.all(e).then(()=>{r()}).catch(s=>{this.reject(s)}),0===e.length&&r(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(Ve(ly,8))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const hp=new Dt("AppId",{providedIn:"root",factory:function NU(){return`${PO()}${PO()}${PO()}`}});function PO(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const IU=new Dt("Platform Initializer"),dp=new Dt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),xU=new Dt("appBootstrapListener"),kU=new Dt("AnimationModuleType");let g0e=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const y4=new Dt("LocaleId",{providedIn:"root",factory:()=>Hr(y4,Yt.Optional|Yt.SkipSelf)||function m0e(){return typeof $localize<"u"&&$localize.locale||_f}()});class v0e{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let TO=(()=>{class n{compileModuleSync(e){return new lO(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),i=Ha(vo(e).declarations).reduce((o,c)=>{const u=b1(c);return u&&o.push(new Mu(u)),o},[]);return new v0e(r,i)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const E0e=(()=>Promise.resolve(0))();function wO(n){typeof Zone>"u"?E0e.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Pr{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new hr(!1),this.onMicrotaskEmpty=new hr(!1),this.onStable=new hr(!1),this.onError=new hr(!1),typeof Zone>"u")throw new Ne(908,!1);Zone.assertZonePatched();const s=this;if(s._nesting=0,s._outer=s._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const i=Zone.AsyncStackTaggingZoneSpec;s._inner=s._inner.fork(new i("Angular"))}Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&e,s.shouldCoalesceRunChangeDetection=r,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function M0e(){let n=K1.requestAnimationFrame,t=K1.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function T0e(n){const t=()=>{!function P0e(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(K1,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,OO(n),n.isCheckStableRunning=!0,bO(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),OO(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,s,i,o,c)=>{try{return DU(n),e.invokeTask(s,i,o,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||n.shouldCoalesceRunChangeDetection)&&t(),zU(n)}},onInvoke:(e,r,s,i,o,c,u)=>{try{return DU(n),e.invoke(s,i,o,c,u)}finally{n.shouldCoalesceRunChangeDetection&&t(),zU(n)}},onHasTask:(e,r,s,i)=>{e.hasTask(s,i),r===s&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,OO(n),bO(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,r,s,i)=>(e.handleError(s,i),n.runOutsideAngular(()=>n.onError.emit(i)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Pr.isInAngularZone())throw new Ne(909,!1)}static assertNotInAngularZone(){if(Pr.isInAngularZone())throw new Ne(909,!1)}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,s){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+s,t,S0e,cy,cy);try{return i.runTask(o,e,r)}finally{i.cancelTask(o)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}}const S0e={};function bO(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function OO(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function DU(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function zU(n){n._nesting--,bO(n)}class w0e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new hr,this.onMicrotaskEmpty=new hr,this.onStable=new hr,this.onError=new hr}run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,s){return t.apply(e,r)}}const VU=new Dt(""),fy=new Dt("");let IO,AO=(()=>{class n{constructor(e,r,s){this._ngZone=e,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,IO||(function b0e(n){IO=n}(s),s.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Pr.assertNotInAngularZone(),wO(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())wO(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,s){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==i),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:s})}whenStable(e,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,s){return[]}}return n.\u0275fac=function(e){return new(e||n)(Ve(Pr),Ve(NO),Ve(fy))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),NO=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return IO?.findTestabilityInTree(this,e,r)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),E0=null;const HU=new Dt("AllowMultipleToken"),xO=new Dt("PlatformDestroyListeners");class FU{constructor(t,e){this.name=t,this.token=e}}function $U(n,t,e=[]){const r=`Platform: ${t}`,s=new Dt(r);return(i=[])=>{let o=kO();if(!o||o.injector.get(HU,!1)){const c=[...e,...i,{provide:s,useValue:!0}];n?n(c):function N0e(n){if(E0&&!E0.get(HU,!1))throw new Ne(400,!1);E0=n;const t=n.get(GU);(function BU(n){const t=n.get(IU,null);t&&t.forEach(e=>e())})(n)}(function UU(n=[],t){return fi.create({name:t,providers:[{provide:o9,useValue:"platform"},{provide:xO,useValue:new Set([()=>E0=null])},...n]})}(c,r))}return function x0e(n){const t=kO();if(!t)throw new Ne(401,!1);return t}()}}function kO(){return E0?.get(GU)??null}let GU=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const s=function WU(n,t){let e;return e="noop"===n?new w0e:("zone.js"===n?void 0:n)||new Pr(t),e}(r?.ngZone,function qU(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(r)),i=[{provide:Pr,useValue:s}];return s.run(()=>{const o=fi.create({providers:i,parent:this.injector,name:e.moduleType.name}),c=e.create(o),u=c.injector.get(f0,null);if(!u)throw new Ne(402,!1);return s.runOutsideAngular(()=>{const h=s.onError.subscribe({next:g=>{u.handleError(g)}});c.onDestroy(()=>{hy(this._modules,c),h.unsubscribe()})}),function jU(n,t,e){try{const r=e();return np(r)?r.catch(s=>{throw t.runOutsideAngular(()=>n.handleError(s)),s}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}(u,s,()=>{const h=c.injector.get(uy);return h.runInitializers(),h.donePromise.then(()=>(E$(c.injector.get(y4,_f)||_f),this._moduleDoBootstrap(c),c))})})}bootstrapModule(e,r=[]){const s=ZU({},r);return function O0e(n,t,e){const r=new lO(e);return Promise.resolve(r)}(0,0,e).then(i=>this.bootstrapModuleFactory(i,s))}_moduleDoBootstrap(e){const r=e.injector.get(pp);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(s=>r.bootstrap(s));else{if(!e.instance.ngDoBootstrap)throw new Ne(403,!1);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ne(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const e=this._injector.get(xO,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(Ve(fi))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function ZU(n,t){return Array.isArray(t)?t.reduce(ZU,n):{...n,...t}}let pp=(()=>{class n{constructor(e,r,s){this._zone=e,this._injector=r,this._exceptionHandler=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const i=new yr(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),o=new yr(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{Pr.assertNotInAngularZone(),wO(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{Pr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=function M_(...n){const t=Y3(n),e=function W5(n,t){return"number"==typeof ol(n)?n.pop():t}(n,1/0),r=n;return r.length?1===r.length?mo(r[0]):il(e)(cs(r,t)):Cc}(i,o.pipe(function gT(n={}){const{connector:t=(()=>new q2),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:s=!0}=n;return i=>{let o,c,u,h=0,g=!1,m=!1;const E=()=>{c?.unsubscribe(),c=void 0},b=()=>{E(),o=u=void 0,g=m=!1},k=()=>{const U=o;b(),U?.unsubscribe()};return fr((U,j)=>{h++,!m&&!g&&E();const oe=u=u??t();j.add(()=>{h--,0===h&&!m&&!g&&(c=Y5(k,s))}),oe.subscribe(j),!o&&h>0&&(o=new ir({next:ye=>oe.next(ye),error:ye=>{m=!0,E(),c=Y5(b,e,ye),oe.error(ye)},complete:()=>{g=!0,E(),c=Y5(b,r),oe.complete()}}),mo(U).subscribe(o))})(i)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,r){const s=e instanceof kv;if(!this._injector.get(uy).done)throw!s&&function ll(n){const t=b1(n)||o2(n)||a2(n);return null!==t&&t.standalone}(e),new Ne(405,false);let o;o=s?e:this._injector.get(a0).resolveComponentFactory(e),this.componentTypes.push(o.componentType);const c=function A0e(n){return n.isBoundToModule}(o)?void 0:this._injector.get(Tu),h=o.create(fi.NULL,[],r||o.selector,c),g=h.location.nativeElement,m=h.injector.get(VU,null);return m?.registerApplication(g),h.onDestroy(()=>{this.detachView(h.hostView),hy(this.components,h),m?.unregisterApplication(g)}),this._loadComponent(h),h}tick(){if(this._runningTick)throw new Ne(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;hy(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(xU,[]).concat(this._bootstrapListeners).forEach(s=>s(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>hy(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Ne(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)(Ve(Pr),Ve(Va),Ve(f0))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function hy(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let KU=!0,wu=(()=>{class n{}return n.__NG_ELEMENT_ID__=R0e,n})();function R0e(n){return function D0e(n,t,e){if(na(n)&&!e){const r=ki(n.index,t);return new pf(r,r)}return 47&n.type?new pf(t[16],t):null}(Vr(),De(),16==(16&n))}class tG{constructor(){}supports(t){return Fe(t)}create(t){return new $0e(t)}}const B0e=(n,t)=>t;class $0e{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||B0e}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,r=this._removalsHead,s=0,i=null;for(;e||r;){const o=!r||e&&e.currentIndex<rG(r,s,i)?e:r,c=rG(o,s,i),u=o.currentIndex;if(o===r)s--,r=r._nextRemoved;else if(e=e._next,null==o.previousIndex)s++;else{i||(i=[]);const h=c-s,g=u-s;if(h!=g){for(let E=0;E<h;E++){const b=E<i.length?i[E]:i[E]=0,k=b+E;g<=k&&k<h&&(i[E]=b+1)}i[o.previousIndex]=g-h}}c!==u&&t(o,c,u)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Fe(t))throw new Ne(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let s,i,o,e=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let c=0;c<this.length;c++)i=t[c],o=this._trackByFn(c,i),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,i,o,c)),Object.is(e.item,i)||this._addIdentityChange(e,i)):(e=this._mismatch(e,i,o,c),r=!0),e=e._next}else s=0,function it(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[we()]();let r;for(;!(r=e.next()).done;)t(r.value)}}(t,c=>{o=this._trackByFn(s,c),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,c,o,s)),Object.is(e.item,c)||this._addIdentityChange(e,c)):(e=this._mismatch(e,c,o,s),r=!0),e=e._next,s++}),this.length=s;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,r,s){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,s)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,s))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,s)):t=this._addAfter(new U0e(e,r),i,s),t}_verifyReinsertion(t,e,r,s){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==i?t=this._reinsertAfter(i,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const s=t._prevRemoved,i=t._nextRemoved;return null===s?this._removalsHead=i:s._nextRemoved=i,null===i?this._removalsTail=s:i._prevRemoved=s,this._insertAfter(t,e,r),this._addToMoves(t,r),t}_moveAfter(t,e,r){return this._unlink(t),this._insertAfter(t,e,r),this._addToMoves(t,r),t}_addAfter(t,e,r){return this._insertAfter(t,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,r){const s=null===e?this._itHead:e._next;return t._next=s,t._prev=e,null===s?this._itTail=t:s._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new nG),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,r=t._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new nG),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class U0e{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class G0e{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const e=t._prevDup,r=t._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class nG{constructor(){this.map=new Map}put(t){const e=t.trackById;let r=this.map.get(e);r||(r=new G0e,this.map.set(e,r)),r.add(t)}get(t,e){const s=this.map.get(t);return s?s.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function rG(n,t,e){const r=n.previousIndex;if(null===r)return r;let s=0;return e&&r<e.length&&(s=e[r]),r+t+s}class sG{constructor(){}supports(t){return t instanceof Map||Ct(t)}create(){return new q0e}}class q0e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Ct(t)))throw new Ne(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,s)=>{if(e&&e.key===s)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(s,r);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const r=t._prev;return e._next=t,e._prev=r,t._prev=e,r&&(r._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const s=this._records.get(t);this._maybeAddToChanges(s,e);const i=s._prev,o=s._next;return i&&(i._next=o),o&&(o._prev=i),s._next=null,s._prev=null,s}const r=new W0e(t);return this._records.set(t,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(r=>e(t[r],r))}}class W0e{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function iG(){return new gy([new tG])}let gy=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(null!=r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||iG()),deps:[[n,new eu,new ui]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(null!=r)return r;throw new Ne(901,!1)}}return n.\u0275prov=et({token:n,providedIn:"root",factory:iG}),n})();function oG(){return new gp([new sG])}let gp=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||oG()),deps:[[n,new eu,new ui]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(r)return r;throw new Ne(901,!1)}}return n.\u0275prov=et({token:n,providedIn:"root",factory:oG}),n})();const Y0e=$U(null,"core",[]);let K0e=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(Ve(pp))},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({}),n})();function Ll(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let my=null;function E4(){return my}const $s=new Dt("DocumentToken");let VO=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:function(){return function e8e(){return Ve(aG)}()},providedIn:"platform"}),n})();const t8e=new Dt("Location Initialized");let aG=(()=>{class n extends VO{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return E4().getBaseHref(this._doc)}onPopState(e){const r=E4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=E4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,s){cG()?this._history.pushState(e,r,s):this.location.hash=s}replaceState(e,r,s){cG()?this._history.replaceState(e,r,s):this.location.hash=s}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=et({token:n,factory:function(){return function n8e(){return new aG(Ve($s))}()},providedIn:"platform"}),n})();function cG(){return!!window.history.pushState}function HO(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function lG(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function Rl(n){return n&&"?"!==n[0]?"?"+n:n}let Ou=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:function(){return Hr(fG)},providedIn:"root"}),n})();const uG=new Dt("appBaseHref");let fG=(()=>{class n extends Ou{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Hr($s).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return HO(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+Rl(this._platformLocation.search),s=this._platformLocation.hash;return s&&e?`${r}${s}`:r}pushState(e,r,s,i){const o=this.prepareExternalUrl(s+Rl(i));this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){const o=this.prepareExternalUrl(s+Rl(i));this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(Ve(VO),Ve(uG,8))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),r8e=(()=>{class n extends Ou{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=HO(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,s,i){let o=this.prepareExternalUrl(s+Rl(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){let o=this.prepareExternalUrl(s+Rl(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(Ve(VO),Ve(uG,8))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),FO=(()=>{class n{constructor(e){this._subject=new hr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._baseHref=lG(hG(r)),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+Rl(r))}normalize(e){return n.stripTrailingSlash(function i8e(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,hG(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",s=null){this._locationStrategy.pushState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Rl(r)),s)}replaceState(e,r="",s=null){this._locationStrategy.replaceState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Rl(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(s=>s(e,r))}subscribe(e,r,s){return this._subject.subscribe({next:e,error:r,complete:s})}}return n.normalizeQueryParams=Rl,n.joinWithSlash=HO,n.stripTrailingSlash=lG,n.\u0275fac=function(e){return new(e||n)(Ve(Ou))},n.\u0275prov=et({token:n,factory:function(){return function s8e(){return new FO(Ve(Ou))}()},providedIn:"root"}),n})();function hG(n){return n.replace(/\/index.html$/,"")}var pa=(()=>((pa=pa||{})[pa.Decimal=0]="Decimal",pa[pa.Percent=1]="Percent",pa[pa.Currency=2]="Currency",pa[pa.Scientific=3]="Scientific",pa))(),Ps=(()=>((Ps=Ps||{})[Ps.Format=0]="Format",Ps[Ps.Standalone=1]="Standalone",Ps))(),Jn=(()=>((Jn=Jn||{})[Jn.Narrow=0]="Narrow",Jn[Jn.Abbreviated=1]="Abbreviated",Jn[Jn.Wide=2]="Wide",Jn[Jn.Short=3]="Short",Jn))(),Qr=(()=>((Qr=Qr||{})[Qr.Short=0]="Short",Qr[Qr.Medium=1]="Medium",Qr[Qr.Long=2]="Long",Qr[Qr.Full=3]="Full",Qr))(),nn=(()=>((nn=nn||{})[nn.Decimal=0]="Decimal",nn[nn.Group=1]="Group",nn[nn.List=2]="List",nn[nn.PercentSign=3]="PercentSign",nn[nn.PlusSign=4]="PlusSign",nn[nn.MinusSign=5]="MinusSign",nn[nn.Exponential=6]="Exponential",nn[nn.SuperscriptingExponent=7]="SuperscriptingExponent",nn[nn.PerMille=8]="PerMille",nn[nn.Infinity=9]="Infinity",nn[nn.NaN=10]="NaN",nn[nn.TimeSeparator=11]="TimeSeparator",nn[nn.CurrencyDecimal=12]="CurrencyDecimal",nn[nn.CurrencyGroup=13]="CurrencyGroup",nn))();function _y(n,t){return Nc(Ao(n)[vt.DateFormat],t)}function vy(n,t){return Nc(Ao(n)[vt.TimeFormat],t)}function Cy(n,t){return Nc(Ao(n)[vt.DateTimeFormat],t)}function Ac(n,t){const e=Ao(n),r=e[vt.NumberSymbols][t];if(typeof r>"u"){if(t===nn.CurrencyDecimal)return e[vt.NumberSymbols][nn.Decimal];if(t===nn.CurrencyGroup)return e[vt.NumberSymbols][nn.Group]}return r}function pG(n){if(!n[vt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[vt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Nc(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function $O(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const v8e=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,mp={},C8e=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var di=(()=>((di=di||{})[di.Short=0]="Short",di[di.ShortGMT=1]="ShortGMT",di[di.Long=2]="Long",di[di.Extended=3]="Extended",di))(),fn=(()=>((fn=fn||{})[fn.FullYear=0]="FullYear",fn[fn.Month=1]="Month",fn[fn.Date=2]="Date",fn[fn.Hours=3]="Hours",fn[fn.Minutes=4]="Minutes",fn[fn.Seconds=5]="Seconds",fn[fn.FractionalSeconds=6]="FractionalSeconds",fn[fn.Day=7]="Day",fn))(),Vn=(()=>((Vn=Vn||{})[Vn.DayPeriods=0]="DayPeriods",Vn[Vn.Days=1]="Days",Vn[Vn.Months=2]="Months",Vn[Vn.Eras=3]="Eras",Vn))();function gG(n,t,e,r){let s=function O8e(n){if(vG(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[s,i=1,o=1]=n.split("-").map(c=>+c);return yy(s,i-1,o)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let r;if(r=n.match(v8e))return function A8e(n){const t=new Date(0);let e=0,r=0;const s=n[8]?t.setUTCFullYear:t.setFullYear,i=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),r=Number(n[9]+n[11])),s.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-e,c=Number(n[5]||0)-r,u=Number(n[6]||0),h=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return i.call(t,o,c,u,h),t}(r)}const t=new Date(n);if(!vG(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=Dl(e,t)||t;let c,o=[];for(;t;){if(c=C8e.exec(t),!c){o.push(t);break}{o=o.concat(c.slice(1));const g=o.pop();if(!g)break;t=g}}let u=s.getTimezoneOffset();r&&(u=_G(r,u),s=function b8e(n,t,e){const r=e?-1:1,s=n.getTimezoneOffset();return function w8e(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,r*(_G(t,s)-s))}(s,r,!0));let h="";return o.forEach(g=>{const m=function T8e(n){if(GO[n])return GO[n];let t;switch(n){case"G":case"GG":case"GGG":t=dr(Vn.Eras,Jn.Abbreviated);break;case"GGGG":t=dr(Vn.Eras,Jn.Wide);break;case"GGGGG":t=dr(Vn.Eras,Jn.Narrow);break;case"y":t=Gs(fn.FullYear,1,0,!1,!0);break;case"yy":t=Gs(fn.FullYear,2,0,!0,!0);break;case"yyy":t=Gs(fn.FullYear,3,0,!1,!0);break;case"yyyy":t=Gs(fn.FullYear,4,0,!1,!0);break;case"Y":t=Py(1);break;case"YY":t=Py(2,!0);break;case"YYY":t=Py(3);break;case"YYYY":t=Py(4);break;case"M":case"L":t=Gs(fn.Month,1,1);break;case"MM":case"LL":t=Gs(fn.Month,2,1);break;case"MMM":t=dr(Vn.Months,Jn.Abbreviated);break;case"MMMM":t=dr(Vn.Months,Jn.Wide);break;case"MMMMM":t=dr(Vn.Months,Jn.Narrow);break;case"LLL":t=dr(Vn.Months,Jn.Abbreviated,Ps.Standalone);break;case"LLLL":t=dr(Vn.Months,Jn.Wide,Ps.Standalone);break;case"LLLLL":t=dr(Vn.Months,Jn.Narrow,Ps.Standalone);break;case"w":t=UO(1);break;case"ww":t=UO(2);break;case"W":t=UO(1,!0);break;case"d":t=Gs(fn.Date,1);break;case"dd":t=Gs(fn.Date,2);break;case"c":case"cc":t=Gs(fn.Day,1);break;case"ccc":t=dr(Vn.Days,Jn.Abbreviated,Ps.Standalone);break;case"cccc":t=dr(Vn.Days,Jn.Wide,Ps.Standalone);break;case"ccccc":t=dr(Vn.Days,Jn.Narrow,Ps.Standalone);break;case"cccccc":t=dr(Vn.Days,Jn.Short,Ps.Standalone);break;case"E":case"EE":case"EEE":t=dr(Vn.Days,Jn.Abbreviated);break;case"EEEE":t=dr(Vn.Days,Jn.Wide);break;case"EEEEE":t=dr(Vn.Days,Jn.Narrow);break;case"EEEEEE":t=dr(Vn.Days,Jn.Short);break;case"a":case"aa":case"aaa":t=dr(Vn.DayPeriods,Jn.Abbreviated);break;case"aaaa":t=dr(Vn.DayPeriods,Jn.Wide);break;case"aaaaa":t=dr(Vn.DayPeriods,Jn.Narrow);break;case"b":case"bb":case"bbb":t=dr(Vn.DayPeriods,Jn.Abbreviated,Ps.Standalone,!0);break;case"bbbb":t=dr(Vn.DayPeriods,Jn.Wide,Ps.Standalone,!0);break;case"bbbbb":t=dr(Vn.DayPeriods,Jn.Narrow,Ps.Standalone,!0);break;case"B":case"BB":case"BBB":t=dr(Vn.DayPeriods,Jn.Abbreviated,Ps.Format,!0);break;case"BBBB":t=dr(Vn.DayPeriods,Jn.Wide,Ps.Format,!0);break;case"BBBBB":t=dr(Vn.DayPeriods,Jn.Narrow,Ps.Format,!0);break;case"h":t=Gs(fn.Hours,1,-12);break;case"hh":t=Gs(fn.Hours,2,-12);break;case"H":t=Gs(fn.Hours,1);break;case"HH":t=Gs(fn.Hours,2);break;case"m":t=Gs(fn.Minutes,1);break;case"mm":t=Gs(fn.Minutes,2);break;case"s":t=Gs(fn.Seconds,1);break;case"ss":t=Gs(fn.Seconds,2);break;case"S":t=Gs(fn.FractionalSeconds,1);break;case"SS":t=Gs(fn.FractionalSeconds,2);break;case"SSS":t=Gs(fn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=My(di.Short);break;case"ZZZZZ":t=My(di.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=My(di.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=My(di.Long);break;default:return null}return GO[n]=t,t}(g);h+=m?m(s,e,u):"''"===g?"'":g.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),h}function yy(n,t,e){const r=new Date(0);return r.setFullYear(n,t,e),r.setHours(0,0,0),r}function Dl(n,t){const e=function o8e(n){return Ao(n)[vt.LocaleId]}(n);if(mp[e]=mp[e]||{},mp[e][t])return mp[e][t];let r="";switch(t){case"shortDate":r=_y(n,Qr.Short);break;case"mediumDate":r=_y(n,Qr.Medium);break;case"longDate":r=_y(n,Qr.Long);break;case"fullDate":r=_y(n,Qr.Full);break;case"shortTime":r=vy(n,Qr.Short);break;case"mediumTime":r=vy(n,Qr.Medium);break;case"longTime":r=vy(n,Qr.Long);break;case"fullTime":r=vy(n,Qr.Full);break;case"short":const s=Dl(n,"shortTime"),i=Dl(n,"shortDate");r=Ey(Cy(n,Qr.Short),[s,i]);break;case"medium":const o=Dl(n,"mediumTime"),c=Dl(n,"mediumDate");r=Ey(Cy(n,Qr.Medium),[o,c]);break;case"long":const u=Dl(n,"longTime"),h=Dl(n,"longDate");r=Ey(Cy(n,Qr.Long),[u,h]);break;case"full":const g=Dl(n,"fullTime"),m=Dl(n,"fullDate");r=Ey(Cy(n,Qr.Full),[g,m])}return r&&(mp[e][t]=r),r}function Ey(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,r){return null!=t&&r in t?t[r]:e})),n}function A3(n,t,e="-",r,s){let i="";(n<0||s&&n<=0)&&(s?n=1-n:(n=-n,i=e));let o=String(n);for(;o.length<t;)o="0"+o;return r&&(o=o.slice(o.length-t)),i+o}function Gs(n,t,e=0,r=!1,s=!1){return function(i,o){let c=function E8e(n,t){switch(n){case fn.FullYear:return t.getFullYear();case fn.Month:return t.getMonth();case fn.Date:return t.getDate();case fn.Hours:return t.getHours();case fn.Minutes:return t.getMinutes();case fn.Seconds:return t.getSeconds();case fn.FractionalSeconds:return t.getMilliseconds();case fn.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,i);if((e>0||c>-e)&&(c+=e),n===fn.Hours)0===c&&-12===e&&(c=12);else if(n===fn.FractionalSeconds)return function y8e(n,t){return A3(n,3).substring(0,t)}(c,t);const u=Ac(o,nn.MinusSign);return A3(c,t,u,r,s)}}function dr(n,t,e=Ps.Format,r=!1){return function(s,i){return function M8e(n,t,e,r,s,i){switch(e){case Vn.Months:return function l8e(n,t,e){const r=Ao(n),i=Nc([r[vt.MonthsFormat],r[vt.MonthsStandalone]],t);return Nc(i,e)}(t,s,r)[n.getMonth()];case Vn.Days:return function c8e(n,t,e){const r=Ao(n),i=Nc([r[vt.DaysFormat],r[vt.DaysStandalone]],t);return Nc(i,e)}(t,s,r)[n.getDay()];case Vn.DayPeriods:const o=n.getHours(),c=n.getMinutes();if(i){const h=function d8e(n){const t=Ao(n);return pG(t),(t[vt.ExtraData][2]||[]).map(r=>"string"==typeof r?$O(r):[$O(r[0]),$O(r[1])])}(t),g=function p8e(n,t,e){const r=Ao(n);pG(r);const i=Nc([r[vt.ExtraData][0],r[vt.ExtraData][1]],t)||[];return Nc(i,e)||[]}(t,s,r),m=h.findIndex(E=>{if(Array.isArray(E)){const[b,k]=E,U=o>=b.hours&&c>=b.minutes,j=o<k.hours||o===k.hours&&c<k.minutes;if(b.hours<k.hours){if(U&&j)return!0}else if(U||j)return!0}else if(E.hours===o&&E.minutes===c)return!0;return!1});if(-1!==m)return g[m]}return function a8e(n,t,e){const r=Ao(n),i=Nc([r[vt.DayPeriodsFormat],r[vt.DayPeriodsStandalone]],t);return Nc(i,e)}(t,s,r)[o<12?0:1];case Vn.Eras:return function u8e(n,t){return Nc(Ao(n)[vt.Eras],t)}(t,r)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(s,i,n,t,e,r)}}function My(n){return function(t,e,r){const s=-1*r,i=Ac(e,nn.MinusSign),o=s>0?Math.floor(s/60):Math.ceil(s/60);switch(n){case di.Short:return(s>=0?"+":"")+A3(o,2,i)+A3(Math.abs(s%60),2,i);case di.ShortGMT:return"GMT"+(s>=0?"+":"")+A3(o,1,i);case di.Long:return"GMT"+(s>=0?"+":"")+A3(o,2,i)+":"+A3(Math.abs(s%60),2,i);case di.Extended:return 0===r?"Z":(s>=0?"+":"")+A3(o,2,i)+":"+A3(Math.abs(s%60),2,i);default:throw new Error(`Unknown zone width "${n}"`)}}}function mG(n){return yy(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function UO(n,t=!1){return function(e,r){let s;if(t){const i=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();s=1+Math.floor((o+i)/7)}else{const i=mG(e),o=function P8e(n){const t=yy(n,0,1).getDay();return yy(n,0,1+(t<=4?4:11)-t)}(i.getFullYear()),c=i.getTime()-o.getTime();s=1+Math.round(c/6048e5)}return A3(s,n,Ac(r,nn.MinusSign))}}function Py(n,t=!1){return function(e,r){return A3(mG(e).getFullYear(),n,Ac(r,nn.MinusSign),t)}}const GO={};function _G(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function vG(n){return n instanceof Date&&!isNaN(n.valueOf())}const N8e=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function ZO(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}function MG(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[s,i]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(s.trim()===t)return decodeURIComponent(i)}return null}let pn=(()=>{class n{constructor(e,r,s,i){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=s,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Fe(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${j1(r.item)}`);this._toggleClass(r.item,!0)}),e.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!0)):Object.keys(e).forEach(r=>this._toggleClass(r,!!e[r])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!1)):Object.keys(e).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(e,r){(e=e.trim())&&e.split(/\s+/g).forEach(s=>{r?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return n.\u0275fac=function(e){return new(e||n)(Q(gy),Q(gp),Q(v2),Q(To))},n.\u0275dir=qt({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class U8e{constructor(t,e,r,s){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let On=(()=>{class n{constructor(e,r,s){this._viewContainer=e,this._template=r,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((s,i,o)=>{if(null==s.previousIndex)r.createEmbeddedView(this._template,new U8e(s.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===i?void 0:i);else if(null!==i){const c=r.get(i);r.move(c,o),TG(c,s)}});for(let s=0,i=r.length;s<i;s++){const c=r.get(s).context;c.index=s,c.count=i,c.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{TG(r.get(s.currentIndex),s)})}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(Q(Ga),Q(xl),Q(gy))},n.\u0275dir=qt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function TG(n,t){n.context.$implicit=t.item}let Xt=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new q8e,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){wG("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){wG("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(Q(Ga),Q(xl))},n.\u0275dir=qt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class q8e{constructor(){this.$implicit=null,this.ngIf=null}}function wG(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${j1(t)}'.`)}let AG=(()=>{class n{constructor(e){this._locale=e}transform(e,r,s){if(!function QO(n){return!(null==n||""===n||n!=n)}(e))return null;s=s||this._locale;try{return function D8e(n,t,e){return function WO(n,t,e,r,s,i,o=!1){let c="",u=!1;if(isFinite(n)){let h=function V8e(n){let r,s,i,o,c,t=Math.abs(n)+"",e=0;for((s=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(s<0&&(s=i),s+=+t.slice(i+1),t=t.substring(0,i)):s<0&&(s=t.length),i=0;"0"===t.charAt(i);i++);if(i===(c=t.length))r=[0],s=1;else{for(c--;"0"===t.charAt(c);)c--;for(s-=i,r=[],o=0;i<=c;i++,o++)r[o]=Number(t.charAt(i))}return s>22&&(r=r.splice(0,21),e=s-1,s=1),{digits:r,exponent:e,integerLen:s}}(n);o&&(h=function z8e(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(h));let g=t.minInt,m=t.minFrac,E=t.maxFrac;if(i){const ye=i.match(N8e);if(null===ye)throw new Error(`${i} is not a valid digit info`);const te=ye[1],ke=ye[3],Ge=ye[5];null!=te&&(g=ZO(te)),null!=ke&&(m=ZO(ke)),null!=Ge?E=ZO(Ge):null!=ke&&m>E&&(E=m)}!function H8e(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let r=n.digits,s=r.length-n.integerLen;const i=Math.min(Math.max(t,s),e);let o=i+n.integerLen,c=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let m=o;m<r.length;m++)r[m]=0}else{s=Math.max(0,s),n.integerLen=1,r.length=Math.max(1,o=i+1),r[0]=0;for(let m=1;m<o;m++)r[m]=0}if(c>=5)if(o-1<0){for(let m=0;m>o;m--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;s<Math.max(0,i);s++)r.push(0);let u=0!==i;const h=t+n.integerLen,g=r.reduceRight(function(m,E,b,k){return k[b]=(E+=m)<10?E:E-10,u&&(0===k[b]&&b>=h?k.pop():u=!1),E>=10?1:0},0);g&&(r.unshift(g),n.integerLen++)}(h,m,E);let b=h.digits,k=h.integerLen;const U=h.exponent;let j=[];for(u=b.every(ye=>!ye);k<g;k++)b.unshift(0);for(;k<0;k++)b.unshift(0);k>0?j=b.splice(k,b.length):(j=b,b=[0]);const oe=[];for(b.length>=t.lgSize&&oe.unshift(b.splice(-t.lgSize,b.length).join(""));b.length>t.gSize;)oe.unshift(b.splice(-t.gSize,b.length).join(""));b.length&&oe.unshift(b.join("")),c=oe.join(Ac(e,r)),j.length&&(c+=Ac(e,s)+j.join("")),U&&(c+=Ac(e,nn.Exponential)+"+"+U)}else c=Ac(e,nn.Infinity);return c=n<0&&!u?t.negPre+c+t.negSuf:t.posPre+c+t.posSuf,c}(n,function jO(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(";"),s=r[0],i=r[1],o=-1!==s.indexOf(".")?s.split("."):[s.substring(0,s.lastIndexOf("0")+1),s.substring(s.lastIndexOf("0")+1)],c=o[0],u=o[1]||"";e.posPre=c.substring(0,c.indexOf("#"));for(let g=0;g<u.length;g++){const m=u.charAt(g);"0"===m?e.minFrac=e.maxFrac=g+1:"#"===m?e.maxFrac=g+1:e.posSuf+=m}const h=c.split(",");if(e.gSize=h[1]?h[1].length:0,e.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,i){const g=s.length-e.posPre.length-e.posSuf.length,m=i.indexOf("#");e.negPre=i.substring(0,m).replace(/'/g,""),e.negSuf=i.slice(m+g).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function BO(n,t){return Ao(n)[vt.NumberFormats][t]}(t,pa.Decimal),Ac(t,nn.MinusSign)),t,nn.Group,nn.Decimal,e)}(function JO(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),s,r)}catch(i){throw function N3(n,t){return new Ne(2100,!1)}()}}}return n.\u0275fac=function(e){return new(e||n)(Q(y4,16))},n.\u0275pipe=ai({name:"number",type:n,pure:!0,standalone:!0}),n})();let _ue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({}),n})();let Eue=(()=>{class n{}return n.\u0275prov=et({token:n,providedIn:"root",factory:()=>new Mue(Ve($s),window)}),n})();class Mue{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function Sue(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let s=r.currentNode;for(;s;){const i=s.shadowRoot;if(i){const o=i.getElementById(t)||i.querySelector(`[name="${t}"]`);if(o)return o}s=r.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,s=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],s-i[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=IG(this.window.history)||IG(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function IG(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class xG{}class nA extends class Bue extends class J0e{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function Q0e(n){my||(my=n)}(new nA)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function $ue(){return Cp=Cp||document.querySelector("base"),Cp?Cp.getAttribute("href"):null}();return null==e?null:function Uue(n){by=by||document.createElement("a"),by.setAttribute("href",n);const t=by.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){Cp=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return MG(document.cookie,t)}}let by,Cp=null;const DG=new Dt("TRANSITION_ID"),que=[{provide:ly,useFactory:function Gue(n,t,e){return()=>{e.get(uy).donePromise.then(()=>{const r=E4(),s=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let i=0;i<s.length;i++)r.remove(s[i])})}},deps:[DG,$s,fi],multi:!0}];let jue=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const Oy=new Dt("EventManagerPlugins");let Ay=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(s=>s.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,s){return this._findPluginFor(r).addEventListener(e,r,s)}addGlobalEventListener(e,r,s){return this._findPluginFor(r).addGlobalEventListener(e,r,s)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const s=this._plugins;for(let i=0;i<s.length;i++){const o=s[i];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(Ve(Oy),Ve(Pr))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();class zG{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const s=E4().getGlobalEventTarget(this._doc,t);if(!s)throw new Error(`Unsupported event target ${s} for event ${e}`);return this.addEventListener(s,e,r)}}let VG=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),r.add(s))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),yp=(()=>{class n extends VG{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,s){e.forEach(i=>{const o=this._doc.createElement("style");o.textContent=i,s.push(r.appendChild(o))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(HG),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,s)=>{this._addStylesToHost(e,s,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(HG))}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();function HG(n){E4().remove(n)}const rA={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},sA=/%COMP%/g;function Ny(n,t,e){for(let r=0;r<t.length;r++){let s=t[r];Array.isArray(s)?Ny(n,s,e):(s=s.replace(sA,n),e.push(s))}return e}function $G(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let Iy=(()=>{class n{constructor(e,r,s){this.eventManager=e,this.sharedStylesHost=r,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new iA(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case F1.Emulated:{let s=this.rendererByCompId.get(r.id);return s||(s=new Jue(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,s)),s.applyToHost(e),s}case 1:case F1.ShadowDom:return new e5e(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const s=Ny(r.id,r.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(Ve(Ay),Ve(yp),Ve(hp))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();class iA{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(rA[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(GG(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&(GG(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,s){if(s){e=s+":"+e;const i=rA[s];i?t.setAttributeNS(i,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const s=rA[r];s?t.removeAttributeNS(s,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,s){s&(y2.DashCase|y2.Important)?t.style.setProperty(e,r,s&y2.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&y2.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,$G(r)):this.eventManager.addEventListener(t,e,$G(r))}}function GG(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Jue extends iA{constructor(t,e,r,s){super(t),this.component=r;const i=Ny(s+"-"+r.id,r.styles,[]);e.addStyles(i),this.contentAttr=function Kue(n){return"_ngcontent-%COMP%".replace(sA,n)}(s+"-"+r.id),this.hostAttr=function Xue(n){return"_nghost-%COMP%".replace(sA,n)}(s+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class e5e extends iA{constructor(t,e,r,s){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=Ny(s.id,s.styles,[]);for(let o=0;o<i.length;o++){const c=document.createElement("style");c.textContent=i[o],this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let t5e=(()=>{class n extends zG{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,s){return e.addEventListener(r,s,!1),()=>this.removeEventListener(e,r,s)}removeEventListener(e,r,s){return e.removeEventListener(r,s)}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const qG=["alt","control","meta","shift"],n5e={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},r5e={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let s5e=(()=>{class n extends zG{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,s){const i=n.parseEventName(r),o=n.eventCallback(i.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>E4().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const r=e.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const i=n._normalizeKey(r.pop());let o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),qG.forEach(h=>{const g=r.indexOf(h);g>-1&&(r.splice(g,1),o+=h+".")}),o+=i,0!=r.length||0===i.length)return null;const u={};return u.domEventName=s,u.fullKey=o,u}static matchEventFullKeyCode(e,r){let s=n5e[e.key]||e.key,i="";return r.indexOf("code.")>-1&&(s=e.code,i="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),qG.forEach(o=>{o!==s&&(0,r5e[o])(e)&&(i+=o+".")}),i+=s,i===r)}static eventCallback(e,r,s){return i=>{n.matchEventFullKeyCode(i,e)&&s.runGuarded(()=>r(i))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const jG=[{provide:dp,useValue:"browser"},{provide:IU,useValue:function i5e(){nA.makeCurrent()},multi:!0},{provide:$s,useFactory:function a5e(){return function QT(n){Qd=n}(document),document},deps:[]}],c5e=$U(Y0e,"browser",jG),ZG=new Dt(""),YG=[{provide:fy,useClass:class Wue{addToWindow(t){K1.getAngularTestability=(r,s=!0)=>{const i=t.findTestabilityInTree(r,s);if(null==i)throw new Error("Could not find testability for element.");return i},K1.getAllAngularTestabilities=()=>t.getAllTestabilities(),K1.getAllAngularRootElements=()=>t.getAllRootElements(),K1.frameworkStabilizers||(K1.frameworkStabilizers=[]),K1.frameworkStabilizers.push(r=>{const s=K1.getAllAngularTestabilities();let i=s.length,o=!1;const c=function(u){o=o||u,i--,0==i&&r(o)};s.forEach(function(u){u.whenStable(c)})})}findTestabilityInTree(t,e,r){return null==e?null:t.getTestability(e)??(r?E4().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:VU,useClass:AO,deps:[Pr,NO,fy]},{provide:AO,useClass:AO,deps:[Pr,NO,fy]}],KG=[{provide:o9,useValue:"root"},{provide:f0,useFactory:function o5e(){return new f0},deps:[]},{provide:Oy,useClass:t5e,multi:!0,deps:[$s,Pr,dp]},{provide:Oy,useClass:s5e,multi:!0,deps:[$s]},{provide:Iy,useClass:Iy,deps:[Ay,yp,hp]},{provide:l0,useExisting:Iy},{provide:VG,useExisting:yp},{provide:yp,useClass:yp,deps:[$s]},{provide:Ay,useClass:Ay,deps:[Oy,Pr]},{provide:xG,useClass:jue,deps:[]},[]];let XG=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:hp,useValue:e.appId},{provide:DG,useExisting:hp},que]}}}return n.\u0275fac=function(e){return new(e||n)(Ve(ZG,12))},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[...KG,...YG],imports:[_ue,K0e]}),n})(),QG=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=et({token:n,factory:function(e){let r=null;return r=e?new e:function u5e(){return new QG(Ve($s))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;let tq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:function(e){let r=null;return r=e?new(e||n):Ve(nq),r},providedIn:"root"}),n})(),nq=(()=>{class n extends tq{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case X1.NONE:return r;case X1.HTML:return Mo(r,"HTML")?Eo(r):n9(this._doc,String(r)).toString();case X1.STYLE:return Mo(r,"Style")?Eo(r):r;case X1.SCRIPT:if(Mo(r,"Script"))return Eo(r);throw new Error("unsafe value used in a script context");case X1.URL:return Mo(r,"URL")?Eo(r):la(String(r));case X1.RESOURCE_URL:if(Mo(r,"ResourceURL"))return Eo(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function dv(n){return new tw(n)}(e)}bypassSecurityTrustStyle(e){return function pv(n){return new nw(n)}(e)}bypassSecurityTrustScript(e){return function sw(n){return new rw(n)}(e)}bypassSecurityTrustUrl(e){return function iw(n){return new uv(n)}(e)}bypassSecurityTrustResourceUrl(e){return function ow(n){return new fv(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(Ve($s))},n.\u0275prov=et({token:n,factory:function(e){let r=null;return r=e?new e:function _5e(n){return new nq(n.get($s))}(Ve(fi)),r},providedIn:"root"}),n})();const{isArray:v5e}=Array,{getPrototypeOf:C5e,prototype:y5e,keys:E5e}=Object;function rq(n){if(1===n.length){const t=n[0];if(v5e(t))return{args:t,keys:null};if(function M5e(n){return n&&"object"==typeof n&&C5e(n)===y5e}(t)){const e=E5e(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}const{isArray:S5e}=Array;function sq(n){return vn(t=>function P5e(n,t){return S5e(t)?n(...t):n(t)}(n,t))}function iq(n,t){return n.reduce((e,r,s)=>(e[r]=t[s],e),{})}let oq=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(Q(To),Q(v2))},n.\u0275dir=qt({type:n}),n})(),Au=(()=>{class n extends oq{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,features:[l]}),n})();const M4=new Dt("NgValueAccessor"),w5e={provide:M4,useExisting:T1(()=>cA),multi:!0};let cA=(()=>{class n extends Au{writeValue(e){this.setProperty("checked",e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.checked)})("blur",function(){return r.onTouched()})},features:[Fr([w5e]),l]}),n})();const b5e={provide:M4,useExisting:T1(()=>S4),multi:!0},A5e=new Dt("CompositionEventMode");let S4=(()=>{class n extends oq{constructor(e,r,s){super(e,r),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function O5e(){const n=E4()?E4().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(To),Q(v2),Q(A5e,8))},n.\u0275dir=qt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&ee("input",function(i){return r._handleInput(i.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(i){return r._compositionEnd(i.target.value)})},features:[Fr([b5e]),l]}),n})();function S0(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function aq(n){return null!=n&&"number"==typeof n.length}const eo=new Dt("NgValidators"),P0=new Dt("NgAsyncValidators"),I5e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Ep{static min(t){return function cq(n){return t=>{if(S0(t.value)||S0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function lq(n){return t=>{if(S0(t.value)||S0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return uq(t)}static requiredTrue(t){return function fq(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function hq(n){return S0(n.value)||I5e.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function dq(n){return t=>S0(t.value)||!aq(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return pq(t)}static pattern(t){return function gq(n){if(!n)return xy;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),r=>{if(S0(r.value))return null;const s=r.value;return t.test(s)?null:{pattern:{requiredPattern:e,actualValue:s}}}}(t)}static nullValidator(t){return null}static compose(t){return Eq(t)}static composeAsync(t){return Mq(t)}}function uq(n){return S0(n.value)?{required:!0}:null}function pq(n){return t=>aq(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}function xy(n){return null}function mq(n){return null!=n}function _q(n){return np(n)?cs(n):n}function vq(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function Cq(n,t){return t.map(e=>e(n))}function yq(n){return n.map(t=>function x5e(n){return!n.validate}(t)?t:e=>t.validate(e))}function Eq(n){if(!n)return null;const t=n.filter(mq);return 0==t.length?null:function(e){return vq(Cq(e,t))}}function lA(n){return null!=n?Eq(yq(n)):null}function Mq(n){if(!n)return null;const t=n.filter(mq);return 0==t.length?null:function(e){return function T5e(...n){const t=tn(n),{args:e,keys:r}=rq(n),s=new yr(i=>{const{length:o}=e;if(!o)return void i.complete();const c=new Array(o);let u=o,h=o;for(let g=0;g<o;g++){let m=!1;mo(e[g]).subscribe(as(i,E=>{m||(m=!0,h--),c[g]=E},()=>u--,void 0,()=>{(!u||!m)&&(h||i.next(r?iq(r,c):c),i.complete())}))}});return t?s.pipe(sq(t)):s}(Cq(e,t).map(_q)).pipe(vn(vq))}}function uA(n){return null!=n?Mq(yq(n)):null}function Sq(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function Pq(n){return n._rawValidators}function Tq(n){return n._rawAsyncValidators}function fA(n){return n?Array.isArray(n)?n:[n]:[]}function ky(n,t){return Array.isArray(n)?n.includes(t):n===t}function wq(n,t){const e=fA(t);return fA(n).forEach(s=>{ky(e,s)||e.push(s)}),e}function bq(n,t){return fA(t).filter(e=>!ky(n,e))}class Oq{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=lA(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=uA(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Io extends Oq{get formDirective(){return null}get path(){return null}}class T0 extends Oq{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Aq{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let zl=(()=>{class n extends Aq{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(T0,2))},n.\u0275dir=qt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&JC("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[l]}),n})(),Nu=(()=>{class n extends Aq{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(Io,10))},n.\u0275dir=qt({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,r){2&e&&JC("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[l]}),n})();const Mp="VALID",Ry="INVALID",yf="PENDING",Sp="DISABLED";function gA(n){return(Dy(n)?n.validators:n)||null}function Iq(n){return Array.isArray(n)?lA(n):n||null}function mA(n,t){return(Dy(t)?t.asyncValidators:n)||null}function xq(n){return Array.isArray(n)?uA(n):n||null}function Dy(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function kq(n,t,e){const r=n.controls;if(!(t?Object.keys(r):r).length)throw new Ne(1e3,"");if(!r[e])throw new Ne(1001,"")}function Lq(n,t,e){n._forEachChild((r,s)=>{if(void 0===e[s])throw new Ne(1002,"")})}class zy{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=Iq(this._rawValidators),this._composedAsyncValidatorFn=xq(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Mp}get invalid(){return this.status===Ry}get pending(){return this.status==yf}get disabled(){return this.status===Sp}get enabled(){return this.status!==Sp}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=Iq(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=xq(t)}addValidators(t){this.setValidators(wq(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(wq(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(bq(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(bq(t,this._rawAsyncValidators))}hasValidator(t){return ky(this._rawValidators,t)}hasAsyncValidator(t){return ky(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=yf,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Sp,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Mp,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Mp||this.status===yf)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Sp:Mp}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=yf,this._hasOwnPendingAsyncValidator=!0;const e=_q(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,s)=>r&&r._find(s),this)}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new hr,this.statusChanges=new hr}_calculateStatus(){return this._allControlsDisabled()?Sp:this.errors?Ry:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(yf)?yf:this._anyControlsHaveStatus(Ry)?Ry:Mp}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Dy(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}}class w0 extends zy{constructor(t,e,r){super(gA(e),mA(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){Lq(this,0,t),Object.keys(t).forEach(r=>{kq(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{const s=this.controls[r];s&&s.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,s)=>((r.enabled||this.disabled)&&(e[s]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((s,i)=>{r=e(r,s,i)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class Rq extends w0{}function Vy(n,t){return[...t.path,n]}function Pp(n,t){_A(n,t),t.valueAccessor.writeValue(n.value),n.disabled&&t.valueAccessor.setDisabledState?.(!0),function F5e(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&Dq(n,t)})}(n,t),function $5e(n,t){const e=(r,s)=>{t.valueAccessor.writeValue(r),s&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function B5e(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&Dq(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function H5e(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function Hy(n,t,e=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),By(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Fy(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function _A(n,t){const e=Pq(n);null!==t.validator?n.setValidators(Sq(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=Tq(n);null!==t.asyncValidator?n.setAsyncValidators(Sq(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const s=()=>n.updateValueAndValidity();Fy(t._rawValidators,s),Fy(t._rawAsyncValidators,s)}function By(n,t){let e=!1;if(null!==n){if(null!==t.validator){const s=Pq(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.validator);i.length!==s.length&&(e=!0,n.setValidators(i))}}if(null!==t.asyncValidator){const s=Tq(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.asyncValidator);i.length!==s.length&&(e=!0,n.setAsyncValidators(i))}}}const r=()=>{};return Fy(t._rawValidators,r),Fy(t._rawAsyncValidators,r),e}function Dq(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function zq(n,t){_A(n,t)}function vA(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function Hq(n,t){n._syncPendingControls(),t.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function CA(n,t){if(!t)return null;let e,r,s;return Array.isArray(t),t.forEach(i=>{i.constructor===S4?e=i:function q5e(n){return Object.getPrototypeOf(n.constructor)===Au}(i)?r=i:s=i}),s||r||e||null}const j5e={provide:Io,useExisting:T1(()=>wp)},Tp=(()=>Promise.resolve())();let wp=(()=>{class n extends Io{constructor(e,r){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new hr,this.form=new w0({},lA(e),uA(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Tp.then(()=>{const r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),Pp(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Tp.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Tp.then(()=>{const r=this._findContainer(e.path),s=new w0({});zq(s,e),r.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Tp.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){Tp.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,Hq(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(Q(eo,10),Q(P0,10))},n.\u0275dir=qt({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,r){1&e&&ee("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Fr([j5e]),l]}),n})();function Fq(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function Bq(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const qa=class extends zy{constructor(t=null,e,r){super(gA(e),mA(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Dy(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=Bq(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){Fq(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){Fq(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){Bq(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},K5e={provide:T0,useExisting:T1(()=>bp)},Gq=(()=>Promise.resolve())();let bp=(()=>{class n extends T0{constructor(e,r,s,i,o){super(),this._changeDetectorRef=o,this.control=new qa,this._registered=!1,this.update=new hr,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=CA(0,i)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),vA(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Pp(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){Gq.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,s=0!==r&&Ll(r);Gq.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Vy(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(Q(Io,9),Q(eo,10),Q(P0,10),Q(M4,10),Q(wu,8))},n.\u0275dir=qt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Fr([K5e]),l,u2]}),n})(),Iu=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=qt({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),Wq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({}),n})();const e7e={provide:M4,useExisting:T1(()=>$y),multi:!0};let $y=(()=>{class n extends Au{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.value)})("input",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},features:[Fr([e7e]),l]}),n})();const yA=new Dt("NgModelWithFormControlWarning"),t7e={provide:T0,useExisting:T1(()=>EA)};let EA=(()=>{class n extends T0{constructor(e,r,s,i){super(),this._ngModelWarningConfig=i,this.update=new hr,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(r),this.valueAccessor=CA(0,s)}set isDisabled(e){}ngOnChanges(e){if(this._isControlChanged(e)){const r=e.form.previousValue;r&&Hy(r,this,!1),Pp(this.form,this),this.form.updateValueAndValidity({emitEvent:!1})}vA(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Hy(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(Q(eo,10),Q(P0,10),Q(M4,10),Q(yA,8))},n.\u0275dir=qt({type:n,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Fr([t7e]),l,u2]}),n})();const n7e={provide:Io,useExisting:T1(()=>xu)};let xu=(()=>{class n extends Io{constructor(e,r){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new hr,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(By(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return Pp(r,e),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){Hy(e.control||null,e,!1),function W5e(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,Hq(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,s=this.form.get(e.path);r!==s&&(Hy(r||null,e),(n=>n instanceof qa)(s)&&(Pp(s,e),e.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);zq(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function U5e(n,t){return By(n,t)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){_A(this.form,this),this._oldForm&&By(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(Q(eo,10),Q(P0,10))},n.\u0275dir=qt({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&ee("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Fr([n7e]),l,u2]}),n})();const i7e={provide:T0,useExisting:T1(()=>Ef)};let Ef=(()=>{class n extends T0{constructor(e,r,s,i,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new hr,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=CA(0,i)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),vA(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Vy(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(Q(Io,13),Q(eo,10),Q(P0,10),Q(M4,10),Q(yA,8))},n.\u0275dir=qt({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Fr([i7e]),l,u2]}),n})();const o7e={provide:M4,useExisting:T1(()=>Uy),multi:!0};function Yq(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let Uy=(()=>{class n extends Au{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const s=Yq(this._getOptionId(e),e);this.setProperty("value",s)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function a7e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Fr([o7e]),l]}),n})(),Op=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(Yq(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Q(v2),Q(To),Q(Uy,9))},n.\u0275dir=qt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const c7e={provide:M4,useExisting:T1(()=>PA),multi:!0};function Kq(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let PA=(()=>{class n extends Au{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let r;if(this.value=e,Array.isArray(e)){const s=e.map(i=>this._getOptionId(i));r=(i,o)=>{i._setSelected(s.indexOf(o.toString())>-1)}}else r=(s,i)=>{s._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const s=[],i=r.selectedOptions;if(void 0!==i){const o=i;for(let c=0;c<o.length;c++){const h=this._getOptionValue(o[c].value);s.push(h)}}else{const o=r.options;for(let c=0;c<o.length;c++){const u=o[c];if(u.selected){const h=this._getOptionValue(u.value);s.push(h)}}}this.value=s,e(s)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function l7e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,r){1&e&&ee("change",function(i){return r.onChange(i.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Fr([c7e]),l]}),n})(),Ap=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(Kq(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(Kq(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Q(v2),Q(To),Q(PA,9))},n.\u0275dir=qt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();let ku=(()=>{class n{constructor(){this._validator=xy}ngOnChanges(e){if(this.inputName in e){const r=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):xy,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=qt({type:n,features:[u2]}),n})();const h7e={provide:eo,useExisting:T1(()=>Lu),multi:!0};let Lu=(()=>{class n extends ku{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Ll,this.createValidator=e=>uq}enabled(e){return e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,r){2&e&&D("required",r._enabled?"":null)},inputs:{required:"required"},features:[Fr([h7e]),l]}),n})();const m7e={provide:eo,useExisting:T1(()=>TA),multi:!0};let TA=(()=>{class n extends ku{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>function Xq(n){return"number"==typeof n?n:parseInt(n,10)}(e),this.createValidator=e=>pq(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275dir=qt({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,r){2&e&&D("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Fr([m7e]),l]}),n})(),iW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({imports:[Wq]}),n})(),v7e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({imports:[iW]}),n})(),oW=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:yA,useValue:e.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({imports:[iW]}),n})();class aW extends zy{constructor(t,e,r){super(gA(e),mA(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){let s=this._adjustIndex(t);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),e&&(this.controls.splice(s,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){Lq(this,0,t),t.forEach((r,s)=>{kq(this,!1,s),this.at(s).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((r,s)=>{this.at(s)&&this.at(s).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function cW(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let C7e=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new n;return e.useNonNullable=!0,e}group(e,r=null){const s=this._reduceControls(e);let i={};return cW(r)?i=r:null!==r&&(i.validators=r.validator,i.asyncValidators=r.asyncValidator),new w0(s,i)}record(e,r=null){const s=this._reduceControls(e);return new Rq(s,r)}control(e,r,s){let i={};return this.useNonNullable?(cW(r)?i=r:(i.validators=r,i.asyncValidators=s),new qa(e,{...i,nonNullable:!0})):new qa(e,r,s)}array(e,r,s){const i=e.map(o=>this._createControl(o));return new aW(i,r,s)}_reduceControls(e){const r={};return Object.keys(e).forEach(s=>{r[s]=this._createControl(e[s])}),r}_createControl(e){return e instanceof qa||e instanceof zy?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:oW}),n})();function Kt(...n){return cs(n,Y3(n))}function b0(n,t){return ln(t)?He(n,t,1):He(n,1)}function Vl(n,t){return fr((e,r)=>{let s=0;e.subscribe(as(r,i=>n.call(t,i,s++)&&r.next(i)))})}class lW{}class uW{}class Hl{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const s=e.slice(0,r),i=s.toLowerCase(),o=e.slice(r+1).trim();this.maybeSetNormalizedName(s,i),this.headers.has(i)?this.headers.get(i).push(o):this.headers.set(i,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const s=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(s,r),this.maybeSetNormalizedName(e,s))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Hl?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Hl;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Hl?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const s=("a"===t.op?this.headers.get(e):void 0)||[];s.push(...r),this.headers.set(e,s);break;case"d":const i=t.value;if(i){let o=this.headers.get(e);if(!o)return;o=o.filter(c=>-1===i.indexOf(c)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class y7e{encodeKey(t){return fW(t)}encodeValue(t){return fW(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const M7e=/%(\d[a-f0-9])/gi,S7e={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function fW(n){return encodeURIComponent(n).replace(M7e,(t,e)=>S7e[e]??t)}function Gy(n){return`${n}`}class O0{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new y7e,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function E7e(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(s=>{const i=s.indexOf("="),[o,c]=-1==i?[t.decodeKey(s),""]:[t.decodeKey(s.slice(0,i)),t.decodeValue(s.slice(i+1))],u=e.get(o)||[];u.push(c),e.set(o,u)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e],s=Array.isArray(r)?r.map(Gy):[Gy(r)];this.map.set(e,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const s=t[r];Array.isArray(s)?s.forEach(i=>{e.push({param:r,value:i,op:"a"})}):e.push({param:r,value:s,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new O0({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(Gy(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const s=r.indexOf(Gy(t.value));-1!==s&&r.splice(s,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class P7e{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function hW(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function dW(n){return typeof Blob<"u"&&n instanceof Blob}function pW(n){return typeof FormData<"u"&&n instanceof FormData}class Np{constructor(t,e,r,s){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function T7e(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==r?r:null,i=s):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new Hl),this.context||(this.context=new P7e),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const c=e.indexOf("?");this.urlWithParams=e+(-1===c?"?":c<e.length-1?"&":"")+o}}else this.params=new O0,this.urlWithParams=e}serializeBody(){return null===this.body?null:hW(this.body)||dW(this.body)||pW(this.body)||function w7e(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof O0?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||pW(this.body)?null:dW(this.body)?this.body.type||null:hW(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof O0?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,r=t.url||this.url,s=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,c=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let u=t.headers||this.headers,h=t.params||this.params;const g=t.context??this.context;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((m,E)=>m.set(E,t.setHeaders[E]),u)),t.setParams&&(h=Object.keys(t.setParams).reduce((m,E)=>m.set(E,t.setParams[E]),h)),new Np(e,r,i,{params:h,headers:u,context:g,reportProgress:c,responseType:s,withCredentials:o})}}var qs=(()=>((qs=qs||{})[qs.Sent=0]="Sent",qs[qs.UploadProgress=1]="UploadProgress",qs[qs.ResponseHeader=2]="ResponseHeader",qs[qs.DownloadProgress=3]="DownloadProgress",qs[qs.Response=4]="Response",qs[qs.User=5]="User",qs))();class wA{constructor(t,e=200,r="OK"){this.headers=t.headers||new Hl,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class bA extends wA{constructor(t={}){super(t),this.type=qs.ResponseHeader}clone(t={}){return new bA({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class qy extends wA{constructor(t={}){super(t),this.type=qs.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new qy({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class gW extends wA{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function OA(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let b7e=(()=>{class n{constructor(e){this.handler=e}request(e,r,s={}){let i;if(e instanceof Np)i=e;else{let u,h;u=s.headers instanceof Hl?s.headers:new Hl(s.headers),s.params&&(h=s.params instanceof O0?s.params:new O0({fromObject:s.params})),i=new Np(e,r,void 0!==s.body?s.body:null,{headers:u,context:s.context,params:h,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const o=Kt(i).pipe(b0(u=>this.handler.handle(u)));if(e instanceof Np||"events"===s.observe)return o;const c=o.pipe(Vl(u=>u instanceof qy));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return c.pipe(vn(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return c.pipe(vn(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return c.pipe(vn(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return c.pipe(vn(u=>u.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new O0).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,s={}){return this.request("PATCH",e,OA(s,r))}post(e,r,s={}){return this.request("POST",e,OA(s,r))}put(e,r,s={}){return this.request("PUT",e,OA(s,r))}}return n.\u0275fac=function(e){return new(e||n)(Ve(lW))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();class mW{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const _W=new Dt("HTTP_INTERCEPTORS");let O7e=(()=>{class n{intercept(e,r){return r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const A7e=/^\)\]\}',?\n/;let vW=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new yr(r=>{const s=this.xhrFactory.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((b,k)=>s.setRequestHeader(b,k.join(","))),e.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const b=e.detectContentTypeHeader();null!==b&&s.setRequestHeader("Content-Type",b)}if(e.responseType){const b=e.responseType.toLowerCase();s.responseType="json"!==b?b:"text"}const i=e.serializeBody();let o=null;const c=()=>{if(null!==o)return o;const b=s.statusText||"OK",k=new Hl(s.getAllResponseHeaders()),U=function N7e(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(s)||e.url;return o=new bA({headers:k,status:s.status,statusText:b,url:U}),o},u=()=>{let{headers:b,status:k,statusText:U,url:j}=c(),oe=null;204!==k&&(oe=typeof s.response>"u"?s.responseText:s.response),0===k&&(k=oe?200:0);let ye=k>=200&&k<300;if("json"===e.responseType&&"string"==typeof oe){const te=oe;oe=oe.replace(A7e,"");try{oe=""!==oe?JSON.parse(oe):null}catch(ke){oe=te,ye&&(ye=!1,oe={error:ke,text:oe})}}ye?(r.next(new qy({body:oe,headers:b,status:k,statusText:U,url:j||void 0})),r.complete()):r.error(new gW({error:oe,headers:b,status:k,statusText:U,url:j||void 0}))},h=b=>{const{url:k}=c(),U=new gW({error:b,status:s.status||0,statusText:s.statusText||"Unknown Error",url:k||void 0});r.error(U)};let g=!1;const m=b=>{g||(r.next(c()),g=!0);let k={type:qs.DownloadProgress,loaded:b.loaded};b.lengthComputable&&(k.total=b.total),"text"===e.responseType&&!!s.responseText&&(k.partialText=s.responseText),r.next(k)},E=b=>{let k={type:qs.UploadProgress,loaded:b.loaded};b.lengthComputable&&(k.total=b.total),r.next(k)};return s.addEventListener("load",u),s.addEventListener("error",h),s.addEventListener("timeout",h),s.addEventListener("abort",h),e.reportProgress&&(s.addEventListener("progress",m),null!==i&&s.upload&&s.upload.addEventListener("progress",E)),s.send(i),r.next({type:qs.Sent}),()=>{s.removeEventListener("error",h),s.removeEventListener("abort",h),s.removeEventListener("load",u),s.removeEventListener("timeout",h),e.reportProgress&&(s.removeEventListener("progress",m),null!==i&&s.upload&&s.upload.removeEventListener("progress",E)),s.readyState!==s.DONE&&s.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(Ve(xG))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const AA=new Dt("XSRF_COOKIE_NAME"),NA=new Dt("XSRF_HEADER_NAME");class CW{}let I7e=(()=>{class n{constructor(e,r,s){this.doc=e,this.platform=r,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=MG(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(Ve($s),Ve(dp),Ve(AA))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),IA=(()=>{class n{constructor(e,r){this.tokenService=e,this.headerName=r}intercept(e,r){const s=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||s.startsWith("http://")||s.startsWith("https://"))return r.handle(e);const i=this.tokenService.getToken();return null!==i&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,i)})),r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(Ve(CW),Ve(NA))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),x7e=(()=>{class n{constructor(e,r){this.backend=e,this.injector=r,this.chain=null}handle(e){if(null===this.chain){const r=this.injector.get(_W,[]);this.chain=r.reduceRight((s,i)=>new mW(s,i),this.backend)}return this.chain.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(Ve(uW),Ve(fi))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),k7e=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:IA,useClass:O7e}]}}static withOptions(e={}){return{ngModule:n,providers:[e.cookieName?{provide:AA,useValue:e.cookieName}:[],e.headerName?{provide:NA,useValue:e.headerName}:[]]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[IA,{provide:_W,useExisting:IA,multi:!0},{provide:CW,useClass:I7e},{provide:AA,useValue:"XSRF-TOKEN"},{provide:NA,useValue:"X-XSRF-TOKEN"}]}),n})(),L7e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[b7e,{provide:lW,useClass:x7e},vW,{provide:uW,useExisting:vW}],imports:[k7e.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();class I3 extends q2{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}const Wy=os(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function yW(...n){const t=Y3(n),e=tn(n),{args:r,keys:s}=rq(n);if(0===r.length)return cs([],t);const i=new yr(function R7e(n,t,e=nl){return r=>{EW(t,()=>{const{length:s}=n,i=new Array(s);let o=s,c=s;for(let u=0;u<s;u++)EW(t,()=>{const h=cs(n[u],t);let g=!1;h.subscribe(as(r,m=>{i[u]=m,g||(g=!0,c--),c||r.next(e(i.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,t,s?o=>iq(s,o):nl));return e?i.pipe(sq(e)):i}function EW(n,t,e){n?Hs(e,n,t):t()}function xA(...n){return function D7e(){return il(1)}()(cs(n,Y3(n)))}function MW(n){return new yr(t=>{mo(n()).subscribe(t)})}function Ip(n,t){const e=ln(n)?n:()=>n,r=s=>s.error(e());return new yr(t?s=>t.schedule(r,0,s):r)}function kA(){return fr((n,t)=>{let e=null;n._refCount++;const r=as(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const s=n._connection,i=e;e=null,s&&(!i||s===i)&&s.unsubscribe(),t.unsubscribe()});n.subscribe(r),r.closed||(e=n.connect())})}class SW extends yr{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,u_(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new H1;const e=this.getSubject();t.add(this.source.subscribe(as(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=H1.EMPTY)}return t}refCount(){return kA()(this)}}function P4(n,t){return fr((e,r)=>{let s=null,i=0,o=!1;const c=()=>o&&!s&&r.complete();e.subscribe(as(r,u=>{s?.unsubscribe();let h=0;const g=i++;mo(n(u,g)).subscribe(s=as(r,m=>r.next(t?t(u,m,g,h++):m),()=>{s=null,c()}))},()=>{o=!0,c()}))})}function xp(n){return n<=0?()=>Cc:fr((t,e)=>{let r=0;t.subscribe(as(e,s=>{++r<=n&&(e.next(s),n<=r&&e.complete())}))})}function jy(n){return fr((t,e)=>{let r=!1;t.subscribe(as(e,s=>{r=!0,e.next(s)},()=>{r||e.next(n),e.complete()}))})}function PW(n=V7e){return fr((t,e)=>{let r=!1;t.subscribe(as(e,s=>{r=!0,e.next(s)},()=>r?e.complete():e.error(n())))})}function V7e(){return new Wy}function A0(n,t){const e=arguments.length>=2;return r=>r.pipe(n?Vl((s,i)=>n(s,i,r)):nl,xp(1),e?jy(t):PW(()=>new Wy))}function P2(n,t,e){const r=ln(n)||t||e?{next:n,error:t,complete:e}:n;return r?fr((s,i)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let c=!0;s.subscribe(as(i,u=>{var h;null===(h=r.next)||void 0===h||h.call(r,u),i.next(u)},()=>{var u;c=!1,null===(u=r.complete)||void 0===u||u.call(r),i.complete()},u=>{var h;c=!1,null===(h=r.error)||void 0===h||h.call(r,u),i.error(u)},()=>{var u,h;c&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(h=r.finalize)||void 0===h||h.call(r)}))}):nl}function N0(n){return fr((t,e)=>{let i,r=null,s=!1;r=t.subscribe(as(e,void 0,void 0,o=>{i=mo(n(o,N0(n)(t))),r?(r.unsubscribe(),r=null,i.subscribe(e)):s=!0})),s&&(r.unsubscribe(),r=null,i.subscribe(e))})}function H7e(n,t,e,r,s){return(i,o)=>{let c=e,u=t,h=0;i.subscribe(as(o,g=>{const m=h++;u=c?n(u,g,m):(c=!0,g),r&&o.next(u)},s&&(()=>{c&&o.next(u),o.complete()})))}}function TW(n,t){return fr(H7e(n,t,arguments.length>=2,!0))}function LA(n){return n<=0?()=>Cc:fr((t,e)=>{let r=[];t.subscribe(as(e,s=>{r.push(s),n<r.length&&r.shift()},()=>{for(const s of r)e.next(s);e.complete()},void 0,()=>{r=null}))})}function wW(n,t){const e=arguments.length>=2;return r=>r.pipe(n?Vl((s,i)=>n(s,i,r)):nl,LA(1),e?jy(t):PW(()=>new Wy))}function RA(n){return fr((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const qn="primary",kp=Symbol("RouteTitle");class $7e{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Mf(n){return new $7e(n)}function U7e(n,t,e){const r=e.path.split("/");if(r.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||r.length<n.length))return null;const s={};for(let i=0;i<r.length;i++){const o=r[i],c=n[i];if(o.startsWith(":"))s[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:s}}function T4(n,t){const e=n?Object.keys(n):void 0,r=t?Object.keys(t):void 0;if(!e||!r||e.length!=r.length)return!1;let s;for(let i=0;i<e.length;i++)if(s=e[i],!bW(n[s],t[s]))return!1;return!0}function bW(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),r=[...t].sort();return e.every((s,i)=>r[i]===s)}return n===t}function OW(n){return Array.prototype.concat.apply([],n)}function AW(n){return n.length>0?n[n.length-1]:null}function T2(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function I0(n){return Qb(n)?n:np(n)?cs(Promise.resolve(n)):Kt(n)}const W7e={exact:function xW(n,t,e){if(!Du(n.segments,t.segments)||!Zy(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!n.children[r]||!xW(n.children[r],t.children[r],e))return!1;return!0},subset:kW},NW={exact:function j7e(n,t){return T4(n,t)},subset:function Z7e(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>bW(n[e],t[e]))},ignored:()=>!0};function IW(n,t,e){return W7e[e.paths](n.root,t.root,e.matrixParams)&&NW[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function kW(n,t,e){return LW(n,t,t.segments,e)}function LW(n,t,e,r){if(n.segments.length>e.length){const s=n.segments.slice(0,e.length);return!(!Du(s,e)||t.hasChildren()||!Zy(s,e,r))}if(n.segments.length===e.length){if(!Du(n.segments,e)||!Zy(n.segments,e,r))return!1;for(const s in t.children)if(!n.children[s]||!kW(n.children[s],t.children[s],r))return!1;return!0}{const s=e.slice(0,n.segments.length),i=e.slice(n.segments.length);return!!(Du(n.segments,s)&&Zy(n.segments,s,r)&&n.children[qn])&&LW(n.children[qn],t,i,r)}}function Zy(n,t,e){return t.every((r,s)=>NW[e](n[s].parameters,r.parameters))}class Ru{constructor(t,e,r){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Mf(this.queryParams)),this._queryParamMap}toString(){return X7e.serialize(this)}}class Yn{constructor(t,e){this.segments=t,this.children=e,this.parent=null,T2(e,(r,s)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Yy(this)}}class Lp{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Mf(this.parameters)),this._parameterMap}toString(){return VW(this)}}function Du(n,t){return n.length===t.length&&n.every((e,r)=>e.path===t[r].path)}let RW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:function(){return new zA},providedIn:"root"}),n})();class zA{parse(t){const e=new ofe(t);return new Ru(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${Rp(t.root,!0)}`,r=function efe(n){const t=Object.keys(n).map(e=>{const r=n[e];return Array.isArray(r)?r.map(s=>`${Ky(e)}=${Ky(s)}`).join("&"):`${Ky(e)}=${Ky(r)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${r}${"string"==typeof t.fragment?`#${function Q7e(n){return encodeURI(n)}(t.fragment)}`:""}`}}const X7e=new zA;function Yy(n){return n.segments.map(t=>VW(t)).join("/")}function Rp(n,t){if(!n.hasChildren())return Yy(n);if(t){const e=n.children[qn]?Rp(n.children[qn],!1):"",r=[];return T2(n.children,(s,i)=>{i!==qn&&r.push(`${i}:${Rp(s,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function K7e(n,t){let e=[];return T2(n.children,(r,s)=>{s===qn&&(e=e.concat(t(r,s)))}),T2(n.children,(r,s)=>{s!==qn&&(e=e.concat(t(r,s)))}),e}(n,(r,s)=>s===qn?[Rp(n.children[qn],!1)]:[`${s}:${Rp(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[qn]?`${Yy(n)}/${e[0]}`:`${Yy(n)}/(${e.join("//")})`}}function DW(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ky(n){return DW(n).replace(/%3B/gi,";")}function VA(n){return DW(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Xy(n){return decodeURIComponent(n)}function zW(n){return Xy(n.replace(/\+/g,"%20"))}function VW(n){return`${VA(n.path)}${function J7e(n){return Object.keys(n).map(t=>`;${VA(t)}=${VA(n[t])}`).join("")}(n.parameters)}`}const tfe=/^[^\/()?;=#]+/;function Qy(n){const t=n.match(tfe);return t?t[0]:""}const nfe=/^[^=?&#]+/,sfe=/^[^&#]+/;class ofe{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Yn([],{}):new Yn([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[qn]=new Yn(t,e)),r}parseSegment(){const t=Qy(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Ne(4009,!1);return this.capture(t),new Lp(Xy(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=Qy(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const s=Qy(this.remaining);s&&(r=s,this.capture(r))}t[Xy(e)]=Xy(r)}parseQueryParam(t){const e=function rfe(n){const t=n.match(nfe);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const o=function ife(n){const t=n.match(sfe);return t?t[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const s=zW(e),i=zW(r);if(t.hasOwnProperty(s)){let o=t[s];Array.isArray(o)||(o=[o],t[s]=o),o.push(i)}else t[s]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=Qy(this.remaining),s=this.remaining[r.length];if("/"!==s&&")"!==s&&";"!==s)throw new Ne(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=qn);const o=this.parseChildren();e[i]=1===Object.keys(o).length?o[qn]:new Yn([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Ne(4011,!1)}}function HA(n){return n.segments.length>0?new Yn([],{[qn]:n}):n}function Jy(n){const t={};for(const r of Object.keys(n.children)){const i=Jy(n.children[r]);(i.segments.length>0||i.hasChildren())&&(t[r]=i)}return function afe(n){if(1===n.numberOfChildren&&n.children[qn]){const t=n.children[qn];return new Yn(n.segments.concat(t.segments),t.children)}return n}(new Yn(n.segments,t))}function zu(n){return n instanceof Ru}function ufe(n,t,e,r,s){if(0===e.length)return Sf(t.root,t.root,t.root,r,s);const i=function BW(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new FW(!0,0,n);let t=0,e=!1;const r=n.reduce((s,i,o)=>{if("object"==typeof i&&null!=i){if(i.outlets){const c={};return T2(i.outlets,(u,h)=>{c[h]="string"==typeof u?u.split("/"):u}),[...s,{outlets:c}]}if(i.segmentPath)return[...s,i.segmentPath]}return"string"!=typeof i?[...s,i]:0===o?(i.split("/").forEach((c,u)=>{0==u&&"."===c||(0==u&&""===c?e=!0:".."===c?t++:""!=c&&s.push(c))}),s):[...s,i]},[]);return new FW(e,t,r)}(e);return i.toRoot()?Sf(t.root,t.root,new Yn([],{}),r,s):function o(u){const h=function hfe(n,t,e,r){if(n.isAbsolute)return new Pf(t.root,!0,0);if(-1===r)return new Pf(e,e===t.root,0);return function $W(n,t,e){let r=n,s=t,i=e;for(;i>s;){if(i-=s,r=r.parent,!r)throw new Ne(4005,!1);s=r.segments.length}return new Pf(r,!1,s-i)}(e,r+(Dp(n.commands[0])?0:1),n.numberOfDoubleDots)}(i,t,n.snapshot?._urlSegment,u),g=h.processChildren?Vp(h.segmentGroup,h.index,i.commands):BA(h.segmentGroup,h.index,i.commands);return Sf(t.root,h.segmentGroup,g,r,s)}(n.snapshot?._lastPathIndex)}function Dp(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function zp(n){return"object"==typeof n&&null!=n&&n.outlets}function Sf(n,t,e,r,s){let o,i={};r&&T2(r,(u,h)=>{i[h]=Array.isArray(u)?u.map(g=>`${g}`):`${u}`}),o=n===t?e:HW(n,t,e);const c=HA(Jy(o));return new Ru(c,i,s)}function HW(n,t,e){const r={};return T2(n.children,(s,i)=>{r[i]=s===t?e:HW(s,t,e)}),new Yn(n.segments,r)}class FW{constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&Dp(r[0]))throw new Ne(4003,!1);const s=r.find(zp);if(s&&s!==AW(r))throw new Ne(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Pf{constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}}function BA(n,t,e){if(n||(n=new Yn([],{})),0===n.segments.length&&n.hasChildren())return Vp(n,t,e);const r=function pfe(n,t,e){let r=0,s=t;const i={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(r>=e.length)return i;const o=n.segments[s],c=e[r];if(zp(c))break;const u=`${c}`,h=r<e.length-1?e[r+1]:null;if(s>0&&void 0===u)break;if(u&&h&&"object"==typeof h&&void 0===h.outlets){if(!GW(u,h,o))return i;r+=2}else{if(!GW(u,{},o))return i;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}(n,t,e),s=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const i=new Yn(n.segments.slice(0,r.pathIndex),{});return i.children[qn]=new Yn(n.segments.slice(r.pathIndex),n.children),Vp(i,0,s)}return r.match&&0===s.length?new Yn(n.segments,{}):r.match&&!n.hasChildren()?$A(n,t,e):r.match?Vp(n,0,s):$A(n,t,e)}function Vp(n,t,e){if(0===e.length)return new Yn(n.segments,{});{const r=function dfe(n){return zp(n[0])?n[0].outlets:{[qn]:n}}(e),s={};return T2(r,(i,o)=>{"string"==typeof i&&(i=[i]),null!==i&&(s[o]=BA(n.children[o],t,i))}),T2(n.children,(i,o)=>{void 0===r[o]&&(s[o]=i)}),new Yn(n.segments,s)}}function $A(n,t,e){const r=n.segments.slice(0,t);let s=0;for(;s<e.length;){const i=e[s];if(zp(i)){const u=gfe(i.outlets);return new Yn(r,u)}if(0===s&&Dp(e[0])){r.push(new Lp(n.segments[t].path,UW(e[0]))),s++;continue}const o=zp(i)?i.outlets[qn]:`${i}`,c=s<e.length-1?e[s+1]:null;o&&c&&Dp(c)?(r.push(new Lp(o,UW(c))),s+=2):(r.push(new Lp(o,{})),s++)}return new Yn(r,{})}function gfe(n){const t={};return T2(n,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[r]=$A(new Yn([],{}),0,e))}),t}function UW(n){const t={};return T2(n,(e,r)=>t[r]=`${e}`),t}function GW(n,t,e){return n==e.path&&T4(t,e.parameters)}class Fl{constructor(t,e){this.id=t,this.url=e}}class UA extends Fl{constructor(t,e,r="imperative",s=null){super(t,e),this.type=0,this.navigationTrigger=r,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class x0 extends Fl{constructor(t,e,r){super(t,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class eE extends Fl{constructor(t,e,r,s){super(t,e),this.reason=r,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class qW extends Fl{constructor(t,e,r,s){super(t,e),this.error=r,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class mfe extends Fl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _fe extends Fl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class vfe extends Fl{constructor(t,e,r,s,i){super(t,e),this.urlAfterRedirects=r,this.state=s,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Cfe extends Fl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yfe extends Fl{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Efe{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Mfe{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Sfe{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Pfe{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Tfe{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wfe{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class WW{constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class jW{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=GA(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){const e=GA(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=qA(t,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return qA(t,this._root).map(e=>e.value)}}function GA(n,t){if(n===t.value)return t;for(const e of t.children){const r=GA(n,e);if(r)return r}return null}function qA(n,t){if(n===t.value)return[t];for(const e of t.children){const r=qA(n,e);if(r.length)return r.unshift(t),r}return[]}class Bl{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Tf(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class ZW extends jW{constructor(t,e){super(t),this.snapshot=e,WA(this,t)}toString(){return this.snapshot.toString()}}function YW(n,t){const e=function Ofe(n,t){const o=new tE([],{},{},"",{},qn,t,null,n.root,-1,{});return new XW("",new Bl(o,[]))}(n,t),r=new I3([new Lp("",{})]),s=new I3({}),i=new I3({}),o=new I3({}),c=new I3(""),u=new xo(r,s,o,c,i,qn,t,e.root);return u.snapshot=e.root,new ZW(new Bl(u,[]),e)}class xo{constructor(t,e,r,s,i,o,c,u){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.pipe(vn(h=>h[kp]))??Kt(void 0),this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(vn(t=>Mf(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(vn(t=>Mf(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function KW(n,t="emptyOnly"){const e=n.pathFromRoot;let r=0;if("always"!==t)for(r=e.length-1;r>=1;){const s=e[r],i=e[r-1];if(s.routeConfig&&""===s.routeConfig.path)r--;else{if(i.component)break;r--}}return function Afe(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class tE{constructor(t,e,r,s,i,o,c,u,h,g,m,E){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.[kp],this.routeConfig=u,this._urlSegment=h,this._lastPathIndex=g,this._correctedLastPathIndex=E??g,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Mf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Mf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class XW extends jW{constructor(t,e){super(e),this.url=t,WA(this,e)}toString(){return QW(this._root)}}function WA(n,t){t.value._routerState=n,t.children.forEach(e=>WA(n,e))}function QW(n){const t=n.children.length>0?` { ${n.children.map(QW).join(", ")} } `:"";return`${n.value}${t}`}function jA(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,T4(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),T4(t.params,e.params)||n.params.next(e.params),function G7e(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!T4(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),T4(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function ZA(n,t){const e=T4(n.params,t.params)&&function Y7e(n,t){return Du(n,t)&&n.every((e,r)=>T4(e.parameters,t[r].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||ZA(n.parent,t.parent))}function Hp(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=t.value;const s=function Ife(n,t,e){return t.children.map(r=>{for(const s of e.children)if(n.shouldReuseRoute(r.value,s.value.snapshot))return Hp(n,r,s);return Hp(n,r)})}(n,t,e);return new Bl(r,s)}{if(n.shouldAttach(t.value)){const i=n.retrieve(t.value);if(null!==i){const o=i.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(c=>Hp(n,c)),o}}const r=function xfe(n){return new xo(new I3(n.url),new I3(n.params),new I3(n.queryParams),new I3(n.fragment),new I3(n.data),n.outlet,n.component,n)}(t.value),s=t.children.map(i=>Hp(n,i));return new Bl(r,s)}}const YA="ngNavigationCancelingError";function JW(n,t){const{redirectTo:e,navigationBehaviorOptions:r}=zu(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=ej(!1,0,t);return s.url=e,s.navigationBehaviorOptions=r,s}function ej(n,t,e){const r=new Error("NavigationCancelingError: "+(n||""));return r[YA]=!0,r.cancellationCode=t,e&&(r.url=e),r}function tj(n){return nj(n)&&zu(n.url)}function nj(n){return n&&n[YA]}class kfe{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Fp,this.attachRef=null}}let Fp=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const s=this.getOrCreateContext(e);s.outlet=r,this.contexts.set(e,s)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new kfe,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const nE=!1;let KA=(()=>{class n{constructor(e,r,s,i,o){this.parentContexts=e,this.location=r,this.changeDetector=i,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new hr,this.deactivateEvents=new hr,this.attachEvents=new hr,this.detachEvents=new hr,this.name=s||qn,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ne(4012,nE);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ne(4012,nE);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ne(4012,nE);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new Ne(4013,nE);this._activatedRoute=e;const s=this.location,o=e._futureSnapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new Lfe(e,c,s.injector);if(r&&function Rfe(n){return!!n.resolveComponentFactory}(r)){const h=r.resolveComponentFactory(o);this.activated=s.createComponent(h,s.length,u)}else this.activated=s.createComponent(o,{index:s.length,injector:u,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)(Q(Fp),Q(Ga),j8("name"),Q(wu),Q(Va))},n.\u0275dir=qt({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class Lfe{constructor(t,e,r){this.route=t,this.childContexts=e,this.parent=r}get(t,e){return t===xo?this.route:t===Fp?this.childContexts:this.parent.get(t,e)}}let XA=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ut({type:n,selectors:[["ng-component"]],standalone:!0,features:[q$],decls:1,vars:0,template:function(e,r){1&e&&X(0,"router-outlet")},dependencies:[KA],encapsulation:2}),n})();function rj(n,t){return n.providers&&!n._injector&&(n._injector=iy(n.providers,t,`Route: ${n.path}`)),n._injector??t}function JA(n){const t=n.children&&n.children.map(JA),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==qn&&(e.component=XA),e}function Ic(n){return n.outlet||qn}function sj(n,t){const e=n.filter(r=>Ic(r)===t);return e.push(...n.filter(r=>Ic(r)!==t)),e}function Bp(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class Ffe{constructor(t,e,r,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=s}activate(t){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),jA(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){const s=Tf(e);t.children.forEach(i=>{const o=i.value.outlet;this.deactivateRoutes(i,s[o],r),delete s[o]}),T2(s,(i,o)=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(s===i)if(s.component){const o=r.getContext(s.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,r);else i&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=Tf(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);if(r&&r.outlet){const o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:c})}}deactivateRouteAndOutlet(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=Tf(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,e,r){const s=Tf(e);t.children.forEach(i=>{this.activateRoutes(i,s[i.value.outlet],r),this.forwardEvent(new wfe(i.value.snapshot))}),t.children.length&&this.forwardEvent(new Pfe(t.value.snapshot))}activateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(jA(s),s===i)if(s.component){const o=r.getOrCreateContext(s.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,r);else if(s.component){const o=r.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const c=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),jA(c.route.value),this.activateChildRoutes(t,null,o.children)}else{const c=Bp(s.snapshot),u=c?.get(a0)??null;o.attachRef=null,o.route=s,o.resolver=u,o.injector=c,o.outlet&&o.outlet.activateWith(s,o.injector),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,r)}}class ij{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class rE{constructor(t,e){this.component=t,this.route=e}}function Bfe(n,t,e){const r=n._root;return $p(r,t?t._root:null,e,[r.value])}function wf(n,t){const e=Symbol(),r=t.get(n,e);return r===e?"function"!=typeof n||function j2(n){return null!==Dn(n)}(n)?t.get(n):n:r}function $p(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=Tf(t);return n.children.forEach(o=>{(function Ufe(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=n.value,o=t?t.value:null,c=e?e.getContext(n.value.outlet):null;if(o&&i.routeConfig===o.routeConfig){const u=function Gfe(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!Du(n.url,t.url);case"pathParamsOrQueryParamsChange":return!Du(n.url,t.url)||!T4(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ZA(n,t)||!T4(n.queryParams,t.queryParams);default:return!ZA(n,t)}}(o,i,i.routeConfig.runGuardsAndResolvers);u?s.canActivateChecks.push(new ij(r)):(i.data=o.data,i._resolvedData=o._resolvedData),$p(n,t,i.component?c?c.children:null:e,r,s),u&&c&&c.outlet&&c.outlet.isActivated&&s.canDeactivateChecks.push(new rE(c.outlet.component,o))}else o&&Up(t,c,s),s.canActivateChecks.push(new ij(r)),$p(n,null,i.component?c?c.children:null:e,r,s)})(o,i[o.value.outlet],e,r.concat([o.value]),s),delete i[o.value.outlet]}),T2(i,(o,c)=>Up(o,e.getContext(c),s)),s}function Up(n,t,e){const r=Tf(n),s=n.value;T2(r,(i,o)=>{Up(i,s.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new rE(s.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,s))}function Gp(n){return"function"==typeof n}function eN(n){return n instanceof Wy||"EmptyError"===n?.name}const sE=Symbol("INITIAL_VALUE");function bf(){return P4(n=>yW(n.map(t=>t.pipe(xp(1),function z7e(...n){const t=Y3(n);return fr((e,r)=>{(t?xA(n,e,t):xA(n,e)).subscribe(r)})}(sE)))).pipe(vn(t=>{for(const e of t)if(!0!==e){if(e===sE)return sE;if(!1===e||e instanceof Ru)return e}return!0}),Vl(t=>t!==sE),xp(1)))}function oj(n){return function rT(...n){return l_(n)}(P2(t=>{if(zu(t))throw JW(0,t)}),vn(t=>!0===t))}const tN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function aj(n,t,e,r,s){const i=nN(n,t,e);return i.matched?function ahe(n,t,e,r){const s=t.canMatch;return s&&0!==s.length?Kt(s.map(o=>{const c=wf(o,n);return I0(function Kfe(n){return n&&Gp(n.canMatch)}(c)?c.canMatch(t,e):n.runInContext(()=>c(t,e)))})).pipe(bf(),oj()):Kt(!0)}(r=rj(t,r),t,e).pipe(vn(o=>!0===o?i:{...tN})):Kt(i)}function nN(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...tN}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const s=(t.matcher||U7e)(e,n,t);if(!s)return{...tN};const i={};T2(s.posParams,(c,u)=>{i[u]=c.path});const o=s.consumed.length>0?{...i,...s.consumed[s.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:o,positionalParamSegments:s.posParams??{}}}function iE(n,t,e,r,s="corrected"){if(e.length>0&&function uhe(n,t,e){return e.some(r=>oE(n,t,r)&&Ic(r)!==qn)}(n,e,r)){const o=new Yn(t,function lhe(n,t,e,r){const s={};s[qn]=r,r._sourceSegment=n,r._segmentIndexShift=t.length;for(const i of e)if(""===i.path&&Ic(i)!==qn){const o=new Yn([],{});o._sourceSegment=n,o._segmentIndexShift=t.length,s[Ic(i)]=o}return s}(n,t,r,new Yn(e,n.children)));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===e.length&&function fhe(n,t,e){return e.some(r=>oE(n,t,r))}(n,e,r)){const o=new Yn(n.segments,function che(n,t,e,r,s,i){const o={};for(const c of r)if(oE(n,e,c)&&!s[Ic(c)]){const u=new Yn([],{});u._sourceSegment=n,u._segmentIndexShift="legacy"===i?n.segments.length:t.length,o[Ic(c)]=u}return{...s,...o}}(n,t,e,r,n.children,s));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:e}}const i=new Yn(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:e}}function oE(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function cj(n,t,e,r){return!!(Ic(n)===r||r!==qn&&oE(t,e,n))&&("**"===n.path||nN(t,n,e).matched)}function lj(n,t,e){return 0===t.length&&!n.children[e]}const aE=!1;class cE{constructor(t){this.segmentGroup=t||null}}class uj{constructor(t){this.urlTree=t}}function qp(n){return Ip(new cE(n))}function fj(n){return Ip(new uj(n))}class ghe{constructor(t,e,r,s,i){this.injector=t,this.configLoader=e,this.urlSerializer=r,this.urlTree=s,this.config=i,this.allowRedirects=!0}apply(){const t=iE(this.urlTree.root,[],[],this.config).segmentGroup,e=new Yn(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,qn).pipe(vn(i=>this.createUrlTree(Jy(i),this.urlTree.queryParams,this.urlTree.fragment))).pipe(N0(i=>{if(i instanceof uj)return this.allowRedirects=!1,this.match(i.urlTree);throw i instanceof cE?this.noMatchError(i):i}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,qn).pipe(vn(s=>this.createUrlTree(Jy(s),t.queryParams,t.fragment))).pipe(N0(s=>{throw s instanceof cE?this.noMatchError(s):s}))}noMatchError(t){return new Ne(4002,aE)}createUrlTree(t,e,r){const s=HA(t);return new Ru(s,e,r)}expandSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,e,r).pipe(vn(i=>new Yn([],i))):this.expandSegment(t,r,e,r.segments,s,!0)}expandChildren(t,e,r){const s=[];for(const i of Object.keys(r.children))"primary"===i?s.unshift(i):s.push(i);return cs(s).pipe(b0(i=>{const o=r.children[i],c=sj(e,i);return this.expandSegmentGroup(t,c,o,i).pipe(vn(u=>({segment:u,outlet:i})))}),TW((i,o)=>(i[o.outlet]=o.segment,i),{}),wW())}expandSegment(t,e,r,s,i,o){return cs(r).pipe(b0(c=>this.expandSegmentAgainstRoute(t,e,r,c,s,i,o).pipe(N0(h=>{if(h instanceof cE)return Kt(null);throw h}))),A0(c=>!!c),N0((c,u)=>{if(eN(c))return lj(e,s,i)?Kt(new Yn([],{})):qp(e);throw c}))}expandSegmentAgainstRoute(t,e,r,s,i,o,c){return cj(s,e,i,o)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(t,e,s,i,o):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o):qp(e):qp(e)}expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,s,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,r,s){const i=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?fj(i):this.lineralizeSegments(r,i).pipe(He(o=>{const c=new Yn(o,{});return this.expandSegment(t,c,e,o,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){const{matched:c,consumedSegments:u,remainingSegments:h,positionalParamSegments:g}=nN(e,s,i);if(!c)return qp(e);const m=this.applyRedirectCommands(u,s.redirectTo,g);return s.redirectTo.startsWith("/")?fj(m):this.lineralizeSegments(s,m).pipe(He(E=>this.expandSegment(t,e,r,E.concat(h),o,!1)))}matchSegmentAgainstRoute(t,e,r,s,i){return"**"===r.path?(t=rj(r,t),r.loadChildren?(r._loadedRoutes?Kt({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(t,r)).pipe(vn(c=>(r._loadedRoutes=c.routes,r._loadedInjector=c.injector,new Yn(s,{})))):Kt(new Yn(s,{}))):aj(e,r,s,t).pipe(P4(({matched:o,consumedSegments:c,remainingSegments:u})=>o?this.getChildConfig(t=r._injector??t,r,s).pipe(He(g=>{const m=g.injector??t,E=g.routes,{segmentGroup:b,slicedSegments:k}=iE(e,c,u,E),U=new Yn(b.segments,b.children);if(0===k.length&&U.hasChildren())return this.expandChildren(m,E,U).pipe(vn(te=>new Yn(c,te)));if(0===E.length&&0===k.length)return Kt(new Yn(c,{}));const j=Ic(r)===i;return this.expandSegment(m,U,E,k,j?qn:i,!0).pipe(vn(ye=>new Yn(c.concat(ye.segments),ye.children)))})):qp(e)))}getChildConfig(t,e,r){return e.children?Kt({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?Kt({routes:e._loadedRoutes,injector:e._loadedInjector}):function ohe(n,t,e,r){const s=t.canLoad;return void 0===s||0===s.length?Kt(!0):Kt(s.map(o=>{const c=wf(o,n);return I0(function Wfe(n){return n&&Gp(n.canLoad)}(c)?c.canLoad(t,e):n.runInContext(()=>c(t,e)))})).pipe(bf(),oj())}(t,e,r).pipe(He(s=>s?this.configLoader.loadChildren(t,e).pipe(P2(i=>{e._loadedRoutes=i.routes,e._loadedInjector=i.injector})):function dhe(n){return Ip(ej(aE,3))}())):Kt({routes:[],injector:t})}lineralizeSegments(t,e){let r=[],s=e.root;for(;;){if(r=r.concat(s.segments),0===s.numberOfChildren)return Kt(r);if(s.numberOfChildren>1||!s.children[qn])return Ip(new Ne(4e3,aE));s=s.children[qn]}}applyRedirectCommands(t,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,r)}applyRedirectCreateUrlTree(t,e,r,s){const i=this.createSegmentGroup(t,e.root,r,s);return new Ru(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const r={};return T2(t,(s,i)=>{if("string"==typeof s&&s.startsWith(":")){const c=s.substring(1);r[i]=e[c]}else r[i]=s}),r}createSegmentGroup(t,e,r,s){const i=this.createSegments(t,e.segments,r,s);let o={};return T2(e.children,(c,u)=>{o[u]=this.createSegmentGroup(t,c,r,s)}),new Yn(i,o)}createSegments(t,e,r,s){return e.map(i=>i.path.startsWith(":")?this.findPosParam(t,i,s):this.findOrReturn(i,r))}findPosParam(t,e,r){const s=r[e.path.substring(1)];if(!s)throw new Ne(4001,aE);return s}findOrReturn(t,e){let r=0;for(const s of e){if(s.path===t.path)return e.splice(r),s;r++}return t}}class _he{}class yhe{constructor(t,e,r,s,i,o,c,u){this.injector=t,this.rootComponentType=e,this.config=r,this.urlTree=s,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=c,this.urlSerializer=u}recognize(){const t=iE(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,qn).pipe(vn(e=>{if(null===e)return null;const r=new tE([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},qn,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new Bl(r,e),i=new XW(this.url,s);return this.inheritParamsAndData(i._root),i}))}inheritParamsAndData(t){const e=t.value,r=KW(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),t.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,e,r):this.processSegment(t,e,r,r.segments,s)}processChildren(t,e,r){return cs(Object.keys(r.children)).pipe(b0(s=>{const i=r.children[s],o=sj(e,s);return this.processSegmentGroup(t,o,i,s)}),TW((s,i)=>s&&i?(s.push(...i),s):null),function F7e(n,t=!1){return fr((e,r)=>{let s=0;e.subscribe(as(r,i=>{const o=n(i,s++);(o||t)&&r.next(i),!o&&r.complete()}))})}(s=>null!==s),jy(null),wW(),vn(s=>{if(null===s)return null;const i=hj(s);return function Ehe(n){n.sort((t,e)=>t.value.outlet===qn?-1:e.value.outlet===qn?1:t.value.outlet.localeCompare(e.value.outlet))}(i),i}))}processSegment(t,e,r,s,i){return cs(e).pipe(b0(o=>this.processSegmentAgainstRoute(o._injector??t,o,r,s,i)),A0(o=>!!o),N0(o=>{if(eN(o))return lj(r,s,i)?Kt([]):Kt(null);throw o}))}processSegmentAgainstRoute(t,e,r,s,i){if(e.redirectTo||!cj(e,r,s,i))return Kt(null);let o;if("**"===e.path){const c=s.length>0?AW(s).parameters:{},u=pj(r)+s.length;o=Kt({snapshot:new tE(s,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,mj(e),Ic(e),e.component??e._loadedComponent??null,e,dj(r),u,_j(e),u),consumedSegments:[],remainingSegments:[]})}else o=aj(r,e,s,t).pipe(vn(({matched:c,consumedSegments:u,remainingSegments:h,parameters:g})=>{if(!c)return null;const m=pj(r)+u.length;return{snapshot:new tE(u,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,mj(e),Ic(e),e.component??e._loadedComponent??null,e,dj(r),m,_j(e),m),consumedSegments:u,remainingSegments:h}}));return o.pipe(P4(c=>{if(null===c)return Kt(null);const{snapshot:u,consumedSegments:h,remainingSegments:g}=c;t=e._injector??t;const m=e._loadedInjector??t,E=function Mhe(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:b,slicedSegments:k}=iE(r,h,g,E.filter(j=>void 0===j.redirectTo),this.relativeLinkResolution);if(0===k.length&&b.hasChildren())return this.processChildren(m,E,b).pipe(vn(j=>null===j?null:[new Bl(u,j)]));if(0===E.length&&0===k.length)return Kt([new Bl(u,[])]);const U=Ic(e)===i;return this.processSegment(m,E,b,k,U?qn:i).pipe(vn(j=>null===j?null:[new Bl(u,j)]))}))}}function She(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function hj(n){const t=[],e=new Set;for(const r of n){if(!She(r)){t.push(r);continue}const s=t.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==s?(s.children.push(...r.children),e.add(s)):t.push(r)}for(const r of e){const s=hj(r.children);t.push(new Bl(r.value,s))}return t.filter(r=>!e.has(r))}function dj(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function pj(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function mj(n){return n.data||{}}function _j(n){return n.resolve||{}}function vj(n){return"string"==typeof n.title||null===n.title}function rN(n){return P4(t=>{const e=n(t);return e?cs(e).pipe(vn(()=>t)):Kt(t)})}let Cj=(()=>{class n{buildTitle(e){let r,s=e.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(i=>i.outlet===qn);return r}getResolvedTitleForRoute(e){return e.data[kp]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:function(){return Hr(yj)},providedIn:"root"}),n})(),yj=(()=>{class n extends Cj{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(e){return new(e||n)(Ve(QG))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ihe{}class khe extends class xhe{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const uE=new Dt("",{providedIn:"root",factory:()=>({})}),sN=new Dt("ROUTES");let iN=(()=>{class n{constructor(e,r){this.injector=e,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Kt(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=I0(e.loadComponent()).pipe(P2(i=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=i}),RA(()=>{this.componentLoaders.delete(e)})),s=new SW(r,()=>new q2).pipe(kA());return this.componentLoaders.set(e,s),s}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Kt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(vn(c=>{this.onLoadEndListener&&this.onLoadEndListener(r);let u,h,g=!1;Array.isArray(c)?h=c:(u=c.create(e).injector,h=OW(u.get(sN,[],Yt.Self|Yt.Optional)));return{routes:h.map(JA),injector:u}}),RA(()=>{this.childrenLoaders.delete(r)})),o=new SW(i,()=>new q2).pipe(kA());return this.childrenLoaders.set(r,o),o}loadModuleFactoryOrRoutes(e){return I0(e()).pipe(He(r=>r instanceof U$||Array.isArray(r)?Kt(r):cs(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(e){return new(e||n)(Ve(fi),Ve(TO))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Rhe{}class Dhe{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function zhe(n){throw n}function Vhe(n,t,e){return t.parse("/")}const Hhe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Fhe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function Mj(){const n=Hr(RW),t=Hr(Fp),e=Hr(FO),r=Hr(fi),s=Hr(TO),i=Hr(sN,{optional:!0})??[],o=Hr(uE,{optional:!0})??{},c=Hr(yj),u=Hr(Cj,{optional:!0}),h=Hr(Rhe,{optional:!0}),g=Hr(Ihe,{optional:!0}),m=new Kn(null,n,t,e,r,s,OW(i));return h&&(m.urlHandlingStrategy=h),g&&(m.routeReuseStrategy=g),m.titleStrategy=u??c,function Bhe(n,t){n.errorHandler&&(t.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(t.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(t.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(t.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(t.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(t.canceledNavigationResolution=n.canceledNavigationResolution)}(o,m),m}let Kn=(()=>{class n{constructor(e,r,s,i,o,c,u){this.rootComponentType=e,this.urlSerializer=r,this.rootContexts=s,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new q2,this.errorHandler=zhe,this.malformedUriErrorHandler=Vhe,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Kt(void 0),this.urlHandlingStrategy=new Dhe,this.routeReuseStrategy=new khe,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(iN),this.configLoader.onLoadEndListener=E=>this.triggerEvent(new Mfe(E)),this.configLoader.onLoadStartListener=E=>this.triggerEvent(new Efe(E)),this.ngModule=o.get(Tu),this.console=o.get(g0e);const m=o.get(Pr);this.isNgZoneEnabled=m instanceof Pr&&Pr.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=function q7e(){return new Ru(new Yn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=YW(this.currentUrlTree,this.rootComponentType),this.transitions=new I3({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const r=this.events;return e.pipe(Vl(s=>0!==s.id),vn(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),P4(s=>{let i=!1,o=!1;return Kt(s).pipe(P2(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),P4(c=>{const u=this.browserUrlTree.toString(),h=!this.navigated||c.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||h)&&this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Sj(c.source)&&(this.browserUrlTree=c.extractedUrl),Kt(c).pipe(P4(m=>{const E=this.transitions.getValue();return r.next(new UA(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),E!==this.transitions.getValue()?Cc:Promise.resolve(m)}),function mhe(n,t,e,r){return P4(s=>function phe(n,t,e,r,s){return new ghe(n,t,e,r,s).apply()}(n,t,e,s.extractedUrl,r).pipe(vn(i=>({...s,urlAfterRedirects:i}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),P2(m=>{this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects},s.urlAfterRedirects=m.urlAfterRedirects}),function The(n,t,e,r,s,i){return He(o=>function Che(n,t,e,r,s,i,o="emptyOnly",c="legacy"){return new yhe(n,t,e,r,s,o,c,i).recognize().pipe(P4(u=>null===u?function vhe(n){return new yr(t=>t.error(n))}(new _he):Kt(u)))}(n,t,e,o.urlAfterRedirects,r.serialize(o.urlAfterRedirects),r,s,i).pipe(vn(c=>({...o,targetSnapshot:c}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),P2(m=>{if(s.targetSnapshot=m.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const b=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(b,m)}this.browserUrlTree=m.urlAfterRedirects}const E=new mfe(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);r.next(E)}));if(h&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:E,extractedUrl:b,source:k,restoredState:U,extras:j}=c,oe=new UA(E,this.serializeUrl(b),k,U);r.next(oe);const ye=YW(b,this.rootComponentType).snapshot;return Kt(s={...c,targetSnapshot:ye,urlAfterRedirects:b,extras:{...j,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=c.rawUrl,c.resolve(null),Cc}),P2(c=>{const u=new _fe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(u)}),vn(c=>s={...c,guards:Bfe(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),function Qfe(n,t){return He(e=>{const{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:i,canDeactivateChecks:o}}=e;return 0===o.length&&0===i.length?Kt({...e,guardsResult:!0}):function Jfe(n,t,e,r){return cs(n).pipe(He(s=>function ihe(n,t,e,r,s){const i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?Kt(i.map(c=>{const u=Bp(t)??s,h=wf(c,u);return I0(function Yfe(n){return n&&Gp(n.canDeactivate)}(h)?h.canDeactivate(n,t,e,r):u.runInContext(()=>h(n,t,e,r))).pipe(A0())})).pipe(bf()):Kt(!0)}(s.component,s.route,e,t,r)),A0(s=>!0!==s,!0))}(o,r,s,n).pipe(He(c=>c&&function qfe(n){return"boolean"==typeof n}(c)?function ehe(n,t,e,r){return cs(t).pipe(b0(s=>xA(function nhe(n,t){return null!==n&&t&&t(new Sfe(n)),Kt(!0)}(s.route.parent,r),function the(n,t){return null!==n&&t&&t(new Tfe(n)),Kt(!0)}(s.route,r),function she(n,t,e){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(o=>function $fe(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(o)).filter(o=>null!==o).map(o=>MW(()=>Kt(o.guards.map(u=>{const h=Bp(o.node)??e,g=wf(u,h);return I0(function Zfe(n){return n&&Gp(n.canActivateChild)}(g)?g.canActivateChild(r,n):h.runInContext(()=>g(r,n))).pipe(A0())})).pipe(bf())));return Kt(i).pipe(bf())}(n,s.path,e),function rhe(n,t,e){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Kt(!0);const s=r.map(i=>MW(()=>{const o=Bp(t)??e,c=wf(i,o);return I0(function jfe(n){return n&&Gp(n.canActivate)}(c)?c.canActivate(t,n):o.runInContext(()=>c(t,n))).pipe(A0())}));return Kt(s).pipe(bf())}(n,s.route,e))),A0(s=>!0!==s,!0))}(r,i,n,t):Kt(c)),vn(c=>({...e,guardsResult:c})))})}(this.ngModule.injector,c=>this.triggerEvent(c)),P2(c=>{if(s.guardsResult=c.guardsResult,zu(c.guardsResult))throw JW(0,c.guardsResult);const u=new vfe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.triggerEvent(u)}),Vl(c=>!!c.guardsResult||(this.restoreHistory(c),this.cancelNavigationTransition(c,"",3),!1)),rN(c=>{if(c.guards.canActivateChecks.length)return Kt(c).pipe(P2(u=>{const h=new Cfe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}),P4(u=>{let h=!1;return Kt(u).pipe(function whe(n,t){return He(e=>{const{targetSnapshot:r,guards:{canActivateChecks:s}}=e;if(!s.length)return Kt(e);let i=0;return cs(s).pipe(b0(o=>function bhe(n,t,e,r){const s=n.routeConfig,i=n._resolve;return void 0!==s?.title&&!vj(s)&&(i[kp]=s.title),function Ohe(n,t,e,r){const s=function Ahe(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===s.length)return Kt({});const i={};return cs(s).pipe(He(o=>function Nhe(n,t,e,r){const s=Bp(t)??r,i=wf(n,s);return I0(i.resolve?i.resolve(t,e):s.runInContext(()=>i(t,e)))}(n[o],t,e,r).pipe(A0(),P2(c=>{i[o]=c}))),LA(1),function B7e(n){return vn(()=>n)}(i),N0(o=>eN(o)?Cc:Ip(o)))}(i,n,t,r).pipe(vn(o=>(n._resolvedData=o,n.data=KW(n,e).resolve,s&&vj(s)&&(n.data[kp]=s.title),null)))}(o.route,r,n,t)),P2(()=>i++),LA(1),He(o=>i===s.length?Kt(e):Cc))})}(this.paramsInheritanceStrategy,this.ngModule.injector),P2({next:()=>h=!0,complete:()=>{h||(this.restoreHistory(u),this.cancelNavigationTransition(u,"",2))}}))}),P2(u=>{const h=new yfe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}))}),rN(c=>{const u=h=>{const g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe(P2(m=>{h.component=m}),vn(()=>{})));for(const m of h.children)g.push(...u(m));return g};return yW(u(c.targetSnapshot.root)).pipe(jy(),xp(1))}),rN(()=>this.afterPreactivation()),vn(c=>{const u=function Nfe(n,t,e){const r=Hp(n,t._root,e?e._root:void 0);return new ZW(r,t)}(this.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return s={...c,targetRouterState:u}}),P2(c=>{this.currentUrlTree=c.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),this.routerState=c.targetRouterState,"deferred"===this.urlUpdateStrategy&&(c.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,c),this.browserUrlTree=c.urlAfterRedirects)}),((n,t,e)=>vn(r=>(new Ffe(t,r.targetRouterState,r.currentRouterState,e).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,c=>this.triggerEvent(c)),P2({next(){i=!0},complete(){i=!0}}),RA(()=>{i||o||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),N0(c=>{if(o=!0,nj(c)){tj(c)||(this.navigated=!0,this.restoreHistory(s,!0));const u=new eE(s.id,this.serializeUrl(s.extractedUrl),c.message,c.cancellationCode);if(r.next(u),tj(c)){const h=this.urlHandlingStrategy.merge(c.url,this.rawUrlTree),g={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Sj(s.source)};this.scheduleNavigation(h,"imperative",null,g,{resolve:s.resolve,reject:s.reject,promise:s.promise})}else s.resolve(!1)}else{this.restoreHistory(s,!0);const u=new qW(s.id,this.serializeUrl(s.extractedUrl),c,s.targetSnapshot??void 0);r.next(u);try{s.resolve(this.errorHandler(c))}catch(h){s.reject(h)}}return Cc}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const s={replaceUrl:!0},i=e.state?.navigationId?e.state:null;if(i){const c={...i};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(s.state=c)}const o=this.parseUrl(e.url);this.scheduleNavigation(o,r,i,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(JA),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:s,queryParams:i,fragment:o,queryParamsHandling:c,preserveFragment:u}=r,h=s||this.routerState.root,g=u?this.currentUrlTree.fragment:o;let m=null;switch(c){case"merge":m={...this.currentUrlTree.queryParams,...i};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=i||null}return null!==m&&(m=this.removeEmptyProps(m)),ufe(h,this.currentUrlTree,e,m,g??null)}navigateByUrl(e,r={skipLocationChange:!1}){const s=zu(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function $he(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new Ne(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(s){r=this.malformedUriErrorHandler(s,this.urlSerializer,e)}return r}isActive(e,r){let s;if(s=!0===r?{...Hhe}:!1===r?{...Fhe}:r,zu(e))return IW(this.currentUrlTree,e,s);const i=this.parseUrl(e);return IW(this.currentUrlTree,i,s)}removeEmptyProps(e){return Object.keys(e).reduce((r,s)=>{const i=e[s];return null!=i&&(r[s]=i),r},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new x0(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,r,s,i,o){if(this.disposed)return Promise.resolve(!1);let c,u,h;o?(c=o.resolve,u=o.reject,h=o.promise):h=new Promise((E,b)=>{c=E,u=b});const g=++this.navigationId;let m;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(s=this.location.getState()),m=s&&s.\u0275routerPageId?s.\u0275routerPageId:i.replaceUrl||i.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):m=0,this.setTransition({id:g,targetPageId:m,source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:i,resolve:c,reject:u,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(E=>Promise.reject(E))}setBrowserUrl(e,r){const s=this.urlSerializer.serialize(e),i={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl?this.location.replaceState(s,"",i):this.location.go(s,"",i)}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===s?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===s&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(s)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,r,s){const i=new eE(e.id,this.serializeUrl(e.extractedUrl),r,s);this.triggerEvent(i),e.resolve(!1)}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return n.\u0275fac=function(e){Y7()},n.\u0275prov=et({token:n,factory:function(){return Mj()},providedIn:"root"}),n})();function Sj(n){return"imperative"!==n}let Of=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.route=r,this.tabIndexAttribute=s,this.renderer=i,this.el=o,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new q2,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=Ll(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Ll(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Ll(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const r=this.renderer,s=this.el.nativeElement;null!==e?r.setAttribute(s,"tabindex",e):r.removeAttribute(s,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(Q(Kn),Q(xo),j8("tabindex"),Q(To),Q(v2))},n.\u0275dir=qt({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,r){1&e&&ee("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[u2]}),n})(),Vu=(()=>{class n{constructor(e,r,s){this.router=e,this.route=r,this.locationStrategy=s,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new q2,this.subscription=e.events.subscribe(i=>{i instanceof x0&&this.updateTargetUrlAndHref()})}set preserveFragment(e){this._preserveFragment=Ll(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Ll(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Ll(e)}get replaceUrl(){return this._replaceUrl}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,r,s,i,o){return!!(0!==e||r||s||i||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(Q(Kn),Q(xo),Q(Ou))},n.\u0275dir=qt({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,r){1&e&&ee("click",function(i){return r.onClick(i.button,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey)}),2&e&&D("target",r.target)("href",r.href,m3)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[u2]}),n})();class Pj{}let qhe=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.injector=s,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Vl(e=>e instanceof x0),b0(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const s=[];for(const i of r){i.providers&&!i._injector&&(i._injector=iy(i.providers,e,`Route: ${i.path}`));const o=i._injector??e,c=i._loadedInjector??o;i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent?s.push(this.preloadConfig(o,i)):(i.children||i._loadedRoutes)&&s.push(this.processRoutes(c,i.children??i._loadedRoutes))}return cs(s).pipe(il())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let s;s=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):Kt(null);const i=s.pipe(He(o=>null===o?Kt(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));return r.loadComponent&&!r._loadedComponent?cs([i,this.loader.loadComponent(r)]).pipe(il()):i})}}return n.\u0275fac=function(e){return new(e||n)(Ve(Kn),Ve(TO),Ve(Va),Ve(Pj),Ve(iN))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const oN=new Dt("");let Tj=(()=>{class n{constructor(e,r,s={}){this.router=e,this.viewportScroller=r,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof UA?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof x0&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof WW&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.router.triggerEvent(new WW(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(e){Y7()},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();function Af(n,t){return{\u0275kind:n,\u0275providers:t}}function aN(n){return[{provide:sN,multi:!0,useValue:n}]}function bj(){const n=Hr(fi);return t=>{const e=n.get(pp);if(t!==e.components[0])return;const r=n.get(Kn),s=n.get(Oj);1===n.get(cN)&&r.initialNavigation(),n.get(Aj,null,Yt.Optional)?.setUpPreloading(),n.get(oN,null,Yt.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),s.next(),s.complete()}}const Oj=new Dt("",{factory:()=>new q2}),cN=new Dt("",{providedIn:"root",factory:()=>1});const Aj=new Dt("");function Yhe(n){return Af(0,[{provide:Aj,useExisting:qhe},{provide:Pj,useExisting:n}])}const Nj=new Dt("ROUTER_FORROOT_GUARD"),Khe=[FO,{provide:RW,useClass:zA},{provide:Kn,useFactory:Mj},Fp,{provide:xo,useFactory:function wj(n){return n.routerState.root},deps:[Kn]},iN];function Xhe(){return new FU("Router",Kn)}let Qhe=(()=>{class n{constructor(e){}static forRoot(e,r){return{ngModule:n,providers:[Khe,[],aN(e),{provide:Nj,useFactory:nde,deps:[[Kn,new ui,new eu]]},{provide:uE,useValue:r||{}},r?.useHash?{provide:Ou,useClass:r8e}:{provide:Ou,useClass:fG},{provide:oN,useFactory:()=>{const n=Hr(Kn),t=Hr(Eue),e=Hr(uE);return e.scrollOffset&&t.setOffset(e.scrollOffset),new Tj(n,t,e)}},r?.preloadingStrategy?Yhe(r.preloadingStrategy).\u0275providers:[],{provide:FU,multi:!0,useFactory:Xhe},r?.initialNavigation?rde(r):[],[{provide:Ij,useFactory:bj},{provide:xU,multi:!0,useExisting:Ij}]]}}static forChild(e){return{ngModule:n,providers:[aN(e)]}}}return n.\u0275fac=function(e){return new(e||n)(Ve(Nj,8))},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({imports:[XA]}),n})();function nde(n){return"guarded"}function rde(n){return["disabled"===n.initialNavigation?Af(3,[{provide:ly,multi:!0,useFactory:()=>{const t=Hr(Kn);return()=>{t.setUpLocationChangeListener()}}},{provide:cN,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Af(2,[{provide:cN,useValue:0},{provide:ly,multi:!0,deps:[fi],useFactory:t=>{const e=t.get(t8e,Promise.resolve());let r=!1;return()=>e.then(()=>new Promise(i=>{const o=t.get(Kn),c=t.get(Oj);(function s(i){t.get(Kn).events.pipe(Vl(c=>c instanceof x0||c instanceof eE||c instanceof qW),vn(c=>c instanceof x0||c instanceof eE&&(0===c.code||1===c.code)&&null),Vl(c=>null!==c),xp(1)).subscribe(()=>{i()})})(()=>{i(!0),r=!0}),o.afterPreactivation=()=>(i(!0),r||c.closed?Kt(void 0):c),o.initialNavigation()}))}}]).\u0275providers:[]]}const Ij=new Dt("");class xj{}const $l="*";function kj(n,t=null){return{type:2,steps:n,options:t}}function Lj(n){return{type:6,styles:n,offset:null}}function Rj(n){Promise.resolve().then(n)}class Wp{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Rj(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class Dj{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,r=0,s=0;const i=this.players.length;0==i?Rj(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==i&&this._onFinish()}),o.onDestroy(()=>{++r==i&&this._onDestroy()}),o.onStart(()=>{++s==i&&this._onStart()})}),this.totalTime=this.players.reduce((o,c)=>Math.max(o,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(r=>{const s=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(s)})}getPosition(){const t=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}function zj(n){return new Ne(3e3,!1)}function Fde(){return typeof window<"u"&&typeof window.document<"u"}function uN(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function k0(n){switch(n.length){case 0:return new Wp;case 1:return n[0];default:return new Dj(n)}}function Vj(n,t,e,r,s=new Map,i=new Map){const o=[],c=[];let u=-1,h=null;if(r.forEach(g=>{const m=g.get("offset"),E=m==u,b=E&&h||new Map;g.forEach((k,U)=>{let j=U,oe=k;if("offset"!==U)switch(j=t.normalizePropertyName(j,o),oe){case"!":oe=s.get(U);break;case $l:oe=i.get(U);break;default:oe=t.normalizeStyleValue(U,j,oe,o)}b.set(j,oe)}),E||c.push(b),h=b,u=m}),o.length)throw function Ode(n){return new Ne(3502,!1)}();return c}function fN(n,t,e,r){switch(t){case"start":n.onStart(()=>r(e&&hN(e,"start",n)));break;case"done":n.onDone(()=>r(e&&hN(e,"done",n)));break;case"destroy":n.onDestroy(()=>r(e&&hN(e,"destroy",n)))}}function hN(n,t,e){const i=dN(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),o=n._data;return null!=o&&(i._data=o),i}function dN(n,t,e,r,s="",i=0,o){return{element:n,triggerName:t,fromState:e,toState:r,phaseName:s,totalTime:i,disabled:!!o}}function Wa(n,t,e){let r=n.get(t);return r||n.set(t,r=e),r}function Hj(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let pN=(n,t)=>!1,Fj=(n,t,e)=>[],Bj=null;function gN(n){const t=n.parentNode||n.host;return t===Bj?null:t}(uN()||typeof Element<"u")&&(Fde()?(Bj=(()=>document.documentElement)(),pN=(n,t)=>{for(;t;){if(t===n)return!0;t=gN(t)}return!1}):pN=(n,t)=>n.contains(t),Fj=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const r=n.querySelector(t);return r?[r]:[]});let Hu=null,$j=!1;const Uj=pN,Gj=Fj;let qj=(()=>{class n{validateStyleProperty(e){return function $de(n){Hu||(Hu=function Ude(){return typeof document<"u"?document.body:null}()||{},$j=!!Hu.style&&"WebkitAppearance"in Hu.style);let t=!0;return Hu.style&&!function Bde(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in Hu.style,!t&&$j&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Hu.style)),t}(e)}matchesElement(e,r){return!1}containsElement(e,r){return Uj(e,r)}getParentElement(e){return gN(e)}query(e,r,s){return Gj(e,r,s)}computeStyle(e,r,s){return s||""}animate(e,r,s,i,o,c=[],u){return new Wp(s,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),mN=(()=>{class n{}return n.NOOP=new qj,n})();const _N="ng-enter",pE="ng-leave",gE="ng-trigger",mE=".ng-trigger",jj="ng-animating",vN=".ng-animating";function Ul(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:CN(parseFloat(t[1]),t[2])}function CN(n,t){return"s"===t?1e3*n:n}function _E(n,t,e){return n.hasOwnProperty("duration")?n:function Wde(n,t,e){let s,i=0,o="";if("string"==typeof n){const c=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return t.push(zj()),{duration:0,delay:0,easing:""};s=CN(parseFloat(c[1]),c[2]);const u=c[3];null!=u&&(i=CN(parseFloat(u),c[4]));const h=c[5];h&&(o=h)}else s=n;if(!e){let c=!1,u=t.length;s<0&&(t.push(function ode(){return new Ne(3100,!1)}()),c=!0),i<0&&(t.push(function ade(){return new Ne(3101,!1)}()),c=!0),c&&t.splice(u,0,zj())}return{duration:s,delay:i,easing:o}}(n,t,e)}function jp(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function Zj(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function L0(n,t=new Map,e){if(e)for(let[r,s]of e)t.set(r,s);for(let[r,s]of n)t.set(r,s);return t}function Kj(n,t,e){return e?t+":"+e+";":""}function Xj(n){let t="";for(let e=0;e<n.style.length;e++){const r=n.style.item(e);t+=Kj(0,r,n.style.getPropertyValue(r))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=Kj(0,Kde(e),n.style[e]));n.setAttribute("style",t)}function w4(n,t,e){n.style&&(t.forEach((r,s)=>{const i=EN(s);e&&!e.has(s)&&e.set(s,n.style[i]),n.style[i]=r}),uN()&&Xj(n))}function Fu(n,t){n.style&&(t.forEach((e,r)=>{const s=EN(r);n.style[s]=""}),uN()&&Xj(n))}function Zp(n){return Array.isArray(n)?1==n.length?n[0]:kj(n):n}const yN=new RegExp("{{\\s*(.+?)\\s*}}","g");function Qj(n){let t=[];if("string"==typeof n){let e;for(;e=yN.exec(n);)t.push(e[1]);yN.lastIndex=0}return t}function Yp(n,t,e){const r=n.toString(),s=r.replace(yN,(i,o)=>{let c=t[o];return null==c&&(e.push(function lde(n){return new Ne(3003,!1)}()),c=""),c.toString()});return s==r?n:s}function vE(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const Yde=/-+([a-z0-9])/g;function EN(n){return n.replace(Yde,(...t)=>t[1].toUpperCase())}function Kde(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ja(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function ude(n){return new Ne(3004,!1)}()}}function Jj(n,t){return window.getComputedStyle(n)[t]}function n9e(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function r9e(n,t,e){if(":"==n[0]){const u=function s9e(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return t.push(function Pde(n){return new Ne(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof u)return void t.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function Sde(n){return new Ne(3015,!1)}()),t;const s=r[1],i=r[2],o=r[3];t.push(eZ(s,o));"<"==i[0]&&!("*"==s&&"*"==o)&&t.push(eZ(o,s))}(r,e,t)):e.push(n),e}const ME=new Set(["true","1"]),SE=new Set(["false","0"]);function eZ(n,t){const e=ME.has(n)||SE.has(n),r=ME.has(t)||SE.has(t);return(s,i)=>{let o="*"==n||n==s,c="*"==t||t==i;return!o&&e&&"boolean"==typeof s&&(o=s?ME.has(n):SE.has(n)),!c&&r&&"boolean"==typeof i&&(c=i?ME.has(t):SE.has(t)),o&&c}}const i9e=new RegExp("s*:selfs*,?","g");function MN(n,t,e,r){return new o9e(n).build(t,e,r)}class o9e{constructor(t){this._driver=t}build(t,e,r){const s=new l9e(e);return this._resetContextStyleTimingState(s),ja(this,Zp(t),s)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let r=e.queryCount=0,s=e.depCount=0;const i=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push(function hde(){return new Ne(3006,!1)}()),t.definitions.forEach(c=>{if(this._resetContextStyleTimingState(e),0==c.type){const u=c,h=u.name;h.toString().split(/\s*,\s*/).forEach(g=>{u.name=g,i.push(this.visitState(u,e))}),u.name=h}else if(1==c.type){const u=this.visitTransition(c,e);r+=u.queryCount,s+=u.depCount,o.push(u)}else e.errors.push(function dde(){return new Ne(3007,!1)}())}),{type:7,name:t.name,states:i,transitions:o,queryCount:r,depCount:s,options:null}}visitState(t,e){const r=this.visitStyle(t.styles,e),s=t.options&&t.options.params||null;if(r.containsDynamicStyles){const i=new Set,o=s||{};r.styles.forEach(c=>{c instanceof Map&&c.forEach(u=>{Qj(u).forEach(h=>{o.hasOwnProperty(h)||i.add(h)})})}),i.size&&(vE(i.values()),e.errors.push(function pde(n,t){return new Ne(3008,!1)}()))}return{type:0,name:t.name,style:r,options:s?{params:s}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const r=ja(this,Zp(t.animation),e);return{type:1,matchers:n9e(t.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:Bu(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(r=>ja(this,r,e)),options:Bu(t.options)}}visitGroup(t,e){const r=e.currentTime;let s=0;const i=t.steps.map(o=>{e.currentTime=r;const c=ja(this,o,e);return s=Math.max(s,e.currentTime),c});return e.currentTime=s,{type:3,steps:i,options:Bu(t.options)}}visitAnimate(t,e){const r=function f9e(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return SN(_E(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(i=>"{"==i.charAt(0)&&"{"==i.charAt(1))){const i=SN(0,0,"");return i.dynamic=!0,i.strValue=e,i}const s=_E(e,t);return SN(s.duration,s.delay,s.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;let s,i=t.styles?t.styles:Lj({});if(5==i.type)s=this.visitKeyframes(i,e);else{let o=t.styles,c=!1;if(!o){c=!0;const h={};r.easing&&(h.easing=r.easing),o=Lj(h)}e.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,e);u.isEmptyStep=c,s=u}return e.currentAnimateTimings=null,{type:4,timings:r,style:s,options:null}}visitStyle(t,e){const r=this._makeStyleAst(t,e);return this._validateStyleAst(r,e),r}_makeStyleAst(t,e){const r=[],s=Array.isArray(t.styles)?t.styles:[t.styles];for(let c of s)"string"==typeof c?c===$l?r.push(c):e.errors.push(new Ne(3002,!1)):r.push(Zj(c));let i=!1,o=null;return r.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(o=c.get("easing"),c.delete("easing")),!i))for(let u of c.values())if(u.toString().indexOf("{{")>=0){i=!0;break}}),{type:6,styles:r,easing:o,offset:t.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(t,e){const r=e.currentAnimateTimings;let s=e.currentTime,i=e.currentTime;r&&i>0&&(i-=r.duration+r.delay),t.styles.forEach(o=>{"string"!=typeof o&&o.forEach((c,u)=>{const h=e.collectedStyles.get(e.currentQuerySelector),g=h.get(u);let m=!0;g&&(i!=s&&i>=g.startTime&&s<=g.endTime&&(e.errors.push(function mde(n,t,e,r,s){return new Ne(3010,!1)}()),m=!1),i=g.startTime),m&&h.set(u,{startTime:i,endTime:s}),e.options&&function Zde(n,t,e){const r=t.params||{},s=Qj(n);s.length&&s.forEach(i=>{r.hasOwnProperty(i)||e.push(function cde(n){return new Ne(3001,!1)}())})}(c,e.options,e.errors)})})}visitKeyframes(t,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function _de(){return new Ne(3011,!1)}()),r;let i=0;const o=[];let c=!1,u=!1,h=0;const g=t.steps.map(oe=>{const ye=this._makeStyleAst(oe,e);let te=null!=ye.offset?ye.offset:function u9e(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(ye.styles),ke=0;return null!=te&&(i++,ke=ye.offset=te),u=u||ke<0||ke>1,c=c||ke<h,h=ke,o.push(ke),ye});u&&e.errors.push(function vde(){return new Ne(3012,!1)}()),c&&e.errors.push(function Cde(){return new Ne(3200,!1)}());const m=t.steps.length;let E=0;i>0&&i<m?e.errors.push(function yde(){return new Ne(3202,!1)}()):0==i&&(E=1/(m-1));const b=m-1,k=e.currentTime,U=e.currentAnimateTimings,j=U.duration;return g.forEach((oe,ye)=>{const te=E>0?ye==b?1:E*ye:o[ye],ke=te*j;e.currentTime=k+U.delay+ke,U.duration=ke,this._validateStyleAst(oe,e),oe.offset=te,r.styles.push(oe)}),r}visitReference(t,e){return{type:8,animation:ja(this,Zp(t.animation),e),options:Bu(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:Bu(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Bu(t.options)}}visitQuery(t,e){const r=e.currentQuerySelector,s=t.options||{};e.queryCount++,e.currentQuery=t;const[i,o]=function a9e(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(i9e,"")),n=n.replace(/@\*/g,mE).replace(/@\w+/g,e=>mE+"-"+e.slice(1)).replace(/:animating/g,vN),[n,t]}(t.selector);e.currentQuerySelector=r.length?r+" "+i:i,Wa(e.collectedStyles,e.currentQuerySelector,new Map);const c=ja(this,Zp(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:i,limit:s.limit||0,optional:!!s.optional,includeSelf:o,animation:c,originalSelector:t.selector,options:Bu(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function Ede(){return new Ne(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:_E(t.timings,e.errors,!0);return{type:12,animation:ja(this,Zp(t.animation),e),timings:r,options:null}}}class l9e{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Bu(n){return n?(n=jp(n)).params&&(n.params=function c9e(n){return n?jp(n):null}(n.params)):n={},n}function SN(n,t,e){return{duration:n,delay:t,easing:e}}function PN(n,t,e,r,s,i,o=null,c=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:r,duration:s,delay:i,totalTime:s+i,easing:o,subTimeline:c}}class PE{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const p9e=new RegExp(":enter","g"),m9e=new RegExp(":leave","g");function TN(n,t,e,r,s,i=new Map,o=new Map,c,u,h=[]){return(new _9e).buildKeyframes(n,t,e,r,s,i,o,c,u,h)}class _9e{buildKeyframes(t,e,r,s,i,o,c,u,h,g=[]){h=h||new PE;const m=new wN(t,e,h,s,i,g,[]);m.options=u;const E=u.delay?Ul(u.delay):0;m.currentTimeline.delayNextStep(E),m.currentTimeline.setStyles([o],null,m.errors,u),ja(this,r,m);const b=m.timelines.filter(k=>k.containsAnimation());if(b.length&&c.size){let k;for(let U=b.length-1;U>=0;U--){const j=b[U];if(j.element===e){k=j;break}}k&&!k.allowOnlyTimelineStyles()&&k.setStyles([c],null,m.errors,u)}return b.length?b.map(k=>k.buildKeyframes()):[PN(e,[],[],[],0,E,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const r=e.subInstructions.get(e.element);if(r){const s=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(r,s,s.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const r=e.createSubContext(t.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,r),this.visitReference(t.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,r){for(const s of t){const i=s?.delay;if(i){const o="number"==typeof i?i:Ul(Yp(i,s?.params??{},e.errors));r.delayNextStep(o)}}}_visitSubInstructions(t,e,r){let i=e.currentTimeline.currentTime;const o=null!=r.duration?Ul(r.duration):null,c=null!=r.delay?Ul(r.delay):null;return 0!==o&&t.forEach(u=>{const h=e.appendInstructionToTimeline(u,o,c);i=Math.max(i,h.duration+h.delay)}),i}visitReference(t,e){e.updateOptions(t.options,!0),ja(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const r=e.subContextCount;let s=e;const i=t.options;if(i&&(i.params||i.delay)&&(s=e.createSubContext(i),s.transformIntoNewTimeline(),null!=i.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=TE);const o=Ul(i.delay);s.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>ja(this,o,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>r&&s.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const r=[];let s=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?Ul(t.options.delay):0;t.steps.forEach(o=>{const c=e.createSubContext(t.options);i&&c.delayNextStep(i),ja(this,o,c),s=Math.max(s,c.currentTimeline.currentTime),r.push(c.currentTimeline)}),r.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(s),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const r=t.strValue;return _E(e.params?Yp(r,e.params,e.errors):r,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const r=e.currentAnimateTimings=this._visitTiming(t.timings,e),s=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),s.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(r.duration),this.visitStyle(i,e),s.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const r=e.currentTimeline,s=e.currentAnimateTimings;!s&&r.hasCurrentStyleProperties()&&r.forwardFrame();const i=s&&s.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(i):r.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const r=e.currentAnimateTimings,s=e.currentTimeline.duration,i=r.duration,c=e.createSubContext().currentTimeline;c.easing=r.easing,t.styles.forEach(u=>{c.forwardTime((u.offset||0)*i),c.setStyles(u.styles,u.easing,e.errors,e.options),c.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(c),e.transformIntoNewTimeline(s+i),e.previousNode=t}visitQuery(t,e){const r=e.currentTimeline.currentTime,s=t.options||{},i=s.delay?Ul(s.delay):0;i&&(6===e.previousNode.type||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=TE);let o=r;const c=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!s.optional,e.errors);e.currentQueryTotal=c.length;let u=null;c.forEach((h,g)=>{e.currentQueryIndex=g;const m=e.createSubContext(t.options,h);i&&m.delayNextStep(i),h===e.element&&(u=m.currentTimeline),ja(this,t.animation,m),m.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,m.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),u&&(e.currentTimeline.mergeTimelineCollectedStyles(u),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const r=e.parentContext,s=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),c=o*(e.currentQueryTotal-1);let u=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":u=c-u;break;case"full":u=r.currentStaggerTime}const g=e.currentTimeline;u&&g.delayNextStep(u);const m=g.currentTime;ja(this,t.animation,e),e.previousNode=t,r.currentStaggerTime=s.currentTime-m+(s.startTime-r.currentTimeline.startTime)}}const TE={};class wN{constructor(t,e,r,s,i,o,c,u){this._driver=t,this.element=e,this.subInstructions=r,this._enterClassName=s,this._leaveClassName=i,this.errors=o,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=TE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new wE(this._driver,e,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const r=t;let s=this.options;null!=r.duration&&(s.duration=Ul(r.duration)),null!=r.delay&&(s.delay=Ul(r.delay));const i=r.params;if(i){let o=s.params;o||(o=this.options.params={}),Object.keys(i).forEach(c=>{(!e||!o.hasOwnProperty(c))&&(o[c]=Yp(i[c],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const r=t.params={};Object.keys(e).forEach(s=>{r[s]=e[s]})}}return t}createSubContext(t=null,e,r){const s=e||this.element,i=new wN(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,r||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=TE,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,r){const s={duration:e??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},i=new v9e(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,s,t.stretchStartingKeyframe);return this.timelines.push(i),s}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,r,s,i,o){let c=[];if(s&&c.push(this.element),t.length>0){t=(t=t.replace(p9e,"."+this._enterClassName)).replace(m9e,"."+this._leaveClassName);let h=this._driver.query(this.element,t,1!=r);0!==r&&(h=r<0?h.slice(h.length+r,h.length):h.slice(0,r)),c.push(...h)}return!i&&0==c.length&&o.push(function Mde(n){return new Ne(3014,!1)}()),c}}class wE{constructor(t,e,r,s){this._driver=t,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new wE(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||$l),this._currentKeyframe.set(e,$l);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,r,s){e&&this._previousKeyframe.set("easing",e);const i=s&&s.params||{},o=function C9e(n,t){const e=new Map;let r;return n.forEach(s=>{if("*"===s){r=r||t.keys();for(let i of r)e.set(i,$l)}else L0(s,e)}),e}(t,this._globalTimelineStyles);for(let[c,u]of o){const h=Yp(u,i,r);this._pendingStyles.set(c,h),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??$l),this._updateStyle(c,h)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,r)=>{const s=this._styleSummary.get(r);(!s||e.time>s.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((c,u)=>{const h=L0(c,new Map,this._backFill);h.forEach((g,m)=>{"!"===g?t.add(m):g===$l&&e.add(m)}),r||h.set("offset",u/this.duration),s.push(h)});const i=t.size?vE(t.values()):[],o=e.size?vE(e.values()):[];if(r){const c=s[0],u=new Map(c);c.set("offset",0),u.set("offset",1),s=[c,u]}return PN(this.element,s,i,o,this.duration,this.startTime,this.easing,!1)}}class v9e extends wE{constructor(t,e,r,s,i,o,c=!1){super(t,e,o.delay),this.keyframes=r,this.preStyleProps=s,this.postStyleProps=i,this._stretchStartingKeyframe=c,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:r,easing:s}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],o=r+e,c=e/o,u=L0(t[0]);u.set("offset",0),i.push(u);const h=L0(t[0]);h.set("offset",rZ(c)),i.push(h);const g=t.length-1;for(let m=1;m<=g;m++){let E=L0(t[m]);const b=E.get("offset");E.set("offset",rZ((e+b*r)/o)),i.push(E)}r=o,e=0,s="",t=i}return PN(this.element,t,this.preStyleProps,this.postStyleProps,r,e,s,!0)}}function rZ(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class bN{}const y9e=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class E9e extends bN{normalizePropertyName(t,e){return EN(t)}normalizeStyleValue(t,e,r,s){let i="";const o=r.toString().trim();if(y9e.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)i="px";else{const c=r.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&s.push(function fde(n,t){return new Ne(3005,!1)}())}return o+i}}function sZ(n,t,e,r,s,i,o,c,u,h,g,m,E){return{type:0,element:n,triggerName:t,isRemovalTransition:s,fromState:e,fromStyles:i,toState:r,toStyles:o,timelines:c,queriedElements:u,preStyleProps:h,postStyleProps:g,totalTime:m,errors:E}}const ON={};class iZ{constructor(t,e,r){this._triggerName=t,this.ast=e,this._stateStyles=r}match(t,e,r,s){return function M9e(n,t,e,r,s){return n.some(i=>i(t,e,r,s))}(this.ast.matchers,t,e,r,s)}buildStyles(t,e,r){let s=this._stateStyles.get("*");return void 0!==t&&(s=this._stateStyles.get(t?.toString())||s),s?s.buildStyles(e,r):new Map}build(t,e,r,s,i,o,c,u,h,g){const m=[],E=this.ast.options&&this.ast.options.params||ON,k=this.buildStyles(r,c&&c.params||ON,m),U=u&&u.params||ON,j=this.buildStyles(s,U,m),oe=new Set,ye=new Map,te=new Map,ke="void"===s,Ge={params:S9e(U,E),delay:this.ast.options?.delay},Xe=g?[]:TN(t,e,this.ast.animation,i,o,k,j,Ge,h,m);let Bt=0;if(Xe.forEach(N1=>{Bt=Math.max(N1.duration+N1.delay,Bt)}),m.length)return sZ(e,this._triggerName,r,s,ke,k,j,[],[],ye,te,Bt,m);Xe.forEach(N1=>{const bn=N1.element,S6=Wa(ye,bn,new Set);N1.preStyleProps.forEach(Aa=>S6.add(Aa));const Qc=Wa(te,bn,new Set);N1.postStyleProps.forEach(Aa=>Qc.add(Aa)),bn!==e&&oe.add(bn)});const V1=vE(oe.values());return sZ(e,this._triggerName,r,s,ke,k,j,Xe,V1,ye,te,Bt)}}function S9e(n,t){const e=jp(t);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(e[r]=n[r]);return e}class P9e{constructor(t,e,r){this.styles=t,this.defaultParams=e,this.normalizer=r}buildStyles(t,e){const r=new Map,s=jp(this.defaultParams);return Object.keys(t).forEach(i=>{const o=t[i];null!==o&&(s[i]=o)}),this.styles.styles.forEach(i=>{"string"!=typeof i&&i.forEach((o,c)=>{o&&(o=Yp(o,s,e));const u=this.normalizer.normalizePropertyName(c,e);o=this.normalizer.normalizeStyleValue(c,u,o,e),r.set(u,o)})}),r}}class w9e{constructor(t,e,r){this.name=t,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(s=>{this.states.set(s.name,new P9e(s.style,s.options&&s.options.params||{},r))}),oZ(this.states,"true","1"),oZ(this.states,"false","0"),e.transitions.forEach(s=>{this.transitionFactories.push(new iZ(t,s,this.states))}),this.fallbackTransition=function b9e(n,t,e){return new iZ(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,c)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,r,s){return this.transitionFactories.find(o=>o.match(t,e,r,s))||null}matchStyles(t,e,r){return this.fallbackTransition.buildStyles(t,e,r)}}function oZ(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const O9e=new PE;class A9e{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const r=[],i=MN(this._driver,e,r,[]);if(r.length)throw function Ade(n){return new Ne(3503,!1)}();this._animations.set(t,i)}_buildPlayer(t,e,r){const s=t.element,i=Vj(0,this._normalizer,0,t.keyframes,e,r);return this._driver.animate(s,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,r={}){const s=[],i=this._animations.get(t);let o;const c=new Map;if(i?(o=TN(this._driver,e,i,_N,pE,new Map,new Map,r,O9e,s),o.forEach(g=>{const m=Wa(c,g.element,new Map);g.postStyleProps.forEach(E=>m.set(E,null))})):(s.push(function Nde(){return new Ne(3300,!1)}()),o=[]),s.length)throw function Ide(n){return new Ne(3504,!1)}();c.forEach((g,m)=>{g.forEach((E,b)=>{g.set(b,this._driver.computeStyle(m,b,$l))})});const h=k0(o.map(g=>{const m=c.get(g.element);return this._buildPlayer(g,new Map,m)}));return this._playersById.set(t,h),h.onDestroy(()=>this.destroy(t)),this.players.push(h),h}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function xde(n){return new Ne(3301,!1)}();return e}listen(t,e,r,s){const i=dN(e,"","","");return fN(this._getPlayer(t),r,i,s),()=>{}}command(t,e,r,s){if("register"==r)return void this.register(t,s[0]);if("create"==r)return void this.create(t,e,s[0]||{});const i=this._getPlayer(t);switch(r){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(t)}}}const aZ="ng-animate-queued",AN="ng-animate-disabled",L9e=[],cZ={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},R9e={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},xc="__ng_removed";class NN{constructor(t,e=""){this.namespaceId=e;const r=t&&t.hasOwnProperty("value");if(this.value=function H9e(n){return n??null}(r?t.value:t),r){const i=jp(t);delete i.value,this.options=i}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const r=this.options.params;Object.keys(e).forEach(s=>{null==r[s]&&(r[s]=e[s])})}}}const Kp="void",IN=new NN(Kp);class D9e{constructor(t,e,r){this.id=t,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,kc(e,this._hostClassName)}listen(t,e,r,s){if(!this._triggers.has(e))throw function kde(n,t){return new Ne(3302,!1)}();if(null==r||0==r.length)throw function Lde(n){return new Ne(3303,!1)}();if(!function F9e(n){return"start"==n||"done"==n}(r))throw function Rde(n,t){return new Ne(3400,!1)}();const i=Wa(this._elementListeners,t,[]),o={name:e,phase:r,callback:s};i.push(o);const c=Wa(this._engine.statesByElement,t,new Map);return c.has(e)||(kc(t,gE),kc(t,gE+"-"+e),c.set(e,IN)),()=>{this._engine.afterFlush(()=>{const u=i.indexOf(o);u>=0&&i.splice(u,1),this._triggers.has(e)||c.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function Dde(n){return new Ne(3401,!1)}();return e}trigger(t,e,r,s=!0){const i=this._getTrigger(e),o=new xN(this.id,e,t);let c=this._engine.statesByElement.get(t);c||(kc(t,gE),kc(t,gE+"-"+e),this._engine.statesByElement.set(t,c=new Map));let u=c.get(e);const h=new NN(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&h.absorbOptions(u.options),c.set(e,h),u||(u=IN),h.value!==Kp&&u.value===h.value){if(!function U9e(n,t){const e=Object.keys(n),r=Object.keys(t);if(e.length!=r.length)return!1;for(let s=0;s<e.length;s++){const i=e[s];if(!t.hasOwnProperty(i)||n[i]!==t[i])return!1}return!0}(u.params,h.params)){const U=[],j=i.matchStyles(u.value,u.params,U),oe=i.matchStyles(h.value,h.params,U);U.length?this._engine.reportError(U):this._engine.afterFlush(()=>{Fu(t,j),w4(t,oe)})}return}const E=Wa(this._engine.playersByElement,t,[]);E.forEach(U=>{U.namespaceId==this.id&&U.triggerName==e&&U.queued&&U.destroy()});let b=i.matchTransition(u.value,h.value,t,h.params),k=!1;if(!b){if(!s)return;b=i.fallbackTransition,k=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:b,fromState:u,toState:h,player:o,isFallbackTransition:k}),k||(kc(t,aZ),o.onStart(()=>{Nf(t,aZ)})),o.onDone(()=>{let U=this.players.indexOf(o);U>=0&&this.players.splice(U,1);const j=this._engine.playersByElement.get(t);if(j){let oe=j.indexOf(o);oe>=0&&j.splice(oe,1)}}),this.players.push(o),E.push(o),o}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(s=>s.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const r=this._engine.driver.query(t,mE,!0);r.forEach(s=>{if(s[xc])return;const i=this._engine.fetchNamespacesByElement(s);i.size?i.forEach(o=>o.triggerLeaveAnimation(s,e,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(t,e,r,s){const i=this._engine.statesByElement.get(t),o=new Map;if(i){const c=[];if(i.forEach((u,h)=>{if(o.set(h,u.value),this._triggers.has(h)){const g=this.trigger(t,h,Kp,s);g&&c.push(g)}}),c.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),r&&k0(c).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(e&&r){const s=new Set;e.forEach(i=>{const o=i.name;if(s.has(o))return;s.add(o);const u=this._triggers.get(o).fallbackTransition,h=r.get(o)||IN,g=new NN(Kp),m=new xN(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:u,fromState:h,toState:g,player:m,isFallbackTransition:!0})})}}removeNode(t,e){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let s=!1;if(r.totalAnimations){const i=r.players.length?r.playersByQueriedElement.get(t):[];if(i&&i.length)s=!0;else{let o=t;for(;o=o.parentNode;)if(r.statesByElement.get(o)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(t),s)r.markElementAsRemoved(this.id,t,!1,e);else{const i=t[xc];(!i||i===cZ)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}insertNode(t,e){kc(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(r=>{const s=r.player;if(s.destroyed)return;const i=r.element,o=this._elementListeners.get(i);o&&o.forEach(c=>{if(c.name==r.triggerName){const u=dN(i,r.triggerName,r.fromState.value,r.toState.value);u._data=t,fN(r.player,c.phase,u,c.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):e.push(r)}),this._queue=[],e.sort((r,s)=>{const i=r.transition.ast.depCount,o=s.transition.ast.depCount;return 0==i||0==o?i-o:this._engine.driver.containsElement(r.element,s.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(r=>r.element===t)||e,e}}class z9e{constructor(t,e,r){this.bodyNode=t,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,i)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,e){const r=new D9e(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,e){const r=this._namespaceList,s=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,c=this.driver.getParentElement(e);for(;c;){const u=s.get(c);if(u){const h=r.indexOf(u);r.splice(h+1,0,t),o=!0;break}c=this.driver.getParentElement(c)}o||r.unshift(t)}else r.push(t);return s.set(e,t),t}register(t,e){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,e)),r}registerTrigger(t,e,r){let s=this._namespaceLookup[t];s&&s.register(e,r)&&this.totalAnimations++}destroy(t,e){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const s=this._namespaceList.indexOf(r);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,r=this.statesByElement.get(t);if(r)for(let s of r.values())if(s.namespaceId){const i=this._fetchNamespace(s.namespaceId);i&&e.add(i)}return e}trigger(t,e,r,s){if(bE(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,r,s),!0}return!1}insertNode(t,e,r,s){if(!bE(e))return;const i=e[xc];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(e,r)}s&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),kc(t,AN)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Nf(t,AN))}removeNode(t,e,r,s){if(bE(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,s):this.markElementAsRemoved(t,e,!1,s),r){const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,s)}}else this._onRemovalComplete(e,s)}markElementAsRemoved(t,e,r,s,i){this.collectedLeaveElements.push(e),e[xc]={namespaceId:t,setForRemoval:s,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:i}}listen(t,e,r,s,i){return bE(e)?this._fetchNamespace(t).listen(e,r,s,i):()=>{}}_buildInstruction(t,e,r,s,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,s,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,mE,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,vN,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return k0(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[xc];if(e&&e.setForRemoval){if(t[xc]=cZ,e.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(AN)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,s)=>this._balanceNamespaceList(r,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)kc(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,t)}finally{for(let s=0;s<r.length;s++)r[s]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?k0(e).onDone(()=>{r.forEach(s=>s())}):r.forEach(s=>s())}}reportError(t){throw function zde(n){return new Ne(3402,!1)}()}_flushAnimations(t,e){const r=new PE,s=[],i=new Map,o=[],c=new Map,u=new Map,h=new Map,g=new Set;this.disabledNodes.forEach(Mt=>{g.add(Mt);const Wt=this.driver.query(Mt,".ng-animate-queued",!0);for(let en=0;en<Wt.length;en++)g.add(Wt[en])});const m=this.bodyNode,E=Array.from(this.statesByElement.keys()),b=fZ(E,this.collectedEnterElements),k=new Map;let U=0;b.forEach((Mt,Wt)=>{const en=_N+U++;k.set(Wt,en),Mt.forEach(s1=>kc(s1,en))});const j=[],oe=new Set,ye=new Set;for(let Mt=0;Mt<this.collectedLeaveElements.length;Mt++){const Wt=this.collectedLeaveElements[Mt],en=Wt[xc];en&&en.setForRemoval&&(j.push(Wt),oe.add(Wt),en.hasAnimation?this.driver.query(Wt,".ng-star-inserted",!0).forEach(s1=>oe.add(s1)):ye.add(Wt))}const te=new Map,ke=fZ(E,Array.from(oe));ke.forEach((Mt,Wt)=>{const en=pE+U++;te.set(Wt,en),Mt.forEach(s1=>kc(s1,en))}),t.push(()=>{b.forEach((Mt,Wt)=>{const en=k.get(Wt);Mt.forEach(s1=>Nf(s1,en))}),ke.forEach((Mt,Wt)=>{const en=te.get(Wt);Mt.forEach(s1=>Nf(s1,en))}),j.forEach(Mt=>{this.processLeaveNode(Mt)})});const Ge=[],Xe=[];for(let Mt=this._namespaceList.length-1;Mt>=0;Mt--)this._namespaceList[Mt].drainQueuedTransitions(e).forEach(en=>{const s1=en.player,Zt=en.element;if(Ge.push(s1),this.collectedEnterElements.length){const po=Zt[xc];if(po&&po.setForMove){if(po.previousTriggersValues&&po.previousTriggersValues.has(en.triggerName)){const H5=po.previousTriggersValues.get(en.triggerName),Jc=this.statesByElement.get(en.element);if(Jc&&Jc.has(en.triggerName)){const nT=Jc.get(en.triggerName);nT.value=H5,Jc.set(en.triggerName,nT)}}return void s1.destroy()}}const el=!m||!this.driver.containsElement(m,Zt),pc=te.get(Zt),S8=k.get(Zt),is=this._buildInstruction(en,r,S8,pc,el);if(is.errors&&is.errors.length)return void Xe.push(is);if(el)return s1.onStart(()=>Fu(Zt,is.fromStyles)),s1.onDestroy(()=>w4(Zt,is.toStyles)),void s.push(s1);if(en.isFallbackTransition)return s1.onStart(()=>Fu(Zt,is.fromStyles)),s1.onDestroy(()=>w4(Zt,is.toStyles)),void s.push(s1);const m4e=[];is.timelines.forEach(po=>{po.stretchStartingKeyframe=!0,this.disabledNodes.has(po.element)||m4e.push(po)}),is.timelines=m4e,r.append(Zt,is.timelines),o.push({instruction:is,player:s1,element:Zt}),is.queriedElements.forEach(po=>Wa(c,po,[]).push(s1)),is.preStyleProps.forEach((po,H5)=>{if(po.size){let Jc=u.get(H5);Jc||u.set(H5,Jc=new Set),po.forEach((nT,sF)=>Jc.add(sF))}}),is.postStyleProps.forEach((po,H5)=>{let Jc=h.get(H5);Jc||h.set(H5,Jc=new Set),po.forEach((nT,sF)=>Jc.add(sF))})});if(Xe.length){const Mt=[];Xe.forEach(Wt=>{Mt.push(function Vde(n,t){return new Ne(3505,!1)}())}),Ge.forEach(Wt=>Wt.destroy()),this.reportError(Mt)}const Bt=new Map,V1=new Map;o.forEach(Mt=>{const Wt=Mt.element;r.has(Wt)&&(V1.set(Wt,Wt),this._beforeAnimationBuild(Mt.player.namespaceId,Mt.instruction,Bt))}),s.forEach(Mt=>{const Wt=Mt.element;this._getPreviousPlayers(Wt,!1,Mt.namespaceId,Mt.triggerName,null).forEach(s1=>{Wa(Bt,Wt,[]).push(s1),s1.destroy()})});const N1=j.filter(Mt=>dZ(Mt,u,h)),bn=new Map;uZ(bn,this.driver,ye,h,$l).forEach(Mt=>{dZ(Mt,u,h)&&N1.push(Mt)});const Qc=new Map;b.forEach((Mt,Wt)=>{uZ(Qc,this.driver,new Set(Mt),u,"!")}),N1.forEach(Mt=>{const Wt=bn.get(Mt),en=Qc.get(Mt);bn.set(Mt,new Map([...Array.from(Wt?.entries()??[]),...Array.from(en?.entries()??[])]))});const Aa=[],P6=[],T6={};o.forEach(Mt=>{const{element:Wt,player:en,instruction:s1}=Mt;if(r.has(Wt)){if(g.has(Wt))return en.onDestroy(()=>w4(Wt,s1.toStyles)),en.disabled=!0,en.overrideTotalTime(s1.totalTime),void s.push(en);let Zt=T6;if(V1.size>1){let pc=Wt;const S8=[];for(;pc=pc.parentNode;){const is=V1.get(pc);if(is){Zt=is;break}S8.push(pc)}S8.forEach(is=>V1.set(is,Zt))}const el=this._buildAnimation(en.namespaceId,s1,Bt,i,Qc,bn);if(en.setRealPlayer(el),Zt===T6)Aa.push(en);else{const pc=this.playersByElement.get(Zt);pc&&pc.length&&(en.parentPlayer=k0(pc)),s.push(en)}}else Fu(Wt,s1.fromStyles),en.onDestroy(()=>w4(Wt,s1.toStyles)),P6.push(en),g.has(Wt)&&s.push(en)}),P6.forEach(Mt=>{const Wt=i.get(Mt.element);if(Wt&&Wt.length){const en=k0(Wt);Mt.setRealPlayer(en)}}),s.forEach(Mt=>{Mt.parentPlayer?Mt.syncPlayerEvents(Mt.parentPlayer):Mt.destroy()});for(let Mt=0;Mt<j.length;Mt++){const Wt=j[Mt],en=Wt[xc];if(Nf(Wt,pE),en&&en.hasAnimation)continue;let s1=[];if(c.size){let el=c.get(Wt);el&&el.length&&s1.push(...el);let pc=this.driver.query(Wt,vN,!0);for(let S8=0;S8<pc.length;S8++){let is=c.get(pc[S8]);is&&is.length&&s1.push(...is)}}const Zt=s1.filter(el=>!el.destroyed);Zt.length?B9e(this,Wt,Zt):this.processLeaveNode(Wt)}return j.length=0,Aa.forEach(Mt=>{this.players.push(Mt),Mt.onDone(()=>{Mt.destroy();const Wt=this.players.indexOf(Mt);this.players.splice(Wt,1)}),Mt.play()}),Aa}elementContainsData(t,e){let r=!1;const s=e[xc];return s&&s.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(t).elementContainsData(e)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,r,s,i){let o=[];if(e){const c=this.playersByQueriedElement.get(t);c&&(o=c)}else{const c=this.playersByElement.get(t);if(c){const u=!i||i==Kp;c.forEach(h=>{h.queued||!u&&h.triggerName!=s||o.push(h)})}}return(r||s)&&(o=o.filter(c=>!(r&&r!=c.namespaceId||s&&s!=c.triggerName))),o}_beforeAnimationBuild(t,e,r){const i=e.element,o=e.isRemovalTransition?void 0:t,c=e.isRemovalTransition?void 0:e.triggerName;for(const u of e.timelines){const h=u.element,g=h!==i,m=Wa(r,h,[]);this._getPreviousPlayers(h,g,o,c,e.toState).forEach(b=>{const k=b.getRealPlayer();k.beforeDestroy&&k.beforeDestroy(),b.destroy(),m.push(b)})}Fu(i,e.fromStyles)}_buildAnimation(t,e,r,s,i,o){const c=e.triggerName,u=e.element,h=[],g=new Set,m=new Set,E=e.timelines.map(k=>{const U=k.element;g.add(U);const j=U[xc];if(j&&j.removedBeforeQueried)return new Wp(k.duration,k.delay);const oe=U!==u,ye=function $9e(n){const t=[];return hZ(n,t),t}((r.get(U)||L9e).map(Bt=>Bt.getRealPlayer())).filter(Bt=>!!Bt.element&&Bt.element===U),te=i.get(U),ke=o.get(U),Ge=Vj(0,this._normalizer,0,k.keyframes,te,ke),Xe=this._buildPlayer(k,Ge,ye);if(k.subTimeline&&s&&m.add(U),oe){const Bt=new xN(t,c,U);Bt.setRealPlayer(Xe),h.push(Bt)}return Xe});h.forEach(k=>{Wa(this.playersByQueriedElement,k.element,[]).push(k),k.onDone(()=>function V9e(n,t,e){let r=n.get(t);if(r){if(r.length){const s=r.indexOf(e);r.splice(s,1)}0==r.length&&n.delete(t)}return r}(this.playersByQueriedElement,k.element,k))}),g.forEach(k=>kc(k,jj));const b=k0(E);return b.onDestroy(()=>{g.forEach(k=>Nf(k,jj)),w4(u,e.toStyles)}),m.forEach(k=>{Wa(s,k,[]).push(b)}),b}_buildPlayer(t,e,r){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,r):new Wp(t.duration,t.delay)}}class xN{constructor(t,e,r){this.namespaceId=t,this.triggerName=e,this.element=r,this._player=new Wp,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,r)=>{e.forEach(s=>fN(t,r,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Wa(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function bE(n){return n&&1===n.nodeType}function lZ(n,t){const e=n.style.display;return n.style.display=t??"none",e}function uZ(n,t,e,r,s){const i=[];e.forEach(u=>i.push(lZ(u)));const o=[];r.forEach((u,h)=>{const g=new Map;u.forEach(m=>{const E=t.computeStyle(h,m,s);g.set(m,E),(!E||0==E.length)&&(h[xc]=R9e,o.push(h))}),n.set(h,g)});let c=0;return e.forEach(u=>lZ(u,i[c++])),o}function fZ(n,t){const e=new Map;if(n.forEach(c=>e.set(c,[])),0==t.length)return e;const s=new Set(t),i=new Map;function o(c){if(!c)return 1;let u=i.get(c);if(u)return u;const h=c.parentNode;return u=e.has(h)?h:s.has(h)?1:o(h),i.set(c,u),u}return t.forEach(c=>{const u=o(c);1!==u&&e.get(u).push(c)}),e}function kc(n,t){n.classList?.add(t)}function Nf(n,t){n.classList?.remove(t)}function B9e(n,t,e){k0(e).onDone(()=>n.processLeaveNode(t))}function hZ(n,t){for(let e=0;e<n.length;e++){const r=n[e];r instanceof Dj?hZ(r.players,t):t.push(r)}}function dZ(n,t,e){const r=e.get(n);if(!r)return!1;let s=t.get(n);return s?r.forEach(i=>s.add(i)):t.set(n,r),e.delete(n),!0}class OE{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(s,i)=>{},this._transitionEngine=new z9e(t,e,r),this._timelineEngine=new A9e(t,e,r),this._transitionEngine.onRemovalComplete=(s,i)=>this.onRemovalComplete(s,i)}registerTrigger(t,e,r,s,i){const o=t+"-"+s;let c=this._triggerCache[o];if(!c){const u=[],g=MN(this._driver,i,u,[]);if(u.length)throw function bde(n,t){return new Ne(3404,!1)}();c=function T9e(n,t,e){return new w9e(n,t,e)}(s,g,this._normalizer),this._triggerCache[o]=c}this._transitionEngine.registerTrigger(e,s,c)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,r,s){this._transitionEngine.insertNode(t,e,r,s)}onRemove(t,e,r,s){this._transitionEngine.removeNode(t,e,s||!1,r)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,r,s){if("@"==r.charAt(0)){const[i,o]=Hj(r);this._timelineEngine.command(i,e,o,s)}else this._transitionEngine.trigger(t,e,r,s)}listen(t,e,r,s,i){if("@"==r.charAt(0)){const[o,c]=Hj(r);return this._timelineEngine.listen(o,e,c,i)}return this._transitionEngine.listen(t,e,r,s,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let q9e=(()=>{class n{constructor(e,r,s){this._element=e,this._startStyles=r,this._endStyles=s,this._state=0;let i=n.initialStylesByElement.get(e);i||n.initialStylesByElement.set(e,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&w4(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(w4(this._element,this._initialStyles),this._endStyles&&(w4(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Fu(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Fu(this._element,this._endStyles),this._endStyles=null),w4(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function kN(n){let t=null;return n.forEach((e,r)=>{(function W9e(n){return"display"===n||"position"===n})(r)&&(t=t||new Map,t.set(r,e))}),t}class pZ{constructor(t,e,r,s){this.element=t,this.keyframes=e,this.options=r,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(t,e,r){return t.animate(this._convertKeyframesToObject(e),r)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,s)=>{"offset"!==s&&t.set(s,this._finished?r:Jj(this.element,s))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class j9e{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return Uj(t,e)}getParentElement(t){return gN(t)}query(t,e,r){return Gj(t,e,r)}computeStyle(t,e,r){return window.getComputedStyle(t)[e]}animate(t,e,r,s,i,o=[]){const u={duration:r,delay:s,fill:0==s?"both":"forwards"};i&&(u.easing=i);const h=new Map,g=o.filter(b=>b instanceof pZ);(function Xde(n,t){return 0===n||0===t})(r,s)&&g.forEach(b=>{b.currentSnapshot.forEach((k,U)=>h.set(U,k))});let m=function jde(n){return n.length?n[0]instanceof Map?n:n.map(t=>Zj(t)):[]}(e).map(b=>L0(b));m=function Qde(n,t,e){if(e.size&&t.length){let r=t[0],s=[];if(e.forEach((i,o)=>{r.has(o)||s.push(o),r.set(o,i)}),s.length)for(let i=1;i<t.length;i++){let o=t[i];s.forEach(c=>o.set(c,Jj(n,c)))}}return t}(t,m,h);const E=function G9e(n,t){let e=null,r=null;return Array.isArray(t)&&t.length?(e=kN(t[0]),t.length>1&&(r=kN(t[t.length-1]))):t instanceof Map&&(e=kN(t)),e||r?new q9e(n,e,r):null}(t,m);return new pZ(t,m,u,E)}}let Z9e=(()=>{class n extends xj{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:F1.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(e)?kj(e):e;return gZ(this._renderer,null,r,"register",[s]),new Y9e(r,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(Ve(l0),Ve($s))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();class Y9e extends class ide{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new K9e(this._id,t,e||{},this._renderer)}}class K9e{constructor(t,e,r,s){this.id=t,this.element=e,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return gZ(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function gZ(n,t,e,r,s){return n.setProperty(t,`@@${e}:${r}`,s)}const mZ="@.disabled";let X9e=(()=>{class n{constructor(e,r,s){this.delegate=e,this.engine=r,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(i,o)=>{const c=o?.parentNode(i);c&&o.removeChild(c,i)}}createRenderer(e,r){const i=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let g=this._rendererCache.get(i);return g||(g=new _Z("",i,this.engine,()=>this._rendererCache.delete(i)),this._rendererCache.set(i,g)),g}const o=r.id,c=r.id+"-"+this._currentId;this._currentId++,this.engine.register(c,e);const u=g=>{Array.isArray(g)?g.forEach(u):this.engine.registerTrigger(o,c,e,g.name,g)};return r.data.animation.forEach(u),new Q9e(this,c,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,s){e>=0&&e<this._microtaskId?this._zone.run(()=>r(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(i=>{const[o,c]=i;o(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(Ve(l0),Ve(OE),Ve(Pr))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();class _Z{constructor(t,e,r,s){this.namespaceId=t,this.delegate=e,this.engine=r,this._onDestroy=s,this.destroyNode=this.delegate.destroyNode?i=>e.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,r,s=!0){this.delegate.insertBefore(t,e,r),this.engine.onInsert(this.namespaceId,e,t,s)}removeChild(t,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,s){this.delegate.setAttribute(t,e,r,s)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,s){this.delegate.setStyle(t,e,r,s)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){"@"==e.charAt(0)&&e==mZ?this.disableAnimations(t,!!r):this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.delegate.listen(t,e,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class Q9e extends _Z{constructor(t,e,r,s,i){super(e,r,s,i),this.factory=t,this.namespaceId=e}setProperty(t,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==mZ?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,e.slice(1),r):this.delegate.setProperty(t,e,r)}listen(t,e,r){if("@"==e.charAt(0)){const s=function J9e(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let i=e.slice(1),o="";return"@"!=i.charAt(0)&&([i,o]=function epe(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(i)),this.engine.listen(this.namespaceId,s,i,o,c=>{this.factory.scheduleListenerCallback(c._data||-1,r,c)})}return this.delegate.listen(t,e,r)}}let tpe=(()=>{class n extends OE{constructor(e,r,s,i){super(e.body,r,s)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(Ve($s),Ve(mN),Ve(bN),Ve(pp))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const vZ=[{provide:xj,useClass:Z9e},{provide:bN,useFactory:function npe(){return new E9e}},{provide:OE,useClass:tpe},{provide:l0,useFactory:function rpe(n,t,e){return new X9e(n,t,e)},deps:[Iy,OE,Pr]}],LN=[{provide:mN,useFactory:()=>new j9e},{provide:kU,useValue:"BrowserAnimations"},...vZ],CZ=[{provide:mN,useClass:qj},{provide:kU,useValue:"NoopAnimations"},...vZ];let spe=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?CZ:LN}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:LN,imports:[XG]}),n})();const Ts=void 0,ope=["fr",[["AM","PM"],Ts,Ts],Ts,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Ts,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Ts,[["av. J.-C.","ap. J.-C."],Ts,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",Ts],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Ts,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Ts,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Ts,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Ts,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Ts,"\xa5"],KMF:[Ts,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Ts,"$C"],NZD:["$NZ","$"],PHP:[Ts,"\u20b1"],RHD:["$RH"],RON:[Ts,"L"],RWF:[Ts,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Ts,"$T"],TTD:["$TT","$"],TWD:[Ts,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Ts,"$"],XPF:["FCFP"],ZMW:[Ts,"Kw"]},"ltr",function ipe(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length,s=parseInt(n.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===e||1===e?1:0===s&&0!==e&&e%1e6==0&&0===r||!(s>=0&&s<=5)?4:5}];function yZ(n,t,e,r,s,i,o){try{var c=n[i](o),u=c.value}catch(h){return void e(h)}c.done?t(u):Promise.resolve(u).then(r,s)}function I(n){return function(){var t=this,e=arguments;return new Promise(function(r,s){var i=n.apply(t,e);function o(u){yZ(i,r,s,o,c,"next",u)}function c(u){yZ(i,r,s,o,c,"throw",u)}o(void 0)})}}const EZ=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=63&s|128):55296==(64512&s)&&r+1<n.length&&56320==(64512&n.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&n.charCodeAt(++r)),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=63&s|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=63&s|128)}return t},DN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,c=o?n[s+1]:0,u=s+2<n.length,h=u?n[s+2]:0;let E=(15&c)<<2|h>>6,b=63&h;u||(b=64,o||(E=64)),r.push(e[i>>2],e[(3&i)<<4|c>>4],e[E],e[b])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(EZ(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):function(n){const t=[];let e=0,r=0;for(;e<n.length;){const s=n[e++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[e++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const u=((7&s)<<18|(63&n[e++])<<12|(63&n[e++])<<6|63&n[e++])-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(1023&u))}else{const i=n[e++],o=n[e++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=e[n.charAt(s++)],c=s<n.length?e[n.charAt(s)]:0;++s;const h=s<n.length?e[n.charAt(s)]:64;++s;const m=s<n.length?e[n.charAt(s)]:64;if(++s,null==i||null==c||null==h||null==m)throw Error();r.push(i<<2|c>>4),64!==h&&(r.push(c<<4&240|h>>2),64!==m&&r.push(h<<6&192|m))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},NE=function(n){return function(n){const t=EZ(n);return DN.encodeByteArray(t,!0)}(n).replace(/\./g,"")},IE=function(n){try{return DN.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Fi(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function zN(){const n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof n&&void 0!==n.id}function $u(){return"object"==typeof indexedDB}function Xp(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var i;t((null===(i=s.error)||void 0===i?void 0:i.message)||"")}}catch(e){t(e)}})}function VN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const HN=()=>{try{return function mpe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&IE(n[1]);return t&&JSON.parse(t)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},SZ=n=>{var t,e;return null===(e=null===(t=HN())||void 0===t?void 0:t.emulatorHosts)||void 0===e?void 0:e[n]},PZ=n=>{var t;return null===(t=HN())||void 0===t?void 0:t[`_${n}`]};class xE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}class Lc extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,Lc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b4.prototype.create)}}class b4{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?function Ppe(n,t){return n.replace(Tpe,(e,r)=>{const s=t[r];return null!=s?String(s):`<${r}?>`})}(i,r):"Error";return new Lc(s,`${this.serviceName}: ${o} (${s}).`,r)}}const Tpe=/\{\$([^}]+)}/g;function LE(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const s of e){if(!r.includes(s))return!1;const i=n[s],o=t[s];if(wZ(i)&&wZ(o)){if(!LE(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!e.includes(s))return!1;return!0}function wZ(n){return null!==n&&"object"==typeof n}function Qp(n){const t=[];for(const[e,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Jp(n){const t={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");t[decodeURIComponent(s)]=decodeURIComponent(i)}}),t}function eg(n){const t=n.indexOf("?");if(!t)return"";const e=n.indexOf("#",t);return n.substring(t,e>0?e:void 0)}class Ope{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let s;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");s=function Ape(n,t){if("object"!=typeof n||null===n)return!1;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:r},void 0===s.next&&(s.next=FN),void 0===s.error&&(s.error=FN),void 0===s.complete&&(s.complete=FN);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function FN(){}function $N(n,t=1e3,e=2){const r=t*Math.pow(e,n),s=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+s)}function Jr(n){return n&&n._delegate?n._delegate:n}class to{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Uu="[DEFAULT]";class Rpe{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new xE;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const r=this.normalizeInstanceIdentifier(t?.identifier),s=null!==(e=t?.optional)&&void 0!==e&&e;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function zpe(n){return"EAGER"===n.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:Uu})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=Uu){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return I(function*(){const e=Array.from(t.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=Uu){return this.instances.has(t)}getOptions(t=Uu){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[i,o]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(i)&&o.resolve(s);return s}onInit(t,e){var r;const s=this.normalizeInstanceIdentifier(e),i=null!==(r=this.onInitCallbacks.get(s))&&void 0!==r?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const s of r)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t,n===Uu?void 0:n),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}var n;return r||null}normalizeInstanceIdentifier(t=Uu){return this.component?this.component.multipleInstances?t:Uu:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Vpe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Rpe(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const UN=[];var p1=(()=>{return(n=p1||(p1={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",p1;var n})();const bZ={debug:p1.DEBUG,verbose:p1.VERBOSE,info:p1.INFO,warn:p1.WARN,error:p1.ERROR,silent:p1.SILENT},Hpe=p1.INFO,Fpe={[p1.DEBUG]:"log",[p1.VERBOSE]:"log",[p1.INFO]:"info",[p1.WARN]:"warn",[p1.ERROR]:"error"},Bpe=(n,t,...e)=>{if(t<n.logLevel)return;const r=(new Date).toISOString(),s=Fpe[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${r}]  ${n.name}:`,...e)};class If{constructor(t){this.name=t,this._logLevel=Hpe,this._logHandler=Bpe,this._userLogHandler=null,UN.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in p1))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?bZ[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,p1.DEBUG,...t),this._logHandler(this,p1.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,p1.VERBOSE,...t),this._logHandler(this,p1.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,p1.INFO,...t),this._logHandler(this,p1.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,p1.WARN,...t),this._logHandler(this,p1.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,p1.ERROR,...t),this._logHandler(this,p1.ERROR,...t)}}let OZ,AZ;const NZ=new WeakMap,GN=new WeakMap,IZ=new WeakMap,qN=new WeakMap,WN=new WeakMap;let jN={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return GN.get(n);if("objectStoreNames"===t)return n.objectStoreNames||IZ.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Gl(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function Ype(n){return"function"==typeof n?function Zpe(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Gpe(){return AZ||(AZ=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...t){return n.apply(ZN(this),t),Gl(NZ.get(this))}:function(...t){return Gl(n.apply(ZN(this),t))}:function(t,...e){const r=n.call(ZN(this),t,...e);return IZ.set(r,t.sort?t.sort():[t]),Gl(r)}}(n):(n instanceof IDBTransaction&&function Wpe(n){if(GN.has(n))return;const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{e(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});GN.set(n,t)}(n),((n,t)=>t.some(e=>n instanceof e))(n,function Upe(){return OZ||(OZ=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,jN):n)}function Gl(n){if(n instanceof IDBRequest)return function qpe(n){const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{e(Gl(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&NZ.set(e,n)}).catch(()=>{}),WN.set(t,n),t}(n);if(qN.has(n))return qN.get(n);const t=Ype(n);return t!==n&&(qN.set(n,t),WN.set(t,n)),t}const ZN=n=>WN.get(n);function RE(n,t,{blocked:e,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,t),c=Gl(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Gl(o.result),u.oldVersion,u.newVersion,Gl(o.transaction))}),e&&o.addEventListener("blocked",()=>e()),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",()=>s())}).catch(()=>{}),c}function YN(n,{blocked:t}={}){const e=indexedDB.deleteDatabase(n);return t&&e.addEventListener("blocked",()=>t()),Gl(e).then(()=>{})}const Kpe=["get","getKey","getAll","getAllKeys","count"],Xpe=["put","add","delete","clear"],KN=new Map;function xZ(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(KN.get(t))return KN.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,s=Xpe.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!Kpe.includes(e))return;const i=function(){var o=I(function*(c,...u){const h=this.transaction(c,s?"readwrite":"readonly");let g=h.store;return r&&(g=g.index(u.shift())),(yield Promise.all([g[e](...u),s&&h.done]))[0]});return function(u){return o.apply(this,arguments)}}();return KN.set(t,i),i}!function jpe(n){jN=n(jN)}(n=>({...n,get:(t,e,r)=>xZ(t,e)||n.get(t,e,r),has:(t,e)=>!!xZ(t,e)||n.has(t,e)}));class Qpe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function Jpe(n){return"VERSION"===n.getComponent()?.type}(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}return null}).filter(e=>e).join(" ")}}const XN="@firebase/app",Gu=new If("@firebase/app"),DE="[DEFAULT]",Tge={[XN]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},qu=new Map,zE=new Map;function wge(n,t){try{n.container.addComponent(t)}catch(e){Gu.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function ko(n){const t=n.name;if(zE.has(t))return Gu.debug(`There were multiple attempts to register component ${t}.`),!1;zE.set(t,n);for(const e of qu.values())wge(e,n);return!0}function xf(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}const ql=new b4("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Oge{constructor(t,e,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new to("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ql.create("app-deleted",{appName:this._name})}}const kf="9.14.0";function LZ(n,t={}){let e=n;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:DE,automaticDataCollectionEnabled:!1},t),s=r.name;if("string"!=typeof s||!s)throw ql.create("bad-app-name",{appName:String(s)});if(e||(e=(()=>{var n;return null===(n=HN())||void 0===n?void 0:n.config})()),!e)throw ql.create("no-options");const i=qu.get(s);if(i){if(LE(e,i.options)&&LE(r,i.config))return i;throw ql.create("duplicate-app",{appName:s})}const o=new Vpe(s);for(const u of zE.values())o.addComponent(u);const c=new Oge(e,r,o);return qu.set(s,c),c}function QN(n=DE){const t=qu.get(n);if(!t&&n===DE)return LZ();if(!t)throw ql.create("no-app",{appName:n});return t}function RZ(){return Array.from(qu.values())}function us(n,t,e){var r;let s=null!==(r=Tge[n])&&void 0!==r?r:n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${t}":`];return i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Gu.warn(c.join(" "))}ko(new to(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const tg="firebase-heartbeat-store";let eI=null;function DZ(){return eI||(eI=RE("firebase-heartbeat-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(tg)}}).catch(n=>{throw ql.create("idb-open",{originalErrorMessage:n.message})})),eI}function tI(){return(tI=I(function*(n){var t;try{return(yield DZ()).transaction(tg).objectStore(tg).get(VZ(n))}catch(e){if(e instanceof Lc)Gu.warn(e.message);else{const r=ql.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});Gu.warn(r.message)}}})).apply(this,arguments)}function zZ(n,t){return nI.apply(this,arguments)}function nI(){return(nI=I(function*(n,t){var e;try{const s=(yield DZ()).transaction(tg,"readwrite");return yield s.objectStore(tg).put(t,VZ(n)),s.done}catch(r){if(r instanceof Lc)Gu.warn(r.message);else{const s=ql.create("idb-set",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message});Gu.warn(s.message)}}})).apply(this,arguments)}function VZ(n){return`${n.name}!${n.options.appId}`}class Lge{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Dge(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var t=this;return I(function*(){const r=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=HZ();if(null===t._heartbeatsCache&&(t._heartbeatsCache=yield t._heartbeatsCachePromise),t._heartbeatsCache.lastSentHeartbeatDate!==s&&!t._heartbeatsCache.heartbeats.some(i=>i.date===s))return t._heartbeatsCache.heartbeats.push({date:s,agent:r}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=2592e6}),t._storage.overwrite(t._heartbeatsCache)})()}getHeartbeatsHeader(){var t=this;return I(function*(){if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null===t._heartbeatsCache||0===t._heartbeatsCache.heartbeats.length)return"";const e=HZ(),{heartbeatsToSend:r,unsentEntries:s}=function Rge(n,t=1024){const e=[];let r=n.slice();for(const s of n){const i=e.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),FZ(e)>t){i.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),FZ(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}(t._heartbeatsCache.heartbeats),i=NE(JSON.stringify({version:2,heartbeats:r}));return t._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(t._heartbeatsCache.heartbeats=s,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),i})()}}function HZ(){return(new Date).toISOString().substring(0,10)}class Dge{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return I(function*(){return!!$u()&&Xp().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return I(function*(){return(yield t._canUseIndexedDBPromise)&&(yield function Ige(n){return tI.apply(this,arguments)}(t.app))||{heartbeats:[]}})()}overwrite(t){var e=this;return I(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return zZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var e=this;return I(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return zZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}})()}}function FZ(n){return NE(JSON.stringify({version:2,heartbeats:n})).length}!function zge(n){ko(new to("platform-logger",t=>new Qpe(t),"PRIVATE")),ko(new to("heartbeat",t=>new Lge(t),"PRIVATE")),us(XN,"0.8.4",n),us(XN,"0.8.4","esm2017"),us("fire-js","")}("");var It,Vge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Wl={},rI=rI||{},yn=Vge||self;function VE(){}function HE(n){var t=typeof n;return"array"==(t="object"!=t?t:n?Array.isArray(n)?"array":t:"null")||"object"==t&&"number"==typeof n.length}function ng(n){var t=typeof n;return"object"==t&&null!=n||"function"==t}var sI="closure_uid_"+(1e9*Math.random()>>>0),Fge=0;function Bge(n,t,e){return n.call.apply(n.bind,arguments)}function $ge(n,t,e){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),n.apply(t,s)}}return function(){return n.apply(t,arguments)}}function no(n,t,e){return(no=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Bge:$ge).apply(null,arguments)}function FE(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var r=e.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function w2(n,t){function e(){}e.prototype=t.prototype,n.X=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.Wb=function(r,s,i){for(var o=Array(arguments.length-2),c=2;c<arguments.length;c++)o[c-2]=arguments[c];return t.prototype[s].apply(r,o)}}function R0(){this.s=this.s,this.o=this.o}R0.prototype.s=!1,R0.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function Hge(n){Object.prototype.hasOwnProperty.call(n,sI)&&n[sI]||(n[sI]=++Fge)}(this)},R0.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const BZ=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if("string"==typeof n)return"string"!=typeof t||1!=t.length?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function iI(n){const t=n.length;if(0<t){const e=Array(t);for(let r=0;r<t;r++)e[r]=n[r];return e}return[]}function $Z(n,t){for(let e=1;e<arguments.length;e++){const r=arguments[e];if(HE(r)){const s=n.length||0,i=r.length||0;n.length=s+i;for(let o=0;o<i;o++)n[s+o]=r[o]}else n.push(r)}}function ro(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}ro.prototype.h=function(){this.defaultPrevented=!0};var Gge=function(){if(!yn.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{yn.addEventListener("test",VE,t),yn.removeEventListener("test",VE,t)}catch{}return n}();function BE(n){return/^[\s\xa0]*$/.test(n)}var UZ=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function oI(n,t){return n<t?-1:n>t?1:0}function $E(){var n=yn.navigator;return n&&(n=n.userAgent)?n:""}function O4(n){return-1!=$E().indexOf(n)}function aI(n){return aI[" "](n),n}aI[" "]=VE;var UE,n,Wge=O4("Opera"),Lf=O4("Trident")||O4("MSIE"),GZ=O4("Edge"),cI=GZ||Lf,qZ=O4("Gecko")&&!(-1!=$E().toLowerCase().indexOf("webkit")&&!O4("Edge"))&&!(O4("Trident")||O4("MSIE"))&&!O4("Edge"),jge=-1!=$E().toLowerCase().indexOf("webkit")&&!O4("Edge");function WZ(){var n=yn.document;return n?n.documentMode:void 0}e:{var lI="",uI=(n=$E(),qZ?/rv:([^\);]+)(\)|;)/.exec(n):GZ?/Edge\/([\d\.]+)/.exec(n):Lf?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):jge?/WebKit\/(\S+)/.exec(n):Wge?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(uI&&(lI=uI?uI[1]:""),Lf){var fI=WZ();if(null!=fI&&fI>parseFloat(lI)){UE=String(fI);break e}}UE=lI}var Zge={};var Kge=yn.document&&Lf&&(WZ()||parseInt(UE,10))||void 0;function rg(n,t){if(ro.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(qZ){e:{try{aI(t.nodeName);var s=!0;break e}catch{}s=!1}s||(t=null)}}else"mouseover"==e?t=n.fromElement:"mouseout"==e&&(t=n.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Xge[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&rg.X.h.call(this)}}w2(rg,ro);var Xge={2:"touch",3:"pen",4:"mouse"};rg.prototype.h=function(){rg.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var sg="closure_listenable_"+(1e6*Math.random()|0),Qge=0;function Jge(n,t,e,r,s){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!r,this.ha=s,this.key=++Qge,this.ba=this.ea=!1}function GE(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function dI(n,t,e){for(const r in n)t.call(e,n[r],r,n)}function ZZ(n){const t={};for(const e in n)t[e]=n[e];return t}const YZ="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function KZ(n,t){let e,r;for(let s=1;s<arguments.length;s++){for(e in r=arguments[s],r)n[e]=r[e];for(let i=0;i<YZ.length;i++)e=YZ[i],Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}}function qE(n){this.src=n,this.g={},this.h=0}function pI(n,t){var e=t.type;if(e in n.g){var i,r=n.g[e],s=BZ(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(GE(t),0==n.g[e].length&&(delete n.g[e],n.h--))}}function gI(n,t,e,r){for(var s=0;s<n.length;++s){var i=n[s];if(!i.ba&&i.listener==t&&i.capture==!!e&&i.ha==r)return s}return-1}qE.prototype.add=function(n,t,e,r,s){var i=n.toString();(n=this.g[i])||(n=this.g[i]=[],this.h++);var o=gI(n,t,r,s);return-1<o?(t=n[o],e||(t.ea=!1)):((t=new Jge(t,this.src,i,!!r,s)).ea=e,n.push(t)),t};var mI="closure_lm_"+(1e6*Math.random()|0),_I={};function XZ(n,t,e,r,s){if(r&&r.once)return JZ(n,t,e,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)XZ(n,t[i],e,r,s);return null}return e=EI(e),n&&n[sg]?n.N(t,e,ng(r)?!!r.capture:!!r,s):QZ(n,t,e,!1,r,s)}function QZ(n,t,e,r,s,i){if(!t)throw Error("Invalid event type");var o=ng(s)?!!s.capture:!!s,c=CI(n);if(c||(n[mI]=c=new qE(n)),(e=c.add(t,e,r,o,i)).proxy)return e;if(r=function eme(){const t=tme;return function n(e){return t.call(n.src,n.listener,e)}}(),e.proxy=r,r.src=n,r.listener=e,n.addEventListener)Gge||(s=o),void 0===s&&(s=!1),n.addEventListener(t.toString(),r,s);else if(n.attachEvent)n.attachEvent(tY(t.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return e}function JZ(n,t,e,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)JZ(n,t[i],e,r,s);return null}return e=EI(e),n&&n[sg]?n.O(t,e,ng(r)?!!r.capture:!!r,s):QZ(n,t,e,!0,r,s)}function eY(n,t,e,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)eY(n,t[i],e,r,s);else r=ng(r)?!!r.capture:!!r,e=EI(e),n&&n[sg]?(n=n.i,(t=String(t).toString())in n.g&&-1<(e=gI(i=n.g[t],e,r,s))&&(GE(i[e]),Array.prototype.splice.call(i,e,1),0==i.length&&(delete n.g[t],n.h--))):n&&(n=CI(n))&&(t=n.g[t.toString()],n=-1,t&&(n=gI(t,e,r,s)),(e=-1<n?t[n]:null)&&vI(e))}function vI(n){if("number"!=typeof n&&n&&!n.ba){var t=n.src;if(t&&t[sg])pI(t.i,n);else{var e=n.type,r=n.proxy;t.removeEventListener?t.removeEventListener(e,r,n.capture):t.detachEvent?t.detachEvent(tY(e),r):t.addListener&&t.removeListener&&t.removeListener(r),(e=CI(t))?(pI(e,n),0==e.h&&(e.src=null,t[mI]=null)):GE(n)}}}function tY(n){return n in _I?_I[n]:_I[n]="on"+n}function tme(n,t){if(n.ba)n=!0;else{t=new rg(t,this);var e=n.listener,r=n.ha||n.src;n.ea&&vI(n),n=e.call(r,t)}return n}function CI(n){return(n=n[mI])instanceof qE?n:null}var yI="__closure_events_fn_"+(1e9*Math.random()>>>0);function EI(n){return"function"==typeof n?n:(n[yI]||(n[yI]=function(t){return n.handleEvent(t)}),n[yI])}function Bi(){R0.call(this),this.i=new qE(this),this.P=this,this.I=null}function b2(n,t){var e,r=n.I;if(r)for(e=[];r;r=r.I)e.push(r);if(n=n.P,r=t.type||t,"string"==typeof t)t=new ro(t,n);else if(t instanceof ro)t.target=t.target||n;else{var s=t;KZ(t=new ro(r,n),s)}if(s=!0,e)for(var i=e.length-1;0<=i;i--){var o=t.g=e[i];s=WE(o,r,!0,t)&&s}if(s=WE(o=t.g=n,r,!0,t)&&s,s=WE(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=WE(o=t.g=e[i],r,!1,t)&&s}function WE(n,t,e,r){if(!(t=n.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.ba&&o.capture==e){var c=o.listener,u=o.ha||o.src;o.ea&&pI(n.i,o),s=!1!==c.call(u,r)&&s}}return s&&!r.defaultPrevented}w2(Bi,R0),Bi.prototype[sg]=!0,Bi.prototype.removeEventListener=function(n,t,e,r){eY(this,n,t,e,r)},Bi.prototype.M=function(){if(Bi.X.M.call(this),this.i){var t,n=this.i;for(t in n.g){for(var e=n.g[t],r=0;r<e.length;r++)GE(e[r]);delete n.g[t],n.h--}}this.I=null},Bi.prototype.N=function(n,t,e,r){return this.i.add(String(n),t,!1,e,r)},Bi.prototype.O=function(n,t,e,r){return this.i.add(String(n),t,!0,e,r)};var MI=yn.JSON.stringify;function nme(){var n=sY;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}var SI,nY=new class{constructor(n,t){this.i=n,this.j=t,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new sme,n=>n.reset());class sme{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function ime(n){yn.setTimeout(()=>{throw n},0)}function rY(n,t){SI||function ome(){var n=yn.Promise.resolve(void 0);SI=function(){n.then(ame)}}(),PI||(SI(),PI=!0),sY.add(n,t)}var PI=!1,sY=new class rme{constructor(){this.h=this.g=null}add(t,e){const r=nY.get();r.set(t,e),this.h?this.h.next=r:this.g=r,this.h=r}};function ame(){for(var n;n=nme();){try{n.h.call(n.g)}catch(e){ime(e)}var t=nY;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}PI=!1}function jE(n,t){Bi.call(this),this.h=n||1,this.g=t||yn,this.j=no(this.lb,this),this.l=Date.now()}function TI(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function wI(n,t,e){if("function"==typeof n)e&&(n=no(n,e));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=no(n.handleEvent,n)}return 2147483647<Number(t)?-1:yn.setTimeout(n,t||0)}function iY(n){n.g=wI(()=>{n.g=null,n.i&&(n.i=!1,iY(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}w2(jE,Bi),(It=jE.prototype).ca=!1,It.R=null,It.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),b2(this,"tick"),this.ca&&(TI(this),this.start()))}},It.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},It.M=function(){jE.X.M.call(this),TI(this),delete this.g};class cme extends R0{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:iY(this)}M(){super.M(),this.g&&(yn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ig(n){R0.call(this),this.h=n,this.g={}}w2(ig,R0);var oY=[];function aY(n,t,e,r){Array.isArray(e)||(e&&(oY[0]=e.toString()),e=oY);for(var s=0;s<e.length;s++){var i=XZ(t,e[s],r||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function cY(n){dI(n.g,function(t,e){this.g.hasOwnProperty(e)&&vI(t)},n),n.g={}}function ZE(){this.g=!0}function Rf(n,t,e,r){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+function hme(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var r=e[n];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return MI(e)}catch{return t}}(n,e)+(r?" "+r:"")})}ig.prototype.M=function(){ig.X.M.call(this),cY(this)},ig.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ZE.prototype.Aa=function(){this.g=!1},ZE.prototype.info=function(){};var Wu={},lY=null;function YE(){return lY=lY||new Bi}function uY(n){ro.call(this,Wu.Pa,n)}function og(n){const t=YE();b2(t,new uY(t))}function fY(n,t){ro.call(this,Wu.STAT_EVENT,n),this.stat=t}function Lo(n){const t=YE();b2(t,new fY(t,n))}function hY(n,t){ro.call(this,Wu.Qa,n),this.size=t}function ag(n,t){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return yn.setTimeout(function(){n()},t)}Wu.Pa="serverreachability",w2(uY,ro),Wu.STAT_EVENT="statevent",w2(fY,ro),Wu.Qa="timingevent",w2(hY,ro);var KE={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},dY={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function bI(){}function gY(){}bI.prototype.h=null;var NI,cg={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function OI(){ro.call(this,"d")}function AI(){ro.call(this,"c")}function XE(){}function lg(n,t,e,r){this.l=n,this.j=t,this.m=e,this.U=r||1,this.S=new ig(this),this.O=dme,this.T=new jE(n=cI?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new mY}function mY(){this.i=null,this.g="",this.h=!1}w2(OI,ro),w2(AI,ro),w2(XE,bI),XE.prototype.g=function(){return new XMLHttpRequest},XE.prototype.i=function(){return{}},NI=new XE;var dme=45e3,II={},QE={};function xI(n,t,e){n.K=1,n.v=nM(jl(t)),n.s=e,n.P=!0,_Y(n,null)}function _Y(n,t){n.F=Date.now(),ug(n),n.A=jl(n.v);var e=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),bY(e.i,"t",r),n.C=0,e=n.l.H,n.h=new mY,n.g=XY(n.l,e?t:null,!n.s),0<n.N&&(n.L=new cme(no(n.La,n,n.g),n.N)),aY(n.S,n.g,"readystatechange",n.ib),t=n.H?ZZ(n.H):{},n.s?(n.u||(n.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,t)):(n.u="GET",n.g.da(n.A,n.u,null,t)),og(),function lme(n,t,e,r,s,i){n.info(function(){if(n.g)if(i)for(var o="",c=i.split("&"),u=0;u<c.length;u++){var h=c[u].split("=");if(1<h.length){var g=h[0];h=h[1];var m=g.split("_");o=2<=m.length&&"type"==m[1]?o+(g+"=")+h+"&":o+(g+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+e+"\n"+o})}(n.j,n.u,n.A,n.m,n.U,n.s)}function vY(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function CY(n,t,e){let s,r=!0;for(;!n.I&&n.C<e.length;){if(s=pme(n,e),s==QE){4==t&&(n.o=4,Lo(14),r=!1),Rf(n.j,n.m,null,"[Incomplete Response]");break}if(s==II){n.o=4,Lo(15),Rf(n.j,n.m,e,"[Invalid Chunk]"),r=!1;break}Rf(n.j,n.m,s,null),kI(n,s)}vY(n)&&s!=QE&&s!=II&&(n.h.g="",n.C=0),4!=t||0!=e.length||n.h.h||(n.o=1,Lo(16),r=!1),n.i=n.i&&r,r?0<e.length&&!n.$&&(n.$=!0,(t=n.l).g==n&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+e.length),BI(t),t.K=!0,Lo(11))):(Rf(n.j,n.m,e,"[Invalid Chunked Response]"),ju(n),fg(n))}function pme(n,t){var e=n.C,r=t.indexOf("\n",e);return-1==r?QE:(e=Number(t.substring(e,r)),isNaN(e)?II:(r+=1)+e>t.length?QE:(t=t.substr(r,e),n.C=r+e,t))}function ug(n){n.V=Date.now()+n.O,yY(n,n.O)}function yY(n,t){if(null!=n.B)throw Error("WatchDog timer not null");n.B=ag(no(n.gb,n),t)}function JE(n){n.B&&(yn.clearTimeout(n.B),n.B=null)}function fg(n){0==n.l.G||n.I||jY(n.l,n)}function ju(n){JE(n);var t=n.L;t&&"function"==typeof t.na&&t.na(),n.L=null,TI(n.T),cY(n.S),n.g&&(t=n.g,n.g=null,t.abort(),t.na())}function kI(n,t){try{var e=n.l;if(0!=e.G&&(e.g==n||LI(e.h,n)))if(!n.J&&LI(e.h,n)&&3==e.G){try{var r=e.Fa.g.parse(t)}catch{r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!e.u){if(e.g){if(!(e.g.F+3e3<n.F))break e;cM(e),oM(e)}FI(e),Lo(18)}}else e.Ba=s[1],0<e.Ba-e.T&&37500>s[2]&&e.L&&0==e.A&&!e.v&&(e.v=ag(no(e.cb,e),6e3));if(1>=NY(e.h)&&e.ja){try{e.ja()}catch{}e.ja=void 0}}else Yu(e,11)}else if((n.J||e.g==n)&&cM(e),!BE(t))for(s=e.Fa.g.parse(t),t=0;t<s.length;t++){let h=s[t];if(e.T=h[0],h=h[1],2==e.G)if("c"==h[0]){e.I=h[1],e.ka=h[2];const g=h[3];null!=g&&(e.ma=g,e.j.info("VER="+e.ma));const m=h[4];null!=m&&(e.Ca=m,e.j.info("SVER="+e.Ca));const E=h[5];null!=E&&"number"==typeof E&&0<E&&(e.J=r=1.5*E,e.j.info("backChannelRequestTimeoutMs_="+r)),r=e;const b=n.g;if(b){const k=b.g?b.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(k){var i=r.h;i.g||-1==k.indexOf("spdy")&&-1==k.indexOf("quic")&&-1==k.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(RI(i,i.h),i.h=null))}if(r.D){const U=b.g?b.g.getResponseHeader("X-HTTP-Session-Id"):null;U&&(r.za=U,Br(r.F,r.D,U))}}e.G=3,e.l&&e.l.xa(),e.$&&(e.P=Date.now()-n.F,e.j.info("Handshake RTT: "+e.P+"ms"));var o=n;if((r=e).sa=KY(r,r.H?r.ka:null,r.V),o.J){IY(r.h,o);var c=o,u=r.J;u&&c.setTimeout(u),c.B&&(JE(c),ug(c)),r.g=o}else qY(r);0<e.i.length&&aM(e)}else"stop"!=h[0]&&"close"!=h[0]||Yu(e,7);else 3==e.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?Yu(e,7):HI(e):"noop"!=h[0]&&e.l&&e.l.wa(h),e.A=0)}og()}catch{}}function EY(n,t){if(n.forEach&&"function"==typeof n.forEach)n.forEach(t,void 0);else if(HE(n)||"string"==typeof n)Array.prototype.forEach.call(n,t,void 0);else for(var e=function mme(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(HE(n)||"string"==typeof n){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const r in n)t[e++]=r;return t}}}(n),r=function gme(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(HE(n)){for(var t=[],e=n.length,r=0;r<e;r++)t.push(n[r]);return t}for(r in t=[],e=0,n)t[e++]=n[r];return t}(n),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],e&&e[i],n)}(It=lg.prototype).setTimeout=function(n){this.O=n},It.ib=function(n){n=n.target;const t=this.L;t&&3==Zl(n)?t.l():this.La(n)},It.La=function(n){try{if(n==this.g)e:{const g=Zl(this.g);var t=this.g.Ea();if(this.g.aa(),!(3>g)&&(3!=g||cI||this.g&&(this.h.h||this.g.fa()||HY(this.g)))){this.I||4!=g||7==t||og(),JE(this);var e=this.g.aa();this.Y=e;t:if(vY(this)){var r=HY(this.g);n="";var s=r.length,i=4==Zl(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){ju(this),fg(this);var o="";break t}this.h.i=new yn.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,n+=this.h.i.decode(r[t],{stream:i&&t==s-1});r.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==e,function ume(n,t,e,r,s,i,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+e+"\n"+i+" "+o})}(this.j,this.u,this.A,this.m,this.U,g,e),this.i){if(this.Z&&!this.J){t:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!BE(c)){var h=c;break t}}h=null}if(!(e=h)){this.i=!1,this.o=3,Lo(12),ju(this),fg(this);break e}Rf(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,kI(this,e)}this.P?(CY(this,g,o),cI&&this.i&&3==g&&(aY(this.S,this.T,"tick",this.hb),this.T.start())):(Rf(this.j,this.m,o,null),kI(this,o)),4==g&&ju(this),this.i&&!this.I&&(4==g?jY(this.l,this):(this.i=!1,ug(this)))}else 400==e&&0<o.indexOf("Unknown SID")?(this.o=3,Lo(12)):(this.o=0,Lo(13)),ju(this),fg(this)}}}catch{}},It.hb=function(){if(this.g){var n=Zl(this.g),t=this.g.fa();this.C<t.length&&(JE(this),CY(this,n,t),this.i&&4!=n&&ug(this))}},It.cancel=function(){this.I=!0,ju(this)},It.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function fme(n,t){n.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(og(),Lo(17)),ju(this),this.o=2,fg(this)):yY(this,this.V-n)};var MY=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Zu(n,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Zu){this.h=void 0!==t?t:n.h,eM(this,n.j),this.s=n.s,this.g=n.g,tM(this,n.m),this.l=n.l,t=n.i;var e=new pg;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),SY(this,e),this.o=n.o}else n&&(e=String(n).match(MY))?(this.h=!!t,eM(this,e[1]||"",!0),this.s=hg(e[2]||""),this.g=hg(e[3]||"",!0),tM(this,e[4]),this.l=hg(e[5]||"",!0),SY(this,e[6]||"",!0),this.o=hg(e[7]||"")):(this.h=!!t,this.i=new pg(null,this.h))}function jl(n){return new Zu(n)}function eM(n,t,e){n.j=e?hg(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function tM(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function SY(n,t,e){t instanceof pg?(n.i=t,function Sme(n,t){t&&!n.j&&(D0(n),n.i=null,n.g.forEach(function(e,r){var s=r.toLowerCase();r!=s&&(TY(this,r),bY(this,s,e))},n)),n.j=t}(n.i,n.h)):(e||(t=dg(t,Eme)),n.i=new pg(t,n.h))}function Br(n,t,e){n.i.set(t,e)}function nM(n){return Br(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function hg(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function dg(n,t,e){return"string"==typeof n?(n=encodeURI(n).replace(t,vme),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function vme(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Zu.prototype.toString=function(){var n=[],t=this.j;t&&n.push(dg(t,PY,!0),":");var e=this.g;return(e||"file"==t)&&(n.push("//"),(t=this.s)&&n.push(dg(t,PY,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.m)&&n.push(":",String(e))),(e=this.l)&&(this.g&&"/"!=e.charAt(0)&&n.push("/"),n.push(dg(e,"/"==e.charAt(0)?yme:Cme,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",dg(e,Mme)),n.join("")};var PY=/[#\/\?@]/g,Cme=/[#\?:]/g,yme=/[#\?]/g,Eme=/[#\?@]/g,Mme=/#/g;function pg(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function D0(n){n.g||(n.g=new Map,n.h=0,n.i&&function _me(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var r=n[e].indexOf("="),s=null;if(0<=r){var i=n[e].substring(0,r);s=n[e].substring(r+1)}else i=n[e];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function TY(n,t){D0(n),t=Df(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function wY(n,t){return D0(n),t=Df(n,t),n.g.has(t)}function bY(n,t,e){TY(n,t),0<e.length&&(n.i=null,n.g.set(Df(n,t),iI(e)),n.h+=e.length)}function Df(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function OY(n){this.l=n||Tme,n=yn.PerformanceNavigationTiming?0<(n=yn.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(yn.g&&yn.g.Ga&&yn.g.Ga()&&yn.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(It=pg.prototype).add=function(n,t){D0(this),this.i=null,n=Df(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this},It.forEach=function(n,t){D0(this),this.g.forEach(function(e,r){e.forEach(function(s){n.call(t,s,r,this)},this)},this)},It.oa=function(){D0(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let r=0;r<t.length;r++){const s=n[r];for(let i=0;i<s.length;i++)e.push(t[r])}return e},It.W=function(n){D0(this);let t=[];if("string"==typeof n)wY(this,n)&&(t=t.concat(this.g.get(Df(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t},It.set=function(n,t){return D0(this),this.i=null,wY(this,n=Df(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this},It.get=function(n,t){return n&&0<(n=this.W(n)).length?String(n[0]):t},It.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var r=t[e];const i=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var s=i;""!==o[r]&&(s+="="+encodeURIComponent(String(o[r]))),n.push(s)}}return this.i=n.join("&")};var Tme=10;function AY(n){return!!n.h||!!n.g&&n.g.size>=n.j}function NY(n){return n.h?1:n.g?n.g.size:0}function LI(n,t){return n.h?n.h==t:!!n.g&&n.g.has(t)}function RI(n,t){n.g?n.g.add(t):n.h=t}function IY(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}function xY(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let t=n.i;for(const e of n.g.values())t=t.concat(e.D);return t}return iI(n.i)}function DI(){}function wme(){this.g=new DI}function bme(n,t,e){const r=e||"";try{EY(n,function(s,i){let o=s;ng(s)&&(o=MI(s)),t.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function rM(n,t,e,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch{}}function gg(n){this.l=n.ac||null,this.j=n.jb||!1}function sM(n,t){Bi.call(this),this.D=n,this.u=t,this.m=void 0,this.readyState=zI,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}OY.prototype.cancel=function(){if(this.i=xY(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},DI.prototype.stringify=function(n){return yn.JSON.stringify(n,void 0)},DI.prototype.parse=function(n){return yn.JSON.parse(n,void 0)},w2(gg,bI),gg.prototype.g=function(){return new sM(this.l,this.j)},gg.prototype.i=function(n){return function(){return n}}({}),w2(sM,Bi);var zI=0;function kY(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function mg(n){n.readyState=4,n.l=null,n.j=null,n.A=null,_g(n)}function _g(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(It=sM.prototype).open=function(n,t){if(this.readyState!=zI)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,_g(this)},It.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.D||yn).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},It.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,mg(this)),this.readyState=zI},It.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,_g(this)),this.g&&(this.readyState=3,_g(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof yn.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;kY(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},It.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?mg(this):_g(this),3==this.readyState&&kY(this)}},It.Va=function(n){this.g&&(this.response=this.responseText=n,mg(this))},It.Ua=function(n){this.g&&(this.response=n,mg(this))},It.ga=function(){this.g&&mg(this)},It.setRequestHeader=function(n,t){this.v.append(n,t)},It.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},It.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)n.push((e=e.value)[0]+": "+e[1]),e=t.next();return n.join("\r\n")},Object.defineProperty(sM.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Ame=yn.JSON.parse;function fs(n){Bi.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=LY,this.K=this.L=!1}w2(fs,Bi);var LY="",Nme=/^https?$/i,Ime=["POST","PUT"];function RY(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,DY(n),iM(n)}function DY(n){n.D||(n.D=!0,b2(n,"complete"),b2(n,"error"))}function zY(n){if(n.h&&typeof rI<"u"&&(!n.C[1]||4!=Zl(n)||2!=n.aa()))if(n.v&&4==Zl(n))wI(n.Ha,0,n);else if(b2(n,"readystatechange"),4==Zl(n)){n.h=!1;try{const c=n.aa();e:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var e;if(!(e=t)){var r;if(r=0===c){var s=String(n.H).match(MY)[1]||null;if(!s&&yn.self&&yn.self.location){var i=yn.self.location.protocol;s=i.substr(0,i.length-1)}r=!Nme.test(s?s.toLowerCase():"")}e=r}if(e)b2(n,"complete"),b2(n,"success");else{n.m=6;try{var o=2<Zl(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.aa()+"]",DY(n)}}finally{iM(n)}}}function iM(n,t){if(n.g){VY(n);const e=n.g,r=n.C[0]?VE:null;n.g=null,n.C=null,t||b2(n,"ready");try{e.onreadystatechange=r}catch{}}}function VY(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(yn.clearTimeout(n.A),n.A=null)}function Zl(n){return n.g?n.g.readyState:0}function HY(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case LY:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function FY(n){let t="";return dI(n,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function VI(n,t,e){e:{for(r in e){var r=!1;break e}r=!0}r||(e=FY(e),"string"==typeof n?null!=e&&encodeURIComponent(String(e)):Br(n,t,e))}function vg(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function BY(n){this.Ca=0,this.i=[],this.j=new ZE,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=vg("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=vg("baseRetryDelayMs",5e3,n),this.bb=vg("retryDelaySeedMs",1e4,n),this.$a=vg("forwardChannelMaxRetries",2,n),this.ta=vg("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new OY(n&&n.concurrentRequestLimit),this.Fa=new wme,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function HI(n){if($Y(n),3==n.G){var t=n.U++,e=jl(n.F);Br(e,"SID",n.I),Br(e,"RID",t),Br(e,"TYPE","terminate"),Cg(n,e),(t=new lg(n,n.j,t,void 0)).K=2,t.v=nM(jl(e)),e=!1,yn.navigator&&yn.navigator.sendBeacon&&(e=yn.navigator.sendBeacon(t.v.toString(),"")),!e&&yn.Image&&((new Image).src=t.v,e=!0),e||(t.g=XY(t.l,null),t.g.da(t.v)),t.F=Date.now(),ug(t)}YY(n)}function oM(n){n.g&&(BI(n),n.g.cancel(),n.g=null)}function $Y(n){oM(n),n.u&&(yn.clearTimeout(n.u),n.u=null),cM(n),n.h.cancel(),n.m&&("number"==typeof n.m&&yn.clearTimeout(n.m),n.m=null)}function aM(n){AY(n.h)||n.m||(n.m=!0,rY(n.Ja,n),n.C=0)}function UY(n,t){var e;e=t?t.m:n.U++;const r=jl(n.F);Br(r,"SID",n.I),Br(r,"RID",e),Br(r,"AID",n.T),Cg(n,r),n.o&&n.s&&VI(r,n.o,n.s),e=new lg(n,n.j,e,n.C+1),null===n.o&&(e.H=n.s),t&&(n.i=t.D.concat(n.i)),t=GY(n,e,1e3),e.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),RI(n.h,e),xI(e,r,t)}function Cg(n,t){n.ia&&dI(n.ia,function(e,r){Br(t,r,e)}),n.l&&EY({},function(e,r){Br(t,r,e)})}function GY(n,t,e){e=Math.min(n.i.length,e);var r=n.l?no(n.l.Ra,n.l,n):null;e:{var s=n.i;let i=-1;for(;;){const o=["count="+e];-1==i?0<e?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let c=!0;for(let u=0;u<e;u++){let h=s[u].h;const g=s[u].g;if(h-=i,0>h)i=Math.max(0,s[u].h-100),c=!1;else try{bme(g,o,"req"+h+"_")}catch{r&&r(g)}}if(c){r=o.join("&");break e}}}return n=n.i.splice(0,e),t.D=n,r}function qY(n){n.g||n.u||(n.Z=1,rY(n.Ia,n),n.A=0)}function FI(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=ag(no(n.Ia,n),ZY(n,n.A)),n.A++,0))}function BI(n){null!=n.B&&(yn.clearTimeout(n.B),n.B=null)}function WY(n){n.g=new lg(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var t=jl(n.sa);Br(t,"RID","rpc"),Br(t,"SID",n.I),Br(t,"CI",n.L?"0":"1"),Br(t,"AID",n.T),Br(t,"TYPE","xmlhttp"),Cg(n,t),n.o&&n.s&&VI(t,n.o,n.s),n.J&&n.g.setTimeout(n.J);var e=n.g;n=n.ka,e.K=1,e.v=nM(jl(t)),e.s=null,e.P=!0,_Y(e,n)}function cM(n){null!=n.v&&(yn.clearTimeout(n.v),n.v=null)}function jY(n,t){var e=null;if(n.g==t){cM(n),BI(n),n.g=null;var r=2}else{if(!LI(n.h,t))return;e=t.D,IY(n.h,t),r=1}if(0!=n.G)if(n.pa=t.Y,t.i)if(1==r){e=t.s?t.s.length:0,t=Date.now()-t.F;var s=n.C;b2(r=YE(),new hY(r,e)),aM(n)}else qY(n);else if(3==(s=t.o)||0==s&&0<n.pa||!(1==r&&function kme(n,t){return!(NY(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=t.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=ag(no(n.Ja,n,t),ZY(n,n.C)),n.C++,0)))}(n,t)||2==r&&FI(n)))switch(e&&0<e.length&&(t=n.h,t.i=t.i.concat(e)),s){case 1:Yu(n,5);break;case 4:Yu(n,10);break;case 3:Yu(n,6);break;default:Yu(n,2)}}function ZY(n,t){let e=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(e*=2),e*t}function Yu(n,t){if(n.j.info("Error code "+t),2==t){var e=null;n.l&&(e=null);var r=no(n.kb,n);e||(e=new Zu("//www.google.com/images/cleardot.gif"),yn.location&&"http"==yn.location.protocol||eM(e,"https"),nM(e)),function Ome(n,t){const e=new ZE;if(yn.Image){const r=new Image;r.onload=FE(rM,e,r,"TestLoadImage: loaded",!0,t),r.onerror=FE(rM,e,r,"TestLoadImage: error",!1,t),r.onabort=FE(rM,e,r,"TestLoadImage: abort",!1,t),r.ontimeout=FE(rM,e,r,"TestLoadImage: timeout",!1,t),yn.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else t(!1)}(e.toString(),r)}else Lo(2);n.G=0,n.l&&n.l.va(t),YY(n),$Y(n)}function YY(n){if(n.G=0,n.la=[],n.l){const t=xY(n.h);(0!=t.length||0!=n.i.length)&&($Z(n.la,t),$Z(n.la,n.i),n.h.i.length=0,iI(n.i),n.i.length=0),n.l.ua()}}function KY(n,t,e){var r=e instanceof Zu?jl(e):new Zu(e,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),tM(r,r.m);else{var s=yn.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new Zu(null,void 0);r&&eM(i,r),t&&(i.g=t),s&&tM(i,s),e&&(i.l=e),r=i}return t=n.za,(e=n.D)&&t&&Br(r,e,t),Br(r,"VER",n.ma),Cg(n,r),r}function XY(n,t,e){if(t&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new fs(e&&n.Da&&!n.ra?new gg({jb:!0}):n.ra)).Ka(n.H),t}function QY(){}function lM(){if(Lf&&!(10<=Number(Kge)))throw Error("Environmental error: no available transport.")}function Za(n,t){Bi.call(this),this.g=new BY(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(n?n["X-WebChannel-Client-Profile"]=t.ya:n={"X-WebChannel-Client-Profile":t.ya}),this.g.S=n,(n=t&&t.Yb)&&!BE(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!BE(t)&&(this.g.D=t,null!==(n=this.h)&&t in n&&t in(n=this.h)&&delete n[t]),this.j=new zf(this)}function JY(n){OI.call(this);var t=n.__sm__;if(t){e:{for(const e in t){n=e;break e}n=void 0}(this.i=n)&&(n=this.i,t=null!==t&&n in t?t[n]:void 0),this.data=t}else this.data=n}function eK(){AI.call(this),this.status=1}function zf(n){this.g=n}(It=fs.prototype).Ka=function(n){this.L=n},It.da=function(n,t,e,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);t=t?t.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():NI.g(),this.C=function pY(n){return n.h||(n.h=n.i())}(this.u?this.u:NI),this.g.onreadystatechange=no(this.Ha,this);try{this.F=!0,this.g.open(t,String(n),!0),this.F=!1}catch(i){return void RY(this,i)}if(n=e||"",e=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)e.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const i of r.keys())e.set(i,r.get(i))}r=Array.from(e.keys()).find(i=>"content-type"==i.toLowerCase()),s=yn.FormData&&n instanceof yn.FormData,!(0<=BZ(Ime,t))||r||s||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of e)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{VY(this),0<this.B&&((this.K=function xme(n){return Lf&&function Yge(){return function qge(n){var t=Zge;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=n(9)}(function(){let n=0;const t=UZ(String(UE)).split("."),e=UZ("9").split("."),r=Math.max(t.length,e.length);for(let o=0;0==n&&o<r;o++){var s=t[o]||"",i=e[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],0==s[0].length&&0==i[0].length)break;n=oI(0==s[1].length?0:parseInt(s[1],10),0==i[1].length?0:parseInt(i[1],10))||oI(0==s[2].length,0==i[2].length)||oI(s[2],i[2]),s=s[3],i=i[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=no(this.qa,this)):this.A=wI(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){RY(this,i)}},It.qa=function(){typeof rI<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,b2(this,"timeout"),this.abort(8))},It.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,b2(this,"complete"),b2(this,"abort"),iM(this))},It.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),iM(this,!0)),fs.X.M.call(this)},It.Ha=function(){this.s||(this.F||this.v||this.l?zY(this):this.fb())},It.fb=function(){zY(this)},It.aa=function(){try{return 2<Zl(this)?this.g.status:-1}catch{return-1}},It.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},It.Sa=function(n){if(this.g){var t=this.g.responseText;return n&&0==t.indexOf(n)&&(t=t.substring(n.length)),Ame(t)}},It.Ea=function(){return this.m},It.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(It=BY.prototype).ma=8,It.G=1,It.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const s=new lg(this,this.j,n,void 0);let i=this.s;if(this.S&&(i?(i=ZZ(i),KZ(i,this.S)):i=this.S),null!==this.o||this.N||(s.H=i,i=null),this.O)e:{for(var t=0,e=0;e<this.i.length;e++){var r=this.i[e];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=e;break e}if(4096===t||e===this.i.length-1){t=e+1;break e}}t=1e3}else t=1e3;t=GY(this,s,t),Br(e=jl(this.F),"RID",n),Br(e,"CVER",22),this.D&&Br(e,"X-HTTP-Session-Id",this.D),Cg(this,e),i&&(this.N?t="headers="+encodeURIComponent(String(FY(i)))+"&"+t:this.o&&VI(e,this.o,i)),RI(this.h,s),this.Ya&&Br(e,"TYPE","init"),this.O?(Br(e,"$req",t),Br(e,"SID","null"),s.Z=!0,xI(s,e,null)):xI(s,e,t),this.G=2}}else 3==this.G&&(n?UY(this,n):0==this.i.length||AY(this.h)||UY(this))},It.Ia=function(){if(this.u=null,WY(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=ag(no(this.eb,this),n)}},It.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Lo(10),oM(this),WY(this))},It.cb=function(){null!=this.v&&(this.v=null,oM(this),FI(this),Lo(19))},It.kb=function(n){n?(this.j.info("Successfully pinged google.com"),Lo(2)):(this.j.info("Failed to ping google.com"),Lo(1))},(It=QY.prototype).xa=function(){},It.wa=function(){},It.va=function(){},It.ua=function(){},It.Ra=function(){},lM.prototype.g=function(n,t){return new Za(n,t)},w2(Za,Bi),Za.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,t=this.l,e=this.h||void 0;Lo(0),n.V=t,n.ia=e||{},n.L=n.Y,n.F=KY(n,null,n.V),aM(n)},Za.prototype.close=function(){HI(this.g)},Za.prototype.u=function(n){var t=this.g;if("string"==typeof n){var e={};e.__data__=n,n=e}else this.v&&((e={}).__data__=MI(n),n=e);t.i.push(new class{constructor(n,t){this.h=n,this.g=t}}(t.ab++,n)),3==t.G&&aM(t)},Za.prototype.M=function(){this.g.l=null,delete this.j,HI(this.g),delete this.g,Za.X.M.call(this)},w2(JY,OI),w2(eK,AI),w2(zf,QY),zf.prototype.xa=function(){b2(this.g,"a")},zf.prototype.wa=function(n){b2(this.g,new JY(n))},zf.prototype.va=function(n){b2(this.g,new eK)},zf.prototype.ua=function(){b2(this.g,"b")},lM.prototype.createWebChannel=lM.prototype.g,Za.prototype.send=Za.prototype.u,Za.prototype.open=Za.prototype.m,Za.prototype.close=Za.prototype.close,KE.NO_ERROR=0,KE.TIMEOUT=8,KE.HTTP_ERROR=6,dY.COMPLETE="complete",gY.EventType=cg,cg.OPEN="a",cg.CLOSE="b",cg.ERROR="c",cg.MESSAGE="d",Bi.prototype.listen=Bi.prototype.N,fs.prototype.listenOnce=fs.prototype.O,fs.prototype.getLastError=fs.prototype.Oa,fs.prototype.getLastErrorCode=fs.prototype.Ea,fs.prototype.getStatus=fs.prototype.aa,fs.prototype.getResponseJson=fs.prototype.Sa,fs.prototype.getResponseText=fs.prototype.fa,fs.prototype.send=fs.prototype.da,fs.prototype.setWithCredentials=fs.prototype.Ka;var Lme=Wl.createWebChannelTransport=function(){return new lM},Rme=Wl.getStatEventTarget=function(){return YE()},$I=Wl.ErrorCode=KE,Dme=Wl.EventType=dY,zme=Wl.Event=Wu,tK=Wl.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Vme=Wl.FetchXmlHttpFactory=gg,uM=Wl.WebChannel=gY,Hme=Wl.XhrIo=fs;const nK="@firebase/firestore";class $i{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}$i.UNAUTHENTICATED=new $i(null),$i.GOOGLE_CREDENTIALS=new $i("google-credentials-uid"),$i.FIRST_PARTY=new $i("first-party-uid"),$i.MOCK_USER=new $i("mock-user");let Vf="9.14.0";const z0=new If("@firebase/firestore");function UI(){return z0.logLevel}function We(n,...t){if(z0.logLevel<=p1.DEBUG){const e=t.map(GI);z0.debug(`Firestore (${Vf}): ${n}`,...e)}}function ws(n,...t){if(z0.logLevel<=p1.ERROR){const e=t.map(GI);z0.error(`Firestore (${Vf}): ${n}`,...e)}}function Hf(n,...t){if(z0.logLevel<=p1.WARN){const e=t.map(GI);z0.warn(`Firestore (${Vf}): ${n}`,...e)}}function GI(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function wt(n="Unexpected state"){const t=`FIRESTORE (${Vf}) INTERNAL ASSERTION FAILED: `+n;throw ws(t),new Error(t)}function an(n,t){n||wt()}function ft(n,t){return n}const be={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends Lc{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class pi{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class rK{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Fme{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e($i.UNAUTHENTICATED))}shutdown(){}}class Bme{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class $me{constructor(t){this.t=t,this.currentUser=$i.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var r=this;let s=this.i;const i=h=>this.i!==s?(s=this.i,e(h)):Promise.resolve();let o=new pi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new pi,t.enqueueRetryable(()=>i(this.currentUser))};const c=()=>{const h=o;t.enqueueRetryable(I(function*(){yield h.promise,yield i(r.currentUser)}))},u=h=>{We("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),c()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(We("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new pi)}},0),c()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(r=>this.i!==t?(We("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(an("string"==typeof r.accessToken),new rK(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return an(null===t||"string"==typeof t),new $i(t)}}class Ume{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s,this.type="FirstParty",this.user=$i.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(an(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Gme{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s}getToken(){return Promise.resolve(new Ume(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable(()=>e($i.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class sK{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qme{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const r=i=>{null!=i.error&&We("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,We("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{We("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?s(i):We("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(an("string"==typeof e.token),this.A=e.token,new sK(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Wme(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}class iK{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const s=Wme(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<e&&(r+=t.charAt(s[i]%t.length))}return r}}function En(n,t){return n<t?-1:n>t?1:0}function Ff(n,t,e){return n.length===t.length&&n.every((r,s)=>e(r,t[s]))}class es{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ue(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ue(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ue(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ue(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return es.fromMillis(Date.now())}static fromDate(t){return es.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*e));return new es(e,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?En(this.nanoseconds,t.nanoseconds):En(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class cn{constructor(t){this.timestamp=t}static fromTimestamp(t){return new cn(t)}static min(){return new cn(new es(0,0))}static max(){return new cn(new es(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class yg{constructor(t,e,r){void 0===e?e=0:e>t.length&&wt(),void 0===r?r=t.length-e:r>t.length-e&&wt(),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return 0===yg.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof yg?t.forEach(r=>{e.push(r)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let s=0;s<r;s++){const i=t.get(s),o=e.get(s);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class g1 extends yg{construct(t,e,r){return new g1(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new Ue(be.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter(s=>s.length>0))}return new g1(e)}static emptyPath(){return new g1([])}}const jme=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bs extends yg{construct(t,e,r){return new bs(t,e,r)}static isValidIdentifier(t){return jme.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bs.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new bs(["__name__"])}static fromServerFormat(t){const e=[];let r="",s=0;const i=()=>{if(0===r.length)throw new Ue(be.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let o=!1;for(;s<t.length;){const c=t[s];if("\\"===c){if(s+1===t.length)throw new Ue(be.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[s+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ue(be.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,s+=2}else"`"===c?(o=!o,s++):"."!==c||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new Ue(be.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new bs(e)}static emptyPath(){return new bs([])}}class at{constructor(t){this.path=t}static fromPath(t){return new at(g1.fromString(t))}static fromName(t){return new at(g1.fromString(t).popFirst(5))}static empty(){return new at(g1.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===g1.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return g1.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new at(new g1(t.slice()))}}function cK(n){return new Ya(n.readTime,n.key,-1)}class Ya{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new Ya(cn.min(),at.empty(),-1)}static max(){return new Ya(cn.max(),at.empty(),-1)}}function WI(n,t){let e=n.readTime.compareTo(t.readTime);return 0!==e?e:(e=at.comparator(n.documentKey,t.documentKey),0!==e?e:En(n.largestBatchId,t.largestBatchId))}const lK="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function V0(n){return jI.apply(this,arguments)}function jI(){return jI=I(function*(n){if(n.code!==be.FAILED_PRECONDITION||n.message!==lK)throw n;We("LocalStore","Unexpectedly lost primary lease")}),jI.apply(this,arguments)}class Me{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&wt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Me((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(e,i).next(r,s)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof Me?e:Me.resolve(e)}catch(e){return Me.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):Me.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):Me.reject(e)}static resolve(t){return new Me((e,r)=>{e(t)})}static reject(t){return new Me((e,r)=>{r(t)})}static waitFor(t){return new Me((e,r)=>{let s=0,i=0,o=!1;t.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&e()},u=>r(u))}),o=!0,i===s&&e()})}static or(t){let e=Me.resolve(!1);for(const r of t)e=e.next(s=>s?Me.resolve(s):r());return e}static forEach(t,e){const r=[];return t.forEach((s,i)=>{r.push(e.call(this,s,i))}),this.waitFor(r)}static mapArray(t,e){return new Me((r,s)=>{const i=t.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;e(t[h]).next(g=>{o[h]=g,++c,c===i&&r(o)},g=>s(g))}})}static doWhile(t,e){return new Me((r,s)=>{const i=()=>{!0===t()?e().next(()=>{i()},s):r()};i()})}}function H0(n){return"IndexedDbTransactionError"===n.name}class ga{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>e.writeSequenceNumber(r))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}function fK(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Qu(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function hK(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}ga.at=-1;class hs{constructor(t,e){this.comparator=t,this.root=e||O2.EMPTY}insert(t,e){return new hs(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,O2.BLACK,null,null))}remove(t){return new hs(this.comparator,this.root.remove(t,this.comparator).copy(null,null,O2.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(0===r)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(0===s)return e+r.left.size;s<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,r)=>(t(e,r),!1))}toString(){const t=[];return this.inorderTraversal((e,r)=>(t.push(`${e}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new pM(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new pM(this.root,t,this.comparator,!1)}getReverseIterator(){return new pM(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new pM(this.root,t,this.comparator,!0)}}class pM{constructor(t,e,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?r(t.key,e):1,e&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class O2{constructor(t,e,r,s,i){this.key=t,this.value=e,this.color=r??O2.RED,this.left=s??O2.EMPTY,this.right=i??O2.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,s,i){return new O2(t??this.key,e??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,r),null):0===i?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return O2.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return O2.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,O2.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,O2.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw wt();const t=this.left.check();if(t!==this.right.check())throw wt();return t+(this.isRed()?0:1)}}O2.EMPTY=null,O2.RED=!0,O2.BLACK=!1,O2.EMPTY=new class{constructor(){this.size=0}get key(){throw wt()}get value(){throw wt()}get color(){throw wt()}get left(){throw wt()}get right(){throw wt()}copy(n,t,e,r,s){return this}insert(n,t,e){return new O2(n,t)}remove(n,t){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class er{constructor(t){this.comparator=t,this.data=new hs(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,r)=>(t(e),!1))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let r;for(r=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new dK(this.data.getIterator())}getIteratorFrom(t){return new dK(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(r=>{e=e.add(r)}),e}isEqual(t){if(!(t instanceof er)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(0!==this.comparator(s,i))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new er(this.comparator);return e.data=t,e}}class dK{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ka{constructor(t){this.fields=t,t.sort(bs.comparator)}static empty(){return new Ka([])}unionWith(t){let e=new er(bs.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new Ka(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Ff(this.fields,t.fields,(e,r)=>e.isEqual(r))}}class gi{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new gi(e)}static fromUint8Array(t){const e=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(t);return new gi(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return En(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}gi.EMPTY_BYTE_STRING=new gi("");const t_e=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function F0(n){if(an(!!n),"string"==typeof n){let t=0;const e=t_e.exec(n);if(an(!!e),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:ds(n.seconds),nanos:ds(n.nanos)}}function ds(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Ju(n){return"string"==typeof n?gi.fromBase64String(n):gi.fromUint8Array(n)}function YI(n){var t,e;return"server_timestamp"===(null===(e=((null===(t=n?.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===e?void 0:e.stringValue)}function pK(n){const t=n.mapValue.fields.__previous_value__;return YI(t)?pK(t):t}function Sg(n){const t=F0(n.mapValue.fields.__local_write_time__.timestampValue);return new es(t.seconds,t.nanos)}class n_e{constructor(t,e,r,s,i,o,c,u){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.useFetchStreams=u}}class e5{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new e5("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof e5&&t.projectId===this.projectId&&t.database===this.database}}function Pg(n){return null==n}function Tg(n){return 0===n&&1/n==-1/0}const B0_mapValue={fields:{__type__:{stringValue:"__max__"}}};function t5(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?YI(n)?4:CK(n)?9007199254740991:10:wt()}function A4(n,t){if(n===t)return!0;const e=t5(n);if(e!==t5(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Sg(n).isEqual(Sg(t));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=F0(r.timestampValue),o=F0(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return s=t,Ju(n.bytesValue).isEqual(Ju(s.bytesValue));case 7:return n.referenceValue===t.referenceValue;case 8:return function(r,s){return ds(r.geoPointValue.latitude)===ds(s.geoPointValue.latitude)&&ds(r.geoPointValue.longitude)===ds(s.geoPointValue.longitude)}(n,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return ds(r.integerValue)===ds(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=ds(r.doubleValue),o=ds(s.doubleValue);return i===o?Tg(i)===Tg(o):isNaN(i)&&isNaN(o)}return!1}(n,t);case 9:return Ff(n.arrayValue.values||[],t.arrayValue.values||[],A4);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(fK(i)!==fK(o))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(void 0===o[c]||!A4(i[c],o[c])))return!1;return!0}(n,t);default:return wt()}var s}function wg(n,t){return void 0!==(n.values||[]).find(e=>A4(e,t))}function $0(n,t){if(n===t)return 0;const e=t5(n),r=t5(t);if(e!==r)return En(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return En(n.booleanValue,t.booleanValue);case 2:return function(s,i){const o=ds(s.integerValue||s.doubleValue),c=ds(i.integerValue||i.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(n,t);case 3:return mK(n.timestampValue,t.timestampValue);case 4:return mK(Sg(n),Sg(t));case 5:return En(n.stringValue,t.stringValue);case 6:return function(s,i){const o=Ju(s),c=Ju(i);return o.compareTo(c)}(n.bytesValue,t.bytesValue);case 7:return function(s,i){const o=s.split("/"),c=i.split("/");for(let u=0;u<o.length&&u<c.length;u++){const h=En(o[u],c[u]);if(0!==h)return h}return En(o.length,c.length)}(n.referenceValue,t.referenceValue);case 8:return function(s,i){const o=En(ds(s.latitude),ds(i.latitude));return 0!==o?o:En(ds(s.longitude),ds(i.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(s,i){const o=s.values||[],c=i.values||[];for(let u=0;u<o.length&&u<c.length;++u){const h=$0(o[u],c[u]);if(h)return h}return En(o.length,c.length)}(n.arrayValue,t.arrayValue);case 10:return function(s,i){if(s===B0_mapValue&&i===B0_mapValue)return 0;if(s===B0_mapValue)return 1;if(i===B0_mapValue)return-1;const o=s.fields||{},c=Object.keys(o),u=i.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let g=0;g<c.length&&g<h.length;++g){const m=En(c[g],h[g]);if(0!==m)return m;const E=$0(o[c[g]],u[h[g]]);if(0!==E)return E}return En(c.length,h.length)}(n.mapValue,t.mapValue);default:throw wt()}}function mK(n,t){if("string"==typeof n&&"string"==typeof t&&n.length===t.length)return En(n,t);const e=F0(n),r=F0(t),s=En(e.seconds,r.seconds);return 0!==s?s:En(e.nanos,r.nanos)}function $f(n){return KI(n)}function KI(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const s=F0(r);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Ju(n.bytesValue).toBase64():"referenceValue"in n?at.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(t=n.geoPointValue).latitude},${t.longitude})`:"arrayValue"in n?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=KI(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of s)o?o=!1:i+=",",i+=`${c}:${KI(r.fields[c])}`;return i+"}"}(n.mapValue):wt();var t}function n5(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function XI(n){return!!n&&"integerValue"in n}function bg(n){return!!n&&"arrayValue"in n}function _K(n){return!!n&&"nullValue"in n}function vK(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function mM(n){return!!n&&"mapValue"in n}function Og(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return Qu(n.mapValue.fields,(e,r)=>t.mapValue.fields[e]=Og(r)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Og(n.arrayValue.values[e]);return t}return Object.assign({},n)}function CK(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}class A2{constructor(t){this.value=t}static empty(){return new A2({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!mM(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Og(e)}setAll(t){let e=bs.emptyPath(),r={},s=[];t.forEach((o,c)=>{if(!e.isImmediateParentOf(c)){const u=this.getFieldsMap(e);this.applyChanges(u,r,s),r={},s=[],e=c.popLast()}o?r[c.lastSegment()]=Og(o):s.push(c.lastSegment())});const i=this.getFieldsMap(e);this.applyChanges(i,r,s)}delete(t){const e=this.field(t.popLast());mM(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return A4(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=e.mapValue.fields[t.get(r)];mM(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,r){Qu(e,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new A2(Og(this.value))}}function MK(n){const t=[];return Qu(n.fields,(e,r)=>{const s=new bs([e]);if(mM(r)){const i=MK(r.mapValue).fields;if(0===i.length)t.push(s);else for(const o of i)t.push(s.child(o))}else t.push(s)}),new Ka(t)}class pr{constructor(t,e,r,s,i,o){this.key=t,this.documentType=e,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(t){return new pr(t,0,cn.min(),cn.min(),A2.empty(),0)}static newFoundDocument(t,e,r){return new pr(t,1,e,cn.min(),r,0)}static newNoDocument(t,e){return new pr(t,2,e,cn.min(),A2.empty(),0)}static newUnknownDocument(t,e){return new pr(t,3,e,cn.min(),A2.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=A2.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=A2.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=cn.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof pr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new pr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class i_e{constructor(t,e=null,r=[],s=[],i=null,o=null,c=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ht=null}}function SK(n,t=null,e=[],r=[],s=null,i=null,o=null){return new i_e(n,t,e,r,s,i,o)}function r5(n){const t=ft(n);if(null===t.ht){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+$f(s.value);var s}).join(","),e+="|ob:",e+=t.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),Pg(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(r=>$f(r)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(r=>$f(r)).join(",")),t.ht=e}return t.ht}function Ag(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!p_e(n.orderBy[s],t.orderBy[s]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if((e=n.filters[s]).op!==(r=t.filters[s]).op||!e.field.isEqual(r.field)||!A4(e.value,r.value))return!1;var e,r;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!OK(n.startAt,t.startAt)&&OK(n.endAt,t.endAt)}function _M(n){return at.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class N2 extends class{}{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.lt(t,e,r):new a_e(t,e,r):"array-contains"===e?new u_e(t,r):"in"===e?new f_e(t,r):"not-in"===e?new h_e(t,r):"array-contains-any"===e?new d_e(t,r):new N2(t,e,r)}static lt(t,e,r){return"in"===e?new c_e(t,r):new l_e(t,r)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.ft($0(e,this.value)):null!==e&&t5(this.value)===t5(e)&&this.ft($0(e,this.value))}ft(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return wt()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class a_e extends N2{constructor(t,e,r){super(t,e,r),this.key=at.fromName(r.referenceValue)}matches(t){const e=at.comparator(t.key,this.key);return this.ft(e)}}class c_e extends N2{constructor(t,e){super(t,"in",e),this.keys=wK(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class l_e extends N2{constructor(t,e){super(t,"not-in",e),this.keys=wK(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function wK(n,t){var e;return((null===(e=t.arrayValue)||void 0===e?void 0:e.values)||[]).map(r=>at.fromName(r.referenceValue))}class u_e extends N2{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return bg(e)&&wg(e.arrayValue,this.value)}}class f_e extends N2{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&wg(this.value.arrayValue,e)}}class h_e extends N2{constructor(t,e){super(t,"not-in",e)}matches(t){if(wg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!wg(this.value.arrayValue,e)}}class d_e extends N2{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!bg(e)||!e.arrayValue.values)&&e.arrayValue.values.some(r=>wg(this.value.arrayValue,r))}}class U0{constructor(t,e){this.position=t,this.inclusive=e}}class Uf{constructor(t,e="asc"){this.field=t,this.dir=e}}function p_e(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}function bK(n,t,e){let r=0;for(let s=0;s<n.position.length;s++){const i=t[s],o=n.position[s];if(r=i.field.isKeyField()?at.comparator(at.fromName(o.referenceValue),e.key):$0(o,e.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function OK(n,t){if(null===n)return null===t;if(null===t||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!A4(n.position[e],t.position[e]))return!1;return!0}class Yl{constructor(t,e=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this._t=null,this.wt=null}}function Gf(n){return new Yl(n)}function NK(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function QI(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function JI(n){for(const t of n.filters)if(t.dt())return t.field;return null}function ex(n){return null!==n.collectionGroup}function qf(n){const t=ft(n);if(null===t._t){t._t=[];const e=JI(t),r=QI(t);if(null!==e&&null===r)e.isKeyField()||t._t.push(new Uf(e)),t._t.push(new Uf(bs.keyField(),"asc"));else{let s=!1;for(const i of t.explicitOrderBy)t._t.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new Uf(bs.keyField(),i))}}}return t._t}function Ro(n){const t=ft(n);if(!t.wt)if("F"===t.limitType)t.wt=SK(t.path,t.collectionGroup,qf(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of qf(t))e.push(new Uf(i.field,"desc"===i.dir?"asc":"desc"));const r=t.endAt?new U0(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new U0(t.startAt.position,t.startAt.inclusive):null;t.wt=SK(t.path,t.collectionGroup,e,t.filters,t.limit,r,s)}return t.wt}function CM(n,t,e){return new Yl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Ng(n,t){return Ag(Ro(n),Ro(t))&&n.limitType===t.limitType}function IK(n){return`${r5(Ro(n))}|lt:${n.limitType}`}function tx(n){return`Query(target=${function o_e(n){let t=n.path.canonicalString();return null!==n.collectionGroup&&(t+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(t+=`, filters: [${n.filters.map(e=>{return`${(r=e).field.canonicalString()} ${r.op} ${$f(r.value)}`;var r}).join(", ")}]`),Pg(n.limit)||(t+=", limit: "+n.limit),n.orderBy.length>0&&(t+=`, orderBy: [${n.orderBy.map(e=>{return`${(r=e).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(t+=", startAt: ",t+=n.startAt.inclusive?"b:":"a:",t+=n.startAt.position.map(e=>$f(e)).join(",")),n.endAt&&(t+=", endAt: ",t+=n.endAt.inclusive?"a:":"b:",t+=n.endAt.position.map(e=>$f(e)).join(",")),`Target(${t})`}(Ro(n))}; limitType=${n.limitType})`}function nx(n,t){return t.isFoundDocument()&&function(e,r){const s=r.key.path;return null!==e.collectionGroup?r.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(s):at.isDocumentKey(e.path)?e.path.isEqual(s):e.path.isImmediateParentOf(s)}(n,t)&&function(e,r){for(const s of e.explicitOrderBy)if(!s.field.isKeyField()&&null===r.data.field(s.field))return!1;return!0}(n,t)&&function(e,r){for(const s of e.filters)if(!s.matches(r))return!1;return!0}(n,t)&&(r=t,!((e=n).startAt&&!function(s,i,o){const c=bK(s,i,o);return s.inclusive?c<=0:c<0}(e.startAt,qf(e),r)||e.endAt&&!function(s,i,o){const c=bK(s,i,o);return s.inclusive?c>=0:c>0}(e.endAt,qf(e),r)));var e,r}function kK(n){return(t,e)=>{let r=!1;for(const s of qf(n)){const i=g_e(s,t,e);if(0!==i)return i;r=r||s.field.isKeyField()}return 0}}function g_e(n,t,e){const r=n.field.isKeyField()?at.comparator(t.key,e.key):function(s,i,o){const c=i.data.field(s),u=o.data.field(s);return null!==c&&null!==u?$0(c,u):wt()}(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return wt()}}function LK(n,t){if(n.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Tg(t)?"-0":t}}function RK(n){return{integerValue:""+n}}function DK(n,t){return function gK(n){return"number"==typeof n&&Number.isInteger(n)&&!Tg(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}(t)?RK(t):LK(n,t)}class yM{constructor(){this._=void 0}}function m_e(n,t,e){return n instanceof Wf?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(e,t):n instanceof s5?VK(n,t):n instanceof i5?HK(n,t):function(r,s){const i=zK(r,s),o=FK(i)+FK(r.yt);return XI(i)&&XI(r.yt)?RK(o):LK(r.It,o)}(n,t)}function __e(n,t,e){return n instanceof s5?VK(n,t):n instanceof i5?HK(n,t):e}function zK(n,t){return n instanceof jf?XI(e=t)||(r=e)&&"doubleValue"in r?t:{integerValue:0}:null;var r,e}class Wf extends yM{}class s5 extends yM{constructor(t){super(),this.elements=t}}function VK(n,t){const e=BK(t);for(const r of n.elements)e.some(s=>A4(s,r))||e.push(r);return{arrayValue:{values:e}}}class i5 extends yM{constructor(t){super(),this.elements=t}}function HK(n,t){let e=BK(t);for(const r of n.elements)e=e.filter(s=>!A4(s,r));return{arrayValue:{values:e}}}class jf extends yM{constructor(t,e){super(),this.It=t,this.yt=e}}function FK(n){return ds(n.integerValue||n.doubleValue)}function BK(n){return bg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Ig{constructor(t,e){this.field=t,this.transform=e}}class C_e{constructor(t,e){this.version=t,this.transformResults=e}}class $r{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new $r}static exists(t){return new $r(void 0,t)}static updateTime(t){return new $r(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function EM(n,t){return void 0!==n.updateTime?t.isFoundDocument()&&t.version.isEqual(n.updateTime):void 0===n.exists||n.exists===t.isFoundDocument()}class MM{}function $K(n,t){if(!n.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return n.isNoDocument()?new Yf(n.key,$r.none()):new Zf(n.key,n.data,$r.none());{const e=n.data,r=A2.empty();let s=new er(bs.comparator);for(let i of t.fields)if(!s.has(i)){let o=e.field(i);null===o&&i.length>1&&(i=i.popLast(),o=e.field(i)),null===o?r.delete(i):r.set(i,o),s=s.add(i)}return new Kl(n.key,r,new Ka(s.toArray()),$r.none())}}function y_e(n,t,e){n instanceof Zf?function(r,s,i){const o=r.value.clone(),c=qK(r.fieldTransforms,s,i.transformResults);o.setAll(c),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,t,e):n instanceof Kl?function(r,s,i){if(!EM(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=qK(r.fieldTransforms,s,i.transformResults),c=s.data;c.setAll(GK(r)),c.setAll(o),s.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(n,t,e):t.convertToNoDocument(e.version).setHasCommittedMutations()}function xg(n,t,e,r){return n instanceof Zf?function(s,i,o,c){if(!EM(s.precondition,i))return o;const u=s.value.clone(),h=WK(s.fieldTransforms,c,i);return u.setAll(h),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(n,t,e,r):n instanceof Kl?function(s,i,o,c){if(!EM(s.precondition,i))return o;const u=WK(s.fieldTransforms,c,i),h=i.data;return h.setAll(GK(s)),h.setAll(u),i.convertToFoundDocument(i.version,h).setHasLocalMutations(),null===o?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,t,e,r):(o=e,EM(n.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o);var i,o}function E_e(n,t){let e=null;for(const r of n.fieldTransforms){const s=t.data.field(r.field),i=zK(r.transform,s||null);null!=i&&(null===e&&(e=A2.empty()),e.set(r.field,i))}return e||null}function UK(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(e=n.fieldTransforms)&&void 0===r||e&&r&&Ff(e,r,(s,i)=>function v_e(n,t){return n.field.isEqual(t.field)&&(r=t.transform,(e=n.transform)instanceof s5&&r instanceof s5||e instanceof i5&&r instanceof i5?Ff(e.elements,r.elements,A4):e instanceof jf&&r instanceof jf?A4(e.yt,r.yt):e instanceof Wf&&r instanceof Wf);var e,r}(s,i))))&&(0===n.type?n.value.isEqual(t.value):1!==n.type||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask));var e,r}class Zf extends MM{constructor(t,e,r,s=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Kl extends MM{constructor(t,e,r,s,i=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function GK(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}}),t}function qK(n,t,e){const r=new Map;an(n.length===e.length);for(let s=0;s<e.length;s++){const i=n[s],o=i.transform,c=t.data.field(i.field);r.set(i.field,__e(o,c,e[s]))}return r}function WK(n,t,e){const r=new Map;for(const s of n){const i=s.transform,o=e.data.field(s.field);r.set(s.field,m_e(i,o,t))}return r}class Yf extends MM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class rx extends MM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class M_e{constructor(t){this.count=t}}var Ws,m1;function jK(n){switch(n){default:return wt();case be.CANCELLED:case be.UNKNOWN:case be.DEADLINE_EXCEEDED:case be.RESOURCE_EXHAUSTED:case be.INTERNAL:case be.UNAVAILABLE:case be.UNAUTHENTICATED:return!1;case be.INVALID_ARGUMENT:case be.NOT_FOUND:case be.ALREADY_EXISTS:case be.PERMISSION_DENIED:case be.FAILED_PRECONDITION:case be.ABORTED:case be.OUT_OF_RANGE:case be.UNIMPLEMENTED:case be.DATA_LOSS:return!0}}function ZK(n){if(void 0===n)return ws("GRPC error has no .code"),be.UNKNOWN;switch(n){case Ws.OK:return be.OK;case Ws.CANCELLED:return be.CANCELLED;case Ws.UNKNOWN:return be.UNKNOWN;case Ws.DEADLINE_EXCEEDED:return be.DEADLINE_EXCEEDED;case Ws.RESOURCE_EXHAUSTED:return be.RESOURCE_EXHAUSTED;case Ws.INTERNAL:return be.INTERNAL;case Ws.UNAVAILABLE:return be.UNAVAILABLE;case Ws.UNAUTHENTICATED:return be.UNAUTHENTICATED;case Ws.INVALID_ARGUMENT:return be.INVALID_ARGUMENT;case Ws.NOT_FOUND:return be.NOT_FOUND;case Ws.ALREADY_EXISTS:return be.ALREADY_EXISTS;case Ws.PERMISSION_DENIED:return be.PERMISSION_DENIED;case Ws.FAILED_PRECONDITION:return be.FAILED_PRECONDITION;case Ws.ABORTED:return be.ABORTED;case Ws.OUT_OF_RANGE:return be.OUT_OF_RANGE;case Ws.UNIMPLEMENTED:return be.UNIMPLEMENTED;case Ws.DATA_LOSS:return be.DATA_LOSS;default:return wt()}}(m1=Ws||(Ws={}))[m1.OK=0]="OK",m1[m1.CANCELLED=1]="CANCELLED",m1[m1.UNKNOWN=2]="UNKNOWN",m1[m1.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",m1[m1.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",m1[m1.NOT_FOUND=5]="NOT_FOUND",m1[m1.ALREADY_EXISTS=6]="ALREADY_EXISTS",m1[m1.PERMISSION_DENIED=7]="PERMISSION_DENIED",m1[m1.UNAUTHENTICATED=16]="UNAUTHENTICATED",m1[m1.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",m1[m1.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",m1[m1.ABORTED=10]="ABORTED",m1[m1.OUT_OF_RANGE=11]="OUT_OF_RANGE",m1[m1.UNIMPLEMENTED=12]="UNIMPLEMENTED",m1[m1.INTERNAL=13]="INTERNAL",m1[m1.UNAVAILABLE=14]="UNAVAILABLE",m1[m1.DATA_LOSS=15]="DATA_LOSS";class G0{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0!==r)for(const[s,i]of r)if(this.equalsFn(s,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const r=this.mapKeyFn(t),s=this.inner[r];if(void 0===s)return this.inner[r]=[[t,e]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0===r)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return 1===r.length?delete this.inner[e]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Qu(this.inner,(e,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return hK(this.inner)}size(){return this.innerSize}}const S_e=new hs(at.comparator);function ma(){return S_e}const YK=new hs(at.comparator);function kg(...n){let t=YK;for(const e of n)t=t.insert(e.key,e);return t}function KK(n){let t=YK;return n.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function N4(){return Lg()}function XK(){return Lg()}function Lg(){return new G0(n=>n.toString(),(n,t)=>n.isEqual(t))}const P_e=new hs(at.comparator),T_e=new er(at.comparator);function Ln(...n){let t=T_e;for(const e of n)t=t.add(e);return t}const w_e=new er(En);function SM(){return w_e}class Rg{constructor(t,e,r,s,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const s=new Map;return s.set(t,Dg.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new Rg(cn.min(),s,SM(),ma(),Ln())}}class Dg{constructor(t,e,r,s,i){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new Dg(r,e,Ln(),Ln(),Ln())}}class PM{constructor(t,e,r,s){this.Tt=t,this.removedTargetIds=e,this.key=r,this.Et=s}}class QK{constructor(t,e){this.targetId=t,this.At=e}}class JK{constructor(t,e,r=gi.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=s}}class eX{constructor(){this.Rt=0,this.bt=nX(),this.Pt=gi.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(t){t.approximateByteSize()>0&&(this.Vt=!0,this.Pt=t)}xt(){let t=Ln(),e=Ln(),r=Ln();return this.bt.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:r=r.add(s);break;default:wt()}}),new Dg(this.Pt,this.vt,t,e,r)}Nt(){this.Vt=!1,this.bt=nX()}kt(t,e){this.Vt=!0,this.bt=this.bt.insert(t,e)}Ot(t){this.Vt=!0,this.bt=this.bt.remove(t)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class b_e{constructor(t){this.Bt=t,this.Lt=new Map,this.Ut=ma(),this.qt=tX(),this.Kt=new er(En)}Gt(t){for(const e of t.Tt)t.Et&&t.Et.isFoundDocument()?this.Qt(e,t.Et):this.jt(e,t.key,t.Et);for(const e of t.removedTargetIds)this.jt(e,t.key,t.Et)}Wt(t){this.forEachTarget(t,e=>{const r=this.zt(e);switch(t.state){case 0:this.Ht(e)&&r.Ct(t.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(t.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(e);break;case 3:this.Ht(e)&&(r.$t(),r.Ct(t.resumeToken));break;case 4:this.Ht(e)&&(this.Jt(e),r.Ct(t.resumeToken));break;default:wt()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Lt.forEach((r,s)=>{this.Ht(s)&&e(s)})}Yt(t){const e=t.targetId,r=t.At.count,s=this.Xt(e);if(s){const i=s.target;if(_M(i))if(0===r){const o=new at(i.path);this.jt(e,o,pr.newNoDocument(o,cn.min()))}else an(1===r);else this.Zt(e)!==r&&(this.Jt(e),this.Kt=this.Kt.add(e))}}te(t){const e=new Map;this.Lt.forEach((i,o)=>{const c=this.Xt(o);if(c){if(i.current&&_M(c.target)){const u=new at(c.target.path);null!==this.Ut.get(u)||this.ee(o,u)||this.jt(o,u,pr.newNoDocument(u,t))}i.Dt&&(e.set(o,i.xt()),i.Nt())}});let r=Ln();this.qt.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Xt(u);return!h||2===h.purpose||(c=!1,!1)}),c&&(r=r.add(i))}),this.Ut.forEach((i,o)=>o.setReadTime(t));const s=new Rg(t,e,this.Kt,this.Ut,r);return this.Ut=ma(),this.qt=tX(),this.Kt=new er(En),s}Qt(t,e){if(!this.Ht(t))return;const r=this.ee(t,e.key)?2:0;this.zt(t).kt(e.key,r),this.Ut=this.Ut.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ne(e.key).add(t))}jt(t,e,r){if(!this.Ht(t))return;const s=this.zt(t);this.ee(t,e)?s.kt(e,1):s.Ot(e),this.qt=this.qt.insert(e,this.ne(e).delete(t)),r&&(this.Ut=this.Ut.insert(e,r))}removeTarget(t){this.Lt.delete(t)}Zt(t){const e=this.zt(t).xt();return this.Bt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Mt(t){this.zt(t).Mt()}zt(t){let e=this.Lt.get(t);return e||(e=new eX,this.Lt.set(t,e)),e}ne(t){let e=this.qt.get(t);return e||(e=new er(En),this.qt=this.qt.insert(t,e)),e}Ht(t){const e=null!==this.Xt(t);return e||We("WatchChangeAggregator","Detected inactive target",t),e}Xt(t){const e=this.Lt.get(t);return e&&e.St?null:this.Bt.se(t)}Jt(t){this.Lt.set(t,new eX),this.Bt.getRemoteKeysForTarget(t).forEach(e=>{this.jt(t,e,null)})}ee(t,e){return this.Bt.getRemoteKeysForTarget(t).has(e)}}function tX(){return new hs(at.comparator)}function nX(){return new hs(at.comparator)}const O_e={asc:"ASCENDING",desc:"DESCENDING"},A_e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class N_e{constructor(t,e){this.databaseId=t,this.gt=e}}function zg(n,t){return n.gt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function rX(n,t){return n.gt?t.toBase64():t.toUint8Array()}function I_e(n,t){return zg(n,t.toTimestamp())}function Ui(n){return an(!!n),cn.fromTimestamp(function(t){const e=F0(t);return new es(e.seconds,e.nanos)}(n))}function sx(n,t){return(e=n,new g1(["projects",e.projectId,"databases",e.database])).child("documents").child(t).canonicalString();var e}function sX(n){const t=g1.fromString(n);return an(hX(t)),t}function Vg(n,t){return sx(n.databaseId,t.path)}function I4(n,t){const e=sX(t);if(e.get(1)!==n.databaseId.projectId)throw new Ue(be.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new Ue(be.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new at(oX(e))}function ix(n,t){return sx(n.databaseId,t)}function Hg(n){return new g1(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function oX(n){return an(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function aX(n,t,e){return{name:Vg(n,t),fields:e.value.mapValue.fields}}function lX(n,t){return{documents:[ix(n,t.path)]}}function ax(n,t){const e={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(e.parent=ix(n,r),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=ix(n,r.popLast()),e.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(u){if(0===u.length)return;const h=u.map(g=>function(m){if("=="===m.op){if(vK(m.value))return{unaryFilter:{field:Kf(m.field),op:"IS_NAN"}};if(_K(m.value))return{unaryFilter:{field:Kf(m.field),op:"IS_NULL"}}}else if("!="===m.op){if(vK(m.value))return{unaryFilter:{field:Kf(m.field),op:"IS_NOT_NAN"}};if(_K(m.value))return{unaryFilter:{field:Kf(m.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Kf(m.field),op:z_e(m.op),value:m.value}}}(g));return 1===h.length?h[0]:{compositeFilter:{op:"AND",filters:h}}}(t.filters);s&&(e.structuredQuery.where=s);const i=function(u){if(0!==u.length)return u.map(h=>{return{field:Kf((g=h).field),direction:D_e(g.dir)};var g})}(t.orderBy);i&&(e.structuredQuery.orderBy=i);const o=(h=t.limit,n.gt||Pg(h)?h:{value:h});var h,c,u;return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt={before:(c=t.startAt).inclusive,values:c.position}),t.endAt&&(e.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),e}function uX(n){let t=function iX(n){const t=sX(n);return 4===t.length?g1.emptyPath():oX(t)}(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let s=null;if(r>0){an(1===r);const g=e.from[0];g.allDescendants?s=g.collectionId:t=t.child(g.collectionId)}let i=[];e.where&&(i=fX(e.where));let o=[];e.orderBy&&(o=e.orderBy.map(g=>{return new Uf(Xf((m=g).field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction));var m}));let c=null;e.limit&&(c=function(g){let m;return m="object"==typeof g?g.value:g,Pg(m)?null:m}(e.limit));let u=null;var g;e.startAt&&(u=new U0((g=e.startAt).values||[],!!g.before));let h=null;return e.endAt&&(h=function(g){return new U0(g.values||[],!g.before)}(e.endAt)),function AK(n,t,e,r,s,i,o,c){return new Yl(n,t,e,r,s,i,o,c)}(t,s,o,i,c,"F",u,h)}function fX(n){return n?void 0!==n.unaryFilter?[H_e(n)]:void 0!==n.fieldFilter?[V_e(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(t=>fX(t)).reduce((t,e)=>t.concat(e)):wt():[]}function D_e(n){return O_e[n]}function z_e(n){return A_e[n]}function Kf(n){return{fieldPath:n.canonicalString()}}function Xf(n){return bs.fromServerFormat(n.fieldPath)}function V_e(n){return N2.create(Xf(n.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return wt()}}(n.fieldFilter.op),n.fieldFilter.value)}function H_e(n){switch(n.unaryFilter.op){case"IS_NAN":const t=Xf(n.unaryFilter.field);return N2.create(t,"==",{doubleValue:NaN});case"IS_NULL":const e=Xf(n.unaryFilter.field);return N2.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Xf(n.unaryFilter.field);return N2.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Xf(n.unaryFilter.field);return N2.create(s,"!=",{nullValue:"NULL_VALUE"});default:return wt()}}function F_e(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function hX(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class lx{constructor(t,e,r,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&y_e(i,t,r[s])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=xg(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=xg(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=XK();return this.mutations.forEach(s=>{const i=t.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=e.has(s.key)?null:c;const u=$K(o,c);null!==u&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(cn.min())}),r}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),Ln())}isEqual(t){return this.batchId===t.batchId&&Ff(this.mutations,t.mutations,(e,r)=>UK(e,r))&&Ff(this.baseMutations,t.baseMutations,(e,r)=>UK(e,r))}}class ux{constructor(t,e,r,s){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=s}static from(t,e,r){an(t.mutations.length===r.length);let s=P_e;const i=t.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new ux(t,e,r,s)}}class fx{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class q0{constructor(t,e,r,s,i=cn.min(),o=cn.min(),c=gi.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c}withSequenceNumber(t){return new q0(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new q0(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new q0(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class CX{constructor(t){this.re=t}}function hx(n){const t=uX({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?CM(t,t.limit,"L"):t}class l5{constructor(){}ce(t,e){this.ae(t,e),e.he()}ae(t,e){if("nullValue"in t)this.le(e,5);else if("booleanValue"in t)this.le(e,10),e.fe(t.booleanValue?1:0);else if("integerValue"in t)this.le(e,15),e.fe(ds(t.integerValue));else if("doubleValue"in t){const r=ds(t.doubleValue);isNaN(r)?this.le(e,13):(this.le(e,15),Tg(r)?e.fe(0):e.fe(r))}else if("timestampValue"in t){const r=t.timestampValue;this.le(e,20),"string"==typeof r?e.de(r):(e.de(`${r.seconds||""}`),e.fe(r.nanos||0))}else if("stringValue"in t)this._e(t.stringValue,e),this.we(e);else if("bytesValue"in t)this.le(e,30),e.me(Ju(t.bytesValue)),this.we(e);else if("referenceValue"in t)this.ge(t.referenceValue,e);else if("geoPointValue"in t){const r=t.geoPointValue;this.le(e,45),e.fe(r.latitude||0),e.fe(r.longitude||0)}else"mapValue"in t?CK(t)?this.le(e,Number.MAX_SAFE_INTEGER):(this.ye(t.mapValue,e),this.we(e)):"arrayValue"in t?(this.pe(t.arrayValue,e),this.we(e)):wt()}_e(t,e){this.le(e,25),this.Ie(t,e)}Ie(t,e){e.de(t)}ye(t,e){const r=t.fields||{};this.le(e,55);for(const s of Object.keys(r))this._e(s,e),this.ae(r[s],e)}pe(t,e){const r=t.values||[];this.le(e,50);for(const s of r)this.ae(s,e)}ge(t,e){this.le(e,37),at.fromName(t).path.forEach(r=>{this.le(e,60),this.Ie(r,e)})}le(t,e){t.fe(e)}we(t){t.fe(2)}}l5.Te=new l5;class hve{constructor(){this.Ye=new px}addToCollectionParentIndex(t,e){return this.Ye.add(e),Me.resolve()}getCollectionParents(t,e){return Me.resolve(this.Ye.getEntries(e))}addFieldIndex(t,e){return Me.resolve()}deleteFieldIndex(t,e){return Me.resolve()}getDocumentsMatchingTarget(t,e){return Me.resolve(null)}getIndexType(t,e){return Me.resolve(0)}getFieldIndexes(t,e){return Me.resolve([])}getNextCollectionGroupToUpdate(t){return Me.resolve(null)}getMinOffset(t,e){return Me.resolve(Ya.min())}getMinOffsetFromCollectionGroup(t,e){return Me.resolve(Ya.min())}updateCollectionGroup(t,e,r){return Me.resolve()}updateIndexEntries(t,e){return Me.resolve()}}class px{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e]||new er(g1.comparator),i=!s.has(r);return this.index[e]=s.add(r),i}has(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e];return s&&s.has(r)}getEntries(t){return(this.index[t]||new er(g1.comparator)).toArray()}}new Uint8Array(0);class _a{constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}static withCacheSize(t){return new _a(t,_a.DEFAULT_COLLECTION_PERCENTILE,_a.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}_a.DEFAULT_COLLECTION_PERCENTILE=10,_a.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_a.DEFAULT=new _a(41943040,_a.DEFAULT_COLLECTION_PERCENTILE,_a.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_a.DISABLED=new _a(-1,0,0);class h5{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new h5(0)}static vn(){return new h5(-1)}}class Mve{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class FX{constructor(t,e,r,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next(s=>(r=s,this.getBaseDocument(t,e,r))).next(s=>(null!==r&&xg(r.mutation,s,Ka.empty(),es.now()),s))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.getLocalViewOfDocuments(t,r,Ln()).next(()=>r))}getLocalViewOfDocuments(t,e,r=Ln()){const s=N4();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,r).next(i=>{let o=kg();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const r=N4();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,Ln()))}populateOverlays(t,e,r){const s=[];return r.forEach(i=>{e.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((o,c)=>{e.set(o,c)})})}computeViews(t,e,r,s){let i=ma();const o=Lg(),c=Lg();return e.forEach((u,h)=>{const g=r.get(h.key);s.has(h.key)&&(void 0===g||g.mutation instanceof Kl)?i=i.insert(h.key,h):void 0!==g&&(o.set(h.key,g.mutation.getFieldMask()),xg(g.mutation,h,g.mutation.getFieldMask(),es.now()))}),this.recalculateAndSaveOverlays(t,i).next(u=>(u.forEach((h,g)=>o.set(h,g)),e.forEach((h,g)=>{var m;return c.set(h,new Mve(g,null!==(m=o.get(h))&&void 0!==m?m:null))}),c))}recalculateAndSaveOverlays(t,e){const r=Lg();let s=new hs((o,c)=>o-c),i=Ln();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=e.get(u);if(null===h)return;let g=r.get(u)||Ka.empty();g=c.applyToLocalView(h,g),r.set(u,g);const m=(s.get(c.batchId)||Ln()).add(u);s=s.insert(c.batchId,m)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,g=u.value,m=XK();g.forEach(E=>{if(!i.has(E)){const b=$K(e.get(E),r.get(E));null!==b&&m.set(E,b),i=i.add(E)}}),o.push(this.documentOverlayCache.saveOverlays(t,h,m))}return Me.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,e,r){return at.isDocumentKey((s=e).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):ex(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r):this.getDocumentsMatchingCollectionQuery(t,e,r);var s}getNextDocuments(t,e,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,s-i.size):Me.resolve(N4());let c=-1,u=i;return o.next(h=>Me.forEach(h,(g,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(g)?Me.resolve():this.getBaseDocument(t,g,m).next(E=>{u=u.insert(g,E)}))).next(()=>this.populateOverlays(t,h,i)).next(()=>this.computeViews(t,u,h,Ln())).next(g=>({batchId:c,changes:KK(g)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new at(e)).next(r=>{let s=kg();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,e,r){const s=e.collectionGroup;let i=kg();return this.indexManager.getCollectionParents(t,s).next(o=>Me.forEach(o,c=>{const u=(h=e,g=c.child(s),new Yl(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,g;return this.getDocumentsMatchingCollectionQuery(t,u,r).next(h=>{h.forEach((g,m)=>{i=i.insert(g,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,e,r){let s;return this.remoteDocumentCache.getAllFromCollection(t,e.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId))).next(i=>{i.forEach((c,u)=>{const h=u.getKey();null===s.get(h)&&(s=s.insert(h,pr.newInvalidDocument(h)))});let o=kg();return s.forEach((c,u)=>{const h=i.get(c);void 0!==h&&xg(h.mutation,u,Ka.empty(),es.now()),nx(e,u)&&(o=o.insert(c,u))}),o})}getBaseDocument(t,e,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(t,e):Me.resolve(pr.newInvalidDocument(e))}}class Sve{constructor(t){this.It=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return Me.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var r;return this.Zn.set(e.id,{id:(r=e).id,version:r.version,createTime:Ui(r.createTime)}),Me.resolve()}getNamedQuery(t,e){return Me.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,{name:(r=e).name,query:hx(r.bundledQuery),readTime:Ui(r.readTime)}),Me.resolve();var r}}class Pve{constructor(){this.overlays=new hs(at.comparator),this.es=new Map}getOverlay(t,e){return Me.resolve(this.overlays.get(e))}getOverlays(t,e){const r=N4();return Me.forEach(e,s=>this.getOverlay(t,s).next(i=>{null!==i&&r.set(s,i)})).next(()=>r)}saveOverlays(t,e,r){return r.forEach((s,i)=>{this.ue(t,e,i)}),Me.resolve()}removeOverlaysForBatchId(t,e,r){const s=this.es.get(r);return void 0!==s&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.es.delete(r)),Me.resolve()}getOverlaysForCollection(t,e,r){const s=N4(),i=e.length+1,o=new at(e.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!e.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return Me.resolve(s)}getOverlaysForCollectionGroup(t,e,r,s){let i=new hs((h,g)=>h-g);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===e&&h.largestBatchId>r){let g=i.get(h.largestBatchId);null===g&&(g=N4(),i=i.insert(h.largestBatchId,g)),g.set(h.getKey(),h)}}const c=N4(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,g)=>c.set(h,g)),!(c.size()>=s)););return Me.resolve(c)}ue(t,e,r){const s=this.overlays.get(r.key);if(null!==s){const o=this.es.get(s.largestBatchId).delete(r.key);this.es.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new fx(e,r));let i=this.es.get(e);void 0===i&&(i=Ln(),this.es.set(e,i)),this.es.set(e,i.add(r.key))}}class gx{constructor(){this.ns=new er(qi.ss),this.rs=new er(qi.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const r=new qi(t,e);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(t,e){t.forEach(r=>this.addReference(r,e))}removeReference(t,e){this.cs(new qi(t,e))}hs(t,e){t.forEach(r=>this.removeReference(r,e))}ls(t){const e=new at(new g1([])),r=new qi(e,t),s=new qi(e,t+1),i=[];return this.rs.forEachInRange([r,s],o=>{this.cs(o),i.push(o.key)}),i}fs(){this.ns.forEach(t=>this.cs(t))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new at(new g1([])),r=new qi(e,t),s=new qi(e,t+1);let i=Ln();return this.rs.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(t){const e=new qi(t,0),r=this.ns.firstAfterOrEqual(e);return null!==r&&t.isEqual(r.key)}}class qi{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return at.comparator(t.key,e.key)||En(t._s,e._s)}static os(t,e){return En(t._s,e._s)||at.comparator(t.key,e.key)}}class Tve{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new er(qi.ss)}checkEmpty(t){return Me.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,r,s){const i=this.ws;this.ws++;const o=new lx(i,e,r,s);this.mutationQueue.push(o);for(const c of s)this.gs=this.gs.add(new qi(c.key,i)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast());return Me.resolve(o)}lookupMutationBatch(t,e){return Me.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const s=this.ps(e+1),i=s<0?0:s;return Me.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Me.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return Me.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new qi(e,0),s=new qi(e,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([r,s],o=>{const c=this.ys(o._s);i.push(c)}),Me.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new er(En);return e.forEach(s=>{const i=new qi(s,0),o=new qi(s,Number.POSITIVE_INFINITY);this.gs.forEachInRange([i,o],c=>{r=r.add(c._s)})}),Me.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,s=r.length+1;let i=r;at.isDocumentKey(i)||(i=i.child(""));const o=new qi(new at(i),0);let c=new er(En);return this.gs.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(u._s)),!0)},o),Me.resolve(this.Is(c))}Is(t){const e=[];return t.forEach(r=>{const s=this.ys(r);null!==s&&e.push(s)}),e}removeMutationBatch(t,e){an(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return Me.forEach(e.mutations,s=>{const i=new qi(s.key,e.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.gs=r})}An(t){}containsKey(t,e){const r=new qi(e,0),s=this.gs.firstAfterOrEqual(r);return Me.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return Me.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class wve{constructor(t){this.Es=t,this.docs=new hs(at.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,s=this.docs.get(r),i=s?s.size:0,o=this.Es(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return Me.resolve(r?r.document.mutableCopy():pr.newInvalidDocument(e))}getEntries(t,e){let r=ma();return e.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():pr.newInvalidDocument(s))}),Me.resolve(r)}getAllFromCollection(t,e,r){let s=ma();const i=new at(e.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:c,value:{document:u}}=o.getNext();if(!e.isPrefixOf(c.path))break;c.path.length>e.length+1||WI(cK(u),r)<=0||(s=s.insert(u.key,u.mutableCopy()))}return Me.resolve(s)}getAllFromCollectionGroup(t,e,r,s){wt()}As(t,e){return Me.forEach(this.docs,r=>e(r))}newChangeBuffer(t){return new bve(this)}getSize(t){return Me.resolve(this.size)}}class bve extends class Cve{constructor(){this.changes=new G0(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,pr.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return void 0!==r?Me.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?e.push(this.Yn.addEntry(t,s)):this.Yn.removeEntry(r)}),Me.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class Ove{constructor(t){this.persistence=t,this.Rs=new G0(e=>r5(e),Ag),this.lastRemoteSnapshotVersion=cn.min(),this.highestTargetId=0,this.bs=0,this.Ps=new gx,this.targetCount=0,this.vs=h5.Pn()}forEachTarget(t,e){return this.Rs.forEach((r,s)=>e(s)),Me.resolve()}getLastRemoteSnapshotVersion(t){return Me.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Me.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),Me.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.bs&&(this.bs=e),Me.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new h5(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,Me.resolve()}updateTargetData(t,e){return this.Dn(e),Me.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,Me.resolve()}removeTargets(t,e,r){let s=0;const i=[];return this.Rs.forEach((o,c)=>{c.sequenceNumber<=e&&null===r.get(c.targetId)&&(this.Rs.delete(o),i.push(this.removeMatchingKeysForTargetId(t,c.targetId)),s++)}),Me.waitFor(i).next(()=>s)}getTargetCount(t){return Me.resolve(this.targetCount)}getTargetData(t,e){const r=this.Rs.get(e)||null;return Me.resolve(r)}addMatchingKeys(t,e,r){return this.Ps.us(e,r),Me.resolve()}removeMatchingKeys(t,e,r){this.Ps.hs(e,r);const s=this.persistence.referenceDelegate,i=[];return s&&e.forEach(o=>{i.push(s.markPotentiallyOrphaned(t,o))}),Me.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),Me.resolve()}getMatchingKeysForTargetId(t,e){const r=this.Ps.ds(e);return Me.resolve(r)}containsKey(t,e){return Me.resolve(this.Ps.containsKey(e))}}class BX{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new ga(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new Ove(this),this.indexManager=new hve,this.remoteDocumentCache=new wve(r=>this.referenceDelegate.xs(r)),this.It=new CX(e),this.Ns=new Sve(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Pve,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.Vs[t.toKey()];return r||(r=new Tve(e,this.referenceDelegate),this.Vs[t.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,r){We("MemoryPersistence","Starting transaction:",t);const s=new Ave(this.Ss.next());return this.referenceDelegate.ks(),r(s).next(i=>this.referenceDelegate.Os(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ms(t,e){return Me.or(Object.values(this.Vs).map(r=>()=>r.containsKey(t,e)))}}class Ave extends class Kme{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}{constructor(t){super(),this.currentSequenceNumber=t}}class kM{constructor(t){this.persistence=t,this.Fs=new gx,this.$s=null}static Bs(t){return new kM(t)}get Ls(){if(this.$s)return this.$s;throw wt()}addReference(t,e,r){return this.Fs.addReference(r,e),this.Ls.delete(r.toString()),Me.resolve()}removeReference(t,e,r){return this.Fs.removeReference(r,e),this.Ls.add(r.toString()),Me.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),Me.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach(s=>this.Ls.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(s=>{s.forEach(i=>this.Ls.add(i.toString()))}).next(()=>r.removeTargetData(t,e))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Me.forEach(this.Ls,r=>{const s=at.fromPath(r);return this.Us(t,s).next(i=>{i||e.removeEntry(s,cn.min())})}).next(()=>(this.$s=null,e.apply(t)))}updateLimboDocument(t,e){return this.Us(t,e).next(r=>{r?this.Ls.delete(e.toString()):this.Ls.add(e.toString())})}xs(t){return 0}Us(t,e){return Me.or([()=>Me.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class Cx{constructor(t,e,r,s){this.targetId=t,this.fromCache=e,this.Si=r,this.Di=s}static Ci(t,e){let r=Ln(),s=Ln();for(const i of e.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Cx(t,e.fromCache,r,s)}}class UX{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,r,s){return this.ki(t,e).next(i=>i||this.Oi(t,e,s,r)).next(i=>i||this.Mi(t,e))}ki(t,e){if(NK(e))return Me.resolve(null);let r=Ro(e);return this.indexManager.getIndexType(t,r).next(s=>0===s?null:(null!==e.limit&&1===s&&(e=CM(e,null,"F"),r=Ro(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=Ln(...i);return this.Ni.getDocuments(t,o).next(c=>this.indexManager.getMinOffset(t,r).next(u=>{const h=this.Fi(e,c);return this.$i(e,h,o,u.readTime)?this.ki(t,CM(e,null,"F")):this.Bi(t,h,e,u)}))})))}Oi(t,e,r,s){return NK(e)||s.isEqual(cn.min())?this.Mi(t,e):this.Ni.getDocuments(t,r).next(i=>{const o=this.Fi(e,i);return this.$i(e,o,r,s)?this.Mi(t,e):(UI()<=p1.DEBUG&&We("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),tx(e)),this.Bi(t,o,e,function aK(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=cn.fromTimestamp(1e9===r?new es(e+1,0):new es(e,r));return new Ya(s,at.empty(),t)}(s,-1)))})}Fi(t,e){let r=new er(kK(t));return e.forEach((s,i)=>{nx(t,i)&&(r=r.add(i))}),r}$i(t,e,r,s){if(null===t.limit)return!1;if(r.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(t,e){return UI()<=p1.DEBUG&&We("QueryEngine","Using full collection scan to execute query:",tx(e)),this.Ni.getDocumentsMatchingQuery(t,e,Ya.min())}Bi(t,e,r,s){return this.Ni.getDocumentsMatchingQuery(t,r,s).next(i=>(e.forEach(o=>{i=i.insert(o.key,o)}),i))}}class Ive{constructor(t,e,r,s){this.persistence=t,this.Li=e,this.It=s,this.Ui=new hs(En),this.qi=new G0(i=>r5(i),Ag),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(r)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new FX(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ui))}}function qX(n,t){return yx.apply(this,arguments)}function yx(){return yx=I(function*(n,t){const e=ft(n);return yield e.persistence.runTransaction("Handle user change","readonly",r=>{let s;return e.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,e.Qi(t),e.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=Ln();for(const h of s){o.push(h.batchId);for(const g of h.mutations)u=u.add(g.key)}for(const h of i){c.push(h.batchId);for(const g of h.mutations)u=u.add(g.key)}return e.localDocuments.getDocuments(r,u).next(h=>({ji:h,removedBatchIds:o,addedBatchIds:c}))})})}),yx.apply(this,arguments)}function xve(n,t){const e=ft(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=e.Gi.newChangeBuffer({trackRemovals:!0});return function(o,c,u,h){const g=u.batch,m=g.keys();let E=Me.resolve();return m.forEach(b=>{E=E.next(()=>h.getEntry(c,b)).next(k=>{const U=u.docVersions.get(b);an(null!==U),k.version.compareTo(U)<0&&(g.applyToRemoteDocument(k,u),k.isValidDocument()&&(k.setReadTime(u.commitVersion),h.addEntry(k)))})}),E.next(()=>o.mutationQueue.removeMutationBatch(c,g))}(e,r,t,i).next(()=>i.apply(r)).next(()=>e.mutationQueue.performConsistencyCheck(r)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let c=Ln();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(c=c.add(o.batch.mutations[u].key));return c}(t))).next(()=>e.localDocuments.getDocuments(r,s))})}function WX(n){const t=ft(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Cs.getLastRemoteSnapshotVersion(e))}function kve(n,t){const e=ft(n),r=t.snapshotVersion;let s=e.Ui;return e.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=e.Gi.newChangeBuffer({trackRemovals:!0});s=e.Ui;const c=[];t.targetChanges.forEach((g,m)=>{const E=s.get(m);if(!E)return;c.push(e.Cs.removeMatchingKeys(i,g.removedDocuments,m).next(()=>e.Cs.addMatchingKeys(i,g.addedDocuments,m)));let b=E.withSequenceNumber(i.currentSequenceNumber);var k,U,j;t.targetMismatches.has(m)?b=b.withResumeToken(gi.EMPTY_BYTE_STRING,cn.min()).withLastLimboFreeSnapshotVersion(cn.min()):g.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(g.resumeToken,r)),s=s.insert(m,b),U=b,j=g,(0===(k=E).resumeToken.approximateByteSize()||U.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8||j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0)&&c.push(e.Cs.updateTargetData(i,b))});let u=ma(),h=Ln();if(t.documentUpdates.forEach(g=>{t.resolvedLimboDocuments.has(g)&&c.push(e.persistence.referenceDelegate.updateLimboDocument(i,g))}),c.push(function jX(n,t,e){let r=Ln(),s=Ln();return e.forEach(i=>r=r.add(i)),t.getEntries(n,r).next(i=>{let o=ma();return e.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(cn.min())?(t.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||0===u.version.compareTo(h.version)&&h.hasPendingWrites?(t.addEntry(u),o=o.insert(c,u)):We("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Wi:o,zi:s}})}(i,o,t.documentUpdates).next(g=>{u=g.Wi,h=g.zi})),!r.isEqual(cn.min())){const g=e.Cs.getLastRemoteSnapshotVersion(i).next(m=>e.Cs.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(g)}return Me.waitFor(c).next(()=>o.apply(i)).next(()=>e.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(e.Ui=s,i))}function Lve(n,t){const e=ft(n);return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function eh(n,t){const e=ft(n);return e.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return e.Cs.getTargetData(r,t).next(i=>i?(s=i,Me.resolve(s)):e.Cs.allocateTargetId(r).next(o=>(s=new q0(t,o,0,r.currentSequenceNumber),e.Cs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=e.Ui.get(r.targetId);return(null===s||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ui=e.Ui.insert(r.targetId,r),e.qi.set(t,r.targetId)),r})}function th(n,t,e){return Ex.apply(this,arguments)}function Ex(){return Ex=I(function*(n,t,e){const r=ft(n),s=r.Ui.get(t),i=e?"readwrite":"readwrite-primary";try{e||(yield r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!H0(o))throw o;We("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.Ui=r.Ui.remove(t),r.qi.delete(s.target)}),Ex.apply(this,arguments)}function RM(n,t,e){const r=ft(n);let s=cn.min(),i=Ln();return r.persistence.runTransaction("Execute query","readonly",o=>function(c,u,h){const g=ft(c),m=g.qi.get(h);return void 0!==m?Me.resolve(g.Ui.get(m)):g.Cs.getTargetData(u,h)}(r,o,Ro(t)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Li.getDocumentsMatchingQuery(o,t,e?s:cn.min(),e?i:Ln())).next(c=>(function KX(n,t,e){let r=n.Ki.get(t)||cn.min();e.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Ki.set(t,r)}(r,function xK(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}(t),c),{documents:c,Hi:i})))}class wx{constructor(){this.activeTargetIds=SM()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class JX{constructor(){this.Lr=new wx,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t){return this.Lr.er(t),this.Ur[t]||"not-current"}updateQueryState(t,e,r){this.Ur[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.Ur[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new wx,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class zve{qr(t){}shutdown(){}}class eQ{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){We("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){We("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Vve={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Hve{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class Fve extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.oo=(t.ssl?"https":"http")+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,r,s,i){const o=this.ho(t,e);We("RestConnection","Sending: ",o,r);const c={};return this.lo(c,s,i),this.fo(t,o,c,r).then(u=>(We("RestConnection","Received: ",u),u),u=>{throw Hf("RestConnection",`${t} failed with error: `,u,"url: ",o,"request:",r),u})}_o(t,e,r,s,i,o){return this.ao(t,e,r,s,i)}lo(t,e,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+Vf,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((s,i)=>t[i]=s),r&&r.headers.forEach((s,i)=>t[i]=s)}ho(t,e){return`${this.oo}/v1/${e}:${Vve[t]}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,r,s){return new Promise((i,o)=>{const c=new Hme;c.setWithCredentials(!0),c.listenOnce(Dme.COMPLETE,()=>{var h;try{switch(c.getLastErrorCode()){case $I.NO_ERROR:const g=c.getResponseJson();We("Connection","XHR received:",JSON.stringify(g)),i(g);break;case $I.TIMEOUT:We("Connection",'RPC "'+t+'" timed out'),o(new Ue(be.DEADLINE_EXCEEDED,"Request time out"));break;case $I.HTTP_ERROR:const m=c.getStatus();if(We("Connection",'RPC "'+t+'" failed with status:',m,"response text:",c.getResponseText()),m>0){let E=c.getResponseJson();Array.isArray(E)&&(E=E[0]);const b=null===(h=E)||void 0===h?void 0:h.error;if(b&&b.status&&b.message){const k=function(U){const j=U.toLowerCase().replace(/_/g,"-");return Object.values(be).indexOf(j)>=0?j:be.UNKNOWN}(b.status);o(new Ue(k,b.message))}else o(new Ue(be.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new Ue(be.UNAVAILABLE,"Connection failed."));break;default:wt()}}finally{We("Connection",'RPC "'+t+'" completed.')}});const u=JSON.stringify(s);c.send(e,"POST",u,r,15)})}wo(t,e,r){const s=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=Lme(),o=Rme(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(c.xmlHttpFactory=new Vme({})),this.lo(c.initMessageHeaders,e,r),c.encodeInitMessageHeaders=!0;const u=s.join("");We("Connection","Creating WebChannel: "+u,c);const h=i.createWebChannel(u,c);let g=!1,m=!1;const E=new Hve({Hr:k=>{m?We("Connection","Not sending because WebChannel is closed:",k):(g||(We("Connection","Opening WebChannel transport."),h.open(),g=!0),We("Connection","WebChannel sending:",k),h.send(k))},Jr:()=>h.close()}),b=(k,U,j)=>{k.listen(U,oe=>{try{j(oe)}catch(ye){setTimeout(()=>{throw ye},0)}})};return b(h,uM.EventType.OPEN,()=>{m||We("Connection","WebChannel transport opened.")}),b(h,uM.EventType.CLOSE,()=>{m||(m=!0,We("Connection","WebChannel transport closed"),E.io())}),b(h,uM.EventType.ERROR,k=>{m||(m=!0,Hf("Connection","WebChannel transport errored:",k),E.io(new Ue(be.UNAVAILABLE,"The operation could not be completed")))}),b(h,uM.EventType.MESSAGE,k=>{var U;if(!m){const j=k.data[0];an(!!j);const oe=j,ye=oe.error||(null===(U=oe[0])||void 0===U?void 0:U.error);if(ye){We("Connection","WebChannel received error:",ye);const te=ye.status;let ke=function(Xe){const Bt=Ws[Xe];if(void 0!==Bt)return ZK(Bt)}(te),Ge=ye.message;void 0===ke&&(ke=be.INTERNAL,Ge="Unknown error status: "+te+" with message "+ye.message),m=!0,E.io(new Ue(ke,Ge)),h.close()}else We("Connection","WebChannel received:",j),E.ro(j)}}),b(o,zme.STAT_EVENT,k=>{k.stat===tK.PROXY?We("Connection","Detected buffering proxy"):k.stat===tK.NOPROXY&&We("Connection","Detected no buffering proxy")}),setTimeout(()=>{E.so()},0),E}}function VM(){return typeof document<"u"?document:null}function Yg(n){return new N_e(n,!0)}class Ox{constructor(t,e,r=1e3,s=1.5,i=6e4){this.Hs=t,this.timerId=e,this.mo=r,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),s=Math.max(0,e-r);s>0&&We("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,()=>(this.Eo=Date.now(),t())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class nQ{constructor(t,e,r,s,i,o,c,u){this.Hs=t,this.vo=r,this.Vo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Ox(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var t=this;return I(function*(){t.No()&&(yield t.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(t){this.Lo(),this.stream.send(t)}$o(){var t=this;return I(function*(){if(t.ko())return t.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(t,e){var r=this;return I(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==t?r.xo.reset():e&&e.code===be.RESOURCE_EXHAUSTED?(ws(e.toString()),ws("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):e&&e.code===be.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=t,yield r.listener.Zr(e)})()}qo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.So===e&&this.Go(r,s)},r=>{t(()=>{const s=new Ue(be.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(s)})})}Go(t,e){const r=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(s=>{r(()=>this.Qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Oo(){var t=this;this.state=5,this.xo.Ro(I(function*(){t.state=0,t.start()}))}Qo(t){return We("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget(()=>this.So===t?e():(We("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Bve extends nQ{constructor(t,e,r,s,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,s,o),this.It=i}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function k_e(n,t){let e;if("targetChange"in t){const r="NO_CHANGE"===(u=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:wt(),s=t.targetChange.targetIds||[],i=function(u,h){return u.gt?(an(void 0===h||"string"==typeof h),gi.fromBase64String(h||"")):(an(void 0===h||h instanceof Uint8Array),gi.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,c=o&&function(u){const h=void 0===u.code?be.UNKNOWN:ZK(u.code);return new Ue(h,u.message||"")}(o);e=new JK(r,s,i,c||null)}else if("documentChange"in t){const r=t.documentChange,s=I4(n,r.document.name),i=Ui(r.document.updateTime),o=new A2({mapValue:{fields:r.document.fields}}),c=pr.newFoundDocument(s,i,o);e=new PM(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){const r=t.documentDelete,s=I4(n,r.document),i=r.readTime?Ui(r.readTime):cn.min(),o=pr.newNoDocument(s,i);e=new PM([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){const r=t.documentRemove,s=I4(n,r.document);e=new PM([],r.removedTargetIds||[],s,null)}else{if(!("filter"in t))return wt();{const r=t.filter,i=new M_e(r.count||0);e=new QK(r.targetId,i)}}var u;return e}(this.It,t),r=function(s){if(!("targetChange"in s))return cn.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?cn.min():i.readTime?Ui(i.readTime):cn.min()}(t);return this.listener.Wo(e,r)}zo(t){const e={};e.database=Hg(this.It),e.addTarget=function(s,i){let o;const c=i.target;return o=_M(c)?{documents:lX(s,c)}:{query:ax(s,c)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=rX(s,i.resumeToken):i.snapshotVersion.compareTo(cn.min())>0&&(o.readTime=zg(s,i.snapshotVersion.toTimestamp())),o}(this.It,t);const r=function R_e(n,t){const e=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return wt()}}(0,t.purpose);return null==e?null:{"goog-listen-tags":e}}(0,t);r&&(e.labels=r),this.Bo(e)}Ho(t){const e={};e.database=Hg(this.It),e.removeTarget=t,this.Bo(e)}}class $ve extends nQ{constructor(t,e,r,s,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,s,o),this.It=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(an(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function L_e(n,t){return n&&n.length>0?(an(void 0!==t),n.map(e=>function(r,s){let i=Ui(r.updateTime?r.updateTime:s);return i.isEqual(cn.min())&&(i=Ui(s)),new C_e(i,r.transformResults||[])}(e,t))):[]}(t.writeResults,t.commitTime),r=Ui(t.commitTime);return this.listener.Zo(r,e)}return an(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=Hg(this.It),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map(r=>function Fg(n,t){let e;if(t instanceof Zf)e={update:aX(n,t.key,t.value)};else if(t instanceof Yf)e={delete:Vg(n,t.key)};else if(t instanceof Kl)e={update:aX(n,t.key,t.data),updateMask:F_e(t.fieldMask)};else{if(!(t instanceof rx))return wt();e={verify:Vg(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Wf)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof s5)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof i5)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof jf)return{fieldPath:i.field.canonicalString(),increment:o.yt};throw wt()}(0,r))),t.precondition.isNone||(e.currentDocument=void 0!==(s=t.precondition).updateTime?{updateTime:I_e(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:wt()),e;var s}(this.It,r))};this.Bo(e)}}class Uve extends class{}{constructor(t,e,r,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.It=s,this.nu=!1}su(){if(this.nu)throw new Ue(be.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.ao(t,e,r,s,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ue(be.UNKNOWN,s.toString())})}_o(t,e,r,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection._o(t,e,r,i,o,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ue(be.UNKNOWN,i.toString())})}terminate(){this.nu=!0}}class qve{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(ws(e),this.ou=!1):We("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class Wve{constructor(t,e,r,s,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr(c=>{r.enqueueAndForget(I(function*(){var u;Xl(o)&&(We("RemoteStore","Restarting streams for network reachability change."),yield(u=I(function*(h){const g=ft(h);g._u.add(4),yield nh(g),g.gu.set("Unknown"),g._u.delete(4),yield Kg(g)}),function(h){return u.apply(this,arguments)})(o))}))}),this.gu=new qve(r,s)}}function Kg(n){return Nx.apply(this,arguments)}function Nx(){return Nx=I(function*(n){if(Xl(n))for(const t of n.wu)yield t(!0)}),Nx.apply(this,arguments)}function nh(n){return Ix.apply(this,arguments)}function Ix(){return Ix=I(function*(n){for(const t of n.wu)yield t(!1)}),Ix.apply(this,arguments)}function HM(n,t){const e=ft(n);e.du.has(t.targetId)||(e.du.set(t.targetId,t),Lx(e)?kx(e):sh(e).ko()&&xx(e,t))}function Xg(n,t){const e=ft(n),r=sh(e);e.du.delete(t),r.ko()&&rQ(e,t),0===e.du.size&&(r.ko()?r.Fo():Xl(e)&&e.gu.set("Unknown"))}function xx(n,t){n.yu.Mt(t.targetId),sh(n).zo(t)}function rQ(n,t){n.yu.Mt(t),sh(n).Ho(t)}function kx(n){n.yu=new b_e({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),se:t=>n.du.get(t)||null}),sh(n).start(),n.gu.uu()}function Lx(n){return Xl(n)&&!sh(n).No()&&n.du.size>0}function Xl(n){return 0===ft(n)._u.size}function sQ(n){n.yu=void 0}function jve(n){return Rx.apply(this,arguments)}function Rx(){return Rx=I(function*(n){n.du.forEach((t,e)=>{xx(n,t)})}),Rx.apply(this,arguments)}function Zve(n,t){return Dx.apply(this,arguments)}function Dx(){return Dx=I(function*(n,t){sQ(n),Lx(n)?(n.gu.hu(t),kx(n)):n.gu.set("Unknown")}),Dx.apply(this,arguments)}function Yve(n,t,e){return zx.apply(this,arguments)}function zx(){return zx=I(function*(n,t,e){if(n.gu.set("Online"),t instanceof JK&&2===t.state&&t.cause)try{yield(r=I(function*(s,i){const o=i.cause;for(const c of i.targetIds)s.du.has(c)&&(yield s.remoteSyncer.rejectListen(c,o),s.du.delete(c),s.yu.removeTarget(c))}),function(s,i){return r.apply(this,arguments)})(n,t)}catch(r){We("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield FM(n,r)}else if(t instanceof PM?n.yu.Gt(t):t instanceof QK?n.yu.Yt(t):n.yu.Wt(t),!e.isEqual(cn.min()))try{const r=yield WX(n.localStore);e.compareTo(r)>=0&&(yield function(s,i){const o=s.yu.te(i);return o.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.du.get(u);h&&s.du.set(u,h.withResumeToken(c.resumeToken,i))}}),o.targetMismatches.forEach(c=>{const u=s.du.get(c);if(!u)return;s.du.set(c,u.withResumeToken(gi.EMPTY_BYTE_STRING,u.snapshotVersion)),rQ(s,c);const h=new q0(u.target,c,1,u.sequenceNumber);xx(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(n,e))}catch(r){We("RemoteStore","Failed to raise snapshot:",r),yield FM(n,r)}var r}),zx.apply(this,arguments)}function FM(n,t,e){return Vx.apply(this,arguments)}function Vx(){return Vx=I(function*(n,t,e){if(!H0(t))throw t;n._u.add(1),yield nh(n),n.gu.set("Offline"),e||(e=()=>WX(n.localStore)),n.asyncQueue.enqueueRetryable(I(function*(){We("RemoteStore","Retrying IndexedDB access"),yield e(),n._u.delete(1),yield Kg(n)}))}),Vx.apply(this,arguments)}function iQ(n,t){return t().catch(e=>FM(n,e,t))}function rh(n){return Hx.apply(this,arguments)}function Hx(){return Hx=I(function*(n){const t=ft(n),e=Z0(t);let r=t.fu.length>0?t.fu[t.fu.length-1].batchId:-1;for(;Kve(t);)try{const s=yield Lve(t.localStore,r);if(null===s){0===t.fu.length&&e.Fo();break}r=s.batchId,Xve(t,s)}catch(s){yield FM(t,s)}oQ(t)&&aQ(t)}),Hx.apply(this,arguments)}function Kve(n){return Xl(n)&&n.fu.length<10}function Xve(n,t){n.fu.push(t);const e=Z0(n);e.ko()&&e.Yo&&e.Xo(t.mutations)}function oQ(n){return Xl(n)&&!Z0(n).No()&&n.fu.length>0}function aQ(n){Z0(n).start()}function Qve(n){return Fx.apply(this,arguments)}function Fx(){return Fx=I(function*(n){Z0(n).eu()}),Fx.apply(this,arguments)}function Jve(n){return Bx.apply(this,arguments)}function Bx(){return Bx=I(function*(n){const t=Z0(n);for(const e of n.fu)t.Xo(e.mutations)}),Bx.apply(this,arguments)}function eCe(n,t,e){return $x.apply(this,arguments)}function $x(){return $x=I(function*(n,t,e){const r=n.fu.shift(),s=ux.from(r,t,e);yield iQ(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield rh(n)}),$x.apply(this,arguments)}function tCe(n,t){return Ux.apply(this,arguments)}function Ux(){return Ux=I(function*(n,t){var e;t&&Z0(n).Yo&&(yield(e=I(function*(r,s){if(jK(i=s.code)&&i!==be.ABORTED){const o=r.fu.shift();Z0(r).Mo(),yield iQ(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield rh(r)}var i}),function(r,s){return e.apply(this,arguments)})(n,t)),oQ(n)&&aQ(n)}),Ux.apply(this,arguments)}function cQ(n,t){return Gx.apply(this,arguments)}function Gx(){return Gx=I(function*(n,t){const e=ft(n);e.asyncQueue.verifyOperationInProgress(),We("RemoteStore","RemoteStore received new credentials");const r=Xl(e);e._u.add(3),yield nh(e),r&&e.gu.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e._u.delete(3),yield Kg(e)}),Gx.apply(this,arguments)}function Wx(){return Wx=I(function*(n,t){const e=ft(n);t?(e._u.delete(2),yield Kg(e)):t||(e._u.add(2),yield nh(e),e.gu.set("Unknown"))}),Wx.apply(this,arguments)}function sh(n){return n.pu||(n.pu=function(t,e,r){const s=ft(t);return s.su(),new Bve(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:jve.bind(null,n),Zr:Zve.bind(null,n),Wo:Yve.bind(null,n)}),n.wu.push(function(){var t=I(function*(e){e?(n.pu.Mo(),Lx(n)?kx(n):n.gu.set("Unknown")):(yield n.pu.stop(),sQ(n))});return function(e){return t.apply(this,arguments)}}())),n.pu}function Z0(n){return n.Iu||(n.Iu=function(t,e,r){const s=ft(t);return s.su(),new $ve(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:Qve.bind(null,n),Zr:tCe.bind(null,n),tu:Jve.bind(null,n),Zo:eCe.bind(null,n)}),n.wu.push(function(){var t=I(function*(e){e?(n.Iu.Mo(),yield rh(n)):(yield n.Iu.stop(),n.fu.length>0&&(We("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(e){return t.apply(this,arguments)}}())),n.Iu}class jx{constructor(t,e,r,s,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(t,e,r,s,i){const o=Date.now()+r,c=new jx(t,e,o,s,i);return c.start(r),c}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ue(be.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ih(n,t){if(ws("AsyncQueue",`${t}: ${n}`),H0(n))return new Ue(be.UNAVAILABLE,`${t}: ${n}`);throw n}class oh{constructor(t){this.comparator=t?(e,r)=>t(e,r)||at.comparator(e.key,r.key):(e,r)=>at.comparator(e.key,r.key),this.keyedMap=kg(),this.sortedSet=new hs(this.comparator)}static emptySet(t){return new oh(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,r)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof oh)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const r=new oh;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class lQ{constructor(){this.Tu=new hs(at.comparator)}track(t){const e=t.doc.key,r=this.Tu.get(e);r?0!==t.type&&3===r.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==r.type?this.Tu=this.Tu.insert(e,{type:r.type,doc:t.doc}):2===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===r.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===r.type?this.Tu=this.Tu.remove(e):1===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:1,doc:r.doc}):0===t.type&&1===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):wt():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal((e,r)=>{t.push(r)}),t}}class ah{constructor(t,e,r,s,i,o,c,u,h){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(t,e,r,s,i){const o=[];return e.forEach(c=>{o.push({type:0,doc:c})}),new ah(t,e,oh.emptySet(e),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ng(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==r[s].type||!e[s].doc.isEqual(r[s].doc))return!1;return!0}}class nCe{constructor(){this.Au=void 0,this.listeners=[]}}class rCe{constructor(){this.queries=new G0(t=>IK(t),Ng),this.onlineState="Unknown",this.Ru=new Set}}function Zx(n,t){return Yx.apply(this,arguments)}function Yx(){return Yx=I(function*(n,t){const e=ft(n),r=t.query;let s=!1,i=e.queries.get(r);if(i||(s=!0,i=new nCe),s)try{i.Au=yield e.onListen(r)}catch(o){const c=ih(o,`Initialization of query '${tx(t.query)}' failed`);return void t.onError(c)}e.queries.set(r,i),i.listeners.push(t),t.bu(e.onlineState),i.Au&&t.Pu(i.Au)&&Qx(e)}),Yx.apply(this,arguments)}function Kx(n,t){return Xx.apply(this,arguments)}function Xx(){return Xx=I(function*(n,t){const e=ft(n),r=t.query;let s=!1;const i=e.queries.get(r);if(i){const o=i.listeners.indexOf(t);o>=0&&(i.listeners.splice(o,1),s=0===i.listeners.length)}if(s)return e.queries.delete(r),e.onUnlisten(r)}),Xx.apply(this,arguments)}function sCe(n,t){const e=ft(n);let r=!1;for(const s of t){const o=e.queries.get(s.query);if(o){for(const c of o.listeners)c.Pu(s)&&(r=!0);o.Au=s}}r&&Qx(e)}function iCe(n,t,e){const r=ft(n),s=r.queries.get(t);if(s)for(const i of s.listeners)i.onError(e);r.queries.delete(t)}function Qx(n){n.Ru.forEach(t=>{t.next()})}class Jx{constructor(t,e,r){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)3!==s.type&&r.push(s);t=new ah(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){return!t.fromCache||(!this.options.Nu||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(t){t=ah.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class hQ{constructor(t){this.key=t}}class dQ{constructor(t){this.key=t}}class pQ{constructor(t,e){this.query=t,this.Uu=e,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Ln(),this.mutatedKeys=Ln(),this.Gu=kK(t),this.Qu=new oh(this.Gu)}get ju(){return this.Uu}Wu(t,e){const r=e?e.zu:new lQ,s=e?e.Qu:this.Qu;let i=e?e.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,h="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((g,m)=>{const E=s.get(g),b=nx(this.query,m)?m:null,k=!!E&&this.mutatedKeys.has(E.key),U=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let j=!1;E&&b?E.data.isEqual(b.data)?k!==U&&(r.track({type:3,doc:b}),j=!0):this.Hu(E,b)||(r.track({type:2,doc:b}),j=!0,(u&&this.Gu(b,u)>0||h&&this.Gu(b,h)<0)&&(c=!0)):!E&&b?(r.track({type:0,doc:b}),j=!0):E&&!b&&(r.track({type:1,doc:E}),j=!0,(u||h)&&(c=!0)),j&&(b?(o=o.add(b),i=U?i.add(g):i.delete(g)):(o=o.delete(g),i=i.delete(g)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const g="F"===this.query.limitType?o.last():o.first();o=o.delete(g.key),i=i.delete(g.key),r.track({type:1,doc:g})}return{Qu:o,zu:r,$i:c,mutatedKeys:i}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r){const s=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const i=t.zu.Eu();i.sort((h,g)=>function(m,E){const b=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wt()}};return b(m)-b(E)}(h.type,g.type)||this.Gu(h.doc,g.doc)),this.Ju(r);const o=e?this.Yu():[],c=0===this.Ku.size&&this.current?1:0,u=c!==this.qu;return this.qu=c,0!==i.length||u?{snapshot:new ah(this.query,t.Qu,s,i,t.mutatedKeys,0===c,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new lQ,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.Uu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach(e=>this.Uu=this.Uu.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Uu=this.Uu.delete(e)),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=Ln(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const e=[];return t.forEach(r=>{this.Ku.has(r)||e.push(new dQ(r))}),this.Ku.forEach(r=>{t.has(r)||e.push(new hQ(r))}),e}tc(t){this.Uu=t.Hi,this.Ku=Ln();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return ah.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class cCe{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class lCe{constructor(t){this.key=t,this.nc=!1}}class uCe{constructor(t,e,r,s,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new G0(c=>IK(c),Ng),this.rc=new Map,this.oc=new Set,this.uc=new hs(at.comparator),this.cc=new Map,this.ac=new gx,this.hc={},this.lc=new Map,this.fc=h5.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function fCe(n,t){return ek.apply(this,arguments)}function ek(){return ek=I(function*(n,t){const e=Sk(n);let r,s;const i=e.ic.get(t);if(i)r=i.targetId,e.sharedClientState.addLocalQueryTarget(r),s=i.view.ec();else{const o=yield eh(e.localStore,Ro(t));e.isPrimaryClient&&HM(e.remoteStore,o);const c=e.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=yield tk(e,t,r,"current"===c,o.resumeToken)}return s}),ek.apply(this,arguments)}function tk(n,t,e,r,s){return nk.apply(this,arguments)}function nk(){return nk=I(function*(n,t,e,r,s){n._c=(m,E,b)=>{return(k=I(function*(U,j,oe,ye){let te=j.view.Wu(oe);te.$i&&(te=yield RM(U.localStore,j.query,!1).then(({documents:Xe})=>j.view.Wu(Xe,te)));const ke=ye&&ye.targetChanges.get(j.targetId),Ge=j.view.applyChanges(te,U.isPrimaryClient,ke);return hk(U,j.targetId,Ge.Xu),Ge.snapshot}),function(U,j,oe,ye){return k.apply(this,arguments)})(n,m,E,b);var k};const i=yield RM(n.localStore,t,!0),o=new pQ(t,i.Hi),c=o.Wu(i.documents),u=Dg.createSynthesizedTargetChangeForCurrentChange(e,r&&"Offline"!==n.onlineState,s),h=o.applyChanges(c,n.isPrimaryClient,u);hk(n,e,h.Xu);const g=new cCe(t,e,o);return n.ic.set(t,g),n.rc.has(e)?n.rc.get(e).push(t):n.rc.set(e,[t]),h.snapshot}),nk.apply(this,arguments)}function hCe(n,t){return rk.apply(this,arguments)}function rk(){return rk=I(function*(n,t){const e=ft(n),r=e.ic.get(t),s=e.rc.get(r.targetId);if(s.length>1)return e.rc.set(r.targetId,s.filter(i=>!Ng(i,t))),void e.ic.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(r.targetId),e.sharedClientState.isActiveQueryTarget(r.targetId)||(yield th(e.localStore,r.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(r.targetId),Xg(e.remoteStore,r.targetId),ch(e,r.targetId)}).catch(V0))):(ch(e,r.targetId),yield th(e.localStore,r.targetId,!0))}),rk.apply(this,arguments)}function sk(){return sk=I(function*(n,t,e){const r=Pk(n);try{const s=yield function(i,o){const c=ft(i),u=es.now(),h=o.reduce((E,b)=>E.add(b.key),Ln());let g,m;return c.persistence.runTransaction("Locally write mutations","readwrite",E=>{let b=ma(),k=Ln();return c.Gi.getEntries(E,h).next(U=>{b=U,b.forEach((j,oe)=>{oe.isValidDocument()||(k=k.add(j))})}).next(()=>c.localDocuments.getOverlayedDocuments(E,b)).next(U=>{g=U;const j=[];for(const oe of o){const ye=E_e(oe,g.get(oe.key).overlayedDocument);null!=ye&&j.push(new Kl(oe.key,ye,MK(ye.value.mapValue),$r.exists(!0)))}return c.mutationQueue.addMutationBatch(E,u,j,o)}).next(U=>{m=U;const j=U.applyToLocalDocumentSet(g,k);return c.documentOverlayCache.saveOverlays(E,U.batchId,j)})}).then(()=>({batchId:m.batchId,changes:KK(g)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,c){let u=i.hc[i.currentUser.toKey()];u||(u=new hs(En)),u=u.insert(o,c),i.hc[i.currentUser.toKey()]=u}(r,s.batchId,e),yield Ql(r,s.changes),yield rh(r.remoteStore)}catch(s){const i=ih(s,"Failed to persist write");e.reject(i)}}),sk.apply(this,arguments)}function gQ(n,t){return ik.apply(this,arguments)}function ik(){return ik=I(function*(n,t){const e=ft(n);try{const r=yield kve(e.localStore,t);t.targetChanges.forEach((s,i)=>{const o=e.cc.get(i);o&&(an(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.nc=!0:s.modifiedDocuments.size>0?an(o.nc):s.removedDocuments.size>0&&(an(o.nc),o.nc=!1))}),yield Ql(e,r,t)}catch(r){yield V0(r)}}),ik.apply(this,arguments)}function mQ(n,t,e){const r=ft(n);if(r.isPrimaryClient&&0===e||!r.isPrimaryClient&&1===e){const s=[];r.ic.forEach((i,o)=>{const c=o.view.bu(t);c.snapshot&&s.push(c.snapshot)}),function(i,o){const c=ft(i);c.onlineState=o;let u=!1;c.queries.forEach((h,g)=>{for(const m of g.listeners)m.bu(o)&&(u=!0)}),u&&Qx(c)}(r.eventManager,t),s.length&&r.sc.Wo(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function pCe(n,t,e){return ok.apply(this,arguments)}function ok(){return ok=I(function*(n,t,e){const r=ft(n);r.sharedClientState.updateQueryState(t,"rejected",e);const s=r.cc.get(t),i=s&&s.key;if(i){let o=new hs(at.comparator);o=o.insert(i,pr.newNoDocument(i,cn.min()));const c=Ln().add(i),u=new Rg(cn.min(),new Map,new er(En),o,c);yield gQ(r,u),r.uc=r.uc.remove(i),r.cc.delete(t),dk(r)}else yield th(r.localStore,t,!1).then(()=>ch(r,t,e)).catch(V0)}),ok.apply(this,arguments)}function gCe(n,t){return ak.apply(this,arguments)}function ak(){return ak=I(function*(n,t){const e=ft(n),r=t.batch.batchId;try{const s=yield xve(e.localStore,t);fk(e,r,null),uk(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),yield Ql(e,s)}catch(s){yield V0(s)}}),ak.apply(this,arguments)}function mCe(n,t,e){return ck.apply(this,arguments)}function ck(){return ck=I(function*(n,t,e){const r=ft(n);try{const s=yield function(i,o){const c=ft(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,o).next(g=>(an(null!==g),h=g.keys(),c.mutationQueue.removeMutationBatch(u,g))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(r.localStore,t);fk(r,t,e),uk(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),yield Ql(r,s)}catch(s){yield V0(s)}}),ck.apply(this,arguments)}function uk(n,t){(n.lc.get(t)||[]).forEach(e=>{e.resolve()}),n.lc.delete(t)}function fk(n,t,e){const r=ft(n);let s=r.hc[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(e?i.reject(e):i.resolve(),s=s.remove(t)),r.hc[r.currentUser.toKey()]=s}}function ch(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.rc.get(t))n.ic.delete(r),e&&n.sc.wc(r,e);n.rc.delete(t),n.isPrimaryClient&&n.ac.ls(t).forEach(r=>{n.ac.containsKey(r)||_Q(n,r)})}function _Q(n,t){n.oc.delete(t.path.canonicalString());const e=n.uc.get(t);null!==e&&(Xg(n.remoteStore,e),n.uc=n.uc.remove(t),n.cc.delete(e),dk(n))}function hk(n,t,e){for(const r of e)r instanceof hQ?(n.ac.addReference(r.key,t),vCe(n,r)):r instanceof dQ?(We("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,t),n.ac.containsKey(r.key)||_Q(n,r.key)):wt()}function vCe(n,t){const e=t.key,r=e.path.canonicalString();n.uc.get(e)||n.oc.has(r)||(We("SyncEngine","New document in limbo: "+e),n.oc.add(r),dk(n))}function dk(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const t=n.oc.values().next().value;n.oc.delete(t);const e=new at(g1.fromString(t)),r=n.fc.next();n.cc.set(r,new lCe(e)),n.uc=n.uc.insert(e,r),HM(n.remoteStore,new q0(Ro(Gf(e.path)),r,2,ga.at))}}function Ql(n,t,e){return pk.apply(this,arguments)}function pk(){return pk=I(function*(n,t,e){const r=ft(n),s=[],i=[],o=[];var c;r.ic.isEmpty()||(r.ic.forEach((c,u)=>{o.push(r._c(u,t,e).then(h=>{if((h||e)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,h?.fromCache?"not-current":"current"),h){s.push(h);const g=Cx.Ci(u.targetId,h);i.push(g)}}))}),yield Promise.all(o),r.sc.Wo(s),yield(c=I(function*(u,h){const g=ft(u);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Me.forEach(h,E=>Me.forEach(E.Si,b=>g.persistence.referenceDelegate.addReference(m,E.targetId,b)).next(()=>Me.forEach(E.Di,b=>g.persistence.referenceDelegate.removeReference(m,E.targetId,b)))))}catch(m){if(!H0(m))throw m;We("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const E=m.targetId;if(!m.fromCache){const b=g.Ui.get(E),U=b.withLastLimboFreeSnapshotVersion(b.snapshotVersion);g.Ui=g.Ui.insert(E,U)}}}),function(u,h){return c.apply(this,arguments)})(r.localStore,i))}),pk.apply(this,arguments)}function CCe(n,t){return gk.apply(this,arguments)}function gk(){return gk=I(function*(n,t){const e=ft(n);if(!e.currentUser.isEqual(t)){We("SyncEngine","User change. New user:",t.toKey());const r=yield qX(e.localStore,t);e.currentUser=t,(s=e).lc.forEach(o=>{o.forEach(c=>{c.reject(new Ue(be.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.lc.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),yield Ql(e,r.ji)}var s}),gk.apply(this,arguments)}function yCe(n,t){const e=ft(n),r=e.cc.get(t);if(r&&r.nc)return Ln().add(r.key);{let s=Ln();const i=e.rc.get(t);if(!i)return s;for(const o of i){const c=e.ic.get(o);s=s.unionWith(c.view.ju)}return s}}function Sk(n){const t=ft(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=gQ.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=yCe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=pCe.bind(null,t),t.sc.Wo=sCe.bind(null,t.eventManager),t.sc.wc=iCe.bind(null,t.eventManager),t}function Pk(n){const t=ft(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=gCe.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=mCe.bind(null,t),t}class ACe{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return I(function*(){e.It=Yg(t.databaseInfo.databaseId),e.sharedClientState=e.gc(t),e.persistence=e.yc(t),yield e.persistence.start(),e.localStore=e.Ic(t),e.gcScheduler=e.Tc(t,e.localStore),e.indexBackfillerScheduler=e.Ec(t,e.localStore)})()}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return function GX(n,t,e,r){return new Ive(n,t,e,r)}(this.persistence,new UX,t.initialUser,this.It)}yc(t){return new BX(kM.Bs,this.It)}gc(t){return new JX}terminate(){var t=this;return I(function*(){t.gcScheduler&&t.gcScheduler.stop(),yield t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class Tk{initialize(t,e){var r=this;return I(function*(){r.localStore||(r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(e),r.remoteStore=r.createRemoteStore(e),r.eventManager=r.createEventManager(e),r.syncEngine=r.createSyncEngine(e,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=s=>mQ(r.syncEngine,s,1),r.remoteStore.remoteSyncer.handleCredentialChange=CCe.bind(null,r.syncEngine),yield function qx(n,t){return Wx.apply(this,arguments)}(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(t){return new rCe}createDatastore(t){const e=Yg(t.databaseInfo.databaseId),r=new Fve(t.databaseInfo);return new Uve(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return e=this.localStore,r=this.datastore,s=t.asyncQueue,i=c=>mQ(this.syncEngine,c,0),o=eQ.C()?new eQ:new zve,new Wve(e,r,s,i,o);var e,r,s,i,o}createSyncEngine(t,e){return function(r,s,i,o,c,u,h){const g=new uCe(r,s,i,o,c,u);return h&&(g.dc=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return(t=I(function*(e){const r=ft(e);We("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield nh(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}function wk(n,t,e){if(!e)throw new Ue(be.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function yQ(n){if(!at.isDocumentKey(n))throw new Ue(be.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function EQ(n){if(at.isDocumentKey(n))throw new Ue(be.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function BM(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const t=(e=n).constructor?e.constructor.name:null;return t?`a custom ${t} object`:"an object"}}var e;return"function"==typeof n?"a function":wt()}function c1(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new Ue(be.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=BM(n);throw new Ue(be.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}const SQ=new Map;class PQ{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ue(be.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ue(be.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function xCe(n,t,e,r){if(!0===t&&!0===r)throw new Ue(be.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Qg{constructor(t,e,r,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new PQ({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ue(be.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Ue(be.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new PQ(t),void 0!==t.credentials&&(this._authCredentials=function(e){if(!e)return new Fme;switch(e.type){case"gapi":return new Gme(e.client,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ue(be.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=SQ.get(t);e&&(We("ComponentProvider","Removing Datastore"),SQ.delete(t),e.terminate())}(this),Promise.resolve()}}function TQ(n,t,e,r={}){var s;const i=(n=c1(n,Qg))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&Hf("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},i),{host:`${t}:${e}`,ssl:!1})),r.mockUserToken){let o,c;if("string"==typeof r.mockUserToken)o=r.mockUserToken,c=$i.MOCK_USER;else{o=function Mpe(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[NE(JSON.stringify({alg:"none",type:"JWT"})),NE(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=n._app)||void 0===s?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Ue(be.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new $i(u)}n._authCredentials=new Bme(new rK(o,c))}}class Os{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new k4(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Os(this.firestore,t,this._key)}}class so{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new so(this.firestore,t,this._query)}}class k4 extends so{constructor(t,e,r){super(t,e,Gf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Os(this.firestore,null,new at(t))}withConverter(t){return new k4(this.firestore,t,this._path)}}function kCe(n,t,...e){if(n=Jr(n),wk("collection","path",t),n instanceof Qg){const r=g1.fromString(t,...e);return EQ(r),new k4(n,null,r)}{if(!(n instanceof Os||n instanceof k4))throw new Ue(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(g1.fromString(t,...e));return EQ(r),new k4(n.firestore,null,r)}}function wQ(n,t,...e){if(n=Jr(n),1===arguments.length&&(t=iK.R()),wk("doc","path",t),n instanceof Qg){const r=g1.fromString(t,...e);return yQ(r),new Os(n,null,new at(r))}{if(!(n instanceof Os||n instanceof k4))throw new Ue(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(g1.fromString(t,...e));return yQ(r),new Os(n.firestore,n instanceof k4?n.converter:null,new at(r))}}class $M{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):ws("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class HCe{constructor(t,e,r,s){var i=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=s,this.user=$i.UNAUTHENTICATED,this.clientId=iK.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=I(function*(c){We("FirestoreClient","Received user=",c.uid),yield i.authCredentialListener(c),i.user=c});return function(c){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(We("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var t=this;return I(function*(){return{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ue(be.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(I(function*(){try{t.onlineComponents&&(yield t.onlineComponents.terminate()),t.offlineComponents&&(yield t.offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(r){const s=ih(r,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}function AQ(n,t){return bk.apply(this,arguments)}function bk(){return bk=I(function*(n,t){n.asyncQueue.verifyOperationInProgress(),We("FirestoreClient","Initializing OfflineComponentProvider");const e=yield n.getConfiguration();yield t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener(function(){var s=I(function*(i){r.isEqual(i)||(yield qX(t.localStore,i),r=i)});return function(i){return s.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=t}),bk.apply(this,arguments)}function NQ(n,t){return Ok.apply(this,arguments)}function Ok(){return Ok=I(function*(n,t){n.asyncQueue.verifyOperationInProgress();const e=yield Ak(n);We("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield t.initialize(e,r),n.setCredentialChangeListener(s=>cQ(t.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>cQ(t.remoteStore,i)),n.onlineComponents=t}),Ok.apply(this,arguments)}function Ak(n){return Nk.apply(this,arguments)}function Nk(){return Nk=I(function*(n){return n.offlineComponents||(We("FirestoreClient","Using default OfflineComponentProvider"),yield AQ(n,new ACe)),n.offlineComponents}),Nk.apply(this,arguments)}function UM(n){return Ik.apply(this,arguments)}function Ik(){return Ik=I(function*(n){return n.onlineComponents||(We("FirestoreClient","Using default OnlineComponentProvider"),yield NQ(n,new Tk)),n.onlineComponents}),Ik.apply(this,arguments)}function lh(n){return Lk.apply(this,arguments)}function Lk(){return Lk=I(function*(n){const t=yield UM(n),e=t.eventManager;return e.onListen=fCe.bind(null,t.syncEngine),e.onUnlisten=hCe.bind(null,t.syncEngine),e}),Lk.apply(this,arguments)}class jCe{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new Ox(this,"async_queue_retry"),this.Wc=()=>{const e=VM();e&&We("AsyncQueue","Visibility state changed to "+e.visibilityState),this.xo.Po()};const t=VM();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.Uc){this.Uc=!0,this.Qc=t||!1;const e=VM();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.Uc)return new Promise(()=>{});const e=new pi;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Lc.push(t),this.Jc()))}Jc(){var t=this;return I(function*(){if(0!==t.Lc.length){try{yield t.Lc[0](),t.Lc.shift(),t.xo.reset()}catch(e){if(!H0(e))throw e;We("AsyncQueue","Operation failed with retryable error: "+e)}t.Lc.length>0&&t.xo.Ro(()=>t.Jc())}})()}Hc(t){const e=this.Bc.then(()=>(this.Gc=!0,t().catch(r=>{throw this.Kc=r,this.Gc=!1,ws("INTERNAL UNHANDLED ERROR: ",function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+"\n"+i.stack),o}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=e,e}enqueueAfterDelay(t,e,r){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const s=jx.createAndSchedule(this,t,e,r,i=>this.Yc(i));return this.qc.push(s),s}zc(){this.Kc&&wt()}verifyOperationInProgress(){}Xc(){var t=this;return I(function*(){let e;do{e=t.Bc,yield e}while(e!==t.Bc)})()}Zc(t){for(const e of this.qc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then(()=>{this.qc.sort((e,r)=>e.targetTimeMs-r.targetTimeMs);for(const e of this.qc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()})}ea(t){this.jc.push(t)}Yc(t){const e=this.qc.indexOf(t);this.qc.splice(e,1)}}function Rk(n){return function(t,e){if("object"!=typeof t||null===t)return!1;const r=t;for(const s of["next","error","complete"])if(s in r&&"function"==typeof r[s])return!0;return!1}(n)}class Tr extends Qg{constructor(t,e,r,s){super(t,e,r,s),this.type="firestore",this._queue=new jCe,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||RQ(this),this._firestoreClient.terminate()}}function YCe(n,t){const r="string"==typeof n?n:t||"(default)",s=xf("object"==typeof n?n:QN(),"firestore").getImmediate({identifier:r});if(!s._initialized){const i=(n=>{const t=SZ("firestore");if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return"["===t[0]?[t.substring(1,e-1),r]:[t.substring(0,e),r]})();i&&TQ(s,...i)}return s}function js(n){return n._firestoreClient||RQ(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function RQ(n){var t;const e=n._freezeSettings(),r=(i=(null===(t=n._app)||void 0===t?void 0:t.options.appId)||"",new n_e(n._databaseId,i,n._persistenceKey,(c=e).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams));var i,c;n._firestoreClient=new HCe(n._authCredentials,n._appCheckCredentials,n._queue,r)}class p5{constructor(t){this._byteString=t}static fromBase64String(t){try{return new p5(gi.fromBase64String(t))}catch(e){throw new Ue(be.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new p5(gi.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class uh{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Ue(be.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bs(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class qM{constructor(t){this._methodName=t}}class Dk{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Ue(be.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ue(be.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return En(this._lat,t._lat)||En(this._long,t._long)}}const KCe=/^__.*__$/;class XCe{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return null!==this.fieldMask?new Kl(t,this.data,this.fieldMask,e,this.fieldTransforms):new Zf(t,this.data,e,this.fieldTransforms)}}class VQ{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new Kl(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function HQ(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wt()}}class WM{constructor(t,e,r,s,i,o){this.settings=t,this.databaseId=e,this.It=r,this.ignoreUndefinedProperties=s,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new WM(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.ua(t),s}ca(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.na(),s}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return ZM(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(HQ(this.sa)&&KCe.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class QCe{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.It=r||Yg(t)}da(t,e,r,s=!1){return new WM({sa:t,methodName:e,fa:r,path:bs.emptyPath(),oa:!1,la:s},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function fh(n){const t=n._freezeSettings(),e=Yg(n._databaseId);return new QCe(n._databaseId,!!t.ignoreUndefinedProperties,e)}function zk(n,t,e,r,s,i={}){const o=n.da(i.merge||i.mergeFields?2:0,t,e,s);Hk("Data must be an object, but it was:",o,r);const c=GQ(r,o);let u,h;if(i.merge)u=new Ka(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const g=[];for(const m of i.mergeFields){const E=Fk(t,m,e);if(!o.contains(E))throw new Ue(be.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);WQ(g,E)||g.push(E)}u=new Ka(g),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new XCe(new A2(c),u,h)}class Jg extends qM{_toFieldTransform(t){if(2!==t.sa)throw t.ha(1===t.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Jg}}class Vk extends qM{_toFieldTransform(t){return new Ig(t.path,new Wf)}isEqual(t){return t instanceof Vk}}function g5(n,t){if(qQ(n=Jr(n)))return Hk("Unsupported field value:",t,n),GQ(n,t);if(n instanceof qM)return function(e,r){if(!HQ(r.sa))throw r.ha(`${e._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${e._methodName}() is not currently supported inside arrays`);const s=e._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,t),null;if(void 0===n&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,r){const s=[];let i=0;for(const o of e){let c=g5(o,r.aa(i));null==c&&(c={nullValue:"NULL_VALUE"}),s.push(c),i++}return{arrayValue:{values:s}}}(n,t)}return function(e,r){if(null===(e=Jr(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return DK(r.It,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const s=es.fromDate(e);return{timestampValue:zg(r.It,s)}}if(e instanceof es){const s=new es(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:zg(r.It,s)}}if(e instanceof Dk)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof p5)return{bytesValue:rX(r.It,e._byteString)};if(e instanceof Os){const s=r.databaseId,i=e.firestore._databaseId;if(!i.isEqual(s))throw r.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:sx(e.firestore._databaseId||r.databaseId,e._key.path)}}throw r.ha(`Unsupported field value: ${BM(e)}`)}(n,t)}function GQ(n,t){const e={};return hK(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Qu(n,(r,s)=>{const i=g5(s,t.ra(r));null!=i&&(e[r]=i)}),{mapValue:{fields:e}}}function qQ(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof es||n instanceof Dk||n instanceof p5||n instanceof Os||n instanceof qM)}function Hk(n,t,e){if(!qQ(e)||"object"!=typeof(r=e)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=BM(e);throw t.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function Fk(n,t,e){if((t=Jr(t))instanceof uh)return t._internalPath;if("string"==typeof t)return jM(n,t);throw ZM("Field path arguments must be of type string or ",n,!1,void 0,e)}const nye=new RegExp("[~\\*/\\[\\]]");function jM(n,t,e){if(t.search(nye)>=0)throw ZM(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new uh(...t.split("."))._internalPath}catch{throw ZM(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function ZM(n,t,e,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let c=`Function ${t}() called with invalid data`;e&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new Ue(be.INVALID_ARGUMENT,c+n+u)}function WQ(n,t){return n.some(e=>e.isEqual(t))}class Bk{constructor(t,e,r,s,i){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Os(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new rye(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(YM("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class rye extends Bk{data(){return super.data()}}function YM(n,t){return"string"==typeof t?jM(n,t):t instanceof uh?t._internalPath:t._delegate._internalPath}function jQ(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Ue(be.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $k{}function sye(n,...t){for(const e of t)n=e._apply(n);return n}class iye extends $k{constructor(t,e,r){super(),this.ma=t,this.ga=e,this.ya=r,this.type="where"}_apply(t){const e=fh(t.firestore),r=function(s,i,o,c,u,h,g){let m;if(u.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new Ue(be.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){JQ(g,h);const b=[];for(const k of g)b.push(QQ(c,s,k));m={arrayValue:{values:b}}}else m=QQ(c,s,g)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||JQ(g,h),m=function UQ(n,t,e,r=!1){return g5(e,n.da(r?4:3,t))}(o,"where",g,"in"===h||"not-in"===h);const E=N2.create(u,h,m);return function(b,k){if(k.dt()){const j=JI(b);if(null!==j&&!j.isEqual(k.field))throw new Ue(be.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${j.toString()}' and '${k.field.toString()}'`);const oe=QI(b);null!==oe&&eJ(0,k.field,oe)}const U=function(j,oe){for(const ye of j.filters)if(oe.indexOf(ye.op)>=0)return ye.op;return null}(b,function(j){switch(j){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(k.op));if(null!==U)throw new Ue(be.INVALID_ARGUMENT,U===k.op?`Invalid query. You cannot use more than one '${k.op.toString()}' filter.`:`Invalid query. You cannot use '${k.op.toString()}' filters with '${U.toString()}' filters.`)}(s,E),E}(t._query,0,e,t.firestore._databaseId,this.ma,this.ga,this.ya);return new so(t.firestore,t.converter,function(s,i){const o=s.filters.concat([i]);return new Yl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(t._query,r))}}function oye(n,t,e){const r=t,s=YM("where",n);return new iye(s,r,e)}class aye extends $k{constructor(t,e){super(),this.ma=t,this.pa=e,this.type="orderBy"}_apply(t){const e=function(r,s,i){if(null!==r.startAt)throw new Ue(be.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Ue(be.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Uf(s,i);return function(c,u){if(null===QI(c)){const h=JI(c);null!==h&&eJ(0,h,u.field)}}(r,o),o}(t._query,this.ma,this.pa);return new so(t.firestore,t.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new Yl(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,e))}}function cye(n,t="asc"){const e=t,r=YM("orderBy",n);return new aye(r,e)}class ZQ extends $k{constructor(t,e,r){super(),this.type=t,this.Ia=e,this.Ta=r}_apply(t){return new so(t.firestore,t.converter,CM(t._query,this.Ia,this.Ta))}}function lye(n){return function MQ(n,t){if(t<=0)throw new Ue(be.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}("limit",n),new ZQ("limit",n,"F")}function QQ(n,t,e){if("string"==typeof(e=Jr(e))){if(""===e)throw new Ue(be.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ex(t)&&-1!==e.indexOf("/"))throw new Ue(be.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const r=t.path.child(g1.fromString(e));if(!at.isDocumentKey(r))throw new Ue(be.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return n5(n,new at(r))}if(e instanceof Os)return n5(n,e._key);throw new Ue(be.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${BM(e)}.`)}function JQ(n,t){if(!Array.isArray(n)||0===n.length)throw new Ue(be.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(n.length>10)throw new Ue(be.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function eJ(n,t,e){if(!e.isEqual(t))throw new Ue(be.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${e.toString()}' instead.`)}function Uk(n,t,e){let r;return r=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,r}class m5{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class hh extends Bk{constructor(t,e,r,s,i,o){super(t,e,r,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new KM(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(YM("DocumentSnapshot.get",t));if(null!==r)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}}class KM extends hh{data(t={}){return super.data(t)}}class dh{constructor(t,e,r,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new m5(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(r=>{t.call(e,new KM(this._firestore,this._userDataWriter,r.key,r,new m5(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ue(be.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new KM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new m5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||3!==o.type).map(o=>{const c=new KM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new m5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return 0!==o.type&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),1!==o.type&&(i=i.add(o.doc),h=i.indexOf(o.doc.key)),{type:fye(o.type),doc:c,oldIndex:u,newIndex:h}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function fye(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wt()}}function hye(n){n=c1(n,Os);const t=c1(n.firestore,Tr);return function kQ(n,t,e={}){const r=new pi;return n.asyncQueue.enqueueAndForget(I(function*(){return function(s,i,o,c,u){const h=new $M({next:m=>{i.enqueueAndForget(()=>Kx(s,g));const E=m.docs.has(o);!E&&m.fromCache?u.reject(new Ue(be.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&m.fromCache&&c&&"server"===c.source?u.reject(new Ue(be.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new Jx(Gf(o.path),h,{includeMetadataChanges:!0,Nu:!0});return Zx(s,g)}(yield lh(n),n.asyncQueue,t,e,r)})),r.promise}(js(t),n._key).then(e=>Gk(t,n,e))}class Y0 extends class uye{convertValue(t,e="none"){switch(t5(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ds(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Ju(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw wt()}}convertObject(t,e){const r={};return Qu(t.fields,(s,i)=>{r[s]=this.convertValue(i,e)}),r}convertGeoPoint(t){return new Dk(ds(t.latitude),ds(t.longitude))}convertArray(t,e){return(t.values||[]).map(r=>this.convertValue(r,e))}convertServerTimestamp(t,e){switch(e){case"previous":const r=pK(t);return null==r?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(Sg(t));default:return null}}convertTimestamp(t){const e=F0(t);return new es(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=g1.fromString(t);an(hX(r));const s=new e5(r.get(1),r.get(3)),i=new at(r.popFirst(5));return s.isEqual(e)||ws(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}{constructor(t){super(),this.firestore=t}convertBytes(t){return new p5(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Os(this.firestore,null,e)}}function dye(n){n=c1(n,so);const t=c1(n.firestore,Tr),e=js(t),r=new Y0(t);return jQ(n._query),function LQ(n,t,e={}){const r=new pi;return n.asyncQueue.enqueueAndForget(I(function*(){return function(s,i,o,c,u){const h=new $M({next:m=>{i.enqueueAndForget(()=>Kx(s,g)),m.fromCache&&"server"===c.source?u.reject(new Ue(be.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new Jx(o,h,{includeMetadataChanges:!0,Nu:!0});return Zx(s,g)}(yield lh(n),n.asyncQueue,t,e,r)})),r.promise}(e,n._query).then(s=>new dh(t,r,n,s))}function pye(n,t,e){n=c1(n,Os);const r=c1(n.firestore,Tr),s=Uk(n.converter,t,e);return em(r,[zk(fh(r),"setDoc",n._key,s,null!==n.converter,e).toMutation(n._key,$r.none())])}function gye(n,t,e,...r){n=c1(n,Os);const s=c1(n.firestore,Tr),i=fh(s);let o;return o="string"==typeof(t=Jr(t))||t instanceof uh?function $Q(n,t,e,r,s,i){const o=n.da(1,t,e),c=[Fk(t,r,e)],u=[s];if(i.length%2!=0)throw new Ue(be.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<i.length;E+=2)c.push(Fk(t,i[E])),u.push(i[E+1]);const h=[],g=A2.empty();for(let E=c.length-1;E>=0;--E)if(!WQ(h,c[E])){const b=c[E];let k=u[E];k=Jr(k);const U=o.ca(b);if(k instanceof Jg)h.push(b);else{const j=g5(k,U);null!=j&&(h.push(b),g.set(b,j))}}const m=new Ka(h);return new VQ(g,m,o.fieldTransforms)}(i,"updateDoc",n._key,t,e,r):function BQ(n,t,e,r){const s=n.da(1,t,e);Hk("Data must be an object, but it was:",s,r);const i=[],o=A2.empty();Qu(r,(u,h)=>{const g=jM(t,u,e);h=Jr(h);const m=s.ca(g);if(h instanceof Jg)i.push(g);else{const E=g5(h,m);null!=E&&(i.push(g),o.set(g,E))}});const c=new Ka(i);return new VQ(o,c,s.fieldTransforms)}(i,"updateDoc",n._key,t),em(s,[o.toMutation(n._key,$r.exists(!0))])}function mye(n){return em(c1(n.firestore,Tr),[new Yf(n._key,$r.none())])}function _ye(n,t){const e=c1(n.firestore,Tr),r=wQ(n),s=Uk(n.converter,t);return em(e,[zk(fh(n.firestore),"addDoc",r._key,s,null!==n.converter,{}).toMutation(r._key,$r.exists(!1))]).then(()=>r)}function vye(n,...t){var e,r,s;n=Jr(n);let i={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||Rk(t[o])||(i=t[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges};if(Rk(t[o])){const m=t[o];t[o]=null===(e=m.next)||void 0===e?void 0:e.bind(m),t[o+1]=null===(r=m.error)||void 0===r?void 0:r.bind(m),t[o+2]=null===(s=m.complete)||void 0===s?void 0:s.bind(m)}let u,h,g;if(n instanceof Os)h=c1(n.firestore,Tr),g=Gf(n._key.path),u={next:m=>{t[o]&&t[o](Gk(h,n,m))},error:t[o+1],complete:t[o+2]};else{const m=c1(n,so);h=c1(m.firestore,Tr),g=m._query;const E=new Y0(h);u={next:b=>{t[o]&&t[o](new dh(h,E,m,b))},error:t[o+1],complete:t[o+2]},jQ(n._query)}return function(m,E,b,k){const U=new $M(k),j=new Jx(E,U,b);return m.asyncQueue.enqueueAndForget(I(function*(){return Zx(yield lh(m),j)})),()=>{U.bc(),m.asyncQueue.enqueueAndForget(I(function*(){return Kx(yield lh(m),j)}))}}(js(h),g,c,u)}function em(n,t){return function(e,r){const s=new pi;return e.asyncQueue.enqueueAndForget(I(function*(){return function dCe(n,t,e){return sk.apply(this,arguments)}(yield function kk(n){return UM(n).then(t=>t.syncEngine)}(e),r,s)})),s.promise}(js(n),t)}function Gk(n,t,e){const r=e.docs.get(t._key),s=new Y0(n);return new hh(n,s,t._key,r,new m5(e.hasPendingWrites,e.fromCache),t.converter)}function L4(){return new Vk("serverTimestamp")}function nJ(n,t){if(null!=n&&null!=t&&"object"==typeof n){if(null!=n.equals)return n.equals(t);{const e=n,r=t;for(const s of Object.keys(e)){if(!(s in r))return!1;if(!1===nJ(e[s],r[s]))return!1}return!0}}return n===t}function qk(n){return null==n||function Mye(n){return"object"==typeof n&&null!=n&&null!=n.equals}(n)||function kbe(n){return"string"==typeof n||"number"==typeof n||"boolean"==typeof n||null===n}(n)||function Sye(n){if("object"==typeof n){for(const t in n)if(null!=n[t]&&!1===qk(n[t]))return!1;return null!=n&&n.constructor.prototype===Object.prototype}return!1}(n)}function Xa(n,t){if(qk(n)&&qk(t))return nJ(n,t);throw new Error(`Comparing non comparable objects: ${n.constructor.name} and ${t.constructor.name}`)}function Le(n,t,e){if(!1===n)throw void 0!==e&&console.log(e),As.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}!function(n,t=!0){Vf="9.14.0",ko(new to("firestore",(e,{instanceIdentifier:r,options:s})=>{const i=e.getProvider("app").getImmediate(),o=new Tr(new $me(e.getProvider("auth-internal")),new qme(e.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ue(be.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new e5(c.options.projectId,u)}(i,r),i);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),us(nK,"3.7.3",n),us(nK,"3.7.3","esm2017")}();class R4{}class xt extends R4{static fromFunctions(t,e){return new class extends xt{encodeMove(r){return t(r)}decodeMove(r){return e(r)}}}static identity(){function t(e){return e}return xt.fromFunctions(t,t)}static constant(t,e){return new class extends xt{encodeMove(r){return t}decodeMove(r){return e}}}static tuple(t,e,r){return new class extends xt{encodeMove(s){const i=e(s),o={};return Object.keys(i).forEach(c=>{o[c]=t[c].encode(i[c])}),o}decodeMove(s){const i={};return Object.keys(t).reverse().forEach(o=>{i[o]=t[o].decode(s[o])}),r(Object.values(i))}}}static disjunction(t,e,r){return new class extends xt{encodeMove(s){return r(s)?{type:"T",encoded:t.encode(s)}:{type:"U",encoded:e.encode(s)}}decodeMove(s){const i=Se.getNonNullable(s).type,o=Se.getNonNullable(s).encoded;return"T"===i?t.decode(o):e.decode(o)}}}static disjunction3(t,e,r,s,i){return new class extends xt{encodeMove(o){return s(o)?{type:"T",encoded:t.encode(o)}:i(o)?{type:"U",encoded:e.encode(o)}:{type:"V",encoded:r.encode(o)}}decodeMove(o){const c=Se.getNonNullable(o).type,u=Se.getNonNullable(o).encoded;return"T"===c?t.decode(u):"U"===c?e.decode(u):r.decode(u)}}}encode(t){return this.encodeMove(t)}decode(t){return Le(!1===Array.isArray(t),"MoveEncoder.decode called with an array"),this.decodeMove(t)}}class y{constructor(t){this.value=t}static of(t){return new y(t)}static ofNullable(t){return null==t?y.empty():y.of(t)}static empty(){return new y(null)}static getEncoder(t){return new class extends R4{encode(e){return e.isPresent()?t.encode(e.get()):null}decode(e){return null===e?y.empty():y.of(t.decode(e))}}}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(t){return this.isPresent()?this.value:t}equals(t){return this.isAbsent()?t.isAbsent():!t.isAbsent()&&Xa(this.value,t.value)}equalsValue(t){return this.equals(y.of(t))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(t){return this.isPresent()?y.of(t(this.get())):y.empty()}}class _e{static success(t){return new Pye(t)}static failure(t){return new Tye(t)}constructor(){}equals(t){return this.isFailure()?t.isFailure()&&this.getReason()===t.getReason():!t.isFailure()&&Xa(this.get(),t.get())}}class Pye extends _e{constructor(t){super(),this.value=t}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(t){return t}toOptional(){return y.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class Tye extends _e{constructor(t){super(),this.reason=t}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(t){return this.getReason()}toOptional(){return y.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return _e.failure(this.reason)}}var z;!function(n){n.SUCCESS=_e.success(void 0),n.ofFallible=function t(r){return r.isSuccess()?n.SUCCESS:n.failure(r.getReason())},n.failure=function e(r){return _e.failure(r)}}(z||(z={})),us("firebase","9.14.0","app");const rJ="@firebase/installations",Wk="0.5.16",iJ=`w:${Wk}`,oJ="FIS_v2",Jl=new b4("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function aJ(n){return n instanceof Lc&&n.code.includes("request-failed")}function jk({projectId:n}){return`https://firebaseinstallations.googleapis.com/v1/projects/${n}/installations`}function cJ(n){return{token:n.token,requestStatus:2,expiresIn:kye(n.expiresIn),creationTime:Date.now()}}function Zk(n,t){return Yk.apply(this,arguments)}function Yk(){return Yk=I(function*(n,t){const r=(yield t.json()).error;return Jl.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}),Yk.apply(this,arguments)}function lJ({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function uJ(n,{refreshToken:t}){const e=lJ(n);return e.append("Authorization",function Lye(n){return`${oJ} ${n}`}(t)),e}function Kk(n){return Xk.apply(this,arguments)}function Xk(){return Xk=I(function*(n){const t=yield n();return t.status>=500&&t.status<600?n():t}),Xk.apply(this,arguments)}function kye(n){return Number(n.replace("s","000"))}function Rye(n,t){return Qk.apply(this,arguments)}function Qk(){return Qk=I(function*({appConfig:n,heartbeatServiceProvider:t},{fid:e}){const r=jk(n),s=lJ(n),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({fid:e,authVersion:oJ,appId:n.appId,sdkVersion:iJ})},u=yield Kk(()=>fetch(r,c));if(u.ok){const h=yield u.json();return{fid:h.fid||e,registrationStatus:2,refreshToken:h.refreshToken,authToken:cJ(h.authToken)}}throw yield Zk("Create Installation",u)}),Qk.apply(this,arguments)}function fJ(n){return new Promise(t=>{setTimeout(t,n)})}const zye=/^[cdef][\w-]{21}$/;function Vye(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const e=function Hye(n){return function Dye(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return zye.test(e)?e:""}catch{return""}}function ph(n){return`${n.appName}!${n.appId}`}const gh=new Map;function hJ(n,t){const e=ph(n);dJ(e,t),function $ye(n,t){const e=function pJ(){return!_5&&"BroadcastChannel"in self&&(_5=new BroadcastChannel("[Firebase] FID Change"),_5.onmessage=n=>{dJ(n.data.key,n.data.fid)}),_5}();e&&e.postMessage({key:n,fid:t}),function gJ(){0===gh.size&&_5&&(_5.close(),_5=null)}()}(e,t)}function dJ(n,t){const e=gh.get(n);if(e)for(const r of e)r(t)}let _5=null;const v5="firebase-installations-store";let eL=null;function tL(){return eL||(eL=RE("firebase-installations-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(v5)}})),eL}function QM(n,t){return nL.apply(this,arguments)}function nL(){return nL=I(function*(n,t){const e=ph(n),s=(yield tL()).transaction(v5,"readwrite"),i=s.objectStore(v5),o=yield i.get(e);return yield i.put(t,e),yield s.done,(!o||o.fid!==t.fid)&&hJ(n,t.fid),t}),nL.apply(this,arguments)}function rL(n){return sL.apply(this,arguments)}function sL(){return sL=I(function*(n){const t=ph(n),r=(yield tL()).transaction(v5,"readwrite");yield r.objectStore(v5).delete(t),yield r.done}),sL.apply(this,arguments)}function tm(n,t){return iL.apply(this,arguments)}function iL(){return iL=I(function*(n,t){const e=ph(n),s=(yield tL()).transaction(v5,"readwrite"),i=s.objectStore(v5),o=yield i.get(e),c=t(o);return void 0===c?yield i.delete(e):yield i.put(c,e),yield s.done,c&&(!o||o.fid!==c.fid)&&hJ(n,c.fid),c}),iL.apply(this,arguments)}function oL(n){return aL.apply(this,arguments)}function aL(){return aL=I(function*(n){let t;const e=yield tm(n.appConfig,r=>{const s=qye(r),i=Wye(n,s);return t=i.registrationPromise,i.installationEntry});return""===e.fid?{installationEntry:yield t}:{installationEntry:e,registrationPromise:t}}),aL.apply(this,arguments)}function qye(n){return _J(n||{fid:Vye(),registrationStatus:0})}function Wye(n,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Jl.create("app-offline"))};const e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function jye(n,t){return cL.apply(this,arguments)}(n,e);return{installationEntry:e,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Zye(n)}:{installationEntry:t}}function cL(){return cL=I(function*(n,t){try{const e=yield Rye(n,t);return QM(n.appConfig,e)}catch(e){throw aJ(e)&&409===e.customData.serverCode?yield rL(n.appConfig):yield QM(n.appConfig,{fid:t.fid,registrationStatus:0}),e}}),cL.apply(this,arguments)}function Zye(n){return lL.apply(this,arguments)}function lL(){return lL=I(function*(n){let t=yield mJ(n.appConfig);for(;1===t.registrationStatus;)yield fJ(100),t=yield mJ(n.appConfig);if(0===t.registrationStatus){const{installationEntry:e,registrationPromise:r}=yield oL(n);return r||e}return t}),lL.apply(this,arguments)}function mJ(n){return tm(n,t=>{if(!t)throw Jl.create("installation-not-found");return _J(t)})}function _J(n){return function Yye(n){return 1===n.registrationStatus&&n.registrationTime+1e4<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function Kye(n,t){return uL.apply(this,arguments)}function uL(){return uL=I(function*({appConfig:n,heartbeatServiceProvider:t},e){const r=Xye(n,e),s=uJ(n,e),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({installation:{sdkVersion:iJ,appId:n.appId}})},u=yield Kk(()=>fetch(r,c));if(u.ok)return cJ(yield u.json());throw yield Zk("Generate Auth Token",u)}),uL.apply(this,arguments)}function Xye(n,{fid:t}){return`${jk(n)}/${t}/authTokens:generate`}function fL(n){return hL.apply(this,arguments)}function hL(){return hL=I(function*(n,t=!1){let e;const r=yield tm(n.appConfig,i=>{if(!CJ(i))throw Jl.create("not-registered");const o=i.authToken;if(!t&&eEe(o))return i;if(1===o.requestStatus)return e=Qye(n,t),i;{if(!navigator.onLine)throw Jl.create("app-offline");const c=nEe(i);return e=Jye(n,c),c}});return e?yield e:r.authToken}),hL.apply(this,arguments)}function Qye(n,t){return dL.apply(this,arguments)}function dL(){return dL=I(function*(n,t){let e=yield vJ(n.appConfig);for(;1===e.authToken.requestStatus;)yield fJ(100),e=yield vJ(n.appConfig);const r=e.authToken;return 0===r.requestStatus?fL(n,t):r}),dL.apply(this,arguments)}function vJ(n){return tm(n,t=>{if(!CJ(t))throw Jl.create("not-registered");return function rEe(n){return 1===n.requestStatus&&n.requestTime+1e4<Date.now()}(t.authToken)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}function Jye(n,t){return pL.apply(this,arguments)}function pL(){return pL=I(function*(n,t){try{const e=yield Kye(n,t),r=Object.assign(Object.assign({},t),{authToken:e});return yield QM(n.appConfig,r),e}catch(e){if(!aJ(e)||401!==e.customData.serverCode&&404!==e.customData.serverCode){const r=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});yield QM(n.appConfig,r)}else yield rL(n.appConfig);throw e}}),pL.apply(this,arguments)}function CJ(n){return void 0!==n&&2===n.registrationStatus}function eEe(n){return 2===n.requestStatus&&!function tEe(n){const t=Date.now();return t<n.creationTime||n.creationTime+n.expiresIn<t+36e5}(n)}function nEe(n){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:t})}function gL(){return gL=I(function*(n){const t=n,{installationEntry:e,registrationPromise:r}=yield oL(t);return r?r.catch(console.error):fL(t).catch(console.error),e.fid}),gL.apply(this,arguments)}function mL(){return mL=I(function*(n,t=!1){const e=n;return yield oEe(e),(yield fL(e,t)).token}),mL.apply(this,arguments)}function oEe(n){return _L.apply(this,arguments)}function _L(){return _L=I(function*(n){const{registrationPromise:t}=yield oL(n);t&&(yield t)}),_L.apply(this,arguments)}function yL(n){return Jl.create("missing-app-config-values",{valueName:n})}const yJ="installations",fEe=n=>{const t=n.getProvider("app").getImmediate(),e=function lEe(n){if(!n||!n.options)throw yL("App Configuration");if(!n.name)throw yL("App Name");const t=["projectId","apiKey","appId"];for(const e of t)if(!n.options[e])throw yL(e);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(t);return{app:t,appConfig:e,heartbeatServiceProvider:xf(t,"heartbeat"),_delete:()=>Promise.resolve()}},hEe=n=>{const e=xf(n.getProvider("app").getImmediate(),yJ).getImmediate();return{getId:()=>function sEe(n){return gL.apply(this,arguments)}(e),getToken:s=>function iEe(n){return mL.apply(this,arguments)}(e,s)}};(function dEe(){ko(new to(yJ,fEe,"PUBLIC")),ko(new to("installations-internal",hEe,"PRIVATE"))})(),us(rJ,Wk),us(rJ,Wk,"esm2017");const EL="@firebase/remote-config",va=new b4("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class PEe{constructor(t,e,r,s){this.client=t,this.storage=e,this.storageCache=r,this.logger=s}isCachedDataFresh(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-e,s=r<=t;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${t}. Is cache hit: ${s}.`),s}fetch(t){var e=this;return I(function*(){const[r,s]=yield Promise.all([e.storage.getLastSuccessfulFetchTimestampMillis(),e.storage.getLastSuccessfulFetchResponse()]);if(s&&e.isCachedDataFresh(t.cacheMaxAgeMillis,r))return s;t.eTag=s&&s.eTag;const i=yield e.client.fetch(t),o=[e.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===i.status&&o.push(e.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(o),i})()}}function TEe(n=navigator){return n.languages&&n.languages[0]||n.language}class wEe{constructor(t,e,r,s,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=r,this.projectId=s,this.apiKey=i,this.appId=o}fetch(t){var e=this;return I(function*(){var r,s,i;const[o,c]=yield Promise.all([e.firebaseInstallations.getId(),e.firebaseInstallations.getToken()]),h=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${e.projectId}/namespaces/${e.namespace}:fetch?key=${e.apiKey}`,g={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},m={sdk_version:e.sdkVersion,app_instance_id:o,app_instance_id_token:c,app_id:e.appId,language_code:TEe()},E={method:"POST",headers:g,body:JSON.stringify(m)},b=fetch(h,E),k=new Promise((ke,Ge)=>{t.signal.addEventListener(()=>{const Xe=new Error("The operation was aborted.");Xe.name="AbortError",Ge(Xe)})});let U;try{yield Promise.race([b,k]),U=yield b}catch(ke){let Ge="fetch-client-network";throw"AbortError"===(null===(r=ke)||void 0===r?void 0:r.name)&&(Ge="fetch-timeout"),va.create(Ge,{originalErrorMessage:null===(s=ke)||void 0===s?void 0:s.message})}let j=U.status;const oe=U.headers.get("ETag")||void 0;let ye,te;if(200===U.status){let ke;try{ke=yield U.json()}catch(Ge){throw va.create("fetch-client-parse",{originalErrorMessage:null===(i=Ge)||void 0===i?void 0:i.message})}ye=ke.entries,te=ke.state}if("INSTANCE_STATE_UNSPECIFIED"===te?j=500:"NO_CHANGE"===te?j=304:("NO_TEMPLATE"===te||"EMPTY_CONFIG"===te)&&(ye={}),304!==j&&200!==j)throw va.create("fetch-status",{httpStatus:j});return{status:j,eTag:oe,config:ye}})()}}class AEe{constructor(t,e){this.client=t,this.storage=e}fetch(t){var e=this;return I(function*(){const r=(yield e.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return e.attemptFetch(t,r)})()}attemptFetch(t,{throttleEndTimeMillis:e,backoffCount:r}){var s=this;return I(function*(){yield function bEe(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(va.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(t.signal,e);try{const i=yield s.client.fetch(t);return yield s.storage.deleteThrottleMetadata(),i}catch(i){if(!function OEe(n){if(!(n instanceof Lc&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i))throw i;const o={throttleEndTimeMillis:Date.now()+$N(r),backoffCount:r+1};return yield s.storage.setThrottleMetadata(o),s.attemptFetch(t,o)}})()}}class xEe{constructor(t,e,r,s,i){this.app=t,this._client=e,this._storageCache=r,this._storage=s,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function eS(n,t){var e;const r=n.target.error||void 0;return va.create(t,{originalErrorMessage:r&&(null===(e=r)||void 0===e?void 0:e.message)})}const C5="app_namespace_store";class DEe{constructor(t,e,r,s=function REe(){return new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase_remote_config",1);r.onerror=s=>{t(eS(s,"storage-open"))},r.onsuccess=s=>{n(s.target.result)},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(C5,{keyPath:"compositeKey"})}}catch(r){t(va.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}})}()){this.appId=t,this.appName=e,this.namespace=r,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(t){return this.set("last_fetch_status",t)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(t){return this.set("last_successful_fetch_timestamp_millis",t)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(t){return this.set("last_successful_fetch_response",t)}getActiveConfig(){return this.get("active_config")}setActiveConfig(t){return this.set("active_config",t)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(t){return this.set("active_config_etag",t)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(t){return this.set("throttle_metadata",t)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(t){var e=this;return I(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([C5],"readonly").objectStore(C5),h=e.createCompositeKey(t);try{const g=u.get(h);g.onerror=m=>{i(eS(m,"storage-get"))},g.onsuccess=m=>{const E=m.target.result;s(E?E.value:void 0)}}catch(g){i(va.create("storage-get",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}set(t,e){var r=this;return I(function*(){const s=yield r.openDbPromise;return new Promise((i,o)=>{var c;const h=s.transaction([C5],"readwrite").objectStore(C5),g=r.createCompositeKey(t);try{const m=h.put({compositeKey:g,value:e});m.onerror=E=>{o(eS(E,"storage-set"))},m.onsuccess=()=>{i()}}catch(m){o(va.create("storage-set",{originalErrorMessage:null===(c=m)||void 0===c?void 0:c.message}))}})})()}delete(t){var e=this;return I(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([C5],"readwrite").objectStore(C5),h=e.createCompositeKey(t);try{const g=u.delete(h);g.onerror=m=>{i(eS(m,"storage-delete"))},g.onsuccess=()=>{s()}}catch(g){i(va.create("storage-delete",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}createCompositeKey(t){return[this.appId,this.appName,this.namespace,t].join()}}class zEe{constructor(t){this.storage=t}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var t=this;return I(function*(){const e=t.storage.getLastFetchStatus(),r=t.storage.getLastSuccessfulFetchTimestampMillis(),s=t.storage.getActiveConfig(),i=yield e;i&&(t.lastFetchStatus=i);const o=yield r;o&&(t.lastSuccessfulFetchTimestampMillis=o);const c=yield s;c&&(t.activeConfig=c)})()}setLastFetchStatus(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)}setLastSuccessfulFetchTimestampMillis(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)}setActiveConfig(t){return this.activeConfig=t,this.storage.setActiveConfig(t)}}function HEe(){return wL.apply(this,arguments)}function wL(){return(wL=I(function*(){if(!$u())return!1;try{return yield Xp()}catch{return!1}})).apply(this,arguments)}!function VEe(){ko(new to("remote-config",function n(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw va.create("registration-window");if(!$u())throw va.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:c}=r.options;if(!i)throw va.create("registration-project-id");if(!o)throw va.create("registration-api-key");if(!c)throw va.create("registration-app-id");const u=new DEe(c,r.name,e=e||"firebase"),h=new zEe(u),g=new If(EL);g.logLevel=p1.ERROR;const m=new wEe(s,kf,e,i,o,c),E=new AEe(m,u),b=new PEe(E,u,h,g),k=new xEe(r,b,h,u,g);return function EEe(n){const t=Jr(n);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0}))}(k),k},"PUBLIC").setMultipleInstances(!0)),us(EL,"0.3.15"),us(EL,"0.3.15","esm2017")}();const FEe="/firebase-messaging-sw.js",BEe="/firebase-cloud-messaging-push-scope",PJ="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",TJ="google.c.a.c_id",UEe="google.c.a.c_l",GEe="google.c.a.ts",qEe="google.c.a.e";var mh=(()=>(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"}(mh||(mh={})),mh))();function e6(n){const t=new Uint8Array(n);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function WEe(n){const e=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(e),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}const bL="fcm_token_details_db",wJ="fcm_token_object_Store";function ZEe(n){return OL.apply(this,arguments)}function OL(){return OL=I(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(i=>i.name).includes(bL))return null;let t=null;return(yield RE(bL,5,{upgrade:(r=I(function*(s,i,o,c){var u;if(i<2||!s.objectStoreNames.contains(wJ))return;const h=c.objectStore(wJ),g=yield h.index("fcmSenderId").get(n);if(yield h.clear(),g)if(2===i){const m=g;if(!m.auth||!m.p256dh||!m.endpoint)return;t={token:m.fcmToken,createTime:null!==(u=m.createTime)&&void 0!==u?u:Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:"string"==typeof m.vapidKey?m.vapidKey:e6(m.vapidKey)}}}else if(3===i){const m=g;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:e6(m.auth),p256dh:e6(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:e6(m.vapidKey)}}}else if(4===i){const m=g;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:e6(m.auth),p256dh:e6(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:e6(m.vapidKey)}}}}),function(i,o,c,u){return r.apply(this,arguments)})})).close(),yield YN(bL),yield YN("fcm_vapid_details_db"),yield YN("undefined"),YEe(t)?t:null;var r}),OL.apply(this,arguments)}function YEe(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:t}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}const y5="firebase-messaging-store";let AL=null;function NL(){return AL||(AL=RE("firebase-messaging-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(y5)}})),AL}function bJ(n){return IL.apply(this,arguments)}function IL(){return IL=I(function*(n){const t=RL(n),r=yield(yield NL()).transaction(y5).objectStore(y5).get(t);if(r)return r;{const s=yield ZEe(n.appConfig.senderId);if(s)return yield xL(n,s),s}}),IL.apply(this,arguments)}function xL(n,t){return kL.apply(this,arguments)}function kL(){return kL=I(function*(n,t){const e=RL(n),s=(yield NL()).transaction(y5,"readwrite");return yield s.objectStore(y5).put(t,e),yield s.done,t}),kL.apply(this,arguments)}function QEe(n){return LL.apply(this,arguments)}function LL(){return LL=I(function*(n){const t=RL(n),r=(yield NL()).transaction(y5,"readwrite");yield r.objectStore(y5).delete(t),yield r.done}),LL.apply(this,arguments)}function RL({appConfig:n}){return n.appId}const I2=new b4("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function eMe(n,t){return DL.apply(this,arguments)}function DL(){return DL=I(function*(n,t){var e;const r=yield FL(n),s=AJ(t),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(HL(n.appConfig),i)).json()}catch(c){throw I2.create("token-subscribe-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw I2.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw I2.create("token-subscribe-no-token");return o.token}),DL.apply(this,arguments)}function tMe(n,t){return zL.apply(this,arguments)}function zL(){return zL=I(function*(n,t){var e;const r=yield FL(n),s=AJ(t.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(`${HL(n.appConfig)}/${t.token}`,i)).json()}catch(c){throw I2.create("token-update-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw I2.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw I2.create("token-update-no-token");return o.token}),zL.apply(this,arguments)}function OJ(n,t){return VL.apply(this,arguments)}function VL(){return VL=I(function*(n,t){var e;const s={method:"DELETE",headers:yield FL(n)};try{const o=yield(yield fetch(`${HL(n.appConfig)}/${t}`,s)).json();if(o.error)throw I2.create("token-unsubscribe-failed",{errorInfo:o.error.message})}catch(i){throw I2.create("token-unsubscribe-failed",{errorInfo:null===(e=i)||void 0===e?void 0:e.toString()})}}),VL.apply(this,arguments)}function HL({projectId:n}){return`https://fcmregistrations.googleapis.com/v1/projects/${n}/registrations`}function FL(n){return BL.apply(this,arguments)}function BL(){return BL=I(function*({appConfig:n,installations:t}){const e=yield t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${e}`})}),BL.apply(this,arguments)}function AJ({p256dh:n,auth:t,endpoint:e,vapidKey:r}){const s={web:{endpoint:e,auth:t,p256dh:n}};return r!==PJ&&(s.web.applicationPubKey=r),s}function rMe(n){return $L.apply(this,arguments)}function $L(){return $L=I(function*(n){const t=yield iMe(n.swRegistration,n.vapidKey),e={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:t.endpoint,auth:e6(t.getKey("auth")),p256dh:e6(t.getKey("p256dh"))},r=yield bJ(n.firebaseDependencies);if(r){if(oMe(r.subscriptionOptions,e))return Date.now()>=r.createTime+6048e5?sMe(n,{token:r.token,createTime:Date.now(),subscriptionOptions:e}):r.token;try{yield OJ(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return IJ(n.firebaseDependencies,e)}return IJ(n.firebaseDependencies,e)}),$L.apply(this,arguments)}function NJ(n){return UL.apply(this,arguments)}function UL(){return UL=I(function*(n){const t=yield bJ(n.firebaseDependencies);t&&(yield OJ(n.firebaseDependencies,t.token),yield QEe(n.firebaseDependencies));const e=yield n.swRegistration.pushManager.getSubscription();return!e||e.unsubscribe()}),UL.apply(this,arguments)}function sMe(n,t){return GL.apply(this,arguments)}function GL(){return GL=I(function*(n,t){try{const e=yield tMe(n.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:e,createTime:Date.now()});return yield xL(n.firebaseDependencies,r),e}catch(e){throw yield NJ(n),e}}),GL.apply(this,arguments)}function IJ(n,t){return qL.apply(this,arguments)}function qL(){return qL=I(function*(n,t){const r={token:yield eMe(n,t),createTime:Date.now(),subscriptionOptions:t};return yield xL(n,r),r.token}),qL.apply(this,arguments)}function iMe(n,t){return WL.apply(this,arguments)}function WL(){return WL=I(function*(n,t){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:WEe(t)})}),WL.apply(this,arguments)}function oMe(n,t){return t.vapidKey===n.vapidKey&&t.endpoint===n.endpoint&&t.auth===n.auth&&t.p256dh===n.p256dh}function xJ(n){const t={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function aMe(n,t){if(!t.notification)return;n.notification={};const e=t.notification.title;e&&(n.notification.title=e);const r=t.notification.body;r&&(n.notification.body=r);const s=t.notification.image;s&&(n.notification.image=s);const i=t.notification.icon;i&&(n.notification.icon=i)}(t,n),function cMe(n,t){!t.data||(n.data=t.data)}(t,n),function lMe(n,t){var e,r,s,i,o;if(!(t.fcmOptions||null!==(e=t.notification)&&void 0!==e&&e.click_action))return;n.fcmOptions={};const c=null!==(s=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==s?s:null===(i=t.notification)||void 0===i?void 0:i.click_action;c&&(n.fcmOptions.link=c);const u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(n.fcmOptions.analyticsLabel=u)}(t,n),t}function uMe(n){return"object"==typeof n&&!!n&&TJ in n}function kJ(n,t){const e=[];for(let r=0;r<n.length;r++)e.push(n.charAt(r)),r<t.length&&e.push(t.charAt(r));return e.join("")}function jL(n){return I2.create("missing-app-config-values",{valueName:n})}kJ("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),kJ("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class hMe{constructor(t,e,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=function fMe(n){if(!n||!n.options)throw jL("App Configuration Object");if(!n.name)throw jL("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:e}=n;for(const r of t)if(!e[r])throw jL(r);return{appName:n.name,projectId:e.projectId,apiKey:e.apiKey,appId:e.appId,senderId:e.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:s,installations:e,analyticsProvider:r}}_delete(){return Promise.resolve()}}function LJ(n){return ZL.apply(this,arguments)}function ZL(){return ZL=I(function*(n){var t;try{n.swRegistration=yield navigator.serviceWorker.register(FEe,{scope:BEe}),n.swRegistration.update().catch(()=>{})}catch(e){throw I2.create("failed-service-worker-registration",{browserErrorMessage:null===(t=e)||void 0===t?void 0:t.message})}}),ZL.apply(this,arguments)}function dMe(n,t){return YL.apply(this,arguments)}function YL(){return YL=I(function*(n,t){if(!t&&!n.swRegistration&&(yield LJ(n)),t||!n.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw I2.create("invalid-sw-registration");n.swRegistration=t}}),YL.apply(this,arguments)}function pMe(n,t){return KL.apply(this,arguments)}function KL(){return KL=I(function*(n,t){t?n.vapidKey=t:n.vapidKey||(n.vapidKey=PJ)}),KL.apply(this,arguments)}function XL(){return XL=I(function*(n,t){if(!navigator)throw I2.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw I2.create("permission-blocked");return yield pMe(n,t?.vapidKey),yield dMe(n,t?.serviceWorkerRegistration),rMe(n)}),XL.apply(this,arguments)}function gMe(n,t,e){return QL.apply(this,arguments)}function QL(){return QL=I(function*(n,t,e){const r=mMe(t);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:e[TJ],message_name:e[UEe],message_time:e[GEe],message_device_time:Math.floor(Date.now()/1e3)})}),QL.apply(this,arguments)}function mMe(n){switch(n){case mh.NOTIFICATION_CLICKED:return"notification_open";case mh.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function JL(){return JL=I(function*(n,t){const e=t.data;if(!e.isFirebaseMessaging)return;n.onMessageHandler&&e.messageType===mh.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(xJ(e)):n.onMessageHandler.next(xJ(e)));const r=e.data;uMe(r)&&"1"===r[qEe]&&(yield gMe(n,e.messageType,r))}),JL.apply(this,arguments)}const DJ="@firebase/messaging",vMe=n=>{const t=new hMe(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>function _Me(n,t){return JL.apply(this,arguments)}(t,e)),t},CMe=n=>{const t=n.getProvider("messaging").getImmediate();return{getToken:r=>function RJ(n,t){return XL.apply(this,arguments)}(t,r)}};function VJ(){return eR.apply(this,arguments)}function eR(){return(eR=I(function*(){try{yield Xp()}catch{return!1}return typeof window<"u"&&$u()&&VN()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function yMe(){ko(new to("messaging",vMe,"PUBLIC")),ko(new to("messaging-internal",CMe,"PRIVATE")),us(DJ,"0.11.0"),us(DJ,"0.11.0","esm2017")}();const tS="analytics",SMe="firebase_id",wMe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",HJ="https://www.googletagmanager.com/gtag/js",x2=new If("@firebase/analytics");function FJ(n){return Promise.all(n.map(t=>t.catch(e=>e)))}function bMe(n,t){const e=document.createElement("script");e.src=`${HJ}?l=${n}&id=${t}`,e.async=!0,document.head.appendChild(e)}function AMe(n,t,e,r,s,i){return rR.apply(this,arguments)}function rR(){return rR=I(function*(n,t,e,r,s,i){const o=r[s];try{if(o)yield t[o];else{const u=(yield FJ(e)).find(h=>h.measurementId===s);u&&(yield t[u.appId])}}catch(c){x2.error(c)}n("config",s,i)}),rR.apply(this,arguments)}function NMe(n,t,e,r,s){return sR.apply(this,arguments)}function sR(){return sR=I(function*(n,t,e,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const c=yield FJ(e);for(const u of o){const h=c.find(m=>m.measurementId===u),g=h&&t[h.appId];if(!g){i=[];break}i.push(g)}}0===i.length&&(i=Object.values(t)),yield Promise.all(i),n("event",r,s||{})}catch(i){x2.error(i)}}),sR.apply(this,arguments)}function kMe(n){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(HJ)&&e.src.includes(n))return e;return null}const Qa=new b4("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),BJ=new class zMe{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function VMe(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function HMe(n){return iR.apply(this,arguments)}function iR(){return iR=I(function*(n){var t;const{appId:e,apiKey:r}=n,s={method:"GET",headers:VMe(r)},i=wMe.replace("{app-id}",e),o=yield fetch(i,s);if(200!==o.status&&304!==o.status){let c="";try{const u=yield o.json();null!==(t=u.error)&&void 0!==t&&t.message&&(c=u.error.message)}catch{}throw Qa.create("config-fetch-failed",{httpStatus:o.status,responseMessage:c})}return o.json()}),iR.apply(this,arguments)}function FMe(n){return oR.apply(this,arguments)}function oR(){return oR=I(function*(n,t=BJ,e){const{appId:r,apiKey:s,measurementId:i}=n.options;if(!r)throw Qa.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Qa.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new UMe;return setTimeout(I(function*(){c.abort()}),void 0!==e?e:6e4),$J({appId:r,apiKey:s,measurementId:i},o,c,t)}),oR.apply(this,arguments)}function $J(n,t,e){return aR.apply(this,arguments)}function aR(){return aR=I(function*(n,{throttleEndTimeMillis:t,backoffCount:e},r,s=BJ){var i,o;const{appId:c,measurementId:u}=n;try{yield BMe(r,t)}catch(h){if(u)return x2.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${null===(i=h)||void 0===i?void 0:i.message}]`),{appId:c,measurementId:u};throw h}try{const h=yield HMe(n);return s.deleteThrottleMetadata(c),h}catch(h){const g=h;if(!$Me(g)){if(s.deleteThrottleMetadata(c),u)return x2.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:c,measurementId:u};throw h}const m=503===Number(null===(o=g?.customData)||void 0===o?void 0:o.httpStatus)?$N(e,s.intervalMillis,30):$N(e,s.intervalMillis),E={throttleEndTimeMillis:Date.now()+m,backoffCount:e+1};return s.setThrottleMetadata(c,E),x2.debug(`Calling attemptFetch again in ${m} millis`),$J(n,E,r,s)}}),aR.apply(this,arguments)}function BMe(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(Qa.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function $Me(n){if(!(n instanceof Lc&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}class UMe{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let cR,pR;function lR(){return lR=I(function*(n,t,e,r,s){if(s&&s.global)n("event",e,r);else{const i=yield t;n("event",e,Object.assign(Object.assign({},r),{send_to:i}))}}),lR.apply(this,arguments)}function UJ(n){pR=n}function GJ(n){cR=n}function YMe(){return gR.apply(this,arguments)}function gR(){return gR=I(function*(){var n;if(!$u())return x2.warn(Qa.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield Xp()}catch(t){return x2.warn(Qa.create("indexeddb-unavailable",{errorInfo:null===(n=t)||void 0===n?void 0:n.toString()}).message),!1}return!0}),gR.apply(this,arguments)}function mR(){return mR=I(function*(n,t,e,r,s,i,o){var c;const u=FMe(n);u.then(b=>{e[b.measurementId]=b.appId,n.options.measurementId&&b.measurementId!==n.options.measurementId&&x2.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${b.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(b=>x2.error(b)),t.push(u);const h=YMe().then(b=>{if(b)return r.getId()}),[g,m]=yield Promise.all([u,h]);kMe(i)||bMe(i,g.measurementId),pR&&(s("consent","default",pR),UJ(void 0)),s("js",new Date);const E=null!==(c=o?.config)&&void 0!==c?c:{};return E.origin="firebase",E.update=!0,null!=m&&(E[SMe]=m),s("config",g.measurementId,E),cR&&(s("set",cR),GJ(void 0)),g.measurementId}),mR.apply(this,arguments)}class XMe{constructor(t){this.app=t}_delete(){return delete t6[this.app.options.appId],Promise.resolve()}}let t6={},qJ=[];const WJ={};let ZJ,n6,nS="dataLayer",_R=!1;function JMe(n,t,e){!function QMe(){const n=[];if(zN()&&n.push("This is a browser extension environment."),VN()||n.push("Cookies are not available."),n.length>0){const t=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),e=Qa.create("invalid-analytics-context",{errorInfo:t});x2.warn(e.message)}}();const r=n.options.appId;if(!r)throw Qa.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw Qa.create("no-api-key");x2.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=t6[r])throw Qa.create("already-exists",{id:r});if(!_R){!function OMe(n){let t=[];Array.isArray(window[n])?t=window[n]:window[n]=t}(nS);const{wrappedGtag:i,gtagCore:o}=function xMe(n,t,e,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&"function"==typeof window[s]&&(i=window[s]),window[s]=function IMe(n,t,e,r){function i(){return(i=I(function*(o,c,u){try{"event"===o?yield NMe(n,t,e,c,u):"config"===o?yield AMe(n,t,e,r,c,u):"consent"===o?n("consent","update",u):n("set",c)}catch(h){x2.error(h)}})).apply(this,arguments)}return function s(o,c,u){return i.apply(this,arguments)}}(i,n,t,e),{gtagCore:i,wrappedGtag:window[s]}}(t6,qJ,WJ,nS,"gtag");n6=i,ZJ=o,_R=!0}return t6[r]=function KMe(n,t,e,r,s,i,o){return mR.apply(this,arguments)}(n,qJ,WJ,t,ZJ,nS,e),new XMe(n)}function tSe(){return vR.apply(this,arguments)}function vR(){return(vR=I(function*(){if(zN()||!VN()||!$u())return!1;try{return yield Xp()}catch{return!1}})).apply(this,arguments)}const YJ="@firebase/analytics";!function rSe(){ko(new to(tS,(t,{options:e})=>JMe(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e),"PUBLIC")),ko(new to("analytics-internal",function n(t){try{const e=t.getProvider(tS).getImmediate();return{logEvent:(r,s,i)=>function nSe(n,t,e,r){n=Jr(n),function GMe(n,t,e,r,s){return lR.apply(this,arguments)}(n6,t6[n.app.options.appId],t,e,r).catch(s=>x2.error(s))}(e,r,s,i)}}catch(e){throw Qa.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),us(YJ,"0.8.4"),us(YJ,"0.8.4","esm2017")}();class sSe extends H1{constructor(t,e){super()}schedule(t,e=0){return this}}const rS={setInterval(n,t,...e){const{delegate:r}=rS;return r?.setInterval?r.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=rS;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class XJ extends sSe{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var r;if(this.closed)return this;this.state=t;const s=this.id,i=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(i,s,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,e),this}requestAsyncId(t,e,r=0){return rS.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&rS.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let s,r=!1;try{this.work(t)}catch(i){r=!0,s=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,e3(r,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const CR={now:()=>(CR.delegate||Date).now(),delegate:void 0};class nm{constructor(t,e=nm.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,r){return new this.schedulerActionCtor(this,t).schedule(r,e)}}nm.now=CR.now;class QJ extends nm{constructor(t,e=nm.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}}const aSe=new class oSe extends QJ{}(class iSe extends XJ{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(t,e,r):(t.flush(this),0)}}),cSe=new QJ(XJ),sS=new u0("7.4.1"),yR="__angularfire_symbol__analyticsIsSupportedValue",ER="__angularfire_symbol__analyticsIsSupported",MR="__angularfire_symbol__remoteConfigIsSupportedValue",SR="__angularfire_symbol__remoteConfigIsSupported",PR="__angularfire_symbol__messagingIsSupportedValue",TR="__angularfire_symbol__messagingIsSupported";function bR(n,t,e){if(t){if(1===t.length)return t[0];const i=t.filter(o=>o.app===e);if(1===i.length)return i[0]}return e.container.getProvider(n).getImmediate({optional:!0})}globalThis[ER]||(globalThis[ER]=tSe().then(n=>globalThis[yR]=n).catch(()=>globalThis[yR]=!1)),globalThis[TR]||(globalThis[TR]=VJ().then(n=>globalThis[PR]=n).catch(()=>globalThis[PR]=!1)),globalThis[SR]||(globalThis[SR]=HEe().then(n=>globalThis[MR]=n).catch(()=>globalThis[MR]=!1));const OR=(n,t)=>{const e=t?[t]:RZ(),r=[];return e.forEach(s=>{s.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r};function _h(){}class JJ{constructor(t,e=aSe){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,r){const s=this.zone;return this.delegate.schedule(function(o){s.runGuarded(()=>{t.apply(this,[o])})},e,r)}}class lSe{constructor(t){this.zone=t,this.task=null}call(t,e){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",_h,{},_h,_h)),e.pipe(P2({next:r,complete:r,error:r})).subscribe(t).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let AR=(()=>{class n{constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new JJ(Zone.current)),this.insideAngular=e.run(()=>new JJ(Zone.current,cSe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(e){return new(e||n)(Ve(Pr))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function E5(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function uSe(n){return E5().ngZone.runOutsideAngular(()=>n())}function M5(n){return E5().ngZone.run(()=>n())}function fSe(n){return E5(),function hSe(n){return function(e){return(e=e.lift(new lSe(n.ngZone))).pipe(yc(n.outsideAngular),al(n.insideAngular))}}(E5())(n)}const dSe=(n,t)=>function(){const r=arguments;return t&&setTimeout(()=>{"scheduled"===t.state&&t.invoke()},10),M5(()=>n.apply(void 0,r))},wr=(n,t)=>function(){let e;const r=arguments;for(let i=0;i<arguments.length;i++)"function"==typeof r[i]&&(t&&(e||(e=M5(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",_h,{},_h,_h)))),r[i]=dSe(r[i],e));const s=uSe(()=>n.apply(this,r));if(!t){if(s instanceof yr){const i=E5();return s.pipe(yc(i.outsideAngular),al(i.insideAngular))}return M5(()=>s)}return s instanceof yr?s.pipe(fSe):s instanceof Promise?M5(()=>new Promise((i,o)=>s.then(c=>M5(()=>i(c)),c=>M5(()=>o(c))))):"function"==typeof s&&e?function(){return setTimeout(()=>{e&&"scheduled"===e.state&&e.invoke()},10),s.apply(this,arguments)}:M5(()=>s)};class vh{constructor(t){return t}}class NR{constructor(){return RZ()}}const IR=new Dt("angularfire2._apps"),gSe={provide:vh,useFactory:function pSe(n){return n&&1===n.length?n[0]:new vh(QN())},deps:[[new ui,IR]]},mSe={provide:NR,deps:[[new ui,IR]]};function _Se(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new vh(r)}}let vSe=(()=>{class n{constructor(e){us("angularfire",sS.full,"core"),us("angularfire",sS.full,"app"),us("angular",Lv.full,e.toString())}}return n.\u0275fac=function(e){return new(e||n)(Ve(dp))},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[gSe,mSe]}),n})();const ySe=wr(LZ,!0),xR=new Map,eee={activated:!1,tokenObservers:[]},ESe={initialized:!1,enabled:!1};function k2(n){return xR.get(n)||Object.assign({},eee)}function iS(){return ESe}class bSe{constructor(t,e,r,s,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){var e=this;return I(function*(){e.stop();try{e.pending=new xE,yield function OSe(n){return new Promise(t=>{setTimeout(t,n)})}(e.getNextRun(t)),e.pending.resolve(),yield e.pending.promise,e.pending=new xE,yield e.operation(),e.pending.resolve(),yield e.pending.promise,e.process(!0).catch(()=>{})}catch(r){e.retryPolicy(r)?e.process(!1).catch(()=>{}):e.stop()}})()}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const zo=new b4("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function nee(n){if(!k2(n).activated)throw zo.create("use-before-activation",{appName:n.name})}function RR(n,t){return DR.apply(this,arguments)}function DR(){return DR=I(function*({url:n,body:t},e){var r,s;const i={"Content-Type":"application/json"},o=e.getImmediate({optional:!0});if(o){const b=yield o.getHeartbeatsHeader();b&&(i["X-Firebase-Client"]=b)}const c={method:"POST",body:JSON.stringify(t),headers:i};let u,h;try{u=yield fetch(n,c)}catch(b){throw zo.create("fetch-network-error",{originalErrorMessage:null===(r=b)||void 0===r?void 0:r.message})}if(200!==u.status)throw zo.create("fetch-status-error",{httpStatus:u.status});try{h=yield u.json()}catch(b){throw zo.create("fetch-parse-error",{originalErrorMessage:null===(s=b)||void 0===s?void 0:s.message})}const g=h.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw zo.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const m=1e3*Number(g[1]),E=Date.now();return{token:h.token,expireTimeMillis:E+m,issuedAtTimeMillis:E}}),DR.apply(this,arguments)}function xSe(n,t){const{projectId:e,appId:r,apiKey:s}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${e}/apps/${r}:exchangeDebugToken?key=${s}`,body:{debug_token:t}}}const rm="firebase-app-check-store";let cS=null;function see(){return cS||(cS=new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=s=>{n(s.target.result)},r.onerror=s=>{var i;t(zo.create("storage-open",{originalErrorMessage:null===(i=s.target.error)||void 0===i?void 0:i.message}))},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(rm,{keyPath:"compositeKey"})}}catch(r){t(zo.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}}),cS)}function zR(){return zR=I(function*(n,t){const r=(yield see()).transaction(rm,"readwrite"),i=r.objectStore(rm).put({compositeKey:n,value:t});return new Promise((o,c)=>{i.onsuccess=u=>{o()},r.onerror=u=>{var h;c(zo.create("storage-set",{originalErrorMessage:null===(h=u.target.error)||void 0===h?void 0:h.message}))}})}),zR.apply(this,arguments)}const sm=new If("@firebase/app-check");function FR(n,t){return $u()?function DSe(n,t){return function iee(n,t){return zR.apply(this,arguments)}(function aee(n){return`${n.options.appId}-${n.name}`}(n),t)}(n,t).catch(e=>{sm.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function cee(){return iS().enabled}function lee(){return $R.apply(this,arguments)}function $R(){return $R=I(function*(){const n=iS();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),$R.apply(this,arguments)}const $Se={error:"UNKNOWN_ERROR"};function USe(n){return DN.encodeString(JSON.stringify(n),!1)}function lS(n){return UR.apply(this,arguments)}function UR(){return UR=I(function*(n,t=!1){const e=n.app;nee(e);const r=k2(e);let i,s=r.token;if(s&&!Ch(s)&&(r.token=void 0,s=void 0),!s){const u=yield r.cachedTokenPromise;u&&(Ch(u)?s=u:yield FR(e,void 0))}if(!t&&s&&Ch(s))return{token:s.token};let c,o=!1;if(cee()){r.exchangeTokenPromise||(r.exchangeTokenPromise=RR(xSe(e,yield lee()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);const u=yield r.exchangeTokenPromise;return yield FR(e,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),s=yield k2(e).exchangeTokenPromise}catch(u){"appCheck/throttled"===u.code?sm.warn(u.message):sm.error(u),i=u}return s?i?c=Ch(s)?{token:s.token,internalError:i}:hee(i):(c={token:s.token},r.token=s,yield FR(e,s)):c=hee(i),o&&fee(e,c),c}),UR.apply(this,arguments)}function qR(n,t){const e=k2(n),r=e.tokenObservers.filter(s=>s.next!==t);0===r.length&&e.tokenRefresher&&e.tokenRefresher.isRunning()&&e.tokenRefresher.stop(),e.tokenObservers=r}function uee(n){const{app:t}=n,e=k2(t);let r=e.tokenRefresher;r||(r=function GSe(n){const{app:t}=n;return new bSe(I(function*(){let r;if(r=k2(t).token?yield lS(n,!0):yield lS(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const e=k2(t);if(e.token){let r=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,e.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),e.tokenRefresher=r),!r.isRunning()&&e.isTokenAutoRefreshEnabled&&r.start()}function fee(n,t){const e=k2(n).tokenObservers;for(const r of e)try{"EXTERNAL"===r.type&&null!=t.error?r.error(t.error):r.next(t)}catch{}}function Ch(n){return n.expireTimeMillis-Date.now()>0}function hee(n){return{token:USe($Se),error:n}}class qSe{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=k2(this.app);for(const e of t)qR(this.app,e.next);return Promise.resolve()}}const yee="app-check-internal";!function iPe(){ko(new to("app-check",n=>function WSe(n,t){return new qSe(n,t)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,e)=>{n.getProvider(yee).initialize()})),ko(new to(yee,n=>function jSe(n){return{getToken:t=>lS(n,t),addTokenListener:t=>function GR(n,t,e,r){const{app:s}=n,i=k2(s);if(i.tokenObservers=[...i.tokenObservers,{next:e,error:r,type:t}],i.token&&Ch(i.token)){const c=i.token;Promise.resolve().then(()=>{e({token:c.token}),uee(n)}).catch(()=>{})}i.cachedTokenPromise.then(()=>uee(n))}(n,"INTERNAL",t),removeTokenListener:t=>qR(n.app,t)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),us("@firebase/app-check","0.5.17")}();class YR{constructor(){return OR("app-check")}}typeof window<"u"&&window;const uPe=function Mee(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},See=new b4("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Pee=new If("@firebase/auth");function fS(n,...t){Pee.logLevel<=p1.ERROR&&Pee.error(`Auth (${kf}): ${n}`,...t)}function Ca(n,...t){throw XR(n,...t)}function Ja(n,...t){return XR(n,...t)}function Tee(n,t,e){const r=Object.assign(Object.assign({},uPe()),{[t]:e});return new b4("auth","Firebase",r).create(t,{appName:n.name})}function yh(n,t,e){if(!(t instanceof e))throw e.name!==t.constructor.name&&Ca(n,"argument-error"),Tee(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function XR(n,...t){if("string"!=typeof n){const e=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(e,...r)}return See.create(n,...t)}function rt(n,t,...e){if(!n)throw XR(t,...e)}function D4(n){const t="INTERNAL ASSERTION FAILED: "+n;throw fS(t),new Error(t)}function r6(n,t){n||D4(t)}const wee=new Map;function s6(n){r6(n instanceof Function,"Expected a class definition");let t=wee.get(n);return t?(r6(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,wee.set(n,t),t)}function im(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.href)||""}function bee(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.protocol)||null}class om{constructor(t,e){this.shortDelay=t,this.longDelay=e,r6(e>t,"Short delay should be less than long delay!"),this.isMobile=function hpe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fi())}()||function ppe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function dPe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function QR(){return"http:"===bee()||"https:"===bee()}()||zN()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function JR(n,t){r6(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class Oee{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void D4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void D4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void D4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const gPe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},mPe=new om(3e4,6e4);function mi(n,t){return n.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:n.tenantId}):t}function Wi(n,t,e,r){return eD.apply(this,arguments)}function eD(){return eD=I(function*(n,t,e,r,s={}){return Aee(n,s,I(function*(){let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const c=Qp(Object.assign({key:n.config.apiKey},o)).slice(1),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode),Oee.fetch()(Nee(n,n.config.apiHost,e,c),Object.assign({method:t,headers:u,referrerPolicy:"no-referrer"},i))}))}),eD.apply(this,arguments)}function Aee(n,t,e){return tD.apply(this,arguments)}function tD(){return tD=I(function*(n,t,e){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},gPe),t);try{const s=new _Pe(n),i=yield Promise.race([e(),s.promise]);s.clearNetworkTimeout();const o=yield i.json();if("needConfirmation"in o)throw am(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===u)throw am(n,"credential-already-in-use",o);if("EMAIL_EXISTS"===u)throw am(n,"email-already-in-use",o);if("USER_DISABLED"===u)throw am(n,"user-disabled",o);const g=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Tee(n,g,h);Ca(n,g)}}catch(s){if(s instanceof Lc)throw s;Ca(n,"network-request-failed")}}),tD.apply(this,arguments)}function i6(n,t,e,r){return nD.apply(this,arguments)}function nD(){return nD=I(function*(n,t,e,r,s={}){const i=yield Wi(n,t,e,r,s);return"mfaPendingCredential"in i&&Ca(n,"multi-factor-auth-required",{_serverResponse:i}),i}),nD.apply(this,arguments)}function Nee(n,t,e,r){const s=`${t}${e}?${r}`;return n.config.emulator?JR(n.config,s):`${n.config.apiScheme}://${s}`}class _Pe{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(Ja(this.auth,"network-request-failed")),mPe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function am(n,t,e){const r={appName:n.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const s=Ja(n,t,r);return s.customData._tokenResponse=e,s}function rD(){return rD=I(function*(n,t){return Wi(n,"POST","/v1/accounts:delete",t)}),rD.apply(this,arguments)}function yPe(n,t){return iD.apply(this,arguments)}function iD(){return iD=I(function*(n,t){return Wi(n,"POST","/v1/accounts:lookup",t)}),iD.apply(this,arguments)}function cm(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}function oD(){return oD=I(function*(n,t=!1){const e=Jr(n),r=yield e.getIdToken(t),s=hS(r);rt(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const i="object"==typeof s.firebase?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:cm(aD(s.auth_time)),issuedAtTime:cm(aD(s.iat)),expirationTime:cm(aD(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}),oD.apply(this,arguments)}function aD(n){return 1e3*Number(n)}function hS(n){var t;const[e,r,s]=n.split(".");if(void 0===e||void 0===r||void 0===s)return fS("JWT malformed, contained fewer than 3 sections"),null;try{const i=IE(r);return i?JSON.parse(i):(fS("Failed to decode base64 JWT payload"),null)}catch(i){return fS("Caught error parsing JWT payload as JSON",null===(t=i)||void 0===t?void 0:t.toString()),null}}function o6(n,t){return cD.apply(this,arguments)}function cD(){return cD=I(function*(n,t,e=!1){if(e)return t;try{return yield t}catch(r){throw r instanceof Lc&&SPe(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}}),cD.apply(this,arguments)}function SPe({code:n}){return"auth/user-disabled"===n||"auth/user-token-expired"===n}class PPe{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const s=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){var e=this;if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(I(function*(){yield e.iteration()}),r)}iteration(){var t=this;return I(function*(){var e;try{yield t.user.getIdToken(!0)}catch(r){return void("auth/network-request-failed"===(null===(e=r)||void 0===e?void 0:e.code)&&t.schedule(!0))}t.schedule()})()}}class Iee{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=cm(this.lastLoginAt),this.creationTime=cm(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function lm(n){return lD.apply(this,arguments)}function lD(){return lD=I(function*(n){var t;const e=n.auth,r=yield n.getIdToken(),s=yield o6(n,yPe(e,{idToken:r}));rt(s?.users.length,e,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=null!==(t=i.providerUserInfo)&&void 0!==t&&t.length?bPe(i.providerUserInfo):[],c=wPe(n.providerData,o),g=!!n.isAnonymous&&!(n.email&&i.passwordHash||c?.length),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new Iee(i.createdAt,i.lastLoginAt),isAnonymous:g};Object.assign(n,m)}),lD.apply(this,arguments)}function uD(){return uD=I(function*(n){const t=Jr(n);yield lm(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}),uD.apply(this,arguments)}function wPe(n,t){return[...n.filter(r=>!t.some(s=>s.providerId===r.providerId)),...t]}function bPe(n){return n.map(t=>{var{providerId:e}=t,r=q5(t,["providerId"]);return{providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function fD(){return fD=I(function*(n,t){const e=yield Aee(n,{},I(function*(){const r=Qp({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=Nee(n,s,"/v1/token",`key=${i}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Oee.fetch()(o,{method:"POST",headers:c,body:r})}));return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}),fD.apply(this,arguments)}class um{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){rt(t.idToken,"internal-error"),rt(typeof t.idToken<"u","internal-error"),rt(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):function MPe(n){const t=hS(n);return rt(t,"internal-error"),rt(typeof t.exp<"u","internal-error"),rt(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}getToken(t,e=!1){var r=this;return I(function*(){return rt(!r.accessToken||r.refreshToken,t,"user-token-expired"),e||!r.accessToken||r.isExpired?r.refreshToken?(yield r.refresh(t,r.refreshToken),r.accessToken):null:r.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(t,e){var r=this;return I(function*(){const{accessToken:s,refreshToken:i,expiresIn:o}=yield function OPe(n,t){return fD.apply(this,arguments)}(t,e);r.updateTokensAndExpiration(s,i,Number(o))})()}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(t,e){const{refreshToken:r,accessToken:s,expirationTime:i}=e,o=new um;return r&&(rt("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),s&&(rt("string"==typeof s,"internal-error",{appName:t}),o.accessToken=s),i&&(rt("number"==typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new um,this.toJSON())}_performRefresh(){return D4("not implemented")}}function K0(n,t){rt("string"==typeof n||typeof n>"u","internal-error",{appName:t})}class S5{constructor(t){var{uid:e,auth:r,stsTokenManager:s}=t,i=q5(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new PPe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Iee(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(t){var e=this;return I(function*(){const r=yield o6(e,e.stsTokenManager.getToken(e.auth,t));return rt(r,e.auth,"internal-error"),e.accessToken!==r&&(e.accessToken=r,yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)),r})()}getIdTokenResult(t){return function EPe(n){return oD.apply(this,arguments)}(this,t)}reload(){return function TPe(n){return uD.apply(this,arguments)}(this)}_assign(t){this!==t&&(rt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>Object.assign({},e)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new S5(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){rt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(t,e=!1){var r=this;return I(function*(){let s=!1;t.idToken&&t.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(t),s=!0),e&&(yield lm(r)),yield r.auth._persistUserIfCurrent(r),s&&r.auth._notifyListenersIfCurrent(r)})()}delete(){var t=this;return I(function*(){const e=yield t.getIdToken();return yield o6(t,function vPe(n,t){return rD.apply(this,arguments)}(t.auth,{idToken:e})),t.stsTokenManager.clearRefreshToken(),t.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var r,s,i,o,c,u,h,g;const m=null!==(r=e.displayName)&&void 0!==r?r:void 0,E=null!==(s=e.email)&&void 0!==s?s:void 0,b=null!==(i=e.phoneNumber)&&void 0!==i?i:void 0,k=null!==(o=e.photoURL)&&void 0!==o?o:void 0,U=null!==(c=e.tenantId)&&void 0!==c?c:void 0,j=null!==(u=e._redirectEventId)&&void 0!==u?u:void 0,oe=null!==(h=e.createdAt)&&void 0!==h?h:void 0,ye=null!==(g=e.lastLoginAt)&&void 0!==g?g:void 0,{uid:te,emailVerified:ke,isAnonymous:Ge,providerData:Xe,stsTokenManager:Bt}=e;rt(te&&Bt,t,"internal-error");const V1=um.fromJSON(this.name,Bt);rt("string"==typeof te,t,"internal-error"),K0(m,t.name),K0(E,t.name),rt("boolean"==typeof ke,t,"internal-error"),rt("boolean"==typeof Ge,t,"internal-error"),K0(b,t.name),K0(k,t.name),K0(U,t.name),K0(j,t.name),K0(oe,t.name),K0(ye,t.name);const N1=new S5({uid:te,auth:t,email:E,emailVerified:ke,displayName:m,isAnonymous:Ge,photoURL:k,phoneNumber:b,tenantId:U,stsTokenManager:V1,createdAt:oe,lastLoginAt:ye});return Xe&&Array.isArray(Xe)&&(N1.providerData=Xe.map(bn=>Object.assign({},bn))),j&&(N1._redirectEventId=j),N1}static _fromIdTokenResponse(t,e,r=!1){return I(function*(){const s=new um;s.updateFromServerResponse(e);const i=new S5({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:r});return yield lm(i),i})()}}const xee=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return I(function*(){return!0})()}_set(e,r){var s=this;return I(function*(){s.storage[e]=r})()}_get(e){var r=this;return I(function*(){const s=r.storage[e];return void 0===s?null:s})()}_remove(e){var r=this;return I(function*(){delete r.storage[e]})()}_addListener(e,r){}_removeListener(e,r){}}return n.type="NONE",n})();function dS(n,t,e){return`firebase:${n}:${t}:${e}`}class Eh{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=dS(this.userKey,s.apiKey,i),this.fullPersistenceKey=dS("persistence",s.apiKey,i),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}getCurrentUser(){var t=this;return I(function*(){const e=yield t.persistence._get(t.fullUserKey);return e?S5._fromJSON(t.auth,e):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(t){var e=this;return I(function*(){if(e.persistence===t)return;const r=yield e.getCurrentUser();return yield e.removeCurrentUser(),e.persistence=t,r?e.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(t,e,r="authUser"){return I(function*(){if(!e.length)return new Eh(s6(xee),t,r);const s=(yield Promise.all(e.map(function(){var h=I(function*(g){if(yield g._isAvailable())return g});return function(g){return h.apply(this,arguments)}}()))).filter(h=>h);let i=s[0]||s6(xee);const o=dS(r,t.config.apiKey,t.name);let c=null;for(const h of e)try{const g=yield h._get(o);if(g){const m=S5._fromJSON(t,g);h!==i&&(c=m),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return i._shouldAllowMigration&&u.length?(i=u[0],c&&(yield i._set(o,c.toJSON())),yield Promise.all(e.map(function(){var h=I(function*(g){if(g!==i)try{yield g._remove(o)}catch{}});return function(g){return h.apply(this,arguments)}}())),new Eh(i,t,r)):new Eh(i,t,r)})()}}function kee(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Dee(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Lee(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Vee(t))return"Blackberry";if(Hee(t))return"Webos";if(hD(t))return"Safari";if((t.includes("chrome/")||Ree(t))&&!t.includes("edge/"))return"Chrome";if(zee(t))return"Android";{const r=n.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function Lee(n=Fi()){return/firefox\//i.test(n)}function hD(n=Fi()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Ree(n=Fi()){return/crios\//i.test(n)}function Dee(n=Fi()){return/iemobile/i.test(n)}function zee(n=Fi()){return/android/i.test(n)}function Vee(n=Fi()){return/blackberry/i.test(n)}function Hee(n=Fi()){return/webos/i.test(n)}function pS(n=Fi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Fee(n=Fi()){return pS(n)||zee(n)||Hee(n)||Vee(n)||/windows phone/i.test(n)||Dee(n)}function Bee(n,t=[]){let e;switch(n){case"Browser":e=kee(Fi());break;case"Worker":e=`${kee(Fi())}-${n}`;break;default:e=n}const r=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${kf}/${r}`}class xPe{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=i=>new Promise((o,c)=>{try{o(t(i))}catch(u){c(u)}});r.onAbort=e,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}runMiddleware(t){var e=this;return I(function*(){var r;if(e.auth.currentUser===t)return;const s=[];try{for(const i of e.queue)yield i(t),i.onAbort&&s.push(i.onAbort)}catch(i){s.reverse();for(const o of s)try{o()}catch{}throw e.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=i)||void 0===r?void 0:r.message})}})()}}class kPe{constructor(t,e,r){this.app=t,this.heartbeatServiceProvider=e,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $ee(this),this.idTokenSubscription=new $ee(this),this.beforeStateQueue=new xPe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=See,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(t,e){var r=this;return e&&(this._popupRedirectResolver=s6(e)),this._initializationPromise=this.queue(I(function*(){var s,i;if(!r._deleted&&(r.persistenceManager=yield Eh.create(r,t),!r._deleted)){if(null!==(s=r._popupRedirectResolver)&&void 0!==s&&s._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(e),r.lastNotifiedUid=(null===(i=r.currentUser)||void 0===i?void 0:i.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var t=this;return I(function*(){if(t._deleted)return;const e=yield t.assertedPersistence.getCurrentUser();if(t.currentUser||e){if(t.currentUser&&e&&t.currentUser.uid===e.uid)return t._currentUser._assign(e),void(yield t.currentUser.getIdToken());yield t._updateCurrentUser(e,!0)}})()}initializeCurrentUser(t){var e=this;return I(function*(){var r;const s=yield e.assertedPersistence.getCurrentUser();let i=s,o=!1;if(t&&e.config.authDomain){yield e.getOrInitRedirectPersistenceManager();const c=null===(r=e.redirectUser)||void 0===r?void 0:r._redirectEventId,u=i?._redirectEventId,h=yield e.tryRedirectSignIn(t);(!c||c===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return e.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield e.beforeStateQueue.runMiddleware(i)}catch(c){i=s,e._popupRedirectResolver._overrideRedirectResult(e,()=>Promise.reject(c))}return i?e.reloadAndSetCurrentUserOrClear(i):e.directlySetCurrentUser(null)}return rt(e._popupRedirectResolver,e,"argument-error"),yield e.getOrInitRedirectPersistenceManager(),e.redirectUser&&e.redirectUser._redirectEventId===i._redirectEventId?e.directlySetCurrentUser(i):e.reloadAndSetCurrentUserOrClear(i)})()}tryRedirectSignIn(t){var e=this;return I(function*(){let r=null;try{r=yield e._popupRedirectResolver._completeRedirectFn(e,t,!0)}catch{yield e._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(t){var e=this;return I(function*(){var r;try{yield lm(t)}catch(s){if("auth/network-request-failed"!==(null===(r=s)||void 0===r?void 0:r.code))return e.directlySetCurrentUser(null)}return e.directlySetCurrentUser(t)})()}useDeviceLanguage(){this.languageCode=function pPe(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}()}_delete(){var t=this;return I(function*(){t._deleted=!0})()}updateCurrentUser(t){var e=this;return I(function*(){const r=t?Jr(t):null;return r&&rt(r.auth.config.apiKey===e.config.apiKey,e,"invalid-user-token"),e._updateCurrentUser(r&&r._clone(e))})()}_updateCurrentUser(t,e=!1){var r=this;return I(function*(){if(!r._deleted)return t&&rt(r.tenantId===t.tenantId,r,"tenant-id-mismatch"),e||(yield r.beforeStateQueue.runMiddleware(t)),r.queue(I(function*(){yield r.directlySetCurrentUser(t),r.notifyAuthListeners()}))})()}signOut(){var t=this;return I(function*(){return yield t.beforeStateQueue.runMiddleware(null),(t.redirectPersistenceManager||t._popupRedirectResolver)&&(yield t._setRedirectUser(null)),t._updateCurrentUser(null,!0)})()}setPersistence(t){var e=this;return this.queue(I(function*(){yield e.assertedPersistence.setPersistence(s6(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new b4("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}_setRedirectUser(t,e){var r=this;return I(function*(){const s=yield r.getOrInitRedirectPersistenceManager(e);return null===t?s.removeCurrentUser():s.setCurrentUser(t)})()}getOrInitRedirectPersistenceManager(t){var e=this;return I(function*(){if(!e.redirectPersistenceManager){const r=t&&s6(t)||e._popupRedirectResolver;rt(r,e,"argument-error"),e.redirectPersistenceManager=yield Eh.create(e,[s6(r._redirectPersistence)],"redirectUser"),e.redirectUser=yield e.redirectPersistenceManager.getCurrentUser()}return e.redirectPersistenceManager})()}_redirectUserForId(t){var e=this;return I(function*(){var r,s;return e._isInitialized&&(yield e.queue(I(function*(){}))),(null===(r=e._currentUser)||void 0===r?void 0:r._redirectEventId)===t?e._currentUser:(null===(s=e.redirectUser)||void 0===s?void 0:s._redirectEventId)===t?e.redirectUser:null})()}_persistUserIfCurrent(t){var e=this;return I(function*(){if(t===e.currentUser)return e.queue(I(function*(){return e.directlySetCurrentUser(t)}))})()}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,s){if(this._deleted)return()=>{};const i="function"==typeof e?e:e.next.bind(e),o=this._isInitialized?Promise.resolve():this._initializationPromise;return rt(o,this,"internal-error"),o.then(()=>i(this.currentUser)),"function"==typeof e?t.addObserver(e,r,s):t.addObserver(e)}directlySetCurrentUser(t){var e=this;return I(function*(){e.currentUser&&e.currentUser!==t&&e._currentUser._stopProactiveRefresh(),t&&e.isProactiveRefreshEnabled&&t._startProactiveRefresh(),e.currentUser=t,t?yield e.assertedPersistence.setCurrentUser(t):yield e.assertedPersistence.removeCurrentUser()})()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return rt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Bee(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var t=this;return I(function*(){var e;const r={"X-Client-Version":t.clientVersion};t.app.options.appId&&(r["X-Firebase-gmpid"]=t.app.options.appId);const s=yield null===(e=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();return s&&(r["X-Firebase-Client"]=s),r})()}}function ya(n){return Jr(n)}class $ee{constructor(t){this.auth=t,this.observer=null,this.addObserver=function bpe(n,t){const e=new Ope(n,t);return e.subscribe.bind(e)}(e=>this.observer=e)}get next(){return rt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Uee(n,t,e){const r=ya(n);rt(r._canInitEmulator,r,"emulator-config-failed"),rt(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!e?.disableWarnings,i=Gee(t),{host:o,port:c}=function LPe(n){const t=Gee(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:qee(r.substr(i.length+1))}}{const[i,o]=r.split(":");return{host:i,port:qee(o)}}}(t);r.config.emulator={url:`${i}//${o}${null===c?"":`:${c}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function RPe(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",n):n())}()}function Gee(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function qee(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}class dD{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return D4("not implemented")}_getIdTokenResponse(t){return D4("not implemented")}_linkToIdToken(t,e){return D4("not implemented")}_getReauthenticationResolver(t){return D4("not implemented")}}function gD(){return gD=I(function*(n,t){return Wi(n,"POST","/v1/accounts:update",t)}),gD.apply(this,arguments)}function _D(){return _D=I(function*(n,t){return i6(n,"POST","/v1/accounts:signInWithPassword",mi(n,t))}),_D.apply(this,arguments)}function gS(n,t){return vD.apply(this,arguments)}function vD(){return vD=I(function*(n,t){return Wi(n,"POST","/v1/accounts:sendOobCode",mi(n,t))}),vD.apply(this,arguments)}function VPe(n,t){return CD.apply(this,arguments)}function CD(){return CD=I(function*(n,t){return gS(n,t)}),CD.apply(this,arguments)}function HPe(n,t){return yD.apply(this,arguments)}function yD(){return yD=I(function*(n,t){return gS(n,t)}),yD.apply(this,arguments)}function SD(){return SD=I(function*(n,t){return i6(n,"POST","/v1/accounts:signInWithEmailLink",mi(n,t))}),SD.apply(this,arguments)}function PD(){return PD=I(function*(n,t){return i6(n,"POST","/v1/accounts:signInWithEmailLink",mi(n,t))}),PD.apply(this,arguments)}class fm extends dD{constructor(t,e,r,s=null){super("password",r),this._email=t,this._password=e,this._tenantId=s}static _fromEmailAndPassword(t,e){return new fm(t,e,"password")}static _fromEmailAndCode(t,e,r=null){return new fm(t,e,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if(e?.email&&e?.password){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}_getIdTokenResponse(t){var e=this;return I(function*(){switch(e.signInMethod){case"password":return function zPe(n,t){return _D.apply(this,arguments)}(t,{returnSecureToken:!0,email:e._email,password:e._password});case"emailLink":return function $Pe(n,t){return SD.apply(this,arguments)}(t,{email:e._email,oobCode:e._password});default:Ca(t,"internal-error")}})()}_linkToIdToken(t,e){var r=this;return I(function*(){switch(r.signInMethod){case"password":return function jee(n,t){return gD.apply(this,arguments)}(t,{idToken:e,returnSecureToken:!0,email:r._email,password:r._password});case"emailLink":return function UPe(n,t){return PD.apply(this,arguments)}(t,{idToken:e,email:r._email,oobCode:r._password});default:Ca(t,"internal-error")}})()}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}function a6(n,t){return TD.apply(this,arguments)}function TD(){return TD=I(function*(n,t){return i6(n,"POST","/v1/accounts:signInWithIdp",mi(n,t))}),TD.apply(this,arguments)}class Mh extends dD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Mh(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Ca("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:r,signInMethod:s}=e,i=q5(e,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Mh(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(t){return a6(t,this.buildRequest())}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,a6(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,a6(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=Qp(e)}return t}}class dm{constructor(t){var e,r,s,i,o,c;const u=Jp(eg(t)),h=null!==(e=u.apiKey)&&void 0!==e?e:null,g=null!==(r=u.oobCode)&&void 0!==r?r:null,m=function KPe(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(s=u.mode)&&void 0!==s?s:null);rt(h&&g&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=g,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(c=u.tenantId)&&void 0!==c?c:null}static parseLink(t){const e=function XPe(n){const t=Jp(eg(n)).link,e=t?Jp(eg(t)).deep_link_id:null,r=Jp(eg(n)).deep_link_id;return(r?Jp(eg(r)).link:null)||r||e||t||n}(t);try{return new dm(e)}catch{return null}}}let Zee=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(e,r){return fm._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const s=dm.parseLink(r);return rt(s,"argument-error"),fm._fromEmailAndCode(e,s.code,s.tenantId)}}return n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink",n})();class X0{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class Yee extends X0{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}let QPe=(()=>{class n extends Yee{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Mh._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:s}=e;if(!r&&!s)return null;try{return n.credential(r,s)}catch{return null}}}return n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com",n})();function Kee(n,t){return ID.apply(this,arguments)}function ID(){return ID=I(function*(n,t){return i6(n,"POST","/v1/accounts:signUp",mi(n,t))}),ID.apply(this,arguments)}class Rc{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static _fromIdTokenResponse(t,e,r,s=!1){return I(function*(){const i=yield S5._fromIdTokenResponse(t,r,s),o=Xee(r);return new Rc({user:i,providerId:o,_tokenResponse:r,operationType:e})})()}static _forOperation(t,e,r){return I(function*(){yield t._updateTokensIfNecessary(r,!0);const s=Xee(r);return new Rc({user:t,providerId:s,_tokenResponse:r,operationType:e})})()}}function Xee(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class _S extends Lc{constructor(t,e,r,s){var i;super(e.code,e.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,_S.prototype),this.customData={appName:t.name,tenantId:null!==(i=t.tenantId)&&void 0!==i?i:void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,s){return new _S(t,e,r,s)}}function Qee(n,t,e,r){return("reauthenticate"===t?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(i=>{throw"auth/multi-factor-auth-required"===i.code?_S._fromErrorAndOperation(n,i,t,r):i})}function LD(n,t){return RD.apply(this,arguments)}function RD(){return RD=I(function*(n,t,e=!1){const r=yield o6(n,t._linkToIdToken(n.auth,yield n.getIdToken()),e);return Rc._forOperation(n,"link",r)}),RD.apply(this,arguments)}function zD(){return zD=I(function*(n,t,e=!1){var r;const{auth:s}=n,i="reauthenticate";try{const o=yield o6(n,Qee(s,i,t,n),e);rt(o.idToken,s,"internal-error");const c=hS(o.idToken);rt(c,s,"internal-error");const{sub:u}=c;return rt(n.uid===u,s,"user-mismatch"),Rc._forOperation(n,i,o)}catch(o){throw"auth/user-not-found"===(null===(r=o)||void 0===r?void 0:r.code)&&Ca(s,"user-mismatch"),o}}),zD.apply(this,arguments)}function tte(n,t){return VD.apply(this,arguments)}function VD(){return VD=I(function*(n,t,e=!1){const r="signIn",s=yield Qee(n,r,t),i=yield Rc._fromIdTokenResponse(n,r,s);return e||(yield n._updateCurrentUser(i.user)),i}),VD.apply(this,arguments)}function FD(){return FD=I(function*(n,t){return tte(ya(n),t)}),FD.apply(this,arguments)}function CS(n,t,e){var r;rt((null===(r=e.url)||void 0===r?void 0:r.length)>0,n,"invalid-continue-uri"),rt(typeof e.dynamicLinkDomain>"u"||e.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),t.continueUrl=e.url,t.dynamicLinkDomain=e.dynamicLinkDomain,t.canHandleCodeInApp=e.handleCodeInApp,e.iOS&&(rt(e.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),t.iOSBundleId=e.iOS.bundleId),e.android&&(rt(e.android.packageName.length>0,n,"missing-android-pkg-name"),t.androidInstallApp=e.android.installApp,t.androidMinimumVersionCode=e.android.minimumVersion,t.androidPackageName=e.android.packageName)}function sTe(n,t,e){return jD.apply(this,arguments)}function jD(){return jD=I(function*(n,t,e){const r=Jr(n),s={requestType:"PASSWORD_RESET",email:t};e&&CS(r,s,e),yield HPe(r,s)}),jD.apply(this,arguments)}function oTe(n,t,e){return QD.apply(this,arguments)}function QD(){return QD=I(function*(n,t,e){const r=ya(n),s=yield Kee(r,{returnSecureToken:!0,email:t,password:e}),i=yield Rc._fromIdTokenResponse(r,"signIn",s);return yield r._updateCurrentUser(i.user),i}),QD.apply(this,arguments)}function aTe(n,t,e){return function HD(n,t){return FD.apply(this,arguments)}(Jr(n),Zee.credential(t,e))}function lTe(n,t){return rz.apply(this,arguments)}function rz(){return rz=I(function*(n,t){const e=Jr(n),s={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};t&&CS(e.auth,s,t);const{email:i}=yield VPe(e.auth,s);i!==n.email&&(yield n.reload())}),rz.apply(this,arguments)}function uTe(n,t){return iz.apply(this,arguments)}function iz(){return iz=I(function*(n,t){return Wi(n,"POST","/v1/accounts:update",t)}),iz.apply(this,arguments)}function fTe(n,t){return oz.apply(this,arguments)}function oz(){return oz=I(function*(n,{displayName:t,photoURL:e}){if(void 0===t&&void 0===e)return;const r=Jr(n),i={idToken:yield r.getIdToken(),displayName:t,photoUrl:e,returnSecureToken:!0},o=yield o6(r,uTe(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>"password"===u);c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),yield r._updateTokensIfNecessary(o)}),oz.apply(this,arguments)}function CTe(n,t,e,r){return Jr(n).onAuthStateChanged(t,e,r)}const yS="__sak";class rte{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(yS,"1"),this.storage.removeItem(yS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const wTe=(()=>{class n extends rte{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function STe(){const n=Fi();return hD(n)||pS(n)}()&&function IPe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Fee(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const s=this.storage.getItem(r),i=this.localCache[r];s!==i&&e(r,i,s)}}onStorageEvent(e,r=!1){if(!e.key)return void this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});const s=e.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const c=this.storage.getItem(s);if(e.newValue!==c)null!==e.newValue?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!r)return}const i=()=>{const c=this.storage.getItem(s);!r&&this.localCache[s]===c||this.notifyListeners(s,c)},o=this.storage.getItem(s);!function NPe(){return function gpe(){const n=Fi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:s}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,r){var s=()=>super._set,i=this;return I(function*(){yield s().call(i,e,r),i.localCache[e]=JSON.stringify(r)})()}_get(e){var r=()=>super._get,s=this;return I(function*(){const i=yield r().call(s,e);return s.localCache[e]=JSON.stringify(i),i})()}_remove(e){var r=()=>super._remove,s=this;return I(function*(){yield r().call(s,e),delete s.localCache[e]})()}}return n.type="LOCAL",n})(),ste=(()=>{class n extends rte{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}return n.type="SESSION",n})();let OTe=(()=>{class n{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const s=new n(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}handleEvent(e){var r=this;return I(function*(){const s=e,{eventId:i,eventType:o,data:c}=s.data,u=r.handlersMap[o];if(!u?.size)return;s.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const h=Array.from(u).map(function(){var m=I(function*(E){return E(s.origin,c)});return function(E){return m.apply(this,arguments)}}()),g=yield function bTe(n){return Promise.all(n.map(function(){var t=I(function*(e){try{return{fulfilled:!0,value:yield e}}catch(r){return{fulfilled:!1,reason:r}}});return function(e){return t.apply(this,arguments)}}()))}(h);s.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})})()}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return n.receivers=[],n})();function ES(n="",t=10){let e="";for(let r=0;r<t;r++)e+=Math.floor(10*Math.random());return n+e}class ATe{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}_send(t,e,r=50){var s=this;return I(function*(){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const g=ES("",20);i.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:i,onMessage(E){const b=E;if(b.data.eventId===g)switch(b.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(b.data.response);break;default:clearTimeout(m),clearTimeout(o),h(new Error("invalid_response"))}}},s.handlers.add(c),i.port1.addEventListener("message",c.onMessage),s.target.postMessage({eventType:t,eventId:g,data:e},[i.port2])}).finally(()=>{c&&s.removeMessageHandler(c)})})()}}function _i(){return window}function dz(){return typeof _i().WorkerGlobalScope<"u"&&"function"==typeof _i().importScripts}function pz(){return(pz=I(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const ite="firebaseLocalStorageDb",MS="firebaseLocalStorage",ote="fbase_key";class gm{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function SS(n,t){return n.transaction([MS],t?"readwrite":"readonly").objectStore(MS)}function gz(){const n=indexedDB.open(ite,1);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(MS,{keyPath:ote})}catch(s){e(s)}}),n.addEventListener("success",I(function*(){const r=n.result;r.objectStoreNames.contains(MS)?t(r):(r.close(),yield function RTe(){const n=indexedDB.deleteDatabase(ite);return new gm(n).toPromise()}(),t(yield gz()))}))})}function ate(n,t,e){return mz.apply(this,arguments)}function mz(){return mz=I(function*(n,t,e){const r=SS(n,!0).put({[ote]:t,value:e});return new gm(r).toPromise()}),mz.apply(this,arguments)}function _z(){return _z=I(function*(n,t){const e=SS(n,!1).get(t),r=yield new gm(e).toPromise();return void 0===r?null:r.value}),_z.apply(this,arguments)}function cte(n,t){const e=SS(n,!0).delete(t);return new gm(e).toPromise()}const HTe=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return I(function*(){return e.db||(e.db=yield gz()),e.db})()}_withRetries(e){var r=this;return I(function*(){let s=0;for(;;)try{const i=yield r._openDb();return yield e(i)}catch(i){if(s++>3)throw i;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return I(function*(){return dz()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return I(function*(){e.receiver=OTe._getInstance(function kTe(){return dz()?self:null}()),e.receiver._subscribe("keyChanged",function(){var r=I(function*(s,i){return{keyProcessed:(yield e._poll()).includes(i.key)}});return function(s,i){return r.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var r=I(function*(s,i){return["keyChanged"]});return function(s,i){return r.apply(this,arguments)}}())})()}initializeSender(){var e=this;return I(function*(){var r,s;if(e.activeServiceWorker=yield function ITe(){return pz.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new ATe(e.activeServiceWorker);const i=yield e.sender._send("ping",{},800);!i||(null===(r=i[0])||void 0===r?void 0:r.fulfilled)&&(null===(s=i[0])||void 0===s?void 0:s.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var r=this;return I(function*(){if(r.sender&&r.activeServiceWorker&&function xTe(){var n;return(null===(n=navigator?.serviceWorker)||void 0===n?void 0:n.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:e},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return I(function*(){try{if(!indexedDB)return!1;const e=yield gz();return yield ate(e,yS,"1"),yield cte(e,yS),!0}catch{}return!1})()}_withPendingWrite(e){var r=this;return I(function*(){r.pendingWrites++;try{yield e()}finally{r.pendingWrites--}})()}_set(e,r){var s=this;return I(function*(){return s._withPendingWrite(I(function*(){return yield s._withRetries(i=>ate(i,e,r)),s.localCache[e]=r,s.notifyServiceWorker(e)}))})()}_get(e){var r=this;return I(function*(){const s=yield r._withRetries(i=>function DTe(n,t){return _z.apply(this,arguments)}(i,e));return r.localCache[e]=s,s})()}_remove(e){var r=this;return I(function*(){return r._withPendingWrite(I(function*(){return yield r._withRetries(s=>cte(s,e)),delete r.localCache[e],r.notifyServiceWorker(e)}))})()}_poll(){var e=this;return I(function*(){const r=yield e._withRetries(o=>{const c=SS(o,!1).getAll();return new gm(c).toPromise()});if(!r)return[];if(0!==e.pendingWrites)return[];const s=[],i=new Set;for(const{fbase_key:o,value:c}of r)i.add(o),JSON.stringify(e.localCache[o])!==JSON.stringify(c)&&(e.notifyListeners(o,c),s.push(o));for(const o of Object.keys(e.localCache))e.localCache[o]&&!i.has(o)&&(e.notifyListeners(o,null),s.push(o));return s})()}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(I(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return n.type="LOCAL",n})();function ute(n){return`__${n}${Math.floor(1e6*Math.random())}`}function T5(n,t){return t?s6(t):(rt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}ute("rcb"),new om(3e4,6e4);class bz extends dD{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return a6(t,this._buildIdpRequest())}_linkToIdToken(t,e){return a6(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return a6(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function nwe(n){return tte(n.auth,new bz(n),n.bypassAuthState)}function rwe(n){const{auth:t,user:e}=n;return rt(e,t,"internal-error"),function ete(n,t){return zD.apply(this,arguments)}(e,new bz(n),n.bypassAuthState)}function swe(n){return Oz.apply(this,arguments)}function Oz(){return Oz=I(function*(n){const{auth:t,user:e}=n;return rt(e,t,"internal-error"),LD(e,new bz(n),n.bypassAuthState)}),Oz.apply(this,arguments)}class hte{constructor(t,e,r,s,i=!1){this.auth=t,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){var t=this;return new Promise(function(){var e=I(function*(r,s){t.pendingPromise={resolve:r,reject:s};try{t.eventManager=yield t.resolver._initialize(t.auth),yield t.onExecution(),t.eventManager.registerConsumer(t)}catch(i){t.reject(i)}});return function(r,s){return e.apply(this,arguments)}}())}onAuthEvent(t){var e=this;return I(function*(){const{urlResponse:r,sessionId:s,postBody:i,tenantId:o,error:c,type:u}=t;if(c)return void e.reject(c);const h={auth:e.auth,requestUri:r,sessionId:s,tenantId:o||void 0,postBody:i||void 0,user:e.user,bypassAuthState:e.bypassAuthState};try{e.resolve(yield e.getIdpTask(u)(h))}catch(g){e.reject(g)}})()}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return nwe;case"linkViaPopup":case"linkViaRedirect":return swe;case"reauthViaPopup":case"reauthViaRedirect":return rwe;default:Ca(this.auth,"internal-error")}}resolve(t){r6(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){r6(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const iwe=new om(2e3,1e4);function owe(n,t,e){return Az.apply(this,arguments)}function Az(){return Az=I(function*(n,t,e){const r=ya(n);yh(n,t,X0);const s=T5(r,e);return new xz(r,"signInViaPopup",t,s).executeNotNull()}),Az.apply(this,arguments)}let xz=(()=>{class n extends hte{constructor(e,r,s,i,o){super(e,r,i,o),this.provider=s,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){var e=this;return I(function*(){const r=yield e.execute();return rt(r,e.auth,"internal-error"),r})()}onExecution(){var e=this;return I(function*(){r6(1===e.filter.length,"Popup operations only handle one event");const r=ES();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],r),e.authWindow.associatedEvent=r,e.resolver._originValidation(e.auth).catch(s=>{e.reject(s)}),e.resolver._isIframeWebStorageSupported(e.auth,s=>{s||e.reject(Ja(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Ja(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,s;this.pollId=null!==(s=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==s&&s.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Ja(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(e,iwe.get())};e()}}return n.currentPopupAction=null,n})();const mm=new Map;class cwe extends hte{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}execute(){var t=()=>super.execute,e=this;return I(function*(){let r=mm.get(e.auth._key());if(!r){try{const i=(yield function lwe(n,t){return kz.apply(this,arguments)}(e.resolver,e.auth))?yield t().call(e):null;r=()=>Promise.resolve(i)}catch(s){r=()=>Promise.reject(s)}mm.set(e.auth._key(),r)}return e.bypassAuthState||mm.set(e.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(t){var e=()=>super.onAuthEvent,r=this;return I(function*(){if("signInViaRedirect"===t.type)return e().call(r,t);if("unknown"!==t.type){if(t.eventId){const s=yield r.auth._redirectUserForId(t.eventId);if(s)return r.user=s,e().call(r,t);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return I(function*(){})()}cleanUp(){}}function kz(){return kz=I(function*(n,t){const e=pte(t),r=dte(n);if(!(yield r._isAvailable()))return!1;const s="true"===(yield r._get(e));return yield r._remove(e),s}),kz.apply(this,arguments)}function uwe(n,t){mm.set(n._key(),t)}function dte(n){return s6(n._redirectPersistence)}function pte(n){return dS("pendingRedirect",n.config.apiKey,n.name)}function gte(n,t){return Fz.apply(this,arguments)}function Fz(){return Fz=I(function*(n,t,e=!1){const r=ya(n),s=T5(r,t),o=yield new cwe(r,s,e).execute();return o&&!e&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,t)),o}),Fz.apply(this,arguments)}class gwe{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function mwe(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vte(n);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var r;if(t.error&&!vte(t)){const s=(null===(r=t.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";e.onError(Ja(this.auth,s))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(_te(t))}saveEventToCache(t){this.cachedEventUids.add(_te(t)),this.lastProcessedEventTime=Date.now()}}function _te(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function vte({type:n,error:t}){return"unknown"===n&&"auth/no-auth-event"===t?.code}function _we(n){return $z.apply(this,arguments)}function $z(){return $z=I(function*(n,t={}){return Wi(n,"GET","/v1/projects",t)}),$z.apply(this,arguments)}const vwe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Cwe=/^https?/;function Uz(){return Uz=I(function*(n){if(n.config.emulator)return;const{authorizedDomains:t}=yield _we(n);for(const e of t)try{if(Ewe(e))return}catch{}Ca(n,"unauthorized-domain")}),Uz.apply(this,arguments)}function Ewe(n){const t=im(),{protocol:e,hostname:r}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return""===o.hostname&&""===r?"chrome-extension:"===e&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===e&&o.hostname===r}if(!Cwe.test(e))return!1;if(vwe.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const Mwe=new om(3e4,6e4);function Cte(){const n=_i().___jsl;if(n?.H)for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}let TS=null;function Pwe(n){return TS=TS||function Swe(n){return new Promise((t,e)=>{var r,s,i;function o(){Cte(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Cte(),e(Ja(n,"network-request-failed"))},timeout:Mwe.get()})}if(null!==(s=null===(r=_i().gapi)||void 0===r?void 0:r.iframes)&&void 0!==s&&s.Iframe)t(gapi.iframes.getContext());else{if(null===(i=_i().gapi)||void 0===i||!i.load){const c=ute("iframefcb");return _i()[c]=()=>{gapi.load?o():e(Ja(n,"network-request-failed"))},function lte(n){return new Promise((t,e)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=t,r.onerror=s=>{const i=Ja("internal-error");i.customData=s,e(i)},r.type="text/javascript",r.charset="UTF-8",function UTe(){var n,t;return null!==(t=null===(n=document.getElementsByTagName("head"))||void 0===n?void 0:n[0])&&void 0!==t?t:document}().appendChild(r)})}(`https://apis.google.com/js/api.js?onload=${c}`).catch(u=>e(u))}o()}}).catch(t=>{throw TS=null,t})}(n),TS}const Twe=new om(5e3,15e3),Owe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Awe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Nwe(n){const t=n.config;rt(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?JR(t,"emulator/auth/iframe"):`https://${n.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:n.name,v:kf},s=Awe.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${e}?${Qp(r).slice(1)}`}function Gz(){return Gz=I(function*(n){const t=yield Pwe(n),e=_i().gapi;return rt(e,n,"internal-error"),t.open({where:document.body,url:Nwe(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Owe,dontclear:!0},r=>new Promise(function(){var s=I(function*(i,o){yield r.restyle({setHideOnLeave:!1});const c=Ja(n,"network-request-failed"),u=_i().setTimeout(()=>{o(c)},Twe.get());function h(){_i().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(c)})});return function(i,o){return s.apply(this,arguments)}}()))}),Gz.apply(this,arguments)}const xwe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class yte{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Ete(n,t,e,r,s,i){rt(n.config.authDomain,n,"auth-domain-config-required"),rt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:r,v:kf,eventId:s};if(t instanceof X0){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",function wpe(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,h]of Object.entries(i||{}))o[u]=h}if(t instanceof Yee){const u=t.getScopes().filter(h=>""!==h);u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const u of Object.keys(c))void 0===c[u]&&delete c[u];return`${function Bwe({config:n}){return n.emulator?JR(n,"emulator/auth/handler"):`https://${n.authDomain}/__/auth/handler`}(n)}?${Qp(c).slice(1)}`}const qz="webStorageSupport",Uwe=class $we{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ste,this._completeRedirectFn=gte,this._overrideRedirectResult=uwe}_openPopup(t,e,r,s){var i=this;return I(function*(){var o;r6(null===(o=i.eventManagers[t._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const c=Ete(t,e,r,im(),s);return function zwe(n,t,e,r=500,s=600){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},xwe),{width:r.toString(),height:s.toString(),top:i,left:o}),h=Fi().toLowerCase();e&&(c=Ree(h)?"_blank":e),Lee(h)&&(t=t||"http://localhost",u.scrollbars="yes");const g=Object.entries(u).reduce((E,[b,k])=>`${E}${b}=${k},`,"");if(function APe(n=Fi()){var t;return pS(n)&&!(null===(t=window.navigator)||void 0===t||!t.standalone)}(h)&&"_self"!==c)return function Vwe(n,t){const e=document.createElement("a");e.href=n,e.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}(t||"",c),new yte(null);const m=window.open(t||"",c,g);rt(m,n,"popup-blocked");try{m.focus()}catch{}return new yte(m)}(t,c,ES())})()}_openRedirect(t,e,r,s){var i=this;return I(function*(){return yield i._originValidation(t),function NTe(n){_i().location.href=n}(Ete(t,e,r,im(),s)),new Promise(()=>{})})()}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:i}=this.eventManagers[e];return s?Promise.resolve(s):(r6(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}initAndGetManager(t){var e=this;return I(function*(){const r=yield function Iwe(n){return Gz.apply(this,arguments)}(t),s=new gwe(t);return r.register("authEvent",i=>(rt(i?.authEvent,t,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),e.eventManagers[t._key()]={manager:s},e.iframes[t._key()]=r,s})()}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(qz,{type:qz},s=>{var i;const o=null===(i=s?.[0])||void 0===i?void 0:i[qz];void 0!==o&&e(!!o),Ca(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function ywe(n){return Uz.apply(this,arguments)}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Fee()||hD()||pS()}};var Ste="@firebase/auth";class Gwe{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}getToken(t){var e=this;return I(function*(){return e.assertAuthConfigured(),yield e.auth._initializationPromise,e.auth.currentUser?{accessToken:yield e.auth.currentUser.getIdToken(t)}:null})()}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(r=>{var s;t((null===(s=r)||void 0===s?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);!e||(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){rt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Zwe=PZ("authIdTokenMaxAge")||300;let Tte=null;const Ywe=n=>function(){var t=I(function*(e){const r=e&&(yield e.getIdTokenResult()),s=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(s&&s>Zwe)return;const i=r?.token;Tte!==i&&(Tte=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});return function(e){return t.apply(this,arguments)}}();function Kwe(n=QN()){const t=xf(n,"auth");if(t.isInitialized())return t.getImmediate();const e=function fPe(n,t){const e=xf(n,"auth");if(e.isInitialized()){const s=e.getImmediate();if(LE(e.getOptions(),t??{}))return s;Ca(s,"already-initialized")}return e.initialize({options:t})}(n,{popupRedirectResolver:Uwe,persistence:[HTe,wTe,ste]}),r=PZ("authTokenSyncURL");if(r){const i=Ywe(r);(function vTe(n,t,e){Jr(n).beforeAuthStateChanged(t,e)})(e,i,()=>i(e.currentUser)),function _Te(n,t,e,r){Jr(n).onIdTokenChanged(t,e,r)}(e,o=>i(o))}const s=SZ("auth");return s&&Uee(e,`http://${s}`),e}!function Wwe(n){ko(new to("auth",(t,{options:e})=>{const r=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),{apiKey:i,authDomain:o}=r.options;return((c,u)=>{rt(i&&!i.includes(":"),"invalid-api-key",{appName:c.name}),rt(!o?.includes(":"),"argument-error",{appName:c.name});const h={apiKey:i,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Bee(n)},g=new kPe(c,u,h);return function hPe(n,t){const e=t?.persistence||[],r=(Array.isArray(e)?e:[e]).map(s6);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(r,t?.popupRedirectResolver)}(g,e),g})(r,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,r)=>{t.getProvider("auth-internal").initialize()})),ko(new to("auth-internal",t=>{const e=ya(t.getProvider("auth").getImmediate());return new Gwe(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),us(Ste,"0.20.11",function qwe(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(n)),us(Ste,"0.20.11","esm2017")}("Browser");class wS{constructor(t){return t}}class bte{constructor(){return OR("auth")}}const Wz=new Dt("angularfire2.auth-instances");function Qwe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new wS(r)}}const Jwe={provide:bte,deps:[[new ui,Wz]]},ebe={provide:wS,useFactory:function Xwe(n,t){const e=bR("auth",n,t);return e&&new wS(e)},deps:[[new ui,Wz],vh]};let tbe=(()=>{class n{constructor(){us("angularfire",sS.full,"auth")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[ebe,Jwe]}),n})();const sbe=wr(oTe,!0),ibe=wr(Kwe,!0),obe=wr(CTe,!0),abe=wr(lTe,!0),cbe=wr(sTe,!0),lbe=wr(aTe,!0),ube=wr(owe,!0),fbe=wr(fTe,!0);class Q0{constructor(t){return t}}const jz=new Dt("angularfire2.firestore-instances");function pbe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new Q0(r)}}const gbe={provide:class hbe{constructor(){return OR("firestore")}},deps:[[new ui,jz]]},mbe={provide:Q0,useFactory:function dbe(n,t){const e=bR("firestore",n,t);return e&&new Q0(e)},deps:[[new ui,jz],vh]};let _be=(()=>{class n{constructor(){us("angularfire",sS.full,"fst")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({providers:[mbe,gbe]}),n})();const Cbe=wr(_ye,!0),ybe=wr(kCe,!0),Mbe=wr(mye,!0),_m=wr(wQ,!0),Sbe=wr(hye,!0),Pbe=wr(dye,!0),Tbe=wr(YCe,!0),wbe=wr(lye,!0),Ate=wr(vye,!0),bbe=wr(cye,!0),bS=wr(sye,!0),Obe=wr(pye,!0),Abe=wr(gye,!0),Nbe=wr(oye,!0);let vm=(()=>{class n{constructor(e,r){this.collectionName=e,this.firestore=r,this.subDAOs={};this.collection=ybe(r,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var r=this;return I(function*(){return J(n.VERBOSE,{called:r.collectionName+".create",newElement:e}),(yield Cbe(r.collection,e)).id})()}read(e){var r=this;return I(function*(){J(n.VERBOSE,{called:r.collectionName+".read",id:e});const s=yield Sbe(_m(r.collection,e));return s.exists()?y.of(Se.getNonNullable(s.data())):y.empty()})()}exists(e){var r=this;return I(function*(){return J(n.VERBOSE,{called:r.collectionName+".exists",id:e}),(yield r.read(e)).isPresent()})()}update(e,r){var s=this;return I(function*(){return J(n.VERBOSE,{called:s.collectionName+".update",id:e,update:r}),Abe(_m(s.collection,e),r)})()}delete(e){return J(n.VERBOSE,{called:this.collectionName+".delete",id:e}),Mbe(_m(this.collection,e))}set(e,r){return J(n.VERBOSE,{called:this.collectionName+".set",id:e,element:r}),Obe(_m(this.collection,e),r)}subscribeToChanges(e,r){return new H1(Ate(_m(this.collection,e),s=>{r(y.ofNullable(s.data()))}))}findWhere(e,r,s){var i=this;return I(function*(){const o=i.constructQuery(e,r,s);return(yield Pbe(o)).docs.map(u=>({id:u.id,data:u.data()}))})()}observingWhere(e,r,s){J(n.VERBOSE,{called:this.collectionName+".observingWhere"});const i=this.constructQuery(e,s);return new H1(Ate(i,o=>{const c=[],u=[],h=[];o.docChanges().forEach(g=>{const m={id:g.doc.id,data:g.doc.data()};switch(g.type){case"added":c.push(m);break;case"modified":u.push(m);break;case"removed":h.push(m)}}),c.length>0&&(J(n.VERBOSE,"firebase gave us "+c.length+" NEW "+this.collectionName),r.onDocumentCreated(c)),u.length>0&&(J(n.VERBOSE,"firebase gave us "+u.length+" MODIFIED "+this.collectionName),r.onDocumentModified(u)),h.length>0&&(J(n.VERBOSE,"firebase gave us "+h.length+" DELETED "+this.collectionName),r.onDocumentDeleted(h))}))}constructQuery(e,r,s){let i=bS(this.collection);null!=r&&(i=bS(i,bbe(r))),null!=s&&(i=bS(i,wbe(s)));for(const o of e)i=bS(i,Nbe(o[0],o[1],o[2]));return i}subCollectionDAO(e,r){const s=`${this.collection.path}/${e}/${r}`;if(s in this.subDAOs)return this.subDAOs[s];{const i=new class extends n{constructor(o){super(s,o)}}(this.firestore);return this.subDAOs[s]=i,i}}}return n.VERBOSE=!1,n})(),Ibe=(()=>{class n extends vm{constructor(e){super("errors",e)}}return n.\u0275fac=function(e){return new(e||n)(Ve(Q0))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var xbe=gc(2486);let Mn=(()=>{class n{infoMessage(e){this.message(e,"is-info")}gameMessage(e){this.message(e,"is-warning")}criticalMessage(e){this.message(e,"is-danger")}message(e,r){(0,xbe.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:r,dismissible:!0})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class As{constructor(t,e,r){this.errorDAO=t,this.router=e,this.messageDisplayer=r,As.setSingletonInstance(this)}static setSingletonInstance(t){As.singleton=y.of(t)}static logErrorAndFail(t,e,r){throw As.logError(t,e,r),new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`)}static logError(t,e,r){if(this.singleton.isAbsent())throw new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`);return this.singleton.get().logError(t,e,r),z.failure(t+": "+e)}findErrors(t,e,r,s){return this.errorDAO.findWhere(void 0===s?[["component","==",t],["route","==",e],["message","==",r]]:[["component","==",t],["route","==",e],["message","==",r],["data","==",s]])}logError(t,e,r){var s=this;return I(function*(){s.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const i=s.router.url,o=yield s.findErrors(t,i,e,r);if(0===o.length){const c={component:t,route:i,message:e,firstEncounter:L4(),lastEncounter:L4(),occurences:1};null!=r&&(c.data=r),yield s.errorDAO.create(c)}else{const c=o[0].id,u=o[0].data;yield s.errorDAO.update(c,{lastEncounter:L4(),occurences:u.occurences+1})}})()}}As.singleton=y.empty(),As.\u0275fac=function(t){return new(t||As)(Ve(Ibe),Ve(Kn),Ve(Mn))},As.\u0275prov=et({token:As,factory:As.\u0275fac,providedIn:"root"});class Se{static expectToBe(t,e,r){if(t!==e)throw void 0!==r?new Error(r):new Error(`A default switch case did not observe the correct value, expected ${e}, but got ${t} instead.`)}static expectToBeMultiple(t,e){let r=!1;for(const s of e)if(t===s){r=!0;break}if(!1===r)throw new Error(`A default switch case did not observe the correct value, expected a value among ${e}, but got ${t} instead.`)}static getNonNullable(t){if(null==t)throw new Error("Expected value not to be null or undefined, but it was.");return t}static assert(t,e){if(!1===t)throw As.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}static identity(t){return t}}function J(n,t){n&&console.log(t)}let Lbe=(()=>{class n extends vm{constructor(e){super("chats",e),J(n.VERBOSE,"ChatDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(Q0))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Nte=(()=>{class n{}return n.CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`,n.FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`,n})(),OS=(()=>{class n{constructor(e){this.chatDAO=e,J(n.VERBOSE,"ChatService.constructor")}addMessage(e,r){var s=this;return I(function*(){return s.chatDAO.subCollectionDAO(e,"messages").create(r)})()}getLastMessages(e,r){var s=this;return I(function*(){return s.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",r)})()}subscribeToMessages(e,r){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],r,"postedTime")}deleteChat(e){var r=this;return I(function*(){return J(n.VERBOSE,"ChatService.deleteChat "+e),r.chatDAO.delete(e)})()}createNewChat(e){var r=this;return I(function*(){return r.chatDAO.set(e,{})})()}sendMessage(e,r,s,i){var o=this;return I(function*(){if(!1===o.userCanSendMessage(r.name,e))return z.failure(Nte.CANNOT_SEND_MESSAGE());if(o.isForbiddenMessage(s))return z.failure(Nte.FORBIDDEN_MESSAGE());const c={content:s,sender:r,postedTime:L4(),currentTurn:i};return yield o.addMessage(e,c),z.SUCCESS})()}userCanSendMessage(e,r){return""!==e}isForbiddenMessage(e){return""===e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(Lbe))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Zz=(()=>{class n extends vm{constructor(e){super(n.COLLECTION_NAME,e),J(n.VERBOSE,"UserDAO.constructor")}}return n.VERBOSE=!1,n.COLLECTION_NAME="users",n.\u0275fac=function(e){return new(e||n)(Ve(Q0))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Cm=(()=>{class n{constructor(e){this.userDAO=e}usernameIsAvailable(e){var r=this;return I(function*(){return 0===(yield r.userDAO.findWhere([["username","==",e]])).length})()}setUsername(e,r){var s=this;return I(function*(){yield s.userDAO.update(e,{username:r})})()}markAsVerified(e){var r=this;return I(function*(){yield r.userDAO.update(e,{verified:!0})})()}observeUser(e,r){return this.userDAO.subscribeToChanges(e,r)}getUserLastUpdateTime(e){var r=this;return I(function*(){const s=yield r.userDAO.read(e);if(s.isAbsent())return y.empty();{const i=s.get().lastUpdateTime;return Le(null!=i,"should not receive a lastUpdateTime equal to null"),y.of(i)}})()}updatePresenceToken(e){return this.userDAO.update(e,{lastUpdateTime:L4()})}}return n.\u0275fac=function(e){return new(e||n)(Ve(Zz))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ite extends q2{constructor(t=1/0,e=1/0,r=CR){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:r,_infiniteTimeWindow:s,_timestampProvider:i,_windowTime:o}=this;e||(r.push(t),!s&&r.push(i.now()+o)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:r,_buffer:s}=this,i=s.slice();for(let o=0;o<i.length&&!t.closed;o+=r?1:2)t.next(i[o]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:r,_infiniteTimeWindow:s}=this,i=(s?1:2)*t;if(t<1/0&&i<r.length&&r.splice(0,r.length-i),!s){const o=e.now();let c=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)c=u;c&&r.splice(0,c+1)}}}let ym=(()=>{class n{}return n.YOU_ARE_ALREADY_PLAYING=()=>$localize`You are already playing in another game.`,n.YOU_ARE_ALREADY_CREATING=()=>$localize`You are already the creator of another game.`,n.YOU_ARE_ALREADY_CHOSEN_OPPONENT=()=>$localize`You are already the chosen opponent in another game.`,n.YOU_ARE_ALREADY_CANDIDATE=()=>$localize`You are already candidate in another game.`,n.YOU_ARE_ALREADY_OBSERVING=()=>$localize`You are already observing another game.`,n})();class J0{static createUserWithEmailAndPassword(t,e,r){return sbe(t,e,r)}static sendEmailVerification(t){return abe(t)}static sendPasswordResetEmail(t,e){return cbe(t,e)}static signInWithEmailAndPassword(t,e,r){return I(function*(){return(yield lbe(t,e,r)).user})()}static signInWithPopup(t,e){return I(function*(){return(yield ube(t,e)).user})()}static updateProfile(t,e){return fbe(t,e)}}class w5{constructor(t,e,r,s){this.id=t,this.email=e,this.username=r,this.verified=s}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(t){return this.id===t.id&&this.email.equals(t.email)&&this.username.equals(t.username)&&this.verified===t.verified}}w5.NOT_CONNECTED=new w5("",y.empty(),y.empty(),!1);let Ns=(()=>{class n{constructor(e,r,s){var i=this;this.userDAO=e,this.userService=r,this.auth=s,this.user=y.empty(),this.userSubscription=new H1,J(n.VERBOSE,"ConnectedUserService constructor"),this.userRS=new Ite(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new H1(obe(this.auth,function(){var o=I(function*(c){null==c?(J(n.VERBOSE,"User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(w5.NOT_CONNECTED),i.user=y.empty()):(Le(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(c.uid,u=>{if(u.isPresent()){const h=u.get(),g=h.username;J(n.VERBOSE,`User ${g} is connected, and the verified status is ${i.emailVerified(c)}`);const m=!0===i.emailVerified(c)&&null!=g;if(!0===m&&!1===h.verified)return i.userService.markAsVerified(c.uid);const E=new w5(c.uid,y.ofNullable(c.email),y.ofNullable(g),m);!1===i.user.equalsValue(E)&&(i.user=y.of(E),i.userRS.next(E))}}))});return function(c){return o.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var r=this;return I(function*(){try{return yield J0.sendPasswordResetEmail(r.auth,e),z.SUCCESS}catch(s){return z.failure(r.mapFirebaseError(s))}})()}doRegister(e,r,s){var i=this;return I(function*(){return J(n.VERBOSE,"ConnectedUserService.doRegister("+r+")"),(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,r,s):_e.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,r,s){var i=this;return I(function*(){try{const o=yield J0.createUserWithEmailAndPassword(i.auth,r,s);yield J0.signInWithEmailAndPassword(i.auth,r,s);const c=Se.getNonNullable(o.user);return yield i.createUser(c.uid,e),_e.success(c)}catch(o){return _e.failure(i.mapFirebaseError(o))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return As.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return I(function*(){J(n.VERBOSE,"ConnectedUserService.sendEmailVerification()");const r=y.ofNullable(e.auth.currentUser);if(!r.isPresent())return As.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(r.get()))return As.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield J0.sendEmailVerification(r.get()),z.SUCCESS}catch(s){return z.failure(e.mapFirebaseError(s))}})()}doEmailLogin(e,r){var s=this;return I(function*(){J(n.VERBOSE,"ConnectedUserService.doEmailLogin("+e+")");try{return yield J0.signInWithEmailAndPassword(s.auth,e,r),z.SUCCESS}catch(i){return z.failure(s.mapFirebaseError(i))}})()}createUser(e,r){var s=this;return I(function*(){null==r?yield s.userDAO.set(e,{verified:!1}):yield s.userDAO.set(e,{username:r,verified:!1})})()}doGoogleLogin(){var e=this;return I(function*(){return z.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return I(function*(){try{const r=new QPe;r.addScope("profile"),r.addScope("email");const s=yield J0.signInWithPopup(e.auth,r);return!1===(yield e.userDAO.exists(s.uid))&&(yield e.createUser(s.uid)),_e.success(s)}catch(r){return _e.failure(e.mapFirebaseError(r))}})()}disconnect(){var e=this;return I(function*(){return y.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),z.SUCCESS):z.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var r=this;return I(function*(){if(""===e)return z.failure($localize`Your username may not be empty.`);try{if(!1===(yield r.userService.usernameIsAvailable(e)))return z.failure($localize`This username is already in use, please select a different one.`);const i=Se.getNonNullable(r.auth.currentUser);return yield J0.updateProfile(i,{displayName:e}),yield r.userService.setUsername(i.uid,e),yield r.userService.markAsVerified(i.uid),yield r.reloadUser(),z.SUCCESS}catch(s){return z.failure(r.mapFirebaseError(s))}})()}setPicture(e){var r=this;return I(function*(){try{const s=Se.getNonNullable(r.auth.currentUser);return yield J0.updateProfile(s,{photoURL:e}),z.SUCCESS}catch(s){return z.failure(r.mapFirebaseError(s))}})()}reloadUser(){var e=this;return I(function*(){const r=Se.getNonNullable(e.auth.currentUser);yield r.getIdToken(!0),yield r.reload()})()}sendPresenceToken(){return Le(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(Zz),Ve(Cm),Ve(wS))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class E1{constructor(t){this.value=t}}E1.HARD_DRAW=new E1(0),E1.RESIGN=new E1(1),E1.ESCAPE=new E1(2),E1.VICTORY=new E1(3),E1.TIMEOUT=new E1(4),E1.UNACHIEVED=new E1(5),E1.AGREED_DRAW_BY_ZERO=new E1(6),E1.AGREED_DRAW_BY_ONE=new E1(7);class AS{constructor(t,e){this.id=t,this.data=e}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===E1.HARD_DRAW.value}isAgreedDraw(){return this.data.result===E1.AGREED_DRAW_BY_ZERO.value||this.data.result===E1.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===E1.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(Le(this.data.result===E1.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),Se.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===E1.VICTORY.value}isTimeout(){return this.data.result===E1.TIMEOUT.value}isResign(){return this.data.result===E1.RESIGN.value}getWinner(){return y.ofNullable(this.data.winner)}getLoser(){return y.ofNullable(this.data.loser)}setWinnerAndLoser(t,e){return new AS(this.id,{...this.data,winner:t,loser:e})}}class Zs{constructor(t){this.value=t}static of(t){switch(t){case"CREATOR":return Zs.CREATOR;case"RANDOM":return Zs.RANDOM;default:return Le("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),Zs.CHOSEN_PLAYER}}}Zs.CREATOR=new Zs("CREATOR"),Zs.RANDOM=new Zs("RANDOM"),Zs.CHOSEN_PLAYER=new Zs("CHOSEN_PLAYER");class br{constructor(t){this.value=t}static of(t){switch(t){case"STANDARD":return br.STANDARD;case"BLITZ":return br.BLITZ;case"CUSTOM":return br.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}br.STANDARD=new br("STANDARD"),br.BLITZ=new br("BLITZ"),br.CUSTOM=new br("CUSTOM"),br.NORMAL_MOVE_DURATION=120,br.NORMAL_PART_DURATION=1800,br.BLITZ_MOVE_DURATION=30,br.BLITZ_PART_DURATION=900;class Ys{constructor(t){this.value=t}}Ys.PART_CREATED=new Ys(0),Ys.CONFIG_PROPOSED=new Ys(2),Ys.PART_STARTED=new Ys(3),Ys.PART_FINISHED=new Ys(4);class Yz{constructor(){this.value=2}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(t){return this===t}}Yz.NONE=new Yz;class B{constructor(t){this.value=t}static of(t){return 0===t?B.ZERO:(Se.expectToBe(t,1),B.ONE)}static fromTurn(t){return t%2==0?B.ZERO:B.ONE}isPlayer(){return!0}toString(){return this===B.ZERO?"PLAYER_ZERO":(Se.expectToBe(this,B.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(t){return this===t}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===B.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===B.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===B.ZERO?B.ONE:(Se.expectToBe(this,B.ONE),B.ZERO)}}var pe;B.encoder=new class extends xt{encodeMove(n){return n.value}decodeMove(n){return Se.assert(0===n||1===n,"Invalid encoded player: "+n),B.of(n)}},B.ZERO=new B(0),B.ONE=new B(1),B.PLAYERS=[B.ZERO,B.ONE],function(n){n.ZERO=B.ZERO,n.ONE=B.ONE,n.NONE=Yz.NONE,n.encoder=new class extends xt{encodeMove(t){return t.value}decodeMove(t){return 2===t?n.NONE:(Se.assert(0===t||1===t,"Invalid encoded player: "+t),B.of(t))}}}(pe||(pe={}));let Kz=(()=>{class n extends vm{constructor(e){super("parts",e),J(n.VERBOSE,"PartDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(Q0))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class NS{constructor(t,e,r){this.onDocumentCreated=t,this.onDocumentModified=e,this.onDocumentDeleted=r}}let Xz=(()=>{class n{constructor(e){this.partDAO=e}eventsCollection(e){return this.partDAO.subCollectionDAO(e,"events")}addEvent(e,r){return this.eventsCollection(e).create(r)}addMove(e,r,s){return this.addEvent(e,{eventType:"Move",time:L4(),player:r.value,move:s})}addRequest(e,r,s){return this.addEvent(e,{eventType:"Request",time:L4(),player:r.value,requestType:s})}addReply(e,r,s,i,o=null){return this.addEvent(e,{eventType:"Reply",time:L4(),player:r.value,reply:s,requestType:i,data:o})}startGame(e,r){return this.addAction(e,r,"StartGame")}addAction(e,r,s){return this.addEvent(e,{eventType:"Action",time:L4(),player:r.value,action:s})}subscribeToEvents(e,r){const s=new NS(i=>{const o=i.map(c=>c.data).filter(c=>null!=c.time);o.length>0&&r(o)},i=>{r(i.map(o=>o.data))},()=>{});return this.eventsCollection(e).observingWhere([],s,"time")}}return n.\u0275fac=function(e){return new(e||n)(Ve(Kz))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Rbe=(()=>{class n extends vm{constructor(e){super("config-room",e),J(n.VERBOSE,"ConfigRoomDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(Q0))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Qz=(()=>{class n{constructor(e,r){this.configRoomDAO=e,this.connectedUserService=r,J(n.VERBOSE,"ConfigRoomService.constructor")}addCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(r.id,r)}removeCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(r.id)}subscribeToChanges(e,r){return this.configRoomDAO.subscribeToChanges(e,r)}subscribeToCandidates(e,r){let s=[];const i=new NS(c=>{for(const u of c)s.push(u.data);r(s)},c=>{for(const u of c)s=s.map(h=>h.id===u.data.id?u.data:h);r(s)},c=>{for(const u of c)s=s.filter(h=>h.id!==u.data.id);r(s)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var r=this;return I(function*(){J(n.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+e+")");const s=r.connectedUserService.user.get().toMinimalUser();return r.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:Zs.RANDOM.value,partType:br.STANDARD.value,partStatus:Ys.PART_CREATED.value,maximalMoveDuration:br.NORMAL_MOVE_DURATION,totalPartDuration:br.NORMAL_PART_DURATION,creator:s})})()}joinGame(e){var r=this;return I(function*(){J(n.VERBOSE,"ConfigRoomService.joinGame("+e+")");const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);return i.isAbsent()?z.failure(n.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==s.id&&(yield r.addCandidate(e,s)),z.SUCCESS)})()}cancelJoining(e){var r=this;return I(function*(){J(n.VERBOSE,`ConfigRoomService.cancelJoining(${e})`);const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);if(!i.isAbsent()){const o=i.get(),c=[r.removeCandidate(e,s)];o.chosenOpponent?.id===s.id&&c.push(r.configRoomDAO.update(e,{chosenOpponent:null,partStatus:Ys.PART_CREATED.value})),yield Promise.all(c)}})()}deleteConfigRoom(e,r){var s=this;return I(function*(){J(n.VERBOSE,`ConfigRoomService.deleteConfigRoom(${e}`),yield Promise.all(r.map(i=>s.removeCandidate(e,i))),yield s.configRoomDAO.delete(e)})()}proposeConfig(e,r,s,i,o,c){var u=this;return I(function*(){return J(n.VERBOSE,{configRoomService_proposeConfig:{configRoomId:e,maximalMoveDuration:i,firstPlayer:o,totalPartDuration:c}}),u.configRoomDAO.update(e,{partStatus:Ys.CONFIG_PROPOSED.value,chosenOpponent:r,partType:s.value,maximalMoveDuration:i,totalPartDuration:c,firstPlayer:o.value})})()}setChosenOpponent(e,r){return J(n.VERBOSE,`ConfigRoomService.setChosenOpponent(${e}, ${r.name})`),this.configRoomDAO.update(e,{chosenOpponent:r})}reviewConfig(e){var r=this;return I(function*(){return J(n.VERBOSE,`ConfigRoomService.reviewConfig(${e})`),r.configRoomDAO.update(e,{partStatus:Ys.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var r=this;return I(function*(){return J(n.VERBOSE,`ConfigRoomService.reviewConfigAndRemoveChosenOpponent(${e})`),r.configRoomDAO.update(e,{partStatus:Ys.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return J(n.VERBOSE,`ConfigRoomService.acceptConfig(${e}`),this.configRoomDAO.update(e,{partStatus:Ys.PART_STARTED.value})}createConfigRoom(e,r){var s=this;return I(function*(){return J(n.VERBOSE,`ConfigRoomService.create(${e}`+JSON.stringify(r)+")"),s.configRoomDAO.set(e,r)})()}readConfigRoomById(e){var r=this;return I(function*(){return J(n.VERBOSE,`ConfigRoomService.readConfigRoomById(${e})`),(yield r.configRoomDAO.read(e)).get()})()}}return n.VERBOSE=!1,n.GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`,n.\u0275fac=function(e){return new(e||n)(Ve(Rbe),Ve(Ns))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),IS=(()=>{class n{constructor(e,r,s,i,o){this.partDAO=e,this.gameEventService=r,this.connectedUserService=s,this.configRoomService=i,this.chatService=o,J(n.VERBOSE,"GameService.constructor")}update(e,r){var s=this;return I(function*(){return s.partDAO.update(e,r)})()}getPartValidity(e,r){var s=this;return I(function*(){const i=yield s.partDAO.read(e);return i.isAbsent()?z.failure("NONEXISTENT_PART"):i.get().typeGame===r?z.SUCCESS:z.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){J(n.VERBOSE,"GameService.createUnstartedPart("+e+")");const r=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({typeGame:e,playerZero:r,turn:-1,result:E1.UNACHIEVED.value})}createChat(e){return J(n.VERBOSE,"GameService.createChat("+e+")"),this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var r=this;return I(function*(){J(n.VERBOSE,`GameService.createGame(${e})`);const s=yield r.createUnstartedPart(e);return yield r.configRoomService.createInitialConfigRoom(s),yield r.createChat(s),s})()}getStartingConfig(e){let s,i,r=Zs.of(e.firstPlayer);return r===Zs.RANDOM&&(r=Math.random()<.5?Zs.CREATOR:Zs.CHOSEN_PLAYER),r===Zs.CREATOR?(s=e.creator,i=Se.getNonNullable(e.chosenOpponent)):(s=Se.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:s,playerOne:i,turn:0,beginning:L4()}}deletePart(e){return J(n.VERBOSE,"GameService.deletePart("+e+")"),this.partDAO.delete(e)}acceptConfig(e,r){var s=this;return I(function*(){J(n.VERBOSE,{gameService_acceptConfig:{partId:e,configRoom:r}}),yield s.configRoomService.acceptConfig(e);const i=s.getStartingConfig(r);let o;o=i.playerZero===r.creator?B.ONE:B.ZERO,yield s.partDAO.update(e,i),yield s.gameEventService.startGame(e,o)})()}getPart(e){return this.partDAO.read(e)}subscribeToChanges(e,r){return this.partDAO.subscribeToChanges(e,r)}resign(e,r,s,i){var o=this;return I(function*(){const c={winner:s,loser:i,result:E1.RESIGN.value};yield o.partDAO.update(e,c),yield o.gameEventService.addAction(e,r,"EndGame")})()}notifyTimeout(e,r,s,i){var o=this;return I(function*(){const c={winner:s,loser:i,result:E1.TIMEOUT.value};yield o.partDAO.update(e,c),yield o.gameEventService.addAction(e,r,"EndGame")})()}proposeDraw(e,r){var s=this;return I(function*(){yield s.gameEventService.addRequest(e,r,"Draw")})()}acceptDraw(e,r){var s=this;return I(function*(){yield s.gameEventService.addReply(e,r,"Accept","Draw");const o={result:(r===B.ZERO?E1.AGREED_DRAW_BY_ZERO:E1.AGREED_DRAW_BY_ONE).value};yield s.partDAO.update(e,o),yield s.gameEventService.addAction(e,r,"EndGame")})()}refuseDraw(e,r){var s=this;return I(function*(){yield s.gameEventService.addReply(e,r,"Reject","Draw")})()}proposeRematch(e,r){var s=this;return I(function*(){yield s.gameEventService.addRequest(e,r,"Rematch")})()}rejectRematch(e,r){var s=this;return I(function*(){yield s.gameEventService.addReply(e,r,"Reject","Rematch")})()}acceptRematch(e,r){var s=this;return I(function*(){J(n.VERBOSE,{called:"GameService.acceptRematch",partDocument:e});const i=Se.getNonNullable(e.data),o=yield s.configRoomService.readConfigRoomById(e.id);let c;const u=s.connectedUserService.user.get().toMinimalUser();let h;i.playerZero.id===u.id?(h=Se.getNonNullable(i.playerOne),c=Zs.CHOSEN_PLAYER):(h=i.playerZero,c=Zs.CREATOR);const g={...o,firstPlayer:c.value,creator:u,chosenOpponent:h,partStatus:Ys.PART_STARTED.value},m=s.getStartingConfig(g),E={typeGame:i.typeGame,result:E1.UNACHIEVED.value,...m},b=yield s.partDAO.create(E);yield s.configRoomService.createConfigRoom(b,g),yield s.createChat(b),yield s.gameEventService.addReply(e.id,r,"Accept","Rematch",b),yield s.gameEventService.startGame(b,r.getOpponent())})()}askTakeBack(e,r){var s=this;return I(function*(){yield s.gameEventService.addRequest(e,r,"TakeBack")})()}acceptTakeBack(e,r,s){var i=this;return I(function*(){let o=r-1;o%2===s.value&&o--;const c={turn:o};return yield i.gameEventService.addReply(e,s,"Accept","TakeBack"),yield i.partDAO.update(e,c)})()}refuseTakeBack(e,r){var s=this;return I(function*(){yield s.gameEventService.addReply(e,r,"Reject","TakeBack")})()}addGlobalTime(e,r){var s=this;return I(function*(){yield s.gameEventService.addAction(e,r,"AddGlobalTime")})()}addTurnTime(e,r){var s=this;return I(function*(){yield s.gameEventService.addAction(e,r,"AddTurnTime")})()}preparePartUpdate(e,r){var s=this;return I(function*(){let c={turn:(yield s.partDAO.read(e)).get().turn+1};return c=s.updateScore(c,r),c})()}updatePart(e,r){var s=this;return I(function*(){J(n.VERBOSE,{gameService_updatePart:{partId:e,scores:r}});const i=yield s.preparePartUpdate(e,r);yield s.update(e,i)})()}drawPart(e,r,s){var i=this;return I(function*(){let o=yield i.preparePartUpdate(e,s);o={...o,result:E1.HARD_DRAW.value},yield i.update(e,o),yield i.gameEventService.addAction(e,r,"EndGame")})()}endPartWithVictory(e,r,s,i,o){var c=this;return I(function*(){let u=yield c.preparePartUpdate(e,o);u={...u,winner:s,loser:i,result:E1.VICTORY.value},yield c.update(e,u),yield c.gameEventService.addAction(e,r,"EndGame")})()}addMove(e,r,s){var i=this;return I(function*(){yield i.gameEventService.addMove(e,r,s)})()}updateScore(e,r){return void 0!==r?{...e,scorePlayerZero:r[0],scorePlayerOne:r[1]}:e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Ve(Kz),Ve(Xz),Ve(Ns),Ve(Qz),Ve(OS))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var tne={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},ane={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},cne={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class Em{static getNavigatorLanguage(){return navigator.language}static getLocale(){const r=(localStorage.getItem("locale")??Em.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(s=>s===r)?r:"fr"}}let dne=(()=>{class n{changeTheme(e){localStorage.setItem("theme",e)}getTheme(){return y.ofNullable(localStorage.getItem("theme"))}changeLanguage(e){localStorage.setItem("locale",e.toLowerCase())}getLanguage(){return Em.getLocale()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),xS=(()=>{class n{constructor(e,r){this.document=e,this.userSettingsService=r,this.availableThemes=["dark","light"];const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const e=this.userSettingsService.getTheme();if(e.isPresent()){const r=e.get();if(this.availableThemes.some(s=>s===r))return y.of(r)}return y.empty()}loadTheme(e){this.loadStyle(e+".css"),this.theme=e}loadStyle(e){const r=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=e;else{const i=this.document.createElement("link");i.id="theme",i.rel="stylesheet",i.href=`${e}`,r.appendChild(i)}}getTheme(){return this.theme}}return n.\u0275fac=function(e){return new(e||n)(Ve($s),Ve(dne))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function pne(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),e.push.apply(e,r)}return e}function St(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?pne(Object(e),!0).forEach(function(r){vi(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):pne(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function kS(n){return(kS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function gne(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function vi(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function eV(n,t){return function _De(n){if(Array.isArray(n))return n}(n)||function CDe(n,t){var e=null==n?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var o,c,r=[],s=!0,i=!1;try{for(e=e.call(n);!(s=(o=e.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(u){i=!0,c=u}finally{try{!s&&null!=e.return&&e.return()}finally{if(i)throw c}}return r}}(n,t)||mne(n,t)||function EDe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sm(n){return function mDe(n){if(Array.isArray(n))return tV(n)}(n)||function vDe(n){if(typeof Symbol<"u"&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||mne(n)||function yDe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mne(n,t){if(n){if("string"==typeof n)return tV(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if("Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return tV(n,t)}}function tV(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var _ne=function(){},nV={},vne={},Cne=null,yne={mark:_ne,measure:_ne};try{typeof window<"u"&&(nV=window),typeof document<"u"&&(vne=document),typeof MutationObserver<"u"&&(Cne=MutationObserver),typeof performance<"u"&&(yne=performance)}catch{}var DS,zS,VS,HS,FS,Ene=(nV.navigator||{}).userAgent,Mne=void 0===Ene?"":Ene,e8=nV,Or=vne,Sne=Cne,RS=yne,c6=!!Or.documentElement&&!!Or.head&&"function"==typeof Or.addEventListener&&"function"==typeof Or.createElement,Pne=~Mne.indexOf("MSIE")||~Mne.indexOf("Trident/"),l6="___FONT_AWESOME___",wne="svg-inline--fa",b5="data-fa-i2svg",sV="data-fa-pseudo-element",iV="data-prefix",oV="data-icon",bne="fontawesome-i2svg",TDe=["HTML","HEAD","STYLE","SCRIPT"],One=function(){try{return!0}catch{return!1}}(),Ar="classic",ps="sharp",aV=[Ar,ps];function Pm(n){return new Proxy(n,{get:function(e,r){return r in e?e[r]:e[Ar]}})}var Tm=Pm((vi(DS={},Ar,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),vi(DS,ps,{fa:"solid",fass:"solid","fa-solid":"solid"}),DS)),wm=Pm((vi(zS={},Ar,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),vi(zS,ps,{solid:"fass"}),zS)),bm=Pm((vi(VS={},Ar,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),vi(VS,ps,{fass:"fa-solid"}),VS)),wDe=Pm((vi(HS={},Ar,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),vi(HS,ps,{"fa-solid":"fass"}),HS)),bDe=/fa(s|r|l|t|d|b|k|ss)?[\-\ ]/,Ane="fa-layers-text",ODe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,ADe=Pm((vi(FS={},Ar,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),vi(FS,ps,{900:"fass"}),FS)),Nne=[1,2,3,4,5,6,7,8,9,10],NDe=Nne.concat([11,12,13,14,15,16,17,18,19,20]),IDe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],Om=new Set;Object.keys(wm[Ar]).map(Om.add.bind(Om)),Object.keys(wm[ps]).map(Om.add.bind(Om));var xDe=[].concat(aV,Sm(Om),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul","duotone-group","swap-opacity","primary","secondary"]).concat(Nne.map(function(n){return"".concat(n,"x")})).concat(NDe.map(function(n){return"w-".concat(n)})),Am=e8.FontAwesomeConfig||{};Or&&"function"==typeof Or.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(n){var t=eV(n,2),r=t[1],s=function LDe(n){return""===n||"false"!==n&&("true"===n||n)}(function kDe(n){var t=Or.querySelector("script["+n+"]");if(t)return t.getAttribute(n)}(t[0]));null!=s&&(Am[r]=s)});var Ine={styleDefault:"solid",familyDefault:"classic",cssPrefix:"fa",replacementClass:wne,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};Am.familyPrefix&&(Am.cssPrefix=Am.familyPrefix);var Sh=St(St({},Ine),Am);Sh.autoReplaceSvg||(Sh.observeMutations=!1);var kt={};Object.keys(Ine).forEach(function(n){Object.defineProperty(kt,n,{enumerable:!0,set:function(e){Sh[n]=e,Nm.forEach(function(r){return r(kt)})},get:function(){return Sh[n]}})}),Object.defineProperty(kt,"familyPrefix",{enumerable:!0,set:function(t){Sh.cssPrefix=t,Nm.forEach(function(e){return e(kt)})},get:function(){return Sh.cssPrefix}}),e8.FontAwesomeConfig=kt;var Nm=[],z4={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function Im(){for(var n=12,t="";n-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function Ph(n){for(var t=[],e=(n||[]).length>>>0;e--;)t[e]=n[e];return t}function cV(n){return n.classList?Ph(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(t){return t})}function xne(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function BS(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,": ").concat(n[e].trim(),";")},"")}function lV(n){return n.size!==z4.size||n.x!==z4.x||n.y!==z4.y||n.rotate!==z4.rotate||n.flipX||n.flipY}function kne(){var n="fa",t=wne,e=kt.cssPrefix,r=kt.replacementClass,s=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';if(e!==n||r!==t){var i=new RegExp("\\.".concat(n,"\\-"),"g"),o=new RegExp("\\--".concat(n,"\\-"),"g"),c=new RegExp("\\.".concat(t),"g");s=s.replace(i,".".concat(e,"-")).replace(o,"--".concat(e,"-")).replace(c,".".concat(r))}return s}var Lne=!1;function uV(){kt.autoAddCss&&!Lne&&(function zDe(n){if(n&&c6){var t=Or.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=n;for(var e=Or.head.childNodes,r=null,s=e.length-1;s>-1;s--){var i=e[s],o=(i.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=i)}Or.head.insertBefore(t,r)}}(kne()),Lne=!0)}var UDe={mixout:function(){return{dom:{css:kne,insertCss:uV}}},hooks:function(){return{beforeDOMElementCreation:function(){uV()},beforeI2svg:function(){uV()}}}},u6=e8||{};u6[l6]||(u6[l6]={}),u6[l6].styles||(u6[l6].styles={}),u6[l6].hooks||(u6[l6].hooks={}),u6[l6].shims||(u6[l6].shims=[]);var k3=u6[l6],Rne=[],$S=!1;function qDe(n){!c6||($S?setTimeout(n,0):Rne.push(n))}function xm(n){var t=n.tag,e=n.attributes,r=void 0===e?{}:e,s=n.children,i=void 0===s?[]:s;return"string"==typeof n?xne(n):"<".concat(t," ").concat(function HDe(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,'="').concat(xne(n[e]),'" ')},"").trim()}(r),">").concat(i.map(xm).join(""),"</").concat(t,">")}function Dne(n,t,e){if(n&&n[t]&&n[t][e])return{prefix:t,iconName:e,icon:n[t][e]}}c6&&(($S=(Or.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Or.readyState))||Or.addEventListener("DOMContentLoaded",function n(){Or.removeEventListener("DOMContentLoaded",n),$S=1,Rne.map(function(t){return t()})}));var fV=function(t,e,r,s){var u,h,g,i=Object.keys(t),o=i.length,c=void 0!==s?function(t,e){return function(r,s,i,o){return t.call(e,r,s,i,o)}}(e,s):e;for(void 0===r?(u=1,g=t[i[0]]):(u=0,g=r);u<o;u++)g=c(g,t[h=i[u]],h,t);return g};function hV(n){var t=function jDe(n){for(var t=[],e=0,r=n.length;e<r;){var s=n.charCodeAt(e++);if(s>=55296&&s<=56319&&e<r){var i=n.charCodeAt(e++);56320==(64512&i)?t.push(((1023&s)<<10)+(1023&i)+65536):(t.push(s),e--)}else t.push(s)}return t}(n);return 1===t.length?t[0].toString(16):null}function zne(n){return Object.keys(n).reduce(function(t,e){var r=n[e];return r.icon?t[r.iconName]=r.icon:t[e]=r,t},{})}function dV(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.skipHooks,s=void 0!==r&&r,i=zne(t);"function"!=typeof k3.hooks.addPack||s?k3.styles[n]=St(St({},k3.styles[n]||{}),i):k3.hooks.addPack(n,zne(t)),"fas"===n&&dV("fa",t)}var US,GS,qS,Th=k3.styles,YDe=k3.shims,KDe=(vi(US={},Ar,Object.values(bm[Ar])),vi(US,ps,Object.values(bm[ps])),US),pV=null,Vne={},Hne={},Fne={},Bne={},$ne={},XDe=(vi(GS={},Ar,Object.keys(Tm[Ar])),vi(GS,ps,Object.keys(Tm[ps])),GS);function JDe(n,t){var e=t.split("-"),r=e[0],s=e.slice(1).join("-");return r!==n||""===s||function QDe(n){return~xDe.indexOf(n)}(s)?null:s}var Une=function(){var t=function(i){return fV(Th,function(o,c,u){return o[u]=fV(c,i,{}),o},{})};Vne=t(function(s,i,o){return i[3]&&(s[i[3]]=o),i[2]&&i[2].filter(function(u){return"number"==typeof u}).forEach(function(u){s[u.toString(16)]=o}),s}),Hne=t(function(s,i,o){return s[o]=o,i[2]&&i[2].filter(function(u){return"string"==typeof u}).forEach(function(u){s[u]=o}),s}),$ne=t(function(s,i,o){var c=i[2];return s[o]=o,c.forEach(function(u){s[u]=o}),s});var e="far"in Th||kt.autoFetchSvg,r=fV(YDe,function(s,i){var o=i[0],c=i[1],u=i[2];return"far"===c&&!e&&(c="fas"),"string"==typeof o&&(s.names[o]={prefix:c,iconName:u}),"number"==typeof o&&(s.unicodes[o.toString(16)]={prefix:c,iconName:u}),s},{names:{},unicodes:{}});Fne=r.names,Bne=r.unicodes,pV=WS(kt.styleDefault,{family:kt.familyDefault})};function gV(n,t){return(Vne[n]||{})[t]}function A5(n,t){return($ne[n]||{})[t]}function Gne(n){return Fne[n]||{prefix:null,iconName:null}}function n8(){return pV}function WS(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.family,r=void 0===e?Ar:e,s=Tm[r][n],i=wm[r][n]||wm[r][s],o=n in k3.styles?n:null;return i||o||null}(function DDe(n){Nm.push(n)})(function(n){pV=WS(n.styleDefault,{family:kt.familyDefault})}),Une();var qne=(vi(qS={},Ar,Object.keys(bm[Ar])),vi(qS,ps,Object.keys(bm[ps])),qS);function jS(n){var t,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.skipLookups,s=void 0!==r&&r,i=(vi(t={},Ar,"".concat(kt.cssPrefix,"-").concat(Ar)),vi(t,ps,"".concat(kt.cssPrefix,"-").concat(ps)),t),o=null,c=Ar;(n.includes(i[Ar])||n.some(function(h){return qne[Ar].includes(h)}))&&(c=Ar),(n.includes(i[ps])||n.some(function(h){return qne[ps].includes(h)}))&&(c=ps);var u=n.reduce(function(h,g){var m=JDe(kt.cssPrefix,g);if(Th[g]?(g=KDe[c].includes(g)?wDe[c][g]:g,o=g,h.prefix=g):XDe[c].indexOf(g)>-1?(o=g,h.prefix=WS(g,{family:c})):m?h.iconName=m:g!==kt.replacementClass&&g!==i[Ar]&&g!==i[ps]&&h.rest.push(g),!s&&h.prefix&&h.iconName){var E="fa"===o?Gne(h.iconName):{},b=A5(h.prefix,h.iconName);E.prefix&&(o=null),h.iconName=E.iconName||b||h.iconName,h.prefix=E.prefix||h.prefix,"far"===h.prefix&&!Th.far&&Th.fas&&!kt.autoFetchSvg&&(h.prefix="fas")}return h},{prefix:null,iconName:null,rest:[]});return(n.includes("fa-brands")||n.includes("fab"))&&(u.prefix="fab"),(n.includes("fa-duotone")||n.includes("fad"))&&(u.prefix="fad"),!u.prefix&&c===ps&&(Th.fass||kt.autoFetchSvg)&&(u.prefix="fass",u.iconName=A5(u.prefix,u.iconName)||u.iconName),("fa"===u.prefix||"fa"===o)&&(u.prefix=n8()||"fas"),u}var nze=function(){function n(){(function dDe(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),this.definitions={}}return function pDe(n,t,e){t&&gne(n.prototype,t),e&&gne(n,e),Object.defineProperty(n,"prototype",{writable:!1})}(n,[{key:"add",value:function(){for(var e=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var o=s.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(c){e.definitions[c]=St(St({},e.definitions[c]||{}),o[c]),dV(c,o[c]);var u=bm[Ar][c];u&&dV(u,o[c]),Une()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,r){var s=r.prefix&&r.iconName&&r.icon?{0:r}:r;return Object.keys(s).map(function(i){var o=s[i],c=o.prefix,u=o.iconName,h=o.icon,g=h[2];e[c]||(e[c]={}),g.length>0&&g.forEach(function(m){"string"==typeof m&&(e[c][m]=h)}),e[c][u]=h}),e}}]),n}(),Wne=[],wh={},bh={},rze=Object.keys(bh);function _V(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),s=2;s<e;s++)r[s-2]=arguments[s];var i=wh[n]||[];return i.forEach(function(o){t=o.apply(null,[t].concat(r))}),t}function N5(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];var s=wh[n]||[];s.forEach(function(i){i.apply(null,e)})}function f6(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);return bh[n]?bh[n].apply(null,t):void 0}function vV(n){"fa"===n.prefix&&(n.prefix="fas");var t=n.iconName,e=n.prefix||n8();if(t)return t=A5(e,t)||t,Dne(jne.definitions,e,t)||Dne(k3.styles,e,t)}var jne=new nze,oze={i2svg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c6?(N5("beforeI2svg",t),f6("pseudoElements2svg",t),f6("i2svg",t)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot;!1===kt.autoReplaceSvg&&(kt.autoReplaceSvg=!0),kt.observeMutations=!0,qDe(function(){cze({autoReplaceSvgRoot:e}),N5("watch",t)})}},ec={noAuto:function(){kt.autoReplaceSvg=!1,kt.observeMutations=!1,N5("noAuto")},config:kt,dom:oze,parse:{icon:function(t){if(null===t)return null;if("object"===kS(t)&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:A5(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&2===t.length){var e=0===t[1].indexOf("fa-")?t[1].slice(3):t[1],r=WS(t[0]);return{prefix:r,iconName:A5(r,e)||e}}if("string"==typeof t&&(t.indexOf("".concat(kt.cssPrefix,"-"))>-1||t.match(bDe))){var s=jS(t.split(" "),{skipLookups:!0});return{prefix:s.prefix||n8(),iconName:A5(s.prefix,s.iconName)||s.iconName}}if("string"==typeof t){var i=n8();return{prefix:i,iconName:A5(i,t)||t}}}},library:jne,findIconDefinition:vV,toHtml:xm},cze=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot,r=void 0===e?Or:e;(Object.keys(k3.styles).length>0||kt.autoFetchSvg)&&c6&&kt.autoReplaceSvg&&ec.dom.i2svg({node:r})};function ZS(n,t){return Object.defineProperty(n,"abstract",{get:t}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(r){return xm(r)})}}),Object.defineProperty(n,"node",{get:function(){if(c6){var r=Or.createElement("div");return r.innerHTML=n.html,r.children}}}),n}function CV(n){var t=n.icons,e=t.main,r=t.mask,s=n.prefix,i=n.iconName,o=n.transform,c=n.symbol,u=n.title,h=n.maskId,g=n.titleId,m=n.extra,E=n.watchable,b=void 0!==E&&E,k=r.found?r:e,U=k.width,j=k.height,oe="fak"===s,ye=[kt.replacementClass,i?"".concat(kt.cssPrefix,"-").concat(i):""].filter(function(N1){return-1===m.classes.indexOf(N1)}).filter(function(N1){return""!==N1||!!N1}).concat(m.classes).join(" "),te={children:[],attributes:St(St({},m.attributes),{},{"data-prefix":s,"data-icon":i,class:ye,role:m.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(U," ").concat(j)})},ke=oe&&!~m.classes.indexOf("fa-fw")?{width:"".concat(U/j*16*.0625,"em")}:{};b&&(te.attributes[b5]=""),u&&(te.children.push({tag:"title",attributes:{id:te.attributes["aria-labelledby"]||"title-".concat(g||Im())},children:[u]}),delete te.attributes.title);var Ge=St(St({},te),{},{prefix:s,iconName:i,main:e,mask:r,maskId:h,transform:o,symbol:c,styles:St(St({},ke),m.styles)}),Xe=r.found&&e.found?f6("generateAbstractMask",Ge)||{children:[],attributes:{}}:f6("generateAbstractIcon",Ge)||{children:[],attributes:{}},V1=Xe.attributes;return Ge.children=Xe.children,Ge.attributes=V1,c?function uze(n){var e=n.iconName,r=n.children,s=n.attributes,i=n.symbol,o=!0===i?"".concat(n.prefix,"-").concat(kt.cssPrefix,"-").concat(e):i;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:St(St({},s),{},{id:o}),children:r}]}]}(Ge):function lze(n){var t=n.children,e=n.main,r=n.mask,s=n.attributes,i=n.styles,o=n.transform;if(lV(o)&&e.found&&!r.found){var h={x:e.width/e.height/2,y:.5};s.style=BS(St(St({},i),{},{"transform-origin":"".concat(h.x+o.x/16,"em ").concat(h.y+o.y/16,"em")}))}return[{tag:"svg",attributes:s,children:t}]}(Ge)}function Zne(n){var t=n.content,e=n.width,r=n.height,s=n.transform,i=n.title,o=n.extra,c=n.watchable,u=void 0!==c&&c,h=St(St(St({},o.attributes),i?{title:i}:{}),{},{class:o.classes.join(" ")});u&&(h[b5]="");var g=St({},o.styles);lV(s)&&(g.transform=function BDe(n){var t=n.transform,e=n.width,s=n.height,i=void 0===s?16:s,o=n.startCentered,c=void 0!==o&&o,u="";return u+=c&&Pne?"translate(".concat(t.x/16-(void 0===e?16:e)/2,"em, ").concat(t.y/16-i/2,"em) "):c?"translate(calc(-50% + ".concat(t.x/16,"em), calc(-50% + ").concat(t.y/16,"em)) "):"translate(".concat(t.x/16,"em, ").concat(t.y/16,"em) "),(u+="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "))+"rotate(".concat(t.rotate,"deg) ")}({transform:s,startCentered:!0,width:e,height:r}),g["-webkit-transform"]=g.transform);var m=BS(g);m.length>0&&(h.style=m);var E=[];return E.push({tag:"span",attributes:h,children:[t]}),i&&E.push({tag:"span",attributes:{class:"sr-only"},children:[i]}),E}function fze(n){var t=n.content,e=n.title,r=n.extra,s=St(St(St({},r.attributes),e?{title:e}:{}),{},{class:r.classes.join(" ")}),i=BS(r.styles);i.length>0&&(s.style=i);var o=[];return o.push({tag:"span",attributes:s,children:[t]}),e&&o.push({tag:"span",attributes:{class:"sr-only"},children:[e]}),o}var yV=k3.styles;function EV(n){var t=n[0],e=n[1],i=eV(n.slice(4),1)[0];return{found:!0,width:t,height:e,icon:Array.isArray(i)?{tag:"g",attributes:{class:"".concat(kt.cssPrefix,"-").concat("duotone-group")},children:[{tag:"path",attributes:{class:"".concat(kt.cssPrefix,"-").concat("secondary"),fill:"currentColor",d:i[0]}},{tag:"path",attributes:{class:"".concat(kt.cssPrefix,"-").concat("primary"),fill:"currentColor",d:i[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:i}}}}var hze={found:!1,width:512,height:512};function MV(n,t){var e=t;return"fa"===t&&null!==kt.styleDefault&&(t=n8()),new Promise(function(r,s){if(f6("missingIconAbstract"),"fa"===e){var o=Gne(n)||{};n=o.iconName||n,t=o.prefix||t}if(n&&t&&yV[t]&&yV[t][n])return r(EV(yV[t][n]));(function dze(n,t){!One&&!kt.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(t,'" is missing.'))})(n,t),r(St(St({},hze),{},{icon:kt.showMissingIcons&&n&&f6("missingIconAbstract")||{}}))})}var Yne=function(){},SV=kt.measurePerformance&&RS&&RS.mark&&RS.measure?RS:{mark:Yne,measure:Yne},km='FA "6.2.1"',PV_begin=function(t){return SV.mark("".concat(km," ").concat(t," begins")),function(){return function(t){SV.mark("".concat(km," ").concat(t," ends")),SV.measure("".concat(km," ").concat(t),"".concat(km," ").concat(t," begins"),"".concat(km," ").concat(t," ends"))}(t)}},YS=function(){};function Xne(n){return"string"==typeof(n.getAttribute?n.getAttribute(b5):null)}function vze(n){return Or.createElementNS("http://www.w3.org/2000/svg",n)}function Cze(n){return Or.createElement(n)}function Qne(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.ceFn,r=void 0===e?"svg"===n.tag?vze:Cze:e;if("string"==typeof n)return Or.createTextNode(n);var s=r(n.tag);Object.keys(n.attributes||[]).forEach(function(o){s.setAttribute(o,n.attributes[o])});var i=n.children||[];return i.forEach(function(o){s.appendChild(Qne(o,{ceFn:r}))}),s}var KS={replace:function(t){var e=t[0];if(e.parentNode)if(t[1].forEach(function(s){e.parentNode.insertBefore(Qne(s),e)}),null===e.getAttribute(b5)&&kt.keepOriginalSource){var r=Or.createComment(function yze(n){var t=" ".concat(n.outerHTML," ");return"".concat(t,"Font Awesome fontawesome.com ")}(e));e.parentNode.replaceChild(r,e)}else e.remove()},nest:function(t){var e=t[0],r=t[1];if(~cV(e).indexOf(kt.replacementClass))return KS.replace(t);var s=new RegExp("".concat(kt.cssPrefix,"-.*"));if(delete r[0].attributes.id,r[0].attributes.class){var i=r[0].attributes.class.split(" ").reduce(function(c,u){return u===kt.replacementClass||u.match(s)?c.toSvg.push(u):c.toNode.push(u),c},{toNode:[],toSvg:[]});r[0].attributes.class=i.toSvg.join(" "),0===i.toNode.length?e.removeAttribute("class"):e.setAttribute("class",i.toNode.join(" "))}var o=r.map(function(c){return xm(c)}).join("\n");e.setAttribute(b5,""),e.innerHTML=o}};function Jne(n){n()}function e1e(n,t){var e="function"==typeof t?t:YS;if(0===n.length)e();else{var r=Jne;"async"===kt.mutateApproach&&(r=e8.requestAnimationFrame||Jne),r(function(){var s=function _ze(){return!0===kt.autoReplaceSvg?KS.replace:KS[kt.autoReplaceSvg]||KS.replace}(),i=PV_begin("mutate");n.map(s),i(),e()})}}var TV=!1;function t1e(){TV=!0}function wV(){TV=!1}var XS=null;function n1e(n){if(Sne&&kt.observeMutations){var t=n.treeCallback,e=void 0===t?YS:t,r=n.nodeCallback,s=void 0===r?YS:r,i=n.pseudoElementsCallback,o=void 0===i?YS:i,c=n.observeMutationsRoot,u=void 0===c?Or:c;XS=new Sne(function(h){if(!TV){var g=n8();Ph(h).forEach(function(m){if("childList"===m.type&&m.addedNodes.length>0&&!Xne(m.addedNodes[0])&&(kt.searchPseudoElements&&o(m.target),e(m.target)),"attributes"===m.type&&m.target.parentNode&&kt.searchPseudoElements&&o(m.target.parentNode),"attributes"===m.type&&Xne(m.target)&&~IDe.indexOf(m.attributeName))if("class"===m.attributeName&&function gze(n){var t=n.getAttribute?n.getAttribute(iV):null,e=n.getAttribute?n.getAttribute(oV):null;return t&&e}(m.target)){var E=jS(cV(m.target)),k=E.iconName;m.target.setAttribute(iV,E.prefix||g),k&&m.target.setAttribute(oV,k)}else(function mze(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(kt.replacementClass)})(m.target)&&s(m.target)})}}),c6&&XS.observe(u,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function Mze(n){var t=n.getAttribute("style"),e=[];return t&&(e=t.split(";").reduce(function(r,s){var i=s.split(":"),o=i[0],c=i.slice(1);return o&&c.length>0&&(r[o]=c.join(":").trim()),r},{})),e}function Sze(n){var t=n.getAttribute("data-prefix"),e=n.getAttribute("data-icon"),r=void 0!==n.innerText?n.innerText.trim():"",s=jS(cV(n));return s.prefix||(s.prefix=n8()),t&&e&&(s.prefix=t,s.iconName=e),s.iconName&&s.prefix||(s.prefix&&r.length>0&&(s.iconName=function eze(n,t){return(Hne[n]||{})[t]}(s.prefix,n.innerText)||gV(s.prefix,hV(n.innerText))),!s.iconName&&kt.autoFetchSvg&&n.firstChild&&n.firstChild.nodeType===Node.TEXT_NODE&&(s.iconName=n.firstChild.data)),s}function Pze(n){var t=Ph(n.attributes).reduce(function(s,i){return"class"!==s.name&&"style"!==s.name&&(s[i.name]=i.value),s},{}),e=n.getAttribute("title"),r=n.getAttribute("data-fa-title-id");return kt.autoA11y&&(e?t["aria-labelledby"]="".concat(kt.replacementClass,"-title-").concat(r||Im()):(t["aria-hidden"]="true",t.focusable="false")),t}function r1e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},e=Sze(n),r=e.iconName,s=e.prefix,i=e.rest,o=Pze(n),c=_V("parseNodeAttributes",{},n),u=t.styleParser?Mze(n):[];return St({iconName:r,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:s,transform:z4,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:i,styles:u,attributes:o}},c)}var wze=k3.styles;function s1e(n){var t="nest"===kt.autoReplaceSvg?r1e(n,{styleParser:!1}):r1e(n);return~t.extra.classes.indexOf(Ane)?f6("generateLayersText",n,t):f6("generateSvgReplacementMutation",n,t)}var r8=new Set;function i1e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!c6)return Promise.resolve();var e=Or.documentElement.classList,r=function(m){return e.add("".concat(bne,"-").concat(m))},s=function(m){return e.remove("".concat(bne,"-").concat(m))},i=kt.autoFetchSvg?r8:aV.map(function(g){return"fa-".concat(g)}).concat(Object.keys(wze));i.includes("fa")||i.push("fa");var o=[".".concat(Ane,":not([").concat(b5,"])")].concat(i.map(function(g){return".".concat(g,":not([").concat(b5,"])")})).join(", ");if(0===o.length)return Promise.resolve();var c=[];try{c=Ph(n.querySelectorAll(o))}catch{}if(!(c.length>0))return Promise.resolve();r("pending"),s("complete");var u=PV_begin("onTree"),h=c.reduce(function(g,m){try{var E=s1e(m);E&&g.push(E)}catch(b){One||"MissingIcon"===b.name&&console.error(b)}return g},[]);return new Promise(function(g,m){Promise.all(h).then(function(E){e1e(E,function(){r("active"),r("complete"),s("pending"),"function"==typeof t&&t(),u(),g()})}).catch(function(E){u(),m(E)})})}function bze(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;s1e(n).then(function(e){e&&e1e([e],t)})}function Oze(n){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:vV(t||{}),s=e.mask;return s&&(s=(s||{}).icon?s:vV(s||{})),n(r,St(St({},e),{},{mask:s}))}}aV.map(function(n){r8.add("fa-".concat(n))}),Object.keys(Tm[Ar]).map(r8.add.bind(r8)),Object.keys(Tm[ps]).map(r8.add.bind(r8)),r8=Sm(r8);var Aze=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.transform,s=void 0===r?z4:r,i=e.symbol,o=void 0!==i&&i,c=e.mask,u=void 0===c?null:c,h=e.maskId,g=void 0===h?null:h,m=e.title,E=void 0===m?null:m,b=e.titleId,k=void 0===b?null:b,U=e.classes,j=void 0===U?[]:U,oe=e.attributes,ye=void 0===oe?{}:oe,te=e.styles,ke=void 0===te?{}:te;if(t){var Ge=t.prefix,Xe=t.iconName,Bt=t.icon;return ZS(St({type:"icon"},t),function(){return N5("beforeDOMElementCreation",{iconDefinition:t,params:e}),kt.autoA11y&&(E?ye["aria-labelledby"]="".concat(kt.replacementClass,"-title-").concat(k||Im()):(ye["aria-hidden"]="true",ye.focusable="false")),CV({icons:{main:EV(Bt),mask:u?EV(u.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Ge,iconName:Xe,transform:St(St({},z4),s),symbol:o,title:E,maskId:g,titleId:k,extra:{attributes:ye,styles:ke,classes:j}})})}},Nze={mixout:function(){return{icon:Oze(Aze)}},hooks:function(){return{mutationObserverCallbacks:function(e){return e.treeCallback=i1e,e.nodeCallback=bze,e}}},provides:function(t){t.i2svg=function(e){var r=e.node,i=e.callback;return i1e(void 0===r?Or:r,void 0===i?function(){}:i)},t.generateSvgReplacementMutation=function(e,r){var s=r.iconName,i=r.title,o=r.titleId,c=r.prefix,u=r.transform,h=r.symbol,g=r.mask,m=r.maskId,E=r.extra;return new Promise(function(b,k){Promise.all([MV(s,c),g.iconName?MV(g.iconName,g.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(U){var j=eV(U,2);b([e,CV({icons:{main:j[0],mask:j[1]},prefix:c,iconName:s,transform:u,symbol:h,maskId:m,title:i,titleId:o,extra:E,watchable:!0})])}).catch(k)})},t.generateAbstractIcon=function(e){var h,r=e.children,s=e.attributes,i=e.main,o=e.transform,u=BS(e.styles);return u.length>0&&(s.style=u),lV(o)&&(h=f6("generateAbstractTransformGrouping",{main:i,transform:o,containerWidth:i.width,iconWidth:i.width})),r.push(h||i.icon),{children:r,attributes:s}}}},Ize={mixout:function(){return{layer:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.classes,i=void 0===s?[]:s;return ZS({type:"layer"},function(){N5("beforeDOMElementCreation",{assembler:e,params:r});var o=[];return e(function(c){Array.isArray(c)?c.map(function(u){o=o.concat(u.abstract)}):o=o.concat(c.abstract)}),[{tag:"span",attributes:{class:["".concat(kt.cssPrefix,"-layers")].concat(Sm(i)).join(" ")},children:o}]})}}}},xze={mixout:function(){return{counter:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.title,i=void 0===s?null:s,o=r.classes,c=void 0===o?[]:o,u=r.attributes,h=void 0===u?{}:u,g=r.styles,m=void 0===g?{}:g;return ZS({type:"counter",content:e},function(){return N5("beforeDOMElementCreation",{content:e,params:r}),fze({content:e.toString(),title:i,extra:{attributes:h,styles:m,classes:["".concat(kt.cssPrefix,"-layers-counter")].concat(Sm(c))}})})}}}},kze={mixout:function(){return{text:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.transform,i=void 0===s?z4:s,o=r.title,c=void 0===o?null:o,u=r.classes,h=void 0===u?[]:u,g=r.attributes,m=void 0===g?{}:g,E=r.styles,b=void 0===E?{}:E;return ZS({type:"text",content:e},function(){return N5("beforeDOMElementCreation",{content:e,params:r}),Zne({content:e,transform:St(St({},z4),i),title:c,extra:{attributes:m,styles:b,classes:["".concat(kt.cssPrefix,"-layers-text")].concat(Sm(h))}})})}}},provides:function(t){t.generateLayersText=function(e,r){var s=r.title,i=r.transform,o=r.extra,c=null,u=null;if(Pne){var h=parseInt(getComputedStyle(e).fontSize,10),g=e.getBoundingClientRect();c=g.width/h,u=g.height/h}return kt.autoA11y&&!s&&(o.attributes["aria-hidden"]="true"),Promise.resolve([e,Zne({content:e.innerHTML,width:c,height:u,transform:i,title:s,extra:o,watchable:!0})])}}},Lze=new RegExp('"',"ug"),o1e=[1105920,1112319];function a1e(n,t){var e="".concat("data-fa-pseudo-element-pending").concat(t.replace(":","-"));return new Promise(function(r,s){if(null!==n.getAttribute(e))return r();var o=Ph(n.children).filter(function(Bt){return Bt.getAttribute(sV)===t})[0],c=e8.getComputedStyle(n,t),u=c.getPropertyValue("font-family").match(ODe),h=c.getPropertyValue("font-weight"),g=c.getPropertyValue("content");if(o&&!u)return n.removeChild(o),r();if(u&&"none"!==g&&""!==g){var m=c.getPropertyValue("content"),E=~["Sharp"].indexOf(u[2])?ps:Ar,b=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(u[2])?wm[E][u[2].toLowerCase()]:ADe[E][h],k=function Rze(n){var t=n.replace(Lze,""),e=function ZDe(n,t){var s,e=n.length,r=n.charCodeAt(t);return r>=55296&&r<=56319&&e>t+1&&(s=n.charCodeAt(t+1))>=56320&&s<=57343?1024*(r-55296)+s-56320+65536:r}(t,0),r=e>=o1e[0]&&e<=o1e[1],s=2===t.length&&t[0]===t[1];return{value:hV(s?t[0]:t),isSecondary:r||s}}(m),U=k.value,j=k.isSecondary,oe=u[0].startsWith("FontAwesome"),ye=gV(b,U),te=ye;if(oe){var ke=function tze(n){var t=Bne[n],e=gV("fas",n);return t||(e?{prefix:"fas",iconName:e}:null)||{prefix:null,iconName:null}}(U);ke.iconName&&ke.prefix&&(ye=ke.iconName,b=ke.prefix)}if(!ye||j||o&&o.getAttribute(iV)===b&&o.getAttribute(oV)===te)r();else{n.setAttribute(e,te),o&&n.removeChild(o);var Ge=function Tze(){return{iconName:null,title:null,titleId:null,prefix:null,transform:z4,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),Xe=Ge.extra;Xe.attributes[sV]=t,MV(ye,b).then(function(Bt){var V1=CV(St(St({},Ge),{},{icons:{main:Bt,mask:{prefix:null,iconName:null,rest:[]}},prefix:b,iconName:te,extra:Xe,watchable:!0})),N1=Or.createElement("svg");"::before"===t?n.insertBefore(N1,n.firstChild):n.appendChild(N1),N1.outerHTML=V1.map(function(bn){return xm(bn)}).join("\n"),n.removeAttribute(e),r()}).catch(s)}}else r()})}function Dze(n){return Promise.all([a1e(n,"::before"),a1e(n,"::after")])}function zze(n){return!(n.parentNode===document.head||~TDe.indexOf(n.tagName.toUpperCase())||n.getAttribute(sV)||n.parentNode&&"svg"===n.parentNode.tagName)}function c1e(n){if(c6)return new Promise(function(t,e){var r=Ph(n.querySelectorAll("*")).filter(zze).map(Dze),s=PV_begin("searchPseudoElements");t1e(),Promise.all(r).then(function(){s(),wV(),t()}).catch(function(){s(),wV(),e()})})}var l1e=!1,u1e=function(t){return t.toLowerCase().split(" ").reduce(function(r,s){var i=s.toLowerCase().split("-"),o=i[0],c=i.slice(1).join("-");if(o&&"h"===c)return r.flipX=!0,r;if(o&&"v"===c)return r.flipY=!0,r;if(c=parseFloat(c),isNaN(c))return r;switch(o){case"grow":r.size=r.size+c;break;case"shrink":r.size=r.size-c;break;case"left":r.x=r.x-c;break;case"right":r.x=r.x+c;break;case"up":r.y=r.y-c;break;case"down":r.y=r.y+c;break;case"rotate":r.rotate=r.rotate+c}return r},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},bV={x:0,y:0,width:"100%",height:"100%"};function f1e(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n.attributes&&(n.attributes.fill||t)&&(n.attributes.fill="black"),n}function Bze(n){return"g"===n.tag?n.children:[n]}var $ze={hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-mask"),i=s?jS(s.split(" ").map(function(o){return o.trim()})):{prefix:null,iconName:null,rest:[]};return i.prefix||(i.prefix=n8()),e.mask=i,e.maskId=r.getAttribute("data-fa-mask-id"),e}}},provides:function(t){t.generateAbstractMask=function(e){var r=e.children,s=e.attributes,i=e.main,o=e.mask,c=e.maskId,g=i.icon,E=o.icon,b=function FDe(n){var t=n.transform,r=n.iconWidth,s={transform:"translate(".concat(n.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),o="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),c="rotate(".concat(t.rotate," 0 0)");return{outer:s,inner:{transform:"".concat(i," ").concat(o," ").concat(c)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}({transform:e.transform,containerWidth:o.width,iconWidth:i.width}),k={tag:"rect",attributes:St(St({},bV),{},{fill:"white"})},U=g.children?{children:g.children.map(f1e)}:{},j={tag:"g",attributes:St({},b.inner),children:[f1e(St({tag:g.tag,attributes:St(St({},g.attributes),b.path)},U))]},oe={tag:"g",attributes:St({},b.outer),children:[j]},ye="mask-".concat(c||Im()),te="clip-".concat(c||Im()),ke={tag:"mask",attributes:St(St({},bV),{},{id:ye,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[k,oe]},Ge={tag:"defs",children:[{tag:"clipPath",attributes:{id:te},children:Bze(E)},ke]};return r.push(Ge,{tag:"rect",attributes:St({fill:"currentColor","clip-path":"url(#".concat(te,")"),mask:"url(#".concat(ye,")")},bV)}),{children:r,attributes:s}}}};!function sze(n,t){var e=t.mixoutsTo;Wne=n,wh={},Object.keys(bh).forEach(function(r){-1===rze.indexOf(r)&&delete bh[r]}),Wne.forEach(function(r){var s=r.mixout?r.mixout():{};if(Object.keys(s).forEach(function(o){"function"==typeof s[o]&&(e[o]=s[o]),"object"===kS(s[o])&&Object.keys(s[o]).forEach(function(c){e[o]||(e[o]={}),e[o][c]=s[o][c]})}),r.hooks){var i=r.hooks();Object.keys(i).forEach(function(o){wh[o]||(wh[o]=[]),wh[o].push(i[o])})}r.provides&&r.provides(bh)})}([UDe,Nze,Ize,xze,kze,{hooks:function(){return{mutationObserverCallbacks:function(e){return e.pseudoElementsCallback=c1e,e}}},provides:function(t){t.pseudoElements2svg=function(e){var r=e.node;kt.searchPseudoElements&&c1e(void 0===r?Or:r)}}},{mixout:function(){return{dom:{unwatch:function(){t1e(),l1e=!0}}}},hooks:function(){return{bootstrap:function(){n1e(_V("mutationObserverCallbacks",{}))},noAuto:function(){!function Eze(){!XS||XS.disconnect()}()},watch:function(e){var r=e.observeMutationsRoot;l1e?wV():n1e(_V("mutationObserverCallbacks",{observeMutationsRoot:r}))}}}},{mixout:function(){return{parse:{transform:function(e){return u1e(e)}}}},hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-transform");return s&&(e.transform=u1e(s)),e}}},provides:function(t){t.generateAbstractTransformGrouping=function(e){var r=e.main,s=e.transform,o=e.iconWidth,c={transform:"translate(".concat(e.containerWidth/2," 256)")},u="translate(".concat(32*s.x,", ").concat(32*s.y,") "),h="scale(".concat(s.size/16*(s.flipX?-1:1),", ").concat(s.size/16*(s.flipY?-1:1),") "),g="rotate(".concat(s.rotate," 0 0)"),b={outer:c,inner:{transform:"".concat(u," ").concat(h," ").concat(g)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:St({},b.outer),children:[{tag:"g",attributes:St({},b.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:St(St({},r.icon.attributes),b.path)}]}]}}}},$ze,{provides:function(t){var e=!1;e8.matchMedia&&(e=e8.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){var r=[],s={fill:"currentColor"},i={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};r.push({tag:"path",attributes:St(St({},s),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=St(St({},i),{},{attributeName:"opacity"}),c={tag:"circle",attributes:St(St({},s),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||c.children.push({tag:"animate",attributes:St(St({},i),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:St(St({},o),{},{values:"1;0;1;1;0;1;"})}),r.push(c),r.push({tag:"path",attributes:St(St({},s),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:St(St({},o),{},{values:"1;0;0;0;0;1;"})}]}),e||r.push({tag:"path",attributes:St(St({},s),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:St(St({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:r}}}},{hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-symbol");return e.symbol=null!==s&&(""===s||s),e}}}}],{mixoutsTo:ec});var Wze=ec.parse,jze=ec.icon;const Zze=["*"],Xze=n=>{const t={"fa-spin":n.spin,"fa-pulse":n.pulse,"fa-fw":n.fixedWidth,"fa-border":n.border,"fa-inverse":n.inverse,"fa-layers-counter":n.counter,"fa-flip-horizontal":"horizontal"===n.flip||"both"===n.flip,"fa-flip-vertical":"vertical"===n.flip||"both"===n.flip,[`fa-${n.size}`]:null!==n.size,[`fa-rotate-${n.rotate}`]:null!==n.rotate,[`fa-pull-${n.pull}`]:null!==n.pull,[`fa-stack-${n.stackItemSize}`]:null!=n.stackItemSize};return Object.keys(t).map(e=>t[e]?e:null).filter(e=>e)};let eVe=(()=>{class n{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),tVe=(()=>{class n{constructor(){this.definitions={}}addIcons(...e){for(const r of e){r.prefix in this.definitions||(this.definitions[r.prefix]={}),this.definitions[r.prefix][r.iconName]=r;for(const s of r.icon[2])"string"==typeof s&&(this.definitions[r.prefix][s]=r)}}addIconPacks(...e){for(const r of e){const s=Object.keys(r).map(i=>r[i]);this.addIcons(...s)}}getIconDefinition(e,r){return e in this.definitions&&r in this.definitions[e]?this.definitions[e][r]:null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),nVe=(()=>{class n{constructor(){this.stackItemSize="1x"}ngOnChanges(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=qt({type:n,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[u2]}),n})(),rVe=(()=>{class n{constructor(e,r){this.renderer=e,this.elementRef=r}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${e.size.currentValue}`),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${e.size.previousValue}`))}}return n.\u0275fac=function(e){return new(e||n)(Q(To),Q(v2))},n.\u0275cmp=ut({type:n,selectors:[["fa-stack"]],inputs:{size:"size"},features:[u2],ngContentSelectors:Zze,decls:1,vars:0,template:function(e,r){1&e&&(function kB(n){const t=De()[16][6];if(!t.projection){const r=t.projection=yl(n?n.length:1,null),s=r.slice();let i=t.child;for(;null!==i;){const o=n?N4e(i,n):0;null!==o&&(s[o]?s[o].projectionNext=i:r[o]=i,s[o]=i),i=i.next}}}(),function LB(n,t=0,e){const r=De(),s=Qn(),i=m0(s,22+n,16,null,e||null);null===i.projection&&(i.projection=t),Sd(),64!=(64&i.flags)&&function nb(n,t,e){oC(t[11],0,t,e,Qv(n,e,t),nC(e.parent||t[6],e,t))}(s,r,i)}(0))},encapsulation:2}),n})(),I5=(()=>{class n{constructor(e,r,s,i,o){this.sanitizer=e,this.config=r,this.iconLibrary=s,this.stackItem=i,this.classes=[],null!=o&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(e){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let r=null;if(r=this.icon??this.config.fallbackIcon,e){const s=this.findIconDefinition(r);if(null!=s){const i=this.buildParams();this.renderIcon(s,i)}}}render(){this.ngOnChanges({})}findIconDefinition(e){const r=((n,t)=>(n=>void 0!==n.prefix&&void 0!==n.iconName)(n)?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:t,iconName:n}:void 0)(e,this.config.defaultPrefix);return"icon"in r?r:this.iconLibrary.getIconDefinition(r.prefix,r.iconName)??((n=>{throw new Error(`Could not find icon with iconName=${n.iconName} and prefix=${n.prefix} in the icon library.`)})(r),null)}buildParams(){const e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},r="string"==typeof this.transform?Wze.transform(this.transform):this.transform;return{title:this.title,transform:r,classes:[...Xze(e),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(e,r){const s=jze(e,r);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return n.\u0275fac=function(e){return new(e||n)(Q(tq),Q(eVe),Q(tVe),Q(nVe,8),Q(rVe,8))},n.\u0275cmp=ut({type:n,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,r){2&e&&(nO("innerHTML",r.renderedIconHTML,ou),D("title",r.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[u2],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),sVe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n}),n.\u0275inj=Zr({}),n})();var IV={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},pre={prefix:"fas",iconName:"flag",icon:[448,512,[127988,61725],"f024","M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"]},Yre={prefix:"fas",iconName:"repeat",icon:[512,512,[128257],"f363","M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"]},WV={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"]},toe={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336c44.2 0 80-35.8 80-80s-35.8-80-80-80s-80 35.8-80 80s35.8 80 80 80z"]},eH={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"]},foe={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},Iae={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"]},mH={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},dce={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C87.5 32 35.1 48.6 9 59.9c-5.6 2.4-9 8-9 14V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V73.9c0-6.1-3.4-11.6-9-14C540.9 48.6 488.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class Bce{static toComparableObjectSet(t){const e=[];return t.forEach(r=>{e.some(s=>s.equals(r))||e.push(r)}),e}static toComparableSet(t){const e=[];return t.forEach(r=>{e.some(s=>Xa(s,r))||e.push(r)}),e}}class bt{constructor(t){this.values=void 0===t?[]:Bce.toComparableSet(t)}equals(t){if(t.size()!==this.size())return!1;for(const e of this)if(!1===t.contains(e))return!1;return!0}toString(){let t="";for(const e of this)t+=null==e?"null, ":e.toString()+", ";return"["+t.slice(0,-2)+"]"}add(t){return!this.contains(t)&&(this.values.push(t),!0)}remove(t){for(let e=0;e<this.values.length;e++)if(Xa(this.values[e],t))return this.values.splice(e,1),!0;return!1}addAll(t){for(const e of t)this.add(e)}union(t){const e=new bt(this.toList());return e.addAll(t),e}contains(t){for(const e of this.values)if(Xa(e,t))return!0;return!1}size(){return this.values.length}toList(){const t=[];for(const e of this)t.push(e);return t}getAnyElement(){return this.size()>0?y.of(this.values[0]):y.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(t){const e=[];for(const r of this.values)e.push(t(r));return new bt(e)}flatMap(t){const e=new bt;for(const r of this)e.addAll(t(r));return e}filter(t){const e=new bt;for(const r of this)t(r)&&e.add(r);return e}findAnyCommonElement(t){for(const e of t)if(this.contains(e))return y.of(e);return y.empty()}intersection(t){const e=new bt;for(const r of t)this.contains(r)&&e.add(r);return e}[Symbol.iterator](){return this.values.values()}}class Wn{constructor(t=[],e=!1){this.map=t,this.isImmutable=e}static from(t){const e=Object.keys(t),r=new Wn;for(const s of e)r.set(s,t[s]);return r}makeImmutable(){this.isImmutable=!0}get(t){for(const e of this.map)if(Xa(e.key,t))return y.of(e.value);return y.empty()}getAnyPair(){return this.size()>0?y.of(this.map[0]):y.empty()}forEach(t){for(const e of this.map)t(e)}putAll(t){this.checkImmutability("putAll");for(const e of t.map)this.put(e.key,e.value)}checkImmutability(t){if(this.isImmutable)throw new Error("Cannot call "+t+" on immutable map!")}put(t,e){this.checkImmutability("put");for(const r of this.map)if(Xa(r.key,t)){const s=r.value;return r.value=e,y.of(s)}return this.map.push({key:t,value:e}),y.empty()}containsKey(t){return this.map.some(e=>Xa(e.key,t))}size(){return this.map.length}listKeys(){return this.map.map(t=>t.key)}getKeySet(){return new bt(this.listKeys())}filter(t){const e=new Wn;for(const r of this.map)t(r.key,r.value)&&e.set(r.key,r.value);return e}replace(t,e){if(this.checkImmutability("replace"),this.get(t).isAbsent())throw new Error("No Value to replace for key "+t.toString()+"!");return this.put(t,e),e}set(t,e){if(this.checkImmutability("set"),this.containsKey(t))throw new Error("Key "+t.toString()+" already exist in Map!");this.map.push({key:t,value:e})}delete(t){this.checkImmutability("delete");for(let e=0;e<this.map.length;e++)if(Xa(this.map[e].key,t)){const s=this.map[e].value,i=this.map.slice(0,e),o=this.map.slice(e+1);return this.map=i.concat(o),s}throw new Error('No Value to delete for key "'+t.toString()+'"!')}getCopy(){const t=new this.constructor;for(const e of this.listKeys())t.set(e,this.get(e).get());return t}equals(t){const e=this.getKeySet(),r=t.getKeySet();if(!1===e.equals(r))return!1;for(const s of e){const i=this.get(s).get(),o=t.get(s);if(Le(o.isPresent(),"value is absent in a map even though its key is present!"),!1===Xa(i,o.get()))return!1}return!0}}class Hm extends Wn{reverse(){const t=new Hm;for(const e of this.listKeys()){const r=this.get(e).get();if(t.containsKey(r))t.get(r).get().add(e);else{const s=new bt;s.add(e),t.set(r,s)}}return t}}class L2{constructor(t,e){this.userDAO=t,this.connectedUserService=e,this.userSubscription=new H1,this.observedPartLoading=!0,this.observedPart=y.empty(),this.observedPartRS=new Ite(1),this.observedPartObs=this.observedPartRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(r=>{this.onUserUpdate(r)})}onUserUpdate(t){t===w5.NOT_CONNECTED?(this.authSubscription.unsubscribe(),this.observedPartRS.next(y.empty())):this.userSubscription=this.userDAO.subscribeToChanges(t.id,e=>{Le(e.isPresent(),"When observing part service, user was expected to already have a document!");const r=e.get();this.updateObservedPartWithDoc(r.observedPart)})}updateObservedPartWithDoc(t){const e=this.observedPart,r=null==t&&e.isAbsent(),s=null!=t&&e.equalsValue(t);(!1===r&&!1===s||this.observedPartLoading)&&(this.observedPartLoading=!1,this.observedPart=y.ofNullable(t),this.observedPartRS.next(this.observedPart))}updateObservedPart(t){if(Le(this.connectedUserService.user.isPresent(),"Should not call updateObservedPart when not connected"),this.observedPart.isPresent()){const r={...this.observedPart.get(),...t};return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:r})}{const r=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const s of r)Le(null!=t[s],"field "+s+" should be set before updating observedPart");return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:t})}}removeObservedPart(){return Le(this.connectedUserService.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:null})}subscribeToObservedPart(t){return this.observedPartObs.subscribe(t)}canUserCreate(){if(this.observedPart.isAbsent())return z.SUCCESS;{const t=L2.roleToMessage.get(this.observedPart.get().role).get()();return z.failure(t)}}canUserJoin(t,e){if(this.observedPart.isAbsent()||this.observedPart.get().id===t)return z.SUCCESS;if(e&&"Observer"===this.observedPart.get().role)return z.SUCCESS;{const r=L2.roleToMessage.get(this.observedPart.get().role).get()();return z.failure(r)}}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function T3t(n,t){if(1&n&&(hn(0),ve(1,31),dn()),2&n){const e=C(2);T(1),y1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),A1(1)}}function w3t(n,t){if(1&n&&(hn(0),ve(1,33),dn()),2&n){const e=C(3);T(1),y1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),A1(1)}}function b3t(n,t){if(1&n&&(hn(0),ve(1,34),dn()),2&n){const e=C(3);T(1),y1(e.observedPart.get().typeGame),A1(1)}}function O3t(n,t){if(1&n&&(x(0,w3t,2,2,"ng-container",27),x(1,b3t,2,1,"ng-template",null,32,Gn)),2&n){const e=Fn(2);w("ngIf",C(2).observedPart.get().opponent)("ngIfElse",e)}}function A3t(n,t){if(1&n){const e=Ae();O(0,"a",29),ee("click",function(){return he(e),le(C().navigateToPart())}),x(1,T3t,2,2,"ng-container",27),x(2,O3t,3,2,"ng-template",null,30,Gn),A()}if(2&n){const e=Fn(3),r=C();T(1),w("ngIf","Observer"===r.observedPart.get().role||"Candidate"===r.observedPart.get().role)("ngIfElse",e)}}function N3t(n,t){if(1&n&&(hn(0),X(1,"fa-icon",35),dn()),2&n){const e=C();T(1),w("icon",e.faSpinner)}}function I3t(n,t){if(1&n){const e=Ae();hn(0),O(1,"div",10)(2,"a",37),Tt(3),A(),O(4,"div",13)(5,"a",38),ve(6,39),A(),O(7,"a",40),ee("click",function(){return he(e),le(C(2).logout())}),ve(8,41),A()()(),dn()}if(2&n){const e=C(2);T(3),a1(e.username.get())}}L2.roleToMessage=new Wn([{key:"Candidate",value:ym.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:ym.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:ym.YOU_ARE_ALREADY_CREATING},{key:"Player",value:ym.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:ym.YOU_ARE_ALREADY_OBSERVING}]),L2.\u0275fac=function(t){return new(t||L2)(Ve(Zz),Ve(Ns))},L2.\u0275prov=et({token:L2,factory:L2.\u0275fac,providedIn:"root"});const x3t=function(){return["/register"]},k3t=function(){return["/login"]};function L3t(n,t){1&n&&(O(0,"div",42)(1,"a",43)(2,"strong"),ve(3,44),A()(),O(4,"a",45),ve(5,46),A()()),2&n&&(T(1),w("routerLink",J1(2,x3t)),T(3),w("routerLink",J1(3,k3t)))}function R3t(n,t){if(1&n&&(x(0,I3t,9,1,"ng-container",27),x(1,L3t,6,4,"ng-template",null,36,Gn)),2&n){const e=Fn(2);w("ngIf",C().username.isPresent())("ngIfElse",e)}}const $ce=function(){return["/"]},D3t=function(){return["/play"]},z3t=function(){return["/lobby"]},V3t=function(){return["/local"]},H3t=function(){return["/tutorial"]},F3t=function(){return["/settings"]};let B3t=(()=>{class n{constructor(e,r,s,i){this.router=e,this.connectedUserService=r,this.observedPartService=s,this.userService=i,this.loading=!0,this.username=y.empty(),this.faCog=toe,this.faSpinner=Iae,this.showMenu=!1,this.observedPart=y.empty()}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(e=>{this.loading=!1,this.username=e.username.isPresent()?e.username:e.email}),this.observedPartSubscription=this.observedPartService.subscribeToObservedPart(e=>{this.observedPart=e})}logout(){var e=this;return I(function*(){yield e.connectedUserService.disconnect(),yield e.router.navigate(["/"])})()}navigateToPart(){var e=this;return I(function*(){return e.router.navigate(["/play",e.observedPart.get().typeGame,e.observedPart.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.observedPartSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(Kn),Q(Ns),Q(L2),Q(Cm))},n.\u0275cmp=ut({type:n,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E,b,k,U;return t=$localize`Home`,e=$localize`Play online`,r=$localize`Create a game`,s=$localize`Join a game`,i=$localize`Play offline`,o=$localize`Create a game`,c=$localize`Learn the rules`,u=$localize`Settings`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,g=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,E=$localize`Account`,b=$localize`Log out`,k=$localize`Register`,U=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],e,[1,"navbar-dropdown"],r,s,["id","playOffline",1,"navbar-link"],i,["id","playLocally",1,"navbar-item",3,"routerLink"],o,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","observedPartLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",u,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","observedPartLink",1,"navbar-item",3,"click"],["activeUser",""],h,["waitingForOpponent",""],g,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","account","routerLink","/account",1,"navbar-item"],E,["id","logout",1,"navbar-item",3,"click"],b,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],k,["id","login",1,"button","is-light",3,"routerLink"],U]},template:function(e,r){if(1&e&&(O(0,"nav",0)(1,"div",1)(2,"a",2),X(3,"img",3),A(),O(4,"a",4),ee("click",function(){return r.showMenu=!r.showMenu}),X(5,"span",5)(6,"span",5)(7,"span",5),A()(),O(8,"div",6),ee("click",function(){return r.showMenu=!r.showMenu}),O(9,"div",7)(10,"a",8),ve(11,9),A(),O(12,"div",10)(13,"a",11),ve(14,12),A(),O(15,"div",13)(16,"a",2),ve(17,14),A(),O(18,"a",2),ve(19,15),A()()(),O(20,"div",10)(21,"a",16),ve(22,17),A(),O(23,"div",13)(24,"a",18),ve(25,19),A(),O(26,"a",20),ve(27,21),A()()()(),O(28,"div",22),x(29,A3t,4,2,"a",23),O(30,"a",24),X(31,"fa-icon",25),A(),O(32,"div",26),x(33,N3t,2,1,"ng-container",27),x(34,R3t,3,2,"ng-template",null,28,Gn),A()()()()),2&e){const s=Fn(35);T(2),w("routerLink",J1(13,$ce)),T(2),w("ngClass",r.showMenu?"is-active":""),T(4),w("ngClass",r.showMenu?"is-active":""),T(2),w("routerLink",J1(14,$ce)),T(6),w("routerLink",J1(15,D3t)),T(2),w("routerLink",J1(16,z3t)),T(6),w("routerLink",J1(17,V3t)),T(2),w("routerLink",J1(18,H3t)),T(3),w("ngIf",r.observedPart.isPresent()),T(1),w("routerLink",J1(19,F3t)),T(1),w("icon",r.faCog),T(2),w("ngIf",r.loading)("ngIfElse",s)}},dependencies:[pn,Xt,Vu,I5],encapsulation:2}),n})(),$3t=(()=>{class n{constructor(e,r){this._themeService=e,this._errorLoggerService=r,this.faTwitter=cne,this.faFacebook=tne,this.faGithub=ane}}return n.\u0275fac=function(e){return new(e||n)(Q(xS),Q(As))},n.\u0275cmp=ut({type:n,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(e,r){1&e&&(X(0,"app-header"),O(1,"main",0),X(2,"router-outlet"),A(),O(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),ha(7,3),X(8,"strong"),da(),A(),Tt(9," \xa0 "),O(10,"a",4),X(11,"fa-icon",5),A(),Tt(12,"\xa0 "),O(13,"a",6),X(14,"fa-icon",5),A(),Tt(15,"\xa0 "),O(16,"a",7),X(17,"fa-icon",5),A()()()()),2&e&&(T(11),w("icon",r.faGithub),T(3),w("icon",r.faTwitter),T(3),w("icon",r.faFacebook))},dependencies:[KA,I5,B3t],encapsulation:2}),n})();class ji{}class gn{constructor(t){this.x=t}static from(t){switch(t){case 0:return gn.ZERO;case 1:return gn.ONE;case 2:return gn.TWO;default:return Le(3===t,"Invalid Apagos Coord "+t),gn.THREE}}equals(t){return this.x===t.x}}gn.encoder=new class extends xt{encodeMove(n){return n.x}decodeMove(n){return Se.assert(null!=n,"Invalid encoded ApagosCoord: "+n),gn.from(n)}},gn.ZERO=new gn(0),gn.ONE=new gn(1),gn.TWO=new gn(2),gn.THREE=new gn(3);let Oh=(()=>{class n{}return n.PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`,n.CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`,n.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`,n.NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`,n.NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`,n})();class cr extends ji{constructor(t,e,r){super(),this.landing=t,this.piece=e,this.starting=r}static drop(t,e){return Se.getNonNullable(cr.ALL_MOVES.find(s=>s.landing.equals(t)&&s.piece.equalsValue(e)&&s.starting.equals(y.empty())))}static transfer(t,e){if(t.x<=e.x)return _e.failure(Oh.PIECE_SHOULD_MOVE_DOWNWARD());const r=Se.getNonNullable(cr.ALL_MOVES.find(s=>s.landing.equals(e)&&s.piece.equals(y.empty())&&s.starting.equals(y.of(t))));return _e.success(r)}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(t){return!1!==this.starting.equals(t.starting)&&!1!==this.landing.equals(t.landing)&&this.piece.equals(t.piece)}}cr.ALL_MOVES=[new cr(gn.ZERO,y.of(B.ZERO),y.empty()),new cr(gn.ONE,y.of(B.ZERO),y.empty()),new cr(gn.TWO,y.of(B.ZERO),y.empty()),new cr(gn.THREE,y.of(B.ZERO),y.empty()),new cr(gn.ZERO,y.of(B.ONE),y.empty()),new cr(gn.ONE,y.of(B.ONE),y.empty()),new cr(gn.TWO,y.of(B.ONE),y.empty()),new cr(gn.THREE,y.of(B.ONE),y.empty()),new cr(gn.TWO,y.empty(),y.of(gn.THREE)),new cr(gn.ONE,y.empty(),y.of(gn.THREE)),new cr(gn.ZERO,y.empty(),y.of(gn.THREE)),new cr(gn.ONE,y.empty(),y.of(gn.TWO)),new cr(gn.ZERO,y.empty(),y.of(gn.TWO)),new cr(gn.ZERO,y.empty(),y.of(gn.ONE))],cr.encoder=xt.tuple([gn.encoder,y.getEncoder(B.encoder),y.getEncoder(gn.encoder)],n=>[n.landing,n.piece,n.starting],n=>new cr(n[0],n[1],n[2]));class pP{constructor(t){this.turn=t}getCurrentPlayer(){return B.fromTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?B.ZERO:B.ONE}}class Qe{static mapBiArray(t,e){const r=[];let s=0;for(;s<t.length;){r[s]=[];let i=0;for(;i<t[s].length;)r[s][i]=e(t[s][i]),i++;s++}return r}static create3DTable(t,e,r,s){const i=[];for(let o=0;o<t;o++)i.push(Qe.createTable(e,r,s));return i}static createTable(t,e,r){const s=[];for(let i=0;i<e;i++)s.push(Qe.createArray(t,r));return s}static createArray(t,e){const r=[];for(let s=0;s<t;s++)r.push(e);return r}static copyBiArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=Qe.copyImmutableArray(t[r]),r++;return e}static copyImmutableArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=t[r],r++;return e}static sortByDescending(t,e){t.sort((r,s)=>{const i=e(r),o=e(s);return i<o?1:i>o?-1:0})}static compareArray(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===Xa(t[r],e[r]))return!1;return!0}static compareTable(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===Qe.compareArray(t[r],e[r]))return!1;return!0}static isPrefix(t,e){return!(t.length>e.length)&&Qe.compareArray(t,e.slice(0,t.length))}static range(t){const e=[];for(let r=0;r<t;r++)e.push(r);return e}static smallerFirst(t,e){return t-e}}class Uce{constructor(){this.content=new Wn}get(t){const e=this.content.get(t.y);return e.isAbsent()?y.empty():e.get().get(t.x)}set(t,e){const r=this.content.get(t.y);let s;r.isPresent()?s=r.get():(s=new Wn,this.content.set(t.y,s)),s.set(t.x,e)}[Symbol.iterator](){const t=[],e=this.content.getKeySet().toList();e.sort(Qe.smallerFirst);for(const r of e){const s=this.content.get(r).get(),i=s.getKeySet().toList();i.sort(Qe.smallerFirst);for(const o of i){const c=s.get(o).get();t.push({x:o,y:r,content:c})}}return t.values()}}class Fm{constructor(t){this.containing=t}static from(t,e,r){if(t+e>r)return _e.failure("invalid starting space");const s=new Wn([{key:B.ZERO,value:t},{key:B.ONE,value:e},{key:pe.NONE,value:r}]);s.makeImmutable();const i=new Fm(s);return _e.success(i)}isFull(){return this.count(B.ZERO)+this.count(B.ONE)>=this.count(pe.NONE)}count(t){return this.containing.get(t).get()}addPiece(t){let e=this.count(B.ZERO),r=this.count(B.ONE);const s=this.count(pe.NONE);return t===B.ZERO?e++:r++,Fm.from(e,r,s).get()}substractPiece(t){let e=this.count(B.ZERO),r=this.count(B.ONE);const s=this.count(pe.NONE);return t===B.ZERO?e--:r--,Fm.from(e,r,s).get()}getDominatingPlayer(){const t=this.count(B.ZERO),e=this.count(B.ONE);return t>e?B.ZERO:e>t?B.ONE:pe.NONE}equals(t){return this.containing.equals(t.containing)}}let s8=(()=>{class n extends pP{constructor(e,r,s){super(e),this.board=r,this.remaining=s,this.remaining.makeImmutable()}static getInitialState(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(e,r,s,i){const o=[];for(let u=0;u<4;u++){const E=Fm.from(r[0][u],r[1][u],r[2][u]).get();o.push(E)}const c=new Wn;return c.set(B.ZERO,s),c.set(B.ONE,i),new n(e,o,c)}getPieceAt(e){return this.board[e.x]}updateAt(e,r){const s=[];for(let o=0;o<4;o++)s.push(e.x===o?r:this.board[o]);const i=this.getRemainingCopy();return new n(this.turn,s,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&Qe.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}return n.PIECES_PER_PLAYER=10,n})();class ie{constructor(t,e,r){this.title=t,this.instruction=e,this.state=r,this.previousMove=y.empty()}static fromMove(t,e,r,s,i,o){return new U3t(t,e,r,s,i,o)}static forClick(t,e,r,s,i,o){return new q3t(t,e,r,s,i,o)}static anyMove(t,e,r,s,i){return new G3t(t,e,r,s,i)}static fromPredicate(t,e,r,s,i,o){return new W3t(t,e,r,s,i,o)}static informational(t,e,r){return new j3t(t,e,r)}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(t){return this.previousMove=y.of(t),this}}class gP extends ie{constructor(t,e,r,s){super(t,e,r),this.successMessage=s}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class U3t extends gP{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedMoves=s,this.failureMessage=o,Le(s.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class G3t extends gP{constructor(t,e,r,s,i){super(t,e,r,i),this.solutionMove=s}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class q3t extends gP{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedClicks=s,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class W3t extends gP{constructor(t,e,r,s,i,o){super(t,e,r,o),this.solutionMove=s,this.predicate=i}getSolution(){return this.solutionMove}isPredicate(){return!0}}class j3t extends ie{isInformation(){return!0}}class U1{}class Gce extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,s8.getInitialState()),ie.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,s8.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),cr.drop(gn.ZERO,B.ZERO),$localize`Congratulations!`),ie.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,s8.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),cr.transfer(gn.TWO,gn.ZERO).get(),(t,e,r)=>t.isDrop()?z.failure($localize`This move is a drop, please do a transfer!`):z.SUCCESS,$localize`Congratulations!`),ie.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,s8.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),cr.drop(gn.TWO,B.ONE),(t,e,r)=>t.isDrop()?t.piece.equalsValue(B.ONE)?z.SUCCESS:z.failure($localize`You actively made your opponent win!`):z.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)]}}class M1{constructor(t){this.value=t}static fromWinner(t){return t.isPlayer()?new M1(t.getVictoryValue()):new M1(0)}static from(t,e){return t*=B.ZERO.getScoreModifier(),e*=B.ONE.getScoreModifier(),new M1(t+e)}toString(){return""+this.value}}class xe{constructor(t,e){this.isEndGame=t,this.winner=e}static getVictory(t){return t===B.ZERO?xe.ZERO_WON:xe.ONE_WON}static getDefeat(t){return t===B.ZERO?xe.ONE_WON:xe.ZERO_WON}toBoardValue(){return this.winner.isPlayer()?new M1(this.winner.getVictoryValue()):new M1(0)}}xe.ZERO_WON=new xe(!0,B.ZERO),xe.ONE_WON=new xe(!0,B.ONE),xe.DRAW=new xe(!0,pe.NONE),xe.ONGOING=new xe(!1,pe.NONE);var Sn=(()=>(function(n){n.VICTORY="VICTORY",n.PRE_VICTORY="PRE_VICTORY",n.DEFAULT="DEFAULT"}(Sn||(Sn={})),Sn))();let mP=(()=>{class n{}return n.createdNodes=0,n.minimaxTime=0,n})();class gr{constructor(t,e=y.empty(),r=y.empty(),s){if(this.gameState=t,this.mother=e,this.move=r,this.minimaxCreator=s,this.childs=y.empty(),this.hopedValue=new Wn,this.ownValue=new Wn,this.possibleMoves=new Wn,this.ownValue=new Wn,null!=s){const i=s.getBoardValue(this);this.ownValue.set(s.name,i),this.hopedValue.set(s.name,i.value)}mP.createdNodes++,J(gr.VERBOSE,"creating "+this.myToString())}static getScoreStatus(t){return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(J(gr.VERBOSE||!1,"VICTORY"),Sn.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(J(gr.VERBOSE||!1,"PRE_VICTORY_MIN"),Sn.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(J(gr.VERBOSE||!1,"PRE_VICTORY_MAX"),Sn.PRE_VICTORY):(J(gr.VERBOSE||!1,"DEFAULT"),Sn.DEFAULT)}findBestMove(t,e,r=!1,s=!0){const i=(new Date).getTime();let o=this.alphaBeta(t,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,e,r,s);for(;o.gameState.turn>this.gameState.turn+1;)o=o.mother.get(),t--;return mP.minimaxTime+=(new Date).getTime()-i,o.move.get()}alphaBeta(t,e,r,s,i,o){if(t<1)return J(gr.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(s.ruler.getGameStatus(this).isEndGame)return J(gr.VERBOSE||!1,"isLeaf-EndGame("+s.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;const u=this.getPossibleMoves(s);Le(u.size()>0,"Minimax "+s.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=y.of([]));const h=this.getBestChilds(u,t,e,r,s,i,o),g=this.getBestChildAmongst(h,i),m=g.hopedValue.get(s.toString()).get();return this.hopedValue.put(s.toString(),m),g}getPossibleMoves(t){const e=this.possibleMoves.get(t.name);if(e.isAbsent()){const r=t.getListMoves(this);return this.possibleMoves.set(t.name,new bt(r)),new bt(r)}return e.get()}getBestChilds(t,e,r,s,i,o,c){let u=[];const h=this.gameState.getCurrentPlayer();let g=h===B.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const m=h===B.ZERO?(E,b)=>E<b:(E,b)=>b<E;for(const E of t){const k=this.getOrCreateChild(E,i).alphaBeta(e-1,r,s,i,o,c),U=k.getHopedValue(i);if(m(U,g)||0===u.length?(g=U,u=[k]):U===g&&u.push(k),c&&m(g,h===B.ZERO?r:s))break;h===B.ZERO?s=Math.min(g,s):r=Math.max(g,r)}return u}getBestChildAmongst(t,e){return e?t[Math.floor(Math.random()*t.length)]:t[0]}getOrCreateChild(t,e){let r=this.getSonByMove(t);if(r.isAbsent()){const s=e.ruler.isLegal(t,this.gameState),i=t.toString();Le(s.isSuccess(),'The minimax "'+e.name+'" has proposed an illegal move ('+i+"), refusal reason: "+s.getReasonOr("")+" this should not happen.");const o=e.ruler.applyLegalMove(t,this.gameState,s.get());r=y.of(new gr(o,y.of(this),y.of(t),e)),this.childs.get().push(r.get())}return r.get()}getSonByMove(t){Le(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const e of this.childs.get())if(e.move.isPresent()&&e.move.equalsValue(t))return y.of(e);return y.empty()}getHopedValue(t){return this.hopedValue.get(t.name).get()}getOwnValue(t){const e=this.ownValue.get(t.name);if(e.isAbsent()){const r=t.getBoardValue(this);return this.ownValue.set(t.name,r),r}return e.get()}myToString(){let t="",e=this;if(e.mother.isAbsent())return"NodeInitial: "+e.gameState.turn;for(;e.mother.isPresent();)t=(e.move.isAbsent()?" ":" > "+e.move.get().toString()+"> ")+e.gameState.turn+" "+t,e=e.mother.get();return"Node: "+t}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let t=this.childs.get().length;for(const e of this.childs.get())t+=e.countDescendants();return t}}gr.VERBOSE=!1,gr.minimaxes=new Wn;class L1{constructor(t){this.stateType=t}choose(t,e){J(!1,"Rules.choose: "+e.toString()+" was proposed");const s=this.isLegal(e,t.gameState);if(t.hasMoves()){J(!1,"Rules.choose: current node has moves");const c=t.getSonByMove(e);if(c.isPresent())return Le(s.isSuccess(),"Rules.choose: Move is illegal: "+s.getReasonOr("")),J(!1,"Rules.choose: and this proposed move is found in the list, so it is legal"),y.of(c.get())}if(J(!1,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),s.isFailure())return J(!1,"Rules.choose: Move is illegal: "+s.getReason()),y.empty();J(!1,"Rules.choose: Move is legal, let's apply it");const i=this.applyLegalMove(e,t.gameState,s.get()),o=new gr(i,y.of(t),y.of(e));return y.of(o)}getInitialNode(){const t=this.stateType.getInitialState();return new gr(t)}applyMoves(t,e,r){let s=0;for(const i of t){const o=r(i),c=this.isLegal(o,e);Le(c.isSuccess(),"Can't create state from invalid moves ("+s+"): "+c.toString()+"."),e=this.applyLegalMove(o,e,c.get()),s++}return e}}class h6 extends L1{constructor(){super(s8)}static get(){return h6.singleton.isAbsent()&&(h6.singleton=y.of(new h6)),h6.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalTransfer(t,e)}applyLegalDrop(t,e){const r=e.getRemainingCopy(),s=r.get(t.piece.get()).get();r.put(t.piece.get(),s-1);const i=new s8(e.turn+1,e.board,r),o=t.piece.get(),c=i.getPieceAt(t.landing).addPiece(o);if(t.landing===gn.THREE)return i.updateAt(t.landing,c);{const u=gn.from(t.landing.x+1),h=i.getPieceAt(u);return i.updateAt(t.landing,h).updateAt(u,c)}}applyLegalTransfer(t,e){const r=e.getCurrentPlayer(),s=t.starting.get(),i=e.getPieceAt(s).substractPiece(r),o=e.getPieceAt(t.landing).addPiece(r);let c=e.updateAt(s,i);return c=c.updateAt(t.landing,o),new s8(c.turn+1,c.board,c.remaining)}isLegal(t,e){return e.getPieceAt(t.landing).isFull()?z.failure(Oh.CANNOT_LAND_ON_A_FULL_SQUARE()):t.isDrop()?this.isLegalDrop(t,e):this.isLegalSlideDown(t,e)}isLegalDrop(t,e){return e.getRemaining(t.piece.get())<=0?z.failure(Oh.NO_PIECE_REMAINING_TO_DROP()):z.SUCCESS}isLegalSlideDown(t,e){const r=e.getCurrentPlayer();return 0===e.getPieceAt(t.starting.get()).count(r)?z.failure(Oh.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):z.SUCCESS}getGameStatus(t){const e=t.gameState;for(let s=0;s<4;s++)if(!1===e.getPieceAt(gn.from(s)).isFull())return xe.ONGOING;const r=e.getPieceAt(gn.THREE).getDominatingPlayer();return Le(r.isPlayer(),"winner can only be a player if the game is finished"),xe.getVictory(r)}}h6.singleton=y.empty();class PH{static gcd(t,e){return 0===e?Math.abs(t):PH.gcd(e,t%e)}}class $t{constructor(t,e){this.x=t,this.y=e}equals(t){return this.x===t.x&&this.y===t.y}isDiagonalOfLength(t){return Math.abs(this.x)===t&&Math.abs(this.y)===t}toMinimalVector(){const t=PH.gcd(this.x,this.y);return new $t(this.x/t,this.y/t)}combine(t,e=1){return new $t(this.x+e*t.x,this.y+e*t.y)}toString(){return"("+this.x+", "+this.y+")"}}class TH extends $t{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class wH{of(t,e){for(const r of this.all)if(r.x===t&&r.y===e)return _e.success(r);return _e.failure("Invalid x and y in direction construction")}fromDelta(t,e){return 0===t&&0===e?_e.failure("Empty delta for direction"):Math.abs(t)===Math.abs(e)||0===t||0===e?this.of(Math.sign(t),Math.sign(e)):_e.failure(K3t.DIRECTION_MUST_BE_LINEAR())}fromMove(t,e){return this.fromDelta(e.x-t.x,e.y-t.y)}fromString(t){switch(t){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return _e.failure(`Invalid direction string ${t}`)}}fromInt(t){switch(t){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return _e.failure(`Invalid int direction: ${t}`)}}}class Oe extends TH{constructor(t,e){super(t,e)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return Oe.factory.of(-this.x,-this.y).get()}}Oe.UP=new Oe(0,-1),Oe.UP_RIGHT=new Oe(1,-1),Oe.RIGHT=new Oe(1,0),Oe.DOWN_RIGHT=new Oe(1,1),Oe.DOWN=new Oe(0,1),Oe.DOWN_LEFT=new Oe(-1,1),Oe.LEFT=new Oe(-1,0),Oe.UP_LEFT=new Oe(-1,-1),Oe.factory=new class extends wH{constructor(){super(...arguments),this.all=[Oe.UP,Oe.UP_RIGHT,Oe.RIGHT,Oe.DOWN_RIGHT,Oe.DOWN,Oe.DOWN_LEFT,Oe.LEFT,Oe.UP_LEFT]}},Oe.DIRECTIONS=Oe.factory.all,Oe.DIAGONALS=[Oe.UP_RIGHT,Oe.DOWN_RIGHT,Oe.DOWN_LEFT,Oe.UP_LEFT],Oe.ORTHOGONALS=[Oe.UP,Oe.RIGHT,Oe.DOWN,Oe.LEFT],Oe.encoder=new class Z3t extends R4{encode(t){return t.toString()}decode(t){return Le("string"==typeof t,"Invalid encoded direction"),Oe.factory.fromString(t).get()}};class $e extends TH{constructor(t,e){super(t,e)}getOpposite(){return $e.factory.of(-this.x,-this.y).get()}rotateClockwise(){return $e.factory.of(-this.y,this.x).get()}}$e.UP=new $e(0,-1),$e.RIGHT=new $e(1,0),$e.DOWN=new $e(0,1),$e.LEFT=new $e(-1,0),$e.factory=new class extends wH{constructor(){super(...arguments),this.all=[$e.UP,$e.RIGHT,$e.DOWN,$e.LEFT]}of(n,t){return 0===n&&-1===t?_e.success($e.UP):1===n&&0===t?_e.success($e.RIGHT):0===n&&1===t?_e.success($e.DOWN):-1===n&&0===t?_e.success($e.LEFT):_e.failure("Invalid orthogonal from x and y")}},$e.ORTHOGONALS=$e.factory.all,$e.encoder=new class Y3t extends R4{encode(t){return t.toString()}decode(t){return Le("string"==typeof t,"Invalid encoded orthogonal"),$e.factory.fromString(t).get()}};let K3t=(()=>{class n{}return n.DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`,n})(),bH=(()=>{class n{}return n.OUT_OF_RANGE=t=>`The coordinate ${t.toString()} is not on the board`,n})();class S extends $t{constructor(t,e){super(t,e)}getNext(t,e){const r=this.combine(t,e);return new S(r.x,r.y)}getPrevious(t,e){return this.getNext(t,-(e=e??1))}getLeft(t){return new S(this.x+t.y,this.y+-t.x)}getRight(t){return new S(this.x+-t.y,this.y+t.x)}isInRange(t,e){return!(this.x<0||this.y<0||this.x>=t||this.y>=e)}isNotInRange(t,e){return this.x<0||this.y<0||this.x>=t||this.y>=e}getDirectionToward(t){return Oe.factory.fromMove(this,t)}getOrthogonalDistance(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}getDistance(t){if(!t.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const e=Math.abs(t.x-this.x),r=Math.abs(t.y-this.y);return Math.max(e,r)}isHexagonallyAlignedWith(t){const e=this.x-t.x,r=this.y-t.y;return e!==r&&(e===-r||e*r==0)}isAlignedWith(t){const e=Math.abs(this.x-t.x),r=Math.abs(this.y-t.y);return e===r||e*r==0}getVectorToward(t){return new $t(t.x-this.x,t.y-this.y)}toVector(){return new $t(this.x,this.y)}getCoordsToward(t){if(t.equals(this))return[];if(!t.isAlignedWith(this))return[];const e=this.getDirectionToward(t).get();let r=this.getNext(e,1);const s=[];for(;!1===r.equals(t);)s.push(r),r=r.getNext(e,1);return s}getUntil(t){const e=[],r=this.getDirectionToward(t).get();let s=this.getNext(r);for(;!1===s.equals(t);)e.push(s),s=s.getNext(r);return e}equals(t){return this===t||t.x===this.x&&t.y===this.y}compareTo(t){return t.y===this.y?t.x===this.x?0:this.x<t.x?-1:1:this.y<t.y?-1:1}toSVGPoint(){return this.x+","+this.y}}S.encoder=new class extends xt{encodeMove(n){return{x:n.x,y:n.y}}decodeMove(n){const t=n;return Le(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new S(t.x,t.y)}};class qce{constructor(){this.ArrayUtils=Qe}getPlayerClass(t){switch(t){case B.ZERO:return"player0-fill";case B.ONE:return"player1-fill";default:return Se.expectToBe(t,pe.NONE),""}}}let i8=(()=>{class n extends qce{constructor(e){super(),this.messageDisplayer=e,this.Player=B,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.canPass=!1,this.scores=y.empty(),this.imagesLocation="assets/images/",this.hasAsymmetricBoard=!1,this.rotation=""}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?z.SUCCESS:(this.messageDisplayer.gameMessage(e),z.failure(e))}cancelMoveAttempt(){}pass(){var e=this;return I(function*(){return As.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.node.gameState.turn}getCurrentPlayer(){return this.node.gameState.getCurrentPlayer()}getState(){return this.node.gameState}getPreviousState(){return this.node.mother.get().gameState}showLastMove(e){}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Ah=(()=>{class n extends i8{getHexaPointsAtXY(e,r){const s=new S(e,r);return this.getHexaPointsAt(s)}getHexaPointsAt(e){return this.hexaLayout.getHexaPointsAt(e)}getCenterAtXY(e,r){const s=new S(e,r);return this.getCenterAt(s)}getCenterAt(e){return this.hexaLayout.getCenterAt(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275cmp=ut({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class Ie{constructor(t){this.value=t}static from(t){switch(t){case Ie.ZERO.value:return Ie.ZERO;case Ie.ONE.value:return Ie.ONE;case Ie.EMPTY.value:return Ie.EMPTY;case Ie.UNREACHABLE.value:return Ie.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}static ofPlayer(t){return t===B.ZERO?Ie.ZERO:(Se.expectToBe(t,B.ONE),Ie.ONE)}equals(t){return this===t}is(t){return this.value===t.value}isPlayer(){return this===Ie.ZERO||this===Ie.ONE}}Ie.ZERO=new Ie(B.ZERO.value),Ie.ONE=new Ie(B.ONE.value),Ie.EMPTY=new Ie(pe.NONE.value),Ie.UNREACHABLE=new Ie(3);class ze extends TH{constructor(t,e){super(t,e)}static getAngle(t){switch(t){case ze.UP:return 0;case ze.UP_RIGHT:return 60;case ze.RIGHT:return 120;case ze.DOWN:return 180;case ze.DOWN_LEFT:return 240;default:return Se.expectToBe(t,ze.LEFT),300}}getOpposite(){return ze.factory.of(-this.x,-this.y).get()}}ze.UP=new ze(0,-1),ze.LEFT=new ze(-1,0),ze.UP_RIGHT=new ze(1,-1),ze.DOWN_LEFT=new ze(-1,1),ze.RIGHT=new ze(1,0),ze.DOWN=new ze(0,1),ze.factory=new class extends wH{constructor(){super(...arguments),this.all=[ze.UP,ze.UP_RIGHT,ze.RIGHT,ze.DOWN,ze.DOWN_LEFT,ze.LEFT]}},ze.encoder=new class X3t extends xt{encodeMove(t){switch(t){case ze.UP:return 0;case ze.UP_RIGHT:return 1;case ze.RIGHT:return 2;case ze.DOWN:return 3;case ze.DOWN_LEFT:return 4;default:return 5}}decodeMove(t){return Le(0<=t&&t<=5,"Invalid encoded number for HexaDirection "+t),ze.factory.all[t]}};class Wce{}class _P extends Wce{constructor(){super(),this.startAngle=.5,this.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],this.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3]}}_P.INSTANCE=new _P;class Is extends Wce{constructor(){super(),this.startAngle=0,this.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],this.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3]}isOnBorder(t,e){return this.isOnTopRightBorder(t,e)||this.isOnRightBorder(t,e)||this.isOnBottomRightBorder(t,e)||this.isOnBottomLeftBorder(t,e)||this.isOnLeftBorder(t,e)||this.isOnTopLeftBorder(t,e)}isOnTopRightBorder(t,e){return 0===e.y}isOnRightBorder(t,e){return e.x===t.width-1}isOnLeftBorder(t,e){return 0===e.x}isOnBottomLeftBorder(t,e){return e.y===t.height-1}isOnTopLeftBorder(t,e){return null!=t.excludedSpaces[e.y]?e.x===t.excludedSpaces[e.y]:e.y===t.excludedSpaces.length&&0===e.x}isOnBottomRightBorder(t,e){return null!=t.excludedSpaces[t.height-1-e.y]?t.width-1-e.x===t.excludedSpaces[t.height-1-e.y]:t.height-1-e.y===t.excludedSpaces.length&&e.x===t.width-1}getAllBorders(t){const e=[];return t.forEachCoord((r,s)=>{this.isOnBorder(t,r)&&e.push(r)}),e}isTopCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnTopRightBorder(t,e)}isTopLeftCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isTopRightCorner(t,e){return this.isOnTopRightBorder(t,e)&&this.isOnRightBorder(t,e)}isBottomCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnBottomRightBorder(t,e)}isBottomLeftCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isBottomRightCorner(t,e){return this.isOnBottomRightBorder(t,e)&&this.isOnRightBorder(t,e)}}Is.INSTANCE=new Is;class Nh{constructor(t,e,r){this.size=t,this.origin=e,this.orientation=r}getCenterAt(t){const e=this.orientation.conversionMatrix;return new S(this.size*(e[0]*t.x+e[1]*t.y)+this.origin.x,this.size*(e[2]*t.x+e[3]*t.y)+this.origin.y)}getCornerOffset(t){const e=2*Math.PI*(this.orientation.startAngle+t)/6;return new S(this.size*Math.cos(e),this.size*Math.sin(e))}getHexaPointsListAt(t){const e=this.getCenterAt(t),r=[];for(let s=0;s<6;s+=1){const i=this.getCornerOffset(s);r.push(new S(e.x+i.x,e.y+i.y))}return r}getHexaPointsAt(t){return this.getHexaPointsListAt(t).map(r=>r.toSVGPoint()).join(" ")}getIsoPoints(t,e){Se.assert(this.orientation===Is.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const r=this.getCenterAt(t),s=this.getCornerOffset(0),i=this.getCornerOffset(1),o=this.getCornerOffset(2),c=this.getCornerOffset(3);return[[new S(r.x+c.x,r.y+c.y),new S(r.x+c.x,r.y+c.y+e),new S(r.x+o.x,r.y+o.y+e),new S(r.x+o.x,r.y+o.y)],[new S(r.x+s.x,r.y+s.y),new S(r.x+s.x,r.y+s.y+e),new S(r.x+i.x,r.y+i.y+e),new S(r.x+o.x,r.y+o.y+e),new S(r.x+o.x,r.y+o.y),new S(r.x+i.x,r.y+i.y)],[new S(r.x+c.x,r.y+c.y),new S(r.x+c.x,r.y+c.y+e),new S(r.x+o.x,r.y+o.y+e),new S(r.x+i.x,r.y+i.y+e),new S(r.x+s.x,r.y+s.y+e),new S(r.x+s.x,r.y+s.y),new S(r.x+i.x,r.y+i.y),new S(r.x+o.x,r.y+o.y)]]}}let tt=(()=>{class n{}return n.CANNOT_CHOOSE_OPPONENT_PIECE=()=>$localize`You cannot pick a piece of the opponent.`,n.MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`,n.MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`,n.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`,n.CANNOT_SELF_CAPTURE=()=>$localize`You cannot capture your own pieces.`,n.MUST_CHOOSE_PLAYER_PIECE=()=>$localize`You must pick one of your pieces.`,n.CANNOT_PASS=()=>$localize`You cannot pass your turn.`,n.MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`,n.MUST_PASS=()=>$localize`You must pass your turn.`,n.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`,n.MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`,n.SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`,n})();class Dc{constructor(t,e){this.ruler=t,this.name=e}toString(){return this.name}}class xs extends Dc{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return M1.fromWinner(e.winner);{const r=this.getMetrics(t);return M1.from(r[0],r[1])}}}class Ur extends pP{constructor(t,e){super(e),this.board=t}getPieceAt(t){if(this.isOnBoard(t))return this.board[t.y][t.x];throw new Error("Accessing coord not on board "+t+".")}tryToGetPieceAt(t){return this.isOnBoard(t)?y.of(this.board[t.y][t.x]):y.empty()}isOnBoard(t){return t.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(t,e){return this.getPieceAt(new S(t,e))}forEachCoord(t){for(const{coord:e,content:r}of this.getCoordsAndContents())t(e,r)}getCoordsAndContents(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new S(r,e);this.isOnBoard(s)&&t.push({coord:s,content:this.getPieceAt(s)})}return t}getCopiedBoard(){return Qe.copyBiArray(this.board)}toMap(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[0].length;r++){const s=new S(r,e);t.push({key:s,value:this.getPieceAt(s)})}return t}[Symbol.iterator](){const t=[];for(const e of this.board)t.push(...e);return t.values()}}class o8 extends Ur{static getInitialState(){const t=Ie.EMPTY,e=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE;return new o8([[e,e,e,e,s,s,s,s,s],[e,e,e,s,s,s,s,s,s],[e,e,t,t,s,s,s,t,t],[e,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,e],[t,t,r,r,r,t,t,e,e],[r,r,r,r,r,r,e,e,e],[r,r,r,r,r,e,e,e,e]],0)}isInBoard(t){return t.isInRange(9,9)&&this.getPieceAt(t)!==Ie.UNREACHABLE}isPiece(t){return this.getPieceAt(t).isPlayer()}getScores(){const t=[14,14];for(let e=0;e<9;e++)for(let r=0;r<9;r++)this.getPieceAtXY(r,e)===Ie.ZERO&&(t[1]=t[1]-1),this.getPieceAtXY(r,e)===Ie.ONE&&(t[0]=t[0]-1);return t}}class Ks extends ji{constructor(t,e){super(),this.coord=new S(t,e)}static getEncoder(t){return xt.tuple([S.encoder],e=>[e.coord],e=>t(e[0]))}static getFallibleEncoder(t){return Ks.getEncoder(e=>t(e).get())}equals(t){return this===t||this.coord.equals(t.coord)}}class Zi extends Ks{constructor(t,e,r){if(super(t.x,t.y),this.dir=e,this.lastPiece=r,t.isNotInRange(9,9))throw new Error("Coord "+t.toString()+" out of range, invalid move!")}static fromSingleCoord(t,e){try{return _e.success(new Zi(t,e,y.empty()))}catch(r){return _e.failure(r.message)}}static fromDoubleCoord(t,e,r){const s=[t,e];Qe.sortByDescending(s,Zi.sortCoord);const i=s[1].getDirectionToward(s[0]).get(),o=ze.factory.fromDelta(i.x,i.y);if(o.isFailure())return _e.failure("Invalid direction");const c=o.get();return s[1].getDistance(s[0])>2?_e.failure("Distance between first coord and last coord is too big"):c.equals(r)?Zi.fromSingleCoord(s[1],r):c.getOpposite().equals(r)?Zi.fromSingleCoord(s[0],r):_e.success(new Zi(s[1],r,y.of(s[0])))}static sortCoord(t){return 9*t.y+t.x}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(t){return t.coord.equals(this.coord)&&t.dir.equals(this.dir)&&t.lastPiece.equals(this.lastPiece)}}Zi.encoder=xt.tuple([S.encoder,ze.encoder,y.getEncoder(S.encoder)],n=>[n.coord,n.dir,n.lastPiece],n=>new Zi(n[0],n[1],n[2]));let a8=(()=>{class n{}return n.CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`,n.NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`,n.CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`,n.MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`,n.TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`,n.LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`,n})();class Vo extends L1{constructor(){super(o8)}static get(){return Vo.singleton.isAbsent()&&(Vo.singleton=y.of(new Vo)),Vo.singleton.get()}static isLegal(t,e){const r=this.getFirstPieceValidity(t,e);return r.isFailure()?r.toOtherFallible():t.isSingleCoord()?Vo.isLegalPush(t,e):Vo.isLegalSideStep(t,e)}static getFirstPieceValidity(t,e){const r=e.getPieceAt(t.coord);return!1===e.isPiece(t.coord)?z.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r===Ie.ofPlayer(e.getCurrentOpponent())?z.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):z.SUCCESS}static isLegalPush(t,e){let r=1,s=t.coord.getNext(t.dir);const i=Ie.ofPlayer(e.getCurrentPlayer()),o=Ie.EMPTY,c=e.getCopiedBoard();for(c[t.coord.y][t.coord.x]=o;r<=3&&e.isOnBoard(s)&&e.getPieceAt(s)===i;)r++,s=s.getNext(t.dir);return r>3?_e.failure(a8.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===e.isInBoard(s)||(c[s.y][s.x]=i,e.getPieceAt(s)===o)?_e.success(c):Vo.isLegalRealPush(s,t,e,r,c)}static isLegalRealPush(t,e,r,s,i){let o=0;const c=Ie.ofPlayer(r.getCurrentOpponent()),u=Ie.ofPlayer(r.getCurrentPlayer());for(;o<s&&r.isOnBoard(t)&&r.getPieceAt(t)===c;)o++,t=t.getNext(e.dir);return o>=s?_e.failure(a8.NOT_ENOUGH_PIECE_TO_PUSH()):t.isInRange(9,9)&&(r.getPieceAt(t)===Ie.EMPTY&&(i[t.y][t.x]=c),r.getPieceAt(t)===u)?_e.failure(a8.CANNOT_PUSH_YOUR_OWN_PIECES()):_e.success(i)}static isLegalSideStep(t,e){let r=t.lastPiece.get();const s=t.coord.getDirectionToward(r).get();r=r.getNext(s);let i=t.coord;const o=Ie.ofPlayer(e.getCurrentPlayer()),c=e.getCopiedBoard();for(;!1===i.equals(r)&&i.isInRange(9,9);){if(e.getPieceAt(i)!==o)return _e.failure(a8.MUST_ONLY_TRANSLATE_YOUR_PIECES());const u=i.getNext(t.dir);if(c[i.y][i.x]=Ie.EMPTY,u.isInRange(9,9)){if(e.isPiece(u))return _e.failure(a8.TRANSLATION_IMPOSSIBLE());e.getPieceAt(u)===Ie.EMPTY&&(c[u.y][u.x]=o)}i=i.getNext(s)}return _e.success(c)}static getGameStatus(t){const e=t.gameState.getScores();return e[0]>5?xe.ZERO_WON:e[1]>5?xe.ONE_WON:xe.ONGOING}applyLegalMove(t,e,r){return new o8(r,e.turn+1)}isLegal(t,e){return Vo.isLegal(t,e)}getGameStatus(t){return Vo.getGameStatus(t)}}Vo.singleton=y.empty();class Q3t extends xs{getListMoves(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<9;i++)for(let o=0;o<9;o++){const c=new S(o,i);if(!1!==r.getPieceAt(c).is(s))for(const u of ze.factory.all){const h=Zi.fromSingleCoord(c,u).get();if(this.isAcceptablePush(h,r)){e.push(h);for(const g of ze.factory.all)for(let m=1;m<=2&&!g.equals(u);m++){const E=c.getNext(g,m);if(!E.isInRange(9,9))break;{const b=Zi.fromDoubleCoord(c,E,u).get();Vo.isLegal(b,r).isSuccess()&&e.push(b)}}}}}return new bt(e).toList()}isAcceptablePush(t,e){const r=e.getScores(),s=Vo.isLegal(t,e);if(s.isSuccess()){const i=e.getCurrentOpponent().value;return!(new o8(s.get(),e.turn+1).getScores()[i]>r[i])}return!1}getMetrics(t){return t.gameState.getScores()}}const xn=Ie.EMPTY,Xs=Ie.UNREACHABLE,zc=Ie.ZERO,Ih=Ie.ONE;class jce extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,o8.getInitialState()),ie.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,o8.getInitialState(),Zi.fromSingleCoord(new S(2,6),ze.UP).get(),$localize`Congratulations!`),ie.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new o8([[Xs,Xs,Xs,Xs,xn,zc,zc,Ih,Ih],[Xs,Xs,Xs,xn,xn,xn,xn,xn,xn],[Xs,Xs,xn,zc,zc,zc,Ih,zc,xn],[Xs,xn,xn,xn,xn,xn,xn,xn,xn],[xn,xn,xn,xn,zc,zc,zc,Ih,Ih],[xn,xn,xn,xn,xn,xn,xn,xn,Xs],[xn,xn,xn,xn,zc,Ih,xn,Xs,Xs],[xn,xn,xn,zc,xn,xn,Xs,Xs,Xs],[xn,xn,zc,xn,xn,Xs,Xs,Xs,Xs]],0),[Zi.fromSingleCoord(new S(4,4),ze.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)]}}function J3t(n,t){if(1&n){const e=Ae();F(),O(0,"circle",6),ee("click",function(){he(e);const s=C(2).index,i=C().index;return le(C().onPieceClick(s,i))}),A()}if(2&n){const e=C(2).index,r=C().index,s=C();Re("id","piece_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),D("cx",s.getCenterAtXY(e,r).x)("cy",s.getCenterAtXY(e,r).y)("r",.5*s.SPACE_SIZE)}}function e4t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"polygon",4),ee("click",function(){he(e);const s=C().index,i=C().index;return le(C().onSpaceClick(s,i))}),A(),x(2,J3t,1,6,"circle",5),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();T(1),Re("id","space_",r,"_",i,""),w("ngClass",o.getSquareClasses(r,i)),D("points",o.getHexaPointsAtXY(r,i)),T(1),w("ngIf",o.isPiece(s))}}function t4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,e4t,3,5,"g",3),A()),2&n){const e=t.$implicit,r=C(2);T(1),w("ngIf",r.isBoard(e))}}function n4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,t4t,2,1,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function r4t(n,t){1&n&&(F(),O(0,"marker",7),X(1,"polygon",8),A()),2&n&&d1("id","arrowhead_",t.$implicit.dir.toString(),"")}function s4t(n,t){if(1&n){const e=Ae();F(),O(0,"g"),X(1,"line",9),O(2,"line",10),ee("click",function(){const i=he(e).$implicit;return le(C().chooseDirection(i.dir))}),A(),O(3,"polygon",11),ee("click",function(){const i=he(e).$implicit;return le(C().chooseDirection(i.dir))}),A()()}if(2&n){const e=t.$implicit;T(1),d1("id","line_start_",e.dir.toString(),""),D("x1",e.startCenter.x)("y1",e.startCenter.y)("x2",e.middle.x)("y2",e.middle.y),T(1),d1("id","line_end_",e.dir.toString(),""),D("x1",e.middle.x)("y1",e.middle.y)("x2",e.landingCenter.x)("y2",e.landingCenter.y),T(1),d1("id","direction_",e.dir.toString(),""),D("transform",e.transformation)}}class i4t{constructor(t,e,r,s,i,o){this.startCenter=t,this.middle=e,this.landingCenter=r,this.landing=s,this.dir=i,this.transformation=o}}let o4t=(()=>{class n extends Ah{constructor(e){super(e),this.moveds=[],this.directions=[],this.selecteds=[],this.rules=Vo.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Q3t(this.rules,"Dummy")],this.encoder=Zi.encoder,this.tutorial=(new jce).tutorial,this.scores=y.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new Nh(this.SPACE_SIZE,new S(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),_P.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=y.of(this.getState().getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(e){e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}showPushingMove(e){const r=this.getPreviousState();let s=e.coord;for(this.moveds=[s],s=s.getNext(e.dir);s.isInRange(9,9)&&r.isPiece(s);)this.moveds.push(s),s=s.getNext(e.dir);s.isInRange(9,9)&&this.moveds.push(s)}showSideStepMove(e){let r=e.lastPiece.get();const s=e.coord.getDirectionToward(r).get();r=r.getNext(s);let i=e.coord;for(;!1===i.equals(r);)this.moveds.push(i),this.moveds.push(i.getNext(e.dir)),i=i.getNext(s)}onPieceClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#piece_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentOpponent();return s.hexaBoard[r][e].is(o)?s.opponentClick(e,r):0===s.selecteds.length?s.firstClick(e,r):1===s.selecteds.length?s.secondClick(e,r):s.thirdClick(e,r)})()}opponentClick(e,r){var s=this;return I(function*(){return(yield s.tryChoosingDirection(e,r)).isSuccess()?z.SUCCESS:s.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(e,r){var s=this;return I(function*(){return s.selecteds=[new S(e,r)],s.showPossibleDirections(),z.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(e){const r=this.getState(),s=Ie.ofPlayer(r.getCurrentPlayer()),i=this.selecteds[0],o=this.selecteds[this.selecteds.length-1];for(const c of ze.factory.all){let h,u=i.getNext(c,1);if(r.isOnBoard(u)&&r.getPieceAt(u)===s){if(e)continue;if(u=o.getNext(c,1),r.isOnBoard(u)&&r.getPieceAt(u)===s)continue}if(h=e?Zi.fromSingleCoord(i,c).get():Zi.fromDoubleCoord(i,o,c).get(),this.rules.isLegal(h,r).isSuccess()){const m=this.getCenterAt(i),E=this.getCenterAt(u),b=this.getMiddleOfArrow(c,u,E),k=E.x+" "+E.y,U=ze.getAngle(c)+150,te=new i4t(m,b,E,u,c,"rotate("+U+" "+k+") translate("+k+")");this.directions.push(te)}}}getMiddleOfArrow(e,r,s){const i=r.getPrevious(e),o=this.getCenterAt(i);return new S(o.x+(s.x-o.x)/2,o.y+(s.y-o.y)/2)}isBoard(e){return e!==Ie.UNREACHABLE}isPiece(e){return e!==Ie.EMPTY}secondClick(e,r){var s=this;return I(function*(){const i=s.selecteds[0],o=new S(e,r);if(o.equals(i))return s.cancelMoveAttempt(),z.SUCCESS;if(!1===o.isHexagonallyAlignedWith(i))return s.cancelMoveAttempt(),s.firstClick(e,r);const c=o.getDistance(i);if(c>2)return s.cancelMove(a8.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const u=i.getDirectionToward(o).get();s.selecteds=[i];for(let h=0;h<c;h++)s.selecteds.push(i.getNext(u,h+1));if(3===s.selecteds.length){const h=s.selecteds[1],g=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[h.y][h.x].is(g))return s.cancelMoveAttempt(),s.firstClick(e,r)}return s.showPossibleDirections(),z.SUCCESS})()}thirdClick(e,r){var s=this;return I(function*(){const i=new S(e,r),o=s.selecteds[0];if(i.equals(o))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return i.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&i.equals(s.selecteds[1])?(s.cancelMoveAttempt(),z.SUCCESS):s.tryExtension(i,o,c)})()}tryExtension(e,r,s){var i=this;return I(function*(){const o=Oe.factory.fromMove(r,e);if(o.isSuccess()){const u=Oe.factory.fromMove(s,e);if(o.equals(u)){const h=r.getDistance(e),g=s.getDistance(e);return 2===Math.max(h,g)?(i.selecteds.push(e),Qe.sortByDescending(i.selecteds,Zi.sortCoord),i.showPossibleDirections(),z.SUCCESS):i.cancelMove(a8.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=i.cancelMove(a8.LINE_AND_COORD_NOT_ALIGNED());return yield i.firstClick(e.x,e.y),c})()}deselectExtremity(e){var r=this;return I(function*(){return r.selecteds=r.selecteds.slice(e?1:0,e?void 0:-1),r.showPossibleDirections(),z.SUCCESS})()}chooseDirection(e){var r=this;return I(function*(){const s=r.canUserPlay("#direction_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):r._chooseDirection(e)})()}_chooseDirection(e){var r=this;return I(function*(){const s=r.getState();let i;const o=r.selecteds[0];return i=1===r.selecteds.length?Zi.fromSingleCoord(o,e).get():Zi.fromDoubleCoord(o,r.selecteds[r.selecteds.length-1],e).get(),r.chooseMove(i,s,r.scores.get())})()}onSpaceClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#space_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.tryChoosingDirection(e,r)})()}tryChoosingDirection(e,r){var s=this;return I(function*(){const i=new S(e,r);for(const o of s.directions)if(o.landing.equals(i))return s._chooseDirection(o.dir);return z.failure("not a direction")})()}getSquareClasses(e,r){const s=new S(e,r),i=[];return this.moveds.some(o=>o.equals(s))&&i.push("moved-fill"),i}getPieceClasses(e,r){const s=new S(e,r),i=B.of(this.hexaBoard[r][e].value),o=[this.getPlayerClass(i)];return this.selecteds.some(c=>c.equals(s))&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-abalone"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,n4t,2,1,"g",1),O(2,"defs"),x(3,r4t,2,1,"marker",2),A(),x(4,s4t,4,12,"g",1),A()),2&e&&(T(1),w("ngForOf",r.hexaBoard),T(2),w("ngForOf",r.directions),T(1),w("ngForOf",r.directions))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class a4t extends xs{getListMoves(t){const e=t.gameState;return cr.ALL_MOVES.filter(function r(s){return h6.get().isLegal(s,e).isSuccess()})}getMetrics(t){const e=t.gameState.board[3].getDominatingPlayer(),r=[0,0];return e.isPlayer()&&(r[e.value]=1),r}}function c4t(n,t){if(1&n&&(F(),X(0,"circle",5)),2&n){const e=t.$implicit,r=C();D("cx",r.getRemainingPieceCx(e))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function l4t(n,t){if(1&n&&(F(),X(0,"circle",6)),2&n){const e=t.$implicit,r=C();D("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(e))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function u4t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",9),ee("click",function(){he(e);const s=C().index,i=C();return le(i.onArrowClick(s,i.PlayerOrNone.ZERO))}),A()}if(2&n){const e=C().index,r=C();d1("id","dropArrow_zero_",e,""),w("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ZERO)),D("points",r.ARROW_COORD)("transform","translate("+r.SPACE_SIZE/2+" "+-r.SPACE_SIZE/2+")")}}function f4t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",9),ee("click",function(){he(e);const s=C().index,i=C();return le(i.onArrowClick(s,i.PlayerOrNone.ONE))}),A()}if(2&n){const e=C().index,r=C();d1("id","dropArrow_one_",e,""),w("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ONE)),D("points",r.ARROW_COORD)("transform","translate(0 "+-r.SPACE_SIZE/2+")")}}function h4t(n,t){if(1&n){const e=Ae();F(),hn(0),O(1,"circle",10),ee("click",function(){he(e);const s=C().index;return le(C().onSquareClick(s))}),A(),dn()}if(2&n){const e=t.$implicit,r=C(),s=r.index,i=r.$implicit,o=C();T(1),Q2("id","square_",s,"_piece_",e,"_out_of_",i.count(o.PlayerOrNone.NONE),""),w("ngClass",o.getPieceClasses(s,e,i)),D("cx",o.getCircleCenter(s,e,i).x)("cy",o.getCircleCenter(s,e,i).y)}}function d4t(n,t){if(1&n){const e=Ae();F(),O(0,"g"),x(1,u4t,1,4,"polygon",7),x(2,f4t,1,4,"polygon",7),O(3,"rect",8),ee("click",function(){const i=he(e).index;return le(C().onSquareClick(i))}),A(),x(4,h4t,2,6,"ng-container",4),A()}if(2&n){const e=t.$implicit,r=t.index,s=C();D("transform",s.getBlockTransform(r)),T(1),w("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ZERO)),T(1),w("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ONE)),T(1),d1("id","square_",r,""),w("ngClass",s.getSquareClasses(r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngForOf",s.ArrayUtils.range(e.count(s.PlayerOrNone.NONE)))}}let p4t=(()=>{class n extends i8{constructor(e){super(e),this.PlayerOrNone=pe,this.BOARD_WIDTH=4*this.SPACE_SIZE,this.BOARD_HEIGHT=4.5*this.SPACE_SIZE,this.ARROW_COORD=n.getArrowCoord(),this.PIECES_PER_PLAYER=s8.PIECES_PER_PLAYER,this.selectedPiece=y.empty(),this.leftPiece=y.empty(),this.droppedPiece=y.empty(),this.displayableArrow=[],this.rules=h6.get(),this.node=this.rules.getInitialNode(),this.hasAsymmetricBoard=!0,this.availableMinimaxes=[new a4t(this.rules,"ApagosDummyMinimax")],this.encoder=cr.encoder,this.tutorial=(new Gce).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5),this.updateBoard()}static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}cancelMoveAttempt(){this.selectedPiece=y.empty(),this.showPossibleDrops()}updateBoard(){const e=this.getState();this.board=e.board,this.remainingZero=e.remaining.get(B.ZERO).get(),this.remainingOne=e.remaining.get(B.ONE).get(),this.hideLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=y.empty(),this.leftPiece=y.empty(),this.selectedPiece=y.empty()}showLastMove(e){e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}showLastDrop(e){const r=e.piece.get();let s=e.landing.x;this.movedSquare=[s],3!==e.landing.x&&(s+=1,this.movedSquare.push(s));const o=this.getLowestPlayerPiece(this.board[s],r);this.droppedPiece=y.of({square:s,piece:o})}getLowestPlayerPiece(e,r){const s=e.count(r);return r===B.ZERO?s-1:e.count(pe.NONE)-s}showLastTransfer(e){const r=this.getPreviousState(),s=r.getCurrentPlayer(),i=e.starting.get().x,c=this.getLowestPlayerPiece(r.board[i],s);this.leftPiece=y.of({square:i,piece:c});const u=e.landing.x,g=this.getLowestPlayerPiece(this.board[u],s);this.droppedPiece=y.of({square:u,piece:g})}showPossibleDrops(){this.displayableArrow=[];const e=this.getState();for(let r=0;r<4;r++)!1===e.board[r].isFull()&&(e.remaining.get(B.ZERO).get()>0&&this.displayableArrow.push({x:r,player:B.ZERO}),e.remaining.get(B.ONE).get()>0&&this.displayableArrow.push({x:r,player:B.ONE}))}getCircleCenter(e,r,s){const i=this.SPACE_SIZE/2,o=this.SPACE_SIZE/2;if(1===s.count(pe.NONE))return new S(i,o);const c=s.count(pe.NONE),u=2*r*Math.PI/c-Math.PI/2,h=.3*this.SPACE_SIZE,g=h*Math.cos(u),m=h*Math.sin(u);return new S(i+g,o+m)}canDisplayArrow(e,r){return this.displayableArrow.some(s=>s.x===e&&s.player.equals(r))}getArrowClasses(e,r){return[this.getPlayerClass(r)]}getBlockTransform(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(e){const r=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?r.push("selected-stroke"):this.movedSquare.includes(e)&&r.push("last-move-stroke"),r}onArrowClick(e,r){var s=this;return I(function*(){const o=s.canUserPlay("#dropArrow_"+(r===B.ZERO?"zero":"one")+"_"+e);if(o.isFailure())return s.cancelMove(o.getReason());const c=gn.from(e);let u;if(s.selectedPiece.isPresent()){const g=s.selectedPiece.get().square;u=cr.transfer(gn.from(g),c).get()}else u=cr.drop(c,r);const h=s.getState();return s.chooseMove(u,h)})()}getPieceClasses(e,r,s){const i={square:e,piece:r},o=[];let c=s.count(B.ZERO),u=s.count(B.ONE);if(this.selectedPiece.equalsValue(i))o.push("selected-stroke");else if(this.droppedPiece.equalsValue(i))o.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===r)return o.push("captured-stroke"),o;this.getState().getCurrentOpponent()===B.ZERO?c++:u++}const h=s.count(pe.NONE)-(u+c),g=this.getPieceColor(r,c,h);return""!==g&&o.push(g),o}getPieceColor(e,r,s){return e<r?"player0-fill":e>=r+s?"player1-fill":""}onSquareClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#square_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.selectedPiece.isPresent()&&r.selectedPiece.get().square===e)return r.cancelMoveAttempt(),z.SUCCESS;const i=r.getState().getCurrentPlayer(),o=r.board[e];return o.count(i)<=0?r.cancelMove(Oh.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(r.selectedPiece=y.of({square:e,piece:r.getLowestPlayerPiece(o,i)}),0===r.showAndGetPossibleTranfers().length?r.cancelMove(Oh.NO_POSSIBLE_TRANSFER_REMAINS()):z.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let e=this.selectedPiece.get().square-1;const r=this.getState().getCurrentPlayer();for(;0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:r}),e--;return this.displayableArrow}getRemainingPieceCx(e){return(e+.5)*this.PIECE_RADIUS*1.5}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-apagos"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"g"),x(2,c4t,1,3,"circle",1),x(3,l4t,1,3,"circle",2),A(),O(4,"g",3),x(5,d4t,5,8,"g",4),A()()),2&e&&(D("viewBox",-r.STROKE_WIDTH/2+" "+-r.STROKE_WIDTH/2+" "+(r.BOARD_WIDTH+r.STROKE_WIDTH)+" "+(r.BOARD_HEIGHT+r.STROKE_WIDTH)),T(1),D("transform","rotate("+180*r.role.value+" "+r.BOARD_WIDTH/2+" "+r.BOARD_HEIGHT/2+")"),T(1),w("ngForOf",r.ArrayUtils.range(r.remainingOne)),T(1),w("ngForOf",r.ArrayUtils.range(r.remainingZero)),T(2),w("ngForOf",r.board))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Ho=(()=>{class n extends i8{getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275cmp=ut({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class Fo extends Ur{constructor(t,e,r){super(t,e),this.captured=r}static getInitialState(){const t=Qe.createTable(6,2,4);return new Fo(t,0,[0,0])}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let OH=(()=>{class n{}return n.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=()=>$localize`You cannot distribute from the opponent's home.`,n.MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`,n.SHOULD_DISTRIBUTE=()=>$localize`You should distribute but you do not.`,n})();class G1 extends L1{constructor(){super(Fo)}static get(){return G1.singleton.isAbsent()&&(G1.singleton=y.of(new G1)),G1.singleton.get()}applyLegalMove(t,e,r){J(G1.VERBOSE,{called:"AwaleRules.applyLegalMove",move:t,state:e});const s=t.x,i=e.getCurrentPlayer(),c=e.getCurrentOpponent().value,u=e.getCopiedBoard(),h=G1.distribute(s,c,u),g=h[h.length-1];return g.y===c?new Fo(u,e.turn+1,e.captured):this.applyPotentialCapture(i,g,u,e)}applyPotentialCapture(t,e,r,s){const i=s.getCurrentOpponent(),o=[s.captured[0],s.captured[1]],c=G1.captureIfLegal(e.x,e.y,t,r);o[t.value]+=c.capturedSum;const u=c.resultingBoard;if(G1.mustMansoon(t,u)){const h=G1.mansoon(i,u);return o[i.value]+=h.capturedSum,new Fo(h.resultingBoard,s.turn+1,o)}return new Fo(u,s.turn+1,o)}static mustMansoon(t,e){return G1.isStarving(t,e)&&!1===G1.canDistribute(t.getOpponent(),e)}static mansoon(t,e){const r=Qe.copyBiArray(e);let s=0;const i=[[0,0,0,0,0,0],[0,0,0,0,0,0]];let o=0;const c=t.getOpponent().value;do{s+=r[c][o],i[c][o]=r[c][o],r[c][o]=0,o++}while(o<6);return{capturedSum:s,captureMap:i,resultingBoard:r}}static isLegal(t,e){const r=e.getCurrentOpponent(),s=r.value,i=t.x;if(0===e.getPieceAtXY(i,s))return z.failure(OH.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=G1.isStarving(r,e.board),c=!1===G1.doesDistribute(i,s,e.board);return o&&c?z.failure(OH.SHOULD_DISTRIBUTE()):z.SUCCESS}isLegal(t,e){return G1.isLegal(t,e)}static doesDistribute(t,e,r){return 0===e?r[e][t]>5-t:r[e][t]>t}static canDistribute(t,e){for(let r=0;r<6;r++)if(G1.doesDistribute(r,t.getOpponent().value,e))return!0;return!1}static isStarving(t,e){let r=0;const s=t.getOpponent().value;do{if(e[s][r++]>0)return!1}while(r<6);return!0}static distribute(t,e,r){const s=t,i=e;let o=r[e][t];const c=[];for(r[e][t]=0;o>0;)0===e?5===t?e=1:t++:0===t?e=0:t--,(t!==s||e!==i)&&(r[e][t]+=1,c.push(new S(t,e)),o--);return c}static capture(t,e,r,s){const i=Qe.copyBiArray(s);Le(e!==r.getOpponent().value,"AwaleRules.capture cannot capture the players house");let c=i[e][t],u=0;const h=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(c<2||c>3)return{capturedSum:0,captureMap:h,resultingBoard:i};let g=-1,m=-1;r===B.ONE&&(g=1,m=6);do{h[e][t]=c,u+=c,i[e][t]=0,c=i[e][t+=g]}while(t!==m&&(2===c||3===c));return{capturedSum:u,captureMap:h,resultingBoard:i}}static captureIfLegal(t,e,r,s){const i=Qe.copyBiArray(s),o=G1.capture(t,e,r,s),c=G1.isStarving(r.getOpponent(),o.resultingBoard);return o.capturedSum>0&&c?{capturedSum:0,resultingBoard:i,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:o}static getGameStatus(t){const e=t.gameState;return e.captured[0]>24?xe.ZERO_WON:e.captured[1]>24?xe.ONE_WON:24===e.captured[0]&&24===e.captured[1]?xe.DRAW:xe.ONGOING}getGameStatus(t){return G1.getGameStatus(t)}}G1.VERBOSE=!1,G1.singleton=y.empty();class _1 extends ji{constructor(t){super(),this.x=t}static from(t){switch(t){case 0:return _1.ZERO;case 1:return _1.ONE;case 2:return _1.TWO;case 3:return _1.THREE;case 4:return _1.FOUR;default:return Le(5===t,"Invalid x for AwaleMove: "+t),_1.FIVE}}equals(t){return t===this||t.x===this.x}toString(){return"AwaleMove("+this.x+")"}}_1.ZERO=new _1(0),_1.ONE=new _1(1),_1.TWO=new _1(2),_1.THREE=new _1(3),_1.FOUR=new _1(4),_1.FIVE=new _1(5),_1.encoder=new class extends xt{encodeMove(n){return n.x}decodeMove(n){return _1.from(n)}};class g4t extends xs{getListMoves(t){const e=[],r=t.gameState,i=(r.turn+1)%2;let o,c=0;do{0!==r.getPieceAtXY(c,i)&&(o=_1.from(c),G1.isLegal(o,r).isSuccess()&&(o=_1.from(c),e.push(o))),c++}while(c<6);return this.orderMoves(t,e)}orderMoves(t,e){const r=t.gameState.getCurrentPlayer(),s=t.gameState.getCurrentOpponent().value,i=r.value;return Qe.sortByDescending(e,o=>{const c=t.gameState.getCopiedBoard(),u=c[s][o.x],h=G1.distribute(o.x,s,c),g=h[h.length-1];let m,E=0;return g.y===s?(m=0,u<=6&&(E=10)):m=G1.captureIfLegal(g.x,i,r,c).capturedSum,100*m+E-u}),e}getMetrics(t){const e=t.gameState.getCapturedCopy();return[e[0],e[1]]}}class Zce extends U1{constructor(){super(...arguments),this.tutorial=[ie.anyMove($localize`Sowing`,$localize`Awalé is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown. The spaces in Awalé are called the houses.
         As you're playing Dark, the 6 houses on the bottom are yours.<br/><br>
         Click on any of the bottom houses to sow the seeds it contains: they will be sown clockwise, one seed per house.`,Fo.getInitialState(),_1.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),ie.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new Fo([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),_1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),ie.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new Fo([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),ie.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new Fo([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),ie.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new Fo([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),ie.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new Fo([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[_1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),ie.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        You're playing Dark. Try it.`,new Fo([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[_1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),ie.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new Fo([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),_1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),ie.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new Fo([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),_1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}}function m4t(n,t){if(1&n){const e=Ae();F(),O(0,"text",7),ee("click",function(){he(e);const s=C().index,i=C().index;return le(C().onClick(s,i))}),Tt(1),A()}if(2&n){const e=C().index,r=C().index,s=C();Re("id","captured_",e,"_",r,""),D("x",65+100*e)("y",81+120*r)("transform",s.getPieceRotation(e,r)),T(1),Hi(" ",-s.captured[r][e]," ")}}function _4t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"circle",4),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),A(),O(2,"text",5),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),Tt(3),A(),x(4,m4t,2,6,"text",6),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Re("id","click_",r,"_",s,""),w("ngClass",i.getSpaceClasses(r,s)),D("cx",i.getPieceCx(r))("cy",i.getPieceCy(s)),T(1),Re("id","number_",r,"__",s,""),D("x",50+100*r)("y",66+120*s)("transform",i.getPieceRotation(r,s)),T(1),Hi(" ",e," "),T(1),w("ngIf",i.captured[s][r]>0)}}function v4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,_4t,5,12,"g",2),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let C4t=(()=>{class n extends Ho{constructor(e){super(e),this.last=y.empty(),this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.hasAsymmetricBoard=!0,this.scores=y.of([0,0]),this.rules=G1.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new g4t(this.rules,"AwaleMinimax")],this.encoder=_1.encoder,this.tutorial=(new Zce).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.scores=y.of(e.getCapturedCopy()),this.hidePreviousMove(),this.board=e.getCopiedBoard(),this.last=y.empty()}hidePreviousMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}showLastMove(e){const r=this.getState().getCurrentPlayer().value;this.last=y.of(new S(e.x,r));const s=this.getPreviousState(),i=Qe.copyBiArray(s.board),o=s.getCurrentOpponent().value;this.filledCoords=G1.distribute(e.x,o,i);const c=this.filledCoords[this.filledCoords.length-1];if(c.y!==o){const u=G1.captureIfLegal(c.x,c.y,s.getCurrentPlayer(),i);this.captured=u.captureMap;const h=this.getState().getCurrentPlayer();G1.mustMansoon(h.getOpponent(),u.resultingBoard)&&(this.captured=G1.mansoon(h,u.resultingBoard).captureMap)}}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(r===s.getState().getCurrentPlayer().value)return s.cancelMove(OH.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());s.last=y.empty();const o=_1.from(e);return s.chooseMove(o,s.getState())})()}getSpaceClasses(e,r){const s=new S(e,r),i="player"+(r+1)%2+"-fill";return this.captured[r][e]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(s)?["moved-stroke","last-move-stroke",i]:this.filledCoords.some(o=>o.equals(s))?["moved-stroke",i]:[i]}getPieceCx(e){return 50+100*e}getPieceCy(e){return 50+120*e}getPieceRotation(e,r){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(r)+")"}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-awale-component"]],features:[l],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),X(1,"rect",1),x(2,v4t,2,1,"g",2),X(3,"line",3),A()),2&e&&(D("transform",r.rotation),T(2),w("ngForOf",r.board))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class io extends ji{constructor(t,e){super(),this.first=t,this.second=e}static getFallibleEncoder(t){return io.getEncoder((e,r)=>t(e,r).get())}static getEncoder(t){return xt.tuple([S.encoder,S.encoder],e=>[e.first,e.second],e=>t(e[0],e[1]))}getFirst(){return this.first}getSecond(){return this.second}}class c8 extends io{constructor(t,e){if(super(t,e),t.equals(e))throw new Error(tt.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return Oe.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}}let vP=(()=>{class n{}return n.LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`,n.THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`,n.SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`,n.MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`,n})();class AH extends c8{constructor(t,e){if(super(t,e),t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+t.toString()+".");if(e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+e.toString()+".");const r=t.getDirectionToward(e);if(r.isFailure()||r.get().isDiagonal())throw new Error(vP.MOVE_MUST_BE_ORTHOGONAL())}equals(t){return t===this||!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class Bo extends AH{static of(t,e){return new Bo(t,e)}static from(t,e){try{const r=new Bo(t,e);return _e.success(r)}catch(r){return _e.failure(r.message)}}getMaximalDistance(){return 7}}Bo.encoder=io.getFallibleEncoder(Bo.from);const y4t={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:B.ZERO};class Pn{constructor(t,e){this.owner=t,this.king=e}isKing(){return this.king}getOwner(){return this.owner}}Pn.UNOCCUPIED=new Pn(pe.NONE,!1),Pn.PLAYER_ONE_KING=new Pn(pe.ONE,!0),Pn.INVADERS=new Pn(pe.ZERO,!1),Pn.DEFENDERS=new Pn(pe.ONE,!1);class Z1{constructor(t){this.value=t}}Z1.NONE=new Z1("NONE"),Z1.OPPONENT=new Z1("OPPONENT"),Z1.PLAYER=new Z1("PLAYER");class NH extends Ur{isCentralThrone(t){return t.equals(this.getCentralThrone())}getCentralThrone(){const t=(this.board.length-1)/2;return new S(t,t)}getRelativeOwner(t,e){const r=this.getAbsoluteOwner(e);let s;return s=r===pe.NONE?Z1.NONE:t===r?Z1.PLAYER:Z1.OPPONENT,s}getAbsoluteOwner(t){return this.getPieceAt(t).getOwner()}}class L3 extends NH{static getInitialState(){const t=Pn.UNOCCUPIED,e=Pn.INVADERS,r=Pn.DEFENDERS;return new L3([[t,t,t,e,t,t,t],[t,t,t,e,t,t,t],[t,t,t,r,t,t,t],[e,e,r,Pn.PLAYER_ONE_KING,r,e,e],[t,t,t,r,t,t,t],[t,t,t,e,t,t,t],[t,t,t,e,t,t,t]],0)}from(t,e){return new L3(t,e)}}let IH=(()=>{class n extends L1{constructor(e,r,s){super(e),this.config=r,this.generateMove=s}isLegal(e,r){J(n.VERBOSE,{tablutRules_isLegal:{move:e,state:r}});const s=r.getCurrentPlayer(),i=this.getMoveValidity(s,e,r);return i.isFailure()?z.failure(i.getReason()):z.SUCCESS}getMoveValidity(e,r,s){const i=s.getRelativeOwner(e,r.getStart());if(i===Z1.NONE)return z.failure(tt.MUST_CHOOSE_PLAYER_PIECE());if(i===Z1.OPPONENT)return z.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE());if(s.getRelativeOwner(e,r.getEnd())!==Z1.NONE)return z.failure(vP.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(s,r.getEnd())){if(!s.getPieceAt(r.getStart()).isKing())return z.failure(vP.SOLDIERS_CANNOT_SIT_ON_THRONE());if(s.isCentralThrone(r.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return z.failure(vP.THRONE_IS_LEFT_FOR_GOOD())}const c=r.getStart().getDirectionToward(r.getEnd()).get(),u=r.getStart().getOrthogonalDistance(r.getEnd());let h=r.getStart().getNext(c);for(let g=1;g<u;g++){if(s.getPieceAt(h)!==Pn.UNOCCUPIED)return z.failure(tt.SOMETHING_IN_THE_WAY());h=h.getNext(c)}return z.SUCCESS}isThrone(e,r){return!!this.isExternalThrone(r)||e.isCentralThrone(r)}isExternalThrone(e){const r=this.config.WIDTH-1;return!(0!==e.x&&e.x!==r||0!==e.y&&e.y!==r)}tryCapture(e,r,s,i){const o=r.getNext(s);return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&i.getRelativeOwner(e,o)===Z1.OPPONENT?i.getPieceAt(o).isKing()?this.captureKing(e,r,s,i):this.capturePawn(e,r,s,i):y.empty()}captureKing(e,r,s,i){const o=r.getNext(s),{backCoord:c,back:u,backInRange:h,left:g,leftCoord:m,right:E,rightCoord:b}=this.getSurroundings(o,s,e,i);return!1===h?this.captureKingAgainstTheWall(g,E,o):u===Z1.NONE&&this.isThrone(i,c)?this.captureKingAgainstThrone(c,o,g,E):u===Z1.PLAYER?this.captureKingWithAtLeastASandwich(i,o,g,m,E,b):y.empty()}getSurroundings(e,r,s,i){const o=e.getNext(r),c=o.isInRange(this.config.WIDTH,this.config.WIDTH),u=c?i.getRelativeOwner(s,o):Z1.NONE,h=e.getLeft(r),m=h.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,h):Z1.NONE,E=e.getRight(r),k=E.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,E):Z1.NONE;return{backCoord:o,back:u,backInRange:c,leftCoord:h,left:m,rightCoord:E,right:k}}captureKingAgainstTheWall(e,r,s){let o=e===Z1.PLAYER?1:0;return o+=r===Z1.PLAYER?1:0,2===o&&this.config.BORDER_CAN_SURROUND_KING?(J(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),y.of(s)):y.empty()}captureKingAgainstThrone(e,r,s,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return y.of(r)}else{const c=i===Z1.PLAYER,u=s===Z1.PLAYER||c;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&u)return y.of(r)}return y.empty()}capturePawn(e,r,s,i){const c=r.getNext(s),u=c.getNext(s);let h=Z1.NONE;return u.isInRange(this.config.WIDTH,this.config.WIDTH)&&(h=i.getRelativeOwner(e,u)),h===Z1.NONE?!1===this.isThrone(i,u)?(J(n.VERBOSE||!1,"cannot capture a pawn without an ally; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")cannot capture a pawn without an ally behind"),y.empty()):(J(n.VERBOSE||!1,"pawn captured by 1 opponent and 1 throne; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),y.of(c)):h===Z1.PLAYER?(J(n.VERBOSE||!1,"pawn captured by 2 opponents; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),y.of(c)):(J(n.VERBOSE||!1,"no captures; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),y.empty())}captureKingWithAtLeastASandwich(e,r,s,i,o,c){if(!1===this.kingTouchCentralThrone(e,r)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return y.of(r);const h=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,g=this.isThrone(e,i),m=s===Z1.PLAYER||g&&h,E=this.isThrone(e,c);return m&&(o===Z1.PLAYER||E&&h)?(J(n.VERBOSE||!1,"king captured by 4 invaders"),y.of(r)):y.empty()}kingTouchCentralThrone(e,r){const s=e.getCentralThrone();return r.getOrthogonalDistance(s)<=1}applyLegalMove(e,r,s){J(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:r}});const i=r.turn,o=r.getCopiedBoard(),c=r.getCurrentPlayer(),u=e.getStart(),h=e.getEnd();o[h.y][h.x]=o[u.y][u.x],o[u.y][u.x]=Pn.UNOCCUPIED;for(const g of $e.ORTHOGONALS){const m=this.tryCapture(c,e.getEnd(),g,r);m.isPresent()&&(o[m.get().y][m.get().x]=Pn.UNOCCUPIED)}return r.from(o,i+1)}getGameStatus(e){const s=this.getWinner(e.gameState);return s.isPresent()?xe.getVictory(s.get()):xe.ONGOING}getWinner(e){const s=this.getKingCoord(e);if(s.isAbsent())return J(!1,"The king is dead, victory to invader"),y.of(this.getInvader());const i=s.get();return this.isExternalThrone(i)?(J(!1,"The king escape, victory to defender"),y.of(this.getDefender())):this.isPlayerImmobilized(B.ZERO,e)?(J(!1,"Zero has no move, victory to one"),y.of(B.ONE)):this.isPlayerImmobilized(B.ONE,e)?(J(!1,"One has no move, victory to zero"),y.of(B.ZERO)):(J(!1,"no victory"),y.empty())}getKingCoord(e){J(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(let r=0;r<this.config.WIDTH;r++)for(let s=0;s<this.config.WIDTH;s++)if(e.getPieceAtXY(s,r).isKing())return y.of(new S(s,r));return y.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,r){return 0===this.getPlayerListMoves(e,r).length}getPlayerListMoves(e,r){const i=[],o=this.getPlayerListPawns(e,r);J(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:r}});for(const c of o){const u=this.getPossibleDestinations(c,r);for(const h of u){const g=this.generateMove(c,h);i.push(g)}}return i}getPlayerListPawns(e,r){const s=[];for(let i=0;i<this.config.WIDTH;i++)for(let o=0;o<this.config.WIDTH;o++){const c=new S(o,i);r.getAbsoluteOwner(c)===e&&s.push(c)}return s}getPossibleDestinations(e,r){const s=[];let i;for(const o of $e.ORTHOGONALS){i=e.getNext(o,1);let c=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===c;)r.getAbsoluteOwner(i)===pe.NONE?this.isExternalThrone(i)?r.getPieceAt(e).isKing()&&s.push(i):r.isCentralThrone(i)?r.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&s.push(i):s.push(i):c=!0,i=i.getNext(o,1)}return s}}return n.VERBOSE=!1,n})();class l8 extends IH{constructor(){super(L3,y4t,Bo.of)}static get(){return l8.singleton.isAbsent()&&(l8.singleton=y.of(new l8)),l8.singleton.get()}}l8.singleton=y.empty();class xH extends Ho{constructor(t,e,r){super(t),this.VERBOSE=e,this.generateMove=r,this.viewInfo={pieceClasses:[]},this.EMPTY=Pn.UNOCCUPIED,this.capturedCoords=[],this.chosen=y.empty(),this.lastMove=y.empty()}getViewBox(){const t=-this.STROKE_WIDTH,e=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return t+" "+t+" "+e+" "+e}updateBoard(){J(this.VERBOSE,"taflComponent.updateBoard"),this.board=this.getState().getCopiedBoard(),this.capturedCoords=[],this.updateViewInfo(),this.lastMove=this.node.move}showLastMove(t){const e=this.getPreviousState(),r=this.getState().getCurrentOpponent();for(const s of $e.ORTHOGONALS){const i=this.lastMove.get().getEnd().getNext(s,1);if(i.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const c=e.getRelativeOwner(r,i)===Z1.OPPONENT,h=this.getState().getPieceAt(i)===Pn.UNOCCUPIED;c&&h&&this.capturedCoords.push(i)}}}updateViewInfo(){const t=[];this.board=this.getState().getCopiedBoard();for(let e=0;e<this.board.length;e++){const r=[];for(let s=0;s<this.board[0].length;s++){let i=[];i=this.board[e][s].getOwner()===pe.NONE?[""]:this.getPieceClasses(s,e),r.push(i)}t.push(r)}this.viewInfo={pieceClasses:t}}onClick(t,e){var r=this;return I(function*(){J(r.VERBOSE,"TaflComponent.onClick("+t+", "+e+")");const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(t,e);return r.chosen.equalsValue(i)?(r.cancelMoveAttempt(),z.SUCCESS):r.chosen.isAbsent()||r.pieceBelongToCurrentPlayer(i)?r.choosePiece(i):r.chooseDestination(t,e)})()}chooseDestination(t,e){var r=this;return I(function*(){J(r.VERBOSE,"TaflComponent.chooseDestination");const s=r.chosen.get(),i=new S(t,e),o=r.generateMove(s,i);return o.isSuccess()?yield r.chooseMove(o.get(),r.getState()):r.cancelMove(o.getReason())})()}choosePiece(t){return J(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t.y][t.x]===Pn.UNOCCUPIED?this.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(t)?(this.chosen=y.of(t),this.updateViewInfo(),J(this.VERBOSE,"selected piece = ("+t.x+", "+t.y+")"),z.SUCCESS):this.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE())}pieceBelongToCurrentPlayer(t){const e=this.getState(),r=e.getCurrentPlayer();return e.getRelativeOwner(r,t)===Z1.PLAYER}cancelMoveAttempt(){this.chosen=y.empty(),this.updateViewInfo()}isThrone(t,e){const r=this.getState();return this.rules.isThrone(r,new S(t,e))}isCentralThrone(t,e){return this.getState().isCentralThrone(new S(t,e))}getPieceClasses(t,e){const r=[],s=new S(t,e),i=this.getState().getAbsoluteOwner(s);return r.push(this.getPlayerClass(i)),this.chosen.equalsValue(s)&&r.push("selected-stroke"),r}getRectClasses(t,e){const r=[],s=new S(t,e);if(this.capturedCoords.some(i=>i.equals(s)))r.push("captured-fill");else if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();(s.equals(i)||s.equals(o))&&r.push("moved-fill")}return r}getClickables(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new S(r,e);this.isClickable(s)&&t.push(s)}return t}isClickable(t){return this.pieceBelongToCurrentPlayer(t)}isInvader(t,e){return this.board[e][t]===Pn.INVADERS}isKing(t,e){return this.board[e][t].isKing()}}class CP extends xs{getListMoves(t){J(!1,{TaflMinimax_getListMoves:{node:t}});const r=t.gameState,s=r.getCurrentPlayer(),i=this.ruler.getPlayerListMoves(s,r);return this.orderMoves(r,i)}orderMoves(t,e){const r=this.ruler.getKingCoord(t).get();return t.getCurrentPlayer()===this.ruler.config.INVADER?Qe.sortByDescending(e,s=>-s.getEnd().getOrthogonalDistance(r)):Qe.sortByDescending(e,s=>s.getStart().equals(r)?this.ruler.isExternalThrone(s.getEnd())?2:1:0),e}getMetrics(t){const e=t.gameState,r=this.ruler.getPlayerListPawns(B.ZERO,e).length,s=this.ruler.getPlayerListPawns(B.ONE,e).length;return[r*[1,2][this.ruler.config.INVADER.value],s*[2,1][this.ruler.config.INVADER.value]]}}class yP{constructor(t,e){this.directThreats=t,this.mover=e}equals(t){return t.directThreats.equals(this.directThreats)&&t.mover.equals(this.mover)}}class Yce extends yP{constructor(t,e){super(new bt([t]),e),this.directThreat=t}}class E4t extends bt{constructor(t){if(super(),this.valueMap=[],this.values=[],void 0!==t)for(const e of t)this.add(e)}add(t){const e=this.toFields(t);let r=this.valueMap;for(const i of e[0])void 0===r[i]&&(r[i]=[]),r=r[i];const s=e[1];return void 0===r[s]&&(r[s]=!0,this.values.push(t),!0)}contains(t){const e=this.toFields(t);let r=this.valueMap;for(const i of e[0]){if(void 0===r[i])return!1;r=r[i]}return void 0!==r[e[1]]}[Symbol.iterator](){return this.values.values()}}class Nr extends E4t{toFields(t){return[[t.y],t.x]}}class EP extends CP{constructor(t,e){super(t,e),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=Pn.UNOCCUPIED;let i=0;const o=this.getPiecesMap(r),c=this.getThreatMap(r,o),u=this.filterThreatMap(c,r);for(const h of B.PLAYERS)for(const g of o.get(h).get())if(u.get(g).isPresent())i+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=h.getScoreModifier()*this.scoreBySafePiece;let m=0;for(const E of $e.ORTHOGONALS){let b=g.getNext(E,1);for(;b.isInRange(this.width,this.width)&&r.getPieceAt(b)===s;)m++,b=b.getNext(E,1)}i+=m*h.getScoreModifier()}return new M1(i)}getPiecesMap(t){const e=Pn.UNOCCUPIED,r=[],s=[];for(let o=0;o<this.width;o++)for(let c=0;c<this.width;c++){const u=new S(c,o);t.getPieceAt(u)!==e&&(t.getAbsoluteOwner(u)===B.ZERO?r.push(u):s.push(u))}return new Wn([{key:B.ZERO,value:new Nr(r)},{key:B.ONE,value:new Nr(s)}])}getThreatMap(t,e){const r=new Wn;for(const s of B.PLAYERS)for(const i of e.get(s).get()){const o=this.getThreats(i,t);this.isThreatReal(i,t,o)&&r.set(i,new bt(o))}return r}getThreats(t,e){const r=e.getAbsoluteOwner(t);Le(r.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const s=r.getOpponent(),i=[];for(const o of $e.ORTHOGONALS){const c=t.getPrevious(o,1);if(this.isAThreat(c,e,s)){const u=[];for(const h of $e.ORTHOGONALS){if(h===o.getOpposite())continue;let g=t.getNext(o,1);for(;g.isInRange(this.width,this.width)&&e.getPieceAt(g)===Pn.UNOCCUPIED;)g=g.getNext(h);g.isInRange(this.width,this.width)&&e.getAbsoluteOwner(g)===s&&!1===t.getNext(o,1).equals(g)&&u.push(g)}i.push(new Yce(c,new Nr(u)))}}return i}isAThreat(t,e,r){return!(t.isNotInRange(this.width,this.width)||e.getAbsoluteOwner(t)!==r&&(!this.ruler.isThrone(e,t)||r!==B.ONE&&e.getPieceAt(t)!==Pn.UNOCCUPIED))}isThreatReal(t,e,r){if(0===r.length)return!1;if(e.getPieceAt(t).isKing())return 3===r.length;for(const s of r)if(s.mover.size()>0)return!0;return!1}filterThreatMap(t,e){const r=new Wn,s=t.listKeys(),i=s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentPlayer()),o=new Nr(s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentOpponent()));for(const c of i){const u=t.get(c).get(),h=[];for(const g of u)if(!1===o.contains(g.directThreat)){const m=[];for(const E of g.mover)!1===o.contains(E)&&m.push(E);m.length>0&&h.push(new Yce(g.directThreat,new Nr(m)))}h.length>0&&r.set(c,new bt(h))}for(const c of o){const u=t.get(c).get();r.set(c,u)}return r}}class MP extends EP{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,i=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,r);let o=i.controlScore;o+=i.safeScore*this.getScoreBySafePiece(r);const c=this.getScoreByThreatenedPiece(r);return o+=i.threatenedScore*c,Le(i.controlScore<=c,"Control Score should be below "+c+", got "+i.controlScore),Le(i.threatenedScore<=16,"Threatened Score should be below 16, got "+i.threatenedScore),Le(i.safeScore<=16,"Safe Score should be below 16, got "+i.threatenedScore),new M1(o)}getControlScoreAndPieceScores(t,e){const r=this.getPiecesMap(e),s=this.getThreatMap(e,r),i=this.filterThreatMap(s,e),o={safeScore:0,threatenedScore:0,controlScore:0};for(const c of B.PLAYERS){const u=new Nr;for(const h of r.get(c).get())if(i.get(h).isPresent())o.threatenedScore+=c.getScoreModifier();else{o.safeScore+=c.getScoreModifier();for(const g of $e.ORTHOGONALS){let m=h.getNext(g,1);for(;m.isInRange(t,t)&&e.getPieceAt(m)===Pn.UNOCCUPIED;)u.add(m),m=m.getNext(g,1)}}for(const h of u){const g=this.getControlledPieceValue(h.x,h.y,t);o.controlScore+=c.getScoreModifier()*g}}return o}getControlledPieceValue(t,e,r){let s=1;return(0===t||t===r-1)&&(s*=r),(0===e||e===r-1)&&(s*=r),s}getScoreByThreatenedPiece(t){const e=t.board.length,r=e-2;return 4*e*e+4*r*e+r*r}getScoreBySafePiece(t){return 16*this.getScoreByThreatenedPiece(t)+1}}class kH extends MP{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,i=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,r),o=r.getPieceAt(this.ruler.getKingCoord(r).get()).getOwner(),c=this.getStepForEscape(r)*o.getScoreModifier();if(-1===c)return new M1(o.getOpponent().getPreVictory());const u=this.getScoreByThreatenedPiece(r);return Le(i.controlScore<=u,"Control Score should be below "+u+", got "+i.controlScore),Le(i.threatenedScore<=16,"Threatened Score should be below 16, got "+i.threatenedScore),Le(i.safeScore<=16,"Safe Score should be below 16, got "+i.threatenedScore),new M1(-1*c*(u+1)*17*17+i.safeScore*(u+1)*17+i.threatenedScore*(u+1)+i.controlScore)}getStepForEscape(t){const e=this.ruler.getKingCoord(t).get();return this._getStepForEscape(t,1,[e],[]).getOrElse(-1)}_getStepForEscape(t,e,r,s){const i=this.getNextGen(t,r,s);return 0===i.length?y.empty():i.some(o=>this.ruler.isExternalThrone(o))?y.of(e):(e++,s.push(...i),this._getStepForEscape(t,e,i,s))}getNextGen(t,e,r){const s=[];for(const i of e)for(const o of $e.ORTHOGONALS){let c=i.getNext(o,1);for(;c.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&t.getPieceAt(c)===Pn.UNOCCUPIED;)r.every(u=>!1===u.equals(c))&&s.push(c),c=c.getNext(o,1)}return s}}const ne=Pn.UNOCCUPIED,Y1=Pn.INVADERS,Ea=Pn.DEFENDERS,Bm=Pn.PLAYER_ONE_KING;class Kce extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,L3.getInitialState()),ie.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,L3.getInitialState(),Bo.of(new S(3,1),new S(1,1)),$localize`Congratulations!`),ie.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new L3([[ne,ne,ne,Y1,ne,ne,ne],[ne,ne,ne,Y1,ne,ne,ne],[Y1,ne,ne,Ea,ne,ne,ne],[ne,ne,Ea,Bm,Ea,Y1,Y1],[ne,ne,Y1,ne,ne,ne,ne],[ne,ne,ne,Ea,ne,Y1,ne],[ne,ne,ne,Y1,ne,ne,ne]],1),[Bo.of(new S(3,5),new S(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),ie.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new L3([[ne,ne,ne,Y1,ne,ne,ne],[ne,ne,Y1,ne,ne,ne,ne],[ne,ne,ne,Ea,ne,ne,ne],[Y1,Ea,ne,ne,Ea,Y1,Y1],[ne,Ea,ne,ne,ne,ne,ne],[ne,Y1,ne,Bm,ne,Y1,ne],[ne,ne,ne,Y1,ne,ne,ne]],12),[Bo.of(new S(2,1),new S(3,1)),Bo.of(new S(3,0),new S(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ie.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new L3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,Ea,ne,ne,ne],[ne,ne,ne,Y1,ne,ne,ne],[ne,Y1,ne,Bm,Y1,ne,ne],[ne,ne,ne,Y1,ne,ne,ne],[ne,Ea,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[Bo.of(new S(1,3),new S(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ie.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new L3([[ne,ne,Y1,ne,ne,ne,ne],[ne,ne,ne,Y1,ne,ne,ne],[ne,ne,ne,Bm,Y1,ne,ne],[ne,Y1,Ea,ne,Ea,ne,ne],[ne,ne,ne,Y1,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[Bo.of(new S(2,0),new S(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),ie.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new L3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,Y1,ne,Y1,ne,ne,ne],[Y1,ne,ne,ne,Ea,ne,ne],[ne,ne,ne,Ea,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,Bm,ne,Y1,ne,ne,ne]],72),[Bo.of(new S(3,6),new S(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function M4t(n,t){1&n&&(F(),X(0,"polygon",8))}function S4t(n,t){1&n&&(F(),X(0,"rect",9))}function P4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,M4t,1,0,"polygon",6),x(2,S4t,1,0,"ng-template",null,7,Gn),A()),2&n){const e=Fn(3),r=C().index,s=C().index,i=C();T(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function T4t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=C(2).index,r=C().index,s=C();T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function w4t(n,t){if(1&n&&(F(),X(0,"polyline",16)),2&n){const e=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][e])}}function b4t(n,t){if(1&n&&(F(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function O4t(n,t){if(1&n&&(F(),x(0,w4t,1,1,"polyline",14),x(1,b4t,4,20,"ng-template",null,15,Gn)),2&n){const e=Fn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",e)}}function A4t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",10),x(2,T4t,6,25,"g",11),x(3,O4t,3,2,"ng-template",null,12,Gn),A()),2&n){const e=Fn(4),r=C().index,s=C().index,i=C();T(1),Re("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),T(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function N4t(n,t){if(1&n){const e=Ae();F(),O(0,"g",3),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),X(1,"rect",4),x(2,P4t,4,2,"g",5),x(3,A4t,5,8,"g",5),A()}if(2&n){const e=t.index,r=C().index,s=C();Re("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),T(1),Re("id","space_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),T(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function I4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,N4t,4,10,"g",2),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function x4t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",17),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),Re("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let k4t=(()=>{class n extends xH{constructor(e){super(e,!1,Bo.from),this.rules=l8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new CP(this.rules,"DummyBot"),new EP(this.rules,"Piece > Influence"),new MP(this.rules,"Piece > Control"),new kH(this.rules,"Escape > Piece > Control")],this.encoder=Bo.encoder,this.tutorial=(new Kce).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-brandhub"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,I4t,2,1,"g",1),x(2,x4t,2,6,"g",1),A()),2&e&&(D("viewBox",r.getViewBox()),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getClickables()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Ci=(()=>{class n extends Ur{static getInitialState(){const e=Qe.createTable(n.WIDTH,n.HEIGHT,pe.NONE);return new n(e,0)}}return n.WIDTH=19,n.HEIGHT=19,n})();class tc extends Ks{constructor(t,e){super(t,e)}static isInRange(t){return t.isInRange(Ci.WIDTH,Ci.HEIGHT)}static from(t){return Se.assert(tc.isInRange(t),"FIRST_COORD_IS_OUT_OF_RANGE"),new tc(t.x,t.y)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}tc.encoder=Ks.getEncoder(tc.from);class V4 extends io{static from(t,e){return Se.assert(t.isInRange(Ci.WIDTH,Ci.HEIGHT),"FIRST_COORD_IS_OUT_OF_RANGE"),Se.assert(e.isInRange(Ci.WIDTH,Ci.HEIGHT),"SECOND_COORD_IS_OUT_OF_RANGE"),Se.assert(!1===t.equals(e),"COORDS_SHOULD_BE_DIFFERENT"),_e.success(new V4(t,e))}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(t){const e=this.getFirst(),r=t.getFirst(),s=this.getSecond(),i=t.getSecond();return!(!e.equals(r)||!s.equals(i))||!(!e.equals(i)||!s.equals(r))}}V4.encoder=io.getFallibleEncoder(V4.from);const L4t=xt.disjunction(tc.encoder,V4.encoder,n=>n instanceof tc);class $m{constructor(t,e,r){this.isInRange=t,this.getOwner=e,this.N=r}getBoardValue(t){let e=0;return t.forEachCoord((r,s)=>{this.getOwner(s,t).isPlayer()&&(e+=this.getSquareScore(t,r))}),new M1(e)}getSquareScore(t,e){const r=t.getPieceAt(e),s=this.getOwner(r,t);Le(s.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const i=new Wn,o=new Wn;for(const u of Oe.DIRECTIONS){const h=this.getNumberOfFreeSpacesAndAllies(t,e,u,s);i.set(u,h[0]),o.set(u,h[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(o,i)*s.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(t,e){let r=0;for(const s of[Oe.UP,Oe.UP_RIGHT,Oe.RIGHT,Oe.DOWN_RIGHT]){if(t.get(s).get()+t.get(s.getOpposite()).get()+1>=this.N)return Number.MAX_SAFE_INTEGER;const g=e.get(s).get()+e.get(s.getOpposite()).get();g+1>=this.N&&(r+=2+g-this.N)}return r}getNumberOfFreeSpacesAndAllies(t,e,r,s){let i=0,o=0,c=!0,u=new S(e.x+r.x,e.y+r.y),h=1;const g=s.getOpponent();for(;this.isInRange(u)&&h<this.N;){const m=t.getPieceAt(u);if(this.getOwner(m,t)===g)return[i,o];this.getOwner(m,t)===s&&c?o++:c=!1,m!==g&&m!==s&&i++,u=u.getNext(r),h++}return[i,o]}getVictoriousCoord(t){const e=[];for(const r of t.getCoordsAndContents())if(this.getOwner(r.content,t).isPlayer()){const s=r.coord,i=this.getSquareScore(t,s);gr.getScoreStatus(i)===Sn.VICTORY&&(i===B.ZERO.getVictoryValue()||i===B.ONE.getVictoryValue())&&e.push(s)}return e}}class nc extends L1{constructor(){super(Ci)}static get(){return nc.singleton.isAbsent()&&(nc.singleton=y.of(new nc)),nc.singleton.get()}static getVictoriousCoords(t){return nc.CONNECT_SIX_HELPER.getVictoriousCoord(t)}applyLegalMove(t,e,r){return t instanceof V4?this.applyLegalDrops(t,e):this.applyLegalFirstMove(t,e)}applyLegalDrops(t,e){const r=e.getCurrentPlayer(),s=t.getFirst(),i=t.getSecond(),o=e.getCopiedBoard();return o[s.y][s.x]=r,o[i.y][i.x]=r,new Ci(o,e.turn+1)}applyLegalFirstMove(t,e){const r=e.getCurrentPlayer(),s=e.getCopiedBoard();return s[t.coord.y][t.coord.x]=r,new Ci(s,e.turn+1)}isLegal(t,e){return 0===e.turn?(Se.assert(t instanceof tc,"First move should be instance of ConnectSixFirstMove"),z.SUCCESS):(Se.assert(t instanceof V4,"non-firsts moves should be instance of ConnectSixDrops"),this.isLegalDrops(t,e))}isLegalDrops(t,e){return e.getPieceAt(t.getFirst()).isPlayer()||e.getPieceAt(t.getSecond()).isPlayer()?z.failure(tt.MUST_CLICK_ON_EMPTY_SQUARE()):z.SUCCESS}getGameStatus(t){const e=t.gameState;return nc.CONNECT_SIX_HELPER.getVictoriousCoord(e).length>0?xe.getVictory(e.getCurrentOpponent()):181===e.turn?xe.DRAW:xe.ONGOING}}nc.singleton=y.empty(),nc.CONNECT_SIX_HELPER=new $m(tc.isInRange,Se.identity,6);const G=pe.NONE,R2=pe.ZERO,Yi=pe.ONE;class Xce extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,Ci.getInitialState()),ie.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,Ci.getInitialState(),tc.from(new S(9,9)),$localize`Congratulations!`),ie.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new Ci([[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,Yi,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,R2,G,Yi,R2,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,R2,R2,G,G,Yi,G,G,G,G,G,G],[G,G,G,G,G,G,G,Yi,R2,R2,R2,R2,Yi,G,G,G,G,G,G],[G,G,G,G,G,G,Yi,R2,R2,R2,R2,Yi,G,G,G,G,G,G,G],[G,G,G,G,G,G,Yi,G,Yi,R2,Yi,Yi,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,R2,Yi,R2,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,Yi,G,Yi,G,R2,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,Yi,Yi,G,Yi,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,Yi,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,R2,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G]],20),V4.from(new S(4,11),new S(5,10)).get(),$localize`Congratulations!`)]}}let LH=(()=>{class n extends Ho{constructor(){super(...arguments),this.hoshis=[]}createHoshis(){const e=this.board.length,r=Math.floor(e/2),s=e<12?2:3,i=e-(s+1);18<e&&this.hoshis.push(new S(s,r),new S(r,s),new S(r,i),new S(i,r)),this.hoshis.push(new S(r,r),new S(s,s),new S(s,i),new S(i,s),new S(i,i))}isHoshi(e,r){return this.hoshis.some(s=>s.x===e&&s.y===r)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275cmp=ut({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class R4t extends Dc{getListMoves(t){return 0===t.gameState.turn?this.getFirstMove():this.getListDrops(t)}getFirstMove(){const e=Ci.HEIGHT,r=Math.floor(Ci.WIDTH/2),s=Math.floor(e/2);return[tc.from(new S(r,s))]}getListDrops(t){const e=this.getAvailableCoords(t.gameState),r=[];for(const s of e){const i=t.gameState.getCopiedBoard();i[s.y][s.x]=t.gameState.getCurrentPlayer();const o=new Ci(i,t.gameState.turn),c=this.getAvailableCoords(o);for(const u of c){const h=V4.from(s,u).get();r.push(h)}}return new bt(r).toList()}getAvailableCoords(t){const e=this.getUsefulCoordsMap(t),r=[];for(const s of t.getCoordsAndContents()){const i=s.coord;!0===e[i.y][i.x]&&!1===s.content.isPlayer()&&r.push(i)}return r}getUsefulCoordsMap(t){const e=Qe.createTable(Ci.WIDTH,Ci.HEIGHT,!1);for(const r of t.getCoordsAndContents())r.content.isPlayer()&&this.addNeighboringCoord(e,r.coord);return e}addNeighboringCoord(t,e){const s=Math.max(0,e.x-1),i=Math.max(0,e.y-1),o=Math.min(Ci.WIDTH-1,e.x+1),c=Math.min(Ci.HEIGHT-1,e.y+1);for(let u=i;u<=c;u++)for(let h=s;h<=o;h++)t[u][h]=!0}getBoardValue(t){const e=t.gameState;let r=0;for(const s of e.getCoordsAndContents())if(s.content.isPlayer()){const i=nc.CONNECT_SIX_HELPER.getSquareScore(e,s.coord);if(gr.getScoreStatus(i)===Sn.VICTORY)return new M1(i);r+=i}return new M1(r)}}function D4t(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=C().index,r=C().index,s=C();Re("id","piece_",e,"_",r,""),w("ngClass",s.getSpaceClass(e,r)),D("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function z4t(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2).index,r=C().index,s=C();Re("id","hoshi_",e,"_",r,""),D("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.1*s.SPACE_SIZE)}}function V4t(n,t){if(1&n&&(F(),X(0,"rect",9)(1,"line",10)(2,"line",10),x(3,z4t,1,5,"circle",11)),2&n){const e=C().index,r=C().index,s=C();D("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*e)("y",.5*s.SPACE_SIZE*r),T(1),D("x1",.5*s.SPACE_SIZE*e)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),D("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),w("ngIf",s.isHoshi(e,r))}}function H4t(n,t){if(1&n){const e=Ae();F(),O(0,"g",5),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),x(1,D4t,1,6,"circle",6),x(2,V4t,4,13,"ng-template",null,7,Gn),A()}if(2&n){const e=t.$implicit,r=t.index,s=Fn(3);Re("id","click_",r,"_",C().index,""),T(1),w("ngIf",e.isPlayer())("ngIfElse",s)}}function F4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,H4t,4,4,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function B4t(n,t){if(1&n){const e=Ae();F(),O(0,"circle",13),ee("click",function(){he(e);const s=C();return le(s.onClick(s.droppedCoord.get().x,s.droppedCoord.get().y))}),A()}if(2&n){const e=C();w("ngClass",e.getSpaceClass(e.droppedCoord.get().x,e.droppedCoord.get().y)),D("cx",.25*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.droppedCoord.get().x)("cy",.25*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.droppedCoord.get().y)("r",.22*e.SPACE_SIZE)}}let $4t=(()=>{class n extends LH{constructor(e){super(e),this.droppedCoord=y.empty(),this.lastMoved=[],this.victoryCoords=[],this.rules=nc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new R4t(this.rules,"Minimax")],this.encoder=L4t,this.tutorial=(new Xce).tutorial}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.victoryCoords=nc.getVictoriousCoords(e),this.createHoshis()}showLastMove(e){this.lastMoved=e instanceof tc?[e.coord]:[e.getFirst(),e.getSecond()]}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);if(0===s.getState().turn)return s.chooseMove(tc.from(o),s.getState());if(s.getState().getPieceAt(o).isPlayer())return s.cancelMove(tt.MUST_CLICK_ON_EMPTY_SQUARE());if(s.droppedCoord.isPresent()){if(s.droppedCoord.equalsValue(o))return s.droppedCoord=y.empty(),z.SUCCESS;{const c=V4.from(s.droppedCoord.get(),o).get();return s.chooseMove(c,s.getState())}}return s.droppedCoord=y.of(o),z.SUCCESS})()}getSpaceClass(e,r){const s=new S(e,r),i=this.getState().getPieceAt(s),o=[];return this.droppedCoord.equalsValue(s)?(o.push(this.getPlayerClass(this.getState().getCurrentPlayer())),o.push("highlighted-stroke")):(o.push(this.getPlayerClass(i)),this.victoryCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),this.lastMoved.some(c=>c.equals(s))&&o.push("last-move-stroke")),o}cancelMoveAttempt(){this.droppedCoord=y.empty()}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-connect-six"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["id","dropped","class","base mid-stroke moved-stroke",3,"ngClass","click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],["id","dropped",1,"base","mid-stroke","moved-stroke",3,"ngClass","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),X(1,"rect",1),x(2,F4t,2,1,"g",2),x(3,B4t,1,4,"circle",3),A()),2&e&&(D("viewBox","0 -3 "+r.board.length*r.SPACE_SIZE*.5+" "+(6+r.board.length*r.SPACE_SIZE*.5)),T(1),D("width",r.board.length*r.SPACE_SIZE*.5)("height",r.board.length*r.SPACE_SIZE*.5),T(1),w("ngForOf",r.board),T(1),w("ngIf",r.droppedCoord.isPresent()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),d6=(()=>{class n{}return n.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`,n.CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`,n.CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`,n.MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`,n.MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`,n.INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`,n.SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`,n})();class jt extends Ur{static getInitialState(){const t=Qe.createTable(jt.WIDTH,jt.HEIGHT,pe.NONE);return new jt(t,0)}isShelter(t){return 0===t.x||t.x===jt.WIDTH-1?jt.SHELTERS_INDICES.some(e=>t.y===e):(0===t.y||t.y===jt.HEIGHT-1)&&jt.SHELTERS_INDICES.some(e=>t.x===e)}isCentralZone(t){return t.x>=jt.CENTRAL_ZONE_TOP_LEFT.x&&t.x<=jt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&t.y>=jt.CENTRAL_ZONE_TOP_LEFT.y&&t.y<=jt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}jt.WIDTH=17,jt.HEIGHT=17,jt.CENTRAL_ZONE_TOP_LEFT=new S(4,6),jt.CENTRAL_ZONE_BOTTOM_RIGHT=new S(12,10),jt.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],jt.ALL_SHELTERS=new bt(jt.SHELTERS_INDICES.flatMap(n=>[new S(n,0),new S(n,jt.HEIGHT-1),new S(0,n),new S(jt.WIDTH-1,n)])).toList();class u8 extends Ks{constructor(t){super(t.x,t.y)}static from(t){return t.isInRange(jt.WIDTH,jt.HEIGHT)?_e.success(new u8(t)):_e.failure("Move out of board")}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(t){return!!t.isDrop()&&this.coord.equals(t.coord)}isDrop(){return!0}isSimple(){return!1}isJump(){return!1}}u8.encoder=Ks.getFallibleEncoder(u8.from);class f8 extends c8{constructor(t,e){super(t,e)}static from(t,e){return t.isInRange(jt.WIDTH,jt.HEIGHT)&&e.isInRange(jt.WIDTH,jt.HEIGHT)?t.isAlignedWith(e)&&1===t.getDistance(e)?_e.success(new f8(t,e)):_e.failure(d6.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):_e.failure("Move out of board")}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(!t.isSimple()||t!==this&&(!1===t.getStart().equals(this.getStart())||!1===t.getEnd().equals(this.getEnd())))}isDrop(){return!1}isSimple(){return!0}isJump(){return!1}}f8.encoder=io.getFallibleEncoder(f8.from);class R3 extends ji{constructor(t){super(),this.coords=t}static from(t){if(t.length<2)return _e.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const r of t)if(r.isNotInRange(jt.WIDTH,jt.HEIGHT))return _e.failure("Move out of board");for(let r=1;r<t.length;r++)if(t[r-1].getDirectionToward(t[r]).isFailure()||2!==t[r-1].getDistance(t[r]))return _e.failure(d6.INVALID_JUMP());return new Nr(t).size()===t.length?_e.success(new R3(t)):_e.failure(d6.SAME_LOCATION_VISITED_IN_JUMP())}addJump(t){const e=Qe.copyImmutableArray(this.coords);return e.push(t),R3.from(e)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const t=[];for(let e=1;e<this.coords.length;e++){const r=this.coords[e-1].getDirectionToward(this.coords[e]).get();t.push(this.coords[e-1].getNext(r,1))}return t}toString(){return`ConspirateursMoveJump(${this.coords.map(e=>e.toString()).reduce((e,r)=>e+" -> "+r)})`}equals(t){return!(t.isSimple()||t.isDrop()||t!==this&&(!1===this.getStartingCoord().equals(t.getStartingCoord())||!1===this.getEndingCoord().equals(t.getEndingCoord())))}isDrop(){return!1}isSimple(){return!1}isJump(){return!0}}R3.encoder=new class extends xt{encodeMove(n){return{coords:n.coords.map(S.encoder.encodeMove)}}decodeMove(n){Le(null!=Se.getNonNullable(n).coords,"Encoded ConspirateursMoveJump should contain coords");const e=Se.getNonNullable(n).coords.map(S.encoder.decodeMove);return R3.from(e).get()}};const U4t=xt.disjunction3(u8.encoder,f8.encoder,R3.encoder,n=>n.isDrop(),n=>n.isSimple()),P=pe.NONE,Lt=pe.ZERO,Nt=pe.ONE;class Qce extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,jt.getInitialState()),ie.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,jt.getInitialState(),u8.from(new S(7,7)).get(),$localize`Congratulations!`),ie.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new jt([[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,Lt,Lt,Nt,Nt,Lt,Lt,Nt,Lt,Nt,P,P,P,P],[P,P,P,P,Lt,Nt,Lt,Nt,Lt,Lt,Lt,Lt,Nt,P,P,P,P],[P,P,P,P,Lt,Nt,P,P,P,P,P,Nt,Lt,P,P,P,P],[P,P,P,P,Nt,Lt,Lt,Nt,Nt,Nt,Lt,Lt,Lt,P,P,P,P],[P,P,P,P,Nt,Lt,Nt,Nt,Nt,Nt,Nt,Nt,Lt,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P]],40),f8.from(new S(4,6),new S(3,5)).get(),(t,e,r)=>t.isSimple()?z.SUCCESS:z.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),ie.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new jt([[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,Lt,Lt,Nt,Nt,Lt,Lt,Nt,Lt,Nt,P,P,P,P],[P,P,P,P,Lt,Nt,Lt,Nt,Lt,Lt,Lt,Lt,Nt,P,P,P,P],[P,P,P,P,Lt,Nt,P,P,P,P,P,Nt,Lt,P,P,P,P],[P,P,P,P,Nt,Lt,Lt,Nt,Nt,Nt,Lt,Lt,Lt,P,P,P,P],[P,P,P,P,Nt,Lt,Nt,Nt,Nt,Nt,Nt,Nt,Lt,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P]],40),R3.from([new S(6,7),new S(6,5)]).get(),(t,e,r)=>t.isJump()?z.SUCCESS:z.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),ie.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new jt([[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,Nt,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,Nt,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,Nt,P,P,P,P,P,P,P,P,P],[P,P,P,P,Lt,Lt,P,Nt,Lt,Lt,Nt,Lt,Nt,P,P,P,P],[P,P,P,P,Lt,P,Lt,Nt,Lt,Lt,Lt,Lt,Nt,P,P,P,P],[P,P,P,P,Lt,Nt,P,P,P,P,P,Nt,Lt,P,P,P,P],[P,P,P,P,Nt,Lt,Lt,Nt,Nt,Nt,Lt,Lt,Lt,P,P,P,P],[P,P,P,P,Nt,Lt,Nt,Nt,Nt,Nt,Nt,Nt,Lt,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P]],40),[R3.from([new S(8,6),new S(6,4),new S(6,2),new S(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}}class rc extends L1{constructor(){super(jt)}static get(){return rc.singleton.isAbsent()&&(rc.singleton=y.of(new rc)),rc.singleton.get()}applyLegalMove(t,e,r){const s=e.getCopiedBoard();if(t.isDrop())s[t.coord.y][t.coord.x]=e.getCurrentPlayer();else if(t.isSimple())s[t.getStart().y][t.getStart().x]=pe.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer();else{const i=t.getStartingCoord(),o=t.getEndingCoord();s[i.y][i.x]=pe.NONE,s[o.y][o.x]=e.getCurrentPlayer()}return new jt(s,e.turn+1)}isLegal(t,e){return t.isDrop()?this.dropLegality(t,e):t.isSimple()?this.simpleMoveLegality(t,e):this.jumpLegality(t,e)}dropLegality(t,e){return e.turn>=40?z.failure(d6.CANNOT_DROP_AFTER_TURN_40()):e.getPieceAt(t.coord).isPlayer()?z.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):!1===e.isCentralZone(t.coord)?z.failure(d6.MUST_DROP_IN_CENTRAL_ZONE()):z.SUCCESS}simpleMoveLegality(t,e){return e.turn<40?z.failure(d6.CANNOT_MOVE_BEFORE_TURN_40()):e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?z.failure(tt.MUST_CHOOSE_PLAYER_PIECE()):e.getPieceAt(t.getEnd()).isPlayer()?z.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):z.SUCCESS}jumpLegality(t,e){if(e.turn<40)return z.failure(d6.CANNOT_MOVE_BEFORE_TURN_40());if(e.getPieceAt(t.getStartingCoord())!==e.getCurrentPlayer())return z.failure(tt.MUST_CHOOSE_PLAYER_PIECE());for(const r of t.getJumpedOverCoords())if(e.getPieceAt(r)===pe.NONE)return z.failure(d6.MUST_JUMP_OVER_PIECES());for(const r of t.getLandingCoords())if(e.getPieceAt(r).isPlayer())return z.failure(tt.MUST_LAND_ON_EMPTY_SPACE());return z.SUCCESS}jumpTargetsFrom(t){const e=[new S(t.x+2,t.y),new S(t.x-2,t.y),new S(t.x,t.y+2),new S(t.x,t.y-2),new S(t.x+2,t.y+2),new S(t.x+2,t.y-2),new S(t.x-2,t.y+2),new S(t.x-2,t.y-2)],r=[];for(const s of e)R3.from([t,s]).isSuccess()&&r.push(s);return r}nextJumps(t,e){const r=t.getEndingCoord(),s=[];for(const i of this.jumpTargetsFrom(r)){const o=t.addJump(i);o.isSuccess()&&this.jumpLegality(o.get(),e).isSuccess()&&s.push(o.get())}return s}jumpHasPossibleNextTargets(t,e){return this.nextJumps(t,e).length>0}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of jt.ALL_SHELTERS){const i=e.getPieceAt(s);if(i.isPlayer()&&(r[i.value]+=1,20===r[i.value]))return xe.getVictory(i)}return xe.ONGOING}}rc.singleton=y.empty();let Um=(()=>{class n{}return n.NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`,n.SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`,n.TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`,n.MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`,n.MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`,n})();class Tn{constructor(t,e){this.owner=t,this.otherPieceType=e}static of(t,e){return t===B.ZERO?e?Tn.ZERO_SECOND:Tn.ZERO_FIRST:t===B.ONE?e?Tn.ONE_SECOND:Tn.ONE_FIRST:Tn.EMPTY}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(t){return this===t}}Tn.encoder=xt.tuple([pe.encoder,xt.identity()],n=>[n.owner,n.otherPieceType],n=>Tn.of(n[0],n[1])),Tn.EMPTY=new Tn(pe.NONE,!1),Tn.ZERO_FIRST=new Tn(B.ZERO,!1),Tn.ZERO_SECOND=new Tn(B.ZERO,!0),Tn.ONE_FIRST=new Tn(B.ONE,!1),Tn.ONE_SECOND=new Tn(B.ONE,!0),Tn.PLAYER_PIECES=[Tn.ZERO_FIRST,Tn.ZERO_SECOND,Tn.ONE_FIRST,Tn.ONE_SECOND];class h8 extends ji{constructor(t,e){if(super(),this.target=t,this.piece=e,e===Tn.EMPTY)throw new Error("Cannot drop an empty piece")}isDrop(){return!0}getTarget(){return this.target}equals(t){return t instanceof h8&&!(this.target!==t.target||this.piece!==t.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}h8.encoder=xt.tuple([xt.identity(),Tn.encoder],n=>[n.target,n.piece],n=>new h8(n[0],n[1]));class D2 extends ji{constructor(t,e){super(),this.start=t,this.moveDirection=e}static fromRepresentation(t,e){return new D2(new S(t.x,3-t.y),e)}isDrop(){return!1}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(t){return t instanceof D2&&!(!1===this.start.equals(t.start)||this.moveDirection!==t.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}D2.encoder=xt.tuple([S.encoder,xt.identity()],n=>[n.start,"clockwise"===n.moveDirection],n=>new D2(n[0],n[1]?"clockwise":"counterclockwise"));const G4t=xt.disjunction(h8.encoder,D2.encoder,n=>n.isDrop());let Gr=(()=>{class n extends Ur{constructor(e,r,s){super(e,s),this.remainingPieces=r}static getInitialState(){const e=Tn.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}static fromRepresentation(e,r){const s=e.reverse(),i=[4,4,4,4];for(let o=0;o<n.HEIGHT;o++)for(let c=0;c<n.WIDTH;c++){const u=s[o][c];s[o][c]!==Tn.EMPTY&&i[n.pieceIndex(u)]--}return Le(i.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new n(s,i,r)}static pieceIndex(e){switch(e){case Tn.ZERO_FIRST:return 0;case Tn.ZERO_SECOND:return 1;case Tn.ONE_FIRST:return 2;default:return Se.expectToBe(e,Tn.ONE_SECOND),3}}getRemainingPiecesOf(e){return this.remainingPieces[n.pieceIndex(e)]}getStackHeight(e){let r=0;for(let s=0;s<n.HEIGHT&&this.getPieceAtXY(e,s)!==Tn.EMPTY;s++)r++;return r}}return n.WIDTH=8,n.HEIGHT=4,n})();class H4 extends L1{constructor(){super(Gr)}static get(){return H4.singleton.isAbsent()&&(H4.singleton=y.of(new H4)),H4.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalShift(t,e)}applyLegalDrop(t,e){const r=Qe.copyBiArray(e.board);r[e.getStackHeight(t.target)][t.target]=t.piece;const s=Qe.copyImmutableArray(e.remainingPieces);return s[Gr.pieceIndex(t.piece)]-=1,new Gr(r,s,e.turn+1)}applyLegalShift(t,e){const r=Qe.copyBiArray(e.board),s=t.getTarget();let i=e.getStackHeight(s),o=t.start.y;for(;o<Gr.HEIGHT&&e.getPieceAtXY(t.start.x,o)!==Tn.EMPTY;)r[i][s]=e.getPieceAtXY(t.start.x,o),r[o][t.start.x]=Tn.EMPTY,i++,o++;return new Gr(r,e.remainingPieces,e.turn+1)}isLegal(t,e){return t.isDrop()?this.isDropLegal(t,e):this.isShiftLegal(t,e)}isDropLegal(t,e){return t.piece.owner!==e.getCurrentPlayer()?z.failure(tt.MUST_CHOOSE_PLAYER_PIECE()):0===e.getRemainingPiecesOf(t.piece)?z.failure(Um.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(t,e)}dropHeightValidity(t,e){return e.getStackHeight(t.target)===Gr.HEIGHT?z.failure(Um.SPACE_IS_FULL()):z.SUCCESS}isShiftLegal(t,e){return e.getPieceAt(t.start).owner!==e.getCurrentPlayer()?z.failure(tt.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(t,e)}shiftHeightValidity(t,e){const r=e.getStackHeight(t.start.x)-t.start.y;return e.getStackHeight(t.getTarget())+r>Gr.HEIGHT?z.failure(Um.TARGET_STACK_TOO_HIGH()):z.SUCCESS}getGameStatus(t){const e=this.findHighestAlignment(t.gameState);if(e.isPresent()){const r=t.gameState.getPieceAt(e.get());return Le(r.owner.isPlayer(),"highest alignment is owned by a player"),xe.getVictory(r.owner)}return xe.ONGOING}findHighestAlignment(t){for(let e=0;e<Gr.WIDTH/2;e++)for(let r=Gr.HEIGHT-1;r>0;r--){const s=t.getPieceAtXY(e,r),i=t.getPieceAtXY(e+Gr.WIDTH/2,r);if(s!==Tn.EMPTY&&s===i)return y.of(new S(e,r))}return y.empty()}pieceCanMove(t,e){return!!this.isShiftLegal(new D2(e,"clockwise"),t).isSuccess()||!!this.isShiftLegal(new D2(e,"counterclockwise"),t).isSuccess()}}H4.singleton=y.empty();const st=Tn.EMPTY,xh=Tn.ZERO_FIRST,Jce=Tn.ZERO_SECOND,SP=Tn.ONE_FIRST,RH=Tn.ONE_SECOND;class e3e{constructor(){this.tutorial=[ie.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,Gr.getInitialState()),ie.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,Gr.fromRepresentation([[st,st,st,st,st,st,st,st],[st,st,st,st,st,st,st,st],[st,st,st,st,SP,st,st,st],[xh,st,st,st,xh,st,st,st]],3),[new h8(0,Tn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),ie.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,Gr.fromRepresentation([[st,st,st,st,st,st,st,st],[st,st,st,st,RH,st,st,st],[st,st,st,st,xh,st,st,st],[SP,st,st,st,Jce,st,st,st]],4),[D2.fromRepresentation(new S(4,3),"counterclockwise"),D2.fromRepresentation(new S(4,3),"clockwise"),D2.fromRepresentation(new S(4,2),"counterclockwise"),D2.fromRepresentation(new S(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),ie.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,Gr.fromRepresentation([[st,st,st,st,xh,st,st,st],[st,st,st,st,RH,st,st,xh],[st,st,st,st,xh,st,st,RH],[st,SP,st,st,Jce,st,st,SP]],8),[D2.fromRepresentation(new S(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)]}}let t3e=(()=>{class n extends i8{constructor(){super(...arguments),this.SPACE_SIZE=50}getTriangleCornerCoords(e,r){return(e+r)%2==1?this.getDownwardCoordinate(e,r):this.getUpwardCoordinate(e,r)}getTriangleCoordinate(e,r){return this.getTriangleCornerCoords(e,r).map(o=>o.x+","+o.y).reduce((o,c)=>o+","+c)}getDownwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new S(.5*this.SPACE_SIZE*e,c);return[h,new S(i,u),new S(o,c),h]}getUpwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new S(.5*this.SPACE_SIZE*e,u);return[h,new S(i,c),new S(o,u),h]}getPyramidCoordinate(e,r){return(e+r)%2==1?this.getDownwardPyramidCoordinate(e,r):this.getUpwardPyramidCoordinate(e,r)}getDownwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=this.SPACE_SIZE*r,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}getUpwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=(r+1)*this.SPACE_SIZE,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275cmp=ut({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),Gm=(()=>{class n{}return n.INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`,n.NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`,n.FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`,n.CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`,n})();class mr{constructor(t,e){this.direction=t,this.str=e}static fromCoords(t,e){const r=t.getVectorToward(e),s=mr.STEPS.findIndex(i=>i.direction.equals(r));if(-1===s)throw new Error(Gm.INVALID_DISTANCE());return mr.STEPS[s]}equals(t){return this===t}toString(){return this.str}}mr.LEFT=new mr(new $t(-2,0),"LEFT"),mr.UP_LEFT=new mr(Oe.UP_LEFT,"UP_LEFT"),mr.UP_RIGHT=new mr(Oe.UP_RIGHT,"UP_RIGHT"),mr.RIGHT=new mr(new $t(2,0),"RIGHT"),mr.DOWN_LEFT=new mr(Oe.DOWN_LEFT,"DOWN_LEFT"),mr.DOWN_RIGHT=new mr(Oe.DOWN_RIGHT,"DOWN_RIGHT"),mr.STEPS=[mr.LEFT,mr.UP_LEFT,mr.UP_RIGHT,mr.RIGHT,mr.DOWN_LEFT,mr.DOWN_RIGHT];class Ir extends ji{constructor(t,e,r,s){super(),this.start=t,this.step=e,this.landingCoord=r,this.capture=s}static fromMovement(t,e){if(t.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");const r=new S(t.x+e.direction.x,t.y+e.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new Ir(y.of(t),y.of(e),y.of(r),y.empty())}static fromTilesExchange(t){if(t.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new Ir(y.empty(),y.empty(),y.empty(),y.of(t))}static fromCoordToCoord(t,e){const r=mr.fromCoords(t,e);return Ir.fromMovement(t,r)}isTileExchange(){return this.capture.isPresent()}toString(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}equals(t){return!(!this.capture.equals(t.capture)||!this.start.equals(t.start)||!this.step.equals(t.step))}}Ir.tileExchangeEncoder=xt.tuple([S.encoder],n=>[n.capture.get()],n=>Ir.fromTilesExchange(n[0])),Ir.movementEncoder=xt.tuple([S.encoder,S.encoder],n=>[n.start.get(),n.landingCoord.get()],n=>Ir.fromCoordToCoord(n[0],n[1])),Ir.encoder=xt.disjunction(Ir.tileExchangeEncoder,Ir.movementEncoder,n=>n.isTileExchange());class Vc{static getNeighbors(t){let e;const r=new S(t.x-1,t.y),s=new S(t.x+1,t.y);return e=(t.x+t.y)%2==1?[r,s,new S(t.x,t.y-1)]:[r,s,new S(t.x,t.y+1)],e}static getFakeNeighbors(t){return new S(t.x,(t.x+t.y)%2==1?t.y+1:t.y-1)}static getCommonNeighbor(t,e){const r=Vc.getNeighbors(t),s=Vc.getNeighbors(e);let i=0;for(;i<r.length;){const o=r[i];let c=0;for(;c<s.length;){if(o.equals(s[c]))return y.of(o);c++}i++}return y.empty()}static isSpaceDark(t){return(t.x+t.y)%2==0}}class x5 extends Ur{static getEmptyNeighbors(t,e,r){const s=[];for(const i of Vc.getNeighbors(e))i.isInRange(t[0].length,t.length)&&t[i.y][i.x]===r&&s.push(i);return s}getEmptyNeighbors(t,e){return x5.getEmptyNeighbors(this.board,t,e)}}class R1 extends x5{constructor(t,e,r,s){super(t,e),this.tiles=r,this.captures=s}static getTilesUpperLeftCoord(t){const e=t.x-t.x%3;let r=t.y;return r-=e%2==0?t.y%2:(t.y+1)%2,new S(e,r)}static getPresentNeighborEntrances(t){return[new S(t.x+1,t.y-1),new S(t.x+3,t.y+0),new S(t.x+3,t.y+1),new S(t.x+1,t.y+2),new S(t.x-1,t.y+1),new S(t.x-1,t.y+0)].filter(R1.isInRange)}static getInitialState(){const t=Ie.EMPTY,e=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE;return new R1([[e,e,e,e,e,e,r,t,r,e,e,e,e,e,e],[e,e,e,t,t,r,t,t,t,r,t,t,e,e,e],[t,s,t,s,t,t,r,t,r,t,t,s,t,s,t],[s,t,t,t,s,t,t,t,t,t,s,t,t,t,s],[t,s,t,s,t,t,t,t,t,t,t,s,t,s,t],[t,r,t,r,t,t,t,t,t,t,t,r,t,r,t],[r,t,t,t,r,t,t,t,t,t,r,t,t,t,r],[t,r,t,r,t,t,s,t,s,t,t,r,t,r,t],[e,e,e,t,t,s,t,t,t,s,t,t,e,e,e],[e,e,e,e,e,e,s,t,s,e,e,e,e,e,e]],0,[0,0],[0,0])}applyLegalMovement(t){J(R1.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:t}});const e=t.start.get(),r=t.landingCoord.get(),s=this.getCopiedBoard();return s[r.y][r.x]=Ie.ofPlayer(this.getCurrentPlayer()),s[e.y][e.x]=Ie.EMPTY,new R1(s,this.turn,this.tiles,this.captures)}doMovementCaptures(t){J(R1.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:t}});const e=this.getCapturedNeighbors(t.landingCoord.get());let r=this;for(const s of e)r=r.capture(s);return r}getCapturedNeighbors(t){const e=this.getCurrentOpponent();return Vc.getNeighbors(t).filter(s=>!s.isNotInRange(15,10)&&!!this.getPieceAt(s).is(e)&&this.isSurrounded(s))}isSurrounded(t){return 0===this.getEmptyNeighbors(t,Ie.EMPTY).length}capture(t){J(R1.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:t}});const e=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return J(R1.VERBOSE,t.toString()+" has been captured"),e[t.y][t.x]=Ie.EMPTY,r[this.getCurrentPlayer().value]+=1,new R1(e,this.turn,this.tiles,r)}removeTilesIfNeeded(t,e){J(R1.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:t,countTiles:e}});let r=this;const s=R1.getTilesUpperLeftCoord(t);if(this.isTileEmpty(s)&&this.isDeconnectable(s)){r=this.deconnectTile(s,e);const i=R1.getPresentNeighborEntrances(s);for(const o of i){const c=r.getPieceAt(o);c===Ie.EMPTY?r=r.removeTilesIfNeeded(o,e):c.is(this.getCurrentOpponent())&&r.isSurrounded(o)&&(r=r.capture(o))}}return r}isTileEmpty(t){Le(this.getPieceAt(t)!==Ie.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let e=0;e<2;e++)for(let r=0;r<3;r++){const s=t.getNext(new $t(r,e),1);if(this.getPieceAt(s)!==Ie.EMPTY)return!1}return!0}isDeconnectable(t){const e=this.getPresentNeighborTilesRelativeIndexes(t);if(e.length>3)return!1;let r=0;for(let s=1;s<e.length;s++)!1===this.areNeighbor(e[s-1],e[s])&&(r+=1);return!1===this.areNeighbor(e[0],e[e.length-1])&&(r+=1),r<=1}areNeighbor(t,e){return t+1===e||0===t&&5===e}getPresentNeighborTilesRelativeIndexes(t){const e=[];let r=y.empty();for(let s=0;s<6;s++){const o=t.getNext(R1.NEIGHBORS_TILES_DIRECTIONS[s],1);o.isInRange(15,10)&&this.getPieceAt(o)!==Ie.UNREACHABLE&&(r.isAbsent()&&(r=y.of(s)),e.push(s-r.get()))}return e}deconnectTile(t,e){J(R1.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:t,countTiles:e}});const r=this.getCopiedBoard(),s=t.x,i=t.y;for(let c=0;c<2;c++)for(let u=0;u<3;u++)r[i+c][s+u]=Ie.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return e&&(o[this.getCurrentPlayer().value]+=1),new R1(r,this.turn,o,this.captures)}getLegalLandings(t){const e=[];for(const r of mr.STEPS){const s=t.getNext(r.direction,1);this.isOnBoard(s)&&this.getPieceAt(s)===Ie.EMPTY&&e.push(s)}return e}getPiecesByFreedom(){const t=[[0,0,0,0],[0,0,0,0]];for(let e=0;e<10;e++)for(let r=0;r<15;r++){const s=this.board[e][r];if(s.isPlayer()){const i=this.getEmptyNeighbors(new S(r,e),Ie.EMPTY).length;t[s.value][i]=t[s.value][i]+1}}return t}}R1.VERBOSE=!1,R1.NEIGHBORS_TILES_DIRECTIONS=[new $t(0,-2),new $t(3,-1),new $t(3,1),new $t(0,2),new $t(-3,1),new $t(-3,-1)],R1.isInRange=n=>n.isInRange(15,10);class Hc extends L1{constructor(){super(R1)}static get(){return Hc.singleton.isAbsent()&&(Hc.singleton=y.of(new Hc)),Hc.singleton.get()}applyLegalMove(t,e,r){return t.isTileExchange()?this.applyLegalTileExchange(t,e):this.applyLegalMovement(t,e)}applyLegalTileExchange(t,e){const r=e.getCopiedBoard(),s=t.capture.get();r[s.y][s.x]=Ie.EMPTY;const i=[e.captures[0],e.captures[1]];i[e.getCurrentPlayer().value]+=1;const o=[e.tiles[0],e.tiles[1]];o[e.getCurrentPlayer().value]-=2;const c=new R1(r,e.turn,o,i),u=c.removeTilesIfNeeded(s,!1),h=new R1(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return J(Hc.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:e,afterCapture:c,afterTileRemoval:u,resultingState:h}}),h}applyLegalMovement(t,e){const r=e.applyLegalMovement(t),s=r.removeTilesIfNeeded(t.start.get(),!0),i=s.doMovementCaptures(t),o=new R1(i.board,e.turn+1,i.tiles,i.captures);return J(Hc.VERBOSE,{ab_state:e,afterMovement:r,afterTilesRemoved:s,afterCaptures:i,resultingState:o}),o}isLegal(t,e){return t.isTileExchange()?this.isLegalTileExchange(t,e):this.isLegalMovement(t,e)}isLegalTileExchange(t,e){if(e.tiles[e.getCurrentPlayer().value]<2)return z.failure(Gm.NOT_ENOUGH_TILES_TO_EXCHANGE());const r=e.getPieceAt(t.capture.get());return r===Ie.UNREACHABLE||r===Ie.EMPTY?z.failure(Gm.CANNOT_CAPTURE_FROM_EMPTY()):r.is(e.getCurrentPlayer())?z.failure(tt.CANNOT_SELF_CAPTURE()):z.SUCCESS}isLegalMovement(t,e){Se.assert(e.getPieceAt(t.start.get())!==Ie.UNREACHABLE,"Cannot start with a coord outside the board "+t.start.get().toString()+"."),Se.assert(e.getPieceAt(t.landingCoord.get())!==Ie.UNREACHABLE,"Cannot end with a coord outside the board "+t.landingCoord.get().toString()+".");const r=e.getPieceAt(t.start.get());return r===Ie.EMPTY?z.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r.is(e.getCurrentOpponent())?z.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):e.getPieceAt(t.landingCoord.get()).is(e.getCurrentPlayer())?z.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):z.SUCCESS}static getGameStatus(t){const e=t.gameState;return e.captures[0]>=18?xe.ZERO_WON:e.captures[1]>=18?xe.ONE_WON:xe.ONGOING}getGameStatus(t){return Hc.getGameStatus(t)}}Hc.VERBOSE=!1,Hc.singleton=y.empty();class n3e extends xs{getListMoves(t){let e=this.getListExchanges(t);return e=e.concat(this.getListMovement(t)),this.putCaptureFirst(t,e)}getListExchanges(t){const e=[],r=t.gameState,s=r.getCurrentPlayer().value,i=Ie.ofPlayer(r.getCurrentOpponent());if(r.tiles[s]<2)return e;for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new S(c,o);if(r.getPieceAt(u)===i){const h=Ir.fromTilesExchange(u);e.push(h)}}return e}getListMovement(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<10;i++)for(let o=0;o<15;o++){const c=new S(o,i);if(r.getPieceAt(c).is(s)){const u=r.getLegalLandings(c);for(const h of u){const g=Ir.fromCoordToCoord(c,h);e.push(g)}}}return e}getMetrics(t){const e=t.gameState,r=e.getPiecesByFreedom(),s=this.getPiecesScore(r);return[2*e.captures[0]+s[0],2*e.captures[1]+s[1]]}getPiecesScore(t){return[this.getPlayerPiecesScore(t[0]),this.getPlayerPiecesScore(t[1])]}getPlayerPiecesScore(t){return 3*t[0]+1*t[1]+3*t[2]+3*t[3]}putCaptureFirst(t,e){return Qe.sortByDescending(e,r=>this.moveCapturesList(t,r).length),e}moveCapturesList(t,e){return e.isTileExchange()?[e.capture.get()]:t.gameState.applyLegalMovement(e).removeTilesIfNeeded(e.start.get(),!0).getCapturedNeighbors(e.landingCoord.get())}}let q4t=(()=>{class n extends n3e{getMetrics(e){const r=e.gameState,s=this.getPiecesMap(r),i=this.getThreatMap(r,s),o=this.filterThreatMap(i,r),c=[0,0];for(const u of B.PLAYERS){for(const h of s.get(u).get())o.get(h).isPresent()?c[u.value]+=n.SCORE_BY_THREATENED_PIECE:c[u.value]+=n.SCORE_BY_SAFE_PIECE;c[u.value]+=r.tiles[u.value]}return c}getPiecesMap(e){const r=new Wn,s=[],i=[];for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new S(c,o),h=e.getPieceAt(u);h===Ie.ZERO?s.push(u):h===Ie.ONE&&i.push(u)}return r.set(B.ZERO,new Nr(s)),r.set(B.ONE,new Nr(i)),r}getThreatMap(e,r){const s=new Wn;for(const i of B.PLAYERS)for(const o of r.get(i).get()){const c=this.getThreat(o,e);c.isPresent()&&s.set(o,c.get())}return s}getThreat(e,r){const i=B.of(r.getPieceAt(e).value).getOpponent();let o=y.empty(),c=y.empty(),u=[];const h=Vc.getNeighbors(e).filter(g=>g.isInRange(15,10));for(const g of h){const m=r.getPieceAt(g);if(m.is(i))u.push(g),this.tileCouldBeRemovedThisTurn(g,r,i)&&(c=y.of(g));else if(m===Ie.EMPTY){if(o.isPresent())return y.empty();o=y.of(g)}}if(o.isPresent()){const g=[];for(const m of mr.STEPS){const E=o.get().getNext(m.direction,1);E.isInRange(15,10)&&r.getPieceAt(E).is(i)&&!1===u.some(b=>b.equals(E))&&g.push(E)}if(g.length>0)return y.of(new yP(new Nr(u),new Nr(g)))}if(c.isPresent()){u=u.filter(m=>m.equals(c.get()));const g=new Nr(u);return y.of(new yP(g,new Nr([c.get()])))}return y.empty()}tileCouldBeRemovedThisTurn(e,r,s){const i=s.getOpponent();if(!1===r.isDeconnectable(e))return!1;let c=y.empty();const u=R1.getTilesUpperLeftCoord(e);for(let h=0;h<2;h++)for(let g=0;g<3;g++){const m=u.getNext(new $t(g,h),1);if(r.getPieceAt(m).is(s)){if(!this.pieceCouldLeaveTheTile(m,r))return!1;c=y.of(m)}else if(r.getPieceAt(m).is(i))return!1}return c.isPresent()}pieceCouldLeaveTheTile(e,r){const s=R1.getTilesUpperLeftCoord(e);for(const i of mr.STEPS){const o=e.getNext(i.direction,1),c=R1.getTilesUpperLeftCoord(o);if(!1===s.equals(c)&&r.getPieceAt(o)===Ie.EMPTY)return!0}return!1}filterThreatMap(e,r){const s=new Wn,i=e.listKeys(),o=i.filter(u=>r.getPieceAt(u).is(r.getCurrentPlayer())),c=new Nr(i.filter(u=>r.getPieceAt(u).is(r.getCurrentOpponent())));for(const u of o){const h=e.get(u).get();let g=y.empty();for(const m of h.directThreats)if(!1===c.contains(m)){const E=[];for(const b of h.mover)!1===c.contains(b)&&E.push(b);E.length>0&&(g=y.of(new yP(h.directThreats,new Nr(E))))}g.isPresent()&&s.set(u,g.get())}for(const u of c){const h=e.get(u).get();s.set(u,h)}return s}}return n.SCORE_BY_THREATENED_PIECE=1e3,n.SCORE_BY_SAFE_PIECE=1e6,n})();const de=Ie.EMPTY,$=Ie.UNREACHABLE,q1=Ie.ZERO,e1=Ie.ONE;class r3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,R1.getInitialState()),ie.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,R1.getInitialState(),Ir.fromCoordToCoord(new S(3,5),new S(5,5)),$localize`Congratulations! Let's see captures now.`),ie.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new R1([[$,$,$,$,$,$,q1,de,q1,$,$,$,$,$,$],[$,$,$,q1,de,de,de,de,de,q1,de,de,$,$,$],[de,e1,de,e1,q1,e1,de,de,q1,de,de,e1,de,e1,de],[e1,de,de,de,de,de,de,de,de,de,e1,de,de,de,e1],[de,e1,de,e1,de,de,de,de,de,de,de,e1,de,e1,de],[de,q1,de,q1,de,de,de,de,de,de,de,q1,de,q1,de],[q1,de,de,de,q1,de,de,de,de,de,q1,de,de,de,q1],[de,q1,de,q1,de,de,e1,de,e1,de,de,q1,de,q1,de],[$,$,$,de,de,e1,de,de,de,e1,de,de,$,$,$],[$,$,$,$,$,$,e1,de,e1,$,$,$,$,$,$]],3,[0,0],[0,0]),[Ir.fromCoordToCoord(new S(5,2),new S(4,1)),Ir.fromCoordToCoord(new S(3,4),new S(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),ie.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new R1([[$,$,$,$,$,$,de,de,de,$,$,$,$,$,$],[$,$,$,$,$,$,e1,de,de,$,$,$,$,$,$],[de,de,de,$,$,$,de,de,de,$,$,$,$,$,$],[de,de,e1,de,de,de,de,q1,de,$,$,$,$,$,$],[de,de,de,e1,de,de,de,de,de,$,$,$,$,$,$],[de,de,de,de,de,de,de,de,de,de,de,q1,$,$,$],[de,de,q1,de,de,e1,de,de,de,de,q1,de,de,de,q1],[de,de,de,de,de,de,e1,de,e1,de,de,q1,de,q1,de],[$,$,$,de,de,e1,de,de,de,e1,de,de,$,$,$],[$,$,$,$,$,$,e1,de,e1,$,$,$,$,$,$]],2,[0,0],[0,0]),[Ir.fromCoordToCoord(new S(2,6),new S(4,6)),Ir.fromCoordToCoord(new S(2,6),new S(3,5)),Ir.fromCoordToCoord(new S(2,6),new S(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),ie.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new R1([[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,de,de,q1,$,$,$,$,$,$,$,$,$],[$,$,$,de,de,de,de,de,de,$,$,$,$,$,$],[$,$,$,de,de,de,e1,de,e1,$,$,$,$,$,$],[$,$,$,de,de,e1,de,de,de,$,$,$,$,$,$],[$,$,$,$,$,$,e1,de,e1,$,$,$,$,$,$]],1,[0,2],[0,0]),[Ir.fromTilesExchange(new S(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),ie.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new R1([[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,de,de,q1,$,$,$,$,$,$],[$,$,$,de,de,q1,de,de,de,$,$,$,$,$,$],[$,$,$,de,q1,e1,de,e1,de,$,$,$,$,$,$],[$,$,$,de,e1,q1,de,de,de,$,$,$,$,$,$],[$,$,$,de,de,e1,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$]],1,[0,0],[0,0]),[Ir.fromCoordToCoord(new S(7,6),new S(6,5)),Ir.fromCoordToCoord(new S(7,6),new S(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)]}}function W4t(n,t){if(1&n&&(F(),X(0,"polygon",10)),2&n){const e=C().index,r=C().index,s=C();w("ngClass",s.getPyramidClass(e,r)),D("points",s.getPyramidCoordinate(e,r))}}function j4t(n,t){if(1&n&&(F(),X(0,"polygon",12)),2&n){const e=C(2).index,r=C().index,s=C();Re("id","empty_",e,"_",r,""),w("ngClass",s.getEmptyClass(e,r)),D("points",s.getTriangleCoordinate(e,r))}}function Z4t(n,t){if(1&n&&(F(),x(0,j4t,1,4,"polygon",11)),2&n){const e=C().index,r=C().index;w("ngIf",C().isEmptySpace(e,r))}}function Y4t(n,t){if(1&n&&(F(),X(0,"polygon",13)),2&n){const e=C().index,r=C().index,s=C();Re("id","dark_line_",e,"_",r,""),D("points",s.getLineCoordinate(e,r))}}function K4t(n,t){if(1&n&&(F(),X(0,"polygon",14)),2&n){const e=C().index,r=C().index,s=C();Re("id","dark_line_",e,"_",r,""),D("points",s.getLineCoordinate(e,r))}}function X4t(n,t){if(1&n){const e=Ae();F(),O(0,"g",5),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),x(1,W4t,1,2,"polygon",6),x(2,Z4t,1,1,"ng-template",null,7,Gn),x(4,Y4t,1,3,"polygon",8),x(5,K4t,1,3,"polygon",9),A()}if(2&n){const e=t.$implicit,r=t.index,s=Fn(3),i=C().index,o=C();Re("id","click_",r,"_",i,""),T(1),w("ngIf",o.isPyramid(r,i))("ngIfElse",s),T(3),w("ngIf",e!==o.NONE),T(1),w("ngIf",e!==o.NONE)}}function Q4t(n,t){if(1&n&&(F(),O(0,"g"),x(1,X4t,6,6,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function J4t(n,t){if(1&n&&(F(),X(0,"polygon",17)),2&n){const e=t.$implicit;D("points",C(2).getTriangleCoordinate(e.x,e.y))}}function elt(n,t){if(1&n&&(F(),O(0,"g"),X(1,"polygon",15),x(2,J4t,1,1,"polygon",16),A()),2&n){const e=C();T(1),Re("id","selected_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y)),T(1),w("ngForOf",e.possibleLandings)}}function tlt(n,t){if(1&n&&(F(),X(0,"polygon",19)),2&n){const e=C(2);Re("id","last_start_",e.lastStart.get().x,"_",e.lastStart.get().y,""),D("points",e.getTriangleCoordinate(e.lastStart.get().x,e.lastStart.get().y))}}function nlt(n,t){if(1&n&&(F(),X(0,"polygon",19)),2&n){const e=C(2);Re("id","last_end_",e.lastEnd.get().x,"_",e.lastEnd.get().y,""),D("points",e.getTriangleCoordinate(e.lastEnd.get().x,e.lastEnd.get().y))}}function rlt(n,t){if(1&n&&(F(),x(0,tlt,1,3,"polygon",18),x(1,nlt,1,3,"polygon",18)),2&n){const e=C();w("ngIf",e.lastStart.isPresent()),T(1),w("ngIf",e.lastEnd.isPresent())}}const slt=function(n){return["base",n]};function ilt(n,t){if(1&n&&(F(),O(0,"g",21),X(1,"polygon",22),O(2,"text",23),Tt(3),A()()),2&n){const e=C().$implicit,r=C();w("id","tilesCount"+e),T(1),w("ngClass",w3(8,slt,"player"+e+"-fill")),D("points",r.getTilesCountCoordinate(0===e?0:4.5,0===e?0:6))("stroke",r.lastTurnWasTilesExchange(e)?"yellow":"black"),T(1),D("x",r.SPACE_SIZE/2+r.SPACE_SIZE*(0===e?0:6.4))("y",16+r.SPACE_SIZE/2+r.SPACE_SIZE*(0===e?0:8.5))("font-size",r.SPACE_SIZE/2),T(1),a1(r.tiles[e])}}function olt(n,t){if(1&n&&(F(),O(0,"g"),x(1,ilt,4,10,"g",20),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngIf",r.mustShowTilesOf(e))}}const alt=function(){return[0,1]};let clt=(()=>{class n extends t3e{constructor(e){super(e),this.tiles=[0,0],this.NONE=Ie.UNREACHABLE,this.chosenCoord=y.empty(),this.lastStart=y.empty(),this.lastEnd=y.empty(),this.possibleLandings=[],this.scores=y.of([0,0]),this.rules=Hc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new n3e(this.rules,"Normal"),new q4t(this.rules,"Piece > Threat > Tiles")],this.encoder=Ir.encoder,this.tutorial=(new r3e).tutorial,this.SPACE_SIZE=70,this.updateBoard()}updateBoard(){this.chosenCoord=y.empty(),this.state=this.getState(),this.scores=y.of(this.state.captures),this.tiles=this.state.tiles;const e=this.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=y.empty(),this.lastEnd=y.empty()),this.board=this.getState().board}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=y.empty(),this.possibleLandings=[]}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(o)?(s.cancelMoveAttempt(),z.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(o).is(c)?s.firstClick(o):s.secondClick(o)})()}firstClick(e){var r=this;return I(function*(){const s=r.state.getPieceAt(e);if(s.is(r.state.getCurrentOpponent())){const i=Ir.fromTilesExchange(e);return r.chooseMove(i,r.state,r.state.captures)}return s.is(r.state.getCurrentPlayer())?(r.chosenCoord=y.of(e),r.showHighlight(),z.SUCCESS):r.cancelMove(Gm.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(e){var r=this;return I(function*(){if(r.possibleLandings.some(s=>s.equals(e))){const s=Ir.fromCoordToCoord(r.chosenCoord.get(),e);return r.chooseMove(s,r.state,r.state.captures)}return r.cancelMove(Gm.INVALID_DISTANCE())})()}isPyramid(e,r){return this.board[r][e].isPlayer()||this.wasOpponent(e,r)}wasOpponent(e,r){const s=this.node.mother;return s.isPresent()&&s.get().gameState.getPieceAtXY(e,r).is(s.get().gameState.getCurrentOpponent())}getPyramidClass(e,r){const s=this.board[r][e];return s===Ie.ZERO?this.getPlayerClass(B.ZERO):s===Ie.ONE?this.getPlayerClass(B.ONE):"captured-fill"}isEmptySpace(e,r){return this.board[r][e]===Ie.EMPTY||this.wasRemoved(e,r)}wasRemoved(e,r){const i=this.node.mother;if(this.board[r][e]===Ie.UNREACHABLE&&i.isPresent()){const o=i.get().gameState.getPieceAtXY(e,r);return o===Ie.EMPTY||o.is(i.get().gameState.getCurrentPlayer())}return!1}getEmptyClass(e,r){return this.board[r][e]===Ie.EMPTY?(e+r)%2==1?"background":"background2":"captured-alternate-fill"}getTilesCountCoordinate(e,r){const s=100*e,i=100*r,o=s+25;return o+", "+i+", "+(s+75)+", "+i+", "+(s+100)+", "+(i+50)+", "+(s+75)+", "+(i+100)+", "+(s+25)+", "+(i+100)+", "+(s+0)+", "+(i+50)+", "+o+", "+i}getLineCoordinate(e,r){const s=this.getTriangleCornerCoords(e,r);return e%3==0?s[0].x+","+s[0].y+","+s[1].x+","+s[1].y:e%3==1?s[0].x+","+s[0].y+","+s[2].x+","+s[2].y:s[1].x+","+s[1].y+","+s[2].x+","+s[2].y}mustShowTilesOf(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}lastTurnWasTilesExchange(e){return!this.node.mother.isAbsent()&&this.getPreviousState().tiles[e]>this.tiles[e]}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-coerceo"]],features:[l],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptySpace",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","selected-stroke",3,"id"],["class","base no-fill selectable-stroke",4,"ngFor","ngForOf"],[1,"base","no-fill","selectable-stroke"],["class","base no-fill last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount",1,"text-giant"]],template:function(e,r){if(1&e&&(F(),O(0,"svg",0),x(1,Q4t,2,1,"g",1),x(2,elt,3,4,"g",2),x(3,rlt,2,2,"ng-template",null,3,Gn),x(5,olt,2,1,"g",1),A()),2&e){const s=Fn(4);D("viewBox","-5 -5 "+(10+8*r.SPACE_SIZE)+" "+(10+10*r.SPACE_SIZE)),T(1),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent())("ngIfElse",s),T(3),w("ngForOf",J1(5,alt))}},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class llt extends xs{getListMoves(t){return this.sortByNumberOfJump(t.gameState.turn<40?this.getListMovesDrop(t.gameState):this.getListMovesAfterDrop(t.gameState))}sortByNumberOfJump(t){return t.sort((e,r)=>{const s=e.isDrop()?1:e.isSimple()?2:e.coords.length;return(r.isDrop()?1:r.isSimple()?2:r.coords.length)-s})}getListMovesDrop(t){const e=[],r=jt.CENTRAL_ZONE_TOP_LEFT,s=jt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let i=r.y;i<=s.y;i++)for(let o=r.x;o<=s.x;o++)t.getPieceAtXY(o,i)===pe.NONE&&e.push(u8.from(new S(o,i)).get());return e}getListMovesAfterDrop(t){let e=[];const r=t.getCurrentPlayer();for(let s=0;s<jt.HEIGHT;s++)for(let i=0;i<jt.WIDTH;i++){const o=new S(i,s);t.getPieceAt(o)===r&&(e=e.concat(this.getListSimpleMoves(t,o)),e=e.concat(this.getListJumps(t,o)))}return e}getListSimpleMoves(t,e){const r=[],s=[new S(e.x+1,e.y),new S(e.x-1,e.y),new S(e.x,e.y+1),new S(e.x,e.y-1),new S(e.x+1,e.y+1),new S(e.x+1,e.y-1),new S(e.x-1,e.y+1),new S(e.x-1,e.y-1)];for(const i of s){const o=f8.from(e,i);o.isSuccess()&&rc.get().simpleMoveLegality(o.get(),t).isSuccess()&&r.push(o.get())}return r}getListJumps(t,e){const r=new bt;for(const s of rc.get().jumpTargetsFrom(e)){const i=R3.from([e,s]).get();rc.get().jumpLegality(i,t).isSuccess()&&(r.add(i),r.addAll(this.getListJumpStartingFrom(t,i)))}return r.toList()}getListJumpStartingFrom(t,e){const r=rc.get().nextJumps(e,t),s=new bt(r);for(const i of r)s.addAll(this.getListJumpStartingFrom(t,i));return s}getMetrics(t){const e=t.gameState,r=[0,0];for(let s=0;s<jt.HEIGHT;s++)for(let i=0;i<jt.WIDTH;i++){const o=new S(i,s),c=e.getPieceAt(o);if(c.isPlayer())if(e.isShelter(o))r[c.value]+=20;else{let u=100;for(const h of jt.ALL_SHELTERS)if(e.getPieceAt(h)===pe.NONE){const g=o.getOrthogonalDistance(h);u=Math.min(u,g)}r[c.value]-=u}}return r}}function ult(n,t){if(1&n){const e=Ae();F(),O(0,"rect",9),ee("click",function(){he(e);const s=C().$implicit;return le(C(2).onClick(s.coord))}),A()}if(2&n){const e=C().$implicit,r=C(2);D("x",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.x+r.STROKE_WIDTH)("y",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE-3*r.STROKE_WIDTH)("height",r.SPACE_SIZE-3*r.STROKE_WIDTH)}}function flt(n,t){if(1&n){const e=Ae();F(),O(0,"circle",6),ee("click",function(){he(e);const s=C().$implicit;return le(C(2).onClick(s.coord))}),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();Re("id","piece_",r,"_",i,""),w("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function hlt(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",6),ee("click",function(){const i=he(e).$implicit;return le(C(2).onClick(i.coord))}),A(),x(2,ult,1,4,"rect",7),x(3,flt,1,6,"circle",8),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Re("id","click_",r,"_",s,""),w("ngClass",e.squareClasses),D("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e.isShelter),T(1),w("ngIf",e.hasPiece)}}function dlt(n,t){if(1&n&&(F(),O(0,"g"),x(1,hlt,4,9,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function plt(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",10),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),w("ngClass",r.viewInfo.boardInfo[e.y][e.x].shelterClasses),D("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function glt(n,t){if(1&n&&(F(),X(0,"circle",11)),2&n){const e=t.$implicit,r=C();d1("id","sidePiece_0_",e,""),D("cx",-r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function mlt(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=t.$implicit,r=C();d1("id","sidePiece_1_",e,""),D("cx",1715+r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function _lt(n,t){if(1&n&&(F(),X(0,"rect",13)),2&n){const e=C();D("x",e.SPACE_SIZE*e.CENTRAL_ZONE_START.x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.CENTRAL_ZONE_START.y+e.STROKE_WIDTH)("width",e.CENTRAL_ZONE_SIZE.x*e.SPACE_SIZE)("height",e.CENTRAL_ZONE_SIZE.y*e.SPACE_SIZE)}}let vlt=(()=>{class n extends i8{constructor(e){super(e),this.ALL_SHELTERS=jt.ALL_SHELTERS,this.CENTRAL_ZONE_START=jt.CENTRAL_ZONE_TOP_LEFT,this.CENTRAL_ZONE_SIZE=new $t(jt.CENTRAL_ZONE_BOTTOM_RIGHT.x-jt.CENTRAL_ZONE_TOP_LEFT.x+1,jt.CENTRAL_ZONE_BOTTOM_RIGHT.y-jt.CENTRAL_ZONE_TOP_LEFT.y+1),this.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},this.selected=y.empty(),this.jumpInConstruction=y.empty(),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=rc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new llt(this.rules,"ConspirateursMinimax")],this.encoder=U4t,this.tutorial=(new Qce).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo()}updateViewInfo(){const e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let r=0;r<jt.HEIGHT;r++){this.viewInfo.boardInfo.push([]);for(let s=0;s<jt.WIDTH;s++){const i=new S(s,r),o=e.getPieceAt(i),c={coord:i,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(o)],hasPiece:o.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[r].push(c)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const e of jt.ALL_SHELTERS){const r=this.viewInfo.boardInfo[e.y][e.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const e=this.jumpInConstruction.get(),r=e.getStartingCoord(),s=e.getEndingCoord();this.viewInfo.boardInfo[r.y][r.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const i of e.coords)this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("moved-fill")}else{const e=this.selected.get();this.viewInfo.boardInfo[e.y][e.x].pieceClasses.push("selected-stroke")}}updateVictory(){const e=this.getState(),r=rc.get().getGameStatus(this.node);if(!0===r.isEndGame)for(const s of jt.ALL_SHELTERS)e.getPieceAt(s)===r.winner&&this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("victory-fill")}showLastMove(e){if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill");else if(e.isSimple())this.viewInfo.boardInfo[e.getStart().y][e.getStart().x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[e.getEnd().y][e.getEnd().x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";for(const r of e.coords)this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=y.empty(),this.selected=y.empty(),this.updateBoard()}onClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());const i=r.getState();if(i.getPieceAt(e)===r.getCurrentPlayer())return r.selected.equalsValue(e)?r.cancelMoveAttempt():(r.selected=y.of(e),r.jumpInConstruction=y.empty()),r.updateViewInfo(),z.SUCCESS;if(r.jumpInConstruction.isPresent())return r.constructJump(e);if(r.selected.isPresent())return r.selectNextCoord(e);if(i.isDropPhase()){const o=u8.from(e);return Le(o.isSuccess(),"ConspirateursMove should be valid by construction"),r.chooseMove(o.get(),i)}return r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(e){var r=this;return I(function*(){const s=r.jumpInConstruction.get(),i=r.getState();if(e.equals(s.getEndingCoord()))return r.chooseMove(s,i);{const o=s.addJump(e);if(o.isFailure())return r.cancelMove(o.getReason());const c=r.rules.jumpLegality(o.get(),i);return c.isFailure()?r.cancelMove(c.getReason()):r.updateJump(o.get())}})()}updateJump(e){var r=this;return I(function*(){const s=r.getState();return r.rules.jumpHasPossibleNextTargets(e,s)?(r.jumpInConstruction=y.of(e),r.updateViewInfo(),z.SUCCESS):r.chooseMove(e,s)})()}selectNextCoord(e){var r=this;return I(function*(){const s=r.selected.get(),i=f8.from(s,e);if(i.isSuccess())return r.chooseMove(i.get(),r.getState());{const o=R3.from([s,e]);return o.isFailure()?r.cancelMove(o.getReason()):r.updateJump(o.get())}})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-conspirateurs"]],features:[l],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,dlt,2,1,"g",1),x(2,plt,2,5,"g",1),x(3,glt,1,4,"circle",2),x(4,mlt,1,4,"circle",3),x(5,_lt,1,4,"rect",4),X(6,"polyline",5),A()),2&e&&(T(1),w("ngForOf",r.viewInfo.boardInfo),T(1),w("ngForOf",r.ALL_SHELTERS),T(1),w("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[0])),T(1),w("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[1])),T(1),w("ngIf",r.viewInfo.dropPhase),T(1),D("points",r.viewInfo.lastMoveArrow))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Clt extends xs{getListMoves(t){const e=t.gameState,r=this.getListDrops(e),s=this.getListShifts(e);return r.concat(s)}getListShifts(t){const e=[],r=this.getShiftSources(t);for(const s of r)for(const i of[new D2(s,"clockwise"),new D2(s,"counterclockwise")])H4.get().shiftHeightValidity(i,t).isSuccess()&&e.push(i);return e}getListDrops(t){const e=this.getRemainingPiecesForCurrentPlayer(t),r=[];for(let s=0;s<Gr.WIDTH;s++)for(const i of e){const o=new h8(s,i);H4.get().dropHeightValidity(o,t).isSuccess()&&r.push(o)}return r}getRemainingPiecesForCurrentPlayer(t){const e=[];for(const r of Tn.PLAYER_PIECES)this.currentPlayerCanDropPiece(t,r)&&e.push(r);return e}currentPlayerCanDropPiece(t,e){return t.getCurrentPlayer()===e.owner&&t.getRemainingPiecesOf(e)>0}getShiftSources(t){const e=[],r=t.getCurrentPlayer();for(let s=0;s<Gr.HEIGHT;s++)for(let i=0;i<Gr.WIDTH;i++)t.getPieceAtXY(i,s).owner===r&&e.push(new S(i,s));return e}getMetrics(t){return[0,0]}}function ylt(n,t){if(1&n){const e=Ae();F(),O(0,"g",6)(1,"path",7),ee("click",function(){const i=he(e).$implicit;return le(C().onSpaceClick(i))}),A(),O(2,"path",8),ee("click",function(){const i=he(e).$implicit;return le(C().onSpaceClick(i))}),A()()}if(2&n){const e=t.$implicit,r=C();d1("id","board_space_",e,""),T(1),d1("id","click_",e,""),w("ngClass",r.viewInfo.boardInfo[e].spaceClasses),D("d",r.BOARD_PATHS[e]),T(1),w("ngClass",r.viewInfo.boardInfo[e].spaceClasses),D("d",r.DECORATION_PATHS[e])}}function Elt(n,t){if(1&n){const e=Ae();F(),O(0,"g",10),ee("click",function(){const i=he(e).$implicit,o=C().$implicit;return le(C().onPieceInGameClick(o,i.y))}),X(1,"use",11)(2,"use",12),A()}if(2&n){const e=t.$implicit;Re("id","click_",C().$implicit,"_",e.y,""),w("ngClass",e.foregroundClasses),T(1),w("ngClass",e.backgroundClasses),D("x",e.drawPosition.x)("y",e.drawPosition.y),T(1),D("x",e.drawPosition.x)("y",e.drawPosition.y)}}function Mlt(n,t){if(1&n&&(F(),O(0,"g"),x(1,Elt,3,8,"g",9),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",r.viewInfo.boardInfo[e].pieces)}}function Slt(n,t){if(1&n){const e=Ae();F(),O(0,"g",14),ee("click",function(){const s=he(e),i=s.$implicit,o=s.index;return le(C(2).onRemainingPieceClick(i.actualPiece,o))}),X(1,"use",11)(2,"use",12),A()}if(2&n){const e=t.$implicit,r=t.index;Q2("id","piece_",e.actualPiece.owner.toString(),"_",e.actualPiece.otherPieceType?1:0,"_",r,""),w("ngClass",e.foregroundClasses),T(1),w("ngClass",e.backgroundClasses),D("x",e.drawPosition.x)("y",e.drawPosition.y),T(1),D("x",e.drawPosition.x)("y",e.drawPosition.y)}}function Plt(n,t){if(1&n&&(F(),O(0,"g"),x(1,Slt,3,9,"g",13),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",r.viewInfo.remainingPieces.get(e).get())}}const Tlt=function(){return[0,1,2,3,4,5,6,7]},wlt=function(){return[2,1,3,0,4,7,5,6]};class D3 extends i8{constructor(t){super(t),this.BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],this.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],this.selected=y.empty(),this.viewInfo={boardInfo:[],remainingPieces:new Wn([{key:B.ZERO,value:[]},{key:B.ONE,value:[]}])},this.rules=H4.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Clt(this.rules,"DiamDummyMinimax")],this.encoder=G4t,this.tutorial=(new e3e).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(t){var e=this;return I(function*(){const r=e.canUserPlay("#click_"+t);return r.isFailure()?e.cancelMove(r.getReason()):e.onSpaceClickAfterCheck(t)})()}onSpaceClickAfterCheck(t){var e=this;return I(function*(){if(e.selected.isPresent()){const r=e.selected.get();let s;if("pieceFromReserve"===r.type)s=new h8(t,r.piece);else if((r.position.x+1)%Gr.WIDTH===t)s=new D2(r.position,"clockwise");else{if((r.position.x+(Gr.WIDTH-1))%Gr.WIDTH!==t)return e.cancelMove(Um.MUST_SHIFT_TO_NEIGHBOR());s=new D2(r.position,"counterclockwise")}return e.chooseMove(s,e.getState())}return e.cancelMove(Um.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(t,e);return r.getState().getPieceAt(i).owner===r.getCurrentPlayer()?(r.isSelected(null,i)?r.cancelMoveAttempt():r.selected=y.of({type:"pieceFromBoard",position:i}),r.updateViewInfo(),z.SUCCESS):r.selected.isPresent()?r.onSpaceClickAfterCheck(t):r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(t,e){var r=this;return I(function*(){const s=r.canUserPlay(r.getPieceId(t,e));return s.isFailure()?r.cancelMove(s.getReason()):t.owner===r.getCurrentPlayer()?(r.selected=r.isSelected(t)?y.empty():y.of({type:"pieceFromReserve",piece:t}),r.updateViewInfo(),z.SUCCESS):r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(t,e){return"#piece_"+t.owner.toString()+"_"+(t.otherPieceType?1:0)+"_"+e}isSelected(t,e){return!this.selected.isAbsent()&&(null==t&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(e):this.selected.get().piece===t)}updateBoard(){this.updateViewInfo()}getLastMovedFromDrop(t,e){const r=this.getDrawPositionRemainingPiece(t.piece,e.getRemainingPiecesOf(t.piece)-1),s=t.getTarget(),i=e.getStackHeight(t.getTarget()),o=this.getDrawPositionOnBoard(s,i),c=new S(s,i);return[{start:y.empty(),end:c,startDrawPosition:r,endDrawPosition:o}]}getLastMovedFromShift(t,e){const r=t.start.x,s=t.getTarget();let i=e.getStackHeight(s);const o=[];for(let c=t.start.y;c<Gr.HEIGHT&&e.getPieceAtXY(r,c)!==Tn.EMPTY;c++,i++)o.push({start:y.of(new S(r,c)),end:new S(s,i),startDrawPosition:this.getDrawPositionOnBoard(r,c),endDrawPosition:this.getDrawPositionOnBoard(s,i)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let t=0;t<Gr.WIDTH;t++)this.viewInfo.boardInfo[t]={x:t,spaceClasses:[],pieces:this.getPieces(t)}}showLastMove(t){this.showLastMoveOnSpaces(t),this.showLastMoveOnPieces(t)}showLastMoveOnSpaces(t){for(let e=0;e<Gr.WIDTH;e++){const r=[];t.isDrop()?t.getTarget()===e&&r.push("moved-fill"):(t.getTarget()===e||t.start.x===e)&&r.push("moved-fill"),this.viewInfo.boardInfo[e].spaceClasses=r}}showLastMoveOnPieces(t){const e=this.getPreviousState();let r=[];r=t.isDrop()?this.getLastMovedFromDrop(t,e):this.getLastMovedFromShift(t,e);for(const s of r)this.viewInfo.boardInfo[s.end.x].pieces[s.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const t=this.getCurrentPlayer();this.viewInfo.remainingPieces=new Wn([{key:B.ZERO,value:[]},{key:B.ONE,value:[]}]);const e=this.isPlayerTurn();for(const r of Tn.PLAYER_PIECES){const s=this.getState().getRemainingPiecesOf(r);for(let i=0;i<s;i++){const o=[];this.isTopPieceOfReserveAndSelected(i,s,r)&&o.push("selected-stroke"),e&&i===s-1&&r.owner===t&&o.push("clickable-stroke-hover");const c=this.viewInfo.remainingPieces.get(r.owner).get(),u=[];u.push(r.otherPieceType?"player"+r.owner.value+"-alternate-fill":"player"+r.owner.value+"-fill"),c.push({backgroundClasses:u,foregroundClasses:o,y:i,drawPosition:this.getDrawPositionRemainingPiece(r,i),actualPiece:r}),this.viewInfo.remainingPieces.put(r.owner,c)}}}isTopPieceOfReserveAndSelected(t,e,r){if(this.selected.isPresent()){const s=this.selected.get();return"pieceFromReserve"===s.type&&s.piece===r&&t===e-1}return!1}getDrawPositionRemainingPiece(t,e){let r,s;return r=t.owner===B.ZERO?-100:600,s=t.otherPieceType?100:450,new S(r,s).getNext(new $t(0,-e*D3.PIECE_HEIGHT))}getPieces(t){const e=this.rules.findHighestAlignment(this.getState()),r=this.isPlayerTurn(),s=[];for(let i=0;i<Gr.HEIGHT;i++){const o=this.getState().getPieceAtXY(t,i),c=new S(t,i);if(o!==Tn.EMPTY){const u=[];this.pieceFromBoardIsSelected(t,i)&&u.push("selected-stroke"),this.isVictory(t,i,e)&&u.push("victory-stroke"),r&&this.rules.pieceCanMove(this.getState(),c)&&u.push("clickable-stroke-hover"),s.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:u,y:i,drawPosition:this.getDrawPositionOnBoard(t,i),actualPiece:o})}}return s}pieceFromBoardIsSelected(t,e){if(this.selected.isPresent()){const r=this.selected.get();return"pieceFromBoard"===r.type&&r.position.x===t&&r.position.y===e}return!1}isVictory(t,e,r){if(r.isPresent()){const s=r.get();return s.x%4==t%4&&s.y===e}return!1}getDrawPositionOnBoard(t,e){return D3.CENTER[t].getNext(new $t(0,-e*D3.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=y.empty(),this.updateBoard()}}D3.CENTER=[new S(40,160),new S(100,50),new S(255,2),new S(400,50),new S(460,160),new S(400,270),new S(255,320),new S(100,270)],D3.PIECE_HEIGHT=36,D3.\u0275fac=function(t){return new(t||D3)(Q(Mn))},D3.\u0275cmp=ut({type:D3,selectors:[["app-diam"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(t,e){1&t&&(F(),O(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),A()(),x(5,ylt,3,6,"g",4),x(6,Mlt,2,1,"g",5),x(7,Plt,2,1,"g",5),A()),2&t&&(T(5),w("ngForOf",J1(3,Tlt)),T(1),w("ngForOf",J1(4,wlt)),T(1),w("ngForOf",e.Player.PLAYERS))},dependencies:[pn,On],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class sc{constructor(t,e){this.offset=t,this.constant=e}static fromTwoCoords(t,e){const r=t.x,s=e.x,i=t.y,o=e.y,c=r+i,u=s+o;return r===s&&i!==o&&c!==u?y.of(sc.constantQ(r)):r!==s&&i===o&&c!==u?y.of(sc.constantR(i)):r!==s&&i!==o&&c===u?y.of(sc.constantS(c)):y.empty()}static constantQ(t){return new sc(t,"q")}static constantR(t){return new sc(t,"r")}static constantS(t){return new sc(t,"s")}static areOnSameLine(t){if(t.length<2)return!0;const e=sc.fromTwoCoords(t[0],t[1]);if(e.isAbsent())return!1;const r=e.get();for(const s of t.slice(2))if(!1===r.contains(s))return!1;return!0}toString(){return`Line(${this.constant}, ${this.offset})`}equals(t){return this===t||!(this.offset!==t.offset||this.constant!==t.constant)}contains(t){switch(this.constant){case"q":return t.x===this.offset;case"r":return t.y===this.offset;case"s":return t.x+t.y===this.offset}}getDirection(){switch(this.constant){case"q":return ze.DOWN;case"r":return ze.RIGHT;case"s":return ze.DOWN_LEFT}}}class DH extends Ur{constructor(t,e,r,s,i,o){super(e,t),this.width=r,this.height=s,this.excludedSpaces=i,this.empty=o,Le(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(t,e){if(this.isOnBoard(t))return this.setAtUnsafe(t,e);throw new Error("Setting coord not on board: "+t+".")}equalsT(t,e){if(this===t)return!0;if(this.width!==t.width||this.height!==t.height||!1===e(this.empty,t.empty)||this.excludedSpaces.length!==t.excludedSpaces.length)return!1;for(let r=0;r<this.excludedSpaces.length;r++)if(this.excludedSpaces[r]!==t.excludedSpaces[r])return!1;for(const r of this.allCoords())if(!1===e(this.getPieceAt(r),t.getPieceAt(r)))return!1;return!0}allCoords(){const t=[];return this.forEachCoord(e=>{t.push(e)}),t}allLines(){const t=[];for(let e=0;e<this.width;e++)t.push(sc.constantQ(e));for(let e=0;e<this.height;e++)t.push(sc.constantR(e));for(let e=this.excludedSpaces.length;e<this.height+this.excludedSpaces.length;e++)t.push(sc.constantS(e));return t}getEntranceOnLine(t){let e,r;switch(t.constant){case"q":return r=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new S(t.offset,r));case"r":return e=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new S(e,t.offset));case"s":return this.findEntranceFrom(t,t.offset<this.width?new S(t.offset,0):new S(this.width-1,t.offset-this.width+1))}}findEntranceFrom(t,e){const r=t.getDirection();let s=e;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(s))return s;s=s.getNext(r)}const i=As.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:e.toString(),line:t.toString()});throw new Error(i.getReason())}}class yi{static getNeighbors(t,e=1){const r=[];for(const s of ze.factory.all)r.push(t.getNext(s,e));return r}static areNeighbors(t,e){for(const r of ze.factory.all)if(t.getNext(r).equals(e))return!0;return!1}}class v1{constructor(t,e,r){this.owner=t,this.size=e,this.source=r}static append(t,e){return new v1(t.owner,t.size+e.size,t.source||e.source)}getOwner(){return this.owner}belongsTo(t){return this.owner===t}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(t){return this.owner===t.owner&&this.size===t.size&&this.source===t.source}}v1.encoder=xt.tuple([xt.identity(),B.encoder,xt.identity()],n=>[n.source,n.owner,n.size],n=>new v1(n[1],n[2],n[0])),v1.MAX_SIZE=49,v1.EMPTY=new v1(pe.NONE,0,!1),v1.UNREACHABLE=new v1(pe.NONE,-1,!1),v1.PLAYER_ZERO=new v1(B.ZERO,1,!1),v1.PLAYER_ONE=new v1(B.ONE,1,!1),v1.SOURCE=new v1(pe.NONE,1,!0);let Fc=(()=>{class n extends DH{constructor(e,r,s){super(r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,v1.EMPTY),this.alreadyPassed=s}static balancedBoard(){const e=v1.UNREACHABLE,r=v1.PLAYER_ZERO,s=v1.PLAYER_ONE,i=v1.SOURCE;return[[e,e,r,s,s,s,r,r,s,i,s],[e,s,s,r,r,r,s,s,r,s,s],[s,s,s,s,r,i,s,r,r,r,r],[r,r,s,r,r,s,s,s,r,r,e],[r,i,r,s,s,r,r,r,s,e,e]]}static isOnBoard(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==v1.UNREACHABLE}static getInitialState(){return new n(n.balancedBoard(),0,!1)}getAllPieces(){const e=[];for(let r=0;r<n.HEIGHT;r++)for(let s=0;s<n.WIDTH;s++){const i=new S(s,r);this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()&&e.push(i)}return e}numberOfNeighbors(e){return yi.getNeighbors(e,1).filter(i=>this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()).length}setAtUnsafe(e,r){const s=Qe.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.turn,this.alreadyPassed)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==v1.UNREACHABLE}}return n.WIDTH=11,n.HEIGHT=5,n.EXCLUDED_SPACES=[2,1],n})(),k5=(()=>{class n{}return n.NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`,n.EMPTY_STACK=()=>$localize`You must select a stack.`,n.TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`,n.CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`,n.INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`,n.EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`,n.MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`A stack must move in a straight line.`,n})();class qr extends c8{constructor(t,e){super(t,e)}static from(t,e){return-1===t.x&&-1===t.y&&-2===e.x&&-2===e.y?_e.success(qr.PASS):Fc.isOnBoard(t)?Fc.isOnBoard(e)?t.y===e.y||t.x===e.x||t.x+t.y===e.x+e.y?_e.success(new qr(t,e)):_e.failure(k5.MUST_MOVE_IN_STRAIGHT_LINE()):_e.failure("End coord of DvonnMove must be on the board, not at "+t.toString()):_e.failure("Starting coord of DvonnMove must be on the board, not at "+t.toString())}toString(){return this===qr.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}}qr.PASS=new qr(new S(-1,-1),new S(-2,-2)),qr.encoder=io.getFallibleEncoder(qr.from);const me=v1.EMPTY,Wr=v1.UNREACHABLE,d8=v1.SOURCE,kh=v1.PLAYER_ZERO,Lh=v1.PLAYER_ONE,blt=new v1(B.ZERO,2,!1),zH=new v1(B.ONE,2,!1),s3e=new v1(B.ZERO,4,!1),Olt=new v1(B.ONE,4,!1);class i3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Fc.getInitialState(),qr.from(new S(2,0),new S(3,0)).get(),$localize`Congratulations!`),ie.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Fc([[Wr,Wr,Lh,d8,me,me,me,me,me,me,me],[Wr,me,kh,me,me,me,me,me,me,me,me],[me,me,Olt,me,me,me,me,Lh,d8,me,me],[me,me,me,me,me,me,me,me,me,me,Wr],[me,me,me,me,me,me,me,me,me,Wr,Wr]],0,!1),qr.from(new S(2,1),new S(2,0)).get(),(t,e,r)=>t.getEnd().equals(new S(3,0))?z.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(Le(t.getEnd().equals(new S(2,0)),"player made an impossible move"),z.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),ie.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Fc([[Wr,Wr,d8,Lh,me,me,me,me,me,me,me],[Wr,kh,kh,me,me,me,me,me,me,me,me],[me,Lh,kh,Lh,me,me,kh,zH,d8,me,me],[me,me,Lh,me,me,me,me,me,me,me,Wr],[me,me,me,me,me,me,me,me,me,Wr,Wr]],0,!1),qr.from(new S(2,1),new S(2,0)).get(),(t,e,r)=>t.getEnd().equals(new S(2,0))?z.SUCCESS:z.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),ie.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Fc([[Wr,Wr,d8,me,me,me,me,me,me,me,me],[Wr,me,blt,me,me,me,me,me,me,me,me],[me,me,zH,me,me,me,me,zH,d8,s3e,me],[me,me,me,me,me,me,me,me,me,me,Wr],[me,me,me,me,me,me,me,me,me,Wr,Wr]],0,!1)),ie.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new Fc([[Wr,Wr,d8,me,me,me,me,me,me,me,me],[Wr,me,kh,me,me,me,me,me,me,me,me],[me,me,me,me,me,me,me,me,d8,s3e,me],[me,me,me,me,me,me,me,me,me,me,Wr],[me,me,me,me,me,me,me,me,me,Wr,Wr]],0,!1),[qr.from(new S(2,1),new S(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}}class gs extends L1{constructor(){super(Fc)}static get(){return gs.singleton.isAbsent()&&(gs.singleton=y.of(new gs)),gs.singleton.get()}static getGameStatus(t){const e=t.gameState,r=gs.getScores(e);return 0===gs.getMovablePieces(e).length?r[0]>r[1]?xe.ZERO_WON:r[0]<r[1]?xe.ONE_WON:xe.DRAW:xe.ONGOING}static getMovablePieces(t){return gs.getFreePieces(t).filter(e=>gs.pieceHasTarget(t,e))}static getFreePieces(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).belongsTo(t.getCurrentPlayer())&&t.numberOfNeighbors(e)<6)}static pieceHasTarget(t,e){const r=t.getPieceAt(e).getSize();return void 0!==yi.getNeighbors(e,r).find(i=>t.isOnBoard(i)&&!t.getPieceAt(i).isEmpty())}static pieceTargets(t,e){const r=t.getPieceAt(e).getSize();return yi.getNeighbors(e,r).filter(i=>t.isOnBoard(i)&&t.getPieceAt(i).hasPieces())}static getScores(t){let e=0,r=0;return t.getAllPieces().map(s=>{const i=t.getPieceAt(s);i.belongsTo(B.ZERO)?e+=i.getSize():i.belongsTo(B.ONE)&&(r+=i.getSize())}),[e,r]}isMovablePiece(t,e){Le(t.isOnBoard(e),"piece is not on the board");const r=t.getPieceAt(e);return r.getSize()<1?z.failure(k5.EMPTY_STACK()):r.belongsTo(t.getCurrentPlayer())?t.numberOfNeighbors(e)>=6?z.failure(k5.TOO_MANY_NEIGHBORS()):gs.pieceHasTarget(t,e)?z.SUCCESS:z.failure(k5.CANT_REACH_TARGET()):z.failure(k5.NOT_PLAYER_PIECE())}canOnlyPass(t){return 0===gs.getMovablePieces(t).length}sourceCoords(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).containsSource())}markPiecesConnectedTo(t,e,r){yi.getNeighbors(e,1).forEach(s=>{t.isOnBoard(s)&&!r[s.y][s.x]&&!t.getPieceAt(s).isEmpty()&&(r[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,r))})}removeDisconnectedPieces(t){const e=Qe.createTable(Fc.WIDTH,Fc.HEIGHT,!1);this.sourceCoords(t).forEach(s=>{e[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,e)});let r=t;return r.getAllPieces().forEach(s=>{e[s.y][s.x]||(r=r.setAt(s,v1.EMPTY))}),r}applyLegalMove(t,e,r){if(t===qr.PASS)return new Fc(e.board,e.turn+1,!0);{const s=e.getPieceAt(t.getStart()),i=e.getPieceAt(t.getEnd()),o=e.setAt(t.getStart(),v1.EMPTY).setAt(t.getEnd(),v1.append(s,i));return this.removeDisconnectedPieces(new Fc(o.board,e.turn+1,!1))}}isLegal(t,e){if(0===gs.getMovablePieces(e).length)return t!==qr.PASS||e.alreadyPassed?z.failure(tt.MUST_PASS()):z.SUCCESS;if(t===qr.PASS)return z.failure(tt.CANNOT_PASS());const r=this.isMovablePiece(e,t.getStart());if(r.isFailure())return r;const s=e.getPieceAt(t.getStart());return t.length()!==s.getSize()?_e.failure(k5.INVALID_MOVE_LENGTH()):e.getPieceAt(t.getEnd()).isEmpty()?_e.failure(k5.EMPTY_TARGET_STACK()):_e.success(void 0)}getGameStatus(t){return gs.getGameStatus(t)}}gs.singleton=y.empty();class o3e extends xs{getListMoves(t){const e=t.move,r=t.gameState,s=[];return gs.getMovablePieces(r).forEach(i=>gs.pieceTargets(r,i).forEach(o=>{const c=qr.from(i,o).get();s.push(c)})),0===s.length&&!1===e.equalsValue(qr.PASS)&&s.push(qr.PASS),s}getMetrics(t){return gs.getScores(t.gameState)}}class Alt extends o3e{getListMoves(t){const e=t.gameState,r=super.getListMoves(t),s=e.getCurrentPlayer().getOpponent();return Qe.sortByDescending(r,i=>{Le(i!==qr.PASS,"Cannot sort with DvonnMove.PASS");const o=e.getPieceAt(i.getEnd());return o.belongsTo(s)?o.getSize():0}),r}getMetrics(t){const e=t.gameState,r=gs.getScores(e),s=e.getAllPieces(),i=s.length;for(const o of B.PLAYERS){const c=s.filter(u=>e.getPieceAt(u).belongsTo(o)).length;r[o.value]=r[o.value]*c/i}return r}}function Nlt(n,t){if(1&n&&(F(),X(0,"circle",11)),2&n){const e=C().$implicit,r=C().$implicit,s=C();Re("id","piece_",r.x,"_",r.y,""),w("ngClass",s.getPieceClasses(e)),D("cx",s.getCenterAt(r).x)("cy",s.getCenterAt(r).y)("r",s.SPACE_SIZE)}}function Ilt(n,t){if(1&n&&(F(),X(0,"polygon",12)),2&n){const e=C().$implicit,r=C().$implicit,s=C();D("transform",1===e.getSize()?"translate("+(s.getCenterAt(r).x-18)+" "+(s.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(s.getCenterAt(r).x-3)+" "+(s.getCenterAt(r).y-12)+") scale(0.07)")}}function xlt(n,t){if(1&n){const e=Ae();F(),O(0,"text",13),ee("click",function(){he(e);const s=C(2).$implicit;return le(C().onClick(s.x,s.y))}),Tt(1),A()}if(2&n){const e=C().$implicit,r=C().$implicit,s=C();D("x",e.containsSource()?s.getCenterAt(r).x-7:s.getCenterAt(r).x)("y",s.getCenterAt(r).y),T(1),a1(e.getSize())}}function klt(n,t){if(1&n){const e=Ae();F(),O(0,"g",6),ee("click",function(){he(e);const s=C().$implicit;return le(C().onClick(s.x,s.y))}),X(1,"polygon",7),x(2,Nlt,1,6,"circle",8),x(3,Ilt,1,1,"polygon",9),x(4,xlt,2,3,"text",10),A()}if(2&n){const e=t.$implicit,r=C().$implicit,s=C();Re("id","click_",r.x,"_",r.y,""),T(1),D("points",s.getHexaPointsAt(r)),T(1),w("ngIf",e.getSize()>0),T(1),w("ngIf",e.containsSource()),T(1),w("ngIf",e.getSize()>1)}}const Llt=function(n){return[n]};function Rlt(n,t){if(1&n&&(F(),O(0,"g"),x(1,klt,5,6,"g",5),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",w3(1,Llt,r.state.getPieceAt(e)))}}function Dlt(n,t){if(1&n&&(F(),O(0,"text",18),Tt(1),A()),2&n){const e=C().$implicit,r=C();D("x",r.getCenterAt(e.coord).x)("y",r.getCenterAt(e.coord).y),T(1),a1(e.spaceContent.getSize())}}function zlt(n,t){if(1&n&&(F(),O(0,"g",14),X(1,"polygon",15)(2,"circle",16),x(3,Dlt,2,3,"text",17),A()),2&n){const e=t.$implicit,r=C();Re("id","disconnected_",e.coord.x,"_",e.coord.y,""),T(1),D("points",r.getHexaPointsAt(e.coord)),T(1),Re("id","captured_",e.coord.x,"_",e.coord.y,""),w("ngClass",r.getPieceClasses(e.spaceContent)),D("cx",r.getCenterAt(e.coord).x)("cy",r.getCenterAt(e.coord).y)("r",r.SPACE_SIZE),T(1),w("ngIf",e.spaceContent.getSize()>1)}}function Vlt(n,t){if(1&n&&(F(),hn(0),X(1,"polygon",19)(2,"polygon",19),dn()),2&n){const e=C();T(1),D("points",e.getHexaPointsAt(e.lastMove.get().getStart())),T(1),D("points",e.getHexaPointsAt(e.lastMove.get().getEnd()))}}function Hlt(n,t){if(1&n&&(F(),X(0,"polygon",20)),2&n){const e=C();Re("id","chosen_",e.chosen.get().x,"_",e.chosen.get().y,""),D("points",e.getHexaPointsAt(e.chosen.get()))}}let Flt=(()=>{class n extends Ah{constructor(e){super(e),this.lastMove=y.empty(),this.chosen=y.empty(),this.disconnecteds=[],this.rules=gs.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new o3e(this.rules,"DvonnMinimax"),new Alt(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=qr.encoder,this.tutorial=(new i3e).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=y.of(gs.getScores(this.getState())),this.hexaLayout=new Nh(1.5*this.SPACE_SIZE,new S(-this.SPACE_SIZE,2*this.SPACE_SIZE),_P.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=y.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.getState(),this.disconnecteds=[],this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=y.of(gs.getScores(this.state))}showLastMove(e){this.lastMove=y.of(e);const r=this.getPreviousState(),s=this.getState();for(let i=0;i<s.board.length;i++)for(let o=0;o<s.board[i].length;o++){const c=new S(o,i);if(!0===s.isOnBoard(c)&&!1===c.equals(this.lastMove.get().getStart())){const u=s.getPieceAt(c),h=r.getPieceAt(c);if(u.isEmpty()&&!h.isEmpty()){const m={coord:new S(o,i),spaceContent:h};this.disconnecteds.push(m)}}}}cancelMoveAttempt(){this.chosen=y.empty()}pass(){var e=this;return I(function*(){return Le(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(qr.PASS,e.getState())})()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.chosen.isAbsent()?s.choosePiece(e,r):s.chosen.equalsValue(new S(e,r))?(s.cancelMoveAttempt(),z.SUCCESS):yield s.chooseDestination(e,r)})()}choosePiece(e,r){const s=new S(e,r),i=this.rules.isMovablePiece(this.getState(),s);return i.isSuccess()?(this.chosen=y.of(s),z.SUCCESS):this.cancelMove(i.getReason())}chooseDestination(e,r){var s=this;return I(function*(){const i=s.getState(),o=s.chosen.get(),c=new S(e,r),u=qr.from(o,c);return u.isFailure()?s.rules.isMovablePiece(i,c).isSuccess()?s.choosePiece(e,r):s.cancelMove(u.getReason()):s.rules.isLegal(u.get(),i).isFailure()&&s.rules.isMovablePiece(i,c).isSuccess()?s.choosePiece(e,r):s.chooseMove(u.get(),i)})()}getPieceClasses(e){if(e.containsSource()&&1===e.getSize())return["nonplayer-fill","dashed-stroke"];const r=this.getPlayerClass(e.getOwner());return e.containsSource()?[r,"nonplayer-stroke","dashed-stroke"]:[r]}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-dvonn"]],features:[l],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,Rlt,2,3,"g",1),x(2,zlt,4,10,"g",2),x(3,Vlt,3,2,"ng-container",3),x(4,Hlt,1,3,"polygon",4),A()),2&e&&(T(1),w("ngForOf",r.state.allCoords()),T(1),w("ngForOf",r.disconnecteds),T(1),w("ngIf",r.lastMove.isPresent()),T(1),w("ngIf",r.chosen.isPresent()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();var tr=(()=>(function(n){n[n.NONE=0]="NONE",n[n.SMALL=1]="SMALL",n[n.MEDIUM=2]="MEDIUM",n[n.BIG=3]="BIG"}(tr||(tr={})),tr))();class Je{constructor(t){this.value=t}static of(t){switch(t){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+t+" for EncapsulePiece")}}static ofSizeAndPlayer(t,e){return e===B.ZERO&&t===tr.BIG?Je.BIG_DARK:e===B.ZERO&&t===tr.MEDIUM?Je.MEDIUM_DARK:e===B.ZERO&&t===tr.SMALL?Je.SMALL_DARK:e===B.ONE&&t===tr.BIG?Je.BIG_LIGHT:e===B.ONE&&t===tr.MEDIUM?Je.MEDIUM_LIGHT:e===B.ONE&&t===tr.SMALL?Je.SMALL_LIGHT:Je.NONE}getPlayer(){switch(this){case Je.SMALL_DARK:case Je.MEDIUM_DARK:case Je.BIG_DARK:return B.ZERO;case Je.SMALL_LIGHT:case Je.MEDIUM_LIGHT:case Je.BIG_LIGHT:return B.ONE;default:return pe.NONE}}getSize(){switch(this){case Je.BIG_DARK:case Je.BIG_LIGHT:return tr.BIG;case Je.MEDIUM_DARK:case Je.MEDIUM_LIGHT:return tr.MEDIUM;case Je.SMALL_DARK:case Je.SMALL_LIGHT:return tr.SMALL;default:return Se.expectToBe(this,Je.NONE),tr.NONE}}belongsTo(t){return this.getPlayer()===t}equals(t){return this===t}toString(){switch(this){case Je.BIG_DARK:return"BIG_DARK";case Je.BIG_LIGHT:return"BIG_LIGHT";case Je.MEDIUM_DARK:return"MEDIUM_DARK";case Je.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case Je.SMALL_DARK:return"SMALL_DARK";case Je.SMALL_LIGHT:return"SMALL_LIGHT";default:return Se.expectToBe(this,Je.NONE),"EMPTY"}}}Je.encoder=new class extends R4{encode(n){return n.value}decode(n){return Je.of(n)}},Je.SMALL_DARK=new Je(0),Je.SMALL_LIGHT=new Je(1),Je.MEDIUM_DARK=new Je(2),Je.MEDIUM_LIGHT=new Je(3),Je.BIG_DARK=new Je(4),Je.BIG_LIGHT=new Je(5),Je.NONE=new Je(6);class p8 extends Ur{constructor(t,e,r){super(t,e),this.remainingPieces=r}static getInitialState(){const t=new Ki(pe.NONE,pe.NONE,pe.NONE),e=Qe.createTable(3,3,t);return new p8(e,0,[Je.BIG_DARK,Je.BIG_DARK,Je.BIG_LIGHT,Je.BIG_LIGHT,Je.MEDIUM_DARK,Je.MEDIUM_DARK,Je.MEDIUM_LIGHT,Je.MEDIUM_LIGHT,Je.SMALL_DARK,Je.SMALL_DARK,Je.SMALL_LIGHT,Je.SMALL_LIGHT])}getRemainingPieces(){return Qe.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(t){return this.getRemainingPieces().filter(e=>e.getPlayer()===t)}pieceBelongsToCurrentPlayer(t){return t.belongsTo(this.getCurrentPlayer())}isDroppable(t){return this.pieceBelongsToCurrentPlayer(t)&&this.isInRemainingPieces(t)}isInRemainingPieces(t){return this.remainingPieces.some(e=>e===t)}getPlayerRemainingPieces(){return this.remainingPieces.filter(t=>this.pieceBelongsToCurrentPlayer(t))}}class Ki{constructor(t,e,r){this.small=t,this.medium=e,this.big=r}isEmpty(){return this.small===pe.NONE&&this.medium===pe.NONE&&this.big===pe.NONE}toList(){const t=[];return this.small.isPlayer()&&t.push(Je.ofSizeAndPlayer(tr.SMALL,this.small)),this.medium.isPlayer()&&t.push(Je.ofSizeAndPlayer(tr.MEDIUM,this.medium)),this.big.isPlayer()&&t.push(Je.ofSizeAndPlayer(tr.BIG,this.big)),t}toOrderedPieceNames(){const t=Je.ofSizeAndPlayer(tr.SMALL,this.small),e=Je.ofSizeAndPlayer(tr.MEDIUM,this.medium),r=Je.ofSizeAndPlayer(tr.BIG,this.big);return[t.toString(),e.toString(),r.toString()]}getBiggest(){return this.big===B.ZERO?Je.BIG_DARK:this.big===B.ONE?Je.BIG_LIGHT:this.medium===B.ZERO?Je.MEDIUM_DARK:this.medium===B.ONE?Je.MEDIUM_LIGHT:this.small===B.ZERO?Je.SMALL_DARK:this.small===B.ONE?Je.SMALL_LIGHT:Je.NONE}tryToSuperposePiece(t){const e=this.getBiggest().getSize();if(t===Je.NONE)throw new Error("Cannot move EMPTY on a space");return t.getSize()>e?y.of(this.put(t)):y.empty()}removeBiggest(){const t=this.getBiggest();if(t===Je.NONE)throw new Error("Cannot removed piece from empty space");let e;const r=t.getSize();switch(r){case tr.BIG:e=new Ki(this.small,this.medium,pe.NONE);break;case tr.MEDIUM:e=new Ki(this.small,pe.NONE,pe.NONE);break;default:Se.expectToBe(r,tr.SMALL),e=new Ki(pe.NONE,pe.NONE,pe.NONE)}return{removedSpace:e,removedPiece:t}}put(t){if(t===Je.NONE)throw new Error("Cannot put NONE on space");const e=t.getPlayer(),r=t.getSize();switch(r){case tr.BIG:return new Ki(this.small,this.medium,e);case tr.MEDIUM:return Le(this.big===pe.NONE,"Cannot put a piece on top of a bigger one"),new Ki(this.small,e,this.big);default:return Se.expectToBe(r,tr.SMALL),Le(this.big===pe.NONE,"Cannot put a piece on top of a bigger one"),Le(this.medium===pe.NONE,"Cannot put a piece on top of a bigger one"),new Ki(e,this.medium,this.big)}}encode(){return this.small.value+3*this.medium.value+9*this.big.value}belongsTo(t){return this.getBiggest().getPlayer()===t}toString(){const t=this.toOrderedPieceNames();return"("+t[0]+", "+t[1]+", "+t[2]+")"}}Ki.EMPTY=new Ki(pe.NONE,pe.NONE,pe.NONE);let qm=(()=>{class n{}return n.PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`,n.INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`,n.NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`,n.INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`,n.END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`,n})();class oo extends L1{constructor(){super(p8)}static get(){return oo.singleton.isAbsent()&&(oo.singleton=y.of(new oo)),oo.singleton.get()}static isVictory(t){const e=t.getCopiedBoard();for(const r of oo.LINES){const i=oo.isVictoriousLine([e[r[0].y][r[0].x],e[r[1].y][r[1].x],e[r[2].y][r[2].x]]);if(i.isPresent())return i}return y.empty()}static isVictoriousLine(t){const r=t.map(s=>s.getBiggest()).map(s=>s.getPlayer());return r[0]===pe.NONE?y.empty():r[0]===r[1]&&r[1]===r[2]?y.of(r[0]):y.empty()}static isLegal(t,e){let s;if(J(!1,t.toString()),t.isDropping()){if(s=t.piece.get(),!1===e.pieceBelongsToCurrentPlayer(s))return _e.failure(tt.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.isInRemainingPieces(s))return _e.failure(qm.PIECE_OUT_OF_STOCK())}else{const c=t.startingCoord.get();if(s=e.getPieceAt(c).getBiggest(),!1===e.pieceBelongsToCurrentPlayer(s))return _e.failure(tt.MUST_CHOOSE_PLAYER_PIECE())}const o=e.getPieceAt(t.landingCoord).tryToSuperposePiece(s);return o.isPresent()?_e.success(o.get()):_e.failure(qm.INVALID_PLACEMENT())}isLegal(t,e){return oo.isLegal(t,e)}applyLegalMove(t,e,r){const s=e.getCopiedBoard();let i=e.getRemainingPieces();const o=e.turn+1;let c;if(s[t.landingCoord.y][t.landingCoord.x]=r,t.isDropping()){c=t.piece.get();const h=i.indexOf(c);i=i.slice(0,h).concat(i.slice(h+1))}else{const h=t.startingCoord.get(),m=s[h.y][h.x].removeBiggest();s[h.y][h.x]=m.removedSpace,c=m.removedPiece}return new p8(s,o,i)}static getGameStatus(t){const r=oo.isVictory(t.gameState);return r.isPresent()?xe.getVictory(r.get()):xe.ONGOING}getGameStatus(t){return oo.getGameStatus(t)}}oo.singleton=y.empty(),oo.LINES=[[new S(0,0),new S(0,1),new S(0,2)],[new S(1,0),new S(1,1),new S(1,2)],[new S(2,0),new S(2,1),new S(2,2)],[new S(0,0),new S(1,0),new S(2,0)],[new S(0,1),new S(1,1),new S(2,1)],[new S(0,2),new S(1,2),new S(2,2)],[new S(0,0),new S(1,1),new S(2,2)],[new S(0,2),new S(1,1),new S(2,0)]];class Ei extends ji{constructor(t,e,r){super(),this.startingCoord=t,this.landingCoord=e,this.piece=r}static fromMove(t,e){if(t.equals(e))throw new Error("Starting coord and landing coord must be separate coords");return new Ei(y.of(t),e,y.empty())}static fromDrop(t,e){return new Ei(y.empty(),e,y.of(t))}isDropping(){return this.startingCoord.isAbsent()}equals(t){return this===t||!1!==t.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(t.startingCoord)&&this.piece.equals(t.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}Ei.encoder=xt.tuple([y.getEncoder(S.encoder),S.encoder,y.getEncoder(Je.encoder)],n=>[n.startingCoord,n.landingCoord,n.piece],n=>new Ei(n[0],n[1],n[2]));class Blt extends xs{getMetrics(t){return[0,0]}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getCurrentPlayer(),o=Bce.toComparableObjectSet(r.getPlayerRemainingPieces());for(let c=0;c<3;c++)for(let u=0;u<3;u++){const h=new S(u,c);for(const g of o){const m=Ei.fromDrop(g,h);oo.isLegal(m,r).isSuccess()&&e.push(m)}if(s[c][u].belongsTo(i))for(let g=0;g<3;g++)for(let m=0;m<3;m++){const E=new S(m,g);if(!E.equals(h)){const b=Ei.fromMove(h,E);oo.isLegal(b,r).isSuccess()&&e.push(b)}}}return e}}const $o=new Ki(pe.NONE,pe.NONE,pe.NONE),a3e=new Ki(B.ZERO,pe.NONE,pe.NONE),$lt=new Ki(pe.NONE,B.ZERO,pe.NONE),Ult=new Ki(pe.NONE,pe.NONE,B.ZERO),c3e=new Ki(B.ONE,pe.NONE,pe.NONE),PP=new Ki(pe.NONE,pe.NONE,B.ONE),Glt=new Ki(B.ONE,B.ZERO,pe.NONE),qlt=new Ki(B.ZERO,B.ZERO,pe.NONE);class l3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new p8([[a3e,c3e,PP],[$o,$lt,$o],[$o,$o,Ult]],0,[Je.SMALL_DARK,Je.MEDIUM_DARK,Je.BIG_DARK,Je.SMALL_LIGHT,Je.MEDIUM_LIGHT,Je.MEDIUM_LIGHT,Je.BIG_LIGHT])),ie.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,p8.getInitialState(),Ei.fromDrop(Je.SMALL_DARK,new S(1,1)),$localize`Congratulations!`),ie.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new p8([[a3e,PP,$o],[$o,$o,$o],[$o,$o,$o]],0,[]),[Ei.fromMove(new S(0,0),new S(2,0)),Ei.fromMove(new S(0,0),new S(0,1)),Ei.fromMove(new S(0,0),new S(1,1)),Ei.fromMove(new S(0,0),new S(2,1)),Ei.fromMove(new S(0,0),new S(0,2)),Ei.fromMove(new S(0,0),new S(1,2)),Ei.fromMove(new S(0,0),new S(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new p8([[Glt,$o,c3e],[qlt,PP,PP],[$o,$o,$o]],0,[Je.MEDIUM_DARK,Je.BIG_DARK,Je.MEDIUM_LIGHT,Je.MEDIUM_LIGHT]),Ei.fromMove(new S(0,1),new S(0,2)),(t,e,r)=>{if(t.landingCoord.equals(new S(0,2))){if(t.isDropping())return z.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new S(0,1)))return z.SUCCESS}return z.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)]}}function Wlt(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"circle",5),ee("click",function(){const s=he(e),i=s.$implicit,o=s.index,c=C().$implicit;return le(C().onPieceClick(c.value,i,o))}),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().$implicit,i=C();T(1),Q2("id","piece_",s.value,"_",e.toString(),"_",r,""),w("ngClass",i.getSidePieceClasses(e,r)),D("transform","rotate("+180*(i.role.value+s.value)+" "+i.CENTER+" "+i.CENTER+")")("r",i.getPieceRadius(e))("cx",i.getRemainingPieceCenterCoord(s,r).x)("cy",i.getRemainingPieceCenterCoord(s,r).y)}}function jlt(n,t){if(1&n&&(F(),O(0,"g",null,4),x(2,Wlt,2,8,"g",1),A()),2&n){const e=t.$implicit,r=C();T(2),w("ngForOf",r.getRemainingPieces(e))}}function Zlt(n,t){if(1&n){const e=Ae();F(),O(0,"circle",8),ee("click",function(){he(e);const s=C().index,i=C().index;return le(C().onBoardClick(s,i))}),A()}if(2&n){const e=t.$implicit,r=C().index,s=C().index,i=C();w("ngClass",i.getPieceClasses(e)),D("r",i.getPieceRadius(e))("cx",i.getPieceCenter(r))("cy",i.getPieceCenter(s))}}function Ylt(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",6),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onBoardClick(i,o))}),A(),x(2,Zlt,1,4,"circle",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Re("id","click_",r,"_",s,""),w("ngClass",i.getRectClasses(r,s)),D("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngForOf",i.getListPieces(e))}}function Klt(n,t){if(1&n&&(F(),O(0,"g"),x(1,Ylt,3,8,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function Xlt(n,t){if(1&n){const e=Ae();F(),O(0,"rect",9),ee("click",function(){he(e);const s=C();return le(s.onBoardClick(s.chosenCoord.get().x,s.chosenCoord.get().y))}),A()}if(2&n){const e=C();Re("id","chosenCoord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("x",e.SPACE_SIZE*e.chosenCoord.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.chosenCoord.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}let Qlt=(()=>{class n extends Ho{constructor(e){super(e),this.CENTER=this.getPieceCenter(1),this.UPLEFT=-(this.SPACE_SIZE+.5*this.STROKE_WIDTH),this.WIDTH=5*this.SPACE_SIZE+3*this.STROKE_WIDTH,this.lastLandingCoord=y.empty(),this.lastStartingCoord=y.empty(),this.chosenCoord=y.empty(),this.chosenPiece=y.empty(),this.remainingPieceCenterCoords=new Wn,this.rules=oo.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Blt(this.rules,"EncapsuleMinimax")],this.encoder=Ei.encoder,this.tutorial=(new l3e).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard();const r=this.node.move;this.calculateLeftPieceCoords(),r.isPresent()?(this.lastLandingCoord=y.of(r.get().landingCoord),this.lastStartingCoord=r.get().startingCoord):(this.lastLandingCoord=y.empty(),this.lastStartingCoord=y.empty())}getListPieces(e){return e.toList()}getRemainingPieces(e){return this.getState().getRemainingPiecesOfPlayer(e)}onBoardClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=y.of(o),s.chosenPiece.isPresent()){const u=Ei.fromDrop(s.chosenPiece.get(),o);return s.chooseMove(u,s.getState())}return!1===c.getPieceAt(o).belongsTo(c.getCurrentPlayer())?s.cancelMove(qm.INVALID_PIECE_SELECTED()):z.SUCCESS}if(s.chosenCoord.equalsValue(o))return s.cancelMoveAttempt(),z.SUCCESS;{const u=Ei.fromMove(s.chosenCoord.get(),o);return s.chooseMove(u,s.getState())}})()}cancelMoveAttempt(){this.chosenCoord=y.empty(),this.chosenPiece=y.empty(),this.chosenPieceIndex=y.empty()}onPieceClick(e,r,s){var i=this;return I(function*(){const o="#piece_"+e+"_"+r.toString()+"_"+s,c=i.canUserPlay(o);return c.isFailure()?i.cancelMove(c.getReason()):!1===i.getState().isDroppable(r)?i.cancelMove(qm.NOT_DROPPABLE()):i.chosenCoord.isAbsent()?(i.chosenPiece.equalsValue(r)&&i.chosenPieceIndex.equalsValue(s)?(i.chosenPiece=y.empty(),i.chosenPieceIndex=y.empty()):(i.chosenPiece=y.of(r),i.chosenPieceIndex=y.of(s)),z.SUCCESS):i.cancelMove(qm.END_YOUR_MOVE())})()}getRectClasses(e,r){return this.isSelected(e,r)?"moved-fill":""}isSelected(e,r){const s=new S(e,r);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(e){return[this.getPieceStrokeClass(e)]}getPieceCenter(e){return this.SPACE_SIZE*e+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(e){const r=e.getPlayer();return Le(r.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+r.value+"-stroke"}getPieceRadius(e){switch(e.getSize()){case tr.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case tr.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return Se.expectToBe(e.getSize(),tr.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(e,r){const s=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(r)&&s.push("selected-stroke"),s}isSelectedPiece(e){return this.chosenPiece.equalsValue(e)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new Wn;for(const e of B.PLAYERS){const r=[],s=this.getRemainingPieces(e);for(let i=0;i<s.length;i++){let o,c=0,u=0;i<=2?(o=new S(2-i,3),u=this.STROKE_WIDTH):(o=new S(-1,5-i),c=-this.STROKE_WIDTH);const h=this.getPieceCenter(o.x),g=this.getPieceCenter(o.y);r.push(new S(h+c,g+u))}this.remainingPieceCenterCoords.set(e,r)}}getRemainingPieceCenterCoord(e,r){return this.remainingPieceCenterCoords.get(e).get()[r]}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-encapsule"]],features:[l],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,jlt,3,1,"g",1),O(2,"g",null,2),x(4,Klt,2,1,"g",1),x(5,Xlt,1,6,"rect",3),A()()),2&e&&(D("viewBox",r.UPLEFT+" "+r.UPLEFT+" "+r.WIDTH+" "+r.WIDTH),T(1),w("ngForOf",r.Player.PLAYERS),T(3),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Bc extends Ks{constructor(t,e,r,s,i){if(super(t,e),this.movedPieces=r,this.stepSize=s,this.direction=i,this.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+this.coord.toString()+".");if(r<1)throw new Error("Must select minimum one piece (got "+r+").");if(s<1)throw new Error("Step size must be minimum one (got "+s+").");if(s>r)throw new Error("Cannot move a phalanx further than its size (got step size "+s+" for "+r+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(t){return this===t||!(!this.coord.equals(t.coord)||this.movedPieces!==t.movedPieces||this.stepSize!==t.stepSize)&&this.direction.equals(t.direction)}}Bc.encoder=xt.tuple([S.encoder,xt.identity(),xt.identity(),Oe.encoder],n=>[n.coord,n.movedPieces,n.stepSize,n.direction],n=>new Bc(n[0].x,n[0].y,n[1],n[2],n[3]));class F4 extends Ur{static getInitialState(){const t=pe.NONE,e=pe.ZERO,r=pe.ONE;return new F4([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e]],0)}count(t,e){let r=0;for(let s=0;s<14;s++)this.board[e][s]===t&&r++;return r}doesOwnPiece(t){for(let e=0;e<12;e++)for(let r=0;r<14;r++)if(this.board[e][r]===t)return!0;return!1}}let $c=(()=>{class n{}return n.PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`,n.SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`,n.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`,n.SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`,n.SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`,n.SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`,n.SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`,n.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`,n.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`,n.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`,n})();class ic extends L1{constructor(){super(F4)}static get(){return ic.singleton.isAbsent()&&(ic.singleton=y.of(new ic)),ic.singleton.get()}static isLegal(t,e){const r=this.getPhalanxValidity(e,t);if(r.isFailure())return _e.failure(r.getReason());const s=this.getLandingStatus(e,t);if(s.isFailure())return s;const i=Qe.copyBiArray(s.get()),o=e.getCurrentOpponent(),c=ic.getCaptureValidity(e,i,t,o);return c.isFailure()?c:_e.success(c.get())}static getPhalanxValidity(t,e){let r=e.coord,s=0;const i=t.getCurrentOpponent();for(;s<e.movedPieces;){if(r.isNotInRange(14,12))return z.failure($c.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=t.getPieceAt(r);if(o===pe.NONE)return z.failure($c.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===i)return z.failure($c.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());r=r.getNext(e.direction,1),s++}return z.SUCCESS}static getLandingStatus(t,e){const r=t.getCopiedBoard(),s=t.getCurrentPlayer();let i=e.coord,o=e.coord.getNext(e.direction,e.movedPieces),c=0;for(;c+1<e.stepSize;){if(r[i.y][i.x]=pe.NONE,r[o.y][o.x]=s,o.isNotInRange(14,12))return _e.failure($c.PHALANX_IS_LEAVING_BOARD());if(t.getPieceAt(o).isPlayer())return _e.failure($c.SOMETHING_IN_PHALANX_WAY());c++,o=o.getNext(e.direction,1),i=i.getNext(e.direction,1)}return o.isNotInRange(14,12)?_e.failure($c.PHALANX_IS_LEAVING_BOARD()):t.getPieceAt(o)===s?_e.failure(tt.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(r[i.y][i.x]=pe.NONE,r[o.y][o.x]=s,_e.success(r))}static getCaptureValidity(t,e,r,s){let i=r.coord.getNext(r.direction,r.movedPieces+r.stepSize-1),o=0;for(;i.isInRange(14,12)&&t.getPieceAt(i)===s;){if(o>0&&(e[i.y][i.x]=pe.NONE),o++,o>=r.movedPieces)return _e.failure($c.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(r.direction,1)}return _e.success(e)}isLegal(t,e){return ic.isLegal(t,e)}applyLegalMove(t,e,r){return new F4(r,e.turn+1)}getGameStatus(t){const e=t.gameState,r=e.count(B.ZERO,0),s=e.count(B.ONE,11);if(e.turn%2==0){if(r>s)return xe.ZERO_WON}else if(s>r)return xe.ONE_WON;return!1===e.doesOwnPiece(B.ZERO)?xe.ONE_WON:!1===e.doesOwnPiece(B.ONE)?xe.ZERO_WON:xe.ONGOING}}ic.singleton=y.empty();class Wm extends Dc{static getListMoves(t){const e=t.gameState.getCurrentPlayer(),r=t.gameState.getCurrentOpponent(),s=pe.NONE;let i=[];const o=t.gameState;let c;for(let u=0;u<12;u++)for(let h=0;h<14;h++){const g=new S(h,u);if(o.getPieceAt(g)===e)for(const m of Oe.DIRECTIONS){let E=1,b=g.getNext(m,1);for(;b.isInRange(14,12)&&o.getPieceAt(b)===e;)E+=1,b=b.getNext(m,1);let k=1;for(;b.isInRange(14,12)&&k<=E&&o.getPieceAt(b)===s;)c=new Bc(h,u,E,k,m),i=this.addMove(i,c,o),k++,b=b.getNext(m,1);b.isInRange(14,12)&&k<=E&&o.getPieceAt(b)===r&&(c=new Bc(h,u,E,k,m),i=this.addMove(i,c,o))}}return i}static addMove(t,e,r){return ic.isLegal(e,r).isSuccess()&&t.push(e),t}getListMoves(t){const e=Wm.getListMoves(t);return Qe.sortByDescending(e,r=>r.stepSize),e}getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?e.toBoardValue():new M1(this.getPieceCountPlusRowDomination(t.gameState))}getPieceCountPlusRowDomination(t){let o=0;for(let c=0;c<12;c++){let u=0;const h=[0,0];for(let g=0;g<14;g++){const m=new S(g,c),E=t.getPieceAt(m);if(E.isPlayer()){const b=E.getScoreModifier();o+=2002*b,h[E.value]=b,u+=b;for(const k of[Oe.UP_LEFT,Oe.UP,Oe.UP_RIGHT]){let U=m.getNext(k,1);for(;U.isInRange(14,12)&&t.getPieceAt(U)===E;)o+=1*b,U=U.getNext(k,1)}}}0!==u&&(o+=Math.abs(u)/u*2),o+=1*h.reduce((g,m)=>g+m)}return o}}class Jlt extends Dc{getListMoves(t){const e=Wm.getListMoves(t);return this.orderMovesByPhalanxSizeAndFilter(e,t.gameState)}orderMovesByPhalanxSizeAndFilter(t,e){return Qe.sortByDescending(t,r=>r.movedPieces),t.length>40?t.filter(s=>!!this.moveIsCapture(s,e)||s.movedPieces*Math.random()>1):t}moveIsCapture(t,e){const r=t.coord.getNext(t.direction,t.movedPieces+t.stepSize-1);return e.board[r.y][r.x]===e.getCurrentOpponent()}getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?e.toBoardValue():new M1(this.getPieceCountThenSupportThenAdvancement(t.gameState))}getPieceCountThenSupportThenAdvancement(t){let o=0;for(let c=0;c<12;c++)for(let u=0;u<14;u++){const h=new S(u,c),g=t.getPieceAt(h);if(g.isPlayer()){let m,E;g===B.ZERO?(m=12-c,E=[Oe.UP_LEFT,Oe.UP,Oe.UP_RIGHT]):(m=c+1,E=[Oe.DOWN_LEFT,Oe.DOWN,Oe.DOWN_RIGHT]);const b=g.getScoreModifier();o+=m*b,o+=149629*b;for(const k of E){let U=h.getNext(k,1);for(;U.isInRange(14,12)&&t.getPieceAt(U)===g;)o+=337*b,U=U.getNext(k,1)}}}return o}}class e6t extends Wm{constructor(){super(...arguments),this.DOMINANCE_FACTOR=20,this.DEFENSE_FACTOR=5,this.TERRITORY_FACTOR=2,this.OFFENSE_FACTOR=10,this.CENTER_FACTOR=5,this.MOBILITY_FACTOR=.12}getDominance(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new S(s,r));i.isPlayer()&&(e+=i.getScoreModifier())}return e*this.DOMINANCE_FACTOR}getDefense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new S(r,11))===B.ZERO&&(e+=B.ZERO.getScoreModifier()),t.getPieceAt(new S(r,0))===B.ONE&&(e+=B.ONE.getScoreModifier());return e*this.DEFENSE_FACTOR}getTerritory(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new S(s,r));if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let c=-1;c<=1;c++){const u=new S(s+o,r+c);if(u.isInRange(14,12)){const h=t.getPieceAt(u);(h===i||h===pe.NONE)&&(e+=1*i.getScoreModifier())}}e-=i.getScoreModifier()}}return e*this.TERRITORY_FACTOR}getOffense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new S(r,0))===B.ZERO&&(e+=B.ZERO.getScoreModifier()),t.getPieceAt(new S(r,11))===B.ONE&&(e+=B.ONE.getScoreModifier());return e*this.OFFENSE_FACTOR}getCenter(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new S(s,r));i.isPlayer()&&(e+=i.getScoreModifier()*Math.sqrt((s-6.5)*(s-6.5)))}return e*this.CENTER_FACTOR}getMobility(t){let e=0,r=0,s=0;for(let i=0;i<12;i++)for(let o=0;o<14;o++){const c=new S(o,i),u=t.getPieceAt(c);if(u.isPlayer())for(const h of Oe.DIRECTIONS){let g=1,m=c.getNext(h,1);for(;m.isInRange(14,12)&&t.getPieceAt(m)===u;)g+=1,m=m.getNext(h,1);let E=1;for(;m.isInRange(14,12)&&E<=g&&t.getPieceAt(m)===pe.NONE;)E++,m=m.getNext(h,1);e+=E*E*u.getScoreModifier(),u===B.ZERO?r=Math.max(r,E):u===B.ONE&&(s=Math.max(s,E))}}return(e+r*B.ZERO.getScoreModifier()+s*B.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(t){const e=t.gameState,r=this.ruler.getGameStatus(t);if(r.isEndGame)return r.toBoardValue();const s=this.getDominance(e),i=this.getDefense(e),o=this.getTerritory(e),c=this.getCenter(e),u=this.getOffense(e),h=this.getMobility(e);return new M1(s+i+o+c+u+h)}}const L=pe.NONE,xr=pe.ZERO,W1=pe.ONE;class u3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,F4.getInitialState()),ie.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new F4([[L,L,L,L,L,xr,L,L,W1,W1,W1,W1,W1,W1],[L,L,L,L,L,xr,L,L,L,L,L,L,W1,W1],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,W1,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,xr,xr,xr,xr,L,L,L]],0)),ie.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new F4([[L,L,L,L,L,xr,L,L,L,L,W1,W1,W1,W1],[L,L,L,L,L,xr,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,W1,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,W1,W1,L,L,L,xr,xr,L,xr,xr,xr,xr]],1)),ie.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,F4.getInitialState(),new Bc(0,10,1,1,Oe.UP),(t,e,r)=>1===t.movedPieces?z.SUCCESS:z.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),ie.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,F4.getInitialState(),new Bc(0,11,2,1,Oe.UP),(t,e,r)=>t.movedPieces>1?z.SUCCESS:z.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),ie.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new F4([[L,L,L,L,L,L,L,L,W1,W1,W1,W1,W1,W1],[L,L,L,L,L,L,W1,L,L,L,L,L,L,L],[L,L,L,L,L,W1,L,L,L,L,L,L,L,L],[L,L,W1,L,W1,L,L,L,L,L,L,L,L,L],[L,L,W1,W1,L,L,L,L,L,L,L,L,L,L],[L,L,W1,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,xr,L,L,L,L,L,L,L,L,L,L,L],[L,L,xr,L,L,L,L,W1,L,L,L,L,L,L],[L,L,xr,L,L,L,L,L,L,L,L,L,L,L],[L,L,xr,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,xr,xr,xr,xr,xr,xr,xr]],0),[new Bc(2,10,4,2,Oe.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}}function t6t(n,t){if(1&n){const e=Ae();F(),O(0,"circle",4),ee("click",function(){he(e);const s=C().index,i=C().index;return le(C().onClick(s,i))}),A()}if(2&n){const e=C().index,r=C().index,s=C();w("ngClass",s.getPieceClasses(e,r)),D("cx",s.SPACE_SIZE*e+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.STROKE_WIDTH+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function n6t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",2),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),A(),x(2,t6t,1,4,"circle",3),A()}if(2&n){const e=t.index,r=C().index,s=C();T(1),Re("id","click_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),D("x",s.SPACE_SIZE*e+s.STROKE_WIDTH)("y",s.SPACE_SIZE*r+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][e]!==s.NONE)}}function r6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,n6t,3,8,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function s6t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",5),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),D("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let i6t=(()=>{class n extends Ho{constructor(e){super(e),this.NONE=pe.NONE,this.firstPiece=y.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=y.empty(),this.phalanxDirection=y.empty(),this.phalanxMiddles=[],this.moveds=[],this.capturedCoords=[],this.hasAsymmetricBoard=!0,this.rules=ic.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Wm(this.rules,"Normal"),new Jlt(this.rules,"Positional"),new e6t(this.rules,"Attack")],this.encoder=Bc.encoder,this.tutorial=(new u3e).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=y.empty(),this.lastPiece=y.empty(),this.hidePreviousMove(),this.board=this.getState().getCopiedBoard()}showLastMove(e){let r=e.coord;this.moveds=[r];for(let o=1;o<e.stepSize+e.movedPieces;o++)r=r.getNext(e.direction,1),this.moveds.push(r);const s=this.node.mother.get(),i=s.gameState.getCurrentOpponent();for(;r.isInRange(14,12)&&s.gameState.getPieceAt(r)===i;)this.capturedCoords.push(r),r=r.getNext(e.direction,1)}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.firstPiece.isAbsent()?s.firstClick(e,r):s.lastPiece.isAbsent()?s.secondClick(e,r):s.thirdClick(e,r)})()}firstClick(e,r){var s=this;return I(function*(){const i=s.getState().getCurrentOpponent(),o=s.getState().getCurrentPlayer();switch(s.board[r][e]){case o:return s.firstPiece=y.of(new S(e,r)),s.validExtensions=s.getValidExtensions(o),s.phalanxValidLandings=s.getPhalanxValidLandings(),z.SUCCESS;case i:return s.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE());default:return Se.expectToBe(s.board[r][e],pe.NONE),s.cancelMove(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}getFirstPieceExtensions(e){const r=[];for(const s of Oe.DIRECTIONS){let i=this.firstPiece.get().getNext(s,1);for(;i.isInRange(14,12)&&this.board[i.y][i.x]===e;)r.push(i),i=i.getNext(s,1)}return r}getPhalanxValidExtensions(e){let r=Oe.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(r,1),i=this.getExtensionsToward(s,r,e);r=r.getOpposite();const o=this.firstPiece.get().getNext(r,1),c=this.getExtensionsToward(o,r,e);return i.concat(c)}getExtensionsToward(e,r,s){const i=[];for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i.push(e),e=e.getNext(r,1);return i}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const e=this.firstPiece.get(),r=this.lastPiece.get(),s=Math.abs(e.x-r.x),i=Math.abs(e.y-r.y),o=Math.max(s,i)+1;let c=Oe.factory.fromMove(e,r).get();const u=r.getNext(c,1),h=this.getLandingsToward(u,c,o);c=c.getOpposite();const g=e.getNext(c,1);return this.getLandingsToward(g,c,o).concat(h)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const e=[];for(const r of Oe.DIRECTIONS){const s=this.firstPiece.get().getNext(r,1);s.isInRange(14,12)&&this.board[s.y][s.x]===pe.NONE&&e.push(s)}return e}getLandingsToward(e,r,s){const i=this.getState().getCurrentPlayer(),o=this.getState().getCurrentOpponent(),c=[];for(;e.isInRange(14,12)&&c.length<s&&this.board[e.y][e.x]!==i;){if(this.board[e.y][e.x]===o)return this.getPhalanxLength(e,r,o)<s&&c.push(e),c;c.push(e),e=e.getNext(r,1)}return c}getPhalanxLength(e,r,s){let i=0;for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i++,e=e.getNext(r,1);return i}cancelMoveAttempt(){this.firstPiece=y.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=y.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(e,r){var s=this;return I(function*(){const i=new S(e,r),o=s.firstPiece.get();if(i.equals(o))return s.cancelMoveAttempt(),z.SUCCESS;const c=s.getState().getCurrentOpponent(),u=s.getState().getCurrentPlayer();if(!i.isAlignedWith(o))return s.cancelMove($c.SQUARE_NOT_ALIGNED_WITH_SELECTED());const h=i.getDistance(o),g=o.getDirectionToward(i).get();switch(s.board[r][e]){case pe.NONE:return 1===h?s.tryMove(new Bc(o.x,o.y,1,1,g)):s.cancelMove($c.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove($c.SINGLE_PIECE_CANNOT_CAPTURE());default:Se.expectToBe(s.board[r][e],u);const m=new Bc(o.x,o.y,h,1,g),E=s.getState(),b=ic.getPhalanxValidity(E,m);return b.isFailure()?s.cancelMove(b.getReason()):(s.lastPiece=y.of(i),s.validExtensions=s.getValidExtensions(u),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=o.getCoordsToward(i),s.phalanxDirection=y.of(g),z.SUCCESS)}})()}thirdClick(e,r){var s=this;return I(function*(){const i=s.getState().getCurrentPlayer(),o=new S(e,r);if(s.firstPiece.equalsValue(o))return s.moveFirstPiece(i);if(s.lastPiece.equalsValue(o))return s.moveLastPiece(i);const c=s.firstPiece.get(),u=s.lastPiece.get();if(!o.isAlignedWith(c))return s.cancelMove($c.SQUARE_NOT_ALIGNED_WITH_PHALANX());let h=Oe.factory.fromMove(c,u).get();const g=Oe.factory.fromMove(c,o).get();if(h===g.getOpposite()&&(s.firstPiece=y.of(u),s.lastPiece=y.of(c),h=g),h!==g)return s.cancelMove($c.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[r][e]===i)return s.thirdClickOnPlayerPiece(o,h,i);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,E=s.lastPiece.get().getDistance(o),b=new Bc(s.firstPiece.get().x,s.firstPiece.get().y,m,E,h);return s.tryMove(b)}})()}thirdClickOnPlayerPiece(e,r,s){var i=this;return I(function*(){i.lastPiece=y.of(e);const o=i.firstPiece.get().getDistance(e)+1,c=new Bc(i.firstPiece.get().x,i.firstPiece.get().y,o,1,r),u=ic.getPhalanxValidity(i.node.gameState,c);return u.isFailure()?i.cancelMove(u.getReason()):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getValidExtensions(s),i.phalanxValidLandings=i.getPhalanxValidLandings(),z.SUCCESS)})()}moveFirstPiece(e){var r=this;return I(function*(){return r.firstPiece=y.of(r.firstPiece.get().getNext(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?yield r.moveOnlyPiece(e):(r.phalanxMiddles=r.phalanxMiddles.slice(1),r.validExtensions=r.getPhalanxValidExtensions(e)),r.phalanxValidLandings=r.getPhalanxValidLandings(),z.SUCCESS})()}moveLastPiece(e){var r=this;return I(function*(){return r.lastPiece=y.of(r.lastPiece.get().getPrevious(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?r.moveOnlyPiece(e):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getPhalanxValidExtensions(e),r.phalanxValidLandings=r.getPhalanxValidLandings(),z.SUCCESS)})()}moveOnlyPiece(e){var r=this;return I(function*(){return r.lastPiece=y.empty(),r.validExtensions=r.getFirstPieceExtensions(e),r.phalanxDirection=y.empty(),r.phalanxMiddles=[],r.phalanxValidLandings=r.getPhalanxValidLandings(),z.SUCCESS})()}tryMove(e){const r=this.getState();return this.cancelMove(),this.chooseMove(e,r)}getPieceClasses(e,r){const s=this.getPlayerClass(this.board[r][e]);return this.getPieceStrokeClasses(e,r).concat([s])}getPieceStrokeClasses(e,r){const s=new S(e,r);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(i=>i.equals(s))?["selected-stroke"]:[]}getRectClasses(e,r){const s=new S(e,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:this.moveds.some(i=>i.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const e=[],s=this.getState().getCurrentPlayer();for(let i=0;i<this.board.length;i++)for(let o=0;o<this.board[i].length;o++)this.board[i][o]===s&&e.push(new S(o,i));return e}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-epaminondas"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,r6t,2,1,"g",1),x(2,s6t,2,4,"g",1),A()),2&e&&(D("transform",r.rotation),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getHighlightedCoords()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Mi{constructor(t){Se.assert(t.length>=4,"Cannot create a GipfCapture with less than 4 captured pieces"),Se.assert(sc.areOnSameLine(t),"Cannot create a GipfCapture with pieces that are not on the same line"),this.capturedSpaces=Qe.copyImmutableArray(t).sort((r,s)=>r.x===s.x?(Se.assert(r.y!==s.y,"Cannot create a GipfCapture with duplicate coords"),r.y>s.y?1:-1):r.x>s.x?1:-1);let e=y.empty();for(const r of this.capturedSpaces)Se.assert(e.isAbsent()||1===e.get().getDistance(r),"Cannot create a GipfCapture with non-consecutive coords"),e=y.of(r)}toString(){let t="";for(const e of this.capturedSpaces)""!==t&&(t+=","),t+=e.toString();return t}size(){return this.capturedSpaces.length}forEach(t){this.capturedSpaces.forEach(t)}contains(t){for(let e=0;e<this.capturedSpaces.length;e++)if(this.capturedSpaces[e].equals(t))return!0;return!1}intersectsWith(t){return this.capturedSpaces.some(e=>t.contains(e))}getLine(){return sc.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(t){if(this===t)return!0;if(this.capturedSpaces.length!==t.capturedSpaces.length)return!1;for(let e=0;e<this.capturedSpaces.length;e++)if(!this.capturedSpaces[e].equals(t.capturedSpaces[e]))return!1;return!0}}Mi.encoder=new class extends R4{encode(n){return n.capturedSpaces.map(t=>S.encoder.encodeMove(t))}decode(n){return new Mi(n.map(S.encoder.decodeMove))}};class oc{constructor(t,e){this.coord=t,this.direction=e}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(t){return!!this.coord.equals(t.coord)&&this.direction.equals(t.direction)}}oc.encoder=new class extends R4{constructor(){super(...arguments),this.optionalDirectionEncoder=y.getEncoder(ze.encoder)}encode(n){return{coord:S.encoder.encode(n.coord),direction:this.optionalDirectionEncoder.encode(n.direction)}}decode(n){const t=n;return Le(null!=t.coord,"Invalid encoded GipfPlacement"),new oc(S.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}};class Ma extends ji{constructor(t,e,r){super(),this.placement=t,this.initialCaptures=e,this.finalCaptures=r}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}equals(t){return this===t||!(!1===this.placement.equals(t.placement)||!1===Qe.compareArray(this.initialCaptures,t.initialCaptures)||!1===Qe.compareArray(this.finalCaptures,t.finalCaptures))}encode(){return Ma.encoder.encode(this)}decode(t){return Ma.encoder.decode(t)}}Ma.encoder=new class extends xt{encodeMove(n){const t={placement:oc.encoder.encode(n.placement)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=Mi.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=Mi.encoder.encode(e)}),t}decodeMove(n){const t=n;return Le(null!=t.placement,"Invalid encoded GipfMove"),new Ma(oc.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",Mi.encoder.decode),this.decodeArray(t,"finalCapture",Mi.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class Uc extends DH{constructor(t,e,r,s){super(e,t,7,7,[3,2,1],Ie.EMPTY),this.sidePieces=r,this.capturedPieces=s}static getInitialState(){const t=Ie.EMPTY,e=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE;return new Uc([[e,e,e,s,t,t,r],[e,e,t,t,t,t,t],[e,t,t,t,t,t,t],[r,t,t,t,t,t,s],[t,t,t,t,t,t,e],[t,t,t,t,t,e,e],[s,t,t,r,e,e,e]],0,[12,12],[0,0])}equals(t){return this.turn===t.turn&&this.sidePieces[0]===t.sidePieces[0]&&this.sidePieces[1]===t.sidePieces[1]&&this.capturedPieces[0]===t.capturedPieces[0]&&this.capturedPieces[1]===t.capturedPieces[1]&&Qe.compareTable(this.board,t.board)}getNumberOfPiecesToPlace(t){return this.sidePieces[t.value]}getNumberOfPiecesCaptured(t){return this.capturedPieces[t.value]}setAtUnsafe(t,e){const r=Qe.copyBiArray(this.board);return r[t.y][t.x]=e,new Uc(r,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==Ie.UNREACHABLE}}let Gc=(()=>{class n{}return n.CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`,n.INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`,n.MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`,n.PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`,n.INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`,n.PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`,n.PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`,n.AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`,n.NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`,n})();class An extends L1{constructor(){super(Uc)}static get(){return An.singleton.isAbsent()&&(An.singleton=y.of(new An)),An.singleton.get()}applyLegalMove(t,e,r){return new Uc(r.board,r.turn+1,r.sidePieces,r.capturedPieces)}static applyCaptures(t,e){let r=e;return t.forEach(s=>{r=An.applyCapture(s,r)}),r}static applyCapture(t,e){const r=e.getCurrentPlayer();let s=e;const i=[e.sidePieces[0],e.sidePieces[1]],o=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(c=>{const u=e.getPieceAt(c);s=s.setAt(c,Ie.EMPTY),u.is(r)?i[r.value]+=1:o[r.value]+=1}),new Uc(s.board,e.turn,i,o)}static getPlacements(t){const e=[];return Is.INSTANCE.getAllBorders(t).forEach(r=>{t.getPieceAt(r)===Ie.EMPTY?e.push(new oc(r,y.empty())):An.getAllDirectionsForEntrance(t,r).forEach(s=>{!1===An.isLineComplete(t,r,s)&&e.push(new oc(r,y.of(s)))})}),e}static isLineComplete(t,e,r){return An.nextGapInLine(t,e,r).isAbsent()}static nextGapInLine(t,e,r){for(let s=e;t.isOnBoard(s);s=s.getNext(r))if(t.getPieceAt(s)===Ie.EMPTY)return y.of(s);return y.empty()}static applyPlacement(t,e){const r=e.getCurrentPlayer();let s=e,i=Ie.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){const c=t.coord;if(e.getPieceAt(c)!==Ie.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");s=s.setAt(c,i)}else for(let c=t.coord;s.isOnBoard(c)&&i!==Ie.EMPTY;c=c.getNext(t.direction.get())){const u=e.getPieceAt(c);s=s.setAt(c,i),i=u}const o=[e.sidePieces[0],e.sidePieces[1]];return o[r.value]-=1,new Uc(s.board,e.turn,o,e.capturedPieces)}getPiecesMoved(t,e,r){const s=An.applyCaptures(e,t);if(r.direction.isAbsent())return[r.coord];{const i=r.direction.get(),o=[];o.push(r.coord);let c=r.coord.getNext(i);for(;s.isOnBoard(c)&&s.getPieceAt(c)!==Ie.EMPTY;)o.push(c),c=c.getNext(i);return Le(s.isOnBoard(c)&&s.getPieceAt(c)===Ie.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(c),o}}static getAllDirectionsForEntrance(t,e){if(Is.INSTANCE.isTopLeftCorner(t,e))return[ze.RIGHT,ze.DOWN,ze.UP_RIGHT];if(Is.INSTANCE.isTopCorner(t,e))return[ze.DOWN,ze.DOWN_LEFT,ze.RIGHT];if(Is.INSTANCE.isTopRightCorner(t,e))return[ze.DOWN_LEFT,ze.DOWN,ze.LEFT];if(Is.INSTANCE.isBottomLeftCorner(t,e))return[ze.UP_RIGHT,ze.UP,ze.RIGHT];if(Is.INSTANCE.isBottomCorner(t,e))return[ze.UP,ze.LEFT,ze.UP_RIGHT];if(Is.INSTANCE.isBottomRightCorner(t,e))return[ze.LEFT,ze.UP,ze.DOWN_LEFT];if(Is.INSTANCE.isOnTopLeftBorder(t,e))return[ze.RIGHT,ze.DOWN];if(Is.INSTANCE.isOnLeftBorder(t,e))return[ze.UP_RIGHT,ze.RIGHT];if(Is.INSTANCE.isOnBottomLeftBorder(t,e))return[ze.UP,ze.UP_RIGHT];if(Is.INSTANCE.isOnBottomRightBorder(t,e))return[ze.LEFT,ze.UP];if(Is.INSTANCE.isOnRightBorder(t,e))return[ze.LEFT,ze.DOWN_LEFT];if(Is.INSTANCE.isOnTopRightBorder(t,e))return[ze.DOWN_LEFT,ze.DOWN];throw new Error("not a border")}isLegal(t,e){const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toOtherFallible();const s=An.applyCaptures(t.initialCaptures,e),i=this.noMoreCapturesValidity(s);if(i.isFailure())return i.toOtherFallible();const o=this.placementValidity(s,t.placement);if(o.isFailure())return o.toOtherFallible();const c=An.applyPlacement(t.placement,s),u=this.capturesValidity(c,t.finalCaptures);if(u.isFailure())return u.toOtherFallible();const h=An.applyCaptures(t.finalCaptures,c),g=this.noMoreCapturesValidity(h);return g.isFailure()?g.toOtherFallible():_e.success(h)}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=An.applyCapture(s,r)}return z.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer(),s=An.getLinePortionWithFourPiecesOfPlayer(t,r,e.getLine());if(s.isAbsent())return z.failure(Gc.CAPTURE_MUST_BE_ALIGNED());const i=s.get();return An.getCapturable(t,i).equals(e)?z.SUCCESS:z.failure(Gc.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=An.getLinePortionWithFourPiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}static getLinePortionWithFourPiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let c=i;for(let u=i;t.isOnBoard(u);u=u.getNext(o))if(t.getPieceAt(u).is(e)?(0===s&&(c=u),s+=1):s=0,4===s)return y.of({0:c,1:u,2:o});return y.empty()}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===An.getLinePortionsWithFourPiecesOfPlayer(t,e).length?z.SUCCESS:z.failure(Gc.MISSING_CAPTURES())}placementValidity(t,e){const r=this.placementCoordValidity(t,e.coord);if(r.isFailure())return r;if(t.getPieceAt(e.coord)!==Ie.EMPTY){if(e.direction.isAbsent())return z.failure(Gc.PLACEMENT_WITHOUT_DIRECTION());if(An.isLineComplete(t,e.coord,e.direction.get()))return z.failure(Gc.PLACEMENT_ON_COMPLETE_LINE());for(const s of An.getAllDirectionsForEntrance(t,e.coord))if(s===e.direction.get())return z.SUCCESS;return z.failure(Gc.INVALID_PLACEMENT_DIRECTION())}return z.SUCCESS}placementCoordValidity(t,e){return Is.INSTANCE.isOnBorder(t,e)?z.SUCCESS:z.failure(Gc.PLACEMENT_NOT_ON_BORDER())}static getCapturable(t,e){const r=[],s=e[0],i=e[1],o=e[2],c=o.getOpposite();let u=s.getNext(c);for(;t.isOnBoard(u)&&t.getPieceAt(u)!==Ie.EMPTY;)r.push(u),u=u.getNext(c);for(let h=s;!h.equals(i);h=h.getNext(o))r.push(h);for(let h=i;t.isOnBoard(h)&&t.getPieceAt(h)!==Ie.EMPTY;h=h.getNext(o))r.push(h);return new Mi(r)}static getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return An.getLinePortionsWithFourPiecesOfPlayer(t,e).forEach(s=>{r.push(An.getCapturable(t,s))}),r}static getPlayerScore(t,e){const r=t.getNumberOfPiecesToPlace(e);if(0===r&&0===An.getPossibleCaptures(t).length)return y.empty();const s=t.getNumberOfPiecesCaptured(e);return y.of(r+3*s)}static isGameOver(t){const e=An.getPlayerScore(t,B.ZERO),r=An.getPlayerScore(t,B.ONE);return e.isAbsent()||r.isAbsent()}getGameStatus(t){const e=t.gameState,r=An.getPlayerScore(e,B.ZERO),s=An.getPlayerScore(e,B.ONE);return r.isAbsent()?xe.ONE_WON:s.isAbsent()?xe.ZERO_WON:xe.ONGOING}}An.singleton=y.empty();class jm extends xs{static getPossibleCaptureCombinationsFromPossibleCaptures(t){const e=jm.computeIntersections(t);let r=[[]];return t.forEach((s,i)=>{if(0===e[i].length)r.forEach(o=>{o.push(i)});else{const o=[],c=e[i].some(u=>u>i);for(const u of r)!0===u.some(g=>e[i].some(m=>g===m))?o.push(Qe.copyImmutableArray(u)):c?(o.push(Qe.copyImmutableArray(u)),u.push(i),o.push(Qe.copyImmutableArray(u))):(u.push(i),o.push(Qe.copyImmutableArray(u)));r=o}}),r.map(s=>s.map(i=>t[i]))}static computeIntersections(t){const e=[];return t.forEach((r,s)=>{e.push([]),t.forEach((i,o)=>{s!==o&&r.intersectsWith(i)&&e[s].push(o)})}),e}getMetrics(t){const e=t.gameState;return[An.getPlayerScore(e,B.ZERO).get(),An.getPlayerScore(e,B.ONE).get()]}getListMoves(t){return this.getListMoveFromState(t.gameState)}getListMoveFromState(t){const e=[];return An.isGameOver(t)||this.getPossibleCaptureCombinations(t).forEach(r=>{const s=An.applyCaptures(r,t);An.getPlacements(s).forEach(i=>{const o=An.applyPlacement(i,s);this.getPossibleCaptureCombinations(o).forEach(c=>{const u=new Ma(i,r,c);e.push(u)})})}),e}getPossibleCaptureCombinations(t){const e=An.getPossibleCaptures(t);return jm.getPossibleCaptureCombinationsFromPossibleCaptures(e)}}class f3e{constructor(t,e,r,s,i,o){this.source=t,this.destination=e,this.x1=r,this.y1=s,this.x2=i,this.y2=o}}const n1=Ie.UNREACHABLE,pt=Ie.EMPTY,kr=Ie.ZERO,B4=Ie.ONE;class h3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,Uc.getInitialState()),ie.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,Uc.getInitialState(),new Ma(new oc(new S(3,0),y.of(ze.DOWN)),[],[]),$localize`Congratulations!`),ie.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new Uc([[n1,n1,n1,kr,B4,pt,pt],[n1,n1,pt,pt,pt,pt,pt],[n1,pt,pt,pt,pt,pt,pt],[kr,kr,kr,pt,pt,pt,pt],[B4,pt,pt,pt,pt,pt,n1],[pt,pt,pt,B4,pt,n1,n1],[pt,pt,pt,B4,n1,n1,n1]],42,[8,8],[0,0]),[new Ma(new oc(new S(0,3),y.of(ze.RIGHT)),[],[new Mi([new S(0,3),new S(1,3),new S(2,3),new S(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),ie.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Uc([[n1,n1,n1,pt,pt,pt,pt],[n1,n1,pt,B4,pt,pt,pt],[n1,pt,pt,kr,pt,pt,pt],[kr,kr,kr,B4,pt,pt,pt],[pt,pt,pt,kr,pt,pt,n1],[pt,pt,pt,kr,pt,n1,n1],[pt,pt,pt,B4,n1,n1,n1]],42,[8,4],[2,3]),[new Ma(new oc(new S(0,3),y.of(ze.RIGHT)),[],[new Mi([new S(3,1),new S(3,2),new S(3,3),new S(3,4),new S(3,5),new S(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),ie.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Uc([[n1,n1,n1,kr,pt,pt,kr],[n1,n1,pt,kr,pt,pt,kr],[n1,kr,kr,pt,kr,B4,kr],[pt,pt,pt,kr,pt,pt,kr],[pt,pt,pt,kr,pt,pt,n1],[kr,kr,kr,B4,B4,n1,n1],[pt,pt,pt,kr,n1,n1,n1]],42,[3,4],[2,3]),[new Ma(new oc(new S(3,6),y.of(ze.UP)),[new Mi([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new Mi([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)]),new Mi([new S(1,2),new S(2,2),new S(3,2),new S(4,2),new S(5,2)])]),new Ma(new oc(new S(4,6),y.of(ze.UP)),[new Mi([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new Mi([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)]),new Mi([new S(3,0),new S(3,1),new S(3,2),new S(3,3),new S(3,4)])]),new Ma(new oc(new S(3,6),y.of(ze.UP)),[new Mi([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new Mi([new S(1,2),new S(2,2),new S(3,2),new S(4,2),new S(5,2)]),new Mi([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}}function o6t(n,t){if(1&n&&(F(),X(0,"circle",13)),2&n){const e=C().$implicit,r=C();w("ngClass",r.getPieceClass(e)),D("cx",r.getCenterAt(e).x)("cy",r.getCenterAt(e).y)("r",r.SPACE_SIZE)}}function a6t(n,t){if(1&n){const e=Ae();F(),O(0,"g",10),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i))}),X(1,"polygon",11),x(2,o6t,1,4,"circle",12),A()}if(2&n){const e=t.$implicit,r=C();Re("id","click_",e.x,"_",e.y,""),T(1),Re("id","space_",e.x,"_",e.y,""),w("ngClass",r.getSpaceClass(e)),D("points",r.getHexaPointsAt(e)),T(1),w("ngIf",r.isPiece(e))}}function c6t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",16),ee("click",function(){const i=he(e).$implicit;return le(C(2).onClick(i))}),A()}if(2&n){const e=t.$implicit;D("points",C(2).getHexaPointsAt(e))}}function l6t(n,t){if(1&n&&(F(),O(0,"g",14),x(1,c6t,1,1,"polygon",15),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e.capturedSpaces)}}function u6t(n,t){if(1&n){const e=Ae();F(),O(0,"line",17),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i.destination))}),A()}if(2&n){const e=t.$implicit;D("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function f6t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",18),A()),2&n){const e=t.$implicit,r=C().$implicit,s=C();T(1),Re("id","piece_",r.value,"_",e,""),w("ngClass",s.getPlayerClass(r)),D("cx",s.getRemainingPieceCx(r,e))("cy",s.getRemainingPieceCy(r))("r",.5*s.SPACE_SIZE)}}function h6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,f6t,2,6,"g",8),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",r.getPlayerSidePieces(e))}}function d6t(n,t){if(1&n&&(F(),X(0,"line",19)),2&n){const e=C();D("x1",e.inserted.get().x1)("y1",e.inserted.get().y1)("x2",e.inserted.get().x2)("y2",e.inserted.get().y2)}}let p6t=(()=>{class n extends Ah{constructor(e){super(e),this.inserted=y.empty(),this.arrows=[],this.captured=[],this.moved=[],this.hexagonWidth=this.SPACE_SIZE,this.sharedHexagonX=Math.cos(30)*this.hexagonWidth*.5,this.boardWidth=this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2,this.boardHeight=7*this.hexagonWidth+4.5*this.STROKE_WIDTH,this.movePhase=n.PHASE_PLACEMENT_COORD,this.possibleCaptures=[],this.initialCaptures=[],this.placement=y.empty(),this.placementEntrance=y.empty(),this.finalCaptures=[],this.hasAsymmetricBoard=!0,this.scores=y.of([0,0]),this.rules=An.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new jm(this.rules,"GipfMinimax")],this.encoder=Ma.encoder,this.tutorial=(new h3e).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new Nh(1.5*this.SPACE_SIZE,new S(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),Is.INSTANCE)}updateBoard(){this.cancelMoveAttempt()}showLastMove(e){if(this.inserted=y.empty(),e.placement.direction.isPresent()){const r=e.placement;this.inserted=y.of(this.arrowTowards(r.coord,r.direction.get()))}this.cancelMoveAttempt()}arrowTowards(e,r){const s=e.getNext(r.getOpposite()),i=this.getCenterAt(e),o=this.getCenterAt(s);return new f3e(s,e,o.x,o.y,i.x,i.y)}markCapture(e){e.forEach(r=>{this.captured.push(r)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(e){const r=this.constructedState.getNumberOfPiecesToPlace(e),s=[];for(let i=0;i<r;i+=1)s.push(i);return s}isPiece(e){return this.getPiece(e)!==Ie.EMPTY}getPiece(e){return this.constructedState.getPieceAt(e)}onClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());switch(r.movePhase){case n.PHASE_INITIAL_CAPTURE:case n.PHASE_FINAL_CAPTURE:return r.selectCapture(e);case n.PHASE_PLACEMENT_COORD:return r.selectPlacementCoord(e);default:return Se.expectToBe(r.movePhase,n.PHASE_PLACEMENT_DIRECTION),r.selectPlacementDirectionOrPlacementCoord(e)}})()}selectCapture(e){var r=this;return I(function*(){const s=[];if(r.possibleCaptures.forEach(o=>{o.contains(e)&&s.push(o)}),s.length>1)return r.cancelMove(Gc.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return r.cancelMove(Gc.MISSING_CAPTURES());const i=s[0];return r.constructedState=An.applyCapture(i,r.constructedState),r.markCapture(i),r.possibleCaptures=An.getPossibleCaptures(r.constructedState),r.movePhase===n.PHASE_INITIAL_CAPTURE?(r.initialCaptures.push(i),0===r.possibleCaptures.length?r.moveToPlacementPhase():z.SUCCESS):(Se.expectToBe(r.movePhase,n.PHASE_FINAL_CAPTURE),r.finalCaptures.push(i),0===r.possibleCaptures.length?r.tryMove(r.initialCaptures,r.placement.get(),r.finalCaptures):z.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=n.PHASE_PLACEMENT_COORD,z.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=An.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,z.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var e=this;return I(function*(){return e.possibleCaptures=An.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,z.SUCCESS)})()}computeArrows(e){this.arrows=[];for(const r of An.getAllDirectionsForEntrance(this.constructedState,e))if(!1===An.isLineComplete(this.constructedState,e,r)){const s=e.getNext(r),i=this.getCenterAt(e),o=this.getCenterAt(s);this.arrows.push(new f3e(e,s,i.x,i.y,o.x,o.y))}}selectPlacementCoord(e){var r=this;return I(function*(){const s=r.rules.placementCoordValidity(r.constructedState,e);return s.isFailure()?r.cancelMove(s.getReason()):r.placementEntrance.equalsValue(e)?(r.cancelMoveAttempt(),z.SUCCESS):(r.placementEntrance=y.of(e),r.constructedState.getPieceAt(e)===Ie.EMPTY?r.selectPlacementDirection(y.empty()):(r.movePhase=n.PHASE_PLACEMENT_DIRECTION,r.computeArrows(e),0===r.arrows.length&&r.cancelMove(Gc.NO_DIRECTIONS_AVAILABLE()),z.SUCCESS))})()}selectPlacementDirection(e){var r=this;return I(function*(){r.placement=y.of(new oc(r.placementEntrance.get(),e));const s=r.rules.placementValidity(r.constructedState,r.placement.get());return s.isFailure()?r.cancelMove(s.getReason()):(r.arrows=[],r.constructedState=An.applyPlacement(r.placement.get(),r.constructedState),r.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(e){var r=this;return I(function*(){const s=r.placementEntrance.get();if(!1===s.isAlignedWith(e)||1!==s.getDistance(e))return r.selectPlacementCoord(e);const i=ze.factory.fromMove(s,e);return r.selectPlacementDirection(i.toOptional())})()}tryMove(e,r,s){var i=this;return I(function*(){const o=new Ma(r,e,s);return yield i.chooseMove(o,i.getState(),i.scores.get())})()}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const e=this.node.move;if(e.isPresent()){const r=e.get(),s=this.getPreviousState();r.initialCaptures.forEach(i=>this.markCapture(i)),r.finalCaptures.forEach(i=>this.markCapture(i)),this.moved=this.rules.getPiecesMoved(s,r.initialCaptures,r.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=y.empty(),this.placement=y.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(e){return this.captured.some(r=>r.equals(e))?"captured-fill":this.moved.some(r=>r.equals(e))?"moved-fill":""}getPieceClass(e){const r=this.getPiece(e);return this.getPlayerClass(B.of(r.value))}getRemainingPieceCy(e){return e===B.ONE?25:this.boardHeight-25}getRemainingPieceCx(e,r){const s=20+r*this.SPACE_SIZE*.5;return e===B.ONE?s:this.boardWidth-(15+s)}}return n.PHASE_INITIAL_CAPTURE=0,n.PHASE_PLACEMENT_COORD=1,n.PHASE_PLACEMENT_DIRECTION=2,n.PHASE_FINAL_CAPTURE=3,n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-gipf"]],features:[l],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),A(),O(4,"marker",3),X(5,"polygon",4),A()(),x(6,a6t,3,7,"g",5),x(7,l6t,2,1,"g",6),x(8,u6t,1,4,"line",7),x(9,h6t,2,1,"g",8),x(10,d6t,1,4,"line",9),A()),2&e&&(D("viewBox",-r.STROKE_WIDTH+" 0 "+r.boardWidth+" "+r.boardHeight)("transform",r.rotation),T(6),w("ngForOf",r.getAllCoords()),T(1),w("ngForOf",r.possibleCaptures),T(1),w("ngForOf",r.arrows),T(1),w("ngForOf",r.Player.PLAYERS),T(1),w("ngIf",r.inserted.isPresent()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Lr extends Ks{toString(){return this===Lr.PASS?"GoMove.PASS":this===Lr.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}Lr.PASS=new Lr(-1,0),Lr.ACCEPT=new Lr(-2,0),Lr.encoder=Ks.getEncoder(n=>new Lr(n.x,n.y));class qe{constructor(t,e){this.player=t,this.type=e}equals(t){return t===this}toString(){switch(this){case qe.DARK:return"GoPiece.DARK";case qe.LIGHT:return"GoPiece.LIGHT";case qe.EMPTY:return"GoPiece.EMPTY";case qe.DEAD_DARK:return"GoPiece.DEAD_DARK";case qe.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case qe.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return Le(this===qe.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(t,e){return e===t.player&&"territory"!==t.type}static ofPlayer(t){return t===B.ZERO?qe.DARK:qe.LIGHT}isOccupied(){return[qe.DARK,qe.LIGHT,qe.DEAD_DARK,qe.DEAD_LIGHT].includes(this)}isEmpty(){return[qe.DARK_TERRITORY,qe.LIGHT_TERRITORY,qe.EMPTY].includes(this)}isDead(){return[qe.DEAD_DARK,qe.DEAD_LIGHT].includes(this)}isTerritory(){return[qe.DARK_TERRITORY,qe.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return Le(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),qe.EMPTY}}qe.DARK=new qe(B.ZERO,"alive"),qe.LIGHT=new qe(B.ONE,"alive"),qe.EMPTY=new qe(pe.NONE,"empty"),qe.DEAD_DARK=new qe(B.ZERO,"dead"),qe.DEAD_LIGHT=new qe(B.ONE,"dead"),qe.DARK_TERRITORY=new qe(pe.NONE,"territory"),qe.LIGHT_TERRITORY=new qe(pe.NONE,"territory");var Bn=(()=>(function(n){n.PLAYING="PLAYING",n.PASSED="PASSED",n.COUNTING="COUNTING",n.ACCEPT="ACCEPT",n.FINISHED="FINISHED"}(Bn||(Bn={})),Bn))();let ms=(()=>{class n extends Ur{constructor(e,r,s,i,o){super(e,s),this.captured=r,this.koCoord=i,this.phase=o}static getInitialState(){const e=n.getStartingBoard();return new n(e,[0,0],0,y.empty(),Bn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return Qe.createTable(n.WIDTH,n.HEIGHT,qe.EMPTY)}copy(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}return n.WIDTH=19,n.HEIGHT=19,n})();const ct=qe.LIGHT,nt=qe.DARK,VH=qe.DEAD_LIGHT,Rh=qe.LIGHT_TERRITORY,qc=qe.DARK_TERRITORY,Ce=qe.EMPTY;class d3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,ms.getInitialState()),ie.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new ms([[Ce,nt,Ce,Ce,ct,ct],[Ce,nt,Ce,Ce,ct,Ce],[Ce,nt,nt,ct,ct,Ce],[Ce,Ce,nt,ct,Ce,Ce],[Ce,Ce,nt,ct,Ce,Ce],[Ce,Ce,nt,ct,Ce,Ce]],[0,0],0,y.empty(),Bn.PLAYING)),ie.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new ms([[Ce,Ce,Ce,Ce,Ce],[Ce,Ce,nt,Ce,Ce],[Ce,nt,ct,Ce,Ce],[Ce,Ce,nt,Ce,Ce],[Ce,Ce,Ce,Ce,Ce]],[0,0],0,y.empty(),Bn.PLAYING),[new Lr(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),ie.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new ms([[Ce,nt,Ce,Ce,Ce],[nt,ct,Ce,Ce,Ce],[nt,ct,ct,nt,Ce],[Ce,nt,nt,Ce,Ce],[Ce,Ce,Ce,Ce,Ce]],[0,0],0,y.empty(),Bn.PLAYING),[new Lr(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),ie.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new ms([[Ce,nt,Ce,Ce,Ce],[nt,Ce,Ce,Ce,Ce],[nt,Ce,Ce,Ce,ct],[ct,nt,Ce,ct,Ce],[Ce,ct,Ce,ct,nt]],[0,0],0,y.empty(),Bn.PLAYING)),ie.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new ms([[Ce,Ce,Ce,Ce,Ce],[nt,nt,nt,Ce,Ce],[ct,ct,nt,Ce,Ce],[Ce,ct,nt,Ce,Ce],[ct,ct,nt,Ce,Ce]],[0,0],0,y.empty(),Bn.PLAYING)),ie.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new ms([[Ce,nt,ct,Ce,Ce],[ct,nt,ct,Ce,Ce],[nt,nt,ct,Ce,Ce],[ct,nt,ct,Ce,Ce],[Ce,nt,ct,Ce,Ce]],[0,0],0,y.empty(),Bn.PLAYING)),ie.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new ms([[Ce,ct,nt,Ce,ct,nt,Ce],[Ce,ct,nt,nt,ct,nt,Ce],[Ce,ct,nt,nt,ct,nt,Ce],[Ce,ct,nt,nt,ct,nt,Ce],[Ce,ct,nt,ct,ct,nt,Ce],[Ce,ct,nt,ct,ct,nt,Ce],[Ce,ct,nt,Ce,ct,nt,Ce]],[0,0],0,y.empty(),Bn.PLAYING)),ie.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new ms([[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,nt,ct,Ce,Ce],[Ce,Ce,nt,ct,Ce,ct,Ce],[Ce,Ce,Ce,nt,ct,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce]],[0,0],0,y.empty(),Bn.PLAYING),[new Lr(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),ie.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new ms([[ct,nt,nt,nt,nt,nt,qc,qc,qc],[ct,ct,ct,ct,nt,nt,nt,qc,qc],[ct,Rh,ct,ct,nt,VH,VH,nt,qc],[nt,ct,ct,ct,ct,nt,qc,qc,qc],[Ce,ct,Rh,ct,nt,nt,VH,nt,qc],[ct,Rh,ct,ct,nt,nt,nt,nt,nt],[ct,ct,nt,nt,nt,ct,ct,nt,ct],[nt,nt,nt,ct,ct,ct,Rh,ct,ct],[qc,qc,nt,nt,nt,ct,ct,Rh,Rh]],[0,0],0,y.empty(),Bn.COUNTING),[new Lr(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)]}}let g8=(()=>{class n{constructor(e){this.color=e}selfContains(e){return this.getCoords().some(s=>s.equals(e))}static insertAsEntryPoint(e,r){return 0===e.length?[r]:r.compareTo(e[0])<0?[r].concat(e):e.concat([r])}}return n.VERBOSE=!1,n})();class _6t extends g8{constructor(t,e,r,s,i,o){super(t),this.emptyCoords=e,this.darkCoords=r,this.lightCoords=s,this.deadDarkCoords=i,this.deadLightCoords=o}getCoords(){return this.color===qe.DARK?this.darkCoords:this.color===qe.LIGHT?this.lightCoords:this.color===qe.DEAD_DARK?this.deadDarkCoords:this.color===qe.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(t){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(r=>r.equals(t))}addPawn(t,e){switch(Le(!1===this.contains(t),"This group already contains "+t.toString()),e){case qe.DARK:this.darkCoords=g8.insertAsEntryPoint(this.darkCoords,t);break;case qe.LIGHT:this.lightCoords=g8.insertAsEntryPoint(this.lightCoords,t);break;case qe.DEAD_DARK:this.deadDarkCoords=g8.insertAsEntryPoint(this.deadDarkCoords,t);break;case qe.DEAD_LIGHT:this.deadLightCoords=g8.insertAsEntryPoint(this.deadLightCoords,t);break;default:Se.expectToBeMultiple(e,[qe.EMPTY,qe.DARK_TERRITORY,qe.LIGHT_TERRITORY]),this.emptyCoords=g8.insertAsEntryPoint(this.emptyCoords,t)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const t=new Wn;t.set(qe.EMPTY,this.emptyCoords.length),t.set(qe.DARK,this.darkCoords.length+this.deadLightCoords.length),t.set(qe.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),t.put(this.color.nonTerritory(),0);const e=t.filter((r,s)=>s>0);if(1===e.size())return e.getAnyPair().get().key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const t=[];return this.color!==qe.EMPTY&&this.emptyCoords.length>0&&t.push(this.emptyCoords[0]),this.color!==qe.DARK&&this.darkCoords.length>0&&t.push(this.darkCoords[0]),this.color!==qe.LIGHT&&this.lightCoords.length>0&&t.push(this.lightCoords[0]),this.color!==qe.DEAD_DARK&&this.deadDarkCoords.length>0&&t.push(this.deadDarkCoords[0]),this.color!==qe.DEAD_LIGHT&&this.deadLightCoords.length>0&&t.push(this.deadLightCoords[0]),t}}class Zm extends class m6t{getGroupDatas(t,e){J(g8.VERBOSE,"GroupDatas.getGroupDatas("+t+", "+e+")");const s=this.getNewInstance(e[t.y][t.x]);return this._getGroupDatas(t,e,s)}_getGroupDatas(t,e,r){J(g8.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:r,coord:t}});const s=e[t.y][t.x];if(r.addPawn(t,s),s===r.color)for(const i of this.getDirections()){const o=t.getNext(i);o.isInRange(e[0].length,e.length)&&(r.contains(o)||(r=this._getGroupDatas(o,e,r)))}return r}}{getNewInstance(t){return new _6t(t,[],[],[],[],[])}getDirections(){return $e.ORTHOGONALS}}let Ym=(()=>{class n{}return n.ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`,n.CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`,n.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`,n.OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`,n.CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`,n})();class Ot extends L1{constructor(){super(ms)}static get(){return Ot.singleton.isAbsent()&&(Ot.singleton=y.of(new Ot)),Ot.singleton.get()}static isLegal(t,e){if(J(Ot.VERBOSE||!1,{isLegal:{move:t,state:e}}),Ot.isPass(t)){const s=e.phase===Bn.PLAYING,i=e.phase===Bn.PASSED;return J(Ot.VERBOSE||!1,"GoRules.isLegal at "+e.phase+(s||i?" forbid":" allowed")+" passing on "+e.getCopiedBoard()),s||i?_e.success([]):_e.failure(Ym.CANNOT_PASS_AFTER_PASSED_PHASE())}if(Ot.isAccept(t)){const i=e.phase===Bn.ACCEPT;return e.phase===Bn.COUNTING||i?_e.success([]):_e.failure(Ym.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return Ot.isOccupied(t.coord,e.getCopiedBoard())?(J(Ot.VERBOSE||!1,"GoRules.isLegal: move is marking"),Ot.isLegalDeadMarking(t,e)?_e.success([]):_e.failure(Ym.OCCUPIED_INTERSECTION())):(J(Ot.VERBOSE||!1,"GoRules.isLegal: move is normal stuff: "+t.toString()),Ot.isLegalNormalMove(t,e))}static getNewKo(t,e,r){if(1===r.length){const s=r[0],i=t.coord,o=e[i.y][i.x],u=(new Zm).getGroupDatas(i,e),h=u.emptyCoords,g=qe.pieceBelongTo(o,B.ZERO)?u.darkCoords:u.lightCoords;if(1===h.length&&h[0].equals(s)&&1===g.length)return y.of(s)}return y.empty()}static markTerritoryAndCount(t){J(Ot.VERBOSE,{markTerritoryAndCount:{state:t}});const e=t.getCopiedBoard(),r=Ot.getTerritoryLikeGroup(t),s=t.getCapturedCopy();for(const i of r){const o=i.getWrapper();if(o===qe.LIGHT){s[1]+=i.emptyCoords.length;for(const c of i.getCoords())e[c.y][c.x]=qe.LIGHT_TERRITORY}else{Le(o===qe.DARK,"territory should be wrapped by dark or light, not by "+o.toString()),s[0]+=i.emptyCoords.length;for(const c of i.getCoords())e[c.y][c.x]=qe.DARK_TERRITORY}}return new ms(e,s,t.turn,t.koCoord,t.phase)}static removeAndSubstractTerritory(t){const e=t.getCopiedBoard(),r=t.getCapturedCopy();let s;for(let i=0;i<t.board.length;i++)for(let o=0;o<t.board[0].length;o++)s=e[i][o],s===qe.DARK_TERRITORY?(e[i][o]=qe.EMPTY,r[0]=r[0]-1):s===qe.LIGHT_TERRITORY&&(e[i][o]=qe.EMPTY,r[1]=r[1]-1);return new ms(e,r,t.turn,t.koCoord,t.phase)}static getEmptyZones(t){return Ot.getGroupsDatasWhere(t.getCopiedBoard(),e=>e.isEmpty())}static getGroupsDatasWhere(t,e){const r=[];let s,i,o;const c=new Zm;for(let u=0;u<t.length;u++)for(let h=0;h<t[0].length;h++)s=new S(h,u),o=t[u][h],e(o)&&(r.some(g=>g.selfContains(s))||(i=c.getGroupDatas(s,t),r.push(i)));return r}static addDeadToScore(t){const e=t.getCapturedCopy();let i,r=e[1],s=e[0];for(let o=0;o<t.board.length;o++)for(let c=0;c<t.board[0].length;c++)i=t.getPieceAtXY(c,o),i===qe.DEAD_DARK?r++:i===qe.DEAD_LIGHT&&s++;return[s,r]}static switchAliveness(t,e){const r=e.getCopiedBoard();Le(r[t.y][t.x].isOccupied(),"Can't switch emptyness aliveness");const o=(new Zm).getGroupDatas(t,r),c=e.getCapturedCopy();switch(o.color){case qe.DEAD_DARK:c[1]-=2*o.deadDarkCoords.length;for(const u of o.deadDarkCoords)r[u.y][u.x]=qe.DARK;break;case qe.DEAD_LIGHT:c[0]-=2*o.deadLightCoords.length;for(const u of o.deadLightCoords)r[u.y][u.x]=qe.LIGHT;break;case qe.LIGHT:c[0]+=2*o.lightCoords.length;for(const u of o.lightCoords)r[u.y][u.x]=qe.DEAD_LIGHT;break;default:Se.expectToBe(o.color,qe.DARK),c[1]+=2*o.darkCoords.length;for(const u of o.darkCoords)r[u.y][u.x]=qe.DEAD_DARK}return new ms(r,c,e.turn,e.koCoord,e.phase)}static getGameStatus(t){const e=t.gameState;return e.phase===Bn.FINISHED?e.captured[0]>e.captured[1]?xe.ZERO_WON:e.captured[1]>e.captured[0]?xe.ONE_WON:xe.DRAW:xe.ONGOING}static isPass(t){return t.equals(Lr.PASS)}static isAccept(t){return t.equals(Lr.ACCEPT)}static isLegalDeadMarking(t,e){return Ot.isOccupied(t.coord,e.getCopiedBoard())&&(e.phase===Bn.COUNTING||e.phase===Bn.ACCEPT)}static isLegalNormalMove(t,e){const r=e.getCopiedBoard();if(Ot.isKo(t,e))return _e.failure(Ym.ILLEGAL_KO());[Bn.COUNTING,Bn.ACCEPT].includes(e.phase)&&(e=Ot.resurrectStones(e));const s=Ot.getCaptureState(t,e);if(g3e.isCapturing(s))return _e.success(s.capturedCoords);{r[t.coord.y][t.coord.x]=e.turn%2==0?qe.DARK:qe.LIGHT;const c=0===(new Zm).getGroupDatas(t.coord,r).emptyCoords.length;return r[t.coord.y][t.coord.x]=qe.EMPTY,c?_e.failure(Ym.CANNOT_COMMIT_SUICIDE()):_e.success([])}}static isOccupied(t,e){return e[t.y][t.x].isOccupied()}static isKo(t,e){return!!e.koCoord.isPresent()&&t.coord.equals(e.koCoord.get())}static getCaptureState(t,e){J(Ot.VERBOSE||!1,{getCaptureState:{move:t,state:e}});const s=new g3e;let i;for(const o of $e.ORTHOGONALS)i=Ot.getCapturedInDirection(t.coord,o,e),i.length>0&&s.capturedCoords.every(c=>!i[0].equals(c))&&(s.capturedCoords=s.capturedCoords.concat(i));return s}static getCapturedInDirection(t,e,r){const i=r.getCopiedBoard(),o=t.getNext(e);if(o.isInRange(r.board[0].length,r.board.length)&&i[o.y][o.x]===(r.turn%2==0?qe.LIGHT:qe.DARK)){J(Ot.VERBOSE||!1,"a group could be captured");const h=(new Zm).getGroupDatas(o,i);if(Ot.isCapturableGroup(h,r.koCoord))return J(Ot.VERBOSE||!1,{neightbooringGroupCoord:h.getCoords(),message:"is capturable"}),h.getCoords()}return[]}static isCapturableGroup(t,e){return!(!t.color.isOccupied()||1!==t.emptyCoords.length)&&!1===e.equalsValue(t.emptyCoords[0])}static getTerritoryLikeGroup(t){return Ot.getEmptyZones(t).filter(r=>r.isMonoWrapped())}static applyPass(t){const e=t.getCopiedBoard(),r=t.getCapturedCopy(),s=t.turn;let i,o;return t.phase===Bn.PASSED?(i=Bn.COUNTING,o=new ms(e,r,s+1,y.empty(),i),o=Ot.markTerritoryAndCount(o)):(Le(t.phase===Bn.PLAYING,"Cannot pass in counting phase!"),i=Bn.PASSED,o=new ms(e,r,s+1,y.empty(),i)),o}static applyLegalAccept(t){const e=t.getCopiedBoard();let r;return r=t.phase===Bn.COUNTING?Bn.ACCEPT:Bn.FINISHED,new ms(e,t.getCapturedCopy(),t.turn+1,y.empty(),r)}static applyNormalLegalMove(t,e,r){let s;J(Ot.VERBOSE,{applyNormalLegal:{currentState:e,legalMove:t,status}}),s=[Bn.COUNTING,Bn.ACCEPT].includes(e.phase)?Ot.resurrectStones(e):e.copy();const i=t.coord.x,o=t.coord.y,c=s.getCopiedBoard(),u=s.turn,h=qe.ofPlayer(s.getCurrentPlayer()),g=u+1;c[o][i]=h;for(const b of r)c[b.y][b.x]=qe.EMPTY;const m=Ot.getNewKo(t,c,r),E=s.getCapturedCopy();return E[h.player.value]+=r.length,new ms(c,E,g,m,Bn.PLAYING)}static resurrectStones(t){for(let e=0;e<t.board.length;e++)for(let r=0;r<t.board[0].length;r++)t.getPieceAtXY(r,e).isDead()&&(t=Ot.switchAliveness(new S(r,e),t));return Ot.removeAndSubstractTerritory(t)}static applyDeadMarkingMove(t,e){J(Ot.VERBOSE,{applyDeadMarkingMove:{legalMove:t,state:e}});const r=Ot.removeAndSubstractTerritory(e),s=Ot.switchAliveness(t.coord,r),i=new ms(s.getCopiedBoard(),s.getCapturedCopy(),s.turn+1,y.empty(),Bn.COUNTING);return Ot.markTerritoryAndCount(i)}isLegal(t,e){return Ot.isLegal(t,e)}applyLegalMove(t,e,r){return J(Ot.VERBOSE,{applyLegalMove:{legalMove:t,state:e,status}}),Ot.isPass(t)?(J(Ot.VERBOSE,"GoRules.applyLegalMove: isPass"),Ot.applyPass(e)):Ot.isAccept(t)?(J(Ot.VERBOSE,"GoRules.applyLegalMove: isAccept"),Ot.applyLegalAccept(e)):Ot.isLegalDeadMarking(t,e)?(J(Ot.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),Ot.applyDeadMarkingMove(t,e)):(J(Ot.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),Ot.applyNormalLegalMove(t,e,r))}getGameStatus(t){return Ot.getGameStatus(t)}}Ot.VERBOSE=!1,Ot.singleton=y.empty();class g3e{constructor(){this.capturedCoords=[]}static isCapturing(t){return t.capturedCoords.length>0}}class v6t extends xs{getListMoves(t){J(Ot.VERBOSE||!1,"GoRules.getListMoves");const r=t.gameState,s=this.getPlayingMovesList(r);if(r.phase===Bn.PLAYING||r.phase===Bn.PASSED)return s.push(Lr.PASS),s;{J(Ot.VERBOSE||!1,"GoRules.getListMoves in counting phase");const i=this.getCountingMovesList(r);return 0===i.length?[Lr.ACCEPT]:i}}getPlayingMovesList(t){const e=[];let r;for(let s=0;s<t.board.length;s++)for(let i=0;i<t.board[0].length;i++)r=new Lr(i,s),t.getPieceAt(r.coord)===qe.EMPTY&&Ot.isLegal(r,t).isSuccess()&&e.push(r);return e}getCountingMovesList(t){const e=[],r=this.getCorrectBoard(t).getCopiedBoard(),s=Ot.getGroupsDatasWhere(r,i=>i!==qe.EMPTY);for(const i of s){const o=i.getCoords()[0],c=r[o.y][o.x];if(t.getPieceAt(o)!==c){const h=new Lr(o.x,o.y);return e.push(h),e}}return e}getCorrectBoard(t){const r=this.mapBoard(t.getCopiedBoard(),o=>o===qe.DARK?qe.DEAD_DARK:o===qe.LIGHT?qe.DEAD_LIGHT:o.isTerritory()?qe.EMPTY:o),s=new ms(r,t.getCapturedCopy(),t.turn,t.koCoord,t.phase),i=Ot.getTerritoryLikeGroup(s);return this.setAliveUniqueWrapper(s,i)}mapBoard(t,e){const r=[];for(let s=0;s<t.length;s++){r[s]=[];for(let i=0;i<t[0].length;i++)r[s][i]=e(t[s][i])}return r}setAliveUniqueWrapper(t,e){let s,r=t.copy();for(const i of e){s=i.deadDarkCoords.concat(i.deadLightCoords);for(const o of s)r.isDead(o)&&(r=Ot.switchAliveness(o,r))}return r}getMetrics(t){const e=Ot.markTerritoryAndCount(t.gameState),r=e.getCapturedCopy(),s=this.getDeadStones(e);return[r[0]+2*s[1],r[1]+2*s[0]]}getDeadStones(t){const e=[0,0];for(let r=0;r<t.board.length;r++)for(let s=0;s<t.board[0].length;s++){const i=t.getPieceAtXY(s,r);"dead"===i.type&&(e[i.player.value]=e[i.player.value]+1)}return e}}function C6t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",8),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),A(),O(2,"line",9),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),A(),O(3,"line",9),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),A()()}if(2&n){const e=t.index,r=C().index,s=C();T(1),Re("id","click_",e,"_",r,""),D("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*e)("y",.5*s.SPACE_SIZE*r),T(1),D("x1",.5*s.SPACE_SIZE*e)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),D("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)}}function y6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,C6t,4,14,"g",3),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function E6t(n,t){if(1&n){const e=Ae();F(),O(0,"circle",10),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();Re("id","hoshi_",e.x,"_",e.y,""),D("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.y)("r",.1*r.SPACE_SIZE)}}function M6t(n,t){if(1&n&&(F(),X(0,"circle",16)),2&n){const e=C(2).index,r=C().index,s=C();D("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function S6t(n,t){if(1&n){const e=Ae();F(),O(0,"line",17),ee("click",function(){he(e);const s=C(2).index,i=C().index;return le(C().onClick(s,i))}),A()}if(2&n){const e=C(2).index,r=C().index,s=C();D("x1",.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)}}function P6t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"circle",13),ee("click",function(){he(e);const s=C().index,i=C().index;return le(C().onClick(s,i))}),A(),x(2,M6t,1,3,"circle",14),x(3,S6t,1,4,"line",15),A()}if(2&n){const e=C().index,r=C().index,s=C();T(1),w("ngClass",s.getSpaceClass(e,r)),D("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE),T(1),w("ngIf",s.isLastSpace(e,r)),T(1),w("ngIf",s.isDead(e,r))}}function T6t(n,t){if(1&n){const e=Ae();F(),O(0,"circle",19),ee("click",function(){he(e);const s=C(2).index,i=C().index;return le(C().onClick(s,i))}),A()}if(2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();D("cx",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*r)("cy",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*i)("r",.1*o.SPACE_SIZE)("class",s===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function w6t(n,t){if(1&n&&(F(),x(0,T6t,1,4,"circle",18)),2&n){const e=C().index,r=C().index;w("ngIf",C().isTerritory(e,r))}}function b6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,P6t,4,6,"g",11),x(2,w6t,1,1,"ng-template",null,12,Gn),A()),2&n){const e=t.index,r=Fn(3),s=C().index,i=C();T(1),w("ngIf",i.spaceIsFull(e,s))("ngIfElse",r)}}function O6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,b6t,4,2,"g",3),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function A6t(n,t){if(1&n&&(F(),X(0,"rect",20)),2&n){const e=C();D("width",.25*e.SPACE_SIZE)("height",.25*e.SPACE_SIZE)("x",.125*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.ko.get().x)("y",.125*e.SPACE_SIZE+.5*e.SPACE_SIZE*e.ko.get().y)}}function N6t(n,t){if(1&n){const e=Ae();F(),O(0,"circle",21),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();D("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.y)("r",.07*r.SPACE_SIZE)}}let I6t=(()=>{class n extends LH{constructor(e){super(e),this.ko=y.empty(),this.last=y.empty(),this.captures=[],this.GoPiece=qe,this.boardHeight=ms.HEIGHT,this.boardWidth=ms.WIDTH,this.scores=y.of([0,0]),this.rules=Ot.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new v6t(this.rules,"GoMinimax")],this.encoder=Lr.encoder,this.tutorial=(new d3e).tutorial,this.canPass=!0,this.boardHeight=this.getState().board.length,this.boardWidth=this.getState().board[0].length,this.updateBoard()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());s.last=y.empty();const o=new Lr(e,r);return s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){J(n.VERBOSE,"updateBoard");const e=this.getState(),r=this.node.move,s=e.phase;this.board=e.getCopiedBoard(),this.scores=y.of(e.getCapturedCopy()),this.ko=e.koCoord,r.isPresent()?this.showCaptures():this.captures=[],this.last=r.map(i=>i.coord),this.canPass=s!==Bn.FINISHED,this.createHoshis()}showCaptures(){const e=this.getPreviousState();this.captures=[];for(let r=0;r<this.board.length;r++)for(let s=0;s<this.board[0].length;s++){const i=new S(s,r),o=e.getPieceAt(i).isOccupied(),c=this.board[r][s]===qe.EMPTY,u=!1===this.ko.equalsValue(i);o&&c&&u&&this.captures.push(i)}}pass(){var e=this;return I(function*(){const r=e.getState().phase;return r===Bn.PLAYING||r===Bn.PASSED?e.onClick(Lr.PASS.coord.x,Lr.PASS.coord.y):(Le(r===Bn.COUNTING||r===Bn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(Lr.ACCEPT.coord.x,Lr.ACCEPT.coord.y))})()}getSpaceClass(e,r){const s=this.getState().getPieceAtXY(e,r);return this.getPlayerClass(s.getOwner())}spaceIsFull(e,r){return this.getState().getPieceAtXY(e,r)!==qe.EMPTY&&!this.isTerritory(e,r)}isLastSpace(e,r){if(this.last.isPresent()){const s=this.last.get();return e===s.x&&r===s.y}return!1}isDead(e,r){return this.getState().isDead(new S(e,r))}isTerritory(e,r){return this.getState().isTerritory(new S(e,r))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-go"]],features:[l],decls:9,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],["id","blank_board"],[4,"ngFor","ngForOf"],["class","base-no-stroke",3,"id","click",4,"ngFor","ngForOf"],["id","piece_ko_territory_markers_and_dead_stones"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],["fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[1,"base-no-stroke",3,"id","click"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),X(1,"rect",1),O(2,"g",2),x(3,y6t,2,1,"g",3),x(4,E6t,1,5,"circle",4),A(),O(5,"g",5),x(6,O6t,2,1,"g",3),A(),x(7,A6t,1,4,"rect",6),x(8,N6t,1,3,"circle",7),A()),2&e&&(D("viewBox","0 -3 "+r.boardWidth*r.SPACE_SIZE*.5+" "+(6+r.boardHeight*r.SPACE_SIZE*.5)),T(1),D("width",r.boardWidth*r.SPACE_SIZE*.5)("height",r.boardHeight*r.SPACE_SIZE*.5),T(2),w("ngForOf",r.board),T(1),w("ngForOf",r.hoshis),T(2),w("ngForOf",r.board),T(1),w("ngIf",r.ko.isPresent()),T(1),w("ngForOf",r.captures))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class p6{constructor(t,e,r,s){this.left=t,this.up=e,this.width=r,this.height=s}static fromLimits(t,e,r,s){return new p6(t,r,e-t,s-r)}static fromHexa(t,e,r){const s=t.flatMap(g=>e.getHexaPointsListAt(g)),i=p6.getLimits(s);return new p6(i.minX-r/2,i.minY-r/2,r+i.maxX-i.minX,r+i.maxY-i.minY)}static getLimits(t){let e=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;for(const o of t)s=Math.min(s,o.x),i=Math.min(i,o.y),e=Math.max(e,o.x),r=Math.max(r,o.y);return{minX:s,minY:i,maxX:e,maxY:r}}center(){return new S(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(t,e,r,s){return new p6(this.left-t,this.up-r,this.width+t+e,this.height+r+s)}containingAtLeast(t){const e=Math.min(this.left,t.left),r=Math.max(this.right(),t.right()),s=Math.min(this.up,t.up),i=Math.max(this.bottom(),t.bottom());return p6.fromLimits(e,r,s,i)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}let ts=(()=>{class n{}return n.CANNOT_DROP_PIECE_YOU_DONT_HAVE=()=>"You cannot drop a piece that you do not have in your reserve.",n.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The queen bee can only move to one of its direct neighbors.`,n.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The beetle can only move to one of its direct neighbors.`,n.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`The grasshopper must move in a straight line.`,n.GRASSHOPPER_MUST_JUMP_OVER_PIECES=()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`,n.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES=()=>$localize`The spider must move on neighboring spaces.`,n.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT=()=>$localize`The spider can only move around pieces that are in direct contact with it.`,n.SPIDER_CANNOT_BACKTRACK=()=>$localize`The spider cannot go twice through the same space in the same move.`,n.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE=()=>$localize`The queen bee must be placed on the board before moving a piece.`,n.THIS_PIECE_CANNOT_CLIMB=()=>$localize`Only the beetle is allowed to climb over other pieces.`,n.CANNOT_DISCONNECT_HIVE=()=>$localize`You are not allowed to split the hive.`,n.MUST_BE_ABLE_TO_SLIDE=()=>$localize`This piece must be able to slide to its destination.`,n.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN=()=>$localize`You must place your queen bee at this turn!`,n.CANNOT_DROP_NEXT_TO_OPPONENT=()=>$localize`You cannot drop a piece next to one of your opponent's stack.`,n.MUST_DROP_ON_EMPTY_SPACE=()=>$localize`You must always drop your piece on an empty space.`,n.MUST_BE_CONNECTED_TO_HIVE=()=>$localize`The piece you are dropping must be connected to the hive.`,n})();class Qs{constructor(t,e){this.owner=t,this.kind=e}toString(){return`${this.kind}_${this.owner.toString()}`}equals(t){return this.owner===t.owner&&this.kind===t.kind}}Qs.encoder=new class extends R4{encode(n){return{owner:n.owner.value,kind:n.kind}}decode(n){Le(null!==Se.getNonNullable(n).kind,"invalid encoded HivePiece"),Le(null!==Se.getNonNullable(n).owner,"invalid encoded HivePiece");const t=Se.getNonNullable(n).kind,e=B.of(Se.getNonNullable(n).owner);return new Qs(e,t)}};class $4{constructor(t){this.pieces=t}equals(t){return this.size()===t.size()&&Qe.compareArray(this.pieces,t.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(t){return new $4([t,...this.pieces])}topPiece(){return Se.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const t=[...this.pieces];return t.shift(),new $4(t)}size(){return this.pieces.length}}$4.EMPTY=new $4([]);class ac extends Ks{constructor(t,e,r){super(e,r),this.piece=t}static from(t,e){return new ac(t,e.x,e.y)}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(t){return t instanceof ac&&this.piece.equals(t.piece)&&this.coord.equals(t.coord)}}ac.encoder=xt.tuple([Qs.encoder,S.encoder],n=>[n.piece,n.coord],n=>new ac(n[0],n[1].x,n[1].y));class z2 extends c8{constructor(t,e){super(t,e)}static from(t,e){return t.equals(e)?_e.failure(tt.MOVE_CANNOT_BE_STATIC()):_e.success(new z2(t,e))}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(t instanceof Wc)&&t instanceof z2&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}z2.encoder=io.getFallibleEncoder(z2.from);class Wc extends z2{constructor(t){super(t[0],t[3]),this.coords=t}static fromCoords(t){return new Wc(t)}toString(){return`HiveMoveSpider(${this.coords.map(e=>e.toString()).join(", ")})`}equals(t){return t instanceof Wc&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}Wc.encoder=xt.tuple([S.encoder,S.encoder,S.encoder,S.encoder],n=>n.coords,n=>new Wc(n));class HH extends ji{toString(){return"HiveMovePass"}equals(t){return t instanceof HH}}var Si;!function(n){n.PASS=new HH,n.drop=function t(s,i){return ac.from(s,i)},n.move=function e(s,i){return z2.from(s,i)},n.spiderMove=function r(s){return Wc.fromCoords(s)},n.encoder=new class extends xt{encodeMove(s){return s instanceof ac?{moveType:"Drop",encoded:ac.encoder.encode(s)}:s instanceof Wc?{moveType:"Spider",encoded:Wc.encoder.encode(s)}:s instanceof z2?{moveType:"CoordToCoord",encoded:z2.encoder.encode(s)}:{moveType:"Pass"}}decodeMove(s){const i=Se.getNonNullable(s).moveType,o=Se.getNonNullable(s).encoded;return"Drop"===i?ac.encoder.decode(o):"Spider"===i?Wc.encoder.decode(o):"CoordToCoord"===i?z2.encoder.decode(o):n.PASS}}}(Si||(Si={}));class jc{static from(t){return jc.INSTANCES.isAbsent()&&(jc.INSTANCES=y.of({QueenBee:TP.get(),Beetle:wP.get(),Grasshopper:bP.get(),Spider:Km.get(),SoldierAnt:OP.get()})),jc.INSTANCES.get()[t.kind]}checkEmptyDestination(t,e){return e.getAt(t.getEnd()).hasPieces()?z.failure(ts.THIS_PIECE_CANNOT_CLIMB()):z.SUCCESS}canSlideBetweenNeighbors(t,e,r){const s=new bt(yi.getNeighbors(e)),i=new bt(yi.getNeighbors(r)),o=s.intersection(i);for(const c of o)if(t.getAt(c).isEmpty())return!0;return!1}}jc.INSTANCES=y.empty();class TP extends jc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new TP)),this.INSTANCE.get()}moveValidity(t,e){return!1===yi.areNeighbors(t.getStart(),t.getEnd())?z.failure(ts.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(e,t.getStart(),t.getEnd())?z.failure(ts.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of yi.getNeighbors(t))e.getAt(s).isEmpty()&&r.push(z2.from(t,s).get());return r}}TP.INSTANCE=y.empty();class wP extends jc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new wP)),this.INSTANCE.get()}moveValidity(t,e){return!1===yi.areNeighbors(t.getStart(),t.getEnd())?z.failure(ts.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):z.SUCCESS}getPotentialMoves(t,e){const r=[];for(const s of yi.getNeighbors(t))r.push(z2.from(t,s).get());return r}}wP.INSTANCE=y.empty();class bP extends jc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new bP)),this.INSTANCE.get()}moveValidity(t,e){if(ze.factory.fromMove(t.getStart(),t.getEnd()).isFailure())return z.failure(ts.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const s=t.getStart().getCoordsToward(t.getEnd());if(0===s.length)return z.failure(ts.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const i of s)if(e.getAt(i).isEmpty())return z.failure(ts.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of ze.factory.all){const i=t.getNext(s);if(e.getAt(i).hasPieces()){let o=i;for(;e.getAt(o).hasPieces();)o=o.getNext(s);r.push(z2.from(t,o).get())}}return r}}bP.INSTANCE=y.empty();class Km extends jc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new Km)),this.INSTANCE.get()}prefixLegality(t,e){const r=new bt,s=e.update().setAt(t[0],$4.EMPTY).increaseTurnAndFinalizeUpdate();for(let i=1;i<t.length;i++){if(s.getAt(t[i]).hasPieces())return z.failure(ts.THIS_PIECE_CANNOT_CLIMB());if(!1===yi.areNeighbors(t[i-1],t[i]))return z.failure(ts.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===s.haveCommonNeighbor(t[i],t[i-1]))return z.failure(ts.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(s,t[i-1],t[i]))return z.failure(ts.MUST_BE_ABLE_TO_SLIDE());if(r.contains(t[i]))return z.failure(ts.SPIDER_CANNOT_BACKTRACK());r.add(t[i])}return z.SUCCESS}moveValidity(t,e){Se.assert(t instanceof Wc,"HiveSpiderRules: move should be a spider move");const s=this.prefixLegality(t.coords,e);return s.isFailure()?s:this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=e.update().setAt(t,$4.EMPTY).increaseTurnAndFinalizeUpdate();let s=[[t]];for(let c=0;c<3;c++)s=s.flatMap(u=>this.nextMoveStep(r,u));return new bt(s.map(function i(c){return Wc.fromCoords(c)})).toList()}nextMoveStep(t,e){const r=e[e.length-1];return new bt(yi.getNeighbors(r)).filter(function s(o){return!t.getAt(o).hasPieces()&&void 0===e.find(c=>o.equals(c))&&t.haveCommonNeighbor(o,r)}).toList().map(o=>[...e,o])}}Km.INSTANCE=y.empty();class OP extends jc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new OP)),this.INSTANCE.get()}pathExists(t,e,r){const s=new bt,i=[e];for(;i.length>0;){const o=i.pop();if(!s.contains(o)){if(s.add(o),o.equals(r))return!0;for(const c of yi.getNeighbors(o)){const u=t.getAt(c).isEmpty(),h=t.getOccupiedNeighbors(c).size()>0,g=this.canSlideBetweenNeighbors(t,o,c);u&&h&&g&&i.push(c)}}}return!1}moveValidity(t,e){return!1===this.pathExists(e,t.getStart(),t.getEnd())?z.failure(ts.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=new bt;for(const s of e.occupiedSpaces())if(!s.equals(t))for(const i of e.emptyNeighbors(s))r.add(z2.from(t,i).get());return r.toList()}}OP.INSTANCE=y.empty();class m3e extends pP{constructor(t,e){super(e),this.pieces=t;const r=this.computeScale();this.width=r.width,this.height=r.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const i of this.pieces.listKeys())t=Math.min(i.x,t),e=Math.max(i.x,e),r=Math.min(i.y,r),s=Math.max(i.y,s);return{width:e+1-t,height:s+1-r}}isOnBoard(t){return this.pieces.containsKey(t)}getOccupiedNeighbors(t){return new bt(yi.getNeighbors(t)).filter(r=>this.pieces.get(r).isPresent())}getGroups(){const t=new bt,e=new bt;return this.pieces.forEach(r=>{if(!1===t.contains(r.key)){const s=new bt,i=new bt([r.key]);for(;i.hasElements();){const o=i.getAnyElement().get();i.remove(o),t.add(o),s.add(o),i.addAll(this.getOccupiedNeighbors(o).filter(c=>!1===t.contains(c)))}e.add(s)}}),e}}class AP{constructor(t){this.pieces=t}static getInitial(){const t=new Wn;for(const e of B.PLAYERS)t.set(new Qs(e,"QueenBee"),1),t.set(new Qs(e,"Beetle"),2),t.set(new Qs(e,"Spider"),2),t.set(new Qs(e,"Grasshopper"),3),t.set(new Qs(e,"SoldierAnt"),3);return t.makeImmutable(),new AP(t)}equals(t){return this.pieces.equals(t.pieces)}getQuantity(t){return this.pieces.get(t).get()}hasRemaining(t){return this.getQuantity(t)>0}getAny(t){for(const e of this.pieces.listKeys())if(e.owner===t&&this.hasRemaining(e))return y.of(e);return y.empty()}remove(t){const e=this.pieces.get(t).get();Se.assert(e>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const r=this.pieces.getCopy();return r.replace(t,e-1),new AP(r)}toListOfStacks(){const t=[];return this.pieces.forEach(e=>{const r=[];for(let s=0;s<e.value;s++)r.push(e.key);t.push(new $4(r))}),t}getPlayerPieces(t){const e=[];return this.pieces.forEach(r=>{r.key.owner===t&&r.value>0&&e.push(r.key)}),e}}class Xm{constructor(t,e,r,s){this.pieces=t,this.remainingPieces=e,this.queenBees=r,this.turn=s}static of(t){return new Xm(t.pieces,t.remainingPieces,t.queenBees,t.turn)}setAt(t,e){const r=this.queenBees.getCopy();for(const i of B.PLAYERS)r.get(i).equalsValue(t)&&r.delete(i);for(const i of e.pieces)"QueenBee"===i.kind&&r.put(i.owner,t);const s=this.pieces.getCopy();return e.isEmpty()?s.delete(t):s.put(t,e),new Xm(s,this.remainingPieces,r,this.turn)}removeRemainingPiece(t){return new Xm(this.pieces,this.remainingPieces.remove(t),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new V2(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class V2 extends m3e{constructor(t,e,r,s){super(t,s),this.remainingPieces=e,this.queenBees=r,this.queenBees=r.getCopy();for(const i of r.listKeys()){const o=r.get(i).get();this.queenBees.replace(i,o)}this.queenBees.makeImmutable()}static getInitialState(){return V2.fromRepresentation([],0)}static fromRepresentation(t,e,r=new $t(0,0)){const s=new Hm;let i=AP.getInitial();const o=new Wn;for(let c=0;c<t.length;c++)for(let u=0;u<t[0].length;u++)if(t[c][u].length>0){const h=new S(u,c).getNext(r,1);s.set(h,new $4(t[c][u]));const g=y.ofNullable(t[c][u].find(m=>"QueenBee"===m.kind));g.isPresent()&&o.set(g.get().owner,h);for(const m of t[c][u])i=i.remove(m)}return new V2(s,i,o,e)}update(){return Xm.of(this)}equals(t){return this.pieces.equals(t.pieces)&&this.remainingPieces.equals(t.remainingPieces)&&this.queenBees.equals(t.queenBees)&&this.turn===t.turn}getAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():$4.EMPTY}queenBeeLocation(t){return this.queenBees.get(t)}hasQueenBeeOnBoard(t){return this.queenBeeLocation(t).isPresent()}numberOfNeighbors(t){let e=0;for(const r of yi.getNeighbors(t))this.getAt(r).hasPieces()&&(e+=1);return e}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(t){const e=[];for(const r of yi.getNeighbors(t))this.getAt(r).isEmpty()&&e.push(r);return e}haveCommonNeighbor(t,e){const r=this.getOccupiedNeighbors(t),s=this.getOccupiedNeighbors(e);return r.findAnyCommonElement(s).isPresent()}}class Xi extends L1{constructor(){super(V2)}static get(){return Xi.singleton.isAbsent()&&(Xi.singleton=y.of(new Xi)),Xi.singleton.get()}applyLegalMove(t,e,r){return t instanceof ac?this.applyLegalDrop(t,e):t instanceof z2?this.applyLegalMoveCoordToCoord(t,e):e.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(t,e){const r=e.getAt(t.coord);return e.update().setAt(t.coord,r.add(t.piece)).removeRemainingPiece(t.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(t,e){const r=e.getAt(t.getStart()),s=e.getAt(t.getEnd());return e.update().setAt(t.getStart(),r.removeTopPiece()).setAt(t.getEnd(),s.add(r.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(t,e){return t instanceof ac?this.isLegalDrop(t,e):t instanceof z2?this.isLegalMoveCoordToCoord(t,e):this.shouldPass(e)?z.SUCCESS:z.failure(tt.CANNOT_PASS())}isLegalMoveCoordToCoord(t,e){if(!1===e.queenBeeLocation(e.getCurrentPlayer()).isPresent())return z.failure(ts.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const r=e.getAt(t.getStart());if(r.isEmpty())return z.failure(tt.MUST_CHOOSE_PLAYER_PIECE());const s=r.topPiece();if(s.owner===e.getCurrentOpponent())return z.failure(tt.MUST_CHOOSE_PLAYER_PIECE());const i=jc.from(s).moveValidity(t,e);if(i.isFailure())return i;const o=e.update().setAt(t.getStart(),r.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(o.isDisconnected())return z.failure(ts.CANNOT_DISCONNECT_HIVE());const c=t.getEnd();return 0===o.numberOfNeighbors(c)?z.failure(ts.CANNOT_DISCONNECT_HIVE()):z.SUCCESS}mustPlaceQueenBee(t){return t.turn>=6&&!1===t.hasQueenBeeOnBoard(t.getCurrentPlayer())}isLegalDrop(t,e){const r=e.getCurrentPlayer();if(t.piece.owner===r.getOpponent())return z.failure(tt.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.remainingPieces.hasRemaining(t.piece))return z.failure(ts.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==t.piece.kind&&this.mustPlaceQueenBee(e))return z.failure(ts.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const s=this.checkNeighborValidity(t,e);return s.isFailure()?s:e.getAt(t.coord).hasPieces()?z.failure(ts.MUST_DROP_ON_EMPTY_SPACE()):z.SUCCESS}checkNeighborValidity(t,e){const r=e.getCurrentPlayer();let s=!1;for(const i of yi.getNeighbors(t.coord)){const o=e.getAt(i);if(o.hasPieces()&&(s=!0,1!==e.turn&&o.topPiece().owner===r.getOpponent()))return z.failure(ts.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==e.turn&&!1===s?z.failure(ts.MUST_BE_CONNECTED_TO_HIVE()):z.SUCCESS}getPossibleDropLocations(t){const e=t.getCurrentPlayer();if(0===t.turn)return new bt([new S(0,0)]);if(1===t.turn)return new bt(yi.getNeighbors(new S(0,0)));const r=t.remainingPieces.getAny(e);if(r.isAbsent())return new bt;const s=r.get(),i=new bt;for(const o of t.occupiedSpaces())if(t.getAt(o).topPiece().owner===e)for(const c of t.emptyNeighbors(o)){const u=ac.from(s,c);this.isLegalDrop(u,t).isSuccess()&&i.add(c)}return i}getPossibleMovesFrom(t,e){const r=t.getCurrentPlayer(),s=new bt,i=t.getAt(e).topPiece();if(i.owner===r)for(const o of jc.from(i).getPotentialMoves(e,t))this.isLegalMoveCoordToCoord(o,t).isSuccess()&&s.add(o);return s}getPossibleMovesOnBoard(t){const e=new bt;for(const r of t.occupiedSpaces())e.addAll(this.getPossibleMovesFrom(t,r));return e}shouldPass(t){return 0===this.getPossibleDropLocations(t).size()&&0===this.getPossibleMovesOnBoard(t).size()}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of B.PLAYERS){const i=e.queenBeeLocation(s);i.isPresent()&&(r[s.value]=e.numberOfNeighbors(i.get()))}return 6===r[0]&&6===r[1]?xe.DRAW:6===r[0]?xe.getVictory(B.ONE):6===r[1]?xe.getVictory(B.ZERO):xe.ONGOING}}Xi.singleton=y.empty();class k6t extends xs{getListMoves(t){const e=this.getListDrops(t.gameState),r=this.getListOfOnBoardMoves(t.gameState),s=e.concat(r);return 0===s.length?[Si.PASS]:s}getListOfOnBoardMoves(t){return Xi.get().getPossibleMovesOnBoard(t).toList()}getListDrops(t){const e=[],r=t.getCurrentPlayer(),s=new Qs(r,"QueenBee");for(const i of Xi.get().getPossibleDropLocations(t))if(Xi.get().mustPlaceQueenBee(t))e.push(Si.drop(s,i));else for(const o of t.remainingPieces.getPlayerPieces(t.getCurrentPlayer()))e.push(Si.drop(o,i));return e}getMetrics(t){return[this.queenBeeMobility(t.gameState,B.ZERO),this.queenBeeMobility(t.gameState,B.ONE)]}queenBeeMobility(t,e){const r=t.queenBeeLocation(e);return r.isPresent()?Xi.get().getPossibleMovesFrom(t,r.get()).size():0}}const U4=new Qs(B.ZERO,"QueenBee"),L5=new Qs(B.ZERO,"Beetle"),Dh=new Qs(B.ZERO,"Grasshopper"),NP=new Qs(B.ZERO,"Spider"),IP=new Qs(B.ZERO,"SoldierAnt"),R5=new Qs(B.ONE,"QueenBee"),cc=new Qs(B.ONE,"Beetle"),FH=new Qs(B.ONE,"Grasshopper"),BH=new Qs(B.ONE,"Spider"),Qm=new Qs(B.ONE,"SoldierAnt");class _3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,V2.fromRepresentation([[[R5],[cc],[BH],[Dh]],[[Dh],[],[IP],[]],[[IP],[],[],[]]],8)),ie.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,V2.fromRepresentation([[[],[cc],[NP]],[[Qm],[R5],[U4]],[[Dh],[L5],[]]],7)),ie.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,V2.getInitialState(),Si.drop(L5,new S(0,0)),$localize`Congratulations!`),ie.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,V2.fromRepresentation([[[cc],[Dh]]],2),Si.drop(U4,new S(2,0)),$localize`Congratulations!`),ie.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,V2.fromRepresentation([[[],[NP],[FH],[R5],[cc]],[[cc],[U4],[L5],[],[]]],4),[Si.move(new S(1,1),new S(0,2)).get(),Si.move(new S(1,1),new S(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,V2.fromRepresentation([[[U4],[R5],[L5]],[[cc],[],[]]],6),[Si.move(new S(2,0),new S(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,V2.fromRepresentation([[[cc,U4],[R5],[L5]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,V2.fromRepresentation([[[Dh],[U4],[cc],[Qm]],[[FH],[],[],[]]],6),[Si.move(new S(0,0),new S(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,V2.fromRepresentation([[[],[IP],[R5]],[[],[U4],[cc]],[[Qm],[BH],[]]],6),Si.move(new S(1,0),new S(3,1)).get(),(t,e,r)=>t.equals(Si.move(new S(1,0),new S(0,1)).get())?z.failure($localize`You have not freed your queen, try again!`):z.SUCCESS,$localize`Congratulations!`),ie.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,V2.fromRepresentation([[[],[NP],[BH],[cc]],[[],[],[],[L5]],[[cc],[],[],[Qm]],[[IP],[],[Dh],[]],[[U4],[FH],[],[]]],6),Si.spiderMove([new S(1,0),new S(1,1),new S(2,1),new S(2,2)]),$localize`Congratulations!`),ie.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,V2.fromRepresentation([[[],[NP],[]],[[],[U4],[cc]],[[Qm],[],[]]],6)),ie.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,V2.fromRepresentation([[[cc,L5],[U4],[R5]]],4))]}}const L6t=["app-hive-piece",""];function R6t(n,t){1&n&&(F(),X(0,"path",9))}function D6t(n,t){1&n&&(F(),X(0,"path",10))}function z6t(n,t){1&n&&(F(),X(0,"path",11))}function V6t(n,t){1&n&&(F(),X(0,"path",12))}function H6t(n,t){1&n&&(F(),X(0,"path",13))}let F6t=(()=>{class n extends qce{constructor(){super(...arguments),this.hexaPoints="",this.pieceClass="",this.isoPointsLight="",this.isoPointsDark="",this.isoPointsStroke="",this.layerTransform="",this.hexaCenter=new S(0,0)}ngAfterContentChecked(){const e=new S(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(e),this.hexaCenter=this.hexaLayout.getCenterAt(e);const s=this.hexaLayout.getIsoPoints(e,this.pieceHeight).map(i=>i.map(o=>o.toSVGPoint()).join(" "));this.isoPointsLight=s[0],this.isoPointsDark=s[1],this.isoPointsStroke=s[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275cmp=ut({type:n,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[l],attrs:L6t,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(e,r){1&e&&(F(),O(0,"g"),X(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),O(5,"g"),x(6,R6t,1,0,"path",4),x(7,D6t,1,0,"path",5),x(8,z6t,1,0,"path",6),x(9,V6t,1,0,"path",7),x(10,H6t,1,0,"path",8),A()()),2&e&&(D("transform",r.layerTransform),T(1),w("ngClass",r.pieceClass),D("points",r.isoPointsLight),T(1),w("ngClass",r.pieceClass),D("points",r.isoPointsDark),T(1),D("points",r.isoPointsStroke),T(1),w("ngClass",r.pieceClass),D("points",r.hexaPoints),T(1),D("transform","translate("+r.hexaCenter.x+" "+r.hexaCenter.y+")"),T(1),w("ngIf","QueenBee"===r.piece.kind),T(1),w("ngIf","Beetle"===r.piece.kind),T(1),w("ngIf","Grasshopper"===r.piece.kind),T(1),w("ngIf","Spider"===r.piece.kind),T(1),w("ngIf","SoldierAnt"===r.piece.kind))},dependencies:[pn,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();function B6t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"polygon",4),ee("click",function(){const i=he(e).$implicit;return le(C().selectSpace(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),Re("id","space_",e.x,"_",e.y,""),w("ngClass",e.content.spaceClasses),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function $6t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",6),ee("click",function(){he(e);const s=C().$implicit;return le(C().selectSpace(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C();Re("id","stroke_",e.x,"_",e.y,""),w("ngClass",e.content.strokeClasses),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function U6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,$6t,1,4,"polygon",5),A()),2&n){const e=t.$implicit;T(1),w("ngIf",e.content.strokeClasses.length>0)}}function G6t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",8),ee("click",function(){he(e);const s=C().$implicit;return le(C().selectSpace(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C();Re("id","stroke_",e.x,"_",e.y,""),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function q6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,G6t,1,3,"polygon",7),A()),2&n){const e=t.$implicit;T(1),w("ngIf",e.content.selected)}}function W6t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"g",9),ee("click",function(){const i=he(e).$implicit;return le(C(2).selectStack(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C().index,s=C();T(1),Re("id","piece_",e.x,"_",e.y,""),w("piece",e.content.piece)("x",e.x)("y",e.y)("pieceHeight",s.PIECE_HEIGHT)("hexaLayout",s.hexaLayout)("layer",r)}}function j6t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",6),ee("click",function(){he(e);const s=C().$implicit;return le(C(2).selectStack(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C().index,s=C();Re("id","stroke_",e.x,"_",e.y,""),w("ngClass",e.content.strokeClasses),D("transform","translate(0 "+-(r+1)*s.PIECE_HEIGHT+")")("points",s.getHexaPointsAtXY(e.x,e.y))}}function Z6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,j6t,1,5,"polygon",5),A()),2&n){const e=t.$implicit;T(1),w("ngIf",e.content.strokeClasses.length>0)}}function Y6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,W6t,2,8,"g",1),x(2,Z6t,2,1,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e),T(1),w("ngForOf",e)}}function K6t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"g",10),ee("click",function(){const i=he(e).$implicit;return le(C(2).selectRemaining(i))}),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C(2);T(1),d1("id","remainingPiece_",e.toString(),""),w("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("layer",r)("hexaLayout",s.hexaLayout),D("transform",s.getRemainingPieceTransform(e))}}function X6t(n,t){if(1&n&&(F(),O(0,"g"),x(1,K6t,2,8,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e.pieces)}}function Q6t(n,t){if(1&n&&(F(),X(0,"polygon",11)),2&n){const e=C();D("transform",e.getRemainingPieceHighlightTransform(e.selectedRemaining.get()))("points",e.getHexaPointsAt(e.ORIGIN))}}function J6t(n,t){if(1&n&&(F(),X(0,"g",13)),2&n){const e=t.$implicit,r=t.index,s=C(2);d1("id","inspectedStack_",r,""),w("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",s.hexaLayout)("layer",6*r),D("transform",s.inspectedStackTransform)}}function e0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,J6t,1,8,"g",12),A()),2&n){const e=C();T(1),w("ngForOf",e.inspectedStack.get().pieces.slice().reverse())}}class v3e extends Uce{constructor(){super(...arguments),this.highlighted=[]}initialize(t){this.set(t,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(t,e){this.highlighted.push(t),this.get(t).map(r=>r.spaceClasses.push(e))}highlightStroke(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}select(t){this.highlighted.push(t),this.get(t).map(e=>e.selected=!0)}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[],e.spaceClasses=[],e.selected=!1});this.highlighted=[]}}class t0t extends Uce{constructor(){super(...arguments),this.highlighted=[]}initialize(t,e){this.set(t,{piece:e,strokeClasses:[]})}highlight(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[]});this.highlighted=[]}}let n0t=(()=>{class n extends Ah{constructor(e){super(e),this.ORIGIN=new S(0,0),this.remainingStacks=[],this.layers=[],this.ground=new v3e,this.inspectedStack=y.empty(),this.inspectedStackCoord=y.empty(),this.selectedRemaining=y.empty(),this.selectedStart=y.empty(),this.selectedSpiderCoords=[],this.rules=Xi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new k6t(this.rules,"HiveMinimax")],this.encoder=Si.encoder,this.tutorial=(new _3e).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new Nh(1.5*this.SPACE_SIZE,new S(2*this.SPACE_SIZE,0),Is.INSTANCE),this.canPass=!1,this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.layers=[];for(const r of this.getState().occupiedSpaces()){const s=this.getState().getAt(r),i=r.x,o=r.y;for(let c=0;c<s.size();c++){c in this.layers||(this.layers[c]=new t0t);const u=s.pieces[s.size()-1-c];this.layers[c].initialize(new S(i,o),u)}}this.ground=this.getGround(),this.computeViewBox(),this.remainingStacks=this.getState().remainingPieces.toListOfStacks(),this.canPass=Xi.get().shouldPass(this.getState());const e=Xi.get().getGameStatus(this.node);switch(e){case xe.ONGOING:break;case xe.DRAW:this.highlight(this.getState().queenBeeLocation(B.ZERO).get(),"victory-stroke"),this.highlight(this.getState().queenBeeLocation(B.ONE).get(),"victory-stroke");break;default:const s=e.winner.getOpponent();this.highlight(this.getState().queenBeeLocation(s).get(),"victory-stroke")}}highlight(e,r){const s=this.getState().getAt(e).size();s-1 in this.layers&&this.layers[s-1].highlight(e,r)}pass(){var e=this;return I(function*(){return Se.assert(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Si.PASS,e.getState())})()}computeViewBox(){const e=this.getPieceCoords().union(this.getAllNeighbors()).toList();e.push(new S(0,0)),this.boardViewBox=p6.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH);const r=new p6(this.getRemainingPieceTransformAsCoord(new Qs(B.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),s=5*this.SPACE_SIZE;let i=0;this.getState().remainingPieces.getAny(B.ZERO).isPresent()&&(i=s);let o=0;this.getState().remainingPieces.getAny(B.ONE).isPresent()&&(o=s);const c=this.boardViewBox.containingAtLeast(r).expand(0,0,i,o);if(this.inspectedStack.isPresent()){const u=new S(c.right()+this.SPACE_SIZE,c.center().y),h=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${u.x} ${u.y+3*(h-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const e=new v3e;for(const r of this.getAllNeighbors())e.initialize(r);return e}getAllNeighbors(){const e=new bt;for(const r of this.getPieceCoords())e.addAll(new bt(this.getState().emptyNeighbors(r)));return e.isEmpty()&&e.add(new S(0,0)),e}clearHighlights(){for(const e of this.layers)e.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=y.empty(),this.selectedRemaining=y.empty(),this.selectedSpiderCoords=[],this.inspectedStack=y.empty(),this.computeViewBox()}showLastMove(e){for(const r of this.getLastMoveCoords(e))this.highlight(r,"last-move-stroke"),this.ground.highlightStroke(r,"last-move-stroke"),this.ground.highlightFill(r,"moved-fill")}getLastMoveCoords(e){let r=[];return e instanceof ac?r=[e.coord]:e instanceof z2&&(r=[e.getStart(),e.getEnd()]),r}getRemainingPieceTransformAsCoord(e){const r=this.getRemainingPieceShift(e),s=this.boardViewBox.center().x+r*this.SPACE_SIZE*4;let i;return i=e.owner===this.role?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new S(s,i)}getRemainingPieceTransform(e){const r=this.getRemainingPieceTransformAsCoord(e);return`translate(${r.x} ${r.y})`}getRemainingPieceHighlightTransform(e){const r=this.getRemainingPieceTransformAsCoord(e),s=this.getState().remainingPieces.getQuantity(e);return`translate(${r.x} ${r.y-this.PIECE_HEIGHT*s})`}getRemainingPieceShift(e){switch(e.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return Se.expectToBe(e.kind,"SoldierAnt"),1.5}}selectRemaining(e){var r=this;return I(function*(){const s=r.canUserPlay(`#remainingPiece_${e.toString()}`);if(s.isFailure())return r.cancelMove(s.getReason());if(e.owner===r.getCurrentPlayer().getOpponent())return r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE());if("QueenBee"!==e.kind&&Xi.get().mustPlaceQueenBee(r.getState()))return r.cancelMove(ts.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(r.selectedRemaining.equalsValue(e))r.cancelMoveAttempt();else{r.cancelMoveAttempt(),r.selectedRemaining=y.of(e),r.clearHighlights();const i=Xi.get().getPossibleDropLocations(r.getState()).toList();for(const o of i)r.ground.highlightStroke(o,"clickable-stroke")}return z.SUCCESS})()}selectStack(e,r){return this.select(new S(e,r),"piece")}selectSpace(e,r){return this.select(new S(e,r),"space")}select(e,r){var s=this;return I(function*(){const i=s.canUserPlay(`#${r}_${e.x}_${e.y}`);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState(),c=o.getAt(e);if(s.selectedRemaining.isPresent()){const u=Si.drop(s.selectedRemaining.get(),e);return s.chooseMove(u,o)}if(s.selectedStart.isPresent()){const u=o.getAt(s.selectedStart.get()).topPiece();return s.selectedStart.equalsValue(e)?s.cancelMove():s.selectTarget(e,u)}return 0===c.size()?s.cancelMove():s.selectStart(e,c)})()}selectTarget(e,r){var s=this;return I(function*(){if("Spider"===r.kind)return s.selectNextSpiderSpace(e);{const i=Si.move(s.selectedStart.get(),e);return Le(i.isSuccess(),"Hive: the only forbidden moves are static moves"),s.chooseMove(i.get(),s.getState())}})()}selectStart(e,r){var s=this;return I(function*(){const i=s.getState(),o=r.topPiece();return o.owner===i.getCurrentPlayer().getOpponent()?1===r.size()?s.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE()):s.inspectedStack.isPresent()?(s.cancelMoveAttempt(),s.clearHighlights(),z.SUCCESS):(s.highlight(e,"selected-stroke"),s.inspectedStack=y.of(r),s.inspectedStackCoord=y.of(e),s.computeViewBox(),z.SUCCESS):(s.cancelMoveAttempt(),s.clearHighlights(),"QueenBee"!==o.kind&&Xi.get().mustPlaceQueenBee(i)?s.cancelMove(ts.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(s.selectedStart=y.of(e),s.highlight(e,"selected-stroke"),"Spider"===o.kind&&s.selectedSpiderCoords.push(s.selectedStart.get()),r.size()>1&&(s.inspectedStack=y.of(r),s.inspectedStackCoord=y.of(e),s.computeViewBox()),s.highlightNextPossibleCoords(e),z.SUCCESS))})()}highlightNextPossibleCoords(e){for(const r of this.getNextPossibleCoords(e))this.highlight(r,"clickable-stroke"),this.ground.highlightStroke(r,"clickable-stroke")}getNextPossibleCoords(e){const r=this.getState(),s=r.getAt(e).topPiece(),i=Xi.get().getPossibleMovesFrom(r,e);return"Spider"===s.kind?i.filter(c=>Qe.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():i.map(o=>o.getEnd()).toList()}selectNextSpiderSpace(e){var r=this;return I(function*(){if(r.selectedSpiderCoords.push(e),4===r.selectedSpiderCoords.length){const i=Si.spiderMove(r.selectedSpiderCoords);return r.chooseMove(i,r.getState())}const s=Km.get().prefixLegality(r.selectedSpiderCoords,r.getState());if(s.isFailure())return r.cancelMove(s.getReason());r.clearHighlights(),r.highlight(r.selectedStart.get(),"selected-stroke");for(const i of r.selectedSpiderCoords)r.ground.select(i);return r.highlightNextPossibleCoords(r.selectedStart.get()),z.SUCCESS})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-hive"]],features:[l],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,B6t,2,4,"g",1),x(2,U6t,2,1,"g",1),x(3,q6t,2,1,"g",1),x(4,Y6t,3,2,"g",1),x(5,X6t,2,1,"g",1),x(6,Q6t,1,2,"polygon",2),x(7,e0t,2,1,"g",3),A()),2&e&&(D("viewBox",r.viewBox),T(1),w("ngForOf",r.ground),T(1),w("ngForOf",r.ground),T(1),w("ngForOf",r.ground),T(1),w("ngForOf",r.layers),T(1),w("ngForOf",r.remainingStacks),T(1),w("ngIf",r.selectedRemaining.isPresent()),T(1),w("ngIf",r.inspectedStack.isPresent()))},dependencies:[pn,On,Xt,F6t],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();const r0t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:B.ZERO};class G4 extends NH{static getInitialState(){const t=Pn.UNOCCUPIED,e=Pn.INVADERS,r=Pn.DEFENDERS;return new G4([[t,t,t,e,e,e,e,e,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,r,t,t,t,t,e],[e,t,t,t,r,r,r,t,t,t,e],[e,e,t,r,r,Pn.PLAYER_ONE_KING,r,r,t,e,e],[e,t,t,t,r,r,r,t,t,t,e],[e,t,t,t,t,r,t,t,t,t,e],[t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,e,e,e,e,e,t,t,t]],0)}from(t,e){return new G4(t,e)}}class Uo extends AH{static of(t,e){return new Uo(t,e)}static from(t,e){try{const r=new Uo(t,e);return _e.success(r)}catch(r){return _e.failure(r.message)}}getMaximalDistance(){return 11}}Uo.encoder=io.getFallibleEncoder(Uo.from);class m8 extends IH{constructor(){super(G4,r0t,Uo.of)}static get(){return m8.singleton.isAbsent()&&(m8.singleton=y.of(new m8)),m8.singleton.get()}}m8.singleton=y.empty();const V=Pn.UNOCCUPIED,Qt=Pn.INVADERS,ns=Pn.DEFENDERS,xP=Pn.PLAYER_ONE_KING;class C3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,G4.getInitialState()),ie.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,G4.getInitialState(),Uo.of(new S(5,1),new S(1,1)),$localize`Congratulations!`),ie.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new G4([[V,V,V,V,Qt,Qt,Qt,Qt,V,V,V],[V,V,V,V,V,Qt,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[Qt,V,V,V,V,ns,V,V,V,V,Qt],[Qt,V,V,Qt,ns,ns,ns,V,V,V,Qt],[Qt,Qt,V,ns,ns,xP,ns,ns,V,Qt,Qt],[Qt,V,V,V,ns,ns,ns,V,V,V,Qt],[Qt,V,V,V,V,ns,V,V,V,V,Qt],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,Qt,V,V,V,V,V],[V,V,V,Qt,Qt,Qt,Qt,Qt,V,V,V]],1),[Uo.of(new S(5,3),new S(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(Uo.of(new S(3,0),new S(3,4))),ie.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new G4([[V,V,V,Qt,Qt,Qt,Qt,Qt,V,V,V],[V,ns,V,V,V,Qt,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,ns,V,V,V,V,Qt],[Qt,V,V,V,V,ns,ns,V,V,V,Qt],[Qt,Qt,xP,V,ns,V,ns,ns,V,V,Qt],[V,V,Qt,V,V,ns,ns,V,V,V,Qt],[Qt,V,V,V,V,ns,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,Qt,V,V,V,V,V,V,V,V,V],[V,V,V,Qt,Qt,Qt,Qt,V,Qt,V,V]],12),[Uo.of(new S(3,0),new S(3,5)),Uo.of(new S(3,10),new S(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ie.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new G4([[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,Qt,V,V,V,V,V,V,V,V,V],[Qt,xP,V,Qt,V,V,V,V,V,V,V],[V,Qt,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V]],72),[Uo.of(new S(3,4),new S(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ie.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new G4([[V,V,Qt,xP,Qt,V,V,V,V,V,V],[V,V,V,V,V,V,ns,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,Qt,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V,V,V,V]],72),[Uo.of(new S(3,3),new S(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function s0t(n,t){1&n&&(F(),X(0,"polygon",8))}function i0t(n,t){1&n&&(F(),X(0,"rect",9))}function o0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,s0t,1,0,"polygon",6),x(2,i0t,1,0,"ng-template",null,7,Gn),A()),2&n){const e=Fn(3),r=C().index,s=C().index,i=C();T(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function a0t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=C(2).index,r=C().index,s=C();T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function c0t(n,t){if(1&n&&(F(),X(0,"polyline",16)),2&n){const e=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][e])}}function l0t(n,t){if(1&n&&(F(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function u0t(n,t){if(1&n&&(F(),x(0,c0t,1,1,"polyline",14),x(1,l0t,4,20,"ng-template",null,15,Gn)),2&n){const e=Fn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",e)}}function f0t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",10),x(2,a0t,6,25,"g",11),x(3,u0t,3,2,"ng-template",null,12,Gn),A()),2&n){const e=Fn(4),r=C().index,s=C().index,i=C();T(1),Re("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),T(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function h0t(n,t){if(1&n){const e=Ae();F(),O(0,"g",3),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),X(1,"rect",4),x(2,o0t,4,2,"g",5),x(3,f0t,5,8,"g",5),A()}if(2&n){const e=t.index,r=C().index,s=C();Re("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),T(1),Re("id","space_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),T(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function d0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,h0t,4,10,"g",2),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function p0t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",17),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),Re("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let g0t=(()=>{class n extends xH{constructor(e){super(e,!1,Uo.from),this.rules=m8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new CP(this.rules,"DummyBot"),new EP(this.rules,"Piece > Influence"),new MP(this.rules,"Piece > Control"),new kH(this.rules,"Escape > Piece > Control")],this.encoder=Uo.encoder,this.tutorial=(new C3e).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-hnefatafl"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,d0t,2,1,"g",1),x(2,p0t,2,6,"g",1),A()),2&e&&(D("viewBox",r.getViewBox()),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getClickables()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class wn{constructor(t,e,r){this.value=t,this.name=e,this.rgb=r}static of(t){switch(t){case 0:return wn.ANY;case 1:return wn.ORANGE;case 2:return wn.BLUE;case 3:return wn.PURPLE;case 4:return wn.PINK;case 5:return wn.YELLOW;case 6:return wn.RED;case 7:return wn.GREEN;default:return Se.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),wn.BROWN}}}wn.ANY=new wn(0,"any","#000"),wn.ORANGE=new wn(1,"orange","#d67421"),wn.BLUE=new wn(2,"blue","#006bac"),wn.PURPLE=new wn(3,"purple","#6f3787"),wn.PINK=new wn(4,"pink","#d2719e"),wn.YELLOW=new wn(5,"yellow","#e2c200"),wn.RED=new wn(6,"red","#d23339"),wn.GREEN=new wn(7,"green","#009157"),wn.BROWN=new wn(8,"brown","#562500");class $n{constructor(t,e){this.player=t,this.color=e}static of(t,e){return new $n(t,wn.of(e))}static createPlayerColors(t){return{ORANGE:new $n(t,wn.ORANGE),BLUE:new $n(t,wn.BLUE),PURPLE:new $n(t,wn.PURPLE),PINK:new $n(t,wn.PINK),YELLOW:new $n(t,wn.YELLOW),RED:new $n(t,wn.RED),GREEN:new $n(t,wn.GREEN),BROWN:new $n(t,wn.BROWN)}}equals(t){return t.player===this.player&&t.color===this.color}isEmpty(){return this.player.equals(pe.NONE)}belongsTo(t){return this.player===t}}$n.EMPTY=new $n(pe.NONE,wn.ANY),$n.ZERO=$n.createPlayerColors(B.ZERO),$n.ONE=$n.createPlayerColors(B.ONE);class Pi{static getColorAt(t,e){return Pi.COLORS[e][t]}static getInitialBoard(){const t=$n.EMPTY;return[[1,2,3,4,5,6,7,8].map(e=>$n.of(B.ONE,e)),[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[8,7,6,5,4,3,2,1].map(e=>$n.of(B.ZERO,e))]}static isEmptyAt(t,e){return t[e.y][e.x].equals($n.EMPTY)}static allPieceCoords(t){const e=[];for(let r=0;r<t.length;r++)for(let s=0;s<t[r].length;s++){const i=new S(s,r);Pi.isEmptyAt(t,i)||e.push(i)}return e}}Pi.INITIAL=Pi.getInitialBoard(),Pi.SIZE=8,Pi.COLORS=Qe.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],wn.of);class $H extends ji{constructor(){super()}isPieceMove(){return!1}length(){return 0}equals(t){return this===t}toString(){return"KamisadoMove(PASS)"}}$H.PASS=new $H;class kP extends c8{constructor(t,e){super(t,e)}static of(t,e){if(t.isNotInRange(Pi.SIZE,Pi.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+t.toString());if(e.isNotInRange(Pi.SIZE,Pi.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+e.toString());return new kP(t,e)}isPieceMove(){return!0}equals(t){return t===this||!!t.isPieceMove()&&!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}var Go;!function(n){n.PASS=$H.PASS,n.of=function t(s,i){return kP.of(s,i)};const e=xt.constant("PASS",n.PASS),r=io.getEncoder(kP.of);n.encoder=xt.disjunction(r,e,s=>s.isPieceMove())}(Go||(Go={}));class q4 extends Ur{constructor(t,e,r,s,i){super(Qe.copyBiArray(i),t),this.colorToPlay=e,this.coordToPlay=r,this.alreadyPassed=s}static getInitialState(){return new q4(0,wn.ANY,y.empty(),!1,Pi.INITIAL)}}let Jm=(()=>{class n{}return n.NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`,n.DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`,n.MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`,n.PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`,n})();class Ti extends L1{constructor(){super(q4)}static get(){return Ti.singleton.isAbsent()&&(Ti.singleton=y.of(new Ti)),Ti.singleton.get()}static getColorMatchingPiece(t){return t.coordToPlay.isPresent()?[t.coordToPlay.get()]:[new S(0,7),new S(1,7),new S(2,7),new S(3,7),new S(4,7),new S(5,7),new S(6,7),new S(7,7)]}static getMovablePieces(t){return Ti.getColorMatchingPiece(t).filter(e=>{for(const r of this.playerDirections(t.getCurrentPlayer())){const s=e.getNext(r);if(t.isOnBoard(s)&&Pi.isEmptyAt(t.board,s))return!0}return!1})}static playerDirections(t){return t===B.ONE?[Oe.DOWN,Oe.DOWN_LEFT,Oe.DOWN_RIGHT]:[Oe.UP,Oe.UP_LEFT,Oe.UP_RIGHT]}static directionAllowedForPlayer(t,e){return e===B.ZERO?t.y<0:t.y>0}static getListMovesFromState(t){const e=Ti.getMovablePieces(t);return 0===e.length?(Le(!1===t.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[Go.PASS]):Ti.getListMovesFromNonBlockedState(t,e)}static getListMovesFromNonBlockedState(t,e){const r=[],s=t.getCurrentPlayer();for(const i of e)for(const o of Ti.playerDirections(s))for(let c=1;c<Pi.SIZE;c++){const u=i.getNext(o,c);if(!t.isOnBoard(u)||!Pi.isEmptyAt(t.board,u))break;{const h=Go.of(i,u);r.push(h)}}return r}static mustPass(t){return 0===this.getMovablePieces(t).length}static getFurthestPiecePositions(t){let e=7,r=0;return Pi.allPieceCoords(t.board).forEach(s=>{const i=t.getPieceAt(s);Le(i!==$n.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===B.ONE?r=Math.max(r,s.y):e=Math.min(e,s.y)}),[e,r]}static isLegal(t,e){if(t.isPieceMove()){const r=t.getStart(),s=t.getEnd(),i=e.colorToPlay,o=e.getPieceAt(r);if(!o.belongsTo(e.getCurrentPlayer()))return z.failure(tt.MUST_CHOOSE_PLAYER_PIECE());if(i!==wn.ANY&&o.color!==i)return z.failure(Jm.NOT_RIGHT_COLOR());if(!e.getPieceAt(s).isEmpty())return z.failure(tt.MUST_CLICK_ON_EMPTY_SPACE());const u=Oe.factory.fromMove(r,s);if(u.isFailure())return z.failure(Jm.DIRECTION_NOT_ALLOWED());const h=u.get();if(!Ti.directionAllowedForPlayer(h,e.getCurrentPlayer()))return z.failure(Jm.DIRECTION_NOT_ALLOWED());let g=r;for(;!g.equals(s);)if(g=g.getNext(h),!e.getPieceAt(g).isEmpty())return z.failure(Jm.MOVE_BLOCKED());return z.SUCCESS}return this.isLegalPass(e)}static isLegalPass(t){return this.mustPass(t)&&!t.alreadyPassed?z.SUCCESS:z.failure(tt.CANNOT_PASS())}nextCoordToPlay(t,e){return y.ofNullable(Pi.allPieceCoords(t.board).find(r=>{const s=t.getPieceAt(r);return s.player===t.getCurrentOpponent()&&s.color===e}))}applyLegalMove(t,e,r){if(t.isPieceMove()){const s=t.getStart(),i=t.getEnd(),o=e.getCopiedBoard();o[i.y][i.x]=o[s.y][s.x],o[s.y][s.x]=$n.EMPTY;const c=Pi.getColorAt(i.x,i.y),u=this.nextCoordToPlay(e,c);return new q4(e.turn+1,c,u,!1,o)}{const s=this.nextCoordToPlay(e,e.colorToPlay);return new q4(e.turn+1,e.colorToPlay,s,!0,e.board)}}isLegal(t,e){return Ti.isLegal(t,e)}getGameStatus(t){const e=t.gameState,r=e.getCurrentPlayer();if(Ti.mustPass(e)&&e.alreadyPassed)return xe.getDefeat(r);const[s,i]=Ti.getFurthestPiecePositions(e);return 7===i?xe.ONE_WON:0===s?xe.ZERO_WON:xe.ONGOING}}Ti.singleton=y.empty();class m0t extends xs{getListMoves(t){const e=Ti.getListMovesFromState(t.gameState);return Qe.sortByDescending(e,r=>r.length()),e}getMetrics(t){const e=t.gameState,[r,s]=Ti.getFurthestPiecePositions(e);return[7-r,s]}}const ae=$n.EMPTY,LP=$n.ZERO.ORANGE,RP=$n.ONE.ORANGE,DP=$n.ZERO.BLUE,zP=$n.ONE.BLUE,UH=$n.ZERO.PURPLE,e_=$n.ONE.PURPLE,VP=$n.ZERO.PINK,HP=$n.ONE.PINK,FP=$n.ZERO.YELLOW,BP=$n.ONE.YELLOW,$P=$n.ZERO.RED,UP=$n.ONE.RED,GP=$n.ZERO.GREEN,qP=$n.ONE.GREEN,WP=$n.ZERO.BROWN,jP=$n.ONE.BROWN;class y3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new q4(5,wn.ORANGE,y.empty(),!1,[[WP,zP,e_,HP,BP,UP,qP,jP],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,RP,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,GP,$P,FP,VP,UH,DP,LP]])).withPreviousMove(Go.of(new S(0,7),new S(0,0))),ie.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,q4.getInitialState(),Go.of(new S(7,7),new S(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),ie.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new q4(1,wn.PINK,y.of(new S(3,0)),!1,[[RP,zP,e_,HP,BP,UP,qP,jP],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,DP,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[WP,GP,$P,FP,VP,UH,ae,LP]]),[Go.of(new S(3,0),new S(3,6)),Go.of(new S(3,0),new S(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(Go.of(new S(6,7),new S(6,5))),ie.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new q4(1,wn.PINK,y.of(new S(3,6)),!1,[[RP,zP,e_,ae,BP,UP,qP,jP],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,DP],[ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,HP,ae,ae,ae,ae],[WP,GP,$P,FP,VP,UH,ae,LP]])).withPreviousMove(Go.of(new S(6,5),new S(7,4))),ie.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new q4(2,wn.RED,y.of(new S(2,4)),!1,[[ae,zP,e_,ae,ae,UP,ae,ae],[ae,ae,ae,BP,ae,ae,ae,ae],[ae,ae,ae,HP,ae,e_,ae,ae],[ae,ae,ae,FP,ae,ae,ae,ae],[ae,ae,$P,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,qP,ae],[RP,ae,ae,ae,ae,VP,ae,jP],[WP,GP,ae,ae,ae,ae,DP,LP]]),[Go.of(new S(2,4),new S(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(Go.of(new S(4,0),new S(3,1)))]}}function _0t(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=C(),r=e.$implicit,s=e.index,i=C().index,o=C();w("ngClass",o.piecePlayerClass(r)),D("cx",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function v0t(n,t){if(1&n&&(F(),X(0,"rect",9)),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();D("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(s)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(s)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(s))}}function C0t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"g",4),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),X(2,"rect",5),x(3,_0t,1,4,"circle",6),x(4,v0t,1,7,"rect",7),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Re("id","click_",r,"_",s,""),T(1),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("fill",i.backgroundColor(r,s)),T(1),w("ngIf",e!==i.UNOCCUPIED),T(1),w("ngIf",e!==i.UNOCCUPIED)}}function y0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,C0t,5,9,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function E0t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"rect",10)(2,"rect",10),A()),2&n){const e=C();T(1),Re("id","last_move_start_",e.lastPieceMove.get().getStart().x,"_",e.lastPieceMove.get().getStart().y,""),D("x",e.lastPieceMove.get().getStart().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getStart().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),T(1),Re("id","last_move_start_",e.lastPieceMove.get().getEnd().x,"_",e.lastPieceMove.get().getEnd().y,""),D("x",e.lastPieceMove.get().getEnd().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getEnd().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function M0t(n,t){if(1&n&&(F(),X(0,"circle",11)),2&n){const e=C();D("cx",e.SPACE_SIZE/2+e.chosen.get().x*e.SPACE_SIZE)("cy",e.SPACE_SIZE/2+e.chosen.get().y*e.SPACE_SIZE)("r",e.SPACE_SIZE/2-e.STROKE_WIDTH)}}let S0t=(()=>{class n extends Ho{constructor(e){super(e),this.UNOCCUPIED=$n.EMPTY,this.lastMove=y.empty(),this.lastPieceMove=y.empty(),this.chosen=y.empty(),this.chosenAutomatically=!1,this.hasAsymmetricBoard=!0,this.rules=Ti.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new m0t(this.rules,"KamisadoMinimax")],this.encoder=Go.encoder,this.tutorial=(new y3e).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(e,r){return Pi.getColorAt(e,r).rgb}isPlayerZero(e){return e.player===B.ZERO}pieceColor(e){return e.color.rgb}piecePlayerClass(e){return this.getPlayerClass(e.player)}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.lastPieceMove=y.empty(),this.canPass=Ti.mustPass(e);const r=this.rules.getGameStatus(this.node)!==xe.ONGOING;this.canPass||e.coordToPlay.isAbsent()||r?(this.chosenAutomatically=!1,this.chosen=y.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}showLastMove(e){e.isPieceMove()&&(this.lastPieceMove=y.of(e))}pass(){var e=this;return I(function*(){return Le(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(Go.PASS,e.getState())})()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);if(s.canPass)return s.cancelMove(tt.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(e,r);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(o))return s.cancelMoveAttempt(),z.SUCCESS;{const c=s.getState().getPieceAtXY(e,r),u=s.getState().getCurrentPlayer();return c.belongsTo(u)?s.chosenAutomatically?s.cancelMove(Jm.PLAY_WITH_SELECTED_PIECE()):(s.chosen=y.of(o),z.SUCCESS):yield s.chooseDestination(e,r)}})()}choosePiece(e,r){const s=this.getState().getPieceAtXY(e,r),i=this.getState().getCurrentOpponent();return s.belongsTo(i)?this.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=y.of(new S(e,r)),z.SUCCESS)}chooseDestination(e,r){var s=this;return I(function*(){const i=s.chosen.get(),o=new S(e,r),c=Go.of(i,o);return s.chooseMove(c,s.getState())})()}cancelMoveAttempt(){this.chosenAutomatically||(this.chosen=y.empty())}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-kamisado"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,y0t,2,1,"g",1),x(2,E0t,3,12,"g",2),x(3,M0t,1,3,"circle",3),A()),2&e&&(D("viewBox",r.getViewBox())("transform",r.rotation),T(1),w("ngForOf",r.board),T(1),w("ngIf",r.lastPieceMove.isPresent()),T(1),w("ngIf",r.chosen.isPresent()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),E3e=(()=>{class n extends Ho{getParallelogramCoords(e){const r=e.parallelogramHeight,s=r*e.horizontalWidthRatio,i=r*e.offsetRatio,o=s,u=s-i,h=r,g=-i,m=r;return[new S(0,0),new S(o,0),new S(u,h),new S(g,m)]}getCoordTranslate(e,r,s,i){const o=i.parallelogramHeight;return new S(e*(o*i.horizontalWidthRatio)+i.offsetRatio*o*(i.abstractBoardSize-r),r*o-i.pieceHeightRatio*o*s)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Sr(n)))(r||n)}}(),n.\u0275cmp=ut({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),g6=(()=>{class n{}return n.CANNOT_GO_BACKWARD=()=>$localize`You cannot go backward with normal pieces!`,n.CANNOT_CAPTURE_EMPTY_SPACE=()=>$localize`You cannot capture an empty square, nor jump over it!`,n.CANNOT_SKIP_CAPTURE=()=>$localize`You must capture when it is possible!`,n.MUST_FINISH_CAPTURING=()=>$localize`You must finish this capture!`,n.THIS_PIECE_CANNOT_MOVE=()=>$localize`This piece cannot move!`,n.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL=()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`,n.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL=()=>$localize`You must move in a single diagonal step!`,n.CANNOT_CAPTURE_TWICE_THE_SAME_COORD=()=>$localize`You cannot jump over the same square several times!`,n})();class ks{constructor(t,e){this.player=t,this.isOfficer=e}static getPlayerOfficer(t){return t===B.ZERO?ks.ZERO_OFFICER:ks.ONE_OFFICER}toString(){switch(this){case ks.ZERO:return"u";case ks.ONE:return"v";case ks.ZERO_OFFICER:return"O";default:return Se.expectToBe(this,ks.ONE_OFFICER),"X"}}equals(t){return this===t}}ks.ZERO=new ks(B.ZERO,!1),ks.ONE=new ks(B.ONE,!1),ks.ZERO_OFFICER=new ks(B.ZERO,!0),ks.ONE_OFFICER=new ks(B.ONE,!0);class qo{constructor(t){this.pieces=t}isEmpty(){return 0===this.pieces.length}isCommandedBy(t){return!this.isEmpty()&&this.getCommander().player===t}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new qo(this.pieces.slice(1))}capturePiece(t){return new qo(this.pieces.concat(t))}addStackBelow(t){let e=this;for(const r of t.pieces)e=e.capturePiece(r);return e}getStackSize(){return this.pieces.length}promoteCommander(){let t=this.getCommander();if(t.isOfficer)return this;{t=ks.getPlayerOfficer(t.player);const e=this.getPiecesUnderCommander();return new qo([t]).addStackBelow(e)}}get(t){return this.pieces[t]}toString(t){let e=t-this.getStackSize(),r="";for(;e>0;)r+="_",e--;for(const s of this.pieces)r+=s.toString();return r}}qo.EMPTY=new qo([]);let nr=(()=>{class n extends Ur{static getInitialState(){const e=new qo([ks.ZERO]),r=new qo([ks.ONE]),s=qo.EMPTY;return new n([[r,s,r,s,r,s,r],[s,r,s,r,s,r,s],[r,s,r,s,r,s,r],[s,s,s,s,s,s,s],[e,s,e,s,e,s,e],[s,e,s,e,s,e,s],[e,s,e,s,e,s,e]],0)}static from(e,r){return new n(e,r)}static isNotOnBoard(e){return e.isNotInRange(n.SIZE,n.SIZE)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}getStacksOf(e){const r=[];for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++)this.getPieceAtXY(i,s).isCommandedBy(e)&&r.push(new S(i,s));return r}set(e,r){const s=this.getCopiedBoard();return s[e.y][e.x]=r,new n(s,this.turn)}remove(e){return this.set(e,qo.EMPTY)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(e){return e===B.ZERO?0:n.SIZE-1}toString(){let e=1;for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++){const o=this.getPieceAtXY(i,s).getStackSize();e=Math.max(e,o)}const r=[];for(let s=0;s<n.SIZE;s++){const i=[];for(let o=0;o<n.SIZE;o++)i.push(this.getPieceAtXY(o,s).toString(e));r.push(i.join(" "))}return r.join("\n")}}return n.SIZE=7,n})();class P0t extends bt{equals(t){if(t.size()!==this.size())return!1;for(let e=0;e<this.size();e++)if(!1===Xa(t.get(e),this.get(e)))return!1;return!0}get(t){return Se.assert(t<this.values.length,"MGPUniqueList: index out of bounds: "+t),this.values[t]}getFromEnd(t){return Se.assert(t<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+t),this.get(this.values.length-1-t)}}class Js extends ji{constructor(t,e){super(),this.isStep=e,this.coords=new P0t(t)}static fromCapture(t){const e=Js.getSteppedOverCoords(t);return e.isSuccess()?_e.success(new Js(t,!1)):_e.failure(e.getReason())}static getSteppedOverCoords(t){let e=y.empty();const r=new bt;for(const s of t){if(nr.isNotOnBoard(s))return _e.failure(bH.OUT_OF_RANGE(s));if(e.isPresent()){const i=e.get();if(!1===i.getVectorToward(s).isDiagonalOfLength(2))return _e.failure(g6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const c=i.getCoordsToward(s)[0];if(r.contains(c))return _e.failure(g6.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());r.add(c)}e=y.of(s)}return _e.success(r)}static fromStep(t,e){return nr.isNotOnBoard(t)?_e.failure(bH.OUT_OF_RANGE(t)):nr.isNotOnBoard(e)?_e.failure(bH.OUT_OF_RANGE(e)):!1===t.getVectorToward(e).isDiagonalOfLength(1)?_e.failure(g6.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):_e.success(new Js([t,e],!0))}toString(){return"LascaMove("+this.coords.toList().map(r=>r.toString()).join(", ")+")"}getRelation(t){const e=this.coords.size(),r=t.coords.size(),s=Math.min(e,r);for(let i=0;i<s;i++)if(!1===this.coords.toList()[i].equals(t.coords.toList()[i]))return"INEQUALITY";return e===r?"EQUALITY":"PREFIX"}equals(t){return"EQUALITY"===this.getRelation(t)}isPrefix(t){return"PREFIX"===this.getRelation(t)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return Js.getSteppedOverCoords(this.coords.toList())}concatenate(t){const e=this.getEndingCoord(),r=t.coords.toList()[0];Le(e.equals(r),"should not concatenate non-touching move");const s=this.coords.toList(),i=Qe.copyImmutableArray(s),o=t.coords.toList(),c=Qe.copyImmutableArray(o).slice(1);return Js.fromCapture(i.concat(c)).get()}}Js.encoder=new class extends xt{encodeMove(n){return{coords:n.coords.toList().map(t=>S.encoder.encode(t)),isStep:n.isStep}}decodeMove(n){const t=n;Le(null!=t.coords,"Encoded LascaMove should have a coords field"),Le(null!=t.isStep,"Encoded LascaMove should have a isStep field");const r=Se.getNonNullable(t.coords).map(s=>S.encoder.decode(s));return new Js(r,t.isStep)}};class lc extends L1{constructor(){super(nr)}static get(){return lc.singleton.isAbsent()&&(lc.singleton=y.of(new lc)),lc.singleton.get()}getCaptures(t){const e=t.getCurrentPlayer();return this.getCapturesOf(t,e)}getCapturesOf(t,e){const r=[],s=t.getStacksOf(e);for(const i of s)r.push(...this.getPieceCaptures(t,i));return r}getPieceCaptures(t,e){let r=[];const o=t.getPieceAt(e).getCommander().player.getOpponent(),c=this.getPieceDirections(t,e),u=t.getPieceAt(e);for(const h of c){const g=e.getNext(h,1);if(nr.isOnBoard(g)&&t.getPieceAt(g).isCommandedBy(o)){const m=g.getNext(h,1);if(nr.isOnBoard(m)&&t.getPieceAt(m).isEmpty()){const E=t.remove(e).remove(g).set(m,u),b=Js.fromCapture([e,m]).get(),k=this.getPieceCaptures(E,m);if(0===k.length)r=r.concat(b);else{const U=k.map(j=>b.concatenate(j));r=r.concat(U)}}}}return r}getPieceDirections(t,e){const i=t.getPieceAt(e).getCommander().player.getScoreModifier(),o=[Oe.factory.fromDelta(-1,i).get(),Oe.factory.fromDelta(1,i).get()];return t.getPieceAt(e).getCommander().isOfficer&&o.push(Oe.factory.fromDelta(-1,-i).get(),Oe.factory.fromDelta(1,-i).get()),o}getSteps(t){const e=t.getCurrentPlayer();return this.getStepsOf(t,e)}getStepsOf(t,e){const r=[],s=t.getStacksOf(e);for(const i of s)r.push(...this.getPieceSteps(t,i));return r}getPieceSteps(t,e){const r=[],s=this.getPieceDirections(t,e);for(const i of s){const o=e.getNext(i,1);if(nr.isOnBoard(o)&&t.getPieceAt(o).isEmpty()){const c=Js.fromStep(e,o).get();r.push(c)}}return r}applyLegalMove(t,e,r){const s=t.getStartingCoord(),i=t.getEndingCoord();let o=e.getPieceAt(s),c=e.remove(s);if(!1===t.isStep)for(const u of t.getCapturedCoords().get()){const h=e.getPieceAt(u),g=h.getCommander();o=o.capturePiece(g);const m=h.getPiecesUnderCommander();c=c.set(u,m)}if(c=c.set(i,o),i.y===e.getFinishLineOf(e.getCurrentPlayer())){const u=o.promoteCommander();c=c.set(i,u)}return c.incrementTurn()}isLegal(t,e){const r=t.getStartingCoord();if(e.getPieceAt(r).isEmpty())return z.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const s=e.getPieceAt(r),i=e.getCurrentOpponent();if(s.isCommandedBy(i))return z.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE());const o=t.coords.get(1);if(!1===s.getCommander().isOfficer&&r.getDirectionToward(o).get().y===i.getScoreModifier())return z.failure(g6.CANNOT_GO_BACKWARD());if(!1===e.getPieceAt(o).isEmpty())return z.failure(tt.MUST_LAND_ON_EMPTY_SPACE());const c=this.getCaptures(e);return t.isStep?c.length>0?z.failure(g6.CANNOT_SKIP_CAPTURE()):z.SUCCESS:this.isLegalCapture(t,e,c)}isLegalCapture(t,e,r){const s=e.getCurrentPlayer(),i=t.getCapturedCoords().get();for(const o of i){const c=e.getPieceAt(o);if(c.isCommandedBy(s))return z.failure(tt.CANNOT_SELF_CAPTURE());if(c.isEmpty())return z.failure(g6.CANNOT_CAPTURE_EMPTY_SPACE())}return r.some(o=>o.equals(t))?z.SUCCESS:z.failure(g6.MUST_FINISH_CAPTURING())}getGameStatus(t){const e=t.gameState;return this.getCaptures(e).length>0||this.getSteps(e).length>0?xe.ONGOING:xe.getVictory(e.getCurrentOpponent())}}lc.singleton=y.empty();class t_ extends Dc{constructor(t){super(lc.get(),t)}static getListMoves(t){const e=lc.get().getCaptures(t.gameState);return e.length>0?e:lc.get().getSteps(t.gameState)}getListMoves(t){return t_.getListMoves(t)}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=this.getNumberOfMobileCoords(r,B.ZERO),i=this.getNumberOfMobileCoords(r,B.ONE);return M1.from(s,i)}getNumberOfMobileCoords(t,e){const s=this.getCapturesAndSteps(t,e).map(o=>o.getStartingCoord());return new bt(s).size()}getCapturesAndSteps(t,e){const r=lc.get().getCapturesOf(t,e),s=lc.get().getStepsOf(t,e);return r.concat(s)}}class T0t extends t_{constructor(){super("Lasca Control And Domination Minimax")}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=12*super.getBoardValue(t).value;let s=0;for(let i=0;i<nr.SIZE;i++)for(let o=0;o<nr.SIZE;o++){const c=t.gameState.getPieceAtXY(o,i);if(c.getStackSize()>0){const u=c.getStackSize();let h=0;const g=c.getCommander().player;for(;h<u&&c.get(h).player===g;)h++;s+=h*g.getScoreModifier()}}return new M1(r+s)}}const M3e=ks.ZERO,GH=ks.ONE,Ls=new qo([M3e]),_r=new qo([GH]),w0t=new qo([M3e,GH]),b0t=new qo([ks.ZERO_OFFICER,GH]),re=qo.EMPTY;class S3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,nr.getInitialState()),ie.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,nr.getInitialState()),ie.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,nr.getInitialState(),Js.fromStep(new S(4,4),new S(3,3)).get(),$localize`Congratulations!`),ie.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,nr.from([[_r,re,re,re,_r,re,_r],[re,re,re,_r,re,_r,re],[re,re,_r,re,_r,re,_r],[re,_r,re,re,re,re,re],[Ls,re,Ls,re,Ls,re,Ls],[re,Ls,re,Ls,re,Ls,re],[Ls,re,Ls,re,Ls,re,Ls]],2),Js.fromCapture([new S(2,4),new S(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),ie.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,nr.from([[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[_r,re,re,re,_r,re,_r],[re,_r,re,_r,re,_r,re],[re,re,_r,re,_r,re,_r],[re,_r,re,re,re,re,re],[re,re,Ls,re,Ls,re,Ls]],2),Js.fromCapture([new S(2,6),new S(0,4),new S(2,2)]).get(),$localize`Congratulations!`),ie.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,nr.from([[re,re,re,re,re,re,re],[re,re,re,re,re,_r,re],[re,re,re,re,re,re,re],[re,_r,re,_r,re,re,re],[re,re,Ls,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re]],2)),ie.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,nr.from([[re,re,re,re,re,re,_r],[re,re,re,w0t,re,_r,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,Ls,re,Ls,re,Ls]],2),[Js.fromStep(new S(3,1),new S(2,0)).get(),Js.fromStep(new S(3,1),new S(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),ie.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,nr.from([[re,re,re,re,b0t,re,_r],[re,re,re,re,re,re,re],[re,re,re,re,_r,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,Ls,re,Ls,re,Ls]],2),[Js.fromStep(new S(4,0),new S(3,1)).get(),Js.fromStep(new S(4,0),new S(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)]}}function O0t(n,t){if(1&n&&(F(),X(0,"circle",13)),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C().index,c=C();Q2("id","square_",i,"_",o,"_piece_",r,"_officer_symbol"),w("ngClass",s.classes),D("cx",.4*c.SPACE_SIZE)("cy",.575*c.SPACE_SIZE)("r",.045*c.SPACE_SIZE)}}function A0t(n,t){if(1&n&&(F(),O(0,"g",10),X(1,"use",11),x(2,O0t,1,7,"circle",12),A()),2&n){const e=t.$implicit,r=t.index,s=C().index,i=C().index;D("transform",C().getPieceTranslate(r)),T(1),Q2("id","square_",s,"_",i,"_piece_",r,""),w("ngClass",e.classes),T(1),w("ngIf",e.isOfficer)}}function N0t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"g",7),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),X(2,"polygon",8),x(3,A0t,3,6,"g",9),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Re("id","coord_",r,"_",s,""),D("transform",i.getTranslate(r,s,0)),T(1),Re("id","square_",r,"_",s,""),w("ngClass",e.squareClasses),D("points",i.getParallelogramPoints()),T(1),w("ngForOf",e.pieceInfos)}}function I0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,N0t,4,8,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let x0t=(()=>{class n extends E3e{constructor(e){super(e),this.THICKNESS=40,this.mode={horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:nr.SIZE},this.LEFT=0,this.UP=-this.SPACE_SIZE,this.basicWidth=this.mode.abstractBoardSize*this.mode.parallelogramHeight,this.WIDTH=this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio),this.HEIGHT=this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP,this.CX=this.WIDTH/2,this.CY=(this.HEIGHT+this.UP)/2,this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]},this.lastMove=y.empty(),this.currentMoveClicks=[],this.capturedCoords=[],this.legalMoves=[],this.hasAsymmetricBoard=!0,this.rules=lc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new t_("Lasca Control Minimax"),new T0t],this.encoder=Js.encoder,this.tutorial=(new S3e).tutorial,this.canPass=!1,this.updateBoard()}updateBoard(){this.lastMove=this.node.move;const e=this.getState();this.board=e.getCopiedBoard(),this.legalMoves=t_.getListMoves(this.node),this.createAdaptedBoardFrom(e),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}createAdaptedBoardFrom(e){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let i=0;i<nr.SIZE;i++){const o=[];for(let c=0;c<nr.SIZE;c++){const u=this.getSpaceInfo(e,c,i);o.push(u)}this.adaptedBoard.spaceInfo.push(o)}const s=y.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(s.isPresent()){const i=s.get();for(const o of this.getSpaceInfoAt(i).pieceInfos)o.classes.push("selected-stroke");this.showPossibleLandings(i,e)}for(const i of this.capturedCoords)this.getSpaceInfoAt(i).squareClasses.push("captured-fill");for(const i of this.currentMoveClicks)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}getSpaceInfo(e,r,s){const i=e.getPieceAtXY(r,s),o=[];for(let c=i.getStackSize()-1;c>=0;c--){const u=i.get(c);o.push({classes:[this.getPlayerClass(u.player)],isOfficer:u.isOfficer})}return{pieceInfos:o,squareClasses:[]}}showLastMove(e){this.showLastCapture(e),this.showSteppedOnCoord(e)}showLastCapture(e){if(!1===e.isStep){const r=e.getCapturedCoords();Se.assert(r.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const s of r.get())this.getSpaceInfoAt(s).squareClasses.push("captured-fill")}}showSteppedOnCoord(e){for(const r of e.coords)this.getSpaceInfoAt(r).squareClasses.push("moved-fill")}showPossibleMoves(){for(const e of this.legalMoves){const r=e.getStartingCoord();this.getSpaceInfoAt(r).squareClasses.push("selectable-fill")}}getSpaceInfoAt(e){if(this.role===B.ONE&&this.adaptedBoard.isAlreadySwitched){const r=nr.SIZE-1,s=new S(r-e.x,r-e.y);return this.adaptedBoard.spaceInfo[s.y][s.x]}return this.adaptedBoard.spaceInfo[e.y][e.x]}rotateAdaptedBoardIfNeeded(){if(this.role===B.ONE){const e=[];for(let r=0;r<nr.SIZE;r++){e[nr.SIZE-1-r]=[];for(let s=0;s<nr.SIZE;s++)e[nr.SIZE-1-r][nr.SIZE-1-s]=this.getSpaceInfoAt(new S(s,r))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:e}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(e,r){var s=this;return I(function*(){s.role===B.ONE&&(e=nr.SIZE-1-e,r=nr.SIZE-1-r);const i=s.canUserPlay("#coord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r),c=s.getState().getPieceAt(o),u=s.getState().getCurrentOpponent();return c.isCommandedBy(u)?s.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):0===s.currentMoveClicks.length?s.trySelectingPiece(o):s.moveClick(o)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(e){var r=this;return I(function*(){if(e.equals(r.currentMoveClicks[0]))return r.cancelMoveAttempt(),z.SUCCESS;const s=r.getState().getPieceAt(e),i=r.getState().getCurrentPlayer();if(s.isCommandedBy(i))return r.cancelMoveAttempt(),r.trySelectingPiece(e);if(1===r.currentMoveClicks.length&&r.currentMoveClicks[0].getVectorToward(e).isDiagonalOfLength(1)){const c=Js.fromStep(r.currentMoveClicks[0],e).get();return r.chooseMove(c,r.getState())}return r.capture(e)})()}capture(e){var r=this;return I(function*(){const i=r.currentMoveClicks[r.currentMoveClicks.length-1],o=i.getVectorToward(e);if(o.isDiagonalOfLength(2)){const c=new S(i.x+o.x/2,i.y+o.y/2);r.capturedCoords.push(c),r.currentMoveClicks.push(e);const u=Js.fromCapture(r.currentMoveClicks).get();return r.legalMoves.some(h=>h.isPrefix(u))?r.applyPartialCapture():r.chooseMove(u,r.getState())}return r.cancelMove(g6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let e=this.getState().remove(this.currentMoveClicks[0]),r=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const i of this.capturedCoords){const o=this.getState().getPieceAt(i),c=o.getCommander(),u=o.getPiecesUnderCommander();e=e.set(i,u),r=r.capturePiece(c)}return e=e.set(this.currentMoveClicks[this.currentMoveClicks.length-1],r),this.createAdaptedBoardFrom(e),this.rotateAdaptedBoardIfNeeded(),z.SUCCESS}trySelectingPiece(e){var r=this;return I(function*(){return r.getState().getPieceAt(e).isEmpty()?r.cancelMove(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r.selectPiece(e)})()}selectPiece(e){return this.capturedCoords=[],this.legalMoves.some(r=>r.getStartingCoord().equals(e))?(this.currentMoveClicks=[e],this.hideLastMove(),z.SUCCESS):this.cancelMove(g6.THIS_PIECE_CANNOT_MOVE())}showPossibleLandings(e,r){const s=this.rules.getPieceCaptures(r,e);if(0===s.length){const i=this.rules.getPieceSteps(r,e);for(const o of i)this.getSpaceInfoAt(o.getEndingCoord()).squareClasses.push("selectable-fill")}else{const i=s.map(o=>o.coords.get(1));for(const o of i)this.getSpaceInfoAt(o).squareClasses.push("capturable-fill")}}getTranslate(e,r,s){const i=this.getCoordTranslate(e,r,s,this.mode);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(r=>r.x+", "+r.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const e=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(e[0],e[1],e[2],e[3])}getParallelogramCenterOf(e,r,s,i){const o=Math.max(e.x,r.x,s.x,i.x),c=Math.max(e.y,r.y,s.y,i.y),u=Math.min(e.x,r.x,s.x,i.x),h=Math.min(e.y,r.y,s.y,i.y);return new S((o-u)/2,(c-h)/2)}getRightEdge(){const e=this.basicWidth*this.mode.horizontalWidthRatio,r=this.basicWidth*this.mode.offsetRatio;return[r+e,0,r+e,this.THICKNESS,e,this.basicWidth+this.THICKNESS,e,this.basicWidth].join(" ")}getPieceTranslate(e){return"translate(0 "+(this.getParallelogramCenter().y-32.5-e*(.15*this.SPACE_SIZE))+")"}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-lasca"]],features:[l],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),A()(),x(5,I0t,2,1,"g",4),X(6,"rect",5)(7,"polygon",6),A()),2&e&&(D("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),T(5),w("ngForOf",r.adaptedBoard.spaceInfo),T(1),D("y",r.basicWidth)("width",r.basicWidth*r.mode.horizontalWidthRatio)("height",r.THICKNESS),T(1),D("points",r.getRightEdge()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),wi=(()=>{class n extends Ur{static getInitialState(){const e=pe.NONE,r=pe.ZERO,s=pe.ONE;return new n([[e,r,r,r,r,r,r,e],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[e,r,r,r,r,r,r,e]],0)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}}return n.SIZE=8,n})();class Qi extends c8{constructor(t,e,r){super(t,e),this.direction=r,this.direction=Oe.factory.fromMove(t,e).get()}static from(t,e){const r=Oe.factory.fromMove(t,e);return r.isFailure()?_e.failure(r.getReason()):t.isNotInRange(wi.SIZE,wi.SIZE)?_e.failure("start coord is not in range"):e.isNotInRange(wi.SIZE,wi.SIZE)?_e.failure("end coord is not in range"):_e.success(new Qi(t,e,r.get()))}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}encode(){return Qi.encoder.encode(this)}decode(t){return Qi.encoder.decode(t)}}Qi.encoder=io.getFallibleEncoder(Qi.from);let qH=(()=>{class n{}return n.INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`,n.CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`,n.PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`,n})();class Rs extends L1{constructor(){super(wi)}static get(){return Rs.singleton.isAbsent()&&(Rs.singleton=y.of(new Rs)),Rs.singleton.get()}static getListMovesFromState(t){const e=[];if(Rs.getVictory(t).isPresent())return e;for(let r=0;r<wi.SIZE;r++)for(let s=0;s<wi.SIZE;s++){const i=new S(s,r);if(t.getPieceAt(i).isPlayer())for(const c of Rs.possibleTargets(t,i)){const u=Qi.from(i,c).get();e.push(u)}}return e}static getNumberOfGroups(t){const e=Qe.createTable(wi.SIZE,wi.SIZE,-1),r=[0,0];let s=0;for(let i=0;i<wi.SIZE;i++)for(let o=0;o<wi.SIZE;o++)if(-1===e[i][o]){const c=t.getPieceAt(new S(o,i));c.isPlayer()&&(s+=1,Rs.markGroupStartingAt(t,e,new S(o,i),s),r[c.value]+=1)}return r}static markGroupStartingAt(t,e,r,s){const i=[r],o=t.getPieceAt(r);for(;i.length>0;){const c=Se.getNonNullable(i.pop());if(-1===e[c.y][c.x]){const u=t.getPieceAt(c);if(u===o){e[c.y][c.x]=s;for(const h of Oe.DIRECTIONS){const g=c.getNext(h);t.isOnBoard(g)&&i.push(g)}}else u===pe.NONE&&(e[c.y][c.x]=0)}}}applyLegalMove(t,e,r){const s=e.getCopiedBoard();return s[t.getStart().y][t.getStart().x]=pe.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer(),new wi(s,e.turn+1)}static isLegal(t,e){return e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?z.failure(tt.MUST_CHOOSE_PLAYER_PIECE()):t.length()!==this.numberOfPiecesOnLine(e,t.getStart(),t.direction)?z.failure(qH.INVALID_MOVE_LENGTH()):t.getStart().getCoordsToward(t.getEnd()).some(r=>e.getPieceAt(r)===e.getCurrentOpponent())?z.failure(qH.CANNOT_JUMP_OVER_OPPONENT()):e.getPieceAt(t.getEnd())===e.getCurrentPlayer()?z.failure(tt.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):z.SUCCESS}isLegal(t,e){return Rs.isLegal(t,e)}static numberOfPiecesOnLine(t,e,r){let s=0;for(const i of Rs.getLineCoords(e,r))t.getPieceAt(i).isPlayer()&&(s+=1);return s}static getLineCoords(t,e){const r=Rs.getEntranceAndForwardDirection(t,e);let s=r[0];const i=r[1],o=[];for(;wi.isOnBoard(s);)o.push(s),s=s.getNext(i);return o}static getEntranceAndForwardDirection(t,e){switch(e){case Oe.UP:case Oe.DOWN:return[new S(t.x,0),Oe.DOWN];case Oe.LEFT:case Oe.RIGHT:return[new S(0,t.y),Oe.RIGHT];case Oe.UP_RIGHT:case Oe.DOWN_LEFT:return[new S(Math.max(0,t.x+t.y-7),Math.min(7,t.x+t.y)),Oe.UP_RIGHT];default:return Se.expectToBeMultiple(e,[Oe.UP_LEFT,Oe.DOWN_RIGHT]),[new S(t.x-Math.min(t.x,t.y),t.y-Math.min(t.x,t.y)),Oe.DOWN_RIGHT]}}static getVictory(t){const[e,r]=Rs.getNumberOfGroups(t);return 1===e&&1===r?y.of(pe.NONE):1===e?y.of(B.ZERO):1===r?y.of(B.ONE):y.empty()}static possibleTargets(t,e){const r=[];for(const s of Oe.DIRECTIONS){const i=Rs.numberOfPiecesOnLine(t,e,s),o=e.getNext(s,i);if(t.isOnBoard(o)){const c=Qi.from(e,o).get();Rs.isLegal(c,t).isSuccess()&&r.push(o)}}return r}getGameStatus(t){const e=t.gameState,[r,s]=Rs.getNumberOfGroups(e);return 1===r&&s>1?xe.ZERO_WON:r>1&&1===s?xe.ONE_WON:xe.ONGOING}}Rs.singleton=y.empty();class k0t extends xs{getListMoves(t){return Rs.getListMovesFromState(t.gameState)}getMetrics(t){const e=t.gameState,[r,s]=Rs.getNumberOfGroups(e);return[100/r,100/s]}}const Y=pe.NONE,lr=pe.ZERO,rr=pe.ONE;class P3e{constructor(){this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new wi([[Y,Y,Y,Y,Y,Y,Y,Y],[rr,Y,Y,Y,lr,Y,Y,rr],[Y,Y,lr,lr,rr,Y,Y,Y],[Y,Y,Y,lr,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y]],0)),ie.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,wi.getInitialState(),Qi.from(new S(1,7),new S(1,5)).get(),$localize`Congratulations!`),ie.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new wi([[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,rr,lr,lr,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,rr],[Y,Y,Y,Y,Y,Y,Y,lr]],0),[Qi.from(new S(3,1),new S(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),ie.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new wi([[Y,Y,Y,Y,Y,Y,rr,Y],[Y,Y,Y,Y,Y,lr,Y,Y],[Y,Y,Y,Y,rr,Y,Y,Y],[Y,Y,Y,lr,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,rr],[Y,Y,Y,Y,Y,rr,Y,rr],[Y,Y,Y,lr,Y,Y,rr,rr],[Y,Y,Y,lr,Y,Y,Y,Y]],0),[Qi.from(new S(3,3),new S(3,0)).get(),Qi.from(new S(3,3),new S(0,0)).get(),Qi.from(new S(3,3),new S(2,3)).get(),Qi.from(new S(3,3),new S(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),ie.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new wi([[Y,lr,Y,lr,lr,lr,lr,Y],[rr,Y,Y,Y,Y,Y,Y,rr],[Y,Y,lr,Y,rr,Y,Y,Y],[rr,Y,Y,Y,Y,Y,Y,rr],[rr,Y,Y,Y,Y,Y,Y,rr],[rr,Y,Y,Y,Y,Y,Y,rr],[rr,Y,Y,Y,Y,Y,Y,rr],[Y,lr,lr,lr,lr,lr,lr,Y]],0),Qi.from(new S(2,2),new S(4,2)).get(),(t,e,r)=>e.getPieceAt(t.getEnd())===pe.ONE?z.SUCCESS:z.failure($localize`Failed. Try again.`),$localize`Congratulations!`),ie.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new wi([[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[lr,Y,Y,lr,rr,lr,Y,Y],[Y,Y,Y,lr,Y,Y,Y,rr],[Y,Y,Y,Y,Y,Y,Y,rr],[Y,Y,Y,Y,Y,Y,Y,rr],[Y,Y,Y,Y,Y,Y,Y,rr],[Y,Y,Y,Y,Y,Y,Y,Y]],0),[Qi.from(new S(0,2),new S(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)]}}function L0t(n,t){if(1&n&&(F(),X(0,"circle",4)),2&n){const e=C().index,r=C().index,s=C();Re("id","piece_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),D("cx",s.SPACE_SIZE/2+e*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+r*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function R0t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"g",3),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),X(2,"rect",4),x(3,L0t,1,6,"circle",5),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Re("id","click_",r,"_",s,""),T(1),Re("id","space_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e!==i.EMPTY)}}function D0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,R0t,4,10,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function z0t(n,t){if(1&n){const e=Ae();F(),O(0,"rect",6),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();D("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}let V0t=(()=>{class n extends Ho{constructor(e){super(e),this.INDICATOR_SIZE=20,this.EMPTY=pe.NONE,this.targets=[],this.selected=y.empty(),this.lastMove=y.empty(),this.captured=y.empty(),this.rules=Rs.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new k0t(this.rules,"LinesOfActionMinimax")],this.encoder=Qi.encoder,this.tutorial=(new P3e).tutorial,this.updateBoard()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);if(s.selected.equalsValue(o))return s.cancelMoveAttempt(),z.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(o)===c?s.select(o):s.concludeMove(o)})()}concludeMove(e){var r=this;return I(function*(){const s=Qi.from(r.selected.get(),e);return s.isSuccess()?r.chooseMove(s.get(),r.node.gameState):r.cancelMove(s.getReason())})()}select(e){var r=this;return I(function*(){return r.getState().getPieceAt(e)!==r.getState().getCurrentPlayer()?r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE()):(r.selected=y.of(e),r.targets=Rs.possibleTargets(r.getState(),r.selected.get()),0===r.targets.length?r.cancelMove(qH.PIECE_CANNOT_MOVE()):z.SUCCESS)})()}updateBoard(){this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.node.move}showLastMove(e){this.captured=this.getPreviousState().getPieceAt(e.getEnd()).isPlayer()?y.of(e.getEnd()):y.empty()}cancelMoveAttempt(){this.selected=y.empty(),this.targets=[]}getSquareClasses(e,r){const s=new S(e,r);if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(i)||s.equals(o))return["moved-fill"]}return[]}getPieceClasses(e,r){const s=this.board[r][e],i=new S(e,r),o=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(i)&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-linesofaction"]],features:[l],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,D0t,2,1,"g",1),x(2,z0t,1,4,"rect",2),A()),2&e&&(T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.targets))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class W4 extends Ks{constructor(t,e,r,s={top:0,bottom:0,left:0,right:0}){super(t.x,t.y),this.direction=e,this.orientation=r,this.captures=s}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(t){return this===t||!(!1===this.coord.equals(t.coord)||this.orientation!==t.orientation||this.direction!==t.direction||this.captures.top!==t.captures.top||this.captures.bottom!==t.captures.bottom||this.captures.left!==t.captures.left||this.captures.right!==t.captures.right)}}W4.encoder=new class extends xt{encodeMove(n){return{coord:S.encoder.encode(n.coord),direction:n.direction,orientation:n.orientation,captures:n.captures}}decodeMove(n){const t=n;return Le(null!=t.coord,"Invalid encoded LodestoneMove"),Le(null!=t.direction,"Invalid encoded LodestoneMove"),Le(null!=t.orientation,"Invalid encoded LodestoneMove"),Le(null!=t.captures,"Invalid encoded LodestoneMove"),new W4(S.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}};class ao{constructor(t){this.unreachable=t}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(t){return this===t}}ao.UNREACHABLE=new ao(!0),ao.EMPTY=new ao(!1);class Zc{constructor(t){this.owner=t}static of(t){return t===B.ZERO?Zc.ZERO:Zc.ONE}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}Zc.ZERO=new Zc(B.ZERO),Zc.ONE=new Zc(B.ONE);class Wo{constructor(t,e,r){this.owner=t,this.direction=e,this.orientation=r}static of(t,e){return Wo.LODESTONES[t.value][e.direction][e.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}Wo.LODESTONES={0:{push:{diagonal:new Wo(B.ZERO,"push","diagonal"),orthogonal:new Wo(B.ZERO,"push","orthogonal")},pull:{diagonal:new Wo(B.ZERO,"pull","diagonal"),orthogonal:new Wo(B.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new Wo(B.ONE,"push","diagonal"),orthogonal:new Wo(B.ONE,"push","orthogonal")},pull:{diagonal:new Wo(B.ONE,"pull","diagonal"),orthogonal:new Wo(B.ONE,"pull","orthogonal")}}};class vr{constructor(t,e){this.width=t,this.pieces=e}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(t,e){if(this.pieces.length+e>=this.width)return 5===this.width?vr.EMPTY_3.addCaptured(t,e+this.pieces.length-5):(Le(this.pieces.length+e===3,"should never put more pieces than the plate can support"),y.empty());{const r=Qe.copyImmutableArray(this.pieces);for(let s=0;s<e;s++)r.push(Zc.of(t));return y.of(new vr(this.width,r))}}getPieceAt(t){return t<this.pieces.length?this.pieces[t]:ao.EMPTY}}vr.POSITIONS=["top","bottom","left","right"],vr.EMPTY_5=new vr(5,[]),vr.EMPTY_3=new vr(3,[]);let sr=(()=>{class n extends Ur{constructor(e,r,s,i){super(e,r),this.lodestones=s,this.pressurePlates=i}static getInitialState(){const e=ao.EMPTY,r=Zc.ZERO,s=Zc.ONE;return new n([[e,e,r,s,r,s,e,e],[e,r,s,r,s,r,s,e],[r,s,r,s,r,s,r,s],[s,r,s,e,e,r,s,r],[r,s,r,e,e,s,r,s],[s,r,s,r,s,r,s,r],[e,s,r,s,r,s,r,e],[e,e,s,r,s,r,e,e]],0,new Wn,{top:y.of(vr.EMPTY_5),bottom:y.of(vr.EMPTY_5),left:y.of(vr.EMPTY_5),right:y.of(vr.EMPTY_5)})}withBoard(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}remainingSpacesDetails(){const e={top:0,bottom:0,left:0,right:0};for(const r of vr.POSITIONS){const s=this.pressurePlates[r];s.isPresent()&&(e[r]=s.get().remainingSpaces())}return e}numberOfPieces(){const e=[0,0];for(let r=0;r<n.SIZE;r++)for(let s=0;s<n.SIZE;s++){const i=this.getPieceAtXY(s,r);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}getScores(){const e=this.numberOfPieces();return[24-e[1],24-e[0]]}nextLodestoneDirection(){const e=this.getCurrentPlayer(),r=this.lodestones.get(e);if(!r.isPresent())return y.empty();{const s=this.getPieceAt(r.get());switch(Le(s.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+r.get()),s.direction){case"push":return y.of("pull");case"pull":return y.of("push")}}}}return n.SIZE=8,n})();const je=ao.UNREACHABLE,fe=ao.EMPTY,_s=Zc.ZERO,co=Zc.ONE,n_=Wo.of(B.ONE,{direction:"push",orientation:"orthogonal"}),WH={top:y.of(vr.EMPTY_5),bottom:y.of(vr.EMPTY_5),left:y.of(vr.EMPTY_5),right:y.of(vr.EMPTY_5)};class T3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,sr.getInitialState()),ie.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,sr.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),ie.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,sr.getInitialState()),ie.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,sr.getInitialState()),ie.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,sr.getInitialState()),ie.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,sr.getInitialState(),new W4(new S(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,e,r)=>32===r.remainingSpaces()?z.failure($localize`You have not captured any of the opponent's pieces, try again!`):z.SUCCESS,$localize`Congratulations!`),ie.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new sr([[fe,fe,fe,fe,co,fe,fe,fe],[fe,fe,_s,fe,fe,co,fe,fe],[fe,fe,n_,fe,fe,fe,fe,_s],[fe,fe,fe,fe,co,fe,fe,_s],[fe,fe,fe,fe,fe,_s,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe]],0,new Wn([{key:B.ONE,value:new S(2,2)}]),{...WH,top:vr.EMPTY_5.addCaptured(B.ONE,4)}),new W4(new S(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>5===r.pressurePlates.top.get().width?z.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):z.SUCCESS,$localize`Congratulations!`),ie.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new sr([[je,je,je,je,je,je,je,je],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,_s],[fe,fe,fe,fe,fe,_s,fe,_s],[fe,n_,fe,fe,co,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,co,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe]],0,new Wn([{key:B.ONE,value:new S(1,4)}]),{...WH,top:vr.EMPTY_3.addCaptured(B.ONE,2)}),new W4(new S(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>r.pressurePlates.top.isPresent()?z.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):z.SUCCESS,$localize`Congratulations!`),ie.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new sr([[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je],[je,je,_s,co,fe,fe,je,je],[je,je,n_,co,fe,fe,je,je],[je,je,fe,_s,_s,fe,je,je],[je,je,_s,fe,fe,fe,je,je],[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je]],0,new Wn([{key:B.ONE,value:new S(2,3)}]),{top:y.empty(),bottom:y.empty(),left:y.empty(),right:y.empty()})),ie.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new sr([[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,co,fe,fe],[fe,fe,fe,n_,fe,fe,_s,fe],[fe,fe,_s,_s,co,fe,fe,_s],[fe,fe,fe,fe,fe,_s,fe,fe],[fe,fe,_s,fe,fe,fe,fe,fe],[fe,fe,co,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe]],0,new Wn([{key:B.ONE,value:new S(3,2)}]),{...WH,top:vr.EMPTY_5.addCaptured(B.ONE,4)}),[new W4(new S(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),ie.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new sr([[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je],[je,co,_s,co,fe,fe,je,je],[je,co,n_,fe,co,fe,je,je],[je,fe,fe,_s,_s,fe,je,je],[je,co,_s,fe,co,fe,je,je],[je,fe,fe,fe,_s,fe,je,je],[je,je,je,je,je,je,je,je]],0,new Wn([{key:B.ONE,value:new S(2,3)}]),{top:y.empty(),bottom:vr.EMPTY_3.addCaptured(B.ZERO,2),left:y.of(vr.EMPTY_3),right:y.empty()}),[new W4(new S(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)]}}let zh=(()=>{class n{}return n.MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`,n.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`,n.TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`,n.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`,n.MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`,n.NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`,n})();class H2 extends L1{constructor(){super(sr)}static get(){return H2.singleton.isAbsent()&&(H2.singleton=y.of(new H2)),H2.singleton.get()}applyLegalMove(t,e,r){const s=e.getCurrentPlayer(),i=s.getOpponent(),o=Qe.copyBiArray(r.board),c=e.lodestones.getCopy();c.put(s,t.coord);const u={...e.pressurePlates};return this.updatePressurePlates(o,u,c,i,t.captures),new sr(o,e.turn+1,c,u)}updatePressurePlates(t,e,r,s,i){for(const o of vr.POSITIONS)e[o]=this.updatePressurePlate(t,o,e[o],r,s,i[o])}updatePressurePlate(t,e,r,s,i,o){if(r.isPresent()){const c=r.get().addCaptured(i,o),u=H2.THREATENED_COORD_RANGE.get(e).get();return c.isAbsent()?(this.removePressurePlate(t,u.startForBigPlate,u.direction,s),this.removePressurePlate(t,u.startForSmallPlate,u.direction,s)):c.get().width<r.get().width&&this.removePressurePlate(t,u.startForBigPlate,u.direction,s),c}return r}removePressurePlate(t,e,r,s){for(let i=e;i.isInRange(sr.SIZE,sr.SIZE);i=i.getNext(r)){for(const o of B.PLAYERS)s.get(o).equalsValue(i)&&s.delete(o);t[i.y][i.x]=ao.UNREACHABLE}}isLegal(t,e){const r=this.isLegalWithoutCaptures(e,t.coord,t.direction);if(r.isFailure())return _e.failure(r.getReason());const s=this.applyMoveWithoutPlacingCaptures(e,t.coord,t);if(t.captures.top+t.captures.bottom+t.captures.left+t.captures.right!==Math.min(s.captures.length,e.remainingSpaces()))return _e.failure(zh.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const c of vr.POSITIONS){const u=e.pressurePlates[c];if(u.isPresent()&&u.get().remainingSpaces()<t.captures[c])return _e.failure(zh.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return _e.success(s)}applyMoveWithoutPlacingCaptures(t,e,r){let s;const i=Qe.copyBiArray(t.board),o=t.lodestones.get(t.getCurrentPlayer());if(o.isPresent()){const c=o.get();i[c.y][c.x]=ao.EMPTY}return s="pull"===r.direction?this.applyPull(t,i,e,r.orientation):this.applyPush(t,i,e,r.orientation),s.board[e.y][e.x]=Wo.of(t.getCurrentPlayer(),r),s.moved.push(e),s}applyPull(t,e,r,s){const i=t.getCurrentPlayer(),o=i.getOpponent(),c=[],u=[],h="diagonal"===s?Oe.DIAGONALS:Oe.ORTHOGONALS;for(const g of h)for(let m=r.getNext(g);t.isOnBoard(m);m=m.getNext(g)){const E=e[m.y][m.x],b=m.getNext(g);if(t.isOnBoard(b)){const k=e[b.y][b.x];k.isPlayerPiece()&&k.owner===i&&(E.isEmpty()?(u.push(m),e[m.y][m.x]=k,u.push(b),e[b.y][b.x]=ao.EMPTY):E.isPlayerPiece()&&E.owner===o&&(c.push(m),e[m.y][m.x]=k,u.push(b),e[b.y][b.x]=ao.EMPTY))}}return{board:e,captures:c,moved:u}}applyPush(t,e,r,s){const o=t.getCurrentPlayer().getOpponent(),c=[],u=[],h="diagonal"===s?Oe.DIAGONALS:Oe.ORTHOGONALS;for(const g of h)for(let E=r.getNext(g,sr.SIZE);!1===E.equals(r);E=E.getPrevious(g))if(t.isOnBoard(E)){const b=e[E.y][E.x];if(b.isPlayerPiece()&&b.owner===o){const k=E.getNext(g);if(t.isOnBoard(k)){const U=e[k.y][k.x];U.isUnreachable()?(c.push(E),e[E.y][E.x]=ao.EMPTY):U.isEmpty()&&(u.push(k),e[k.y][k.x]=b,u.push(E),e[E.y][E.x]=ao.EMPTY)}else c.push(E),e[E.y][E.x]=ao.EMPTY}}return{board:e,captures:c,moved:u}}isLegalWithoutCaptures(t,e,r){const s=this.isTargetLegal(t,e);if(s.isFailure())return s;const i=t.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(r))?z.failure(zh.MUST_FLIP_LODESTONE()):z.SUCCESS}isTargetLegal(t,e){const r=t.getPieceAt(e);if(r.isUnreachable())return z.failure(zh.TARGET_IS_CRUMBLED());if(r.isPlayerPiece())return z.failure(tt.MUST_CLICK_ON_EMPTY_SQUARE());const s=t.getCurrentPlayer();return r.isLodestone()&&r.owner!==s?z.failure(tt.MUST_CLICK_ON_EMPTY_SQUARE()):z.SUCCESS}getGameStatus(t){const r=t.gameState.numberOfPieces();return 0===r[0]&&0===r[1]?xe.DRAW:0===r[0]?xe.ONE_WON:0===r[1]?xe.ZERO_WON:xe.ONGOING}}H2.THREATENED_COORD_RANGE=Wn.from({top:{startForBigPlate:new S(0,0),startForSmallPlate:new S(0,1),direction:Oe.RIGHT},bottom:{startForBigPlate:new S(0,sr.SIZE-1),startForSmallPlate:new S(0,sr.SIZE-2),direction:Oe.RIGHT},left:{startForBigPlate:new S(0,0),startForSmallPlate:new S(1,0),direction:Oe.DOWN},right:{startForBigPlate:new S(sr.SIZE-1,0),startForSmallPlate:new S(sr.SIZE-2,0),direction:Oe.DOWN}}),H2.singleton=y.empty();class H0t extends Dc{getListMoves(t){const e=t.gameState;return this.flatMapEmptyCoords(e,r=>{const s=[];for(const i of this.nextDirection(e)){const o=["diagonal","orthogonal"];for(const c of o){const g=H2.get().applyMoveWithoutPlacingCaptures(e,r,{direction:i,orientation:c}).captures.length;for(const m of this.captureCombinations(e,g))s.push(new W4(r,i,c,m))}}return s})}captureCombinations(t,e){if(0===e)return new bt([{top:0,bottom:0,left:0,right:0}]);{const r=new bt,s=t.remainingSpacesDetails(),i=this.captureCombinations(t,e-1);for(const o of i)o.top+1<=s.top&&r.add({...o,top:o.top+1}),o.bottom+1<=s.bottom&&r.add({...o,bottom:o.bottom+1}),o.left+1<=s.left&&r.add({...o,left:o.left+1}),o.right+1<=s.right&&r.add({...o,right:o.right+1});return 0===r.size()?i:r}}flatMapEmptyCoords(t,e){let r=[];for(let s=0;s<sr.SIZE;s++)for(let i=0;i<sr.SIZE;i++){const o=new S(i,s),c=t.getPieceAt(o);(c.isEmpty()&&!1===c.isUnreachable()||c.isLodestone()&&c.owner===t.getCurrentPlayer())&&(r=r.concat(e(o)))}return r}nextDirection(t){const e=t.nextLodestoneDirection();return e.isPresent()?[e.get()]:["push","pull"]}getBoardValue(t){const e=t.gameState.getScores();let r;return r=24===e[0]&&24!==e[1]?B.ZERO.getVictoryValue():24!==e[0]&&24===e[1]?B.ONE.getVictoryValue():M1.from(e[0],e[1]).value,new M1(r)}}function F0t(n,t){if(1&n&&(F(),X(0,"circle",10)),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();Re("id","piece_",r,"_",i,""),w("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function B0t(n,t){if(1&n&&(F(),X(0,"polygon",15)),2&n){const e=C().$implicit,r=C(3).$implicit,s=C(2);Su("transform","rotate(",90*e,")"),w("ngClass",r.lodestone.movingClass),D("points",s.TRIANGLE_OUT)}}function $0t(n,t){if(1&n&&(F(),X(0,"polygon",15)),2&n){const e=C().$implicit,r=C(3).$implicit,s=C(2);Su("transform","rotate(",90*e,")"),w("ngClass",r.lodestone.movingClass),D("points",s.TRIANGLE_IN)}}function U0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,B0t,1,3,"polygon",14),x(2,$0t,1,3,"polygon",14),A()),2&n){const e=C(3).$implicit;T(1),w("ngIf","push"===e.lodestone.direction),T(1),w("ngIf","pull"===e.lodestone.direction)}}const w3e=function(){return[0,1,2,3]};function G0t(n,t){if(1&n&&(F(),O(0,"g",11),X(1,"circle",12)(2,"circle",13),O(3,"g"),x(4,U0t,3,2,"g",1),A()()),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();D("transform",o.getSquareTransform(r,i)),T(1),w("ngClass",s.lodestone.selectedClass),D("r",o.PIECE_RADIUS),T(1),w("ngClass",s.lodestone.pieceClasses),D("r",o.PIECE_RADIUS/4),T(1),Su("transform","rotate(","diagonal"===s.lodestone.orientation?45:0,")"),T(1),w("ngForOf",J1(7,w3e))}}function q0t(n,t){if(1&n){const e=Ae();F(),O(0,"g",6),ee("click",function(){he(e);const s=C().$implicit;return le(C(2).selectCoord(s.coord))}),X(1,"rect",7),x(2,F0t,1,6,"circle",8),x(3,G0t,5,8,"g",9),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();Re("id","square_",r,"_",i,""),T(1),w("ngClass",s.squareClasses),D("x",o.SPACE_SIZE*r+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),T(1),w("ngIf",s.hasPiece),T(1),w("ngIf",s.lodestone)}}function W0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,q0t,4,9,"g",5),A()),2&n){const e=t.$implicit;T(1),w("ngIf",!1===e.crumbled)}}function j0t(n,t){if(1&n&&(F(),O(0,"g"),x(1,W0t,2,1,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function Z0t(n,t){if(1&n&&(F(),O(0,"g",16),X(1,"circle",17),A()),2&n){const e=t.$implicit,r=t.index,s=C();d1("id","capture_",r,""),D("transform",s.getCaptureTransform(r)),T(1),w("ngClass",e.pieceClasses),D("r",s.PIECE_RADIUS)}}function Y0t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"polygon",15),A()),2&n){const e=t.$implicit,r=C().$implicit,s=C();T(1),Su("transform","rotate(",90*e,")"),w("ngClass",r.movingClass),D("points","push"===r.direction?s.TRIANGLE_OUT:s.TRIANGLE_IN)}}function K0t(n,t){if(1&n){const e=Ae();F(),O(0,"g",6),ee("click",function(){const i=he(e).$implicit;return le(C().selectLodestone(i))}),X(1,"circle",12)(2,"circle",13),O(3,"g"),x(4,Y0t,2,3,"g",1),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C();Re("id","lodestone_",e.direction,"_",e.orientation,""),D("transform",s.getAvailableLodestoneTransform(r)),T(1),w("ngClass",e.selectedClass),D("r",s.PIECE_RADIUS),T(1),w("ngClass",e.pieceClasses),D("r",s.PIECE_RADIUS/4),T(1),Su("transform","rotate(","diagonal"===e.orientation?45:0,")"),T(1),w("ngForOf",J1(9,w3e))}}function X0t(n,t){if(1&n&&(F(),X(0,"circle",10)),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().$implicit,o=C();Re("id","platePiece_",i.position,"_",r,""),w("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*s.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Q0t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"g",6),ee("click",function(){const s=he(e),i=s.$implicit,o=s.index,c=C().$implicit;return le(C().onPressurePlateClick(i.temporary,c.position,o))}),X(2,"rect",18),x(3,X0t,1,6,"circle",8),A()()}if(2&n){const e=t.$implicit,r=t.index,s=C().$implicit,i=C();D("transform",i.getPressurePlateTransform(s.position)),T(1),Re("id","plate_",s.position,"_",r,""),T(1),Re("id","plateSquare_",s.position,"_",r,""),w("ngClass",e.squareClasses),D("x",i.SPACE_SIZE*e.coord.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*e.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e.hasPiece)}}function J0t(n,t){if(1&n&&(F(),O(0,"g",16),x(1,Q0t,4,11,"g",1),A()),2&n){const e=t.$implicit;d1("id","pressurePlate_",e.position,""),T(1),w("ngForOf",e.coords)}}function e8t(n,t){if(1&n&&(F(),X(0,"rect",19)),2&n){const e=C();Re("id","selection_",e.viewInfo.selected.get().x,"_",e.viewInfo.selected.get().y,""),D("x",e.SPACE_SIZE*e.viewInfo.selected.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.viewInfo.selected.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}class F2 extends i8{constructor(t){super(t),this.viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:y.empty(),pressurePlateShift:{top:new $t(0,0),left:new $t(0,0),right:new $t(0,0),bottom:new $t(0,0)}},this.stateAfterPlacingLodestone=y.empty(),this.lastInfos=y.empty(),this.capturesToPlace=0,this.selectedCoord=y.empty(),this.selectedLodestone=y.empty(),this.captures={top:0,bottom:0,left:0,right:0},this.rules=H2.get(),this.node=this.rules.getInitialNode(),this.tutorial=(new T3e).tutorial,this.availableMinimaxes=[new H0t(this.rules,"LodestoneDummyMinimax")],this.encoder=W4.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const e=.8*this.PIECE_RADIUS,r=.3*this.PIECE_RADIUS,s=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${e},0 ${r},${s} ${r},-${s}`,this.TRIANGLE_IN=`${r},0 ${e},${r} ${e},-${r}`,this.displayedState=this.getState(),this.scores=y.of([0,0])}ngOnInit(){this.updateBoard()}selectCoord(t){var e=this;return I(function*(){const r=e.canUserPlay("#square_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());if(e.capturesToPlace>0)return e.cancelMove(zh.MUST_PLACE_CAPTURES());const s=H2.get().isTargetLegal(e.getState(),t);return s.isFailure()?e.cancelMove(s.getReason()):e.selectedCoord.equalsValue(t)?(e.cancelMoveAttempt(),z.SUCCESS):(e.selectedCoord=y.of(t),e.selectedLodestone.isPresent()?e.putLodestone():(e.updateViewInfo(),z.SUCCESS))})()}selectLodestone(t){var e=this;return I(function*(){const r=e.canUserPlay("#lodestone_"+t.direction+"_"+t.orientation);if(r.isFailure())return e.cancelMove(r.getReason());Le(0===e.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const s=e.getCurrentPlayer(),i=Wo.of(s,t);return e.selectedLodestone.equalsValue(i)?(e.cancelMoveAttempt(),z.SUCCESS):(e.selectedLodestone=y.of(i),e.selectedCoord.isPresent()?e.putLodestone():(e.updateViewInfo(),z.SUCCESS))})()}putLodestone(){var t=this;return I(function*(){Le(t.selectedCoord.isPresent(),"coord should have been selected"),Le(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=t.getState();Le(H2.get().isLegalWithoutCaptures(s,e,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=H2.get().applyMoveWithoutPlacingCaptures(s,e,r);return t.lastInfos=y.of(o),t.capturesToPlace=Math.min(o.captures.length,s.remainingSpaces()),0===t.capturesToPlace?t.applyMove():(t.displayedState=t.displayedState.withBoard(o.board),t.stateAfterPlacingLodestone=y.of(t.displayedState),t.updateViewInfo(),z.SUCCESS)})()}applyMove(){var t=this;return I(function*(){Le(t.selectedCoord.isPresent(),"coord should have been selected"),Le(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=new W4(e,r.direction,r.orientation,t.captures);return t.chooseMove(s,t.getState())})()}onPressurePlateClick(t,e,r){return t?this.deselectPressurePlate(e,r):this.selectPressurePlate(e,r)}selectPressurePlate(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(0===r.capturesToPlace)return r.cancelMove(zh.NO_CAPTURES_TO_PLACE_YET());r.capturesToPlace--,r.captures[t]++;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Qe.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return H2.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new sr(c,i.turn,h,u),0===r.capturesToPlace?r.applyMove():(r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),z.SUCCESS)})()}deselectPressurePlate(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());r.capturesToPlace++,r.captures[t]--;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Qe.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return H2.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new sr(c,i.turn,h,u),r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),z.SUCCESS})()}updateBoard(){this.cancelMoveAttempt(),this.scores=y.of(this.getState().getScores())}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=y.empty(),this.lastInfos=y.empty();const t=this.displayedState.lodestones.get(this.getCurrentPlayer());if(t.isPresent()){const e=Qe.copyBiArray(this.displayedState.board);e[t.get().y][t.get().x]=ao.EMPTY,this.displayedState=this.displayedState.withBoard(e)}this.selectedCoord=y.empty(),this.selectedLodestone=y.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let t=0;t<sr.SIZE;t++){this.viewInfo.boardInfo.push([]);for(let e=0;e<sr.SIZE;e++){const r=new S(e,t);this.viewInfo.boardInfo[t].push(this.getSquareInfo(r))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:y.empty()}getSquareInfo(t){const e=this.displayedState.getPieceAt(t),r={coord:t,squareClasses:[],crumbled:e.isUnreachable(),hasPiece:e.isPlayerPiece(),pieceClasses:[]};return e.isPlayerPiece()&&(r.pieceClasses=[this.getPlayerClass(e.owner)]),e.isLodestone()&&(r.lodestone={direction:e.direction,pieceClasses:[this.getPlayerClass(e.owner)],selectedClass:"",movingClass:"",orientation:e.orientation},r.lodestone.movingClass=this.getPlayerClass("push"===e.direction?e.owner.getOpponent():e.owner)),r}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const t=this.getState().getCurrentPlayer(),e=this.getState().nextLodestoneDirection();if(e.isPresent()){const r=e.get();this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:r,orientation:"orthogonal"}),this.nextLodestone(t,{direction:r,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"push",orientation:"diagonal"}),this.nextLodestone(t,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const t=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(let e=0;e<this.capturesToPlace;e++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(t)]})}nextLodestone(t,e){const r=Wo.of(t,e),s={direction:r.direction,orientation:r.orientation,pieceClasses:[this.getPlayerClass(r.owner)],movingClass:"",selectedClass:""};return s.movingClass=this.getPlayerClass("push"===r.direction?r.owner.getOpponent():r.owner),this.selectedLodestone.equalsValue(r)&&(s.selectedClass="selected-stroke"),s}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const t of vr.POSITIONS){const e=[],r=this.displayedState.pressurePlates[t];if(r.isPresent()){const s=F2.PRESSURE_PLATES_POSITIONS.get(t).get(),i=r.get().width;let o=5===i?s.startForBigPlate:s.startForSmallPlate;for(let c=0;c<i;c++){o=o.getNext(s.direction);const u=r.get().getPieceAt(c);let h="";u.isPlayerPiece()&&(h=this.getPlayerClass(u.owner)),e.push({coord:o,hasPiece:u.isPlayerPiece(),pieceClasses:[h],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:t,coords:e})}}showLastMove(t){const e=this.getPreviousState();this.lastInfos=y.of(H2.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();const r=this.getState();this.showPressurePlateDifferences(e,r,!1)}showPressurePlateDifferences(t,e,r){for(const s of vr.POSITIONS)this.showPressurePlateDifference(t.pressurePlates[s],e.pressurePlates[s],s,r)}showPressurePlateDifference(t,e,r,s){if(t.isPresent()&&e.isPresent()){const i=t.get(),o=e.get(),c=Se.getNonNullable(this.viewInfo.pressurePlates.find(u=>u.position===r));if(i.width===o.width)for(let u=0;u<o.width;u++){const h=i.getPieceAt(u),g=o.getPieceAt(u);!1===h.equals(g)&&(c.coords[u].squareClasses.push("moved-fill"),c.coords[u].temporary=s,s&&c.coords[u].pieceClasses.push("semi-transparent"))}else for(const u of c.coords)u.squareClasses.push("moved-fill")}}showMovedAndCaptured(t){for(const e of t.moved)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("moved-fill");for(const e of t.captures)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const t=this.displayedState,e=this.getPressurePlateShift(t.pressurePlates.left),r=this.getPressurePlateShift(t.pressurePlates.right),s=this.getPressurePlateShift(t.pressurePlates.top),i=this.getPressurePlateShift(t.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new $t(.5*(e-r),0),this.viewInfo.pressurePlateShift.bottom=new $t(.5*(e-r),0),this.viewInfo.pressurePlateShift.left=new $t(0,.5*(s-i)),this.viewInfo.pressurePlateShift.right=new $t(0,.5*(s-i))}getPressurePlateShift(t){return t.isAbsent()?2:3===t.get().width?1:0}getSquareTransform(t,e){return`translate(${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(t){return`translate(${(t+(sr.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(t){return`translate(${(t+(sr.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(t){return`translate(${this.viewInfo.pressurePlateShift[t].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[t].y*this.SPACE_SIZE})`}}F2.PRESSURE_PLATE_EXTRA_SHIFT=.2,F2.PRESSURE_PLATES_POSITIONS=Wn.from({top:{startForBigPlate:new S(.5,-1-F2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new S(1.5,0-F2.PRESSURE_PLATE_EXTRA_SHIFT),direction:Oe.RIGHT},bottom:{startForBigPlate:new S(.5,8+F2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new S(1.5,7+F2.PRESSURE_PLATE_EXTRA_SHIFT),direction:Oe.RIGHT},left:{startForBigPlate:new S(-1-F2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new S(0-F2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Oe.DOWN},right:{startForBigPlate:new S(8+F2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new S(7+F2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Oe.DOWN}}),F2.\u0275fac=function(t){return new(t||F2)(Q(Mn))},F2.\u0275cmp=ut({type:F2,selectors:[["app-lodestone"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(t,e){1&t&&(F(),O(0,"svg",0),x(1,j0t,2,1,"g",1),x(2,Z0t,2,4,"g",2),x(3,K0t,5,10,"g",3),x(4,J0t,2,2,"g",2),x(5,e8t,1,6,"rect",4),A()),2&t&&(T(1),w("ngForOf",e.viewInfo.boardInfo),T(1),w("ngForOf",e.viewInfo.capturesToPlace),T(1),w("ngForOf",e.viewInfo.availableLodestones),T(1),w("ngForOf",e.viewInfo.pressurePlates),T(1),w("ngIf",e.viewInfo.selected.isPresent()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let ZP=(()=>{class n{}return n.START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`,n.END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`,n.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`,n.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`,n})();class vs extends c8{constructor(t,e,r){super(t,e),this.calledTheClock=r}static from(t,e,r=!1){if(t.isNotInRange(4,8))return _e.failure(ZP.START_COORD_OUT_OF_RANGE());if(e.isNotInRange(4,8))return _e.failure(ZP.END_COORD_OUT_OF_RANGE());if(e.equals(t))return _e.failure(tt.MOVE_CANNOT_BE_STATIC());const s=Oe.factory.fromDelta(e.x-t.x,e.y-t.y);return s.isFailure()?_e.failure(s.getReason()):_e.success(new vs(t,e,r))}toString(){const t=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+t+")"}equals(t){return!1!==this.getStart().equals(t.getStart())&&!1!==this.getEnd().equals(t.getEnd())&&this.calledTheClock===t.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(t){if(t.isAbsent())return!1;const e=t.get();return e.getEnd().equals(this.getStart())&&e.getStart().equals(this.getEnd())}}vs.encoder=xt.tuple([S.encoder,S.encoder,xt.identity()],n=>[n.getStart(),n.getEnd(),n.calledTheClock],n=>vs.from(n[0],n[1],n[2]).get());class Ht{constructor(t){this.value=t}static tryMerge(t,e){Le(t!==Ht.EMPTY&&e!==Ht.EMPTY,"tryMerge cannot be called with empty pieces");const s=t.value+e.value;return 2===s||3===s?y.of(Ht.from(s)):y.empty()}static from(t){return t===Ht.DRONE.value?Ht.DRONE:(Se.expectToBe(t,Ht.QUEEN.value),Ht.QUEEN)}getValue(){return this.value}equals(t){return this.getValue()===t.getValue()}}Ht.EMPTY=new Ht(0),Ht.PAWN=new Ht(1),Ht.DRONE=new Ht(2),Ht.QUEEN=new Ht(3);class D5{constructor(t){this.captures=t,t.makeImmutable()}static from(t){const e=new Wn;for(const r of t)D5.addToMap(e,r);return new D5(e)}static addToMap(t,e){const r=t.get(e);r.isPresent()?t.replace(e,r.get()+1):t.set(e,1)}toValue(){let t=0;return this.captures.forEach(e=>{t+=e.key.getValue()*e.value}),t}add(t){const e=this.captures.getCopy();return D5.addToMap(e,t),new D5(e)}}class ei extends Ur{constructor(t,e,r=y.empty(),s=y.empty(),i){super(t,e),this.lastMove=r,this.countDown=s,null==i&&(i=new Wn([{key:B.ZERO,value:D5.from([])},{key:B.ONE,value:D5.from([])}])),i.makeImmutable(),this.captured=i}static getInitialState(){const t=Ht.EMPTY,e=Ht.PAWN,r=Ht.DRONE,s=Ht.QUEEN;return new ei([[s,s,r,t],[s,r,e,t],[r,e,e,t],[t,t,t,t],[t,t,t,t],[t,e,e,r],[t,e,r,s],[t,r,s,s]],0,y.empty())}getPlayerTerritory(t){return t===B.ZERO?ei.PLAYER_ZERO_TERRITORY:ei.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(t){const e=this.getCurrentPlayer(),r=this.getPlayerTerritory(e);for(const s of r)for(let i=0;i<4;i++)if(this.getPieceAtXY(i,s)===t)return!0;return!1}getScoreOf(t){return this.captured.get(t).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(B.ZERO)?y.of(B.ZERO):this.isTerritoryEmpty(B.ONE)?y.of(B.ONE):y.empty()}isTerritoryEmpty(t){const e=this.getPlayerTerritory(t);for(const r of e)for(let s=0;s<4;s++)if(this.getPieceAtXY(s,r)!==Ht.EMPTY)return!1;return!0}isInOpponentTerritory(t){const e=this.getCurrentOpponent();return this.getPlayerTerritory(e).contains(t.y)}isInPlayerTerritory(t){const e=this.getCurrentPlayer();return this.getPlayerTerritory(e).contains(t.y)}getCapturesOf(t){const e=this.captured.get(t).get();return[e.captures.get(Ht.PAWN).getOrElse(0),e.captures.get(Ht.DRONE).getOrElse(0),e.captures.get(Ht.QUEEN).getOrElse(0)]}}ei.PLAYER_ZERO_TERRITORY=new bt([4,5,6,7]),ei.PLAYER_ONE_TERRITORY=new bt([0,1,2,3]);let b3e=(()=>{class n{}return n.YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`,n})();const ce=Ht.EMPTY,B2=Ht.PAWN,m6=Ht.DRONE,_8=Ht.QUEEN,O3e=()=>$localize`This is not a field promotion!`;class A3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,ei.getInitialState()),ie.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,ei.getInitialState()),ie.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,ei.getInitialState(),vs.from(new S(2,5),new S(1,4)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Ht.PAWN?z.SUCCESS:z.failure($localize`This is not a pawn!`),$localize`Congratulations!`),ie.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,ei.getInitialState(),vs.from(new S(1,7),new S(0,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Ht.DRONE?z.SUCCESS:z.failure($localize`This is not a drone!`),$localize`Congratulations!`),ie.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new ei([[m6,B2,ce,ce],[_8,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,_8,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[_8,m6,B2,ce]],1),vs.from(new S(2,3),new S(2,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Ht.QUEEN?z.SUCCESS:z.failure($localize`This is not a queen!`),$localize`Congratulations!`),ie.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new ei([[m6,B2,B2,ce],[ce,ce,ce,ce],[_8,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,B2,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,m6,B2,ce]],1),[vs.from(new S(0,2),new S(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,b3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),ie.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new ei([[ce,ce,ce,_8],[ce,B2,ce,ce],[ce,ce,B2,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,_8],[ce,ce,m6,ce],[ce,B2,ce,ce]],1),[vs.from(new S(1,1),new S(2,2)).get(),vs.from(new S(2,2),new S(1,1)).get()],$localize`Congratulations!`,O3e()),ie.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new ei([[B2,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,m6,ce],[ce,B2,ce,ce]],0),vs.from(new S(1,7),new S(2,6)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Ht.QUEEN?z.SUCCESS:z.failure(O3e()),$localize`Congratulations!`),ie.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,ei.getInitialState(),vs.from(new S(1,5),new S(0,4),!0).get(),(t,e,r)=>t.calledTheClock?z.SUCCESS:z.failure($localize`You did not call the clock!`),$localize`Congratulations!`),ie.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new ei([[ce,ce,ce,ce],[ce,B2,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,B2],[ce,ce,m6,ce],[ce,B2,ce,ce]],15,y.empty(),y.of(1)),[vs.from(new S(1,1),new S(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),ie.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new ei([[ce,ce,ce,_8],[ce,B2,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[m6,ce,ce,ce],[ce,ce,ce,ce],[ce,m6,ce,ce]],15,y.empty(),y.of(1)),vs.from(new S(1,1),new S(2,2)).get(),$localize`Congratulations!`),ie.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new ei([[ce,ce,ce,_8],[ce,B2,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,B2,ce],[ce,ce,ce,ce],[ce,ce,ce,ce],[ce,ce,ce,ce]],0),vs.from(new S(2,4),new S(1,3)).get(),(t,e,r)=>3===t.getEnd().y?z.SUCCESS:z.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)]}}let YP=(()=>{class n{}return n.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`,n.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`,n.CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`,n})();class z3 extends L1{constructor(){super(ei)}static get(){return z3.singleton.isAbsent()&&(z3.singleton=y.of(new z3)),z3.singleton.get()}applyLegalMove(t,e,r){const s=e.getCopiedBoard();s[t.getStart().y][t.getStart().x]=Ht.EMPTY;const i=r.finalPiece;s[t.getEnd().y][t.getEnd().x]=i;const o=r.score;let c=e.countDown;if(c.isPresent())if(this.isCapture(t,e))c=z3.STARTING_COUNT_DOWN;else{const h=e.countDown.get();c=y.of(h-1)}return t.calledTheClock&&(c=z3.STARTING_COUNT_DOWN),new ei(s,e.turn+1,y.of(t),c,o)}isLegal(t,e){this.assertNonDoubleClockCall(t,e);const r=this.isLegalMove(t,e);if(r.isFailure())return r.toOtherFallible();if(t.isUndoneBy(e.lastMove))return _e.failure(YP.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(t,e))return this.isLegalFieldPromotion(t,e);const s=e.getPieceAt(t.getStart()),i=e.captured.getCopy();if(this.isCapture(t,e)){const c=e.getCurrentPlayer();let u=i.get(c).get();const h=e.getPieceAt(t.getEnd());u=u.add(h),i.replace(c,u),i.makeImmutable()}return _e.success({finalPiece:s,score:i})}assertNonDoubleClockCall(t,e){Le(!1===(e.countDown.isPresent()&&t.calledTheClock),"Should not call the clock twice")}isCapture(t,e){const r=e.isInOpponentTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Ht.EMPTY;return r&&s}isFieldPromotion(t,e){const r=e.isInPlayerTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Ht.EMPTY;return r&&s}isLegalFieldPromotion(t,e){const r=this.getPromotedPiece(t,e);if(r.isAbsent())return _e.failure(YP.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const s=r.get();if(e.isTherePieceOnPlayerSide(s))return _e.failure(YP.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const i={finalPiece:s,score:e.captured.getCopy()};return _e.success(i)}}isLegalMove(t,e){if(!1===e.isInPlayerTerritory(t.getStart()))return z.failure(YP.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const s=e.getPieceAt(t.getStart());if(s===Ht.EMPTY)return z.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===Ht.PAWN)return t.isValidForPawn()?z.SUCCESS:z.failure(ZP.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(s===Ht.DRONE&&!1===t.isValidForDrone())return z.failure(ZP.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const i of t.getStart().getUntil(t.getEnd()))if(e.getPieceAt(i)!==Ht.EMPTY)return z.failure(tt.SOMETHING_IN_THE_WAY());return z.SUCCESS}getPromotedPiece(t,e){const r=e.getPieceAt(t.getStart()),s=e.getPieceAt(t.getEnd());return Ht.tryMerge(r,s)}getGameStatus(t){const e=t.gameState;if(e.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(e,xe.DRAW);if(e.getEmptyTerritory().isPresent()){const s=e.getCurrentOpponent(),i=xe.getVictory(s);return this.getGameStatusScoreVictoryOr(e,i)}return xe.ONGOING}getGameStatusScoreVictoryOr(t,e){const r=t.getScoreOf(B.ZERO),s=t.getScoreOf(B.ONE);return r>s?xe.ZERO_WON:s>r?xe.ONE_WON:e}}z3.STARTING_COUNT_DOWN=y.of(7),z3.singleton=y.empty();class t8t extends xs{constructor(t,e){super(t,e)}getListMoves(t){const e=t.gameState,r=e.getCurrentPlayer(),s=e.getPlayerTerritory(r);let i=[];for(const o of s)for(let c=0;c<4;c++)switch(e.getPieceAtXY(c,o)){case Ht.PAWN:i=i.concat(this.getMovesForPawnAt(e,c,o));break;case Ht.DRONE:i=i.concat(this.getMovesForDroneAt(e,c,o));break;case Ht.QUEEN:i=i.concat(this.getMovesForQueenAt(e,c,o))}return i}getMovesForPawnAt(t,e,r){const s=new S(e,r),i=[];for(const o of Oe.DIAGONALS){const c=s.getNext(o);c.isInRange(4,8)&&i.push(c)}return this.addLegalMoves(t,s,i)}addLegalMoves(t,e,r){const s=[],i=t.getPieceAt(e),o=!1===t.isTherePieceOnPlayerSide(Ht.DRONE),c=!1===t.isTherePieceOnPlayerSide(Ht.QUEEN),u=t.lastMove;for(const h of r){const g=t.getPieceAt(h);if(g===Ht.EMPTY)this.add(s,vs.from(e,h).get(),u);else if(t.isInPlayerTerritory(h)){const m=Ht.tryMerge(g,i);if(m.isPresent()){const E=m.get(),b=vs.from(e,h).get();(E===Ht.DRONE&&o||E===Ht.QUEEN&&c)&&this.add(s,b,u)}}else this.add(s,vs.from(e,h).get(),u)}return s}add(t,e,r){!1===e.isUndoneBy(r)&&t.push(e)}getMovesForDroneAt(t,e,r){const s=new S(e,r),i=this.getLandingCoordsForLinearMove(s,t,2);return this.addLegalMoves(t,s,i)}getLandingCoordsForLinearMove(t,e,r){const s=[];for(const i of Oe.DIRECTIONS){let o=1,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(Ht.EMPTY);for(;h;)s.push(c),o++,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(Ht.EMPTY)&&o<r;u.isPresent()&&s.push(c)}return s}getMovesForQueenAt(t,e,r){const s=new S(e,r),i=this.getLandingCoordsForQueen(s,t);return this.addLegalMoves(t,s,i)}getLandingCoordsForQueen(t,e){return this.getLandingCoordsForLinearMove(t,e,8)}getMetrics(t){return[t.gameState.getScoreOf(B.ZERO),t.gameState.getScoreOf(B.ONE)]}}function n8t(n,t){if(1&n&&(F(),X(0,"g",19)),2&n){const e=C(2).index,r=C().index,s=C();S2(s.style),Re("mainShapeId","pawn_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function r8t(n,t){if(1&n&&(F(),X(0,"g",20)),2&n){const e=C(2).index,r=C().index,s=C();S2(s.style),Re("mainShapeId","drone_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function s8t(n,t){if(1&n&&(F(),X(0,"g",21)),2&n){const e=C(2).index,r=C().index,s=C();S2(s.style),Re("mainShapeId","queen_",e,"_",r,""),w("pieceClasses",s.getPieceClasses(e,r))}}function i8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,n8t,1,5,"g",16),x(2,r8t,1,5,"g",17),x(3,s8t,1,5,"g",18),A()),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();D("transform",o.getPieceLocation(r,i)),T(1),w("ngIf",s===o.pieces.PAWN),T(1),w("ngIf",s===o.pieces.DRONE),T(1),w("ngIf",s===o.pieces.QUEEN)}}function o8t(n,t){if(1&n){const e=Ae();F(),O(0,"g",14),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),X(1,"rect",15),x(2,i8t,4,4,"g",13),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();Re("id","click_",r,"_",s,""),D("transform",i.getPieceTranslation(s)),T(1),Re("id","square_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e!==i.pieces.EMPTY)}}function a8t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",22),ee("click",function(){const i=he(e).$implicit;return le(C(3).onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C(3);T(1),Re("id","indicator_",e.x,"_",e.y,""),D("transform",r.getPieceTranslation(e.y))("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}function c8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,a8t,2,7,"g",1),A()),2&n){const e=C(2);T(1),w("ngForOf",e.selectedPieceInfo.get().legalLandings)}}function l8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,o8t,3,11,"g",12),x(2,c8t,2,1,"g",13),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",e),T(1),w("ngIf",r.selectedPieceInfo.isPresent())}}function u8t(n,t){if(1&n&&(F(),O(0,"text",23),Tt(1),A()),2&n){const e=C();w("ngClass","player"+e.getCurrentPlayer().value)("ngClass",e.getClockCircleClasses()),D("x",.5*e.SPACE_SIZE)("y",.5*e.SPACE_SIZE),T(1),a1(e.countDown.get())}}function f8t(n,t){if(1&n&&(F(),X(0,"polyline",24)),2&n){const e=C();w("ngClass",e.getClockCircleClasses()),D("points",e.clockNeedlesPoints)}}const KP=function(n){return[n]};function h8t(n,t){if(1&n){const e=Ae();F(),hn(0),O(1,"g",27),ee("click",function(){const i=he(e).index;return le(C(2).chooseStyle(i))}),A(),dn()}if(2&n){const e=t.$implicit,r=t.index,s=C(2);T(1),S2(e.style),w("id",e.name)("pieceClasses",w3(5,KP,"player"+s.getCurrentPlayer().value+"-fill")),D("transform","translate(0, "+-(r+1)*s.SPACE_SIZE+")")}}function d8t(n,t){if(1&n&&(F(),O(0,"g",25),X(1,"rect",26),x(2,h8t,2,7,"ng-container",1),A()),2&n){const e=C();T(1),D("x",0)("y",-e.listOfStyles.length*e.SPACE_SIZE)("width",1*e.SPACE_SIZE)("height",e.listOfStyles.length*e.SPACE_SIZE),T(1),w("ngForOf",e.listOfStyles)}}function p8t(n,t){if(1&n&&(F(),O(0,"text",33),Tt(1),A()),2&n){const e=C(2).$implicit,r=C().$implicit,s=C();w("ngClass",s.getPlayerClass(r)),D("x",s.SPACE_SIZE/2)("y",s.SPACE_SIZE/2),T(1),a1(e+" x ")}}function g8t(n,t){if(1&n&&(F(),X(0,"g",34)),2&n){const e=C(3).$implicit,r=C();S2(r.style),w("pieceClasses",w3(3,KP,r.getPlayerClass(e)))}}function m8t(n,t){if(1&n&&(F(),X(0,"g",35)),2&n){const e=C(3).$implicit,r=C();S2(r.style),w("pieceClasses",w3(3,KP,r.getPlayerClass(e)))}}function _8t(n,t){if(1&n&&(F(),X(0,"g",36)),2&n){const e=C(3).$implicit,r=C();S2(r.style),w("pieceClasses",w3(3,KP,r.getPlayerClass(e)))}}function v8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,p8t,2,4,"text",29),O(2,"g",28),x(3,g8t,1,5,"g",30),x(4,m8t,1,5,"g",31),x(5,_8t,1,5,"g",32),A()()),2&n){const e=C(),r=e.index,s=e.$implicit,i=C().$implicit,o=C();D("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),T(1),w("ngIf",s>1),T(1),Re("id","piece_",r,"_player_",i.value,""),D("transform","translate("+o.SPACE_SIZE+", 0)"),T(1),w("ngIf",0===r),T(1),w("ngIf",1===r),T(1),w("ngIf",2===r)}}function C8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,v8t,6,8,"g",13),A()),2&n){const e=t.$implicit;T(1),w("ngIf",e>0)}}function y8t(n,t){if(1&n&&(F(),O(0,"g")(1,"g",28),x(2,C8t,2,1,"g",1),A()()),2&n){const e=t.$implicit,r=C();T(1),d1("id","capture_of_player_",e.value,""),D("transform",r.getCapturesTransformation(e)),T(1),w("ngForOf",r.state.getCapturesOf(e))}}let jo=(()=>{class n extends Ho{constructor(e){super(e),this.INDICATOR_SIZE=20,this.HORIZONTAL_CENTER=2*n.SPACE_SIZE,this.VERTICAL_CENTER=4*n.SPACE_SIZE+n.STROKE_WIDTH,this.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,this.UP=-n.STROKE_WIDTH/2,this.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,this.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,this.MartianChessComponent=n,this.style={shape:"Circle",points:"Horizontal Points"},this.pieces=Ht,this.selectedPieceInfo=y.empty(),this.countDown=y.empty(),this.callTheClock=!1,this.displayModePanel=!1,this.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],this.hasAsymmetricBoard=!0,this.rules=z3.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new t8t(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=n.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=vs.encoder,this.tutorial=(new A3e).tutorial,this.scores=y.of([0,0]),this.updateBoard()}static getRegularPolygon(e,r=0){const s=n.getRegularPolygonCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStar(e,r){const s=this.getNPointedStarCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStarCoords(e,r){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;e*=2;for(let c=0;c<e;c++){const h=(c*(360/e)+r)/180*Math.PI,g=c%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,m=i+.8*g*Math.cos(h),E=o+.8*g*Math.sin(h);s.push(new S(m,E))}return s}static getRegularPolygonCoords(e,r=0){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;for(let c=0;c<e;c++){const h=(c*(360/e)-90)/180*Math.PI,g=.5*n.SPACE_SIZE,m=i+.8*g*Math.cos(h),E=o+.8*g*Math.sin(h)+r;s.push(new S(m,E))}return s}static mapCoordsToString(e){let r="";for(const s of e)r+=s.x+", "+s.y+" ";return r}static getRadius(e){return this.SPACE_SIZE*e/10}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const e=this.STROKE_WIDTH,s=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}updateBoard(){this.state=this.getState(),this.board=this.state.board;const e=this.state.getScoreOf(B.ZERO),r=this.state.getScoreOf(B.ONE);this.countDown=this.state.countDown,this.scores=y.of([e,r])}getPieceLocation(e,r){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*r+")"}getPieceClasses(e,r){const s=new S(e,r),i=[];return i.push(r>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&i.push("selected-stroke"),this.node.move.isPresent()&&this.node.move.get().getEnd().equals(s)&&this.getPreviousState().getPieceAt(s)!==Ht.EMPTY&&this.getState().isInOpponentTerritory(new S(0,r))&&i.push("last-move-stroke"),i}onClick(e,r){var s=this;return I(function*(){s.displayModePanel=!1;const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);return s.selectedPieceInfo.isPresent()?s.secondClick(o):s.firstClick(o)})()}firstClick(e){var r=this;return I(function*(){return r.isOneOfUsersPieces(e)?r.selectAsFirstPiece(e):(r.cancelMoveAttempt(),z.SUCCESS)})()}selectAsFirstPiece(e){var r=this;return I(function*(){const s=r.getLegalLandings(e);return r.selectedPieceInfo=y.of({selectedPiece:e,legalLandings:s}),z.SUCCESS})()}getLegalLandings(e){const r=this.state.getPieceAt(e);let s;return s=r===Ht.PAWN?Oe.DIAGONALS.map(i=>e.getNext(i)):this.getValidLinearLandingSquareUntil(e,r===Ht.DRONE?2:8),s.filter(i=>{const o=vs.from(e,i);return!!o.isSuccess()&&this.rules.isLegal(o.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(e,r){return Oe.DIRECTIONS.flatMap(s=>{const i=[];let o=e.getNext(s),c=1;for(;o.isInRange(4,8)&&c<=r&&(i.push(o),this.getState().getPieceAt(o)===Ht.EMPTY);)o=o.getNext(s),c++;return i})}secondClick(e){var r=this;return I(function*(){const s=r.selectedPieceInfo.get();if(s.selectedPiece.equals(e))return r.cancelMoveAttempt(),z.SUCCESS;if(s.legalLandings.some(i=>i.equals(e))){const i=vs.from(s.selectedPiece,e,r.callTheClock);Le(i.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!");const o=r.getState();return r.chooseMove(i.get(),o)}if(r.isOneOfUsersPieces(e))return r.selectAsFirstPiece(e);{const i=vs.from(s.selectedPiece,e,r.callTheClock);return i.isSuccess()?r.chooseMove(i.get(),r.getState()):r.cancelMove(i.getReason())}})()}isOneOfUsersPieces(e){return this.state.getPieceAt(e)!==Ht.EMPTY&&this.state.isInPlayerTerritory(e)}cancelMoveAttempt(){this.selectedPieceInfo=y.empty(),this.callTheClock=!1}onClockClick(){var e=this;return I(function*(){const r=e.canUserPlay("#clockOrCountDownView");return r.isFailure()?e.cancelMove(r.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),z.SUCCESS)})()}getClockCircleClasses(){const e=["base"];return this.callTheClock&&e.push("selected-stroke"),this.getCurrentPlayer()===B.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}getSquareClasses(e,r){const s=new S(e,r),i=["base"];if(this.node.move.isPresent()){const o=this.node,c=o.move.get();c.getStart().equals(s)?i.push("moved-fill"):c.getEnd().equals(s)&&(o.mother.get().gameState.getPieceAt(s)===Ht.EMPTY||o.gameState.isInOpponentTerritory(new S(0,r))?i.push("moved-fill"):i.push("captured-fill"))}return i}onModeCogClick(){this.displayModePanel=!this.displayModePanel}chooseStyle(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}getPieceTranslation(e){return"translate(0, "+(e<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.role.value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(e){let i=this.SPACE_SIZE/2;return e===this.role&&(i+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+-this.SPACE_SIZE/2+", "+i+")"}}return n.SPACE_SIZE=100,n.STROKE_WIDTH=8,n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-martian-chess"]],features:[l],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"g"),x(2,l8t,3,2,"g",1),A(),O(3,"g",2),ee("click",function(){return r.onClockClick()}),X(4,"rect",3)(5,"circle",4),x(6,u8t,2,5,"text",5),x(7,f8t,1,2,"polyline",6),A(),O(8,"g",7)(9,"g",8),ee("click",function(){return r.onModeCogClick()}),X(10,"rect",3)(11,"path",9),A(),x(12,d8t,3,5,"g",10),A(),O(13,"g",11),x(14,y8t,3,3,"g",1),A()()),2&e&&(D("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),T(1),D("transform",r.getBoardTransformation()),T(1),w("ngForOf",r.board),T(1),D("transform","translate("+5.25*r.SPACE_SIZE+", 0)"),T(1),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),T(1),w("ngClass",r.getClockCircleClasses()),D("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE)("r",.4*r.SPACE_SIZE),T(1),w("ngIf",r.countDown.isPresent()),T(1),w("ngIf",r.countDown.isAbsent()),T(1),D("transform",r.configViewTranslation),T(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),T(1),w("ngClass",r.getPlayerClass(r.getCurrentPlayer())),D("transform",r.configCogTransformation),T(1),w("ngIf",r.displayModePanel),T(2),w("ngForOf",r.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class v8 extends Ur{static getInitialState(){const t=Qe.createTable(7,6,pe.NONE);return new v8(t,0)}}class D1 extends ji{constructor(t){super(),this.x=t}static of(t){switch(t){case 0:return D1.ZERO;case 1:return D1.ONE;case 2:return D1.TWO;case 3:return D1.THREE;case 4:return D1.FOUR;case 5:return D1.FIVE;case 6:return D1.SIX;default:throw new Error("Invalid P4Move")}}equals(t){return this===t}toString(){return"P4Move("+this.x+")"}}D1.ZERO=new D1(0),D1.ONE=new D1(1),D1.TWO=new D1(2),D1.THREE=new D1(3),D1.FOUR=new D1(4),D1.FIVE=new D1(5),D1.SIX=new D1(6),D1.encoder=new class extends xt{encodeMove(n){return n.x}decodeMove(n){return D1.of(n)}};let E8t=(()=>{class n{}return n.COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`,n})();class ti extends L1{constructor(){super(v8)}static get(){return ti.singleton.isAbsent()&&(ti.singleton=y.of(new ti)),ti.singleton.get()}static isInRange(t){return t.isInRange(7,6)}static getVictoriousCoords(t){return ti.P4_HELPER.getVictoriousCoord(t)}static getLowestUnoccupiedSpace(t,e){let r=0;for(;r<6&&t[r][e]===pe.NONE;)r++;return r-1}static getListMoves(t){J(ti.VERBOSE,{context:"P4Rules.getListMoves",node:t});const e=t.gameState,r=[];for(let s=0;s<7;s++)if(e.getPieceAtXY(s,0)===pe.NONE){const i=D1.of(s);r.push(i)}return r}applyLegalMove(t,e,r){const s=t.x,i=e.getCopiedBoard(),o=ti.getLowestUnoccupiedSpace(i,s),c=e.turn;return i[o][s]=e.getCurrentPlayer(),new v8(i,c+1)}isLegal(t,e){return J(ti.VERBOSE,{context:"P4Rules.isLegal",move:t.toString(),state:e}),e.getPieceAtXY(t.x,0).isPlayer()?z.failure(E8t.COLUMN_IS_FULL()):z.SUCCESS}getGameStatus(t){const e=t.gameState;return ti.P4_HELPER.getVictoriousCoord(e).length>0?xe.getVictory(e.getCurrentOpponent()):42===e.turn?xe.DRAW:xe.ONGOING}}ti.VERBOSE=!1,ti.singleton=y.empty(),ti.P4_HELPER=new $m(ti.isInRange,Se.identity,4);class M8t extends Dc{getListMoves(t){return ti.getListMoves(t).sort((e,r)=>Math.abs(e.x-3)-Math.abs(r.x-3))}getBoardValue(t){const e=t.gameState;let r=0;for(let s=0;s<7;s++)for(let i=5;-1!==i&&e.board[i][s].isPlayer();i--){const o=ti.P4_HELPER.getSquareScore(e,new S(s,i));if(gr.getScoreStatus(o)===Sn.VICTORY)return new M1(o);r+=o}return new M1(r)}}const Et=pe.NONE,_6=pe.ZERO,Vh=pe.ONE;class N3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,v8.getInitialState()),ie.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,v8.getInitialState(),D1.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),ie.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new v8([[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Vh,Et,Et,Et],[Et,Et,Et,Vh,Et,Et,Et],[Et,Et,_6,_6,_6,Vh,Et]],0),[D1.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),ie.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new v8([[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,Et,Et,Et,Et],[Et,Et,Et,_6,Vh,Et,Et],[Et,Et,_6,_6,Vh,Et,Et],[Et,_6,Vh,_6,_6,Et,Et]],0),[D1.of(3),D1.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}}function S8t(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=C().index,r=C().index,s=C();w("ngClass",s.getSquareFillClass(e,r)),D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function P8t(n,t){if(1&n){const e=Ae();F(),O(0,"g",5),ee("click",function(){const i=he(e).index;return le(C(2).onClick(i))}),X(1,"rect",6),x(2,S8t,1,4,"circle",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();d1("id","click_",r,""),T(1),D("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e!==i.EMPTY)}}function T8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,P8t,3,6,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function w8t(n,t){if(1&n&&(F(),X(0,"rect",9)),2&n){const e=C();D("x",e.SPACE_SIZE*e.last.get().x)("y",e.SPACE_SIZE*e.last.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function b8t(n,t){if(1&n&&(F(),X(0,"rect",10)),2&n){const e=t.$implicit,r=C();Re("id","victory_coord_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let O8t=(()=>{class n extends Ho{constructor(e){super(e),this.EMPTY=pe.NONE,this.victoryCoords=[],this.rules=ti.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new M8t(this.rules,"P4Minimax")],this.encoder=D1.encoder,this.tutorial=(new N3e).tutorial,this.updateBoard()}onClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=D1.of(e);return yield r.chooseMove(i,r.getState())})()}updateBoard(){const e=this.getState();this.victoryCoords=ti.getVictoriousCoords(e),this.board=e.board,this.hideLastMove()}showLastMove(e){const r=this.getState(),s=ti.getLowestUnoccupiedSpace(r.board,e.x)+1;this.last=y.of(new S(e.x,s))}hideLastMove(){this.last=y.empty()}getSquareFillClass(e,r){return[this.getPlayerClass(this.board[r][e])]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-p4"]],features:[l],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,T8t,2,1,"g",1),x(2,w8t,1,4,"rect",2),x(3,b8t,1,6,"rect",3),A()),2&e&&(T(1),w("ngForOf",r.board),T(1),w("ngIf",r.last.isPresent()),T(1),w("ngForOf",r.victoryCoords))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ds extends Ks{constructor(t,e,r,s=!1){if(super(t,e),this.blockTurned=r,this.turnedClockwise=s,this.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+this.coord.toString())}static withRotation(t,e,r,s){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new Ds(t,e,y.of(r),s)}static rotationless(t,e){return new Ds(t,e,y.empty())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(t){return!1!==this.coord.equals(t.coord)&&!1!==this.blockTurned.equals(t.blockTurned)&&this.turnedClockwise===t.turnedClockwise}}Ds.encoder=new class extends xt{encodeMove(n){const t={coord:S.encoder.encode(n.coord)};return n.blockTurned.isPresent()&&(t.blockTurned=n.blockTurned.get(),t.turnedClockwise=n.turnedClockwise),t}decodeMove(n){const t=n,e=S.encoder.decode(t.coord),r=y.ofNullable(t.blockTurned);if(r.isPresent()){const s=t.turnedClockwise;return Ds.withRotation(e.x,e.y,r.get(),s)}return Ds.rotationless(e.x,e.y)}};class XP extends xs{getListMoves(t){const e=[],r=t.gameState.neutralBlocks;if(0===t.gameState.turn)return XP.FIRST_TURN_MOVES;const s=this.getLegalDrops(t.gameState);for(const i of s){const o=Ds.rotationless(i.x,i.y),c=t.gameState.applyLegalDrop(o),u=this.getLegalRotations(c,r);for(const g of u)e.push(Ds.withRotation(i.x,i.y,g[0],g[1]));0===c.neutralBlocks.length==0&&e.push(o)}return e}getLegalDrops(t){const e=[];for(let r=0;r<6;r++)for(let s=0;s<6;s++){const i=new S(s,r);t.getPieceAt(i)===pe.NONE&&e.push(i)}return e}getLegalRotations(t,e){const r=0===t.neutralBlocks.length,s=[];for(let i=0;i<4;i++)!1===t.blockIsNeutral(i)&&(e.includes(i)?r&&s.push([i,!0]):s.push([i,!0],[i,!1]));return s}getMetrics(t){return[0,0]}}XP.FIRST_TURN_MOVES=[Ds.rotationless(0,0),Ds.rotationless(1,0),Ds.rotationless(2,0),Ds.rotationless(0,1),Ds.rotationless(1,1),Ds.rotationless(0,2)];let I3e=(()=>{class n{}return n.CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`,n.MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`,n})();class lo extends Ur{constructor(t,e){super(t,e),this.neutralBlocks=this.getBlocksNeutralities()}static getInitialState(){const t=Qe.createTable(6,6,pe.NONE);return new lo(t,0)}getBlocksNeutralities(){const t=[];for(let e=0;e<4;e++)this.getBlockNeutrality(e)&&t.push(e);return t}getBlockNeutrality(t){const e=lo.getBlockCenter(t),r=this.getPieceAt(e.getNext(Oe.UP,1)),s=this.getPieceAt(e.getNext(Oe.UP_LEFT,1));return this.getPieceAt(e.getNext(Oe.RIGHT,1))===r&&this.getPieceAt(e.getNext(Oe.DOWN,1))===r&&this.getPieceAt(e.getNext(Oe.LEFT,1))===r&&this.getPieceAt(e.getNext(Oe.UP_RIGHT,1))===s&&this.getPieceAt(e.getNext(Oe.DOWN_RIGHT,1))===s&&this.getPieceAt(e.getNext(Oe.DOWN_LEFT,1))===s}static getBlockCenter(t){return new S(1+(t%2==0?0:3),1+(t<2?0:3))}applyLegalDrop(t){const e=this.getCopiedBoard();return e[t.coord.y][t.coord.x]=this.getCurrentPlayer(),new lo(e,this.turn)}applyLegalMove(t){const e=this.applyLegalDrop(t),r=e.getCopiedBoard();if(t.blockTurned.isPresent()){const i=lo.getBlockCenter(t.blockTurned.get()).toVector();if(t.turnedClockwise)for(const o of lo.ROTATION_MAP){const c=o[0].getNext(i),u=o[1].getNext(i),h=e.getPieceAt(c);r[u.y][u.x]=h}else for(const o of lo.ROTATION_MAP){const c=o[1].getNext(i),u=o[0].getNext(i),h=e.getPieceAt(c);r[u.y][u.x]=h}}return new lo(r,this.turn+1)}blockIsNeutral(t){return this.neutralBlocks.includes(t)}}lo.ROTATION_MAP=[[new S(-1,-1),new S(1,-1)],[new S(0,-1),new S(1,0)],[new S(1,-1),new S(1,1)],[new S(1,0),new S(0,1)],[new S(1,1),new S(-1,1)],[new S(0,1),new S(-1,0)],[new S(-1,1),new S(-1,-1)],[new S(-1,0),new S(0,-1)]];class j4 extends L1{constructor(){super(lo)}static get(){return j4.singleton.isAbsent()&&(j4.singleton=y.of(new j4)),j4.singleton.get()}applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){if(e.getPieceAt(t.coord).isPlayer())return z.failure(tt.MUST_LAND_ON_EMPTY_SPACE());const r=e.applyLegalDrop(t);if(0===r.neutralBlocks.length){if(t.blockTurned.isAbsent())return z.failure(I3e.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(t.blockTurned.isPresent()){const s=t.blockTurned.get();if(r.neutralBlocks.includes(s))return z.failure(I3e.CANNOT_ROTATE_NEUTRAL_BLOCK())}return z.SUCCESS}getVictoryCoords(t){let e=[];for(const r of j4.VICTORY_SOURCE){const s=t.getPieceAt(r[0]),i=[r[0]];if(s.isPlayer()){let o=r[0].getNext(r[1]),c=!0;for(let u=0;u<3&&c;u++)t.getPieceAt(o)!==s?c=!1:(i.push(o),o=o.getNext(r[1]));if(c&&(t.getPieceAt(o)===s&&(i.push(o),e=e.concat(i)),r[2])){const u=r[0].getPrevious(r[1],1);t.getPieceAt(u)===s&&(i.push(u),e=e.concat(i))}}}return e}getGameStatus(t){const e=t.gameState,r=this.getVictoryCoords(e),s=[!1,!1];for(let i=0;i<r.length;i+=5)s[e.getPieceAt(r[i]).value]=!0;return!0===s[0]?!0===s[1]?xe.DRAW:xe.ZERO_WON:!0===s[1]?xe.ONE_WON:36===e.turn?xe.DRAW:xe.ONGOING}}j4.singleton=y.empty(),j4.VICTORY_SOURCE=[[new S(1,0),new $t(1,1),!1],[new S(0,1),new $t(1,1),!1],[new S(4,0),new $t(-1,1),!1],[new S(5,1),new $t(-1,1),!1],[new S(1,1),new $t(1,1),!0],[new S(4,1),new $t(-1,1),!0],[new S(0,1),new $t(0,1),!0],[new S(1,1),new $t(0,1),!0],[new S(2,1),new $t(0,1),!0],[new S(3,1),new $t(0,1),!0],[new S(4,1),new $t(0,1),!0],[new S(5,1),new $t(0,1),!0],[new S(1,0),new $t(1,0),!0],[new S(1,1),new $t(1,0),!0],[new S(1,2),new $t(1,0),!0],[new S(1,3),new $t(1,0),!0],[new S(1,4),new $t(1,0),!0],[new S(1,5),new $t(1,0),!0]];const Ke=pe.NONE,Z4=pe.ZERO,v6=pe.ONE;class x3e{constructor(){this.tutorial=[ie.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,lo.getInitialState()),ie.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new lo([[Z4,Ke,Ke,Z4,v6,Ke],[Z4,v6,Ke,Ke,Ke,Ke],[Z4,Ke,v6,Ke,Ke,Ke],[Z4,Ke,Ke,Ke,Ke,v6],[Z4,Ke,Ke,Ke,v6,Ke],[Ke,Ke,Ke,Ke,Ke,Ke]],10)).withPreviousMove(Ds.withRotation(0,0,0,!1)),ie.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new lo([[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,Z4,Ke,Ke,v6,Ke],[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,v6,Ke,Ke,Z4,Ke],[Ke,Ke,Ke,Ke,Ke,Ke]],10),Ds.rotationless(2,2),(t,e,r)=>t.blockTurned.isPresent()?z.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):z.SUCCESS,$localize`Congratulations!`),ie.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new lo([[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,Z4,Ke,Ke,v6,Ke],[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,Ke,Ke,Ke,Ke,Ke],[Ke,v6,Ke,Ke,Z4,Ke],[Ke,Ke,Ke,Ke,Ke,Ke]],10),Ds.withRotation(0,0,0,!0),(t,e,r)=>t.blockTurned.isPresent()?z.SUCCESS:z.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}}function A8t(n,t){if(1&n){const e=Ae();F(),O(0,"circle",12),ee("click",function(){const i=he(e).$implicit,o=C().$implicit,c=C().index,u=C().index;return le(C().onClick(3*c+i,3*u+o))}),A()}if(2&n){const e=t.$implicit,r=C().$implicit,s=C(),i=s.index,o=s.$implicit,c=C(),u=c.index,h=c.$implicit,g=C();Re("id","click_",3*i+e,"_",3*u+r,""),w("ngClass",g.getSquareClasses(3*i+e,3*u+r)),D("cx",o+2*g.STROKE_WIDTH+(e+.5)*g.SPACE_SIZE)("cy",h+2*g.STROKE_WIDTH+(r+.5)*g.SPACE_SIZE)("r",(g.SPACE_SIZE-g.STROKE_WIDTH)/2)}}const k3e=function(){return[0,1,2]};function N8t(n,t){1&n&&(F(),hn(0),x(1,A8t,1,6,"circle",11),dn()),2&n&&(T(1),w("ngForOf",J1(1,k3e)))}function I8t(n,t){if(1&n&&(F(),hn(0),X(1,"rect",10),x(2,N8t,2,2,"ng-container",4),dn()),2&n){const e=t.$implicit,r=t.index,s=C(),i=s.index,o=s.$implicit,c=C();T(1),w("ngClass",c.getBlockClasses(r,i)),D("x",c.STROKE_WIDTH+e)("y",c.STROKE_WIDTH+o)("rx",3*c.STROKE_WIDTH)("ry",3*c.STROKE_WIDTH)("width",c.BLOCK_WIDTH)("height",c.BLOCK_WIDTH),T(1),w("ngForOf",J1(8,k3e))}}const L3e=function(n){return[0,n]};function x8t(n,t){if(1&n&&(F(),hn(0),x(1,I8t,3,9,"ng-container",4),dn()),2&n){const e=C();T(1),w("ngForOf",w3(1,L3e,e.BLOCK_SEPARATION))}}function k8t(n,t){if(1&n&&(F(),X(0,"circle",13)),2&n){const e=C();Re("id","currentDrop_",e.currentDrop.get().x,"_",e.currentDrop.get().y,""),w("ngClass",e.getPlayerClass(e.getCurrentPlayer())),D("cx",e.getCenter(e.currentDrop.get().x))("cy",e.getCenter(e.currentDrop.get().y))("r",(e.SPACE_SIZE-e.STROKE_WIDTH)/2)}}function L8t(n,t){if(1&n){const e=Ae();F(),O(0,"path",14),ee("click",function(){const i=he(e).$implicit;return le(C().rotate(i))}),A()}if(2&n){const e=t.$implicit,r=C();Re("id","rotate_",e.blockIndex,"_",e.clockwise?"clockwise":"counterclockwise",""),D("d",e.path)("stroke-width",2*r.STROKE_WIDTH)}}function R8t(n,t){if(1&n&&(F(),X(0,"path",15)),2&n){const e=C();Re("id","last_rotation_",e.lastRotation.get().blockIndex,"_",e.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),D("d",e.lastRotation.get().path)("stroke-width",2*e.STROKE_WIDTH)}}function D8t(n,t){if(1&n&&(F(),X(0,"circle",16)),2&n){const e=t.$implicit,r=C();Re("id","victoryCoord_",e.x,"_",e.y,""),w("ngClass",r.getSquareClasses(e.x,e.y)),D("cx",r.getCenter(e.x))("cy",r.getCenter(e.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function z8t(n,t){if(1&n){const e=Ae();F(),O(0,"g",17),ee("click",function(){return he(e),le(C().skipRotation())}),X(1,"circle",18)(2,"line",19),A()}if(2&n){const e=C();T(1),D("cx",e.BLOCK_SEPARATION)("cy",e.BLOCK_SEPARATION)("r",.75*e.SPACE_SIZE)("stroke-width",2*e.STROKE_WIDTH),T(1),D("x1",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("y1",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("x2",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("y2",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("stroke-width",2*e.STROKE_WIDTH)}}let V8t=(()=>{class n extends Ho{constructor(e){super(e),this.arrows=[],this.victoryCoords=[],this.currentDrop=y.empty(),this.movedBlock=y.empty(),this.lastDrop=y.empty(),this.lastRotation=y.empty(),this.rules=j4.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new XP(this.rules,"PentagoMinimax")],this.encoder=Ds.encoder,this.tutorial=(new x3e).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.lastDrop=y.empty(),this.lastRotation=y.empty()}showLastMove(e){this.cancelMoveAttempt(),this.movedBlock=e.blockTurned;const r=new S(e.coord.x%3-1,e.coord.y%3-1);if(e.blockTurned.isPresent()&&(this.showLastRotation(e),!1===r.equals(new S(0,0))&&this.coordBelongToBlock(e)))return this.showLastDrop(e,r);this.lastDrop=y.of(e.coord)}showLastRotation(e){if(e.blockTurned.isPresent()){const r=e.blockTurned.get(),s=this.ARROWS.filter(i=>i.blockIndex===r&&i.clockwise===e.turnedClockwise)[0];this.lastRotation=y.of(s)}}showLastDrop(e,r){let s;s=e.turnedClockwise?Se.getNonNullable(lo.ROTATION_MAP.find(h=>h[0].equals(r)))[1]:Se.getNonNullable(lo.ROTATION_MAP.find(h=>h[1].equals(r)))[0];const i=e.blockTurned.get(),u=new S(i%2==0?1:4,i<2?1:4);s=s.getNext(u,1),this.lastDrop=y.of(s)}coordBelongToBlock(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=y.empty(),this.movedBlock=y.empty(),this.lastRotation=y.empty(),this.victoryCoords=[]}generateArrowsCoord(){const e=2*this.BLOCK_SEPARATION,s=this.SPACE_SIZE,i=e-s,o=2*s,c=.5*this.SPACE_SIZE;return[{path:"M "+c+" 0 q  "+s+" -"+s+"  "+o+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+c+" q -"+s+"  "+s+"  0  "+o,blockIndex:0,clockwise:!1},{path:"M "+e+" "+c+" q  "+s+"  "+s+"  0  "+o,blockIndex:1,clockwise:!0},{path:"M "+i+" 0 q -"+s+" -"+s+" -"+o+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+i+" q -"+s+" -"+s+"  0 -"+o,blockIndex:2,clockwise:!0},{path:"M "+c+" "+e+" q  "+s+"  "+s+"  "+o+"  0",blockIndex:2,clockwise:!1},{path:"M "+i+" "+e+" q -"+s+"  "+s+" -"+o+"  0",blockIndex:3,clockwise:!0},{path:"M "+e+" "+i+" q  "+s+" -"+s+"  0 -"+o,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=y.empty(),this.canSkipRotation=!1}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hidePreviousMove(),s.board[r][e].isPlayer())return s.cancelMove(tt.MUST_LAND_ON_EMPTY_SPACE());const o=Ds.rotationless(e,r),c=s.getState(),u=c.applyLegalDrop(o);if(4===u.neutralBlocks.length)return s.chooseMove(o,c);const h=s.rules.getGameStatus(s.node);return s.canSkipRotation=u.neutralBlocks.length>0&&!1===h.isEndGame,s.currentDrop=y.of(new S(e,r)),s.displayArrows(u.neutralBlocks),z.SUCCESS})()}getCenter(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}displayArrows(e){this.arrows=[];for(let r=0;r<4;r++)if(!1===e.includes(r)){const s=this.ARROWS.filter(i=>i.blockIndex===r);this.arrows=this.arrows.concat(s)}}getBlockClasses(e,r){return this.movedBlock.equalsValue(e+2*r)?["last-move-stroke"]:[]}getSquareClasses(e,r){const s=[],i=this.getPlayerClass(this.board[r][e]);return s.push(i),this.lastDrop.equalsValue(new S(e,r))&&s.push("last-move-stroke"),s}rotate(e){var r=this;return I(function*(){const i=r.canUserPlay("#rotate_"+e.blockIndex+"_"+(e.clockwise?"clockwise":"counterclockwise"));if(i.isFailure())return r.cancelMove(i.getReason());const o=r.currentDrop.get(),c=Ds.withRotation(o.x,o.y,e.blockIndex,e.clockwise);return r.chooseMove(c,r.getState())})()}skipRotation(){var e=this;return I(function*(){const r=e.canUserPlay("#skipRotation");if(r.isFailure())return e.cancelMove(r.getReason());const s=e.currentDrop.get(),i=Ds.rotationless(s.x,s.y);return e.chooseMove(i,e.getState())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-pentago"]],features:[l],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),A()(),O(4,"defs")(5,"marker",3),X(6,"polygon",2),A()(),x(7,x8t,2,3,"ng-container",4),x(8,k8t,1,6,"circle",5),x(9,L8t,1,4,"path",6),x(10,R8t,1,4,"path",7),x(11,D8t,1,7,"circle",8),x(12,z8t,3,9,"g",9),A()),2&e&&(T(7),w("ngForOf",w3(6,L3e,r.BLOCK_SEPARATION)),T(1),w("ngIf",r.currentDrop.isPresent()),T(1),w("ngForOf",r.arrows),T(1),w("ngIf",r.lastRotation.isPresent()),T(1),w("ngForOf",r.victoryCoords),T(1),w("ngIf",r.canSkipRotation))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),V3=(()=>{class n extends Ur{constructor(e,r,s){super(e,s),this.captures=r}static getInitialState(){const e=Qe.createTable(n.SIZE,n.SIZE,pe.NONE);return e[9][9]=pe.ONE,new n(e,[0,0],0)}}return n.SIZE=19,n})();class Ji extends Ks{constructor(t,e){super(t,e)}static isOnBoard(t){return t.isInRange(V3.SIZE,V3.SIZE)}static of(t){return Se.assert(Ji.isOnBoard(t),"PenteMove: coord is out of the board"),new Ji(t.x,t.y)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}Ji.encoder=Ks.getEncoder(Ji.of);class uc extends L1{constructor(){super(V3)}static get(){return uc.singleton.isAbsent()&&(uc.singleton=y.of(new uc)),uc.singleton.get()}isLegal(t,e){return e.getPieceAt(t.coord).isPlayer()?z.failure(tt.MUST_CLICK_ON_EMPTY_SQUARE()):z.SUCCESS}applyLegalMove(t,e,r){const s=e.getCurrentPlayer(),i=e.getCopiedBoard();i[t.coord.y][t.coord.x]=s;const o=this.getCaptures(t.coord,e,s);for(const u of o)i[u.y][u.x]=pe.NONE;const c=[e.captures[0],e.captures[1]];return c[s.value]+=o.length,new V3(i,c,e.turn+1)}getCaptures(t,e,r){const s=r.getOpponent(),i=[];for(const o of Oe.factory.all){const c=t.getNext(o,1),u=t.getNext(o,2),h=t.getNext(o,3);Ji.isOnBoard(c)&&e.getPieceAt(c)===s&&Ji.isOnBoard(u)&&e.getPieceAt(u)===s&&Ji.isOnBoard(h)&&e.getPieceAt(h)===r&&(i.push(c),i.push(u))}return i}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();return e.captures[r.value]>=10||uc.PENTE_HELPER.getVictoriousCoord(e).length>0?xe.getVictory(r):this.stillHaveEmptySquare(e)?xe.ONGOING:xe.DRAW}stillHaveEmptySquare(t){for(let e=0;e<V3.SIZE;e++)for(let r=0;r<V3.SIZE;r++)if(t.board[e][r]===pe.NONE)return!0;return!1}}uc.PENTE_HELPER=new $m(Ji.isOnBoard,Se.identity,5),uc.singleton=y.empty();class H8t extends Dc{getListMoves(t){const r=[];return t.gameState.forEachCoord((s,i)=>{!1===i.isPlayer()&&r.push(Ji.of(s))}),r}getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?M1.fromWinner(e.winner):uc.PENTE_HELPER.getBoardValue(t.gameState)}}const v=pe.NONE,Y4=pe.ZERO,H3=pe.ONE;class R3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the stones are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a stone of the second player is in the center location of the board.`,V3.getInitialState()),ie.anyMove($localize`Dropping a stone`,$localize`At your turn, you must drop one stone on the board. There is no restriction: you can put it anywhere.<br/><br/>You're playing Dark, put a stone on the board.`,V3.getInitialState(),Ji.of(new S(9,8)),$localize`Congratulations!`),ie.fromMove($localize`Capturing`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new V3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,Y4,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,H3,Y4,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,H3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[0,0],3),[Ji.of(new S(9,6))],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new V3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,H3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,H3,Y4,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,H3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[0,0],4),[Ji.of(new S(9,7))],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new V3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,H3,v,v,Y4,Y4,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,Y4,v,Y4,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,H3,Y4,Y4,Y4,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,H3,H3,H3,H3,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[8,8],7),[Ji.of(new S(9,6)),Ji.of(new S(8,9)),Ji.of(new S(13,9))],$localize`Congratulations!`,$localize`Failed. Try again.`)]}}function F8t(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=C().index,r=C().index,s=C();Re("id","piece_",e,"_",r,""),w("ngClass",s.getSpaceClass(e,r)),D("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function B8t(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2).index,r=C().index,s=C();Re("id","hoshi_",e,"_",r,""),D("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.1*s.SPACE_SIZE)}}function $8t(n,t){if(1&n&&(F(),X(0,"rect",9)(1,"line",10)(2,"line",10),x(3,B8t,1,5,"circle",11)),2&n){const e=C().index,r=C().index,s=C();D("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*e)("y",.5*s.SPACE_SIZE*r),T(1),D("x1",.5*s.SPACE_SIZE*e)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),D("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*e)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),w("ngIf",s.isHoshi(e,r))}}function U8t(n,t){if(1&n){const e=Ae();F(),O(0,"g",5),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),x(1,F8t,1,6,"circle",6),x(2,$8t,4,13,"ng-template",null,7,Gn),A()}if(2&n){const e=t.$implicit,r=t.index,s=Fn(3);Re("id","click_",r,"_",C().index,""),T(1),w("ngIf",e.isPlayer())("ngIfElse",s)}}function G8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,U8t,4,4,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function q8t(n,t){if(1&n){const e=Ae();F(),O(0,"circle",13),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i.x,i.y))}),A()}if(2&n){const e=t.$implicit,r=C();Re("id","capture_",e.x,"_",e.y,""),D("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*e.y)("r",.07*r.SPACE_SIZE)}}let W8t=(()=>{class n extends LH{constructor(e){super(e),this.lastMoved=y.empty(),this.victoryCoords=[],this.captured=[],this.scores=y.of([0,0]),this.rules=uc.get(),this.node=this.rules.getInitialNode(),this.encoder=Ji.encoder,this.tutorial=(new R3e).tutorial,this.availableMinimaxes=[new H8t(this.rules,"Alignment")]}updateBoard(){const e=this.getState();this.board=e.board,this.scores=y.of(this.getState().captures),this.victoryCoords=uc.PENTE_HELPER.getVictoriousCoord(e),this.createHoshis(),this.cancelMoveAttempt()}showLastMove(){const e=this.node.move.get();this.lastMoved=y.of(e.coord);const r=this.getCurrentPlayer().getOpponent();this.captured=uc.get().getCaptures(e.coord,this.getPreviousState(),r)}cancelMoveAttempt(){this.lastMoved=y.empty(),this.captured=[]}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(e,r);return s.chooseMove(Ji.of(o),s.getState())})()}getSpaceClass(e,r){const s=new S(e,r),i=this.getState().getPieceAt(s),o=[];return o.push(this.getPlayerClass(i)),this.victoryCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),this.lastMoved.equalsValue(s)&&o.push("last-move-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-new-game"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],[1,"captured-fill",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),X(1,"rect",1),x(2,G8t,2,1,"g",2),x(3,q8t,1,5,"circle",3),A()),2&e&&(D("viewBox","0 -3 "+r.board.length*r.SPACE_SIZE*.5+" "+(6+r.board.length*r.SPACE_SIZE*.5)),T(1),D("width",r.board.length*r.SPACE_SIZE*.5)("height",r.board.length*r.SPACE_SIZE*.5),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.captured))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class r_ extends S{constructor(t,e,r){super(t,e),this.z=r}static getEncoder(t){return new class extends R4{encode(e){return{x:e.x,y:e.y,z:e.z}}decode(e){const r=e;return Le(null!=r.x&&"number"==typeof r.x&&null!=r.y&&"number"==typeof r.y&&null!=r.z&&"number"==typeof r.z,"Invalid encoded Coord3D"),t(r.x,r.y,r.z)}}}static of(t,e,r){return new r_(t,e,r)}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(t){return this===t||t.x===this.x&&t.y===this.y&&t.z===this.z}isHigherThan(t){return this.z>t.z}}class Nn extends r_{constructor(t,e,r){if(super(t,e,r),t<0||t>3)throw new Error(`PylosCoord: Invalid X: ${t}.`);if(e<0||e>3)throw new Error(`PylosCoord: Invalid Y: ${e}.`);if(r<0||r>3)throw new Error(`PylosCoord: Invalid Z: ${r}.`);const s=4-r;if(this.isNotInRange(s,s))throw new Error(this.toString()+" is not in range.")}static from(t,e,r){return new Nn(t,e,r)}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const t=this.z-1;return[new Nn(this.x,this.y,t),new Nn(this.x+1,this.y,t),new Nn(this.x,this.y+1,t),new Nn(this.x+1,this.y+1,t)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const t=this.z+1,e=new S(this.x-1,this.y-1),r=new S(this.x,this.y-1),s=new S(this.x-1,this.y),i=new S(this.x,this.y),o=4-t;return[e,r,s,i].filter(c=>c.isInRange(o,o)).map(c=>new Nn(c.x,c.y,t))}getNextValid(t){const e=new S(this.x,this.y).getNext(t),r=4-this.z;return e.isNotInRange(r,r)?y.empty():y.of(new Nn(e.x,e.y,this.z))}}Nn.coordEncoder=r_.getEncoder(Nn.from),Nn.optionalEncoder=y.getEncoder(Nn.coordEncoder);let C8=(()=>{class n{}return n.MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`,n.SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`,n.CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`,n.CANNOT_CAPTURE=()=>$localize`You cannot capture.`,n.INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`,n.INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`,n})(),D3e=(()=>{class n{}return n.MUST_CAPTURE_MAXIMUM_TWO_PIECES=()=>$localize`You must capture one or two pieces, not more.`,n})();class Cs extends ji{constructor(t,e,r,s){super(),this.startingCoord=t,this.landingCoord=e,this.firstCapture=r,this.secondCapture=s}static fromClimb(t,e,r){const s=y.of(t),i=Cs.checkCaptures(r),o=new Cs(s,e,i.firstCapture,i.secondCapture);if(!1===e.isHigherThan(t))throw new Error(C8.MUST_MOVE_UPWARD());return o}static checkCaptures(t){let e=y.empty(),r=y.empty();if(t.length>0&&(e=y.of(t[0]),t.length>1)){if(t[1].equals(t[0]))throw new Error("PylosMove: should not capture twice same piece.");if(r=y.of(t[1]),t[1].isHigherThan(t[0])&&(e=y.of(t[1]),r=y.of(t[0])),t.length>2)throw new Error(D3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:e,secondCapture:r}}static fromDrop(t,e){const r=y.empty(),s=Cs.checkCaptures(e);return new Cs(r,t,s.firstCapture,s.secondCapture)}static changeCapture(t,e){const r=Cs.checkCaptures(e);return new Cs(t.startingCoord,t.landingCoord,r.firstCapture,r.secondCapture)}isClimb(){return this.startingCoord.isPresent()}toString(){const t=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),e=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),r=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+t+", "+this.landingCoord.toShortString()+", "+e+", "+r+")"}equals(t){return t===this||!!(this.startingCoord.equals(t.startingCoord)&&this.landingCoord.equals(t.landingCoord)&&this.firstCapture.equals(t.firstCapture)&&this.secondCapture.equals(t.secondCapture))}}Cs.encoder=new class extends xt{encodeMove(n){return{firstCapture:Nn.optionalEncoder.encode(n.firstCapture),landingCoord:Nn.coordEncoder.encode(n.landingCoord),secondCapture:Nn.optionalEncoder.encode(n.secondCapture),startingCoord:Nn.optionalEncoder.encode(n.startingCoord)}}decodeMove(n){const e=n.firstCapture,r=n.landingCoord,s=n.secondCapture;return new Cs(Nn.optionalEncoder.decode(n.startingCoord),Nn.coordEncoder.decode(r),Nn.optionalEncoder.decode(e),Nn.optionalEncoder.decode(s))}};class F3 extends pP{constructor(t,e){super(e),this.boards=t}static getInitialState(){const t=Qe.createTable(4,4,pe.NONE),e=Qe.createTable(3,3,pe.NONE),r=Qe.createTable(2,2,pe.NONE);return new F3([t,e,r,[[pe.NONE]]],0)}static getLevelRange(t){switch(t){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return Se.expectToBe(t,2),[0,1]}}getPieceAt(t){return this.boards[t.z][t.y][t.x]}applyLegalMove(t,e=!0){const r=[];let s;return r.push({coord:t.landingCoord,value:this.getCurrentPlayer()}),t.startingCoord.isPresent()&&r.push({coord:t.startingCoord.get(),value:pe.NONE}),t.firstCapture.isPresent()&&r.push({coord:t.firstCapture.get(),value:pe.NONE}),t.secondCapture.isPresent()&&r.push({coord:t.secondCapture.get(),value:pe.NONE}),s=e?this.turn+1:this.turn,this.setBoardAtCoords(r,s)}setBoardAtCoords(t,e){const r=[Qe.copyBiArray(this.boards[0]),Qe.copyBiArray(this.boards[1]),Qe.copyBiArray(this.boards[2]),Qe.copyBiArray(this.boards[3])];for(const s of t){const i=s.coord;r[i.z][i.y][i.x]=s.value}return new F3(r,e)}isLandable(t){if(this.getPieceAt(t).isPlayer())return!1;if(0===t.z)return!0;const e=t.getLowerPieces();for(const r of e)if(this.getPieceAt(r)===pe.NONE)return!1;return!0}isSupporting(t){if(3===t.z)return!1;const e=t.getHigherCoords();for(const r of e)if(this.getPieceAt(r).isPlayer())return!0;return!1}getPiecesRepartition(){const t={};t[pe.NONE.value]=0,t[B.ZERO.value]=0,t[B.ONE.value]=0;for(let e=0;e<3;e++)for(let r=0;r<4-e;r++)for(let s=0;s<4-e;s++){const i=new Nn(s,r,e),o=this.getPieceAt(i);t[o.value]=1+t[o.value]}return t}removePieceAt(t){return this.setBoardAtCoords([{coord:t,value:pe.NONE}],this.turn)}dropCurrentPlayersPieceAt(t){const e={coord:t,value:this.getCurrentPlayer()};return this.setBoardAtCoords([e],this.turn)}getFreeToMoves(){const t=[],e=this.getCurrentPlayer();for(let r=0;r<=2;r++){const s=F3.getLevelRange(r);for(const i of s)for(const o of s){const c=new Nn(o,i,r);this.getPieceAt(c).equals(e)&&!1===this.isSupporting(c)&&t.push(c)}}return t}}class bi extends L1{constructor(){super(F3)}static get(){return bi.singleton.isAbsent()&&(bi.singleton=y.of(new bi)),bi.singleton.get()}static getStateInfo(t){const e=[],r=[];for(let s=0;s<3;s++)for(let i=0;i<4-s;i++)for(let o=0;o<4-s;o++){const c=new Nn(o,i,s);t.getPieceAt(c)===t.getCurrentPlayer()&&!1===t.isSupporting(c)&&e.push(c),t.isLandable(c)&&r.push(c)}return{freeToMove:e,landable:r}}static getClimbingMoves(t){const e=[];for(const r of t.freeToMove)for(const s of t.landable)if(s.isHigherThan(r)&&!1===s.getLowerPieces().some(i=>r.equals(i))){const i=Cs.fromClimb(r,s,[]);e.push(i)}return e}static getDropMoves(t){const e=[];for(const r of t.landable){const s=Cs.fromDrop(r,[]);e.push(s)}return e}static canCapture(t,e){const r=t.getCurrentPlayer();for(const s of[$e.UP,$e.DOWN]){const i=e.getNextValid(s);if(i.isPresent()&&t.getPieceAt(i.get())===r)for(const o of[$e.LEFT,$e.RIGHT]){const c=i.get().getNextValid(o);if(c.isPresent()&&t.getPieceAt(c.get())===r){const u=s.getOpposite(),h=c.get().getNextValid(u).get();if(t.getPieceAt(h)===r)return!0}}}return!1}static getPossibleCaptures(t){const e=new bt,r=t.getFreeToMoves();for(const s of r){e.add(new bt([s]));const o=t.removePieceAt(s).getFreeToMoves();for(const c of o){const u=new bt([s,c]);e.add(u)}}return e}static applyLegalMove(t,e,r){return e.applyLegalMove(t)}static isValidCapture(t,e,r){const s=t.getCurrentPlayer();return!(!r.equals(e.landingCoord)&&t.getPieceAt(r)!==s)&&0===r.getHigherCoords().filter(o=>t.getPieceAt(o).isPlayer()&&!1===o.equals(e.firstCapture.get())).length}static getGameStatus(t){const r=t.gameState.getPiecesRepartition();return 15===r[B.ZERO.value]?xe.ONE_WON:15===r[B.ONE.value]?xe.ZERO_WON:xe.ONGOING}applyLegalMove(t,e,r){return bi.applyLegalMove(t,e,r)}isLegal(t,e){const r=this.isLegalStartingCoord(t,e);if(r.isFailure())return r.toOtherFallible();const s=r.get(),i=this.isLegalLandingCoord(t,s);if(i.isFailure())return i.toOtherFallible();const o=i.get(),c=this.isLegalCaptures(t,o);return c.isFailure()?c:z.SUCCESS}isLegalStartingCoord(t,e){const r=e.getCurrentOpponent();if(t.startingCoord.isPresent()){const s=t.startingCoord.get(),i=e.getPieceAt(s);if(i===r)return _e.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===pe.NONE)return _e.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===s.getHigherCoords().filter(c=>e.getPieceAt(c).isPlayer()).length){const c=e.removePieceAt(t.startingCoord.get());return _e.success(c)}return _e.failure(C8.CANNOT_MOVE_SUPPORTING_PIECE())}return _e.success(e)}isLegalLandingCoord(t,e){return e.getPieceAt(t.landingCoord).isPlayer()?_e.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):e.isLandable(t.landingCoord)?_e.success(e.dropCurrentPlayersPieceAt(t.landingCoord)):_e.failure(C8.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(t,e){if(t.firstCapture.isAbsent())return z.SUCCESS;if(!1===bi.canCapture(e,t.landingCoord))return z.failure(C8.CANNOT_CAPTURE());if(bi.isValidCapture(e,t,t.firstCapture.get())){const r=e.removePieceAt(t.firstCapture.get());return t.secondCapture.isAbsent()||bi.isValidCapture(r,t,t.secondCapture.get())?z.SUCCESS:z.failure(C8.INVALID_SECOND_CAPTURE())}return z.failure(C8.INVALID_FIRST_CAPTURE())}getGameStatus(t){return bi.getGameStatus(t)}}bi.singleton=y.empty();class s_ extends xs{static getListMoves(t){const e=t.gameState,r=[],s=bi.getStateInfo(e),i=bi.getClimbingMoves(s),o=bi.getDropMoves(s),c=i.concat(o);for(const u of c){const h=e.applyLegalMove(u,!1);let g=new bt;bi.canCapture(h,u.landingCoord)?g=bi.getPossibleCaptures(h):r.push(u);for(const m of g){const E=Cs.changeCapture(u,m.toList());r.push(E)}}return r}getListMoves(t){return s_.getListMoves(t)}getMetrics(t){const e=t.gameState.getPiecesRepartition();return[e[B.ZERO.value],e[B.ONE.value]]}}class Hh extends s_{static countStoneUsed(t){let e=t.isClimb()?0:1;return t.firstCapture.isPresent()&&(e-=1,t.secondCapture.isPresent()&&(e-=1)),e}static sumMoveEmplacementByValue(t){let e=t.landingCoord.z;return t.startingCoord.isPresent()&&(e+=3-t.startingCoord.get().z),t.firstCapture.isPresent()&&(e+=3-t.firstCapture.get().z,t.secondCapture.isPresent()&&(e+=3-t.secondCapture.get().z)),e}getListMoves(t){const e=s_.getListMoves(t);return this.orderMoves(e)}orderMoves(t){return t.sort((e,r)=>{const s=12*Hh.countStoneUsed(e),i=12*Hh.countStoneUsed(r);return s+Hh.sumMoveEmplacementByValue(e)-(i+Hh.sumMoveEmplacementByValue(r))})}}const ot=pe.NONE,C6=pe.ZERO,z3e=pe.ONE;class V3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,F3.getInitialState()),ie.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,F3.getInitialState(),Cs.fromDrop(new Nn(1,1,0),[]),$localize`There you go, as simple as that.`),ie.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new F3([[[C6,z3e,ot,ot],[z3e,C6,ot,ot],[ot,ot,ot,ot],[ot,ot,ot,C6]],[[ot,ot,ot],[ot,ot,ot],[ot,ot,ot]],[[ot,ot],[ot,ot]],[[ot]]],0),[Cs.fromClimb(new Nn(3,3,0),new Nn(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),ie.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new F3([[[C6,C6,ot,ot],[ot,C6,ot,ot],[ot,ot,ot,ot],[ot,ot,ot,ot]],[[ot,ot,ot],[ot,ot,ot],[ot,ot,ot]],[[ot,ot],[ot,ot]],[[ot]]],0),[Cs.fromDrop(new Nn(0,1,0),[new Nn(0,0,0)]),Cs.fromDrop(new Nn(0,1,0),[new Nn(0,1,0)]),Cs.fromDrop(new Nn(0,1,0),[new Nn(1,0,0)]),Cs.fromDrop(new Nn(0,1,0),[new Nn(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),ie.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new F3([[[C6,C6,ot,ot],[ot,C6,ot,ot],[ot,ot,ot,ot],[ot,ot,ot,ot]],[[ot,ot,ot],[ot,ot,ot],[ot,ot,ot]],[[ot,ot],[ot,ot]],[[ot]]],0),Cs.fromDrop(new Nn(0,1,0),[new Nn(0,0,0),new Nn(1,0,0)]),(t,e,r)=>t.secondCapture.isPresent()?z.SUCCESS:t.firstCapture.isPresent()?z.failure($localize`Failed, you only captured one piece.`):z.failure(b3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}}function j8t(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=t.$implicit,r=C().$implicit,s=C();Re("id","piece_",r.value,"_",e,""),w("ngClass",s.getPlayerClass(r)),D("cx",s.SPACE_SIZE/4+e/15*(s.boardWidth-s.SPACE_SIZE/4))("cy",s.getPiecesCyForPlayer(r))("r",s.SPACE_SIZE/4-s.STROKE_WIDTH)}}function Z8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,j8t,1,6,"circle",7),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",r.getPlayerSidePieces(e))}}function Y8t(n,t){if(1&n){const e=Ae();F(),O(0,"circle",12),ee("click",function(){he(e);const s=C(2).$implicit,i=C().$implicit,o=C().$implicit;return le(C().onPieceClick(s,i,o))}),A()}if(2&n){const e=C(2).$implicit,r=C().$implicit,s=C().$implicit,i=C();Q2("id","piece_",e,"_",r,"_",s,""),w("ngClass",i.getPieceClasses(e,r,s)),D("r",i.getPieceRadius(s)-i.STROKE_WIDTH)("cx",i.getPieceCx(e,r,s))("cy",i.getPieceCy(e,r,s))}}function K8t(n,t){if(1&n){const e=Ae();F(),O(0,"rect",12),ee("click",function(){he(e);const s=C(3).$implicit,i=C().$implicit,o=C().$implicit;return le(C().onDrop(s,i,o))}),A()}if(2&n){const e=C(3).$implicit,r=C().$implicit,s=C().$implicit,i=C();Q2("id","drop_",e,"_",r,"_",s,""),w("ngClass",i.getSquareClasses(e,r,s)),D("width",2*i.getPieceRadius(s))("height",2*i.getPieceRadius(s))("x",i.getPieceCx(e,r,s)-i.getPieceRadius(s))("y",i.getPieceCy(e,r,s)-i.getPieceRadius(s))}}function X8t(n,t){if(1&n&&(F(),x(0,K8t,1,8,"rect",13)),2&n){const e=C(2).$implicit,r=C().$implicit,s=C().$implicit;w("ngIf",C().mustDisplayLandingCoord(e,r,s))}}function Q8t(n,t){if(1&n&&(F(),hn(0),x(1,Y8t,1,7,"circle",10),x(2,X8t,1,1,"ng-template",null,11,Gn),dn()),2&n){const e=Fn(3),r=C().$implicit,s=C().$implicit,i=C().$implicit,o=C();T(1),w("ngIf",o.isOccupied(r,s,i))("ngIfElse",e)}}function J8t(n,t){if(1&n&&(F(),O(0,"g"),x(1,Q8t,4,2,"ng-container",9),A()),2&n){const e=t.$implicit,r=C().$implicit,s=C().$implicit,i=C();T(1),w("ngIf",i.mustDraw(e,r,s))}}function eut(n,t){if(1&n&&(F(),O(0,"g"),x(1,J8t,2,1,"g",1),A()),2&n){const e=C().$implicit,r=C();T(1),w("ngForOf",r.getLevelRange(e))}}function tut(n,t){if(1&n&&(F(),O(0,"g"),x(1,eut,2,1,"g",1),A()),2&n){const e=t.$implicit,r=C();T(1),w("ngForOf",r.getLevelRange(e))}}function nut(n,t){if(1&n&&(F(),X(0,"rect",14)),2&n){const e=C();Q2("id","highCapture_",e.highCapture.get().x,"_",e.highCapture.get().y,"_",e.highCapture.get().z,""),D("width",2*e.getPieceRadius(e.highCapture.get().z))("height",2*e.getPieceRadius(e.highCapture.get().z))("x",e.getPieceCxByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))("y",e.getPieceCyByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))}}function rut(n,t){if(1&n){const e=Ae();F(),O(0,"g",15),ee("click",function(){return he(e),le(C().validateCapture())}),X(1,"circle",16)(2,"polygon",17),A()}if(2&n){const e=C();D("transform","translate("+4*e.SPACE_SIZE+" "+4*e.SPACE_SIZE+")"),T(1),w("ngClass",e.getCaptureValidationButtonClasses()),D("cx",e.STROKE_WIDTH/2)("cy",e.STROKE_WIDTH/2)("r",e.SPACE_SIZE/2)}}function sut(n,t){if(1&n){const e=Ae();F(),O(0,"g",18),ee("click",function(){const i=he(e).$implicit;return le(C().onPieceClick(i.x,i.y,i.z))}),X(1,"line",19)(2,"line",19),A()}if(2&n){const e=t.$implicit,r=C();Q2("id","capturable_",e.x,"_",e.y,"_",e.z,""),D("transform","translate("+r.getPieceCxByCoord(e)+" "+r.getPieceCyByCoord(e)+")"),T(1),D("x1",-.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z)),T(1),D("x1",.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",-.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z))}}const iut=function(){return[0,1,2]};let out=(()=>{class n extends i8{constructor(e){super(e),this.boardWidth=4*this.SPACE_SIZE+this.STROKE_WIDTH,this.pieceRowHeight=this.SPACE_SIZE/2,this.boardHeight=this.boardWidth+2*this.pieceRowHeight,this.lastLandingCoord=y.empty(),this.lastStartingCoord=y.empty(),this.lastFirstCapture=y.empty(),this.lastSecondCapture=y.empty(),this.highCapture=y.empty(),this.capturables=[],this.chosenStartingCoord=y.empty(),this.chosenLandingCoord=y.empty(),this.chosenFirstCapture=y.empty(),this.chosenSecondCapture=y.empty(),this.lastMove=y.empty(),this.remainingPieces={0:15,1:15},this.hasAsymmetricBoard=!0,this.rules=bi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new s_(this.rules,"PylosMinimax"),new Hh(this.rules,"PylosOrderedMinimax")],this.encoder=Cs.encoder,this.tutorial=(new V3e).tutorial,this.updateBoard()}getPiecesCyForPlayer(e){return e===B.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(e){return F3.getLevelRange(e)}mustDraw(e,r,s){const i=new Nn(e,r,s);return!!(this.constructedState.getPieceAt(i).isPlayer()||this.justClimbed(i)||this.isCaptured(i))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(i)}isCaptured(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}onPieceClick(e,r,s){var i=this;return I(function*(){const o=i.canUserPlay("#piece_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Nn(e,r,s);return i.state.getPieceAt(c)===i.state.getCurrentOpponent()?i.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):i.chosenStartingCoord.equalsValue(c)?(i.cancelMoveAttempt(),z.SUCCESS):i.chosenLandingCoord.isPresent()?i.isSupporting(c,i.constructedState)?i.cancelMove(C8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onCaptureClick(c):i.isSupporting(c,i.getState())?i.cancelMove(C8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onClimbClick(c)})()}isSupporting(e,r){return r.isSupporting(e)}onClimbClick(e){var r=this;return I(function*(){return r.chosenStartingCoord=y.of(e),r.constructedState=r.constructedState.removePieceAt(e),z.SUCCESS})()}onCaptureClick(e){var r=this;return I(function*(){return r.chosenFirstCapture.equalsValue(e)?(r.chosenFirstCapture=y.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),z.SUCCESS):r.chosenSecondCapture.equalsValue(e)?(r.chosenSecondCapture=y.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),z.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=y.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),z.SUCCESS):r.chosenSecondCapture.isAbsent()?(r.chosenSecondCapture=y.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),z.SUCCESS):r.cancelMove(D3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var e=this;return I(function*(){const r=e.canUserPlay("#capture_validation");return r.isFailure()?e.cancelMove(r.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?z.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()])})()}concludeMoveWithCapture(e){var r=this;return I(function*(){let s;return s=r.chosenStartingCoord.isAbsent()?Cs.fromDrop(r.chosenLandingCoord.get(),e):Cs.fromClimb(r.chosenStartingCoord.get(),r.chosenLandingCoord.get(),e),r.tryMove(s,r.state)})()}tryMove(e,r){var s=this;return I(function*(){return s.cancelMove(),s.chooseMove(e,r)})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=y.empty(),this.chosenLandingCoord=y.empty(),this.chosenFirstCapture=y.empty(),this.chosenSecondCapture=y.empty(),this.capturables=[]}onDrop(e,r,s){var i=this;return I(function*(){const o=i.canUserPlay("#drop_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Nn(e,r,s);return bi.canCapture(i.constructedState,c)?(i.chosenLandingCoord=y.of(c),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(c),i.updateCapturableList(),z.SUCCESS):(i.chosenLandingCoord=y.of(c),i.concludeMoveWithCapture([]))})()}getSquareClasses(e,r,s){const i=new Nn(e,r,s);if(this.lastMove.isPresent()){const o=this.lastMove.get();if(o.firstCapture.equalsValue(i)||o.secondCapture.equalsValue(i))return["captured-fill"];if(i.equals(o.landingCoord)||o.startingCoord.equalsValue(i))return["moved-fill"]}else if(this.justClimbed(i))return["moved-fill"];return[]}justClimbed(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}getPieceRadius(e){return this.SPACE_SIZE*(.45+.025*e)}getPieceCx(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+e*this.SPACE_SIZE}getPieceCy(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+r*this.SPACE_SIZE}getPieceCxByCoord(e){return this.getPieceCx(e.x,e.y,e.z)}getPieceCyByCoord(e){return this.getPieceCy(e.x,e.y,e.z)}isOccupied(e,r,s){const i=new Nn(e,r,s);if(this.justClimbed(i))return!1;const o=this.getState().getPieceAt(i).isPlayer(),c=this.chosenLandingCoord.equalsValue(i);return o||c}getPieceClasses(e,r,s){const i=new Nn(e,r,s),o=[this.getPieceFillClass(i)];return(this.lastLandingCoord.equalsValue(i)||this.lastStartingCoord.equalsValue(i))&&o.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(i)||this.chosenLandingCoord.equalsValue(i))&&o.push("selected-stroke"),this.isCaptured(i)&&o.push("pre-captured-fill"),o}getPieceFillClass(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}getPlayerSidePieces(e){const r=this.remainingPieces[e.value],s=[];for(let i=0;i<r;i++)s.push(i);return s}updateBoard(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.node.move;const e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=y.empty(),this.cancelMoveAttempt(),this.hideLastMove()}showLastMove(e){this.lastLandingCoord=y.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}hideLastMove(){this.lastStartingCoord=y.empty(),this.lastLandingCoord=y.empty(),this.lastFirstCapture=y.empty(),this.lastSecondCapture=y.empty()}mustDrawCoord(e){return this.mustDraw(e.x,e.y,e.z)}mustDisplayLandingCoord(e,r,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new Nn(e,r,s))||this.chosenStartingCoord.get().z<s}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-pylos"]],features:[l],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"g"),x(2,Z8t,2,1,"g",1),A(),O(3,"g",null,2),X(5,"rect",3),x(6,tut,2,1,"g",1),x(7,nut,1,7,"rect",4),x(8,rut,3,5,"g",5),x(9,sut,3,12,"g",6),A()()),2&e&&(D("viewBox","0 0 "+r.boardWidth+" "+r.boardHeight),T(1),D("transform","rotate("+180*r.role.value+" "+r.boardWidth/2+" "+r.boardHeight/2+")"),T(1),w("ngForOf",r.Player.PLAYERS),T(1),D("transform","translate("+r.STROKE_WIDTH/2+" "+(r.STROKE_WIDTH/2+r.pieceRowHeight)+")"),T(2),D("width",4*r.SPACE_SIZE)("height",4*r.SPACE_SIZE),T(1),w("ngForOf",J1(10,iut)),T(1),w("ngIf",r.highCapture.isPresent()),T(1),w("ngIf",r.chosenLandingCoord.isPresent()),T(1),w("ngForOf",r.capturables))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ye{constructor(t){this.value=t}static fromInt(t){if(0<=t&&t<=15)return Ye.pieces[t];if(16===t)return Ye.EMPTY;throw new Error("Invalid piece ("+t+")")}equals(t){return this===t}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}Ye.AAAA=new Ye(0),Ye.AAAB=new Ye(1),Ye.AABA=new Ye(2),Ye.AABB=new Ye(3),Ye.ABAA=new Ye(4),Ye.ABAB=new Ye(5),Ye.ABBA=new Ye(6),Ye.ABBB=new Ye(7),Ye.BAAA=new Ye(8),Ye.BAAB=new Ye(9),Ye.BABA=new Ye(10),Ye.BABB=new Ye(11),Ye.BBAA=new Ye(12),Ye.BBAB=new Ye(13),Ye.BBBA=new Ye(14),Ye.BBBB=new Ye(15),Ye.EMPTY=new Ye(16),Ye.pieces=[Ye.AAAA,Ye.AAAB,Ye.AABA,Ye.AABB,Ye.ABAA,Ye.ABAB,Ye.ABBA,Ye.ABBB,Ye.BAAA,Ye.BAAB,Ye.BABA,Ye.BABB,Ye.BBAA,Ye.BBAB,Ye.BBBA,Ye.BBBB],Ye.encoder=xt.fromFunctions(n=>n.value,Ye.fromInt);class K4 extends Ks{constructor(t,e,r){super(t,e),this.piece=r}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(t){return this===t||!1!==t.coord.equals(this.coord)&&this.piece===t.piece}}K4.encoder=xt.tuple([S.encoder,Ye.encoder],n=>[n.coord,n.piece],n=>new K4(n[0].x,n[0].y,n[1]));class B3 extends Ur{constructor(t,e,r){super(t,e),this.pieceInHand=r}static getInitialState(){const t=Qe.createTable(4,4,Ye.EMPTY);return new B3(t,0,Ye.AAAA)}static isGivable(t,e,r){return t!==r&&!1===B3.isAlreadyOnBoard(t,e)}static isAlreadyOnBoard(t,e){for(let r=0;r<4;r++)for(let s=0;s<4;s++)if(e[r][s]===t)return!0;return!1}getRemainingPieces(){const t=Ye.pieces,e=[];for(const r of t)B3.isGivable(r,this.board,this.pieceInHand)&&e.push(r);return e}}let jH=(()=>{class n{}return n.MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`,n.PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`,n.CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`,n})();class i_{constructor(t){this.subCriterion=[y.empty(),y.empty(),y.empty(),y.empty()],this.subCriterion[0]=y.of(8==(8&t.value)),this.subCriterion[1]=y.of(4==(4&t.value)),this.subCriterion[2]=y.of(2==(2&t.value)),this.subCriterion[3]=y.of(1==(1&t.value))}mergeWith(t){let e=4;for(let r=0;r<4;r++)!1===this.subCriterion[r].equals(t.subCriterion[r])&&(this.subCriterion[r]=y.empty()),this.subCriterion[r].isAbsent()&&e--;return e>0}mergeWithQuartoPiece(t){const e=new i_(t);return this.mergeWith(e)}areAllAbsent(){for(let t=0;t<4;t++)if(this.subCriterion[t].isPresent())return!1;return!0}match(t){for(let e=0;e<4;e++)if(this.subCriterion[e].equals(t.subCriterion[e]))return!0;return!1}matchPiece(t){return this.match(new i_(t))}toString(){return"Criterion{"+this.subCriterion.map(t=>t.isPresent()?t.get()?"1":"0":"x").join(" ")+"}"}}class X4{constructor(t,e){this.initialCoord=t,this.direction=e}allCoords(){const t=[];for(let e=0;e<4;e++)t.push(this.initialCoord.getNext(this.direction,e));return t}}class Rr extends L1{constructor(){super(B3)}static get(){return Rr.singleton.isAbsent()&&(Rr.singleton=y.of(new Rr)),Rr.singleton.get()}static isOccupied(t){return t!==Ye.EMPTY}static isLegal(t,e){const r=t.coord.x,s=t.coord.y,i=t.piece,o=e.getCopiedBoard(),c=e.pieceInHand;return Rr.isOccupied(o[s][r])?z.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):i===Ye.EMPTY?15===e.turn?z.SUCCESS:z.failure(jH.MUST_GIVE_A_PIECE()):B3.isAlreadyOnBoard(i,o)?z.failure(jH.PIECE_ALREADY_ON_BOARD()):c===i?z.failure(jH.CANNOT_GIVE_PIECE_IN_HAND()):z.SUCCESS}isLegal(t,e){return Rr.isLegal(t,e)}applyLegalMove(t,e,r){const s=e.getCopiedBoard();return s[t.coord.y][t.coord.x]=e.pieceInHand,new B3(s,e.turn+1,t.piece)}static updateBoardStatus(t,e,r){return r.score===Sn.PRE_VICTORY?this.isThereAVictoriousLine(t,e)?{score:Sn.VICTORY,sensitiveSquares:new Nr}:r:this.searchForVictoryOrPreVictoryInLine(t,e,r)}static isThereAVictoriousLine(t,e){let r=t.initialCoord,s=e.getPieceAt(r);const i=new i_(s);for(let o=0;o<3&&!1!==Rr.isOccupied(s)&&!i.areAllAbsent();o++)r=r.getNext(t.direction,1),s=e.getPieceAt(r),i.mergeWithQuartoPiece(s);return!(!Rr.isOccupied(s)||i.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(t,e,r){const s=Rr.getLineInfos(t,e,r);if(s.boardStatus.isPresent())return s.boardStatus.get();const i=s.commonCriterion,o=s.sensitiveCoord;if(i.isPresent()&&!1===i.get().areAllAbsent()){if(o.isAbsent())return{score:Sn.VICTORY,sensitiveSquares:new Nr};{i.get().matchPiece(e.pieceInHand)&&(r.score=Sn.PRE_VICTORY);const c=o.get();r.sensitiveSquares.add(c)}}return r}static getLineInfos(t,e,r){let s=y.empty(),i=y.empty(),o=t.initialCoord;for(let c=0;c<4;c++){const u=e.getPieceAt(o);if(u===Ye.EMPTY){if(!s.isAbsent())return{sensitiveCoord:y.of(o),commonCriterion:i,boardStatus:y.of(r)};s=y.of(o)}else i.isAbsent()?(i=y.of(new i_(u)),J(Rr.VERBOSE,"set commonCrit to "+i.toString())):(i.get().mergeWithQuartoPiece(u),J(Rr.VERBOSE,"update commonCrit: "+i.toString()));o=o.getNext(t.direction,1)}return{commonCriterion:i,sensitiveCoord:s,boardStatus:y.empty()}}static scoreToGameStatus(t,e){const r=B.of(e%2);return t===Sn.VICTORY?xe.getDefeat(r):16===e?xe.DRAW:xe.ONGOING}getGameStatus(t){const e=t.gameState;let r={score:Sn.DEFAULT,sensitiveSquares:new Nr};for(const s of Rr.lines)if(r=Rr.updateBoardStatus(s,e,r),r.score===Sn.VICTORY)return Rr.scoreToGameStatus(r.score,e.turn);return Rr.scoreToGameStatus(r.score,e.turn)}getVictoriousCoords(t){for(const e of Rr.lines)if(Rr.isThereAVictoriousLine(e,t))return e.allCoords();return[]}}Rr.VERBOSE=!1,Rr.singleton=y.empty(),Rr.lines=[new X4(new S(0,0),Oe.DOWN),new X4(new S(1,0),Oe.DOWN),new X4(new S(2,0),Oe.DOWN),new X4(new S(3,0),Oe.DOWN),new X4(new S(0,0),Oe.RIGHT),new X4(new S(0,1),Oe.RIGHT),new X4(new S(0,2),Oe.RIGHT),new X4(new S(0,3),Oe.RIGHT),new X4(new S(0,0),Oe.DOWN_RIGHT),new X4(new S(0,3),Oe.UP_RIGHT)];class ZH extends Dc{static scoreToBoardValue(t,e){if(t===Sn.DEFAULT)return new M1(0);{const r=B.of(e%2);return new M1(t===Sn.PRE_VICTORY?r.getPreVictory():r.getDefeatValue())}}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getRemainingPieces(),o=r.pieceInHand;let c;for(let u=0;u<4;u++)for(let h=0;h<4;h++)if(s[u][h]===Ye.EMPTY){if(c=r.getCopiedBoard(),c[u][h]=o,15===r.turn){const g=new K4(h,u,Ye.EMPTY);return e.push(g),e}for(const g of i){const m=new K4(h,u,g);e.push(m)}}return e}getBoardValue(t){const e=t.gameState;let r={score:Sn.DEFAULT,sensitiveSquares:new Nr};for(const s of Rr.lines)if(r=Rr.updateBoardStatus(s,e,r),r.score===Sn.VICTORY)break;return ZH.scoreToBoardValue(r.score,e.turn)}}const aut=Ye.AABA,cut=Ye.AABB,H3e=Ye.ABAA,lut=Ye.ABAB,uut=Ye.ABBA,F3e=Ye.BAAA,fut=Ye.BAAB,hut=Ye.BABB,B3e=Ye.BBAA,dut=Ye.BBAB,YH=Ye.BBBA,put=Ye.BBBB,z1=Ye.EMPTY;class $3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new B3([[YH,B3e,H3e,aut],[z1,z1,z1,z1],[z1,z1,z1,z1],[z1,z1,z1,z1]],7,Ye.ABAB)),ie.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new B3([[YH,cut,uut,z1],[z1,z1,z1,z1],[z1,F3e,z1,z1],[z1,z1,z1,z1]],7,Ye.ABAA),new K4(2,2,Ye.BAAB),$localize`Perfect!`),ie.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new B3([[put,YH,dut,z1],[H3e,hut,B3e,z1],[lut,F3e,fut,z1],[z1,z1,z1,z1]],7,Ye.AABA),[new K4(3,3,Ye.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)]}}function gut(n,t){if(1&n&&(F(),X(0,"rect",12)),2&n){const e=C(2),r=e.$implicit,s=e.index,i=C().index,o=C();w("ngClass",o.getPieceClasses(r.value)),D("x",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function mut(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2),r=e.$implicit,s=e.index,i=C().index,o=C();w("ngClass",o.getPieceClasses(r.value)),D("cx",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function _ut(n,t){if(1&n&&(F(),X(0,"circle")),2&n){const e=C(2).index,r=C().index,s=C();D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function vut(n,t){if(1&n&&(F(),O(0,"g"),x(1,gut,1,5,"rect",10),x(2,mut,1,4,"ng-template",null,11,Gn),x(4,_ut,1,3,"circle",7),A()),2&n){const e=Fn(3),r=C().$implicit,s=C(2);T(1),w("ngIf",r.isRectangle())("ngIfElse",e),T(3),w("ngIf",s.pieceHasDot(r.value))}}function Cut(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",9),ee("click",function(){const i=he(e).index,o=C().index;return le(C().chooseCoord(i,o))}),A(),x(2,vut,5,3,"g",7),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Re("id","chooseCoord_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),D("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e!==i.EMPTY)}}function yut(n,t){if(1&n&&(F(),O(0,"g",null,8),x(2,Cut,3,8,"g",2),A()),2&n){const e=t.$implicit;T(2),w("ngForOf",e)}}function Eut(n,t){if(1&n&&(F(),X(0,"rect",17)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("x",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("y",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function Mut(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",e.getPieceSize(e.pieceInHand.value))}}function Sut(n,t){if(1&n&&(F(),X(0,"circle")),2&n){const e=C(2);D("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",10)}}function Put(n,t){if(1&n){const e=Ae();F(),O(0,"g",13,14),ee("click",function(){return he(e),le(C().deselectDroppedPiece())}),X(2,"rect",15),x(3,Eut,1,5,"rect",16),x(4,Mut,1,4,"ng-template",null,11,Gn),x(6,Sut,1,3,"circle",7),A()}if(2&n){const e=Fn(5),r=C();Re("id","droppedPiece_",r.chosen.get().x,"_",r.chosen.get().y,""),D("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),T(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),T(1),w("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),T(3),w("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Tut(n,t){if(1&n&&(F(),O(0,"g",null,18),X(2,"rect",19),A()),2&n){const e=t.$implicit,r=C();T(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+e.x*r.SPACE_SIZE+" "+e.y*r.SPACE_SIZE+")")}}function wut(n,t){if(1&n&&(F(),X(0,"rect",12)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("x",0)("y",.75*e.SPACE_SIZE)("transform","translate("+-e.getPieceSize(e.pieceInHand.value)+", "+-e.getPieceSize(e.pieceInHand.value)+")")("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function but(n,t){if(1&n&&(F(),X(0,"circle",21)),2&n){const e=C(2);w("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("cy",.75*e.SPACE_SIZE)("r",e.getPieceSize(e.pieceInHand.value))}}function Out(n,t){1&n&&(F(),X(0,"circle",22)),2&n&&D("cy",.75*C(2).SPACE_SIZE)("r",10)}function Aut(n,t){if(1&n&&(F(),O(0,"g"),x(1,wut,1,6,"rect",10),x(2,but,1,3,"ng-template",null,11,Gn),x(4,Out,1,2,"circle",20),A()),2&n){const e=Fn(3),r=C();T(1),w("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),T(3),w("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Nut(n,t){if(1&n&&(F(),X(0,"rect",27)),2&n){const e=C(2).index,r=C().index,s=C();d1("id","chosenPiece_",4*r+e,""),D("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)}}function Iut(n,t){if(1&n&&(F(),X(0,"rect",12)),2&n){const e=C(2).index,r=C().index,s=C();w("ngClass",s.getPieceClasses(4*r+e)),D("x",s.SPACE_SIZE*e+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("y",s.SPACE_SIZE*r+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("width",2*s.getPieceSize(4*r+e))("height",2*s.getPieceSize(4*r+e))}}function xut(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2).index,r=C().index,s=C();w("ngClass",s.getPieceClasses(4*r+e)),D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.getPieceSize(4*r+e))}}function kut(n,t){if(1&n&&(F(),X(0,"circle")),2&n){const e=C(2).index,r=C().index,s=C();D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function Lut(n,t){if(1&n){const e=Ae();F(),O(0,"g",13),ee("click",function(){he(e);const s=C().index,i=C().index;return le(C().choosePiece(4*i+s))}),x(1,Nut,1,5,"rect",26),x(2,Iut,1,5,"rect",10),x(3,xut,1,4,"ng-template",null,11,Gn),x(5,kut,1,3,"circle",7),A()}if(2&n){const e=Fn(4),r=C().index,s=C().index,i=C();d1("id","choosePiece_",4*s+r,""),T(1),w("ngIf",i.pieceToGive.equalsValue(i.QuartoPiece.fromInt(4*s+r))),T(1),w("ngIf",(4*s+r)%4<2)("ngIfElse",e),T(3),w("ngIf",i.pieceHasDot(4*s+r))}}function Rut(n,t){if(1&n&&(F(),O(0,"g"),x(1,Lut,6,5,"g",3),A()),2&n){const e=t.index,r=C().index,s=C();T(1),w("ngIf",s.isRemaining(4*r+e))}}function Dut(n,t){if(1&n&&(F(),O(0,"g",null,23),X(2,"rect",24,25),x(4,Rut,2,1,"g",2),A()),2&n){const e=t.$implicit,r=C();D("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),T(2),D("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),T(2),w("ngForOf",e)}}let zut=(()=>{class n extends Ho{constructor(e){super(e),this.EMPTY=Ye.EMPTY,this.QuartoPiece=Ye,this.chosen=y.empty(),this.lastMove=y.empty(),this.pieceInHand=Ye.EMPTY,this.pieceToGive=y.empty(),this.victoriousCoords=[],this.rules=Rr.get(),this.node=this.rules.getInitialNode(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new ZH(this.rules,"QuartoMinimax")],this.encoder=K4.encoder,this.tutorial=(new $3e).tutorial,this.pieceInHand=this.getState().pieceInHand,this.updateBoard()}updateBoard(){const e=this.getState(),r=this.node.move;this.board=e.getCopiedBoard(),this.chosen=y.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=r.map(s=>s.coord)}chooseCoord(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#chooseCoord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hideLastMove(),s.board[r][e]===Ye.EMPTY){if(s.showPieceInHandOnBoard(e,r),15===s.getState().turn){const o=new K4(e,r,Ye.EMPTY);return s.chooseMove(o,s.getState())}if(s.pieceToGive.isAbsent())return z.SUCCESS;{const o=new K4(e,r,s.pieceToGive.get());return s.chooseMove(o,s.getState())}}return s.cancelMove(tt.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(e){var r=this;return I(function*(){const s=r.canUserPlay("#choosePiece_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.hideLastMove(),r.pieceToGive.equalsValue(Ye.fromInt(e)))return r.cancelMoveAttempt(),z.SUCCESS;if(r.pieceToGive=y.of(Ye.fromInt(e)),r.chosen.isAbsent())return z.SUCCESS;{const i=r.chosen.get(),o=new K4(i.x,i.y,r.pieceToGive.get());return r.chooseMove(o,r.node.gameState)}})()}hideLastMove(){this.lastMove=y.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=y.empty(),this.chosen=y.empty()}deselectDroppedPiece(){const e=this.chosen.getOrElse(new S(404,404)),s=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return s.isFailure()?this.cancelMove(s.getReason()):(this.cancelMoveAttempt(),z.SUCCESS)}showPieceInHandOnBoard(e,r){this.chosen=y.of(new S(e,r))}isRemaining(e){return B3.isGivable(Ye.fromInt(e),this.board,this.pieceInHand)}getSquareClasses(e,r){const s=new S(e,r);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(e){const r=[];return r.push(e%2==0?"player0-fill":"player1-fill"),r}getPieceSize(e){return e<8?40:25}pieceHasDot(e){return e!==Ye.EMPTY.value&&e%8<4}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-quarto"]],features:[l],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"g",1),x(2,yut,3,1,"g",2),x(3,Put,7,8,"g",3),x(4,Tut,3,3,"g",2),O(5,"g",null,4),X(7,"rect",5,6),x(9,Aut,5,3,"g",7),A(),x(10,Dut,5,6,"g",2),A()()),2&e&&(D("viewBox","0 0 "+4.25*r.SPACE_SIZE+" "+10.75*r.SPACE_SIZE),T(2),w("ngForOf",r.board),T(1),w("ngIf",r.chosen.isPresent()),T(1),w("ngForOf",r.victoriousCoords),T(1),D("transform","translate("+2*r.SPACE_SIZE+", "+4.5*r.SPACE_SIZE+")"),T(2),D("width",1.5*r.SPACE_SIZE)("height",1.5*r.SPACE_SIZE)("transform","translate("+-.75*r.SPACE_SIZE+", 0)"),T(2),w("ngIf",r.chosen.isAbsent()),T(1),w("ngForOf",r.board))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Vut=(()=>{class n{}return n.NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`,n})();class fc extends Ks{constructor(t,e,r){super(t,e),this.direction=r;const s=fc.isValidCoord(this.coord);if(s.isFailure())throw new Error(s.getReason());if(0===t&&r===$e.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===t&&r===$e.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===e&&r===$e.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===e&&r===$e.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}static isInRange(t){return t.isInRange(5,5)}static isValidCoord(t){return!1===fc.isInRange(t)?z.failure("Invalid coord for QuixoMove: "+t.toString()+" is outside the board."):0!==t.x&&4!==t.x&&0!==t.y&&4!==t.y?z.failure(Vut.NO_INSIDE_CLICK()):z.SUCCESS}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(t){return t===this||!!t.coord.equals(this.coord)&&t.direction===this.direction}}fc.encoder=xt.tuple([S.encoder,$e.encoder],n=>[n.coord,n.direction],n=>new fc(n[0].x,n[0].y,n[1]));class z5 extends Ur{static getInitialState(){const t=Qe.createTable(5,5,pe.NONE);return new z5(t,0)}applyLegalMove(t){const e=this.getCopiedBoard(),r=this.turn+1;let s=t.coord,i=t.coord.getNext(t.direction);for(;fc.isInRange(i);)e[s.y][s.x]=e[i.y][i.x],s=s.getNext(t.direction),i=i.getNext(t.direction);return e[s.y][s.x]=this.getCurrentPlayer(),new z5(e,r)}}class e2 extends L1{constructor(){super(z5)}static get(){return e2.singleton.isAbsent()&&(e2.singleton=y.of(new e2)),e2.singleton.get()}static getVerticalCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=0;s<5;s++)t.gameState.getPieceAtXY(0,s)!==e&&r.push(new S(0,s)),t.gameState.getPieceAtXY(4,s)!==e&&r.push(new S(4,s));return r}static getHorizontalCenterCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=1;s<4;s++)t.gameState.getPieceAtXY(s,0)!==e&&r.push(new S(s,0)),t.gameState.getPieceAtXY(s,4)!==e&&r.push(new S(s,4));return r}static getPossibleDirections(t){const e=[];return 0!==t.x&&e.push($e.LEFT),0!==t.y&&e.push($e.UP),4!==t.x&&e.push($e.RIGHT),4!==t.y&&e.push($e.DOWN),e}static getLinesSums(t){const e={};e[B.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},e[B.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(let r=0;r<5;r++)for(let s=0;s<5;s++){const i=t.getPieceAtXY(s,r);if(i.isPlayer()){const o=i.value;e[o].columns[s]=e[o].columns[s]+1,e[o].rows[r]=e[o].rows[r]+1,s===r&&(e[o].diagonals[0]=e[o].diagonals[0]+1),s+r===4&&(e[o].diagonals[1]=e[o].diagonals[1]+1)}}return e}static getVictoriousCoords(t){return e2.QUIXO_HELPER.getVictoriousCoord(t)}static getFullestLine(t){const e=t.columns.concat(t.rows.concat(t.diagonals));return Math.max(...e)}applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){return e.getPieceAt(t.coord)===e.getCurrentOpponent()?z.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):z.SUCCESS}getGameStatus(t){const e=t.gameState,s=e2.QUIXO_HELPER.getVictoriousCoord(e).map(o=>e.getPieceAt(o)),i=new bt(s);return 0===i.size()?xe.ONGOING:1===i.size()?xe.getVictory(i.getAnyElement().get()):xe.getVictory(e.getCurrentPlayer())}}e2.singleton=y.empty(),e2.QUIXO_HELPER=new $m(fc.isInRange,Se.identity,5);class Hut extends xs{getListMoves(t){const e=[],r=e2.getVerticalCoords(t),i=e2.getHorizontalCenterCoords(t).concat(r);for(const o of i){const c=e2.getPossibleDirections(o);for(const u of c){const h=new fc(o.x,o.y,u);e.push(h)}}return e}getMetrics(t){const r=e2.getLinesSums(t.gameState);return[e2.getFullestLine(r[B.ZERO.value]),e2.getFullestLine(r[B.ONE.value])]}}const ur=pe.NONE,Yc=pe.ZERO,$3=pe.ONE;class U3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,z5.getInitialState()),ie.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new z5([[ur,ur,ur,ur,ur],[ur,ur,ur,ur,ur],[ur,ur,ur,ur,ur],[ur,ur,ur,ur,ur],[Yc,Yc,Yc,Yc,ur]],1),[new fc(4,4,$e.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),ie.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new z5([[ur,$3,ur,$3,$3],[ur,Yc,Yc,ur,Yc],[$3,$3,$3,Yc,$3],[Yc,ur,Yc,$3,$3],[$3,Yc,ur,$3,Yc]],31),[new fc(3,0,$e.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)]}}function Fut(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"circle",4),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onBoardClick(i,o))}),A()()}if(2&n){const e=t.index,r=C().index,s=C();T(1),Re("id","click_",e,"_",r,""),w("ngClass",s.getPieceClasses(e,r)),D("r",.45*s.SPACE_SIZE)("cx",(e+.5)*s.SPACE_SIZE)("cy",(r+.5)*s.SPACE_SIZE)}}function But(n,t){if(1&n&&(F(),O(0,"g"),x(1,Fut,2,6,"g",2),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function $ut(n,t){if(1&n){const e=Ae();F(),O(0,"use",6),ee("click",function(){const i=he(e).$implicit;return le(C(2).chooseDirection(i))}),A()}if(2&n){const e=t.$implicit,r=C(2);d1("id","chooseDirection_",e,""),D("transform",r.getArrowTransform(e))}}function Uut(n,t){if(1&n&&(F(),O(0,"g"),x(1,$ut,1,2,"use",5),A()),2&n){const e=C();T(1),w("ngForOf",e.getPossiblesDirections())}}let Gut=(()=>{class n extends Ho{constructor(e){super(e),this.lastMoveCoord=y.empty(),this.chosenCoord=y.empty(),this.victoriousCoords=[],this.rules=e2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Hut(this.rules,"QuixoMinimax")],this.encoder=fc.encoder,this.tutorial=(new U3e).tutorial,this.updateBoard()}updateBoard(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.node.move.map(e=>e.coord),this.victoriousCoords=e2.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=y.empty()}getPieceClasses(e,r){const s=new S(e,r),o=[];return o.push(this.getPlayerClass(this.board[r][e])),this.chosenCoord.equalsValue(s)?o.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&o.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),o}onBoardClick(e,r){const s=this.canUserPlay("#click_"+e+"_"+r);if(s.isFailure())return this.cancelMove(s.getReason());const i=new S(e,r),o=fc.isValidCoord(i);return o.isFailure()?this.cancelMove(o.getReason()):this.board[r][e]===this.state.getCurrentOpponent()?this.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(i)?this.cancelMoveAttempt():this.chosenCoord=y.of(i),z.SUCCESS)}getPossiblesDirections(){const e=[],r=this.chosenCoord.get();return 4!==r.x&&e.push($e.RIGHT),0!==r.x&&e.push($e.LEFT),4!==r.y&&e.push($e.DOWN),0!==r.y&&e.push($e.UP),e}chooseDirection(e){var r=this;return I(function*(){const s=r.canUserPlay("#chooseDirection_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):(r.chosenDirection=e,yield r.tryMove())})()}tryMove(){var e=this;return I(function*(){const r=e.chosenCoord.get(),s=new fc(r.x,r.y,e.chosenDirection);return e.cancelMove(),e.chooseMove(s,e.getState())})()}getArrowTransform(e){return class x6t{static getArrowTransform(t,e,r){let s,i,o;switch(r){case $e.UP:s=1,i=0,o=-90;break;case $e.DOWN:s=1,i=2,o=90;break;case $e.LEFT:s=0,i=1,o=180;break;default:Se.expectToBe(r,$e.RIGHT),s=2,i=1,o=0}return["scale("+t/300+")",`translate(${100*s} ${100*i})`,"rotate("+o+" 50 50)"].join(" ")}}.getArrowTransform(5*this.SPACE_SIZE,new S(0,0),e)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-quixo"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"defs"),X(2,"polygon",1),A(),x(3,But,2,1,"g",2),x(4,Uut,2,1,"g",3),A()),2&e&&(D("viewBox","0 0 "+5*r.SPACE_SIZE+" "+5*r.SPACE_SIZE),T(3),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),rs=(()=>{class n extends Ur{static getInitialState(){const e=Qe.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,pe.NONE);return e[3][3]=B.ZERO,e[4][4]=B.ZERO,e[3][4]=B.ONE,e[4][3]=B.ONE,new n(e,0)}static getNeighboringPawnLike(e,r,s,i){let o;const c=[];for(let u=-1;u<2;u++)for(let h=-1;h<2;h++)o=new S(s+h,i+u),o.isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[o.y][o.x]===r&&c.push(o);return c}countScore(){const e=[0,0];for(let r=0;r<n.BOARD_HEIGHT;r++)for(let s=0;s<n.BOARD_WIDTH;s++){const i=this.board[r][s];i.isPlayer()&&(e[i.value]+=1)}return e}}return n.BOARD_WIDTH=8,n.BOARD_HEIGHT=8,n})();class Zo extends Ks{toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}Zo.encoder=Ks.getEncoder(n=>new Zo(n.x,n.y)),Zo.PASS=new Zo(-1,-1);let qut=(()=>{class n{}return n.NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`,n})();class G3e{constructor(t,e){this.move=t,this.switched=e}}class Oi extends L1{constructor(){super(rs)}static get(){return Oi.singleton.isAbsent()&&(Oi.singleton=y.of(new Oi)),Oi.singleton.get()}static getGameStatus(t){const e=t.gameState;if(!1===Oi.isGameEnded(e))return xe.ONGOING;const s=e.countScore(),i=s[1]-s[0];return i<0?xe.ZERO_WON:i>0?xe.ONE_WON:xe.DRAW}applyLegalMove(t,e,r){const s=e.turn,i=e.getCurrentPlayer(),o=e.getCopiedBoard();if(t.equals(Zo.PASS))return new rs(o,s+1);for(const u of r)o[u.y][u.x]=i;return o[t.coord.y][t.coord.x]=i,new rs(o,s+1)}static getAllSwitcheds(t,e,r){const s=[],i=e.getOpponent();for(const o of Oe.DIRECTIONS){const c=t.coord.getNext(o);if(c.isInRange(rs.BOARD_WIDTH,rs.BOARD_HEIGHT)&&r[c.y][c.x]===i){const u=Oi.getSandwicheds(e,o,c,r);for(const h of u)s.push(h)}}return s}static getSandwicheds(t,e,r,s){const i=[r];let o=r.getNext(e);for(;o.isInRange(rs.BOARD_WIDTH,rs.BOARD_HEIGHT);){const c=s[o.y][o.x];if(c===t)return i;if(c===pe.NONE)return[];i.push(o),o=o.getNext(e)}return[]}static isGameEnded(t){return this.playerCanOnlyPass(t)&&this.nextPlayerCantOnlyPass(t)}getGameStatus(t){return Oi.getGameStatus(t)}static playerCanOnlyPass(t){const e=this.getListMoves(t);return 1===e.length&&e[0].move.equals(Zo.PASS)}static nextPlayerCantOnlyPass(t){const e=t.getCopiedBoard(),s=new rs(e,t.turn+1);return this.playerCanOnlyPass(s)}static getListMoves(t){const e=[];let r;const s=t.getCurrentPlayer(),i=t.getCurrentOpponent();for(let o=0;o<8;o++)for(let c=0;c<8;c++)if(t.getPieceAtXY(c,o)===pe.NONE&&(r=t.getCopiedBoard(),rs.getNeighboringPawnLike(r,i,c,o).length>0)){const h=new Zo(c,o),g=Oi.getAllSwitcheds(h,s,r);if(g.length>0){for(const m of g)Le(s!==t.getPieceAt(m),m+"was already switched!"),r[m.y][m.x]=s;r[o][c]=s,e.push(new G3e(h,g.length))}}return 0===e.length&&e.push(new G3e(Zo.PASS,0)),e}isLegal(t,e){if(t.equals(Zo.PASS))return Oi.playerCanOnlyPass(e)?_e.success([]):_e.failure(tt.CANNOT_PASS());if(e.getPieceAt(t.coord).isPlayer())return J(Oi.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),_e.failure(tt.MUST_CLICK_ON_EMPTY_SPACE());const r=e.getCopiedBoard(),s=Oi.getAllSwitcheds(t,e.getCurrentPlayer(),r);return J(Oi.VERBOSE,"ReversiRules.isLegal: "+s.length+" element(s) switched"),0===s.length?_e.failure(qut.NO_ELEMENT_SWITCHED()):_e.success(s)}}Oi.VERBOSE=!1,Oi.singleton=y.empty();class QP extends xs{getMetrics(t){const r=t.gameState.getCopiedBoard();let s=0,i=0;for(let o=0;o<rs.BOARD_HEIGHT;o++)for(let c=0;c<rs.BOARD_WIDTH;c++){const g=(0===c||c===rs.BOARD_WIDTH-1?4:1)*(0===o||o===rs.BOARD_HEIGHT-1?4:1);r[o][c]===B.ZERO&&(s+=g),r[o][c]===B.ONE&&(i+=g)}return[s,i]}getListMoves(t){const e=Oi.getListMoves(t.gameState);return Qe.sortByDescending(e,r=>QP.bestCoords.some(s=>r.move.coord.equals(s))?100:r.switched),e.map(r=>r.move)}}QP.bestCoords=[new S(0,0),new S(0,rs.BOARD_HEIGHT-1),new S(rs.BOARD_WIDTH-1,0),new S(rs.BOARD_WIDTH-1,rs.BOARD_HEIGHT-1)];const Ft=pe.NONE,Ut=pe.ZERO,ht=pe.ONE;class q3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new rs([[Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut],[Ut,ht,ht,ht,ht,ht,ht,Ut],[Ut,ht,ht,ht,ht,ht,ht,Ut],[Ut,ht,ht,ht,ht,ht,ht,Ut],[Ut,ht,ht,ht,ht,ht,ht,Ut],[Ut,ht,ht,ht,ht,ht,ht,Ut],[Ut,ht,ht,ht,ht,ht,ht,Ut],[Ut,Ut,Ut,Ut,Ut,Ut,Ut,Ut]],60)),ie.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,rs.getInitialState(),new Zo(2,4),$localize`Congratulations!`),ie.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new rs([[Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft],[Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft],[Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft],[Ft,Ft,Ft,Ft,ht,Ft,Ft,Ft],[Ft,Ft,Ft,Ut,Ft,Ft,Ft,Ft],[Ft,Ft,Ut,Ft,Ft,Ft,Ft,Ft],[Ut,Ut,Ft,Ft,Ft,Ft,Ft,Ft],[Ft,Ut,ht,Ut,ht,Ut,Ft,Ft]],1),[new Zo(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),ie.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new rs([[ht,Ut,Ut,Ut,Ut,Ut,ht,Ut],[Ut,ht,ht,ht,ht,ht,ht,Ut],[Ut,ht,ht,ht,ht,ht,ht,Ut],[Ut,ht,ht,ht,ht,ht,ht,Ut],[Ut,ht,ht,ht,ht,ht,ht,Ut],[Ut,ht,ht,ht,ht,ht,ht,Ut],[ht,ht,ht,ht,ht,ht,Ft,Ft],[Ut,Ut,Ut,Ut,Ut,Ut,Ft,Ft]],60))]}}function Wut(n,t){if(1&n&&(F(),X(0,"circle",4)),2&n){const e=C().index,r=C().index,s=C();w("ngClass",s.getPieceClass(e,r)),D("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)}}function jut(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",2),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),A(),x(2,Wut,1,4,"circle",3),A()}if(2&n){const e=t.index,r=C().index,s=C();T(1),Re("id","click_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),D("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function Zut(n,t){if(1&n&&(F(),O(0,"g"),x(1,jut,3,8,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let Yut=(()=>{class n extends Ho{constructor(e){super(e),this.EMPTY=pe.NONE,this.lastMove=new S(-2,-2),this.capturedCoords=[],this.scores=y.of([2,2]),this.rules=Oi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new QP(this.rules,"ReversiMinimax")],this.encoder=Zo.encoder,this.tutorial=(new q3e).tutorial,this.canPass=!1,this.updateBoard()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new Zo(e,r);return yield s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.capturedCoords=[],this.lastMove=new S(-2,-2),this.scores=y.of(e.countScore()),this.canPass=Oi.playerCanOnlyPass(e)}showLastMove(e){this.lastMove=e.coord;const r=this.getState().getCurrentPlayer(),s=this.getState().getCurrentOpponent();for(const i of Oe.DIRECTIONS){let o=this.lastMove.getNext(i,1);for(;o.isInRange(rs.BOARD_WIDTH,rs.BOARD_HEIGHT)&&this.getState().getPieceAt(o)===s&&this.getPreviousState().getPieceAt(o)===r;)this.capturedCoords.push(o),o=o.getNext(i,1)}}getRectClasses(e,r){const s=new S(e,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(e,r){return this.getPlayerClass(this.board[r][e])}pass(){var e=this;return I(function*(){return Le(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(Zo.PASS.coord.x,Zo.PASS.coord.y)})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-reversi"]],features:[l],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,Zut,2,1,"g",1),A()),2&e&&(D("viewBox","0 -4 "+8*r.SPACE_SIZE+" "+(10+8*r.SPACE_SIZE)),T(1),w("ngForOf",r.board))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Sa=(()=>{class n extends x5{static getInitialState(){const e=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE,i=Ie.EMPTY;return new n([[e,e,r,s,i,i,i,r,s,e,e],[e,i,i,i,i,i,i,i,i,i,e],[s,i,i,i,i,i,i,i,i,i,r],[r,i,i,i,i,i,i,i,i,i,s],[e,i,i,i,i,i,i,i,i,i,e],[e,e,s,r,i,i,i,s,r,e,e]],0)}}return n.HEIGHT=6,n.WIDTH=11,n})(),Fh=(()=>{class n{}return n.CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`,n.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`,n.MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`,n.MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`,n.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`,n.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`,n})();class U3 extends c8{constructor(t,e){super(t,e)}static checkDistanceAndLocation(t,e){const r=t.getOrthogonalDistance(e);if(0===r)return z.failure(tt.MOVE_CANNOT_BE_STATIC());if(1===r){const s=Vc.getFakeNeighbors(t);if(e.equals(s))return z.failure(Fh.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==r)return z.failure($localize`You can move one or two spaces, not ${r}.`);if(Vc.isSpaceDark(t))return z.failure(Fh.CAN_ONLY_REBOUND_ON_BLACK());if(t.x===e.x)return z.failure(Fh.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return z.SUCCESS}static from(t,e){if(!t.isInRange(Sa.WIDTH,Sa.HEIGHT))throw new Error("Move must start inside the board not at "+t.toString()+".");if(!e.isInRange(Sa.WIDTH,Sa.HEIGHT))throw new Error("Move must end inside the board not at "+e.toString()+".");const r=U3.checkDistanceAndLocation(t,e);return r.isFailure()?r.toOtherFallible():_e.success(new U3(t,e))}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}equals(t){return t===this||!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}U3.encoder=io.getFallibleEncoder(U3.from);class $2 extends L1{constructor(){super(Sa)}static get(){return $2.singleton.isAbsent()&&($2.singleton=y.of(new $2)),$2.singleton.get()}static getStartingCoords(t,e){const r=[];for(let s=0;s<Sa.HEIGHT;s++)for(let i=0;i<Sa.WIDTH;i++)t[s][i].is(e)&&r.push(new S(i,s));return r}static getBoardValuesFor(t,e){const r=$2.getStartingCoords(t,e),s=[];for(const i of r){const o=x5.getEmptyNeighbors(t,i,Ie.EMPTY).length;if(0===o)return[0];s.push(o)}return s.sort((i,o)=>i-o)}applyLegalMove(t,e,r){J($2.VERBOSE,"Legal move "+t.toString()+" applied");const s=e.getCopiedBoard();return s[t.getEnd().y][t.getEnd().x]=s[t.getStart().y][t.getStart().x],s[t.getStart().y][t.getStart().x]=Ie.EMPTY,new Sa(s,e.turn+1)}isLegal(t,e){if(e.getPieceAt(t.getStart()).value!==e.getCurrentPlayer().value)return z.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE());if(e.getPieceAt(t.getEnd())!==Ie.EMPTY)return z.failure(tt.MUST_LAND_ON_EMPTY_SPACE());const i=Vc.getCommonNeighbor(t.getStart(),t.getEnd());return i.isPresent()?e.getPieceAt(i.get())===Ie.EMPTY?z.SUCCESS:z.failure(Fh.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):z.SUCCESS}getGameStatus(t){const e=t.gameState.getCopiedBoard(),r=$2.getBoardValuesFor(e,B.ZERO),s=$2.getBoardValuesFor(e,B.ONE);return $2.getGameStatusFromFreedoms(r,s)}getLandingCoords(t,e){const r=i=>i.isInRange(Sa.WIDTH,Sa.HEIGHT)&&t[i.y][i.x]===Ie.EMPTY,s=new bt(Vc.getNeighbors(e).filter(r));if(!0===Vc.isSpaceDark(e))return s.toList();{const i=new bt(s.toList());for(const o of s){const c=Vc.getNeighbors(o).filter(r);for(const u of c)i.add(u)}return i.toList()}}static getGameStatusFromFreedoms(t,e){return 0===t[0]?xe.ONE_WON:0===e[0]?xe.ZERO_WON:xe.ONGOING}}$2.VERBOSE=!1,$2.singleton=y.empty();class Kut extends xs{getListMoves(t){const e=[],r=t.gameState.getCopiedBoard(),s=t.gameState.getCurrentPlayer(),i=$2.getStartingCoords(r,s);for(const o of i){const c=x5.getEmptyNeighbors(r,o,Ie.EMPTY);for(const u of c){const h=U3.from(o,u).get();if(r[u.y][u.x]=r[o.y][o.x],r[o.y][o.x]=Ie.EMPTY,e.push(h),(u.y+u.x)%2==0){const m=x5.getEmptyNeighbors(r,u,Ie.EMPTY);for(const E of m)if(!E.equals(o)){const b=U3.from(o,E).get();r[E.y][E.x]=r[u.y][u.x],r[u.y][u.x]=Ie.EMPTY,e.push(b),r[u.y][u.x]=r[E.y][E.x],r[E.y][E.x]=Ie.EMPTY}}r[o.y][o.x]=r[u.y][u.x],r[u.y][u.x]=Ie.EMPTY}}return e}getMetrics(t){const e=t.gameState.board,r=$2.getBoardValuesFor(e,B.ZERO),s=$2.getBoardValuesFor(e,B.ONE);let i=0;for(;i<6&&r[i]===s[i];)i++;return[r[i%6],s[i%6]]}}const Kc=Ie.UNREACHABLE,Bh=Ie.ZERO,$h=Ie.ONE,Rn=Ie.EMPTY;class W3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Initial board`,$localize`Sâhârâ is played on a board where each space is a triangle.
        Each player has six pyramids.`,Sa.getInitialState()),ie.informational($localize`Goal of the game`,$localize`At Sâhârâ, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new Sa([[Kc,Kc,Rn,Rn,$h,Rn,Rn,Bh,$h,Kc,Kc],[Kc,Rn,Rn,Rn,Rn,Rn,Rn,Rn,Rn,Rn,Kc],[$h,Bh,Rn,Rn,Rn,Rn,Rn,Rn,Rn,Rn,Bh],[Bh,Rn,Rn,Rn,Rn,Rn,Rn,Rn,Rn,Rn,$h],[Kc,Rn,Rn,Rn,Rn,Rn,Rn,Rn,Rn,Rn,Kc],[Kc,Kc,$h,Bh,Rn,Rn,Rn,$h,Bh,Kc,Kc]],3)),ie.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,Sa.getInitialState(),U3.from(new S(2,0),new S(2,1)).get(),(t,e,r)=>t.isSimpleStep()?z.SUCCESS:z.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),ie.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,Sa.getInitialState(),U3.from(new S(7,0),new S(5,0)).get(),(t,e,r)=>t.isSimpleStep()?z.failure($localize`Failed! You have made a single step.`):z.SUCCESS,$localize`Congratulations!`)]}}function Xut(n,t){if(1&n&&(F(),O(0,"g"),X(1,"polygon",7),A()),2&n){const e=C().index,r=C().index,s=C();T(1),w("ngClass",s.getPlayerClassFor(e,r)),D("points",s.getPyramidCoordinate(e,r))}}function Qut(n,t){if(1&n&&(F(),X(0,"polygon",10)),2&n){const e=C(2).index,r=C().index;D("points",C().getTriangleCoordinate(e,r))}}function Jut(n,t){if(1&n&&(F(),X(0,"polygon",11)),2&n){const e=C(2).index,r=C().index;D("points",C().getTriangleCoordinate(e,r))}}function e5t(n,t){if(1&n&&(F(),O(0,"g"),x(1,Qut,1,1,"polygon",8),x(2,Jut,1,1,"polygon",9),A()),2&n){const e=C().index,r=C().index;T(1),w("ngIf",(e+r)%2==1),T(1),w("ngIf",(e+r)%2==0)}}function t5t(n,t){if(1&n){const e=Ae();F(),O(0,"g",5),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),x(1,Xut,2,2,"g",6),x(2,e5t,3,2,"g",6),A()}if(2&n){const e=t.$implicit;Re("id","click_",t.index,"_",C().index,""),T(1),w("ngIf",e.isPlayer()),T(1),w("ngIf",2===e.value)}}function n5t(n,t){if(1&n&&(F(),O(0,"g"),x(1,t5t,3,4,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function r5t(n,t){if(1&n&&(F(),X(0,"polygon",14)),2&n){const e=t.$implicit,r=C(2);Re("id","possible_landing_",e.x,"_",e.y,""),D("points",r.getTriangleCoordinate(e.x,e.y))}}function s5t(n,t){if(1&n&&(F(),X(0,"polygon",14)),2&n){const e=C(2);Re("id","chosen_coord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function i5t(n,t){if(1&n&&(F(),hn(0),x(1,r5t,1,3,"polygon",12),x(2,s5t,1,3,"polygon",13),dn()),2&n){const e=C();T(1),w("ngForOf",e.possibleLandings),T(1),w("ngIf",e.chosenCoord.isPresent())}}function o5t(n,t){if(1&n&&(F(),hn(0),X(1,"polygon",15)(2,"polygon",15),dn()),2&n){const e=C(2);T(1),D("points",e.getTriangleCoordinate(e.lastCoord.get().x,e.lastCoord.get().y)),T(1),D("points",e.getTriangleCoordinate(e.lastMoved.get().x,e.lastMoved.get().y))}}function a5t(n,t){1&n&&(F(),x(0,o5t,3,2,"ng-container",6)),2&n&&w("ngIf",C().lastMoved.isPresent())}let c5t=(()=>{class n extends t3e{constructor(e){super(e),this.lastCoord=y.empty(),this.lastMoved=y.empty(),this.chosenCoord=y.empty(),this.possibleLandings=[],this.rules=$2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Kut(this.rules,"SaharaMinimax")],this.encoder=U3.encoder,this.tutorial=(new W3e).tutorial,this.updateBoard()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=y.empty()}onClick(e,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentPlayer(),c=Ie.ofPlayer(o);return s.chosenCoord.equalsValue(new S(e,r))?(s.cancelMoveAttempt(),z.SUCCESS):s.chosenCoord.isAbsent()||s.board[r][e]===c?s.choosePiece(e,r):s.chooseLandingCoord(e,r)})()}choosePiece(e,r){if(this.board[r][e]===Ie.EMPTY)return this.cancelMove(Fh.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[r][e].is(B.fromTurn(this.getTurn()))){const s=new S(e,r);return this.selectPiece(s),z.SUCCESS}return this.cancelMove(Fh.MUST_CHOOSE_OWN_PYRAMID())}selectPiece(e){this.chosenCoord=y.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}chooseLandingCoord(e,r){var s=this;return I(function*(){const i=new S(e,r),o=U3.from(s.chosenCoord.get(),i);return o.isFailure()?s.cancelMove(o.getReason()):yield s.chooseMove(o.get(),s.getState())})()}updateBoard(){const e=this.node.move;this.lastCoord=e.map(r=>r.getStart()),this.lastMoved=e.map(r=>r.getEnd()),this.board=this.getState().board}getPlayerClassFor(e,r){return this.getPlayerClass(B.of(this.board[r][e].value))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-sahara"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","selected-stroke",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,r){if(1&e&&(F(),O(0,"svg",0),x(1,n5t,2,1,"g",1),x(2,i5t,3,2,"ng-container",2),x(3,a5t,1,1,"ng-template",null,3,Gn),A()),2&e){const s=Fn(4);T(1),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Pa extends Ks{constructor(t,e,r,s){super(t,e),this.x=t,this.y=e,this.direction=r,this.landingOrientation=s}static of(t,e,r,s){const i=new Pa(t,e,r,s),o=i.coord.isNotInRange(5,5);if(i.isRotation()){if(o)return _e.failure("Cannot rotate piece outside the board: "+i.toString())}else if(i.coord.getNext(i.direction.get()).isNotInRange(5,5)){if(o)return _e.failure("SiamMove should end or start on the board: "+i.toString());if(i.direction.get()!==i.landingOrientation)return _e.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+i.toString())}return _e.success(i)}isRotation(){return this.direction.isAbsent()}equals(t){return this===t||!(!this.coord.equals(t.coord)||!1===this.direction.equals(t.direction))&&this.landingOrientation===t.landingOrientation}toString(){const t=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+t+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}Pa.encoder=xt.tuple([xt.identity(),xt.identity(),y.getEncoder($e.encoder),$e.encoder],n=>[n.x,n.y,n.direction,n.landingOrientation],n=>Pa.of(n[0],n[1],n[2],n[3]).get());class _t{constructor(t){this.value=t}static decode(t){switch(t){case 0:return _t.EMPTY;case 1:return _t.LIGHT_UP;case 2:return _t.LIGHT_RIGHT;case 3:return _t.LIGHT_DOWN;case 4:return _t.LIGHT_LEFT;case 5:return _t.DARK_UP;case 6:return _t.DARK_RIGHT;case 7:return _t.DARK_DOWN;case 8:return _t.DARK_LEFT;case 9:return _t.MOUNTAIN}}belongTo(t){return t===B.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?B.ZERO:5<=this.value&&this.value<=8?B.ONE:pe.NONE}getOptionalDirection(){switch(this.value){case 0:return y.empty();case 1:case 5:return y.of($e.UP);case 2:case 6:return y.of($e.RIGHT);case 3:case 7:return y.of($e.DOWN);case 4:case 8:return y.of($e.LEFT);default:return Se.expectToBe(this.value,9),y.empty()}}static of(t,e){return e===B.ZERO?t===$e.UP?_t.LIGHT_UP:t===$e.RIGHT?_t.LIGHT_RIGHT:t===$e.DOWN?_t.LIGHT_DOWN:_t.LIGHT_LEFT:t===$e.UP?_t.DARK_UP:t===$e.RIGHT?_t.DARK_RIGHT:t===$e.DOWN?_t.DARK_DOWN:_t.DARK_LEFT}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return Se.expectToBe(this.value,9),"MOUNTAIN"}}}_t.EMPTY=new _t(0),_t.LIGHT_UP=new _t(1),_t.LIGHT_RIGHT=new _t(2),_t.LIGHT_DOWN=new _t(3),_t.LIGHT_LEFT=new _t(4),_t.DARK_UP=new _t(5),_t.DARK_RIGHT=new _t(6),_t.DARK_DOWN=new _t(7),_t.DARK_LEFT=new _t(8),_t.MOUNTAIN=new _t(9);class G3 extends Ur{static getInitialState(){const t=Qe.createTable(5,5,_t.EMPTY);return t[2][1]=_t.MOUNTAIN,t[2][2]=_t.MOUNTAIN,t[2][3]=_t.MOUNTAIN,new G3(t,0)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(let e=0;e<5;e++)for(let r=0;r<5;r++)this.board[e][r]!==_t.EMPTY&&t[this.getPieceAtXY(r,e).getOwner().value]++;return t}}let Uh=(()=>{class n{}return n.NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`,n.NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`,n.MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`,n.ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`,n.MUST_SELECT_VALID_DESTINATION=()=>$localize`You must select a valid destination (highlighted on the board) for your piece`,n.MUST_SELECT_ORIENTATION=()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`,n})();class j3e{constructor(t,e){this.resultingBoard=t,this.moved=e}}class Cr extends L1{constructor(){super(G3)}static get(){return Cr.singleton.isAbsent()&&(Cr.singleton=y.of(new Cr)),Cr.singleton.get()}isLegal(t,e){if(J(Cr.VERBOSE,{SiamRules_isLegal:{move:t,state:e}}),!t.isInsertion()&&!e.getPieceAt(t.coord).belongTo(e.getCurrentPlayer()))return _e.failure(tt.MUST_CHOOSE_PLAYER_PIECE());if(t.isRotation())return J(Cr.VERBOSE,"Move is rotation"),this.isLegalRotation(t,e);{let r;if(t.isInsertion()){J(Cr.VERBOSE,"Move is insertion");const s=this.isLegalInsertion(t.coord,e);if(s.legal.isFailure())return _e.failure(s.legal.getReason());r=s.insertedPiece}else J(Cr.VERBOSE,"Move is forward"),r=e.getPieceAt(t.coord);return this.isLegalForwarding(t,e,r)}}isLegalInsertion(t,e){const r=e.countCurrentPlayerPawn(),s=e.getCurrentPlayer(),i=r<5?z.SUCCESS:z.failure(Uh.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(t,s),legal:i}}getInsertedPiece(t,e){return _t.of(-1===t.x?$e.RIGHT:-1===t.y?$e.DOWN:5===t.x?$e.LEFT:$e.UP,e)}isLegalForwarding(t,e,r){Le(r!==_t.MOUNTAIN&&r!==_t.EMPTY,"forwarding must be done with player piece");const s=[];let i=_t.of(t.landingOrientation,e.getCurrentPlayer());const o=t.direction.get();let c=t.coord.getNext(o);if(c.isInRange(5,5)&&e.getPieceAt(c)!==_t.EMPTY&&!1===this.isStraight(r,t))return _e.failure(Uh.ILLEGAL_PUSH());let u=y.of(o);const h=o.getOpposite();let g=0;const m=e.getCopiedBoard();t.coord.isInRange(5,5)&&(m[t.coord.y][t.coord.x]=_t.EMPTY,s.push(t.coord));let E=c.isInRange(5,5)&&i!==_t.EMPTY;for(;E;){u.equalsValue(o)?g++:u.equalsValue(h)&&g--;const b=m[c.y][c.x];b===_t.MOUNTAIN&&(g-=.9),m[c.y][c.x]=i,s.push(c),i=b,c=c.getNext(o),u=i.getOptionalDirection(),E=c.isInRange(5,5)&&i!==_t.EMPTY&&g>0}return c.isNotInRange(5,5)&&(u.equalsValue(o)?g++:u.equalsValue(h)&&g--),g<=0?_e.failure(Uh.NOT_ENOUGH_FORCE_TO_PUSH()):_e.success(new j3e(m,s))}isStraight(t,e){const r=t.getDirection();return e.direction.equalsValue(r)&&r===e.landingOrientation}isLegalRotation(t,e){J(Cr.VERBOSE,{isLegalRotation:{rotation:t,state:e}});const r=t.coord,s=e.getPieceAt(r),i=e.getCurrentPlayer();if(s.getDirection()===t.landingOrientation)return _e.failure(Uh.MUST_MOVE_OR_ROTATE());const o=e.getCopiedBoard();return o[r.y][r.x]=_t.of(t.landingOrientation,i),_e.success(new j3e(o,[r]))}applyLegalMove(t,e,r){const s=Qe.copyBiArray(r.resultingBoard);return new G3(s,e.turn+1)}getBoardValueInfo(t,e){const r=this.getMountainsRowsAndColumns(e),s=r.rows,i=r.columns,o=this.getWinner(e,t,r.nbMountain);if(o.isPlayer())return o===B.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const c=this.getPushers(e,i,s);let u=Number.MAX_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER;const g=e.getCurrentPlayer();for(const E of c)E.coord.isInRange(5,5)?e.getPieceAt(E.coord).belongTo(B.ZERO)?u=Math.min(u,E.distance):h=Math.min(h,E.distance):g===B.ZERO?u=Math.min(u,E.distance):h=Math.min(h,E.distance);return{shortestZero:u,shortestOne:h,boardValue:this.getScoreFromShortestDistances(u,h,g)}}}getScoreFromShortestDistances(t,e,r){t===Number.MAX_SAFE_INTEGER&&(t=6),e===Number.MAX_SAFE_INTEGER&&(e=6);const s=6-t,i=6-e;return s===i?r.getScoreModifier():s>i?-10*(s+1)+(i+1):10*(i+1)-(s+1)}getMountainsRowsAndColumns(t){const e=[],r=[];let s=0;for(let i=0;i<5;i++)for(let o=0;o<5;o++)t.getPieceAtXY(o,i)===_t.MOUNTAIN&&(e.includes(i)||e.push(i),r.includes(o)||r.push(o),s++);return{rows:e,columns:r,nbMountain:s}}getWinner(t,e,r){return 2===r?this.getPusher(t,e.get()):pe.NONE}getPusher(t,e){const r=e.coord;let s;s=r.isInRange(5,5)?t.getPieceAt(r.getNext(e.landingOrientation)):this.getInsertedPiece(r,t.getCurrentOpponent());const i=s.getDirection(),o=this.getPusherCoord(t,i,r),c=t.getPieceAt(o).getOwner();return J(Cr.VERBOSE,r.toString()+" belong to "+t.getCurrentOpponent().value+", "+o.toString()+" belong to "+c.value+", "+c.value+" win"),c}getPusherCoord(t,e,r){let s=r.getNext(e),i=r;for(;s.isInRange(5,5);){r=s,s=s.getNext(e);const o=t.getPieceAt(r);o!==_t.MOUNTAIN&&o.getDirection()===e&&(i=r)}return i}getPushers(t,e,r){J(Cr.VERBOSE,{getPushers:{state:t,mountainsColumn:e,mountainsRow:r}});let s=[];const i=[];for(const o of e){let c=$e.DOWN,u=new S(o,4);i.push({direction:c,fallingCoord:u}),c=$e.UP,u=new S(o,0),i.push({direction:c,fallingCoord:u})}for(const o of r){let c=$e.LEFT,u=new S(0,o);i.push({direction:c,fallingCoord:u}),c=$e.RIGHT,u=new S(4,o),i.push({direction:c,fallingCoord:u})}for(const o of i)s=this.addPotentialDirectionPusher(t,o.fallingCoord,o.direction,s);return s}addPotentialDirectionPusher(t,e,r,s){const i=this.getLineClosestPusher(t,e,r);if(i.isAbsent())return s;const o=i.get(),c=o.distance;return J(Cr.VERBOSE,"new closest challenger"),s.push({coord:o.coord,distance:c}),s}getLineClosestPusher(t,e,r){J(Cr.VERBOSE,{getDirectionClosestPusher:{state:t,fallingCoord:e,direction:r.toString()}});const s=r.getOpposite();let i=1,o=t.getPieceAt(e),c=e,u=y.empty(),h=!1,g=!1,m=0;for(;c.isInRange(5,5)&&!1===h;){const E=t.getPieceAt(c);if(E.isEmptyOrMountain())E===_t.MOUNTAIN?(m+=.9,g=!0):i++;else{const b=E.getDirection();b===r?g&&(m-=1,m<=0&&(h=!0,c=c.getNext(r))):b===s?(m+=1,g||i++):g?(u=y.of(c),o!==_t.EMPTY&&i++):i++}o=E,c=c.getPrevious(r)}if(!1===h&&u.isPresent())for(i++,m-=1;!1===c.equals(u.get());)c=c.getNext(r),i--;return c.isNotInRange(5,5)&&(m-=1,5===t.countCurrentPlayerPawn())||m>0?y.empty():y.of({distance:i,coord:c})}getInsertions(t){let e=[];for(let r=1;r<4;r++)e=e.concat(this.getInsertionsAt(t,0,r)),e=e.concat(this.getInsertionsAt(t,4,r)),e=e.concat(this.getInsertionsAt(t,r,0)),e=e.concat(this.getInsertionsAt(t,r,4));return e=e.concat(this.getInsertionsAt(t,0,0)),e=e.concat(this.getInsertionsAt(t,0,4)),e=e.concat(this.getInsertionsAt(t,4,0)),e=e.concat(this.getInsertionsAt(t,4,4)),e}getInsertionsAt(t,e,r){const s=[];for(const i of $e.ORTHOGONALS){const o=new S(e,r).getPrevious(i);if(o.isNotInRange(5,5))for(const c of $e.ORTHOGONALS){const u=Pa.of(o.x,o.y,y.of(i),c);Le(u.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(u.get(),t).isSuccess()&&s.push(u.get())}}return s}getMovesFrom(t,e,r,s){const i=new S(r,s);let o=this.getRotationMovesAt(i,e);for(const c of $e.ORTHOGONALS){const u=i.getNext(c);o=o.concat(this.getForwardMovesBetween(t,i,u))}return o}getMovesBetween(t,e,r,s){return r.equals(s)?this.getRotationMovesAt(r,e):$e.factory.fromMove(r,s).isSuccess()&&1===r.getDistance(s)?this.getForwardMovesBetween(t,r,s):[]}getRotationMovesAt(t,e){const r=[],s=e.getDirection();for(const i of $e.ORTHOGONALS)if(i!==s){const o=Pa.of(t.x,t.y,y.empty(),i).get();r.push(o)}return r}getForwardMovesBetween(t,e,r){const s=[];let i;const o=$e.factory.fromMove(e,r).get(),c=t.getPieceAt(e);i=r.isInRange(5,5)?$e.ORTHOGONALS:[o];for(const u of i){const h=Pa.of(e.x,e.y,y.of(o),u).get();this.isLegalForwarding(h,t,c).isSuccess()&&s.push(h)}return s}getGameStatus(t){const e=this.getMountainsRowsAndColumns(t.gameState),r=this.getWinner(t.gameState,t.move,e.nbMountain);return r.isPlayer()?xe.getVictory(r):xe.ONGOING}}Cr.singleton=y.empty(),Cr.VERBOSE=!1;class l5t extends Dc{getBoardValue(t){return new M1(Cr.get().getBoardValueInfo(t.move,t.gameState).boardValue)}getListMoves(t){let e=[];const r=t.gameState.getCurrentPlayer();for(let s=0;s<5;s++)for(let i=0;i<5;i++){const o=t.gameState.getPieceAtXY(i,s);o.belongTo(r)&&(e=e.concat(Cr.get().getMovesFrom(t.gameState,o,i,s)))}if(t.gameState.countCurrentPlayerPawn()<5)for(const s of Cr.get().getInsertions(t.gameState))if(s.direction.get().getOpposite()!==s.landingOrientation){if(this.isOnBorder(s)&&s.direction.get()!==s.landingOrientation)continue;e.push(s)}return J(Cr.VERBOSE,{getListMovesResult:e}),e}isOnBorder(t){return 0===t.coord.x||4===t.coord.x||0===t.coord.y||4===t.coord.y}}const Ze=_t.EMPTY,hc=_t.MOUNTAIN,KH=_t.LIGHT_UP,XH=_t.LIGHT_LEFT,Gh=_t.LIGHT_RIGHT,u5t=_t.LIGHT_DOWN,f5t=_t.DARK_UP,Z3e=_t.DARK_LEFT,Y3e=_t.DARK_RIGHT,h5t=_t.DARK_DOWN;class K3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,G3.getInitialState()),ie.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,G3.getInitialState(),Pa.of(2,-1,y.of($e.DOWN),$e.DOWN).get(),$localize`Congratulations!`),ie.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new G3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,hc,hc,hc,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,KH,Ze,Ze]],0),[Pa.of(2,4,y.of($e.UP),$e.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),ie.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new G3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,hc,hc,hc,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,KH,Ze,Ze]],0),[Pa.of(2,4,y.of($e.DOWN),$e.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),ie.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new G3([[Ze,Gh,Z3e,Ze,Ze],[Gh,Y3e,XH,Ze,Ze],[Ze,Ze,KH,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze]],0),[Pa.of(2,2,y.of($e.UP),$e.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new G3([[Ze,Ze,Gh,hc,Ze],[Ze,Ze,Gh,hc,XH],[Ze,Gh,hc,hc,Ze],[Ze,Gh,Y3e,Z3e,hc],[Ze,Ze,Ze,Ze,Ze]],0),[Pa.of(1,3,y.of($e.RIGHT),$e.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),ie.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new G3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[hc,f5t,XH,Ze,u5t],[Ze,Ze,Ze,Ze,h5t],[Ze,Ze,Ze,Ze,hc]],0),[Pa.of(2,2,y.of($e.LEFT),$e.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)]}}function d5t(n,t){if(1&n){const e=Ae();F(),O(0,"use",11),ee("click",function(){he(e);const s=C().index,i=C().index;return le(C().clickSquare(s,i))}),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C();Re("id","piece_",r,"_",i,""),w("ngClass",o.getPieceClasses(r,i,s)),D("transform",o.getPieceTransform(r,i))}}function p5t(n,t){if(1&n){const e=Ae();F(),O(0,"use",12),ee("click",function(){he(e);const s=C().index,i=C().index;return le(C().clickSquare(s,i))}),A()}if(2&n){const e=C().index,r=C().index,s=C();D("transform","translate("+(e+1)*s.SPACE_SIZE+" "+(r+1)*s.SPACE_SIZE+")")}}function g5t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",8),ee("click",function(){const i=he(e).index,o=C().index;return le(C().clickSquare(i,o))}),A(),x(2,d5t,1,4,"use",9),x(3,p5t,1,1,"use",10),A()}if(2&n){const e=t.$implicit,r=t.index,s=C().index,i=C();T(1),Re("id","square_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),D("x",i.SPACE_SIZE*(r+1))("y",i.SPACE_SIZE*(s+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",e.isPiece()),T(1),w("ngIf",i.isMountain(e))}}function m5t(n,t){if(1&n&&(F(),O(0,"g"),x(1,g5t,4,9,"g",4),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function _5t(n,t){if(1&n){const e=Ae();F(),O(0,"rect",15),ee("click",function(){he(e);const s=C().$implicit;return le(C().clickSquare(s.x,s.y))}),A()}if(2&n){const e=C().$implicit,r=C();Re("id","square_",e.x,"_",e.y,""),w("ngClass",r.getSquareClasses(e.x,e.y)),D("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function v5t(n,t){if(1&n){const e=Ae();F(),O(0,"g"),x(1,_5t,1,7,"rect",13),O(2,"rect",14),ee("click",function(){const i=he(e).$implicit;return le(C().clickSquare(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),w("ngIf",!1===e.isInRange(5,5)),T(1),D("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function C5t(n,t){if(1&n){const e=Ae();F(),O(0,"rect",16),ee("click",function(){he(e);const s=C();return le(s.clickSquare(s.selectedLanding.get().x,s.selectedLanding.get().y))}),A()}if(2&n){const e=C();D("x",e.SPACE_SIZE*(e.selectedLanding.get().x+1))("y",e.SPACE_SIZE*(e.selectedLanding.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function y5t(n,t){if(1&n){const e=Ae();F(),O(0,"rect",16),ee("click",function(){he(e);const s=C();return le(s.clickSquare(s.selectedPiece.get().x,s.selectedPiece.get().y))}),A()}if(2&n){const e=C();D("x",e.SPACE_SIZE*(e.selectedPiece.get().x+1))("y",e.SPACE_SIZE*(e.selectedPiece.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function E5t(n,t){if(1&n&&(F(),X(0,"use",19)),2&n){const e=t.$implicit,r=C().$implicit,s=C();Re("id","remainingPieces_",r.value,"_",e,""),w("ngClass",s.getRemainingPieceClasses(r,e)),D("transform",s.getRemainingPieceTransform(e,r))}}function M5t(n,t){if(1&n){const e=Ae();F(),O(0,"g",17),ee("click",function(){const i=he(e).$implicit;return le(C().selectPieceForInsertion(i))}),x(1,E5t,1,4,"use",18),A()}if(2&n){const e=t.$implicit,r=C();d1("id","remainingPieces_",e.value,""),T(1),w("ngForOf",r.ArrayUtils.range(r.playerPieces(e)))}}function S5t(n,t){if(1&n){const e=Ae();F(),O(0,"use",22),ee("click",function(){he(e);const s=C().$implicit;return le(C().clickSquare(s.source.get().coord.x,s.source.get().coord.y))}),A()}if(2&n){const e=C().$implicit,r=C();w("ngClass",r.getPieceClasses(e.source.get().coord.x,e.source.get().coord.y,e.source.get().piece)),D("transform",r.getPieceTransform(e.source.get().coord.x,e.source.get().coord.y))}}function P5t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"use",20),ee("click",function(){const i=he(e).$implicit;return le(C().clickArrow(i))}),A(),x(2,S5t,1,2,"use",21),A()}if(2&n){const e=t.$implicit,r=C();T(1),Q2("id","indicator_",e.target.x,"_",e.target.y,"_",e.direction.toString(),""),D("transform",r.getIndicatorTransform(e)),T(1),w("ngIf",e.source.isPresent())}}function T5t(n,t){if(1&n){const e=Ae();F(),O(0,"use",23),ee("click",function(){const i=he(e).$implicit;return le(C().selectOrientation(i))}),A()}if(2&n){const e=t.$implicit,r=C();d1("id","orientation_",e.landingOrientation,""),w("ngClass",r.getCurrentPlayerClass()),D("transform",r.getOrientationTransform(e.landingOrientation))}}let w5t=(()=>{class n extends Ho{constructor(e){super(e),this.lastMove=y.empty(),this.movedPieces=[],this.selectedPiece=y.empty(),this.selectedLanding=y.empty(),this.orientations=[],this.clickableCoords=new bt,this.indicatorArrows=[],this.insertingPiece=!1,this.rules=Cr.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new l5t(this.rules,"SiamMinimax")],this.encoder=Pa.encoder,this.tutorial=(new K3e).tutorial,this.updateBoard()}updateBoard(){J(n.VERBOSE,"updateBoard");const e=this.getState();this.board=e.board,this.movedPieces=[]}showLastMove(e){this.lastMove=y.of(e);const r=this.getPreviousState();this.movedPieces=this.rules.isLegal(this.lastMove.get(),r).get().moved}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=y.empty(),this.selectedLanding=y.empty(),this.orientations=[],this.clickableCoords=new bt,this.indicatorArrows=[]}selectPieceForInsertion(e){var r=this;return I(function*(){const s=r.canUserPlay("#remainingPieces_"+e.value);if(s.isFailure())return r.cancelMove(s.getReason());if(e!==r.getCurrentPlayer())return r.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE());if(r.insertingPiece)return r.cancelMoveAttempt(),z.SUCCESS;r.cancelMoveAttempt();for(const i of Cr.get().getInsertions(r.getState())){const o=i.coord.getNext(i.direction.get());if(r.board[o.y][o.x]!==_t.EMPTY){const c={source:y.empty(),target:o,direction:i.direction.get(),move:i};r.indicatorArrows.push(c)}r.clickableCoords.add(o)}return r.insertingPiece=!0,z.SUCCESS})()}selectOrientation(e){var r=this;return I(function*(){const s=r.canUserPlay("#orientation_"+e.landingOrientation.toString());return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e,r.getState())})()}clickSquare(e,r,s=!1){var i=this;return I(function*(){if(J(n.VERBOSE,"SiamComponent.clickSquare("+e+", "+r+")"),!1===s){const c=i.canUserPlay("#square_"+e+"_"+r);if(c.isFailure())return i.cancelMove(c.getReason())}const o=new S(e,r);if(i.insertingPiece)return i.insertPiece(o);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),z.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=y.of(o);const c=Cr.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),o);return 0===c.length?i.changeMoveDestinationClick(o):i.performMoveOrShowOrientationArrows(c)}{Le(i.getState().isOnBoard(o),"SiamComponent: user clicked outside of board when it should not be possible");const c=i.board[r][e];return c.getOwner()!==i.getCurrentPlayer()?i.cancelMove(tt.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(o,c)}})()}insertPiece(e){var r=this;return I(function*(){if(r.selectedLanding.isPresent())return r.cancelMove(Uh.MUST_SELECT_ORIENTATION()),z.SUCCESS;r.selectedLanding=y.of(e);const s=Cr.get().getInsertionsAt(r.getState(),e.x,e.y);return 0===s.length?r.changeMoveDestinationClick(e):r.performMoveOrShowOrientationArrows(s)})()}changeMoveDestinationClick(e){var r=this;return I(function*(){return r.cancelMoveAttempt(),r.getState().getPieceAt(e).getOwner()===r.getCurrentPlayer()?r.clickSquare(e.x,e.y,!0):r.cancelMove(Uh.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var r=this;return I(function*(){return Le(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(r.cancelMove(),r.chooseMove(e[0],r.getState())):(r.clickableCoords=new bt,r.indicatorArrows=[],r.orientations=e,z.SUCCESS)})()}selectPiece(e,r){this.cancelMoveAttempt();const s=this.getState();this.selectedPiece=y.of(e);const i=Cr.get().getMovesFrom(s,r,e.x,e.y);for(const o of i)if(o.direction.isPresent()){const c=o.coord.getNext(o.direction.get());if(this.clickableCoords.add(c),s.isOnBoard(c)&&s.getPieceAt(c)!==_t.EMPTY){const u={source:y.of({coord:e,piece:r}),target:c,direction:o.direction.get(),move:o};this.indicatorArrows.push(u)}}else this.clickableCoords.add(o.coord);return z.SUCCESS}clickArrow(e){var r=this;return I(function*(){const s=r.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e.move,r.getState())})()}isMountain(e){return e===_t.MOUNTAIN}getArrowTransform(e,r,s){const o=`rotate(${90*(s.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+r*this.SPACE_SIZE+")",o].join(" ")}getPieceTransform(e,r){return this.getArrowTransform(e+1,r+1,this.board[r][e].getDirection())}getIndicatorTransform(e){const r=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(r.x+1,r.y+1,e.direction)}getRemainingPieceTransform(e,r){const s=this.playerPieces(r);let u,h,c=2;return r===B.ONE?(c+=(s-e+(5-s)/2)/3,u=-1,h=$e.RIGHT):(c+=(e+1+(5-s)/2)/3,u=7,h=$e.LEFT),this.getArrowTransform(c,u,h)}getOrientationTransform(e){const r=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,r].join(" ")}getPieceClasses(e,r,s){const i=new S(e,r),o=[this.getPlayerClass(s.getOwner())];return this.selectedPiece.equalsValue(i)&&o.push("selected-stroke"),o}getSquareClasses(e,r){const s=new S(e,r);return this.movedPieces.some(i=>i.equals(s))?["moved-fill"]:[]}getRemainingPieceClasses(e,r){const s=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&r===this.playerPieces(e)-1&&s.push("selected-stroke"),s}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-siam"]],features:[l],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0)(1,"defs"),X(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),A(),x(5,m5t,2,1,"g",4),x(6,v5t,3,5,"g",4),x(7,C5t,1,4,"rect",5),x(8,y5t,1,4,"rect",5),x(9,M5t,2,2,"g",6),x(10,P5t,3,5,"g",4),x(11,T5t,1,3,"use",7),A()),2&e&&(T(5),w("ngForOf",r.board),T(1),w("ngForOf",r.clickableCoords),T(1),w("ngIf",r.selectedLanding.isPresent()),T(1),w("ngIf",r.selectedPiece.isPresent()),T(1),w("ngForOf",r.Player.PLAYERS),T(1),w("ngForOf",r.indicatorArrows),T(1),w("ngForOf",r.orientations))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Dr extends ji{constructor(t,e,r){if(super(),this.start=t,this.landing=e,this.keep=r,t.equalsValue(e))throw new Error("Deplacement cannot be static!");if(t.isPresent()&&t.equals(r))throw new Error("Cannot keep starting coord, since it will always be empty after move!")}static fromDrop(t){return new Dr(y.empty(),t,y.empty())}static fromMovement(t,e){return new Dr(y.of(t),e,y.empty())}static fromCut(t,e,r){return new Dr(y.of(t),e,y.of(r))}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(t){return!1!==this.landing.equals(t.landing)&&!1!==this.start.equals(t.start)&&this.keep.equals(t.keep)}}Dr.encoder=new class extends xt{encodeMove(n){return{start:n.start.isPresent()?S.encoder.encode(n.start.get()):null,landing:S.encoder.encode(n.landing),keep:n.keep.isPresent()?S.encoder.encode(n.keep.get()):null}}decodeMove(n){const t=n;if("object"!=typeof n)throw new Error("Invalid encodedMove of type "+typeof n+"!");const e=S.encoder.decode(t.landing);if(null==t.start)return Dr.fromDrop(e);const r=S.encoder.decode(t.start);if(null==t.keep)return Dr.fromMovement(r,e);{const s=S.encoder.decode(t.keep);return Dr.fromCut(r,e,s)}}};let q3=(()=>{class n{}return n.NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`,n.MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`,n.CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`,n.CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`,n.MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`,n.CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`,n.MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`,n})();class uo extends m3e{static getInitialState(){return uo.fromRepresentation([[B.ZERO],[B.ONE]],0)}static fromRepresentation(t,e,r=new $t(0,0)){const s=new Hm;for(let i=0;i<t.length;i++)for(let o=0;o<t[0].length;o++)if(t[i][o]!==pe.NONE){const c=new S(o,i).getNext(r);s.set(c,t[i][o])}return new uo(s,e)}movePiece(t){const e=this.pieces.getCopy();return e.delete(t.start.get()),e.set(t.landing,this.getCurrentPlayer()),new uo(e,this.turn)}toRepresentation(){const t=Qe.createTable(this.width,this.height,pe.NONE);for(const e of this.pieces.listKeys()){const r=this.getPieceAt(e);t[e.y][e.x]=r}return t}isIllegalLandingZone(t,e){return this.pieces.containsKey(t)?z.failure(tt.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(t,e)?z.SUCCESS:z.failure(q3.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(t,e){for(const r of yi.getNeighbors(t))if(this.pieces.containsKey(r)&&!1===e.equalsValue(r))return!0;return!1}getPieceAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():pe.NONE}applyLegalDrop(t){const e=this.pieces.getCopy();return e.put(t,this.getCurrentPlayer()),new uo(e,this.turn+1)}applyLegalDeplacement(t,e){const r=this.movePiece(t);if(e.size()>0){const s=new Hm;for(const i of e)s.set(i,r.getPieceAt(i));return new uo(s,this.turn+1)}return new uo(r.pieces,this.turn+1)}countPieces(){const t=this.pieces.reverse(),e=t.get(B.ZERO).getOrElse(new Nr),r=t.get(B.ONE).getOrElse(new Nr);return[e.size(),r.size()]}switchPiece(t){const e=this.pieces.getCopy(),r=this.getPieceAt(t);if(r.isPlayer())return e.replace(t,r.getOpponent()),new uo(e,this.turn);As.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:t.toString()})}equals(t){return this.turn===t.turn&&this.pieces.equals(t.pieces)}}class U2 extends L1{constructor(){super(uo),this.VERBOSE=!1}static get(){return U2.singleton.isAbsent()&&(U2.singleton=y.of(new U2)),U2.singleton.get()}applyLegalMove(t,e,r){return e.turn<40?e.applyLegalDrop(t.landing):e.applyLegalDeplacement(t,r)}isLegal(t,e){J(this.VERBOSE,{called:"SixRules.isLegal",move:t,state:e});const r=e.isIllegalLandingZone(t.landing,t.start);return r.isFailure()?r.toOtherFallible():e.turn<40?this.isLegalDrop(t,e):U2.isLegalPhaseTwoMove(t,e)}static getLegalLandings(t){const e=new Nr;for(const r of t.getPieceCoords())for(const s of ze.factory.all){const i=r.getNext(s,1);t.getPieceAt(i)===pe.NONE&&e.add(i)}return e.toList()}isLegalDrop(t,e){return!1===t.isDrop()?_e.failure(q3.NO_MOVEMENT_BEFORE_TURN_40()):_e.success(new bt(e.getPieceCoords()))}static isLegalPhaseTwoMove(t,e){if(t.isDrop())return _e.failure(q3.CAN_NO_LONGER_DROP());const r=e.getPieceAt(t.start.get());if(r===pe.NONE)return _e.failure(tt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(r===e.getCurrentOpponent())return _e.failure(tt.CANNOT_CHOOSE_OPPONENT_PIECE());const s=e.movePiece(t),i=s.getGroups();if(U2.isSplit(i)){const o=this.getLargestGroups(i);return 1===o.size()?t.keep.isPresent()?_e.failure(q3.CANNOT_CHOOSE_TO_KEEP()):_e.success(o.getAnyElement().get()):this.moveKeepBiggerGroup(t.keep,o,s)}return _e.success(new Nr)}static isSplit(t){return t.size()>1}static getLargestGroups(t){let e=0,r=new bt;for(const s of t){const i=s.size();i>e?(e=i,r=new bt([s])):i===e&&r.add(s)}return r}static moveKeepBiggerGroup(t,e,r){if(t.isAbsent())return _e.failure(q3.MUST_CUT());if(r.getPieces().get(t.get()).isAbsent())return _e.failure(q3.CANNOT_KEEP_EMPTY_COORD());const s=t.get();for(const i of e)if(i.contains(s))return _e.success(i);return _e.failure(q3.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=[];if(t.move.isPresent()&&(s=this.getShapeVictory(t.move.get(),e)),6===s.length)return xe.getVictory(r);if(e.turn>39){const i=e.countPieces(),o=i[0],c=i[1];return o<6&&c<6?o<c?xe.ONE_WON:c<o?xe.ZERO_WON:xe.DRAW:o<6?xe.getDefeat(B.ZERO):c<6?xe.getDefeat(B.ONE):xe.ONGOING}return xe.ONGOING}startSearchingVictorySources(){J(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(t,e){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const r=this.searchVictoryOnly(this.currentVictorySource,t,e);if(6===r.length)return r}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing;switch(J(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(ze.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];const h=(t+o.length)%6;o.push(c),c=c.getNext(ze.factory.all[h],1)}return o}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=ze.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return[];u=!0,i=i.getOpposite(),o=o.getNext(i,c.length)}o=o.getNext(i,1)}return c}searchVictoryOnlyForTriangleCorner(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=ze.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.length%2==0&&(i=ze.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return o}searchVictoryOnlyForTriangleEdge(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=ze.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.push(c),o.length%2==0&&(i=ze.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return o}}U2.singleton=y.empty();class b5t extends Dc{calculateBoardValue(t,e){this.startSearchingVictorySources();const r={status:Sn.DEFAULT,victory:y.empty(),preVictory:y.empty(),sum:0};for(;this.hasNextVictorySource();){const s=this.getNextVictorySource();let i;if(i=r.status===Sn.PRE_VICTORY?this.searchVictoryOnly(s,t,e):this.getBoardInfo(s,t,e,r),i.status===Sn.VICTORY)return i;r.status=i.status,r.sum=r.sum+i.sum,r.preVictory.isAbsent()&&(r.preVictory=i.preVictory)}return r}}class y6 extends M1{constructor(t,e){super(t),this.preVictory=e}}class y8 extends b5t{constructor(){super(...arguments),this.VERBOSE=!1}static get(){if(y8.singleton.isAbsent()){const t=U2.get();y8.singleton=y.of(new y8(t,"SixMinimax"))}return y8.singleton.get()}getListMoves(t){const e=y8.get(),r=t.getOwnValue(e);if(r.preVictory.isPresent())return t.gameState.turn<40?this.createForcedDrop(r):this.createForcedMovement(t,r);const s=U2.getLegalLandings(t.gameState);return t.gameState.turn<40?this.getListDrop(s):this.getMovement(t.gameState,s)}getMovement(t,e){const r=this.getSafelyMovablePieceOrFirstOne(t);return this.getMovementFrom(t,r,e)}createForcedDrop(t){J(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:t});const e=[],r=Dr.fromDrop(t.preVictory.get());return e.push(r),e}createForcedMovement(t,e){J(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:t});const r=this.getSafelyMovablePieceOrFirstOne(t.gameState),s=[e.preVictory.get()];return this.getMovementFrom(t.gameState,r,s)}getMovementFrom(t,e,r){const s=[];for(const i of e)for(const o of r){const c=Dr.fromMovement(i,o);if(t.isCoordConnected(o,y.of(i))){const h=t.movePiece(c).getGroups();if(U2.isSplit(h)){const g=U2.getLargestGroups(h);if(1===g.size())s.push(Dr.fromMovement(i,o));else for(const m of g){const E=m.getAnyElement().get(),b=Dr.fromCut(i,o,E);s.push(b)}}else s.push(c)}}return s}getSafelyMovablePieceOrFirstOne(t){const e=t.getPieces().reverse(),r=t.getCurrentPlayer(),s=e.get(r).get(),i=s.getAnyElement().get(),o=[];for(const c of s)!1===this.isPieceBlockingAVictory(t,c)&&o.push(c);return new Nr(0===o.length?[i]:o)}isPieceBlockingAVictory(t,e){const r=t.switchPiece(e),s=Dr.fromDrop(e);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,s,r).status===Sn.VICTORY)return!0;return!1}getListDrop(t){const e=[];for(const r of t){const s=Dr.fromDrop(r);e.push(s)}return e}getBoardValue(t){const e=t.move,r=t.gameState,s=r.getCurrentOpponent(),i=s.getVictoryValue();let o={status:Sn.DEFAULT,victory:y.empty(),preVictory:y.empty(),sum:0};if(e.isPresent()&&(o=this.calculateBoardValue(e.get(),r)),o.status===Sn.VICTORY)return new y6(i,y.empty());if(r.turn>39){const c=r.countPieces(),u=c[0],h=c[1];return u<6&&h<6?new y6(u<h?B.ONE.getVictoryValue():h<u?B.ZERO.getVictoryValue():0,y.empty()):u<6?new y6(B.ZERO.getDefeatValue(),y.empty()):h<6?new y6(B.ONE.getDefeatValue(),y.empty()):new y6(u-h,o.preVictory)}return new y6(o.status===Sn.PRE_VICTORY?s.getPreVictory():o.sum*s.getScoreModifier(),o.preVictory)}startSearchingVictorySources(){J(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing;switch(J(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(ze.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Sn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};const h=(t+o.length)%6;o.push(c),c=c.getNext(ze.factory.all[h],1)}return{status:Sn.VICTORY,victory:y.of(o),preVictory:y.empty(),sum:0}}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=ze.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return{status:Sn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};u=!0,i=i.getOpposite(),o=o.getNext(i,c.length-1)}o=o.getNext(i,1)}return{status:Sn.VICTORY,victory:y.of(c),preVictory:y.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=ze.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Sn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};o.length%2==0&&(i=ze.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return{status:Sn.VICTORY,victory:y.of(o),preVictory:y.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(t,e,r){J(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=ze.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Sn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};o.push(c),o.length%2==0&&(i=ze.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return{status:Sn.VICTORY,victory:y.of(o),preVictory:y.empty(),sum:0}}getBoardInfo(t,e,r,s){J(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:t,move:e,state:r,boardInfo:s});const i=e.landing;switch(t.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(t.index,i,r,s);case"LINE":return this.getBoardInfoForLine(t.index,i,r,s);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(t.index,i,r,s);default:return this.getBoardInfoForTriangleEdge(t.index,i,r,s)}}getBoardInfoForCircle(t,e,r,s){J(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer(),c=[e];let u=e.getNext(ze.factory.all[t],1),h=0,g=y.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;const E=(t+c.length)%6;c.push(u);const b=ze.factory.all[E];m===pe.NONE?(h+=.16,g=y.of(u)):h++,u=u.getNext(b,1)}return this.getBoardInfoResult(h,g,c,s)}getBoardInfoResult(t,e,r,s){let i=s.preVictory;if(4.16===t){if(J(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(e))return{status:Sn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};i=e}else if(5===t)return{status:Sn.VICTORY,victory:y.of(r),preVictory:y.empty(),sum:0};return{status:s.status,victory:y.empty(),preVictory:i,sum:s.sum+t}}getBoardInfoForLine(t,e,r,s){J(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:t,lastDrop:e,state:r,boardInfo:s});const i=ze.factory.all[t];let o=e.getPrevious(i,5),c=[],u=[],h=y.empty();for(let U=0;U<6;U++){const j=this.updateEncounterAndReturnLastEmpty(r,o,u);j.isPresent()&&(h=j),c.push(o),o=o.getNext(i,1)}let g=s.status,m=s.preVictory,E=0,b=0;for(;E<6;){const U=u.reduce((oe,ye)=>oe+ye);if(6===U)return{status:Sn.VICTORY,victory:y.of(c),preVictory:y.empty(),sum:0};5.16===U&&g===Sn.DEFAULT&&(m.isPresent()?(Le(!1===m.equals(h),"Impossible to have point aligned with differents line to a same point"),g=Sn.PRE_VICTORY):m=h),b=Math.max(b,U),c=c.slice(1,6),c.push(o),u=u.slice(1,6);const j=this.updateEncounterAndReturnLastEmpty(r,o,u);j.isPresent()&&(h=j),E++,o=o.getNext(i,1)}const k={status:g,victory:y.of(c),preVictory:m,sum:b};return this.getBoardInfoResult(b,h,c,k)}updateEncounterAndReturnLastEmpty(t,e,r){const s=t.getCurrentPlayer();switch(t.getPieceAt(e)){case s:return r.push(-7),y.empty();case pe.NONE:return r.push(.16),y.of(e);default:return r.push(1),y.empty()}}getBoardInfoForTriangleCorner(t,e,r,s){J(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=ze.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,g=y.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===pe.NONE?(h+=.16,g=y.of(u)):h++,c.length%2==0&&(o=ze.factory.all[(t+c.length)%6]),c.push(u),u=u.getNext(o,1)}return this.getBoardInfoResult(h,g,c,s)}getBoardInfoForTriangleEdge(t,e,r,s){J(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=ze.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,g=y.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===pe.NONE?(h+=.16,g=y.of(u)):h++,c.push(u),c.length%2==0&&(o=ze.factory.all[(t+c.length)%6]),u=u.getNext(o,1)}return this.getBoardInfoResult(h,g,c,s)}}y8.singleton=y.empty();const Pe=pe.NONE,Gt=B.ZERO,Jt=B.ONE;let QH=(()=>{class n{}return n.MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`,n.MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`,n})();class X3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,uo.getInitialState()),ie.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,uo.fromRepresentation([[Gt,Jt,Jt,Jt,Jt,Gt],[Pe,Gt,Jt,Pe,Gt,Pe],[Jt,Jt,Gt,Pe,Pe,Pe],[Pe,Pe,Gt,Pe,Pe,Pe],[Pe,Gt,Pe,Pe,Pe,Pe],[Gt,Pe,Pe,Pe,Pe,Pe]],0),[Dr.fromDrop(new S(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,uo.fromRepresentation([[Pe,Pe,Pe,Jt,Pe,Pe],[Pe,Pe,Jt,Jt,Gt,Gt],[Pe,Jt,Pe,Gt,Jt,Pe],[Jt,Gt,Gt,Gt,Gt,Jt]],0),[Dr.fromDrop(new S(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),ie.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,uo.fromRepresentation([[Pe,Pe,Pe,Jt,Pe,Pe],[Pe,Gt,Jt,Gt,Gt,Gt],[Pe,Gt,Pe,Gt,Gt,Pe],[Jt,Jt,Jt,Pe,Jt,Pe]],0),[Dr.fromDrop(new S(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),ie.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,uo.fromRepresentation([[Pe,Pe,Pe,Pe,Pe,Pe,Pe,Jt,Pe],[Pe,Pe,Pe,Pe,Pe,Pe,Gt,Pe,Pe],[Pe,Pe,Pe,Pe,Gt,Gt,Gt,Pe,Pe],[Pe,Pe,Pe,Pe,Jt,Jt,Pe,Jt,Gt],[Pe,Gt,Jt,Jt,Gt,Gt,Jt,Pe,Pe],[Gt,Gt,Gt,Gt,Jt,Jt,Jt,Gt,Pe],[Jt,Jt,Gt,Pe,Jt,Jt,Gt,Pe,Pe],[Pe,Gt,Pe,Gt,Gt,Pe,Pe,Pe,Pe],[Jt,Jt,Jt,Jt,Pe,Pe,Pe,Pe,Pe],[Pe,Gt,Pe,Jt,Pe,Pe,Pe,Pe,Pe]],40),Dr.fromMovement(new S(6,1),new S(5,1)),(t,e,r)=>{const s=r.countPieces();return 19===s[0]?18===s[1]?z.SUCCESS:z.failure(QH.MOVEMENT_NOT_DISCONNECTING()):z.failure(QH.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),ie.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,uo.fromRepresentation([[Pe,Pe,Pe,Pe,Pe,Jt],[Pe,Pe,Pe,Pe,Gt,Jt],[Pe,Pe,Pe,Jt,Gt,Gt],[Pe,Pe,Gt,Pe,Jt,Gt],[Jt,Jt,Pe,Pe,Pe,Gt],[Gt,Jt,Pe,Pe,Pe,Pe],[Gt,Pe,Pe,Pe,Pe,Pe]],40),Dr.fromMovement(new S(2,3),new S(3,3)),(t,e,r)=>t.start.equalsValue(new S(2,3))?z.SUCCESS:z.failure(QH.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),ie.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,uo.fromRepresentation([[Pe,Pe,Pe,Pe,Pe,Jt],[Pe,Pe,Pe,Pe,Gt,Jt],[Pe,Pe,Pe,Jt,Gt,Gt],[Gt,Pe,Gt,Pe,Pe,Jt],[Jt,Jt,Pe,Pe,Pe,Pe],[Gt,Gt,Pe,Pe,Pe,Pe],[Gt,Pe,Pe,Pe,Pe,Pe]],40),Dr.fromCut(new S(2,3),new S(2,5),new S(2,5)),(t,e,r)=>t.keep.isAbsent()?z.failure($localize`This move has not cut the board in two equal halves.`):r.getPieceAt(t.landing)===pe.NONE?z.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):z.SUCCESS,$localize`Congratulations, you won!`)]}}function O5t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",10),ee("click",function(){const i=he(e).$implicit;return le(C().onPieceClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();Re("id","piece_",e.x,"_",e.y,""),w("ngClass",r.getPieceClass(e)),D("points",r.getHexaPointsAt(e))}}function A5t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",11),ee("click",function(){const i=he(e).$implicit;return le(C().onNeighborClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();Re("id","neighbor_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function N5t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",10),ee("click",function(){he(e);const s=C();return le(s.onPieceClick(s.chosenLanding.get()))}),A()}if(2&n){const e=C();Re("id","chosenLanding_",e.chosenLanding.get().x,"_",e.chosenLanding.get().y,""),w("ngClass",e.getPlayerClass(e.state.getCurrentPlayer())),D("points",e.getHexaPointsAt(e.chosenLanding.get()))}}function I5t(n,t){if(1&n&&(F(),X(0,"polygon",12)),2&n){const e=t.$implicit,r=C();Re("id","disconnected_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function x5t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",13),ee("click",function(){he(e);const s=C();return le(s.onNeighborClick(s.leftCoord.get()))}),A()}if(2&n){const e=C();Re("id","leftCoord_",e.leftCoord.get().x,"_",e.leftCoord.get().y,""),D("points",e.getHexaPointsAt(e.leftCoord.get()))}}function k5t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",14),ee("click",function(){he(e);const s=C();return le(s.onPieceClick(s.lastDrop.get()))}),A()}if(2&n){const e=C();Re("id","lastDrop_",e.lastDrop.get().x,"_",e.lastDrop.get().y,""),D("points",e.getHexaPointsAt(e.lastDrop.get()))}}function L5t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",15),ee("click",function(){he(e);const s=C();return le(s.onPieceClick(s.selectedPiece.get()))}),A()}if(2&n){const e=C();Re("id","selectedPiece_",e.selectedPiece.get().x,"_",e.selectedPiece.get().y,""),w("ngClass",e.getSelectedPieceClass()),D("points",e.getHexaPointsAt(e.selectedPiece.get()))}}function R5t(n,t){if(1&n&&(F(),X(0,"polygon",16)),2&n){const e=t.$implicit,r=C();Re("id","victoryCoord_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function D5t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",19),ee("click",function(){const i=he(e).$implicit;return le(C(2).onPieceClick(i))}),A()}if(2&n){const e=t.$implicit,r=C(2);Re("id","cuttable_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function z5t(n,t){if(1&n&&(F(),O(0,"g",17),x(1,D5t,1,3,"polygon",18),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let V5t=(()=>{class n extends Ah{constructor(e){super(e),this.disconnecteds=[],this.cuttableGroups=[],this.leftCoord=y.empty(),this.lastDrop=y.empty(),this.selectedPiece=y.empty(),this.chosenLanding=y.empty(),this.nextClickShouldSelectGroup=!1,this.rules=U2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new y8(this.rules,"SixMinimax")],this.encoder=Dr.encoder,this.tutorial=(new X3e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new Nh(1.5*this.SPACE_SIZE,new S(2*this.SPACE_SIZE,0),Is.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=y.empty(),this.chosenLanding=y.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.node.gameState,this.node.move.isAbsent()&&this.hideLastMove(),this.pieces=this.state.getPieceCoords(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}hideLastMove(){this.leftCoord=y.empty(),this.lastDrop=y.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const e=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return p6.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH).toSVGString()}showLastMove(e){this.lastDrop=y.of(e.landing),this.leftCoord=!1===e.isDrop()?y.of(e.start.get()):y.empty();const r=this.getState();this.rules.getGameStatus(this.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,r)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const e=this.getPreviousState().getPieceCoords(),r=this.getState().getPieceCoords(),s=[];for(const o of e)!1===this.node.move.get().start.equalsValue(o)&&!1===r.some(u=>u.equals(o))&&s.push(o);const i=this.lastDrop.get();return!1===this.pieces.some(o=>o.equals(i))&&!1===r.some(o=>o.equals(i))&&s.push(i),s}getEmptyNeighbors(){let e=U2.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const r=this.chosenLanding.get();e=e.filter(s=>!1===s.equals(r))}return e}getPieceClass(e){const r=this.getState().getPieceAt(e);return this.getPlayerClass(r)}onPieceClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#piece_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.state.turn<40)return r.cancelMove(q3.NO_MOVEMENT_BEFORE_TURN_40());if(r.chosenLanding.isAbsent())return r.state.getPieceAt(e)===r.state.getCurrentOpponent()?r.cancelMove(tt.CANNOT_CHOOSE_OPPONENT_PIECE()):(r.selectedPiece=r.selectedPiece.equalsValue(e)?y.empty():y.of(e),z.SUCCESS);{const i=Dr.fromCut(r.selectedPiece.get(),r.chosenLanding.get(),e);return r.chooseMove(i,r.state)}})()}onNeighborClick(e){var r=this;return I(function*(){const s=r.canUserPlay("#neighbor_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.nextClickShouldSelectGroup)return r.cancelMove(q3.MUST_CUT());if(r.state.turn<40)return r.chooseMove(Dr.fromDrop(e),r.state);if(r.selectedPiece.isAbsent())return r.cancelMove(q3.CAN_NO_LONGER_DROP());{const i=Dr.fromMovement(r.selectedPiece.get(),e),o=U2.isLegalPhaseTwoMove(i,r.state);return r.neededCutting(o)?(r.chosenLanding=y.of(e),r.moveVirtuallyPiece(),r.showCuttable(),r.nextClickShouldSelectGroup=!0,z.SUCCESS):r.chooseMove(i,r.state)}})()}neededCutting(e){return e.isFailure()&&e.getReason()===q3.MUST_CUT()}moveVirtuallyPiece(){const e=this.selectedPiece.get();this.pieces=this.pieces.filter(r=>!1===r.equals(e)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const e=Dr.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),s=this.state.movePiece(e).getGroups(),i=U2.getLargestGroups(s);this.cuttableGroups=[];for(const o of i)this.cuttableGroups.push(o.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-six"]],features:[l],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,O5t,1,4,"polygon",1),x(2,A5t,1,3,"polygon",2),x(3,N5t,1,4,"polygon",3),x(4,I5t,1,3,"polygon",4),x(5,x5t,1,3,"polygon",5),x(6,k5t,1,3,"polygon",6),x(7,L5t,1,4,"polygon",7),x(8,R5t,1,3,"polygon",8),x(9,z5t,2,1,"g",9),A()),2&e&&(D("viewBox",r.viewBox),T(1),w("ngForOf",r.pieces),T(1),w("ngForOf",r.neighbors),T(1),w("ngIf",r.chosenLanding.isPresent()),T(1),w("ngForOf",r.disconnecteds),T(1),w("ngIf",r.leftCoord.isPresent()),T(1),w("ngIf",r.lastDrop.isPresent()),T(1),w("ngIf",r.selectedPiece.isPresent()),T(1),w("ngForOf",r.victoryCoords),T(1),w("ngForOf",r.cuttableGroups))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ta extends AH{static of(t,e){return new Ta(t,e)}static from(t,e){try{const r=new Ta(t,e);return _e.success(r)}catch(r){return _e.failure(r.message)}}getMaximalDistance(){return 9}}Ta.encoder=io.getFallibleEncoder(Ta.from);const H5t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:B.ZERO};class Q4 extends NH{static getInitialState(){const t=Pn.UNOCCUPIED,e=Pn.INVADERS,r=Pn.DEFENDERS;return new Q4([[t,t,t,e,e,e,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,t,r,t,t,t,t],[e,t,t,t,r,t,t,t,e],[e,e,r,r,Pn.PLAYER_ONE_KING,r,r,e,e],[e,t,t,t,r,t,t,t,e],[t,t,t,t,r,t,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,e,e,e,t,t,t]],0)}from(t,e){return new Q4(t,e)}}class E8 extends IH{constructor(){super(Q4,H5t,Ta.of)}static get(){return E8.singleton.isAbsent()&&(E8.singleton=y.of(new E8)),E8.singleton.get()}}E8.singleton=y.empty();const Z=Pn.UNOCCUPIED,r1=Pn.INVADERS,fo=Pn.DEFENDERS,JP=Pn.PLAYER_ONE_KING;class Q3e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Q4.getInitialState()),ie.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Q4.getInitialState(),Ta.of(new S(4,1),new S(1,1)),$localize`Congratulations!`),ie.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Q4([[Z,Z,Z,r1,r1,r1,Z,Z,Z],[Z,Z,Z,Z,r1,Z,Z,Z,Z],[Z,Z,Z,Z,fo,Z,Z,Z,Z],[Z,Z,Z,r1,fo,Z,Z,Z,r1],[r1,r1,fo,fo,JP,fo,fo,r1,r1],[Z,Z,Z,Z,fo,Z,Z,Z,r1],[Z,Z,Z,Z,fo,Z,Z,Z,Z],[Z,Z,Z,Z,r1,Z,Z,Z,Z],[Z,Z,Z,r1,r1,r1,Z,Z,Z]],1),[Ta.of(new S(2,4),new S(2,3)),Ta.of(new S(4,2),new S(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),ie.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Q4([[Z,Z,Z,r1,r1,r1,Z,Z,Z],[Z,Z,Z,Z,r1,Z,Z,Z,Z],[Z,Z,Z,Z,fo,Z,Z,Z,Z],[Z,Z,fo,Z,JP,Z,fo,Z,r1],[r1,r1,Z,fo,Z,fo,fo,r1,r1],[Z,Z,Z,Z,fo,Z,Z,Z,r1],[Z,Z,Z,Z,fo,Z,Z,Z,Z],[Z,Z,Z,Z,r1,Z,Z,Z,Z],[Z,Z,Z,r1,r1,r1,Z,Z,Z]],12),[Ta.of(new S(1,4),new S(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ie.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new Q4([[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,r1,Z,Z,Z,Z,Z,Z,Z],[r1,JP,Z,r1,Z,Z,Z,Z,Z],[Z,r1,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z]],72),[Ta.of(new S(3,4),new S(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ie.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new Q4([[Z,Z,r1,JP,r1,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,r1,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z]],72),[Ta.of(new S(3,3),new S(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function F5t(n,t){1&n&&(F(),X(0,"polygon",8))}function B5t(n,t){1&n&&(F(),X(0,"rect",9))}function $5t(n,t){if(1&n&&(F(),O(0,"g"),x(1,F5t,1,0,"polygon",6),x(2,B5t,1,0,"ng-template",null,7,Gn),A()),2&n){const e=Fn(3),r=C().index,s=C().index,i=C();T(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function U5t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const e=C(2).index,r=C().index,s=C();T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function G5t(n,t){if(1&n&&(F(),X(0,"polyline",16)),2&n){const e=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][e])}}function q5t(n,t){if(1&n&&(F(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function W5t(n,t){if(1&n&&(F(),x(0,G5t,1,1,"polyline",14),x(1,q5t,4,20,"ng-template",null,15,Gn)),2&n){const e=Fn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",e)}}function j5t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",10),x(2,U5t,6,25,"g",11),x(3,W5t,3,2,"ng-template",null,12,Gn),A()),2&n){const e=Fn(4),r=C().index,s=C().index,i=C();T(1),Re("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),T(1),w("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function Z5t(n,t){if(1&n){const e=Ae();F(),O(0,"g",3),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),X(1,"rect",4),x(2,$5t,4,2,"g",5),x(3,j5t,5,8,"g",5),A()}if(2&n){const e=t.index,r=C().index,s=C();Re("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),T(1),Re("id","space_",e,"_",r,""),w("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),T(1),w("ngIf",s.board[r][e]!==s.EMPTY)}}function Y5t(n,t){if(1&n&&(F(),O(0,"g"),x(1,Z5t,4,10,"g",2),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function K5t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"rect",17),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i.x,i.y))}),A()()}if(2&n){const e=t.$implicit,r=C();T(1),Re("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let X5t=(()=>{class n extends xH{constructor(e){super(e,!1,Ta.from),this.rules=E8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new CP(this.rules,"DummyBot"),new EP(this.rules,"Piece > Influence"),new MP(this.rules,"Piece > Control"),new kH(this.rules,"Escape > Piece > Control")],this.encoder=Ta.encoder,this.tutorial=(new Q3e).tutorial,this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-tablut"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(F(),O(0,"svg",0),x(1,Y5t,2,1,"g",1),x(2,K5t,2,6,"g",1),A()),2&e&&(D("viewBox",r.getViewBox()),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getClickables()))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class G2{constructor(t,e){this.owner=t,this.tileId=e}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class zs{constructor(t){this.pieces=t}static from(t){let e=-1;for(const r of t)Le(e<r.tileId,"TrexoPieceStack: dropped turn should be ascending"),e=r.tileId;return new zs(t)}getHeight(){return this.pieces.length}getOwner(){const t=this.pieces.length;return 0===t?pe.NONE:this.pieces[t-1].owner}getUpperTileId(){const t=this.pieces.length;return 0===t?-1:this.pieces[t-1].tileId}add(t){return zs.from(this.pieces.concat(t))}getPieceAt(t){return Le(t<this.pieces.length,"no element "+t+"in piece!"),this.pieces[t]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(t=>"("+t.toString()+")").join(" ")+"]"}}zs.EMPTY=zs.from([]);let ss=(()=>{class n extends Ur{static getInitialState(){const e=Qe.createTable(n.SIZE,n.SIZE,zs.EMPTY);return new n(e,0)}static from(e,r){Le(e.length===n.SIZE,"Invalid board dimensions");for(const s of e)Le(s.length===n.SIZE,"Invalid board dimensions");return _e.success(new n(e,r))}drop(e,r){const s=this.getCopiedBoard(),i=new G2(r,this.turn);return s[e.y][e.x]=s[e.y][e.x].add(i),new n(s,this.turn)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(e=>"["+e.map(r=>"TrexoPieceStack.from("+r.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(e,r,s){return this.getPieceAtXY(e,r).getPieceAt(s)}}return n.SIZE=10,n})(),eT=(()=>{class n{}return n.NON_NEIGHBORING_SPACES=()=>$localize`Those two spaces are not neighbors!`,n.NO_WAY_TO_DROP_IT_HERE=()=>$localize`There is no way to put a piece there!`,n.CANNOT_DROP_ON_ONLY_ONE_PIECE=()=>$localize`You cannot drop on only one piece!`,n.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS=()=>$localize`You cannot drop a piece on uneven grounds!`,n})();class wa extends io{constructor(t,e){super(t,e)}static from(t,e){return Le(t.isInRange(ss.SIZE,ss.SIZE),`${t.toString()} is out of the TrexoBoard!`),Le(e.isInRange(ss.SIZE,ss.SIZE),`${e.toString()} is out of the TrexoBoard!`),1===t.getOrthogonalDistance(e)?_e.success(new wa(t,e)):_e.failure(eT.NON_NEIGHBORING_SPACES())}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(t){return this.getFirst().equals(t.getFirst())&&this.getSecond().equals(t.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}wa.encoder=io.getFallibleEncoder(wa.from);class t2 extends L1{constructor(){super(ss)}static get(){return t2.instance.isAbsent()&&(t2.instance=y.of(new t2)),t2.instance.get()}static getOwner(t){return t.getOwner()}static isInRange(t){return t.isInRange(ss.SIZE,ss.SIZE)}applyLegalMove(t,e,r){return e.drop(t.getZero(),B.ZERO).drop(t.getOne(),B.ONE).incrementTurn()}isLegal(t,e){return this.isUnevenGround(t,e)?z.failure(eT.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(t,e)?z.failure(eT.CANNOT_DROP_ON_ONLY_ONE_PIECE()):z.SUCCESS}isUnevenGround(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return r.getHeight()!==s.getHeight()}landsOnOnlyOnePiece(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return(-1!==r.getUpperTileId()||-1!==s.getUpperTileId())&&r.getUpperTileId()===s.getUpperTileId()}static getSquareScore(t,e){return t2.TREXO_HELPER.getSquareScore(t,e)}static getVictoriousCoords(t){const e=[],r=[],s=t.getCurrentOpponent();for(const i of t.toMap()){const o=i.key,c=t.getPieceAt(o).getOwner();if(c.isPlayer()){const u=t2.getSquareScore(t,o);gr.getScoreStatus(u)===Sn.VICTORY&&(c===s?e.push(o):r.push(o))}}return r.length>0?r:e}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=!1;for(const i of e.toMap()){const o=i.key,c=e.getPieceAt(o).getOwner();if(c.isPlayer()){const u=t2.getSquareScore(e,o);if(gr.getScoreStatus(u)===Sn.VICTORY){if(c!==r)return xe.getDefeat(r);s=!0}}}return s?xe.getVictory(r):xe.ONGOING}getLegalMoves(t){const e=[];for(const r of t.toMap()){const s=r.key;if(s.x+1<ss.SIZE){const i=new S(s.x+1,s.y);e.push(...this.getPossiblesMoves(t,s,i))}if(s.y+1<ss.SIZE){const i=new S(s.x,s.y+1);e.push(...this.getPossiblesMoves(t,s,i))}}return e}getPossiblesMoves(t,e,r){const s=t.getPieceAt(e),i=t.getPieceAt(r);let o;o=!s.isGround()&&s.getUpperTileId()===i.getUpperTileId();const c=s.getHeight()!==i.getHeight();return o||c?[]:[wa.from(e,r).get(),wa.from(r,e).get()]}}t2.instance=y.empty(),t2.TREXO_HELPER=new $m(t2.isInRange,t2.getOwner,5);class Q5t extends Dc{getListMoves(t){return t2.get().getLegalMoves(t.gameState)}getBoardValue(t){let e=0;const r=t.gameState,s=r.getCurrentOpponent();let i=!1;for(const o of r.toMap()){const c=r.getPieceAt(o.key).getOwner();if(c.isPlayer()){const u=t2.getSquareScore(r,o.key);if(gr.getScoreStatus(u)===Sn.VICTORY){if(c!==s)return new M1(s.getDefeatValue());i=!0}else e+=u}}return new M1(i?s.getVictoryValue():e)}}const ue=zs.EMPTY,J3e=zs.from([new G2(B.ONE,0)]),J5t=zs.from([new G2(B.ZERO,0)]),e7t=zs.from([new G2(B.ONE,1)]),e4e=zs.from([new G2(B.ZERO,1)]),t7t=zs.from([new G2(B.ZERO,2)]),n7t=zs.from([new G2(B.ONE,2)]),r7t=zs.from([new G2(B.ZERO,0),new G2(B.ZERO,3)]),s7t=zs.from([new G2(B.ONE,1),new G2(B.ONE,3)]),i7t=zs.from([new G2(B.ZERO,4)]),o7t=zs.from([new G2(B.ONE,4)]),a7t=zs.from([new G2(B.ZERO,5)]),c7t=zs.from([new G2(B.ONE,5)]),l7t=zs.from([new G2(B.ONE,6)]),u7t=zs.from([new G2(B.ZERO,6)]);class t4e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,ss.getInitialState()),ie.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,ss.getInitialState(),wa.from(new S(4,4),new S(3,4)).get(),$localize`Congratulations!`),ie.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new ss([[ue,ue,ue,J3e,J5t,e4e,e7t,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue]],7),[wa.from(new S(4,0),new S(5,0)).get(),wa.from(new S(5,0),new S(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),ie.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new ss([[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,a7t,ue,ue,ue,ue,ue,ue],[ue,ue,ue,c7t,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,J3e,ue,ue,i7t,o7t,ue],[ue,ue,ue,ue,r7t,s7t,e4e,ue,ue,ue],[ue,ue,ue,ue,ue,t7t,l7t,u7t,ue,ue],[ue,ue,ue,ue,ue,n7t,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue]],7),wa.from(new S(2,0),new S(2,1)).get(),(t,e,r)=>t2.TREXO_HELPER.getSquareScore(r,t.getOne())===Number.MAX_SAFE_INTEGER?z.SUCCESS:z.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)]}}function f7t(n,t){if(1&n){const e=Ae();F(),O(0,"g")(1,"polygon",5),ee("click",function(){const i=he(e).index,o=C().index;return le(C().onClick(i,o))}),A()()}if(2&n){const e=t.index,r=C().index,s=C();T(1),Re("id","space_",e,"_",r,""),w("ngClass",s.getSpaceClasses(e,r)),D("points",s.getParallelogramPoints())("transform",s.getTranslate(e,r,0))}}function h7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,f7t,2,5,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function d7t(n,t){if(1&n){const e=Ae();F(),O(0,"g",8),ee("click",function(){he(e);const s=C().index,i=C().index;return le(C(2).onClick(s,i))}),A()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index,o=C().index,c=C();Q2("id","half_tile_",r,"_",i,"_",o,""),w("mode",c.mode)("coord",c.Coord3D.of(r,i,o))("mustDisplayHeight","2D"===c.chosenMode)("move",s.move.get())("pieceClasses",c.getPieceClasses(r,i,o)),D("transform",c.getTranslate(r,i,o+1))}}const n4e=function(n){return[n]};function p7t(n,t){if(1&n){const e=Ae();F(),O(0,"g",9),ee("click",function(){he(e);const s=C().index,i=C().index;return le(C(2).onClick(s,i))}),A()}if(2&n){const e=C().index,r=C().index,s=C().index,i=C();Q2("id","dropped_piece_",e,"_",r,"_",s,""),w("mode",i.mode)("coord",i.Coord3D.of(e,r,s))("pieceClasses",w3(7,n4e,i.currentOpponentClass)),D("transform",i.getTranslate(e,r,s+1))}}function g7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,d7t,1,9,"g",6),x(2,p7t,1,9,"g",7),A()),2&n){const e=t.$implicit;T(1),w("ngIf",e.move.isPresent()),T(1),w("ngIf",e.isDroppedPiece)}}function m7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,g7t,3,2,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function _7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,m7t,2,1,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}const v7t=function(){return["player0-fill"]};function C7t(n,t){if(1&n){const e=Ae();F(),O(0,"g",10),ee("click",function(){return he(e),le(C().switchToMode("3D"))}),A()}if(2&n){const e=C();w("mode",e.TrexoComponent.modeMap["3D"])("coord",e.Coord3D.of(10.5,8.5,0))("pieceClasses",J1(4,v7t)),D("transform",e.get3DSwitcherTransform())}}function y7t(n,t){if(1&n){const e=Ae();F(),O(0,"g",11),ee("click",function(){return he(e),le(C().switchToMode("2D"))}),A()}if(2&n){const e=C();w("mode",e.TrexoComponent.modeMap["2D"])("coord",e.Coord3D.of(12,9,0))("pieceClasses",w3(4,n4e,e.currentPlayerClass)),D("transform",e.getTranslate(12,9,0))}}class l1 extends E3e{constructor(t){super(t),this.TrexoComponent=l1,this.left=-this.STROKE_WIDTH/2,this.Coord3D=r_,this.up=0,this.chosenMode="3D",this.victoryCoords=[],this.droppedPiece=y.empty(),this.possibleNextClicks=[],this.possibleMoves=[],this.pieceOnBoard=[],this.currentOpponentClass="player1",this.currentPlayerClass="player0",this.rules=t2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Q5t(this.rules,"TrexoMinimax")],this.encoder=wa.encoder,this.tutorial=(new t4e).tutorial,l1.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D"),this.updateBoard()}switchToMode(t){this.chosenMode=t,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=l1.modeMap[t]}getViewBoxWidth(){const t=l1.modeMap["3D"],e=ss.SIZE;return"2D"===this.chosenMode?(e+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:e*(this.SPACE_SIZE*(t.horizontalWidthRatio+t.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const e=ss.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?e:this.STROKE_WIDTH+e+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const t=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+t)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*l1.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(){const t=this.getState();this.board=t.getCopiedBoard(),this.currentOpponentClass=this.getPlayerClass(t.getCurrentOpponent()),this.currentPlayerClass=this.getPlayerClass(t.getCurrentPlayer()),this.possibleMoves=this.rules.getLegalMoves(t),this.victoryCoords=t2.getVictoriousCoords(t),this.pieceOnBoard=this.get3DBoard(),this.height=this.getViewBoxHeight(),this.up=this.getViewBoxUp()}get3DBoard(){const t=Qe.create3DTable(1,ss.SIZE,ss.SIZE,l1.INITIAL_PIECE_ON_BOARD);let e=1;for(let r=0;r<=e;r++)for(const s of this.getState().toMap()){const i=s.key,o=s.value.getHeight();if(e=Math.max(e,o),r<o){const c=this.extractMoveFromState(i.x,i.y,r);this.addMoveToArray(r,c,t)}}return t}extractMoveFromState(t,e,r){const s=this.getState().getPieceAtXYZ(t,e,r),i=new S(t,e);let o=new S(-2,-2);for(const c of Oe.ORTHOGONALS){const u=i.getNext(c);if(u.isInRange(ss.SIZE,ss.SIZE)){const h=this.getState().getPieceAt(u);h.getHeight()>r&&h.getPieceAt(r).tileId===s.tileId&&(o=u)}}return s.owner===B.ZERO?wa.from(i,o).get():wa.from(o,i).get()}addMoveToArray(t,e,r){for(;r.length<=t;)r.push(Qe.createTable(ss.SIZE,ss.SIZE,l1.INITIAL_PIECE_ON_BOARD));r[t][e.getZero().y][e.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:y.of(e)},r[t][e.getOne().y][e.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:y.of(e)}}onClick(t,e){var r=this;return I(function*(){const s=r.canUserPlay("#space_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(t,e);if(r.droppedPiece.isPresent()){const o=r.droppedPiece.get();if(r.droppedPiece.equalsValue(i))return r.cancelMoveAttempt(),z.SUCCESS;if(r.possibleNextClicks.some(c=>c.equals(i))){const c=r.getState().getCurrentPlayer()===B.ZERO,g=wa.from(c?i:o,c?o:i).get();return r.chooseMove(g,r.getState())}r.deselectPiece()}return r.selectPiece(i)})()}deselectPiece(){const t=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),e=this.droppedPiece.get().y,r=this.droppedPiece.get().x;this.pieceOnBoard[t][e][r]=l1.INITIAL_PIECE_ON_BOARD;for(const s of this.possibleNextClicks)this.pieceOnBoard[t][s.y][s.x].isPossibleClick=!1}selectPiece(t){if(this.possibleMoves.some(e=>e.getZero().equals(t))){const e=this.getState().getPieceAt(t).getHeight();return e>=this.pieceOnBoard.length&&this.pieceOnBoard.push(Qe.createTable(ss.SIZE,ss.SIZE,l1.INITIAL_PIECE_ON_BOARD)),this.showDroppedPieceAndIndicators(t,e),z.SUCCESS}return this.cancelMove(eT.NO_WAY_TO_DROP_IT_HERE())}showDroppedPieceAndIndicators(t,e){this.droppedPiece=y.of(t),this.possibleNextClicks=this.getPossibleNextClicks(t);for(const r of this.possibleNextClicks)this.pieceOnBoard[e][r.y][r.x]={isDroppedPiece:!1,isPossibleClick:!0,move:y.empty()};this.pieceOnBoard[e][t.y][t.x]={isDroppedPiece:!0,isPossibleClick:!1,move:y.empty()}}getPossibleNextClicks(t){return this.possibleMoves.filter(r=>r.getZero().equals(t)).map(r=>r.getOne())}cancelMoveAttempt(){this.droppedPiece=y.empty(),this.possibleNextClicks=[],this.updateBoard()}getPieceClasses(t,e,r){const s=new S(t,e),i=this.getState().getPieceAtXYZ(t,e,r).owner;let o=[this.getPlayerClass(i)];o=o.concat(this.getSpaceClasses(t,e));for(const c of this.victoryCoords)if(c.equals(s)){o.push("victory-stroke");break}if(this.node.move.isPresent()){const c=this.node.move.get();(c.getZero().equals(s)||c.getOne().equals(s))&&o.push("last-move-stroke")}return o}getSpaceClasses(t,e){for(const r of this.pieceOnBoard)if(r[e][t].isPossibleClick)return["darker"];return[]}getTranslate(t,e,r){const i=this.getCoordTranslate(t,e,r,l1.modeMap[this.chosenMode]);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(e=>e.x+" "+e.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(l1.modeMap[this.chosenMode])}get3DSwitcherTransform(){const t=l1.modeMap["3D"],e=t.horizontalWidthRatio+t.offsetRatio;return"translate("+(10+t.offsetRatio)*t.parallelogramHeight+", "+(9+(1-1/e)/2)*t.parallelogramHeight+") scale("+1/e+")"}}l1.VERBOSE=!1,l1.INITIAL_PIECE_ON_BOARD={isDroppedPiece:!1,isPossibleClick:!1,move:y.empty()},l1.modeMap={"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}},l1.\u0275fac=function(t){return new(t||l1)(Q(Mn))},l1.\u0275cmp=ut({type:l1,selectors:[["app-trexo"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(t,e){if(1&t&&(F(),O(0,"svg",0),x(1,h7t,2,1,"g",1),x(2,_7t,2,1,"g",1),O(3,"g",null,2),x(5,C7t,1,5,"g",3),x(6,y7t,1,6,"ng-template",null,4,Gn),A()()),2&t){const r=Fn(7);D("viewBox",e.left+" "+e.up+" "+e.width+" "+e.height),T(1),w("ngForOf",e.board),T(1),w("ngForOf",e.pieceOnBoard),T(3),w("ngIf","2D"===e.chosenMode)("ngIfElse",r)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class zr{}zr.PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`,zr.NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`,zr.MISSING_CAPTURES=Gc.MISSING_CAPTURES,zr.MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`,zr.CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`,zr.SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`,zr.SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`,zr.MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`,zr.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`,zr.AMBIGUOUS_CAPTURE_COORD=Gc.AMBIGUOUS_CAPTURE_COORD,zr.CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`;class At{constructor(t,e){this.player=t,this.isRing=e}static of(t,e){return t===pe.NONE?At.EMPTY:e?At.RINGS[t.value]:At.MARKERS[t.value]}equals(t){return this===t}flip(){return Le(!1===this.isRing,"cannot flip a ring (it should never happen)"),Le(this.player.isPlayer(),"cannot flip a non-player piece"),At.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case At.UNREACHABLE:return"NONE";case At.EMPTY:return"EMPTY";case At.MARKER_ZERO:return"MARKER_ZERO";case At.MARKER_ONE:return"MARKER_ONE";case At.RING_ZERO:return"RING_ZERO";default:return Se.expectToBe(this,At.RING_ONE),"RING_ONE"}}}At.encoder=xt.tuple([pe.encoder,xt.identity()],n=>[n.player,n.isRing],n=>At.of(n[0],n[1])),At.UNREACHABLE=new At(pe.NONE,!1),At.EMPTY=new At(pe.NONE,!1),At.MARKER_ZERO=new At(B.ZERO,!1),At.MARKER_ONE=new At(B.ONE,!1),At.MARKERS=[At.MARKER_ZERO,At.MARKER_ONE],At.RING_ZERO=new At(B.ZERO,!0),At.RING_ONE=new At(B.ONE,!0),At.RINGS=[At.RING_ZERO,At.RING_ONE];let Xc=(()=>{class n extends DH{constructor(e,r,s){super(s,e,n.SIZE,n.SIZE,[6,4,3,2,1],At.EMPTY),this.sideRings=r}static getInitialState(){const e=At.EMPTY,r=At.UNREACHABLE;return new n([[r,r,r,r,r,r,e,e,e,e,r],[r,r,r,r,e,e,e,e,e,e,e],[r,r,r,e,e,e,e,e,e,e,e],[r,r,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,r,r],[e,e,e,e,e,e,e,e,r,r,r],[e,e,e,e,e,e,e,r,r,r,r],[r,e,e,e,e,r,r,r,r,r,r]],[5,5],0)}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&Qe.compareTable(this.board,e.board)}getRingCoords(e){const r=[];return this.forEachCoord((s,i)=>{i.isRing&&i.player===e&&r.push(s)}),r}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==At.UNREACHABLE}setAtUnsafe(e,r){const s=Qe.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.sideRings,this.turn)}}return n.SIZE=11,n})();class ba extends Mi{constructor(t,e){if(super(t),5!==t.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=y.ofNullable(e)}static of(t,e,r){const s=[],i=ze.factory.fromMove(t,e).get();for(let o=t;!1===o.equals(e);o=o.getNext(i))s.push(o);return s.push(e),new ba(s,r)}setRingTaken(t){return new ba(this.capturedSpaces,t)}equals(t){return!(!1===super.equals(t)||!1===this.ringTaken.equals(t.ringTaken))}}ba.encoder=new class extends R4{encode(n){return{captured:n.capturedSpaces.map(t=>S.encoder.encode(t)),ringTaken:S.encoder.encode(n.ringTaken.get())}}decode(n){const t=n;return Le(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new ba(t.captured.map(e=>S.encoder.decode(e)),S.encoder.decode(t.ringTaken))}};class dc extends ji{constructor(t,e,r,s){super(),this.initialCaptures=t,this.start=e,this.end=r,this.finalCaptures=s}isInitialPlacement(){return this.end.isAbsent()}equals(t){return this===t||!(!1===this.start.equals(t.start)||!1===this.end.equals(t.end)||!1===Qe.compareArray(this.initialCaptures,t.initialCaptures)||!1===Qe.compareArray(this.finalCaptures,t.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}}dc.coordOptionalEncoder=y.getEncoder(S.encoder),dc.encoder=new class extends xt{encodeMove(n){const t={moveStart:S.encoder.encode(n.start),moveEnd:dc.coordOptionalEncoder.encode(n.end)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=ba.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=ba.encoder.encode(e)}),t}decodeMove(n){const t=n;return Le(null!=t.moveStart,"Invalid encoded YinshMove"),new dc(this.decodeArray(t,"initialCapture",ba.encoder.decode),S.encoder.decode(t.moveStart),dc.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",ba.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class M7t extends xs{getMetrics(t){return t.gameState.sideRings}getListMoves(t){const e=[],r=t.gameState;if(r.isInitialPlacementPhase())for(const{coord:s,content:i}of r.getCoordsAndContents())i===At.EMPTY&&e.push(new dc([],s,y.empty(),[]));else{const s=this.ruler;this.getPossibleCaptureCombinations(r).forEach(i=>{const o=s.applyCaptures(i,r);this.getRingMoves(o).forEach(c=>{const u=s.applyRingMoveAndFlip(c.start,c.end,o);this.getPossibleCaptureCombinations(u).forEach(h=>{const g=new dc(i,c.start,y.of(c.end),h);e.push(g)})})})}return e}getPossibleCaptureCombinations(t){const r=this.ruler.getPossibleCaptures(t),s=this.getRingCoords(t);return jm.getPossibleCaptureCombinationsFromPossibleCaptures(r).map(i=>class E7t{static getCombinations(t,e){return Le(t.length>=e,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(t,e).map(r=>this.getPermutations(r)).reduce((r,s)=>r.concat(s))}static getPermutations(t){const e=t.length,r=[t.slice()],s=new Array(e).fill(0);let i=1;for(;i<e;)if(s[i]<i){const o=i%2&&s[i],c=t[i];t[i]=t[o],t[o]=c,++s[i],i=1,r.push(t.slice())}else s[i]=0,++i;return r}static getSubsetsOfSize(t,e){return function r(s,i){if(i>=t.length||s<1)return[[]];{const o=[];for(;i<=t.length-s;){const c=t[i];for(const u of r(s-1,i+1))u.push(c),o.push(u);++i}return o}}(e,0)}}.getCombinations(s,i.length).map(o=>i.map((c,u)=>new ba(c.capturedSpaces,o[u])))).reduce((i,o)=>i.concat(o),[])}getRingMoves(t){const e=this.ruler,r=[];for(const s of this.getRingCoords(t))for(const i of e.getRingTargets(t,s))r.push({start:s,end:i});return r}getRingCoords(t){const e=t.getCurrentPlayer().value,r=[];return t.forEachCoord((s,i)=>{i===At.RINGS[e]&&r.push(s)}),r}}class M8 extends L1{constructor(){super(Xc)}static get(){return M8.singleton.isAbsent()&&(M8.singleton=y.of(new M8)),M8.singleton.get()}applyLegalMove(t,e,r){return new Xc(r.board,r.sideRings,r.turn+1)}applyCaptures(t,e){let r=e;return t.forEach(s=>{r=this.applyCapture(s,r)}),r}applyCapture(t,e){const r=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new Xc(r,e.sideRings,e.turn),t.ringTaken.get())}takeRing(t,e){const r=t.getCurrentPlayer().value,s=t.setAt(e,At.EMPTY).board,i=[t.sideRings[0],t.sideRings[1]];return i[r]+=1,new Xc(s,i,t.turn)}applyCaptureWithoutTakingRing(t,e){return e.forEach(r=>{t=t.setAt(r,At.EMPTY)}),t.board}ringSelectionValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)===At.RINGS[r]?z.SUCCESS:z.failure(zr.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(t,e,r){const s=r.getCurrentPlayer().value;let i=r.setAt(t,At.MARKERS[s]);i=i.setAt(e,At.RINGS[s]);const o=ze.factory.fromMove(t,e).get();for(let c=t.getNext(o);!1===c.equals(e);c=c.getNext(o)){const u=i.getPieceAt(c);u!==At.EMPTY&&(i=i.setAt(c,u.flip()))}return i}isLegal(t,e){if(t.isInitialPlacement())return this.initialPlacementValidity(e,t.start);if(e.isInitialPlacementPhase())return _e.failure(zr.NO_MARKERS_IN_INITIAL_PHASE());const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toOtherFallible();const s=this.applyCaptures(t.initialCaptures,e),i=this.moveValidity(s,t.start,t.end.get());if(i.isFailure())return i.toOtherFallible();const o=this.applyRingMoveAndFlip(t.start,t.end.get(),s),c=this.capturesValidity(o,t.finalCaptures);if(c.isFailure())return c.toOtherFallible();const u=this.applyCaptures(t.finalCaptures,o),h=this.noMoreCapturesValidity(u);return h.isFailure()?h.toOtherFallible():_e.success(u)}initialPlacementValidity(t,e){if(!0!==t.isInitialPlacementPhase())return _e.failure(zr.PLACEMENT_AFTER_INITIAL_PHASE());if(t.getPieceAt(e)!==At.EMPTY)return _e.failure(tt.MUST_CLICK_ON_EMPTY_SPACE());const r=t.getCurrentPlayer(),s=[t.sideRings[0],t.sideRings[1]];s[r.value]-=1;const i=t.setAt(e,At.of(r,!0)).board,o=new Xc(i,s,t.turn);return _e.success(o)}moveStartValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)!==At.RINGS[r]?z.failure(zr.SHOULD_SELECT_PLAYER_RING()):z.SUCCESS}moveValidity(t,e,r){const s=this.moveStartValidity(t,e);if(s.isFailure())return s;if(t.getPieceAt(r)!==At.EMPTY)return z.failure(zr.SHOULD_END_MOVE_ON_EMPTY_SPACE());const i=ze.factory.fromMove(e,r);if(i.isFailure())return z.failure(zr.MOVE_DIRECTION_INVALID());const o=i.get();let c=!1;for(let u=e.getNext(o);!1===u.equals(r);u=u.getNext(o)){const h=t.getPieceAt(u);if(h===At.EMPTY){if(c)return z.failure(zr.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(h.isRing)return z.failure(zr.MOVE_SHOULD_NOT_PASS_ABOVE_RING());c=!0}}return z.SUCCESS}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=this.applyCapture(s,r)}return z.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer().value;for(const s of e.capturedSpaces)if(t.getPieceAt(s)!==At.MARKERS[r])return z.failure(zr.CAN_ONLY_CAPTURE_YOUR_MARKERS());return t.getPieceAt(e.ringTaken.get())!==At.RINGS[r]?z.failure(zr.CAPTURE_SHOULD_TAKE_RING()):z.SUCCESS}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).length?z.SUCCESS:z.failure(zr.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=this.getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let u,c=i;for(u=i;t.isOnBoard(u);u=u.getNext(o)){const h=t.getPieceAt(u);if(h.player===e&&!1===h.isRing)0===s&&(c=u),s+=1;else{if(s>=5)break;s=0}}return s>=5?y.of({start:c,end:u,dir:o}):y.empty()}getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).forEach(s=>{for(let i=s.start;i.getDistance(s.end)>=5;i=i.getNext(s.dir))r.push(ba.of(i,i.getNext(s.dir,4)))}),r}getRingTargets(t,e){const r=[];for(const s of ze.factory.all){let i=!1;for(let o=e.getNext(s);t.isOnBoard(o);o=o.getNext(s)){const c=t.getPieceAt(o);if(c===At.EMPTY){if(r.push(o),i)break}else{if(c.isRing)break;i=!0}}}return r}getGameStatus(t){return t.gameState.isInitialPlacementPhase()?xe.ONGOING:t.gameState.sideRings[0]>=3?xe.ZERO_WON:t.gameState.sideRings[1]>=3?xe.ONE_WON:xe.ONGOING}}M8.singleton=y.empty();const W=At.EMPTY,Te=At.UNREACHABLE,n2=At.MARKER_ZERO,ho=At.RING_ZERO,J4=At.MARKER_ONE,Ai=At.RING_ONE;let r4e=(()=>{class n{}return n.MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`,n.MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`,n})();class s4e extends U1{constructor(){super(...arguments),this.tutorial=[ie.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new Xc([[Te,Te,Te,Te,Te,Te,W,W,W,W,Te],[Te,Te,Te,Te,W,W,W,W,W,W,W],[Te,Te,Te,n2,Ai,W,W,W,W,W,W],[Te,Te,W,n2,W,Ai,W,J4,W,W,W],[Te,W,ho,J4,W,W,Ai,n2,W,W,W],[Te,W,W,n2,J4,W,W,W,W,W,Te],[W,W,W,n2,W,W,W,Ai,W,W,Te],[W,W,W,J4,n2,ho,W,W,W,Te,Te],[W,W,W,W,W,W,W,W,Te,Te,Te],[W,W,W,W,W,W,W,Te,Te,Te,Te],[Te,W,W,W,W,Te,Te,Te,Te,Te,Te]],[3,1],20)),ie.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new Xc(Xc.getInitialState().board,[5,5],0),new dc([],new S(5,5),y.empty(),[]),$localize`Congratulations!`),ie.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new Xc([[Te,Te,Te,Te,Te,Te,W,W,W,W,Te],[Te,Te,Te,Te,W,W,W,W,W,W,W],[Te,Te,Te,Ai,W,W,W,W,W,W,W],[Te,Te,Ai,W,W,Ai,W,W,W,W,W],[Te,W,ho,J4,W,W,Ai,W,W,W,W],[Te,W,W,J4,W,W,W,W,W,W,Te],[W,W,W,W,ho,W,W,Ai,W,W,Te],[W,W,W,W,W,ho,W,W,W,Te,Te],[W,W,W,ho,W,W,W,Te,Te,Te,Te],[W,W,W,W,W,W,W,Te,Te,Te,Te],[Te,W,W,W,W,Te,Te,Te,Te,Te,Te]],[0,0],20),new dc([],new S(2,4),y.of(new S(4,4)),[]),$localize`Congratulations!`),ie.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new Xc([[Te,Te,Te,Te,Te,Te,W,W,W,W,Te],[Te,Te,Te,Te,W,W,W,W,W,W,W],[Te,Te,Te,Ai,W,W,W,W,W,W,W],[Te,Te,Ai,W,W,Ai,W,W,W,W,W],[Te,W,n2,n2,ho,J4,J4,W,W,W,W],[Te,W,W,Ai,W,W,W,W,W,W,Te],[W,W,W,W,ho,W,W,Ai,W,W,Te],[W,W,W,W,W,ho,W,W,W,Te,Te],[W,W,W,ho,W,W,W,ho,Te,Te,Te],[W,W,W,W,W,W,W,Te,Te,Te,Te],[Te,W,W,W,W,Te,Te,Te,Te,Te,Te]],[0,0],20),new dc([],new S(4,4),y.of(new S(7,4)),[ba.of(new S(2,4),new S(6,4),new S(7,4))]),(t,e,r)=>1===r.sideRings[B.ZERO.value]?z.SUCCESS:z.failure(r4e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),ie.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new Xc([[Te,Te,Te,Te,Te,Te,W,W,W,W,Te],[Te,Te,Te,Te,ho,W,W,Ai,Ai,ho,W],[Te,Te,Te,ho,W,W,J4,Ai,W,ho,W],[Te,Te,W,ho,W,W,W,W,W,Ai,W],[Te,W,W,W,W,n2,W,W,Ai,W,W],[Te,W,W,W,n2,n2,W,J4,W,W,Te],[W,W,W,n2,W,n2,W,W,W,W,Te],[W,W,n2,W,W,n2,W,W,W,Te,Te],[W,n2,W,W,W,n2,W,W,Te,Te,Te],[W,W,W,W,W,n2,W,Te,Te,Te,Te],[Te,W,W,W,W,Te,Te,Te,Te,Te,Te]],[0,0],10),new dc([ba.of(new S(5,4),new S(1,8),new S(3,2)),ba.of(new S(5,9),new S(5,5),new S(3,3))],new S(4,1),y.of(new S(4,2)),[]),(t,e,r)=>2===r.sideRings[B.ZERO.value]?z.SUCCESS:z.failure(r4e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)]}}function S7t(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2).$implicit,r=C(2);D("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringOuterSize)}}function P7t(n,t){if(1&n&&(F(),X(0,"circle",13)),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();Re("id","ring_",r,"_",i,""),w("ngClass",s.ringClasses),D("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.ringMidSize)}}function T7t(n,t){if(1&n&&(F(),X(0,"circle",12)),2&n){const e=C(2).$implicit,r=C(2);D("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringInnerSize)}}function w7t(n,t){if(1&n&&(F(),X(0,"circle",14)),2&n){const e=C(2),r=e.index,s=e.$implicit,i=C().index,o=C();Re("id","marker_",r,"_",i,""),w("ngClass",s.markerClasses),D("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.markerSize)}}function b7t(n,t){if(1&n){const e=Ae();F(),O(0,"g",6),ee("click",function(){he(e);const s=C().$implicit;return le(C(2).onClick(s.coord))}),X(1,"polygon",7),O(2,"g",8),x(3,S7t,1,3,"circle",9),x(4,P7t,1,6,"circle",10),x(5,T7t,1,3,"circle",9),x(6,w7t,1,6,"circle",11),A()()}if(2&n){const e=C(),r=e.index,s=e.$implicit,i=C().index;Re("id","click_",r,"_",i,""),T(1),Re("id","space_",r,"_",i,""),w("ngClass",s.spaceClasses),D("points",s.coordinates),T(1),Re("id","pieceGroup_",r,"_",i,""),w("ngClass",s.removedClass),T(1),w("ngIf",s.isRing),T(1),w("ngIf",s.isRing),T(1),w("ngIf",s.isRing),T(1),w("ngIf",s.isMarker)}}function O7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,b7t,7,13,"g",5),A()),2&n){const e=t.$implicit;T(1),w("ngIf",null!=e)}}function A7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,O7t,2,1,"g",1),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}function N7t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",15),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();Re("id","selected_",e.x,"_",e.y,""),D("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function I7t(n,t){if(1&n){const e=Ae();F(),O(0,"polygon",17),ee("click",function(){const i=he(e).$implicit;return le(C(2).onClick(i))}),A()}if(2&n){const e=t.$implicit,r=C(2);Re("id","selectable_",e.x,"_",e.y,""),D("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function x7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,I7t,1,3,"polygon",16),A()),2&n){const e=C();T(1),w("ngForOf",e.viewInfo.selectableCoords)}}function k7t(n,t){if(1&n){const e=Ae();F(),O(0,"rect",18),ee("click",function(){const i=he(e).$implicit;return le(C().onClick(i))}),A()}if(2&n){const e=t.$implicit,r=C();Re("id","indicator_",e.x,"_",e.y,""),D("x",r.viewInfo.spaceInfo[e.y][e.x].center.x-r.viewInfo.indicatorSize/2)("y",r.viewInfo.spaceInfo[e.y][e.x].center.y-r.viewInfo.indicatorSize/2)("width",r.viewInfo.indicatorSize)("height",r.viewInfo.indicatorSize)}}function L7t(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",19)(2,"circle",12)(3,"circle",20),A()),2&n){const e=t.index,r=C().$implicit,s=C();T(1),Re("id","player_",r.value,"_sideRing_",e+1,""),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringOuterSize),T(1),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringInnerSize),T(1),w("ngClass",s.viewInfo.sideRingClass[r.value]),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringMidSize)}}const R7t=function(){return[]};function D7t(n,t){if(1&n&&(F(),O(0,"g"),x(1,L7t,4,12,"g",1),A()),2&n){const e=t.$implicit,r=C();D("transform","rotate("+180*(r.role.value+1)+" 532.5 780)"),T(1),w("ngForOf",J1(2,R7t).constructor(r.viewInfo.sideRings[e.value]))}}class Ni extends Ah{constructor(t){super(t),this.movePhase="MOVE_START",this.moveStart=y.empty(),this.moveEnd=y.empty(),this.currentlyMoved=[],this.currentCapture=y.empty(),this.initialCaptures=[],this.finalCaptures=[],this.possibleCaptures=[],this.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:Ni.MARKER_SIZE,ringOuterSize:Ni.RING_OUTER_SIZE,ringMidSize:Ni.RING_MID_SIZE,ringInnerSize:Ni.RING_INNER_SIZE,indicatorSize:Ni.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},this.scores=y.of([0,0]),this.rules=M8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new M7t(this.rules,"YinshMinimax")],this.encoder=dc.encoder,this.tutorial=(new s4e).tutorial,this.hexaLayout=new Nh(1.5*Ni.RING_OUTER_SIZE,new S(2*Ni.RING_OUTER_SIZE,0),Is.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(e=>{null==this.viewInfo.spaceInfo[e.y]&&(this.viewInfo.spaceInfo[e.y]=[]),this.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:this.getHexaPointsAt(e),center:this.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt();const t=this.getState();this.scores=y.of(t.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(t=>{this.viewInfo.spaceInfo[t.y][t.x].spaceClasses=this.getSpaceClasses(t);const e=this.constructedState.getPieceAt(t);this.viewInfo.spaceInfo[t.y][t.x].removedClass="",this.setRingInfo(t,e),this.setMarkerInfo(t,e)});for(const t of B.PLAYERS)this.viewInfo.sideRings[t.value]=this.constructedState.sideRings[t.value];switch(this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const t of this.possibleCaptures)for(const e of t.capturedSpaces)this.viewInfo.selectableCoords.push(e);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const t of this.initialCaptures)this.markCurrentCapture(t);for(const t of this.finalCaptures)this.markCurrentCapture(t)}getSpaceClasses(t){return this.currentlyMoved.some(e=>e.equals(t))?["moved-fill"]:[]}setRingInfo(t,e){e.isRing?(this.viewInfo.spaceInfo[t.y][t.x].isRing=!0,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=["player"+e.player.value+"-stroke"]):(this.viewInfo.spaceInfo[t.y][t.x].isRing=!1,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=[])}setMarkerInfo(t,e){if(this.viewInfo.spaceInfo[t.y][t.x].isMarker=!1,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[],e!==At.EMPTY&&(!e.isRing||this.moveStart.equalsValue(t))){const s=this.getPlayerClass(e.player);this.viewInfo.spaceInfo[t.y][t.x].isMarker=!0,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[s]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=y.empty(),this.moveStart=y.empty(),this.moveEnd=y.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(t){if(t.isInitialPlacement())this.viewInfo.spaceInfo[t.start.y][t.start.x].spaceClasses=["moved-fill"];else{for(const r of this.coordsBetween(t.start,t.end.get()))this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["moved-fill"];const e=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();t.initialCaptures.forEach(r=>this.showLastMoveCapture(r,e)),t.finalCaptures.forEach(r=>this.showLastMoveCapture(r,e))}}coordsBetween(t,e){const r=[],s=ze.factory.fromMove(t,e).get();for(let i=t;!i.equals(e);i=i.getNext(s))this.constructedState.getPieceAt(i)!==At.EMPTY&&r.push(i),r.push(e);return r}showLastMoveCapture(t,e){for(const r of t.capturedSpaces)this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["captured-fill"],e&&this.markRemovedMarker(r,this.getState().getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[t.ringTaken.get().y][t.ringTaken.get().x].spaceClasses=["captured-fill"],e&&this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),z.SUCCESS}onClick(t){var e=this;return I(function*(){const r=e.canUserPlay("#click_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());switch(e.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return e.selectCaptureFirstCoord(t);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return e.selectCaptureLastCoord(t);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return e.selectRing(t);case"MOVE_START":return e.selectMoveStart(t);case"MOVE_END":return e.selectMoveEnd(t)}})()}selectCaptureFirstCoord(t){var e=this;return I(function*(){const r=[];if(e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1)e.viewInfo.selectedCoords.push(t),e.moveToCaptureSelectLast(r);else{if(0===r.length)return e.cancelMove(zr.MISSING_CAPTURES());e.selectCapture(r[0])}return z.SUCCESS})()}moveToCaptureSelectLast(t){this.viewInfo.selectableCoords=[],this.possibleCaptures=t;for(const e of t)for(const r of e.capturedSpaces)this.viewInfo.selectableCoords.push(r);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(Se.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(t){var e=this;return I(function*(){const r=[];return e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1?e.cancelMove(zr.AMBIGUOUS_CAPTURE_COORD()):0===r.length?e.cancelMove(zr.MISSING_CAPTURES()):e.selectCapture(r[0])})()}selectCapture(t){return this.currentCapture=y.of(t),this.constructedState=new Xc(this.rules.applyCaptureWithoutTakingRing(this.constructedState,t),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(Le("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),z.SUCCESS}markCurrentCapture(t){for(const e of t.capturedSpaces)this.viewInfo.selectedCoords.push(e),this.markRemovedMarker(e,this.getState().getCurrentPlayer());t.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(t.ringTaken.get()),this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setMarkerInfo(t,At.MARKERS[e.value])}markRemovedRing(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setRingInfo(t,At.RINGS[e.value])}selectRing(t){var e=this;return I(function*(){const r=e.rules.ringSelectionValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.constructedState=e.rules.takeRing(e.constructedState,t);const s=e.currentCapture.get().setRingTaken(t);return"INITIAL_CAPTURE_SELECT_RING"===(e.currentCapture=y.empty(),e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),e.movePhase)?(e.initialCaptures.push(s),0===e.possibleCaptures.length?e.moveToMovePhase():(e.movePhase="INITIAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),z.SUCCESS)):(Se.expectToBe(e.movePhase,"FINAL_CAPTURE_SELECT_RING"),e.finalCaptures.push(s),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),z.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),z.SUCCESS}tryMove(){var t=this;return I(function*(){const e=new dc(t.initialCaptures,t.moveStart.get(),t.moveEnd,t.finalCaptures);return yield t.chooseMove(e,t.getState(),t.scores.get())})()}selectMoveStart(t){var e=this;return I(function*(){if(e.constructedState.isInitialPlacementPhase()){const r=e.rules.initialPlacementValidity(e.constructedState,t);return r.isFailure()?e.cancelMove(r.getReason()):(e.moveStart=y.of(t),e.tryMove())}{const r=e.rules.moveStartValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.moveStart=y.of(t),e.movePhase="MOVE_END",e.updateViewInfo()}return z.SUCCESS})()}selectMoveEnd(t){var e=this;return I(function*(){if(e.moveStart.equalsValue(t))return e.cancelMoveAttempt(),z.SUCCESS;const r=At.RINGS[e.getState().getCurrentPlayer().value];if(e.constructedState.getPieceAt(t)===r)return e.cancelMoveAttempt(),e.selectMoveStart(t);const s=e.rules.moveValidity(e.constructedState,e.moveStart.get(),t);return s.isFailure()?e.cancelMove(s.getReason()):(e.moveEnd=y.of(t),e.currentlyMoved=e.coordsBetween(e.moveStart.get(),t),e.constructedState=e.rules.applyRingMoveAndFlip(e.moveStart.get(),t,e.constructedState),e.updateViewInfo(),e.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var t=this;return I(function*(){return t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),z.SUCCESS)})()}}function z7t(n,t){if(1&n&&(O(0,"option",5),Tt(1),A()),2&n){const e=t.$implicit;w("value",e.urlName),T(1),a1(e.name)}}Ni.RING_OUTER_SIZE=40,Ni.RING_MID_SIZE=34,Ni.RING_INNER_SIZE=28,Ni.MARKER_SIZE=Ni.RING_INNER_SIZE,Ni.INDICATOR_SIZE=10,Ni.\u0275fac=function(t){return new(t||Ni)(Q(Mn))},Ni.\u0275cmp=ut({type:Ni,selectors:[["app-yinsh"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(t,e){1&t&&(F(),O(0,"svg",0),x(1,A7t,2,1,"g",1),x(2,N7t,1,3,"polygon",2),x(3,x7t,2,1,"g",3),x(4,k7t,1,6,"rect",4),x(5,D7t,2,3,"g",1),A()),2&t&&(T(1),w("ngForOf",e.viewInfo.spaceInfo),T(1),w("ngForOf",e.viewInfo.selectedCoords),T(1),w("ngIf",e.isPlayerTurn()),T(1),w("ngForOf",e.viewInfo.targets),T(1),w("ngForOf",e.Player.PLAYERS))},dependencies:[pn,On,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let S1=(()=>{class n{}return n.ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`,n.APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`,n.AWALE=()=>$localize`The international version of the famous African strategy game!`,n.BRANDHUB=()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`,n.CONNECT_SIX=()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`,n.CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`,n.DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`,n.DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`,n.ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`,n.EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`,n.GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`,n.GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`,n.HIVE=()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`,n.HNEFATAFL=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`,n.KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`,n.LASCA=()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`,n.LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`,n.LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`,n.MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`,n.P4=()=>$localize`The classical 4 in a row game!`,n.PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`,n.PENTE=()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`,n.PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`,n.QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`,n.QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`,n.REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`,n.SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`,n.SIAM=()=>$localize`Be the first to push a mountain out of the board!`,n.SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`,n.TABLUT=()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.TREXO=()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`,n.YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`,n})(),qh=(()=>{class n{constructor(e,r,s,i,o,c,u,h=!0){this.name=e,this.urlName=r,this.component=s,this.tutorial=i,this.rules=o,this.creationDate=c,this.description=u,this.display=h}}return n.ALL_GAMES=()=>[new n($localize`Four in a Row`,"P4",O8t,new N3e,ti.get(),new Date("2018-08-28"),S1.P4()),new n($localize`Awalé`,"Awale",C4t,new Zce,G1.get(),new Date("2018-11-29"),S1.AWALE()),new n($localize`Quarto`,"Quarto",zut,new $3e,Rr.get(),new Date("2018-12-09"),S1.QUARTO()),new n($localize`Tablut`,"Tablut",X5t,new Q3e,E8.get(),new Date("2018-12-27"),S1.TABLUT()),new n($localize`Reversi`,"Reversi",Yut,new q3e,Oi.get(),new Date("2019-01-16"),S1.REVERSI()),new n($localize`Go`,"Go",I6t,new d3e,Ot.get(),new Date("2019-12-21"),S1.GO()),new n($localize`Encapsule`,"Encapsule",Qlt,new l3e,oo.get(),new Date("2019-12-30"),S1.ENCAPSULE()),new n($localize`Siam`,"Siam",w5t,new K3e,Cr.get(),new Date("2020-01-11"),S1.SIAM()),new n($localize`Sahara`,"Sahara",c5t,new W3e,$2.get(),new Date("2020-02-29"),S1.SAHARA()),new n($localize`Pylos`,"Pylos",out,new V3e,bi.get(),new Date("2020-10-02"),S1.PYLOS()),new n($localize`Kamisado`,"Kamisado",S0t,new y3e,Ti.get(),new Date("2020-10-03"),S1.KAMISADO()),new n($localize`Quixo`,"Quixo",Gut,new U3e,e2.get(),new Date("2020-10-15"),S1.QUIXO()),new n($localize`Dvonn`,"Dvonn",Flt,new i3e,gs.get(),new Date("2020-10-21"),S1.DVONN()),new n($localize`Epaminondas`,"Epaminondas",i6t,new u3e,ic.get(),new Date("2021-01-16"),S1.EPAMINONDAS()),new n($localize`Gipf`,"Gipf",p6t,new h3e,An.get(),new Date("2021-02-22"),S1.GIPF()),new n($localize`Coerceo`,"Coerceo",clt,new r3e,Hc.get(),new Date("2021-03-21"),S1.COERCEO()),new n($localize`Six`,"Six",V5t,new X3e,U2.get(),new Date("2021-04-08"),S1.SIX()),new n($localize`Lines of Action`,"LinesOfAction",V0t,new P3e,Rs.get(),new Date("2021-04-28"),S1.LINES_OF_ACTION()),new n($localize`Pentago`,"Pentago",V8t,new x3e,j4.get(),new Date("2021-05-23"),S1.PENTAGO()),new n($localize`Abalone`,"Abalone",o4t,new jce,Vo.get(),new Date("2021-07-13"),S1.ABALONE()),new n($localize`Yinsh`,"Yinsh",Ni,new s4e,M8.get(),new Date("2021-07-31"),S1.YINSH()),new n($localize`Apagos`,"Apagos",p4t,new Gce,h6.get(),new Date("2021-11-04"),S1.APAGOS()),new n($localize`Diam`,"Diam",D3,new e3e,H4.get(),new Date("2021-11-30"),S1.DIAM()),new n($localize`Brandhub`,"Brandhub",k4t,new Kce,l8.get(),new Date("2021-12-07"),S1.BRANDHUB()),new n($localize`Conspirateurs`,"Conspirateurs",vlt,new Qce,rc.get(),new Date("2021-12-30"),S1.CONSPIRATEURS()),new n($localize`Lodestone`,"Lodestone",F2,new T3e,H2.get(),new Date("2022-06-24"),S1.LODESTONE()),new n($localize`Martian Chess`,"MartianChess",jo,new A3e,z3.get(),new Date("2022-07-01"),S1.MARTIAN_CHESS()),new n($localize`Hnefatafl`,"Hnefatafl",g0t,new C3e,m8.get(),new Date("2022-09-21"),S1.HNEFATAFL()),new n($localize`Hive`,"Hive",n0t,new _3e,Xi.get(),new Date("2023-04-02"),S1.HIVE()),new n($localize`Trexo`,"Trexo",l1,new t4e,t2.get(),new Date("2023-04-23"),S1.TREXO()),new n($localize`Lasca`,"Lasca",x0t,new S3e,lc.get(),new Date("2023-05-11"),S1.LASCA()),new n($localize`Connect Six`,"ConnectSix",$4t,new Xce,nc.get(),new Date("2023-05-13"),S1.CONNECT_SIX()),new n($localize`Pente`,"Pente",W8t,new R3e,uc.get(),new Date("2023-05-20"),S1.PENTE())].sort((t,e)=>t.name.localeCompare(e.name)),n})(),JH=(()=>{class n{constructor(){this.games=qh.ALL_GAMES(),this.pickGame=new hr}onChange(e){this.pickGame.emit(e.target.value)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ut({type:n,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"select",1),ee("change",function(i){return r.onChange(i)}),O(2,"option",2),ve(3,3),A(),x(4,z7t,2,2,"option",4),A()()),2&e&&(T(4),w("ngForOf",r.games))},dependencies:[On,Op,Ap],encapsulation:2}),n})();function V7t(n,t){if(1&n){const e=Ae();O(0,"div",26)(1,"div",27),ee("click",function(){return he(e),le(C().closeInfo())}),A(),O(2,"div",28)(3,"header",29)(4,"p",30),Tt(5),A(),O(6,"button",31),ee("click",function(){return he(e),le(C().closeInfo())}),A()(),O(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),X(11,"img",35),A()(),O(12,"div",7)(13,"div",13),Tt(14),A()()(),O(15,"div",6)(16,"div",33)(17,"a",36),ee("click",function(){he(e);const s=C();return le(s.createGame(s.gameInfoDetails.get().urlName))}),X(18,"fa-icon",37),Tt(19,"\xa0"),O(20,"span"),ve(21,38),A()()(),O(22,"div",33)(23,"a",36),ee("click",function(){he(e);const s=C();return le(s.createLocalGame(s.gameInfoDetails.get().urlName))}),X(24,"fa-icon",37),Tt(25,"\xa0"),O(26,"span"),ve(27,39),A()()(),O(28,"div",33)(29,"a",36),ee("click",function(){he(e);const s=C();return le(s.createTutorial(s.gameInfoDetails.get().urlName))}),X(30,"fa-icon",37),Tt(31,"\xa0"),O(32,"span"),ve(33,40),A()()()()()()()}if(2&n){const e=C();T(5),a1(e.gameInfoDetails.get().name),T(6),Re("src","assets/images/",e.theme,"/",e.gameInfoDetails.get().urlName,".png",m3),T(3),Hi(" ",e.gameInfoDetails.get().description," "),T(4),w("icon",e.iconOnlineGame),T(6),w("icon",e.iconLocalGame),T(6),w("icon",e.iconTutorial)}}function H7t(n,t){if(1&n){const e=Ae();O(0,"div",8)(1,"div",9)(2,"p",10),Tt(3),A()(),O(4,"div",42)(5,"figure",34)(6,"img",43),ee("click",function(){const i=he(e).$implicit;return le(C(2).openInfo(i))}),A(),O(7,"figcaption",44),ee("click",function(){const i=he(e).$implicit;return le(C(2).openInfo(i))}),O(8,"div",45),Tt(9,"?"),A()(),O(10,"figcaption",46)(11,"a",47),ee("click",function(){const i=he(e).$implicit;return le(C(2).createGame(i.urlName))}),X(12,"fa-icon",37),A(),O(13,"a",48),ee("click",function(){const i=he(e).$implicit;return le(C(2).createLocalGame(i.urlName))}),X(14,"fa-icon",37),A(),O(15,"a",49),ee("click",function(){const i=he(e).$implicit;return le(C(2).createTutorial(i.urlName))}),X(16,"fa-icon",37),A()()()(),O(17,"div",50),Tt(18),A()()}if(2&n){const e=t.$implicit,r=C(2);T(3),a1(e.name),T(3),d1("id","image_",e.urlName,""),Re("src","assets/images/",r.theme,"/",e.urlName,".png",m3),T(5),d1("id","playOnline_",e.urlName,""),T(1),w("icon",r.iconOnlineGame),T(1),d1("id","playLocally_",e.urlName,""),T(1),w("icon",r.iconLocalGame),T(1),d1("id","startTutorial_",e.urlName,""),T(1),w("icon",r.iconTutorial),T(2),Hi(" ",e.description," ")}}function F7t(n,t){if(1&n&&(O(0,"div",7),x(1,H7t,19,11,"div",41),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let B7t=(()=>{class n{constructor(e,r,s,i){this.router=e,this.messageDisplayer=r,this.observedPartService=s,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=foe,this.iconLocalGame=mH,this.iconTutorial=dce,this.gameInfoDetails=y.empty(),this.theme=i.getTheme();const o=qh.ALL_GAMES();let c=0;for(let u=0;u<o.length;u++)u<this.numberOfColumns&&this.games.push([]),this.games[c].push(o[u]),c=(c+1)%this.numberOfColumns}createGame(e){var r=this;return I(function*(){const s=r.observedPartService.canUserCreate();return s.isSuccess()?r.router.navigate(null==e?["/play"]:["/play",e]):(r.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(e){var r=this;return I(function*(){return r.router.navigate(["/local",e])})()}createTutorial(e){return this.router.navigate(["/tutorial",e])}openInfo(e){this.gameInfoDetails=y.of(e)}closeInfo(){this.gameInfoDetails=y.empty()}}return n.\u0275fac=function(e){return new(e||n)(Q(Kn),Q(Mn),Q(L2),Q(xS))},n.\u0275cmp=ut({type:n,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E,b,k;return t=$localize`EveryBoard`,e=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,r=$localize`Play online`,s=$localize`Create an online game`,i=$localize`See the game list`,o=$localize`Play offline`,c=$localize`Play`,u=$localize`Learn`,h=$localize`Play online`,g=$localize`Play offline`,m=$localize`Learn the rules`,E=$localize`Play online`,b=$localize`Play offline`,k=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],e,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],r,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],i,o,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],u,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],h,g,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",E,1,"button",3,"id","click"],["data-tooltip",b,1,"button",3,"id","click"],["data-tooltip",k,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,r){1&e&&(O(0,"section",0)(1,"div",1)(2,"p",2),ve(3,3),A(),O(4,"p",4),ha(5,5),X(6,"br"),da(),A()(),O(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),ve(12,11),A()(),O(13,"div",12)(14,"div",13)(15,"button",14),ee("click",function(){return r.createGame()}),ve(16,15),A(),O(17,"button",16),ve(18,17),A()()()()(),O(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),ve(23,18),A()(),O(24,"div",12)(25,"div",19)(26,"button",20),ve(27,21),A(),O(28,"button",22),ve(29,23),A()()()()()(),x(30,V7t,34,7,"div",24),O(31,"div",6),x(32,F7t,2,1,"div",25),A()()),2&e&&(T(30),w("ngIf",r.gameInfoDetails.isPresent()),T(2),w("ngForOf",r.games))},dependencies:[On,Xt,Of,I5],encapsulation:2}),n})();const $7t=["board"];let V5=(()=>{class n{static NO_MATCHING_GAME(e){return $localize`This game (${e}) does not exist.`}}return n.NOT_YOUR_TURN=()=>$localize`It is not your turn!`,n.GAME_HAS_ENDED=()=>$localize`This game has ended.`,n.CANNOT_PLAY_AS_OBSERVER=()=>$localize`You are an observer in this game, you cannot play.`,n.MUST_ANSWER_REQUEST=()=>$localize`You must answer your opponent's request.`,n})(),tT=(()=>{class n{constructor(e,r,s,i){this.actRoute=e,this.connectedUserService=r,this.router=s,this.messageDisplayer=i,this.boardRef=null,this.players=[y.empty(),y.empty()],this.role=pe.NONE,this.endGame=!1,this.Player=B,J(n.VERBOSE,"GameWrapper.constructed: "+(null!=this.boardRef))}getMatchingComponent(e){return J(n.VERBOSE,"GameWrapper.getMatchingComponent"),y.ofNullable(qh.ALL_GAMES().find(s=>s.urlName===e)).map(s=>s.component)}afterViewInit(){var e=this;return I(function*(){J(n.VERBOSE,"GameWrapper.afterViewInit");const r=yield e.createGameComponent();return r&&(e.gameComponent.node=e.gameComponent.rules.getInitialNode(),e.gameComponent.updateBoard()),r})()}getGameName(){return Se.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var e=this;return I(function*(){J(n.VERBOSE,{m:"GameWrapper.createGameComponent",that:e});const r=e.getGameName(),s=e.getMatchingComponent(r);if(s.isAbsent())return yield e.router.navigate(["/notFound",V5.NO_MATCHING_GAME(r)],{skipLocationChange:!0}),!1;Le(null!=e.boardRef,"Board element should be present");const i=Se.getNonNullable(e.boardRef).createComponent(s.get());return e.gameComponent=i.instance,e.gameComponent.chooseMove=(o,c,u)=>e.receiveValidMove(o,c,u),e.gameComponent.canUserPlay=o=>e.canUserPlay(o),e.gameComponent.isPlayerTurn=()=>e.isPlayerTurn(),e.gameComponent.cancelMoveOnWrapper=o=>{e.onCancelMove(o)},e.setRole(e.role),!0})()}setRole(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymmetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")"),this.updateBoardAndShowLastMove()}receiveValidMove(e,r,s){var i=this;return I(function*(){J(n.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:e,state:r,scores:s}});const c=i.canUserPlay("none");if(c.isFailure())return i.gameComponent.cancelMove(c.getReason()),c;const u=i.gameComponent.rules.isLegal(e,r);return u.isFailure()?(i.gameComponent.cancelMove(u.getReason()),z.ofFallible(u)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(e,s),J(n.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),z.SUCCESS)})()}canUserPlay(e){if(this.role===pe.NONE){const r=V5.CANNOT_PLAY_AS_OBSERVER();return z.failure(r)}return!1===this.isPlayerTurn()?z.failure(V5.NOT_YOUR_TURN()):this.endGame?z.failure(V5.GAME_HAS_ENDED()):z.SUCCESS}isPlayerTurn(){if(this.role===pe.NONE||null==this.gameComponent)return!1;const e=this.gameComponent.getTurn(),r=e%2,s=this.getPlayer();return J(n.VERBOSE,{isPlayerTurn:{turn:e,players:this.players,player:s,observer:this.role,areYouPlayer:this.players[r].isPresent()&&Xa(this.players[r].get(),s),isThereAPlayer:this.players[r]}}),!this.players[r].isPresent()||this.players[r].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}updateBoardAndShowLastMove(){if(this.gameComponent.cancelMoveAttempt(),this.gameComponent.updateBoard(),this.gameComponent.node.move.isPresent()){const e=this.gameComponent.node.move.get();this.gameComponent.showLastMove(e)}}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(xo),Q(Ns),Q(Kn),Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["ng-component"]],viewQuery:function(e,r){if(1&e&&y0($7t,5,Ga),2&e){let s;v4(s=C4())&&(r.boardRef=s.first)}},decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();const U7t=["board"];let G7t=(()=>{class n extends tT{constructor(e,r,s,i,o){super(e,r,s,i),this.cdr=o,this.boardRef=null}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var e=this;return I(function*(){setTimeout(I(function*(){yield e.afterViewInit(),e.gameComponent.node=e.demoNodeInfo.node,e.setRole(e.gameComponent.getCurrentPlayer()),e.cdr.detectChanges(),e.demoNodeInfo.click.isPresent()&&(Se.getNonNullable(document.querySelector(e.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),e.cdr.detectChanges())}),1)})()}onLegalUserMove(e,r){return I(function*(){})()}getPlayer(){return"no-player"}onCancelMove(e){}}return n.\u0275fac=function(e){return new(e||n)(Q(xo),Q(Ns),Q(Kn),Q(Mn),Q(wu))},n.\u0275cmp=ut({type:n,selectors:[["app-demo-card"]],viewQuery:function(e,r){if(1&e&&y0(U7t,5,Ga),2&e){let s;v4(s=C4())&&(r.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[l],decls:2,vars:0,consts:[["board",""]],template:function(e,r){1&e&&X(0,"div",null,0)},encapsulation:2}),n})();function q7t(n,t){if(1&n&&(O(0,"div",17)(1,"figure",18),X(2,"app-demo-card",19),A()()),2&n){const e=C().$implicit;T(2),w("demoNodeInfo",e)}}function W7t(n,t){if(1&n&&(O(0,"div",20)(1,"figure",21),X(2,"app-demo-card",19),A()()),2&n){const e=C().$implicit;T(2),w("demoNodeInfo",e)}}function j7t(n,t){if(1&n&&(O(0,"div",12)(1,"div",13)(2,"p",14),Tt(3),A()(),x(4,q7t,3,1,"div",15),x(5,W7t,3,1,"ng-template",null,16,Gn),A()),2&n){const e=t.$implicit,r=Fn(6),s=C(2);T(3),a1(e.name),T(1),w("ngIf",s.squared.value)("ngIfElse",r)}}function Z7t(n,t){if(1&n&&(O(0,"div",10),x(1,j7t,7,3,"div",11),A()),2&n){const e=t.$implicit;T(1),w("ngForOf",e)}}let Y7t=(()=>{class n{constructor(){this.numberOfColumns=new qa(5),this.squared=new qa(!0),this.columns=[],this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(e=>{this.fillColumns(e)})}fillColumns(e){const r=qh.ALL_GAMES();let s=0,i=0;this.columns=[];for(const o of r){const c=[],u=o.rules,h=o.tutorial.tutorial;for(const g of h){const m=this.getNodeFromStep(g,u);c.push(m)}for(const g of c)i<e&&this.columns.push([]),this.columns[s].push({name:o.urlName,node:g.node,click:g.click}),i++,s=(s+1)%e}}getNodeFromStep(e,r){if(e.hasSolution()){const s=e.getSolution();if("string"==typeof s)return{node:new gr(e.state),click:y.of(s)};{const i=s;return{node:new gr(r.applyLegalMove(i,e.state,r.isLegal(i,e.state).get()),y.of(new gr(e.state)),y.of(i)),click:y.empty()}}}return{node:new gr(e.state),click:y.empty()}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ut({type:n,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,e;return t=$localize`Number of columns: `,e=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],e,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(e,r){1&e&&(O(0,"form")(1,"div",0)(2,"label",1),hn(3),ve(4,2),dn(),O(5,"output"),Tt(6),A()(),O(7,"div",3),X(8,"input",4),A()(),O(9,"div",0)(10,"label",5),X(11,"input",6),Tt(12," \xa0"),hn(13),ve(14,7),dn(),A()()(),O(15,"div",8),x(16,Z7t,2,1,"div",9),A()),2&e&&(T(6),a1(r.numberOfColumns.value),T(2),w("formControl",r.numberOfColumns),T(3),w("formControl",r.squared),T(5),w("ngForOf",r.columns))},dependencies:[On,Xt,Iu,S4,$y,cA,zl,Nu,EA,wp,G7t],encapsulation:2}),n})(),eF=(()=>{class n{constructor(e){this.element=e}ngAfterViewInit(){this.element.nativeElement.focus()}}return n.\u0275fac=function(e){return new(e||n)(Q(v2))},n.\u0275dir=qt({type:n,selectors:[["","autofocus",""]]}),n})(),i4e=(()=>{class n{constructor(e){this.shown=!1,this.input=e.nativeElement.parentNode.previousSibling,e.nativeElement.addEventListener("click",r=>{this.toggle()})}toggle(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return n.\u0275fac=function(e){return new(e||n)(Q(v2))},n.\u0275dir=qt({type:n,selectors:[["","toggleVisibility",""]]}),n})();function K7t(n,t){if(1&n&&(O(0,"div",29)(1,"div",30),ve(2,31),A(),O(3,"div",32),Tt(4),A()()),2&n){const e=C();T(4),a1(e.errorMessage)}}const X7t=function(){return["/register"]},Q7t=function(){return["/reset-password"]};let J7t=(()=>{class n{constructor(e,r){this.router=e,this.connectedUserService=r,this.faEye=WV,this.loginForm=new w0({email:new qa,password:new qa})}ngOnInit(){var e=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var r=I(function*(s){s!==w5.NOT_CONNECTED&&(yield e.redirect())});return function(s){return r.apply(this,arguments)}}())}loginWithEmail(e){var r=this;return I(function*(){const s=yield r.connectedUserService.doEmailLogin(e.email,e.password);s.isFailure()&&(r.errorMessage=s.getReason())})()}loginWithGoogle(){var e=this;return I(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isFailure()&&(e.errorMessage=r.getReason())})()}redirect(){var e=this;return I(function*(){return e.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(Kn),Q(Ns))},n.\u0275cmp=ut({type:n,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E;return t=$localize`Log in`,e=$localize`Email`,r=$localize`Email`,s=$localize`Password`,i=$localize`Password`,o=$localize`Log in`,c=$localize`Log in with Google`,u=$localize`No account?`,h=$localize`Register`,g=$localize`Forgot your password?`,m=$localize`Reset your password`,E=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",r,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",i,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],o,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],u,[3,"routerLink"],h,g,m,["role","alert",1,"message","is-danger"],[1,"message-header"],E,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),ve(7,7),A()(),O(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),A()()()(),O(12,"div",4)(13,"div",5)(14,"label",12),ve(15,13),A()(),O(16,"div",8)(17,"div",9)(18,"div",14),X(19,"input",15),O(20,"span",16),X(21,"fa-icon",17),A()()()()(),O(22,"div",4),X(23,"div",5),O(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),ee("click",function(){return r.loginWithEmail(r.loginForm.value)}),ve(28,19),A()()()()(),O(29,"div",4),X(30,"div",5),O(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),ee("click",function(){return r.loginWithGoogle()}),ve(35,21),A()()()()(),x(36,K7t,5,1,"div",22),O(37,"p",23),hn(38),ve(39,24),dn(),Tt(40,"\xa0 "),O(41,"a",25),ve(42,26),A()(),O(43,"p",23),hn(44),ve(45,27),dn(),Tt(46,"\xa0 "),O(47,"a",25),ve(48,28),A()()()()),2&e&&(T(3),w("formGroup",r.loginForm),T(18),w("icon",r.faEye),T(6),w("disabled",!r.canLogin()),T(9),w("ngIf",r.errorMessage),T(5),w("routerLink",J1(6,X7t)),T(6),w("routerLink",J1(7,Q7t)))},dependencies:[Xt,Vu,Iu,S4,zl,Nu,Lu,xu,Ef,I5,eF,i4e],encapsulation:2}),n})(),eft=(()=>{class n{constructor(e){this.partDAO=e}subscribeToActiveParts(e){let r=[];const c=new NS(u=>{r=r.concat(...u),e(r)},u=>{const h=r;for(const g of u)h.forEach(m=>{m.id===g.id&&(m.data=g.data)});r=h,e(r)},u=>{const h=[];for(const g of r)u.some(m=>m.id===g.id)||h.push(g);r=h,e(r)});return this.partDAO.observingWhere([["result","==",E1.UNACHIEVED.value]],c)}}return n.\u0275fac=function(e){return new(e||n)(Ve(Kz))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),tft=(()=>{class n{transform(e){return gG(1e3*e.seconds,"HH:mm:ss","en-US")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=ai({name:"firestoreTime",type:n,pure:!0}),n})();const nft=["chatDiv"];function rft(n,t){1&n&&(hn(0),ve(1,5),dn())}function sft(n,t){1&n&&ve(0,6),2&n&&(y1(C().unreadMessagesText),A1(0))}function ift(n,t){if(1&n){const e=Ae();O(0,"button",11),ee("click",function(){return he(e),le(C(2).scrollToBottom())}),Tt(1),A()}if(2&n){const e=C(2);T(1),Hi("",e.unreadMessagesText," \u2193")}}function oft(n,t){if(1&n&&(O(0,"p"),Tt(1),b3(2,"firestoreTime"),O(3,"b",12),Tt(4),A(),O(5,"span",13),Tt(6),A()()),2&n){const e=t.$implicit;T(1),Hi(" [",_4(2,3,e.postedTime),"] "),T(3),Hi("",e.sender.name," : "),T(2),a1(e.content)}}function aft(n,t){if(1&n){const e=Ae();O(0,"div"),x(1,ift,2,1,"button",7),O(2,"div",8,9),ee("scroll",function(){return he(e),le(C().updateCurrentScrollPosition())}),x(4,oft,7,5,"p",10),A()()}if(2&n){const e=C();T(1),w("ngIf",e.showUnreadMessagesButton),T(3),w("ngForOf",e.chat)}}const cft=function(){return{standalone:!0}};function lft(n,t){if(1&n){const e=Ae();O(0,"form",14),ee("onSubmit",function(){return he(e),le(C().sendMessage())}),O(1,"div",15)(2,"div",16)(3,"input",17,18),ee("ngModelChange",function(s){return he(e),le(C().userMessage=s)}),A(),O(5,"p",19),Tt(6),A()(),O(7,"div",20)(8,"button",21),ee("click",function(){return he(e),le(C().sendMessage())}),X(9,"fa-icon",22),A()()(),O(10,"div",23)(11,"p")(12,"strong"),ve(13,24),A()()()()}if(2&n){const e=Fn(4),r=C();T(3),w("ngModel",r.userMessage)("ngModelOptions",J1(4,cft)),T(3),Hi("",e.value.length,"/128"),T(3),w("icon",r.faReply)}}let o4e=(()=>{class n{constructor(e,r){this.chatService=e,this.connectedUserService=r,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=IV,this.isNearBottom=!0,this.notYetScrolled=!0,J(n.VERBOSE,"ChatComponent constructor")}ngOnInit(){J(n.VERBOSE,`ChatComponent.ngOnInit for chat ${this.chatId}`),Le(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=s=>{this.updateMessages(s.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},r=new NS(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,r)}updateMessages(e){this.chat=this.chat.concat(e);const r=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=r,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(r-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return I(function*(){const r=e.userMessage;e.userMessage="";const s=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,s,r,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(OS),Q(Ns))},n.\u0275cmp=ut({type:n,selectors:[["app-chat"]],viewQuery:function(e,r){if(1&e&&y0(nft,5),2&e){let s;v4(s=C4())&&(r.chatDiv=s.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let t,e,r,s;return t=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,r=$localize`Type your message here`,s=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],t,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",r,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],s]},template:function(e,r){if(1&e&&(O(0,"div")(1,"button",0),ee("click",function(){return r.switchChatVisibility()}),x(2,rft,2,0,"ng-container",1),x(3,sft,1,1,"ng-template",null,2,Gn),A(),x(5,aft,5,2,"div",3),x(6,lft,14,5,"form",4),A()),2&e){const s=Fn(4);T(2),w("ngIf",r.visible)("ngIfElse",s),T(3),w("ngIf",r.visible),T(1),w("ngIf",r.visible)}},dependencies:[On,Xt,Iu,S4,zl,Nu,TA,bp,wp,I5,tft],encapsulation:2}),n})(),a4e=(()=>{class n{constructor(e,r,s){this.router=e,this.observedPartService=r,this.messageDisplayer=s}pickGame(e){this.selectedGame=e}navigateToOnlineGameCreation(){var e=this;return I(function*(){const r=e.observedPartService.canUserCreate();r.isSuccess()?yield e.router.navigate(["/play",e.selectedGame]):e.messageDisplayer.criticalMessage(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Kn),Q(L2),Q(Mn))},n.\u0275cmp=ut({type:n,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(O(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),A(),O(1,"button",1),ee("click",function(){return r.navigateToOnlineGameCreation()}),ve(2,2),A()),2&e&&(T(1),w("disabled",!r.selectedGame))},dependencies:[JH],encapsulation:2}),n})();function uft(n,t){if(1&n&&(hn(0),Tt(1),dn()),2&n){const e=C().$implicit;T(1),a1(e.data.playerOne.name)}}function fft(n,t){1&n&&(hn(0),ve(1,27),dn())}function hft(n,t){if(1&n){const e=Ae();O(0,"tr",22),ee("click",function(){const i=he(e).$implicit;return le(C(2).joinGame(i))}),O(1,"td",23),Tt(2),A(),O(3,"td",23),Tt(4),A(),O(5,"td",23),x(6,uft,2,1,"ng-container",24),x(7,fft,2,0,"ng-template",null,25,Gn),A(),O(9,"td",26),Tt(10),A()()}if(2&n){const e=t.$implicit,r=t.index,s=Fn(8);d1("id","part_",r,""),T(2),a1(e.data.typeGame),T(2),a1(e.data.playerZero.name),T(2),w("ngIf",e.data.playerOne)("ngIfElse",s),T(4),a1(e.data.turn+1)}}function dft(n,t){if(1&n&&(O(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),ve(6,17),A(),O(7,"th",16),ve(8,18),A(),O(9,"th",16),ve(10,19),A(),O(11,"th",16),ve(12,20),A()()(),O(13,"tbody"),x(14,hft,11,6,"tr",21),A()()()()),2&n){const e=C();T(14),w("ngForOf",e.activeParts)}}function pft(n,t){1&n&&(O(0,"div",28),X(1,"app-online-game-selection",29),A())}function gft(n,t){1&n&&(O(0,"div",30)(1,"div",31)(2,"div",32),X(3,"app-chat",33),A()()()),2&n&&(T(3),w("turn",-1))}let mft=(()=>{class n{constructor(e,r,s,i){this.router=e,this.messageDisplayer=r,this.activePartsService=s,this.observedPartService=i,this.activeParts=[],this.currentTab="games",this.createTabClasses=[]}ngOnInit(){J(n.VERBOSE,"lobbyComponent.ngOnInit"),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.observedPartService.subscribeToObservedPart(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){J(n.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activePartsSubscription.unsubscribe()}joinGame(e){var r=this;return I(function*(){const s=e.id,i=e.data.typeGame,c=r.observedPartService.canUserJoin(s,null!=e.data.beginning);c.isSuccess()?yield r.router.navigate(["/play",i,s]):r.messageDisplayer.criticalMessage(c.getReason())})()}selectTab(e){if("create"===e){const r=this.observedPartService.canUserCreate();r.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(r.getReason())}else this.currentTab=e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Kn),Q(Mn),Q(eft),Q(L2))},n.\u0275cmp=ut({type:n,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let t,e,r,s,i,o,c,u;return t=$localize`Games`,e=$localize`Create`,r=$localize`Chat`,s=$localize`Game`,i=$localize`First player`,o=$localize`Second player`,c=$localize`Turn`,u=$localize`Waiting for opponent`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],t,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],r,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],s,i,o,c,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],[1,"td","turn"],u,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],[1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),ee("click",function(){return r.selectTab("games")}),ve(4,3),A()(),O(5,"li",4)(6,"a",5),ee("click",function(){return r.selectTab("create")}),ve(7,6),A()(),O(8,"li",7)(9,"a",8),ee("click",function(){return r.selectTab("chat")}),ve(10,9),A()()()(),x(11,dft,15,1,"div",10),x(12,pft,2,0,"div",11),x(13,gft,4,1,"div",12)),2&e&&(T(6),w("ngClass",r.createTabClasses),T(5),w("ngIf","games"===r.currentTab),T(1),w("ngIf","create"===r.currentTab),T(1),w("ngIf","chat"===r.currentTab))},dependencies:[pn,On,Xt,o4e,a4e],encapsulation:2}),n})(),_ft=(()=>{class n{constructor(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ut({type:n,selectors:[["app-account"]],decls:11,vars:0,consts:function(){let t,e,r;return t=$localize`User settings`,e=$localize`If you forgot your password or want to change it, click on the following button:`,r=$localize`Reset password`,[[1,"hero-body"],[1,"title"],t,[1,"box"],[1,"block","level-left"],[1,"level-item"],e,["id","reset","routerLink","/reset-password",1,"button","is-primary","level-item","is-small"],r]},template:function(e,r){1&e&&(O(0,"div",0)(1,"p",1),ve(2,2),A()(),O(3,"div",3)(4,"p",1),Tt(5,"Resetting password"),A(),O(6,"div",4)(7,"p",5),ve(8,6),A(),O(9,"button",7),ve(10,8),A()()())},dependencies:[Of],encapsulation:2}),n})(),c4e=(()=>{class n{constructor(e){this.route=e,this.message=e.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return n.\u0275fac=function(e){return new(e||n)(Q(xo))},n.\u0275cmp=ut({type:n,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"div",1),ve(2,2),A(),O(3,"div",3),Tt(4),A()()),2&e&&(T(4),a1(r.message))},encapsulation:2}),n})();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const yft=new Error("request for lock canceled");class Mft{constructor(t,e=yft){this._value=t,this._cancelError=e,this._weightedQueues=[],this._weightedWaiters=[]}acquire(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);return new Promise((e,r)=>{this._weightedQueues[t-1]||(this._weightedQueues[t-1]=[]),this._weightedQueues[t-1].push({resolve:e,reject:r}),this._dispatch()})}runExclusive(t,e=1){return function(n,t,e,r){return new(e||(e=Promise))(function(i,o){function c(g){try{h(r.next(g))}catch(m){o(m)}}function u(g){try{h(r.throw(g))}catch(m){o(m)}}function h(g){g.done?i(g.value):function s(i){return i instanceof e?i:new e(function(o){o(i)})}(g.value).then(c,u)}h((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){const[r,s]=yield this.acquire(e);try{return yield t(r)}finally{s()}})}waitForUnlock(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);return new Promise(e=>{this._weightedWaiters[t-1]||(this._weightedWaiters[t-1]=[]),this._weightedWaiters[t-1].push(e),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(t){this._value=t,this._dispatch()}release(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);this._value+=t,this._dispatch()}cancel(){this._weightedQueues.forEach(t=>t.forEach(e=>e.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var t;for(let e=this._value;e>0;e--){const r=null===(t=this._weightedQueues[e-1])||void 0===t?void 0:t.shift();if(!r)continue;const s=this._value,i=e;this._value-=e,e=this._value+1,r.resolve([s,this._newReleaser(i)])}this._drainUnlockWaiters()}_newReleaser(t){let e=!1;return()=>{e||(e=!0,this.release(t))}}_drainUnlockWaiters(){for(let t=this._value;t>0;t--)!this._weightedWaiters[t-1]||(this._weightedWaiters[t-1].forEach(e=>e()),this._weightedWaiters[t-1]=[])}}class Pft{constructor(t){this._semaphore=new Mft(1,t)}acquire(){return function(n,t,e,r){return new(e||(e=Promise))(function(i,o){function c(g){try{h(r.next(g))}catch(m){o(m)}}function u(g){try{h(r.throw(g))}catch(m){o(m)}}function h(g){g.done?i(g.value):function s(i){return i instanceof e?i:new e(function(o){o(i)})}(g.value).then(c,u)}h((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){const[,t]=yield this._semaphore.acquire();return t})}runExclusive(t){return this._semaphore.runExclusive(()=>t())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}let u4e=(()=>{class n{constructor(){this.requestAwaitingReply=y.empty(),this.lastDeniedRequest=y.empty(),this.forbiddenRequests=new bt}onGameStart(){this.requestAwaitingReply=y.empty(),this.lastDeniedRequest=y.empty(),this.forbiddenRequests=new bt}onReceivedMove(){this.forbiddenRequests=new bt,this.lastDeniedRequest=y.empty()}onReceivedRequest(e){Se.assert(this.requestAwaitingReply.isAbsent(),"Should not receive two requests in a row!"),this.requestAwaitingReply=y.of(e)}onReceivedReply(e,r){var s=this;return I(function*(){switch(s.requestAwaitingReply=y.empty(),e.reply){case"Accept":return!0;case"Reject":return e.player===r.getOpponent().value&&(s.lastDeniedRequest=y.of(e.requestType),s.forbiddenRequests.add(e.requestType)),!1}})()}canMakeRequest(e){return!(this.requestAwaitingReply.isPresent()||this.forbiddenRequests.contains(e))}getRequestAwaitingReplyFrom(e){return this.requestAwaitingReply.isPresent()&&this.requestAwaitingReply.get().player===e.getOpponent().value?y.of(this.requestAwaitingReply.get().requestType):y.empty()}getCurrentRequest(){return this.requestAwaitingReply}deniedRequest(){return this.lastDeniedRequest}}return n.requestInfos={TakeBack:{requestType:"TakeBack",textForRequest:()=>$localize`Ask to take back one move`,textForReply:()=>$localize`Your opponent is asking for a take back.`,name:()=>$localize`take back`,icon:eH},Draw:{requestType:"Draw",textForRequest:()=>$localize`Propose a draw`,textForReply:()=>$localize`Your opponent is proposing a draw.`,name:()=>$localize`draw`,icon:pre},Rematch:{requestType:"Rematch",textForRequest:()=>$localize`Propose a rematch`,textForReply:()=>$localize`Your opponent is proposing a rematch.`,name:()=>$localize`rematch`,icon:Yre}},n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function f4e(n){return 1e3*n.seconds+n.nanoseconds/1e6}function h4e(n,t){return f4e(t)-f4e(n)}let wft=(()=>{class n{constructor(){this.configRoom=y.empty(),this.takenGlobalTime=[0,0],this.extraGlobalTime=[0,0],this.availableTurnTime=[0,0],this.lastMoveStartTimestamp=y.empty()}setClocks(e,r){this.turnClocks=e,this.globalClocks=r,this.allClocks=e.concat(r)}onGameStart(e){this.configRoom=y.of(e);for(const r of B.PLAYERS)this.takenGlobalTime[r.value]=0,this.extraGlobalTime[r.value]=0,this.availableTurnTime[r.value]=this.getMoveDurationInMs(),this.globalClocks[r.value].setDuration(this.getPartDurationInMs()),this.turnClocks[r.value].setDuration(this.getMoveDurationInMs());for(const r of this.allClocks)r.start(),r.pause()}getPartDurationInMs(){return 1e3*this.configRoom.get().totalPartDuration}getMoveDurationInMs(){return 1e3*this.configRoom.get().maximalMoveDuration}onReceivedAction(e){switch(e.action){case"AddTurnTime":this.addTurnTime(B.of(e.player));break;case"AddGlobalTime":this.addGlobalTime(B.of(e.player));break;case"StartGame":this.lastMoveStartTimestamp=y.of(e.time);break;case"EndGame":this.onGameEnd()}}onReceivedMove(e){const r=B.of(e.player),s=e.time,i=this.getMillisecondsElapsedSinceLastMoveStart(s);this.lastMoveStartTimestamp=y.of(s),this.takenGlobalTime[r.value]+=i,this.availableTurnTime[r.value]-=i;const o=r.getOpponent();this.availableTurnTime[o.value]=this.getMoveDurationInMs();const c=this.getPartDurationInMs()-this.takenGlobalTime[o.value];this.globalClocks[o.value].changeDuration(c)}getMillisecondsElapsedSinceLastMoveStart(e){return h4e(this.lastMoveStartTimestamp.get(),e)}onGameEnd(){for(const e of this.allClocks)e.isStarted()&&e.stop();this.updateClocks()}beforeEventsBatch(e){!1===e&&this.pauseAllClocks()}afterEventsBatch(e,r,s){if(this.updateClocks(),!1===e){const i=this.getMillisecondsElapsedSinceLastMoveStart(s);this.turnClocks[r.value].subtract(i),this.globalClocks[r.value].subtract(i),this.resumeClocks(r)}}resumeClocks(e){this.turnClocks[e.value].resume(),this.globalClocks[e.value].resume()}addTurnTime(e){this.availableTurnTime[e.getOpponent().value]+=3e4}addGlobalTime(e){this.extraGlobalTime[e.getOpponent().value]+=3e5}updateClocks(){for(const e of B.PLAYERS){this.turnClocks[e.value].changeDuration(this.availableTurnTime[e.value]);const r=this.getPartDurationInMs()+this.extraGlobalTime[e.value]-this.takenGlobalTime[e.value];this.globalClocks[e.value].changeDuration(r)}}pauseAllClocks(){for(const e of this.allClocks)!1===e.isIdle()&&e.pause()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function o_(n){return fr((t,e)=>{mo(n).subscribe(as(e,()=>e.complete(),go)),!e.closed&&t.subscribe(e)})}let bft=(()=>{class n{transform(e){const r=e%60,s=(e-r)%3600/60,i=(e-60*s-r)/3600,o=[];if(i>1?o.push($localize`${i} hours`):1===i&&o.push($localize`1 hour`),s>1?o.push($localize`${s} minutes`):1===s&&o.push($localize`1 minute`),r>1?o.push($localize`${r} seconds`):1===r&&o.push($localize`1 second`),0===o.length)return $localize`0 seconds`;if(1===o.length)return o[0];{const c=o.slice(0,-1).join(", "),u=o.slice(-1)[0];return $localize`${c} and ${u}`}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=ai({name:"humanDuration",type:n,pure:!0}),n})();function Oft(n,t){if(1&n&&(hn(0),Tt(1),dn()),2&n){const e=C(3);T(1),a1(e.viewInfo.chosenOpponent)}}function Aft(n,t){1&n&&ve(0,44)}function Nft(n,t){if(1&n&&(O(0,"div",45)(1,"div",8)(2,"label",46),hn(3),ve(4,47),dn(),O(5,"output"),Tt(6),b3(7,"humanDuration"),A()(),O(8,"div",37),X(9,"input",48),A()(),O(10,"div",8)(11,"label",49),ha(12,50),X(13,"output"),b3(14,"humanDuration"),da(),A(),O(15,"div",37),X(16,"input",51),A()()()),2&n){const e=C(3);T(6),a1(_4(7,2,e.viewInfo.maximalMoveDuration||0)),T(8),y1(_4(14,4,e.viewInfo.totalPartDuration||0)),A1(12)}}function Ift(n,t){1&n&&(O(0,"div"),ha(1,52),X(2,"br"),da(),A())}function xft(n,t){1&n&&(O(0,"button",64),ve(1,65),A())}function kft(n,t){if(1&n){const e=Ae();O(0,"tr",60),ee("click",function(){const i=he(e).$implicit;return le(C(4).selectOpponent(i))}),O(1,"td",61),Tt(2),A(),O(3,"td",62),x(4,xft,2,0,"button",63),A()()}if(2&n){const e=t.$implicit,r=C(4);d1("id","presenceOf_",e,""),w("ngClass",r.viewInfo.candidateClasses[e]),T(1),w("id",r.viewInfo.chosenOpponent===e?"selected_"+e:"candidate_"+e),T(1),a1(e),T(2),w("ngIf",r.viewInfo.chosenOpponent!==e)}}function Lft(n,t){if(1&n&&(hn(0),ve(1,53),dn(),O(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),ve(7,57),A(),O(8,"th",56),ve(9,58),A()()(),O(10,"tbody"),x(11,kft,5,5,"tr",59),A()()()),2&n){const e=C(3);T(11),w("ngForOf",e.viewInfo.candidates)}}function Rft(n,t){if(1&n){const e=Ae();O(0,"button",66),ee("click",function(){return he(e),le(C(3).changeConfig())}),ve(1,67),A()}}function Dft(n,t){if(1&n){const e=Ae();O(0,"div")(1,"h1",4),ve(2,5),A(),O(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),ve(7,10),A(),O(8,"div",11)(9,"button",12),ee("click",function(){return he(e),le(C(2).selectFirstPlayer("RANDOM"))}),ve(10,13),A(),O(11,"button",14),ee("click",function(){return he(e),le(C(2).selectFirstPlayer("CREATOR"))}),ve(12,15),A(),O(13,"button",16),ee("click",function(){return he(e),le(C(2).selectFirstPlayer("CHOSEN_PLAYER"))}),x(14,Oft,2,1,"ng-container",17),x(15,Aft,1,0,"ng-template",null,18,Gn),A()()(),O(17,"div",8)(18,"label",9),ve(19,19),A(),O(20,"div",11)(21,"div",20),ee("click",function(){return he(e),le(C(2).selectPartType("STANDARD"))}),O(22,"div",21)(23,"span"),ve(24,22),A()(),O(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),hn(29),ve(30,26),dn(),O(31,"strong"),Tt(32),b3(33,"humanDuration"),A(),X(34,"br"),hn(35),ha(36,27),X(37,"strong"),b3(38,"humanDuration"),da(),dn(),A()()()()(),O(39,"div",28),ee("click",function(){return he(e),le(C(2).selectPartType("BLITZ"))}),O(40,"div",21)(41,"span"),ve(42,29),A()(),O(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),hn(47),ve(48,30),dn(),O(49,"strong"),Tt(50),b3(51,"humanDuration"),A(),X(52,"br"),hn(53),ha(54,31),X(55,"strong"),b3(56,"humanDuration"),da(),dn(),A()()()()(),O(57,"button",32),ee("click",function(){return he(e),le(C(2).selectPartType("CUSTOM"))}),ve(58,33),A()()(),x(59,Nft,17,6,"div",34),O(60,"div",8)(61,"label",35),ve(62,36),A(),O(63,"div",37),x(64,Ift,3,0,"div",17),x(65,Lft,12,1,"ng-template",null,38,Gn),A()()(),O(67,"div",8)(68,"div",11)(69,"button",39),ee("click",function(){return he(e),le(C(2).proposeConfig())}),ve(70,40),A(),x(71,Rft,2,0,"button",41),O(72,"button",42),ee("click",function(){return he(e),le(C(2).cancelGameCreation())}),ve(73,43),A()()()()()}if(2&n){const e=Fn(16),r=Fn(66),s=C(2);T(3),w("formGroup",s.configFormGroup),T(1),w("disabled",!s.viewInfo.canEditConfig),T(5),w("ngClass",s.viewInfo.firstPlayerClasses.RANDOM),T(2),w("ngClass",s.viewInfo.firstPlayerClasses.CREATOR),T(2),w("ngClass",s.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),T(1),w("ngIf",s.viewInfo.chosenOpponent)("ngIfElse",e),T(7),w("ngClass",s.viewInfo.partTypeClasses.STANDARD),T(11),a1(_4(33,19,s.partType.NORMAL_MOVE_DURATION)),T(6),y1(_4(38,21,s.partType.NORMAL_PART_DURATION)),A1(36),T(1),w("ngClass",s.viewInfo.partTypeClasses.BLITZ),T(11),a1(_4(51,23,s.partType.BLITZ_MOVE_DURATION)),T(6),y1(_4(56,25,s.partType.BLITZ_PART_DURATION)),A1(54),T(1),w("ngClass",s.viewInfo.partTypeClasses.CUSTOM),T(2),w("ngIf",s.viewInfo.showCustomTime),T(5),w("ngIf",0===s.viewInfo.candidates.length)("ngIfElse",r),T(5),w("disabled",!s.viewInfo.canProposeConfig),T(2),w("ngIf",s.viewInfo.canReviewConfig)}}function zft(n,t){if(1&n&&(O(0,"div",74)(1,"p"),ha(2,75),X(3,"br"),da(),A()()),2&n){const e=C(3);T(3),y1(e.viewInfo.creator),A1(2)}}function Vft(n,t){if(1&n&&(O(0,"span"),ve(1,81),A()),2&n){const e=C(4);T(1),y1(e.viewInfo.creator),A1(1)}}function Hft(n,t){1&n&&(O(0,"span"),ve(1,82),A())}function Fft(n,t){1&n&&(O(0,"span"),ve(1,83),A())}function Bft(n,t){if(1&n){const e=Ae();O(0,"div",74)(1,"p"),ve(2,76),A(),O(3,"ul")(4,"li"),x(5,Vft,2,1,"span",2),x(6,Hft,2,0,"span",2),x(7,Fft,2,0,"span",2),A(),O(8,"li"),ha(9,77),X(10,"strong"),b3(11,"humanDuration"),da(),A(),O(12,"li"),ha(13,78),X(14,"strong"),b3(15,"humanDuration"),da(),A()(),O(16,"button",79),ee("click",function(){return he(e),le(C(3).acceptConfig())}),ve(17,80),A()()}if(2&n){const e=C(3);T(2),y1(e.viewInfo.creator)(e.viewInfo.partTypeName),A1(2),T(3),w("ngIf","CREATOR"===e.viewInfo.firstPlayer),T(1),w("ngIf","CHOSEN_PLAYER"===e.viewInfo.firstPlayer),T(1),w("ngIf","RANDOM"===e.viewInfo.firstPlayer),T(4),y1(_4(11,7,e.viewInfo.maximalMoveDuration||0)),A1(9),T(4),y1(_4(15,9,e.viewInfo.totalPartDuration||0)),A1(13)}}function $ft(n,t){if(1&n&&(O(0,"div")(1,"div",68)(2,"div",69)(3,"p"),ve(4,70),A()(),O(5,"div",71),x(6,zft,4,1,"div",72),x(7,Bft,18,11,"ng-template",null,73,Gn),A()()()),2&n){const e=Fn(8),r=C(2);T(6),w("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function Uft(n,t){if(1&n&&(hn(0),ve(1,86),dn()),2&n){const e=C(3);T(1),y1(e.viewInfo.creator),A1(1)}}function Gft(n,t){if(1&n&&ve(0,87),2&n){const e=C(3);y1(e.viewInfo.creator)(e.viewInfo.chosenOpponent),A1(0)}}function qft(n,t){if(1&n&&(O(0,"div",68)(1,"div",69)(2,"p"),ve(3,84),A()(),O(4,"div",71)(5,"p"),x(6,Uft,2,1,"ng-container",17),x(7,Gft,1,2,"ng-template",null,85,Gn),A()()()),2&n){const e=Fn(8),r=C(2);T(6),w("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function Wft(n,t){if(1&n&&(O(0,"div",1),x(1,Dft,74,27,"div",2),x(2,$ft,9,2,"div",2),x(3,qft,9,2,"div",3),A()),2&n){const e=C();T(1),w("ngIf",e.viewInfo.userIsCreator),T(1),w("ngIf",e.viewInfo.userIsChosenOpponent),T(1),w("ngIf",e.viewInfo.userIsObserver)}}class u1{constructor(t,e,r,s,i,o,c,u,h,g){this.router=t,this.actRoute=e,this.connectedUserService=r,this.observedPartService=s,this.gameService=i,this.configRoomService=o,this.chatService=c,this.userService=u,this.formBuilder=h,this.messageDisplayer=g,this.partType=br,this.gameStartNotification=new hr,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new q2,this.allUserInterval=y.empty(),this.ownTokenInterval=y.empty(),this.selfSubscription=new H1,this.configRoomSubscription=new H1,this.candidatesSubscription=new H1,this.allDocDeleted=!1,J(u1.VERBOSE,"PartCreationComponent constructed")}ngOnInit(){var t=this;return I(function*(){J(u1.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms();const e=yield t.configRoomService.joinGame(t.partId);if(e.isFailure()){const r=e.getReason();t.messageDisplayer.criticalMessage(r)}else yield t.startSendingPresenceTokens(),t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),J(u1.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds")})()}checkInputs(){const t=this.connectedUserService.user;Le(t.isPresent(),"PartCreationComponent should not be called without connected user"),Le(t.get()!==w5.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),Le(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[Zs.RANDOM.value,Ep.required],maximalMoveDuration:[br.NORMAL_MOVE_DURATION,Ep.required],partType:["STANDARD",Ep.required],totalPartDuration:[br.NORMAL_PART_DURATION,Ep.required],chosenOpponent:["",Ep.required]})}updateUserDocWithObservedPart(t){J(u1.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'");const e=this.getUserRoleInPart(t),r={id:this.partId,opponent:this.getOpponent(),typeGame:Se.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:e};return this.observedPartService.updateObservedPart(r)}getUserRoleInPart(t){const e=this.connectedUserService.user.get().id;return e===t.creator.id?"Creator":e===t.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let t=null;return t=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:Se.getNonNullable(this.currentConfigRoom?.creator),t}subscribeToConfigRoomDoc(){var t=this;const e=function(){var s=I(function*(i){yield t.onCurrentConfigRoomUpdate(i)});return function(o){return s.apply(this,arguments)}}(),r=function(){var s=I(function*(i){yield t.onCandidatesUpdate(i)});return function(o){return s.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,e),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}getForm(t){return Se.getNonNullable(this.configFormGroup.get(t))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(o_(this.ngUnsubscribe)).subscribe(t=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[t]=["is-selected"],this.viewInfo.chosenOpponent=t;const e=Se.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=e!==Ys.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(o_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],this.viewInfo.partType=t,this.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(o_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(o_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(o_(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],this.viewInfo.firstPlayer=t})}updateViewInfo(){const t=Se.getNonNullable(this.currentConfigRoom),e=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=t.partStatus===Ys.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=t.partStatus!==Ys.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(t),this.viewInfo.userIsChosenOpponent=e.id===t.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=t.partStatus!==Ys.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=t.creator.name,this.viewInfo.candidates=this.candidates.map(r=>r.name),this.userIsCreator(t)?this.setDataForCreator(t):(this.viewInfo.maximalMoveDuration=t.maximalMoveDuration,this.viewInfo.totalPartDuration=t.totalPartDuration,this.viewInfo.partType=t.partType,this.viewInfo.chosenOpponent=t.chosenOpponent?.name,this.viewInfo.firstPlayer=t.firstPlayer),t.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(t){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??t.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??t.totalPartDuration;let e=this.viewInfo.chosenOpponent;null==e||""===e?e=t.chosenOpponent?.name??"":!1===this.candidates.some(s=>s.name===e)&&(e=""),this.getForm("chosenOpponent").setValue(e)}selectFirstPlayer(t){this.getForm("firstPlayer").setValue(t)}selectPartType(t){"STANDARD"===t?(this.getForm("maximalMoveDuration").setValue(br.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(br.NORMAL_PART_DURATION)):"BLITZ"===t&&(this.getForm("maximalMoveDuration").setValue(br.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(br.BLITZ_PART_DURATION)),this.getForm("partType").setValue(t)}selectOpponent(t){var e=this;return I(function*(){J(u1.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")");const r=e.getUserFromName(t);yield Promise.all([e.observedPartService.updateObservedPart({opponent:r}),e.configRoomService.setChosenOpponent(e.partId,r)])})()}getUserFromName(t){const e=this.candidates.find(r=>r.name===t);return Se.getNonNullable(e)}changeConfig(){var t=this;return I(function*(){return t.configRoomService.reviewConfig(t.partId)})()}proposeConfig(){var t=this;return I(function*(){const e=t.getForm("chosenOpponent").value,r=t.getForm("partType").value,s=t.getForm("maximalMoveDuration").value,i=t.getForm("firstPlayer").value,o=t.getForm("totalPartDuration").value,c=t.getUserFromName(e);return t.configRoomService.proposeConfig(t.partId,c,br.of(r),s,Zs.of(i),o)})()}cancelGameCreation(){var t=this;return I(function*(){t.allDocDeleted=!0,yield t.observedPartService.removeObservedPart(),J(u1.VERBOSE,"PartCreationComponent.cancelGameCreation"),yield t.chatService.deleteChat(t.partId),J(u1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),yield t.gameService.deletePart(t.partId),J(u1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),yield t.configRoomService.deleteConfigRoom(t.partId,t.candidates),J(u1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(t){var e=this;return I(function*(){if(J(u1.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(e.currentConfigRoom),then:JSON.stringify(t)}}),t.isAbsent())return J(u1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),e.onGameCancelled();{const r=t.get();if(e.chosenOpponentJustLeft(r)&&e.userIsCreator(r)){const i=Se.getNonNullable(e.currentConfigRoom),o=Se.getNonNullable(i.chosenOpponent).name;e.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield e.observedPartService.updateObservedPart({opponent:null})}let s=!1;e.userJustChosenAsOpponent(r)&&(yield e.updateUserDocWithObservedPart(r),s=!0),e.currentConfigRoom=r,e.allUserInterval.isAbsent()&&(Le(!1===s,"Expected observedPartUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield e.updateUserDocWithObservedPart(e.currentConfigRoom),yield e.observeNeededPlayers()),e.updateViewInfo(),e.isGameStarted(e.currentConfigRoom)&&(J(u1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),e.onGameStarted())}})()}onCandidatesUpdate(t){var e=this;return I(function*(){e.candidates=t,e.updateViewInfo()})()}userJustChosenAsOpponent(t){if(this.isGameStarted(t))return!1;const e=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==e&&t.chosenOpponent?.id===e}chosenOpponentJustLeft(t){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==t.chosenOpponent)}onGameCancelled(){var t=this;return I(function*(){J(u1.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield t.router.navigate(["/lobby"])})()}isGameStarted(t){return Le(null!=t,"configRoom should not be null (isGameStarted)"),Se.getNonNullable(t).partStatus===Ys.PART_STARTED.value}onGameStarted(){const t=Se.getNonNullable(this.currentConfigRoom);J(u1.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,J(u1.VERBOSE,"PartCreationComponent.onGameStarted finished")}observeNeededPlayers(){var t=this;return I(function*(){const e=Se.getNonNullable(t.currentConfigRoom);J(u1.VERBOSE,{PartCreationComponent_observeNeededPlayers:{configRoom:e}}),Le(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),t.allUserInterval=y.of(window.setInterval(I(function*(){const r=t.lastToken;t.userIsCreator(e)?yield t.checkCandidatesTokensFreshness(r):yield t.checkCreatorTokenFreshness(r)}),u1.TOKEN_INTERVAL))})()}userIsCreator(t){return this.connectedUserService.user.get().id===t.creator.id}checkCreatorTokenFreshness(t){var e=this;return I(function*(){const r=Se.getNonNullable(e.currentConfigRoom);(yield e.didUserTimeout(r.creator.id,t))&&(yield e.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var t=this;return I(function*(){Le(!1===t.isGameStarted(t.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),Le(!1===t.allDocDeleted,"Should not delete doc twice"),yield t.cancelGameCreation()})()}checkCandidatesTokensFreshness(t){var e=this;return I(function*(){for(const r of e.candidates)(yield e.didUserTimeout(r.id,t))&&(yield e.removeCandidateFromLobby(r))})()}didUserTimeout(t,e){var r=this;return I(function*(){const s=yield r.userService.getUserLastUpdateTime(t);return s.isAbsent()?(As.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):h4e(s.get(),e)>u1.TOKEN_TIMEOUT})()}removeCandidateFromLobby(t){var e=this;return I(function*(){const r=Se.getNonNullable(e.currentConfigRoom);return t.id===r.chosenOpponent?.id&&(yield e.configRoomService.reviewConfigAndRemoveChosenOpponent(e.partId)),e.configRoomService.removeCandidate(e.partId,t)})()}startSendingPresenceTokens(){var t=this;return I(function*(){yield t.connectedUserService.sendPresenceToken(),Le(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=y.of(window.setInterval(()=>{t.connectedUserService.sendPresenceToken()},u1.TOKEN_INTERVAL));const e=t.connectedUserService.user.get().id;t.selfSubscription=t.userService.observeUser(e,r=>{Le(r.isPresent(),"connected user should exist");const s=r.get();null!=s.lastUpdateTime&&(t.lastToken=s.lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=y.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return J(u1.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,Se.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var t=this;return I(function*(){J(u1.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded();const e=t.connectedUserService.user.get();!0!==t.gameStarted&&(null===t.currentConfigRoom?J(u1.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"):!0===t.allDocDeleted?J(u1.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"):e.id===t.currentConfigRoom.creator.id?(J(u1.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),yield t.cancelGameCreation()):(J(u1.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),yield t.observedPartService.removeObservedPart(),yield t.configRoomService.cancelJoining(t.partId)))})()}}function jft(n,t){if(1&n){const e=Ae();O(0,"button",3),ee("click",function(){return he(e),le(C().addTime())}),ve(1,4),A()}if(2&n){const e=C();T(1),y1(e.timeToAdd),A1(1)}}u1.VERBOSE=!1,u1.TOKEN_INTERVAL=5e3,u1.TOKEN_TIMEOUT=2*u1.TOKEN_INTERVAL,u1.\u0275fac=function(t){return new(t||u1)(Q(Kn),Q(xo),Q(Ns),Q(L2),Q(IS),Q(Qz),Q(OS),Q(Cm),Q(C7e),Q(Mn))},u1.\u0275cmp=ut({type:u1,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let n,t,e,r,s,i,o,c,u,h,g,m,E,b,k,U,j,oe,ye,te,ke,Ge,Xe,Bt,V1,N1,bn,S6,Qc,Aa,P6,T6,Mt,Wt,en,s1;return n=$localize`Game creation`,t=$localize`First player`,e=$localize`Random`,r=$localize`You`,s=$localize`Game type`,i=$localize`Standard`,o=$localize`Maximal turn duration: `,c=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,u=$localize`Blitz`,h=$localize`Maximal turn duration: `,g=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,m=$localize`Custom`,E=$localize`Opponents`,b=$localize`Propose configuration`,k=$localize`Cancel game`,U=$localize`The opponent`,j=$localize`Maximal turn duration: `,oe=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,ye=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,te=$localize`Click on the opponent against which you would like to play.`,ke=$localize`Name`,Ge=$localize`Actions`,Xe=$localize`Pick`,Bt=$localize`Change configuration`,V1=$localize`Configuration proposal`,N1=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,bn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,S6=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,Qc=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,Aa=$localize`Accept and start`,P6=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,T6=$localize`you play first`,Mt=$localize`the first player is selected randomly`,Wt=$localize`One moment...`,en=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,s1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],n,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],t,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],e,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],r,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],s,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],i,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,c,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],u,h,g,["id","partTypeCustom",1,"button",3,"ngClass","click"],m,["id","customTime",4,"ngIf"],[1,"label"],E,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],b,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],k,U,["id","customTime"],["for","maximalMoveDuration",1,"label"],j,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],oe,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],ye,te,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],ke,Ge,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],Xe,["id","reviewConfig",1,"button",3,"click"],Bt,[1,"message","is-primary"],[1,"message-header"],V1,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],N1,bn,S6,Qc,["id","acceptConfig",1,"button","is-primary",3,"click"],Aa,P6,T6,Mt,Wt,["proposalSent",""],en,s1]},template:function(t,e){1&t&&x(0,Wft,4,3,"div",0),2&t&&w("ngIf",e.viewInfo)},dependencies:[pn,On,Xt,Iu,S4,$y,zl,Nu,xu,Ef,bft],encapsulation:2});let Zft=(()=>{class n{constructor(){this.timeoutHandleGlobal=null,this.timeoutHandleSec=null,this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new hr,this.addTimeToOpponent=new hr,this.cssClasses=n.SAFE_TIME}ngOnInit(){J(n.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}setDuration(e){J(n.VERBOSE,this.debugName+".set("+e+"ms)"),Se.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){Se.assert(this.isPaused,"Should not change duration of a clock while it is running"),this.remainingMs=e,this.displayDuration()}subtract(e){this.changeDuration(this.remainingMs-e)}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){J(n.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),Se.assert(this.isSet,"Should not start a chrono that has not been set!"),Se.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){J(n.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),Se.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){J(n.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){J(n.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),Se.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),Se.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){J(n.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),Se.assert(this.started,"Should only stop chrono that are started!"),!1===this.isPaused&&this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?n.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?n.DANGER_TIME_ODD:n.DANGER_TIME_EVEN:n.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){J(n.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}}return n.VERBOSE=!1,n.DANGER_TIME_EVEN="has-background-danger has-text-white",n.DANGER_TIME_ODD="has-background-warning has-text-white",n.PASSIVE_STYLE="has-text-passive is-italic",n.SAFE_TIME="",n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ut({type:n,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let t;return t=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],t]},template:function(e,r){1&e&&(O(0,"div",0)(1,"p",1),Tt(2),b3(3,"number"),A(),x(4,jft,2,1,"button",2),A()),2&e&&(w("ngClass",r.getTimeClass()),T(2),eO("",r.displayedMinute,":",rU(3,4,r.displayedSec,"2.0-0"),""),T(2),w("ngIf",r.canAddTime))},dependencies:[pn,Xt,AG],encapsulation:2}),n})();const Yft=["chronoZeroGlobal"],Kft=["chronoOneGlobal"],Xft=["chronoZeroTurn"],Qft=["chronoOneTurn"];function Jft(n,t){if(1&n){const e=Ae();O(0,"app-part-creation",5,6),ee("gameStartNotification",function(s){return he(e),le(C().startGame(s))}),A()}2&n&&w("partId",C().currentPartId)}function eht(n,t){1&n&&(hn(0),O(1,"span",39),ve(2,40),A(),dn())}function tht(n,t){if(1&n&&(O(0,"span",41),ve(1,42),A()),2&n){const e=C(4);T(1),y1(null==e.currentPlayer?null:e.currentPlayer.name),A1(1)}}function nht(n,t){if(1&n&&(O(0,"p",36),x(1,eht,3,0,"ng-container",37),x(2,tht,2,1,"ng-template",null,38,Gn),A()),2&n){const e=Fn(3),r=C(3);T(1),w("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",e)}}function rht(n,t){if(1&n&&(O(0,"div",32)(1,"p",33),ve(2,34),A(),x(3,nht,4,2,"p",35),A()),2&n){const e=C(2);T(2),y1(e.currentPart.getTurn()+1),A1(2),T(1),w("ngIf",!1===e.endGame)}}function sht(n,t){if(1&n&&(O(0,"p",43),Tt(1),A()),2&n){const e=C(2);w("ngClass",e.getPlayerNameClass(e.Player.ZERO)),T(1),a1(e.players[0].get().name)}}function iht(n,t){if(1&n&&(O(0,"p",44),ve(1,45),A()),2&n){const e=C(2);T(1),y1(e.gameComponent.scores.get()[0]),A1(1)}}function oht(n,t){if(1&n&&(O(0,"p",46),Tt(1),A()),2&n){const e=C(2);w("ngClass",e.getPlayerNameClass(e.Player.ONE)),T(1),a1(e.players[1].get().name)}}function aht(n,t){if(1&n&&(O(0,"p",47),ve(1,48),A()),2&n){const e=C(2);T(1),y1(e.gameComponent.scores.get()[1]),A1(1)}}function cht(n,t){1&n&&(O(0,"div")(1,"p",50),ve(2,51),A()())}function lht(n,t){1&n&&(O(0,"p",55),ve(1,56),A())}function uht(n,t){1&n&&(O(0,"p",57),ve(1,58),A())}function fht(n,t){1&n&&(O(0,"p",59),ve(1,60),A())}function hht(n,t){if(1&n&&(O(0,"div"),x(1,lht,2,0,"p",52),x(2,uht,2,0,"p",53),x(3,fht,2,0,"p",54),A()),2&n){const e=C(3);T(1),w("ngIf",e.currentPart.getDrawAccepter().name===e.getPlayer().name),T(1),w("ngIf",e.currentPart.getDrawAccepter().name!==e.getPlayer().name&&e.isPlaying()),T(1),w("ngIf",!1===e.isPlaying())}}function dht(n,t){1&n&&(O(0,"p",64),ve(1,65),A())}function pht(n,t){1&n&&(O(0,"p",66),ve(1,67),A())}function ght(n,t){if(1&n&&(O(0,"p",68),ve(1,69),A()),2&n){const e=C(4);T(1),y1(e.currentPart.getWinner().get().name),A1(1)}}function mht(n,t){if(1&n&&(O(0,"div"),x(1,dht,2,0,"p",61),x(2,pht,2,0,"p",62),x(3,ght,2,1,"p",63),A()),2&n){const e=C(3);T(1),w("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),T(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),T(1),w("ngIf",!1===e.isPlaying())}}function _ht(n,t){if(1&n&&(O(0,"p",64),ve(1,70),A()),2&n){const e=C(4);T(1),y1(e.currentPart.getLoser().get().name),A1(1)}}function vht(n,t){1&n&&(O(0,"p",68),ve(1,71),A())}function Cht(n,t){if(1&n&&(O(0,"p",68),ve(1,72),A()),2&n){const e=C(4);T(1),y1(e.currentPart.getLoser().get().name),A1(1)}}function yht(n,t){if(1&n&&(O(0,"div"),x(1,_ht,2,1,"p",61),x(2,vht,2,0,"p",63),x(3,Cht,2,1,"p",63),A()),2&n){const e=C(3);T(1),w("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),T(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),T(1),w("ngIf",!1===e.isPlaying())}}function Eht(n,t){1&n&&(O(0,"p",74),ve(1,75),A())}function Mht(n,t){if(1&n&&(O(0,"p",74),ve(1,76),A()),2&n){const e=C(4);T(1),y1(e.currentPart.getLoser().get().name),A1(1)}}function Sht(n,t){if(1&n&&(O(0,"div"),x(1,Eht,2,0,"p",73),x(2,Mht,2,1,"p",73),A()),2&n){const e=C(3);T(1),w("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),T(1),w("ngIf",!1===e.isPlaying()||e.currentPart.getWinner().get().name===e.getPlayer().name)}}function Pht(n,t){if(1&n&&(O(0,"div",49),X(1,"hr"),x(2,cht,3,0,"div",27),x(3,hht,4,3,"div",27),x(4,mht,4,3,"div",27),x(5,yht,4,3,"div",27),x(6,Sht,3,2,"div",27),A()),2&n){const e=C(2);T(2),w("ngIf",e.currentPart.isHardDraw()),T(1),w("ngIf",e.currentPart.isAgreedDraw()),T(1),w("ngIf",e.currentPart.isWin()),T(1),w("ngIf",e.currentPart.isTimeout()),T(1),w("ngIf",e.currentPart.isResign())}}function Tht(n,t){if(1&n){const e=Ae();hn(0),O(1,"button",85),ee("click",function(){const i=he(e).$implicit;return le(C(4).propose(i))}),Tt(2),X(3,"fa-icon",86),A(),dn()}if(2&n){const e=t.$implicit,r=C(4);T(1),d1("id","propose",e,""),w("disabled",!1===r.requestAvailable(e)),T(1),Hi("",r.requestInfos[e].textForRequest(),"\xa0\xa0"),T(1),w("icon",r.requestInfos[e].icon)}}function wht(n,t){if(1&n){const e=Ae();hn(0),O(1,"button",80),ee("click",function(){return he(e),le(C(3).resign())}),ve(2,81),A(),O(3,"button",82),ee("click",function(){return he(e),le(C(3).gameComponent.pass())}),ve(4,83),A(),x(5,Tht,4,4,"ng-container",84),dn()}if(2&n){const e=C(3);T(1),w("disabled",!1===e.canResign()),T(2),w("disabled",!1===e.canPass()),T(2),w("ngForOf",e.allRequests)}}function bht(n,t){if(1&n){const e=Ae();O(0,"div",87)(1,"p"),Tt(2),X(3,"fa-icon",86),A(),O(4,"button",88),ee("click",function(){return he(e),le(C(3).accept())}),ve(5,89),A(),O(6,"button",90),ee("click",function(){return he(e),le(C(3).reject())}),ve(7,91),A()()}if(2&n){const e=C(3);T(2),Hi(" ",e.requestInfos[e.requestAwaitingReplyFromUs().get()].textForReply(),"\xa0\xa0 "),T(1),w("icon",e.requestInfos[e.requestAwaitingReplyFromUs().get()].icon)}}function Oht(n,t){if(1&n&&(O(0,"div",92)(1,"p")(2,"span"),ha(3,93),X(4,"fa-icon",86),da(),A()()()),2&n){const e=C(3);T(4),w("icon",e.requestInfos[e.deniedRequest().get()].icon),y1(e.requestInfos[e.deniedRequest().get()].name()),A1(3)}}function Aht(n,t){if(1&n&&(O(0,"div",94)(1,"p")(2,"span"),ha(3,95),X(4,"fa-icon",86),da(),A()()()),2&n){const e=C(3);T(4),w("icon",e.requestInfos[e.requestAwaitingReplyFromOpponent().get()].icon),y1(e.requestInfos[e.requestAwaitingReplyFromOpponent().get()].name()),A1(3)}}function Nht(n,t){if(1&n&&(hn(0),x(1,wht,6,3,"ng-container",37),x(2,bht,8,2,"ng-template",null,77,Gn),x(4,Oht,5,2,"div",78),x(5,Aht,5,2,"div",79),dn()),2&n){const e=Fn(3),r=C(2);T(1),w("ngIf",!1===r.mustReply())("ngIfElse",e),T(3),w("ngIf",r.deniedRequest().isPresent()),T(1),w("ngIf",r.requestAwaitingReplyFromOpponent().isPresent())}}function Iht(n,t){1&n&&(O(0,"button",96),ve(1,97),A())}function xht(n,t){if(1&n){const e=Ae();O(0,"div",7)(1,"div",8)(2,"div",9),x(3,rht,4,2,"div",10),O(4,"div",11),x(5,sht,2,2,"p",12),x(6,iht,2,1,"p",13),O(7,"app-count-down",14,15),ee("outOfTimeAction",function(){he(e);const s=C();return le(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return he(e),le(C().addGlobalTime())}),A(),O(9,"app-count-down",16,17),ee("outOfTimeAction",function(){he(e);const s=C();return le(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return he(e),le(C().addTurnTime())}),A()(),O(11,"p",18),ve(12,19),A(),O(13,"div",11),x(14,oht,2,2,"p",20),x(15,aht,2,1,"p",21),O(16,"app-count-down",22,23),ee("outOfTimeAction",function(){he(e);const s=C();return le(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return he(e),le(C().addGlobalTime())}),A(),O(18,"app-count-down",24,25),ee("outOfTimeAction",function(){he(e);const s=C();return le(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return he(e),le(C().addTurnTime())}),A()(),X(20,"hr"),x(21,Pht,7,5,"div",26),x(22,Nht,6,4,"ng-container",27),x(23,Iht,2,0,"button",28),A()(),O(24,"div",29)(25,"div",30),X(26,"div",null,31),A()()()}if(2&n){const e=C();T(3),w("ngIf",null!==e.currentPart),T(2),w("ngIf",e.players[0].isPresent()),T(1),w("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),T(1),w("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),T(2),w("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),T(5),w("ngIf",e.players[1].isPresent()),T(1),w("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),T(1),w("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),T(2),w("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),T(3),w("ngIf",e.endGame&&null!==e.currentPart),T(1),w("ngIf",e.isPlaying()),T(1),w("ngIf",e.endGame),T(1),w("ngClass",e.getBoardHighlight())}}let kht=(()=>{class n{}return n.NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`,n})(),Lht=(()=>{class n extends tT{constructor(e,r,s,i,o,c,u,h,g,m){super(e,r,s,i),this.observedPartService=o,this.userService=c,this.gameService=u,this.gameEventService=h,this.timeManager=g,this.requestManager=m,this.currentPart=null,this.gameStarted=!1,this.opponent=null,this.currentPlayer=null,this.observedPart=y.empty(),this.userLinkedToThisPart=!0,this.opponentSubscription=new H1,this.partSubscription=new H1,this.gameEventsSubscription=new H1,this.observedPartSubscription=new H1,this.OFFLINE_FONT_COLOR={color:"lightgrey"},this.globalTimeMessage=$localize`5 minutes`,this.turnTimeMessage=$localize`30 seconds`,this.requestInfos=u4e.requestInfos,this.allRequests=["TakeBack","Draw","Rematch"],J(n.VERBOSE,"OnlineGameWrapperComponent constructed")}getServerTime(){var e=this;return I(function*(){const r=e.connectedUserService.user.get().id;return new Promise(s=>{let i=!1;const c=e.userService.observeUser(r,u=>{null==u.get().lastUpdateTime?i=!0:i&&(c.unsubscribe(),s(u.get().lastUpdateTime))});e.userService.updatePresenceToken(r)})})()}extractPartIdFromURL(){return Se.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return Se.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}redirectIfPartOrGameIsInvalid(){var e=this;return I(function*(){const r=e.extractGameNameFromURL();if(qh.ALL_GAMES().some(i=>i.urlName===r)){if((yield e.gameService.getPartValidity(e.currentPartId,r)).isFailure()){e.routerEventsSubscription.unsubscribe();const o=kht.NO_MATCHING_PART();yield e.router.navigate(["/notFound",o],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=V5.NO_MATCHING_GAME(r);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSubscription=e.router.events.subscribe(function(){var r=I(function*(s){s instanceof x0&&(yield e.setCurrentPartIdOrRedirect())});return function(s){return r.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(r=>{e.authUser=r}),yield e.setCurrentPartIdOrRedirect(),e.observedPartSubscription=e.observedPartService.subscribeToObservedPart(function(){var r=I(function*(s){yield e.onObservedPartUpdate(s)});return function(s){return r.apply(this,arguments)}}()),J(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done")})()}onObservedPartUpdate(e){var r=this;return I(function*(){if(J(n.VERBOSE,"OnlineGameWrapperComponent.onObservedPartUpdate called"),e.isPresent()){const s=e.get();"Observer"===s.role||s.id===r.currentPartId?r.observedPart=e:(r.userLinkedToThisPart=!1,yield r.router.navigate(["/lobby"]))}else r.observedPart=y.empty()})()}startGame(e){var r=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),Se.assert(!1===r.gameStarted,"Should not start already started game"),r.configRoom=e,r.gameStarted=!0,window.setTimeout(I(function*(){const s=yield r.afterViewInit();r.timeManager.setClocks([r.chronoZeroTurn,r.chronoOneTurn],[r.chronoZeroGlobal,r.chronoOneGlobal]),Se.assert(s,"Game should be created successfully, otherwise part-creation would have redirected"),yield r.startPart()}),2)})()}startPart(){var e=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.startPart");const r=(yield e.gameService.getPart(e.currentPartId)).get();e.currentPart=new AS(e.currentPartId,r),e.partSubscription=e.gameService.subscribeToChanges(e.currentPartId,function(){var s=I(function*(i){Se.assert(i.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.currentPart=new AS(e.currentPartId,i.get())});return function(i){return s.apply(this,arguments)}}()),e.subscribeToEvents()})()}onGameStart(){var e=this;return I(function*(){yield e.initializePlayersDatas(e.currentPart);const r=e.gameComponent.getTurn();Se.assert(0===r,"turn should always be 0 upon game start"),e.timeManager.onGameStart(e.configRoom),e.requestManager.onGameStart()})()}subscribeToEvents(){var e=this;const r=new Pft,s=function(){var i=I(function*(o){yield r.runExclusive(I(function*(){e.beforeEventsBatch();for(const c of o)switch(c.eventType){case"Move":const u=c;yield e.onReceivedMove(u);break;case"Request":e.requestManager.onReceivedRequest(c);break;case"Reply":const g=c;(yield e.requestManager.onReceivedReply(g,e.role))&&(yield e.handleReply(g));break;default:Se.expectToBe(c.eventType,"Action","Event should be an action");const E=c;e.timeManager.onReceivedAction(E),"EndGame"===E.action?yield e.onGameEnd():"StartGame"===E.action&&(yield e.onGameStart())}yield e.afterEventsBatch()}))});return function(c){return i.apply(this,arguments)}}();this.gameEventsSubscription=this.gameEventService.subscribeToEvents(this.currentPartId,s)}handleReply(e){var r=this;return I(function*(){switch(e.requestType){case"TakeBack":const s=B.of(e.player);r.takeBackToPreviousPlayerTurn(s.getOpponent());break;case"Rematch":yield r.router.navigate(["/nextGameLoading"]);const i=r.extractGameNameFromURL();yield r.router.navigate(["/play",i,e.data])}})()}onGameEnd(){var e=this;return I(function*(){yield e.observedPartService.removeObservedPart(),e.endGame=!0})()}onReceivedMove(e){var r=this;return I(function*(){const s=r.gameComponent.rules,i=r.gameComponent.getTurn(),o=r.gameComponent.encoder.decode(e.move),c=s.isLegal(o,r.gameComponent.getState()),u="We received an incorrect db move: "+o.toString()+" at turn "+i+'because "'+c.getReasonOr("")+'"';Se.assert(c.isSuccess(),u);const h=s.choose(r.gameComponent.node,o);Se.assert(h.isPresent(),"Chosen move should be legal after all checks, but it is not!"),r.gameComponent.node=h.get(),r.updateBoardAndShowLastMove(),r.currentPlayer=r.players[r.gameComponent.getTurn()%2].get(),r.timeManager.onReceivedMove(e),r.requestManager.onReceivedMove()})()}beforeEventsBatch(){this.timeManager.beforeEventsBatch(this.endGame)}afterEventsBatch(){var e=this;return I(function*(){const r=B.fromTurn(e.gameComponent.getTurn());e.timeManager.afterEventsBatch(e.endGame,r,yield e.getServerTime())})()}takeBackToPreviousPlayerTurn(e){J(n.VERBOSE,"OnlineGameWrapperComponent.takeBackToPreviousPlayerTurn"),this.gameComponent.node=this.gameComponent.node.mother.get(),this.gameComponent.getCurrentPlayer()!==e&&(this.gameComponent.node=this.gameComponent.node.mother.get()),this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.updateBoardAndShowLastMove()}canResign(){return Se.assert(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}requestAvailable(e){switch(e){case"TakeBack":return this.canAskTakeBack();case"Draw":return this.canProposeDraw();default:return Se.expectToBe(e,"Rematch"),this.endGame}}mustReply(){return this.requestAwaitingReplyFromUs().isPresent()}requestAwaitingReplyFromUs(){return Se.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role)}requestAwaitingReplyFromOpponent(){return Se.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role.getOpponent())}deniedRequest(){return this.requestManager.deniedRequest()}canPass(){return Se.assert(this.isPlaying(),"Non playing should not call canPass"),!this.endGame&&this.currentPlayer?.name===this.getPlayer().name&&this.gameComponent.canPass}canAskTakeBack(){return Se.assert(this.isPlaying(),"Non playing should not call canAskTakeBack"),Se.assert(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(!0===this.endGame||Se.getNonNullable(this.currentPart).data.turn<=this.role.value)&&this.requestManager.canMakeRequest("TakeBack")}canProposeDraw(){return Se.assert(this.isPlaying(),"Non playing should not call canProposeDraw"),!this.endGame&&this.requestManager.canMakeRequest("Draw")}initializePlayersDatas(e){var r=this;return I(function*(){J(n.VERBOSE,{OnlineGameWrapper_initializePlayersDatas:e}),r.players=[y.of(e.data.playerZero),y.ofNullable(e.data.playerOne)],Se.assert(null!=e.data.playerOne,"should not initializePlayersDatas when players data is not received"),r.currentPlayer=r.players[e.data.turn%2].get();const s=yield r.setRealObserverRole();if(s.isPresent()){const i=o=>{Se.assert(o.isPresent(),"opponent was deleted, what sorcery is this"),r.opponent=s.get()};r.opponentSubscription=r.userService.observeUser(s.get().id,i)}})()}setRealObserverRole(){var e=this;return I(function*(){let r=y.empty();return e.players[0].equalsValue(e.getPlayer())?(e.setRole(B.ZERO),r=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(e.setRole(B.ONE),r=e.players[0]):e.setRole(pe.NONE),yield e.observedPartService.updateObservedPart({...e.observedPart.get(),role:e.role===pe.NONE?"Observer":"Player"}),r})()}onLegalUserMove(e,r){var s=this;return I(function*(){if(J(n.VERBOSE,"OnlineGameWrapperComponent.onLegalUserMove"),!s.mustReply()){const i=s.gameComponent.rules.isLegal(e,s.gameComponent.node.gameState);Se.assert(i.isSuccess(),"onLegalUserMove called with an illegal move");const o=s.gameComponent.rules.applyLegalMove(e,s.gameComponent.node.gameState,i.get()),c=new gr(o,y.of(s.gameComponent.node),y.of(e)),u=s.gameComponent.rules.getGameStatus(c),h=s.gameComponent.encoder.encodeMove(e);return yield s.gameService.addMove(s.currentPartId,s.role,h),s.updatePartWithStatusAndScores(u,r)}s.gameComponent.message(V5.MUST_ANSWER_REQUEST())})()}updatePartWithStatusAndScores(e,r){var s=this;return I(function*(){return J(n.VERBOSE,"OnlineGameWrapperComponent.updatePartWithStatusAndScores"),e.isEndGame?e===xe.DRAW?yield s.gameService.drawPart(s.currentPartId,s.role,r):(Se.assert(e.winner.isPlayer(),"Non-draw end games should have a winner"),s.notifyVictory(e.winner,r)):s.gameService.updatePart(s.currentPartId,r)})()}notifyTimeoutVictory(e,r){var s=this;return I(function*(){const i=s.role;yield s.gameService.notifyTimeout(s.currentPartId,i,e,r)})()}notifyVictory(e,r){var s=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");const i=Se.getNonNullable(s.currentPart),o=s.players[0].get(),c=s.players[1].get();s.currentPart=e===B.ONE?i.setWinnerAndLoser(c,o):i.setWinnerAndLoser(o,c);const u=s.role;yield s.gameService.endPartWithVictory(s.currentPartId,u,s.currentPart.getWinner().get(),s.currentPart.getLoser().get(),r)})()}resign(){var e=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.resign");const r=e.role,s=e.getPlayer(),i=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,r,i,s)})()}reachedOutOfTime(e){var r=this;return I(function*(){if(J(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),!1===r.isPlaying())return;const s=Se.getNonNullable(r.opponent);e===r.role?yield r.notifyTimeoutVictory(s,r.authUser.toMinimalUser()):yield r.notifyTimeoutVictory(r.authUser.toMinimalUser(),s)})()}propose(e){var r=this;return I(function*(){Se.assert(r.role.isPlayer(),"cannot propose request if not player");const s=r.role;switch(e){case"Rematch":return r.gameService.proposeRematch(r.currentPartId,s);case"Draw":return r.gameService.proposeDraw(r.currentPartId,s);default:return Se.expectToBe(e,"TakeBack"),r.gameService.askTakeBack(r.currentPartId,s)}})()}accept(){var e=this;return I(function*(){Se.assert(e.role.isPlayer(),"cannot accept request if not player");const r=e.role,s=Se.getNonNullable(e.currentPart),i=e.requestManager.getCurrentRequest().get().requestType;switch(i){case"Rematch":return e.gameService.acceptRematch(s,r);case"Draw":return e.gameService.acceptDraw(s.id,r);default:return Se.expectToBe(i,"TakeBack"),e.gameService.acceptTakeBack(s.id,s.data.turn,r)}})()}reject(){var e=this;return I(function*(){Se.assert(e.role.isPlayer(),"cannot reject request if not player");const r=e.role,s=e.requestManager.getCurrentRequest().get().requestType;switch(s){case"Rematch":return e.gameService.rejectRematch(e.currentPartId,r);case"Draw":return e.gameService.refuseDraw(e.currentPartId,r);default:return Se.expectToBe(s,"TakeBack"),e.gameService.refuseTakeBack(e.currentPartId,r)}})()}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===B.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}addGlobalTime(){return this.gameService.addGlobalTime(this.currentPartId,this.role)}addTurnTime(){return this.gameService.addTurnTime(this.currentPartId,this.role)}onCancelMove(e){if(this.gameComponent.node.move.isPresent()){const r=this.gameComponent.node.move.get();this.gameComponent.showLastMove(r)}}ngOnDestroy(){var e=this;return I(function*(){J(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.observedPartSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&(yield e.observedPartService.removeObservedPart()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe(),e.gameEventsSubscription.unsubscribe()),J(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")})()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(xo),Q(Ns),Q(Kn),Q(Mn),Q(L2),Q(Cm),Q(IS),Q(Xz),Q(wft),Q(u4e))},n.\u0275cmp=ut({type:n,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,r){if(1&e&&(y0(Yft,5),y0(Kft,5),y0(Xft,5),y0(Qft,5)),2&e){let s;v4(s=C4())&&(r.chronoZeroGlobal=s.first),v4(s=C4())&&(r.chronoOneGlobal=s.first),v4(s=C4())&&(r.chronoZeroTurn=s.first),v4(s=C4())&&(r.chronoOneTurn=s.first)}},features:[l],decls:5,vars:4,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E,b,k,U,j,oe,ye,te,ke,Ge,Xe,Bt,V1,N1;return t=$localize`vs.`,e=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,r=$localize`It is your turn.`,s=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Draw`,u=$localize`You agreed to draw.`,h=$localize`Your draw proposal has been accepted.`,g=$localize`Players agreed to draw.`,m=$localize`You won.`,E=$localize`You lost.`,b=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,k=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,U=$localize`You reached your time limit.`,j=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,oe=$localize`You resigned.`,ye=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,te=$localize`Resign`,ke=$localize`Pass a turn`,Ge=$localize`Accept`,Xe=$localize`Reject`,Bt=$localize`Your ${"\ufffd0\ufffd"}:INTERPOLATION: request has been rejected.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,V1=$localize`Your request for a ${"\ufffd0\ufffd"}:INTERPOLATION: has been sent.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,N1=$localize`Go back to the game list`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],t,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],["class","block","id","winnerIndicator",4,"ngIf"],[4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],r,["id","opponentTurn"],s,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],o,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],c,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],u,["id","yourOpponentAgreedToDrawIndicator",1,"title"],h,["id","playersAgreedToDraw",1,"title"],g,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],m,["id","youLostIndicator",1,"title"],E,[1,"title"],b,k,U,j,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],oe,ye,["replyButtons",""],["id","requestRejected","class","notification is-danger",4,"ngIf"],["id","requestAwaitingReply","class","notification",4,"ngIf"],["id","resign",1,"button","is-fullwidth","mb-1","is-danger",3,"disabled","click"],te,["id","pass",1,"button","is-fullwidth","mb-1","is-success",3,"disabled","click"],ke,[4,"ngFor","ngForOf"],[1,"button","is-fullwidth","mb-1",3,"id","disabled","click"],[3,"icon"],[1,"notification"],["id","accept",1,"button","is-fullwidth","mb-1","is-success",3,"click"],Ge,["id","reject",1,"button","is-fullwidth","mb-1","is-danger",3,"click"],Xe,["id","requestRejected",1,"notification","is-danger"],Bt,["id","requestAwaitingReply",1,"notification"],V1,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],N1]},template:function(e,r){1&e&&(x(0,Jft,2,1,"app-part-creation",0),x(1,xht,28,25,"div",1),O(2,"div",2)(3,"div",3),X(4,"app-chat",4),A()()),2&e&&(w("ngIf",!1===r.gameStarted),T(1),w("ngIf",r.gameStarted),T(3),w("chatId",r.currentPartId)("turn",null==r.currentPart?null:r.currentPart.getTurn()))},dependencies:[pn,On,Xt,Of,I5,o4e,u1,Zft],encapsulation:2}),n})();function Rht(n,t){if(1&n&&(O(0,"option",26),Tt(1),A()),2&n){const e=t.$implicit;w("value",e.name),T(1),a1(e.name)}}function Dht(n,t){if(1&n&&(O(0,"option",26),ve(1,30),A()),2&n){const e=t.$implicit;w("value",e),T(1),y1(e),A1(1)}}const zht=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function Vht(n,t){if(1&n){const e=Ae();O(0,"select",27),ee("ngModelChange",function(s){return he(e),le(C(2).aiDepths[0]=s)})("change",function(){he(e);const s=C(2);return le(s.updatePlayer(s.Player.ZERO))}),O(1,"option",28),ve(2,29),A(),x(3,Dht,2,2,"option",17),A()}2&n&&(w("ngModel",C(2).aiDepths[0]),T(3),w("ngForOf",J1(2,zht)))}function Hht(n,t){if(1&n&&(O(0,"p",31),ve(1,32),A()),2&n){const e=C(2);T(1),y1(e.gameComponent.scores.get()[0]),A1(1)}}function Fht(n,t){if(1&n&&(O(0,"option",26),Tt(1),A()),2&n){const e=t.$implicit;w("value",e.name),T(1),a1(e.name)}}function Bht(n,t){if(1&n&&(O(0,"option",26),ve(1,35),A()),2&n){const e=t.$implicit;w("value",e),T(1),y1(e),A1(1)}}const $ht=function(){return[1,2,3,4,5,6,7,8,9,10]};function Uht(n,t){if(1&n){const e=Ae();O(0,"select",33),ee("ngModelChange",function(s){return he(e),le(C(2).aiDepths[1]=s)})("change",function(){he(e);const s=C(2);return le(s.updatePlayer(s.Player.ONE))}),O(1,"option",28),ve(2,34),A(),x(3,Bht,2,2,"option",17),A()}2&n&&(w("ngModel",C(2).aiDepths[1]),T(3),w("ngForOf",J1(2,$ht)))}function Ght(n,t){if(1&n&&(O(0,"p",36),ve(1,37),A()),2&n){const e=C(2);T(1),y1(e.gameComponent.scores.get()[1]),A1(1)}}function qht(n,t){if(1&n&&(O(0,"h4",41),Tt(1),A()),2&n){const e=C(3);T(1),a1(e.winnerMessage.get())}}function Wht(n,t){1&n&&(O(0,"h4",42),ve(1,43),A())}function jht(n,t){if(1&n&&(O(0,"div",38),x(1,qht,2,1,"h4",39),x(2,Wht,2,0,"h4",40),A()),2&n){const e=C(2);T(1),w("ngIf",e.winnerMessage.isPresent()),T(1),w("ngIf",e.winnerMessage.isAbsent())}}function Zht(n,t){if(1&n){const e=Ae();O(0,"div",7)(1,"div",8)(2,"p",9),ve(3,10),A()(),O(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),ee("change",function(){he(e);const s=C();return le(s.updatePlayer(s.Player.ZERO))})("ngModelChange",function(s){return he(e),le(C().playerSelection[0]=s)}),O(8,"option",15),ve(9,16),A(),x(10,Rht,2,2,"option",17),A()(),O(11,"div",13),x(12,Vht,4,3,"select",18),A(),x(13,Hht,2,1,"p",19),A(),O(14,"div",20)(15,"div",13)(16,"select",21),ee("change",function(){he(e);const s=C();return le(s.updatePlayer(s.Player.ONE))})("ngModelChange",function(s){return he(e),le(C().playerSelection[1]=s)}),O(17,"option",15),ve(18,22),A(),x(19,Fht,2,2,"option",17),A()(),O(20,"div",13),x(21,Uht,4,3,"select",23),A(),x(22,Ght,2,1,"p",24),A()(),x(23,jht,3,2,"div",25),A()}if(2&n){const e=C();T(3),y1(e.gameComponent.getTurn()+1),A1(3),T(4),w("ngModel",e.playerSelection[0]),T(3),w("ngForOf",e.gameComponent.availableMinimaxes),T(2),w("ngIf",!1===e.players[0].equalsValue("human")),T(1),w("ngIf",e.gameComponent.scores.isPresent()),T(3),w("ngModel",e.playerSelection[1]),T(3),w("ngForOf",e.gameComponent.availableMinimaxes),T(2),w("ngIf",!1===e.players[1].equalsValue("human")),T(1),w("ngIf",e.gameComponent.scores.isPresent()),T(1),w("ngIf",e.endGame)}}function Yht(n,t){if(1&n){const e=Ae();O(0,"button",50),ee("click",function(){return he(e),le(C(2).gameComponent.pass())}),ve(1,51),A()}}function Kht(n,t){if(1&n){const e=Ae();O(0,"button",52),ee("click",function(){return he(e),le(C(2).takeBack())}),ve(1,53),A()}}function Xht(n,t){if(1&n&&(hn(0),Tt(1),X(2,"br"),dn()),2&n){const e=t.$implicit,r=C(3);T(1),Hi(" ",e.name+": "+e.getBoardValue(r.gameComponent.node)," ")}}function Qht(n,t){if(1&n&&(O(0,"div",54),x(1,Xht,3,1,"ng-container",55),Tt(2),X(3,"br"),Tt(4),X(5,"br"),A()),2&n){const e=C(2);T(1),w("ngForOf",e.gameComponent.availableMinimaxes),T(1),Hi(" Created ",e.getCreatedNodes()," nodes."),T(2),Hi(" Minimax time: ",e.getMinimaxTime(),"ms.")}}function Jht(n,t){if(1&n){const e=Ae();O(0,"div",44),x(1,Yht,2,0,"button",45),x(2,Kht,2,0,"button",46),O(3,"button",47),ee("click",function(){return he(e),le(C().restartGame())}),ve(4,48),A(),x(5,Qht,6,3,"div",49),A()}if(2&n){const e=C();T(1),w("ngIf",!1===e.endGame&&e.gameComponent.canPass),T(1),w("ngIf",e.canTakeBack()),T(3),w("ngIf",e.gameComponent.node.move.isPresent()&&e.displayAIMetrics)}}let edt=(()=>{class n extends tT{constructor(e,r,s,i,o){super(e,r,s,i),this.cdr=o,this.aiDepths=["0","0"],this.playerSelection=["human","human"],this.winnerMessage=y.empty(),this.botTimeOut=1e3,this.displayAIMetrics=!1,this.players=[y.of(this.playerSelection[0]),y.of(this.playerSelection[1])],this.role=B.ZERO,J(n.VERBOSE,"LocalGameWrapper.constructor")}getCreatedNodes(){return mP.createdNodes}getMinimaxTime(){return mP.minimaxTime}ngAfterViewInit(){var e=this;setTimeout(I(function*(){(yield e.afterViewInit())&&(e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){this.players[e.value]=y.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?B.ONE:B.ZERO),this.proposeAIToPlay()}onLegalUserMove(e){var r=this;return I(function*(){J(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),r.gameComponent.node=r.gameComponent.rules.choose(r.gameComponent.node,e).get(),r.updateBoard(),r.proposeAIToPlay()})()}updateBoard(){this.updateBoardAndShowLastMove();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.node);if(!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer())){const r=$localize`Player ${e.winner.value+1}`,i=e.winner.getOpponent().value;this.winnerMessage=this.players[e.winner.value].equalsValue("human")?this.players[i].equalsValue("human")?y.of($localize`${r} won`):y.of($localize`You won`):this.players[i].equalsValue("human")?y.of($localize`You lost`):y.of($localize`${this.players[e.winner.value].get()} (Player ${e.winner.value+1}) won`)}}proposeAIToPlay(){var e=this;const r=this.getPlayingAI();r.isPresent()&&window.setTimeout(I(function*(){yield e.doAIMove(r.get())}),this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.node).isEndGame)return y.empty();const e=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[e]?y.empty():y.ofNullable(this.gameComponent.availableMinimaxes.find(r=>this.players[e].equalsValue(r.name)))}doAIMove(e){var r=this;return I(function*(){const s=r.gameComponent.rules;Le(s.getGameStatus(r.gameComponent.node)===xe.ONGOING,"AI should not try to play when game is over!");const c=Number.parseInt(r.aiDepths[r.gameComponent.node.gameState.turn%2%2]),u=r.gameComponent.node.findBestMove(c,e,!0),h=s.choose(r.gameComponent.node,u);return h.isPresent()?(r.gameComponent.node=h.get(),r.updateBoard(),r.cdr.detectChanges(),r.proposeAIToPlay(),z.SUCCESS):(r.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),As.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:u.toString()}))})()}canTakeBack(){return this.gameComponent.getTurn()>0}takeBack(){this.gameComponent.node=this.gameComponent.node.mother.get(),this.isAITurn()&&(this.gameComponent.node=this.gameComponent.node.mother.get()),this.updateBoardAndShowLastMove()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){this.gameComponent.node=this.gameComponent.rules.getInitialNode(),this.gameComponent.updateBoard(),this.endGame=!1,this.winnerMessage=y.empty(),this.proposeAIToPlay()}getPlayer(){return"human"}onCancelMove(e){if(this.gameComponent.node.move.isPresent()){const r=this.gameComponent.node.move.get();this.gameComponent.showLastMove(r)}}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(xo),Q(Ns),Q(Kn),Q(Mn),Q(wu))},n.\u0275cmp=ut({type:n,selectors:[["app-local-game-wrapper"]],features:[l],decls:8,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E,b;return t=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,r=$localize`Human`,s=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Pick the level`,u=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,g=$localize`Draw`,m=$localize`Start a new game`,E=$localize`Pass a turn`,b=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],r,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],s,i,["id","scoreOne",1,"block"],o,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],c,u,["id","scoreZero",1,"block"],h,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],g,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],m,["id","AIMetrics",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],E,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],b,["id","AIMetrics"],[4,"ngFor","ngForOf"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"div",1),x(2,Zht,24,10,"div",2),x(3,Jht,6,3,"div",3),A(),O(4,"div",4)(5,"div",5),X(6,"div",null,6),A()()()),2&e&&(T(2),w("ngIf",r.gameComponent),T(1),w("ngIf",r.gameComponent),T(1),w("ngClass",r.getBoardHighlight()))},dependencies:[pn,On,Xt,Op,Ap,Uy,zl,bp],encapsulation:2,changeDetection:0}),n})(),d4e=(()=>{class n{}return n.STEP_FINISHED=()=>$localize`Step finished!`,n.INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`,n})();function tdt(n,t){if(1&n&&(O(0,"div",21)(1,"div",22),ve(2,23),A(),X(3,"div",24),A()),2&n){const e=C();T(3),w("innerHTML",e.currentReason.get(),ou)}}function ndt(n,t){if(1&n){const e=Ae();O(0,"button",25),ee("click",function(){return he(e),le(C().retry())}),ve(1,26),A()}}function rdt(n,t){1&n&&(hn(0),ve(1,31),dn())}function sdt(n,t){1&n&&(hn(0),ve(1,32),dn())}function idt(n,t){if(1&n&&x(0,sdt,2,0,"ng-container",28),2&n){C();const e=Fn(5),r=C();w("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",e)}}function odt(n,t){1&n&&(hn(0),ve(1,33),dn())}function adt(n,t){if(1&n){const e=Ae();O(0,"button",27),ee("click",function(){return he(e),le(C().next())}),x(1,rdt,2,0,"ng-container",28),x(2,idt,1,2,"ng-template",null,29,Gn),x(4,odt,2,0,"ng-template",null,30,Gn),A()}if(2&n){const e=Fn(3),r=C();T(1),w("ngIf",r.steps[r.stepIndex]&&r.steps[r.stepIndex].isInformation())("ngIfElse",e)}}function cdt(n,t){if(1&n){const e=Ae();O(0,"button",34),ee("click",function(){return he(e),le(C().start())}),ve(1,35),A()}}function ldt(n,t){if(1&n){const e=Ae();O(0,"button",36),ee("click",function(){return he(e),le(C().playLocally())}),ve(1,37),A()}}function udt(n,t){if(1&n){const e=Ae();O(0,"button",38),ee("click",function(){return he(e),le(C().createGame())}),ve(1,39),A()}}function fdt(n,t){if(1&n){const e=Ae();O(0,"button",40),ee("click",function(){return he(e),le(C().showSolution())}),ve(1,41),A()}}function hdt(n,t){if(1&n&&(hn(0),O(1,"option",43),Tt(2),A(),dn()),2&n){const e=C(),r=e.index,s=e.$implicit;T(1),d1("id","step_",r,""),w("value",r),T(1),a1(s.title)}}function ddt(n,t){1&n&&(hn(0),Tt(1,"v "),dn())}function pdt(n,t){1&n&&Tt(0,"x ")}function gdt(n,t){if(1&n&&(O(0,"option",44),x(1,ddt,2,0,"ng-container",28),x(2,pdt,1,0,"ng-template",null,45,Gn),O(4,"span",46),Tt(5),A()()),2&n){const e=Fn(3),r=C(),s=r.index,i=r.$implicit,o=C();w("value",s),T(1),w("ngIf",o.stepFinished[s])("ngIfElse",e),T(3),d1("id","step_",s,""),T(1),a1(i.title)}}function mdt(n,t){if(1&n&&(hn(0),x(1,hdt,3,3,"ng-container",28),x(2,gdt,6,5,"ng-template",null,42,Gn),dn()),2&n){const e=t.index,r=Fn(3),s=C();T(1),w("ngIf",e===s.stepIndex)("ngIfElse",r)}}let _dt=(()=>{class n extends tT{constructor(e,r,s,i,o){super(e,o,r,s),this.cdr=i,this.COMPLETED_TUTORIAL_MESSAGE=$localize`Congratulations, you completed the tutorial.`,this.steps=[],this.successfulSteps=0,this.stepIndex=-1,this.currentMessage="",this.currentReason=y.empty(),this.moveAttemptMade=!1,this.stepFinished=[],this.tutorialOver=!1,J(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),this.role=B.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return I(function*(){J(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),(yield e.afterViewInit())&&e.start()})()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(e){J(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(e){J(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;const r=this.steps[this.stepIndex];this.currentMessage=r.instruction,this.currentReason=y.empty(),this.gameComponent.node=new gr(r.state,y.empty(),r.previousMove),this.setRole(this.gameComponent.getCurrentPlayer()),this.cdr.detectChanges()}onLegalUserMove(e){var r=this;return I(function*(){J(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}});const s=r.steps[r.stepIndex],i=r.gameComponent.rules.choose(r.gameComponent.node,e);if(Le(i.isPresent(),"It should be impossible to call onLegalUserMove with an illegal move"),r.gameComponent.node=i.get(),J(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),r.updateBoardAndShowLastMove(),r.moveAttemptMade=!0,s.isPredicate()){const o=r.gameComponent.getPreviousState(),c=r.gameComponent.getState(),u=Se.getNonNullable(s.predicate)(e,o,c);u.isSuccess()?r.showStepSuccess(s.getSuccessMessage()):r.currentReason=y.of(u.getReason())}else if(s.isAnyMove())J(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(s.getSuccessMessage());else{Le(s.isMove(),"cannot reach here with a click step");const o=s;o.acceptedMoves.some(c=>c.equals(e))?(J(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(o.getSuccessMessage())):(J(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),r.currentReason=y.of(o.getFailureMessage()))}r.cdr.detectChanges()})()}retry(){J(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}canUserPlay(e){if(J(n.VERBOSE,"tutorialGameWrapper.canUserPlay("+e+")"),this.currentReason=y.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return z.failure(d4e.STEP_FINISHED());const r=this.steps[this.stepIndex];return r.isClick()?(this.updateBoardAndShowLastMove(),this.moveAttemptMade=!0,Se.getNonNullable(r.acceptedClicks).some(s=>s===e)?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),z.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(()=>{this.cdr.detectChanges()},10),z.SUCCESS):z.failure(d4e.INFORMATIONAL_STEP())}onCancelMove(e){J(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=y.of(e)),this.cdr.detectChanges()}showStepSuccess(e){J(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const r of this.stepFinished)r&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var e=this;return I(function*(){J(n.VERBOSE,"tutorialGameWrapper.showSolution()");const r=e.steps[e.stepIndex];Le(r.hasSolution(),"step must have solution");const s=r,i=s.getSolution();i instanceof ji?(e.showStep(e.stepIndex),e.gameComponent.node=e.gameComponent.rules.choose(e.gameComponent.node,i).get(),e.updateBoardAndShowLastMove()):(e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=s.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return I(function*(){const r=Se.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",r])})()}createGame(){var e=this;return I(function*(){const r=Se.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",r])})()}getPlayer(){return"tutorial-player"}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(xo),Q(Kn),Q(Mn),Q(wu),Q(Ns))},n.\u0275cmp=ut({type:n,selectors:[["app-tutorial-game-wrapper"]],features:[l],decls:23,vars:15,consts:function(){let t,e,r,s,i,o,c,u,h;return t=$localize`Failure`,e=$localize`Try again`,r=$localize`Ok`,s=$localize`Continue`,i=$localize`Skip`,o=$localize`Try again`,c=$localize`Play locally`,u=$localize`Create an online game`,h=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],t,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],r,s,i,["id","restartButton",1,"button",3,"click"],o,["id","playLocallyButton",1,"button",3,"click"],c,["id","playOnlineButton",1,"button",3,"click"],u,["id","showSolutionButton",1,"button",3,"click"],h,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"div",1)(2,"div",2),X(3,"progress",3),O(4,"div",4)(5,"p",5),Tt(6),A(),X(7,"p",6),A(),x(8,tdt,4,1,"div",7),O(9,"div",8),x(10,ndt,2,0,"button",9),x(11,adt,6,2,"button",10),x(12,cdt,2,0,"button",11),x(13,ldt,2,0,"button",12),x(14,udt,2,0,"button",13),x(15,fdt,2,0,"button",14),O(16,"div",15)(17,"select",16),ee("change",function(i){return r.changeStep(i)}),x(18,mdt,4,2,"ng-container",17),A()()()()(),O(19,"div",18)(20,"div",19),X(21,"div",null,20),A()()()),2&e&&(T(3),D("value",r.successfulSteps)("max",r.getNumberOfSteps()),T(3),tO("",r.getCurrentStepTitle()," [",r.stepIndex+1,"/",r.getNumberOfSteps(),"]"),T(1),w("innerHTML",r.currentMessage,ou),T(1),w("ngIf",r.currentReason.isPresent()),T(2),w("ngIf",!1===r.tutorialOver&&(r.stepFinished&&!0===r.stepFinished[r.stepIndex]||r.moveAttemptMade)),T(1),w("ngIf",!1===r.tutorialOver),T(1),w("ngIf",r.tutorialOver),T(1),w("ngIf",r.tutorialOver),T(1),w("ngIf",r.tutorialOver),T(1),w("ngIf",r.moveAttemptMade&&!1===r.stepFinished[r.stepIndex]),T(3),w("ngForOf",r.steps),T(1),w("ngClass",r.getBoardHighlight()))},dependencies:[pn,On,Xt,Op,Ap],encapsulation:2,changeDetection:0}),n})();function vdt(n,t){if(1&n&&(O(0,"div",35)(1,"div",36),ve(2,37),A(),O(3,"div",38),Tt(4),A()()),2&n){const e=C();T(4),a1(e.errorMessage)}}const Cdt=function(){return["/login"]};let ydt=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.faEye=WV,this.registrationForm=new w0({email:new qa,username:new qa,password:new qa})}registerWithEmail(){var e=this;return I(function*(){const r=e.registrationForm.value.username,s=e.registrationForm.value.email,i=e.registrationForm.value.password;if(null==r||null==s||null==i)e.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const o=yield e.connectedUserService.doRegister(r,s,i);if(o.isSuccess()){const c=yield e.connectedUserService.sendEmailVerification();c.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=c.getReason()}else e.errorMessage=o.getReason()}})()}registerWithGoogle(){var e=this;return I(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=r.getReason()})()}getPasswordHelpClass(){const e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}canRegister(){const e=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===e||e.length<6)}}return n.\u0275fac=function(e){return new(e||n)(Q(Ns),Q(Kn))},n.\u0275cmp=ut({type:n,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,e,r,s,i,o,c,u,h,g,m,E,b,k;return t=$localize`Registering`,e=$localize`Email`,r=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,i=$localize`Username`,o=$localize`Username`,c=$localize`Password`,u=$localize`Password`,h=$localize`The password should be at least 6 characters long`,g=$localize`Register`,m=$localize`Register with Google`,E=$localize`Have an account?`,b=$localize`Log in`,k=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",r,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],i,["id","username","formControlName","username","name","username","placeholder",o,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",u,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],h,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],g,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],E,[3,"routerLink"],b,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],k,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),ve(7,7),A()(),O(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),O(12,"p",12),ve(13,13),A()()()()(),O(14,"div",4)(15,"div",5)(16,"label",14),ve(17,15),A()(),O(18,"div",8)(19,"div",9)(20,"div",10),X(21,"input",16),A()()()(),O(22,"div",4)(23,"div",5)(24,"label",17),ve(25,18),A()(),O(26,"div",8)(27,"div",9)(28,"div",19),X(29,"input",20),O(30,"span",21),X(31,"fa-icon",22),A(),O(32,"p",23),ve(33,24),A()()()()(),O(34,"div",4),X(35,"div",5),O(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),ee("click",function(){return r.registerWithEmail()}),ve(40,26),A()()()()(),O(41,"div",4),X(42,"div",5),O(43,"div",27),x(44,vdt,5,1,"div",28),A()(),O(45,"div",4),X(46,"div",5),O(47,"div",8)(48,"button",29),ee("click",function(){return r.registerWithGoogle()}),ve(49,30),A()()(),O(50,"p",31),hn(51),ve(52,32),dn(),Tt(53,"\xa0 "),O(54,"a",33),ve(55,34),A()()()()),2&e&&(T(3),w("formGroup",r.registrationForm),T(28),w("icon",r.faEye),T(1),w("ngClass",r.getPasswordHelpClass()),T(7),w("disabled",!r.canRegister()),T(5),w("ngIf",r.errorMessage),T(10),w("routerLink",J1(6,Cdt)))},dependencies:[pn,Xt,Vu,Iu,S4,zl,Nu,Lu,xu,Ef,I5,eF,i4e],encapsulation:2}),n})(),Edt=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}playLocally(){var e=this;return I(function*(){yield e.router.navigate(["local/"+e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Kn))},n.\u0275cmp=ut({type:n,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(O(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),A(),O(1,"button",1),ee("click",function(){return r.playLocally()}),ve(2,2),A()),2&e&&(T(1),w("disabled",!r.selectedGame))},dependencies:[JH],encapsulation:2}),n})(),Mdt=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}launchTutorial(){var e=this;return I(function*(){yield e.router.navigate(["/tutorial/",e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Kn))},n.\u0275cmp=ut({type:n,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(O(0,"app-pick-game",0),ee("pickGame",function(i){return r.pickGame(i)}),A(),O(1,"button",1),ee("click",function(){return r.launchTutorial()}),ve(2,2),A()),2&e&&(T(1),w("disabled",!r.selectedGame))},dependencies:[JH],encapsulation:2}),n})(),Sdt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=ut({type:n,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(O(0,"p"),ve(1,0),A())},encapsulation:2}),n})();function Tdt(n,t){if(1&n&&(F(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessQueenComponent.HEPTAGON)}}function wdt(n,t){if(1&n&&(F(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function bdt(n,t){if(1&n&&(F(),X(0,"circle",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function Odt(n,t){if(1&n&&(hn(0),F(),X(1,"circle",6)(2,"circle",6)(3,"circle",6),dn()),2&n){const e=C();T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(3)),T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function Adt(n,t){if(1&n&&(F(),O(0,"g"),X(1,"circle",7)(2,"circle",7)(3,"circle",7),A()),2&n){const e=C();T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.45*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),T(1),D("cx",.45*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),T(1),D("cx",.55*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function Ndt(n,t){if(1&n&&(F(),O(0,"g",8),X(1,"circle",9)(2,"circle",9)(3,"circle",9),A()),2&n){const e=C();w("ngClass",e.pieceClasses),T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE-3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE+3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class E6{constructor(){this.MartianChessQueenComponent=E6,this.MartianChessComponent=jo,this.horizontalDotsRadius=jo.SPACE_SIZE/15}}function xdt(n,t){if(1&n&&(F(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessDroneComponent.PENTAGON)}}function kdt(n,t){if(1&n&&(F(),X(0,"polygon",4)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function Ldt(n,t){if(1&n&&(F(),X(0,"circle",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function Rdt(n,t){if(1&n&&(hn(0),F(),X(1,"circle",6)(2,"circle",6),dn()),2&n){const e=C();T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function Ddt(n,t){if(1&n&&(F(),O(0,"g",7),X(1,"circle",8)(2,"circle",8),A()),2&n){const e=C();w("ngClass",e.pieceClasses),T(1),D("cx",.4*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),T(1),D("cx",.6*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function zdt(n,t){if(1&n&&(F(),O(0,"g",7),X(1,"circle",9)(2,"circle",9),A()),2&n){const e=C();w("ngClass",e.pieceClasses),T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE-2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE+2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}E6.HEPTAGON=jo.getRegularPolygon(7),E6.EIGHT_POINTED_STAR=jo.getNPointedStar(8,0),E6.\u0275fac=function(t){return new(t||E6)},E6.\u0275cmp=ut({type:E6,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,Tdt,1,3,"polygon",0),x(1,wdt,1,3,"polygon",0),x(2,bdt,1,5,"circle",1),x(3,Odt,4,9,"ng-container",2),x(4,Adt,4,9,"g",2),x(5,Ndt,4,10,"g",3)),2&t&&(w("ngIf","Polygon"===e.style.shape),T(1),w("ngIf","Star"===e.style.shape),T(1),w("ngIf","Circle"===e.style.shape),T(1),w("ngIf","Concentric Circles"===e.style.points),T(1),w("ngIf","Dots"===e.style.points),T(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[pn,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class M6{constructor(){this.MartianChessComponent=jo,this.MartianChessDroneComponent=M6,this.horizontalDotsRadius=jo.SPACE_SIZE/15}}function Hdt(n,t){if(1&n&&(F(),X(0,"polygon",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessPawnComponent.TRIANGLE)}}function Fdt(n,t){if(1&n&&(F(),X(0,"polygon",5)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function Bdt(n,t){if(1&n&&(F(),X(0,"circle",6)),2&n){const e=C();w("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function $dt(n,t){if(1&n&&(F(),X(0,"circle",7)),2&n){const e=C();D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE+e.getConcreteTriangleYOffset())("r",e.MartianChessComponent.getRadius(1))}}function Udt(n,t){if(1&n&&(F(),X(0,"circle",8)),2&n){const e=C();D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function Gdt(n,t){if(1&n&&(F(),O(0,"g",9),X(1,"circle",10),A()),2&n){const e=C();w("ngClass",e.pieceClasses),T(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}M6.FOUR_POINTED_STAR_VERTICAL=jo.getNPointedStar(4,0),M6.PENTAGON=jo.getRegularPolygon(5),M6.\u0275fac=function(t){return new(t||M6)},M6.\u0275cmp=ut({type:M6,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,xdt,1,3,"polygon",0),x(1,kdt,1,3,"polygon",0),x(2,Ldt,1,5,"circle",1),x(3,Rdt,3,6,"ng-container",2),x(4,Ddt,3,7,"g",3),x(5,zdt,3,7,"g",3)),2&t&&(w("ngIf","Polygon"===e.style.shape),T(1),w("ngIf","Star"===e.style.shape),T(1),w("ngIf","Circle"===e.style.shape),T(1),w("ngIf","Concentric Circles"===e.style.points),T(1),w("ngIf","Dots"===e.style.points),T(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[pn,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Oa{constructor(){this.MartianChessComponent=jo,this.MartianChessPawnComponent=Oa,this.horizontalDotsRadius=jo.SPACE_SIZE/15}static getTriangle(){return jo.getRegularPolygon(3,Oa.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const e=jo.getRegularPolygonCoords(3).map(u=>u.y);return(e.reduce((u,h)=>Math.min(u,h))+(100-e.reduce((u,h)=>Math.max(u,h))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?Oa.TRIANGLE_Y_OFFSET:0}}function Wdt(n,t){if(1&n&&(F(),X(0,"text",8)),2&n){const e=C();Q2("id","height_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),w("innerHTML",e.coord.z,ou)}}function jdt(n,t){if(1&n&&(F(),X(0,"polyline",9)),2&n){const e=C();w("ngClass",e.pieceClasses),D("points",e.getUpperHorizontalLine())}}function Zdt(n,t){if(1&n&&(F(),O(0,"g"),X(1,"polyline",10)(2,"polyline",11),A()),2&n){const e=C();T(1),w("ngClass",e.pieceClasses),D("points",e.getMiddleHorizontalLine()),T(1),w("ngClass",e.pieceClasses),D("points",e.getLowerHorizontalLine())}}function Ydt(n,t){if(1&n&&(F(),X(0,"polyline",12)),2&n){const e=C();w("ngClass",e.pieceClasses),D("points",e.getLeftDiagonalLine())}}function Kdt(n,t){if(1&n&&(F(),O(0,"g"),X(1,"polyline",13)(2,"polyline",14),A()),2&n){const e=C();T(1),w("ngClass",e.pieceClasses),D("points",e.getMiddleDiagonalLine()),T(1),w("ngClass",e.pieceClasses),D("points",e.getRighterDiagonalLine())}}function Xdt(n,t){if(1&n&&(F(),X(0,"polyline",15)),2&n){const e=C();w("ngClass",e.pieceClasses),D("points",e.getLeftVerticalLine())}}function Qdt(n,t){if(1&n&&(F(),X(0,"polyline",16)),2&n){const e=C();w("ngClass",e.pieceClasses),D("points",e.getMiddleVerticalLine())}}function Jdt(n,t){if(1&n&&(F(),X(0,"polyline",17)),2&n){const e=C();w("ngClass",e.pieceClasses),D("points",e.getRighterVerticalLine())}}Oa.FOUR_POINTED_STAR_DIAGONAL=jo.getNPointedStar(4,45),Oa.TRIANGLE_Y_OFFSET=Oa.yOffsetForVerticalCentering(),Oa.TRIANGLE=Oa.getTriangle(),Oa.\u0275fac=function(t){return new(t||Oa)},Oa.\u0275cmp=ut({type:Oa,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,Hdt,1,3,"polygon",0),x(1,Fdt,1,3,"polygon",0),x(2,Bdt,1,5,"circle",1),x(3,$dt,1,3,"circle",2),x(4,Udt,1,3,"circle",3),x(5,Gdt,2,4,"g",4)),2&t&&(w("ngIf","Polygon"===e.style.shape),T(1),w("ngIf","Star"===e.style.shape),T(1),w("ngIf","Circle"===e.style.shape),T(1),w("ngIf","Concentric Circles"===e.style.points),T(1),w("ngIf","Dots"===e.style.points),T(1),w("ngIf","Horizontal Points"===e.style.points))},dependencies:[pn,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Wh{mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(t=>"victory-stroke"===t)||this.pieceClasses.some(t=>"last-move-stroke"===t)}get3DIsoSquarePoints(){const t=this.getParallelogramPoints();return this.mapCoordToPoints([t[0],t[1],t[4],t[6],t[5],t[2],t[0]])}getParallelogramPoints(){const t=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,e=this.mode.parallelogramHeight,r=this.mode.offsetRatio*this.mode.parallelogramHeight,s=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,i=t,c=t-r,u=e,h=-r,g=e;return[new S(0,0),new S(i,0),new S(h,g),new S(c,u),new S(i,0+s),new S(h,g+s),new S(c,u+s)]}mapCoordToPoints(t){return t.map(e=>e.x+" "+e.y).join(" ")}getUpperHorizontalLineCoords(){const t=this.getParallelogramPoints(),e=t[0],r=t[1],i=new $t(-1*this.mode.offsetRatio*l1.STROKE_WIDTH,l1.STROKE_WIDTH),o=e.getNext(i),c=r.getNext(i);return[e,r,c,o]}getUpperHorizontalLine(){const t=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(t)}getMiddleHorizontalCoords(){const t=this.getParallelogramPoints(),e=t[2],r=t[3],i=new $t(-1*this.mode.offsetRatio*l1.STROKE_WIDTH,l1.STROKE_WIDTH);return[e.getNext(i,-1),r.getNext(i,-1),r,e]}getMiddleHorizontalLine(){const t=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(t)}getLowerHorizontalLine(){const t=this.getParallelogramPoints(),e=t[5],r=t[6],s=new $t(0,l1.STROKE_WIDTH),i=e.getNext(s,-1),o=r.getNext(s,-1);return this.mapCoordToPoints([i,o,r,e])}getLeftDiagonalLine(){const t=this.getParallelogramPoints(),e=t[0],r=t[2],i=new $t(l1.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleDiagonalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[3],i=new $t(l1.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterDiagonalLine(){const t=this.getParallelogramPoints(),e=t[4],r=t[6],i=new $t(0,l1.STROKE_WIDTH),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getLeftVerticalLine(){const t=this.getParallelogramPoints(),e=t[2],r=t[5],i=new $t(l1.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleVerticalLine(){const t=this.getParallelogramPoints(),e=t[3],r=t[6],i=new $t(l1.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterVerticalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[4],o=new $t(l1.STROKE_WIDTH,-l1.STROKE_WIDTH/this.mode.offsetRatio),c=e.getNext(o,-1),u=r.getNext(o,-1);return this.mapCoordToPoints([c,e,r,u])}getOtherCoord(){Le(null!=this.move,"Move should be set before calling getOtherCoord");const t=this.move;return t.getZero().equals(this.coord)?t.getOne():t.getZero()}isLeftHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x-1}}isRightHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x+1}}isTopHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y-1}}isBottomHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y+1}}}Wh.STROKE_OFFSET=l1.STROKE_WIDTH/2,Wh.\u0275fac=function(t){return new(t||Wh)},Wh.\u0275cmp=ut({type:Wh,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(t,e){1&t&&(F(),X(0,"polyline",0),x(1,Wdt,1,4,"text",1),x(2,jdt,1,2,"polyline",2),x(3,Zdt,3,4,"g",3),x(4,Ydt,1,2,"polyline",4),x(5,Kdt,3,4,"g",3),x(6,Xdt,1,2,"polyline",5),x(7,Qdt,1,2,"polyline",6),x(8,Jdt,1,2,"polyline",7)),2&t&&(Q2("id","tile_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),w("ngClass",e.pieceClasses),D("points",e.get3DIsoSquarePoints()),T(1),w("ngIf",e.mustDisplayHeight),T(1),w("ngIf",!1===e.isBottomHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",!1===e.isTopHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",!1===e.isRightHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",!1===e.isLeftHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",e.isBottomHalf()||e.isLeftHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",e.isBottomHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()),T(1),w("ngIf",e.isTopHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()))},dependencies:[pn,Xt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});const a__firebaseConfig={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"};let tF=(()=>{class n{constructor(e){this.connectedUserService=e}canActivate(){var e=this;return I(function*(){const r=yield new Promise(s=>{e.userSubscription=e.connectedUserService.subscribeToUser(function(){var i=I(function*(o){return s(yield e.evaluateUserPermission(o))});return function(o){return i.apply(this,arguments)}}())});return e.userSubscription.unsubscribe(),r})()}}return n.\u0275fac=function(e){return new(e||n)(Ve(Ns))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),jh=(()=>{class n extends tF{constructor(e,r){super(e),this.router=r}static evaluateUserPermission(e,r){return I(function*(){return!1===r.isConnected()?e.parseUrl("/login"):!1!==r.verified||e.parseUrl("/verify-account")})()}evaluateUserPermission(e){var r=this;return I(function*(){return n.evaluateUserPermission(r.router,e)})()}}return n.\u0275fac=function(e){return new(e||n)(Ve(Ns),Ve(Kn))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),nF=(()=>{class n{constructor(e,r){this.observedPartService=e,this.router=r,this.observedPartSubscription=y.empty()}canActivate(e){var r=this;return I(function*(){const s=yield new Promise(i=>{const o=r.observedPartService.subscribeToObservedPart(c=>{if(c.isAbsent())return i(!0);const u=c.get();return i(e.params.id===u.id||r.router.parseUrl("/play/"+u.typeGame+"/"+u.id))});r.observedPartSubscription=y.of(o)});return r.observedPartSubscription.get().unsubscribe(),r.observedPartSubscription=y.empty(),s})()}}return n.\u0275fac=function(e){return new(e||n)(Ve(L2),Ve(Kn))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),e9t=(()=>{class n extends tF{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return I(function*(){return!1===e.isConnected()?r.router.parseUrl("/login"):!e.verified||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(Ve(Ns),Ve(Kn))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),t9t=(()=>{class n extends tF{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return I(function*(){return!1===e.isConnected()||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(Ve(Ns),Ve(Kn))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function n9t(n,t){1&n&&(O(0,"p",20),ve(1,21),A())}function r9t(n,t){if(1&n){const e=Ae();O(0,"div",7)(1,"p",8),ve(2,9),A(),O(3,"div",10)(4,"p",11),ve(5,12),A(),O(6,"button",13),ee("click",function(){return he(e),le(C().finalizeEmailVerification())}),ve(7,14),A()(),O(8,"div",15)(9,"p",11),ve(10,16),A(),O(11,"button",17),ee("click",function(){return he(e),le(C().sendEmailVerification())}),ve(12,18),A()(),x(13,n9t,2,0,"p",19),A()}if(2&n){const e=C();T(2),y1(e.emailAddress),A1(2),T(11),w("ngIf",e.success)}}function s9t(n,t){if(1&n){const e=Ae();O(0,"div",24)(1,"div",8),ve(2,25),A(),O(3,"form",26)(4,"div",27)(5,"div",28),X(6,"input",29),A(),O(7,"div",28)(8,"button",30),ee("click",function(){he(e);const s=C(2);return le(s.pickUsername(s.usernameForm.value))}),ve(9,31),A()()()()()}if(2&n){const e=C(2);T(3),w("formGroup",e.usernameForm)}}const i9t=function(){return["/lobby"]};function o9t(n,t){1&n&&(O(0,"div",32),ha(1,33),X(2,"a",34),da(),A()),2&n&&(T(2),w("routerLink",J1(1,i9t)))}function a9t(n,t){if(1&n&&(hn(0),x(1,s9t,10,1,"div",22),x(2,o9t,3,2,"div",23),dn()),2&n){const e=C();T(1),w("ngIf",!e.success),T(1),w("ngIf",e.success)}}function c9t(n,t){if(1&n&&(O(0,"div",35)(1,"div",36),Tt(2),A()()),2&n){const e=C();T(2),a1(e.errorMessage)}}let l9t=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new w0({username:new qa})}ngOnInit(){var e=this;return I(function*(){e.userSubscription=e.connectedUserService.subscribeToUser(function(){var r=I(function*(s){e.emailAddress=s.email.get(),s.username.isAbsent()?e.verificationType="enter-username":(e.verificationType="send-email",!0===e.triedToFinalize&&!1===s.verified&&(e.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield e.router.navigate(["/lobby"])))});return function(s){return r.apply(this,arguments)}}())})()}pickUsername(e){var r=this;return I(function*(){const s=yield r.connectedUserService.setUsername(e.username);s.isSuccess()?r.success=!0:r.errorMessage=s.getReason()})()}sendEmailVerification(){var e=this;return I(function*(){const r=yield e.connectedUserService.sendEmailVerification();r.isSuccess()?e.success=!0:e.errorMessage=r.getReason()})()}finalizeEmailVerification(){var e=this;return I(function*(){e.triedToFinalize=!0,yield e.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(Ns),Q(Kn))},n.\u0275cmp=ut({type:n,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,g,m;return t=$localize`Account verification`,e=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,r=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,i=$localize`If you have not received the verification email, click on the following button:`,o=$localize`Send verification email again`,c=$localize`The email has been sent`,u=$localize`In order to finalize your account, you must choose a username.`,h=$localize`Username`,g=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],e,[1,"block","level-left"],[1,"level-item"],r,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],i,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],o,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],u,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",h,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],g,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"div",1)(2,"div",2),ve(3,3),A(),x(4,r9t,14,2,"div",4),x(5,a9t,3,2,"ng-container",5),A(),x(6,c9t,3,1,"div",6),A()),2&e&&(T(4),w("ngIf","send-email"===r.verificationType),T(1),w("ngIf","enter-username"===r.verificationType),T(1),w("ngIf",r.errorMessage))},dependencies:[Xt,Vu,Iu,S4,zl,Nu,Lu,xu,Ef],encapsulation:2}),n})();function u9t(n,t){1&n&&(O(0,"p",17),ve(1,18),A())}function f9t(n,t){if(1&n&&(O(0,"div",19)(1,"div",20),ve(2,21),A(),O(3,"div",22),Tt(4),A()()),2&n){const e=C();T(4),a1(e.errorMessage.get())}}const h9t=function(){return{standalone:!0}};let d9t=(()=>{class n{constructor(e){this.connectedUserService=e,this.success=!1,this.errorMessage=y.empty(),this.email=""}resetPassword(){var e=this;return I(function*(){Le(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=y.empty(),e.success=!1;const r=yield e.connectedUserService.sendPasswordResetEmail(e.email);r.isSuccess()?e.success=!0:e.errorMessage=y.of(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Ns))},n.\u0275cmp=ut({type:n,selectors:[["app-reset-password"]],decls:17,vars:6,consts:function(){let t,e,r,s,i,o,c;return t=$localize`Password reset`,e=$localize`Email`,r=$localize`Email`,s=$localize`An email will be sent with instruction to reset your password.`,i=$localize`Reset password`,o=$localize`The email has been sent, please follow the instructions from that email.`,c=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","name","email","placeholder",r,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],s,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],i,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],o,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],c,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"div",3)(4,"div",4)(5,"label",5),ve(6,6),A()(),O(7,"div",7)(8,"div",8)(9,"div",9)(10,"input",10),ee("ngModelChange",function(i){return r.email=i}),A(),O(11,"p",11),ve(12,12),A(),x(13,u9t,2,0,"p",13),A()()()(),O(14,"button",14),ee("click",function(){return r.resetPassword()}),ve(15,15),A(),x(16,f9t,5,1,"div",16),A()),2&e&&(T(10),w("ngModel",r.email)("ngModelOptions",J1(5,h9t)),T(3),w("ngIf",r.success),T(1),w("disabled",""===r.email),T(2),w("ngIf",r.errorMessage.isPresent()))},dependencies:[Xt,S4,zl,Lu,bp,eF],encapsulation:2}),n})();function p9t(n,t){if(1&n&&(O(0,"option",13),Tt(1),A()),2&n){const e=t.$implicit,r=C();w("value",e.value)("selected",e.value===r.currentTheme),T(1),Hi(" ",e.name," ")}}function g9t(n,t){if(1&n&&(O(0,"option",13),Tt(1),A()),2&n){const e=t.$implicit,r=C();w("value",e.value)("selected",e.value===r.currentLanguage),T(1),Hi(" ",e.name," ")}}let m9t=(()=>{class n{constructor(e,r){this.userSettingsService=e,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}],this.currentTheme=r.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}changeTheme(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return n.\u0275fac=function(e){return new(e||n)(Q(dne),Q(xS))},n.\u0275cmp=ut({type:n,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,e,r;return t=$localize`User settings`,e=$localize`Theme`,r=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],e,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],r,["id","language",3,"change"],[3,"value","selected"]]},template:function(e,r){1&e&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"div",3)(4,"label",4),ve(5,5),A(),O(6,"div",6)(7,"div",7)(8,"select",8),ee("change",function(i){return r.changeTheme(i)}),x(9,p9t,2,3,"option",9),A()()()(),O(10,"div",3)(11,"label",10),ve(12,11),A(),O(13,"div",6)(14,"div",7)(15,"select",12),ee("change",function(i){return r.changeLanguage(i)}),x(16,g9t,2,3,"option",9),A()()()()()),2&e&&(T(9),w("ngForOf",r.availableThemes),T(7),w("ngForOf",r.availableLanguages))},dependencies:[On,Op,Ap],encapsulation:2}),n})(),_9t=(()=>{class n{constructor(e,r,s,i,o,c){this.route=e,this.router=r,this.connectedUserService=s,this.observedPartService=i,this.messageDisplayer=o,this.gameService=c}ngOnInit(){var e=this;return I(function*(){yield e.createGameAndRedirectOrShowError(e.extractGameFromURL())})()}extractGameFromURL(){return Se.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(e){var r=this;return I(function*(){if(Le(r.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===r.gameExists(e))return yield r.router.navigate(["/notFound",V5.NO_MATCHING_GAME(e)],{skipLocationChange:!0}),!1;const i=r.observedPartService.canUserCreate();if(i.isSuccess()){const o=yield r.gameService.createPartConfigRoomAndChat(e);return yield r.router.navigate(["/play",e,o]),!0}return r.messageDisplayer.infoMessage(i.getReason()),yield r.router.navigate(["/lobby"]),!1})()}gameExists(e){return y.ofNullable(qh.ALL_GAMES().find(s=>s.urlName===e)).isPresent()}}return n.\u0275fac=function(e){return new(e||n)(Q(xo),Q(Kn),Q(Ns),Q(L2),Q(Mn),Q(IS))},n.\u0275cmp=ut({type:n,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(O(0,"p"),ve(1,0),A())},encapsulation:2}),n})();!function B8e(n,t,e){(function gle(n,t,e){"string"!=typeof t&&(e=t,t=n[vt.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),mf[t]=n,e&&(mf[t][vt.ExtraData]=e)})(n,t,e)}(ope);const v9t=[{path:"login",component:J7t},{path:"lobby",component:mft,canActivate:[jh]},{path:"account",component:_ft,canActivate:[jh]},{path:"settings",component:m9t},{path:"register",component:ydt,canActivate:[t9t]},{path:"reset-password",component:d9t},{path:"notFound/:message",component:c4e},{path:"nextGameLoading",component:Sdt,canActivate:[jh]},{path:"verify-account",component:l9t,canActivate:[e9t]},{path:"play",component:a4e,canActivate:[jh,nF]},{path:"play/:compo",component:_9t,canActivate:[jh,nF]},{path:"play/:compo/:id",component:Lht,canActivate:[jh,nF]},{path:"local",component:Edt},{path:"local/:compo",component:edt},{path:"tutorial",component:Mdt},{path:"tutorial/:compo",component:_dt},{path:"",component:B7t},{path:"demo",component:Y7t},{path:"**",component:c4e}];class rF{static app(){return function CSe(n,...t){return{ngModule:vSe,providers:[{provide:IR,useFactory:_Se(n),multi:!0,deps:[Pr,fi,AR,...t]}]}}(()=>ySe(a__firebaseConfig))}static firestore(){return function vbe(n,...t){return{ngModule:_be,providers:[{provide:jz,useFactory:pbe(n),multi:!0,deps:[Pr,fi,AR,NR,[new ui,bte],[new ui,YR],...t]}]}}(()=>{const t=Tbe();t.toJSON();return t})}static auth(){return function nbe(n,...t){return{ngModule:tbe,providers:[{provide:Wz,useFactory:Qwe(n),multi:!0,deps:[Pr,fi,AR,NR,[new ui,YR],...t]}]}}(()=>{const t=ibe();return t})}}let C9t=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=oi({type:n,bootstrap:[$3t]}),n.\u0275inj=Zr({providers:[Ns,IS,Xz,Qz,Cm,OS,xS,{provide:y4,useValue:Em.getLocale()}],imports:[rF.app(),rF.firestore(),rF.auth(),XG,L7e,Qhe.forRoot(v9t,{useHash:!1}),oW,v7e,spe,sVe]}),n})();k8(jo,function(){return[pn,On,Xt,E6,M6,Oa]},[]),k8(l1,function(){return[pn,On,Xt,Wh]},[]);var y9t=gc(7742);function p4e(){(function L0e(){KU=!1})(),c5e().bootstrapModule(C9t).catch(n=>console.error(n))}const g4e=Em.getLocale();"en"!==g4e?fetch("/assets/"+g4e+".json").then(n=>n.ok?n.json():{locale:"en",translations:{}}).then(n=>{(0,y9t.XJ)(n.translations),$localize.locale=n.locale,p4e()}).catch(function(n){console.log(n)}):p4e()},2486:function(Zh,F5){!function(gc){"use strict";function ln(gt,lt){var rn=Object.keys(gt);if(Object.getOwnPropertySymbols){var i1=Object.getOwnPropertySymbols(gt);lt&&(i1=i1.filter(function(Vs){return Object.getOwnPropertyDescriptor(gt,Vs).enumerable})),rn.push.apply(rn,i1)}return rn}function os(gt){for(var lt,rn=1;rn<arguments.length;rn++)lt=arguments[rn]??{},rn%2?ln(Object(lt),!0).forEach(function(i1){P8(gt,i1,lt[i1])}):Object.getOwnPropertyDescriptors?Object.defineProperties(gt,Object.getOwnPropertyDescriptors(lt)):ln(Object(lt)).forEach(function(i1){Object.defineProperty(gt,i1,Object.getOwnPropertyDescriptor(lt,i1))});return gt}function W3(gt,lt){if(!(gt instanceof lt))throw new TypeError("Cannot call a class as a function")}function e3(gt,lt){for(var rn,i1=0;i1<lt.length;i1++)(rn=lt[i1]).enumerable=rn.enumerable||!1,rn.configurable=!0,"value"in rn&&(rn.writable=!0),Object.defineProperty(gt,rn.key,rn)}function H1(gt,lt,rn){return lt&&e3(gt.prototype,lt),rn&&e3(gt,rn),gt}function P8(gt,lt,rn){return lt in gt?Object.defineProperty(gt,lt,{value:rn,enumerable:!0,configurable:!0,writable:!0}):gt[lt]=rn,gt}function t3(){var gt;return null!==(gt=tl)&&void 0!==gt?gt:document}var j3={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},go=os({},j3),ni={},tl=null,Yh=function(gt,lt,rn,i1,Vs){return"top-left"===gt?"left:".concat(i1,";top:").concat(lt,";text-align:left;align-items:flex-start;"):"top-right"===gt?"right:".concat(Vs,";top:").concat(lt,";text-align:right;align-items:flex-end;"):"top-center"===gt?"top:".concat(lt,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===gt?"left:".concat(i1,";bottom:").concat(rn,";text-align:left;align-items:flex-start;"):"bottom-right"===gt?"right:".concat(Vs,";bottom:").concat(rn,";text-align:right;align-items:flex-end;"):"bottom-center"===gt?"bottom:".concat(rn,";left:0;right:0;text-align:center;align-items:center;"):"center"===gt?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},T8=function(){function gt(lt){var rn=this;W3(this,gt),this.element=t3().createElement("div"),this.opacity=lt.opacity,this.type=lt.type,this.animate=lt.animate,this.dismissible=lt.dismissible,this.closeOnClick=lt.closeOnClick,this.message=lt.message,this.duration=lt.duration,this.pauseOnHover=lt.pauseOnHover,this.offsetTop=lt.offsetTop,this.offsetBottom=lt.offsetBottom,this.offsetLeft=lt.offsetLeft,this.offsetRight=lt.offsetRight,this.extraClasses=lt.extraClasses;var i1="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),Vs=["notification",this.extraClasses];if(this.type&&Vs.push(this.type),this.animate&&this.animate.in){var kn="animate__".concat(this.animate.in),ir=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";Vs.push("animate__animated ".concat(kn," ").concat(ir)),this.onAnimationEnd(function(){return rn.element.classList.remove(kn)})}if(this.element.className=Vs.join(" "),this.dismissible){var Z3=t3().createElement("button");Z3.className="delete",Z3.addEventListener("click",function(){rn.destroy()}),this.element.insertAdjacentElement("afterbegin",Z3)}else i1+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){rn.destroy()}),this.element.setAttribute("style",i1),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var B5=new r3(function(){rn.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){B5.pause()}),this.element.addEventListener("mouseout",function(){B5.resume()}))}return H1(gt,[{key:"destroy",value:function(){var lt=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){lt.removeParent(lt.element.parentNode),lt.element.remove(),delete ni.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete ni.position)}},{key:"removeParent",value:function(lt){lt&&1>=lt.children.length&&lt.remove()}},{key:"onAnimationEnd",value:function(){var lt=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},rn={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var i1 in rn)if(void 0!==this.element.style[i1]){this.element.addEventListener(rn[i1],function(){return lt()});break}}}]),gt}(),r3=function(){function gt(lt,rn){W3(this,gt),this.remaining=rn,this.callback=lt,this.resume()}return H1(gt,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),gt}();gc.resetDefaults=function(){go=os({},j3)},gc.setDefaults=function(gt){go=os(os({},j3),gt)},gc.setDoc=function mc(gt){for(var lt in ni)ni[lt].remove();ni={},tl=gt},gc.toast=function n3(gt){if(!gt.message)throw new Error("message is required");var lt=os(os({},go),gt),rn=new T8(lt),i1=function _n(gt,lt,rn,i1,Vs,kn){if(ni.position)return ni.position;var ir=t3().createElement("div");return ir.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+Yh(lt,rn,i1,Vs,kn)),gt.appendChild(ir),ni.position=ir,ir}(lt.appendTo||t3().body,lt.position||go.position,lt.offsetTop||go.offsetTop,lt.offsetBottom||go.offsetBottom,lt.offsetLeft||go.offsetLeft,lt.offsetRight||go.offsetRight);if(lt.single)for(var Vs=i1.lastElementChild;Vs;)i1.removeChild(Vs),Vs=i1.lastElementChild;i1.appendChild(rn.element)},Object.defineProperty(gc,"__esModule",{value:!0})}(F5)},7742:(Zh,F5,gc)=>{"use strict";gc.d(F5,{XJ:()=>Mu,pQ:()=>XC,Q:()=>Yb});class vn{constructor(a){this.digits=a}static zero(){return new vn([0])}static one(){return new vn([1])}clone(){return new vn(this.digits.slice())}add(a){const l=this.clone();return l.addToSelf(a),l}addToSelf(a){const l=Math.max(this.digits.length,a.digits.length);let f=0;for(let p=0;p<l;p++){let _=f;p<this.digits.length&&(_+=this.digits[p]),p<a.digits.length&&(_+=a.digits[p]),_>=10?(this.digits[p]=_-10,f=1):(this.digits[p]=_,f=0)}f>0&&(this.digits[l]=1)}toString(){let a="";for(let l=this.digits.length-1;l>=0;l--)a+=this.digits[l];return a}}class G5{constructor(a){this.powerOfTwos=[a]}getValue(){return this.powerOfTwos[0]}multiplyBy(a){const l=vn.zero();return this.multiplyByAndAddTo(a,l),l}multiplyByAndAddTo(a,l){for(let f=0;0!==a;a>>>=1,f++)if(1&a){const p=this.getMultipliedByPowerOfTwo(f);l.addToSelf(p)}}getMultipliedByPowerOfTwo(a){for(let l=this.powerOfTwos.length;l<=a;l++){const f=this.powerOfTwos[l-1];this.powerOfTwos[l]=f.add(f)}return this.powerOfTwos[a]}}class oF{constructor(a){this.base=a,this.exponents=[new G5(vn.one())]}toThePowerOf(a){for(let l=this.exponents.length;l<=a;l++){const f=this.exponents[l-1].multiplyBy(this.base);this.exponents[l]=new G5(f)}return this.exponents[a]}}function p_(d){const a=function q2(d){let a=[];for(let l=0;l<d.length;l++){let f=d.charCodeAt(l);if(f>=55296&&f<=56319&&d.length>l+1){const p=d.charCodeAt(l+1);p>=56320&&p<=57343&&(l++,f=(f-55296<<10)+p-56320+65536)}f<=127?a.push(f):f<=2047?a.push(f>>6&31|192,63&f|128):f<=65535?a.push(f>>12|224,f>>6&63|128,63&f|128):f<=2097151&&a.push(f>>18&7|240,f>>12&63|128,f>>6&63|128,63&f|128)}return a}(d);let l=lT(a,0),f=lT(a,102072);return 0==l&&(0==f||1==f)&&(l^=319790063,f^=-1801410264),[l,f]}function lT(d,a){let p,l=2654435769,f=2654435769;const _=d.length;for(p=0;p+12<=_;p+=12){l=r2(l,w6(d,p,jr.Little)),f=r2(f,w6(d,p+4,jr.Little));const M=uT(l,f,a=r2(a,w6(d,p+8,jr.Little)));l=M[0],f=M[1],a=M[2]}return l=r2(l,w6(d,p,jr.Little)),f=r2(f,w6(d,p+4,jr.Little)),a=r2(a,_),uT(l,f,a=r2(a,w6(d,p+8,jr.Little)<<8))[2]}function uT(d,a,l){return d=ri(d,a),d=ri(d,l),d^=l>>>13,a=ri(a,l),a=ri(a,d),a^=d<<8,l=ri(l,d),l=ri(l,a),l^=a>>>13,d=ri(d,a),d=ri(d,l),d^=l>>>12,a=ri(a,l),a=ri(a,d),a^=d<<16,l=ri(l,d),l=ri(l,a),l^=a>>>5,d=ri(d,a),d=ri(d,l),d^=l>>>3,a=ri(a,l),a=ri(a,d),a^=d<<10,l=ri(l,d),l=ri(l,a),[d,a,l^=a>>>15]}var jr=(()=>((jr=jr||{})[jr.Little=0]="Little",jr[jr.Big=1]="Big",jr))();function r2(d,a){return fT(d,a)[1]}function fT(d,a){const l=(65535&d)+(65535&a),f=(d>>>16)+(a>>>16)+(l>>>16);return[f>>>16,f<<16|65535&l]}function ri(d,a){const l=(65535&d)-(65535&a);return(d>>16)-(a>>16)+(l>>16)<<16|65535&l}function m_(d,a){return a>=d.length?0:d[a]}function w6(d,a,l){let f=0;if(l===jr.Big)for(let p=0;p<4;p++)f+=m_(d,a+p)<<24-8*p;else for(let p=0;p<4;p++)f+=m_(d,a+p)<<8*p;return f}const td=new oF(256);function WC(d,a,l,f,p=[]){const _={},M={},N={},R=function jC(d,a){const{text:l,block:f}=hf(d,a);if(void 0===f)return{text:l};{const[p,..._]=f.split("\u241f"),[M,N]=p.split("@@",2);let[R,H]=M.split("|",2);return void 0===H&&(H=R,R=void 0),""===H&&(H=void 0),{text:l,meaning:R,description:H,customId:N,legacyIds:_}}}(d[0],d.raw[0]),H=[R.text],q=[];let se=R.text;for(let Fe=1;Fe<d.length;Fe++){const{messagePart:yt,placeholderName:it=S3(Fe),associatedMessageId:Ct}=ZC(d[Fe],d.raw[Fe]);se+=`{$${it}}${yt}`,void 0!==a&&(_[it]=a[Fe-1],M[it]=p[Fe-1]),q.push(it),void 0!==Ct&&(N[it]=Ct),H.push(yt)}const we=R.customId||function g_(d,a=""){let l=p_(d);if(a){const _=p_(a);l=function hT(d,a){const l=d[0],p=a[0],M=fT(d[1],a[1]),N=M[0],R=M[1];return[r2(r2(l,p),N),R]}(function lF(d,a){const l=d[0],f=d[1];return[l<<a|f>>>32-a,f<<a|l>>>32-a]}(l,1),_)}return function C_(d,a){const l=td.toThePowerOf(0).multiplyBy(a);return td.toThePowerOf(4).multiplyByAndAddTo(d,l),l.toString()}(2147483647&l[0],l[1])}(se,R.meaning||""),Be=R.legacyIds?R.legacyIds.filter(Fe=>Fe!==we):[];return{id:we,legacyIds:Be,substitutions:_,substitutionLocations:M,text:se,customId:R.customId,meaning:R.meaning||"",description:R.description||"",messageParts:H,messagePartLocations:f,placeholderNames:q,associatedMessageIds:N,location:l}}function ZC(d,a){const{text:l,block:f}=hf(d,a);if(void 0===f)return{messagePart:l};{const[p,_]=f.split("@@");return{messagePart:l,placeholderName:p,associatedMessageId:_}}}function hf(d,a){if(":"!==a.charAt(0))return{text:d};{const l=Eu(d,a);return{block:d.substring(1,l),text:d.substring(l+1)}}}function S3(d){return 1===d?"PH":"PH_"+(d-1)}function Eu(d,a){for(let l=1,f=1;l<d.length;l++,f++)if("\\"===a[f])f++;else if(":"===d[l])return l;throw new Error(`Unterminated $localize metadata block in "${a}".`)}class df extends Error{constructor(a){super(`No translation found for ${KC(a)}.`),this.parsedMessage=a,this.type="MissingTranslationError"}}function YC(d,a){return Object.defineProperty(d,"raw",{value:a}),d}function KC(d){const a=d.meaning&&` - "${d.meaning}"`,l=d.legacyIds&&d.legacyIds.length>0?` [${d.legacyIds.map(f=>`"${f}"`).join(", ")}]`:"";return`"${d.id}"${l} ("${d.text}"${a})`}function Mu(d){$localize.translate||($localize.translate=vB),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(d).forEach(a=>{$localize.TRANSLATIONS[a]=function tp(d){const a=d.split(/{\$([^}]*)}/),l=[a[0]],f=[];for(let _=1;_<a.length-1;_+=2)f.push(a[_]),l.push(`${a[_+1]}`);const p=l.map(_=>":"===_.charAt(0)?"\\"+_:_);return{text:d,messageParts:YC(l,p),placeholderNames:f}}(d[a])})}function vB(d,a){try{return function jb(d,a,l){const f=WC(a,l);let p=d[f.id];if(void 0!==f.legacyIds)for(let _=0;_<f.legacyIds.length&&void 0===p;_++)p=d[f.legacyIds[_]];if(void 0===p)throw new df(f);return[p.messageParts,p.placeholderNames.map(_=>{if(f.substitutions.hasOwnProperty(_))return f.substitutions[_];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${KC(f)}.\nThe translation contains a placeholder with name ${_}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,d,a)}catch(l){return console.warn(l.message),[d,a]}}const Yb=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),XC=function(d,...a){if(XC.translate){const f=XC.translate(d,a);d=f[0],a=f[1]}let l=QC(d[0],d.raw[0]);for(let f=1;f<d.length;f++)l+=a[f-1]+QC(d[f],d.raw[f]);return l};function QC(d,a){return":"===a.charAt(0)?d.substring(Eu(d,a)+1):d}}},Zh=>{Zh(Zh.s=5353)}]);