!function(){var e,t,n,r,i,o,a,s,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,C,E,O,S,P,I,T,A,N,x,R,M,D,L,B,F,j,U,V,z,H,G,q,W,$,Z,Q,Y,K,J,X,ee,te,ne,re,ie,oe,ae,se,ue,ce,le,he,fe,de,pe,ve,ge,ye,me,be,_e,we,ke,Ce,Ee,Oe,Se,Pe,Ie,Te,Ae,Ne,xe,Re,Me,De,Le,Be,Fe,je,Ue,Ve,ze,He,Ge,qe,We,$e,Ze,Qe,Ye,Ke,Je,Xe,et,tt,nt,rt,it,ot,at,st,ut,ct,lt,ht,ft,dt,pt,vt,gt,yt,mt,bt,_t,wt,kt,Ct,Et,Ot,St,Pt,It,Tt,At,Nt,xt,Rt,Mt,Dt,Lt,Bt,Ft,jt,Ut,Vt,zt,Ht,Gt,qt,Wt,$t,Zt,Qt,Yt,Kt,Jt,Xt,en,tn,nn,rn,on,an,sn,un,cn,ln,hn,fn,dn,pn,vn,gn,yn,mn,bn,_n,wn,kn,Cn,En,On,Sn,Pn,In,Tn,An,Nn,xn,Rn,Mn,Dn,Ln,Bn,Fn,jn,Un,Vn,zn,Hn,Gn,qn,Wn,$n,Zn,Qn,Yn,Kn,Jn,Xn,er,tr,nr,rr,ir,or,ar,sr,ur,cr,lr,hr,fr,dr,pr,vr,gr,yr,mr,br,_r,wr,kr,Cr,Er,Or,Sr,Pr,Ir,Tr,Ar,Nr,xr,Rr,Mr,Dr,Lr,Br,Fr,jr,Ur,Vr,zr,Hr,Gr,qr,Wr,$r,Zr,Qr,Yr,Kr,Jr,Xr,ei,ti,ni,ri,ii,oi,ai,si,ui,ci,li,hi,fi,di,pi,vi,gi,yi,mi,bi,_i,wi,ki,Ci,Ei,Oi,Si,Pi,Ii,Ti,Ai,Ni,xi,Ri,Mi,Di,Li,Bi,Fi,ji,Ui,Vi,zi,Hi,Gi,qi,Wi,$i,Zi,Qi,Yi,Ki,Ji,Xi,eo,to,no,ro,io,oo,ao,so,uo,co,lo,ho,fo,po,vo,go,yo,mo,bo,_o,wo,ko,Co,Eo,Oo,So,Po,Io,To,Ao,No,xo,Ro,Mo,Do,Lo,Bo,Fo,jo,Uo,Vo,zo,Ho,Go,qo,Wo,$o,Zo,Qo,Yo,Ko,Jo,Xo,ea,ta,na,ra,ia,oa,aa,sa,ua,ca,la,ha,fa,da,pa,va,ga,ya,ma,ba,_a,wa,ka,Ca,Ea,Oa,Sa,Pa,Ia,Ta,Aa,Na,xa,Ra,Ma,Da,La,Ba,Fa,ja,Ua,Va,za,Ha,Ga,qa,Wa,$a,Za,Qa,Ya,Ka,Ja,Xa,es,ts,ns,rs,is,os,as,ss,us,cs,ls,hs,fs,ds,ps,vs,gs,ys,ms,bs,_s,ws,ks,Cs,Es,Os,Ss,Ps,Is,Ts,As,Ns,xs,Rs,Ms,Ds,Ls,Bs,Fs,js,Us,Vs,zs,Hs,Gs,qs,Ws,$s,Zs,Qs,Ys,Ks,Js,Xs,eu,tu,nu,ru,iu,ou,au,su,uu,cu,lu,hu,fu,du,pu,vu,gu,yu,mu,bu,_u,wu,ku,Cu,Eu,Ou,Su,Pu,Iu,Tu,Au,Nu,xu,Ru,Mu,Du,Lu,Bu,Fu,ju,Uu,Vu,zu,Hu,Gu,qu,Wu,$u,Zu,Qu,Yu,Ku,Ju,Xu,ec,tc,nc,rc,ic,oc,ac,sc,uc,cc,lc,hc,fc,dc,pc,vc,gc,yc,mc,bc,_c,wc,kc,Cc,Ec,Oc,Sc,Pc,Ic,Tc,Ac,Nc,xc,Rc,Mc,Dc,Lc,Bc,Fc,jc,Uc,Vc,zc,Hc,Gc,qc,Wc,$c,Zc,Qc,Yc,Kc,Jc,Xc,el,tl,nl,rl,il,ol,al,sl,ul,cl,ll,hl,fl,dl,pl,vl,gl,yl,ml,bl,_l,wl,kl,Cl,El,Ol,Sl,Pl,Il,Tl,Al,Nl,xl,Rl,Ml,Dl,Ll,Bl,Fl,jl,Ul,Vl,zl,Hl,Gl,ql,Wl,$l,Zl,Ql,Yl,Kl,Jl,Xl,eh,th,nh,rh,ih,oh,ah,sh,uh,ch,lh,hh,fh,dh,ph,vh,gh,yh,mh,bh,_h,wh,kh,Ch,Eh,Oh,Sh,Ph,Ih,Th,Ah,Nh,xh,Rh,Mh,Dh,Lh,Bh,Fh,jh,Uh,Vh,zh,Hh,Gh,qh,Wh,$h,Zh,Qh,Yh,Kh,Jh,Xh,ef,tf,nf,rf,of,af,sf,uf,cf,lf,hf,ff,df,pf,vf,gf,yf,mf,bf,_f,wf,kf,Cf,Ef,Of,Sf,Pf,If,Tf,Af,Nf,xf,Rf,Mf,Df,Lf,Bf,Ff,jf,Uf,Vf,zf,Hf,Gf,qf,Wf,$f,Zf,Qf,Yf,Kf,Jf,Xf,ed,td,nd,rd,id,od,ad,sd,ud,cd,ld,hd,fd,dd,pd,vd,gd,yd,md,bd,_d,wd,kd,Cd,Ed,Od,Sd,Pd,Id,Td,Ad,Nd,xd,Rd,Md,Dd,Ld,Bd,Fd,jd,Ud,Vd,zd,Hd,Gd,qd,Wd,$d,Zd,Qd,Yd,Kd,Jd,Xd,ep,tp,np,rp,ip,op,ap,sp,up,cp,lp,hp,fp,dp,pp,vp,gp,yp,mp,bp,_p,wp,kp,Cp,Ep,Op,Sp,Pp,Ip,Tp,Ap,Np;function xp(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Rp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Mp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rp(Object(n),!0).forEach(function(t){Dp(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rp(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Dp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lp(e){return jp(e)||Vp(e)||Hp(e)||Fp()}function Bp(e,t){return jp(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(u){s=!0,i=u}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}(e,t)||Hp(e,t)||Fp()}function Fp(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jp(e){if(Array.isArray(e))return e}function Up(e){return function(e){if(Array.isArray(e))return Gp(e)}(e)||Vp(e)||Hp(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vp(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function zp(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Hp(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Hp(e,t){if(e){if("string"==typeof e)return Gp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gp(e,t):void 0}}function Gp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qp(e){var t="function"==typeof Map?new Map:void 0;return(qp=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Wp(e,arguments,iv(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Xp(r,e)})(e)}function Wp(e,t,n){return(Wp=rv()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Xp(i,n.prototype),i}).apply(null,arguments)}function $p(){return($p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Zp(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function Zp(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=iv(e)););return e}function Qp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kp(e,t,n){return t&&Yp(e.prototype,t),n&&Yp(e,n),e}function Jp(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xp(e,t)}function Xp(e,t){return(Xp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ev(e){var t=rv();return function(){var n,r=iv(e);if(t){var i=iv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return tv(this,n)}}function tv(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return nv(e)}function nv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rv(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function iv(e){return(iv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"/6Yf":function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return a});var r=n("mrSG"),i=n("qOnz"),o=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),a=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new i.a;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:"[DEFAULT]"})}catch(l){}try{for(var i=Object(r.g)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var a=Object(r.e)(o.value,2),s=a[1],u=this.normalizeInstanceIdentifier(a[0]);try{var c=this.getOrInitializeService({instanceIdentifier:u});s.resolve(c)}catch(l){}}}catch(h){t={error:h}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e="[DEFAULT]"),this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return Object(r.b)(this,void 0,void 0,function(){var e;return Object(r.d)(this,function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(Object(r.f)(Object(r.f)([],Object(r.e)(e.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()}))),Object(r.e)(e.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))))];case 1:return t.sent(),[2]}})})},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e="[DEFAULT]"),this.instances.has(e)},e.prototype.getOptions=function(e){return void 0===e&&(e="[DEFAULT]"),this.instancesOptions.get(e)||{}},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var i=e.options,o=void 0===i?{}:i,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(this.name+"("+a+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:a,options:o});try{for(var u=Object(r.g)(this.instancesDeferred.entries()),c=u.next();!c.done;c=u.next()){var l=Object(r.e)(c.value,2),h=l[1];a===this.normalizeInstanceIdentifier(l[0])&&h.resolve(s)}}catch(f){t={error:f}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return s},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&e(o,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,i,o=this.onInitCallbacks.get(t);if(o)try{for(var a=Object(r.g)(o),s=a.next();!s.done;s=a.next()){var u=s.value;try{u(e,t)}catch(c){}}}catch(l){n={error:l}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,"[DEFAULT]"===t?void 0:t),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(a){}return o||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e="[DEFAULT]"),this.component?this.component.multipleInstances?e:"[DEFAULT]":e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}(),s=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new a(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}()},0:function(e,t,n){e.exports=n("zUnb")},"2QA8":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()},"2fFW":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=e},get useDeprecatedSynchronousErrorHandling(){return r}}},"3N8a":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return Kp(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=!!i&&i||new Error(i)}if(r)return this.unsubscribe(),n}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),n}(function(e){Jp(n,e);var t=ev(n);function n(e,r){return Qp(this,n),t.call(this)}return Kp(n,[{key:"schedule",value:function(e){return this}}]),n}(n("quSY").a))},"3UD+":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"5+tZ":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("lJxs"),i=n("Cfvw"),o=n("zx2A");function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof t?function(o){return o.pipe(a(function(n,o){return Object(i.a)(e(n,o)).pipe(Object(r.a)(function(e,r){return t(n,e,o,r)}))},n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new s(e,n))})}var s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;Qp(this,e),this.project=t,this.concurrent=n}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new u(e,this.project,this.concurrent))}}]),e}(),u=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return Qp(this,n),(i=t.call(this,e)).project=r,i.concurrent=o,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return Kp(n,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}},{key:"_innerSub",value:function(e){var t=new o.a(this),n=this.destination;n.add(t);var r=Object(o.c)(e,t);r!==t&&n.add(r)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(e){this.destination.next(e)}},{key:"notifyComplete",value:function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),n}(o.b)},"6Uf2":function(e,t,n){"use strict";(function(e){var t=n("zIRd"),r=n("/6Yf"),i=n("qOnz"),o=n("mrSG"),a=n("q/0M"),s="";function u(e){s=e}var c,l=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Object(i.I)(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Object(i.C)(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),h=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return Object(i.h)(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),f=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new l(t)}}catch(n){}return new h},d=f("localStorage"),p=f("sessionStorage"),v=new a.b("@firebase/database"),g=(c=1,function(){return c++}),y=function(e){var t=Object(i.H)(e),n=new i.c;n.update(t);var r=n.digest();return i.f.encodeByteArray(r)},m=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r="",o=0;o<t.length;o++){var a=t[o];Array.isArray(a)||a&&"object"==typeof a&&"number"==typeof a.length?r+=e.apply(null,a):r+="object"==typeof a?Object(i.I)(a):a,r+=" "}return r},b=null,_=!0,w=function(e,t){Object(i.d)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(v.logLevel=a.a.VERBOSE,b=v.log.bind(v),t&&p.set("logging_enabled",!0)):"function"==typeof e?b=e:(b=null,p.remove("logging_enabled"))},k=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===_&&(_=!1,null===b&&!0===p.get("logging_enabled")&&w(!0)),b){var n=m.apply(null,e);b(n)}},C=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];k.apply(void 0,Object(o.f)([e],Object(o.e)(t)))}},E=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+m.apply(void 0,Object(o.f)([],Object(o.e)(e)));v.error(n)},O=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+m.apply(void 0,Object(o.f)([],Object(o.e)(e)));throw v.error(n),new Error(n)},S=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+m.apply(void 0,Object(o.f)([],Object(o.e)(e)));v.warn(n)},P=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},I="[MIN_NAME]",T="[MAX_NAME]",A=function(e,t){if(e===t)return 0;if(e===I||t===T)return-1;if(t===I||e===T)return 1;var n=F(e),r=F(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},N=function(e,t){return e===t?0:e<t?-1:1},x=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Object(i.I)(t))},R=function e(t){if("object"!=typeof t||null===t)return Object(i.I)(t);var n=[];for(var r in t)n.push(r);n.sort();for(var o="{",a=0;a<n.length;a++)0!==a&&(o+=","),o+=Object(i.I)(n[a]),o+=":",o+=e(t[n[a]]);return o+"}"},M=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)r.push(e.substring(i,i+t>n?n:i+t));return r};function D(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var L=function(e){var t,n,r,o,a;Object(i.d)(!P(e),"Invalid JSON number"),0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(o=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,r=Math.round(e*Math.pow(2,52-o)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},B=new RegExp("^-?(0*)\\d{1,10}$"),F=function(e){if(B.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},j=function(e){try{e()}catch(t){setTimeout(function(){throw S("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}},U=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},V=function(){function e(e,t){var n=this;this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(function(e){return n.appCheck=e})}return e.prototype.getToken=function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise(function(n,r){setTimeout(function(){t.appCheck?t.getToken(e).then(n,r):n(null)},0)})},e.prototype.addTokenChangeListener=function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(function(t){return t.addTokenListener(e)})},e.prototype.notifyForInvalidToken=function(){S('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},e}(),z=function(){function e(e,t,n){var r=this;this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(function(e){return r.auth_=e})}return e.prototype.getToken=function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(k("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):new Promise(function(n,r){setTimeout(function(){t.auth_?t.getToken(e).then(n,r):n(null)},0)})},e.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(function(t){return t.addAuthTokenListener(e)})},e.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then(function(t){return t.removeAuthTokenListener(e)})},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';S(e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.')},e}(),H=function(){function e(e){this.accessToken=e}return e.prototype.getToken=function(e){return Promise.resolve({accessToken:this.accessToken})},e.prototype.addTokenChangeListener=function(e){e(this.accessToken)},e.prototype.removeTokenChangeListener=function(e){},e.prototype.notifyForInvalidToken=function(){},e.OWNER="owner",e}(),G=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,q=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=d.get("host:"+e)||this._host}return e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(e.prototype,"host",{get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&d.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host+"/"+(this.includeNamespaceInQueryParams?"?ns="+this.namespace:"")},e}();function W(e,t,n){var r;if(Object(i.d)("string"==typeof t,"typeof type must == string"),Object(i.d)("object"==typeof n,"typeof params must == object"),"websocket"===t)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if("long_polling"!==t)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var o=[];return D(n,function(e,t){o.push(e+"="+t)}),r+o.join("&")}var $=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),Object(i.h)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return Object(i.k)(this.counters_)},e}(),Z={},Q={};function Y(e){var t=e.toString();return Z[t]||(Z[t]=new $),Z[t]}var K=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&j(function(){n.onMessage_(e[t])})},r=0;r<e.length;++r)t(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},e}(),J=function(){function e(e,t,n,r,i,o,a){var s=this;this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=C(e),this.stats_=Y(t),this.urlFn=function(e){return s.appCheckToken&&(e.ac=s.appCheckToken),W(t,"long_polling",e)}}return e.prototype.open=function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new K(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if(Object(i.x)()||"complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!n.isClosed_){n.scriptTagHolder=new X(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Object(o.e)(e,5),i=r[0],a=r[1],s=r[2];if(n.incrementIncomingBytes_(e),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"===i)n.id=a,n.password=s;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Object(o.e)(e,2),i=r[0],a=r[1];n.incrementIncomingBytes_(e),n.myPacketOrderer.handleResponse(i,a)},function(){n.onClosed_()},n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&G.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return!(Object(i.x)()||!e.forceAllow_&&(e.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=Object(i.I)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=Object(i.g)(t),r=M(n,1840),o=0;o<r.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[o]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!Object(i.x)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=Object(i.I)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),X=function(){function e(t,n,r,o){if(this.onDisconnect=r,this.urlFn=o,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(i.x)())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=g(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(a='<script>document.domain="'+document.domain+'";<\/script>');var s="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(u){k("frame writing exception"),u.stack&&k(u.stack),k(u)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||k("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return this.addLongPollTag_(t+=n,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),r()})},e.prototype.addTag=function(e,t){var n=this;Object(i.x)()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){k("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}},Math.floor(1))},e}(),ee=null;"undefined"!=typeof MozWebSocket?ee=MozWebSocket:"undefined"!=typeof WebSocket&&(ee=WebSocket);var te=function(){function e(t,n,r,i,o,a,s){this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=C(this.connId),this.stats_=Y(n),this.connURL=e.connectionURL_(n,a,s,i),this.nodeAdmin=n.nodeAdmin}return e.connectionURL_=function(e,t,n,r){var o={v:"5"};return!Object(i.x)()&&"undefined"!=typeof location&&location.hostname&&G.test(location.hostname)&&(o.r="f"),t&&(o.s=t),n&&(o.ls=n),r&&(o.ac=r),W(e,"websocket",o)},e.prototype.open=function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,d.set("previous_websocket_failure",!0);try{if(Object(i.x)()){var r={headers:{"User-Agent":"Firebase/5/"+s+"/"+process.platform+"/"+(this.nodeAdmin?"AdminNode":"Node"),"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(r.headers.Authorization="Bearer "+this.authToken),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);var o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(r.proxy={origin:a}),this.mySock=new ee(this.connURL,[],r)}else this.mySock=new ee(this.connURL,[],r={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}})}catch(c){this.log_("Error instantiating WebSocket.");var u=c.message||c.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==ee&&!e.forceDisallow_},e.previouslyFailed=function(){return d.isInMemoryStorage||!0===d.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){d.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=Object(i.C)(t);this.onMessage(n)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(Object(i.d)(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=Object(i.I)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=M(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),ne=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[J,te]},enumerable:!1,configurable:!0}),e.prototype.initTransports_=function(t){var n,r,i=te&&te.isAvailable(),a=i&&!te.previouslyFailed();if(t.webSocketOnly&&(i||S("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),a=!0),a)this.transports_=[te];else{var s=this.transports_=[];try{for(var u=Object(o.g)(e.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var l=c.value;l&&l.isAvailable()&&s.push(l)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),re=function(){function e(e,t,n,r,i,o,a,s,u,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=s,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=C("c:"+this.id+":"),this.transportManager_=new ne(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=U(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){this.sendData_({t:"d",d:e})},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=x("t",e),n=x("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=x("t",e),n=x("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=x("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?E("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&S("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),U(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):U(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(d.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),ie=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.refreshAppCheckToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),oe=function(){function e(e){this.allowedEvents_=e,this.listeners_={},Object(i.d)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=Object(o.f)([],Object(o.e)(this.listeners_[e])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.validateEventType_=function(e){Object(i.d)(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)},e}(),ae=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Object(i.v)()||(window.addEventListener("online",function(){t.online_||(t.online_=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.online_&&(t.online_=!1,t.trigger("online",!1))},!1)),t}return Object(o.c)(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Object(i.d)("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(oe),se=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e}();function ue(){return new se("")}function ce(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function le(e){return e.pieces_.length-e.pieceNum_}function he(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new se(e.pieces_,t)}function fe(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function de(e,t){return void 0===t&&(t=0),e.pieces_.slice(e.pieceNum_+t)}function pe(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new se(t,0)}function ve(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof se)for(r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{var i=t.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new se(n,0)}function ge(e){return e.pieceNum_>=e.pieces_.length}function ye(e,t){var n=ce(e),r=ce(t);if(null===n)return t;if(n===r)return ye(he(e),he(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function me(e,t){for(var n=de(e,0),r=de(t,0),i=0;i<n.length&&i<r.length;i++){var o=A(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function be(e,t){if(le(e)!==le(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function _e(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(le(e)>le(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var we=function(e,t){this.errorPrefix_=t,this.parts_=de(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=Object(i.G)(this.parts_[n]);ke(this)};function ke(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Ce(e))}function Ce(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var Ee,Oe,Se=function(e){function t(){var t,n,r=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",t="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",t="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var e=!document[t];e!==r.visible_&&(r.visible_=e,r.trigger("visible",e))},!1),r}return Object(o.c)(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Object(i.d)("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(oe),Pe=function(e){function t(n,r,o,a,s,u,c,l){var h=e.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=o,h.onConnectStatus_=a,h.onServerInfoUpdate_=s,h.authTokenProvider_=u,h.appCheckTokenProvider_=c,h.authOverride_=l,h.id=t.nextPersistentConnectionId_++,h.log_=C("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=1e3,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,l&&!Object(i.x)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Se.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&ae.getInstance().on("online",h.onOnline_,h),h}return Object(o.c)(t,e),t.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,o={r:r,a:e,b:t};this.log_(Object(i.I)(o)),Object(i.d)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),n&&(this.requestCBHash_[r]=n)},t.prototype.get=function(e){var t=this;this.initConnection_();var n=new i.a,r={p:e._path.toString(),q:e._queryObject},o={action:"g",request:r,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var e=t.outstandingGets_[a];void 0!==e&&o===e&&(delete t.outstandingGets_[a],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(a),n.promise},t.prototype.listen=function(e,t,n,r){this.initConnection_();var o=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),Object(i.d)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Object(i.d)(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(o,s),this.connected_&&this.sendListen_(s)},t.prototype.sendGet_=function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})},t.prototype.sendListen_=function(e){var n=this,r=e.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};e.tag&&(a.q=r._queryObject,a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,u=a.s;t.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===e&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),e.onComplete&&e.onComplete(u,s))})},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&Object(i.h)(e,"w")){var n=Object(i.F)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();S("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+o+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||Object(i.p)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},t.prototype.refreshAppCheckToken=function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},function(){})},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=Object(i.B)(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}},t.prototype.tryAppCheck=function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)})},t.prototype.unlisten=function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Object(i.d)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)},t.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},t.prototype.onDisconnectMerge=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},t.prototype.onDisconnectCancel=function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})},t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},t.prototype.putInternal=function(e,t,n,r,i){this.initConnection_();var o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)})},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,function(e){"ok"!==e.s&&t.log_("reportStats","Error sending stats: "+e.d)})}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+Object(i.I)(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):E("Unrecognized action received from server: "+Object(i.I)(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;Object(i.d)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},t.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){return Object(o.b)(this,void 0,void 0,function(){var e,n,r,a,s,u,c,l,h,f,d,p,v,g=this;return Object(o.d)(this,function(y){switch(y.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+t.nextConnectionId_++,s=this.lastSessionId,u=!1,c=null,this.realtime_={close:l=function(){c?c.close():(u=!0,r())},sendRequest:function(e){Object(i.d)(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(e)}},h=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,y.label=1;case 1:return y.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)])];case 2:return f=o.e.apply(void 0,[y.sent(),2]),d=f[0],p=f[1],u?k("getToken() completed but was canceled"):(k("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=p&&p.token,c=new re(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,function(e){S(e+" ("+g.repoInfo_.toString()+")"),g.interrupt("server_kill")},s)),[3,4];case 3:return v=y.sent(),this.log_("Failed to get token: "+v),u||(this.repoInfo_.nodeAdmin&&S(v),l()),[3,4];case 4:return[2]}})})},t.prototype.interrupt=function(e){k("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){k("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Object(i.t)(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map(function(e){return R(e)}).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var n,r=new se(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n},t.prototype.onAuthRevoked_=function(e,t){k("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onAppCheckRevoked_=function(e,t){k("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e,t,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=Object(o.g)(this.listens.values()),a=i.next();!a.done;a=i.next()){var s=a.value;try{for(var u=(n=void 0,Object(o.g)(s.values())),c=u.next();!c.done;c=u.next())this.sendListen_(c.value)}catch(f){n={error:f}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(d){e={error:d}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}for(l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)},t.prototype.sendConnectStats_=function(){var e={},t="js";Object(i.x)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+s.replace(/\./g,"-")]=1,Object(i.v)()?e["framework.cordova"]=1:Object(i.y)()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=ae.getInstance().currentlyOnline();return Object(i.t)(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(ie),Ie=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,n){return new e(t,n)},e}(),Te=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new Ie(I,e),r=new Ie(I,t);return 0!==this.compare(n,r)},e.prototype.minPost=function(){return Ie.MIN},e}(),Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return Ee},set:function(e){Ee=e},enumerable:!1,configurable:!0}),t.prototype.compare=function(e,t){return A(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw Object(i.e)("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return Ie.MIN},t.prototype.maxPost=function(){return new Ie(T,Ee)},t.prototype.makePost=function(e,t){return Object(i.d)("string"==typeof e,"KeyIndex indexValue must always be a string."),new Ie(e,Ee)},t.prototype.toString=function(){return".key"},t}(Te),Ne=new Ae,xe=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),Re=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:De.EMPTY_NODE,this.right=null!=o?o:De.EMPTY_NODE}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return De.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return De.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),Me=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Re(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),De=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE),this.comparator_=t,this.root_=n}return e.prototype.insert=function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Re.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Re.BLACK,null,null))},e.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new xe(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new xe(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new xe(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new xe(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new Me,e}();function Le(e,t){return A(e.name,t.name)}function Be(e,t){return A(e,t)}var Fe,je,Ue,Ve,ze,He=function(e){return"number"==typeof e?"number:"+L(e):"string:"+e},Ge=function(e){if(e.isLeafNode()){var t=e.val();Object(i.d)("string"==typeof t||"number"==typeof t||"object"==typeof t&&Object(i.h)(t,".sv"),"Priority must be a string or number.")}else Object(i.d)(e===Oe||e.isEmpty(),"priority of unexpected type.");Object(i.d)(e===Oe||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},qe=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,Object(i.d)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Ge(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return Fe},set:function(e){Fe=e},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return ge(t)?this:".priority"===ce(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,n){var r=ce(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(Object(i.d)(".priority"!==r||1===le(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(he(t),n)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+He(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?L(this.value_):this.value_,this.lazyHash_=y(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(Object(i.d)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var n=typeof t.value_,r=typeof this.value_,o=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return Object(i.d)(o>=0,"Unknown leaf type: "+n),Object(i.d)(a>=0,"Unknown leaf type: "+r),o===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-o},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){return e===this||!!e.isLeafNode()&&this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}(),We=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?A(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return Ie.MIN},t.prototype.maxPost=function(){return new Ie(T,new qe("[PRIORITY-POST]",Ue))},t.prototype.makePost=function(e,t){var n=je(e);return new Ie(t,new qe("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(Te)),$e=Math.log(2),Ze=function(){function e(e){this.count=parseInt(Math.log(e+1)/$e,10),this.current_=this.count-1;var t=parseInt(Array(this.count+1).join("1"),2);this.bits_=e+1&t}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),Qe=function(e,t,n,r){e.sort(t);var i=function t(r,i){var o,a,s=i-r;if(0===s)return null;if(1===s)return o=e[r],a=n?n(o):o,new Re(a,o.node,Re.BLACK,null,null);var u=parseInt(s/2,10)+r,c=t(r,u),l=t(u+1,i);return o=e[u],a=n?n(o):o,new Re(a,o.node,Re.BLACK,c,l)},o=function(t){for(var r=null,o=null,a=e.length,s=function(t,r){var o=a-t,s=a;a-=t;var c=i(o+1,s),l=e[o],h=n?n(l):l;u(new Re(h,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(o=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?s(h,Re.BLACK):(s(h,Re.BLACK),s(h,Re.RED))}return o}(new Ze(e.length));return new De(r||t,o)},Ye={},Ke=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return Object(i.d)(Ye&&We,"ChildrenNode.ts has not been loaded"),Ve=Ve||new e({".priority":Ye},{".priority":We})},enumerable:!1,configurable:!0}),e.prototype.get=function(e){var t=Object(i.F)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof De?t:null},e.prototype.hasIndex=function(e){return Object(i.h)(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,n){Object(i.d)(t!==Ne,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,a=[],s=!1,u=n.getIterator(Ie.Wrap),c=u.getNext();c;)s=s||t.isDefinedOn(c.node),a.push(c),c=u.getNext();r=s?Qe(a,t.getCompare()):Ye;var l=t.toString(),h=Object(o.a)({},this.indexSet_);h[l]=t;var f=Object(o.a)({},this.indexes_);return f[l]=r,new e(f,h)},e.prototype.addToIndexes=function(t,n){var r=this;return new e(Object(i.D)(this.indexes_,function(e,o){var a=Object(i.F)(r.indexSet_,o);if(Object(i.d)(a,"Missing index implementation for "+o),e===Ye){if(a.isDefinedOn(t.node)){for(var s=[],u=n.getIterator(Ie.Wrap),c=u.getNext();c;)c.name!==t.name&&s.push(c),c=u.getNext();return s.push(t),Qe(s,a.getCompare())}return Ye}var l=n.get(t.name),h=e;return l&&(h=h.remove(new Ie(t.name,l))),h.insert(t,t.node)}),this.indexSet_)},e.prototype.removeFromIndexes=function(t,n){return new e(Object(i.D)(this.indexes_,function(e){if(e===Ye)return e;var r=n.get(t.name);return r?e.remove(new Ie(t.name,r)):e}),this.indexSet_)},e}(),Je=function(){function e(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Ge(this.priorityNode_),this.children_.isEmpty()&&Object(i.d)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return ze||(ze=new e(new De(Be),null,Ke.Default))},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||ze},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?ze:t},e.prototype.getChild=function(e){var t=ce(e);return null===t?this:this.getImmediateChild(t).getChild(he(e))},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,n){if(Object(i.d)(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r=new Ie(t,n),o=void 0,a=void 0;n.isEmpty()?(o=this.children_.remove(t),a=this.indexMap_.removeFromIndexes(r,this.children_)):(o=this.children_.insert(t,n),a=this.indexMap_.addToIndexes(r,this.children_));var s=o.isEmpty()?ze:this.priorityNode_;return new e(o,s,a)},e.prototype.updateChild=function(e,t){var n=ce(e);if(null===n)return t;Object(i.d)(".priority"!==ce(e)||1===le(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(he(e),t);return this.updateImmediateChild(n,r)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(We,function(a,s){n[a]=s.val(t),r++,o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!t&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+He(this.getPriority().val())+":"),this.forEachChild(We,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":y(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Ie(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new Ie(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new Ie(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,Ie.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,Ie.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Xe?-1:0},e.prototype.withIndex=function(t){if(t===Ne||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)},e.prototype.isIndexed=function(e){return e===Ne||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(We),r=t.getIterator(We),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===Ne?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),Xe=new(function(e){function t(){return e.call(this,new De(Be),Je.EMPTY_NODE,Ke.Default)||this}return Object(o.c)(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return Je.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(Je));function et(e,t){if(void 0===t&&(t=null),null===e)return Je.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),Object(i.d)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new qe(e,et(t));if(e instanceof Array){var n=Je.EMPTY_NODE;return D(e,function(t,r){if(Object(i.h)(e,t)&&"."!==t.substring(0,1)){var o=et(r);!o.isLeafNode()&&o.isEmpty()||(n=n.updateImmediateChild(t,o))}}),n.updatePriority(et(t))}var r=[],o=!1;if(D(e,function(e,t){if("."!==e.substring(0,1)){var n=et(t);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),r.push(new Ie(e,n)))}}),0===r.length)return Je.EMPTY_NODE;var a=Qe(r,Le,function(e){return e.name},Be);if(o){var s=Qe(r,We.getCompare());return new Je(a,et(t),new Ke({".priority":s},{".priority":We}))}return new Je(a,et(t),Ke.Default)}Object.defineProperties(Ie,{MIN:{value:new Ie(I,Je.EMPTY_NODE)},MAX:{value:new Ie(T,Xe)}}),Ae.__EMPTY_NODE=Je.EMPTY_NODE,qe.__childrenNodeConstructor=Je,Oe=Xe,Ue=Xe,je=et;var tt,nt,rt=function(e){function t(t){var n=e.call(this)||this;return n.indexPath_=t,Object(i.d)(!ge(t)&&".priority"!==ce(t),"Can't create PathIndex with empty path or .priority key"),n}return Object(o.c)(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?A(e.name,t.name):i},t.prototype.makePost=function(e,t){var n=et(e),r=Je.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ie(t,r)},t.prototype.maxPost=function(){var e=Je.EMPTY_NODE.updateChild(this.indexPath_,Xe);return new Ie(T,e)},t.prototype.toString=function(){return de(this.indexPath_,0).join("/")},t}(Te),it=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?A(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return Ie.MIN},t.prototype.maxPost=function(){return Ie.MAX},t.prototype.makePost=function(e,t){var n=et(e);return new Ie(t,n)},t.prototype.toString=function(){return".value"},t}(Te)),ot="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",at=(tt=0,nt=[],function(e){var t,n=e===tt;tt=e;var r=new Array(8);for(t=7;t>=0;t--)r[t]=ot.charAt(e%64),e=Math.floor(e/64);Object(i.d)(0===e,"Cannot push at time == 0");var o=r.join("");if(n){for(t=11;t>=0&&63===nt[t];t--)nt[t]=0;nt[t]++}else for(t=0;t<12;t++)nt[t]=Math.floor(64*Math.random());for(t=0;t<12;t++)o+=ot.charAt(nt[t]);return Object(i.d)(20===o.length,"nextPushId: Length should be 20."),o}),st=function(e){if("2147483647"===e)return"-";var t=F(e);if(null!=t)return""+(t+1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return T;var o=ot.charAt(ot.indexOf(n[i])+1);return n[i]=o,n.slice(0,i+1).join("")},ut=function(e){if("-2147483648"===e)return I;var t=F(e);if(null!=t)return""+(t-1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=ot.charAt(ot.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function ct(e){return{type:"value",snapshotNode:e}}function lt(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function ht(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function ft(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var dt=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,n,r,o,a){Object(i.d)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=e.getImmediateChild(t);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?e:(null!=a&&(n.isEmpty()?e.hasChild(t)?a.trackChildChange(ht(t,s)):Object(i.d)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(lt(t,n)):a.trackChildChange(ft(t,n,s))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(We,function(e,r){t.hasChild(e)||n.trackChildChange(ht(e,r))}),t.isLeafNode()||t.forEachChild(We,function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(ft(t,r,i))}else n.trackChildChange(lt(t,r))})),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?Je.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),pt=function(){function e(t){this.indexedFilter_=new dt(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new Ie(t,n))||(n=Je.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=Je.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(Je.EMPTY_NODE);var i=this;return t.forEachChild(We,function(e,t){i.matches(new Ie(e,t))||(r=r.updateImmediateChild(e,Je.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),vt=function(){function e(e){this.rangedFilter_=new pt(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new Ie(t,n))||(n=Je.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=Je.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=Je.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(Je.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(e,t){return l(t,e)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)a=i.getNext(),!h&&c(s,a)<=0&&(h=!0),h&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,Je.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,n,r,o){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(e,t){return s(t,e)}}else a=this.index_.getCompare();var u=e;Object(i.d)(u.numChildren()===this.limit_,"");var c=new Ie(t,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(t)){for(var f=u.getImmediateChild(t),d=r.getChildAfterChild(this.index_,l,this.reverse_);null!=d&&(d.name===t||u.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:a(d,c);if(h&&!n.isEmpty()&&p>=0)return null!=o&&o.trackChildChange(ft(t,n,f)),u.updateImmediateChild(t,n);null!=o&&o.trackChildChange(ht(t,f));var v=u.updateImmediateChild(t,Je.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=o&&o.trackChildChange(lt(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}return n.isEmpty()?e:h&&a(l,c)>=0?(null!=o&&(o.trackChildChange(ht(l.name,l.node)),o.trackChildChange(lt(t,n))),u.updateImmediateChild(t,n).updateImmediateChild(l.name,Je.EMPTY_NODE)):e},e}(),gt=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=We}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.hasStartAfter=function(){return this.startAfterSet_},e.prototype.hasEndBefore=function(){return this.endBeforeSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},e.prototype.getIndexStartValue=function(){return Object(i.d)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return Object(i.d)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:I},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return Object(i.d)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return Object(i.d)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:T},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return Object(i.d)(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===We},e.prototype.copy=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e}();function yt(e,t,n){var r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function mt(e,t,n){var r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function bt(e,t){var n=e.copy();return n.index_=t,n}function _t(e){var t,n={};return e.isDefault()||(e.index_===We?t="$priority":e.index_===it?t="$value":e.index_===Ne?t="$key":(Object(i.d)(e.index_ instanceof rt,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=Object(i.I)(t),e.startSet_&&(n.startAt=Object(i.I)(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+Object(i.I)(e.indexStartName_))),e.endSet_&&(n.endAt=Object(i.I)(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+Object(i.I)(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function wt(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==We&&(t.i=e.index_.toString()),t}var kt=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o.repoInfo_=t,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=C("p:rest:"),o.listens_={},o}return Object(o.c)(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(Object(i.d)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())},t.prototype.listen=function(e,n,r,o){var a=this,s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);var u=t.getListenId_(e,r),c={};this.listens_[u]=c;var l=_t(e._queryParams);this.restRequest_(s+".json",l,function(e,t){var n=t;404===e&&(n=null,e=null),null===e&&a.onDataUpdate_(s,n,!1,r),Object(i.F)(a.listens_,u)===c&&o(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})},t.prototype.unlisten=function(e,n){var r=t.getListenId_(e,n);delete this.listens_[r]},t.prototype.get=function(e){var t=this,n=_t(e._queryParams),r=e._path.toString(),o=new i.a;return this.restRequest_(r+".json",n,function(e,n){var i=n;404===e&&(i=null,e=null),null===e?(t.onDataUpdate_(r,i,!1,null),o.resolve(i)):o.reject(new Error(i))}),o.promise},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,n){var r=this;return void 0===t&&(t={}),t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(function(a){var s=Object(o.e)(a,2),u=s[0],c=s[1];u&&u.accessToken&&(t.auth=u.accessToken),c&&c.token&&(t.ac=c.token);var l=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?ns="+r.repoInfo_.namespace+Object(i.E)(t);r.log_("Sending REST request for "+l);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(n&&4===h.readyState){r.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);var e=null;if(h.status>=200&&h.status<300){try{e=Object(i.C)(h.responseText)}catch(t){S("Failed to parse JSON response for "+l+": "+h.responseText)}n(null,e)}else 401!==h.status&&404!==h.status&&S("Got unsuccessful REST response for "+l+" Status: "+h.status),n(h.status);n=null}},h.open("GET",l,!0),h.send()})},t}(ie),Ct=function(){function e(){this.rootNode_=Je.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}();function Et(){return{value:null,children:new Map}}function Ot(e,t,n){if(ge(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=ce(t);e.children.has(r)||e.children.set(r,Et()),Ot(e.children.get(r),t=he(t),n)}}function St(e,t){if(ge(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(We,function(t,n){Ot(e,new se(t),n)}),St(e,t)}if(e.children.size>0){var r=ce(t);return t=he(t),e.children.has(r)&&St(e.children.get(r),t)&&e.children.delete(r),0===e.children.size}return!0}function Pt(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(function(e,n){t(n,e)})}(e,function(e,r){Pt(r,new se(t.toString()+"/"+e),n)})}var It=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=Object(o.a)({},e);return this.last_&&D(this.last_,function(e,n){t[e]=t[e]-n}),this.last_=e,t},e}(),Tt=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new It(e);var n=1e4+2e4*Math.random();U(this.reportStats_.bind(this),Math.floor(n))}return e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),n={},r=!1;D(t,function(t,o){o>0&&Object(i.h)(e.statsToReport_,t)&&(n[t]=o,r=!0)}),r&&this.server_.reportStats(n),U(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},e}(),At=function(e){return e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",e}({});function Nt(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}var xt,Rt=function(){function e(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=At.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return e.prototype.operationForChild=function(t){if(ge(this.path)){if(null!=this.affectedTree.value)return Object(i.d)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new se(t));return new e(ue(),n,this.revert)}return Object(i.d)(ce(this.path)===t,"operationForChild called for unrelated child."),new e(he(this.path),this.affectedTree,this.revert)},e}(),Mt=function(){function e(e,t){this.source=e,this.path=t,this.type=At.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return ge(this.path)?new e(this.source,ue()):new e(this.source,he(this.path))},e}(),Dt=function(){function e(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=At.OVERWRITE}return e.prototype.operationForChild=function(t){return ge(this.path)?new e(this.source,ue(),this.snap.getImmediateChild(t)):new e(this.source,he(this.path),this.snap)},e}(),Lt=function(){function e(e,t,n){this.source=e,this.path=t,this.children=n,this.type=At.MERGE}return e.prototype.operationForChild=function(t){if(ge(this.path)){var n=this.children.subtree(new se(t));return n.isEmpty()?null:n.value?new Dt(this.source,ue(),n.value):new e(this.source,ue(),n)}return Object(i.d)(ce(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,he(this.path),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),Bt=function(){function e(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(ge(e))return this.isFullyInitialized()&&!this.filtered_;var t=ce(e);return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),Ft=function(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()};function jt(e,t,n,r,o,a){var s=r.filter(function(e){return e.type===n});s.sort(function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw Object(i.e)("Should only compare child_ events.");var r=new Ie(t.childName,t.snapshotNode),o=new Ie(n.childName,n.snapshotNode);return e.index_.compare(r,o)}(e,t,n)}),s.forEach(function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);o.forEach(function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))})})}function Ut(e,t){return{eventCache:e,serverCache:t}}function Vt(e,t,n,r){return Ut(new Bt(t,n,r),e.serverCache)}function zt(e,t,n,r){return Ut(e.eventCache,new Bt(t,n,r))}function Ht(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Gt(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var qt=function(){function e(e,t){void 0===t&&(xt||(xt=new De(N)),t=xt),this.value=e,this.children=t}return e.fromObject=function(t){var n=new e(null);return D(t,function(e,t){n=n.set(new se(e),t)}),n},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:ue(),value:this.value};if(ge(e))return null;var n=ce(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(he(e),t);return null!=i?{path:ve(new se(n),i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},e.prototype.subtree=function(t){if(ge(t))return this;var n=ce(t),r=this.children.get(n);return null!==r?r.subtree(he(t)):new e(null)},e.prototype.set=function(t,n){if(ge(t))return new e(n,this.children);var r=ce(t),i=(this.children.get(r)||new e(null)).set(he(t),n),o=this.children.insert(r,i);return new e(this.value,o)},e.prototype.remove=function(t){if(ge(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=ce(t),r=this.children.get(n);if(r){var i=r.remove(he(t)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new e(null):new e(this.value,o)}return this},e.prototype.get=function(e){if(ge(e))return this.value;var t=ce(e),n=this.children.get(t);return n?n.get(he(e)):null},e.prototype.setTree=function(t,n){if(ge(t))return n;var r,i=ce(t),o=(this.children.get(i)||new e(null)).setTree(he(t),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new e(this.value,r)},e.prototype.fold=function(e){return this.fold_(ue(),e)},e.prototype.fold_=function(e,t){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(ve(e,r),t)}),t(e,this.value,n)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,ue(),t)},e.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(ge(e))return null;var i=ce(e),o=this.children.get(i);return o?o.findOnPath_(he(e),ve(t,i),n):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,ue(),t)},e.prototype.foreachOnPath_=function(t,n,r){if(ge(t))return this;this.value&&r(n,this.value);var i=ce(t),o=this.children.get(i);return o?o.foreachOnPath_(he(t),ve(n,i),r):new e(null)},e.prototype.foreach=function(e){this.foreach_(ue(),e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal(function(n,r){r.foreach_(ve(e,n),t)}),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,n){n.value&&e(t,n.value)})},e}(),Wt=function(){function e(e){this.writeTree_=e}return e.empty=function(){return new e(new qt(null))},e}();function $t(e,t,n){if(ge(t))return new Wt(new qt(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,o=r.value,a=ye(i,t);return o=o.updateChild(a,n),new Wt(e.writeTree_.set(i,o))}var s=new qt(n),u=e.writeTree_.setTree(t,s);return new Wt(u)}function Zt(e,t,n){var r=e;return D(n,function(e,n){r=$t(r,ve(t,e),n)}),r}function Qt(e,t){if(ge(t))return Wt.empty();var n=e.writeTree_.setTree(t,new qt(null));return new Wt(n)}function Yt(e,t){return null!=Kt(e,t)}function Kt(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(ye(n.path,t)):null}function Jt(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(We,function(e,n){t.push(new Ie(e,n))}):e.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new Ie(e,n.value))}),t}function Xt(e,t){if(ge(t))return e;var n=Kt(e,t);return new Wt(null!=n?new qt(n):e.writeTree_.subtree(t))}function en(e){return e.writeTree_.isEmpty()}function tn(e,t){return nn(ue(),e.writeTree_,t)}function nn(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal(function(t,o){".priority"===t?(Object(i.d)(null!==o.value,"Priority writes must always be leaf nodes"),r=o.value):n=nn(ve(e,t),o,n)}),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(ve(e,".priority"),r)),n}function rn(e,t){return vn(t,e)}function on(e,t){if(e.snap)return _e(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&_e(ve(e.path,n),t))return!0;return!1}function an(e){return e.visible}function sn(e,t,n){for(var r=Wt.empty(),o=0;o<e.length;++o){var a=e[o];if(t(a)){var s=a.path,u=void 0;if(a.snap)_e(n,s)?r=$t(r,u=ye(n,s),a.snap):_e(s,n)&&(u=ye(s,n),r=$t(r,ue(),a.snap.getChild(u)));else{if(!a.children)throw Object(i.e)("WriteRecord should have .snap or .children");if(_e(n,s))r=Zt(r,u=ye(n,s),a.children);else if(_e(s,n))if(ge(u=ye(s,n)))r=Zt(r,ue(),a.children);else{var c=Object(i.F)(a.children,ce(u));if(c){var l=c.getChild(he(u));r=$t(r,ue(),l)}}}}}return r}function un(e,t,n,r,i){if(r||i){var o=Xt(e.visibleWrites,t);return!i&&en(o)?n:i||null!=n||Yt(o,ue())?tn(sn(e.allWrites,function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(_e(e.path,t)||_e(t,e.path))},t),n||Je.EMPTY_NODE):null}var a=Kt(e.visibleWrites,t);if(null!=a)return a;var s=Xt(e.visibleWrites,t);return en(s)?n:null!=n||Yt(s,ue())?tn(s,n||Je.EMPTY_NODE):null}function cn(e,t,n,r){return un(e.writeTree,e.treePath,t,n,r)}function ln(e,t){return function(e,t,n){var r=Je.EMPTY_NODE,i=Kt(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(We,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(n){var o=Xt(e.visibleWrites,t);return n.forEachChild(We,function(e,t){var n=tn(Xt(o,new se(e)),t);r=r.updateImmediateChild(e,n)}),Jt(o).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return Jt(Xt(e.visibleWrites,t)).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}(e.writeTree,e.treePath,t)}function hn(e,t,n,r){return function(e,t,n,r,o){Object(i.d)(r||o,"Either existingEventSnap or existingServerSnap must exist");var a=ve(t,n);if(Yt(e.visibleWrites,a))return null;var s=Xt(e.visibleWrites,a);return en(s)?o.getChild(n):tn(s,o.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function fn(e,t){return function(e,t){return Kt(e.visibleWrites,t)}(e.writeTree,ve(e.treePath,t))}function dn(e,t,n){return function(e,t,n,r){var i=ve(t,n),o=Kt(e.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?tn(Xt(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function pn(e,t){return vn(ve(e.treePath,t),e.writeTree)}function vn(e,t){return{treePath:e,writeTree:t}}var gn=function(){function e(){this.changeMap=new Map}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;Object(i.d)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Object(i.d)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var o=r.type;if("child_added"===t&&"child_removed"===o)this.changeMap.set(n,ft(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===o)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===o)this.changeMap.set(n,ht(n,r.oldSnap));else if("child_changed"===t&&"child_added"===o)this.changeMap.set(n,lt(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==o)throw Object(i.e)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,ft(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},e.prototype.getChanges=function(){return Array.from(this.changeMap.values())},e}(),yn=new(function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}()),mn=function(){function e(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new Bt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return dn(this.writes_,e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Gt(this.viewCache_),i=function(e,t,n,r,i,o){return function(e,t,n,r,i,o,a){var s,u=Xt(e.visibleWrites,t),c=Kt(u,ue());if(null!=c)s=c;else{if(null==n)return[];s=tn(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),d=f.getNext();d&&l.length<1;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(e.writeTree,e.treePath,t,n,0,i,o)}(this.writes_,r,t,0,n,e);return 0===i.length?null:i[0]},e}();function bn(e,t,n,r,o,a){var s=t.eventCache;if(null!=fn(r,n))return t;var u=void 0,c=void 0;if(ge(n))if(Object(i.d)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var l=Gt(t),h=ln(r,l instanceof Je?l:Je.EMPTY_NODE);u=e.filter.updateFullNode(t.eventCache.getNode(),h,a)}else{var f=cn(r,Gt(t));u=e.filter.updateFullNode(t.eventCache.getNode(),f,a)}else{var d=ce(n);if(".priority"===d){Object(i.d)(1===le(n),"Can't have a priority with additional path components");var p=s.getNode(),v=hn(r,n,p,c=t.serverCache.getNode());u=null!=v?e.filter.updatePriority(p,v):s.getNode()}else{var g=he(n),y=void 0;if(s.isCompleteForChild(d)){c=t.serverCache.getNode();var m=hn(r,n,s.getNode(),c);y=null!=m?s.getNode().getImmediateChild(d).updateChild(g,m):s.getNode().getImmediateChild(d)}else y=dn(r,d,t.serverCache);u=null!=y?e.filter.updateChild(s.getNode(),d,y,g,o,a):s.getNode()}}return Vt(t,u,s.isFullyInitialized()||ge(n),e.filter.filtersNodes())}function _n(e,t,n,r,i,o,a,s){var u,c=t.serverCache,l=a?e.filter:e.filter.getIndexedFilter();if(ge(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=ce(n);if(!c.isCompleteForPath(n)&&le(n)>1)return t;var d=he(n),p=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?l.updatePriority(c.getNode(),p):l.updateChild(c.getNode(),f,p,d,yn,null)}var v=zt(t,u,c.isFullyInitialized()||ge(n),l.filtersNodes());return bn(e,v,n,i,new mn(i,v,o),s)}function wn(e,t,n,r,i,o,a){var s,u,c=t.eventCache,l=new mn(i,t,o);if(ge(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,a),s=Vt(t,u,!0,e.filter.filtersNodes());else{var h=ce(n);if(".priority"===h)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=Vt(t,u,c.isFullyInitialized(),c.isFiltered());else{var f=he(n),d=c.getNode().getImmediateChild(h),p=void 0;if(ge(f))p=r;else{var v=l.getCompleteChild(h);p=null!=v?".priority"===fe(f)&&v.getChild(pe(f)).isEmpty()?v:v.updateChild(f,r):Je.EMPTY_NODE}s=d.equals(p)?t:Vt(t,e.filter.updateChild(c.getNode(),h,p,f,l,a),c.isFullyInitialized(),e.filter.filtersNodes())}}return s}function kn(e,t){return e.eventCache.isCompleteForChild(t)}function Cn(e,t,n){return n.foreach(function(e,n){t=t.updateChild(e,n)}),t}function En(e,t,n,r,i,o,a,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,c=t;u=ge(n)?r:new qt(null).setTree(n,r);var l=t.serverCache.getNode();return u.children.inorderTraversal(function(n,r){if(l.hasChild(n)){var u=Cn(0,t.serverCache.getNode().getImmediateChild(n),r);c=_n(e,c,new se(n),u,i,o,a,s)}}),u.children.inorderTraversal(function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=Cn(0,t.serverCache.getNode().getImmediateChild(n),r);c=_n(e,c,new se(n),h,i,o,a,s)}}),c}var On,Sn=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new dt(r.getIndex()),o=(n=r).loadsAllData()?new dt(n.getIndex()):n.hasLimit()?new vt(n):new pt(n);this.processor_=function(e){return{filter:e}}(o);var a=t.serverCache,s=t.eventCache,u=i.updateFullNode(Je.EMPTY_NODE,a.getNode(),null),c=o.updateFullNode(Je.EMPTY_NODE,s.getNode(),null),l=new Bt(u,a.isFullyInitialized(),i.filtersNodes()),h=new Bt(c,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Ut(h,l),this.eventGenerator_=new Ft(this.query_)}return Object.defineProperty(e.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),e}();function Pn(e,t){var n=Gt(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!ge(t)&&!n.getImmediateChild(ce(t)).isEmpty())?n.getChild(t):null}function In(e){return 0===e.eventRegistrations_.length}function Tn(e,t,n){var r=[];if(n){Object(i.d)(null==t,"A cancel should cancel all event registrations.");var o=e.query._path;e.eventRegistrations_.forEach(function(e){var t=e.createCancelEvent(n,o);t&&r.push(t)})}if(t){for(var a=[],s=0;s<e.eventRegistrations_.length;++s){var u=e.eventRegistrations_[s];if(u.matches(t)){if(t.hasAnyCallback()){a=a.concat(e.eventRegistrations_.slice(s+1));break}}else a.push(u)}e.eventRegistrations_=a}else e.eventRegistrations_=[];return r}function An(e,t,n,r){t.type===At.MERGE&&null!==t.source.queryId&&(Object(i.d)(Gt(e.viewCache_),"We should always have a full cache before handling merges"),Object(i.d)(Ht(e.viewCache_),"Missing event cache, even though we have a server cache"));var o,a,s=e.viewCache_,u=function(e,t,n,r,o){var a,s,u=new gn;if(n.type===At.OVERWRITE){var c=n;c.source.fromUser?a=wn(e,t,c.path,c.snap,r,o,u):(Object(i.d)(c.source.fromServer,"Unknown source."),s=c.source.tagged||t.serverCache.isFiltered()&&!ge(c.path),a=_n(e,t,c.path,c.snap,r,o,s,u))}else if(n.type===At.MERGE){var l=n;l.source.fromUser?a=function(e,t,n,r,i,o,a){var s=t;return r.foreach(function(r,u){var c=ve(n,r);kn(t,ce(c))&&(s=wn(e,s,c,u,i,o,a))}),r.foreach(function(r,u){var c=ve(n,r);kn(t,ce(c))||(s=wn(e,s,c,u,i,o,a))}),s}(e,t,l.path,l.children,r,o,u):(Object(i.d)(l.source.fromServer,"Unknown source."),s=l.source.tagged||t.serverCache.isFiltered(),a=En(e,t,l.path,l.children,r,o,s,u))}else if(n.type===At.ACK_USER_WRITE){var h=n;a=h.revert?function(e,t,n,r,o,a){var s;if(null!=fn(r,n))return t;var u=new mn(r,t,o),c=t.eventCache.getNode(),l=void 0;if(ge(n)||".priority"===ce(n)){var h=void 0;if(t.serverCache.isFullyInitialized())h=cn(r,Gt(t));else{var f=t.serverCache.getNode();Object(i.d)(f instanceof Je,"serverChildren would be complete if leaf node"),h=ln(r,f)}l=e.filter.updateFullNode(c,h=h,a)}else{var d=ce(n),p=dn(r,d,t.serverCache);null==p&&t.serverCache.isCompleteForChild(d)&&(p=c.getImmediateChild(d)),(l=null!=p?e.filter.updateChild(c,d,p,he(n),u,a):t.eventCache.getNode().hasChild(d)?e.filter.updateChild(c,d,Je.EMPTY_NODE,he(n),u,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&(s=cn(r,Gt(t))).isLeafNode()&&(l=e.filter.updateFullNode(l,s,a))}return s=t.serverCache.isFullyInitialized()||null!=fn(r,ue()),Vt(t,l,s,e.filter.filtersNodes())}(e,t,h.path,r,o,u):function(e,t,n,r,i,o,a){if(null!=fn(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(ge(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return _n(e,t,n,u.getNode().getChild(n),i,o,s,a);if(ge(n)){var c=new qt(null);return u.getNode().forEachChild(Ne,function(e,t){c=c.set(new se(e),t)}),En(e,t,n,c,i,o,s,a)}return t}var l=new qt(null);return r.foreach(function(e,t){var r=ve(n,e);u.isCompleteForPath(r)&&(l=l.set(e,u.getNode().getChild(r)))}),En(e,t,n,l,i,o,s,a)}(e,t,h.path,h.affectedTree,r,o,u)}else{if(n.type!==At.LISTEN_COMPLETE)throw Object(i.e)("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var o=t.serverCache;return bn(e,zt(t,o.getNode(),o.isFullyInitialized()||ge(n),o.isFiltered()),n,r,yn,i)}(e,t,n.path,r,u)}var f=u.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Ht(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(ct(Ht(t)))}}(t,a,f),{viewCache:a,changes:f}}(e.processor_,s,t,n,r);return o=e.processor_,a=u.viewCache,Object(i.d)(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),Object(i.d)(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),Object(i.d)(u.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=u.viewCache,Nn(e,u.changes,u.viewCache.eventCache.getNode(),null)}function Nn(e,t,n,r){return function(e,t,n,r){var i=[],o=[];return t.forEach(function(t){"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push({type:"child_moved",snapshotNode:t.snapshotNode,childName:t.childName})}),jt(e,i,"child_removed",t,r,n),jt(e,i,"child_added",t,r,n),jt(e,i,"child_moved",o,r,n),jt(e,i,"child_changed",t,r,n),jt(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,r?[r]:e.eventRegistrations_)}var xn,Rn=function(){this.views=new Map};function Mn(e,t,n,r){var a,s,u=t.source.queryId;if(null!==u){var c=e.views.get(u);return Object(i.d)(null!=c,"SyncTree gave us an op for an invalid query."),An(c,t,n,r)}var l=[];try{for(var h=Object(o.g)(e.views.values()),f=h.next();!f.done;f=h.next())l=l.concat(An(c=f.value,t,n,r))}catch(d){a={error:d}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}return l}function Dn(e,t,n,r,i){var o=e.views.get(t._queryIdentifier);if(!o){var a=cn(n,i?r:null),s=!1;a?s=!0:r instanceof Je?(a=ln(n,r),s=!1):(a=Je.EMPTY_NODE,s=!1);var u=Ut(new Bt(a,s,!1),new Bt(r,i,!1));return new Sn(t,u)}return o}function Ln(e){var t,n,r=[];try{for(var i=Object(o.g)(e.views.values()),a=i.next();!a.done;a=i.next()){var s=a.value;s.query._queryParams.loadsAllData()||r.push(s)}}catch(u){t={error:u}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function Bn(e,t){var n,r,i=null;try{for(var a=Object(o.g)(e.views.values()),s=a.next();!s.done;s=a.next())i=i||Pn(s.value,t)}catch(u){n={error:u}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function Fn(e,t){return t._queryParams.loadsAllData()?Vn(e):e.views.get(t._queryIdentifier)}function jn(e,t){return null!=Fn(e,t)}function Un(e){return null!=Vn(e)}function Vn(e){var t,n;try{for(var r=Object(o.g)(e.views.values()),i=r.next();!i.done;i=r.next()){var a=i.value;if(a.query._queryParams.loadsAllData())return a}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null}var zn=1,Hn=function(e){this.listenProvider_=e,this.syncPointTree_=new qt(null),this.pendingWriteTree_={visibleWrites:Wt.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function Gn(e,t,n,r,o){return function(e,t,n,r,o){Object(i.d)(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:o}),o&&(e.visibleWrites=$t(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,o),o?Yn(e,new Dt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function qn(e,t,n){void 0===n&&(n=!1);var r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){var n=e.allWrites.findIndex(function(e){return e.writeId===t});Object(i.d)(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var o=r.visible,a=!1,s=e.allWrites.length-1;o&&s>=0;){var u=e.allWrites[s];u.visible&&(s>=n&&on(u,r.path)?o=!1:_e(r.path,u.path)&&(a=!0)),s--}return!!o&&(a?(function(e){e.visibleWrites=sn(e.allWrites,an,ue()),e.lastWriteId=e.allWrites.length>0?e.allWrites[e.allWrites.length-1].writeId:-1}(e),!0):(r.snap?e.visibleWrites=Qt(e.visibleWrites,r.path):D(r.children,function(t){e.visibleWrites=Qt(e.visibleWrites,ve(r.path,t))}),!0))}(e.pendingWriteTree_,t)){var o=new qt(null);return null!=r.snap?o=o.set(ue(),!0):D(r.children,function(e){o=o.set(new se(e),!0)}),Yn(e,new Rt(r.path,o,n))}return[]}function Wn(e,t,n){return Yn(e,new Dt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function $n(e,t,n,r){var a=t._path,s=e.syncPointTree_.get(a),u=[];if(s&&("default"===t._queryIdentifier||jn(s,t))){var c=function(e,t,n,r){var a,s,u=t._queryIdentifier,c=[],l=[],h=Un(e);if("default"===u)try{for(var f=Object(o.g)(e.views.entries()),d=f.next();!d.done;d=f.next()){var p,v=Object(o.e)(d.value,2),g=v[0];l=l.concat(Tn(p=v[1],n,r)),In(p)&&(e.views.delete(g),p.query._queryParams.loadsAllData()||c.push(p.query))}}catch(y){a={error:y}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}else(p=e.views.get(u))&&(l=l.concat(Tn(p,n,r)),In(p)&&(e.views.delete(u),p.query._queryParams.loadsAllData()||c.push(p.query)));return h&&!Un(e)&&c.push(new(Object(i.d)(On,"Reference.ts has not been loaded"),On)(t._repo,t._path)),{removed:c,events:l}}(s,t,n,r);0===s.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(a));var l=c.removed;u=c.events;var h=-1!==l.findIndex(function(e){return e._queryParams.loadsAllData()}),f=e.syncPointTree_.findOnPath(a,function(e,t){return Un(t)});if(h&&!f){var d=e.syncPointTree_.subtree(a);if(!d.isEmpty())for(var p=function(e){return e.fold(function(e,t,n){if(t&&Un(t))return[Vn(t)];var r=[];return t&&(r=Ln(t)),D(n,function(e,t){r=r.concat(t)}),r})}(d),v=0;v<p.length;++v){var g=p[v],y=g.query,m=Xn(e,g);e.listenProvider_.startListening(or(y),er(e,y),m.hashFn,m.onComplete)}}!f&&l.length>0&&!r&&(h?e.listenProvider_.stopListening(or(t),null):l.forEach(function(t){var n=e.queryToTagMap.get(tr(t));e.listenProvider_.stopListening(or(t),n)})),function(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var i=tr(r),o=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(o)}}}(e,l)}return u}function Zn(e,t,n){var r=t._path,o=null,a=!1;e.syncPointTree_.foreachOnPath(r,function(e,t){var n=ye(e,r);o=o||Bn(t,n),a=a||Un(t)});var s,u=e.syncPointTree_.get(r);u?(a=a||Un(u),o=o||Bn(u,ue())):(u=new Rn,e.syncPointTree_=e.syncPointTree_.set(r,u)),null!=o?s=!0:(s=!1,o=Je.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild(function(e,t){var n=Bn(t,ue());n&&(o=o.updateImmediateChild(e,n))}));var c=jn(u,t);if(!c&&!t._queryParams.loadsAllData()){var l=tr(t);Object(i.d)(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=zn++;e.queryToTagMap.set(l,h),e.tagToQueryMap.set(h,l)}var f=function(e,t,n,r,i,o){var a=Dn(e,t,r,i,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),function(e,t){e.eventRegistrations_.push(t)}(a,n),function(e,t){var n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(We,function(e,t){r.push(lt(e,t))}),n.isFullyInitialized()&&r.push(ct(n.getNode())),Nn(e,r,n.getNode(),t)}(a,n)}(u,t,n,rn(e.pendingWriteTree_,r),o,s);if(!c&&!a){var d=Fn(u,t);f=f.concat(function(e,t,n){var r=t._path,o=er(e,t),a=Xn(e,n),s=e.listenProvider_.startListening(or(t),o,a.hashFn,a.onComplete),u=e.syncPointTree_.subtree(r);if(o)Object(i.d)(!Un(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold(function(e,t,n){if(!ge(e)&&t&&Un(t))return[Vn(t).query];var r=[];return t&&(r=r.concat(Ln(t).map(function(e){return e.query}))),D(n,function(e,t){r=r.concat(t)}),r}),l=0;l<c.length;++l){var h=c[l];e.listenProvider_.stopListening(or(h),er(e,h))}return s}(e,t,d))}return f}function Qn(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,function(e,n){var r=Bn(n,ye(e,t));if(r)return r});return un(r,t,i,n,!0)}function Yn(e,t){return Kn(t,e.syncPointTree_,null,rn(e.pendingWriteTree_,ue()))}function Kn(e,t,n,r){if(ge(e.path))return Jn(e,t,n,r);var i=t.get(ue());null==n&&null!=i&&(n=Bn(i,ue()));var o=[],a=ce(e.path),s=e.operationForChild(a),u=t.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=pn(r,a);o=o.concat(Kn(s,u,c,l))}return i&&(o=o.concat(Mn(i,e,r,n))),o}function Jn(e,t,n,r){var i=t.get(ue());null==n&&null!=i&&(n=Bn(i,ue()));var o=[];return t.children.inorderTraversal(function(t,i){var a=n?n.getImmediateChild(t):null,s=pn(r,t),u=e.operationForChild(t);u&&(o=o.concat(Jn(u,i,a,s)))}),i&&(o=o.concat(Mn(i,e,r,n))),o}function Xn(e,t){var n=t.query,r=er(e,n);return{hashFn:function(){return(function(e){return e.viewCache_.serverCache.getNode()}(t)||Je.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?function(e,t,n){var r=nr(e,n);if(r){var i=rr(r),o=i.path,a=i.queryId,s=ye(o,t);return ir(e,o,new Mt(Nt(a),s))}return[]}(e,n._path,r):function(e,t){return Yn(e,new Mt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return $n(e,n,null,i)}}}function er(e,t){var n=tr(t);return e.queryToTagMap.get(n)}function tr(e){return e._path.toString()+"$"+e._queryIdentifier}function nr(e,t){return e.tagToQueryMap.get(t)}function rr(e){var t=e.indexOf("$");return Object(i.d)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new se(e.substr(0,t))}}function ir(e,t,n){var r=e.syncPointTree_.get(t);return Object(i.d)(r,"Missing sync point for query tag that we're tracking"),Mn(r,n,rn(e.pendingWriteTree_,t),null)}function or(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Object(i.d)(xn,"Reference.ts has not been loaded"),xn)(e._repo,e._path):e}var ar=function(){function e(e){this.node_=e}return e.prototype.getImmediateChild=function(t){return new e(this.node_.getImmediateChild(t))},e.prototype.node=function(){return this.node_},e}(),sr=function(){function e(e,t){this.syncTree_=e,this.path_=t}return e.prototype.getImmediateChild=function(t){var n=ve(this.path_,t);return new e(this.syncTree_,n)},e.prototype.node=function(){return Qn(this.syncTree_,this.path_)},e}(),ur=function(e,t,n){return e&&"object"==typeof e?(Object(i.d)(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?cr(e[".sv"],t,n):"object"==typeof e[".sv"]?lr(e[".sv"],t):void Object(i.d)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},cr=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:Object(i.d)(!1,"Unexpected server value: "+e)}},lr=function(e,t,n){e.hasOwnProperty("increment")||Object(i.d)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&Object(i.d)(!1,"Unexpected increment value: "+r);var o=t.node();if(Object(i.d)(null!=o,"Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return r;var a=o.getValue();return"number"!=typeof a?r:a+r},hr=function(e,t,n,r){return dr(t,new sr(n,e),r)},fr=function(e,t,n){return dr(e,new ar(t),n)};function dr(e,t,n){var r,i=e.getPriority().val(),o=ur(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var a=e,s=ur(a.getValue(),t,n);return s!==a.getValue()||o!==a.getPriority().val()?new qe(s,et(o)):e}var u=e;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new qe(o))),u.forEachChild(We,function(e,i){var o=dr(i,t.getImmediateChild(e),n);o!==i&&(r=r.updateImmediateChild(e,o))}),r}var pr=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n={children:{},childCount:0}),this.name=e,this.parent=t,this.node=n};function vr(e,t){for(var n=t instanceof se?t:new se(t),r=e,o=ce(n);null!==o;){var a=Object(i.F)(r.node.children,o)||{children:{},childCount:0};r=new pr(o,r,a),o=ce(n=he(n))}return r}function gr(e){return e.node.value}function yr(e,t){e.node.value=t,kr(e)}function mr(e){return e.node.childCount>0}function br(e,t){D(e.node.children,function(n,r){t(new pr(n,e,r))})}function _r(e,t,n,r){n&&!r&&t(e),br(e,function(e){_r(e,t,!0,r)}),n&&r&&t(e)}function wr(e){return new se(null===e.parent?e.name:wr(e.parent)+"/"+e.name)}function kr(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===gr(e)&&!mr(e)}(n),o=Object(i.h)(e.node.children,t);r&&o?(delete e.node.children[t],e.node.childCount--,kr(e)):r||o||(e.node.children[t]=n.node,e.node.childCount++,kr(e))}(e.parent,e.name,e)}var Cr=/[\[\].#$\/\u0000-\u001F\u007F]/,Er=/[\[\].#$\u0000-\u001F\u007F]/,Or=function(e){return"string"==typeof e&&0!==e.length&&!Cr.test(e)},Sr=function(e){return"string"==typeof e&&0!==e.length&&!Er.test(e)},Pr=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!P(e)||e&&"object"==typeof e&&Object(i.h)(e,".sv")},Ir=function(e,t,n,r){r&&void 0===t||Tr(Object(i.m)(e,"value"),t,n)},Tr=function e(t,n,r){var o=r instanceof se?new we(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+Ce(o));if("function"==typeof n)throw new Error(t+"contains a function "+Ce(o)+" with contents = "+n.toString());if(P(n))throw new Error(t+"contains "+n.toString()+" "+Ce(o));if("string"==typeof n&&n.length>10485760/3&&Object(i.G)(n)>10485760)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+Ce(o)+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var a=!1,s=!1;if(D(n,function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(s=!0,!Or(n)))throw new Error(t+" contains an invalid key ("+n+") "+Ce(o)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var u,c;!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=Object(i.G)(t),ke(e)}(o,n),e(t,r,o),c=(u=o).parts_.pop(),u.byteLength_-=Object(i.G)(c),u.parts_.length>0&&(u.byteLength_-=1)}),a&&s)throw new Error(t+' contains ".value" child '+Ce(o)+" in addition to actual children.")}},Ar=function(e,t,n,r){if(!r||void 0!==t){var o=Object(i.m)(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(o+" must be an object containing the children to replace.");var a=[];D(t,function(e,t){var r=new se(e);if(Tr(o,t,ve(n,r)),".priority"===fe(r)&&!Pr(t))throw new Error(o+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)}),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=de(r=t[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!Or(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(me);var a=null;for(n=0;n<t.length;n++){if(r=t[n],null!==a&&_e(a,r))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(o,a)}},Nr=function(e,t,n){if(!n||void 0!==t){if(P(t))throw new Error(Object(i.m)(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Pr(t))throw new Error(Object(i.m)(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},xr=function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Object(i.m)(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Rr=function(e,t,n,r){if(!(r&&void 0===n||Or(n)))throw new Error(Object(i.m)(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Mr=function(e,t,n,r){if(!(r&&void 0===n||Sr(n)))throw new Error(Object(i.m)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Dr=function(e,t){if(".info"===ce(t))throw new Error(e+" failed = Can't modify data under /.info/")},Lr=function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Or(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Sr(e)}(n))throw new Error(Object(i.m)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Br=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(Object(i.m)(e,t)+"must be a boolean.")},Fr=function(){this.eventLists_=[],this.recursionDepth_=0};function jr(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],o=i.getPath();null===n||be(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function Ur(e,t,n){jr(e,n),zr(e,function(e){return be(e,t)})}function Vr(e,t,n){jr(e,n),zr(e,function(e){return _e(e,t)||_e(t,e)})}function zr(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];i&&(t(i.path)?(Hr(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}function Hr(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();b&&k("event: "+n.toString()),j(r)}}}var Gr=function(){function e(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Fr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Et(),this.transactionQueueTree_=new pr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e}();function qr(e){var t=e.infoData_.getNode(new se(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Wr(e){return(t=(t={timestamp:qr(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function $r(e,t,n,r,o){e.dataUpdateCount++;var a=new se(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var s=[];if(o)if(r){var u=Object(i.D)(n,function(e){return et(e)});s=function(e,t,n,r){var i=nr(e,r);if(i){var o=rr(i),a=o.path,s=o.queryId,u=ye(a,t),c=qt.fromObject(n);return ir(e,a,new Lt(Nt(s),u,c))}return[]}(e.serverSyncTree_,a,u,o)}else{var c=et(n);s=function(e,t,n,r){var i=nr(e,r);if(null!=i){var o=rr(i),a=o.path,s=o.queryId,u=ye(a,t);return ir(e,a,new Dt(Nt(s),u,n))}return[]}(e.serverSyncTree_,a,c,o)}else if(r){var l=Object(i.D)(n,function(e){return et(e)});s=function(e,t,n){var r=qt.fromObject(n);return Yn(e,new Lt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,l)}else{var h=et(n);s=Wn(e.serverSyncTree_,a,h)}var f=a;s.length>0&&(f=ai(e,a)),Vr(e.eventQueue_,f,s)}function Zr(e,t){Qr(e,"connected",t),!1===t&&function(e){ni(e,"onDisconnectEvents");var t=Wr(e),n=Et();Pt(e.onDisconnect_,ue(),function(r,i){var o=hr(r,i,e.serverSyncTree_,t);Ot(n,r,o)});var r=[];Pt(n,ue(),function(t,n){r=r.concat(Wn(e.serverSyncTree_,t,n));var i=hi(e,t);ai(e,i)}),e.onDisconnect_=Et(),Vr(e.eventQueue_,ue(),r)}(e)}function Qr(e,t,n){var r=new se("/.info/"+t),i=et(n);e.infoData_.updateSnapshot(r,i);var o=Wn(e.infoSyncTree_,r,i);Vr(e.eventQueue_,r,o)}function Yr(e){return e.nextWriteId_++}function Kr(e,t,n,r,i){ni(e,"set",{path:t.toString(),value:n,priority:r});var o=Wr(e),a=et(n,r),s=Qn(e.serverSyncTree_,t),u=fr(a,s,o),c=Yr(e),l=Gn(e.serverSyncTree_,t,u,c,!0);jr(e.eventQueue_,l),e.server_.put(t.toString(),a.val(!0),function(n,r){var o="ok"===n;o||S("set at "+t+" failed: "+n);var a=qn(e.serverSyncTree_,c,!o);Vr(e.eventQueue_,t,a),ri(0,i,n,r)});var h=hi(e,t);ai(e,h),Vr(e.eventQueue_,h,[])}function Jr(e,t,n){e.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&St(e.onDisconnect_,t),ri(0,n,r,i)})}function Xr(e,t,n,r){var i=et(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),function(n,o){"ok"===n&&Ot(e.onDisconnect_,t,i),ri(0,r,n,o)})}function ei(e,t,n){var r;r=".info"===ce(t._path)?$n(e.infoSyncTree_,t,n):$n(e.serverSyncTree_,t,n),Ur(e.eventQueue_,t._path,r)}function ti(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}function ni(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r="";e.persistentConnection_&&(r=e.persistentConnection_.id+":"),k.apply(void 0,Object(o.f)([r],Object(o.e)(t)))}function ri(e,t,n,r){t&&j(function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var o=new Error(i);o.code=e,t(o)}})}function ii(e,t,n){return Qn(e.serverSyncTree_,t,n)||Je.EMPTY_NODE}function oi(e,t){if(void 0===t&&(t=e.transactionQueueTree_),t||li(e,t),gr(t)){var n=ui(e,t);Object(i.d)(n.length>0,"Sending zero length transaction queue"),n.every(function(e){return 0===e.status})&&function(e,t,n){for(var r=n.map(function(e){return e.currentWriteId}),o=ii(e,t,r),a=o,s=o.hash(),u=0;u<n.length;u++){var c=n[u];Object(i.d)(0===c.status,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;var l=ye(t,c.path);a=a.updateChild(l,c.currentOutputSnapshotRaw)}var h=a.val(!0),f=t;e.server_.put(f.toString(),h,function(r){ni(e,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(t){n[t].status=2,i=i.concat(qn(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&o.push(function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)}),n[t].unwatcher()},s=0;s<n.length;s++)a(s);for(li(e,vr(e.transactionQueueTree_,t)),oi(e,e.transactionQueueTree_),Vr(e.eventQueue_,t,i),s=0;s<o.length;s++)j(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)n[s].status=3===n[s].status?4:0;else for(S("transaction at "+f.toString()+" failed: "+r),s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r;ai(e,t)}},s)}(e,wr(t),n)}else mr(t)&&br(t,function(t){oi(e,t)})}function ai(e,t){var n=si(e,t),r=wr(n);return function(e,t,n){if(0!==t.length){for(var r=[],o=[],a=t.filter(function(e){return 0===e.status}).map(function(e){return e.currentWriteId}),s=function(s){var u,c=t[s],l=ye(n,c.path),h=!1;if(Object(i.d)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,u=c.abortReason,o=o.concat(qn(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)h=!0,u="maxretry",o=o.concat(qn(e.serverSyncTree_,c.currentWriteId,!0));else{var f=ii(e,c.path,a);c.currentInputSnapshot=f;var d=t[s].update(f.val());if(void 0!==d){Tr("transaction failed: Data returned ",d,c.path);var p=et(d);"object"==typeof d&&null!=d&&Object(i.h)(d,".priority")||(p=p.updatePriority(f.getPriority()));var v=c.currentWriteId,g=Wr(e),y=fr(p,f,g);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=y,c.currentWriteId=Yr(e),a.splice(a.indexOf(v),1),o=(o=o.concat(Gn(e.serverSyncTree_,c.path,y,c.currentWriteId,c.applyLocally))).concat(qn(e.serverSyncTree_,v,!0))}else h=!0,u="nodata",o=o.concat(qn(e.serverSyncTree_,c.currentWriteId,!0))}Vr(e.eventQueue_,n,o),o=[],h&&(t[s].status=2,setTimeout(t[s].unwatcher,Math.floor(0)),t[s].onComplete&&r.push("nodata"===u?function(){return t[s].onComplete(null,!1,t[s].currentInputSnapshot)}:function(){return t[s].onComplete(new Error(u),!1,null)}))},u=0;u<t.length;u++)s(u);for(li(e,e.transactionQueueTree_),u=0;u<r.length;u++)j(r[u]);oi(e,e.transactionQueueTree_)}}(e,ui(e,n),r),r}function si(e,t){var n,r=e.transactionQueueTree_;for(n=ce(t);null!==n&&void 0===gr(r);)r=vr(r,n),n=ce(t=he(t));return r}function ui(e,t){var n=[];return ci(e,t,n),n.sort(function(e,t){return e.order-t.order}),n}function ci(e,t,n){var r=gr(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);br(t,function(t){ci(e,t,n)})}function li(e,t){var n=gr(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,yr(t,n.length>0?n:void 0)}br(t,function(t){li(e,t)})}function hi(e,t){var n=wr(si(e,t)),r=vr(e.transactionQueueTree_,t);return function(e,t,n){for(var r=e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,function(t){fi(e,t)}),fi(e,r),_r(r,function(t){fi(e,t)}),n}function fi(e,t){var n=gr(t);if(n){for(var r=[],o=[],a=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?(Object(i.d)(a===s-1,"All SENT items should be at beginning of queue."),a=s,n[s].status=3,n[s].abortReason="set"):(Object(i.d)(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),o=o.concat(qn(e.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));for(-1===a?yr(t,void 0):n.length=a+1,Vr(e.eventQueue_,wr(t),o),s=0;s<r.length;s++)j(r[s])}}var di=function(e,t){var n=pi(e),r=n.namespace;return"firebase.com"===n.domain&&O(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||O("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&S("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new q(n.host,n.secure,r,t,"ws"===n.scheme||"wss"===n.scheme,"",r!==n.subdomain),path:new se(n.pathString)}},pi=function(e){var t="",n="",r="",i="",a="",s=!0,u="https",c=443;if("string"==typeof e){var l=e.indexOf("//");l>=0&&(u=e.substring(0,l-1),e=e.substring(l+2));var h=e.indexOf("/");-1===h&&(h=e.length);var f=e.indexOf("?");-1===f&&(f=e.length),t=e.substring(0,Math.min(h,f)),h<f&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}t+="/"+i}return t}(e.substring(h,f)));var d=function(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=Object(o.g)(e.split("&")),a=i.next();!a.done;a=i.next()){var s=a.value;if(0!==s.length){var u=s.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):S("Invalid query segment '"+s+"' in query '"+e+"'")}}}catch(c){t={error:c}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.substring(Math.min(e.length,f)));(l=t.indexOf(":"))>=0?(s="https"===u||"wss"===u,c=parseInt(t.substring(l+1),10)):l=t.length;var p=t.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var v=t.indexOf(".");r=t.substring(0,v).toLowerCase(),n=t.substring(v+1),a=r}"ns"in d&&(a=d.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:s,scheme:u,pathString:i,namespace:a}},vi=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Object(i.I)(this.snapshot.exportVal())},e}(),gi=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),yi=function(){function e(e,t){this.snapshotCallback=e,this.cancelCallback=t}return e.prototype.onValue=function(e,t){this.snapshotCallback.call(null,e,t)},e.prototype.onCancel=function(e){return Object(i.d)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)},Object.defineProperty(e.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),e.prototype.matches=function(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context},e}(),mi=function(){function e(e,t){this._repo=e,this._path=t}return e.prototype.cancel=function(){var e=new i.a;return Jr(this._repo,this._path,e.wrapCallback(function(){})),e.promise},e.prototype.remove=function(){Dr("OnDisconnect.remove",this._path);var e=new i.a;return Xr(this._repo,this._path,null,e.wrapCallback(function(){})),e.promise},e.prototype.set=function(e){Dr("OnDisconnect.set",this._path),Ir("OnDisconnect.set",e,this._path,!1);var t=new i.a;return Xr(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise},e.prototype.setWithPriority=function(e,t){Dr("OnDisconnect.setWithPriority",this._path),Ir("OnDisconnect.setWithPriority",e,this._path,!1),Nr("OnDisconnect.setWithPriority",t,!1);var n=new i.a;return function(e,t,n,r,i){var o=et(n,r);e.server_.onDisconnectPut(t.toString(),o.val(!0),function(n,r){"ok"===n&&Ot(e.onDisconnect_,t,o),ri(0,i,n,r)})}(this._repo,this._path,e,t,n.wrapCallback(function(){})),n.promise},e.prototype.update=function(e){Dr("OnDisconnect.update",this._path),Ar("OnDisconnect.update",e,this._path,!1);var t=new i.a;return function(e,t,n,r){if(Object(i.t)(n))return k("onDisconnect().update() called with empty data.  Don't do anything."),void ri(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,function(i,o){"ok"===i&&D(n,function(n,r){var i=et(r);Ot(e.onDisconnect_,ve(t,n),i)}),ri(0,r,i,o)})}(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise},e}(),bi=function(){function e(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(e.prototype,"key",{get:function(){return ge(this._path)?null:fe(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new Ci(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryIdentifier",{get:function(){var e=wt(this._queryParams),t=R(e);return"{}"===t?"default":t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryObject",{get:function(){return wt(this._queryParams)},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){if(!((t=Object(i.n)(t))instanceof e))return!1;var n=this._repo===t._repo,r=be(this._path,t._path);return n&&r&&this._queryIdentifier===t._queryIdentifier},e.prototype.toJSON=function(){return this.toString()},e.prototype.toString=function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)},e}();function _i(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function wi(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Ne){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",o="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==I)throw new Error(r);if("string"!=typeof t)throw new Error(o)}if(e.hasEnd()){if(e.getIndexEndName()!==T)throw new Error(r);if("string"!=typeof n)throw new Error(o)}}else if(e.getIndex()===We){if(null!=t&&!Pr(t)||null!=n&&!Pr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Object(i.d)(e.getIndex()instanceof rt||e.getIndex()===it,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function ki(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Ci=function(e){function t(t,n){return e.call(this,t,n,new gt,!1)||this}return Object(o.c)(t,e),Object.defineProperty(t.prototype,"parent",{get:function(){var e=pe(this._path);return null===e?null:new t(this._repo,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e},enumerable:!1,configurable:!0}),t}(bi),Ei=function(){function e(e,t,n){this._node=e,this.ref=t,this._index=n}return Object.defineProperty(e.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),e.prototype.child=function(t){var n=new se(t),r=Pi(this.ref,t);return new e(this._node.getChild(n),r,We)},e.prototype.exists=function(){return!this._node.isEmpty()},e.prototype.exportVal=function(){return this._node.val(!0)},e.prototype.forEach=function(t){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,function(r,i){return t(new e(i,Pi(n.ref,r),We))})},e.prototype.hasChild=function(e){var t=new se(e);return!this._node.getChild(t).isEmpty()},e.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},e.prototype.toJSON=function(){return this.exportVal()},e.prototype.val=function(){return this._node.val()},e}();function Oi(e,t){return(e=Object(i.n)(e))._checkNotDeleted("ref"),void 0!==t?Pi(e._root,t):e._root}function Si(e,t){(e=Object(i.n)(e))._checkNotDeleted("refFromURL");var n=di(t,e._repo.repoInfo_.nodeAdmin);Lr("refFromURL",n);var r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||O("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),Oi(e,n.path.toString())}function Pi(e,t){var n;return null===ce((e=Object(i.n)(e))._path)?((n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Mr("child","path",n,!1)):Mr("child","path",t,!1),new Ci(e._repo,ve(e._path,t))}function Ii(e,t){e=Object(i.n)(e),Dr("push",e._path),Ir("push",t,e._path,!0);var n,r=qr(e._repo),o=at(r),a=Pi(e,o),s=Pi(e,o);return n=null!=t?Ai(s,t).then(function(){return s}):Promise.resolve(s),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}function Ti(e){return Dr("remove",e._path),Ai(e,null)}function Ai(e,t){e=Object(i.n)(e),Dr("set",e._path),Ir("set",t,e._path,!1);var n=new i.a;return Kr(e._repo,e._path,t,null,n.wrapCallback(function(){})),n.promise}function Ni(e,t){e=Object(i.n)(e),Dr("setPriority",e._path),Nr("setPriority",t,!1);var n=new i.a;return Kr(e._repo,ve(e._path,".priority"),t,null,n.wrapCallback(function(){})),n.promise}function xi(e,t,n){if(Dr("setWithPriority",e._path),Ir("setWithPriority",t,e._path,!1),Nr("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";var r=new i.a;return Kr(e._repo,e._path,t,n,r.wrapCallback(function(){})),r.promise}function Ri(e,t){Ar("update",t,e._path,!1);var n=new i.a;return function(e,t,n,r){ni(e,"update",{path:t.toString(),value:n});var o=!0,a=Wr(e),s={};if(D(n,function(n,r){o=!1,s[n]=hr(ve(t,n),et(r),e.serverSyncTree_,a)}),o)k("update() called with empty data.  Don't do anything."),ri(0,r,"ok",void 0);else{var u=Yr(e),c=function(e,t,n,r){!function(e,t,n,r){Object(i.d)(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Zt(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);var o=qt.fromObject(n);return Yn(e,new Lt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,o))}(e.serverSyncTree_,t,s,u);jr(e.eventQueue_,c),e.server_.merge(t.toString(),n,function(n,i){var o="ok"===n;o||S("update at "+t+" failed: "+n);var a=qn(e.serverSyncTree_,u,!o),s=a.length>0?ai(e,t):t;Vr(e.eventQueue_,s,a),ri(0,r,n,i)}),D(n,function(n){var r=hi(e,ve(t,n));ai(e,r)}),Vr(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback(function(){})),n.promise}var Mi=function(){function e(e){this.callbackContext=e}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var n=t._queryParams.getIndex();return new vi("value",this,new Ei(e.snapshotNode,new Ci(t._repo,t._path),n))},e.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}},e.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new gi(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))},e.prototype.hasAnyCallback=function(){return null!==this.callbackContext},e}(),Di=function(){function e(e,t){this.eventType=e,this.callbackContext=t}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return this.eventType===("children_removed"===t?"child_removed":t)},e.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new gi(this,e,t):null},e.prototype.createEvent=function(e,t){Object(i.d)(null!=e.childName,"Child events should have a childName.");var n=Pi(new Ci(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new vi(e.type,this,new Ei(e.snapshotNode,n,r),e.prevName)},e.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}},e.prototype.matches=function(t){return t instanceof e&&this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext))},e.prototype.hasAnyCallback=function(){return!!this.callbackContext},e}();function Li(e,t,n,r,i){var o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){var a=n,s=function(t,n){ei(e._repo,e,c),a(t,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new yi(n,o||void 0),c="value"===t?new Mi(u):new Di(t,u);return function(e,t,n){var r;r=".info"===ce(t._path)?Zn(e.infoSyncTree_,t,n):Zn(e.serverSyncTree_,t,n),Ur(e.eventQueue_,t._path,r)}(e._repo,e,c),function(){return ei(e._repo,e,c)}}function Bi(e,t,n,r){return Li(e,"value",t,n,r)}function Fi(e,t,n,r){return Li(e,"child_added",t,n,r)}function ji(e,t,n,r){return Li(e,"child_changed",t,n,r)}function Ui(e,t,n,r){return Li(e,"child_moved",t,n,r)}function Vi(e,t,n,r){return Li(e,"child_removed",t,n,r)}function zi(e,t,n){var r=null,i=n?new yi(n):null;"value"===t?r=new Mi(i):t&&(r=new Di(t,i)),ei(e._repo,e,r)}var Hi=function(){},Gi=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(o.c)(t,e),t.prototype._apply=function(e){Ir("endAt",this._value,e._path,!0);var t=mt(e._queryParams,this._value,this._key);if(ki(t),wi(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)},t}(Hi);function qi(e,t){return Rr("endAt","key",t,!0),new Gi(e,t)}var Wi=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(o.c)(t,e),t.prototype._apply=function(e){Ir("endBefore",this._value,e._path,!1);var t,n,r,i,o=(n=this._value,r=this._key,(t=e._queryParams).index_===Ne?("string"==typeof n&&(n=ut(n)),i=mt(t,n,r)):i=mt(t,n,null==r?I:ut(r)),i.endBeforeSet_=!0,i);if(ki(o),wi(o),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new bi(e._repo,e._path,o,e._orderByCalled)},t}(Hi);function $i(e,t){return Rr("endBefore","key",t,!0),new Wi(e,t)}var Zi=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(o.c)(t,e),t.prototype._apply=function(e){Ir("startAt",this._value,e._path,!0);var t=yt(e._queryParams,this._value,this._key);if(ki(t),wi(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new bi(e._repo,e._path,t,e._orderByCalled)},t}(Hi);function Qi(e,t){return void 0===e&&(e=null),Rr("startAt","key",t,!0),new Zi(e,t)}var Yi=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(o.c)(t,e),t.prototype._apply=function(e){Ir("startAfter",this._value,e._path,!1);var t,n,r,i,o=(n=this._value,r=this._key,(t=e._queryParams).index_===Ne?("string"==typeof n&&(n=st(n)),i=yt(t,n,r)):i=yt(t,n,null==r?T:st(r)),i.startAfterSet_=!0,i);if(ki(o),wi(o),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new bi(e._repo,e._path,o,e._orderByCalled)},t}(Hi);function Ki(e,t){return Rr("startAfter","key",t,!0),new Yi(e,t)}var Ji=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return Object(o.c)(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new bi(e._repo,e._path,(t=this._limit,(n=e._queryParams.copy()).limitSet_=!0,n.limit_=t,n.viewFrom_="l",n),e._orderByCalled);var t,n},t}(Hi);function Xi(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Ji(e)}var eo=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return Object(o.c)(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new bi(e._repo,e._path,(t=this._limit,(n=e._queryParams.copy()).limitSet_=!0,n.limit_=t,n.viewFrom_="r",n),e._orderByCalled);var t,n},t}(Hi);function to(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new eo(e)}var no=function(e){function t(t){var n=e.call(this)||this;return n._path=t,n}return Object(o.c)(t,e),t.prototype._apply=function(e){_i(e,"orderByChild");var t=new se(this._path);if(ge(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new rt(t),r=bt(e._queryParams,n);return wi(r),new bi(e._repo,e._path,r,!0)},t}(Hi);function ro(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Mr("orderByChild","path",e,!1),new no(e)}var io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype._apply=function(e){_i(e,"orderByKey");var t=bt(e._queryParams,Ne);return wi(t),new bi(e._repo,e._path,t,!0)},t}(Hi);function oo(){return new io}var ao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype._apply=function(e){_i(e,"orderByPriority");var t=bt(e._queryParams,We);return wi(t),new bi(e._repo,e._path,t,!0)},t}(Hi);function so(){return new ao}var uo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.c)(t,e),t.prototype._apply=function(e){_i(e,"orderByValue");var t=bt(e._queryParams,it);return wi(t),new bi(e._repo,e._path,t,!0)},t}(Hi);function co(){return new uo}var lo,ho=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(o.c)(t,e),t.prototype._apply=function(e){if(Ir("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Gi(this._value,this._key)._apply(new Zi(this._value,this._key)._apply(e))},t}(Hi);function fo(e,t){return Rr("equalTo","key",t,!0),new ho(e,t)}function po(e){for(var t,n,r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];var s=Object(i.n)(e);try{for(var u=Object(o.g)(r),c=u.next();!c.done;c=u.next()){var l=c.value;s=l._apply(s)}}catch(h){t={error:h}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return s}lo=Ci,Object(i.d)(!On,"__referenceConstructor has already been defined"),On=lo,function(e){Object(i.d)(!xn,"__referenceConstructor has already been defined"),xn=e}(Ci);var vo={},go=!1;function yo(e,t,n,r,i){var o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||O("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),k("Using default host for project ",e.options.projectId),o=e.options.projectId+"-default-rtdb.firebaseio.com");var a,s=di(o,i),u=s.repoInfo,c=void 0;"undefined"!=typeof process&&(c=process.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(a=!0,u=(s=di(o="http://"+c+"?ns="+u.namespace,i)).repoInfo):a=!s.repoInfo.secure;var l=i&&a?new H(H.OWNER):new z(e.name,e.options,t);Lr("Invalid Firebase Database URL",s),ge(s.path)||O("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=vo[t.name];i||(vo[t.name]=i={});var o=i[e.toURLString()];return o&&O("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Gr(e,go,n,r),i[e.toURLString()]=o,o}(u,e,l,new V(e.name,n));return new mo(h,e)}var mo=function(){function e(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}return Object.defineProperty(e.prototype,"_repo",{get:function(){return this._instanceStarted||(function(e,t,n){if(e.stats_=Y(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new kt(e.repoInfo_,function(t,n,r,i){$r(e,t,n,r,i)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(function(){return Zr(e,!0)},0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Object(i.I)(n)}catch(a){throw new Error("Invalid authOverride provided: "+a)}}e.persistentConnection_=new Pe(e.repoInfo_,t,function(t,n,r,i){$r(e,t,n,r,i)},function(t){Zr(e,t)},function(t){!function(e,t){D(t,function(t,n){Qr(e,t,n)})}(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}var r,o;e.authTokenProvider_.addTokenChangeListener(function(t){e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(function(t){e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=(r=function(){return new Tt(e.stats_,e.server_)},o=e.repoInfo_.toString(),Q[o]||(Q[o]=r()),Q[o]),e.infoData_=new Ct,e.infoSyncTree_=new Hn({startListening:function(t,n,r,i){var o=[],a=e.infoData_.getNode(t._path);return a.isEmpty()||(o=Wn(e.infoSyncTree_,t._path,a),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),Qr(e,"connected",!1),e.serverSyncTree_=new Hn({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,function(n,r){var o=i(n,r);Vr(e.eventQueue_,t._path,o)}),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Ci(this._repo,ue())),this._rootInternal},enumerable:!1,configurable:!0}),e.prototype._delete=function(){var e,t,n;return null!==this._rootInternal&&(e=this._repo,(n=vo[t=this.app.name])&&n[e.key]===e||O("Database "+t+"("+e.repoInfo_+") has already been deleted."),ti(e),delete n[e.key],this._repoInternal=null,this._rootInternal=null),Promise.resolve()},e.prototype._checkNotDeleted=function(e){null===this._rootInternal&&O("Cannot call "+e+" on a deleted database.")},e}();function bo(e){(e=Object(i.n)(e))._checkNotDeleted("goOffline"),ti(e._repo)}function _o(e){var t;(e=Object(i.n)(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume("repo_interrupt")}var wo={".sv":"timestamp"},ko=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}();function Co(e,t,n){var r;if(e=Object(i.n)(e),Dr("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";var o=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,a=new i.a,s=Bi(e,function(){});return function(t,n,r,o,s,u){ni(t,"transaction on "+n);var c={path:n,update:r,onComplete:function(t,n,r){var i=null;t?a.reject(t):(i=new Ei(r,new Ci(e._repo,e._path),We),a.resolve(new ko(n,i)))},status:null,order:g(),applyLocally:u,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=ii(t,n,void 0);c.currentInputSnapshot=l;var h=c.update(l.val());if(void 0===h)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Tr("transaction failed: Data returned ",h,c.path),c.status=0;var f=vr(t.transactionQueueTree_,n),d=gr(f)||[];d.push(c),yr(f,d);var p=void 0;"object"==typeof h&&null!==h&&Object(i.h)(h,".priority")?(p=Object(i.F)(h,".priority"),Object(i.d)(Pr(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):p=(Qn(t.serverSyncTree_,n)||Je.EMPTY_NODE).getPriority().val();var v=Wr(t),y=et(h,p),m=fr(y,l,v);c.currentOutputSnapshotRaw=y,c.currentOutputSnapshotResolved=m,c.currentWriteId=Yr(t);var b=Gn(t.serverSyncTree_,n,m,c.currentWriteId,c.applyLocally);Vr(t.eventQueue_,n,b),oi(t,t.transactionQueueTree_)}}(e._repo,e._path,t,0,s,o),a.promise}var Eo=function(){function e(e){this._delegate=e}return e.prototype.cancel=function(e){Object(i.J)("OnDisconnect.cancel",0,1,arguments.length),Object(i.K)("OnDisconnect.cancel","onComplete",e,!0);var t=this._delegate.cancel();return e&&t.then(function(){return e(null)},function(t){return e(t)}),t},e.prototype.remove=function(e){Object(i.J)("OnDisconnect.remove",0,1,arguments.length),Object(i.K)("OnDisconnect.remove","onComplete",e,!0);var t=this._delegate.remove();return e&&t.then(function(){return e(null)},function(t){return e(t)}),t},e.prototype.set=function(e,t){Object(i.J)("OnDisconnect.set",1,2,arguments.length),Object(i.K)("OnDisconnect.set","onComplete",t,!0);var n=this._delegate.set(e);return t&&n.then(function(){return t(null)},function(e){return t(e)}),n},e.prototype.setWithPriority=function(e,t,n){Object(i.J)("OnDisconnect.setWithPriority",2,3,arguments.length),Object(i.K)("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(e,t);return n&&r.then(function(){return n(null)},function(e){return n(e)}),r},e.prototype.update=function(e,t){if(Object(i.J)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,S("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Object(i.K)("OnDisconnect.update","onComplete",t,!0);var o=this._delegate.update(e);return t&&o.then(function(){return t(null)},function(e){return t(e)}),o},e}(),Oo=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return Object(i.J)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),So=function(){function e(e,t){this._database=e,this._delegate=t}return e.prototype.val=function(){return Object(i.J)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},e.prototype.exportVal=function(){return Object(i.J)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},e.prototype.toJSON=function(){return Object(i.J)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.exists=function(){return Object(i.J)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},e.prototype.child=function(t){return Object(i.J)("DataSnapshot.child",0,1,arguments.length),t=String(t),Mr("DataSnapshot.child","path",t,!1),new e(this._database,this._delegate.child(t))},e.prototype.hasChild=function(e){return Object(i.J)("DataSnapshot.hasChild",1,1,arguments.length),Mr("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)},e.prototype.getPriority=function(){return Object(i.J)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},e.prototype.forEach=function(t){var n=this;return Object(i.J)("DataSnapshot.forEach",1,1,arguments.length),Object(i.K)("DataSnapshot.forEach","action",t,!1),this._delegate.forEach(function(r){return t(new e(n._database,r))})},e.prototype.hasChildren=function(){return Object(i.J)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(e.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),e.prototype.numChildren=function(){return Object(i.J)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},e.prototype.getRef=function(){return Object(i.J)("DataSnapshot.ref",0,0,arguments.length),new Io(this._database,this._delegate.ref)},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),e}(),Po=function(){function e(e,t){this.database=e,this._delegate=t}return e.prototype.on=function(t,n,r,o){var a,s=this;Object(i.J)("Query.on",2,4,arguments.length),Object(i.K)("Query.on","callback",n,!1);var u=e.getCancelAndContextArgs_("Query.on",r,o),c=function(e,t){n.call(u.context,new So(s.database,e),t)};c.userCallback=n,c.context=u.context;var l=null===(a=u.cancel)||void 0===a?void 0:a.bind(u.context);switch(t){case"value":return Bi(this._delegate,c,l),n;case"child_added":return Fi(this._delegate,c,l),n;case"child_removed":return Vi(this._delegate,c,l),n;case"child_changed":return ji(this._delegate,c,l),n;case"child_moved":return Ui(this._delegate,c,l),n;default:throw new Error(Object(i.m)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},e.prototype.off=function(e,t,n){if(Object(i.J)("Query.off",0,3,arguments.length),xr("Query.off",e,!0),Object(i.K)("Query.off","callback",t,!0),Object(i.L)("Query.off","context",n,!0),t){var r=function(){};r.userCallback=t,r.context=n,zi(this._delegate,e,r)}else zi(this._delegate,e)},e.prototype.get=function(){var e=this;return function(e){return function(e,t){var n=function(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,function(e,t){var i=ye(e,n);r=r||Bn(t,i)});var i=e.syncPointTree_.get(n);i?r=r||Bn(i,ue()):(i=new Rn,e.syncPointTree_=e.syncPointTree_.set(n,i));var o=null!=r,a=o?new Bt(r,!0,!1):null;return Ht(Dn(i,t,rn(e.pendingWriteTree_,t._path),o?a.getNode():Je.EMPTY_NODE,o).viewCache_)}(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then(function(n){var r=et(n).withIndex(t._queryParams.getIndex()),i=Wn(e.serverSyncTree_,t._path,r);return Ur(e.eventQueue_,t._path,i),Promise.resolve(r)},function(n){return ni(e,"get for query "+Object(i.I)(t)+" failed: "+n),Promise.reject(new Error(n))})}((e=Object(i.n)(e))._repo,e).then(function(t){return new Ei(t,new Ci(e._repo,e._path),e._queryParams.getIndex())})}(this._delegate).then(function(t){return new So(e.database,t)})},e.prototype.once=function(t,n,r,o){var a=this;Object(i.J)("Query.once",1,4,arguments.length),Object(i.K)("Query.once","callback",n,!0);var s=e.getCancelAndContextArgs_("Query.once",r,o),u=new i.a,c=function(e,t){var r=new So(a.database,e);n&&n.call(s.context,r,t),u.resolve(r)};c.userCallback=n,c.context=s.context;var l=function(e){s.cancel&&s.cancel.call(s.context,e),u.reject(e)};switch(t){case"value":Bi(this._delegate,c,l,{onlyOnce:!0});break;case"child_added":Fi(this._delegate,c,l,{onlyOnce:!0});break;case"child_removed":Vi(this._delegate,c,l,{onlyOnce:!0});break;case"child_changed":ji(this._delegate,c,l,{onlyOnce:!0});break;case"child_moved":Ui(this._delegate,c,l,{onlyOnce:!0});break;default:throw new Error(Object(i.m)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise},e.prototype.limitToFirst=function(t){return Object(i.J)("Query.limitToFirst",1,1,arguments.length),new e(this.database,po(this._delegate,Xi(t)))},e.prototype.limitToLast=function(t){return Object(i.J)("Query.limitToLast",1,1,arguments.length),new e(this.database,po(this._delegate,to(t)))},e.prototype.orderByChild=function(t){return Object(i.J)("Query.orderByChild",1,1,arguments.length),new e(this.database,po(this._delegate,ro(t)))},e.prototype.orderByKey=function(){return Object(i.J)("Query.orderByKey",0,0,arguments.length),new e(this.database,po(this._delegate,oo()))},e.prototype.orderByPriority=function(){return Object(i.J)("Query.orderByPriority",0,0,arguments.length),new e(this.database,po(this._delegate,so()))},e.prototype.orderByValue=function(){return Object(i.J)("Query.orderByValue",0,0,arguments.length),new e(this.database,po(this._delegate,co()))},e.prototype.startAt=function(t,n){return void 0===t&&(t=null),Object(i.J)("Query.startAt",0,2,arguments.length),new e(this.database,po(this._delegate,Qi(t,n)))},e.prototype.startAfter=function(t,n){return void 0===t&&(t=null),Object(i.J)("Query.startAfter",0,2,arguments.length),new e(this.database,po(this._delegate,Ki(t,n)))},e.prototype.endAt=function(t,n){return void 0===t&&(t=null),Object(i.J)("Query.endAt",0,2,arguments.length),new e(this.database,po(this._delegate,qi(t,n)))},e.prototype.endBefore=function(t,n){return void 0===t&&(t=null),Object(i.J)("Query.endBefore",0,2,arguments.length),new e(this.database,po(this._delegate,$i(t,n)))},e.prototype.equalTo=function(t,n){return Object(i.J)("Query.equalTo",1,2,arguments.length),new e(this.database,po(this._delegate,fo(t,n)))},e.prototype.toString=function(){return Object(i.J)("Query.toString",0,0,arguments.length),this._delegate.toString()},e.prototype.toJSON=function(){return Object(i.J)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.isEqual=function(t){if(Object(i.J)("Query.isEqual",1,1,arguments.length),!(t instanceof e)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(t._delegate)},e.getCancelAndContextArgs_=function(e,t,n){var r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Object(i.K)(e,"cancel",r.cancel,!0),r.context=n,Object(i.L)(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(Object(i.m)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(e.prototype,"ref",{get:function(){return new Io(this.database,new Ci(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),e}(),Io=function(e){function t(t,n){var r=e.call(this,t,new bi(n._repo,n._path,new gt,!1))||this;return r.database=t,r._delegate=n,r}return Object(o.c)(t,e),t.prototype.getKey=function(){return Object(i.J)("Reference.key",0,0,arguments.length),this._delegate.key},t.prototype.child=function(e){return Object(i.J)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new t(this.database,Pi(this._delegate,e))},t.prototype.getParent=function(){Object(i.J)("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new t(this.database,e):null},t.prototype.getRoot=function(){return Object(i.J)("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)},t.prototype.set=function(e,t){Object(i.J)("Reference.set",1,2,arguments.length),Object(i.K)("Reference.set","onComplete",t,!0);var n=Ai(this._delegate,e);return t&&n.then(function(){return t(null)},function(e){return t(e)}),n},t.prototype.update=function(e,t){if(Object(i.J)("Reference.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,S("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Dr("Reference.update",this._delegate._path),Object(i.K)("Reference.update","onComplete",t,!0);var o=Ri(this._delegate,e);return t&&o.then(function(){return t(null)},function(e){return t(e)}),o},t.prototype.setWithPriority=function(e,t,n){Object(i.J)("Reference.setWithPriority",2,3,arguments.length),Object(i.K)("Reference.setWithPriority","onComplete",n,!0);var r=xi(this._delegate,e,t);return n&&r.then(function(){return n(null)},function(e){return n(e)}),r},t.prototype.remove=function(e){Object(i.J)("Reference.remove",0,1,arguments.length),Object(i.K)("Reference.remove","onComplete",e,!0);var t=Ti(this._delegate);return e&&t.then(function(){return e(null)},function(t){return e(t)}),t},t.prototype.transaction=function(e,t,n){var r=this;Object(i.J)("Reference.transaction",1,3,arguments.length),Object(i.K)("Reference.transaction","transactionUpdate",e,!1),Object(i.K)("Reference.transaction","onComplete",t,!0),Br("Reference.transaction","applyLocally",n,!0);var o=Co(this._delegate,e,{applyLocally:n}).then(function(e){return new Oo(e.committed,new So(r.database,e.snapshot))});return t&&o.then(function(e){return t(null,e.committed,e.snapshot)},function(e){return t(e,!1,null)}),o},t.prototype.setPriority=function(e,t){Object(i.J)("Reference.setPriority",1,2,arguments.length),Object(i.K)("Reference.setPriority","onComplete",t,!0);var n=Ni(this._delegate,e);return t&&n.then(function(){return t(null)},function(e){return t(e)}),n},t.prototype.push=function(e,n){var r=this;Object(i.J)("Reference.push",0,2,arguments.length),Object(i.K)("Reference.push","onComplete",n,!0);var o=Ii(this._delegate,e),a=o.then(function(e){return new t(r.database,e)});n&&a.then(function(){return n(null)},function(e){return n(e)});var s=new t(this.database,o);return s.then=a.then.bind(a),s.catch=a.catch.bind(a,void 0),s},t.prototype.onDisconnect=function(){return Dr("Reference.onDisconnect",this._delegate._path),new Eo(new mi(this._delegate._repo,this._delegate._path))},Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),t}(Po),To=function(){function e(e,t){var n=this;this._delegate=e,this.app=t,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return e.prototype.useEmulator=function(e,t,n){void 0===n&&(n={}),function(e,t,n,r){void 0===r&&(r={}),(e=Object(i.n)(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&O("Cannot call useEmulator() after instance has already been initialized.");var o=e._repoInternal,a=void 0;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&O('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new H(H.OWNER);else if(r.mockUserToken){var s="string"==typeof r.mockUserToken?r.mockUserToken:Object(i.i)(r.mockUserToken,e.app.options.projectId);a=new H(s)}!function(e,t,n,r){e.repoInfo_=new q(t+":"+n,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(o,t,n,a)}(this._delegate,e,t,n)},e.prototype.ref=function(e){if(Object(i.J)("database.ref",0,1,arguments.length),e instanceof Io){var t=Si(this._delegate,e.toString());return new Io(this,t)}return t=Oi(this._delegate,e),new Io(this,t)},e.prototype.refFromURL=function(e){var t="database.refFromURL";Object(i.J)(t,1,1,arguments.length);var n=Si(this._delegate,e);return new Io(this,n)},e.prototype.goOffline=function(){return Object(i.J)("database.goOffline",0,0,arguments.length),bo(this._delegate)},e.prototype.goOnline=function(){return Object(i.J)("database.goOnline",0,0,arguments.length),_o(this._delegate)},e.ServerValue={TIMESTAMP:wo,increment:function(e){return function(e){return{".sv":{increment:e}}}(e)}},e}(),Ao=Object.freeze({__proto__:null,forceLongPolling:function(){te.forceDisallow(),J.forceAllow()},forceWebSockets:function(){J.forceDisallow()},isWebSocketsAvailable:function(){return te.isAvailable()},setSecurityDebugCallback:function(e,t){e._delegate._repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){!function(e,t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var n;t?(e.statsListener_||(e.statsListener_=new It(e.stats_)),n=e.statsListener_.get()):n=e.stats_.get();var r=Object.keys(n).reduce(function(e,t){return Math.max(t.length,e)},0);D(n,function(e,t){for(var n=e,i=e.length;i<r+2;i++)n+=" ";console.log(n+t)})}}(e._delegate._repo,t)},statsIncrementCounter:function(e,t){!function(e,t){e.stats_.incrementCounter(t),e.statsReporter_.statsToReport_[t]=!0}(e._delegate._repo,t)},dataUpdateCount:function(e){return e._delegate._repo.dataUpdateCount},interceptServerData:function(e,t){return function(e,t){e.interceptServerDataCallback_=t}(e._delegate._repo,t)},initStandalone:function(e){var t=e.app,n=e.url,i=e.customAuthImpl,o=e.namespace,a=e.nodeAdmin,s=void 0!==a&&a;u(e.version);var c=new r.c("auth-internal",new r.b("database-standalone"));return c.setComponent(new r.a("auth-internal",function(){return i},"PRIVATE")),{instance:new To(yo(t,c,void 0,n,s),t),namespace:o}}}),No=Pe;Pe.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Pe.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var xo=Object.freeze({__proto__:null,DataConnection:No,RealTimeConnection:re,hijackHash:function(e){var t=Pe.prototype.put;return Pe.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){Pe.prototype.put=t}},ConnectionTarget:q,queryIdentifier:function(e){return e._delegate._queryIdentifier},forceRestClient:function(e){!function(e){go=e}(e)}}),Ro=To.ServerValue;!function(t){u(t.SDK_VERSION);var n=t.INTERNAL.registerComponent(new r.a("database",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return new To(yo(r,i,o,n),r)},"PUBLIC").setServiceProps({Reference:Io,Query:Po,Database:To,DataSnapshot:So,enableLogging:w,INTERNAL:Ao,ServerValue:Ro,TEST_ACCESS:xo}).setMultipleInstances(!0));t.registerVersion("@firebase/database","0.11.0"),Object(i.x)()&&(e.exports=n)}(t.a)}).call(this,n("3UD+")(e))},"6nsN":function(e,t,n){"use strict";n.r(t);var r=n("zIRd");(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},n=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,e];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}return globalThis}(this);function i(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function o(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:i(e)}}!function(e,r){if(r){var i=n;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];a in i||(i[a]={}),i=i[a]}(r=r(o=i[e=e[e.length-1]]))!=o&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Promise",function(e){function t(e){this.b=0,this.c=void 0,this.a=[];var t=this.f();try{e(t.resolve,t.reject)}catch(n){t.reject(n)}}function r(){this.a=null}function i(e){return e instanceof t?e:new t(function(t){t(e)})}if(e)return e;r.prototype.b=function(e){if(null==this.a){this.a=[];var t=this;this.c(function(){t.g()})}this.a.push(e)};var a=n.setTimeout;r.prototype.c=function(e){a(e,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(r){this.f(r)}}}this.a=null},r.prototype.f=function(e){this.c(function(){throw e})},t.prototype.f=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.m),reject:e(this.g)}},t.prototype.m=function(e){if(e===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.s(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.v(e):this.h(e)}},t.prototype.v=function(e){var t=void 0;try{t=e.then}catch(n){return void this.g(n)}"function"==typeof t?this.u(t,e):this.h(e)},t.prototype.g=function(e){this.i(2,e)},t.prototype.h=function(e){this.i(1,e)},t.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.c=t,this.l()},t.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)s.b(this.a[e]);this.a=null}};var s=new r;return t.prototype.s=function(e){var t=this.f();e.Ra(t.resolve,t.reject)},t.prototype.u=function(e,t){var n=this.f();try{e.call(t,n.resolve,n.reject)}catch(r){n.reject(r)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(n){o(n)}}:t}var i,o,a=new t(function(e,t){i=e,o=t});return this.Ra(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Ra=function(e,t){function n(){switch(r.b){case 1:e(r.c);break;case 2:t(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},t.resolve=i,t.reject=function(e){return new t(function(t,n){n(e)})},t.race=function(e){return new t(function(t,n){for(var r=o(e),a=r.next();!a.done;a=r.next())i(a.value).Ra(t,n)})},t.all=function(e){var n=o(e),r=n.next();return r.done?i([]):new t(function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,i(r.value).Ra(o(a.length-1),t),r=n.next()}while(!r.done)})},t});var a=a||{},s=this||self,u=/^[\w+/_-]+[=]{0,2}$/,c=null;function l(e){return(e=e.querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&u.test(e)?e:""}function h(){}function f(e){var t=typeof e;return"object"!=t?t:e?Array.isArray(e)?"array":t:"null"}function d(e){var t=f(e);return"array"==t||"object"==t&&"number"==typeof e.length}function p(e){return"function"==f(e)}function v(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function g(e){return Object.prototype.hasOwnProperty.call(e,y)&&e[y]||(e[y]=++m)}var y="closure_uid_"+(1e9*Math.random()>>>0),m=0;function b(e,t,n){return e.call.apply(e.bind,arguments)}function _(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function w(e,t,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:_).apply(null,arguments)}function k(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var C=Date.now;function E(e,t){function n(){}n.prototype=t.prototype,e.bb=t.prototype,e.prototype=new n,e.prototype.constructor=e}function O(e){return e}function S(e,t,n){this.code=T+e,this.message=t||A[e]||"",this.a=n||null}function P(e){var t=e&&e.code;return t?new S(t.substring(T.length),e.message,e.serverResponse):null}E(S,Error),S.prototype.w=function(){var e={code:this.code,message:this.message};return this.a&&(e.serverResponse=this.a),e},S.prototype.toJSON=function(){return this.w()};var I,T="auth/",A={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},N={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function x(e){for(var t in N)if(N[t].id===e)return{firebaseEndpoint:(e=N[t]).Ua,secureTokenEndpoint:e.$a,identityPlatformEndpoint:e.Xa};return null}function R(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(t){return!1}}function M(e){if(Error.captureStackTrace)Error.captureStackTrace(this,M);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function D(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");M.call(this,n+e[r])}function L(e,t){throw new D("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function B(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function F(e,t){e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}function j(){this.b=this.a=null}I=x("__EID__")?"__EID__":void 0,E(M,Error),M.prototype.name="CustomError",E(D,M),D.prototype.name="AssertionError",B.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var U=new B(function(){return new z},function(e){e.reset()});function V(){var e=mt,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function z(){this.next=this.b=this.a=null}j.prototype.add=function(e,t){var n=U.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},z.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},z.prototype.reset=function(){this.next=this.b=this.a=null};var H=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},G=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)},q=Array.prototype.filter?function(e,t){return Array.prototype.filter.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=[],i=0,o="string"==typeof e?e.split(""):e,a=0;a<n;a++)if(a in o){var s=o[a];t.call(void 0,s,a,e)&&(r[i++]=s)}return r},W=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),i="string"==typeof e?e.split(""):e,o=0;o<n;o++)o in i&&(r[o]=t.call(void 0,i[o],o,e));return r},$=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(e,t){for(var n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e))return!0;return!1};function Z(e,t){return 0<=H(e,t)}function Q(e,t){var n;return(n=0<=(t=H(e,t)))&&Array.prototype.splice.call(e,t,1),n}function Y(e,t){!function(e,t){for(var n="string"==typeof e?e.split(""):e,r=e.length-1;0<=r;--r)r in n&&t.call(void 0,n[r],r,e)}(e,function(n,r){t.call(void 0,n,r,e)&&Array.prototype.splice.call(e,r,1)})}function K(e){return Array.prototype.concat.apply([],arguments)}function J(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}var X,ee=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},te=/&/g,ne=/</g,re=/>/g,ie=/"/g,oe=/'/g,ae=/\x00/g,se=/[\x00&<>"']/;function ue(e,t){return-1!=e.indexOf(t)}function ce(e,t){return e<t?-1:e>t?1:0}e:{var le=s.navigator;if(le){var he=le.userAgent;if(he){X=he;break e}}X=""}function fe(e){return ue(X,e)}function de(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function pe(e){for(var t in e)return!1;return!0}function ve(e){var t,n={};for(t in e)n[t]=e[t];return n}var ge="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ye(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<ge.length;o++)n=ge[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function me(e,t){e:{try{var n=e&&e.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||s).Element&&r.Location){var i=r;break e}}catch(a){}i=null}if(i&&void 0!==i[t]&&(!e||!(e instanceof i[t])&&(e instanceof i.Location||e instanceof i.Element))){if(v(e))try{var o=e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e)}catch(a){o="<object could not be stringified>"}else o=void 0===e?"undefined":null===e?"null":typeof e;L("Argument is not a %s (or a non-Element, non-Location mock); got: %s",t,o)}}function be(e,t){this.a=e===Ce&&t||"",this.b=ke}function _e(e){return e instanceof be&&e.constructor===be&&e.b===ke?e.a:(L("expected object of type Const, got '"+e+"'"),"type_error:Const")}be.prototype.ta=!0,be.prototype.sa=function(){return this.a},be.prototype.toString=function(){return"Const{"+this.a+"}"};var we,ke={},Ce={};function Ee(){if(void 0===we){var e=null,t=s.trustedTypes;if(t&&t.createPolicy){try{e=t.createPolicy("goog#html",{createHTML:O,createScript:O,createScriptURL:O})}catch(n){s.console&&s.console.error(n.message)}we=e}else we=e}return we}function Oe(e,t){this.a=t===Ae?e:""}function Se(e){return e instanceof Oe&&e.constructor===Oe?e.a:(L("expected object of type TrustedResourceUrl, got '"+e+"' of type "+f(e)),"type_error:TrustedResourceUrl")}function Pe(e,t){var n=_e(e);if(!Te.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(e){var t=Ee();return new Oe(e=t?t.createScriptURL(e):e,Ae)}(e=n.replace(Ie,function(e,r){if(!Object.prototype.hasOwnProperty.call(t,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(t));return(e=t[r])instanceof be?_e(e):encodeURIComponent(String(e))}))}Oe.prototype.ta=!0,Oe.prototype.sa=function(){return this.a.toString()},Oe.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Ie=/%{(\w+)}/g,Te=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Ae={};function Ne(e,t){this.a=t===Fe?e:""}function xe(e){return e instanceof Ne&&e.constructor===Ne?e.a:(L("expected object of type SafeUrl, got '"+e+"' of type "+f(e)),"type_error:SafeUrl")}Ne.prototype.ta=!0,Ne.prototype.sa=function(){return this.a.toString()},Ne.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Re=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Me=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,De=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Le(e){if(e instanceof Ne)return e;if(e="object"==typeof e&&e.ta?e.sa():String(e),De.test(e))e=new Ne(e,Fe);else{var t=(e=(e=String(e)).replace(/(%0A|%0D)/g,"")).match(Me);e=t&&Re.test(t[1])?new Ne(e,Fe):null}return e}function Be(e){return e instanceof Ne?e:(e="object"==typeof e&&e.ta?e.sa():String(e),De.test(e)||(e="about:invalid#zClosurez"),new Ne(e,Fe))}var Fe={},je=new Ne("about:invalid#zClosurez",Fe);function Ue(e,t,n){this.a=n===Ve?e:""}Ue.prototype.ta=!0,Ue.prototype.sa=function(){return this.a.toString()},Ue.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Ve={};function ze(e,t,n,r){return e=e instanceof Ne?e:Be(e),t=t||s,n=n instanceof be?_e(n):n||"",t.open(xe(e),n,r,void 0)}function He(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Ge(e){return se.test(e)&&(-1!=e.indexOf("&")&&(e=e.replace(te,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(ne,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(re,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(ie,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(oe,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(ae,"&#0;"))),e}function qe(e){return qe[" "](e),e}qe[" "]=h;var We,$e,Ze=fe("Opera"),Qe=fe("Trident")||fe("MSIE"),Ye=fe("Edge"),Ke=Ye||Qe,Je=fe("Gecko")&&!(ue(X.toLowerCase(),"webkit")&&!fe("Edge"))&&!(fe("Trident")||fe("MSIE"))&&!fe("Edge"),Xe=ue(X.toLowerCase(),"webkit")&&!fe("Edge");function et(){var e=s.document;return e?e.documentMode:void 0}e:{var tt="",nt=($e=X,Je?/rv:([^\);]+)(\)|;)/.exec($e):Ye?/Edge\/([\d\.]+)/.exec($e):Qe?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec($e):Xe?/WebKit\/(\S+)/.exec($e):Ze?/(?:Version)[ \/]?(\S+)/.exec($e):void 0);if(nt&&(tt=nt?nt[1]:""),Qe){var rt=et();if(null!=rt&&rt>parseFloat(tt)){We=String(rt);break e}}We=tt}var it={};function ot(e){return function(e,t){var n=it;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t()}(e,function(){for(var t=0,n=ee(String(We)).split("."),r=ee(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=ce(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ce(0==a[2].length,0==s[2].length)||ce(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t})}var at=s.document&&Qe&&(et()||parseInt(We,10))||void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch($e){}var st=!Qe||9<=Number(at);function ut(e){var t=document;return"string"==typeof e?t.getElementById(e):e}function ct(e,t){de(t,function(t,n){t&&"object"==typeof t&&t.ta&&(t=t.sa()),"style"==n?e.style.cssText=t:"class"==n?e.className=t:"for"==n?e.htmlFor=t:ft.hasOwnProperty(n)?e.setAttribute(ft[n],t):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?e.setAttribute(n,t):e[n]=t})}var lt,ht,ft={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function dt(e,t,n){function r(n){n&&t.appendChild("string"==typeof n?e.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!d(o)||v(o)&&0<o.nodeType)r(o);else{e:{if(o&&"number"==typeof o.length){if(v(o)){var a="function"==typeof o.item||"string"==typeof o.item;break e}if(p(o)){a="function"==typeof o.item;break e}}a=!1}G(a?J(o):o,r)}}}function pt(e,t){return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)}function vt(e){s.setTimeout(function(){throw e},0)}function gt(e,t){ht||function(){if(s.Promise&&s.Promise.resolve){var e=s.Promise.resolve(void 0);ht=function(){e.then(bt)}}else ht=function(){var e=bt;!p(s.setImmediate)||s.Window&&s.Window.prototype&&!fe("Edge")&&s.Window.prototype.setImmediate==s.setImmediate?(lt||(lt=function(){var e=s.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!fe("Presto")&&(e=function(){var e=pt(document,"IFRAME");e.style.display="none",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=w(function(e){"*"!=r&&e.origin!=r||e.data!=n||this.port1.onmessage()},this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}}),void 0!==e&&!fe("Trident")&&!fe("MSIE")){var t=new e,n={},r=n;return t.port1.onmessage=function(){if(void 0!==n.next){var e=(n=n.next).Hb;n.Hb=null,e()}},function(e){r.next={Hb:e},r=r.next,t.port2.postMessage(0)}}return function(e){s.setTimeout(e,0)}}()),lt(e)):s.setImmediate(e)}}(),yt||(ht(),yt=!0),mt.add(e,t)}var yt=!1,mt=new j;function bt(){for(var e;e=V();){try{e.a.call(e.b)}catch(t){vt(t)}F(U,e)}yt=!1}function _t(e,t){if(this.a=wt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,e!=h)try{var n=this;e.call(t,function(e){Mt(n,kt,e)},function(e){if(!(e instanceof Vt))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(t){}Mt(n,Ct,e)})}catch(r){Mt(this,Ct,r)}}var wt=0,kt=2,Ct=3;function Et(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Et.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ot=new B(function(){return new Et},function(e){e.reset()});function St(e,t,n){var r=Ot.get();return r.g=e,r.b=t,r.f=n,r}function Pt(e){if(e instanceof _t)return e;var t=new _t(h);return Mt(t,kt,e),t}function It(e){return new _t(function(t,n){n(e)})}function Tt(e,t,n){Dt(e,t,n,null)||gt(k(t,e))}function At(e){return new _t(function(t){var n=e.length,r=[];if(n)for(var i=function(e,i,o){n--,r[e]=i?{Qb:!0,value:o}:{Qb:!1,reason:o},0==n&&t(r)},o=0;o<e.length;o++)Tt(e[o],k(i,o,!0),k(i,o,!1));else t(r)})}function Nt(e,t){if(e.a==wt)if(e.c){var n=e.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==e&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==wt&&1==r?Nt(n,t):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):Bt(n),Ft(n,i,Ct,t)))}e.c=null}else Mt(e,Ct,t)}function xt(e,t){e.b||e.a!=kt&&e.a!=Ct||Lt(e),e.f?e.f.next=t:e.b=t,e.f=t}function Rt(e,t,n,r){var i=St(null,null,null);return i.a=new _t(function(e,o){i.g=t?function(n){try{var i=t.call(r,n);e(i)}catch(a){o(a)}}:e,i.b=n?function(t){try{var i=n.call(r,t);void 0===i&&t instanceof Vt?o(t):e(i)}catch(a){o(a)}}:o}),i.a.c=e,xt(e,i),i.a}function Mt(e,t,n){e.a==wt&&(e===n&&(t=Ct,n=new TypeError("Promise cannot resolve to itself")),e.a=1,Dt(n,e.$c,e.ad,e)||(e.i=n,e.a=t,e.c=null,Lt(e),t!=Ct||n instanceof Vt||function(e,t){e.g=!0,gt(function(){e.g&&Ut.call(null,t)})}(e,n)))}function Dt(e,t,n,r){if(e instanceof _t)return xt(e,St(t||h,n||null,r)),!0;if(R(e))return e.then(t,n,r),!0;if(v(e))try{var i=e.then;if(p(i))return function(e,t,n,r,i){function o(e){a||(a=!0,r.call(i,e))}var a=!1;try{t.call(e,function(e){a||(a=!0,n.call(i,e))},o)}catch(s){o(s)}}(e,i,t,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function Lt(e){e.h||(e.h=!0,gt(e.gc,e))}function Bt(e){var t=null;return e.b&&(e.b=(t=e.b).next,t.next=null),e.b||(e.f=null),t}function Ft(e,t,n,r){if(n==Ct&&t.b&&!t.c)for(;e&&e.g;e=e.c)e.g=!1;if(t.a)t.a.c=null,jt(t,n,r);else try{t.c?t.g.call(t.f):jt(t,n,r)}catch(i){Ut.call(null,i)}F(Ot,t)}function jt(e,t,n){t==kt?e.g.call(e.f,n):e.b&&e.b.call(e.f,n)}_t.prototype.then=function(e,t,n){return Rt(this,p(e)?e:null,p(t)?t:null,n)},_t.prototype.$goog_Thenable=!0,(e=_t.prototype).oa=function(e,t){return(e=St(e,e,t)).c=!0,xt(this,e),this},e.o=function(e,t){return Rt(this,null,e,t)},e.cancel=function(e){if(this.a==wt){var t=new Vt(e);gt(function(){Nt(this,t)},this)}},e.$c=function(e){this.a=wt,Mt(this,kt,e)},e.ad=function(e){this.a=wt,Mt(this,Ct,e)},e.gc=function(){for(var e;e=Bt(this);)Ft(this,e,this.a,this.i);this.h=!1};var Ut=vt;function Vt(e){M.call(this,e)}function zt(){0!=Ht&&(Gt[g(this)]=this),this.ya=this.ya,this.pa=this.pa}E(Vt,M),Vt.prototype.name="cancel";var Ht=0,Gt={};function qt(e){if(!e.ya&&(e.ya=!0,e.Da(),0!=Ht)){var t=g(e);if(0!=Ht&&e.pa&&0<e.pa.length)throw Error(e+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Gt[t]}}zt.prototype.ya=!1,zt.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Wt=Object.freeze||function(e){return e},$t=!Qe||9<=Number(at),Zt=Qe&&!ot("9"),Qt=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{s.addEventListener("test",h,t),s.removeEventListener("test",h,t)}catch(n){}return e}();function Yt(e,t){this.type=e,this.b=this.target=t,this.defaultPrevented=!1}function Kt(e,t){if(Yt.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=t,t=e.relatedTarget){if(Je){e:{try{qe(t.nodeName);var i=!0;break e}catch(o){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Jt[e.pointerType]||"",this.a=e,e.defaultPrevented&&this.preventDefault()}}Yt.prototype.preventDefault=function(){this.defaultPrevented=!0},E(Kt,Yt);var Jt=Wt({2:"touch",3:"pen",4:"mouse"});Kt.prototype.preventDefault=function(){Kt.bb.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Zt)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(t){}},Kt.prototype.g=function(){return this.a};var Xt="closure_listenable_"+(1e6*Math.random()|0),en=0;function tn(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.Wa=i,this.key=++en,this.wa=this.Qa=!1}function nn(e){e.wa=!0,e.listener=null,e.proxy=null,e.src=null,e.Wa=null}function rn(e){this.src=e,this.a={},this.b=0}function on(e,t){var n=t.type;n in e.a&&Q(e.a[n],t)&&(nn(t),0==e.a[n].length&&(delete e.a[n],e.b--))}function an(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.wa&&o.listener==t&&o.capture==!!n&&o.Wa==r)return i}return-1}rn.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=an(e,t,r,i);return-1<a?(t=e[a],n||(t.Qa=!1)):((t=new tn(t,this.src,o,!!r,i)).Qa=n,e.push(t)),t};var sn="closure_lm_"+(1e6*Math.random()|0),un={};function cn(e,t,n,r,i){if(r&&r.once)hn(e,t,n,r,i);else if(Array.isArray(t))for(var o=0;o<t.length;o++)cn(e,t[o],n,r,i);else n=_n(n),e&&e[Xt]?kn(e,t,n,v(r)?!!r.capture:!!r,i):ln(e,t,n,!1,r,i)}function ln(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=v(i)?!!i.capture:!!i,s=mn(e);if(s||(e[sn]=s=new rn(e)),!(n=s.add(t,n,r,a,o)).proxy)if(r=function(){var e=yn,t=$t?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Qt||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(pn(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}}function hn(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)hn(e,t[o],n,r,i);else n=_n(n),e&&e[Xt]?Cn(e,t,n,v(r)?!!r.capture:!!r,i):ln(e,t,n,!0,r,i)}function fn(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)fn(e,t[o],n,r,i);else r=v(r)?!!r.capture:!!r,n=_n(n),e&&e[Xt]?(e=e.v,(t=String(t).toString())in e.a&&-1<(n=an(o=e.a[t],n,r,i))&&(nn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--))):e&&(e=mn(e))&&(t=e.a[t.toString()],e=-1,t&&(e=an(t,n,r,i)),(n=-1<e?t[e]:null)&&dn(n))}function dn(e){if("number"!=typeof e&&e&&!e.wa){var t=e.src;if(t&&t[Xt])on(t.v,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(pn(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=mn(t))?(on(n,e),0==n.b&&(n.src=null,t[sn]=null)):nn(e)}}}function pn(e){return e in un?un[e]:un[e]="on"+e}function vn(e,t,n,r){var i=!0;if((e=mn(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.wa&&(o=gn(o,r),i=i&&!1!==o)}return i}function gn(e,t){var n=e.listener,r=e.Wa||e.src;return e.Qa&&dn(e),n.call(r,t)}function yn(e,t){if(e.wa)return!0;if(!$t){if(!t)e:{t=["window","event"];for(var n=s,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}if(t=new Kt(r=t,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){e:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(a){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=t.b;i;i=i.parentNode)r.push(i);for(e=e.type,i=r.length-1;0<=i;i--){t.b=r[i];var o=vn(r[i],e,!0,t);n=n&&o}for(i=0;i<r.length;i++)t.b=r[i],o=vn(r[i],e,!1,t),n=n&&o}return n}return gn(e,new Kt(t,this))}function mn(e){return(e=e[sn])instanceof rn?e:null}var bn="__closure_events_fn_"+(1e9*Math.random()>>>0);function _n(e){return p(e)?e:(e[bn]||(e[bn]=function(t){return e.handleEvent(t)}),e[bn])}function wn(){zt.call(this),this.v=new rn(this),this.bc=this,this.hb=null}function kn(e,t,n,r,i){e.v.add(String(t),n,!1,r,i)}function Cn(e,t,n,r,i){e.v.add(String(t),n,!0,r,i)}function En(e,t,n,r){if(!(t=e.v.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.wa&&a.capture==n){var s=a.listener,u=a.Wa||a.src;a.Qa&&on(e.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function On(e,t,n){if(p(e))n&&(e=w(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=w(e.handleEvent,e)}return 2147483647<Number(t)?-1:s.setTimeout(e,t||0)}function Sn(e){var t=null;return new _t(function(n,r){-1==(t=On(function(){n(void 0)},e))&&r(Error("Failed to schedule timer."))}).o(function(e){throw s.clearTimeout(t),e})}function Pn(e){if(e.X&&"function"==typeof e.X)return e.X();if("string"==typeof e)return e.split("");if(d(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}function In(e){if(e.Y&&"function"==typeof e.Y)return e.Y();if(!e.X||"function"!=typeof e.X){if(d(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}function Tn(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Tn)for(n=e.Y(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function An(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Nn(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)Nn(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function Nn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}E(wn,zt),wn.prototype[Xt]=!0,wn.prototype.addEventListener=function(e,t,n,r){cn(this,e,t,n,r)},wn.prototype.removeEventListener=function(e,t,n,r){fn(this,e,t,n,r)},wn.prototype.dispatchEvent=function(e){var t,n=this.hb;if(n)for(t=[];n;n=n.hb)t.push(n);n=this.bc;var r=e.type||e;if("string"==typeof e)e=new Yt(e,n);else if(e instanceof Yt)e.target=e.target||n;else{var i=e;ye(e=new Yt(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var a=e.b=t[o];i=En(a,r,!0,e)&&i}if(i=En(a=e.b=n,r,!0,e)&&i,i=En(a,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=En(a=e.b=t[o],r,!1,e)&&i;return i},wn.prototype.Da=function(){if(wn.bb.Da.call(this),this.v){var e,t=this.v;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)nn(n[r]);delete t.a[e],t.b--}}this.hb=null},(e=Tn.prototype).X=function(){An(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},e.Y=function(){return An(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(e,t){return Nn(this.b,e)?this.b[e]:t},e.set=function(e,t){Nn(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},e.forEach=function(e,t){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var xn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Rn(e,t){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,e instanceof Rn?(this.i=void 0!==t?t:e.i,Mn(this,e.c),this.l=e.l,this.a=e.a,Dn(this,e.g),this.f=e.f,Ln(this,tr(e.b)),this.h=e.h):e&&(n=String(e).match(xn))?(this.i=!!t,Mn(this,n[1]||"",!0),this.l=Vn(n[2]||""),this.a=Vn(n[3]||"",!0),Dn(this,n[4]),this.f=Vn(n[5]||"",!0),Ln(this,n[6]||"",!0),this.h=Vn(n[7]||"")):(this.i=!!t,this.b=new Qn(null,this.i))}function Mn(e,t,n){e.c=n?Vn(t,!0):t,e.c&&(e.c=e.c.replace(/:$/,""))}function Dn(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.g=t}else e.g=null}function Ln(e,t,n){t instanceof Qn?(e.b=t,function(e,t){t&&!e.f&&(Yn(e),e.c=null,e.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Jn(this,t),er(this,n,e))},e)),e.f=t}(e.b,e.i)):(n||(t=zn(t,$n)),e.b=new Qn(t,e.i))}function Bn(e,t,n){e.b.set(t,n)}function Fn(e,t){return e.b.get(t)}function jn(e){return e instanceof Rn?new Rn(e):new Rn(e,void 0)}function Un(e,t,n,r){var i=new Rn(null,void 0);return e&&Mn(i,e),t&&(i.a=t),n&&Dn(i,n),r&&(i.f=r),i}function Vn(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function zn(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Hn),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Hn(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Rn.prototype.toString=function(){var e=[],t=this.c;t&&e.push(zn(t,Gn,!0),":");var n=this.a;return(n||"file"==t)&&(e.push("//"),(t=this.l)&&e.push(zn(t,Gn,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&e.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&e.push("/"),e.push(zn(n,"/"==n.charAt(0)?Wn:qn,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.h)&&e.push("#",zn(n,Zn)),e.join("")},Rn.prototype.resolve=function(e){var t=new Rn(this),n=!!e.c;n?Mn(t,e.c):n=!!e.l,n?t.l=e.l:n=!!e.a,n?t.a=e.a:n=null!=e.g;var r=e.f;if(n)Dn(t,e.g);else if(n=!!e.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=t.f.lastIndexOf("/");-1!=i&&(r=t.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ue(i,"./")||ue(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?t.f=r:n=""!==e.b.toString(),n?Ln(t,tr(e.b)):n=!!e.h,n&&(t.h=e.h),t};var Gn=/[#\/\?@]/g,qn=/[#\?:]/g,Wn=/[#\?]/g,$n=/[#\?@]/g,Zn=/#/g;function Qn(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Yn(e){e.a||(e.a=new Tn,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Kn(e){var t=In(e);if(void 0===t)throw Error("Keys are undefined");var n=new Qn(null,void 0);e=Pn(e);for(var r=0;r<t.length;r++){var i=t[r],o=e[r];Array.isArray(o)?er(n,i,o):n.add(i,o)}return n}function Jn(e,t){Yn(e),t=nr(e,t),Nn(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,Nn((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&An(e)))}function Xn(e,t){return Yn(e),t=nr(e,t),Nn(e.a.b,t)}function er(e,t,n){Jn(e,t),0<n.length&&(e.c=null,e.a.set(nr(e,t),J(n)),e.b+=n.length)}function tr(e){var t=new Qn;return t.c=e.c,e.a&&(t.a=new Tn(e.a),t.b=e.b),t}function nr(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function rr(e){var t=[];return or(new ir,e,t),t.join("")}function ir(){}function or(e,t,n){if(null==t)n.push("null");else{if("object"==typeof t){if(Array.isArray(t)){var r=t;t=r.length,n.push("[");for(var i="",o=0;o<t;o++)n.push(i),or(e,r[o],n),i=",";return void n.push("]")}if(!(t instanceof String||t instanceof Number||t instanceof Boolean)){for(r in n.push("{"),i="",t)Object.prototype.hasOwnProperty.call(t,r)&&"function"!=typeof(o=t[r])&&(n.push(i),ur(r,n),n.push(":"),or(e,o,n),i=",");return void n.push("}")}t=t.valueOf()}switch(typeof t){case"string":ur(t,n);break;case"number":n.push(isFinite(t)&&!isNaN(t)?String(t):"null");break;case"boolean":n.push(String(t));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof t)}}}(e=Qn.prototype).add=function(e,t){Yn(this),this.c=null,e=nr(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(e,t){Yn(this),this.a.forEach(function(n,r){G(n,function(n){e.call(t,n,r,this)},this)},this)},e.Y=function(){Yn(this);for(var e=this.a.X(),t=this.a.Y(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},e.X=function(e){Yn(this);var t=[];if("string"==typeof e)Xn(this,e)&&(t=K(t,this.a.get(nr(this,e))));else{e=this.a.X();for(var n=0;n<e.length;n++)t=K(t,e[n])}return t},e.set=function(e,t){return Yn(this),this.c=null,Xn(this,e=nr(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},e.get=function(e,t){return e&&0<(e=this.X(e)).length?String(e[0]):t},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.Y(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.X(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")};var ar={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},sr=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function ur(e,t){t.push('"',e.replace(sr,function(e){var t=ar[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),ar[e]=t),t}),'"')}function cr(){var e=Ir();return Qe&&!!at&&11==at||/Edge\/\d+/.test(e)}function lr(){return s.window&&s.window.location.href||self&&self.location&&self.location.href||""}function hr(e,t){t=t||s.window;var n="about:blank";e&&(n=xe(Le(e)||je)),t.location.href=n}function fr(e,t){var n,r=[];for(n in e)n in t?typeof e[n]!=typeof t[n]?r.push(n):"object"==typeof e[n]&&null!=e[n]&&null!=t[n]?0<fr(e[n],t[n]).length&&r.push(n):e[n]!==t[n]&&r.push(n):r.push(n);for(n in t)n in e||r.push(n);return r}function dr(e){return!!((e=(e||Ir()).toLowerCase()).match(/android/)||e.match(/webos/)||e.match(/iphone|ipad|ipod/)||e.match(/blackberry/)||e.match(/windows phone/)||e.match(/iemobile/))}function pr(e){e=e||s.window;try{e.close()}catch(t){}}function vr(e,t,n){var r=Math.floor(1e9*Math.random()).toString();t=t||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-t)/2;for(a in t={width:t,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Ir().toLowerCase(),r&&(t.target=r,ue(n,"crios/")&&(t.target="_blank")),Or(Ir())==Er&&(e=e||"http://localhost",t.scrollbars=!0),n=e||"",(e=t)||(e={}),r=window,t=n instanceof Ne?n:Le(void 0!==n.href?n.href:String(n))||je,n=e.target||n.target,i=[],e)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+e[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(e[a]?1:0))}var a=i.join(",");if((fe("iPhone")&&!fe("iPod")&&!fe("iPad")||fe("iPad")||fe("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(me(a=pt(document,"A"),"HTMLAnchorElement"),t=t instanceof Ne?t:Be(t),a.href=xe(t),a.setAttribute("target",n),e.noreferrer&&a.setAttribute("rel","noreferrer"),(e=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(e),a={}):e.noreferrer?(a=ze("",r,n,a),e=xe(t),a&&(Ke&&ue(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),a.opener=null,e='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Ge(e)+'">',e=new Ue(e=(r=Ee())?r.createHTML(e):e,null,Ve),r=a.document)&&(r.write(function(e){return e instanceof Ue&&e.constructor===Ue?e.a:(L("expected object of type SafeHtml, got '"+e+"' of type "+f(e)),"type_error:SafeHtml")}(e)),r.close())):(a=ze(t,r,n,a))&&e.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var gr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yr=/^[^@]+@[^@]+$/;function mr(){var e=null;return new _t(function(t){"complete"==s.document.readyState?t():(e=function(){t()},hn(window,"load",e))}).o(function(t){throw fn(window,"load",e),t})}function br(e){return e=e||Ir(),!("file:"!==Rr()&&"ionic:"!==Rr()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function _r(){var e=s.window;try{return!(!e||e==e.top)}catch(t){return!1}}function wr(){return void 0!==s.WorkerGlobalScope&&"function"==typeof s.importScripts}function kr(){return r.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.a.INTERNAL.hasOwnProperty("node")?"Node":wr()?"Worker":"Browser"}function Cr(){var e=kr();return"ReactNative"===e||"Node"===e}var Er="Firefox";function Or(e){var t=e.toLowerCase();return ue(t,"opera/")||ue(t,"opr/")||ue(t,"opios/")?"Opera":ue(t,"iemobile")?"IEMobile":ue(t,"msie")||ue(t,"trident/")?"IE":ue(t,"edge/")?"Edge":ue(t,"firefox/")?Er:ue(t,"silk/")?"Silk":ue(t,"blackberry")?"Blackberry":ue(t,"webos")?"Webos":!ue(t,"safari/")||ue(t,"chrome/")||ue(t,"crios/")||ue(t,"android")?!ue(t,"chrome/")&&!ue(t,"crios/")||ue(t,"edge/")?ue(t,"android")?"Android":(e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length?e[1]:"Other":"Chrome":"Safari"}var Sr={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Pr(e,t){t=t||[];var n,r=[],i={};for(n in Sr)i[Sr[n]]=!0;for(n=0;n<t.length;n++)void 0!==i[t[n]]&&(delete i[t[n]],r.push(t[n]));return r.sort(),(t=r).length||(t=["FirebaseCore-web"]),"Browser"===(r=kr())?r=Or(i=Ir()):"Worker"===r&&(r=Or(i=Ir())+"-"+r),r+"/JsCore/"+e+"/"+t.join(",")}function Ir(){return s.navigator&&s.navigator.userAgent||""}function Tr(e,t){e=e.split("."),t=t||s;for(var n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];return n!=e.length&&(t=void 0),t}function Ar(){try{var e=s.localStorage,t=Fr();if(e)return e.setItem(t,"1"),e.removeItem(t),!cr()||!!s.indexedDB}catch(n){return wr()&&!!s.indexedDB}return!1}function Nr(){return(xr()||"chrome-extension:"===Rr()||br())&&!Cr()&&Ar()&&!wr()}function xr(){return"http:"===Rr()||"https:"===Rr()}function Rr(){return s.location&&s.location.protocol||null}function Mr(e){return!dr(e=e||Ir())&&Or(e)!=Er}function Dr(e){return void 0===e?null:rr(e)}function Lr(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&null!=e[t]&&(n[t]=e[t]);return n}function Br(e){if(null!==e)return JSON.parse(e)}function Fr(e){return e||Math.floor(1e9*Math.random()).toString()}function jr(e){return"Safari"!=Or(e=e||Ir())&&!e.toLowerCase().match(/iphone|ipad|ipod/)}function Ur(){var e=s.___jsl;if(e&&e.H)for(var t in e.H)if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=e.H[t].L.concat(),e.CP)for(var n=0;n<e.CP.length;n++)e.CP[n]=null}function Vr(e,t){if(e>t)throw Error("Short delay should be less than long delay!");this.a=e,this.c=t,e=Ir(),t=kr(),this.b=dr(e)||"ReactNative"===t}function zr(){var e=s.document;return!e||void 0===e.visibilityState||"visible"==e.visibilityState}function Hr(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime())&&!/[^0-9]/.test(e))return t.toUTCString()}catch(n){}return null}function Gr(){return!(!Tr("fireauth.oauthhelper",s)&&!Tr("fireauth.iframe",s))}Vr.prototype.get=function(){var e=s.navigator;return!e||"boolean"!=typeof e.onLine||!xr()&&"chrome-extension:"!==Rr()&&void 0===e.connection||e.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var qr,Wr={};function $r(e){Wr[e]||(Wr[e]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e))}try{var Zr={};Object.defineProperty(Zr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Zr,"abcd",{configurable:!0,enumerable:!0,value:2}),qr=2==Zr.abcd}catch($e){qr=!1}function Qr(e,t,n){qr?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n}function Yr(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&Qr(e,n,t[n])}function Kr(e){var t={};return Yr(t,e),t}function Jr(e){var t=e;if("object"==typeof e&&null!=e)for(var n in t="length"in e?[]:{},e)Qr(t,n,Jr(e[n]));return t}function Xr(e){var t=e&&(e[ii]?"phone":null);if(!(t&&e&&e[ri]))throw new S("internal-error","Internal assert: invalid MultiFactorInfo object");Qr(this,"uid",e[ri]),Qr(this,"displayName",e[ti]||null);var n=null;e[ni]&&(n=new Date(e[ni]).toUTCString()),Qr(this,"enrollmentTime",n),Qr(this,"factorId",t)}function ei(e){try{var t=new oi(e)}catch(n){t=null}return t}Xr.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var ti="displayName",ni="enrolledAt",ri="mfaEnrollmentId",ii="phoneInfo";function oi(e){Xr.call(this,e),Qr(this,"phoneNumber",e[ii])}function ai(e){var t={},n=e[li],r=e[fi],i=e[di];if(e=ei(e[hi]),!i||i!=ui&&i!=ci&&!n||i==ci&&!r||i==si&&!e)throw Error("Invalid checkActionCode response!");i==ci?(t[vi]=n||null,t[yi]=n||null,t[pi]=r):(t[vi]=r||null,t[yi]=r||null,t[pi]=n||null),t[gi]=e||null,Qr(this,bi,i),Qr(this,mi,Jr(t))}E(oi,Xr),oi.prototype.w=function(){var e=oi.bb.w.call(this);return e.phoneNumber=this.phoneNumber,e};var si="REVERT_SECOND_FACTOR_ADDITION",ui="EMAIL_SIGNIN",ci="VERIFY_AND_CHANGE_EMAIL",li="email",hi="mfaInfo",fi="newEmail",di="requestType",pi="email",vi="fromEmail",gi="multiFactorInfo",yi="previousEmail",mi="data",bi="operation";function _i(e){var t=Fn(e=jn(e),wi)||null,n=Fn(e,ki)||null,r=Fn(e,Oi)||null;if(r=r&&Pi[r]||null,!t||!n||!r)throw new S("argument-error",wi+", "+ki+"and "+Oi+" are required in a valid action code URL.");Yr(this,{apiKey:t,operation:r,code:n,continueUrl:Fn(e,Ci)||null,languageCode:Fn(e,Ei)||null,tenantId:Fn(e,Si)||null})}var wi="apiKey",ki="oobCode",Ci="continueUrl",Ei="languageCode",Oi="mode",Si="tenantId",Pi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:si,signIn:ui,verifyAndChangeEmail:ci,verifyEmail:"VERIFY_EMAIL"};function Ii(e){try{return new _i(e)}catch(t){return null}}function Ti(e){var t=e[Mi];if(void 0===t)throw new S("missing-continue-uri");if("string"!=typeof t||"string"==typeof t&&!t.length)throw new S("invalid-continue-uri");this.h=t,this.b=this.a=null,this.g=!1;var n=e[Ai];if(n&&"object"==typeof n){t=n[Bi];var r=n[Di];if(n=n[Li],"string"==typeof t&&t.length){if(this.a=t,void 0!==r&&"boolean"!=typeof r)throw new S("argument-error",Di+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new S("argument-error",Li+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==t)throw new S("argument-error",Bi+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new S("missing-android-pkg-name")}}else if(void 0!==n)throw new S("argument-error",Ai+" property must be a non null object when specified.");if(this.f=null,(t=e[Ri])&&"object"==typeof t){if("string"==typeof(t=t[Fi])&&t.length)this.f=t;else if(void 0!==t)throw new S("argument-error",Fi+" property must be a non empty string when specified.")}else if(void 0!==t)throw new S("argument-error",Ri+" property must be a non null object when specified.");if(void 0!==(t=e[xi])&&"boolean"!=typeof t)throw new S("argument-error",xi+" property must be a boolean when specified.");if(this.c=!!t,void 0!==(e=e[Ni])&&("string"!=typeof e||"string"==typeof e&&!e.length))throw new S("argument-error",Ni+" property must be a non empty string when specified.");this.i=e||null}var Ai="android",Ni="dynamicLinkDomain",xi="handleCodeInApp",Ri="iOS",Mi="url",Di="installApp",Li="minimumVersion",Bi="packageName",Fi="bundleId";function ji(e){var t={};for(var n in t.continueUrl=e.h,t.canHandleCodeInApp=e.c,(t.androidPackageName=e.a)&&(t.androidMinimumVersion=e.b,t.androidInstallApp=e.g),t.iOSBundleId=e.f,t.dynamicLinkDomain=e.i,t)null===t[n]&&delete t[n];return t}var Ui=null;function Vi(e){var t=Hi(e);if(!(t&&t.sub&&t.iss&&t.aud&&t.exp))throw Error("Invalid JWT");this.h=e,this.a=t.exp,this.i=t.sub,e=Date.now()/1e3,this.g=t.iat||(e>this.a?this.a:e),this.b=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.f=t.firebase&&t.firebase.tenant||null,this.c=!!t.is_anonymous||"anonymous"==this.b}function zi(e){try{return new Vi(e)}catch(t){return null}}function Hi(e){if(!e)return null;if(3!=(e=e.split(".")).length)return null;for(var t=(4-(e=e[1]).length%4)%4,n=0;n<t;n++)e+=".";try{var r=function(e){var t=[];return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=Ui[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}!function(){if(!Ui){Ui={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=e.concat(t[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Ui[o]&&(Ui[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,function(e){t.push(e)}),t}(e);for(e=[],n=t=0;t<r.length;){var i=r[t++];if(128>i)e[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[t++];var a=r[t++],s=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(s>>10)),e[n++]=String.fromCharCode(56320+(1023&s))}else o=r[t++],a=r[t++],e[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return JSON.parse(e.join(""))}catch(u){}return null}Vi.prototype.T=function(){return this.f},Vi.prototype.l=function(){return this.c},Vi.prototype.toString=function(){return this.h};var Gi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),qi=["client_id","response_type","scope","redirect_uri","state"],Wi={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:qi},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:qi},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:qi},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:Gi},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function $i(e){for(var t in Wi)if(Wi[t].fa==e)return Wi[t];return null}function Zi(e){var t={};t["facebook.com"]=Xi,t["google.com"]=to,t["github.com"]=eo,t["twitter.com"]=no;var n=e&&e[Yi];try{if(n)return t[n]?new t[n](e):new Ji(e);if(void 0!==e[Qi])return new Ki(e)}catch(r){}return null}var Qi="idToken",Yi="providerId";function Ki(e){var t=e[Yi];if(!t&&e[Qi]){var n=zi(e[Qi]);n&&n.b&&(t=n.b)}if(!t)throw Error("Invalid additional user info!");"anonymous"!=t&&"custom"!=t||(t=null),n=!1,void 0!==e.isNewUser?n=!!e.isNewUser:"identitytoolkit#SignupNewUserResponse"===e.kind&&(n=!0),Qr(this,"providerId",t),Qr(this,"isNewUser",n)}function Ji(e){Ki.call(this,e),Qr(this,"profile",Jr((e=Br(e.rawUserInfo||"{}"))||{}))}function Xi(e){if(Ji.call(this,e),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function eo(e){if(Ji.call(this,e),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Qr(this,"username",this.profile&&this.profile.login||null)}function to(e){if(Ji.call(this,e),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function no(e){if(Ji.call(this,e),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Qr(this,"username",e.screenName||null)}function ro(e){var t=jn(e),n=Fn(t,"link"),r=Fn(jn(n),"link");return t=Fn(t,"deep_link_id"),Fn(jn(t),"link")||t||r||n||e}function io(e,t){if(!e&&!t)throw new S("internal-error","Internal assert: no raw session string available");if(e&&t)throw new S("internal-error","Internal assert: unable to determine the session type");this.a=e||null,this.b=t||null,this.type=this.a?oo:ao}E(Ji,Ki),E(Xi,Ji),E(eo,Ji),E(to,Ji),E(no,Ji);var oo="enroll",ao="signin";function so(){}function uo(e,t){return e.then(function(e){if(e[Qa]){var n=zi(e[Qa]);if(!n||t!=n.i)throw new S("user-mismatch");return e}throw new S("user-mismatch")}).o(function(e){throw e&&e.code&&e.code==T+"user-not-found"?new S("user-mismatch"):e})}function co(e,t){if(!t)throw new S("internal-error","failed to construct a credential");this.a=t,Qr(this,"providerId",e),Qr(this,"signInMethod",e)}function lo(e){return{pendingToken:e.a,requestUri:"http://localhost"}}function ho(e){if(e&&e.providerId&&e.signInMethod&&0==e.providerId.indexOf("saml.")&&e.pendingToken)try{return new co(e.providerId,e.pendingToken)}catch(t){}return null}function fo(e,t,n){if(this.a=null,t.idToken||t.accessToken)t.idToken&&Qr(this,"idToken",t.idToken),t.accessToken&&Qr(this,"accessToken",t.accessToken),t.nonce&&!t.pendingToken&&Qr(this,"nonce",t.nonce),t.pendingToken&&(this.a=t.pendingToken);else{if(!t.oauthToken||!t.oauthTokenSecret)throw new S("internal-error","failed to construct a credential");Qr(this,"accessToken",t.oauthToken),Qr(this,"secret",t.oauthTokenSecret)}Qr(this,"providerId",e),Qr(this,"signInMethod",n)}function po(e){var t={};return e.idToken&&(t.id_token=e.idToken),e.accessToken&&(t.access_token=e.accessToken),e.secret&&(t.oauth_token_secret=e.secret),t.providerId=e.providerId,e.nonce&&!e.a&&(t.nonce=e.nonce),t={postBody:Kn(t).toString(),requestUri:"http://localhost"},e.a&&(delete t.postBody,t.pendingToken=e.a),t}function vo(e){if(e&&e.providerId&&e.signInMethod){var t={idToken:e.oauthIdToken,accessToken:e.oauthTokenSecret?null:e.oauthAccessToken,oauthTokenSecret:e.oauthTokenSecret,oauthToken:e.oauthTokenSecret&&e.oauthAccessToken,nonce:e.nonce,pendingToken:e.pendingToken};try{return new fo(e.providerId,t,e.signInMethod)}catch(n){}}return null}function go(e,t){this.Qc=t||[],Yr(this,{providerId:e,isOAuthProvider:!0}),this.Jb={},this.qb=($i(e)||{}).Ja||null,this.pb=null}function yo(e){if("string"!=typeof e||0!=e.indexOf("saml."))throw new S("argument-error",'SAML provider IDs must be prefixed with "saml."');go.call(this,e,[])}function mo(e){go.call(this,e,qi),this.a=[]}function bo(){mo.call(this,"facebook.com")}function _o(e){if(!e)throw new S("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return v(e)&&(t=e.accessToken),(new bo).credential({accessToken:t})}function wo(){mo.call(this,"github.com")}function ko(e){if(!e)throw new S("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return v(e)&&(t=e.accessToken),(new wo).credential({accessToken:t})}function Co(){mo.call(this,"google.com"),this.Ca("profile")}function Eo(e,t){var n=e;return v(e)&&(n=e.idToken,t=e.accessToken),(new Co).credential({idToken:n,accessToken:t})}function Oo(){go.call(this,"twitter.com",Gi)}function So(e,t){var n=e;if(v(n)||(n={oauthToken:e,oauthTokenSecret:t}),!n.oauthToken||!n.oauthTokenSecret)throw new S("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new fo("twitter.com",n,"twitter.com")}function Po(e,t,n){this.a=e,this.f=t,Qr(this,"providerId","password"),Qr(this,"signInMethod",n===To.EMAIL_LINK_SIGN_IN_METHOD?To.EMAIL_LINK_SIGN_IN_METHOD:To.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Io(e){return e&&e.email&&e.password?new Po(e.email,e.password,e.signInMethod):null}function To(){Yr(this,{providerId:"password",isOAuthProvider:!1})}function Ao(e,t){if(!(t=No(t)))throw new S("argument-error","Invalid email link!");return new Po(e,t.code,To.EMAIL_LINK_SIGN_IN_METHOD)}function No(e){return(e=Ii(e=ro(e)))&&e.operation===ui?e:null}function xo(e){if(!(e.fb&&e.eb||e.La&&e.ea))throw new S("internal-error");this.a=e,Qr(this,"providerId","phone"),this.fa="phone",Qr(this,"signInMethod","phone")}function Ro(e){if(e&&"phone"===e.providerId&&(e.verificationId&&e.verificationCode||e.temporaryProof&&e.phoneNumber)){var t={};return G(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){e[n]&&(t[n]=e[n])}),new xo(t)}return null}function Mo(e){return e.a.La&&e.a.ea?{temporaryProof:e.a.La,phoneNumber:e.a.ea}:{sessionInfo:e.a.fb,code:e.a.eb}}function Do(e){try{this.a=e||r.a.auth()}catch(t){throw new S("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Yr(this,{providerId:"phone",isOAuthProvider:!1})}function Lo(e,t){if(!e)throw new S("missing-verification-id");if(!t)throw new S("missing-verification-code");return new xo({fb:e,eb:t})}function Bo(e){if(e.temporaryProof&&e.phoneNumber)return new xo({La:e.temporaryProof,ea:e.phoneNumber});var t=e&&e.providerId;if(!t||"password"===t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret,i=e&&e.nonce,o=e&&e.oauthIdToken,a=e&&e.pendingToken;try{switch(t){case"google.com":return Eo(o,n);case"facebook.com":return _o(n);case"github.com":return ko(n);case"twitter.com":return So(n,r);default:return n||r||o||a?a?0==t.indexOf("saml.")?new co(t,a):new fo(t,{pendingToken:a,idToken:e.oauthIdToken,accessToken:e.oauthAccessToken},t):new mo(t).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function Fo(e){if(!e.isOAuthProvider)throw new S("invalid-oauth-provider")}function jo(e,t,n,r,i,o,a){if(this.c=e,this.b=t||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new S("invalid-auth-event");if(this.g&&this.a)throw new S("invalid-auth-event");if(this.g&&!this.f)throw new S("invalid-auth-event")}function Uo(e){return(e=e||{}).type?new jo(e.type,e.eventId,e.urlResponse,e.sessionId,e.error&&P(e.error),e.postBody,e.tenantId):null}function Vo(){this.b=null,this.a=[]}io.prototype.Ha=function(){return Pt(this.a?this.a:this.b)},io.prototype.w=function(){return this.type==oo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},so.prototype.ka=function(){},so.prototype.b=function(){},so.prototype.c=function(){},so.prototype.w=function(){},co.prototype.ka=function(e){return gs(e,lo(this))},co.prototype.b=function(e,t){var n=lo(this);return n.idToken=t,ys(e,n)},co.prototype.c=function(e,t){return uo(ms(e,lo(this)),t)},co.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},fo.prototype.ka=function(e){return gs(e,po(this))},fo.prototype.b=function(e,t){var n=po(this);return n.idToken=t,ys(e,n)},fo.prototype.c=function(e,t){return uo(ms(e,po(this)),t)},fo.prototype.w=function(){var e={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(e.oauthIdToken=this.idToken),this.accessToken&&(e.oauthAccessToken=this.accessToken),this.secret&&(e.oauthTokenSecret=this.secret),this.nonce&&(e.nonce=this.nonce),this.a&&(e.pendingToken=this.a),e},go.prototype.Ka=function(e){return this.Jb=ve(e),this},E(yo,go),E(mo,go),mo.prototype.Ca=function(e){return Z(this.a,e)||this.a.push(e),this},mo.prototype.Rb=function(){return J(this.a)},mo.prototype.credential=function(e,t){var n;if(!(n=v(e)?{idToken:e.idToken||null,accessToken:e.accessToken||null,nonce:e.rawNonce||null}:{idToken:e||null,accessToken:t||null}).idToken&&!n.accessToken)throw new S("argument-error","credential failed: must provide the ID token and/or the access token.");return new fo(this.providerId,n,this.providerId)},E(bo,mo),Qr(bo,"PROVIDER_ID","facebook.com"),Qr(bo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),E(wo,mo),Qr(wo,"PROVIDER_ID","github.com"),Qr(wo,"GITHUB_SIGN_IN_METHOD","github.com"),E(Co,mo),Qr(Co,"PROVIDER_ID","google.com"),Qr(Co,"GOOGLE_SIGN_IN_METHOD","google.com"),E(Oo,go),Qr(Oo,"PROVIDER_ID","twitter.com"),Qr(Oo,"TWITTER_SIGN_IN_METHOD","twitter.com"),Po.prototype.ka=function(e){return this.signInMethod==To.EMAIL_LINK_SIGN_IN_METHOD?Xs(e,Ss,{email:this.a,oobCode:this.f}):Xs(e,Zs,{email:this.a,password:this.f})},Po.prototype.b=function(e,t){return this.signInMethod==To.EMAIL_LINK_SIGN_IN_METHOD?Xs(e,Ps,{idToken:t,email:this.a,oobCode:this.f}):Xs(e,Us,{idToken:t,email:this.a,password:this.f})},Po.prototype.c=function(e,t){return uo(this.ka(e),t)},Po.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Yr(To,{PROVIDER_ID:"password"}),Yr(To,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Yr(To,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),xo.prototype.ka=function(e){return e.gb(Mo(this))},xo.prototype.b=function(e,t){var n=Mo(this);return n.idToken=t,Xs(e,Ys,n)},xo.prototype.c=function(e,t){var n=Mo(this);return n.operation="REAUTH",uo(e=Xs(e,Ks,n),t)},xo.prototype.w=function(){var e={providerId:"phone"};return this.a.fb&&(e.verificationId=this.a.fb),this.a.eb&&(e.verificationCode=this.a.eb),this.a.La&&(e.temporaryProof=this.a.La),this.a.ea&&(e.phoneNumber=this.a.ea),e},Do.prototype.gb=function(e,t){var n=this.a.a;return Pt(t.verify()).then(function(r){if("string"!=typeof r)throw new S("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(t.type){case"recaptcha":var i=v(e)?e.session:null,o=v(e)?e.phoneNumber:e;return(i&&i.type==oo?i.Ha().then(function(e){return function(e,t){return Xs(e,zs,t).then(function(e){return e.phoneSessionInfo.sessionInfo})}(n,{idToken:e,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})}):i&&i.type==ao?i.Ha().then(function(t){return function(e,t){return Xs(e,Hs,t).then(function(e){return e.phoneResponseInfo.sessionInfo})}(n,{mfaPendingCredential:t,mfaEnrollmentId:e.multiFactorHint&&e.multiFactorHint.uid||e.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})}):function(e,t){return Xs(e,Fs,t)}(n,{phoneNumber:o,recaptchaToken:r})).then(function(e){return"function"==typeof t.reset&&t.reset(),e},function(e){throw"function"==typeof t.reset&&t.reset(),e});default:throw new S("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},Yr(Do,{PROVIDER_ID:"phone"}),Yr(Do,{PHONE_SIGN_IN_METHOD:"phone"}),jo.prototype.getUid=function(){var e=[];return e.push(this.c),this.b&&e.push(this.b),this.f&&e.push(this.f),this.h&&e.push(this.h),e.join("-")},jo.prototype.T=function(){return this.h},jo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var zo,Ho=null;function Go(e){var t="unauthorized-domain",n=void 0,r=jn(e);e=r.a,"chrome-extension"==(r=r.c)?n=He("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):"http"==r||"https"==r?n=He("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):t="operation-not-supported-in-this-environment",S.call(this,t,n)}function qo(e,t,n){S.call(this,e,n),(e=t||{}).Kb&&Qr(this,"email",e.Kb),e.ea&&Qr(this,"phoneNumber",e.ea),e.credential&&Qr(this,"credential",e.credential),e.$b&&Qr(this,"tenantId",e.$b)}function Wo(e){if(e.code){var t=e.code||"";0==t.indexOf(T)&&(t=t.substring(T.length));var n={credential:Bo(e),$b:e.tenantId};if(e.email)n.Kb=e.email;else if(e.phoneNumber)n.ea=e.phoneNumber;else if(!n.credential)return new S(t,e.message||void 0);return new qo(t,n,e.message)}return null}function $o(){}function Zo(){}function Qo(e){if(!e.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.f}function Yo(){}function Ko(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=w(this.qc,this),this.a.onerror=w(this.Tb,this),this.a.onprogress=w(this.rc,this),this.a.ontimeout=w(this.vc,this)}function Jo(e,t){e.readyState=t,e.onreadystatechange&&e.onreadystatechange()}function Xo(e,t,n){this.reset(e,t,n,void 0,void 0)}function ea(e){this.f=e,this.b=this.c=this.a=null}function ta(e,t){this.name=e,this.value=t}E(Go,S),E(qo,S),qo.prototype.w=function(){var e={code:this.code,message:this.message};this.email&&(e.email=this.email),this.phoneNumber&&(e.phoneNumber=this.phoneNumber),this.tenantId&&(e.tenantId=this.tenantId);var t=this.credential&&this.credential.w();return t&&ye(e,t),e},qo.prototype.toJSON=function(){return this.w()},$o.prototype.c=null,E(Zo,$o),Zo.prototype.a=function(){var e=Qo(this);return e?new ActiveXObject(e):new XMLHttpRequest},Zo.prototype.b=function(){var e={};return Qo(this)&&(e[0]=!0,e[1]=!0),e},zo=new Zo,E(Yo,$o),Yo.prototype.a=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new Ko;throw Error("Unsupported browser")},Yo.prototype.b=function(){return{}},(e=Ko.prototype).open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(e,t)},e.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.a.send(e)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(e){return"content-type"==e.toLowerCase()?this.a.contentType:""},e.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Jo(this,4)},e.Tb=function(){this.status=500,this.response=this.responseText="",Jo(this,4)},e.vc=function(){this.Tb()},e.rc=function(){this.status=200,Jo(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Xo.prototype.a=null,Xo.prototype.reset=function(e,t,n,r,i){r||C(),delete this.a},ta.prototype.toString=function(){return this.name};var na=new ta("SEVERE",1e3),ra=new ta("WARNING",900),ia=new ta("CONFIG",700),oa=new ta("FINE",500);function aa(e){return e.c?e.c:e.a?aa(e.a):(L("Root logger has no level set."),null)}ea.prototype.log=function(e,t,n){if(e.value>=aa(this).value)for(p(t)&&(t=t()),e=new Xo(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var sa={},ua=null;function ca(e){var t;if(ua||(ua=new ea(""),sa[""]=ua,ua.c=ia),!(t=sa[e])){t=new ea(e);var n=e.lastIndexOf("."),r=e.substr(n+1);(n=ca(e.substr(0,n))).b||(n.b={}),n.b[r]=t,t.a=n,sa[e]=t}return t}function la(e,t){e&&e.log(oa,t,void 0)}function ha(e){this.f=e}function fa(e){wn.call(this),this.u=e,this.h=void 0,this.readyState=da,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=ca("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}E(ha,$o),ha.prototype.a=function(){return new fa(this.f)},ha.prototype.b=function(e){return function(){return e}}({}),E(fa,wn);var da=0;function pa(e){e.c.read().then(e.pc.bind(e)).catch(e.Va.bind(e))}function va(e){e.readyState=4,e.g=null,e.c=null,e.m=null,ga(e)}function ga(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function ya(e){wn.call(this),this.headers=new Tn,this.D=e||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=ma,this.u=this.S=!1}(e=fa.prototype).open=function(e,t){if(this.readyState!=da)throw this.abort(),Error("Error reopening a connection");this.s=e,this.f=t,this.readyState=1,ga(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.l,method:this.s,credentials:this.h,cache:void 0};e&&(t.body=e),this.u.fetch(new Request(this.f,t)).then(this.uc.bind(this),this.Va.bind(this))},e.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,va(this)),this.readyState=da},e.uc=function(e){this.a&&(this.g=e,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=e.headers,this.readyState=2,ga(this)),this.a&&(this.readyState=3,ga(this),this.a&&("arraybuffer"===this.responseType?e.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):void 0!==s.ReadableStream&&"body"in e?(this.response=this.responseText="",this.c=e.body.getReader(),this.m=new TextDecoder,pa(this)):e.text().then(this.tc.bind(this),this.Va.bind(this)))))},e.pc=function(e){if(this.a){var t=this.m.decode(e.value?e.value:new Uint8Array(0),{stream:!e.done});t&&(this.response=this.responseText+=t),e.done?va(this):ga(this),3==this.readyState&&pa(this)}},e.tc=function(e){this.a&&(this.response=this.responseText=e,va(this))},e.sc=function(e){this.a&&(this.response=e,va(this))},e.Va=function(e){var t=this.i;t&&t.log(ra,"Failed to fetch url "+this.f,e instanceof Error?e:Error(e)),this.a&&va(this)},e.setRequestHeader=function(e,t){this.l.append(e,t)},e.getResponseHeader=function(e){return this.b?this.b.get(e.toLowerCase())||"":((e=this.i)&&e.log(ra,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var e=this.i;return e&&e.log(ra,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}e=[];for(var t=this.b.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(fa.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(e){this.h=e?"include":"same-origin"}}),E(ya,wn);var ma="";ya.prototype.b=ca("goog.net.XhrIo");var ba=/^https?$/i,_a=["POST","PUT"];function wa(e){return"content-type"==e.toLowerCase()}function ka(e,t){e.c=!1,e.a&&(e.f=!0,e.a.abort(),e.f=!1),e.h=t,Ca(e),Oa(e)}function Ca(e){e.J||(e.J=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function Ea(e){if(e.c&&void 0!==a)if(e.C[1]&&4==Pa(e)&&2==Ia(e))la(e.b,Ta(e,"Local request error detected and ignored"));else if(e.i&&4==Pa(e))On(e.Wb,0,e);else if(e.dispatchEvent("readystatechange"),4==Pa(e)){la(e.b,Ta(e,"Request complete")),e.c=!1;try{var t,n=Ia(e);e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.l).match(xn)[1]||null;if(!o&&s.self&&s.self.location){var u=s.self.location.protocol;o=u.substr(0,u.length-1)}i=!ba.test(o?o.toLowerCase():"")}t=i}if(t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var c=2<Pa(e)?e.a.statusText:""}catch(l){la(e.b,"Can not get status: "+l.message),c=""}e.h=c+" ["+Ia(e)+"]",Ca(e)}}finally{Oa(e)}}}function Oa(e,t){if(e.a){Sa(e);var n=e.a,r=e.C[0]?h:null;e.a=null,e.C=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(e=e.b)&&e.log(na,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function Sa(e){e.a&&e.u&&(e.a.ontimeout=null),e.s&&(s.clearTimeout(e.s),e.s=null)}function Pa(e){return e.a?e.a.readyState:0}function Ia(e){try{return 2<Pa(e)?e.a.status:-1}catch(t){return-1}}function Ta(e,t){return t+" ["+e.P+" "+e.l+" "+Ia(e)+"]"}function Aa(e){var t=Va;this.g=[],this.u=t,this.s=e||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function Na(e,t,n){e.a=!0,e.c=n,e.f=!t,Da(e)}function xa(e){if(e.a){if(!e.v)throw new La(e);e.v=!1}}function Ra(e,t,n,r){e.g.push([t,n,r]),e.a&&Da(e)}function Ma(e){return $(e.g,function(e){return p(e[1])})}function Da(e){if(e.h&&e.a&&Ma(e)){var t=e.h,n=ja[t];n&&(s.clearTimeout(n.a),delete ja[t]),e.h=0}e.b&&(e.b.l--,delete e.b),t=e.c;for(var r=n=!1;e.g.length&&!e.i;){var i=e.g.shift(),o=i[0],a=i[1];if(i=i[2],o=e.f?a:o)try{var u=o.call(i||e.s,t);void 0!==u&&(e.f=e.f&&(u==t||u instanceof Error),e.c=t=u),(R(t)||"function"==typeof s.Promise&&t instanceof s.Promise)&&(r=!0,e.i=!0)}catch(c){t=c,e.f=!0,Ma(e)||(n=!0)}}e.c=t,r&&(u=w(e.m,e,!0),r=w(e.m,e,!1),t instanceof Aa?(Ra(t,u,r),t.C=!0):t.then(u,r)),n&&(t=new Fa(t),ja[t.a]=t,e.h=t.a)}function La(){M.call(this)}function Ba(){M.call(this)}function Fa(e){this.a=s.setTimeout(w(this.c,this),0),this.b=e}(e=ya.prototype).Ma=function(){void 0!==a&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",la(this.b,Ta(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(la(this.b,Ta(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Oa(this))},e.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Oa(this,!0)),ya.bb.Da.call(this)},e.Wb=function(){this.ya||(this.N||this.i||this.f?Ea(this):this.Jc())},e.Jc=function(){Ea(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ma:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var e=this.b;return e&&e.log(na,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return la(this.b,"Can not get response: "+t.message),null}},Aa.prototype.cancel=function(e){if(this.a)this.c instanceof Aa&&this.c.cancel();else{if(this.b){var t=this.b;delete this.b,e?t.cancel(e):(t.l--,0>=t.l&&t.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(e=new Ba(this),xa(this),Na(this,!1,e))}},Aa.prototype.m=function(e,t){this.i=!1,Na(this,e,t)},Aa.prototype.then=function(e,t,n){var r,i,o=new _t(function(e,t){r=e,i=t});return Ra(this,r,function(e){e instanceof Ba?o.cancel():i(e)}),o.then(e,t,n)},Aa.prototype.$goog_Thenable=!0,E(La,M),La.prototype.message="Deferred has already fired",La.prototype.name="AlreadyCalledError",E(Ba,M),Ba.prototype.message="Deferred was canceled",Ba.prototype.name="CanceledError",Fa.prototype.c=function(){throw delete ja[this.a],this.b};var ja={};function Ua(e){var t={},n=t.document||document,r=Se(e).toString(),i=pt(document,"SCRIPT"),o={Xb:i,Ma:void 0},a=new Aa(o),u=null,h=null!=t.timeout?t.timeout:5e3;return 0<h&&(u=window.setTimeout(function(){za(i,!0);var e=new qa(Ga,"Timeout reached for loading script "+r);xa(a),Na(a,!1,e)},h),o.Ma=u),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(za(i,t.xd||!1,u),xa(a),Na(a,!0,null))},i.onerror=function(){za(i,!0,u);var e=new qa(Ha,"Error while loading script "+r);xa(a),Na(a,!1,e)},ye(o=t.attributes||{},{type:"text/javascript",charset:"UTF-8"}),ct(i,o),function(e,t){me(e,"HTMLScriptElement"),e.src=Se(t),(t=e.ownerDocument&&e.ownerDocument.defaultView)&&t!=s?t=l(t.document):(null===c&&(c=l(s.document)),t=c),t&&e.setAttribute("nonce",t)}(i,e),function(e){var t;return(t=(e||document).getElementsByTagName("HEAD"))&&0!=t.length?t[0]:e.documentElement}(n).appendChild(i),a}function Va(){if(this&&this.Xb){var e=this.Xb;e&&"SCRIPT"==e.tagName&&za(e,!0,this.Ma)}}function za(e,t,n){null!=n&&s.clearTimeout(n),e.onload=h,e.onerror=h,e.onreadystatechange=h,t&&window.setTimeout(function(){e&&e.parentNode&&e.parentNode.removeChild(e)},0)}var Ha=0,Ga=1;function qa(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t),M.call(this,n),this.code=e}function Wa(e){this.f=e}function $a(e,t,n){if(this.c=e,this.l=(e=t||{}).secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=e.secureTokenTimeout||Ya,this.g=ve(e.secureTokenHeaders||Ka),this.h=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=e.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=e.firebaseTimeout||Ja,this.a=ve(e.firebaseHeaders||Xa),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==kr(),!(n=s.XMLHttpRequest||n&&r.a.INTERNAL.node&&r.a.INTERNAL.node.XMLHttpRequest)&&!wr())throw new S("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,this.f=wr()?new ha(self):Cr()?new Wa(n):new Yo,this.b=null}E(qa,M),E(Wa,$o),Wa.prototype.a=function(){return new this.f},Wa.prototype.b=function(){return{}};var Za,Qa="idToken",Ya=new Vr(3e4,6e4),Ka={"Content-Type":"application/x-www-form-urlencoded"},Ja=new Vr(3e4,6e4),Xa={"Content-Type":"application/json"};function es(e,t){t?e.a["X-Firebase-Locale"]=t:delete e.a["X-Firebase-Locale"]}function ts(e,t){t&&(e.l=ns("https://securetoken.googleapis.com/v1/token",t),e.h=ns("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",t),e.i=ns("https://identitytoolkit.googleapis.com/v2/",t))}function ns(e,t){return e=jn(e),t=jn(t.url),e.f=e.a+e.f,Mn(e,t.c),e.a=t.a,Dn(e,t.g),e.toString()}function rs(e,t){t?(e.a["X-Client-Version"]=t,e.g["X-Client-Version"]=t):(delete e.a["X-Client-Version"],delete e.g["X-Client-Version"])}function is(e,t,n,r,i,o,a){(function(){var e=Ir();return!((e="Chrome"!=Or(e)?null:(e=e.match(/\sChrome\/(\d+)/i))&&2==e.length?parseInt(e[1],10):null)&&30>e||Qe&&at&&!(9<at))})()||wr()?e=w(e.u,e):(Za||(Za=new _t(function(e,t){!function(e,t){((window.gapi||{}).client||{}).request?e():(s[as]=function(){((window.gapi||{}).client||{}).request?e():t(Error("CORS_UNSUPPORTED"))},function(e,t){Ra(e,null,t,void 0)}(Ua(Pe(os,{onload:as})),function(){t(Error("CORS_UNSUPPORTED"))}))}(e,t)})),e=w(e.s,e)),e(t,n,r,i,o,a)}$a.prototype.T=function(){return this.b},$a.prototype.u=function(e,t,n,r,i,o){if(wr()&&(void 0===s.fetch||void 0===s.Headers||void 0===s.Request))throw new S("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new ya(this.f);if(o){a.g=Math.max(0,o);var u=setTimeout(function(){a.dispatchEvent("timeout")},o)}kn(a,"complete",function(){u&&clearTimeout(u);var e=null;try{e=JSON.parse(function(e){try{return e.a?e.a.responseText:""}catch(t){return la(e.b,"Can not get responseText: "+t.message),""}}(this))||null}catch(n){e=null}t&&t(e)}),Cn(a,"ready",function(){u&&clearTimeout(u),qt(this)}),Cn(a,"timeout",function(){u&&clearTimeout(u),qt(this),t&&t(null)}),function(e,t,n,r,i){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.l+"; newUri="+t);n=n?n.toUpperCase():"GET",e.l=t,e.h="",e.P=n,e.J=!1,e.c=!0,e.a=e.D?e.D.a():zo.a(),e.C=function(e){return e.c||(e.c=e.b())}(e.D?e.D:zo),e.a.onreadystatechange=w(e.Wb,e);try{la(e.b,Ta(e,"Opening Xhr")),e.N=!0,e.a.open(n,String(t),!0),e.N=!1}catch(a){return la(e.b,Ta(e,"Error opening Xhr: "+a.message)),void ka(e,a)}t=r||"";var o=new Tn(e.headers);i&&function(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(d(e)||"string"==typeof e)G(e,t,void 0);else for(var n=In(e),r=Pn(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}(i,function(e,t){o.set(t,e)}),i=function(e){e:{for(var t=wa,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(o.Y()),r=s.FormData&&t instanceof s.FormData,!Z(_a,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(e,t){this.a.setRequestHeader(t,e)},e),e.m&&(e.a.responseType=e.m),"withCredentials"in e.a&&e.a.withCredentials!==e.S&&(e.a.withCredentials=e.S);try{Sa(e),0<e.g&&(e.u=function(e){return Qe&&ot(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(e.a),la(e.b,Ta(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.u)),e.u?(e.a.timeout=e.g,e.a.ontimeout=w(e.Ma,e)):e.s=On(e.Ma,e.g,e)),la(e.b,Ta(e,"Sending request")),e.i=!0,e.a.send(t),e.i=!1}catch(a){la(e.b,Ta(e,"Send error: "+a.message)),ka(e,a)}}(a,e,n,r,i)};var os=new be(Ce,"https://apis.google.com/js/client.js?onload=%{onload}"),as="__fcb"+Math.floor(1e6*Math.random()).toString();function ss(e){if("string"!=typeof(e=e.email)||!yr.test(e))throw new S("invalid-email")}function us(e){"email"in e&&ss(e)}function cs(e){if(!e[Qa]){if(e.mfaPendingCredential)throw new S("multi-factor-auth-required",null,ve(e));throw new S("internal-error")}}function ls(e){if(e.phoneNumber||e.temporaryProof){if(!e.phoneNumber||!e.temporaryProof)throw new S("internal-error")}else{if(!e.sessionInfo)throw new S("missing-verification-id");if(!e.code)throw new S("missing-verification-code")}}$a.prototype.s=function(e,t,n,r,i){var o=this;Za.then(function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:e,method:n,body:r,headers:i,authType:"none",callback:function(e){window.gapi.auth.setToken(a),t&&t(e)}})}).o(function(e){t&&t({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})})},$a.prototype.Ab=function(){return Xs(this,Vs,{})},$a.prototype.Cb=function(e,t){return Xs(this,js,{idToken:e,email:t})},$a.prototype.Db=function(e,t){return Xs(this,Us,{idToken:e,password:t})};var hs={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function fs(e){if(!e.phoneVerificationInfo)throw new S("internal-error");if(!e.phoneVerificationInfo.sessionInfo)throw new S("missing-verification-id");if(!e.phoneVerificationInfo.code)throw new S("missing-verification-code")}function ds(e){if(!e.requestUri||!e.sessionId&&!e.postBody&&!e.pendingToken)throw new S("internal-error")}function ps(e,t){return t.oauthIdToken&&t.providerId&&0==t.providerId.indexOf("oidc.")&&!t.pendingToken&&(e.sessionId?t.nonce=e.sessionId:e.postBody&&Xn(e=new Qn(e.postBody),"nonce")&&(t.nonce=e.get("nonce"))),t}function vs(e){var t=null;if(e.needConfirmation?(e.code="account-exists-with-different-credential",t=Wo(e)):"FEDERATED_USER_ID_ALREADY_LINKED"==e.errorMessage?(e.code="credential-already-in-use",t=Wo(e)):"EMAIL_EXISTS"==e.errorMessage?(e.code="email-already-in-use",t=Wo(e)):e.errorMessage&&(t=eu(e.errorMessage)),t)throw t;cs(e)}function gs(e,t){return t.returnIdpCredential=!0,Xs(e,Gs,t)}function ys(e,t){return t.returnIdpCredential=!0,Xs(e,Ws,t)}function ms(e,t){return t.returnIdpCredential=!0,t.autoCreate=!1,Xs(e,qs,t)}function bs(e){if(!e.oobCode)throw new S("invalid-action-code")}(e=$a.prototype).Eb=function(e,t){var n={idToken:e},r=[];return de(hs,function(e,i){var o=t[i];null===o?r.push(e):i in t&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),Xs(this,js,n)},e.wb=function(e,t){return ye(e={requestType:"PASSWORD_RESET",email:e},t),Xs(this,Ms,e)},e.xb=function(e,t){return ye(e={requestType:"EMAIL_SIGNIN",email:e},t),Xs(this,Ns,e)},e.vb=function(e,t){return ye(e={requestType:"VERIFY_EMAIL",idToken:e},t),Xs(this,xs,e)},e.Fb=function(e,t,n){return ye(e={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:e,newEmail:t},n),Xs(this,Rs,e)},e.gb=function(e){return Xs(this,Qs,e)},e.ob=function(e,t){return Xs(this,Bs,{oobCode:e,newPassword:t})},e.Sa=function(e){return Xs(this,ws,{oobCode:e})},e.kb=function(e){return Xs(this,_s,{oobCode:e})};var _s={endpoint:"setAccountInfo",A:bs,Z:"email",B:!0},ws={endpoint:"resetPassword",A:bs,G:function(e){var t=e.requestType;if(!t||!e.email&&"EMAIL_SIGNIN"!=t&&"VERIFY_AND_CHANGE_EMAIL"!=t)throw new S("internal-error")},B:!0},ks={endpoint:"signupNewUser",A:function(e){if(ss(e),!e.password)throw new S("weak-password")},G:cs,V:!0,B:!0},Cs={endpoint:"createAuthUri",B:!0},Es={endpoint:"deleteAccount",O:["idToken"]},Os={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(e){if(!Array.isArray(e.deleteProvider))throw new S("internal-error")}},Ss={endpoint:"emailLinkSignin",O:["email","oobCode"],A:ss,G:cs,V:!0,B:!0},Ps={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:ss,G:cs,V:!0},Is={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:fs,G:cs,B:!0,Na:!0},Ts={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:fs,G:cs,B:!0,Na:!0},As={endpoint:"getAccountInfo"},Ns={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(e){if("EMAIL_SIGNIN"!=e.requestType)throw new S("internal-error");ss(e)},Z:"email",B:!0},xs={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new S("internal-error")},Z:"email",B:!0},Rs={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(e){if("VERIFY_AND_CHANGE_EMAIL"!=e.requestType)throw new S("internal-error")},Z:"email",B:!0},Ms={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(e){if("PASSWORD_RESET"!=e.requestType)throw new S("internal-error");ss(e)},Z:"email",B:!0},Ds={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},Ls={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(e){if(!e.recaptchaSiteKey)throw new S("internal-error")}},Bs={endpoint:"resetPassword",A:bs,Z:"email",B:!0},Fs={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},js={endpoint:"setAccountInfo",O:["idToken"],A:us,V:!0},Us={endpoint:"setAccountInfo",O:["idToken"],A:function(e){if(us(e),!e.password)throw new S("weak-password")},G:cs,V:!0},Vs={endpoint:"signupNewUser",G:cs,V:!0,B:!0},zs={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(e){if(!e.phoneEnrollmentInfo)throw new S("internal-error");if(!e.phoneEnrollmentInfo.phoneNumber)throw new S("missing-phone-number");if(!e.phoneEnrollmentInfo.recaptchaToken)throw new S("missing-app-credential")},G:function(e){if(!e.phoneSessionInfo||!e.phoneSessionInfo.sessionInfo)throw new S("internal-error")},B:!0,Na:!0},Hs={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(e){if(!e.phoneSignInInfo||!e.phoneSignInInfo.recaptchaToken)throw new S("missing-app-credential")},G:function(e){if(!e.phoneResponseInfo||!e.phoneResponseInfo.sessionInfo)throw new S("internal-error")},B:!0,Na:!0},Gs={endpoint:"verifyAssertion",A:ds,Za:ps,G:vs,V:!0,B:!0},qs={endpoint:"verifyAssertion",A:ds,Za:ps,G:function(e){if(e.errorMessage&&"USER_NOT_FOUND"==e.errorMessage)throw new S("user-not-found");if(e.errorMessage)throw eu(e.errorMessage);cs(e)},V:!0,B:!0},Ws={endpoint:"verifyAssertion",A:function(e){if(ds(e),!e.idToken)throw new S("internal-error")},Za:ps,G:vs,V:!0},$s={endpoint:"verifyCustomToken",A:function(e){if(!e.token)throw new S("invalid-custom-token")},G:cs,V:!0,B:!0},Zs={endpoint:"verifyPassword",A:function(e){if(ss(e),!e.password)throw new S("wrong-password")},G:cs,V:!0,B:!0},Qs={endpoint:"verifyPhoneNumber",A:ls,G:cs,B:!0},Ys={endpoint:"verifyPhoneNumber",A:function(e){if(!e.idToken)throw new S("internal-error");ls(e)},G:function(e){if(e.temporaryProof)throw e.code="credential-already-in-use",Wo(e);cs(e)}},Ks={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:ls,G:cs,B:!0},Js={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(e){if(!!e[Qa]^!!e.refreshToken)throw new S("internal-error")},B:!0,Na:!0};function Xs(e,t,n){if(!function(e,t){if(!t||!t.length)return!0;if(!e)return!1;for(var n=0;n<t.length;n++){var r=e[t[n]];if(null==r||""===r)return!1}return!0}(n,t.O))return It(new S("internal-error"));var r,i=!!t.Na,o=t.Vb||"POST";return Pt(n).then(t.A).then(function(){return t.V&&(n.returnSecureToken=!0),t.B&&e.b&&void 0===n.tenantId&&(n.tenantId=e.b),function(e,t,n,r,i,o,a){var s=jn(t+n);Bn(s,"key",e.c),a&&Bn(s,"cb",Date.now().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&Bn(s,c,i[c]);return new _t(function(t,n){is(e,s.toString(),function(e){e?e.error?n(tu(e,o||{})):t(e):n(new S("network-request-failed"))},r,u?void 0:rr(Lr(i)),e.a,e.v.get())})}(e,i?e.i:e.h,t.endpoint,o,n,t.Ib,t.mb||!1)}).then(function(e){return r=e,t.Za?t.Za(n,r):r}).then(t.G).then(function(){if(!t.Z)return r;if(!(t.Z in r))throw new S("internal-error");return r[t.Z]})}function eu(e){return tu({error:{errors:[{message:e}],code:400,message:e}})}function tu(e,t){var n=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new S(r[n]):null)return n;for(var i in n=e.error&&e.error.message||"",ye(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},t||{}),t=(t=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<t.length?t[1]:void 0,r)if(0===n.indexOf(i))return new S(r[i],t);return!t&&e&&(t=Dr(e)),new S("internal-error",t)}function nu(e){this.b=e,this.a=null,this.sb=function(e){return(au||(au=new _t(function(e,t){function n(){Ur(),Tr("gapi.load")("gapi.iframes",{callback:e,ontimeout:function(){Ur(),t(Error("Network Error"))},timeout:iu.get()})}if(Tr("gapi.iframes.Iframe"))e();else if(Tr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();s[r]=function(){Tr("gapi.load")?n():t(Error("Network Error"))},Pt(Ua(r=Pe(ru,{onload:r}))).o(function(){t(Error("Network Error"))})}}).o(function(e){throw au=null,e}))).then(function(){return new _t(function(t,n){Tr("gapi.iframes.getContext")().open({where:document.body,url:e.b,messageHandlersFilter:Tr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),t()}e.a=r,e.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},ou.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}(this)}var ru=new be(Ce,"https://apis.google.com/js/api.js?onload=%{onload}"),iu=new Vr(3e4,6e4),ou=new Vr(5e3,15e3),au=null;function su(e,t,n,r){this.l=e,this.h=t,this.i=n,this.g=r,this.f=null,e=this.g?Un((e=jn(this.g.url)).c,e.a,e.g,"/emulator/auth/iframe"):Un("https",this.l,null,"/__/auth/iframe"),this.a=e,Bn(this.a,"apiKey",this.h),Bn(this.a,"appName",this.i),this.b=null,this.c=[]}function uu(e,t,n,r,i,o){this.u=e,this.s=t,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function cu(e){try{return r.a.app(e).auth().Ga()}catch(t){return[]}}function lu(e,t,n,r,i,o){this.s=e,this.g=t,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function hu(e){var t=lr();return function(e){return Xs(e,Ds,{}).then(function(e){return e.authorizedDomains||[]})}(e).then(function(e){e:{var n=jn(t),r=n.c;n=n.a;for(var i=0;i<e.length;i++){var o=e[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=jn(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:gr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){e=!0;break e}}e=!1}if(!e)throw new Go(lr())})}function fu(e){return e.m||(e.m=mr().then(function(){if(!e.u){var t=e.c,n=e.i,r=cu(e.b),i=new su(e.s,e.g,e.b,e.f);i.f=t,i.b=n,i.c=J(r||[]),e.u=i.toString()}e.v=new nu(e.u),function(e){if(!e.v)throw Error("IfcHandler must be initialized!");!function(e,t){e.sb.then(function(){e.a.register("authEvent",t,Tr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(e.v,function(t){var n={};if(t&&t.authEvent){var r=!1;for(t=Uo(t.authEvent),n=0;n<e.h.length;n++)r=e.h[n](t)||r;return(n={}).status=r?"ACK":"ERROR",Pt(n)}return n.status="ERROR",Pt(n)})}(e)})),e.m}function du(e){return e.l||(e.C=e.c?Pr(e.c,cu(e.b)):null,e.l=new $a(e.g,x(e.i),e.C),e.f&&ts(e.l,e.f)),e.l}function pu(e,t,n,r,i,o,a,s,u,c,l,h){return(e=new uu(e,t,n,r,i,h)).l=o,e.g=a,e.i=s,e.b=ve(u||null),e.f=c,e.zb(l).toString()}function vu(e){if(this.a=e||r.a.INTERNAL.reactNative&&r.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new S("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function gu(e){this.b=e,this.a={},this.f=w(this.c,this)}su.prototype.toString=function(){return this.f?Bn(this.a,"v",this.f):Jn(this.a.b,"v"),this.b?Bn(this.a,"eid",this.b):Jn(this.a.b,"eid"),this.c.length?Bn(this.a,"fw",this.c.join(",")):Jn(this.a.b,"fw"),this.a.toString()},uu.prototype.zb=function(e){return this.h=e,this},uu.prototype.toString=function(){if(this.v){var e=jn(this.v.url);e=Un(e.c,e.a,e.g,"/emulator/auth/handler")}else e=Un("https",this.u,null,"/__/auth/handler");if(Bn(e,"apiKey",this.s),Bn(e,"appName",this.c),Bn(e,"authType",this.m),this.a.isOAuthProvider){var t=this.a;try{var n=r.a.app(this.c).auth().la()}catch(u){n=null}for(var i in t.pb=n,Bn(e,"providerId",this.a.providerId),t=Lr((n=this.a).Jb))t[i]=t[i].toString();i=n.Qc,t=ve(t);for(var o=0;o<i.length;o++){var a=i[o];a in t&&delete t[a]}n.qb&&n.pb&&!t[n.qb]&&(t[n.qb]=n.pb),pe(t)||Bn(e,"customParameters",Dr(t))}if("function"==typeof this.a.Rb&&(n=this.a.Rb()).length&&Bn(e,"scopes",n.join(",")),this.l?Bn(e,"redirectUrl",this.l):Jn(e.b,"redirectUrl"),this.g?Bn(e,"eventId",this.g):Jn(e.b,"eventId"),this.i?Bn(e,"v",this.i):Jn(e.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!Fn(e,s)&&Bn(e,s,this.b[s]);return this.h?Bn(e,"tid",this.h):Jn(e.b,"tid"),this.f?Bn(e,"eid",this.f):Jn(e.b,"eid"),(s=cu(this.c)).length&&Bn(e,"fw",s.join(",")),e.toString()},(e=lu.prototype).Pb=function(e,t,n){var r=new S("popup-closed-by-user"),i=new S("web-storage-unsupported"),o=this,a=!1;return this.ma().then(function(){(function(e){var t={type:"webStorageSupport"};return fu(e).then(function(){return function(e,t){return e.sb.then(function(){return new _t(function(n){e.a.send(t.type,t,n,Tr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(e.v,t)}).then(function(e){if(e&&e.length&&void 0!==e[0].webStorageSupport)return e[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(e&&pr(e),t(i),a=!0)})}).o(function(){}).then(function(){if(!a)return function(e){return new _t(function(t){return function n(){Sn(2e3).then(function(){if(e&&!e.closed)return n();t()})}()})}(e)}).then(function(){if(!a)return Sn(n).then(function(){t(r)})})},e.Yb=function(){var e=Ir();return!Mr(e)&&!jr(e)},e.Ub=function(){return!1},e.Nb=function(e,t,n,r,i,o,a,s){if(!e)return It(new S("popup-blocked"));if(a&&!Mr())return this.ma().o(function(t){pr(e),i(t)}),r(),Pt();this.a||(this.a=hu(du(this)));var u=this;return this.a.then(function(){var t=u.ma().o(function(t){throw pr(e),i(t),t});return r(),t}).then(function(){Fo(n),a||hr(pu(u.s,u.g,u.b,t,n,null,o,u.c,void 0,u.i,s,u.f),e)}).o(function(e){throw"auth/network-request-failed"==e.code&&(u.a=null),e})},e.Ob=function(e,t,n,r){this.a||(this.a=hu(du(this)));var i=this;return this.a.then(function(){Fo(t),hr(pu(i.s,i.g,i.b,e,t,lr(),n,i.c,void 0,i.i,r,i.f))}).o(function(e){throw"auth/network-request-failed"==e.code&&(i.a=null),e})},e.ma=function(){var e=this;return fu(this).then(function(){return e.v.sb}).o(function(){throw e.a=null,new S("network-request-failed")})},e.ac=function(){return!0},e.Ea=function(e){this.h.push(e)},e.Ta=function(e){Y(this.h,function(t){return t==e})},(e=vu.prototype).get=function(e){return Pt(this.a.getItem(e)).then(function(e){return e&&Br(e)})},e.set=function(e,t){return Pt(this.a.setItem(e,Dr(t)))},e.U=function(e){return Pt(this.a.removeItem(e))},e.ca=function(){},e.ia=function(){};var yu,mu=[];function bu(e,t,n){pe(e.a)&&e.b.addEventListener("message",e.f),void 0===e.a[t]&&(e.a[t]=[]),e.a[t].push(n)}function _u(e){this.a=e}function wu(e){this.c=e,this.b=!1,this.a=[]}function ku(e,t,n,r){var i,o,a,s,u=n||{},c=null;if(e.b)return It(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new _t(function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout(function(){r(Error("unsupported_event"))},l),e.a.push(c={messageChannel:h,onMessage:o=function(e){e.data.eventId===i&&("ack"===e.data.status?(clearTimeout(a),s=setTimeout(function(){r(Error("timeout"))},3e3)):"done"===e.data.status?(clearTimeout(s),void 0!==e.data.response?n(e.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}}),h.port1.addEventListener("message",o),e.c.postMessage({eventType:t,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))}).then(function(t){return Cu(e,c),t}).o(function(t){throw Cu(e,c),t})}function Cu(e,t){if(t){var n=t.messageChannel;n&&(n.port1.removeEventListener("message",t.onMessage),n.port1.close()),Y(e.a,function(e){return e==t})}}function Eu(){if(!Iu())throw new S("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=s.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var e=this;wr()&&self?(this.v=function(){var e=wr()?self:null;if(G(mu,function(n){n.b==e&&(t=n)}),!t){var t=new gu(e);mu.push(t)}return t}(),bu(this.v,"keyChanged",function(t,n){return Ru(e).then(function(t){return 0<t.length&&G(e.a,function(e){e(t)}),{keyProcessed:Z(t,n.key)}})}),bu(this.v,"ping",function(){return Pt(["keyChanged"])})):function(){var e=s.navigator;return e&&e.serviceWorker?Pt().then(function(){return e.serviceWorker.ready}).then(function(e){return e.active||null}).o(function(){return null}):Pt(null)}().then(function(t){(e.h=t)&&(e.g=new wu(new _u(t)),ku(e.g,"ping",null,!0).then(function(t){t[0].fulfilled&&Z(t[0].value,"keyChanged")&&(e.s=!0)}).o(function(){}))})}function Ou(e){return new _t(function(t,n){var r=e.m.open("firebaseLocalStorageDb",1);r.onerror=function(e){try{e.preventDefault()}catch(t){}n(Error(e.target.error))},r.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?t(r):function(e){return new _t(function(t,n){var r=e.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){t()},r.onerror=function(e){n(Error(e.target.error))}})}(e).then(function(){return Ou(e)}).then(function(e){t(e)}).o(function(e){n(e)})}})}function Su(e){return e.i||(e.i=Ou(e)),e.i}function Pu(e,t){var n=0;return new _t(function r(i,o){Su(e).then(t).then(i).o(function(t){if(!(3<++n))return Su(e).then(function(t){return t.close(),e.i=void 0,r(i,o)}).o(function(e){o(e)});o(t)})})}function Iu(){try{return!!s.indexedDB}catch($e){return!1}}function Tu(e){return e.objectStore("firebaseLocalStorage")}function Au(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly")}function Nu(e){return new _t(function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()},e.onerror=function(e){n(e.target.error)}})}function xu(e,t){return e.g&&e.h&&function(){var e=s.navigator;return e&&e.serviceWorker&&e.serviceWorker.controller||null}()===e.h?ku(e.g,"keyChanged",{key:t},e.s).then(function(){}).o(function(){}):Pt()}function Ru(e){return Su(e).then(function(e){var t=Tu(Au(e,!1));return t.getAll?Nu(t.getAll()):new _t(function(e,n){var r=[],i=t.openCursor();i.onsuccess=function(t){(t=t.target.result)?(r.push(t.value),t.continue()):e(r)},i.onerror=function(e){n(e.target.error)}})}).then(function(t){var n={},r=[];if(0==e.b){for(r=0;r<t.length;r++)n[t[r].fbase_key]=t[r].value;r=fr(e.c,n),e.c=n}return r})}function Mu(e){e.l&&e.l.cancel("STOP_EVENT"),e.f&&(clearTimeout(e.f),e.f=null)}function Du(e){var t=this,n=null;this.a=[],this.type="indexedDB",this.c=e,this.b=Pt().then(function(){if(Iu()){var e=Fr(),r="__sak"+e;return yu||(yu=new Eu),(n=yu).set(r,e).then(function(){return n.get(r)}).then(function(t){if(t!==e)throw Error("indexedDB not supported!");return n.U(r)}).then(function(){return n}).o(function(){return t.c})}return t.c}).then(function(e){return t.type=e.type,e.ca(function(e){G(t.a,function(t){t(e)})}),e})}function Lu(){this.a={},this.type="inMemory"}function Bu(){if(!function(){var e="Node"==kr();if(!(e=Fu()||e&&r.a.INTERNAL.node&&r.a.INTERNAL.node.localStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==kr())throw new S("internal-error","The LocalStorage compatibility library was not found.");throw new S("web-storage-unsupported")}this.a=Fu()||r.a.INTERNAL.node.localStorage,this.type="localStorage"}function Fu(){try{var e=s.localStorage,t=Fr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(n){return null}}function ju(){this.type="nullStorage"}function Uu(){if(!function(){var e="Node"==kr();if(!(e=Vu()||e&&r.a.INTERNAL.node&&r.a.INTERNAL.node.sessionStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==kr())throw new S("internal-error","The SessionStorage compatibility library was not found.");throw new S("web-storage-unsupported")}this.a=Vu()||r.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Vu(){try{var e=s.sessionStorage,t=Fr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(n){return null}}function zu(){var e={};e.Browser=qu,e.Node=Wu,e.ReactNative=$u,e.Worker=Zu,this.a=e[kr()]}gu.prototype.c=function(e){var t=e.data.eventType,n=e.data.eventId,r=this.a[t];if(r&&0<r.length){e.ports[0].postMessage({status:"ack",eventId:n,eventType:t,response:null});var i=[];G(r,function(t){i.push(Pt().then(function(){return t(e.origin,e.data.data)}))}),At(i).then(function(r){var i=[];G(r,function(e){i.push({fulfilled:e.Qb,value:e.value,reason:e.reason?e.reason.message:void 0})}),G(i,function(e){for(var t in e)void 0===e[t]&&delete e[t]}),e.ports[0].postMessage({status:"done",eventId:n,eventType:t,response:i})})}},_u.prototype.postMessage=function(e,t){this.a.postMessage(e,t)},wu.prototype.close=function(){for(;0<this.a.length;)Cu(this,this.a[0]);this.b=!0},(e=Eu.prototype).set=function(e,t){var n=this,r=!1;return Pu(this,function(t){return Nu((t=Tu(Au(t,!0))).get(e))}).then(function(i){return Pu(n,function(o){if(o=Tu(Au(o,!0)),i)return i.value=t,Nu(o.put(i));n.b++,r=!0;var a={};return a.fbase_key=e,a.value=t,Nu(o.add(a))})}).then(function(){return n.c[e]=t,xu(n,e)}).oa(function(){r&&n.b--})},e.get=function(e){return Pu(this,function(t){return Nu(Tu(Au(t,!1)).get(e))}).then(function(e){return e&&e.value})},e.U=function(e){var t=this,n=!1;return Pu(this,function(r){return n=!0,t.b++,Nu(Tu(Au(r,!0)).delete(e))}).then(function(){return delete t.c[e],xu(t,e)}).oa(function(){n&&t.b--})},e.ca=function(e){0==this.a.length&&function(e){Mu(e),function t(){e.f=setTimeout(function(){e.l=Ru(e).then(function(t){0<t.length&&G(e.a,function(e){e(t)})}).then(function(){t()}).o(function(e){"STOP_EVENT"!=e.message&&t()})},800)}()}(this),this.a.push(e)},e.ia=function(e){Y(this.a,function(t){return t==e}),0==this.a.length&&Mu(this)},(e=Du.prototype).get=function(e){return this.b.then(function(t){return t.get(e)})},e.set=function(e,t){return this.b.then(function(n){return n.set(e,t)})},e.U=function(e){return this.b.then(function(t){return t.U(e)})},e.ca=function(e){this.a.push(e)},e.ia=function(e){Y(this.a,function(t){return t==e})},(e=Lu.prototype).get=function(e){return Pt(this.a[e])},e.set=function(e,t){return this.a[e]=t,Pt()},e.U=function(e){return delete this.a[e],Pt()},e.ca=function(){},e.ia=function(){},(e=Bu.prototype).get=function(e){var t=this;return Pt().then(function(){return Br(t.a.getItem(e))})},e.set=function(e,t){var n=this;return Pt().then(function(){var r=Dr(t);null===r?n.U(e):n.a.setItem(e,r)})},e.U=function(e){var t=this;return Pt().then(function(){t.a.removeItem(e)})},e.ca=function(e){s.window&&cn(s.window,"storage",e)},e.ia=function(e){s.window&&fn(s.window,"storage",e)},(e=ju.prototype).get=function(){return Pt(null)},e.set=function(){return Pt()},e.U=function(){return Pt()},e.ca=function(){},e.ia=function(){},(e=Uu.prototype).get=function(e){var t=this;return Pt().then(function(){return Br(t.a.getItem(e))})},e.set=function(e,t){var n=this;return Pt().then(function(){var r=Dr(t);null===r?n.U(e):n.a.setItem(e,r)})},e.U=function(e){var t=this;return Pt().then(function(){t.a.removeItem(e)})},e.ca=function(){},e.ia=function(){};var Hu,Gu,qu={F:Bu,cb:Uu},Wu={F:Bu,cb:Uu},$u={F:vu,cb:ju},Zu={F:Bu,cb:ju},Qu={rd:"local",NONE:"none",td:"session"};function Yu(){var e=!(jr(Ir())||!_r()),t=Mr(),n=Ar();this.m=e,this.h=t,this.l=n,this.a={},Hu||(Hu=new zu),e=Hu;try{this.g=!cr()&&Gr()||!s.indexedDB?new e.a.F:new Du(wr()?new Lu:new e.a.F)}catch(r){this.g=new Lu,this.h=!0}try{this.i=new e.a.cb}catch(r){this.i=new Lu}this.v=new Lu,this.f=w(this.Zb,this),this.b={}}function Ku(){return Gu||(Gu=new Yu),Gu}function Ju(e,t){switch(t){case"session":return e.i;case"none":return e.v;default:return e.g}}function Xu(e,t){return"firebase:"+e.name+(t?":"+t:"")}function ec(e,t,n){return n=Xu(t,n),"local"==t.F&&(e.b[n]=null),Ju(e,t.F).U(n)}function tc(e){e.c&&(clearInterval(e.c),e.c=null)}function nc(e){this.a=e,this.b=Ku()}(e=Yu.prototype).get=function(e,t){return Ju(this,e.F).get(Xu(e,t))},e.set=function(e,t,n){var r=Xu(e,n),i=this,o=Ju(this,e.F);return o.set(r,t).then(function(){return o.get(r)}).then(function(t){"local"==e.F&&(i.b[r]=t)})},e.addListener=function(e,t,n){e=Xu(e,t),this.l&&(this.b[e]=s.localStorage.getItem(e)),pe(this.a)&&(Ju(this,"local").ca(this.f),this.h||(cr()||!Gr())&&s.indexedDB||!this.l||function(e){tc(e),e.c=setInterval(function(){for(var t in e.a){var n=s.localStorage.getItem(t),r=e.b[t];n!=r&&(e.b[t]=n,n=new Kt({type:"storage",key:t,target:window,oldValue:r,newValue:n,a:!0}),e.Zb(n))}},1e3)}(this)),this.a[e]||(this.a[e]=[]),this.a[e].push(n)},e.removeListener=function(e,t,n){e=Xu(e,t),this.a[e]&&(Y(this.a[e],function(e){return e==n}),0==this.a[e].length&&delete this.a[e]),pe(this.a)&&(Ju(this,"local").ia(this.f),tc(this))},e.Zb=function(e){if(e&&e.g){var t=e.a.key;if(null==t)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=s.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.nb(n))}else if(0==t.indexOf("firebase:")&&this.a[t]){if(void 0!==e.a.a?Ju(this,"local").ia(this.f):tc(this),this.m)if(n=s.localStorage.getItem(t),(r=e.a.newValue)!==n)null!==r?s.localStorage.setItem(t,r):s.localStorage.removeItem(t);else if(this.b[t]===r&&void 0===e.a.a)return;var o=this;n=function(){void 0===e.a.a&&o.b[t]===s.localStorage.getItem(t)||(o.b[t]=s.localStorage.getItem(t),o.nb(t))},Qe&&at&&10==at&&s.localStorage.getItem(t)!==e.a.newValue&&e.a.newValue!==e.a.oldValue?setTimeout(n,10):n()}}else G(e,w(this.nb,this))},e.nb=function(e){this.a[e]&&G(this.a[e],function(e){e()})};var rc,ic={name:"authEvent",F:"local"};function oc(){this.a=Ku()}function ac(e,t){this.b=sc,this.f=s.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=e,this.h=t,this.l=s.Int32Array?new Int32Array(64):Array(64),void 0===rc&&(rc=s.Int32Array?new Int32Array(pc):pc),this.reset()}E(ac,function(){this.b=-1});for(var sc=64,uc=sc-1,cc=[],lc=0;lc<uc;lc++)cc[lc]=0;var hc=K(128,cc);function fc(e){for(var t=e.f,n=e.l,r=0,i=0;i<t.length;)n[r++]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],i=4*r;for(t=16;64>t;t++){var o=(0|n[t-16])+(((i=0|n[t-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[t-7])+(((r=0|n[t-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[t]=o+a|0}r=0|e.a[0],i=0|e.a[1];var s=0|e.a[2],u=0|e.a[3],c=0|e.a[4],l=0|e.a[5],h=0|e.a[6];for(o=0|e.a[7],t=0;64>t;t++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|rc[t])|0)+(0|n[t])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}e.a[0]=e.a[0]+r|0,e.a[1]=e.a[1]+i|0,e.a[2]=e.a[2]+s|0,e.a[3]=e.a[3]+u|0,e.a[4]=e.a[4]+c|0,e.a[5]=e.a[5]+l|0,e.a[6]=e.a[6]+h|0,e.a[7]=e.a[7]+o|0}function dc(e,t,n){void 0===n&&(n=t.length);var r=0,i=e.c;if("string"==typeof t)for(;r<n;)e.f[i++]=t.charCodeAt(r++),i==e.b&&(fc(e),i=0);else{if(!d(t))throw Error("message must be string or array");for(;r<n;){var o=t[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");e.f[i++]=o,i==e.b&&(fc(e),i=0)}}e.c=i,e.g+=n}ac.prototype.reset=function(){this.g=this.c=0,this.a=s.Int32Array?new Int32Array(this.h):J(this.h)};var pc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function vc(){ac.call(this,8,gc)}E(vc,ac);var gc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function yc(e,t,n,r,i,o){this.v=e,this.i=t,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=t+":"+n,this.C=new oc,this.g=new nc(this.h),this.f=null,this.b=[],this.a=this.c=null}function mc(e){return new S("invalid-cordova-configuration",e)}function bc(e,t){for(var n=0;n<e.b.length;n++)try{e.b[n](t)}catch(r){}}function _c(e){return e.f||(e.f=e.ma().then(function(){return new _t(function(t){e.Ea(function n(r){return t(r),e.Ta(n),!1}),function(e){function t(t){r=!0,i&&i.cancel(),wc(e).then(function(r){var i=n;if(r&&t&&t.url){var o=null;-1!=(i=ro(t.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Br(Fn(o=jn(i),"firebaseError")||null))?P(o):null)?new jo(r.c,r.b,null,null,o,null,r.T()):new jo(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}bc(e,i)})}var n=new jo("unknown",null,null,null,new S("no-auth-event")),r=!1,i=Sn(500).then(function(){return wc(e).then(function(){r||bc(e,n)})}),o=s.handleOpenURL;s.handleOpenURL=function(e){if(0==e.toLowerCase().indexOf(Tr("BuildInfo.packageName",s).toLowerCase()+"://")&&t({url:e}),"function"==typeof o)try{o(e)}catch(n){console.error(n)}},Ho||(Ho=new Vo),function(e){var t=Ho;t.a.push(e),t.b||(t.b=function(e){for(var n=0;n<t.a.length;n++)t.a[n](e)},"function"==typeof(e=Tr("universalLinks.subscribe",s))&&e(null,t.b))}(t)}(e)})})),e.f}function wc(e){var t=null;return function(e){return e.b.get(ic,e.a).then(function(e){return Uo(e)})}(e.g).then(function(n){return t=n,ec((n=e.g).b,ic,n.a)}).then(function(){return t})}function kc(e){this.a=e,this.b=Ku()}(e=yc.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(br(void 0)?mr().then(function(){return new _t(function(e,t){var n=s.document,r=setTimeout(function(){t(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),e()},!1)})}):It(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof Tr("universalLinks.subscribe",s))throw mc("cordova-universal-links-plugin-fix is not installed");if(void 0===Tr("BuildInfo.packageName",s))throw mc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Tr("cordova.plugins.browsertab.openUrl",s))throw mc("cordova-plugin-browsertab is not installed");if("function"!=typeof Tr("cordova.InAppBrowser.open",s))throw mc("cordova-plugin-inappbrowser is not installed")},function(){throw new S("cordova-not-ready")})},e.Pb=function(e,t){return t(new S("operation-not-supported-in-this-environment")),Pt()},e.Nb=function(){return It(new S("operation-not-supported-in-this-environment"))},e.ac=function(){return!1},e.Yb=function(){return!0},e.Ub=function(){return!0},e.Ob=function(e,t,n,r){if(this.c)return It(new S("redirect-operation-pending"));var i=this,o=s.document,a=null,u=null,c=null,l=null;return this.c=Pt().then(function(){return Fo(t),_c(i)}).then(function(){return function(e,t,n,r,i){var o=function(){for(var e=20,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}(),a=new jo(t,r,null,o,new S("no-auth-event"),null,i),u=Tr("BuildInfo.packageName",s);if("string"!=typeof u)throw new S("invalid-cordova-configuration");var c=Tr("BuildInfo.displayName",s),l={};if(Ir().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=u;else{if(!Ir().toLowerCase().match(/android/))return It(new S("operation-not-supported-in-this-environment"));l.apn=u}c&&(l.appDisplayName=c),o=function(e){var t=new vc;dc(t,e),e=[];var n=8*t.g;dc(t,hc,56>t.c?56-t.c:t.b-(t.c-56));for(var r=63;56<=r;r--)t.f[r]=255&n,n/=256;for(fc(t),r=n=0;r<t.i;r++)for(var i=24;0<=i;i-=8)e[n++]=t.a[r]>>i&255;return function(e){return W(e,function(e){return 1<(e=e.toString(16)).length?e:"0"+e}).join("")}(e)}(o),l.sessionId=o;var h=pu(e.v,e.i,e.l,t,n,null,r,e.m,l,e.u,i,e.s);return e.ma().then(function(){var t=e.h;return e.C.a.set(ic,a.w(),t)}).then(function(){var t=Tr("cordova.plugins.browsertab.isAvailable",s);if("function"!=typeof t)throw new S("invalid-cordova-configuration");var n=null;t(function(t){if(t){if("function"!=typeof(n=Tr("cordova.plugins.browsertab.openUrl",s)))throw new S("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=Tr("cordova.InAppBrowser.open",s)))throw new S("invalid-cordova-configuration");t=Ir(),e.a=n(h,t.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||t.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(i,e,t,n,r)}).then(function(){return new _t(function(e,t){u=function(){var t=Tr("cordova.plugins.browsertab.close",s);return e(),"function"==typeof t&&t(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(u),l=function(){zr()&&c()},o.addEventListener("resume",c=function(){a||(a=Sn(2e3).then(function(){t(new S("redirect-cancelled-by-user"))}))},!1),Ir().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)}).o(function(e){return wc(i).then(function(){throw e})})}).oa(function(){c&&o.removeEventListener("resume",c,!1),l&&o.removeEventListener("visibilitychange",l,!1),a&&a.cancel(),u&&i.Ta(u),i.c=null})},e.Ea=function(e){this.b.push(e),_c(this).o(function(t){"auth/invalid-cordova-configuration"===t.code&&(t=new jo("unknown",null,null,null,new S("no-auth-event")),e(t))})},e.Ta=function(e){Y(this.b,function(t){return t==e})};var Cc={name:"pendingRedirect",F:"session"};function Ec(e){return ec(e.b,Cc,e.a)}function Oc(e,t,n,r){this.i={},this.u=0,this.D=e,this.v=t,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=w(this.s,this),this.b=new Uc,this.C=new qc,this.g=new kc(Fc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Sc(this.D,this.v,this.m,I,this.J)}function Sc(e,t,n,i,o){var a=r.a.SDK_VERSION||null;return br()?new yc(e,t,n,a,i,o):new lu(e,t,n,a,i,o)}function Pc(e){e.f||(e.f=!0,e.a.Ea(e.l));var t=e.a;return e.a.ma().o(function(n){throw e.a==t&&e.reset(),n})}function Ic(e){e.a.Yb()&&Pc(e).o(function(t){var n=new jo("unknown",null,null,null,new S("operation-not-supported-in-this-environment"));Mc(t)&&e.s(n)}),e.a.Ub()||Vc(e.b)}function Tc(e,t){Z(e.h,t)||e.h.push(t),e.f||function(e){return e.b.get(Cc,e.a).then(function(e){return"pending"==e})}(e.g).then(function(t){t?Ec(e.g).then(function(){Pc(e).o(function(t){var n=new jo("unknown",null,null,null,new S("operation-not-supported-in-this-environment"));Mc(t)&&e.s(n)})}):Ic(e)}).o(function(){Ic(e)})}function Ac(e,t){Y(e.h,function(e){return e==t})}Oc.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=Sc(this.D,this.v,this.m,null,this.J),this.i={}},Oc.prototype.s=function(e){if(!e)throw new S("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),e&&e.getUid()&&this.i.hasOwnProperty(e.getUid()))return!1;for(var t=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Gb(e.c,e.b)){(t=this.c[e.c])&&(t.h(e,r),e&&(e.f||e.b)&&(this.i[e.getUid()]=!0,this.u=Date.now())),t=!0;break}}return Vc(this.b),t};var Nc=new Vr(2e3,1e4),xc=new Vr(3e4,6e4);function Rc(e,t,n,r,i,o,a){return e.a.Nb(t,n,r,function(){e.f||(e.f=!0,e.a.Ea(e.l))},function(){e.reset()},i,o,a)}function Mc(e){return!(!e||"auth/cordova-not-ready"!=e.code)}function Dc(e,t,n,r,i){var o;return function(e){return e.b.set(Cc,"pending",e.a)}(e.g).then(function(){return e.a.Ob(t,n,r,i).o(function(t){if(Mc(t))throw new S("operation-not-supported-in-this-environment");return o=t,Ec(e.g).then(function(){throw o})}).then(function(){return e.a.ac()?new _t(function(){}):Ec(e.g).then(function(){return e.ra()}).then(function(){}).o(function(){})})})}function Lc(e,t,n,r,i){return e.a.Pb(r,function(e){t.na(n,null,e,i)},Nc.get())}Oc.prototype.ra=function(){return this.b.ra()};var Bc={};function Fc(e,t,n){return e=e+":"+t,n&&(e=e+":"+n.url),e}function jc(e,t,n,r){var i=Fc(t,n,r);return Bc[i]||(Bc[i]=new Oc(e,t,n,r)),Bc[i]}function Uc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Vc(e){e.g||(e.g=!0,Gc(e,!1,null,null))}function zc(e){e.g&&!e.i&&Gc(e,!1,null,null)}function Hc(e,t){if(e.b=function(){return Pt(t)},e.f.length)for(var n=0;n<e.f.length;n++)e.f[n](t)}function Gc(e,t,n,r){t?r?function(e,t){if(e.b=function(){return It(t)},e.c.length)for(var n=0;n<e.c.length;n++)e.c[n](t)}(e,r):Hc(e,n):Hc(e,{user:null}),e.f=[],e.c=[]}function qc(){}function Wc(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(e){this.jb=e},enumerable:!1})}function $c(e,t){this.a=t,Qr(this,"verificationId",e)}function Zc(e,t,n,r){return new Do(e).gb(t,n).then(function(e){return new $c(e,r)})}function Qc(e){var t=Hi(e);if(!(t&&t.exp&&t.auth_time&&t.iat))throw new S("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Yr(this,{token:e,expirationTime:Hr(1e3*t.exp),authTime:Hr(1e3*t.auth_time),issuedAtTime:Hr(1e3*t.iat),signInProvider:t.firebase&&t.firebase.sign_in_provider?t.firebase.sign_in_provider:null,signInSecondFactor:t.firebase&&t.firebase.sign_in_second_factor?t.firebase.sign_in_second_factor:null,claims:t})}function Yc(e,t,n){var r=t&&t[Jc];if(!r)throw new S("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=e,this.f=ve(t),this.g=n,this.c=new io(null,r),this.b=[];var i=this;G(t[Kc]||[],function(e){(e=ei(e))&&i.b.push(e)}),Qr(this,"auth",this.a),Qr(this,"session",this.c),Qr(this,"hints",this.b)}Uc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Uc.prototype.h=function(e,t){if(e){this.reset(),this.g=!0;var n=e.c,r=e.b,i=e.a&&"auth/web-storage-unsupported"==e.a.code,o=e.a&&"auth/operation-not-supported-in-this-environment"==e.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?e.a?(Gc(this,!0,null,e.a),Pt()):t.Fa(n,r)?function(e,t,n){n=n.Fa(t.c,t.b);var r=t.g,i=t.f,o=t.i,a=t.T(),s=!!t.c.match(/Redirect$/);n(r,i,a,o).then(function(t){Gc(e,s,t,null)}).o(function(t){Gc(e,s,null,t)})}(this,e,t):It(new S("invalid-auth-event")):(Gc(this,!1,null,null),Pt())}else It(new S("invalid-auth-event"))},Uc.prototype.ra=function(){var e=this;return new _t(function(t,n){e.b?e.b().then(t,n):(e.f.push(t),e.c.push(n),function(e){var t=new S("timeout");e.a&&e.a.cancel(),e.a=Sn(xc.get()).then(function(){e.b||(e.g=!0,Gc(e,!0,null,t))})}(e))})},qc.prototype.h=function(e,t){if(e){var n=e.c,r=e.b;e.a?(t.na(e.c,null,e.a,e.b),Pt()):t.Fa(n,r)?function(e,t){var n=e.b,r=e.c;t.Fa(r,n)(e.g,e.f,e.T(),e.i).then(function(e){t.na(r,e,null,n)}).o(function(e){t.na(r,null,e,n)})}(e,t):It(new S("invalid-auth-event"))}else It(new S("invalid-auth-event"))},$c.prototype.confirm=function(e){return e=Lo(this.verificationId,e),this.a(e)};var Kc="mfaInfo",Jc="mfaPendingCredential";function Xc(e,t,n,r){S.call(this,"multi-factor-auth-required",r,t),this.b=new Yc(e,t,n),Qr(this,"resolver",this.b)}function el(e,t,n){if(e&&v(e.serverResponse)&&"auth/multi-factor-auth-required"===e.code)try{return new Xc(t,e.serverResponse,n,e.message)}catch(r){}return null}function tl(){}function nl(e){Qr(this,"factorId",e.fa),this.a=e}function rl(e){if(nl.call(this,e),this.a.fa!=Do.PROVIDER_ID)throw new S("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function il(e,t){for(var n in Yt.call(this,e),t)this[n]=t[n]}function ol(e,t){this.a=e,this.b=[],this.c=w(this.yc,this),cn(this.a,"userReloaded",this.c);var n=[];t&&t.multiFactor&&t.multiFactor.enrolledFactors&&G(t.multiFactor.enrolledFactors,function(e){var t=null,r={};if(e){e.uid&&(r[ri]=e.uid),e.displayName&&(r[ti]=e.displayName),e.enrollmentTime&&(r[ni]=new Date(e.enrollmentTime).toISOString()),e.phoneNumber&&(r[ii]=e.phoneNumber);try{t=new oi(r)}catch(i){}e=t}else e=null;e&&n.push(e)}),al(this,n)}function al(e,t){e.b=t,Qr(e,"enrolledFactors",t)}function sl(e,t,n){if(this.h=e,this.i=t,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function ul(e,t){e.stop(),e.b=Sn(function(e,t){return t?(e.a=e.c,e.g()):(t=e.a,e.a*=2,e.a>e.f&&(e.a=e.f),t)}(e,t)).then(function(){return function(){var e=s.document,t=null;return zr()||!e?Pt():new _t(function(n){t=function(){zr()&&(e.removeEventListener("visibilitychange",t,!1),n())},e.addEventListener("visibilitychange",t,!1)}).o(function(n){throw e.removeEventListener("visibilitychange",t,!1),n})}()}).then(function(){return e.h()}).then(function(){ul(e,!0)}).o(function(t){e.i(t)&&ul(e,!1)})}function cl(e){this.f=e,this.b=this.a=null,this.c=Date.now()}function ll(e,t){void 0===t&&(t=e.b?(t=e.b).a-t.g:0),e.c=Date.now()+1e3*t}function hl(e,t){e.b=zi(t[Qa]||""),e.a=t.refreshToken,ll(e,void 0!==(t=t.expiresIn)?Number(t):void 0)}function fl(e,t){this.a=e||null,this.b=t||null,Yr(this,{lastSignInTime:Hr(t||null),creationTime:Hr(e||null)})}function dl(e,t,n,r,i,o){Yr(this,{uid:e,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:t})}function pl(e,t,n){this.N=[],this.l=e.apiKey,this.m=e.appName,this.s=e.authDomain||null;var i=r.a.SDK_VERSION?Pr(r.a.SDK_VERSION):null;this.a=new $a(this.l,x(I),i),(this.u=e.emulatorConfig||null)&&ts(this.a,this.u),this.h=new cl(this.a),Cl(this,t[Qa]),hl(this.h,t),Qr(this,"refreshToken",this.h.a),Sl(this,n||{}),wn.call(this),this.P=!1,this.s&&Nr()&&(this.b=jc(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=function(e){return new sl(function(){return e.I(!0)},function(e){return!(!e||"auth/network-request-failed"!=e.code)},function(){var t=e.h.c-Date.now()-3e5;return 0<t?t:0})}(this),this.ba=w(this.ib,this);var o=this;this.za=null,this.Pa=function(e){o.xa(e.h)},this.qa=null,this.Ba=function(e){vl(o,e.c)},this.$=null,this.aa=[],this.Oa=function(e){ml(o,e.f)},this.ja=null,this.S=new ol(this,n),Qr(this,"multiFactor",this.S)}function vl(e,t){e.u=t,ts(e.a,t),e.b&&(t=e.b,e.b=jc(e.s,e.l,e.m,e.u),e.P&&(Ac(t,e),Tc(e.b,e)))}function gl(e,t){e.qa&&fn(e.qa,"languageCodeChanged",e.Pa),(e.qa=t)&&cn(t,"languageCodeChanged",e.Pa)}function yl(e,t){e.$&&fn(e.$,"emulatorConfigChanged",e.Ba),(e.$=t)&&cn(t,"emulatorConfigChanged",e.Ba)}function ml(e,t){e.aa=t,rs(e.a,r.a.SDK_VERSION?Pr(r.a.SDK_VERSION,e.aa):null)}function bl(e,t){e.ja&&fn(e.ja,"frameworkChanged",e.Oa),(e.ja=t)&&cn(t,"frameworkChanged",e.Oa)}function _l(e){try{return r.a.app(e.m).auth()}catch(t){throw new S("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+e.m+"'!")}}function wl(e){e.J||e.D.b||(e.D.start(),fn(e,"tokenChanged",e.ba),cn(e,"tokenChanged",e.ba))}function kl(e){fn(e,"tokenChanged",e.ba),e.D.stop()}function Cl(e,t){e.Aa=t,Qr(e,"_lat",t)}function El(e){for(var t=[],n=0;n<e.W.length;n++)t.push(e.W[n](e));return At(t).then(function(){return e})}function Ol(e){e.b&&!e.P&&(e.P=!0,Tc(e.b,e))}function Sl(e,t){Yr(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,isAnonymous:t.isAnonymous||!1,tenantId:t.tenantId||null,metadata:new fl(t.createdAt,t.lastLoginAt),providerData:[]}),e.a.b=e.tenantId}function Pl(){}function Il(e){return Pt().then(function(){if(e.J)throw new S("app-deleted")})}function Tl(e){return W(e.providerData,function(e){return e.providerId})}function Al(e,t){t&&(Nl(e,t.providerId),e.providerData.push(t))}function Nl(e,t){Y(e.providerData,function(e){return e.providerId==t})}function xl(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&Qr(e,t,n)}function Rl(e,t){e!=t&&(Yr(e,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,tenantId:t.tenantId,providerData:[]}),Qr(e,"metadata",t.metadata?function(e){return new fl(e.a,e.b)}(t.metadata):new fl),G(t.providerData,function(t){Al(e,t)}),function(e,t){e.b=t.b,e.a=t.a,e.c=t.c}(e.h,t.h),Qr(e,"refreshToken",e.h.a),al(e.S,t.S.b))}function Ml(e){return e.I().then(function(t){var n=e.isAnonymous;return function(e,t){return Xs(e.a,As,{idToken:t}).then(w(e.Kc,e))}(e,t).then(function(){return n||xl(e,"isAnonymous",!1),t})})}function Dl(e,t){t[Qa]&&e.Aa!=t[Qa]&&(hl(e.h,t),e.dispatchEvent(new il("tokenChanged")),Cl(e,t[Qa]),xl(e,"refreshToken",e.h.a))}function Ll(e,t){return Ml(e).then(function(){if(Z(Tl(e),t))return El(e).then(function(){throw new S("provider-already-linked")})})}function Bl(e,t,n){return Kr({user:e,credential:Bo(t),additionalUserInfo:t=Zi(t),operationType:n})}function Fl(e,t){return Dl(e,t),e.reload().then(function(){return e})}function jl(e,t,n,i,o){if(!Nr())return It(new S("operation-not-supported-in-this-environment"));if(e.i&&!o)return It(e.i);var a=$i(n.providerId),s=Fr(e.uid+":::"),u=null;(!Mr()||_r())&&e.s&&n.isOAuthProvider&&(u=pu(e.s,e.l,e.m,t,n,null,s,r.a.SDK_VERSION||null,null,null,e.tenantId,e.u));var c=vr(u,a&&a.va,a&&a.ua);return i=i().then(function(){if(Vl(e),!o)return e.I().then(function(){})}).then(function(){return Rc(e.b,c,t,n,s,!!u,e.tenantId)}).then(function(){return new _t(function(n,r){e.na(t,null,new S("cancelled-popup-request"),e.g||null),e.f=n,e.C=r,e.g=s,e.c=Lc(e.b,e,t,c,s)})}).then(function(e){return c&&pr(c),e?Kr(e):null}).o(function(e){throw c&&pr(c),e}),zl(e,i,o)}function Ul(e,t,n,r,i){if(!Nr())return It(new S("operation-not-supported-in-this-environment"));if(e.i&&!i)return It(e.i);var o=null,a=Fr(e.uid+":::");return r=r().then(function(){if(Vl(e),!i)return e.I().then(function(){})}).then(function(){return e.ga=a,El(e)}).then(function(t){return e.ha&&(t=(t=e.ha).b.set(ql,e.w(),t.a)),t}).then(function(){return Dc(e.b,t,n,a,e.tenantId)}).o(function(t){if(o=t,e.ha)return Wl(e.ha);throw o}).then(function(){if(o)throw o}),zl(e,r,i)}function Vl(e){if(!e.b||!e.P){if(e.b&&!e.P)throw new S("internal-error");throw new S("auth-domain-config-required")}}function zl(e,t,n){var r=function(e,t,n){return e.i&&!n?(t.cancel(),It(e.i)):t.o(function(t){throw!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(e.i||e.dispatchEvent(new il("userInvalidated")),e.i=t),t})}(e,t,n);return e.N.push(r),r.oa(function(){Q(e.N,r)}),r.o(function(t){var n=null;throw t&&"auth/multi-factor-auth-required"===t.code&&(n=el(t.w(),_l(e),w(e.jc,e))),n||t})}function Hl(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName,emulatorConfig:e.emulatorConfig},n={};if(!e.stsTokenManager||!e.stsTokenManager.accessToken)return null;n[Qa]=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken||null;var r=e.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new pl(t,n,e);return e.providerData&&G(e.providerData,function(e){e&&Al(i,Kr(e))}),e.redirectEventId&&(i.ga=e.redirectEventId),i}function Gl(e){this.a=e,this.b=Ku()}Yc.prototype.Rc=function(e){var t=this;return e.tb(this.a.a,this.c).then(function(e){var n=ve(t.f);return delete n[Kc],delete n[Jc],ye(n,e),t.g(n)})},E(Xc,S),tl.prototype.tb=function(e,t,n){return t.type==oo?function(e,t,n,r){return n.Ha().then(function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),ye(n,{phoneVerificationInfo:Mo(e.a)}),Xs(t,Is,n)})}(this,e,t,n):function(e,t,n){return n.Ha().then(function(n){return ye(n={mfaPendingCredential:n},{phoneVerificationInfo:Mo(e.a)}),Xs(t,Ts,n)})}(this,e,t)},E(nl,tl),E(rl,nl),E(il,Yt),(e=ol.prototype).yc=function(e){al(this,function(e){var t=[];return G(e.mfaInfo||[],function(e){(e=ei(e))&&t.push(e)}),t}(e.hd))},e.Sb=function(){return this.a.I().then(function(e){return new io(e,null)})},e.fc=function(e,t){var n=this,r=this.a.a;return this.Sb().then(function(n){return e.tb(r,n,t)}).then(function(e){return Dl(n.a,e),n.a.reload()})},e.bd=function(e){var t=this,n="string"==typeof e?e:e.uid,r=this.a.a;return this.a.I().then(function(e){return Xs(r,Js,{idToken:e,mfaEnrollmentId:n})}).then(function(e){var r=q(t.b,function(e){return e.uid!=n});return al(t,r),Dl(t.a,e),t.a.reload().o(function(e){if("auth/user-token-expired"!=e.code)throw e})})},e.w=function(){return{multiFactor:{enrolledFactors:W(this.b,function(e){return e.w()})}}},sl.prototype.start=function(){this.a=this.c,ul(this,!0)},sl.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},cl.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},cl.prototype.getToken=function(e){return e=!!e,this.b&&!this.a?It(new S("user-token-expired")):e||!this.b||Date.now()>this.c-3e4?this.a?function(e,t){return function(e,t){return new _t(function(n,r){"refresh_token"==t.grant_type&&t.refresh_token||"authorization_code"==t.grant_type&&t.code?is(e,e.l+"?key="+encodeURIComponent(e.c),function(e){e?e.error?r(tu(e)):e.access_token&&e.refresh_token?n(e):r(new S("internal-error")):r(new S("network-request-failed"))},"POST",Kn(t).toString(),e.g,e.m.get()):r(new S("internal-error"))})}(e.f,t).then(function(t){return e.b=zi(t.access_token),e.a=t.refresh_token,ll(e,t.expires_in),{accessToken:e.b.toString(),refreshToken:e.a}}).o(function(t){throw"auth/user-token-expired"==t.code&&(e.a=null),t})}(this,{grant_type:"refresh_token",refresh_token:this.a}):Pt(null):Pt({accessToken:this.b.toString(),refreshToken:this.a})},fl.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},E(pl,wn),pl.prototype.xa=function(e){this.za=e,es(this.a,e)},pl.prototype.la=function(){return this.za},pl.prototype.Ga=function(){return J(this.aa)},pl.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())},Qr(pl.prototype,"providerId","firebase"),(e=pl.prototype).reload=function(){var e=this;return zl(this,Il(this).then(function(){return Ml(e).then(function(){return El(e)}).then(Pl)}))},e.oc=function(e){return this.I(e).then(function(e){return new Qc(e)})},e.I=function(e){var t=this;return zl(this,Il(this).then(function(){return t.h.getToken(e)}).then(function(e){if(!e)throw new S("internal-error");return e.accessToken!=t.Aa&&(Cl(t,e.accessToken),t.dispatchEvent(new il("tokenChanged"))),xl(t,"refreshToken",e.refreshToken),e.accessToken}))},e.Kc=function(e){if(!(e=e.users)||!e.length)throw new S("internal-error");Sl(this,{uid:(e=e[0]).localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified,phoneNumber:e.phoneNumber,lastLoginAt:e.lastLoginAt,createdAt:e.createdAt,tenantId:e.tenantId});for(var t=function(e){return(e=e.providerUserInfo)&&e.length?W(e,function(e){return new dl(e.rawId,e.providerId,e.email,e.displayName,e.photoUrl,e.phoneNumber)}):[]}(e),n=0;n<t.length;n++)Al(this,t[n]);xl(this,"isAnonymous",!(this.email&&e.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new il("userReloaded",{hd:e}))},e.Lc=function(e){return $r("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(e)},e.ub=function(e){var t=this,n=null;return zl(this,e.c(this.a,this.uid).then(function(e){return Dl(t,e),n=Bl(t,e,"reauthenticate"),t.i=null,t.reload()}).then(function(){return n}),!0)},e.Cc=function(e){return $r("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(e)},e.rb=function(e){var t=this,n=null;return zl(this,Ll(this,e.providerId).then(function(){return t.I()}).then(function(n){return e.b(t.a,n)}).then(function(e){return n=Bl(t,e,"link"),Fl(t,e)}).then(function(){return n}))},e.Dc=function(e,t){var n=this;return zl(this,Ll(this,"phone").then(function(){return Zc(_l(n),e,t,w(n.rb,n))}))},e.Mc=function(e,t){var n=this;return zl(this,Pt().then(function(){return Zc(_l(n),e,t,w(n.ub,n))}),!0)},e.Cb=function(e){var t=this;return zl(this,this.I().then(function(n){return t.a.Cb(n,e)}).then(function(e){return Dl(t,e),t.reload()}))},e.ed=function(e){var t=this;return zl(this,this.I().then(function(n){return e.b(t.a,n)}).then(function(e){return Dl(t,e),t.reload()}))},e.Db=function(e){var t=this;return zl(this,this.I().then(function(n){return t.a.Db(n,e)}).then(function(e){return Dl(t,e),t.reload()}))},e.Eb=function(e){if(void 0===e.displayName&&void 0===e.photoURL)return Il(this);var t=this;return zl(this,this.I().then(function(n){return t.a.Eb(n,{displayName:e.displayName,photoUrl:e.photoURL})}).then(function(e){return Dl(t,e),xl(t,"displayName",e.displayName||null),xl(t,"photoURL",e.photoUrl||null),G(t.providerData,function(e){"password"===e.providerId&&(Qr(e,"displayName",t.displayName),Qr(e,"photoURL",t.photoURL))}),El(t)}).then(Pl))},e.cd=function(e){var t=this;return zl(this,Ml(this).then(function(n){return Z(Tl(t),e)?function(e,t,n){return Xs(e,Os,{idToken:t,deleteProvider:n})}(t.a,n,[e]).then(function(e){var n={};return G(e.providerUserInfo||[],function(e){n[e.providerId]=!0}),G(Tl(t),function(e){n[e]||Nl(t,e)}),n[Do.PROVIDER_ID]||Qr(t,"phoneNumber",null),El(t)}):El(t).then(function(){throw new S("no-such-provider")})}))},e.delete=function(){var e=this;return zl(this,this.I().then(function(t){return Xs(e.a,Es,{idToken:t})}).then(function(){e.dispatchEvent(new il("userDeleted"))})).then(function(){for(var t=0;t<e.N.length;t++)e.N[t].cancel("app-deleted");gl(e,null),yl(e,null),bl(e,null),e.N=[],e.J=!0,kl(e),Qr(e,"refreshToken",null),e.b&&Ac(e.b,e)})},e.Gb=function(e,t){return!!("linkViaPopup"==e&&(this.g||null)==t&&this.f||"reauthViaPopup"==e&&(this.g||null)==t&&this.f||"linkViaRedirect"==e&&(this.ga||null)==t||"reauthViaRedirect"==e&&(this.ga||null)==t)},e.na=function(e,t,n,r){"linkViaPopup"!=e&&"reauthViaPopup"!=e||r!=(this.g||null)||(n&&this.C?this.C(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(e,t){return"linkViaPopup"==e&&t==(this.g||null)?w(this.Lb,this):"reauthViaPopup"==e&&t==(this.g||null)?w(this.Mb,this):"linkViaRedirect"==e&&(this.ga||null)==t?w(this.Lb,this):"reauthViaRedirect"==e&&(this.ga||null)==t?w(this.Mb,this):null},e.Ec=function(e){var t=this;return jl(this,"linkViaPopup",e,function(){return Ll(t,e.providerId).then(function(){return El(t)})},!1)},e.Nc=function(e){return jl(this,"reauthViaPopup",e,function(){return Pt()},!0)},e.Fc=function(e){var t=this;return Ul(this,"linkViaRedirect",e,function(){return Ll(t,e.providerId)},!1)},e.Oc=function(e){return Ul(this,"reauthViaRedirect",e,function(){return Pt()},!0)},e.Lb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return zl(this,this.I().then(function(n){return ys(i.a,{requestUri:e,postBody:r,sessionId:t,idToken:n})}).then(function(e){return o=Bl(i,e,"link"),Fl(i,e)}).then(function(){return o}))},e.Mb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return zl(this,Pt().then(function(){return uo(ms(i.a,{requestUri:e,sessionId:t,postBody:r,tenantId:n}),i.uid)}).then(function(e){return o=Bl(i,e,"reauthenticate"),Dl(i,e),i.i=null,i.reload()}).then(function(){return o}),!0)},e.vb=function(e){var t=this,n=null;return zl(this,this.I().then(function(t){return n=t,void 0===e||pe(e)?{}:ji(new Ti(e))}).then(function(e){return t.a.vb(n,e)}).then(function(e){if(t.email!=e)return t.reload()}).then(function(){}))},e.Fb=function(e,t){var n=this,r=null;return zl(this,this.I().then(function(e){return r=e,void 0===t||pe(t)?{}:ji(new Ti(t))}).then(function(t){return n.a.Fb(r,e,t)}).then(function(e){if(n.email!=e)return n.reload()}).then(function(){}))},e.jc=function(e){var t=null,n=this;return zl(this,e=uo(Pt(e),n.uid).then(function(e){return t=Bl(n,e,"reauthenticate"),Dl(n,e),n.i=null,n.reload()}).then(function(){return t}),!0)},e.toJSON=function(){return this.w()},e.w=function(){var e={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&ye(e,this.metadata.w()),G(this.providerData,function(t){e.providerData.push(function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(t))}),ye(e,this.S.w()),e};var ql={name:"redirectUser",F:"session"};function Wl(e){return ec(e.b,ql,e.a)}function $l(e){this.a=e,this.b=Ku(),this.c=null,this.f=function(e){var t=Yl("local"),n=Yl("session"),r=Yl("none");return function(e,t,n){var r=Xu(t,n),i=Ju(e,t.F);return e.get(t,n).then(function(o){var a=null;try{a=Br(s.localStorage.getItem(r))}catch(u){}if(a&&!o)return s.localStorage.removeItem(r),e.set(t,a,n);a&&o&&"localStorage"!=i.type&&s.localStorage.removeItem(r)})}(e.b,t,e.a).then(function(){return e.b.get(n,e.a)}).then(function(i){return i?n:e.b.get(r,e.a).then(function(n){return n?r:e.b.get(t,e.a).then(function(n){return n?t:e.b.get(Ql,e.a).then(function(e){return e?Yl(e):t})})})}).then(function(t){return e.c=t,Zl(e,t.F)}).o(function(){e.c||(e.c=t)})}(this),this.b.addListener(Yl("local"),this.a,w(this.g,this))}function Zl(e,t){var n,r=[];for(n in Qu)Qu[n]!==t&&r.push(ec(e.b,Yl(Qu[n]),e.a));return r.push(ec(e.b,Ql,e.a)),function(e){return new _t(function(t,n){var r=e.length,i=[];if(r)for(var o=function(e,n){r--,i[e]=n,0==r&&t(i)},a=function(e){n(e)},s=0;s<e.length;s++)Tt(e[s],k(o,s),a);else t(i)})}(r)}$l.prototype.g=function(){var e=this,t=Yl("local");eh(this,function(){return Pt().then(function(){return e.c&&"local"!=e.c.F?e.b.get(t,e.a):null}).then(function(n){if(n)return Zl(e,"local").then(function(){e.c=t})})})};var Ql={name:"persistence",F:"session"};function Yl(e){return{name:"authUser",F:e}}function Kl(e,t){return eh(e,function(){return e.b.set(e.c,t.w(),e.a)})}function Jl(e){return eh(e,function(){return ec(e.b,e.c,e.a)})}function Xl(e,t,n){return eh(e,function(){return e.b.get(e.c,e.a).then(function(e){return e&&t&&(e.authDomain=t),e&&n&&(e.emulatorConfig=n),Hl(e||{})})})}function eh(e,t){return e.f=e.f.then(t,t),e.f}function th(e){if(this.l=!1,Qr(this,"settings",new Wc),Qr(this,"app",e),!ch(this).options||!ch(this).options.apiKey)throw new S("invalid-api-key");e=r.a.SDK_VERSION?Pr(r.a.SDK_VERSION):null,this.a=new $a(ch(this).options&&ch(this).options.apiKey,x(I),e),this.P=[],this.s=[],this.N=[],this.Pa=r.a.INTERNAL.createSubscribe(w(this.zc,this)),this.W=void 0,this.ib=r.a.INTERNAL.createSubscribe(w(this.Ac,this)),sh(this,null),this.i=new $l(ch(this).options.apiKey+":"+ch(this).name),this.D=new Gl(ch(this).options.apiKey+":"+ch(this).name),this.$=dh(this,function(e){var t=ch(e).options.authDomain,n=function(e){var t=function(e,t){return e.b.get(ql,e.a).then(function(e){return e&&t&&(e.authDomain=t),Hl(e||{})})}(e.D,ch(e).options.authDomain).then(function(t){return(e.m=t)&&(t.ha=e.D),Wl(e.D)});return dh(e,t)}(e).then(function(){return Xl(e.i,t,e.R)}).then(function(t){return t?(t.ha=e.D,e.m&&(e.m.ga||null)==(t.ga||null)?t:t.reload().then(function(){return Kl(e.i,t).then(function(){return t})}).o(function(n){return"auth/network-request-failed"==n.code?t:Jl(e.i)})):null}).then(function(t){sh(e,t||null)});return dh(e,n)}(this)),this.h=dh(this,function(e){return e.$.then(function(){return ah(e)}).o(function(){}).then(function(){if(!e.l)return e.ja()}).o(function(){}).then(function(){if(!e.l){e.ba=!0;var t=e.i;t.b.addListener(Yl("local"),t.a,e.ja)}})}(this)),this.ba=!1,this.ja=w(this.Zc,this),this.Ba=w(this.da,this),this.qa=w(this.mc,this),this.za=w(this.wc,this),this.Aa=w(this.xc,this),this.b=null,function(e){var t=ch(e).options.authDomain,n=ch(e).options.apiKey;t&&Nr()&&(e.Oa=e.$.then(function(){if(!e.l){if(e.b=jc(t,n,ch(e).name,e.R),Tc(e.b,e),lh(e)&&Ol(lh(e)),e.m){Ol(e.m);var r=e.m;r.xa(e.la()),gl(r,e),ml(r=e.m,e.J),bl(r,e),vl(r=e.m,e.R),yl(r,e),e.m=null}return e.b}}))}(this),this.INTERNAL={},this.INTERNAL.delete=w(this.delete,this),this.INTERNAL.logFramework=w(this.Gc,this),this.u=0,wn.call(this),function(e){Object.defineProperty(e,"lc",{get:function(){return this.la()},set:function(e){this.xa(e)},enumerable:!1}),e.aa=null,Object.defineProperty(e,"ti",{get:function(){return this.T()},set:function(e){this.zb(e)},enumerable:!1}),e.S=null,Object.defineProperty(e,"emulatorConfig",{get:function(){if(this.R){var e=jn(this.R.url);e=Kr({protocol:e.c,host:e.a,port:e.g,options:Kr({disableWarnings:this.R.ec})})}else e=null;return e},enumerable:!1})}(this),this.J=[],this.R=null}function nh(e){Yt.call(this,"languageCodeChanged"),this.h=e}function rh(e){Yt.call(this,"emulatorConfigChanged"),this.c=e}function ih(e){Yt.call(this,"frameworkChanged"),this.f=e}function oh(e){return e.Oa||It(new S("auth-domain-config-required"))}function ah(e){if(!Nr())return It(new S("operation-not-supported-in-this-environment"));var t=oh(e).then(function(){return e.b.ra()}).then(function(e){return e?Kr(e):null});return dh(e,t)}function sh(e,t){lh(e)&&(function(e,t){Y(e.W,function(e){return e==t})}(lh(e),e.Ba),fn(lh(e),"tokenChanged",e.qa),fn(lh(e),"userDeleted",e.za),fn(lh(e),"userInvalidated",e.Aa),kl(lh(e))),t&&(t.W.push(e.Ba),cn(t,"tokenChanged",e.qa),cn(t,"userDeleted",e.za),cn(t,"userInvalidated",e.Aa),0<e.u&&wl(t)),Qr(e,"currentUser",t),t&&(t.xa(e.la()),gl(t,e),ml(t,e.J),bl(t,e),vl(t,e.R),yl(t,e))}function uh(e,t){var n=null,r=null;return dh(e,t.then(function(t){return n=Bo(t),r=Zi(t),function(e,t){var n={};return n.apiKey=ch(e).options.apiKey,n.authDomain=ch(e).options.authDomain,n.appName=ch(e).name,e.R&&(n.emulatorConfig=e.R),e.$.then(function(){return function(e,t,n,r){var i=new pl(e,t);return n&&(i.ha=n),r&&ml(i,r),i.reload().then(function(){return i})}(n,t,e.D,e.Ga())}).then(function(t){return lh(e)&&t.uid==lh(e).uid?(Rl(lh(e),t),e.da(t)):(sh(e,t),Ol(t),e.da(t))}).then(function(){fh(e)})}(e,t)},function(t){var n=null;throw t&&"auth/multi-factor-auth-required"===t.code&&(n=el(t.w(),e,w(e.kc,e))),n||t}).then(function(){return Kr({user:lh(e),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function ch(e){return e.app}function lh(e){return e.currentUser}function hh(e){return lh(e)&&lh(e)._lat||null}function fh(e){if(e.ba){for(var t=0;t<e.s.length;t++)e.s[t]&&e.s[t](hh(e));if(e.W!==e.getUid()&&e.N.length)for(e.W=e.getUid(),t=0;t<e.N.length;t++)e.N[t]&&e.N[t](hh(e))}}function dh(e,t){return e.P.push(t),t.oa(function(){Q(e.P,t)}),t}function ph(){}function vh(){this.a={},this.b=1e12}$l.prototype.yb=function(e){var t=null,n=this;return function(e){var t=new S("invalid-persistence-type"),n=new S("unsupported-persistence-type");e:{for(r in Qu)if(Qu[r]==e){var r=!0;break e}r=!1}if(!r||"string"!=typeof e)throw t;switch(kr()){case"ReactNative":if("session"===e)throw n;break;case"Node":if("none"!==e)throw n;break;case"Worker":if("session"===e||!Iu()&&"none"!==e)throw n;break;default:if(!Ar()&&"none"!==e)throw n}}(e),eh(this,function(){return e!=n.c.F?n.b.get(n.c,n.a).then(function(r){return t=r,Zl(n,e)}).then(function(){if(n.c=Yl(e),t)return n.b.set(n.c,t,n.a)}):Pt()})},E(th,wn),E(nh,Yt),E(rh,Yt),E(ih,Yt),(e=th.prototype).yb=function(e){return dh(this,e=this.i.yb(e))},e.xa=function(e){this.aa===e||this.l||(this.aa=e,es(this.a,this.aa),this.dispatchEvent(new nh(this.la())))},e.la=function(){return this.aa},e.fd=function(){var e=s.navigator;this.xa(e&&(e.languages&&e.languages[0]||e.language||e.userLanguage)||null)},e.gd=function(e,t){if(!this.R){if(!/^https?:\/\//.test(e))throw new S("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(e){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),s.document&&!e&&mr().then(function(){var e=s.document.createElement("div");e.innerText="Running in emulator mode. Do not use with production credentials.",e.style.position="fixed",e.style.width="100%",e.style.backgroundColor="#ffffff",e.style.border=".1em solid #000000",e.style.color="#b50000",e.style.bottom="0px",e.style.left="0px",e.style.margin="0px",e.style.zIndex=1e4,e.style.textAlign="center",e.classList.add("firebase-emulator-warning"),s.document.body.appendChild(e)})})(t=!!t&&!!t.disableWarnings),this.R={url:e,ec:t},this.settings.jb=!0,ts(this.a,this.R),this.dispatchEvent(new rh(this.R))}},e.Gc=function(e){this.J.push(e),rs(this.a,r.a.SDK_VERSION?Pr(r.a.SDK_VERSION,this.J):null),this.dispatchEvent(new ih(this.J))},e.Ga=function(){return J(this.J)},e.zb=function(e){this.S===e||this.l||(this.S=e,this.a.b=this.S)},e.T=function(){return this.S},e.toJSON=function(){return{apiKey:ch(this).options.apiKey,authDomain:ch(this).options.authDomain,appName:ch(this).name,currentUser:lh(this)&&lh(this).w()}},e.Gb=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==t&&!!this.f;default:return!1}},e.na=function(e,t,n,r){"signInViaPopup"==e&&this.g==r&&(n&&this.C?this.C(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.g==t&&this.f?w(this.ic,this):null},e.ic=function(e,t,n,r){var i=this,o={requestUri:e,postBody:r,sessionId:t,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then(function(){return uh(i,gs(i.a,o))})},e.Xc=function(e){if(!Nr())return It(new S("operation-not-supported-in-this-environment"));var t=this,n=$i(e.providerId),i=Fr(),o=null;(!Mr()||_r())&&ch(this).options.authDomain&&e.isOAuthProvider&&(o=pu(ch(this).options.authDomain,ch(this).options.apiKey,ch(this).name,"signInViaPopup",e,null,i,r.a.SDK_VERSION||null,null,null,this.T(),this.R));var a=vr(o,n&&n.va,n&&n.ua);return dh(this,n=oh(this).then(function(n){return Rc(n,a,"signInViaPopup",e,i,!!o,t.T())}).then(function(){return new _t(function(e,n){t.na("signInViaPopup",null,new S("cancelled-popup-request"),t.g),t.f=e,t.C=n,t.g=i,t.c=Lc(t.b,t,"signInViaPopup",a,i)})}).then(function(e){return a&&pr(a),e?Kr(e):null}).o(function(e){throw a&&pr(a),e}))},e.Yc=function(e){if(!Nr())return It(new S("operation-not-supported-in-this-environment"));var t=this;return dh(this,oh(this).then(function(){return function(e){return eh(e,function(){return e.b.set(Ql,e.c.F,e.a)})}(t.i)}).then(function(){return Dc(t.b,"signInViaRedirect",e,void 0,t.T())}))},e.ra=function(){var e=this;return ah(this).then(function(t){return e.b&&zc(e.b.b),t}).o(function(t){throw e.b&&zc(e.b.b),t})},e.dd=function(e){if(!e)return It(new S("null-user"));if(this.S!=e.tenantId)return It(new S("tenant-id-mismatch"));var t=this,n={};n.apiKey=ch(this).options.apiKey,n.authDomain=ch(this).options.authDomain,n.appName=ch(this).name;var r=function(e,t,n,r){var i=e.h,o={};return o[Qa]=i.b&&i.b.toString(),o.refreshToken=i.a,t=new pl(t||{apiKey:e.l,authDomain:e.s,appName:e.m},o),n&&(t.ha=n),r&&ml(t,r),Rl(t,e),t}(e,n,t.D,t.Ga());return dh(this,this.h.then(function(){if(ch(t).options.apiKey!=e.l)return r.reload()}).then(function(){return lh(t)&&e.uid==lh(t).uid?(Rl(lh(t),e),t.da(e)):(sh(t,r),Ol(r),t.da(r))}).then(function(){fh(t)}))},e.Bb=function(){var e=this;return dh(this,this.h.then(function(){return e.b&&zc(e.b.b),lh(e)?(sh(e,null),Jl(e.i).then(function(){fh(e)})):Pt()}))},e.Zc=function(){var e=this;return Xl(this.i,ch(this).options.authDomain).then(function(t){if(!e.l){var n;if(n=lh(e)&&t){n=lh(e).uid;var r=t.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Rl(lh(e),t),lh(e).I();(lh(e)||t)&&(sh(e,t),t&&(Ol(t),t.ha=e.D),e.b&&Tc(e.b,e),fh(e))}})},e.da=function(e){return Kl(this.i,e)},e.mc=function(){fh(this),this.da(lh(this))},e.wc=function(){this.Bb()},e.xc=function(){this.Bb()},e.kc=function(e){var t=this;return this.h.then(function(){return uh(t,Pt(e))})},e.zc=function(e){var t=this;this.addAuthTokenListener(function(){e.next(lh(t))})},e.Ac=function(e){var t=this;!function(e,t){e.N.push(t),dh(e,e.h.then(function(){!e.l&&Z(e.N,t)&&e.W!==e.getUid()&&(e.W=e.getUid(),t(hh(e)))}))}(this,function(){e.next(lh(t))})},e.Ic=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then(function(){"function"==typeof e?e(lh(r)):"function"==typeof e.next&&e.next(lh(r))}),this.Pa(e,t,n)},e.Hc=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then(function(){r.W=r.getUid(),"function"==typeof e?e(lh(r)):"function"==typeof e.next&&e.next(lh(r))}),this.ib(e,t,n)},e.nc=function(e){var t=this;return dh(this,this.h.then(function(){return lh(t)?lh(t).I(e).then(function(e){return{accessToken:e}}):null}))},e.Tc=function(e){var t=this;return this.h.then(function(){return uh(t,Xs(t.a,$s,{token:e}))}).then(function(e){var n=e.user;return xl(n,"isAnonymous",!1),t.da(n),e})},e.Uc=function(e,t){var n=this;return this.h.then(function(){return uh(n,Xs(n.a,Zs,{email:e,password:t}))})},e.dc=function(e,t){var n=this;return this.h.then(function(){return uh(n,Xs(n.a,ks,{email:e,password:t}))})},e.ab=function(e){var t=this;return this.h.then(function(){return uh(t,e.ka(t.a))})},e.Sc=function(e){return $r("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(e)},e.Ab=function(){var e=this;return this.h.then(function(){var t=lh(e);if(t&&t.isAnonymous){var n=Kr({providerId:null,isNewUser:!1});return Kr({user:t,credential:null,additionalUserInfo:n,operationType:"signIn"})}return uh(e,e.a.Ab()).then(function(t){var n=t.user;return xl(n,"isAnonymous",!0),e.da(n),t})})},e.getUid=function(){return lh(this)&&lh(this).uid||null},e.cc=function(e){this.addAuthTokenListener(e),this.u++,0<this.u&&lh(this)&&wl(lh(this))},e.Pc=function(e){var t=this;G(this.s,function(n){n==e&&t.u--}),0>this.u&&(this.u=0),0==this.u&&lh(this)&&kl(lh(this)),this.removeAuthTokenListener(e)},e.addAuthTokenListener=function(e){var t=this;this.s.push(e),dh(this,this.h.then(function(){t.l||Z(t.s,e)&&e(hh(t))}))},e.removeAuthTokenListener=function(e){Y(this.s,function(t){return t==e})},e.delete=function(){this.l=!0;for(var e=0;e<this.P.length;e++)this.P[e].cancel("app-deleted");return this.P=[],this.i&&(e=this.i).b.removeListener(Yl("local"),e.a,this.ja),this.b&&(Ac(this.b,this),zc(this.b.b)),Promise.resolve()},e.hc=function(e){return dh(this,function(e,t){return Xs(e,Cs,{identifier:t,continueUri:xr()?lr():"http://localhost"}).then(function(e){return e.signinMethods||[]})}(this.a,e))},e.Bc=function(e){return!!No(e)},e.xb=function(e,t){var n=this;return dh(this,Pt().then(function(){var e=new Ti(t);if(!e.c)throw new S("argument-error",xi+" must be true when sending sign in link to email");return ji(e)}).then(function(t){return n.a.xb(e,t)}).then(function(){}))},e.jd=function(e){return this.Sa(e).then(function(e){return e.data.email})},e.ob=function(e,t){return dh(this,this.a.ob(e,t).then(function(){}))},e.Sa=function(e){return dh(this,this.a.Sa(e).then(function(e){return new ai(e)}))},e.kb=function(e){return dh(this,this.a.kb(e).then(function(){}))},e.wb=function(e,t){var n=this;return dh(this,Pt().then(function(){return void 0===t||pe(t)?{}:ji(new Ti(t))}).then(function(t){return n.a.wb(e,t)}).then(function(){}))},e.Wc=function(e,t){return dh(this,Zc(this,e,t,w(this.ab,this)))},e.Vc=function(e,t){var n=this;return dh(this,Pt().then(function(){var r=t||lr(),i=Ao(e,r);if(!(r=No(r)))throw new S("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new S("tenant-id-mismatch");return n.ab(i)}))},ph.prototype.render=function(){},ph.prototype.reset=function(){},ph.prototype.getResponse=function(){},ph.prototype.execute=function(){};var gh=null;function yh(e,t){return(t=mh(t))&&e.a[t]||null}function mh(e){return(e=void 0===e?1e12:e)?e.toString():null}function bh(e,t){this.g=!1,this.c=t,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=ut(e);var n=this;this.i=function(){n.execute()},this.h?this.execute():cn(this.f,"click",this.i)}function _h(e){if(e.g)throw Error("reCAPTCHA mock was already deleted!")}function wh(){}function kh(){}vh.prototype.render=function(e,t){return this.a[this.b.toString()]=new bh(e,t),this.b++},vh.prototype.reset=function(e){var t=yh(this,e);e=mh(e),t&&e&&(t.delete(),delete this.a[e])},vh.prototype.getResponse=function(e){return(e=yh(this,e))?e.getResponse():null},vh.prototype.execute=function(e){(e=yh(this,e))&&e.execute()},bh.prototype.getResponse=function(){return _h(this),this.b},bh.prototype.execute=function(){_h(this);var e=this;this.a||(this.a=setTimeout(function(){e.b=function(){for(var e=50,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}();var t=e.c.callback,n=e.c["expired-callback"];if(t)try{t(e.b)}catch(r){}e.a=setTimeout(function(){if(e.a=null,e.b=null,n)try{n()}catch(r){}e.h&&e.execute()},6e4)},500))},bh.prototype.delete=function(){_h(this),this.g=!0,clearTimeout(this.a),this.a=null,fn(this.f,"click",this.i)},Qr(wh,"FACTOR_ID","phone"),kh.prototype.g=function(){return gh||(gh=new vh),Pt(gh)},kh.prototype.c=function(){};var Ch=null;function Eh(){this.b=s.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Oh=new be(Ce,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Sh=new Vr(3e4,6e4);Eh.prototype.g=function(e){var t=this;return new _t(function(n,r){var i=setTimeout(function(){r(new S("network-request-failed"))},Sh.get());!s.grecaptcha||e!==t.f&&!t.b?(s[t.a]=function(){if(s.grecaptcha){t.f=e;var o=s.grecaptcha.render;s.grecaptcha.render=function(e,n){return e=o(e,n),t.b++,e},clearTimeout(i),n(s.grecaptcha)}else clearTimeout(i),r(new S("internal-error"));delete s[t.a]},Pt(Ua(Pe(Oh,{onload:t.a,hl:e||""}))).o(function(){clearTimeout(i),r(new S("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(i),n(s.grecaptcha))})},Eh.prototype.c=function(){this.b--};var Ph=null;function Ih(e,t,n,r,i,o,a){if(Qr(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=t,this.g=null,a?(Ch||(Ch=new kh),a=Ch):(Ph||(Ph=new Eh),a=Ph),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Nh])throw new S("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[xh],!s.document)throw new S("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ut(t)||!this.i&&ut(t).hasChildNodes())throw new S("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new $a(e,o||null,i||null),this.u=r||function(){return null};var u=this;this.l=[];var c=this.a[Th];this.a[Th]=function(e){if(Rh(u,e),"function"==typeof c)c(e);else if("string"==typeof c){var t=Tr(c,s);"function"==typeof t&&t(e)}};var l=this.a[Ah];this.a[Ah]=function(){if(Rh(u,null),"function"==typeof l)l();else if("string"==typeof l){var e=Tr(l,s);"function"==typeof e&&e()}}}var Th="callback",Ah="expired-callback",Nh="sitekey",xh="size";function Rh(e,t){for(var n=0;n<e.l.length;n++)try{e.l[n](t)}catch(r){}}function Mh(e,t){return e.h.push(t),t.oa(function(){Q(e.h,t)}),t}function Dh(e){if(e.J)throw new S("internal-error","RecaptchaVerifier instance has been destroyed.")}function Lh(e,t,n){var i=!1;try{this.b=n||r.a.app()}catch(s){throw new S("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new S("invalid-api-key");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ga()}catch(s){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}a=r.a.SDK_VERSION?Pr(r.a.SDK_VERSION,a):null,Ih.call(this,n,e,t,function(){try{var e=o.b.auth().la()}catch(t){e=null}return e},a,x(I),i)}function Bh(e,t,n,r){e:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<t.length;a++)if(t[a].optional)o=!0;else{if(o)throw new S("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=t.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=t[i].optional&&void 0===n[i],!t[i].M(n[i])&&!o){if(t=t[i],0>i||i>=Fh.length)throw new S("internal-error","Argument validator received an unsupported number of arguments.");n=Fh[i],r=(r?"":n+" argument ")+(t.name?'"'+t.name+'" ':"")+"must be "+t.K+".";break e}r=null}}if(r)throw new S("argument-error",e+" failed: "+r)}(e=Ih.prototype).Ia=function(){var e=this;return this.f?this.f:this.f=Mh(this,Pt().then(function(){if(xr()&&!wr())return mr();throw new S("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return e.m.g(e.u())}).then(function(t){return e.g=t,Xs(e.s,Ls,{})}).then(function(t){e.a[Nh]=t.recaptchaSiteKey}).o(function(t){throw e.f=null,t}))},e.render=function(){Dh(this);var e=this;return Mh(this,this.Ia().then(function(){if(null===e.c){var t=e.v;if(!e.i){var n=ut(t);t=function(e,t,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!st&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Ge(a.name),'"'),a.type){o.push(' type="',Ge(a.type),'"');var s={};ye(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=pt(i,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):ct(o,a)),2<r.length&&dt(i,o,r),o}("DIV"),n.appendChild(t)}e.c=e.g.render(t,e.a)}return e.c}))},e.verify=function(){Dh(this);var e=this;return Mh(this,this.render().then(function(t){return new _t(function(n){var r=e.g.getResponse(t);if(r)n(r);else{e.l.push(function t(r){r&&(function(e,t){Y(e.l,function(e){return e==t})}(e,t),n(r))}),e.i&&e.g.execute(e.c)}})}))},e.reset=function(){Dh(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Dh(this),this.J=!0,this.m.c();for(var e=0;e<this.h.length;e++)this.h[e].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){e=ut(this.v);for(var t;t=e.firstChild;)e.removeChild(t)}},E(Lh,Ih);var Fh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function jh(e,t){return{name:e||"",K:"a valid string",optional:!!t,M:function(e){return"string"==typeof e}}}function Uh(e,t){return{name:e||"",K:"a boolean",optional:!!t,M:function(e){return"boolean"==typeof e}}}function Vh(e,t){return{name:e||"",K:"a valid object",optional:!!t,M:v}}function zh(e,t){return{name:e||"",K:"a function",optional:!!t,M:function(e){return"function"==typeof e}}}function Hh(e,t){return{name:e||"",K:"null",optional:!!t,M:function(e){return null===e}}}function Gh(e){return{name:e?e+"Credential":"credential",K:e?"a valid "+e+" credential":"a valid credential",optional:!1,M:function(t){return!!t&&!(!t.ka||e&&t.providerId!==e)}}}function qh(e,t){return v(e)&&"string"==typeof e.type&&e.type===t&&"function"==typeof e.Ha}function Wh(e){return v(e)&&"string"==typeof e.uid}function $h(e,t,n,r){return{name:n||"",K:e.K+" or "+t.K,optional:!!r,M:function(n){return e.M(n)||t.M(n)}}}function Zh(e,t){for(var n in t){var r=t[n].name;e[r]=Kh(r,e[n],t[n].j)}}function Qh(e,t){for(var n in t){var r=t[n].name;r!==n&&Object.defineProperty(e,r,{get:k(function(e){return this[e]},n),set:k(function(e,t,n,r){Bh(e,[n],[r],!0),this[t]=r},r,n,t[n].lb),enumerable:!0})}}function Yh(e,t,n,r){e[t]=Kh(t,n,r)}function Kh(e,t,n){function r(){var e=Array.prototype.slice.call(arguments);return Bh(o,n,e),t.apply(this,e)}if(!n)return t;var i,o=function(e){return(e=e.split("."))[e.length-1]}(e);for(i in t)r[i]=t[i];for(i in t.prototype)r.prototype[i]=t.prototype[i];return r}Zh(th.prototype,{kb:{name:"applyActionCode",j:[jh("code")]},Sa:{name:"checkActionCode",j:[jh("code")]},ob:{name:"confirmPasswordReset",j:[jh("code"),jh("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[jh("email"),jh("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[jh("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[jh("emailLink")]},Hc:{name:"onAuthStateChanged",j:[$h(Vh(),zh(),"nextOrObserver"),zh("opt_error",!0),zh("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[$h(Vh(),zh(),"nextOrObserver"),zh("opt_error",!0),zh("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[jh("email"),$h(Vh("opt_actionCodeSettings",!0),Hh(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[jh("email"),Vh("actionCodeSettings")]},yb:{name:"setPersistence",j:[jh("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[Gh()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[Gh()]},Tc:{name:"signInWithCustomToken",j:[jh("token")]},Uc:{name:"signInWithEmailAndPassword",j:[jh("email"),jh("password")]},Vc:{name:"signInWithEmailLink",j:[jh("email"),jh("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[jh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[$h({name:"user",K:"an instance of Firebase User",optional:!1,M:function(e){return!!(e&&e instanceof pl)}},Hh(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[jh(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[jh("url"),Vh("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[jh("code")]}}),Qh(th.prototype,{lc:{name:"languageCode",lb:$h(jh(),Hh(),"languageCode")},ti:{name:"tenantId",lb:$h(jh(),Hh(),"tenantId")}}),(th.Persistence=Qu).LOCAL="local",th.Persistence.SESSION="session",th.Persistence.NONE="none",Zh(pl.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Uh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Uh("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[Gh()]},rb:{name:"linkWithCredential",j:[Gh()]},Dc:{name:"linkWithPhoneNumber",j:[jh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Gh()]},ub:{name:"reauthenticateWithCredential",j:[Gh()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[jh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[$h(Vh("opt_actionCodeSettings",!0),Hh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[jh(null,!0)]},cd:{name:"unlink",j:[jh("provider")]},Cb:{name:"updateEmail",j:[jh("email")]},Db:{name:"updatePassword",j:[jh("password")]},ed:{name:"updatePhoneNumber",j:[Gh("phone")]},Eb:{name:"updateProfile",j:[Vh("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[jh("email"),$h(Vh("opt_actionCodeSettings",!0),Hh(null,!0),"opt_actionCodeSettings",!0)]}}),Zh(vh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Zh(ph.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Zh(_t.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Qh(Wc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:Uh("appVerificationDisabledForTesting")}}),Zh($c.prototype,{confirm:{name:"confirm",j:[jh("verificationCode")]}}),Yh(so,"fromJSON",function(e){e="string"==typeof e?JSON.parse(e):e;for(var t,n=[vo,Io,Ro,ho],r=0;r<n.length;r++)if(t=n[r](e))return t;return null},[$h(jh(),Vh(),"json")]),Yh(To,"credential",function(e,t){return new Po(e,t)},[jh("email"),jh("password")]),Zh(Po.prototype,{w:{name:"toJSON",j:[jh(null,!0)]}}),Zh(bo.prototype,{Ca:{name:"addScope",j:[jh("scope")]},Ka:{name:"setCustomParameters",j:[Vh("customOAuthParameters")]}}),Yh(bo,"credential",_o,[$h(jh(),Vh(),"token")]),Yh(To,"credentialWithLink",Ao,[jh("email"),jh("emailLink")]),Zh(wo.prototype,{Ca:{name:"addScope",j:[jh("scope")]},Ka:{name:"setCustomParameters",j:[Vh("customOAuthParameters")]}}),Yh(wo,"credential",ko,[$h(jh(),Vh(),"token")]),Zh(Co.prototype,{Ca:{name:"addScope",j:[jh("scope")]},Ka:{name:"setCustomParameters",j:[Vh("customOAuthParameters")]}}),Yh(Co,"credential",Eo,[$h(jh(),$h(Vh(),Hh()),"idToken"),$h(jh(),Hh(),"accessToken",!0)]),Zh(Oo.prototype,{Ka:{name:"setCustomParameters",j:[Vh("customOAuthParameters")]}}),Yh(Oo,"credential",So,[$h(jh(),Vh(),"token"),jh("secret",!0)]),Zh(mo.prototype,{Ca:{name:"addScope",j:[jh("scope")]},credential:{name:"credential",j:[$h(jh(),$h(Vh(),Hh()),"optionsOrIdToken"),$h(jh(),Hh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Vh("customOAuthParameters")]}}),Zh(fo.prototype,{w:{name:"toJSON",j:[jh(null,!0)]}}),Zh(co.prototype,{w:{name:"toJSON",j:[jh(null,!0)]}}),Yh(Do,"credential",Lo,[jh("verificationId"),jh("verificationCode")]),Zh(Do.prototype,{gb:{name:"verifyPhoneNumber",j:[$h(jh(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(e){return!!e&&(e.session&&e.phoneNumber?qh(e.session,oo)&&"string"==typeof e.phoneNumber:e.session&&e.multiFactorHint?qh(e.session,ao)&&Wh(e.multiFactorHint):e.session&&e.multiFactorUid?qh(e.session,ao)&&"string"==typeof e.multiFactorUid:!!e.phoneNumber&&"string"==typeof e.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!=typeof e.type||"function"!=typeof e.verify)}}]}}),Zh(xo.prototype,{w:{name:"toJSON",j:[jh(null,!0)]}}),Zh(S.prototype,{toJSON:{name:"toJSON",j:[jh(null,!0)]}}),Zh(qo.prototype,{toJSON:{name:"toJSON",j:[jh(null,!0)]}}),Zh(Go.prototype,{toJSON:{name:"toJSON",j:[jh(null,!0)]}}),Zh(Xc.prototype,{toJSON:{name:"toJSON",j:[jh(null,!0)]}}),Zh(Yc.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(e){return!!e&&!!e.tb}}]}}),Zh(ol.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(e){return!!e&&!!e.tb}},jh("displayName",!0)]},bd:{name:"unenroll",j:[$h({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:Wh},jh(),"multiFactorInfoIdentifier")]}}),Zh(Lh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Yh(_i,"parseLink",Ii,[jh("link")]),Yh(wh,"assertion",function(e){return new rl(e)},[Gh("phone")]),function(){if(void 0===r.a||!r.a.INTERNAL||!r.a.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ui,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:si,VERIFY_AND_CHANGE_EMAIL:ci,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:th,AuthCredential:so,Error:S};Yh(e,"EmailAuthProvider",To,[]),Yh(e,"FacebookAuthProvider",bo,[]),Yh(e,"GithubAuthProvider",wo,[]),Yh(e,"GoogleAuthProvider",Co,[]),Yh(e,"TwitterAuthProvider",Oo,[]),Yh(e,"OAuthProvider",mo,[jh("providerId")]),Yh(e,"SAMLAuthProvider",yo,[jh("providerId")]),Yh(e,"PhoneAuthProvider",Do,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(e){return!!(e&&e instanceof th)}}]),Yh(e,"RecaptchaVerifier",Lh,[$h(jh(),{name:"",K:"an HTML element",optional:!1,M:function(e){return!!(e&&e instanceof Element)}},"recaptchaContainer"),Vh("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(e){return!!(e&&e instanceof r.a.app.App)}}]),Yh(e,"ActionCodeURL",_i,[]),Yh(e,"PhoneMultiFactorGenerator",wh,[]),r.a.INTERNAL.registerComponent({name:"auth",instanceFactory:function(e){return new th(e=e.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:e,instantiationMode:"LAZY",type:"PUBLIC",onInstanceCreated:function(e){e.getProvider("auth-internal").initialize()}}),r.a.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(e){return{getUid:w((e=e.getProvider("auth").getImmediate()).getUid,e),getToken:w(e.nc,e),addAuthTokenListener:w(e.cc,e),removeAuthTokenListener:w(e.Pc,e)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.a.registerVersion("@firebase/auth","0.16.8"),r.a.INTERNAL.extendNamespace({User:pl})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},"7o/Q":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n("n6bG"),i=n("gRHU"),o=n("quSY"),a=n("2QA8"),s=n("2fFW"),u=n("NJ4a"),c=function(e,t){Jp(r,e);var n=ev(r);function r(e,t,o){var a;switch(Qp(this,r),(a=n.call(this)).syncErrorValue=null,a.syncErrorThrown=!1,a.syncErrorThrowable=!1,a.isStopped=!1,arguments.length){case 0:a.destination=i.a;break;case 1:if(!e){a.destination=i.a;break}if("object"==typeof e){e instanceof r?(a.syncErrorThrowable=e.syncErrorThrowable,a.destination=e,e.add(nv(a))):(a.syncErrorThrowable=!0,a.destination=new l(nv(a),e));break}default:a.syncErrorThrowable=!0,a.destination=new l(nv(a),e,t,o)}return a}return Kp(r,[{key:t,value:function(){return this}},{key:"next",value:function(e){this.isStopped||this._next(e)}},{key:"error",value:function(e){this.isStopped||(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,$p(iv(r.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}],[{key:"create",value:function(e,t,n){var i=new r(e,t,n);return i.syncErrorThrowable=!1,i}}]),r}(o.a,a.a),l=function(e){Jp(n,e);var t=ev(n);function n(e,o,a,s){var u,c;Qp(this,n),(u=t.call(this))._parentSubscriber=e;var l=nv(u);return Object(r.a)(o)?c=o:o&&(c=o.next,a=o.error,s=o.complete,o!==i.a&&(l=Object.create(o),Object(r.a)(l.unsubscribe)&&u.add(l.unsubscribe.bind(l)),l.unsubscribe=u.unsubscribe.bind(nv(u)))),u._context=l,u._next=c,u._error=a,u._complete=s,u}return Kp(n,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;s.a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber,n=s.a.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):Object(u.a)(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;Object(u.a)(e)}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};s.a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),s.a.useDeprecatedSynchronousErrorHandling)throw n;Object(u.a)(n)}}},{key:"__tryOrSetError",value:function(e,t,n){if(!s.a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(r){return s.a.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(Object(u.a)(r),!0)}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),n}(c)},"9ppp":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}()},Cfvw:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n("HDdC"),i=n("SeVD"),o=n("quSY"),a=n("kJWO"),s=n("jZKg"),u=n("Lhse"),c=n("c2HN"),l=n("I55L");function h(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[a.a]}(e))return function(e,t){return new r.a(function(n){var r=new o.a;return r.add(t.schedule(function(){var i=e[a.a]();r.add(i.subscribe({next:function(e){r.add(t.schedule(function(){return n.next(e)}))},error:function(e){r.add(t.schedule(function(){return n.error(e)}))},complete:function(){r.add(t.schedule(function(){return n.complete()}))}}))})),r})}(e,t);if(Object(c.a)(e))return function(e,t){return new r.a(function(n){var r=new o.a;return r.add(t.schedule(function(){return e.then(function(e){r.add(t.schedule(function(){n.next(e),r.add(t.schedule(function(){return n.complete()}))}))},function(e){r.add(t.schedule(function(){return n.error(e)}))})})),r})}(e,t);if(Object(l.a)(e))return Object(s.a)(e,t);if(function(e){return e&&"function"==typeof e[u.a]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new r.a(function(n){var r,i=new o.a;return i.add(function(){r&&"function"==typeof r.return&&r.return()}),i.add(t.schedule(function(){r=e[u.a](),i.add(t.schedule(function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(o){return void n.error(o)}t?n.complete():(n.next(e),this.schedule())}}))})),i})}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof r.a?e:new r.a(Object(i.a)(e))}},D0XW:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("3N8a"),i=new(n("IjjT").a)(r.a)},DH7j:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=Array.isArray||function(e){return e&&"number"==typeof e.length}},EQ5u:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return c});var r,i=n("XNiG"),o=n("HDdC"),a=(n("7o/Q"),n("quSY")),s=n("x+ZX"),u=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._refCount=0,i._isComplete=!1,i}return Kp(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new a.a).add(this.source.subscribe(new l(this.getSubject(),this))),e.closed&&(this._connection=null,e=a.a.EMPTY)),e}},{key:"refCount",value:function(){return Object(s.a)()(this)}}]),n}(o.a),c={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:(r=u.prototype)._subscribe},_isComplete:{value:r._isComplete,writable:!0},getSubject:{value:r.getSubject},connect:{value:r.connect},refCount:{value:r.refCount}},l=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).connectable=r,i}return Kp(n,[{key:"_error",value:function(e){this._unsubscribe(),$p(iv(n.prototype),"_error",this).call(this,e)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),$p(iv(n.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}]),n}(i.b)},EY2u:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n("HDdC"),i=new r.a(function(e){return e.complete()});function o(e){return e?function(e){return new r.a(function(t){return e.schedule(function(){return t.complete()})})}(e):i}},HDdC:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r,i=n("7o/Q"),o=n("2QA8"),a=n("gRHU"),s=n("kJWO"),u=n("SpAZ"),c=n("2fFW"),l=((r=function(e){function t(e){Qp(this,t),this._isScalar=!1,e&&(this._subscribe=e)}return Kp(t,[{key:"lift",value:function(e){var n=new t;return n.source=this,n.operator=e,n}},{key:"subscribe",value:function(e,t,n){var r=this.operator,s=function(e,t,n){if(e){if(e instanceof i.a)return e;if(e[o.a])return e[o.a]()}return e||t||n?new i.a(e,t,n):new i.a(a.a)}(e,t,n);if(s.add(r?r.call(s,this.source):this.source||c.a.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),c.a.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){c.a.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,r=t.destination,o=t.isStopped;if(n||o)return!1;e=r&&r instanceof i.a?r:null}return!0}(e)?e.error(t):console.warn(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=h(t))(function(t,r){var i;i=n.subscribe(function(t){try{e(t)}catch(n){r(n),i&&i.unsubscribe()}},r,t)})}},{key:"_subscribe",value:function(e){var t=this.source;return t&&t.subscribe(e)}},{key:e,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?this:(0===(r=t).length?u.a:1===r.length?r[0]:function(e){return r.reduce(function(e,t){return t(e)},e)})(this);var r}},{key:"toPromise",value:function(e){var t=this;return new(e=h(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),t}(s.a)).create=function(e){return new r(e)},r);function h(e){if(e||(e=c.a.Promise||Promise),!e)throw new Error("no Promise impl found");return e}},Hfs6:function(e,t,n){var r,i,o;!function(a){if("object"==typeof e.exports){var s=a(0,t);void 0!==s&&(e.exports=s)}else i=[n,t],void 0===(o="function"==typeof(r=a)?r.apply(t,i):r)||(e.exports=o)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},I55L:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},IjjT:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;Qp(this,e),this.SchedulerAction=t,this.now=n}return Kp(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,e).schedule(n,t)}}]),e}();return e.now=function(){return Date.now()},e}(),i=function(e){Jp(n,e);var t=ev(n);function n(e){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.now;return Qp(this,n),(i=t.call(this,e,function(){return n.delegate&&n.delegate!==nv(i)?n.delegate.now():o()})).actions=[],i.active=!1,i.scheduled=void 0,i}return Kp(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return n.delegate&&n.delegate!==this?n.delegate.schedule(e,t,r):$p(iv(n.prototype),"schedule",this).call(this,e,t,r)}},{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(r)},Jgta:function(e,t,n){"use strict";var r=n("zIRd");n.d(t,"a",function(){return r.a}),r.a.registerVersion("firebase","8.10.0","app"),r.a.SDK_VERSION="8.10.0"},LRne:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("z+Ro"),i=n("yCtX"),o=n("jZKg");function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=t[t.length-1];return Object(r.a)(a)?(t.pop(),Object(o.a)(t,a)):Object(i.a)(t)}},Lhse:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"},NJ4a:function(e,t,n){"use strict";function r(e){setTimeout(function(){throw e},0)}n.d(t,"a",function(){return r})},S0Ta:function(e,t,n){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++)n=null==arguments[r]?{}:arguments[r],r%2?t(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))});return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e;return null!==(e=h)&&void 0!==e?e:document}var u={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},u),l={},h=null,f=function(){function e(t){var n=this;r(this,e),this.element=s().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),o=["notification",this.extraClasses];if(this.type&&o.push(this.type),this.animate&&this.animate.in){var a="animate__".concat(this.animate.in),u=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";o.push("animate__animated ".concat(a," ").concat(u)),this.onAnimationEnd(function(){return n.element.classList.remove(a)})}if(this.element.className=o.join(" "),this.dismissible){var c=s().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var l=new d(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){l.pause()}),this.element.addEventListener("mouseout",function(){l.resume()}))}return o(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete l.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete l.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),d=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return o(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},u)},e.setDefaults=function(e){c=n(n({},u),e)},e.setDoc=function(e){for(var t in l)l[t].remove();l={},h=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new f(t),i=function(e,t,n,r,i,o){if(l.position)return l.position;var a=s().createElement("div");return a.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,o)),e.appendChild(a),l.position=a,a}(t.appendTo||s().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var o=i.lastElementChild;o;)i.removeChild(o),o=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},SeVD:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n("ngJS"),i=n("NJ4a"),o=n("Lhse"),a=n("kJWO"),s=n("I55L"),u=n("c2HN"),c=n("XoHu"),l=function(e){if(e&&"function"==typeof e[a.a])return l=e,function(e){var t=l[a.a]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(Object(s.a)(e))return Object(r.a)(e);if(Object(u.a)(e))return n=e,function(e){return n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,i.a),e};if(e&&"function"==typeof e[o.a])return t=e,function(e){for(var n=t[o.a]();;){var r=void 0;try{r=n.next()}catch(i){return e.error(i),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add(function(){n.return&&n.return()}),e};var t,n,l,h=Object(c.a)(e)?"an invalid object":"'".concat(e,"'");throw new TypeError("You provided ".concat(h," where a stream was expected. You can provide an Observable, Promise, Array, or Iterable."))}},SpAZ:function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",function(){return r})},VRyK:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("HDdC"),i=n("z+Ro"),o=n("bHdf"),a=n("yCtX");function s(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=Number.POSITIVE_INFINITY,u=null,c=t[t.length-1];return Object(i.a)(c)?(u=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(s=t.pop())):"number"==typeof c&&(s=t.pop()),null===u&&1===t.length&&t[0]instanceof r.a?t[0]:Object(o.a)(s)(Object(a.a)(t,u))}},XNiG:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return l});var r=n("HDdC"),i=n("7o/Q"),o=n("quSY"),a=n("9ppp"),s=n("Ylt2"),u=n("2QA8"),c=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).destination=e,r}return n}(i.a),l=function(){var e=function(e,t){Jp(i,e);var n=ev(i);function i(){var e;return Qp(this,i),(e=n.call(this)).observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return Kp(i,[{key:t,value:function(){return new c(this)}},{key:"lift",value:function(e){var t=new h(this,this);return t.operator=e,t}},{key:"next",value:function(e){if(this.closed)throw new a.a;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)}},{key:"error",value:function(e){if(this.closed)throw new a.a;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new a.a;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new a.a;return $p(iv(i.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){if(this.closed)throw new a.a;return this.hasError?(e.error(this.thrownError),o.a.EMPTY):this.isStopped?(e.complete(),o.a.EMPTY):(this.observers.push(e),new s.a(this,e))}},{key:"asObservable",value:function(){var e=new r.a;return e.source=this,e}}]),i}(r.a,u.a);return e.create=function(e,t){return new h(e,t)},e}(),h=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this)).destination=e,i.source=r,i}return Kp(n,[{key:"next",value:function(e){var t=this.destination;t&&t.next&&t.next(e)}},{key:"error",value:function(e){var t=this.destination;t&&t.error&&this.destination.error(e)}},{key:"complete",value:function(){var e=this.destination;e&&e.complete&&this.destination.complete()}},{key:"_subscribe",value:function(e){return this.source?this.source.subscribe(e):o.a.EMPTY}}]),n}(l)},XoHu:function(e,t,n){"use strict";function r(e){return null!==e&&"object"==typeof e}n.d(t,"a",function(){return r})},Ylt2:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this)).subject=e,i.subscriber=r,i.closed=!1,i}return Kp(n,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}}}]),n}(n("quSY").a)},bHdf:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("5+tZ"),i=n("SpAZ");function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;return Object(r.a)(i.a,e)}},c2HN:function(e,t,n){"use strict";function r(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}n.d(t,"a",function(){return r})},fXoL:function(e,t,n){"use strict";n.d(t,"a",function(){return on}),n.d(t,"b",function(){return Hc}),n.d(t,"c",function(){return Fc}),n.d(t,"d",function(){return Lc}),n.d(t,"e",function(){return Bc}),n.d(t,"f",function(){return Dl}),n.d(t,"g",function(){return Ol}),n.d(t,"h",function(){return Tu}),n.d(t,"i",function(){return el}),n.d(t,"j",function(){return Xs}),n.d(t,"k",function(){return Wc}),n.d(t,"l",function(){return ru}),n.d(t,"m",function(){return kr}),n.d(t,"n",function(){return vc}),n.d(t,"o",function(){return Co}),n.d(t,"p",function(){return On}),n.d(t,"q",function(){return N}),n.d(t,"r",function(){return rn}),n.d(t,"s",function(){return Fo}),n.d(t,"t",function(){return ku}),n.d(t,"u",function(){return Eu}),n.d(t,"v",function(){return qc}),n.d(t,"w",function(){return ju}),n.d(t,"x",function(){return Pl}),n.d(t,"y",function(){return Fu}),n.d(t,"z",function(){return _l}),n.d(t,"A",function(){return rl}),n.d(t,"B",function(){return Sn}),n.d(t,"C",function(){return zc}),n.d(t,"D",function(){return Vc}),n.d(t,"E",function(){return au}),n.d(t,"F",function(){return ou}),n.d(t,"G",function(){return Tr}),n.d(t,"H",function(){return uu}),n.d(t,"I",function(){return vr}),n.d(t,"J",function(){return Pn}),n.d(t,"K",function(){return Al}),n.d(t,"L",function(){return Du}),n.d(t,"M",function(){return ll}),n.d(t,"N",function(){return an}),n.d(t,"O",function(){return lu}),n.d(t,"P",function(){return cu}),n.d(t,"Q",function(){return Vu}),n.d(t,"R",function(){return L}),n.d(t,"S",function(){return wl}),n.d(t,"T",function(){return ml}),n.d(t,"U",function(){return d}),n.d(t,"V",function(){return yl}),n.d(t,"W",function(){return Rl}),n.d(t,"X",function(){return fl}),n.d(t,"Y",function(){return Gc}),n.d(t,"Z",function(){return Oo}),n.d(t,"ab",function(){return Qa}),n.d(t,"bb",function(){return g}),n.d(t,"cb",function(){return dr}),n.d(t,"db",function(){return Qn}),n.d(t,"eb",function(){return Bn}),n.d(t,"fb",function(){return jn}),n.d(t,"gb",function(){return Hn}),n.d(t,"hb",function(){return Vn}),n.d(t,"ib",function(){return Un}),n.d(t,"jb",function(){return zn}),n.d(t,"kb",function(){return qa}),n.d(t,"lb",function(){return xl}),n.d(t,"mb",function(){return Wa}),n.d(t,"nb",function(){return $a}),n.d(t,"ob",function(){return Fn}),n.d(t,"pb",function(){return V}),n.d(t,"qb",function(){return Zo}),n.d(t,"rb",function(){return ya}),n.d(t,"sb",function(){return va}),n.d(t,"tb",function(){return ga}),n.d(t,"ub",function(){return Ga}),n.d(t,"vb",function(){return Ee}),n.d(t,"wb",function(){return l}),n.d(t,"xb",function(){return Ln}),n.d(t,"yb",function(){return Uo}),n.d(t,"zb",function(){return be}),n.d(t,"Ab",function(){return Ys}),n.d(t,"Bb",function(){return Ci}),n.d(t,"Cb",function(){return ea}),n.d(t,"Db",function(){return Aa}),n.d(t,"Eb",function(){return Tc}),n.d(t,"Fb",function(){return X}),n.d(t,"Gb",function(){return ae}),n.d(t,"Hb",function(){return w}),n.d(t,"Ib",function(){return k}),n.d(t,"Jb",function(){return re}),n.d(t,"Kb",function(){return se}),n.d(t,"Lb",function(){return aa}),n.d(t,"Mb",function(){return ha}),n.d(t,"Nb",function(){return da}),n.d(t,"Ob",function(){return fa}),n.d(t,"Pb",function(){return la}),n.d(t,"Qb",function(){return ca}),n.d(t,"Rb",function(){return pa}),n.d(t,"Sb",function(){return Xt}),n.d(t,"Tb",function(){return Ua}),n.d(t,"Ub",function(){return Us}),n.d(t,"Vb",function(){return zs}),n.d(t,"Wb",function(){return js}),n.d(t,"Xb",function(){return Vs}),n.d(t,"Yb",function(){return Fs}),n.d(t,"Zb",function(){return _n}),n.d(t,"ac",function(){return tn}),n.d(t,"bc",function(){return Dc}),n.d(t,"cc",function(){return ma}),n.d(t,"dc",function(){return Ac}),n.d(t,"ec",function(){return mt}),n.d(t,"fc",function(){return wa}),n.d(t,"gc",function(){return uc}),n.d(t,"hc",function(){return cc}),n.d(t,"ic",function(){return lc}),n.d(t,"jc",function(){return hc}),n.d(t,"kc",function(){return Ea}),n.d(t,"lc",function(){return Ca}),n.d(t,"mc",function(){return sa}),n.d(t,"nc",function(){return Oa}),n.d(t,"oc",function(){return Sa}),n.d(t,"pc",function(){return Pa}),n.d(t,"qc",function(){return tc}),n.d(t,"rc",function(){return nc}),n.d(t,"sc",function(){return rc}),n.d(t,"tc",function(){return ic}),n.d(t,"uc",function(){return Pc}),n.d(t,"vc",function(){return oa}),n.d(t,"wc",function(){return Ge}),n.d(t,"xc",function(){return gr}),n.d(t,"yc",function(){return yr}),n.d(t,"zc",function(){return ie}),n.d(t,"Ac",function(){return ia}),n.d(t,"Bc",function(){return Mc}),n.d(t,"Cc",function(){return Da}),n.d(t,"Dc",function(){return La}),n.d(t,"Ec",function(){return Ba}),n.d(t,"Fc",function(){return Fa}),n.d(t,"Gc",function(){return ja}),n.d(t,"Hc",function(){return Ic});var r=n("XNiG"),i=n("quSY"),o=n("HDdC"),a=n("VRyK"),s=n("w1tV");function u(e){for(var t in e)if(e[t]===u)return t;throw Error("Could not find renamed property on target object.")}function c(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function l(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(l).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function h(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var f=u({__forward_ref__:u});function d(e){return e.__forward_ref__=d,e.toString=function(){return l(this())},e}function p(e){return v(e)?e():e}function v(e){return"function"==typeof e&&e.hasOwnProperty(f)&&e.__forward_ref__===d}var g=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,r))).code=e,i}return n}(qp(Error));function y(e){return"string"==typeof e?e:null==e?"":String(e)}function m(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():y(e)}function b(e,t){var n=t?" in ".concat(t):"";throw new g("201","No provider for ".concat(m(e)," found").concat(n))}function _(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat(e)+(null==r?"":" [Expected=> ".concat(n," ").concat(r," ").concat(t," <=Actual]")))}function w(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function k(e){return{providers:e.providers||[],imports:e.imports||[]}}function C(e){return E(e,P)||E(e,T)}function E(e,t){return e.hasOwnProperty(t)?e[t]:null}function O(e){return e&&(e.hasOwnProperty(I)||e.hasOwnProperty(A))?e[I]:null}var S,P=u({"\u0275prov":u}),I=u({"\u0275inj":u}),T=u({ngInjectableDef:u}),A=u({ngInjectorDef:u}),N=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function x(e){var t=S;return S=e,t}function R(e,t,n){var r=C(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&N.Optional?null:void 0!==t?t:void b(l(e),"Injector")}function M(e){return{toString:e}.toString()}var D=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}({}),L=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}({}),B="undefined"!=typeof globalThis&&globalThis,F="undefined"!=typeof window&&window,j="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,U="undefined"!=typeof global&&global,V=B||U||F||j,z={},H=[],G=[],q=u({"\u0275cmp":u}),W=u({"\u0275dir":u}),$=u({"\u0275pipe":u}),Z=u({"\u0275mod":u}),Q=u({"\u0275loc":u}),Y=u({"\u0275fac":u}),K=u({__NG_ELEMENT_ID__:u}),J=0;function X(e){return M(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===D.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||G,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||L.Emulated,id:"c",styles:e.styles||G,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,o=e.pipes;return n.id+=J++,n.inputs=oe(e.inputs,t),n.outputs=oe(e.outputs),i&&i.forEach(function(e){return e(n)}),n.directiveDefs=r?function(){return("function"==typeof r?r():r).map(ee)}:null,n.pipeDefs=o?function(){return("function"==typeof o?o():o).map(te)}:null,n})}function ee(e){return ue(e)||function(e){return e[W]||null}(e)}function te(e){return function(e){return e[$]||null}(e)}var ne={};function re(e){var t={type:e.type,bootstrap:e.bootstrap||G,declarations:e.declarations||G,imports:e.imports||G,exports:e.exports||G,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&M(function(){ne[e.id]=e.type}),t}function ie(e,t){return M(function(){var n=ce(e,!0);n.declarations=t.declarations||G,n.imports=t.imports||G,n.exports=t.exports||G})}function oe(e,t){if(null==e)return z;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,t&&(t[i]=o)}return n}var ae=X;function se(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function ue(e){return e[q]||null}function ce(e,t){var n=e[Z]||null;if(!n&&!0===t)throw new Error("Type ".concat(l(e)," does not have '\u0275mod' property."));return n}function le(e){return Array.isArray(e)&&"object"==typeof e[1]}function he(e){return Array.isArray(e)&&!0===e[1]}function fe(e){return 0!=(8&e.flags)}function de(e){return 2==(2&e.flags)}function pe(e){return 1==(1&e.flags)}function ve(e){return null!==e.template}function ge(e,t){return e.hasOwnProperty(Y)?e[Y]:null}var ye,me=function(){function e(t,n,r){Qp(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return Kp(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function be(){return _e}function _e(e){return e.type.prototype.ngOnChanges&&(e.setInput=ke),we}function we(){var e=Ce(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===z)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function ke(e,t,n,r){var i=Ce(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:z,current:null}),o=i.current||(i.current={}),a=i.previous,s=this.declaredInputs[n],u=a[s];o[s]=new me(u&&u.currentValue,t,a===z),e[r]=t}function Ce(e){return e.__ngSimpleChanges__||null}function Ee(e){ye=e}function Oe(){return void 0!==ye?ye:"undefined"!=typeof document?document:void 0}function Se(e){return!!e.listen}be.ngInherit=!0;var Pe={createRenderer:function(e,t){return Oe()}};function Ie(e){for(;Array.isArray(e);)e=e[0];return e}function Te(e,t){return Ie(t[e])}function Ae(e,t){return Ie(t[e.index])}function Ne(e,t){return e.data[t]}function xe(e,t){return e[t]}function Re(e,t){var n=t[e];return le(n)?n:n[0]}function Me(e){var t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function De(e){return 4==(4&e[2])}function Le(e){return 128==(128&e[2])}function Be(e,t){return null==t?null:e[t]}function Fe(e){e[18]=0}function je(e,t){e[5]+=t;for(var n=e,r=e[3];null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}var Ue={lFrame:ht(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Ve(){return Ue.bindingsEnabled}function ze(){return Ue.lFrame.lView}function He(){return Ue.lFrame.tView}function Ge(e){Ue.lFrame.contextLView=e}function qe(){for(var e=We();null!==e&&64===e.type;)e=e.parent;return e}function We(){return Ue.lFrame.currentTNode}function $e(){var e=Ue.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function Ze(e,t){var n=Ue.lFrame;n.currentTNode=e,n.isParent=t}function Qe(){return Ue.lFrame.isParent}function Ye(){Ue.lFrame.isParent=!1}function Ke(){return Ue.isInCheckNoChangesMode}function Je(e){Ue.isInCheckNoChangesMode=e}function Xe(){var e=Ue.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function et(){return Ue.lFrame.bindingIndex}function tt(){return Ue.lFrame.bindingIndex++}function nt(e){var t=Ue.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function rt(e){Ue.lFrame.inI18n=e}function it(e){Ue.lFrame.currentDirectiveIndex=e}function ot(){return Ue.lFrame.currentQueryIndex}function at(e){Ue.lFrame.currentQueryIndex=e}function st(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function ut(e,t,n){if(n&N.SkipSelf){for(var r=t,i=e;!(null!==(r=r.parent)||n&N.Host||(r=st(i),null===r)||(i=i[15],10&r.type)););if(null===r)return!1;t=r,e=i}var o=Ue.lFrame=lt();return o.currentTNode=t,o.lView=e,!0}function ct(e){var t=lt(),n=e[1];Ue.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function lt(){var e=Ue.lFrame,t=null===e?null:e.child;return null===t?ht(e):t}function ht(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function ft(){var e=Ue.lFrame;return Ue.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var dt=ft;function pt(){var e=ft();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function vt(){return Ue.lFrame.selectedIndex}function gt(e){Ue.lFrame.selectedIndex=e}function yt(){var e=Ue.lFrame;return Ne(e.tView,e.selectedIndex)}function mt(){Ue.lFrame.currentNamespace="http://www.w3.org/2000/svg"}function bt(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n].type.prototype,o=i.ngAfterContentInit,a=i.ngAfterContentChecked,s=i.ngAfterViewInit,u=i.ngAfterViewChecked,c=i.ngOnDestroy;o&&(e.contentHooks||(e.contentHooks=[])).push(-n,o),a&&((e.contentHooks||(e.contentHooks=[])).push(n,a),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,a)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function _t(e,t,n){Ct(e,t,3,n)}function wt(e,t,n,r){(3&e[2])===n&&Ct(e,t,n,r)}function kt(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function Ct(e,t,n,r){for(var i=null!=r?r:-1,o=t.length-1,a=0,s=void 0!==r?65535&e[18]:0;s<o;s++)if("number"==typeof t[s+1]){if(a=t[s],null!=r&&a>=r)break}else t[s]<0&&(e[18]+=65536),(a<i||-1==i)&&(Et(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function Et(e,t,n,r){var i=n[r]<0,o=n[r+1],a=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{o.call(a)}finally{}}}else try{o.call(a)}finally{}}var Ot=function e(t,n,r){Qp(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r};function St(e,t,n){for(var r=Se(e),i=0;i<n.length;){var o=n[i];if("number"==typeof o){if(0!==o)break;i++;var a=n[i++],s=n[i++],u=n[i++];r?e.setAttribute(t,s,u,a):t.setAttributeNS(a,s,u)}else{var c=o,l=n[++i];It(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),i++}}return i}function Pt(e){return 3===e||4===e||6===e}function It(e){return 64===e.charCodeAt(0)}function Tt(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||At(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function At(e,t,n,r,i){var o=0,a=e.length;if(-1===t)a=-1;else for(;o<e.length;){var s=e[o++];if("number"==typeof s){if(s===t){a=-1;break}if(s>t){a=o-1;break}}}for(;o<e.length;){var u=e[o];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(e[o+1]=i));if(r===e[o+1])return void(e[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==a&&(e.splice(a,0,t),o=a+1),e.splice(o++,0,n),null!==r&&e.splice(o++,0,r),null!==i&&e.splice(o++,0,i)}function Nt(e){return-1!==e}function xt(e){return 32767&e}function Rt(e,t){for(var n=e>>16,r=t;n>0;)r=r[15],n--;return r}var Mt=!0;function Dt(e){var t=Mt;return Mt=e,t}var Lt=0;function Bt(e,t){var n=jt(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,Ft(r.data,e),Ft(t,null),Ft(r.blueprint,null));var i=Ut(e,t),o=e.injectorIndex;if(Nt(i))for(var a=xt(i),s=Rt(i,t),u=s[1].data,c=0;c<8;c++)t[o+c]=s[a+c]|u[a+c];return t[o+8]=i,o}function Ft(e,t){e.push(0,0,0,0,0,0,0,0,t)}function jt(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Ut(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,r=null,i=t;null!==i;){var o=i[1],a=o.type;if(null===(r=2===a?o.declTNode:1===a?i[6]:null))return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function Vt(e,t,n){!function(e,t,n){var r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(K)&&(r=n[K]),null==r&&(r=n[K]=Lt++);var i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function zt(e,t,n){if(n&N.Optional)return e;b(t,"NodeInjector")}function Ht(e,t,n,r){if(n&N.Optional&&void 0===r&&(r=null),0==(n&(N.Self|N.Host))){var i=e[9],o=x(void 0);try{return i?i.get(t,r,n&N.Optional):R(t,r,n&N.Optional)}finally{x(o)}}return zt(r,t,n)}function Gt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:N.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==e){var o=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(K)?e[K]:void 0;return"number"==typeof t?t>=0?255&t:Wt:t}(n);if("function"==typeof o){if(!ut(t,e,r))return r&N.Host?zt(i,n,r):Ht(t,n,r,i);try{var a=o();if(null!=a||r&N.Optional)return a;b(n)}finally{dt()}}else if("number"==typeof o){var s=null,u=jt(e,t),c=-1,l=r&N.Host?t[16][6]:null;for((-1===u||r&N.SkipSelf)&&(-1!==(c=-1===u?Ut(e,t):t[u+8])&&Kt(r,!1)?(s=t[1],u=xt(c),t=Rt(c,t)):u=-1);-1!==u;){var h=t[1];if(Yt(o,u,h.data)){var f=$t(u,t,n,s,r,l);if(f!==qt)return f}-1!==(c=t[u+8])&&Kt(r,t[1].data[u+8]===l)&&Yt(o,u,t)?(s=h,u=xt(c),t=Rt(c,t)):u=-1}}}return Ht(t,n,r,i)}var qt={};function Wt(){return new Jt(qe(),ze())}function $t(e,t,n,r,i,o){var a=t[1],s=a.data[e+8],u=Zt(s,a,n,null==r?de(s)&&Mt:r!=a&&0!=(3&s.type),i&N.Host&&o===s);return null!==u?Qt(t,a,u,s):qt}function Zt(e,t,n,r,i){for(var o=e.providerIndexes,a=t.data,s=1048575&o,u=e.directiveStart,c=o>>20,l=i?s+c:e.directiveEnd,h=r?s:s+c;h<l;h++){var f=a[h];if(h<u&&n===f||h>=u&&f.type===n)return h}if(i){var d=a[u];if(d&&ve(d)&&d.type===n)return u}return null}function Qt(e,t,n,r){var i=e[n],o=t.data;if(i instanceof Ot){var a=i;a.resolving&&function(e,t){throw new g("200","Circular dependency in DI detected for ".concat(e))}(m(o[n]));var s=Dt(a.canSeeViewProviders);a.resolving=!0;var u=a.injectImpl?x(a.injectImpl):null;ut(e,r,N.Default);try{i=e[n]=a.factory(void 0,o,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.type.prototype,i=r.ngOnChanges,o=r.ngOnInit,a=r.ngDoCheck;if(i){var s=_e(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}o&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,o),a&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,a),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,a))}(n,o[n],t)}finally{null!==u&&x(u),Dt(s),a.resolving=!1,dt()}}return i}function Yt(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function Kt(e,t){return!(e&N.Self||e&N.Host&&t)}var Jt=function(){function e(t,n){Qp(this,e),this._tNode=t,this._lView=n}return Kp(e,[{key:"get",value:function(e,t){return Gt(this._tNode,this._lView,e,void 0,t)}}]),e}();function Xt(e){return M(function(){for(var t=e.prototype.constructor,n=t[Y]||en(t),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;i&&i!==r;){var o=i[Y]||en(i);if(o&&o!==n)return o;i=Object.getPrototypeOf(i)}return function(e){return new e}})}function en(e){return v(e)?function(){var t=en(p(e));return t&&t()}:ge(e)}function tn(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var r=n.length,i=0;i<r;){var o=n[i];if(Pt(o))break;if(0===o)i+=2;else if("number"==typeof o)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(o===t)return n[i+1];i+=2}}return null}(qe(),e)}function nn(e,t,n){return M(function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var o=Wp(i,t);return a.annotation=o,a;function a(e,t,n){for(var r=e.hasOwnProperty("__parameters__")?e.__parameters__:Object.defineProperty(e,"__parameters__",{value:[]}).__parameters__;r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(o),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var rn=function(){function e(t,n){Qp(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=w({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return Kp(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),on=new rn("AnalyzeForEntryComponents"),an=Function;function sn(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),sn(r,t)):t!==e&&t.push(r)}return t}function un(e,t){e.forEach(function(e){return Array.isArray(e)?un(e,t):t(e)})}function cn(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function ln(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function hn(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function fn(e,t){var n=dn(e,t);if(n>=0)return e[1|n]}function dn(e,t){return function(e,t,n){for(var r=0,i=e.length>>1;i!==r;){var o=r+(i-r>>1),a=e[o<<1];if(t===a)return o<<1;a>t?i=o:r=o+1}return~(i<<1)}(e,t)}var pn,vn={},gn=/\n/gm,yn=u({provide:String,useValue:u});function mn(e){var t=pn;return pn=e,t}function bn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N.Default;if(void 0===pn)throw new Error("inject() must be called from an injection context");return null===pn?R(e,void 0,t):pn.get(e,t&N.Optional?null:void 0,t)}function _n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N.Default;return(S||bn)(p(e),t)}function wn(e){for(var t=[],n=0;n<e.length;n++){var r=p(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,o=N.Default,a=0;a<r.length;a++){var s=r[a],u=s.__NG_DI_FLAG__;"number"==typeof u?-1===u?i=s.token:o|=u:i=s}t.push(_n(i,o))}else t.push(_n(r))}return t}function kn(e,t){return e.__NG_DI_FLAG__=t,e.prototype.__NG_DI_FLAG__=t,e}var Cn,En,On=kn(nn("Inject",function(e){return{token:e}}),-1),Sn=kn(nn("Optional"),8),Pn=kn(nn("SkipSelf"),4);function In(e){var t;return(null===(t=function(){if(void 0===Cn&&(Cn=null,V.trustedTypes))try{Cn=V.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(t){}return Cn}())||void 0===t?void 0:t.createHTML(e))||e}function Tn(e){var t;return(null===(t=function(){if(void 0===En&&(En=null,V.trustedTypes))try{En=V.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(t){}return En}())||void 0===t?void 0:t.createHTML(e))||e}var An=function(){function e(t){Qp(this,e),this.changingThisBreaksApplicationSecurity=t}return Kp(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),Nn=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(An),xn=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(An),Rn=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(An),Mn=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(An),Dn=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(An);function Ln(e){return e instanceof An?e.changingThisBreaksApplicationSecurity:e}function Bn(e,t){var n=Fn(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function Fn(e){return e instanceof An&&e.getTypeName()||null}function jn(e){return new Nn(e)}function Un(e){return new xn(e)}function Vn(e){return new Rn(e)}function zn(e){return new Mn(e)}function Hn(e){return new Dn(e)}function Gn(e){var t=new Wn(e);return function(){try{return!!(new window.DOMParser).parseFromString(In(""),"text/html")}catch(e){return!1}}()?new qn(t):t}var qn=function(){function e(t){Qp(this,e),this.inertDocumentHelper=t}return Kp(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(In(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),Wn=function(){function e(t){if(Qp(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var r=this.inertDocument.createElement("body");n.appendChild(r)}}return Kp(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=In(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=In(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;"xmlns:ns1"!==r&&0!==r.indexOf("ns1:")||e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),$n=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Zn=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Qn(e){return(e=String(e)).match($n)||e.match(Zn)?e:"unsafe:"+e}function Yn(e){return(e=String(e)).split(",").map(function(e){return Qn(e.trim())}).join(", ")}function Kn(e){var t,n={},r=zp(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function Jn(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];for(var s in a)a.hasOwnProperty(s)&&(e[s]=!0)}return e}var Xn,er=Kn("area,br,col,hr,img,wbr"),tr=Kn("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),nr=Kn("rp,rt"),rr=Jn(nr,tr),ir=Jn(er,Jn(tr,Kn("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Jn(nr,Kn("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),rr),or=Kn("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ar=Kn("srcset"),sr=Jn(or,ar,Kn("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Kn("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ur=Kn("script,style,template"),cr=function(){function e(){Qp(this,e),this.sanitizedSomething=!1,this.buf=[]}return Kp(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!ir.hasOwnProperty(t))return this.sanitizedSomething=!0,!ur.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n=e.attributes,r=0;r<n.length;r++){var i=n.item(r),o=i.name,a=o.toLowerCase();if(sr.hasOwnProperty(a)){var s=i.value;or[a]&&(s=Qn(s)),ar[a]&&(s=Yn(s)),this.buf.push(" ",o,'="',fr(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();ir.hasOwnProperty(t)&&!er.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(fr(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),lr=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,hr=/([^\#-~ |!])/g;function fr(e){return e.replace(/&/g,"&amp;").replace(lr,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(hr,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function dr(e,t){var n=null;try{Xn=Xn||Gn(e);var r=t?String(t):"";n=Xn.getInertBodyElement(r);var i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=n.innerHTML,n=Xn.getInertBodyElement(r)}while(r!==o);return In((new cr).sanitizeChildren(pr(n)||n))}finally{if(n)for(var a=pr(n)||n;a.firstChild;)a.removeChild(a.firstChild)}}function pr(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var vr=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}({});function gr(e){var t=mr();return t?Tn(t.sanitize(vr.HTML,e)||""):Bn(e,"HTML")?Tn(Ln(e)):dr(Oe(),y(e))}function yr(e){var t=mr();return t?t.sanitize(vr.URL,e)||"":Bn(e,"URL")?Ln(e):Qn(y(e))}function mr(){var e=ze();return e&&e[12]}function br(e){return e.ngDebugContext}function _r(e){return e.ngOriginalError}function wr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var kr=function(){function e(){Qp(this,e),this._console=console}return Kp(e,[{key:"handleError",value:function(e){var t=this._findOriginalError(e),n=this._findContext(e),r=function(e){return e.ngErrorLogger||wr}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}},{key:"_findContext",value:function(e){return e?br(e)?br(e):this._findContext(_r(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=_r(e);t&&_r(t);)t=_r(t);return t}}]),e}(),Cr=/^>|^->|<!--|-->|--!>|<!-$/g,Er=/(<|>)/;function Or(e,t){e.__ngContext__=t}var Sr=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(V);function Pr(e){return e instanceof Function?e():e}var Ir,Tr=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}({});function Ar(e,t){return Ir(e,t)}function Nr(e){var t=e[3];return he(t)?t[3]:t}function xr(e){return Mr(e[13])}function Rr(e){return Mr(e[4])}function Mr(e){for(;null!==e&&!he(e);)e=e[4];return e}function Dr(e,t,n,r,i){if(null!=r){var o,a=!1;he(r)?o=r:le(r)&&(a=!0,r=r[0]);var s=Ie(r);0===e&&null!==n?null==i?$r(t,n,s):Wr(t,n,s,i||null,!0):1===e&&null!==n?Wr(t,n,s,i||null,!0):2===e?oi(t,s,a):3===e&&t.destroyNode(s),null!=o&&function(e,t,n,r,i){var o=n[7];o!==Ie(n)&&Dr(t,e,r,o,i);for(var a=10;a<n.length;a++){var s=n[a];si(s[1],s,e,t,r,o)}}(t,e,o,n,i)}}function Lr(e,t){return Se(e)?e.createText(t):e.createTextNode(t)}function Br(e,t,n){Se(e)?e.setValue(t,n):t.textContent=n}function Fr(e,t){return e.createComment(function(e){return e.replace(Cr,function(e){return e.replace(Er,"\u200b$1\u200b")})}(t))}function jr(e,t,n){return Se(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function Ur(e,t){var n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,je(i,-1)),n.splice(r,1)}function Vr(e,t){if(!(e.length<=10)){var n,r=10+t,i=e[r];if(i){var o=i[17];null!==o&&o!==e&&Ur(o,i),t>0&&(e[r-1][4]=i[4]);var a=ln(e,10+t);si(i[1],n=i,n[11],2,null,null),n[0]=null,n[6]=null;var s=a[19];null!==s&&s.detachView(a[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}}function zr(e,t){if(!(256&t[2])){var n=t[11];Se(n)&&n.destroyNode&&si(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return Hr(e[1],e);for(;t;){var n=null;if(le(t))n=t[13];else{var r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)le(t)&&Hr(t[1],t),t=t[3];null===t&&(t=e),le(t)&&Hr(t[1],t),n=t&&t[4]}t=n}}(t)}}function Hr(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];if(!(i instanceof Ot)){var o=n[r+1];if(Array.isArray(o))for(var a=0;a<o.length;a+=2){var s=i[o[a]],u=o[a+1];try{u.call(s)}finally{}}else try{o.call(i)}finally{}}}}(e,t),function(e,t){var n=e.cleanup,r=t[7],i=-1;if(null!==n)for(var o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){var a=n[o+1],s="function"==typeof a?a(t):Ie(t[a]),u=r[i=n[o+2]],c=n[o+3];"boolean"==typeof c?s.removeEventListener(n[o],u,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),o+=2}else{var l=r[i=n[o+1]];n[o].call(l)}if(null!==r){for(var h=i+1;h<r.length;h++)(0,r[h])();t[7]=null}}(e,t),1===t[1].type&&Se(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&he(t[3])){n!==t[3]&&Ur(n,t);var r=t[19];null!==r&&r.detachView(e)}}}function Gr(e,t,n){return qr(e,t.parent,n)}function qr(e,t,n){for(var r=t;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){var i=e.data[r.directiveStart].encapsulation;if(i===L.None||i===L.Emulated)return null}return Ae(r,n)}function Wr(e,t,n,r,i){Se(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function $r(e,t,n){Se(e)?e.appendChild(t,n):t.appendChild(n)}function Zr(e,t,n,r,i){null!==r?Wr(e,t,n,r,i):$r(e,t,n)}function Qr(e,t){return Se(e)?e.parentNode(t):t.parentNode}function Yr(e,t,n){return Xr(e,t,n)}function Kr(e,t,n){return 40&e.type?Ae(e,n):null}var Jr,Xr=Kr;function ei(e,t){Xr=e,Jr=t}function ti(e,t,n,r){var i=Gr(e,r,t),o=t[11],a=Yr(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(var s=0;s<n.length;s++)Zr(o,i,n[s],a,!1);else Zr(o,i,n,a,!1);void 0!==Jr&&Jr(o,r,t,n,i)}function ni(e,t){if(null!==t){var n=t.type;if(3&n)return Ae(t,e);if(4&n)return ii(-1,e[t.index]);if(8&n){var r=t.child;if(null!==r)return ni(e,r);var i=e[t.index];return he(i)?ii(-1,i):Ie(i)}if(32&n)return Ar(t,e)()||Ie(e[t.index]);var o=ri(e,t);return null!==o?Array.isArray(o)?o[0]:ni(Nr(e[16]),o):ni(e,t.next)}return null}function ri(e,t){return null!==t?e[16][6].projection[t.projection]:null}function ii(e,t){var n=10+e+1;if(n<t.length){var r=t[n],i=r[1].firstChild;if(null!==i)return ni(r,i)}return t[7]}function oi(e,t,n){var r=Qr(e,t);r&&function(e,t,n,r){Se(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function ai(e,t,n,r,i,o,a){for(;null!=n;){var s=r[n.index],u=n.type;if(a&&0===t&&(s&&Or(Ie(s),r),n.flags|=4),64!=(64&n.flags))if(8&u)ai(e,t,n.child,r,i,o,!1),Dr(t,e,i,s,o);else if(32&u){for(var c=Ar(n,r),l=void 0;l=c();)Dr(t,e,i,l,o);Dr(t,e,i,s,o)}else 16&u?ui(e,t,r,n,i,o):Dr(t,e,i,s,o);n=a?n.projectionNext:n.next}}function si(e,t,n,r,i,o){ai(n,r,e.firstChild,t,i,o,!1)}function ui(e,t,n,r,i,o){var a=n[16],s=a[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)Dr(t,e,i,s[u],o);else ai(e,t,s,a[3],i,o,!0)}function ci(e,t,n){Se(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function li(e,t,n){Se(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function hi(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var o=t.length;if(i+o===r||e.charCodeAt(i+o)<=32)return i}n=i+1}}function fi(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==hi((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function di(e){return 4===e.type&&"ng-template"!==e.value}function pi(e,t,n){return t===(4!==e.type||n?e.value:"ng-template")}function vi(e,t,n){for(var r=4,i=e.attrs||[],o=function(e){for(var t=0;t<e.length;t++)if(Pt(e[t]))return t;return e.length}(i),a=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!a)if(4&r){if(r=2|1&r,""!==u&&!pi(e,u,n)||""===u&&1===t.length){if(gi(r))return!1;a=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!fi(e.attrs,c,n)){if(gi(r))return!1;a=!0}continue}var l=yi(8&r?"class":u,i,di(e),n);if(-1===l){if(gi(r))return!1;a=!0;continue}if(""!==c){var h;h=l>o?"":i[l+1].toLowerCase();var f=8&r?h:null;if(f&&-1!==hi(f,c,0)||2&r&&c!==h){if(gi(r))return!1;a=!0}}}}else{if(!a&&!gi(r)&&!gi(u))return!1;if(a&&gi(u))continue;a=!1,r=u|1&r}}return gi(r)||a}function gi(e){return 0==(1&e)}function yi(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var o=!1;i<t.length;){var a=t[i];if(a===e)return i;if(3===a||6===a)o=!0;else{if(1===a||2===a){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===a)break;if(0===a){i+=4;continue}}i+=o?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function mi(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(vi(e,t[r],n))return!0;return!1}function bi(e,t){e:for(var n=0;n<t.length;n++){var r=t[n];if(e.length===r.length){for(var i=0;i<e.length;i++)if(e[i]!==r[i])continue e;return!0}}return!1}function _i(e,t){return e?":not("+t.trim()+")":t}function wi(e){for(var t=e[0],n=1,r=2,i="",o=!1;n<e.length;){var a=e[n];if("string"==typeof a)if(2&r){var s=e[++n];i+="["+a+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+a:4&r&&(i+=" "+a);else""===i||gi(a)||(t+=_i(o,i),i=""),r=a,o=o||!gi(r);n++}return""!==i&&(t+=_i(o,i)),t}var ki={};function Ci(e){Ei(He(),ze(),vt()+e,Ke())}function Ei(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&_t(t,i,n)}else{var o=e.preOrderHooks;null!==o&&wt(t,o,0,n)}gt(n)}function Oi(e,t){return e<<17|t<<2}function Si(e){return e>>17&32767}function Pi(e){return 2|e}function Ii(e){return(131068&e)>>2}function Ti(e,t){return-131069&e|t<<2}function Ai(e){return 1|e}function Ni(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],o=n[r+1];if(-1!==o){var a=e.data[o];at(i),a.contentQueries(2,t[o],o)}}}function xi(e,t,n,r,i,o,a,s,u,c){var l=t.blueprint.slice();return l[0]=i,l[2]=140|r,Fe(l),l[3]=l[15]=e,l[8]=n,l[10]=a||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=o,l[16]=2==t.type?e[16]:l,l}function Ri(e,t,n,r,i){var o=e.data[t];if(null===o)o=Mi(e,t,n,r,i),Ue.lFrame.inI18n&&(o.flags|=64);else if(64&o.type){o.type=n,o.value=r,o.attrs=i;var a=$e();o.injectorIndex=null===a?-1:a.injectorIndex}return Ze(o,!0),o}function Mi(e,t,n,r,i){var o=We(),a=Qe(),s=e.data[t]=function(e,t,n,r,i,o){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?o:o&&o.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=s),null!==o&&(a?null==o.child&&null!==s.parent&&(o.child=s):null===o.next&&(o.next=s)),s}function Di(e,t,n,r){if(0===n)return-1;for(var i=t.length,o=0;o<n;o++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function Li(e,t,n){ct(t);try{var r=e.viewQuery;null!==r&&po(1,r,n);var i=e.template;null!==i&&ji(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Ni(e,t),e.staticViewQueries&&po(2,e.viewQuery,n);var o=e.components;null!==o&&function(e,t){for(var n=0;n<t.length;n++)uo(e,t[n])}(t,o)}catch(a){throw e.firstCreatePass&&(e.incompleteFirstPass=!0),a}finally{t[2]&=-5,pt()}}function Bi(e,t,n,r){var i=t[2];if(256!=(256&i)){ct(t);var o=Ke();try{Fe(t),Ue.lFrame.bindingIndex=e.bindingStartIndex,null!==n&&ji(e,t,n,2,r);var a=3==(3&i);if(!o)if(a){var s=e.preOrderCheckHooks;null!==s&&_t(t,s,null)}else{var u=e.preOrderHooks;null!==u&&wt(t,u,0,null),kt(t,0)}if(function(e){for(var t=xr(e);null!==t;t=Rr(t))if(t[2])for(var n=t[9],r=0;r<n.length;r++){var i=n[r],o=i[3];0==(1024&i[2])&&je(o,1),i[2]|=1024}}(t),function(e){for(var t=xr(e);null!==t;t=Rr(t))for(var n=10;n<t.length;n++){var r=t[n],i=r[1];Le(r)&&Bi(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&Ni(e,t),!o)if(a){var c=e.contentCheckHooks;null!==c&&_t(t,c)}else{var l=e.contentHooks;null!==l&&wt(t,l,1),kt(t,1)}!function(e,t){var n,r,i,o=e.hostBindingOpCodes;if(null!==o)try{for(var a=0;a<o.length;a++){var s=o[a];if(s<0)gt(~s);else{var u=s,c=o[++a],l=o[++a];n=c,r=u,i=void 0,(i=Ue.lFrame).bindingIndex=i.bindingRootIndex=n,it(r),l(2,t[u])}}}finally{gt(-1)}}(e,t);var h=e.components;null!==h&&function(e,t){for(var n=0;n<t.length;n++)ao(e,t[n])}(t,h);var f=e.viewQuery;if(null!==f&&po(2,f,r),!o)if(a){var d=e.viewCheckHooks;null!==d&&_t(t,d)}else{var p=e.viewHooks;null!==p&&wt(t,p,2),kt(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),o||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,je(t[3],-1))}finally{pt()}}}function Fi(e,t,n,r){var i=t[10],o=!Ke(),a=De(t);try{o&&!a&&i.begin&&i.begin(),a&&Li(e,t,r),Bi(e,t,n,r)}finally{o&&!a&&i.end&&i.end()}}function ji(e,t,n,r,i){var o=vt(),a=2&r;try{gt(-1),a&&t.length>20&&Ei(e,t,20,Ke()),n(r,i)}finally{gt(o)}}function Ui(e,t,n){if(fe(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var o=e.data[i];o.contentQueries&&o.contentQueries(1,n[i],i)}}function Vi(e,t,n){Ve()&&(function(e,t,n,r){var i=n.directiveStart,o=n.directiveEnd;e.firstCreatePass||Bt(n,t),Or(r,t);for(var a=n.initialInputs,s=i;s<o;s++){var u=e.data[s],c=ve(u);c&&to(t,n,u);var l=Qt(t,e,s,n);Or(l,t),null!==a&&ro(0,s-i,l,u,0,a),c&&(Re(n.index,t)[8]=l)}}(e,t,n,Ae(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,o=n.index,a=Ue.lFrame.currentDirectiveIndex;try{gt(o);for(var s=r;s<i;s++){var u=e.data[s],c=t[s];it(s),null===u.hostBindings&&0===u.hostVars&&null===u.hostAttrs||Yi(u,c)}}finally{gt(-1),it(a)}}(e,t,n))}function zi(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ae,r=t.localNames;if(null!==r)for(var i=t.index+1,o=0;o<r.length;o+=2){var a=r[o+1],s=-1===a?n(t,e):e[a];e[i++]=s}}function Hi(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Gi(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Gi(e,t,n,r,i,o,a,s,u,c){var l=20+r,h=l+i,f=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:ki);return n}(l,h),d="function"==typeof c?c():c;return f[1]={type:e,blueprint:f,template:n,queries:null,viewQuery:s,declTNode:t,data:f.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function qi(e,t,n,r){var i=go(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&yo(e).push(r,i.length-1))}function Wi(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function $i(e,t,n,r,i,o,a,s){var u,c,l=Ae(t,n),h=t.inputs;!s&&null!=h&&(u=h[r])?(bo(e,n,u,r,i),de(t)&&function(e,t){var n=Re(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r="class"===(c=r)?"className":"for"===c?"htmlFor":"formaction"===c?"formAction":"innerHtml"===c?"innerHTML":"readonly"===c?"readOnly":"tabindex"===c?"tabIndex":c,i=null!=a?a(i,t.value||"",r):i,Se(o)?o.setProperty(l,r,i):It(r)||(l.setProperty?l.setProperty(r,i):l[r]=i))}function Zi(e,t,n,r){var i=!1;if(Ve()){var o=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var o=0;o<r.length;o++){var a=r[o];mi(n,a.selectors,!1)&&(i||(i=[]),Vt(Bt(n,t),e,a.type),ve(a)?(Ki(e,n),i.unshift(a)):i.push(a))}return i}(e,t,n),a=null===r?null:{"":-1};if(null!==o){i=!0,Xi(n,e.data.length,o.length);for(var s=0;s<o.length;s++){var u=o[s];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,h=Di(e,t,o.length,null),f=0;f<o.length;f++){var d=o[f];n.mergedAttrs=Tt(n.mergedAttrs,d.hostAttrs),eo(e,n,t,h,d),Ji(h,d,a),null!==d.contentQueries&&(n.flags|=8),null===d.hostBindings&&null===d.hostAttrs&&0===d.hostVars||(n.flags|=128);var p=d.type.prototype;!c&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),l||!p.ngOnChanges&&!p.ngDoCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),h++}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,o=[],a=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs,h=null===i||di(t)?null:io(l,i);o.push(h),a=Wi(l,u,a),s=Wi(c.outputs,u,s)}null!==a&&(a.hasOwnProperty("class")&&(t.flags|=16),a.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=a,t.outputs=s}(e,n)}a&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var o=n[t[i+1]];if(null==o)throw new g("301","Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],o)}}(n,r,a)}return n.mergedAttrs=Tt(n.mergedAttrs,n.attrs),i}function Qi(e,t,n,r,i,o){var a=o.hostBindings;if(a){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=u&&s.push(u),s.push(r,i,a)}}function Yi(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Ki(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function Ji(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;ve(t)&&(n[""]=e)}}function Xi(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function eo(e,t,n,r,i){e.data[r]=i;var o=i.factory||(i.factory=ge(i.type)),a=new Ot(o,ve(i),null);e.blueprint[r]=a,n[r]=a,Qi(e,t,0,r,Di(e,n,i.hostVars,ki),i)}function to(e,t,n){var r=Ae(t,e),i=Hi(n),o=e[10],a=co(e,xi(e,i,null,n.onPush?64:16,r,t,o,o.createRenderer(r,n),null,null));e[t.index]=a}function no(e,t,n,r,i,o,a){if(null==o)Se(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{var s=null==a?y(o):a(o,r||"",i);Se(e)?e.setAttribute(t,i,s,n):n?t.setAttributeNS(n,i,s):t.setAttribute(i,s)}}function ro(e,t,n,r,i,o){var a=o[t];if(null!==a)for(var s=r.setInput,u=0;u<a.length;){var c=a[u++],l=a[u++],h=a[u++];null!==s?r.setInput(n,h,c,l):n[l]=h}}function io(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function oo(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function ao(e,t){var n=Re(t,e);if(Le(n)){var r=n[1];80&n[2]?Bi(r,n,r.template,n[8]):n[5]>0&&so(n)}}function so(e){for(var t=xr(e);null!==t;t=Rr(t))for(var n=10;n<t.length;n++){var r=t[n];if(1024&r[2]){var i=r[1];Bi(i,r,i.template,r[8])}else r[5]>0&&so(r)}var o=e[1].components;if(null!==o)for(var a=0;a<o.length;a++){var s=Re(o[a],e);Le(s)&&s[5]>0&&so(s)}}function uo(e,t){var n=Re(t,e),r=n[1];!function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(r,n),Li(r,n,n[8])}function co(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function lo(e){for(;e;){e[2]|=64;var t=Nr(e);if(0!=(512&e[2])&&!t)return e;e=t}return null}function ho(e,t,n){var r=t[10];r.begin&&r.begin();try{Bi(e,t,e.template,n)}catch(i){throw mo(t,i),i}finally{r.end&&r.end()}}function fo(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=Me(n),i=r[1];Fi(i,r,i.template,n)}}(e[8])}function po(e,t,n){at(0),t(e,n)}var vo=Promise.resolve(null);function go(e){return e[7]||(e[7]=[])}function yo(e){return e.cleanup||(e.cleanup=[])}function mo(e,t){var n=e[9],r=n?n.get(kr,null):null;r&&r.handleError(t)}function bo(e,t,n,r,i){for(var o=0;o<n.length;){var a=n[o++],s=n[o++],u=t[a],c=e.data[a];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function _o(e,t,n){var r=Te(t,e);Br(e[11],r,n)}function wo(e,t,n){var r=n?e.styles:null,i=n?e.classes:null,o=0;if(null!==t)for(var a=0;a<t.length;a++){var s=t[a];"number"==typeof s?o=s:1==o?i=h(i,s):2==o&&(r=h(r,s+": "+t[++a]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}var ko,Co=new rn("INJECTOR",-1),Eo=function(){function e(){Qp(this,e)}return Kp(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vn;if(t===vn){var n=new Error("NullInjectorError: No provider for ".concat(l(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),Oo=new rn("Set Injector scope."),So={},Po={},Io=[];function To(){return void 0===ko&&(ko=new Eo),ko}function Ao(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new No(e,n,t||To(),r)}var No=function(){function e(t,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Qp(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var a=[];n&&un(n,function(e){return i.processProvider(e,t,n)}),un([t],function(e){return i.processInjectorType(e,[],a)}),this.records.set(Co,Mo(void 0,this));var s=this.records.get(Oo);this.scope=null!=s?s.value:null,this.source=o||("object"==typeof t?null:l(t))}return Kp(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vn,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:N.Default;this.assertNotDestroyed();var r,i=mn(this);try{if(!(n&N.SkipSelf)){var o=this.records.get(e);if(void 0===o){var a=("function"==typeof(r=e)||"object"==typeof r&&r instanceof rn)&&C(e);o=a&&this.injectableDefInScope(a)?Mo(xo(e),So):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&N.Self?To():this.parent).get(e,t=n&N.Optional&&t===vn?null:t)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(l(e)),i)throw s;return function(e,t,n,r){var i=e.ngTempTokenPath;throw t.__source&&i.unshift(t.__source),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=l(t);if(Array.isArray(t))i=t.map(l).join(" -> ");else if("object"==typeof t){var o=[];for(var a in t)if(t.hasOwnProperty(a)){var s=t[a];o.push(a+":"+("string"==typeof s?JSON.stringify(s):l(s)))}i="{".concat(o.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(gn,"\n  "))}("\n"+e.message,i,"R3InjectorError",r),e.ngTokenPath=i,e.ngTempTokenPath=null,e}(s,e,0,this.source)}throw s}finally{mn(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(l(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=p(e)))return!1;var i=O(e),o=null==i&&e.ngModule||void 0,a=void 0===o?e:o,s=-1!==n.indexOf(a);if(void 0!==o&&(i=O(o)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(a);try{un(i.imports,function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,i=t.providers;un(i,function(e){return r.processProvider(e,n,i||Io)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(a);var h=ge(a)||function(){return new a};this.records.set(a,Mo(h,So));var f=i.providers;if(null!=f&&!s){var d=e;un(f,function(e){return r.processProvider(e,d,f)})}return void 0!==o&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r=Lo(e=p(e))?e:p(e&&e.provide),i=function(e,t,n){return Do(e)?Mo(void 0,e.useValue):Mo(Ro(e),So)}(e);if(Lo(e)||!0!==e.multi)this.records.get(r);else{var o=this.records.get(r);o||((o=Mo(void 0,So,!0)).factory=function(){return wn(o.multi)},this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,i)}},{key:"hydrate",value:function(e,t){var n;return t.value===So&&(t.value=Po,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value}},{key:"injectableDefInScope",value:function(e){return!!e.providedIn&&("string"==typeof e.providedIn?"any"===e.providedIn||e.providedIn===this.scope:this.injectorDefTypes.has(e.providedIn))}}]),e}();function xo(e){var t=C(e),n=null!==t?t.factory:ge(e);if(null!==n)return n;if(e instanceof rn)throw new Error("Token ".concat(l(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=hn(t,"?");throw new Error("Can't resolve all parameters for ".concat(l(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[P]||e[T]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function Ro(e,t,n){var r,i;if(Lo(e)){var o=p(e);return ge(o)||xo(o)}if(Do(e))r=function(){return p(e.useValue)};else if((i=e)&&i.useFactory)r=function(){return e.useFactory.apply(e,Up(wn(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return _n(p(e.useExisting))};else{var a=p(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return ge(a)||xo(a);r=function(){return Wp(a,Up(wn(e.deps)))}}return r}function Mo(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function Do(e){return null!==e&&"object"==typeof e&&yn in e}function Lo(e){return"function"==typeof e}var Bo=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=Ao(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},Fo=function(){var e=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?Bo(e,t,""):Bo(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=vn,e.NULL=new Eo,e.\u0275prov=w({token:e,providedIn:"any",factory:function(){return _n(Co)}}),e.__NG_ELEMENT_ID__=-1,e}();function jo(e,t){bt(Me(e)[1],qe())}function Uo(e){for(var t=Object.getPrototypeOf(e.type.prototype).constructor,n=!0,r=[e];t;){var i=void 0;if(ve(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);var o=e;o.inputs=Vo(e.inputs),o.declaredInputs=Vo(e.declaredInputs),o.outputs=Vo(e.outputs);var a=i.hostBindings;a&&Go(e,a);var s=i.viewQuery,u=i.contentQueries;if(s&&zo(e,s),u&&Ho(e,u),c(e.inputs,i.inputs),c(e.declaredInputs,i.declaredInputs),c(e.outputs,i.outputs),ve(i)&&i.data.animation){var l=e.data;l.animation=(l.animation||[]).concat(i.data.animation)}}var h=i.features;if(h)for(var f=0;f<h.length;f++){var d=h[f];d&&d.ngInherit&&d(e),d===Uo&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=Tt(i.hostAttrs,n=Tt(n,i.hostAttrs))}}(r)}function Vo(e){return e===z?{}:e===G?[]:e}function zo(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function Ho(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,i){t(e,r,i),n(e,r,i)}:t}function Go(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var qo=null;function Wo(){if(!qo){var e=V.Symbol;if(e&&e.iterator)qo=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(qo=r)}}return qo}var $o=function(){function e(t){Qp(this,e),this.wrapped=t}return Kp(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function Zo(e){return!!Qo(e)&&(Array.isArray(e)||!(e instanceof Map)&&Wo()in e)}function Qo(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Yo(e,t,n){return e[t]=n}function Ko(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function Jo(e,t,n,r){var i=Ko(e,t,n);return Ko(e,t+1,r)||i}function Xo(e,t,n,r,i){var o=Jo(e,t,n,r);return Ko(e,t+2,i)||o}function ea(e,t,n,r){var i=ze();return Ko(i,tt(),t)&&(He(),function(e,t,n,r,i,o){var a=Ae(e,t);no(t[11],a,o,e.value,n,r,i)}(yt(),i,e,t,n,r)),ea}function ta(e,t,n,r){return Ko(e,tt(),n)?t+y(n)+r:ki}function na(e,t,n,r,i,o){var a=Jo(e,et(),n,i);return nt(2),a?t+y(n)+r+y(i)+o:ki}function ra(e,t,n,r,i,o,a,s){var u=Xo(e,et(),n,i,a);return nt(3),u?t+y(n)+r+y(i)+o+y(a)+s:ki}function ia(e,t,n,r,i,o,a,s){var u=ze(),c=He(),l=e+20,h=c.firstCreatePass?function(e,t,n,r,i,o,a,s,u){var c=t.consts,l=Ri(t,e,4,a||null,Be(c,s));Zi(t,n,l,Be(c,u)),bt(t,l);var h=l.tViews=Gi(2,l,r,i,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),h.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,o,a):c.data[l];Ze(h,!1);var f=u[11].createComment("");ti(c,u,f,h),Or(f,u),co(u,u[l]=oo(f,u,f,h)),pe(h)&&Vi(c,u,h),null!=a&&zi(u,h,s)}function oa(e){return xe(Ue.lFrame.contextLView,20+e)}function aa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N.Default,n=ze();return null===n?_n(e,t):Gt(qe(),n,p(e),t)}function sa(e,t,n){var r=ze();return Ko(r,tt(),t)&&$i(He(),yt(),r,e,t,r[11],n,!1),sa}function ua(e,t,n,r,i){var o=i?"class":"style";bo(e,n,t.inputs[o],o,r)}function ca(e,t,n,r){var i=ze(),o=He(),a=20+e,s=i[11],u=i[a]=jr(s,t,Ue.lFrame.currentNamespace),c=o.firstCreatePass?function(e,t,n,r,i,o,a){var s=t.consts,u=Ri(t,e,2,i,Be(s,o));return Zi(t,n,u,Be(s,a)),null!==u.attrs&&wo(u,u.attrs,!1),null!==u.mergedAttrs&&wo(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(a,o,i,0,t,n,r):o.data[a];Ze(c,!0);var l=c.mergedAttrs;null!==l&&St(s,u,l);var h=c.classes;null!==h&&li(s,u,h);var f=c.styles;null!==f&&ci(s,u,f),64!=(64&c.flags)&&ti(o,i,u,c),0===Ue.lFrame.elementDepthCount&&Or(u,i),Ue.lFrame.elementDepthCount++,pe(c)&&(Vi(o,i,c),Ui(o,c,i)),null!==r&&zi(i,c)}function la(){var e=qe();Qe()?Ye():Ze(e=e.parent,!1);var t=e;Ue.lFrame.elementDepthCount--;var n=He();n.firstCreatePass&&(bt(n,e),fe(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&ua(n,t,ze(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&ua(n,t,ze(),t.stylesWithoutHost,!1)}function ha(e,t,n,r){ca(e,t,n,r),la()}function fa(e,t,n){var r=ze(),i=He(),o=e+20,a=i.firstCreatePass?function(e,t,n,r,i){var o=t.consts,a=Be(o,r),s=Ri(t,e,8,"ng-container",a);return null!==a&&wo(s,a,!0),Zi(t,n,s,Be(o,i)),null!==t.queries&&t.queries.elementStart(t,s),s}(o,i,r,t,n):i.data[o];Ze(a,!0);var s=r[o]=r[11].createComment("");ti(i,r,s,a),Or(s,r),pe(a)&&(Vi(i,r,a),Ui(i,a,r)),null!=n&&zi(r,a)}function da(){var e=qe(),t=He();Qe()?Ye():Ze(e=e.parent,!1),t.firstCreatePass&&(bt(t,e),fe(e)&&t.queries.elementEnd(e))}function pa(){return ze()}function va(e){return!!e&&"function"==typeof e.then}function ga(e){return!!e&&"function"==typeof e.subscribe}var ya=ga;function ma(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=ze(),o=He(),a=qe();return function(e,t,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7?arguments[7]:void 0,u=pe(r),c=e.firstCreatePass&&yo(e),l=go(t),h=!0;if(3&r.type){var f=Ae(r,t),d=s?s(f):z,p=d.target||f,v=l.length,g=s?function(e){return s(Ie(e[r.index])).target}:r.index;if(Se(n)){var y=null;if(!s&&u&&(y=function(e,t,n,r){var i=e.cleanup;if(null!=i)for(var o=0;o<i.length-1;o+=2){var a=i[o];if(a===n&&i[o+1]===r){var s=t[7],u=i[o+2];return s.length>u?s[u]:null}"string"==typeof a&&(o+=2)}return null}(e,t,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=o,y.__ngLastListenerFn__=o,h=!1;else{o=_a(r,t,0,o,!1);var m=n.listen(d.name||p,i,o);l.push(o,m),c&&c.push(i,g,v,v+1)}}else o=_a(r,t,0,o,!0),p.addEventListener(i,o,a),l.push(o),c&&c.push(i,g,v,a)}else o=_a(r,t,0,o,!1);var b,_=r.outputs;if(h&&null!==_&&(b=_[i])){var w=b.length;if(w)for(var k=0;k<w;k+=2){var C=t[b[k]][b[k+1]].subscribe(o),E=l.length;l.push(o,C),c&&c.push(i,r.index,E,-(E+1))}}}(o,i,i[11],a,e,t,n,r),ma}function ba(e,t,n,r){try{return!1!==n(r)}catch(i){return mo(e,i),!1}}function _a(e,t,n,r,i){return function n(o){if(o===Function)return r;var a=2&e.flags?Re(e.index,t):t;0==(32&t[2])&&lo(a);for(var s=ba(t,0,r,o),u=n.__ngNextListenerFn__;u;)s=ba(t,0,u,o)&&s,u=u.__ngNextListenerFn__;return i&&!1===s&&(o.preventDefault(),o.returnValue=!1),s}}function wa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(Ue.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Ue.lFrame.contextLView))[8]}(e)}function ka(e,t){for(var n=null,r=function(e){var t=e.attrs;if(null!=t){var n=t.indexOf(5);if(0==(1&n))return t[n+1]}return null}(e),i=0;i<t.length;i++){var o=t[i];if("*"!==o){if(null===r?mi(e,o,!0):bi(r,o))return i}else n=i}return n}function Ca(e){var t=ze()[16][6];if(!t.projection)for(var n=t.projection=hn(e?e.length:1,null),r=n.slice(),i=t.child;null!==i;){var o=e?ka(i,e):0;null!==o&&(r[o]?r[o].projectionNext=i:n[o]=i,r[o]=i),i=i.next}}function Ea(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=ze(),i=He(),o=Ri(i,20+e,16,null,n||null);null===o.projection&&(o.projection=t),Ye(),64!=(64&o.flags)&&function(e,t,n){ui(t[11],0,t,n,Gr(e,n,t),Yr(n.parent||t[6],n,t))}(i,r,o)}function Oa(e,t,n,r,i){var o=ze(),a=ta(o,t,n,r);return a!==ki&&$i(He(),yt(),o,e,a,o[11],i,!1),Oa}function Sa(e,t,n,r,i,o,a){var s=ze(),u=na(s,t,n,r,i,o);return u!==ki&&$i(He(),yt(),s,e,u,s[11],a,!1),Sa}function Pa(e,t,n,r,i,o,a,s,u){var c=ze(),l=ra(c,t,n,r,i,o,a,s);return l!==ki&&$i(He(),yt(),c,e,l,c[11],u,!1),Pa}function Ia(e,t,n,r,i){for(var o=e[n+1],a=null===t,s=r?Si(o):Ii(o),u=!1;0!==s&&(!1===u||a);){var c=e[s+1];Ta(e[s],t)&&(u=!0,e[s+1]=r?Ai(c):Pi(c)),s=r?Si(c):Ii(c)}u&&(e[n+1]=r?Pi(o):Ai(o))}function Ta(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&dn(e,t)>=0}function Aa(e,t){return function(e,t,n,r){var i=ze(),o=He(),a=nt(2);o.firstUpdatePass&&function(e,t,n,r){var i=e.data;if(null===i[n+1]){var o=i[vt()],a=function(e,t){return t>=e.expandoStartIndex}(e,n);(function(e,t){return 0!=(16&e.flags)})(o)&&null===t&&!a&&(t=!1),t=function(e,t,n,r){var i=function(e){var t=Ue.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),o=t.residualClasses;if(null===i)0===t.classBindings&&(n=xa(n=Na(null,e,t,n,!0),t.attrs,!0),o=null);else{var a=t.directiveStylingLast;if(-1===a||e[a]!==i)if(n=Na(i,e,t,n,!0),null===o){var s=function(e,t,n){var r=t.classBindings;if(0!==Ii(r))return e[Si(r)]}(e,t);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[Si(t.classBindings)]=r}(e,t,0,s=xa(s=Na(null,e,t,s[1],!0),t.attrs,!0))}else o=function(e,t,n){for(var r,i=t.directiveEnd,o=1+t.directiveStylingLast;o<i;o++)r=xa(r,e[o].hostAttrs,!0);return xa(r,t.attrs,!0)}(e,t)}return void 0!==o&&(t.residualClasses=o),n}(i,o,t),function(e,t,n,r,i,o){var a=t.classBindings,s=Si(a),u=Ii(a);e[r]=n;var c,l=!1;if(Array.isArray(n)){var h=n;(null===(c=h[1])||dn(h,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var f=Si(e[s+1]);e[r+1]=Oi(f,s),0!==f&&(e[f+1]=Ti(e[f+1],r)),e[s+1]=131071&e[s+1]|r<<17}else e[r+1]=Oi(s,0),0!==s&&(e[s+1]=Ti(e[s+1],r)),s=r;else e[r+1]=Oi(u,0),0===s?s=r:e[u+1]=Ti(e[u+1],r),u=r;l&&(e[r+1]=Pi(e[r+1])),Ia(e,c,r,!0),Ia(e,c,r,!1),function(e,t,n,r,i){var o=e.residualClasses;null!=o&&"string"==typeof t&&dn(o,t)>=0&&(n[r+1]=Ai(n[r+1]))}(t,c,e,r),a=Oi(s,u),t.classBindings=a}(i,o,t,n,a)}}(o,e,a),t!==ki&&Ko(i,a,t)&&function(e,t,n,r,i,o,a,s){if(3&t.type){var u=e.data,c=u[s+1];Ma(1==(1&c)?Ra(u,t,n,i,Ii(c),!0):void 0)||(Ma(o)||2==(2&c)&&(o=Ra(u,null,n,i,s,!0)),function(e,t,n,r,i){var o=Se(e);i?o?e.addClass(n,r):n.classList.add(r):o?e.removeClass(n,r):n.classList.remove(r)}(r,0,Te(vt(),n),i,o))}}(o,o.data[vt()],i,i[11],e,i[a+1]=function(e,t){return null==e||"object"==typeof e&&(e=l(Ln(e))),e}(t),0,a)}(e,t),Aa}function Na(e,t,n,r,i){var o=null,a=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<a&&(r=xa(r,(o=t[s]).hostAttrs,i),o!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function xa(e,t,n){var r,i,o,a,s=n?1:2,u=-1;if(null!==t)for(var c=0;c<t.length;c++){var l=t[c];"number"==typeof l?u=l:u===s&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),r=e,i=l,o=!!n||t[++c],a=void 0,(a=dn(r,i))>=0?r[1|a]=o:function(e,t,n,r){var i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(r,a=~a,i,o))}return void 0===e?null:e}function Ra(e,t,n,r,i,o){for(var a,s=null===t;i>0;){var u=e[i],c=Array.isArray(u),l=c?u[1]:u,h=null===l,f=n[i+1];f===ki&&(f=h?H:void 0);var d=h?fn(f,r):l===r?f:void 0;if(c&&!Ma(d)&&(d=fn(u,r)),Ma(d)&&(a=d,s))return a;var p=e[i+1];i=s?Si(p):Ii(p)}if(null!==t){var v=o?t.residualClasses:t.residualStyles;null!=v&&(a=fn(v,r))}return a}function Ma(e){return void 0!==e}function Da(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=ze(),r=He(),i=e+20,o=r.firstCreatePass?Ri(r,i,1,t,null):r.data[i],a=n[i]=Lr(n[11],t);ti(r,n,a,o),Ze(o,!1)}function La(e){return Ba("",e,""),La}function Ba(e,t,n){var r=ze(),i=ta(r,e,t,n);return i!==ki&&_o(r,vt(),i),Ba}function Fa(e,t,n,r,i){var o=ze(),a=na(o,e,t,n,r,i);return a!==ki&&_o(o,vt(),a),Fa}function ja(e,t,n,r,i,o,a){var s=ze(),u=ra(s,e,t,n,r,i,o,a);return u!==ki&&_o(s,vt(),u),ja}function Ua(e,t,n){var r=ze();return Ko(r,tt(),t)&&$i(He(),yt(),r,e,t,r[11],n,!0),Ua}var Va=void 0,za=["en",[["a","p"],["AM","PM"],Va],[["AM","PM"],Va,Va],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Va,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Va,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Va,"{1} 'at' {0}",Va],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],Ha={};function Ga(e,t,n){"string"!=typeof t&&(n=t,t=e[Qa.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),Ha[t]=e,n&&(Ha[t][Qa.ExtraData]=n)}function qa(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=Za(t);if(n)return n;var r=t.split("-")[0];if(n=Za(r))return n;if("en"===r)return za;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function Wa(e){return qa(e)[Qa.CurrencyCode]||null}function $a(e){return qa(e)[Qa.PluralCase]}function Za(e){return e in Ha||(Ha[e]=V.ng&&V.ng.common&&V.ng.common.locales&&V.ng.common.locales[e]),Ha[e]}var Qa=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}({}),Ya=["zero","one","two","few","many"],Ka={marker:"element"},Ja={marker:"ICU"},Xa=function(e){return e[e.SHIFT=2]="SHIFT",e[e.APPEND_EAGERLY=1]="APPEND_EAGERLY",e[e.COMMENT=2]="COMMENT",e}({}),es="en-US";function ts(e){var t;null==(t=e)&&_("Expected localeId to be defined",t,null,"!="),"string"==typeof e&&(es=e.toLowerCase().replace(/_/g,"-"))}function ns(e,t,n){var r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?Kr(e,0,n):Ie(n[i])}function rs(e,t,n,r,i){var o=t.insertBeforeIndex;if(Array.isArray(o)){var a=r,s=null;if(3&t.type||(s=a,a=i),null!==a&&0==(2&t.flags))for(var u=1;u<o.length;u++)Wr(e,a,n[o[u]],s,!1)}}function is(e,t){if(e.push(t),e.length>1)for(var n=e.length-2;n>=0;n--){var r=e[n];os(r)||as(r,t)&&null===(i=void 0,i=r.insertBeforeIndex,Array.isArray(i)?i[0]:i)&&ss(r,t.index)}var i}function os(e){return!(64&e.type)}function as(e,t){return os(t)||e.index>t.index}function ss(e,t){var n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(ei(ns,rs),e.insertBeforeIndex=t)}function us(e,t){var n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function cs(e,t,n){var r=Mi(e,n,64,null,null);return is(t,r),r}function ls(e,t){var n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}var hs=0,fs=0;function ds(e,t,n,r){for(var i,o=n[11],a=null,s=0;s<t.length;s++){var u=t[s];if("string"==typeof u){var c=t[++s];null===n[c]&&(n[c]=Lr(o,u))}else if("number"==typeof u)switch(1&u){case 0:var l=u>>>17,h=void 0,f=void 0;if(null===a&&(a=l,i=Qr(o,r)),l===a?(h=r,f=i):(h=null,f=Ie(n[l])),null!==f){var d=(131070&u)>>>1;Wr(o,f,n[d],h,!1);var p=us(e,d);if(null!==p&&"object"==typeof p){var v=ls(p,n);null!==v&&ds(e,p.create[v],n,n[p.anchorIdx])}}break;case 1:var g=t[++s],y=t[++s];no(o,Te(u>>>1,n),null,null,g,y,null);break;default:throw new Error('Unable to determine the type of mutate operation for "'.concat(u,'"'))}else switch(u){case Ja:var m=t[++s],b=t[++s];null===n[b]&&Or(n[b]=Fr(o,m),n);break;case Ka:var _=t[++s],w=t[++s];null===n[w]&&Or(n[w]=jr(o,_,null),n)}}}function ps(e,t,n,r,i){for(var o=0;o<n.length;o++){var a=n[o],s=n[++o];if(a&i)for(var u="",c=o+1;c<=o+s;c++){var l=n[c];if("string"==typeof l)u+=l;else if("number"==typeof l)if(l<0)u+=y(t[r-l]);else{var h=l>>>2;switch(3&l){case 1:var f=n[++c],d=n[++c],p=e.data[h];"string"==typeof p?no(t[11],t[h],null,p,f,u,d):$i(e,p,t,f,u,t[11],d,!1);break;case 0:var v=t[h];null!==v&&Br(t[11],v,u);break;case 2:gs(e,us(e,h),t,u);break;case 3:vs(e,us(e,h),r,t)}}}else{var g=n[o+1];if(g>0&&3==(3&g)){var m=us(e,g>>>2);t[m.currentCaseLViewIndex]<0&&vs(e,m,r,t)}}o+=s}}function vs(e,t,n,r){var i=r[t.currentCaseLViewIndex];if(null!==i){var o=hs;i<0&&(i=r[t.currentCaseLViewIndex]=~i,o=-1),ps(e,r,t.update[i],n,o)}}function gs(e,t,n,r){var i=function(e,t){var n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:var r=function(e,t){var n=$a(t)(parseInt(e,10)),r=Ya[n];return void 0!==r?r:"other"}(t,es);-1===(n=e.cases.indexOf(r))&&"other"!==r&&(n=e.cases.indexOf("other"));break;case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(ls(t,n)!==i&&(ys(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){var o=n[t.anchorIdx];o&&ds(e,t.create[i],n,o)}}function ys(e,t,n){var r=ls(t,n);if(null!==r)for(var i=t.remove[r],o=0;o<i.length;o++){var a=i[o];if(a>0){var s=Te(a,n);null!==s&&oi(n[11],s)}else ys(e,us(e,~a),n)}}var ms=/\ufffd(\d+):?\d*\ufffd/gi,bs=/\ufffd(\d+)\ufffd/,_s=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,ws=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,ks=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,Cs=/\uE500/g;function Es(e,t,n,r,i,o,a){var s=Di(e,r,1,null),u=s<<Xa.SHIFT,c=$e();t===c&&(c=null),null===c&&(u|=Xa.APPEND_EAGERLY),a&&(u|=Xa.COMMENT,void 0===Ir&&(Ir=function(){var e,t,n=[],r=-1;function i(e,n){r=0;var i=ls(e,n);t=null!==i?e.remove[i]:G}function o(){if(r<t.length){var a=t[r++];return a>0?e[a]:(n.push(r,t),i(e[1].data[~a],e),o())}return 0===n.length?null:(t=n.pop(),r=n.pop(),o())}return function(t,r){for(e=r;n.length;)n.pop();return i(t.value,r),o}}())),i.push(u,null===o?"":o);var l=Mi(e,s,a?32:1,null===o?"":o,null);is(n,l);var h=l.index;return Ze(l,!1),null!==c&&t!==c&&function(e,t){var n,r=e.insertBeforeIndex;null===r?(ei(ns,rs),r=e.insertBeforeIndex=[null,t]):(1!=(n=Array.isArray(r))&&_("Expecting array here",n,!0,"=="),r.push(t))}(c,h),l}function Os(e,t,n,r,i,o,a){var s=a.match(ms),u=Es(e,t,n,o,r,s?null:a,!1);s&&Ss(i,a,u.index,null,0,null)}function Ss(e,t,n,r,i,o){var a=e.length,s=a+1;e.push(null,null);for(var u=a+2,c=t.split(ms),l=0,h=0;h<c.length;h++){var f=c[h];if(1&h){var d=i+parseInt(f,10);e.push(-1-d),l|=Ps(d)}else""!==f&&e.push(f)}return e.push(n<<2|(r?1:0)),r&&e.push(r,o),e[a]=l,e[s]=e.length-u,l}function Ps(e){return 1<<Math.min(e,31)}function Is(e){for(var t,n,r="",i=0,o=!1;null!==(t=ws.exec(e));)o?t[0]==="\ufffd/*".concat(n,"\ufffd")&&(i=t.index,o=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],o=!0);return r+=e.substr(i)}function Ts(e,t,n,r,i,o){var a=0,s={type:i.type,currentCaseLViewIndex:Di(e,t,1,null),anchorIdx:o,cases:[],create:[],remove:[],update:[]};!function(e,t,n){e.push(Ps(t.mainBinding),2,-1-t.mainBinding,n<<2|2)}(n,i,o),function(e,t,n){var r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,o,s);for(var u=i.values,c=0;c<u.length;c++){for(var l=u[c],h=[],f=0;f<l.length;f++){var d=l[f];if("string"!=typeof d){var p=h.push(d)-1;l[f]="\x3c!--\ufffd".concat(p,"\ufffd--\x3e")}}a=xs(e,s,t,n,r,i.cases[c],l.join(""),h)|a}a&&function(e,t,n){e.push(t,1,n<<2|3)}(n,a,o)}function As(e){for(var t=[],n=[],r=1,i=0,o=Ns(e=e.replace(_s,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""})),a=0;a<o.length;){var s=o[a++].trim();1===r&&(s=s.replace(/\s*(?:=)?(\w+)\s*/,"$1")),s.length&&t.push(s);var u=Ns(o[a++]);t.length>n.length&&n.push(u)}return{type:r,mainBinding:i,cases:t,values:n}}function Ns(e){if(!e)return[];var t,n=0,r=[],i=[],o=/[{}]/g;for(o.lastIndex=0;t=o.exec(e);){var a=t.index;if("}"==t[0]){if(r.pop(),0==r.length){var s=e.substring(n,a);_s.test(s)?i.push(As(s)):i.push(s),n=a+1}}else{if(0==r.length){var u=e.substring(n,a);i.push(u),n=a+1}r.push("{")}}var c=e.substring(n);return i.push(c),i}function xs(e,t,n,r,i,o,a,s){var u=[],c=[],l=[];t.cases.push(o),t.create.push(u),t.remove.push(c),t.update.push(l);var h=Gn(Oe()).getInertBodyElement(a),f=pr(h)||h;return f?Rs(e,t,n,r,u,c,l,f,i,s,0):0}function Rs(e,t,n,r,i,o,a,s,u,c,l){for(var h=0,f=s.firstChild;f;){var d=Di(e,n,1,null);switch(f.nodeType){case Node.ELEMENT_NODE:var p=f,v=p.tagName.toLowerCase();if(ir.hasOwnProperty(v)){Ls(i,Ka,v,u,d),e.data[d]=v;for(var g=p.attributes,y=0;y<g.length;y++){var m=g.item(y),b=m.name.toLowerCase();m.value.match(ms)?sr.hasOwnProperty(b)&&Ss(a,m.value,d,m.name,0,or[b]?Qn:ar[b]?Yn:null):Bs(i,d,m)}h=Rs(e,t,n,r,i,o,a,f,d,c,l+1)|h,Ms(o,d,l)}break;case Node.TEXT_NODE:var _=f.textContent||"",w=_.match(ms);Ls(i,null,w?"":_,u,d),Ms(o,d,l),w&&(h=Ss(a,_,d,null,0,null)|h);break;case Node.COMMENT_NODE:var k=bs.exec(f.textContent||"");if(k){var C=c[parseInt(k[1],10)];Ls(i,Ja,"",u,d),Ts(e,n,r,u,C,d),Ds(o,d,l)}}f=f.nextSibling}return h}function Ms(e,t,n){0===n&&e.push(t)}function Ds(e,t,n){0===n&&(e.push(~t),e.push(t))}function Ls(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,0|r<<17|i<<1)}function Bs(e,t,n){e.push(t<<1|1,n.name,n.value)}function Fs(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=He(),i=ze(),o=20+e,a=Be(r.consts,t),s=$e();r.firstCreatePass&&function(e,t,n,r,i,o){for(var a,s=$e(),u=[],c=[],l=[[]],h=(a=i=function(e,t){if(function(e){return-1===e}(t))return Is(e);var n=e.indexOf(":".concat(t,"\ufffd"))+2+t.toString().length,r=e.search(new RegExp("\ufffd\\/\\*\\d+:".concat(t,"\ufffd")));return Is(e.substring(n,r))}(i,o),a.replace(Cs," ")).split(ks),f=0;f<h.length;f++){var d=h[f];if(0==(1&f))for(var p=Ns(d),v=0;v<p.length;v++){var g=p[v];if(0==(1&v)){var y=g;""!==y&&Os(e,s,l[0],u,c,n,y)}else{var m=g;if("object"!=typeof m)throw new Error('Unable to parse ICU expression in "'.concat(i,'" message.'));Ts(e,n,c,t,m,Es(e,s,l[0],n,u,"",!0).index)}}else{var b=47===d.charCodeAt(0),_=(d.charCodeAt(b?1:0),20+Number.parseInt(d.substring(b?2:1)));if(b)l.shift(),Ze($e(),!1);else{var w=cs(e,l[0],_);l.unshift([]),Ze(w,!0)}}}e.data[r]={create:u,update:c}}(r,null===s?0:s.index,i,o,a,n);var u=r.data[o],c=qr(r,s===i[6]?null:s,i);!function(e,t,n,r){for(var i=e[11],o=0;o<t.length;o++){var a=t[o++],s=t[o],u=(a&Xa.COMMENT)===Xa.COMMENT,c=(a&Xa.APPEND_EAGERLY)===Xa.APPEND_EAGERLY,l=a>>>Xa.SHIFT,h=e[l];null===h&&(h=e[l]=u?i.createComment(s):Lr(i,s)),c&&null!==n&&Wr(i,n,h,r,!1)}}(i,u.create,c,s&&8&s.type?i[s.index]:null),rt(!0)}function js(){rt(!1)}function Us(e,t,n){Fs(e,t,n),js()}function Vs(e){return Ko(ze(),tt(),e)&&(hs|=1<<Math.min(fs,31)),fs++,Vs}function zs(e){!function(e,t,n){if(fs>0){var r=e.data[n];ps(e,t,Array.isArray(r)?r:r.update,et()-fs-1,hs)}hs=0,fs=0}(He(),ze(),e+20)}function Hs(e,t,n,r,i){if(e=p(e),Array.isArray(e))for(var o=0;o<e.length;o++)Hs(e[o],t,n,r,i);else{var a=He(),s=ze(),u=Lo(e)?e:p(e.provide),c=Ro(e),l=qe(),h=1048575&l.providerIndexes,f=l.directiveStart,d=l.providerIndexes>>20;if(Lo(e)||!e.multi){var v=new Ot(c,i,aa),g=Ws(u,t,i?h:h+d,f);-1===g?(Vt(Bt(l,s),a,u),Gs(a,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(v),s.push(v)):(n[g]=v,s[g]=v)}else{var y=Ws(u,t,h+d,f),m=Ws(u,t,h,h+d),b=y>=0&&n[y],_=m>=0&&n[m];if(i&&!_||!i&&!b){Vt(Bt(l,s),a,u);var w=function(e,t,n,r,i){var o=new Ot(e,n,aa);return o.multi=[],o.index=t,o.componentProviders=0,qs(o,i,r&&!n),o}(i?Zs:$s,n.length,i,r,c);!i&&_&&(n[m].providerFactory=w),Gs(a,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(w),s.push(w)}else Gs(a,e,y>-1?y:m,qs(n[i?m:y],c,!i&&r));!i&&r&&_&&n[m].componentProviders++}}}function Gs(e,t,n,r){var i=Lo(t);if(i||t.useClass){var o=(t.useClass||t).prototype.ngOnDestroy;if(o){var a=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){var s=a.indexOf(n);-1===s?a.push(n,[r,o]):a[s+1].push(r,o)}else a.push(n,o)}}}function qs(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function Ws(e,t,n,r){for(var i=n;i<r;i++)if(t[i]===e)return i;return-1}function $s(e,t,n,r){return Qs(this.multi,[])}function Zs(e,t,n,r){var i,o=this.multi;if(this.providerFactory){var a=this.providerFactory.componentProviders,s=Qt(n,n[1],this.providerFactory.index,r);Qs(o,i=s.slice(0,a));for(var u=a;u<s.length;u++)i.push(s[u])}else Qs(o,i=[]);return i}function Qs(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function Ys(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=He();if(r.firstCreatePass){var i=ve(e);Hs(n,r.data,r.blueprint,i,!0),Hs(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}}var Ks=function e(){Qp(this,e)},Js=function(){function e(){Qp(this,e)}return Kp(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(l(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),Xs=function(){var e=function e(){Qp(this,e)};return e.NULL=new Js,e}();function eu(){}function tu(e,t){return new ru(Ae(e,t))}var nu=function(){return tu(qe(),ze())},ru=function(){var e=function e(t){Qp(this,e),this.nativeElement=t};return e.__NG_ELEMENT_ID__=nu,e}();function iu(e){return e instanceof ru?e.nativeElement:e}var ou=function e(){Qp(this,e)},au=function(){var e=function e(){Qp(this,e)};return e.__NG_ELEMENT_ID__=function(){return su()},e}(),su=function(){var e=ze(),t=Re(qe().index,e);return function(e){return e[11]}(le(t)?t:e)},uu=function(){var e=function e(){Qp(this,e)};return e.\u0275prov=w({token:e,providedIn:"root",factory:function(){return null}}),e}(),cu=function e(t){Qp(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")},lu=new cu("11.2.14"),hu=function(){function e(){Qp(this,e)}return Kp(e,[{key:"supports",value:function(e){return Zo(e)}},{key:"create",value:function(e){return new du(e)}}]),e}(),fu=function(e,t){return t},du=function(){function e(t){Qp(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||fu}return Kp(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var o=!n||t&&t.currentIndex<yu(n,r,i)?t:n,a=yu(o,r,i),s=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{i||(i=[]);var u=a-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var h=l<i.length?i[l]:i[l]=0,f=h+l;c<=f&&f<u&&(i[l]=h+1)}i[o.previousIndex]=c-u}}a!==s&&e(o,a,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!Zo(e))throw new Error("Error trying to diff '".concat(l(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,o=this._itHead,a=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==o&&Object.is(o.trackById,i)?(a&&(o=this._verifyReinsertion(o,r,i,s)),Object.is(o.item,r)||this._addIdentityChange(o,r)):(o=this._mismatch(o,r,i,s),a=!0),o=o._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[Wo()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==o&&Object.is(o.trackById,i)?(a&&(o=t._verifyReinsertion(o,e,i,n)),Object.is(o.item,e)||t._addIdentityChange(o,e)):(o=t._mismatch(o,e,i,n),a=!0),o=o._next,n++}),this.length=n;return this._truncate(o),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new pu(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new gu),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new gu),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),pu=function e(t,n){Qp(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},vu=function(){function e(){Qp(this,e),this._head=null,this._tail=null}return Kp(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),gu=function(){function e(){Qp(this,e),this.map=new Map}return Kp(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new vu,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function yu(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var mu=function(){function e(){Qp(this,e)}return Kp(e,[{key:"supports",value:function(e){return e instanceof Map||Qo(e)}},{key:"create",value:function(){return new bu}}]),e}(),bu=function(){function e(){Qp(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return Kp(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||Qo(e)))throw new Error("Error trying to diff '".concat(l(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var o=new _u(e);return this._records.set(e,o),o.currentValue=t,this._addToAdditions(o),o}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),_u=function e(t){Qp(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null};function wu(){return new ku([new hu])}var ku=function(){var e=function(){function e(t){Qp(this,e),this.factories=t}return Kp(e,[{key:"find",value:function(e){var t,n=this.factories.find(function(t){return t.supports(e)});if(null!=n)return n;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||wu())},deps:[[e,new Pn,new Sn]]}}}]),e}();return e.\u0275prov=w({token:e,providedIn:"root",factory:wu}),e}();function Cu(){return new Eu([new mu])}var Eu=function(){var e=function(){function e(t){Qp(this,e),this.factories=t}return Kp(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||Cu())},deps:[[e,new Pn,new Sn]]}}}]),e}();return e.\u0275prov=w({token:e,providedIn:"root",factory:Cu}),e}();function Ou(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var o=t[n.index];if(null!==o&&r.push(Ie(o)),he(o))for(var a=10;a<o.length;a++){var s=o[a],u=s[1].firstChild;null!==u&&Ou(s[1],s,u,r)}var c=n.type;if(8&c)Ou(e,t,n.child,r);else if(32&c)for(var l=Ar(n,t),h=void 0;h=l();)r.push(h);else if(16&c){var f=ri(t,n);if(Array.isArray(f))r.push.apply(r,Up(f));else{var d=Nr(t[16]);Ou(d[1],d,f,r,!0)}}n=i?n.projectionNext:n.next}return r}var Su=function(){function e(t,n){Qp(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return Kp(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return Ou(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(he(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&(Vr(e,n),ln(t,n))}this._attachedToViewContainer=!1}zr(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){qi(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){lo(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){ho(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){Je(!0);try{ho(e,t,n)}finally{Je(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,si(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),Pu=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e))._view=e,r}return Kp(n,[{key:"detectChanges",value:function(){fo(this._view)}},{key:"checkNoChanges",value:function(){!function(e){Je(!0);try{fo(e)}finally{Je(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(Su),Iu=Au,Tu=function(){var e=function e(){Qp(this,e)};return e.__NG_ELEMENT_ID__=Iu,e.__ChangeDetectorRef__=!0,e}();function Au(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t,n){if(!n&&de(e)){var r=Re(e.index,t);return new Su(r,r)}return 47&e.type?new Su(t[16],t):null}(qe(),ze(),e)}var Nu=[new mu],xu=new ku([new hu]),Ru=new Eu(Nu),Mu=function(){return Bu(qe(),ze())},Du=function(){var e=function e(){Qp(this,e)};return e.__NG_ELEMENT_ID__=Mu,e}(),Lu=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this))._declarationLView=e,o._declarationTContainer=r,o.elementRef=i,o}return Kp(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=xi(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),Li(t,n,e),new Su(n)}}]),n}(Du);function Bu(e,t){return 4&e.type?new Lu(t,e,tu(e,t)):null}var Fu=function e(){Qp(this,e)},ju=function e(){Qp(this,e)},Uu=function(){return qu(qe(),ze())},Vu=function(){var e=function e(){Qp(this,e)};return e.__NG_ELEMENT_ID__=Uu,e}(),zu=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this))._lContainer=e,o._hostTNode=r,o._hostLView=i,o}return Kp(n,[{key:"element",get:function(){return tu(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new Jt(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=Ut(this._hostTNode,this._hostLView);if(Nt(e)){var t=Rt(e,this._hostLView),n=xt(e);return new Jt(t[1].data[n+8],t)}return new Jt(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=Hu(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var o=n||this.parentInjector;if(!i&&null==e.ngModule&&o){var a=o.get(Fu,null);a&&(i=a)}var s=e.create(o,r,void 0,i);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var r=e._lView,i=r[1];if(he(r[3])){var o=this.indexOf(e);if(-1!==o)this.detach(o);else{var a=r[3],s=new n(a,a[6],a[3]);s.detach(s.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,r){var i=10+r,o=n.length;r>0&&(n[i-1][4]=t),r<o-10?(t[4]=n[i],cn(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;var a=t[17];null!==a&&n!==a&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(a,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,r,c,u);var l=ii(u,c),h=r[11],f=Qr(h,c[7]);return null!==f&&function(e,t,n,r,i,o){r[0]=i,r[6]=t,si(e,r,n,1,i,o)}(i,c[6],h,r,f,l),e.attachToViewContainerRef(),cn(Gu(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=Hu(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=Vr(this._lContainer,t);n&&(ln(Gu(this._lContainer),t),zr(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=Vr(this._lContainer,t);return n&&null!=ln(Gu(this._lContainer),t)?new Su(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==e?this.length+t:e}}]),n}(Vu);function Hu(e){return e[8]}function Gu(e){return e[8]||(e[8]=[])}function qu(e,t){var n,r=t[e.index];if(he(r))n=r;else{var i;if(8&e.type)i=Ie(r);else{var o=t[11];i=o.createComment("");var a=Ae(e,t);Wr(o,Qr(o,a),i,function(e,t){return Se(e)?e.nextSibling(t):t.nextSibling}(o,a),!1)}t[e.index]=n=oo(r,t,i,e),co(t,n)}return new zu(n,e,t)}var Wu={},$u=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this)).ngModule=e,r}return Kp(n,[{key:"resolveComponentFactory",value:function(e){var t=ue(e);return new Yu(t,this.ngModule)}}]),n}(Xs);function Zu(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var Qu=new rn("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return Sr}}),Yu=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(wi).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return Kp(n,[{key:"inputs",get:function(){return Zu(this.componentDef.inputs)}},{key:"outputs",get:function(){return Zu(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,r){var i,o,a=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var o=e.get(n,Wu,i);return o!==Wu||r===Wu?o:t.get(n,r,i)}}}(e,r.injector):e,s=a.get(ou,Pe),u=a.get(uu,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",h=n?function(e,t,n){if(Se(e))return e.selectRootElement(t,n===L.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):jr(s.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),f=this.componentDef.onPush?576:528,d={components:[],scheduler:Sr,clean:vo,playerHandler:null,flags:0},p=Gi(0,null,null,1,0,null,null,null,null,null),v=xi(null,p,d,f,null,null,s,c,u,a);ct(v);try{var g=function(e,t,n,r,i,o){var a=n[1];n[20]=e;var s=Ri(a,20,2,"#host",null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(wo(s,u,!0),null!==e&&(St(i,e,u),null!==s.classes&&li(i,e,s.classes),null!==s.styles&&ci(i,e,s.styles)));var c=r.createRenderer(e,t),l=xi(n,Hi(t),null,t.onPush?64:16,n[20],s,r,c,null,null);return a.firstCreatePass&&(Vt(Bt(s,n),a,t.type),Ki(a,s),Xi(s,n.length,1)),co(n,l),n[20]=l}(h,this.componentDef,v,s,c);if(h)if(n)St(c,h,["ng-version",lu.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var o=e[r];if("string"==typeof o)2===i?""!==o&&t.push(o,e[++r]):8===i&&n.push(o);else{if(!gi(i))break;i=o}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),m=y.attrs,b=y.classes;m&&St(c,h,m),b&&b.length>0&&li(c,h,b.join(" "))}if(o=Ne(p,20),void 0!==t)for(var _=o.projection=[],w=0;w<this.ngContentSelectors.length;w++){var k=t[w];_.push(null!=k?Array.from(k):null)}i=function(e,t,n,r,i){var o=n[1],a=function(e,t,n){var r=qe();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),eo(e,r,t,Di(e,t,1,null),n));var i=Qt(t,e,r.directiveStart,r);Or(i,t);var o=Ae(r,t);return o&&Or(o,t),i}(o,n,t);if(r.components.push(a),e[8]=a,i&&i.forEach(function(e){return e(a,t)}),t.contentQueries){var s=qe();t.contentQueries(1,a,s.directiveStart)}var u=qe();return!o.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(gt(u.index),Qi(n[1],u,0,u.directiveStart,u.directiveEnd,t),Yi(t,a)),a}(g,this.componentDef,v,d,[jo]),Li(p,v,null)}finally{pt()}return new Ku(this.componentType,i,tu(o,v),v,o)}}]),n}(Ks),Ku=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a){var s;return Qp(this,n),(s=t.call(this)).location=i,s._rootLView=o,s._tNode=a,s.instance=r,s.hostView=s.changeDetectorRef=new Pu(o),s.componentType=e,s}return Kp(n,[{key:"injector",get:function(){return new Jt(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return function e(){Qp(this,e)}}()),Ju=new Map,Xu=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;Qp(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=nv(i),i.destroyCbs=[],i.componentFactoryResolver=new $u(nv(i));var o=ce(e),a=e[Q]||null;return a&&ts(a),i._bootstrapComponents=Pr(o.bootstrap),i._r3Injector=Ao(e,r,[{provide:Fu,useValue:nv(i)},{provide:Xs,useValue:i.componentFactoryResolver}],l(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return Kp(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fo.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:N.Default;return e===Fo||e===Fu||e===Co?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(Fu),ec=function(e){Jp(n,e);var t=ev(n);function n(e){var r,i,o;return Qp(this,n),(r=t.call(this)).moduleType=e,null!==ce(e)&&(i=e,o=new Set,function e(t){var n=ce(t,!0),r=n.id;null!==r&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(l(t)," vs ").concat(l(t.name)))}(r,Ju.get(r),t),Ju.set(r,t));var i,a=zp(Pr(n.imports));try{for(a.s();!(i=a.n()).done;){var s=i.value;o.has(s)||(o.add(s),e(s))}}catch(u){a.e(u)}finally{a.f()}}(i)),r}return Kp(n,[{key:"create",value:function(e){return new Xu(this.moduleType,e)}}]),n}(ju);function tc(e,t,n){var r=Xe()+e,i=ze();return i[r]===ki?Yo(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function nc(e,t,n,r){return ac(ze(),Xe(),e,t,n,r)}function rc(e,t,n,r,i){return sc(ze(),Xe(),e,t,n,r,i)}function ic(e,t,n,r,i,o,a){return function(e,t,n,r,i,o,a,s,u){var c=t+n;return function(e,t,n,r,i,o){var a=Jo(e,t,n,r);return Jo(e,t+2,i,o)||a}(e,c,i,o,a,s)?Yo(e,c+4,u?r.call(u,i,o,a,s):r(i,o,a,s)):oc(e,c+4)}(ze(),Xe(),e,t,n,r,i,o,a)}function oc(e,t){var n=e[t];return n===ki?void 0:n}function ac(e,t,n,r,i,o){var a=t+n;return Ko(e,a,i)?Yo(e,a+1,o?r.call(o,i):r(i)):oc(e,a+1)}function sc(e,t,n,r,i,o,a){var s=t+n;return Jo(e,s,i,o)?Yo(e,s+2,a?r.call(a,i,o):r(i,o)):oc(e,s+2)}function uc(e,t){var n,r=He(),i=e+20;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new g("302","The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var o=n.factory||(n.factory=ge(n.type)),a=x(aa);try{var s=Dt(!1),u=o();return Dt(s),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(r,ze(),i,u),u}finally{x(a)}}function cc(e,t,n){var r=e+20,i=ze(),o=xe(i,r);return dc(i,fc(i,r)?ac(i,Xe(),t,o.transform,n,o):o.transform(n))}function lc(e,t,n,r){var i=e+20,o=ze(),a=xe(o,i);return dc(o,fc(o,i)?sc(o,Xe(),t,a.transform,n,r,a):a.transform(n,r))}function hc(e,t,n,r,i){var o=e+20,a=ze(),s=xe(a,o);return dc(a,fc(a,o)?function(e,t,n,r,i,o,a,s){var u=t+n;return Xo(e,u,i,o,a)?Yo(e,u+3,s?r.call(s,i,o,a):r(i,o,a)):oc(e,u+3)}(a,Xe(),t,s.transform,n,r,i,s):s.transform(n,r,i))}function fc(e,t){return e[1].data[t].pure}function dc(e,t){return $o.isWrapped(t)&&(t=$o.unwrap(t),e[et()]=ki),t}function pc(e){return function(t){setTimeout(e,void 0,t)}}var vc=function(e){Jp(n,e);var t=ev(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Qp(this,n),(e=t.call(this)).__isAsync=r,e}return Kp(n,[{key:"emit",value:function(e){$p(iv(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var o,a,s,u=e,c=t||function(){return null},l=r;if(e&&"object"==typeof e){var h=e;u=null===(o=h.next)||void 0===o?void 0:o.bind(h),c=null===(a=h.error)||void 0===a?void 0:a.bind(h),l=null===(s=h.complete)||void 0===s?void 0:s.bind(h)}this.__isAsync&&(c=pc(c),u&&(u=pc(u)),l&&(l=pc(l)));var f=$p(iv(n.prototype),"subscribe",this).call(this,{next:u,error:c,complete:l});return e instanceof i.a&&e.add(f),f}}]),n}(r.a);function gc(){return this._results[Wo()]()}var yc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Qp(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=Wo(),r=e.prototype;r[n]||(r[n]=gc)}return Kp(e,[{key:"changes",get:function(){return this._changes||(this._changes=new vc)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){this.dirty=!1;var n=sn(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],o=t[r];if(n&&(i=n(i),o=n(o)),o!==i)return!1}return!0}(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}},{key:"notifyOnChanges",value:function(){!this._changes||!this._changesDetected&&this._emitDistinctChangesOnly||this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}(),mc=function(){function e(t){Qp(this,e),this.queryList=t,this.matches=null}return Kp(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),bc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Qp(this,e),this.queries=t}return Kp(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[],o=0;o<r;o++){var a=n.getByIndex(o);i.push(this.queries[a.indexInDeclarationView].clone())}return new e(i)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==Rc(e,t).matches&&this.queries[t].setDirty()}}]),e}(),_c=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Qp(this,e),this.predicate=t,this.flags=n,this.read=r},wc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Qp(this,e),this.queries=t}return Kp(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,o=this.getByIndex(r).embeddedTView(t,i);o&&(o.indexInDeclarationView=r,null!==n?n.push(o):n=[o])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),kc=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;Qp(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return Kp(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];this.matchTNodeWithReadOption(e,t,Cc(t,i)),this.matchTNodeWithReadOption(e,t,Zt(t,e,i,!1,!1))}else n===Du?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Zt(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===ru||r===Vu||r===Du&&4&t.type)this.addMatch(t.index,-2);else{var i=Zt(t,e,r,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function Cc(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function Ec(e,t,n,r){return-1===n?function(e,t){return 11&e.type?tu(e,t):4&e.type?Bu(e,t):null}(t,e):-2===n?function(e,t,n){return n===ru?tu(t,e):n===Du?Bu(t,e):n===Vu?qu(t,e):void 0}(e,t,r):Qt(e,e[1],n,t)}function Oc(e,t,n,r){var i=t[19].queries[r];if(null===i.matches){for(var o=e.data,a=n.matches,s=[],u=0;u<a.length;u+=2){var c=a[u];s.push(c<0?null:Ec(t,o[c],a[u+1],n.metadata.read))}i.matches=s}return i.matches}function Sc(e,t,n,r){var i=e.queries.getByIndex(n),o=i.matches;if(null!==o)for(var a=Oc(e,t,i,n),s=0;s<o.length;s+=2){var u=o[s];if(u>0)r.push(a[s/2]);else{for(var c=o[s+1],l=t[-u],h=10;h<l.length;h++){var f=l[h];f[17]===f[3]&&Sc(f[1],f,c,r)}if(null!==l[9])for(var d=l[9],p=0;p<d.length;p++){var v=d[p];Sc(v[1],v,c,r)}}}return r}function Pc(e){var t=ze(),n=He(),r=ot();at(r+1);var i=Rc(n,r);if(e.dirty&&De(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{var o=i.crossesNgTemplate?Sc(n,t,r,[]):Oc(n,t,i,r);e.reset(o,iu),e.notifyOnChanges()}return!0}return!1}function Ic(e,t,n){var r=He();r.firstCreatePass&&(xc(r,new _c(e,t,n),-1),2==(2&t)&&(r.staticViewQueries=!0)),Nc(r,ze(),t)}function Tc(e,t,n,r){var i=He();if(i.firstCreatePass){var o=qe();xc(i,new _c(t,n,r),o.index),function(e,t){var n=e.contentQueries||(e.contentQueries=[]);t!==(n.length?n[n.length-1]:-1)&&n.push(e.queries.length-1,t)}(i,e),2==(2&n)&&(i.staticContentQueries=!0)}Nc(i,ze(),n)}function Ac(){return e=ze(),t=ot(),e[19].queries[t].queryList;var e,t}function Nc(e,t,n){var r=new yc(4==(4&n));qi(e,t,r,r.destroy),null===t[19]&&(t[19]=new bc),t[19].queries.push(new mc(r))}function xc(e,t,n){null===e.queries&&(e.queries=new wc),e.queries.track(new kc(t,n))}function Rc(e,t){return e.queries.getByIndex(t)}function Mc(e,t){return Bu(e,t)}function Dc(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N.Default,t=Au(!0);if(null!=t||e&N.Optional)return t;b("ChangeDetectorRef")}var Lc=new rn("Application Initializer"),Bc=function(){var e=function(){function e(t){var n=this;Qp(this,e),this.appInits=t,this.resolve=eu,this.reject=eu,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return Kp(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=0;r<this.appInits.length;r++){var i=this.appInits[r]();va(i)&&t.push(i)}Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_n(Lc,8))},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e}(),Fc=new rn("AppId"),jc={provide:Fc,useFactory:function(){return"".concat(Uc()).concat(Uc()).concat(Uc())},deps:[]};function Uc(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var Vc=new rn("Platform Initializer"),zc=new rn("Platform ID"),Hc=new rn("appBootstrapListener"),Gc=function(){var e=function(){function e(){Qp(this,e)}return Kp(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e}(),qc=new rn("LocaleId"),Wc=new rn("DefaultCurrencyCode"),$c=function e(t,n){Qp(this,e),this.ngModuleFactory=t,this.componentFactories=n},Zc=function(e){return new ec(e)},Qc=Zc,Yc=function(e){return Promise.resolve(Zc(e))},Kc=function(e){var t=Zc(e),n=Pr(ce(e).declarations).reduce(function(e,t){var n=ue(t);return n&&e.push(new Yu(n)),e},[]);return new $c(t,n)},Jc=Kc,Xc=function(e){return Promise.resolve(Kc(e))},el=function(){var e=function(){function e(){Qp(this,e),this.compileModuleSync=Qc,this.compileModuleAsync=Yc,this.compileModuleAndAllComponentsSync=Jc,this.compileModuleAndAllComponentsAsync=Xc}return Kp(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e}(),tl=Promise.resolve(0);function nl(e){"undefined"==typeof Zone?tl.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var rl=function(){function e(t){var n,r,i=t.enableLongStackTrace,o=void 0!==i&&i,a=t.shouldCoalesceEventChangeDetection,s=void 0!==a&&a,u=t.shouldCoalesceRunChangeDetection,c=void 0!==u&&u;if(Qp(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new vc(!1),this.onMicrotaskEmpty=new vc(!1),this.onStable=new vc(!1),this.onError=new vc(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=!c&&s,this.shouldCoalesceRunChangeDetection=c,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){var e=V.requestAnimationFrame,t=V.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,r=function(){!function(e){-1===e.lastRequestAnimationFrameId&&(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(V,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,al(e),ol(e)},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),al(e))}(n)},(n=this)._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(e,t,i,o,a,s){try{return sl(n),e.invokeTask(i,o,a,s)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&r(),ul(n)}},onInvoke:function(e,t,i,o,a,s,u){try{return sl(n),e.invoke(i,o,a,s,u)}finally{n.shouldCoalesceRunChangeDetection&&r(),ul(n)}},onHasTask:function(e,t,r,i){e.hasTask(r,i),t===r&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,al(n),ol(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:function(e,t,r,i){return e.handleError(r,i),n.runOutsideAngular(function(){return n.onError.emit(i)}),!1}})}return Kp(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,e,il,eu,eu);try{return i.runTask(o,t,n)}finally{i.cancelTask(o)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),il={};function ol(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function al(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function sl(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function ul(e){e._nesting--,ol(e)}var cl=function(){function e(){Qp(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new vc,this.onMicrotaskEmpty=new vc,this.onStable=new vc,this.onError=new vc}return Kp(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),ll=function(){var e=function(){function e(t){var n=this;Qp(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return Kp(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){rl.assertNotInAngularZone(),nl(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())nl(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_n(rl))},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e}(),hl=function(){var e=function(){function e(){Qp(this,e),this._applications=new Map,pl.addToWindow(this)}return Kp(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return pl.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e}();function fl(e){pl=e}var dl,pl=new(function(){function e(){Qp(this,e)}return Kp(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),vl=!0,gl=!1;function yl(){return gl=!0,vl}function ml(){if(gl)throw new Error("Cannot enable prod mode after platform setup.");vl=!1}var bl=new rn("AllowMultipleToken"),_l=function e(t,n){Qp(this,e),this.name=t,this.token=n};function wl(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new rn(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=kl();if(!o||o.injector.get(bl,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var a=n.concat(t).concat({provide:i,useValue:!0},{provide:Oo,useValue:"platform"});!function(e){if(dl&&!dl.destroyed&&!dl.injector.get(bl,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");dl=e.get(Cl);var t=e.get(Vc,null);t&&t.forEach(function(e){return e()})}(Fo.create({providers:a,name:r}))}return function(e){var t=kl();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function kl(){return dl&&!dl.destroyed?dl:null}var Cl=function(){var e=function(){function e(t){Qp(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return Kp(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n,r,i=this,o=(n=t?t.ngZone:void 0,r={ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1},"noop"===n?new cl:("zone.js"===n?void 0:n)||new rl({enableLongStackTrace:yl(),shouldCoalesceEventChangeDetection:!!(null==r?void 0:r.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==r?void 0:r.ngZoneRunCoalescing)})),a=[{provide:rl,useValue:o}];return o.run(function(){var t=Fo.create({providers:a,parent:i.injector,name:e.moduleType.name}),n=e.create(t),r=n.injector.get(kr,null);if(!r)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return o.runOutsideAngular(function(){var e=o.onError.subscribe({next:function(e){r.handleError(e)}});n.onDestroy(function(){Sl(i._modules,n),e.unsubscribe()})}),function(e,t,r){try{var o=((a=n.injector.get(Bc)).runInitializers(),a.donePromise.then(function(){return ts(n.injector.get(qc,"en-US")||"en-US"),i._moduleDoBootstrap(n),n}));return va(o)?o.catch(function(n){throw t.runOutsideAngular(function(){return e.handleError(n)}),n}):o}catch(s){throw t.runOutsideAngular(function(){return e.handleError(s)}),s}var a}(r,o)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=El({},n);return function(e,t,n){var r=new ec(n);return Promise.resolve(r)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(Ol);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(l(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_n(Fo))},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e}();function El(e,t){return Array.isArray(t)?t.reduce(El,e):Object.assign(Object.assign({},e),t)}var Ol=function(){var e=function(){function e(t,n,r,i,u){var c=this;Qp(this,e),this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=u,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){c._zone.run(function(){c.tick()})}});var l=new o.a(function(e){c._stable=c._zone.isStable&&!c._zone.hasPendingMacrotasks&&!c._zone.hasPendingMicrotasks,c._zone.runOutsideAngular(function(){e.next(c._stable),e.complete()})}),h=new o.a(function(e){var t;c._zone.runOutsideAngular(function(){t=c._zone.onStable.subscribe(function(){rl.assertNotInAngularZone(),nl(function(){c._stable||c._zone.hasPendingMacrotasks||c._zone.hasPendingMicrotasks||(c._stable=!0,e.next(!0))})})});var n=c._zone.onUnstable.subscribe(function(){rl.assertInAngularZone(),c._stable&&(c._stable=!1,c._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=Object(a.a)(l,h.pipe(Object(s.a)()))}return Kp(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof Ks?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=n.isBoundToModule?void 0:this._injector.get(Fu),o=n.create(Fo.NULL,[],t||n.selector,i),a=o.location.nativeElement,s=o.injector.get(ll,null),u=s&&o.injector.get(hl);return s&&u&&u.registerApplication(a,s),o.onDestroy(function(){r.detachView(o.hostView),Sl(r.components,o),u&&u.unregisterApplication(a)}),this._loadComponent(o),o}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=zp(this._views);try{for(n.s();!(t=n.n()).done;){t.value.detectChanges()}}catch(r){n.e(r)}finally{n.f()}}catch(i){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(i)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;Sl(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(Hc,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_n(rl),_n(Fo),_n(kr),_n(Xs),_n(Bc))},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e}();function Sl(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var Pl=function e(){Qp(this,e)},Il=function e(){Qp(this,e)},Tl={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},Al=function(){var e=function(){function e(t,n){Qp(this,e),this._compiler=t,this._config=n||Tl}return Kp(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,r=Bp(e.split("#"),2),i=r[0],o=r[1];return void 0===o&&(o="default"),n("zn8P")(i).then(function(e){return e[o]}).then(function(e){return Nl(e,i,o)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=Bp(e.split("#"),2),r=t[0],i=t[1],o="NgFactory";return void 0===i&&(i="default",o=""),n("zn8P")(this._config.factoryPathPrefix+r+this._config.factoryPathSuffix).then(function(e){return e[i+o]}).then(function(e){return Nl(e,r,i)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_n(el),_n(Il,8))},e.\u0275prov=w({token:e,factory:e.\u0275fac}),e}();function Nl(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var xl=function(e){return null},Rl=wl(null,"core",[{provide:zc,useValue:"unknown"},{provide:Cl,deps:[Fo]},{provide:hl,deps:[]},{provide:Gc,deps:[]}]),Ml=[{provide:Ol,useClass:Ol,deps:[rl,Fo,kr,Xs,Bc]},{provide:Qu,deps:[rl],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:Bc,useClass:Bc,deps:[[new Sn,Lc]]},{provide:el,useClass:el,deps:[]},jc,{provide:ku,useFactory:function(){return xu},deps:[]},{provide:Eu,useFactory:function(){return Ru},deps:[]},{provide:qc,useFactory:function(e){return ts(e=e||"undefined"!=typeof $localize&&$localize.locale||"en-US"),e},deps:[[new On(qc),new Sn,new Pn]]},{provide:Wc,useValue:"USD"}],Dl=function(){var e=function e(t){Qp(this,e)};return e.\u0275fac=function(t){return new(t||e)(_n(Ol))},e.\u0275mod=re({type:e}),e.\u0275inj=k({providers:Ml}),e}()},gRHU:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("2fFW"),i=n("NJ4a"),o={closed:!0,next:function(e){},error:function(e){if(r.a.useDeprecatedSynchronousErrorHandling)throw e;Object(i.a)(e)},complete:function(){}}},jZKg:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("HDdC"),i=n("quSY");function o(e,t){return new r.a(function(n){var r=new i.a,o=0;return r.add(t.schedule(function(){o!==e.length?(n.next(e[o++]),n.closed||r.add(this.schedule())):n.complete()})),r})}},kJWO:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="function"==typeof Symbol&&Symbol.observable||"@@observable"},lJxs:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("7o/Q");function i(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new o(e,t))}}var o=function(){function e(t,n){Qp(this,e),this.project=t,this.thisArg=n}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new a(e,this.project,this.thisArg))}}]),e}(),a=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e)).project=r,o.count=0,o.thisArg=i||nv(o),o}return Kp(n,[{key:"_next",value:function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),n}(r.a)},mrSG:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"g",function(){return u}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return l});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}u((r=r.apply(e,t||[])).next())})}function s(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function l(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}},n6bG:function(e,t,n){"use strict";function r(e){return"function"==typeof e}n.d(t,"a",function(){return r})},ngJS:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}}},pxpQ:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return h});var r,i=n("7o/Q"),o=n("EY2u"),a=n("LRne"),s=n("HDdC"),u=((r=function(){function e(t,n,r){Qp(this,e),this.kind=t,this.value=n,this.error=r,this.hasValue="N"===t}return Kp(e,[{key:"observe",value:function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}},{key:"do",value:function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}}},{key:"accept",value:function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)}},{key:"toObservable",value:function(){switch(this.kind){case"N":return Object(a.a)(this.value);case"E":return e=this.error,new s.a(function(t){return t.error(e)});case"C":return Object(o.b)()}var e;throw new Error("unexpected notification kind value")}}],[{key:"createNext",value:function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}},{key:"createError",value:function(t){return new e("E",void 0,t)}},{key:"createComplete",value:function(){return e.completeNotification}}]),e}()).completeNotification=new r("C"),r.undefinedValueNotification=new r("N",void 0),r);function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n){return n.lift(new l(e,t))}}var l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Qp(this,e),this.scheduler=t,this.delay=n}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new h(e,this.scheduler,this.delay))}}]),e}(),h=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Qp(this,n),(i=t.call(this,e)).scheduler=r,i.delay=o,i}return Kp(n,[{key:"scheduleMessage",value:function(e){this.destination.add(this.scheduler.schedule(n.dispatch,this.delay,new f(e,this.destination)))}},{key:"_next",value:function(e){this.scheduleMessage(u.createNext(e))}},{key:"_error",value:function(e){this.scheduleMessage(u.createError(e)),this.unsubscribe()}},{key:"_complete",value:function(){this.scheduleMessage(u.createComplete()),this.unsubscribe()}}],[{key:"dispatch",value:function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()}}]),n}(i.a),f=function e(t,n){Qp(this,e),this.notification=t,this.destination=n}},"q/0M":function(e,t,n){"use strict";function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var i;n.d(t,"a",function(){return a}),n.d(t,"b",function(){return h}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return d});var o=[],a=function(e){return e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",e}({}),s={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},u=a.INFO,c=((i={})[a.DEBUG]="log",i[a.VERBOSE]="log",i[a.INFO]="info",i[a.WARN]="warn",i[a.ERROR]="error",i),l=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(t<e.logLevel)){var o=(new Date).toISOString(),a=c[t];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[a].apply(console,r(["["+o+"]  "+e.name+":"],n))}},h=function(){function e(e){this.name=e,this._logLevel=u,this._logHandler=l,this._userLogHandler=null,o.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in a))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?s[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.DEBUG],e)),this._logHandler.apply(this,r([this,a.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.VERBOSE],e)),this._logHandler.apply(this,r([this,a.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.INFO],e)),this._logHandler.apply(this,r([this,a.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.WARN],e)),this._logHandler.apply(this,r([this,a.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,a.ERROR],e)),this._logHandler.apply(this,r([this,a.ERROR],e))},e}();function f(e){o.forEach(function(t){t.setLogLevel(e)})}function d(e,t){for(var n=function(n){var r=null;t&&t.level&&(r=s[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}}).filter(function(e){return e}).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:a[n].toLowerCase(),message:s,args:i,type:t.name})}},r=0,i=o;r<i.length;r++)n(i[r])}},qOnz:function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"b",function(){return P}),n.d(t,"c",function(){return U}),n.d(t,"d",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"f",function(){return s}),n.d(t,"g",function(){return u}),n.d(t,"h",function(){return D}),n.d(t,"i",function(){return p}),n.d(t,"j",function(){return V}),n.d(t,"k",function(){return h}),n.d(t,"l",function(){return f}),n.d(t,"m",function(){return q}),n.d(t,"n",function(){return Y}),n.d(t,"o",function(){return v}),n.d(t,"p",function(){return M}),n.d(t,"q",function(){return m}),n.d(t,"r",function(){return b}),n.d(t,"s",function(){return w}),n.d(t,"t",function(){return B}),n.d(t,"u",function(){return k}),n.d(t,"v",function(){return g}),n.d(t,"w",function(){return y}),n.d(t,"x",function(){return E}),n.d(t,"y",function(){return _}),n.d(t,"z",function(){return O}),n.d(t,"A",function(){return C}),n.d(t,"B",function(){return R}),n.d(t,"C",function(){return A}),n.d(t,"D",function(){return F}),n.d(t,"E",function(){return j}),n.d(t,"F",function(){return L}),n.d(t,"G",function(){return Q}),n.d(t,"H",function(){return Z}),n.d(t,"I",function(){return N}),n.d(t,"J",function(){return G}),n.d(t,"K",function(){return W}),n.d(t,"L",function(){return $});var r=n("mrSG"),i=function(e,t){if(!e)throw o(t)},o=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},a=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,h=63&c;u||(h=64,a||(l=64)),r.push(n[o>>2],n[(3&o)<<4|s>>4],n[l],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{o=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();r.push(o<<2|a>>4),64!==s&&(r.push(a<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},u=function(e){var t=a(e);return s.encodeByteArray(t,!0)},c=function(e){return u(e).replace(/\./g,"")},l=function(e){try{return s.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function h(e){return f(void 0,e)}function f(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=f(e[n],t[n]));return e}var d=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}},e}();function p(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",i=e.iat||0,o=e.sub||e.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object(r.a)({iss:"https://securetoken.google.com/"+n,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},e);return[c(JSON.stringify({alg:"none",type:"JWT"})),c(JSON.stringify(a)),""].join(".")}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function g(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())}function y(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function m(){return"object"==typeof self&&self.self===self}function b(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function _(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function w(){return v().indexOf("Electron/")>=0}function k(){var e=v();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function C(){return v().indexOf("MSAppHost/")>=0}function E(){return!1}function O(){return!y()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}var S=function(e){function t(n,r,i){var o=e.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,P.prototype.create),o}return Object(r.c)(t,e),t}(Error),P=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?I(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new S(i,s,r);return u},e}();function I(e,t){return e.replace(T,function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"})}var T=/\{\$([^}]+)}/g;function A(e){return JSON.parse(e)}function N(e){return JSON.stringify(e)}var x=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=A(l(o[0])||""),n=A(l(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:t,claims:n,data:r,signature:i}},R=function(e){var t=x(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},M=function(e){var t=x(e).claims;return"object"==typeof t&&!0===t.admin};function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function L(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function B(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function F(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function j(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach(function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];n(o[0],o[1])}return t.length?"&"+t.join("&"):""}var U=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++)n[r]=4294967295&((h=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|h>>>31);var i,o,a=this.chain_[0],s=this.chain_[1],u=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(i=c^s&(u^c),o=1518500249):(i=s^u^c,o=1859775393):r<60?(i=s&u|c&(s|u),o=2400959708):(i=s^u^c,o=3395469782);var h=(a<<5|a>>>27)+i+l+o+n[r]&4294967295;l=c,c=u,u=4294967295&(s<<30|s>>>2),s=a,a=h}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();function V(e,t){var n=new z(e,t);return n.subscribe.bind(n)}var z=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=H),void 0===r.error&&(r.error=H),void 0===r.complete&&(r.complete=H);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}();function H(){}var G=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function q(e,t){return e+" failed: "+t+" argument "}function W(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(q(e,t)+"must be a valid function.")}function $(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(q(e,t)+"must be a valid context object.")}var Z=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o>=55296&&o<=56319){var a=o-55296;r++,i(r<e.length,"Surrogate pair missing trail surrogate."),o=65536+(a<<10)+(e.charCodeAt(r)-56320)}o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):o<65536?(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},Q=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function Y(e){return e&&e._delegate?e._delegate:e}},qgXg:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return Kp(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?$p(iv(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?$p(iv(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0||null===r&&this.delay>0?$p(iv(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(n("3N8a").a),i=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return n}(n("IjjT").a))(r),o=i},quSY:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r,i,o=n("DH7j"),a=n("XoHu"),s=n("n6bG"),u=function(){function e(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),c=((i=function(){function e(t){Qp(this,e),this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return Kp(e,[{key:"unsubscribe",value:function(){var t;if(!this.closed){var n=this._parentOrParents,r=this._ctorUnsubscribe,i=this._unsubscribe,c=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var h=0;h<n.length;++h)n[h].remove(this);if(Object(s.a)(i)){r&&(this._unsubscribe=void 0);try{i.call(this)}catch(v){t=v instanceof u?l(v.errors):[v]}}if(Object(o.a)(c))for(var f=-1,d=c.length;++f<d;){var p=c[f];if(Object(a.a)(p))try{p.unsubscribe()}catch(v){t=t||[],v instanceof u?t=t.concat(l(v.errors)):t.push(v)}}if(t)throw new u(t)}}},{key:"add",value:function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n}},{key:"remove",value:function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}}}]),e}()).EMPTY=((r=new i).closed=!0,r),i);function l(e){return e.reduce(function(e,t){return e.concat(t instanceof u?t.errors:t)},[])}},spgP:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return S}),n.d(t,"b",function(){return b}),n.d(t,"c",function(){return m}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return y}),n.d(t,"f",function(){return E}),n.d(t,"g",function(){return w}),n.d(t,"h",function(){return p}),n.d(t,"i",function(){return g}),n.d(t,"j",function(){return k});var r=n("qgXg"),i=n("D0XW"),o=n("vkgz"),a=n("tf+s"),s=n("pxpQ"),u=n("fXoL"),c=n("Jgta");function l(){}var h=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.b;Qp(this,e),this.zone=t,this.delegate=n}return Kp(e,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(e,t,n){var r=this.zone;return this.delegate.schedule(function(t){var n=this;r.runGuarded(function(){e.apply(n,[t])})},t,n)}}]),e}(),f=function(){function e(t){Qp(this,e),this.zone=t,this.task=null}return Kp(e,[{key:"call",value:function(e,t){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",l,{},l,l)}),t.pipe(Object(o.a)({next:n,complete:n,error:n})).subscribe(e).add(n)}},{key:"unscheduleTask",value:function(){var e=this;setTimeout(function(){null!=e.task&&"scheduled"===e.task.state&&(e.task.invoke(),e.task=null)},10)}}]),e}(),d=function e(t){Qp(this,e),this.ngZone=t,this.outsideAngular=t.runOutsideAngular(function(){return new h(Zone.current)}),this.insideAngular=t.run(function(){return new h(Zone.current,i.a)})};function p(e){return function(t){return(t=t.lift(new f(e.ngZone))).pipe(Object(a.a)(e.outsideAngular),Object(s.b)(e.insideAngular))}}var v=["ngOnDestroy"],g=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Proxy(e,{get:function(i,o){return n.runOutsideAngular(function(){var i;if(e[o])return(null===(i=null==r?void 0:r.spy)||void 0===i?void 0:i.get)&&r.spy.get(o,e[o]),e[o];if(v.indexOf(o)>-1)return function(){};var a=t.toPromise().then(function(e){var t=e&&e[o];return"function"==typeof t?t.bind(e):t&&t.then?t.then(function(e){return n.run(function(){return e})}):n.run(function(){return t})});return new Proxy(function(){},{get:function(e,t){return a[t]},apply:function(e,t,n){return a.then(function(e){var t,i=e&&e.apply(void 0,Up(n));return(null===(t=null==r?void 0:r.spy)||void 0===t?void 0:t.apply)&&r.spy.apply(o,n,i),i})}})})}})},y=function(e,t){t.forEach(function(t){Object.getOwnPropertyNames(t.prototype||t).forEach(function(n){Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t.prototype||t,n))})})},m=new u.r("angularfire2.app.options"),b=new u.r("angularfire2.app.nameOrConfig"),_=new u.P("6.1.5");function w(t,n,r){var i="object"==typeof r&&r||{};i.name=i.name||"string"==typeof r&&r||"[DEFAULT]";var o=c.a.apps.filter(function(e){return e&&e.name===i.name})[0]||n.runOutsideAngular(function(){return c.a.initializeApp(t,i)});try{JSON.stringify(t)!==JSON.stringify(o.options)&&C("error","".concat(o.name," Firebase App already initialized with different options").concat(e.hot?", you may need to reload as Firebase is not HMR aware.":"."))}catch(a){}return o}var k=function(){C("warn","You may need to import 'firebase/auth' manually in your component rather than rely on AngularFireAuth's dynamic import, when using the emulator suite https://github.com/angular/angularfire/issues/2656")},C=function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Object(u.V)()&&"undefined"!=typeof console&&(t=console)[e].apply(t,r)};function E(t,n,r,i,o){var a=Lp(globalThis.\u0275AngularfireInstanceCache.get(t)||[]),s=a[0],u=a.slice(1);if(s){try{o.some(function(e,t){var n=u[t];return e&&"object"==typeof e?JSON.stringify(e)!==JSON.stringify(n):e!==n})&&C("error","".concat(n," was already initialized on the ").concat(r.name," Firebase App instance with different settings.").concat(e.hot?" You may need to reload as Firebase is not HMR aware.":""))}catch(l){}return s}var c=i();return globalThis.\u0275AngularfireInstanceCache.set(t,[c].concat(Up(o))),c}globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=new Map);var O={provide:function e(){Qp(this,e)},useFactory:w,deps:[m,u.A,[new u.B,b]]},S=function(){var e=function(){function e(t){Qp(this,e),c.a.registerVersion("angularfire",_.full,t.toString()),c.a.registerVersion("angular",u.O.full)}return Kp(e,null,[{key:"initializeApp",value:function(t,n){return{ngModule:e,providers:[{provide:m,useValue:t},{provide:b,useValue:n}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(u.Zb(u.C))},e.\u0275mod=u.Jb({type:e}),e.\u0275inj=u.Ib({providers:[O]}),e}()}).call(this,n("3UD+")(e))},"tf+s":function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n("HDdC"),i=1,o=Promise.resolve(),a={};function s(e){return e in a&&(delete a[e],!0)}var u=function(e){var t=i++;return a[t]=!0,o.then(function(){return s(t)&&e()}),t},c=function(e){s(e)},l=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return Kp(n,[{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0?$p(iv(n.prototype),"requestAsyncId",this).call(this,e,t,r):(e.actions.push(this),e.scheduled||(e.scheduled=u(e.flush.bind(e,null))))}},{key:"recycleAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==r&&r>0||null===r&&this.delay>0)return $p(iv(n.prototype),"recycleAsyncId",this).call(this,e,t,r);0===e.actions.length&&(c(t),e.scheduled=void 0)}}]),n}(n("3N8a").a),h=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"flush",value:function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}}}]),n}(n("IjjT").a))(l),f=n("DH7j"),d=function(e){Jp(n,e);var t=ev(n);function n(e){var r,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h;return Qp(this,n),(r=t.call(this)).source=e,r.delayTime=o,r.scheduler=a,i=o,(Object(f.a)(i)||!(i-parseFloat(i)+1>=0)||o<0)&&(r.delayTime=0),a&&"function"==typeof a.schedule||(r.scheduler=h),r}return Kp(n,[{key:"_subscribe",value:function(e){return this.scheduler.schedule(n.dispatch,this.delayTime,{source:this.source,subscriber:e})}}],[{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h;return new n(e,t,r)}},{key:"dispatch",value:function(e){var t=e.source,n=e.subscriber;return this.add(t.subscribe(n))}}]),n}(r.a);function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n){return n.lift(new v(e,t))}}var v=function(){function e(t,n){Qp(this,e),this.scheduler=t,this.delay=n}return Kp(e,[{key:"call",value:function(e,t){return new d(t,this.delay,this.scheduler).subscribe(e)}}]),e}()},vkgz:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("7o/Q");function i(){}var o=n("n6bG");function a(e,t,n){return function(r){return r.lift(new s(e,t,n))}}var s=function(){function e(t,n,r){Qp(this,e),this.nextOrObserver=t,this.error=n,this.complete=r}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new u(e,this.nextOrObserver,this.error,this.complete))}}]),e}(),u=function(e){Jp(n,e);var t=ev(n);function n(e,r,a,s){var u;return Qp(this,n),(u=t.call(this,e))._tapNext=i,u._tapError=i,u._tapComplete=i,u._tapError=a||i,u._tapComplete=s||i,Object(o.a)(r)?(u._context=nv(u),u._tapNext=r):r&&(u._context=r,u._tapNext=r.next||i,u._tapError=r.error||i,u._tapComplete=r.complete||i),u}return Kp(n,[{key:"_next",value:function(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}},{key:"_error",value:function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}]),n}(r.a)},w1tV:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("EQ5u"),i=n("x+ZX"),o=n("XNiG");function a(){return new o.a}function s(){return function(e){return Object(i.a)()((t=a,function(e){var n;n="function"==typeof t?t:function(){return t};var i=Object.create(e,r.b);return i.source=e,i.subjectFactory=n,i})(e));var t}}},"x+ZX":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("7o/Q");function i(){return function(e){return e.lift(new o(e))}}var o=function(){function e(t){Qp(this,e),this.connectable=t}return Kp(e,[{key:"call",value:function(e,t){var n=this.connectable;n._refCount++;var r=new a(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i}}]),e}(),a=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).connectable=r,i}return Kp(n,[{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}]),n}(r.a)},yCtX:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("HDdC"),i=n("ngJS"),o=n("jZKg");function a(e,t){return t?Object(o.a)(e,t):new r.a(Object(i.a)(e))}},"z+Ro":function(e,t,n){"use strict";function r(e){return e&&"function"==typeof e.schedule}n.d(t,"a",function(){return r})},zIRd:function(e,t,n){"use strict";var r,i,o=n("mrSG"),a=n("qOnz"),s=n("/6Yf"),u=n("q/0M"),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),l=new a.b("app","Firebase",c),h=((i={})["@firebase/app"]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/app-check"]="fire-app-check",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),f=new u.b("@firebase/app"),d=function(){function e(e,t,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=Object(a.k)(e),this.container=new s.b(t.name),this._addComponent(new s.a("app",function(){return r},"PUBLIC")),this.firebase_.INTERNAL.components.forEach(function(e){return r._addComponent(e)})}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(t){e.checkDestroyed_(),t()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(e){return e.delete()}))}).then(function(){e.isDeleted_=!0})},e.prototype._getService=function(e,t){var n;void 0===t&&(t="[DEFAULT]"),this.checkDestroyed_();var r=this.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t="[DEFAULT]"),this.container.getProvider(e).clearInstance(t)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){f.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},e}();d.prototype.name&&d.prototype.options||d.prototype.delete||console.log("dc");var p=function e(){var t=function(e){var t={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name="[DEFAULT]");var s=o.name;if("string"!=typeof s||!s)throw l.create("bad-app-name",{appName:String(s)});if(Object(a.h)(t,s))throw l.create("duplicate-app",{appName:s});var u=new e(n,o,r);return t[s]=u,u},app:i,registerVersion:function(e,t,n){var r,i=null!==(r=h[e])&&void 0!==r?r:e;n&&(i+="-"+n);var a=i.match(/\s|\//),u=t.match(/\s|\//);if(a||u){var c=['Unable to register library "'+i+'" with version "'+t+'":'];return a&&c.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&u&&c.push("and"),u&&c.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void f.warn(c.join(" "))}o(new s.a(i+"-version",function(){return{library:i,version:t}},"VERSION"))},setLogLevel:u.c,onLog:function(e,t){if(null!==e&&"function"!=typeof e)throw l.create("invalid-log-argument");Object(u.d)(e,t)},apps:null,SDK_VERSION:"8.10.0",INTERNAL:{registerComponent:o,removeApp:function(e){delete t[e]},components:n,useAsService:function(e,t){return"serverAuth"===t?null:t}}};function i(e){if(e=e||"[DEFAULT]",!Object(a.h)(t,e))throw l.create("no-app",{appName:e});return t[e]}function o(o){var s=o.name;if(n.has(s))return f.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var u=function(e){if(void 0===e&&(e=i()),"function"!=typeof e[s])throw l.create("invalid-app-argument",{appName:s});return e[s]()};void 0!==o.serviceProps&&Object(a.l)(u,o.serviceProps),r[s]=u,e.prototype[s]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getService.bind(this,s).apply(this,o.multipleInstances?e:[])}}for(var c=0,h=Object.keys(t);c<h.length;c++)t[h[c]]._addComponent(o);return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(t).map(function(e){return t[e]})}}),i.App=e,r}(d);return t.INTERNAL=Object(o.a)(Object(o.a)({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Object(a.l)(t,e)},createSubscribe:a.j,ErrorFactory:a.b,deepExtend:a.l}),t}(),v=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return t.library+"/"+t.version}return null}).filter(function(e){return e}).join(" ")},e}();if(Object(a.q)()&&void 0!==self.firebase){f.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var g=self.firebase.SDK_VERSION;g&&g.indexOf("LITE")>=0&&f.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var y=p.initializeApp;p.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(a.w)()&&f.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),y.apply(void 0,e)};var m=p;!function(e,t){e.INTERNAL.registerComponent(new s.a("platform-logger",function(e){return new v(e)},"PRIVATE")),e.registerVersion("@firebase/app","0.6.30",void 0),e.registerVersion("fire-js","")}(m),t.a=m},zUnb:function(Rp,Fp,jp){"use strict";jp.r(Fp);var Vp=jp("fXoL"),Hp=null;function Gp(){return Hp}var Wp,Zp=new Vp.r("DocumentToken"),Yp=((Wp=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||Wp)},Wp.\u0275prov=Object(Vp.Hb)({factory:Xp,token:Wp,providedIn:"platform"}),Wp);function Xp(){return Object(Vp.Zb)(av)}var rv,ov=new Vp.r("Location Initialized"),av=((rv=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this))._doc=e,r._init(),r}return Kp(n,[{key:"_init",value:function(){this.location=Gp().getLocation(),this._history=Gp().getHistory()}},{key:"getBaseHrefFromDOM",value:function(){return Gp().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){Gp().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)}},{key:"onHashChange",value:function(e){Gp().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){sv()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){sv()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"getState",value:function(){return this._history.state}}]),n}(Yp)).\u0275fac=function(e){return new(e||rv)(Vp.Zb(Zp))},rv.\u0275prov=Object(Vp.Hb)({factory:uv,token:rv,providedIn:"platform"}),rv);function sv(){return!!window.history.pushState}function uv(){return new av(Object(Vp.Zb)(Zp))}function cv(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function lv(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function hv(e){return e&&"?"!==e[0]?"?"+e:e}var fv,dv=((fv=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||fv)},fv.\u0275prov=Object(Vp.Hb)({factory:pv,token:fv,providedIn:"root"}),fv);function pv(e){var t=Object(Vp.Zb)(Zp).location;return new bv(Object(Vp.Zb)(Yp),t&&t.origin||"")}var vv,gv,yv,mv=new Vp.r("appBaseHref"),bv=((yv=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;if(Qp(this,n),(i=t.call(this))._platformLocation=e,null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,tv(i)}return Kp(n,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return cv(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+hv(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+hv(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+hv(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),n}(dv)).\u0275fac=function(e){return new(e||yv)(Vp.Zb(Yp),Vp.Zb(mv,8))},yv.\u0275prov=Vp.Hb({token:yv,factory:yv.\u0275fac}),yv),_v=((gv=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this))._platformLocation=e,i._baseHref="",null!=r&&(i._baseHref=r),i}return Kp(n,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=cv(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+hv(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+hv(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),n}(dv)).\u0275fac=function(e){return new(e||gv)(Vp.Zb(Yp),Vp.Zb(mv,8))},gv.\u0275prov=Vp.Hb({token:gv,factory:gv.\u0275fac}),gv),wv=((vv=function(){function e(t,n){var r=this;Qp(this,e),this._subject=new Vp.n,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=lv(Cv(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return Kp(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+hv(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,Cv(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hv(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hv(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}()).\u0275fac=function(e){return new(e||vv)(Vp.Zb(dv),Vp.Zb(Yp))},vv.normalizeQueryParams=hv,vv.joinWithSlash=cv,vv.stripTrailingSlash=lv,vv.\u0275prov=Object(Vp.Hb)({factory:kv,token:vv,providedIn:"root"}),vv);function kv(){return new wv(Object(Vp.Zb)(dv),Object(Vp.Zb)(Yp))}function Cv(e){return e.replace(/\/index.html$/,"")}var Ev=function(e){return e[e.Decimal=0]="Decimal",e[e.Percent=1]="Percent",e[e.Currency=2]="Currency",e[e.Scientific=3]="Scientific",e}({}),Ov=function(e){return e[e.Zero=0]="Zero",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Few=3]="Few",e[e.Many=4]="Many",e[e.Other=5]="Other",e}({}),Sv=function(e){return e[e.Format=0]="Format",e[e.Standalone=1]="Standalone",e}({}),Pv=function(e){return e[e.Narrow=0]="Narrow",e[e.Abbreviated=1]="Abbreviated",e[e.Wide=2]="Wide",e[e.Short=3]="Short",e}({}),Iv=function(e){return e[e.Short=0]="Short",e[e.Medium=1]="Medium",e[e.Long=2]="Long",e[e.Full=3]="Full",e}({}),Tv=function(e){return e[e.Decimal=0]="Decimal",e[e.Group=1]="Group",e[e.List=2]="List",e[e.PercentSign=3]="PercentSign",e[e.PlusSign=4]="PlusSign",e[e.MinusSign=5]="MinusSign",e[e.Exponential=6]="Exponential",e[e.SuperscriptingExponent=7]="SuperscriptingExponent",e[e.PerMille=8]="PerMille",e[e[1/0]=9]="Infinity",e[e.NaN=10]="NaN",e[e.TimeSeparator=11]="TimeSeparator",e[e.CurrencyDecimal=12]="CurrencyDecimal",e[e.CurrencyGroup=13]="CurrencyGroup",e}({});function Av(e,t){return Lv(Object(Vp.kb)(e)[Vp.ab.DateFormat],t)}function Nv(e,t){return Lv(Object(Vp.kb)(e)[Vp.ab.TimeFormat],t)}function xv(e,t){return Lv(Object(Vp.kb)(e)[Vp.ab.DateTimeFormat],t)}function Rv(e,t){var n=Object(Vp.kb)(e),r=n[Vp.ab.NumberSymbols][t];if(void 0===r){if(t===Tv.CurrencyDecimal)return n[Vp.ab.NumberSymbols][Tv.Decimal];if(t===Tv.CurrencyGroup)return n[Vp.ab.NumberSymbols][Tv.Group]}return r}var Mv=Vp.nb;function Dv(e){if(!e[Vp.ab.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[Vp.ab.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function Lv(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function Bv(e){var t=Bp(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var Fv=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,jv={},Uv=/((?:[^GyYMLwWdEabBhHmsSzZO']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,Vv=function(e){return e[e.Short=0]="Short",e[e.ShortGMT=1]="ShortGMT",e[e.Long=2]="Long",e[e.Extended=3]="Extended",e}({}),zv=function(e){return e[e.FullYear=0]="FullYear",e[e.Month=1]="Month",e[e.Date=2]="Date",e[e.Hours=3]="Hours",e[e.Minutes=4]="Minutes",e[e.Seconds=5]="Seconds",e[e.FractionalSeconds=6]="FractionalSeconds",e[e.Day=7]="Day",e}({}),Hv=function(e){return e[e.DayPeriods=0]="DayPeriods",e[e.Days=1]="Days",e[e.Months=2]="Months",e[e.Eras=3]="Eras",e}({});function Gv(e,t,n,r){var i=function(e){if(rg(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){var t=Bp(e.split("-").map(function(e){return+e}),3),n=t[0],r=t[1],i=void 0===r?1:r,o=t[2];return qv(n,i-1,void 0===o?1:o)}var a,s=parseFloat(e);if(!isNaN(e-s))return new Date(s);if(a=e.match(Fv))return function(e){var t=new Date(0),n=0,r=0,i=e[8]?t.setUTCFullYear:t.setFullYear,o=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var a=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return o.call(t,a,s,u,c),t}(a)}var u=new Date(e);if(!rg(u))throw new Error('Unable to convert "'.concat(e,'" into a date'));return u}(e);t=Wv(n,t)||t;for(var o,a=[];t;){if(!(o=Uv.exec(t))){a.push(t);break}var s=(a=a.concat(o.slice(1))).pop();if(!s)break;t=s}var u=i.getTimezoneOffset();r&&(u=ng(r,u),i=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(ng(t,r)-r))}(i,r));var c="";return a.forEach(function(e){var t=function(e){if(tg[e])return tg[e];var t;switch(e){case"G":case"GG":case"GGG":t=Yv(Hv.Eras,Pv.Abbreviated);break;case"GGGG":t=Yv(Hv.Eras,Pv.Wide);break;case"GGGGG":t=Yv(Hv.Eras,Pv.Narrow);break;case"y":t=Qv(zv.FullYear,1,0,!1,!0);break;case"yy":t=Qv(zv.FullYear,2,0,!0,!0);break;case"yyy":t=Qv(zv.FullYear,3,0,!1,!0);break;case"yyyy":t=Qv(zv.FullYear,4,0,!1,!0);break;case"Y":t=eg(1);break;case"YY":t=eg(2,!0);break;case"YYY":t=eg(3);break;case"YYYY":t=eg(4);break;case"M":case"L":t=Qv(zv.Month,1,1);break;case"MM":case"LL":t=Qv(zv.Month,2,1);break;case"MMM":t=Yv(Hv.Months,Pv.Abbreviated);break;case"MMMM":t=Yv(Hv.Months,Pv.Wide);break;case"MMMMM":t=Yv(Hv.Months,Pv.Narrow);break;case"LLL":t=Yv(Hv.Months,Pv.Abbreviated,Sv.Standalone);break;case"LLLL":t=Yv(Hv.Months,Pv.Wide,Sv.Standalone);break;case"LLLLL":t=Yv(Hv.Months,Pv.Narrow,Sv.Standalone);break;case"w":t=Xv(1);break;case"ww":t=Xv(2);break;case"W":t=Xv(1,!0);break;case"d":t=Qv(zv.Date,1);break;case"dd":t=Qv(zv.Date,2);break;case"E":case"EE":case"EEE":t=Yv(Hv.Days,Pv.Abbreviated);break;case"EEEE":t=Yv(Hv.Days,Pv.Wide);break;case"EEEEE":t=Yv(Hv.Days,Pv.Narrow);break;case"EEEEEE":t=Yv(Hv.Days,Pv.Short);break;case"a":case"aa":case"aaa":t=Yv(Hv.DayPeriods,Pv.Abbreviated);break;case"aaaa":t=Yv(Hv.DayPeriods,Pv.Wide);break;case"aaaaa":t=Yv(Hv.DayPeriods,Pv.Narrow);break;case"b":case"bb":case"bbb":t=Yv(Hv.DayPeriods,Pv.Abbreviated,Sv.Standalone,!0);break;case"bbbb":t=Yv(Hv.DayPeriods,Pv.Wide,Sv.Standalone,!0);break;case"bbbbb":t=Yv(Hv.DayPeriods,Pv.Narrow,Sv.Standalone,!0);break;case"B":case"BB":case"BBB":t=Yv(Hv.DayPeriods,Pv.Abbreviated,Sv.Format,!0);break;case"BBBB":t=Yv(Hv.DayPeriods,Pv.Wide,Sv.Format,!0);break;case"BBBBB":t=Yv(Hv.DayPeriods,Pv.Narrow,Sv.Format,!0);break;case"h":t=Qv(zv.Hours,1,-12);break;case"hh":t=Qv(zv.Hours,2,-12);break;case"H":t=Qv(zv.Hours,1);break;case"HH":t=Qv(zv.Hours,2);break;case"m":t=Qv(zv.Minutes,1);break;case"mm":t=Qv(zv.Minutes,2);break;case"s":t=Qv(zv.Seconds,1);break;case"ss":t=Qv(zv.Seconds,2);break;case"S":t=Qv(zv.FractionalSeconds,1);break;case"SS":t=Qv(zv.FractionalSeconds,2);break;case"SSS":t=Qv(zv.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=Kv(Vv.Short);break;case"ZZZZZ":t=Kv(Vv.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=Kv(Vv.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=Kv(Vv.Long);break;default:return null}return tg[e]=t,t}(e);c+=t?t(i,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function qv(e,t,n){var r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function Wv(e,t){var n=function(e){return Object(Vp.kb)(e)[Vp.ab.LocaleId]}(e);if(jv[n]=jv[n]||{},jv[n][t])return jv[n][t];var r="";switch(t){case"shortDate":r=Av(e,Iv.Short);break;case"mediumDate":r=Av(e,Iv.Medium);break;case"longDate":r=Av(e,Iv.Long);break;case"fullDate":r=Av(e,Iv.Full);break;case"shortTime":r=Nv(e,Iv.Short);break;case"mediumTime":r=Nv(e,Iv.Medium);break;case"longTime":r=Nv(e,Iv.Long);break;case"fullTime":r=Nv(e,Iv.Full);break;case"short":var i=Wv(e,"shortTime"),o=Wv(e,"shortDate");r=$v(xv(e,Iv.Short),[i,o]);break;case"medium":var a=Wv(e,"mediumTime"),s=Wv(e,"mediumDate");r=$v(xv(e,Iv.Medium),[a,s]);break;case"long":var u=Wv(e,"longTime"),c=Wv(e,"longDate");r=$v(xv(e,Iv.Long),[u,c]);break;case"full":var l=Wv(e,"fullTime"),h=Wv(e,"fullDate");r=$v(xv(e,Iv.Full),[l,h])}return r&&(jv[n][t]=r),r}function $v(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function Zv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,o=n));for(var a=String(e);a.length<t;)a="0"+a;return r&&(a=a.substr(a.length-t)),o+a}function Qv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(o,a){var s,u=function(e,t){switch(e){case zv.FullYear:return t.getFullYear();case zv.Month:return t.getMonth();case zv.Date:return t.getDate();case zv.Hours:return t.getHours();case zv.Minutes:return t.getMinutes();case zv.Seconds:return t.getSeconds();case zv.FractionalSeconds:return t.getMilliseconds();case zv.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,o);if((n>0||u>-n)&&(u+=n),e===zv.Hours)0===u&&-12===n&&(u=12);else if(e===zv.FractionalSeconds)return s=t,Zv(u,3).substr(0,s);var c=Rv(a,Tv.MinusSign);return Zv(u,t,c,r,i)}}function Yv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Sv.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,o){return function(e,t,n,r,i,o){switch(n){case Hv.Months:return function(e,t,n){var r=Object(Vp.kb)(e),i=Lv([r[Vp.ab.MonthsFormat],r[Vp.ab.MonthsStandalone]],t);return Lv(i,n)}(t,i,r)[e.getMonth()];case Hv.Days:return function(e,t,n){var r=Object(Vp.kb)(e),i=Lv([r[Vp.ab.DaysFormat],r[Vp.ab.DaysStandalone]],t);return Lv(i,n)}(t,i,r)[e.getDay()];case Hv.DayPeriods:var a=e.getHours(),s=e.getMinutes();if(o){var u=function(e){var t=Object(Vp.kb)(e);return Dv(t),(t[Vp.ab.ExtraData][2]||[]).map(function(e){return"string"==typeof e?Bv(e):[Bv(e[0]),Bv(e[1])]})}(t),c=function(e,t,n){var r=Object(Vp.kb)(e);Dv(r);var i=Lv([r[Vp.ab.ExtraData][0],r[Vp.ab.ExtraData][1]],t)||[];return Lv(i,n)||[]}(t,i,r),l=u.findIndex(function(e){if(Array.isArray(e)){var t=Bp(e,2),n=t[0],r=t[1],i=a>=n.hours&&s>=n.minutes,o=a<r.hours||a===r.hours&&s<r.minutes;if(n.hours<r.hours){if(i&&o)return!0}else if(i||o)return!0}else if(e.hours===a&&e.minutes===s)return!0;return!1});if(-1!==l)return c[l]}return function(e,t,n){var r=Object(Vp.kb)(e),i=Lv([r[Vp.ab.DayPeriodsFormat],r[Vp.ab.DayPeriodsStandalone]],t);return Lv(i,n)}(t,i,r)[a<12?0:1];case Hv.Eras:return function(e,t){return Lv(Object(Vp.kb)(e)[Vp.ab.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(i,o,e,t,n,r)}}function Kv(e){return function(t,n,r){var i=-1*r,o=Rv(n,Tv.MinusSign),a=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case Vv.Short:return(i>=0?"+":"")+Zv(a,2,o)+Zv(Math.abs(i%60),2,o);case Vv.ShortGMT:return"GMT"+(i>=0?"+":"")+Zv(a,1,o);case Vv.Long:return"GMT"+(i>=0?"+":"")+Zv(a,2,o)+":"+Zv(Math.abs(i%60),2,o);case Vv.Extended:return 0===r?"Z":(i>=0?"+":"")+Zv(a,2,o)+":"+Zv(Math.abs(i%60),2,o);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function Jv(e){return qv(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function Xv(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i,o,a;if(t){var s=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,u=n.getDate();i=1+Math.floor((u+s)/7)}else{var c=Jv(n),l=(o=c.getFullYear(),a=qv(o,0,1).getDay(),qv(o,0,1+(a<=4?4:11)-a)),h=c.getTime()-l.getTime();i=1+Math.round(h/6048e5)}return Zv(i,e,Rv(r,Tv.MinusSign))}}function eg(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return Zv(Jv(n).getFullYear(),e,Rv(r,Tv.MinusSign),t)}}var tg={};function ng(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function rg(e){return e instanceof Date&&!isNaN(e.valueOf())}var ig=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function og(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var ag,sg=function e(){Qp(this,e)},ug=((ag=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this)).locale=e,r}return Kp(n,[{key:"getPluralCategory",value:function(e,t){switch(Mv(t||this.locale)(e)){case Ov.Zero:return"zero";case Ov.One:return"one";case Ov.Two:return"two";case Ov.Few:return"few";case Ov.Many:return"many";default:return"other"}}}]),n}(sg)).\u0275fac=function(e){return new(e||ag)(Vp.Zb(Vp.v))},ag.\u0275prov=Vp.Hb({token:ag,factory:ag.\u0275fac}),ag);function cg(e,t){t=encodeURIComponent(t);var n,r=zp(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.indexOf("="),a=Bp(-1==o?[i,""]:[i.slice(0,o),i.slice(o+1)],2),s=a[0],u=a[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var lg,hg,fg,dg=((lg=function(){function e(t,n,r,i){Qp(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return Kp(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Object(Vp.qb)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(Object(Vp.wb)(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}()).\u0275fac=function(e){return new(e||lg)(Vp.Lb(Vp.t),Vp.Lb(Vp.u),Vp.Lb(Vp.l),Vp.Lb(Vp.E))},lg.\u0275dir=Vp.Gb({type:lg,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),lg),pg=function(){function e(t,n,r,i){Qp(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return Kp(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),vg=((hg=function(){function e(t,n,r){Qp(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return Kp(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(r){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'. NgFor only supports binding to Iterables such as Arrays."))}}var t;if(this._differ){var n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var o=t._viewContainer.createEmbeddedView(t._template,new pg(null,t._ngForOf,-1,-1),null===i?void 0:i),a=new gg(e,o);n.push(a)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new gg(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,o=this._viewContainer.length;i<o;i++){var a=this._viewContainer.get(i);a.context.index=i,a.context.count=o,a.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}()).\u0275fac=function(e){return new(e||hg)(Vp.Lb(Vp.Q),Vp.Lb(Vp.L),Vp.Lb(Vp.t))},hg.\u0275dir=Vp.Gb({type:hg,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),hg),gg=function e(t,n){Qp(this,e),this.record=t,this.view=n},yg=((fg=function(){function e(t,n){Qp(this,e),this._viewContainer=t,this._context=new mg,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return Kp(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){bg("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){bg("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}()).\u0275fac=function(e){return new(e||fg)(Vp.Lb(Vp.Q),Vp.Lb(Vp.L))},fg.\u0275dir=Vp.Gb({type:fg,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),fg),mg=function e(){Qp(this,e),this.$implicit=null,this.ngIf=null};function bg(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(Object(Vp.wb)(t),"'."))}function _g(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(Object(Vp.wb)(e),"'"))}var wg,kg,Cg,Eg=((Cg=function(){function e(t){Qp(this,e),this.locale=t}return Kp(e,[{key:"transform",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mediumDate",r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(null==t||""===t||t!=t)return null;try{return Gv(t,n,i||this.locale,r)}catch(o){throw _g(e,o.message)}}}]),e}()).\u0275fac=function(e){return new(e||Cg)(Vp.Lb(Vp.v))},Cg.\u0275pipe=Vp.Kb({name:"date",type:Cg,pure:!0}),Cg),Og=((kg=function(){function e(t){Qp(this,e),this._locale=t}return Kp(e,[{key:"transform",value:function(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!1;if(isFinite(e)){var c=function(e){var t,n,r,i,o,a=Math.abs(e)+"",s=0;for((n=a.indexOf("."))>-1&&(a=a.replace(".","")),(r=a.search(/e/i))>0?(n<0&&(n=r),n+=+a.slice(r+1),a=a.substring(0,r)):n<0&&(n=a.length),r=0;"0"===a.charAt(r);r++);if(r===(o=a.length))t=[0],n=1;else{for(o--;"0"===a.charAt(o);)o--;for(n-=r,t=[],i=0;r<=o;r++,i++)t[i]=Number(a.charAt(r))}return n>22&&(t=t.splice(0,21),s=n-1,n=1),{digits:t,exponent:s,integerLen:n}}(e);a&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,h=t.minFrac,f=t.maxFrac;if(o){var d=o.match(ig);if(null===d)throw new Error("".concat(o," is not a valid digit info"));var p=d[1],v=d[3],g=d[5];null!=p&&(l=og(p)),null!=v&&(h=og(v)),null!=g?f=og(g):null!=v&&h>f&&(f=h)}!function(e,t,n){if(t>n)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(n,")."));var r=e.digits,i=r.length-e.integerLen,o=Math.min(Math.max(t,i),n),a=o+e.integerLen,s=r[a];if(a>0){r.splice(Math.max(e.integerLen,a));for(var u=a;u<r.length;u++)r[u]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,a=o+1),r[0]=0;for(var c=1;c<a;c++)r[c]=0}if(s>=5)if(a-1<0){for(var l=0;l>a;l--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[a-1]++;for(;i<Math.max(0,o);i++)r.push(0);var h=0!==o,f=t+e.integerLen,d=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,h&&(0===r[n]&&n>=f?r.pop():h=!1),t>=10?1:0},0);d&&(r.unshift(d),e.integerLen++)}(c,h,f);var y=c.digits,m=c.integerLen,b=c.exponent,_=[];for(u=y.every(function(e){return!e});m<l;m++)y.unshift(0);for(;m<0;m++)y.unshift(0);m>0?_=y.splice(m,y.length):(_=y,y=[0]);var w=[];for(y.length>=t.lgSize&&w.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)w.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&w.unshift(y.join("")),s=w.join(Rv(n,r)),_.length&&(s+=Rv(n,i)+_.join("")),b&&(s+=Rv(n,Tv.Exponential)+"+"+b)}else s=Rv(n,Tv.Infinity);return s=e<0&&!u?t.negPre+s+t.negSuf:t.posPre+s+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],o=r[1],a=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=a[0],u=a[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?n.minFrac=n.maxFrac=c+1:"#"===l?n.maxFrac=c+1:n.posSuf+=l}var h=s.split(",");if(n.gSize=h[1]?h[1].length:0,n.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,o){var f=i.length-n.posPre.length-n.posSuf.length,d=o.indexOf("#");n.negPre=o.substr(0,d).replace(/'/g,""),n.negSuf=o.substr(d+f).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return Object(Vp.kb)(e)[Vp.ab.NumberFormats][t]}(t,Ev.Decimal),Rv(t,Tv.MinusSign)),t,Tv.Group,Tv.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),r,n)}catch(i){throw _g(e,i.message)}}}]),e}()).\u0275fac=function(e){return new(e||kg)(Vp.Lb(Vp.v))},kg.\u0275pipe=Vp.Kb({name:"number",type:kg,pure:!0}),kg),Sg=((wg=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||wg)},wg.\u0275mod=Vp.Jb({type:wg}),wg.\u0275inj=Vp.Ib({providers:[{provide:sg,useClass:ug}]}),wg);function Pg(e){return"server"===e}var Ig,Tg=((Ig=function e(){Qp(this,e)}).\u0275prov=Object(Vp.Hb)({token:Ig,providedIn:"root",factory:function(){return new Ag(Object(Vp.Zb)(Zp),window)}}),Ig),Ag=function(){function e(t,n){Qp(this,e),this.document=t,this.window=n,this.offset=function(){return[0,0]}}return Kp(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;i;){var o=i.shadowRoot;if(o){var a=o.getElementById(t)||o.querySelector('[name="'.concat(t,'"]'));if(a)return a}i=r.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=Ng(this.window.history)||Ng(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(t){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function Ng(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var xg,Rg,Mg,Dg,Lg=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getProperty",value:function(e,t){return e[t]}},{key:"log",value:function(e){window.console&&window.console.log&&window.console.log(e)}},{key:"logGroup",value:function(e){window.console&&window.console.group&&window.console.group(e)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){return e.parentNode&&e.parentNode.removeChild(e),e}},{key:"getValue",value:function(e){return e.value}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(e){var t,n=Bg||(Bg=document.querySelector("base"))?Bg.getAttribute("href"):null;return null==n?null:(t=n,xg||(xg=document.createElement("a")),xg.setAttribute("href",t),"/"===xg.pathname.charAt(0)?xg.pathname:"/"+xg.pathname)}},{key:"resetBaseElement",value:function(){Bg=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(e){return cg(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,Hp||(Hp=e)}}]),n}(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.call(this)}return Kp(n,[{key:"supportsDOMEvents",value:function(){return!0}}]),n}(function(){return function e(){Qp(this,e)}}())),Bg=null,Fg=new Vp.r("TRANSITION_ID"),jg=[{provide:Vp.d,useFactory:function(e,t,n){return function(){n.get(Vp.e).donePromise.then(function(){var n=Gp();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter(function(t){return t.getAttribute("ng-transition")===e}).forEach(function(e){return n.remove(e)})})}},deps:[Fg,Zp,Vp.s],multi:!0}],Ug=function(){function e(){Qp(this,e)}return Kp(e,[{key:"addToWindow",value:function(e){Vp.pb.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Vp.pb.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Vp.pb.getAllAngularRootElements=function(){return e.getAllRootElements()},Vp.pb.frameworkStabilizers||(Vp.pb.frameworkStabilizers=[]),Vp.pb.frameworkStabilizers.push(function(e){var t=Vp.pb.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){if(null==t)return null;var r=e.getTestability(t);return null!=r?r:n?Gp().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){Object(Vp.X)(new e)}}]),e}(),Vg=new Vp.r("EventManagerPlugins"),zg=((Rg=function(){function e(t,n){var r=this;Qp(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return Kp(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}()).\u0275fac=function(e){return new(e||Rg)(Vp.Zb(Vg),Vp.Zb(Vp.A))},Rg.\u0275prov=Vp.Hb({token:Rg,factory:Rg.\u0275fac}),Rg),Hg=function(){function e(t){Qp(this,e),this._doc=t}return Kp(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=Gp().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),Gg=((Dg=function(){function e(){Qp(this,e),this._stylesSet=new Set}return Kp(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}()).\u0275fac=function(e){return new(e||Dg)},Dg.\u0275prov=Vp.Hb({token:Dg,factory:Dg.\u0275fac}),Dg),qg=((Mg=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Map,r._hostNodes.set(e.head,[]),r}return Kp(n,[{key:"_addStylesToHost",value:function(e,t,n){var r=this;e.forEach(function(e){var i=r._doc.createElement("style");i.textContent=e,n.push(t.appendChild(i))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(Wg),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n,r){t._addStylesToHost(e,r,n)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(Wg)})}}]),n}(Gg)).\u0275fac=function(e){return new(e||Mg)(Vp.Zb(Zp))},Mg.\u0275prov=Vp.Hb({token:Mg,factory:Mg.\u0275fac}),Mg);function Wg(e){Gp().remove(e)}var $g={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Zg=/%COMP%/g;function Qg(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?Qg(e,i,n):(i=i.replace(Zg,e),n.push(i))}return n}function Yg(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var Kg,Jg,Xg,ey,ty,ny,ry=((Kg=function(){function e(t,n,r){Qp(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new iy(t)}return Kp(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Vp.R.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new oy(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case Vp.R.ShadowDom:return new ay(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=Qg(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Kg)(Vp.Zb(zg),Vp.Zb(qg),Vp.Zb(Vp.c))},Kg.\u0275prov=Vp.Hb({token:Kg,factory:Kg.\u0275fac}),Kg),iy=function(){function e(t){Qp(this,e),this.eventManager=t,this.data=Object.create(null)}return Kp(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS($g[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=$g[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=$g[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&(Vp.G.DashCase|Vp.G.Important)?e.style.setProperty(t,n,r&Vp.G.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&Vp.G.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Yg(n)):this.eventManager.addEventListener(e,t,Yg(n))}}]),e}(),oy=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;Qp(this,n),(a=t.call(this,e)).component=i;var s=Qg(o+"-"+i.id,i.styles,[]);return r.addStyles(s),a.contentAttr="_ngcontent-%COMP%".replace(Zg,o+"-"+i.id),a.hostAttr="_nghost-%COMP%".replace(Zg,o+"-"+i.id),a}return Kp(n,[{key:"applyToHost",value:function(e){$p(iv(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=$p(iv(n.prototype),"createElement",this).call(this,e,t);return $p(iv(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(iy),ay=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;Qp(this,n),(a=t.call(this,e)).sharedStylesHost=r,a.hostEl=i,a.shadowRoot=i.attachShadow({mode:"open"}),a.sharedStylesHost.addHost(a.shadowRoot);for(var s=Qg(o.id,o.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],a.shadowRoot.appendChild(c)}return a}return Kp(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return $p(iv(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return $p(iv(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return $p(iv(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot($p(iv(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(iy),sy=((Jg=function(e){Jp(n,e);var t=ev(n);function n(e){return Qp(this,n),t.call(this,e)}return Kp(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(Hg)).\u0275fac=function(e){return new(e||Jg)(Vp.Zb(Zp))},Jg.\u0275prov=Vp.Hb({token:Jg,factory:Jg.\u0275fac}),Jg),uy=["alt","control","meta","shift"],cy={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ly={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},hy={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},fy=((ty=function(e){Jp(n,e);var t=ev(n);function n(e){return Qp(this,n),t.call(this,e)}return Kp(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),o=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return Gp().onAndCancel(e,i.domEventName,o)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),o="";if(uy.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),o+=e+".")}),o+=i,0!=t.length||0===i.length)return null;var a={};return a.domEventName=r,a.fullKey=o,a}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&ly.hasOwnProperty(t)&&(t=ly[t]))}return cy[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),uy.forEach(function(r){r!=n&&(0,hy[r])(e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded(function(){return t(i)})}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),n}(Hg)).\u0275fac=function(e){return new(e||ty)(Vp.Zb(Zp))},ty.\u0275prov=Vp.Hb({token:ty,factory:ty.\u0275fac}),ty),dy=((ey=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||ey)},ey.\u0275prov=Object(Vp.Hb)({factory:function(){return Object(Vp.Zb)(py)},token:ey,providedIn:"root"}),ey),py=((Xg=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this))._doc=e,r}return Kp(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case Vp.I.NONE:return t;case Vp.I.HTML:return Object(Vp.eb)(t,"HTML")?Object(Vp.xb)(t):Object(Vp.cb)(this._doc,String(t)).toString();case Vp.I.STYLE:return Object(Vp.eb)(t,"Style")?Object(Vp.xb)(t):t;case Vp.I.SCRIPT:if(Object(Vp.eb)(t,"Script"))return Object(Vp.xb)(t);throw new Error("unsafe value used in a script context");case Vp.I.URL:return Object(Vp.ob)(t),Object(Vp.eb)(t,"URL")?Object(Vp.xb)(t):Object(Vp.db)(String(t));case Vp.I.RESOURCE_URL:if(Object(Vp.eb)(t,"ResourceURL"))return Object(Vp.xb)(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return Object(Vp.fb)(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return Object(Vp.ib)(e)}},{key:"bypassSecurityTrustScript",value:function(e){return Object(Vp.hb)(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return Object(Vp.jb)(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return Object(Vp.gb)(e)}}]),n}(dy)).\u0275fac=function(e){return new(e||Xg)(Vp.Zb(Zp))},Xg.\u0275prov=Object(Vp.Hb)({factory:function(){return e=Object(Vp.Zb)(Vp.o),new py(e.get(Zp));var e},token:Xg,providedIn:"root"}),Xg),vy=[{provide:Vp.C,useValue:"browser"},{provide:Vp.D,useValue:function(){Lg.makeCurrent(),Ug.init()},multi:!0},{provide:Zp,useFactory:function(){return Object(Vp.vb)(document),document},deps:[]}],gy=Object(Vp.S)(Vp.W,"browser",vy),yy=[[],{provide:Vp.Z,useValue:"root"},{provide:Vp.m,useFactory:function(){return new Vp.m},deps:[]},{provide:Vg,useClass:sy,multi:!0,deps:[Zp,Vp.A,Vp.C]},{provide:Vg,useClass:fy,multi:!0,deps:[Zp]},[],{provide:ry,useClass:ry,deps:[zg,qg,Vp.c]},{provide:Vp.F,useExisting:ry},{provide:Gg,useExisting:qg},{provide:qg,useClass:qg,deps:[Zp]},{provide:Vp.M,useClass:Vp.M,deps:[Vp.A]},{provide:zg,useClass:zg,deps:[Vg,Vp.A]},[]],my=((ny=function(){function e(t){if(Qp(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return Kp(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:Vp.c,useValue:t.appId},{provide:Fg,useExisting:Vp.c},jg]}}}]),e}()).\u0275fac=function(e){return new(e||ny)(Vp.Zb(ny,12))},ny.\u0275mod=Vp.Jb({type:ny}),ny.\u0275inj=Vp.Ib({providers:yy,imports:[Sg,Vp.f]}),ny);"undefined"!=typeof window&&window;var by=jp("Cfvw"),_y=jp("HDdC"),wy=jp("DH7j"),ky=jp("lJxs"),Cy=jp("XoHu");function Ey(e,t){return new _y.a(function(n){var r=e.length;if(0!==r)for(var i=new Array(r),o=0,a=0,s=function(s){var u=Object(by.a)(e[s]),c=!1;n.add(u.subscribe({next:function(e){c||(c=!0,a++),i[s]=e},error:function(e){return n.error(e)},complete:function(){++o!==r&&c||(a===r&&n.next(t?t.reduce(function(e,t,n){return e[t]=i[n],e},{}):i),n.complete())}}))},u=0;u<r;u++)s(u);else n.complete()})}var Oy,Sy=function e(){Qp(this,e)},Py=new Vp.r("NgValueAccessor"),Iy={provide:Py,useExisting:Object(Vp.U)(function(){return Ay}),multi:!0},Ty=new Vp.r("CompositionEventMode"),Ay=((Oy=function(){function e(t,n,r){var i;Qp(this,e),this._renderer=t,this._elementRef=n,this._compositionMode=r,this.onChange=function(e){},this.onTouched=function(){},this._composing=!1,null==this._compositionMode&&(this._compositionMode=(i=Gp()?Gp().getUserAgent():"",!/android (\d+)/.test(i.toLowerCase())))}return Kp(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),e}()).\u0275fac=function(e){return new(e||Oy)(Vp.Lb(Vp.E),Vp.Lb(Vp.l),Vp.Lb(Ty,8))},Oy.\u0275dir=Vp.Gb({type:Oy,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&Vp.cc("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[Vp.Ab([Iy])]}),Oy);function Ny(e){return null==e||0===e.length}function xy(e){return null!=e&&"number"==typeof e.length}var Ry=new Vp.r("NgValidators"),My=new Vp.r("NgAsyncValidators"),Dy=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Ly=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"min",value:function(e){return function(e){return function(t){if(Ny(t.value)||Ny(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}(e)}},{key:"max",value:function(e){return function(e){return function(t){if(Ny(t.value)||Ny(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}(e)}},{key:"required",value:function(e){return By(e)}},{key:"requiredTrue",value:function(e){return function(e){return!0===e.value?null:{required:!0}}(e)}},{key:"email",value:function(e){return function(e){return Ny(e.value)||Dy.test(e.value)?null:{email:!0}}(e)}},{key:"minLength",value:function(e){return function(e){return function(t){return Ny(t.value)||!xy(t.value)?null:t.value.length<e?{minlength:{requiredLength:e,actualLength:t.value.length}}:null}}(e)}},{key:"maxLength",value:function(e){return Fy(e)}},{key:"pattern",value:function(e){return function(e){return e?("string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),function(e){if(Ny(e.value))return null;var r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}):jy;var t,n}(e)}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){return qy(e)}},{key:"composeAsync",value:function(e){return $y(e)}}]),e}();function By(e){return Ny(e.value)?{required:!0}:null}function Fy(e){return function(t){return xy(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}}function jy(e){return null}function Uy(e){return null!=e}function Vy(e){var t=Object(Vp.sb)(e)?Object(by.a)(e):e;return Object(Vp.rb)(t),t}function zy(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function Hy(e,t){return t.map(function(t){return t(e)})}function Gy(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function qy(e){if(!e)return null;var t=e.filter(Uy);return 0==t.length?null:function(e){return zy(Hy(e,t))}}function Wy(e){return null!=e?qy(Gy(e)):null}function $y(e){if(!e)return null;var t=e.filter(Uy);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length){var r=t[0];if(Object(wy.a)(r))return Ey(r,null);if(Object(Cy.a)(r)&&Object.getPrototypeOf(r)===Object.prototype){var i=Object.keys(r);return Ey(i.map(function(e){return r[e]}),i)}}if("function"==typeof t[t.length-1]){var o=t.pop();return Ey(t=1===t.length&&Object(wy.a)(t[0])?t[0]:t,null).pipe(Object(ky.a)(function(e){return o.apply(void 0,Up(e))}))}return Ey(t,null)}(Hy(e,t).map(Vy)).pipe(Object(ky.a)(zy))}}function Zy(e){return null!=e?$y(Gy(e)):null}function Qy(e,t){return null===e?[t]:Array.isArray(e)?[].concat(Up(e),[t]):[e,t]}function Yy(e){return e._rawValidators}function Ky(e){return e._rawAsyncValidators}var Jy,Xy,em,tm,nm=((Xy=function(){function e(){Qp(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return Kp(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=Wy(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Zy(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}()).\u0275fac=function(e){return new(e||Xy)},Xy.\u0275dir=Vp.Gb({type:Xy}),Xy),rm=((Jy=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(nm)).\u0275fac=function(e){return im(e||Jy)},Jy.\u0275dir=Vp.Gb({type:Jy,features:[Vp.yb]}),Jy),im=Vp.Sb(rm),om=function(e){Jp(n,e);var t=ev(n);function n(){var e;return Qp(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return n}(nm),am=function(){function e(t){Qp(this,e),this._cd=t}return Kp(e,[{key:"is",value:function(e){var t,n;return!!(null===(n=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===n?void 0:n[e])}}]),e}(),sm=((tm=function(e){Jp(n,e);var t=ev(n);function n(e){return Qp(this,n),t.call(this,e)}return n}(am)).\u0275fac=function(e){return new(e||tm)(Vp.Lb(om,2))},tm.\u0275dir=Vp.Gb({type:tm,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&Vp.Db("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[Vp.yb]}),tm),um=((em=function(e){Jp(n,e);var t=ev(n);function n(e){return Qp(this,n),t.call(this,e)}return n}(am)).\u0275fac=function(e){return new(e||em)(Vp.Lb(rm,10))},em.\u0275dir=Vp.Gb({type:em,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(e,t){2&e&&Vp.Db("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[Vp.yb]}),em);function cm(e,t){return[].concat(Up(t.path),[e])}function lm(e,t){dm(e,t,!0),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&vm(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&vm(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function hm(e,t){var n=function(){};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),pm(e,t,!0),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(function(){}))}function fm(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function dm(e,t,n){var r=Yy(e);null!==t.validator?e.setValidators(Qy(r,t.validator)):"function"==typeof r&&e.setValidators([r]);var i=Ky(e);if(null!==t.asyncValidator?e.setAsyncValidators(Qy(i,t.asyncValidator)):"function"==typeof i&&e.setAsyncValidators([i]),n){var o=function(){return e.updateValueAndValidity()};fm(t._rawValidators,o),fm(t._rawAsyncValidators,o)}}function pm(e,t,n){var r=!1;if(null!==e){if(null!==t.validator){var i=Yy(e);if(Array.isArray(i)&&i.length>0){var o=i.filter(function(e){return e!==t.validator});o.length!==i.length&&(r=!0,e.setValidators(o))}}if(null!==t.asyncValidator){var a=Ky(e);if(Array.isArray(a)&&a.length>0){var s=a.filter(function(e){return e!==t.asyncValidator});s.length!==a.length&&(r=!0,e.setAsyncValidators(s))}}}if(n){var u=function(){};fm(t._rawValidators,u),fm(t._rawAsyncValidators,u)}return r}function vm(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function gm(e,t){dm(e,t,!1)}function ym(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function mm(e,t){e._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function bm(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===Ay?n=e:Object.getPrototypeOf(e.constructor)===Sy?r=e:i=e}),i||r||n||null):null;var n,r,i}function _m(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}function wm(e){return(Om(e)?e.validators:e)||null}function km(e){return Array.isArray(e)?Wy(e):e||null}function Cm(e,t){return(Om(t)?t.asyncValidators:e)||null}function Em(e){return Array.isArray(e)?Zy(e):e||null}function Om(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var Sm,Pm,Im,Tm,Am,Nm,xm,Rm=function(){function e(t,n){Qp(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=km(this._rawValidators),this._composedAsyncValidatorFn=Em(this._rawAsyncValidators)}return Kp(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return"VALID"===this.status}},{key:"invalid",get:function(){return"INVALID"===this.status}},{key:"pending",get:function(){return"PENDING"==this.status}},{key:"disabled",get:function(){return"DISABLED"===this.status}},{key:"enabled",get:function(){return"DISABLED"!==this.status}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=km(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=Em(e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status="PENDING",!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="VALID",this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status="PENDING",this._hasOwnPendingAsyncValidator=!0;var n=Vy(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t)return null;if(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length)return null;var r=e;return t.forEach(function(e){r=r instanceof Dm?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof Lm&&r.at(e)||null}),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new Vp.n,this.statusChanges=new Vp.n}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){Om(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),Mm=function(e){Jp(n,e);var t=ev(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return Qp(this,n),(e=t.call(this,wm(i),Cm(o,i)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(i),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!o}),e}return Kp(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){_m(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){_m(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(Rm),Dm=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,wm(r),Cm(i,r))).controls=e,o._initObservables(),o._setUpdateStrategy(r),o._setUpControls(),o.updateValueAndValidity({onlySelf:!0,emitEvent:!!i}),o}return Kp(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"removeControl",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof Mm?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var r=t.controls[n];r&&e(r,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var r=n[t],i=this.controls[r];if(this.contains(r)&&e(i))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(Rm),Lm=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,wm(r),Cm(i,r))).controls=e,o._initObservables(),o._setUpdateStrategy(r),o._setUpControls(),o.updateValueAndValidity({onlySelf:!0,emitEvent:!!i}),o}return Kp(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"insert",value:function(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}},{key:"removeAt",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof Mm?e.value:e.getRawValue()})}},{key:"clear",value:function(){this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity())}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=zp(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(Rm),Bm={provide:rm,useExisting:Object(Vp.U)(function(){return jm})},Fm=Promise.resolve(null),jm=((Sm=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new Vp.n,i.form=new Dm({},Wy(e),Zy(r)),i}return Kp(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;Fm.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),lm(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;Fm.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),_m(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;Fm.then(function(){var n=t._findContainer(e.path),r=new Dm({});gm(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;Fm.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;Fm.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,mm(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(rm)).\u0275fac=function(e){return new(e||Sm)(Vp.Lb(Ry,10),Vp.Lb(My,10))},Sm.\u0275dir=Vp.Gb({type:Sm,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&Vp.cc("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Vp.Ab([Bm]),Vp.yb]}),Sm),Um={provide:om,useExisting:Object(Vp.U)(function(){return zm})},Vm=Promise.resolve(null),zm=((Tm=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this)).control=new Mm,a._registered=!1,a.update=new Vp.n,a._parent=e,a._setValidators(r),a._setAsyncValidators(i),a.valueAccessor=bm(0,o),a}return Kp(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),ym(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?cm(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){lm(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;Vm.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;Vm.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}}]),n}(om)).\u0275fac=function(e){return new(e||Tm)(Vp.Lb(rm,9),Vp.Lb(Ry,10),Vp.Lb(My,10),Vp.Lb(Py,10))},Tm.\u0275dir=Vp.Gb({type:Tm,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Vp.Ab([Um]),Vp.yb,Vp.zb]}),Tm),Hm=((Im=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||Im)},Im.\u0275dir=Vp.Gb({type:Im,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),Im),Gm=((Pm=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||Pm)},Pm.\u0275mod=Vp.Jb({type:Pm}),Pm.\u0275inj=Vp.Ib({}),Pm),qm={provide:Py,useExisting:Object(Vp.U)(function(){return Wm}),multi:!0},Wm=((Am=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this))._renderer=e,i._elementRef=r,i.onChange=function(e){},i.onTouched=function(){},i}return Kp(n,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),n}(Sy)).\u0275fac=function(e){return new(e||Am)(Vp.Lb(Vp.E),Vp.Lb(Vp.l))},Am.\u0275dir=Vp.Gb({type:Am,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&Vp.cc("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[Vp.Ab([qm]),Vp.yb]}),Am),$m=new Vp.r("NgModelWithFormControlWarning"),Zm={provide:rm,useExisting:Object(Vp.U)(function(){return Qm})},Qm=((Nm=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this)).validators=e,i.asyncValidators=r,i.submitted=!1,i._onCollectionChange=function(){return i._updateDomValue()},i.directives=[],i.form=null,i.ngSubmit=new Vp.n,i._setValidators(e),i._setAsyncValidators(r),i}return Kp(n,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}},{key:"ngOnDestroy",value:function(){this.form&&(pm(this.form,this,!1),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(function(){}))}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return lm(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){hm(e.control||null,e,!1),_m(this.directives,e)}},{key:"addFormGroup",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormGroup",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormArray",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,mm(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach(function(t){var n=t.control,r=e.form.get(t.path);n!==r&&(hm(n||null,t),r instanceof Mm&&(lm(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_setUpFormContainer",value:function(e){var t=this.form.get(e.path);gm(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"_cleanUpFormContainer",value:function(e){if(this.form){var t=this.form.get(e.path);t&&function(e,t){return pm(e,t,!1)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}},{key:"_updateRegistrations",value:function(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(function(){})}},{key:"_updateValidators",value:function(){dm(this.form,this,!1),this._oldForm&&pm(this._oldForm,this,!1)}},{key:"_checkFormPresent",value:function(){}}]),n}(rm)).\u0275fac=function(e){return new(e||Nm)(Vp.Lb(Ry,10),Vp.Lb(My,10))},Nm.\u0275dir=Vp.Gb({type:Nm,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&Vp.cc("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Vp.Ab([Zm]),Vp.yb,Vp.zb]}),Nm),Ym={provide:om,useExisting:Object(Vp.U)(function(){return Km})},Km=((xm=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a){var s;return Qp(this,n),(s=t.call(this))._ngModelWarningConfig=a,s._added=!1,s.update=new Vp.n,s._ngModelWarningSent=!1,s._parent=e,s._setValidators(r),s._setAsyncValidators(i),s.valueAccessor=bm(0,o),s}return Kp(n,[{key:"isDisabled",set:function(e){}},{key:"ngOnChanges",value:function(e){this._added||this._setUpControl(),ym(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"path",get:function(){return cm(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"_checkParentType",value:function(){}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}]),n}(om)).\u0275fac=function(e){return new(e||xm)(Vp.Lb(rm,13),Vp.Lb(Ry,10),Vp.Lb(My,10),Vp.Lb(Py,10),Vp.Lb($m,8))},xm.\u0275dir=Vp.Gb({type:xm,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Vp.Ab([Ym]),Vp.yb,Vp.zb]}),xm._ngModelWarningSentOnce=!1,xm),Jm={provide:Py,useExisting:Object(Vp.U)(function(){return nb}),multi:!0};function Xm(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var eb,tb,nb=((tb=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this))._renderer=e,i._elementRef=r,i._optionMap=new Map,i._idCounter=0,i.onChange=function(e){},i.onTouched=function(){},i._compareWith=Object.is,i}return Kp(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);var n=Xm(t,e);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(Sy)).\u0275fac=function(e){return new(e||tb)(Vp.Lb(Vp.E),Vp.Lb(Vp.l))},tb.\u0275dir=Vp.Gb({type:tb,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&Vp.cc("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[Vp.Ab([Jm]),Vp.yb]}),tb),rb=((eb=function(){function e(t,n,r){Qp(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return Kp(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(Xm(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}()).\u0275fac=function(e){return new(e||eb)(Vp.Lb(Vp.l),Vp.Lb(Vp.E),Vp.Lb(nb,9))},eb.\u0275dir=Vp.Gb({type:eb,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),eb),ib={provide:Py,useExisting:Object(Vp.U)(function(){return pb}),multi:!0};function ob(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var ab,sb,ub,cb,lb,hb,fb,db,pb=((sb=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this))._renderer=e,i._elementRef=r,i._optionMap=new Map,i._idCounter=0,i.onChange=function(e){},i.onTouched=function(){},i._compareWith=Object.is,i}return Kp(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(void 0!==n.selectedOptions)for(var i=n.selectedOptions,o=0;o<i.length;o++){var a=i.item(o),s=t._getOptionValue(a.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var h=t._getOptionValue(l.value);r.push(h)}}t.value=r,e(r)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(Sy)).\u0275fac=function(e){return new(e||sb)(Vp.Lb(Vp.E),Vp.Lb(Vp.l))},sb.\u0275dir=Vp.Gb({type:sb,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&Vp.cc("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[Vp.Ab([ib]),Vp.yb]}),sb),vb=((ab=function(){function e(t,n,r){Qp(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return Kp(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(ob(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(ob(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}()).\u0275fac=function(e){return new(e||ab)(Vp.Lb(Vp.l),Vp.Lb(Vp.E),Vp.Lb(pb,9))},ab.\u0275dir=Vp.Gb({type:ab,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),ab),gb={provide:Ry,useExisting:Object(Vp.U)(function(){return yb}),multi:!0},yb=((ub=function(){function e(){Qp(this,e),this._required=!1}return Kp(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?By(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}()).\u0275fac=function(e){return new(e||ub)},ub.\u0275dir=Vp.Gb({type:ub,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&Vp.Cb("required",t.required?"":null)},inputs:{required:"required"},features:[Vp.Ab([gb])]}),ub),mb={provide:Ry,useExisting:Object(Vp.U)(function(){return bb}),multi:!0},bb=((db=function(){function e(){Qp(this,e),this._validator=jy}return Kp(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return null!=this.maxlength?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){this._validator=Fy("number"==typeof this.maxlength?this.maxlength:parseInt(this.maxlength,10))}}]),e}()).\u0275fac=function(e){return new(e||db)},db.\u0275dir=Vp.Gb({type:db,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&Vp.Cb("maxlength",t.maxlength?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Vp.Ab([mb]),Vp.zb]}),db),_b=((fb=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||fb)},fb.\u0275mod=Vp.Jb({type:fb}),fb.\u0275inj=Vp.Ib({imports:[[Gm]]}),fb),wb=((hb=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||hb)},hb.\u0275mod=Vp.Jb({type:hb}),hb.\u0275inj=Vp.Ib({imports:[_b]}),hb),kb=((lb=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:$m,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}()).\u0275fac=function(e){return new(e||lb)},lb.\u0275mod=Vp.Jb({type:lb}),lb.\u0275inj=Vp.Ib({imports:[_b]}),lb),Cb=((cb=function(){function e(){Qp(this,e)}return Kp(e,[{key:"group",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),i=null,o=null;return null!=n&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(n)?(i=null!=n.validators?n.validators:null,o=null!=n.asyncValidators?n.asyncValidators:null,t=null!=n.updateOn?n.updateOn:void 0):(i=null!=n.validator?n.validator:null,o=null!=n.asyncValidator?n.asyncValidator:null)),new Dm(r,{asyncValidators:o,updateOn:t,validators:i})}},{key:"control",value:function(e,t,n){return new Mm(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map(function(e){return r._createControl(e)});return new Lm(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._createControl(e[r])}),n}},{key:"_createControl",value:function(e){return e instanceof Mm||e instanceof Dm||e instanceof Lm?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}()).\u0275fac=function(e){return new(e||cb)},cb.\u0275prov=Object(Vp.Hb)({factory:function(){return new cb},token:cb,providedIn:kb}),cb),Eb=jp("LRne"),Ob=jp("5+tZ");function Sb(e,t){return Object(Ob.a)(e,t,1)}var Pb=jp("7o/Q");function Ib(e,t){return function(n){return n.lift(new Tb(e,t))}}var Tb=function(){function e(t,n){Qp(this,e),this.predicate=t,this.thisArg=n}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new Ab(e,this.predicate,this.thisArg))}}]),e}(),Ab=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e)).predicate=r,o.thisArg=i,o.count=0,o}return Kp(n,[{key:"_next",value:function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}]),n}(Pb.a),Nb=function e(){Qp(this,e)},xb=function e(){Qp(this,e)},Rb=function(){function e(t){var n=this;Qp(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),o=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(o):n.headers.set(i,[o])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return Kp(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,Up(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var o=this.headers.get(t);if(!o)return;0===(o=o.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),Mb=function(){function e(){Qp(this,e)}return Kp(e,[{key:"encodeKey",value:function(e){return Db(e)}},{key:"encodeValue",value:function(e){return Db(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}();function Db(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}var Lb=function(){function e(){var t,n,r,i=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Qp(this,e),this.updates=null,this.cloneFrom=null,this.encoder=o.encoder||new Mb,o.fromString){if(o.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=(t=o.fromString,n=this.encoder,r=new Map,t.length>0&&t.replace(/^\?/,"").split("&").forEach(function(e){var t=e.indexOf("="),i=Bp(-1==t?[n.decodeKey(e),""]:[n.decodeKey(e.slice(0,t)),n.decodeValue(e.slice(t+1))],2),o=i[0],a=i[1],s=r.get(o)||[];s.push(a),r.set(o,s)}),r)}else o.fromObject?(this.map=new Map,Object.keys(o.fromObject).forEach(function(e){var t=o.fromObject[e];i.map.set(e,Array.isArray(t)?t:[t])})):this.map=null}return Kp(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(t.value),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(t.value);-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}();function Bb(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function Fb(e){return"undefined"!=typeof Blob&&e instanceof Blob}function jb(e){return"undefined"!=typeof FormData&&e instanceof FormData}var Ub=function(){function e(t,n,r,i){var o;if(Qp(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.params&&(this.params=o.params)),this.headers||(this.headers=new Rb),this.params){var a=this.params.toString();if(0===a.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+a}}else this.params=new Lb,this.urlWithParams=n}return Kp(e,[{key:"serializeBody",value:function(){return null===this.body?null:Bb(this.body)||Fb(this.body)||jb(this.body)||"string"==typeof this.body?this.body:this.body instanceof Lb?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||jb(this.body)?null:Fb(this.body)?this.body.type||null:Bb(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Lb?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.method||this.method,r=t.url||this.url,i=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,a=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress,u=t.headers||this.headers,c=t.params||this.params;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce(function(e,n){return e.set(n,t.setHeaders[n])},u)),t.setParams&&(c=Object.keys(t.setParams).reduce(function(e,n){return e.set(n,t.setParams[n])},c)),new e(n,r,o,{params:c,headers:u,reportProgress:s,responseType:i,withCredentials:a})}}]),e}(),Vb=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}({}),zb=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";Qp(this,e),this.headers=t.headers||new Rb,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300},Hb=function(e){Jp(n,e);var t=ev(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Qp(this,n),(e=t.call(this,r)).type=Vb.ResponseHeader,e}return Kp(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(zb),Gb=function(e){Jp(n,e);var t=ev(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Qp(this,n),(e=t.call(this,r)).type=Vb.Response,e.body=void 0!==r.body?r.body:null,e}return Kp(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(zb),qb=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return n}(zb);function Wb(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var $b,Zb,Qb,Yb,Kb,Jb,Xb,e_,t_,n_=(($b=function(){function e(t){Qp(this,e),this.handler=t}return Kp(e,[{key:"request",value:function(e,t){var n,r,i,o=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof Ub?n=e:(r=a.headers instanceof Rb?a.headers:new Rb(a.headers),a.params&&(i=a.params instanceof Lb?a.params:new Lb({fromObject:a.params})),n=new Ub(e,t,void 0!==a.body?a.body:null,{headers:r,params:i,reportProgress:a.reportProgress,responseType:a.responseType||"json",withCredentials:a.withCredentials}));var s=Object(Eb.a)(n).pipe(Sb(function(e){return o.handler.handle(e)}));if(e instanceof Ub||"events"===a.observe)return s;var u=s.pipe(Ib(function(e){return e instanceof Gb}));switch(a.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(Object(ky.a)(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(Object(ky.a)(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(Object(ky.a)(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));case"json":default:return u.pipe(Object(ky.a)(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(a.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new Lb).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,Wb(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,Wb(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,Wb(n,t))}}]),e}()).\u0275fac=function(e){return new(e||$b)(Vp.Zb(Nb))},$b.\u0275prov=Vp.Hb({token:$b,factory:$b.\u0275fac}),$b),r_=function(){function e(t,n){Qp(this,e),this.next=t,this.interceptor=n}return Kp(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),i_=new Vp.r("HTTP_INTERCEPTORS"),o_=((Zb=function(){function e(){Qp(this,e)}return Kp(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||Zb)},Zb.\u0275prov=Vp.Hb({token:Zb,factory:Zb.\u0275fac}),Zb),a_=/^\)\]\}',?\n/,s_=function e(){Qp(this,e)},u_=((Yb=function(){function e(){Qp(this,e)}return Kp(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}()).\u0275fac=function(e){return new(e||Yb)},Yb.\u0275prov=Vp.Hb({token:Yb,factory:Yb.\u0275fac}),Yb),c_=((Qb=function(){function e(t){Qp(this,e),this.xhrFactory=t}return Kp(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new _y.a(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var o=e.responseType.toLowerCase();r.responseType="json"!==o?o:"text"}var a=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new Rb(r.getAllResponseHeaders()),o=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new Hb({headers:i,status:t,statusText:n,url:o})},c=function(){var t=u(),i=t.headers,o=t.status,a=t.statusText,s=t.url,c=null;204!==o&&(c=void 0===r.response?r.responseText:r.response),0===o&&(o=c?200:0);var l=o>=200&&o<300;if("json"===e.responseType&&"string"==typeof c){var h=c;c=c.replace(a_,"");try{c=""!==c?JSON.parse(c):null}catch(f){c=h,l&&(l=!1,c={error:f,text:c})}}l?(n.next(new Gb({body:c,headers:i,status:o,statusText:a,url:s||void 0})),n.complete()):n.error(new qb({error:c,headers:i,status:o,statusText:a,url:s||void 0}))},l=function(e){var t=u().url,i=new qb({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},h=!1,f=function(t){h||(n.next(u()),h=!0);var i={type:Vb.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:Vb.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),r.addEventListener("timeout",l),r.addEventListener("abort",l),e.reportProgress&&(r.addEventListener("progress",f),null!==a&&r.upload&&r.upload.addEventListener("progress",d)),r.send(a),n.next({type:Vb.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("abort",l),r.removeEventListener("load",c),r.removeEventListener("timeout",l),e.reportProgress&&(r.removeEventListener("progress",f),null!==a&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}()).\u0275fac=function(e){return new(e||Qb)(Vp.Zb(s_))},Qb.\u0275prov=Vp.Hb({token:Qb,factory:Qb.\u0275fac}),Qb),l_=new Vp.r("XSRF_COOKIE_NAME"),h_=new Vp.r("XSRF_HEADER_NAME"),f_=function e(){Qp(this,e)},d_=((t_=function(){function e(t,n,r){Qp(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return Kp(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=cg(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}()).\u0275fac=function(e){return new(e||t_)(Vp.Zb(Zp),Vp.Zb(Vp.C),Vp.Zb(l_))},t_.\u0275prov=Vp.Hb({token:t_,factory:t_.\u0275fac}),t_),p_=((e_=function(){function e(t,n){Qp(this,e),this.tokenService=t,this.headerName=n}return Kp(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null===r||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||e_)(Vp.Zb(f_),Vp.Zb(h_))},e_.\u0275prov=Vp.Hb({token:e_,factory:e_.\u0275fac}),e_),v_=((Xb=function(){function e(t,n){Qp(this,e),this.backend=t,this.injector=n,this.chain=null}return Kp(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(i_,[]);this.chain=t.reduceRight(function(e,t){return new r_(e,t)},this.backend)}return this.chain.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||Xb)(Vp.Zb(xb),Vp.Zb(Vp.s))},Xb.\u0275prov=Vp.Hb({token:Xb,factory:Xb.\u0275fac}),Xb),g_=((Jb=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:p_,useClass:o_}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:l_,useValue:t.cookieName}:[],t.headerName?{provide:h_,useValue:t.headerName}:[]]}}}]),e}()).\u0275fac=function(e){return new(e||Jb)},Jb.\u0275mod=Vp.Jb({type:Jb}),Jb.\u0275inj=Vp.Ib({providers:[p_,{provide:i_,useExisting:p_,multi:!0},{provide:f_,useClass:d_},{provide:l_,useValue:"XSRF-TOKEN"},{provide:h_,useValue:"X-XSRF-TOKEN"}]}),Jb),y_=((Kb=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||Kb)},Kb.\u0275mod=Vp.Jb({type:Kb}),Kb.\u0275inj=Vp.Ib({providers:[n_,{provide:Nb,useClass:v_},c_,{provide:xb,useExisting:c_},u_,{provide:s_,useExisting:u_}],imports:[[g_.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),Kb),m_=jp("XNiG"),b_=jp("9ppp"),__=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this))._value=e,r}return Kp(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=$p(iv(n.prototype),"_subscribe",this).call(this,e);return t&&!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new b_.a;return this._value}},{key:"next",value:function(e){$p(iv(n.prototype),"next",this).call(this,this._value=e)}}]),n}(m_.a),w_=jp("z+Ro"),k_=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"notifyNext",value:function(e,t,n,r,i){this.destination.next(t)}},{key:"notifyError",value:function(e,t){this.destination.error(e)}},{key:"notifyComplete",value:function(e){this.destination.complete()}}]),n}(Pb.a),C_=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this)).parent=e,o.outerValue=r,o.outerIndex=i,o.index=0,o}return Kp(n,[{key:"_next",value:function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}},{key:"_error",value:function(e){this.parent.notifyError(e,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),n}(Pb.a),E_=jp("SeVD");function O_(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new C_(e,n,r);if(!i.closed)return t instanceof _y.a?t.subscribe(i):Object(E_.a)(t)(i)}var S_=jp("yCtX"),P_={},I_=function(){function e(t){Qp(this,e),this.resultSelector=t}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new T_(e,this.resultSelector))}}]),e}(),T_=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).resultSelector=r,i.active=0,i.values=[],i.observables=[],i}return Kp(n,[{key:"_next",value:function(e){this.values.push(P_),this.observables.push(e)}},{key:"_complete",value:function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++)this.add(O_(this,e[n],void 0,n))}}},{key:"notifyComplete",value:function(e){0==(this.active-=1)&&this.destination.complete()}},{key:"notifyNext",value:function(e,t,n){var r=this.values,i=this.toRespond?r[n]===P_?--this.toRespond:this.toRespond:0;r[n]=t,0===i&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}},{key:"_tryResultSelector",value:function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),n}(k_),A_=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),N_=jp("bHdf");function x_(){return Object(N_.a)(1)(Object(Eb.a).apply(void 0,arguments))}var R_=jp("EY2u");function M_(e){return new _y.a(function(t){var n;try{n=e()}catch(r){return void t.error(r)}return(n?Object(by.a)(n):Object(R_.b)()).subscribe(t)})}var D_=jp("EQ5u"),L_=jp("zx2A");function B_(e,t){return"function"==typeof t?function(n){return n.pipe(B_(function(n,r){return Object(by.a)(e(n,r)).pipe(Object(ky.a)(function(e,i){return t(n,e,r,i)}))}))}:function(t){return t.lift(new F_(e))}}var F_=function(){function e(t){Qp(this,e),this.project=t}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new j_(e,this.project))}}]),e}(),j_=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).project=r,i.index=0,i}return Kp(n,[{key:"_next",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this._innerSub(t)}},{key:"_innerSub",value:function(e){var t=this.innerSubscription;t&&t.unsubscribe();var n=new L_.a(this),r=this.destination;r.add(n),this.innerSubscription=Object(L_.c)(e,n),this.innerSubscription!==n&&r.add(this.innerSubscription)}},{key:"_complete",value:function(){var e=this.innerSubscription;e&&!e.closed||$p(iv(n.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=void 0}},{key:"notifyComplete",value:function(){this.innerSubscription=void 0,this.isStopped&&$p(iv(n.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(e){this.destination.next(e)}}]),n}(L_.b),U_=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}();function V_(e){return function(t){return 0===e?Object(R_.b)():t.lift(new z_(e))}}var z_=function(){function e(t){if(Qp(this,e),this.total=t,this.total<0)throw new U_}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new H_(e,this.total))}}]),e}(),H_=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).total=r,i.count=0,i}return Kp(n,[{key:"_next",value:function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))}}]),n}(Pb.a);function G_(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[t.length-1];return Object(w_.a)(r)?(t.pop(),function(e){return x_(t,e,r)}):function(e){return x_(t,e)}}function q_(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new W_(e,t,n))}}var W_=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Qp(this,e),this.accumulator=t,this.seed=n,this.hasSeed=r}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new $_(e,this.accumulator,this.seed,this.hasSeed))}}]),e}(),$_=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this,e)).accumulator=r,a._seed=i,a.hasSeed=o,a.index=0,a}return Kp(n,[{key:"seed",get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e}},{key:"_next",value:function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(r){this.destination.error(r)}this.seed=t,this.destination.next(t)}}]),n}(Pb.a);function Z_(e){return function(t){var n=new Q_(e),r=t.lift(n);return n.caught=r}}var Q_=function(){function e(t){Qp(this,e),this.selector=t}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new Y_(e,this.selector,this.caught))}}]),e}(),Y_=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e)).selector=r,o.caught=i,o}return Kp(n,[{key:"error",value:function(e){if(!this.isStopped){var t;try{t=this.selector(e,this.caught)}catch(o){return void $p(iv(n.prototype),"error",this).call(this,o)}this._unsubscribeAndRecycle();var r=new L_.a(this);this.add(r);var i=Object(L_.c)(t,r);i!==r&&this.add(i)}}}]),n}(L_.b);function K_(e){return function(t){return 0===e?Object(R_.b)():t.lift(new J_(e))}}var J_=function(){function e(t){if(Qp(this,e),this.total=t,this.total<0)throw new U_}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new X_(e,this.total))}}]),e}(),X_=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).total=r,i.ring=new Array,i.count=0,i}return Kp(n,[{key:"_next",value:function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e}},{key:"_complete",value:function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=t++%n;e.next(r[o])}e.complete()}}]),n}(Pb.a);function ew(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rw;return function(t){return t.lift(new tw(e))}}var tw=function(){function e(t){Qp(this,e),this.errorFactory=t}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new nw(e,this.errorFactory))}}]),e}(),nw=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).errorFactory=r,i.hasValue=!1,i}return Kp(n,[{key:"_next",value:function(e){this.hasValue=!0,this.destination.next(e)}},{key:"_complete",value:function(){if(this.hasValue)return this.destination.complete();var e;try{e=this.errorFactory()}catch(fV){e=fV}this.destination.error(e)}}]),n}(Pb.a);function rw(){return new A_}function iw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){return t.lift(new ow(e))}}var ow=function(){function e(t){Qp(this,e),this.defaultValue=t}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new aw(e,this.defaultValue))}}]),e}(),aw=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).defaultValue=r,i.isEmpty=!0,i}return Kp(n,[{key:"_next",value:function(e){this.isEmpty=!1,this.destination.next(e)}},{key:"_complete",value:function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}]),n}(Pb.a),sw=jp("SpAZ");function uw(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Ib(function(t,n){return e(t,n,r)}):sw.a,V_(1),n?iw(t):ew(function(){return new A_}))}}var cw=jp("vkgz"),lw=jp("x+ZX"),hw=jp("quSY"),fw=function(){function e(t){Qp(this,e),this.callback=t}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new dw(e,this.callback))}}]),e}(),dw=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).add(new hw.a(r)),i}return n}(Pb.a),pw=function e(t,n){Qp(this,e),this.id=t,this.url=n},vw=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Qp(this,n),(i=t.call(this,e,r)).navigationTrigger=o,i.restoredState=a,i}return Kp(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(pw),gw=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o}return Kp(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(pw),yw=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e,r)).reason=i,o}return Kp(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(pw),mw=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e,r)).error=i,o}return Kp(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(pw),bw=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a.state=o,a}return Kp(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(pw),_w=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a.state=o,a}return Kp(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(pw),ww=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a){var s;return Qp(this,n),(s=t.call(this,e,r)).urlAfterRedirects=i,s.state=o,s.shouldActivate=a,s}return Kp(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(pw),kw=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a.state=o,a}return Kp(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(pw),Cw=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a.state=o,a}return Kp(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(pw),Ew=function(){function e(t){Qp(this,e),this.route=t}return Kp(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),Ow=function(){function e(t){Qp(this,e),this.route=t}return Kp(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),Sw=function(){function e(t){Qp(this,e),this.snapshot=t}return Kp(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Pw=function(){function e(t){Qp(this,e),this.snapshot=t}return Kp(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Iw=function(){function e(t){Qp(this,e),this.snapshot=t}return Kp(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Tw=function(){function e(t){Qp(this,e),this.snapshot=t}return Kp(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Aw=function(){function e(t,n,r){Qp(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return Kp(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),Nw=function(){function e(t){Qp(this,e),this.params=t||{}}return Kp(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function xw(e){return new Nw(e)}function Rw(e){var t=Error("NavigationCancelingError: "+e);return t.ngNavigationCancelingError=!0,t}function Mw(e,t,n){var r=n.path.split("/");if(r.length>e.length)return null;if("full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},o=0;o<r.length;o++){var a=r[o],s=e[o];if(a.startsWith(":"))i[a.substring(1)]=s;else if(a!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function Dw(e,t){var n,r=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!r||!i||r.length!=i.length)return!1;for(var o=0;o<r.length;o++)if(!Lw(e[n=r[o]],t[n]))return!1;return!0}function Lw(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=Up(e).sort(),r=Up(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function Bw(e){return Array.prototype.concat.apply([],e)}function Fw(e){return e.length>0?e[e.length-1]:null}function jw(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function Uw(e){return Object(Vp.rb)(e)?e:Object(Vp.sb)(e)?Object(by.a)(Promise.resolve(e)):Object(Eb.a)(e)}function Vw(e,t,n){return n?function(e,t){return Dw(e,t)}(e.queryParams,t.queryParams)&&zw(e.root,t.root):function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return Lw(e[n],t[n])})}(e.queryParams,t.queryParams)&&Hw(e.root,t.root)}function zw(e,t){if(!Zw(e.segments,t.segments))return!1;if(e.numberOfChildren!==t.numberOfChildren)return!1;for(var n in t.children){if(!e.children[n])return!1;if(!zw(e.children[n],t.children[n]))return!1}return!0}function Hw(e,t){return Gw(e,t,t.segments)}function Gw(e,t,n){if(e.segments.length>n.length)return!!Zw(e.segments.slice(0,n.length),n)&&!t.hasChildren();if(e.segments.length===n.length){if(!Zw(e.segments,n))return!1;for(var r in t.children){if(!e.children[r])return!1;if(!Hw(e.children[r],t.children[r]))return!1}return!0}var i=n.slice(0,e.segments.length),o=n.slice(e.segments.length);return!!Zw(e.segments,i)&&!!e.children.primary&&Gw(e.children.primary,t,o)}var qw=function(){function e(t,n,r){Qp(this,e),this.root=t,this.queryParams=n,this.fragment=r}return Kp(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=xw(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return Kw.serialize(this)}}]),e}(),Ww=function(){function e(t,n){var r=this;Qp(this,e),this.segments=t,this.children=n,this.parent=null,jw(n,function(e,t){return e.parent=r})}return Kp(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return Jw(this)}}]),e}(),$w=function(){function e(t,n){Qp(this,e),this.path=t,this.parameters=n}return Kp(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=xw(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return ok(this)}}]),e}();function Zw(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}var Qw=function e(){Qp(this,e)},Yw=function(){function e(){Qp(this,e)}return Kp(e,[{key:"parse",value:function(e){var t=new lk(e);return new qw(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,n,r;return"/".concat(Xw(e.root,!0)).concat((n=e.queryParams,r=Object.keys(n).map(function(e){var t=n[e];return Array.isArray(t)?t.map(function(t){return"".concat(tk(e),"=").concat(tk(t))}).join("&"):"".concat(tk(e),"=").concat(tk(t))}),r.length?"?".concat(r.join("&")):"")).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),Kw=new Yw;function Jw(e){return e.segments.map(function(e){return ok(e)}).join("/")}function Xw(e,t){if(!e.hasChildren())return Jw(e);if(t){var n=e.children.primary?Xw(e.children.primary,!1):"",r=[];return jw(e.children,function(e,t){"primary"!==t&&r.push("".concat(t,":").concat(Xw(e,!1)))}),r.length>0?"".concat(n,"(").concat(r.join("//"),")"):n}var i=function(e,t){var n=[];return jw(e.children,function(e,r){"primary"===r&&(n=n.concat(t(e,r)))}),jw(e.children,function(e,r){"primary"!==r&&(n=n.concat(t(e,r)))}),n}(e,function(t,n){return"primary"===n?[Xw(e.children.primary,!1)]:["".concat(n,":").concat(Xw(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children.primary?"".concat(Jw(e),"/").concat(i[0]):"".concat(Jw(e),"/(").concat(i.join("//"),")")}function ek(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function tk(e){return ek(e).replace(/%3B/gi,";")}function nk(e){return ek(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function rk(e){return decodeURIComponent(e)}function ik(e){return rk(e.replace(/\+/g,"%20"))}function ok(e){return"".concat(nk(e.path)).concat((t=e.parameters,Object.keys(t).map(function(e){return";".concat(nk(e),"=").concat(nk(t[e]))}).join("")));var t}var ak=/^[^\/()?;=#]+/;function sk(e){var t=e.match(ak);return t?t[0]:""}var uk=/^[^=?&#]+/,ck=/^[^?&#]+/,lk=function(){function e(t){Qp(this,e),this.url=t,this.remaining=t}return Kp(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ww([],{}):new Ww([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n.primary=new Ww(e,t)),n}},{key:"parseSegment",value:function(){var e=sk(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new $w(rk(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=sk(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=sk(this.remaining);r&&(n=r,this.capture(n))}e[rk(t)]=rk(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(uk);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(ck);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=ik(t),o=ik(n);if(e.hasOwnProperty(i)){var a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(o)}else e[i]=o}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=sk(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i="primary");var o=this.parseChildren();t[i]=1===Object.keys(o).length?o.primary:new Ww([],o),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),hk=function(){function e(t){Qp(this,e),this._root=t}return Kp(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=fk(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=fk(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=dk(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return dk(e,this._root).map(function(e){return e.value})}}]),e}();function fk(e,t){if(e===t.value)return t;var n,r=zp(t.children);try{for(r.s();!(n=r.n()).done;){var i=fk(e,n.value);if(i)return i}}catch(o){r.e(o)}finally{r.f()}return null}function dk(e,t){if(e===t.value)return[t];var n,r=zp(t.children);try{for(r.s();!(n=r.n()).done;){var i=dk(e,n.value);if(i.length)return i.unshift(t),i}}catch(o){r.e(o)}finally{r.f()}return[]}var pk=function(){function e(t,n){Qp(this,e),this.value=t,this.children=n}return Kp(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function vk(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var gk=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).snapshot=r,kk(nv(i),e),i}return Kp(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(hk);function yk(e,t){var n=function(e,t){var n=new _k([],{},{},"",{},"primary",t,null,e.root,-1,{});return new wk("",new pk(n,[]))}(e,t),r=new __([new $w("",{})]),i=new __({}),o=new __({}),a=new __({}),s=new __(""),u=new mk(r,i,a,s,o,"primary",t,n.root);return u.snapshot=n.root,new gk(new pk(u,[]),n)}var mk=function(){function e(t,n,r,i,o,a,s,u){Qp(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=s,this._futureSnapshot=u}return Kp(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(Object(ky.a)(function(e){return xw(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Object(ky.a)(function(e){return xw(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function bk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],o=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(o.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var _k=function(){function e(t,n,r,i,o,a,s,u,c,l,h){Qp(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=a,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=h}return Kp(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=xw(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=xw(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),wk=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,r)).url=e,kk(nv(i),r),i}return Kp(n,[{key:"toString",value:function(){return Ck(this._root)}}]),n}(hk);function kk(e,t){t.value._routerState=e,t.children.forEach(function(t){return kk(e,t)})}function Ck(e){var t=e.children.length>0?" { ".concat(e.children.map(Ck).join(", ")," } "):"";return"".concat(e.value).concat(t)}function Ek(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,Dw(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),Dw(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!Dw(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),Dw(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function Ok(e,t){return Dw(e.params,t.params)&&function(e,t){return Zw(e,t)&&e.every(function(e,n){return Dw(e.parameters,t[n].parameters)})}(e.url,t.url)&&!(!e.parent!=!t.parent)&&(!e.parent||Ok(e.parent,t.parent))}function Sk(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){var r=n.value;r._futureSnapshot=t.value;var i=function(e,t,n){return t.children.map(function(t){var r,i=zp(n.children);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(e.shouldReuseRoute(t.value,o.value.snapshot))return Sk(e,t,o)}}catch(a){i.e(a)}finally{i.f()}return Sk(e,t)})}(e,t,n);return new pk(r,i)}if(e.shouldAttach(t.value)){var o=e.retrieve(t.value);if(null!==o){var a=o.route;return Pk(t,a),a}}var s,u=new mk(new __((s=t.value).url),new __(s.params),new __(s.queryParams),new __(s.fragment),new __(s.data),s.outlet,s.component,s),c=t.children.map(function(t){return Sk(e,t)});return new pk(u,c)}function Pk(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var n=0;n<e.children.length;++n)Pk(e.children[n],t.children[n])}function Ik(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Tk(e){return"object"==typeof e&&null!=e&&e.outlets}function Ak(e,t,n,r,i){var o={};return r&&jw(r,function(e,t){o[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new qw(n.root===e?t:Nk(n.root,e,t),o,i)}function Nk(e,t,n){var r={};return jw(e.children,function(e,i){r[i]=e===t?n:Nk(e,t,n)}),new Ww(e.segments,r)}var xk=function(){function e(t,n,r){if(Qp(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&Ik(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(Tk);if(i&&i!==Fw(r))throw new Error("{outlets:{}} has to be the last command")}return Kp(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),Rk=function e(t,n,r){Qp(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r};function Mk(e,t,n){if(e||(e=new Ww([],{})),0===e.segments.length&&e.hasChildren())return Dk(e,t,n);var r=function(e,t,n){for(var r=0,i=t,o={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return o;var a=e.segments[i],s=n[r];if(Tk(s))break;var u="".concat(s),c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!jk(u,c,a))return o;r+=2}else{if(!jk(u,{},a))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var o=new Ww(e.segments.slice(0,r.pathIndex),{});return o.children.primary=new Ww(e.segments.slice(r.pathIndex),e.children),Dk(o,0,i)}return r.match&&0===i.length?new Ww(e.segments,{}):r.match&&!e.hasChildren()?Lk(e,t,n):r.match?Dk(e,0,i):Lk(e,t,n)}function Dk(e,t,n){if(0===n.length)return new Ww(e.segments,{});var r=function(e){return Tk(e[0])?e[0].outlets:{primary:e}}(n),i={};return jw(r,function(n,r){"string"==typeof n&&(n=[n]),null!==n&&(i[r]=Mk(e.children[r],t,n))}),jw(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new Ww(e.segments,i)}function Lk(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){var o=n[i];if(Tk(o)){var a=Bk(o.outlets);return new Ww(r,a)}if(0===i&&Ik(n[0]))r.push(new $w(e.segments[t].path,Fk(n[0]))),i++;else{var s=Tk(o)?o.outlets.primary:"".concat(o),u=i<n.length-1?n[i+1]:null;s&&u&&Ik(u)?(r.push(new $w(s,Fk(u))),i+=2):(r.push(new $w(s,{})),i++)}}return new Ww(r,{})}function Bk(e){var t={};return jw(e,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(t[n]=Lk(new Ww([],{}),0,e))}),t}function Fk(e){var t={};return jw(e,function(e,n){return t[n]="".concat(e)}),t}function jk(e,t,n){return e==n.path&&Dw(t,n.parameters)}var Uk=function(){function e(t,n,r,i){Qp(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return Kp(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Ek(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=vk(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),jw(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=vk(e),o=0,a=Object.keys(i);o<a.length;o++){var s=a[o];this.deactivateRouteAndItsChildren(i[s],r)}n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=vk(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new Tw(e.value.snapshot))}),e.children.length&&this.forwardEvent(new Pw(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(Ek(r),r===i)if(r.component){var o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var a=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),a.children.onOutletReAttached(s.contexts),a.attachRef=s.componentRef,a.route=s.route.value,a.outlet&&a.outlet.attach(s.componentRef,s.route.value),Vk(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;a.attachRef=null,a.route=r,a.resolver=c,a.outlet&&a.outlet.activateWith(r,c),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function Vk(e){Ek(e.value),e.children.forEach(Vk)}var zk=function e(t,n){Qp(this,e),this.routes=t,this.module=n};function Hk(e){return"function"==typeof e}function Gk(e){return e instanceof qw}var qk=Symbol("INITIAL_VALUE");function Wk(){return B_(function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i;return Object(w_.a)(t[t.length-1])&&(i=t.pop()),"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&Object(wy.a)(t[0])&&(t=t[0]),Object(S_.a)(t,i).lift(new I_(r))}(e.map(function(e){return e.pipe(V_(1),G_(qk))})).pipe(q_(function(e,t){var n=!1;return t.reduce(function(e,r,i){if(e!==qk)return e;if(r===qk&&(n=!0),!n){if(!1===r)return r;if(i===t.length-1||Gk(r))return r}return e},e)},qk),Ib(function(e){return e!==qk}),Object(ky.a)(function(e){return Gk(e)?e:!0===e}),V_(1))})}var $k,Zk=(($k=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||$k)},$k.\u0275cmp=Vp.Fb({type:$k,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&Vp.Mb(0,"router-outlet")},directives:function(){return[ZC]},encapsulation:2}),$k);function Qk(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];Yk(r,Kk(t,r))}}function Yk(e,t){e.children&&Qk(e.children,t)}function Kk(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function Jk(e){var t=e.children&&e.children.map(Jk),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=Zk),n}function Xk(e){return e.outlet||"primary"}function eC(e,t){var n=e.filter(function(e){return Xk(e)===t});return n.push.apply(n,Up(e.filter(function(e){return Xk(e)!==t}))),n}var tC={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function nC(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},tC):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var i=(t.matcher||Mw)(n,e,t);if(!i)return Object.assign({},tC);var o={};jw(i.posParams,function(e,t){o[t]=e.path});var a=i.consumed.length>0?Object.assign(Object.assign({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:a,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function rC(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(n.length>0&&function(e,t,n){return n.some(function(n){return iC(e,t,n)&&"primary"!==Xk(n)})}(e,n,r)){var o=new Ww(t,function(e,t,n,r){var i={};i.primary=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var o,a=zp(n);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(""===s.path&&"primary"!==Xk(s)){var u=new Ww([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,i[Xk(s)]=u}}}catch(c){a.e(c)}finally{a.f()}return i}(e,t,r,new Ww(n,e.children)));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(function(n){return iC(e,t,n)})}(e,n,r)){var a=new Ww(e.segments,function(e,t,n,r,i,o){var a,s={},u=zp(r);try{for(u.s();!(a=u.n()).done;){var c=a.value;if(iC(e,n,c)&&!i[Xk(c)]){var l=new Ww([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===o?e.segments.length:t.length,s[Xk(c)]=l}}}catch(h){u.e(h)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:n}}var s=new Ww(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function iC(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function oC(e,t,n,r){return!!(Xk(e)===r||"primary"!==r&&iC(t,n,e))&&("**"===e.path||nC(t,e,n).matched)}function aC(e,t,n){return 0===t.length&&!e.children[n]}var sC=function e(t){Qp(this,e),this.segmentGroup=t||null},uC=function e(t){Qp(this,e),this.urlTree=t};function cC(e){return new _y.a(function(t){return t.error(new sC(e))})}function lC(e){return new _y.a(function(t){return t.error(new uC(e))})}function hC(e){return new _y.a(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var fC=function(){function e(t,n,r,i,o){Qp(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=o,this.allowRedirects=!0,this.ngModule=t.get(Vp.y)}return Kp(e,[{key:"apply",value:function(){var e=this,t=rC(this.urlTree.root,[],[],this.config).segmentGroup,n=new Ww(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,"primary").pipe(Object(ky.a)(function(t){return e.createUrlTree(dC(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(Z_(function(t){if(t instanceof uC)return e.allowRedirects=!1,e.match(t.urlTree);if(t instanceof sC)throw e.noMatchError(t);throw t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,"primary").pipe(Object(ky.a)(function(n){return t.createUrlTree(dC(n),e.queryParams,e.fragment)})).pipe(Z_(function(e){if(e instanceof sC)throw t.noMatchError(e);throw e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new Ww([],{primary:e}):e;return new qw(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Object(ky.a)(function(e){return new Ww([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){for(var r=this,i=[],o=0,a=Object.keys(n.children);o<a.length;o++){var s=a[o];"primary"===s?i.unshift(s):i.push(s)}return Object(by.a)(i).pipe(Sb(function(i){var o=n.children[i],a=eC(t,i);return r.expandSegmentGroup(e,a,o,i).pipe(Object(ky.a)(function(e){return{segment:e,outlet:i}}))}),q_(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Ib(function(t,n){return e(t,n,r)}):sw.a,K_(1),n?iw(t):ew(function(){return new A_}))}}())}},{key:"expandSegment",value:function(e,t,n,r,i,o){var a=this;return Object(by.a)(n).pipe(Sb(function(s){return a.expandSegmentAgainstRoute(e,t,n,s,r,i,o).pipe(Z_(function(e){if(e instanceof sC)return Object(Eb.a)(null);throw e}))}),uw(function(e){return!!e}),Z_(function(e,n){if(e instanceof A_||"EmptyError"===e.name){if(aC(t,r,i))return Object(Eb.a)(new Ww([],{}));throw new sC(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,o,a){return oC(r,t,i,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o):cC(t):cC(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,o=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?lC(o):this.lineralizeSegments(n,o).pipe(Object(Ob.a)(function(n){var o=new Ww(n,{});return i.expandSegment(e,o,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,o){var a=this,s=nC(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,h=s.positionalParamSegments;if(!u)return cC(t);var f=this.applyRedirectCommands(c,r.redirectTo,h);return r.redirectTo.startsWith("/")?lC(f):this.lineralizeSegments(r,f).pipe(Object(Ob.a)(function(r){return a.expandSegment(e,t,n,r.concat(i.slice(l)),o,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r,i){var o=this;if("**"===n.path)return n.loadChildren?(n._loadedConfig?Object(Eb.a)(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(Object(ky.a)(function(e){return n._loadedConfig=e,new Ww(r,{})})):Object(Eb.a)(new Ww(r,{}));var a=nC(t,n,r),s=a.matched,u=a.consumedSegments,c=a.lastChild;if(!s)return cC(t);var l=r.slice(c);return this.getChildConfig(e,n,r).pipe(Object(Ob.a)(function(e){var r=e.module,a=e.routes,s=rC(t,u,l,a),c=s.segmentGroup,h=s.slicedSegments,f=new Ww(c.segments,c.children);if(0===h.length&&f.hasChildren())return o.expandChildren(r,a,f).pipe(Object(ky.a)(function(e){return new Ww(u,e)}));if(0===a.length&&0===h.length)return Object(Eb.a)(new Ww(u,{}));var d=Xk(n)===i;return o.expandSegment(r,f,a,h,d?"primary":i,!0).pipe(Object(ky.a)(function(e){return new Ww(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?Object(Eb.a)(new zk(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Object(Eb.a)(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(Object(Ob.a)(function(n){return n?r.configLoader.load(e.injector,t).pipe(Object(ky.a)(function(e){return t._loadedConfig=e,e})):function(e){return new _y.a(function(t){return t.error(Rw("Cannot load children because the guard of the route \"path: '".concat(e.path,"'\" returned false")))})}(t)})):Object(Eb.a)(new zk([],e))}},{key:"runCanLoadGuards",value:function(e,t,n){var r=this,i=t.canLoad;if(!i||0===i.length)return Object(Eb.a)(!0);var o=i.map(function(r){var i,o=e.get(r);if(function(e){return e&&Hk(e.canLoad)}(o))i=o.canLoad(t,n);else{if(!Hk(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return Uw(i)});return Object(Eb.a)(o).pipe(Wk(),Object(cw.a)(function(e){if(Gk(e)){var t=Rw('Redirecting to "'.concat(r.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),Object(ky.a)(function(e){return!0===e}))}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Object(Eb.a)(n);if(r.numberOfChildren>1||!r.children.primary)return hC(e.redirectTo);r=r.children.primary}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new qw(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return jw(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,o=this.createSegments(e,t.segments,n,r),a={};return jw(t.children,function(t,o){a[o]=i.createSegmentGroup(e,t,n,r)}),new Ww(o,a)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,i=zp(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.path===e.path)return t.splice(r),o;r++}}catch(a){i.e(a)}finally{i.f()}return e}}]),e}();function dC(e){for(var t={},n=0,r=Object.keys(e.children);n<r.length;n++){var i=r[n],o=dC(e.children[i]);(o.segments.length>0||o.hasChildren())&&(t[i]=o)}return function(e){if(1===e.numberOfChildren&&e.children.primary){var t=e.children.primary;return new Ww(e.segments.concat(t.segments),t.children)}return e}(new Ww(e.segments,t))}var pC=function e(t){Qp(this,e),this.path=t,this.route=this.path[this.path.length-1]},vC=function e(t,n){Qp(this,e),this.component=t,this.route=n};function gC(e,t,n){var r=e._root;return mC(r,t?t._root:null,n,[r.value])}function yC(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function mC(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=vk(t);return e.children.forEach(function(e){!function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=e.value,a=t?t.value:null,s=n?n.getContext(e.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!Zw(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Zw(e.url,t.url)||!Dw(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ok(e,t)||!Dw(e.queryParams,t.queryParams);case"paramsChange":default:return!Ok(e,t)}}(a,o,o.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new pC(r)):(o.data=a.data,o._resolvedData=a._resolvedData),mC(e,t,o.component?s?s.children:null:n,r,i),u&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new vC(s.outlet.component,a))}else a&&bC(t,s,i),i.canActivateChecks.push(new pC(r)),mC(e,null,o.component?s?s.children:null:n,r,i)}(e,o[e.value.outlet],n,r.concat([e.value]),i),delete o[e.value.outlet]}),jw(o,function(e,t){return bC(e,n.getContext(t),i)}),i}function bC(e,t,n){var r=vk(e),i=e.value;jw(r,function(e,r){bC(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new vC(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var _C=function e(){Qp(this,e)};function wC(e){return new _y.a(function(t){return t.error(e)})}var kC=function(){function e(t,n,r,i,o,a){Qp(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=a}return Kp(e,[{key:"recognize",value:function(){var e=rC(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,"primary");if(null===t)return null;var n=new _k([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),r=new pk(n,t),i=new wk(this.url,r);return this.inheritParamsAndData(i._root),i}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=bk(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,i=Object.keys(t.children);r<i.length;r++){var o=i[r],a=t.children[o],s=eC(e,o),u=this.processSegmentGroup(s,a,o);if(null===u)return null;n.push.apply(n,Up(u))}var c=CC(n);return c.sort(function(e,t){return"primary"===e.value.outlet?-1:"primary"===t.value.outlet?1:e.value.outlet.localeCompare(t.value.outlet)}),c}},{key:"processSegment",value:function(e,t,n,r){var i,o=zp(e);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=this.processSegmentAgainstRoute(a,t,n,r);if(null!==s)return s}}catch(u){o.e(u)}finally{o.f()}return aC(t,n,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo||!oC(e,t,n,r))return null;var i,o=[],a=[];if("**"===e.path){var s=n.length>0?Fw(n).parameters:{};i=new _k(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,SC(e),Xk(e),e.component,e,EC(t),OC(t)+n.length,PC(e))}else{var u=nC(t,e,n);if(!u.matched)return null;o=u.consumedSegments,a=n.slice(u.lastChild),i=new _k(o,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,SC(e),Xk(e),e.component,e,EC(t),OC(t)+o.length,PC(e))}var c=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),l=rC(t,o,a,c.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),h=l.segmentGroup,f=l.slicedSegments;if(0===f.length&&h.hasChildren()){var d=this.processChildren(c,h);return null===d?null:[new pk(i,d)]}if(0===c.length&&0===f.length)return[new pk(i,[])];var p=Xk(e)===r,v=this.processSegment(c,h,f,p?"primary":r);return null===v?null:[new pk(i,v)]}}]),e}();function CC(e){var t,n=[],r=new Set,i=zp(e);try{var o=function(){var e,i=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(i))return n.push(i),"continue";var o=n.find(function(e){return i.value.routeConfig===e.value.routeConfig});void 0!==o?((e=o.children).push.apply(e,Up(i.children)),r.add(o)):n.push(i)};for(i.s();!(t=i.n()).done;)o()}catch(l){i.e(l)}finally{i.f()}var a,s=zp(r);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=CC(u.children);n.push(new pk(u.value,c))}}catch(l){s.e(l)}finally{s.f()}return n.filter(function(e){return!r.has(e)})}function EC(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function OC(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function SC(e){return e.data||{}}function PC(e){return e.resolve||{}}function IC(e){return B_(function(t){var n=e(t);return n?Object(by.a)(n).pipe(Object(ky.a)(function(){return t})):Object(Eb.a)(t)})}var TC=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return n}(function(){function e(){Qp(this,e)}return Kp(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),AC=new Vp.r("ROUTES"),NC=function(){function e(t,n,r,i){Qp(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return Kp(e,[{key:"load",value:function(e,t){var n=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren).pipe(Object(ky.a)(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new zk(Bw(i.injector.get(AC,void 0,Vp.q.Self|Vp.q.Optional)).map(Jk),i)}),Z_(function(e){throw t._loader$=void 0,e}));return t._loader$=new D_.a(r,function(){return new m_.a}).pipe(Object(lw.a)()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?Object(by.a)(this.loader.load(e)):Uw(e()).pipe(Object(Ob.a)(function(e){return e instanceof Vp.w?Object(Eb.a)(e):Object(by.a)(t.compiler.compileModuleAsync(e))}))}}]),e}(),xC=function e(){Qp(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new RC,this.attachRef=null},RC=function(){function e(){Qp(this,e),this.contexts=new Map}return Kp(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new xC,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),MC=function(){function e(){Qp(this,e)}return Kp(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function DC(e){throw e}function LC(e,t,n){return t.parse("/")}function BC(e,t){return Object(Eb.a)(null)}var FC,jC,UC,VC=((UC=function(){function e(t,n,r,i,o,a,s,u){var c=this;Qp(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new m_.a,this.errorHandler=DC,this.malformedUriErrorHandler=LC,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:BC,afterPreactivation:BC},this.urlHandlingStrategy=new MC,this.routeReuseStrategy=new TC,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.ngModule=o.get(Vp.y),this.console=o.get(Vp.Y);var l=o.get(Vp.A);this.isNgZoneEnabled=l instanceof Vp.A&&Vp.A.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new qw(new Ww([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new NC(a,s,function(e){return c.triggerEvent(new Ew(e))},function(e){return c.triggerEvent(new Ow(e))}),this.routerState=yk(this.currentUrlTree,this.rootComponentType),this.transitions=new __({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return Kp(e,[{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(Ib(function(e){return 0!==e.id}),Object(ky.a)(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),B_(function(e){var r,i,o,a,s=!1,u=!1;return Object(Eb.a)(e).pipe(Object(cw.a)(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),B_(function(e){var r,i,o,a,s=!t.navigated||e.extractedUrl.toString()!==t.browserUrlTree.toString();if(("reload"===t.onSameUrlNavigation||s)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return Object(Eb.a)(e).pipe(B_(function(e){var r=t.transitions.getValue();return n.next(new vw(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?R_.a:Promise.resolve(e)}),(r=t.ngModule.injector,i=t.configLoader,o=t.urlSerializer,a=t.config,B_(function(e){return function(e,t,n,r,i){return new fC(e,t,n,r,i).apply()}(r,i,o,e.extractedUrl,a).pipe(Object(ky.a)(function(t){return Object.assign(Object.assign({},e),{urlAfterRedirects:t})}))})),Object(cw.a)(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,n,r,i,o){return Object(Ob.a)(function(r){return function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var a=new kC(e,t,n,r,i,o).recognize();return null===a?wC(new _C):Object(Eb.a)(a)}catch(fV){return wC(fV)}}(e,n,r.urlAfterRedirects,(a=r.urlAfterRedirects,t.serializeUrl(a)),i,o).pipe(Object(ky.a)(function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})}));var a})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),Object(cw.a)(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects);var r=new bw(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(s&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var u=e.id,c=e.extractedUrl,l=e.source,h=e.restoredState,f=e.extras,d=new vw(u,t.serializeUrl(c),l,h);n.next(d);var p=yk(c,t.rootComponentType).snapshot;return Object(Eb.a)(Object.assign(Object.assign({},e),{targetSnapshot:p,urlAfterRedirects:c,extras:Object.assign(Object.assign({},f),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),R_.a}),IC(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,o=e.rawUrl,a=e.extras,s=a.skipLocationChange,u=a.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:o,skipLocationChange:!!s,replaceUrl:!!u})}),Object(cw.a)(function(e){var n=new _w(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),Object(ky.a)(function(e){return Object.assign(Object.assign({},e),{guards:gC(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return Object(Ob.a)(function(n){var r=n.targetSnapshot,i=n.currentSnapshot,o=n.guards,a=o.canActivateChecks,s=o.canDeactivateChecks;return 0===s.length&&0===a.length?Object(Eb.a)(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return Object(by.a)(e).pipe(Object(Ob.a)(function(e){return function(e,t,n,r,i){var o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!o||0===o.length)return Object(Eb.a)(!0);var a=o.map(function(o){var a,s=yC(o,t,i);if(function(e){return e&&Hk(e.canDeactivate)}(s))a=Uw(s.canDeactivate(e,t,n,r));else{if(!Hk(s))throw new Error("Invalid CanDeactivate guard");a=Uw(s(e,t,n,r))}return a.pipe(uw())});return Object(Eb.a)(a).pipe(Wk())}(e.component,e.route,n,t,r)}),uw(function(e){return!0!==e},!0))}(s,r,i,e).pipe(Object(Ob.a)(function(n){return n&&"boolean"==typeof n?function(e,t,n,r){return Object(by.a)(t).pipe(Sb(function(t){return x_(function(e,t){return null!==e&&t&&t(new Sw(e)),Object(Eb.a)(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new Iw(e)),Object(Eb.a)(!0)}(t.route,r),function(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return M_(function(){var i=t.guards.map(function(i){var o,a=yC(i,t.node,n);if(function(e){return e&&Hk(e.canActivateChild)}(a))o=Uw(a.canActivateChild(r,e));else{if(!Hk(a))throw new Error("Invalid CanActivateChild guard");o=Uw(a(r,e))}return o.pipe(uw())});return Object(Eb.a)(i).pipe(Wk())})});return Object(Eb.a)(i).pipe(Wk())}(e,t.path,n),function(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Object(Eb.a)(!0);var i=r.map(function(r){return M_(function(){var i,o=yC(r,t,n);if(function(e){return e&&Hk(e.canActivate)}(o))i=Uw(o.canActivate(t,e));else{if(!Hk(o))throw new Error("Invalid CanActivate guard");i=Uw(o(t,e))}return i.pipe(uw())})});return Object(Eb.a)(i).pipe(Wk())}(e,t.route,n))}),uw(function(e){return!0!==e},!0))}(r,a,e,t):Object(Eb.a)(n)}),Object(ky.a)(function(e){return Object.assign(Object.assign({},n),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),Object(cw.a)(function(e){if(Gk(e.guardsResult)){var n=Rw('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}var r=new ww(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)}),Ib(function(e){if(!e.guardsResult){t.resetUrlToCurrentUrlTree();var r=new yw(e.id,t.serializeUrl(e.extractedUrl),"");return n.next(r),e.resolve(!1),!1}return!0}),IC(function(e){if(e.guards.canActivateChecks.length)return Object(Eb.a)(e).pipe(Object(cw.a)(function(e){var n=new kw(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),B_(function(e){var r,i,o=!1;return Object(Eb.a)(e).pipe((r=t.paramsInheritanceStrategy,i=t.ngModule.injector,Object(Ob.a)(function(e){var t=e.targetSnapshot,n=e.guards.canActivateChecks;if(!n.length)return Object(Eb.a)(e);var o=0;return Object(by.a)(n).pipe(Sb(function(e){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return Object(Eb.a)({});var o={};return Object(by.a)(i).pipe(Object(Ob.a)(function(i){return function(e,t,n,r){var i=yC(e,t,r);return Uw(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(Object(cw.a)(function(e){o[i]=e}))}),K_(1),Object(Ob.a)(function(){return Object.keys(o).length===i.length?Object(Eb.a)(o):R_.a}))}(e._resolve,e,t,r).pipe(Object(ky.a)(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),bk(e,n).resolve),null}))}(e.route,t,r,i)}),Object(cw.a)(function(){return o++}),K_(1),Object(Ob.a)(function(t){return o===n.length?Object(Eb.a)(e):R_.a}))})),Object(cw.a)({next:function(){return o=!0},complete:function(){if(!o){var r=new yw(e.id,t.serializeUrl(e.extractedUrl),"At least one route resolver didn't emit any value.");n.next(r),e.resolve(!1)}}}))}),Object(cw.a)(function(e){var n=new Cw(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),IC(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,o=e.rawUrl,a=e.extras,s=a.skipLocationChange,u=a.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:o,skipLocationChange:!!s,replaceUrl:!!u})}),Object(ky.a)(function(e){var n=function(e,t,n){var r=Sk(e,t._root,n?n._root:void 0);return new gk(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})}),Object(cw.a)(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(t.currentUrlTree,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)}),(i=t.rootContexts,o=t.routeReuseStrategy,a=function(e){return t.triggerEvent(e)},Object(ky.a)(function(e){return new Uk(o,e.targetRouterState,e.currentRouterState,a).activate(i),e})),Object(cw.a)({next:function(){s=!0},complete:function(){s=!0}}),(r=function(){if(!s&&!u){t.resetUrlToCurrentUrlTree();var r=new yw(e.id,t.serializeUrl(e.extractedUrl),"Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId));n.next(r),e.resolve(!1)}t.currentNavigation=null},function(e){return e.lift(new fw(r))}),Z_(function(r){if(u=!0,(s=r)&&s.ngNavigationCancelingError){var i=Gk(r.url);i||(t.navigated=!0,t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl));var o=new yw(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),i?setTimeout(function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree);t.scheduleNavigation(n,"imperative",null,{skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy},{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl);var a=new mw(e.id,t.serializeUrl(e.extractedUrl),r);n.next(a);try{e.resolve(t.errorHandler(r))}catch(Lx){e.reject(Lx)}}var s;return R_.a}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,n)&&setTimeout(function(){var t=n.source,r=n.state,i=n.urlTree,o={replaceUrl:!0};if(r){var a=Object.assign({},r);delete a.navigationId,0!==Object.keys(a).length&&(o.state=a)}e.scheduleNavigation(i,t,r,o)},0),e.lastLocationChangeInfo=n}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var n=t.urlTree.toString()===e.urlTree.toString();return!(t.transitionId===e.transitionId&&n&&("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source))}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){Qk(e),this.config=e.map(Jk),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,o=t.queryParamsHandling,a=t.preserveFragment,s=n||this.routerState.root,u=a?this.currentUrlTree.fragment:i,c=null;switch(o){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return Ak(t.root,t.root,t,r,i);var o=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new xk(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var o={};return jw(r.outlets,function(e,t){o[t]="string"==typeof e?e.split("/"):e}),[].concat(Up(e),[{outlets:o}])}if(r.segmentPath)return[].concat(Up(e),[r.segmentPath])}return"string"!=typeof r?[].concat(Up(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(Up(e),[r])},[]);return new xk(n,t,r)}(n);if(o.toRoot())return Ak(t.root,new Ww([],{}),t,r,i);var a=function(e,t,n){if(e.isAbsolute)return new Rk(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){var r=n.snapshot._urlSegment;return new Rk(r,r===t.root,0)}var i=Ik(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,o=n;o>i;){if(o-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new Rk(r,!1,i-o)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(o,t,e),s=a.processChildren?Dk(a.segmentGroup,a.index,o.commands):Mk(a.segmentGroup,a.index,o.commands);return Ak(a.segmentGroup,s,t,r,i)}(s,this.currentUrlTree,e,c,u)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},n=Gk(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(fV){t=this.malformedUriErrorHandler(fV,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){if(Gk(e))return Vw(this.currentUrlTree,e,t);var n=this.parseUrl(e);return Vw(this.currentUrlTree,n,t)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.events.next(new gw(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ")})}},{key:"scheduleNavigation",value:function(e,t,n,r,i){if(this.disposed)return Promise.resolve(!1);var o,a,s,u=this.getTransition(),c="imperative"!==t&&"imperative"===(null==u?void 0:u.source),l=(this.lastSuccessfulId===u.id||this.currentNavigation?u.rawUrl:u.urlAfterRedirects).toString()===e.toString();if(c&&l)return Promise.resolve(!0);i?(o=i.resolve,a=i.reject,s=i.promise):s=new Promise(function(e,t){o=e,a=t});var h=++this.navigationId;return this.setTransition({id:h,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:o,reject:a,promise:s,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),s.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t,n,r){var i=this.urlSerializer.serialize(e);r=r||{},this.location.isCurrentPathEqualTo(i)||t?this.location.replaceState(i,"",Object.assign(Object.assign({},r),{navigationId:n})):this.location.go(i,"",Object.assign(Object.assign({},r),{navigationId:n}))}},{key:"resetStateAndUrl",value:function(e,t,n){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}]),e}()).\u0275fac=function(e){return new(e||UC)(Vp.Zb(Vp.N),Vp.Zb(Qw),Vp.Zb(RC),Vp.Zb(wv),Vp.Zb(Vp.s),Vp.Zb(Vp.x),Vp.Zb(Vp.i),Vp.Zb(void 0))},UC.\u0275prov=Vp.Hb({token:UC,factory:UC.\u0275fac}),UC),zC=((jC=function(){function e(t,n,r,i,o){Qp(this,e),this.router=t,this.route=n,this.commands=[],this.onChanges=new m_.a,null==r&&i.setAttribute(o.nativeElement,"tabindex","0")}return Kp(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:GC(this.skipLocationChange),replaceUrl:GC(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:GC(this.preserveFragment)})}}]),e}()).\u0275fac=function(e){return new(e||jC)(Vp.Lb(VC),Vp.Lb(mk),Vp.ac("tabindex"),Vp.Lb(Vp.E),Vp.Lb(Vp.l))},jC.\u0275dir=Vp.Gb({type:jC,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&Vp.cc("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Vp.zb]}),jC),HC=((FC=function(){function e(t,n,r){var i=this;Qp(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.onChanges=new m_.a,this.subscription=t.events.subscribe(function(e){e instanceof gw&&i.updateTargetUrlAndHref()})}return Kp(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r,i){if(0!==e||t||n||r||i)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;var o={skipLocationChange:GC(this.skipLocationChange),replaceUrl:GC(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,o),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:GC(this.preserveFragment)})}}]),e}()).\u0275fac=function(e){return new(e||FC)(Vp.Lb(VC),Vp.Lb(mk),Vp.Lb(dv))},FC.\u0275dir=Vp.Gb({type:FC,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&Vp.cc("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(Vp.Tb("href",t.href,Vp.yc),Vp.Cb("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Vp.zb]}),FC);function GC(e){return""===e||!!e}var qC,WC,$C,ZC=((qC=function(){function e(t,n,r,i,o){Qp(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new Vp.n,this.deactivateEvents=new Vp.n,this.name=i||"primary",t.onChildOutletCreated(this.name,this)}return Kp(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new QC(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}()).\u0275fac=function(e){return new(e||qC)(Vp.Lb(RC),Vp.Lb(Vp.Q),Vp.Lb(Vp.j),Vp.ac("name"),Vp.Lb(Vp.h))},qC.\u0275dir=Vp.Gb({type:qC,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),qC),QC=function(){function e(t,n,r){Qp(this,e),this.route=t,this.childContexts=n,this.parent=r}return Kp(e,[{key:"get",value:function(e,t){return e===mk?this.route:e===RC?this.childContexts:this.parent.get(e,t)}}]),e}(),YC=function e(){Qp(this,e)},KC=function(){function e(){Qp(this,e)}return Kp(e,[{key:"preload",value:function(e,t){return Object(Eb.a)(null)}}]),e}(),JC=(($C=function(){function e(t,n,r,i,o){Qp(this,e),this.router=t,this.injector=i,this.preloadingStrategy=o,this.loader=new NC(n,r,function(e){return t.triggerEvent(new Ew(e))},function(e){return t.triggerEvent(new Ow(e))})}return Kp(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(Ib(function(e){return e instanceof gw}),Sb(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(Vp.y);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],i=zp(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.loadChildren&&!o.canLoad&&o._loadedConfig){var a=o._loadedConfig;r.push(this.processRoutes(a.module,a.routes))}else o.loadChildren&&!o.canLoad?r.push(this.preloadConfig(e,o)):o.children&&r.push(this.processRoutes(e,o.children))}}catch(s){i.e(s)}finally{i.f()}return Object(by.a)(r).pipe(Object(N_.a)(),Object(ky.a)(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?Object(Eb.a)(t._loadedConfig):n.loader.load(e.injector,t)).pipe(Object(Ob.a)(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}()).\u0275fac=function(e){return new(e||$C)(Vp.Zb(VC),Vp.Zb(Vp.x),Vp.Zb(Vp.i),Vp.Zb(Vp.s),Vp.Zb(YC))},$C.\u0275prov=Vp.Hb({token:$C,factory:$C.\u0275fac}),$C),XC=((WC=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Qp(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return Kp(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof vw?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof gw&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof Aw&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new Aw(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||WC)(Vp.Zb(VC),Vp.Zb(Tg),Vp.Zb(void 0))},WC.\u0275prov=Vp.Hb({token:WC,factory:WC.\u0275fac}),WC),eE=new Vp.r("ROUTER_CONFIGURATION"),tE=new Vp.r("ROUTER_FORROOT_GUARD"),nE=[wv,{provide:Qw,useClass:Yw},{provide:VC,useFactory:function(e,t,n,r,i,o,a){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new VC(null,e,t,n,r,i,o,Bw(a));if(u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(s,l),s.enableTracing){var h=Gp();l.events.subscribe(function(e){h.logGroup("Router Event: ".concat(e.constructor.name)),h.log(e.toString()),h.log(e),h.logGroupEnd()})}return l},deps:[Qw,RC,wv,Vp.s,Vp.x,Vp.i,AC,eE,[function(){return function e(){Qp(this,e)}}(),new Vp.B],[function(){return function e(){Qp(this,e)}}(),new Vp.B]]},RC,{provide:mk,useFactory:function(e){return e.routerState.root},deps:[VC]},{provide:Vp.x,useClass:Vp.K},JC,KC,function(){function e(){Qp(this,e)}return Kp(e,[{key:"preload",value:function(e,t){return t().pipe(Z_(function(){return Object(Eb.a)(null)}))}}]),e}(),{provide:eE,useValue:{enableTracing:!1}}];function rE(){return new Vp.z("Router",VC)}var iE,oE=((iE=function(){function e(t,n){Qp(this,e)}return Kp(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[nE,cE(t),{provide:tE,useFactory:uE,deps:[[VC,new Vp.B,new Vp.J]]},{provide:eE,useValue:n||{}},{provide:dv,useFactory:sE,deps:[Yp,[new Vp.p(mv),new Vp.B],eE]},{provide:XC,useFactory:aE,deps:[VC,Tg,eE]},{provide:YC,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:KC},{provide:Vp.z,multi:!0,useFactory:rE},[hE,{provide:Vp.d,multi:!0,useFactory:fE,deps:[hE]},{provide:pE,useFactory:dE,deps:[hE]},{provide:Vp.b,multi:!0,useExisting:pE}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[cE(t)]}}}]),e}()).\u0275fac=function(e){return new(e||iE)(Vp.Zb(tE,8),Vp.Zb(VC,8))},iE.\u0275mod=Vp.Jb({type:iE}),iE.\u0275inj=Vp.Ib({}),iE);function aE(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new XC(e,t,n)}function sE(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new _v(e,t):new bv(e,t)}function uE(e){return"guarded"}function cE(e){return[{provide:Vp.a,multi:!0,useValue:e},{provide:AC,multi:!0,useValue:e}]}var lE,hE=((lE=function(){function e(t){Qp(this,e),this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new m_.a}return Kp(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(ov,Promise.resolve(null)).then(function(){var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(VC),i=e.injector.get(eE);return"disabled"===i.initialNavigation?(r.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(r.hooks.afterPreactivation=function(){return e.initNavigation?Object(Eb.a)(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()):t(!0),n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(eE),n=this.injector.get(JC),r=this.injector.get(XC),i=this.injector.get(VC),o=this.injector.get(Vp.g);e===o.components[0]&&("enabledNonBlocking"!==t.initialNavigation&&void 0!==t.initialNavigation||i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}}]),e}()).\u0275fac=function(e){return new(e||lE)(Vp.Zb(Vp.s))},lE.\u0275prov=Vp.Hb({token:lE,factory:lE.\u0275fac}),lE);function fE(e){return e.appInitializer.bind(e)}function dE(e){return e.bootstrapListener.bind(e)}var pE=new Vp.r("Router Initializer"),vE=function e(){Qp(this,e)};function gE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function yE(e){return{type:6,styles:e,offset:null}}function mE(e){Promise.resolve(null).then(e)}var bE=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Qp(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return Kp(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;mE(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),_E=function(){function e(t){var n=this;Qp(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,i=0,o=0,a=this.players.length;0==a?mE(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++r==a&&n._onFinish()}),e.onDestroy(function(){++i==a&&n._onDestroy()}),e.onStart(function(){++o==a&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return Kp(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function wE(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function kE(e){switch(e.length){case 0:return new bE;case 1:return e[0];default:return new _E(e)}}function CE(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=[],s=[],u=-1,c=null;if(r.forEach(function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach(function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,a),s){case"!":s=i[n];break;case"*":s=o[n];break;default:s=t.normalizeStyleValue(n,r,s,a)}l[r]=s}),r||s.push(l),c=l,u=n}),a.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(a.join(l)))}return s}function EE(e,t,n,r){switch(t){case"start":e.onStart(function(){return r(n&&OE(n,"start",e))});break;case"done":e.onDone(function(){return r(n&&OE(n,"done",e))});break;case"destroy":e.onDestroy(function(){return r(n&&OE(n,"destroy",e))})}}function OE(e,t,n){var r=n.totalTime,i=SE(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==r?e.totalTime:r,!!n.disabled),o=e._data;return null!=o&&(i._data=o),i}function SE(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:o,disabled:!!a}}function PE(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function IE(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var TE=function(e,t){return!1},AE=function(e,t){return!1},NE=function(e,t,n){return[]},xE=wE();(xE||"undefined"!=typeof Element)&&(TE=function(e,t){return e.contains(t)},AE=function(){if(xE||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:AE}(),NE=function(e,t,n){var r=[];if(n)for(var i=e.querySelectorAll(t),o=0;o<i.length;o++)r.push(i[o]);else{var a=e.querySelector(t);a&&r.push(a)}return r});var RE=null,ME=!1;function DE(e){RE||(RE=("undefined"!=typeof document?document.body:null)||{},ME=!!RE.style&&"WebkitAppearance"in RE.style);var t=!0;return RE.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in RE.style)&&ME)&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in RE.style),t}var LE=AE,BE=TE,FE=NE;function jE(e){var t={};return Object.keys(e).forEach(function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}var UE,VE=((UE=function(){function e(){Qp(this,e)}return Kp(e,[{key:"validateStyleProperty",value:function(e){return DE(e)}},{key:"matchesElement",value:function(e,t){return LE(e,t)}},{key:"containsElement",value:function(e,t){return BE(e,t)}},{key:"query",value:function(e,t,n){return FE(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,i){return new bE(n,r)}}]),e}()).\u0275fac=function(e){return new(e||UE)},UE.\u0275prov=Vp.Hb({token:UE,factory:UE.\u0275fac}),UE),zE=function(){var e=function e(){Qp(this,e)};return e.NOOP=new VE,e}();function HE(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:GE(parseFloat(t[1]),t[2])}function GE(e,t){switch(t){case"s":return 1e3*e;default:return e}}function qE(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,i=0,o="";if("string"==typeof e){var a=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=GE(parseFloat(a[1]),a[2]);var s=a[3];null!=s&&(i=GE(parseFloat(s),a[4]));var u=a[5];u&&(o=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:i,easing:o}}(e,t,n)}function WE(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function $E(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else WE(e,n);return n}function ZE(e,t,n){return n?t+":"+n+";":""}function QE(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=ZE(0,r,e.style.getPropertyValue(r))}for(var i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=ZE(0,i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e.style[i]));e.setAttribute("style",t)}function YE(e,t,n){e.style&&(Object.keys(t).forEach(function(r){var i=iO(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),wE()&&QE(e))}function KE(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=iO(t);e.style[n]=""}),wE()&&QE(e))}function JE(e){return Array.isArray(e)?1==e.length?e[0]:gE(e):e}var XE=new RegExp("{{\\s*(.+?)\\s*}}","g");function eO(e){var t=[];if("string"==typeof e){for(var n;n=XE.exec(e);)t.push(n[1]);XE.lastIndex=0}return t}function tO(e,t,n){var r=e.toString(),i=r.replace(XE,function(e,r){var i=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()});return i==r?e:i}function nO(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var rO=/-+([a-z0-9])/g;function iO(e){return e.replace(rO,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function oO(e,t){return 0===e||0===t}function aO(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var i=t[0],o=[];if(r.forEach(function(e){i.hasOwnProperty(e)||o.push(e),i[e]=n[e]}),o.length)for(var a=function(){var n=t[s];o.forEach(function(t){n[t]=uO(e,t)})},s=1;s<t.length;s++)a()}return t}function sO(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function uO(e,t){return window.getComputedStyle(e)[t]}var cO=new Set(["true","1"]),lO=new Set(["false","0"]);function hO(e,t){var n=cO.has(e)||lO.has(e),r=cO.has(t)||lO.has(t);return function(i,o){var a="*"==e||e==i,s="*"==t||t==o;return!a&&n&&"boolean"==typeof i&&(a=i?cO.has(e):lO.has(e)),!s&&r&&"boolean"==typeof o&&(s=o?cO.has(t):lO.has(t)),a&&s}}var fO=new RegExp("s*:selfs*,?","g");function dO(e,t,n){return new pO(e).build(t,n)}var pO=function(){function e(t){Qp(this,e),this._driver=t}return Kp(e,[{key:"build",value:function(e,t){var n=new vO(t);return this._resetContextStyleTimingState(n),sO(this,JE(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,i=t.depCount=0,o=[],a=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,o.push(n.visitState(s,t))}),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,i+=c.depCount,a.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:o,transitions:a,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var i=new Set,o=r||{};if(n.styles.forEach(function(e){if(gO(e)){var t=e;Object.keys(t).forEach(function(e){eO(t[e]).forEach(function(e){o.hasOwnProperty(e)||i.add(e)})})}}),i.size){var a=nO(i.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(a.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n,r,i,o=sO(this,JE(e.animation),t);return{type:1,matchers:(n=e.expr,r=t.errors,i=[],"string"==typeof n?n.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var o=i[1],a=i[2],s=i[3];t.push(hO(o,s)),"<"!=a[0]||"*"==o&&"*"==s||t.push(hO(s,o))}(e,i,r)}):i.push(n),i),animation:o,queryCount:t.queryCount,depCount:t.depCount,options:yO(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return sO(n,e,t)}),options:yO(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,i=0,o=e.steps.map(function(e){t.currentTime=r;var o=sO(n,e,t);return i=Math.max(i,t.currentTime),o});return t.currentTime=i,{type:3,steps:o,options:yO(e.options)}}},{key:"visitAnimate",value:function(e,t){var n,r=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return mO(qE(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var i=mO(0,0,"");return i.dynamic=!0,i.strValue=r,i}return mO((n=n||qE(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=r;var i=e.styles?e.styles:yE({});if(5==i.type)n=this.visitKeyframes(i,t);else{var o=e.styles,a=!1;if(!o){a=!0;var s={};r.easing&&(s.easing=r.easing),o=yE(s)}t.currentTime+=r.duration+r.delay;var u=this.visitStyle(o,t);u.isEmptyStep=a,n=u}return t.currentAnimateTimings=null,{type:4,timings:r,style:n,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?"*"==e?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var r=!1,i=null;return n.forEach(function(e){if(gO(e)){var t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(var o in t)if(t[o].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,i=t.currentTime,o=t.currentTime;r&&o>0&&(o-=r.duration+r.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(r){if(n._driver.validateStyleProperty(r)){var a,s,u,c,l,h=t.collectedStyles[t.currentQuerySelector],f=h[r],d=!0;f&&(o!=i&&o>=f.startTime&&i<=f.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(f.startTime,'ms" and "').concat(f.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(o,'ms" and "').concat(i,'ms"')),d=!1),o=f.startTime),d&&(h[r]={startTime:o,endTime:i}),t.options&&(a=e[r],s=t.options,u=t.errors,c=s.params||{},(l=eO(a)).length&&l.forEach(function(e){c.hasOwnProperty(e)||u.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))}))}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,o=[],a=!1,s=!1,u=0,c=e.steps.map(function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(gO(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(gO(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,a=a||l<u,u=l,o.push(l),r});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),a&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,h=0;i>0&&i<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(h=1/(l-1));var f=l-1,d=t.currentTime,p=t.currentAnimateTimings,v=p.duration;return c.forEach(function(e,i){var a=h>0?i==f?1:h*i:o[i],s=a*v;t.currentTime=d+p.delay+s,p.duration=s,n._validateStyleAst(e,t),e.offset=a,r.styles.push(e)}),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:sO(this,JE(e.animation),t),options:yO(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:yO(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:yO(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var i=Bp(function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(fO,"")),[e=e.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,function(e){return".ng-trigger-"+e.substr(1)}).replace(/:animating/g,".ng-animating"),t]}(e.selector),2),o=i[0],a=i[1];t.currentQuerySelector=n.length?n+" "+o:o,PE(t.collectedStyles,t.currentQuerySelector,{});var s=sO(this,JE(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:a,animation:s,originalSelector:e.selector,options:yO(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:qE(e.timings,t.errors,!0);return{type:12,animation:sO(this,JE(e.animation),t),timings:n,options:null}}}]),e}(),vO=function e(t){Qp(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null};function gO(e){return!Array.isArray(e)&&"object"==typeof e}function yO(e){var t;return e?(e=WE(e)).params&&(e.params=(t=e.params)?WE(t):null):e={},e}function mO(e,t,n){return{duration:e,delay:t,easing:n}}function bO(e,t,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:a,subTimeline:s}}var _O=function(){function e(){Qp(this,e),this._map=new Map}return Kp(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,Up(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),wO=new RegExp(":enter","g"),kO=new RegExp(":leave","g");function CO(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new EO).buildKeyframes(e,t,n,r,i,o,a,s,u,c)}var EO=function(){function e(){Qp(this,e)}return Kp(e,[{key:"buildKeyframes",value:function(e,t,n,r,i,o,a,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new _O;var l=new SO(e,t,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([o],null,l.errors,s),sO(this,n,l);var h=l.timelines.filter(function(e){return e.containsAnimation()});if(h.length&&Object.keys(a).length){var f=h[h.length-1];f.allowOnlyTimelineStyles()||f.setStyles([a],null,l.errors,s)}return h.length?h.map(function(e){return e.buildKeyframes()}):[bO(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);i!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,i=null!=n.duration?HE(n.duration):null,o=null!=n.delay?HE(n.delay):null;return 0!==i&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,i,o);r=Math.max(r,n.duration+n.delay)}),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),sO(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,i=t,o=e.options;if(o&&(o.params||o.delay)&&((i=t.createSubContext(o)).transformIntoNewTimeline(),null!=o.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=OO);var a=HE(o.delay);i.delayNextStep(a)}e.steps.length&&(e.steps.forEach(function(e){return sO(n,e,i)}),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],i=t.currentTimeline.currentTime,o=e.options&&e.options.delay?HE(e.options.delay):0;e.steps.forEach(function(a){var s=t.createSubContext(e.options);o&&s.delayNextStep(o),sO(n,a,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(i),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return qE(t.params?tO(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,o=t.createSubContext().currentTimeline;o.easing=n.easing,e.styles.forEach(function(e){o.forwardTime((e.offset||0)*i),o.setStyles(e.styles,e.easing,t.errors,t.options),o.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(o),t.transformIntoNewTimeline(r+i),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,i=e.options||{},o=i.delay?HE(i.delay):0;o&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=OO);var a=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach(function(r,i){t.currentQueryIndex=i;var s=t.createSubContext(e.options,r);o&&s.delayNextStep(o),r===t.element&&(u=s.currentTimeline),sO(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(a),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,i=e.timings,o=Math.abs(i.duration),a=o*(t.currentQueryTotal-1),s=o*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=a-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;sO(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),OO={},SO=function(){function e(t,n,r,i,o,a,s,u){Qp(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=o,this.errors=a,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=OO,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new PO(this._driver,n,0),s.push(this.currentTimeline)}return Kp(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,i=this.options;null!=r.duration&&(i.duration=HE(r.duration)),null!=r.delay&&(i.delay=HE(r.delay));var o=r.params;if(o){var a=i.params;a||(a=this.options.params={}),Object.keys(o).forEach(function(e){t&&a.hasOwnProperty(e)||(a[e]=tO(o[e],a,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,o=new e(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=OO,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new IO(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,i,o){var a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(wO,"."+this._enterClassName)).replace(kO,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),a.push.apply(a,Up(s))}return i||0!=a.length||o.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),a}}]),e}(),PO=function(){function e(t,n,r,i){Qp(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return Kp(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||"*",t._currentKeyframe[e]="*"}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var i=this;t&&(this._previousKeyframe.easing=t);var o=r&&r.params||{},a=function(e,t){var n,r={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){r[e]="*"}):$E(e,!1,r)}),r}(e,this._globalTimelineStyles);Object.keys(a).forEach(function(e){var t=tO(a[e],o,n);i._pendingStyles[e]=t,i._localTimelineStyles.hasOwnProperty(e)||(i._backFill[e]=i._globalTimelineStyles.hasOwnProperty(e)?i._globalTimelineStyles[e]:"*"),i._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var r=t._styleSummary[n],i=e._styleSummary[n];(!r||i.time>r.time)&&t._updateStyle(n,i.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach(function(o,a){var s=$E(o,!0);Object.keys(s).forEach(function(e){var r=s[e];"!"==r?t.add(e):"*"==r&&n.add(e)}),r||(s.offset=a/e.duration),i.push(s)});var o=t.size?nO(t.values()):[],a=n.size?nO(n.values()):[];if(r){var s=i[0],u=WE(s);s.offset=0,u.offset=1,i=[s,u]}return bO(this.element,i,o,a,this.duration,this.startTime,this.easing,!1)}}]),e}(),IO=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return Qp(this,n),(u=t.call(this,e,r,s.delay)).element=r,u.keyframes=i,u.preStyleProps=o,u.postStyleProps=a,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return Kp(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,i=t.easing;if(this._stretchStartingKeyframe&&n){var o=[],a=r+n,s=n/a,u=$E(e[0],!1);u.offset=0,o.push(u);var c=$E(e[0],!1);c.offset=TO(s),o.push(c);for(var l=e.length-1,h=1;h<=l;h++){var f=$E(e[h],!1);f.offset=TO((n+f.offset*r)/a),o.push(f)}r=a,n=0,i="",e=o}return bO(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(PO);function TO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var AO,NO,xO=function e(){Qp(this,e)},RO=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"normalizePropertyName",value:function(e,t){return iO(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var i="",o=n.toString().trim();if(MO[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return o+i}}]),n}(xO),MO=(AO="width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","),NO={},AO.forEach(function(e){return NO[e]=!0}),NO);function DO(e,t,n,r,i,o,a,s,u,c,l,h,f){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:o,toState:r,toStyles:a,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:h,errors:f}}var LO={},BO=function(){function e(t,n,r){Qp(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return Kp(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,i){return e.some(function(e){return e(t,n,r,i)})}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],i=this._stateStyles[e],o=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):o}},{key:"build",value:function(e,t,n,r,i,o,a,s,u,c){var l=[],h=this.ast.options&&this.ast.options.params||LO,f=this.buildStyles(n,a&&a.params||LO,l),d=s&&s.params||LO,p=this.buildStyles(r,d,l),v=new Set,g=new Map,y=new Map,m="void"===r,b={params:Object.assign(Object.assign({},h),d)},_=c?[]:CO(e,t,this.ast.animation,i,o,f,p,b,u,l),w=0;if(_.forEach(function(e){w=Math.max(e.duration+e.delay,w)}),l.length)return DO(t,this._triggerName,n,r,m,f,p,[],[],g,y,w,l);_.forEach(function(e){var n=e.element,r=PE(g,n,{});e.preStyleProps.forEach(function(e){return r[e]=!0});var i=PE(y,n,{});e.postStyleProps.forEach(function(e){return i[e]=!0}),n!==t&&v.add(n)});var k=nO(v.values());return DO(t,this._triggerName,n,r,m,f,p,_,k,g,y,w)}}]),e}(),FO=function(){function e(t,n){Qp(this,e),this.styles=t,this.defaultParams=n}return Kp(e,[{key:"buildStyles",value:function(e,t){var n={},r=WE(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(r[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var i=e;Object.keys(i).forEach(function(e){var o=i[e];o.length>1&&(o=tO(o,r,t)),n[e]=o})}}),n}}]),e}(),jO=function(){function e(t,n){var r=this;Qp(this,e),this.name=t,this.ast=n,this.transitionFactories=[],this.states={},n.states.forEach(function(e){r.states[e.name]=new FO(e.style,e.options&&e.options.params||{})}),UO(this.states,"true","1"),UO(this.states,"false","0"),n.transitions.forEach(function(e){r.transitionFactories.push(new BO(t,e,r.states))}),this.fallbackTransition=new BO(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},this.states)}return Kp(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find(function(i){return i.match(e,t,n,r)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function UO(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var VO=new _O,zO=function(){function e(t,n,r){Qp(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return Kp(e,[{key:"register",value:function(e,t){var n=[],r=dO(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,i=CE(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=[],a=this._animations[e],s=new Map;if(a?(n=CO(this._driver,t,a,"ng-enter","ng-leave",{},{},i,VO,o)).forEach(function(e){var t=PE(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(o.push("The requested animation doesn't exist or has already been destroyed"),n=[]),o.length)throw new Error("Unable to create the animation due to the following errors: ".concat(o.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=r._driver.computeStyle(t,n,"*")})});var u=kE(n.map(function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return r.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,r){var i=SE(t,"","","");return EE(this._getPlayer(e),n,i,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),HO=[],GO={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},qO={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},WO=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Qp(this,e),this.namespaceId=n;var r,i=t&&t.hasOwnProperty("value");if(this.value=null!=(r=i?t.value:t)?r:null,i){var o=WE(t);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}return Kp(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),$O=new WO("void"),ZO=function(){function e(t,n,r){Qp(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,tS(n,this._hostClassName)}return Kp(e,[{key:"listen",value:function(e,t,n,r){var i,o=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var a=PE(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};a.push(s);var u=PE(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(tS(e,"ng-trigger"),tS(e,"ng-trigger-"+t),u[t]=$O),function(){o._engine.afterFlush(function(){var e=a.indexOf(s);e>=0&&a.splice(e,1),o._triggers[t]||delete u[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this._getTrigger(t),a=new YO(this.id,t,e),s=this._engine.statesByElement.get(e);s||(tS(e,"ng-trigger"),tS(e,"ng-trigger-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new WO(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=$O),"void"===c.value||u.value!==c.value){var l=PE(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()});var h=o.matchTransition(u.value,c.value,e,c.params),f=!1;if(!h){if(!i)return;h=o.fallbackTransition,f=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:h,fromState:u,toState:c,player:a,isFallbackTransition:f}),f||(tS(e,"ng-animate-queued"),a.onStart(function(){nS(e,"ng-animate-queued")})),a.onDone(function(){var t=r.players.indexOf(a);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var i=n.indexOf(a);i>=0&&n.splice(i,1)}}),this.players.push(a),l.push(a),a}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var o=n[i];if(!t.hasOwnProperty(o)||e[o]!==t[o])return!1}return!0}(u.params,c.params)){var d=[],p=o.matchStyles(u.value,u.params,d),v=o.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush(function(){KE(e,p),YE(e,v)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,r){t._elementListeners.set(r,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,r=this._engine.driver.query(e,".ng-trigger",!0);r.forEach(function(e){if(!e.__ng_removed){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return r.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var i=this,o=this._engine.statesByElement.get(e);if(o){var a=[];if(Object.keys(o).forEach(function(t){if(i._triggers[t]){var n=i.trigger(e,t,"void",r);n&&a.push(n)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&kE(a).onDone(function(){return i._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){var i=new Set;n.forEach(function(n){var o=n.name;if(!i.has(o)){i.add(o);var a=t._triggers[o].fallbackTransition,s=r[o]||$O,u=new WO("void"),c=new YO(t.id,o,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:o,transition:a,fromState:s,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var i=!1;if(r.totalAnimations){var o=r.players.length?r.playersByQueriedElement.get(e):[];if(o&&o.length)i=!0;else for(var a=e;a=a.parentNode;)if(r.statesByElement.get(a)){i=!0;break}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{var s=e.__ng_removed;s&&s!==GO||(r.afterFlush(function(){return n.clearElementCache(e)}),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){tS(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(r){var i=r.player;if(!i.destroyed){var o=r.element,a=t._elementListeners.get(o);a&&a.forEach(function(t){if(t.name==r.triggerName){var n=SE(o,r.triggerName,r.fromState.value,r.toState.value);n._data=e,EE(r.player,t.phase,n,t.callback)}}),i.markedForDestroy?t._engine.afterFlush(function(){i.destroy()}):n.push(r)}}),this._queue=[],n.sort(function(e,n){var r=e.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),QO=function(){function e(t,n,r){Qp(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return Kp(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new ZO(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return r.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var o=n[r[i]].namespaceId;if(o){var a=this._fetchNamespace(o);a&&t.add(a)}}return t}},{key:"trigger",value:function(e,t,n,r){if(KO(t)){var i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(KO(t)){var i=t.__ng_removed;if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){var a=this._fetchNamespace(e);a&&a.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),tS(e,"ng-animate-disabled")):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),nS(e,"ng-animate-disabled"))}},{key:"removeNode",value:function(e,t,n,r){if(KO(t)){var i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t.__ng_removed={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,i){return KO(t)?this._fetchNamespace(e).listen(t,n,r,i):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,".ng-trigger",!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,".ng-animating",!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return kE(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e.__ng_removed;if(n&&n.setForRemoval){if(e.__ng_removed=GO,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,".ng-animate-disabled")&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)tS(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,t)}finally{for(var o=0;o<i.length;o++)i[o]()}}else for(var a=0;a<this.collectedLeaveElements.length;a++)this.processLeaveNode(this.collectedLeaveElements[a]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?kE(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new _O,i=[],o=new Map,a=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])});var h=this.bodyNode,f=Array.from(this.statesByElement.keys()),d=eS(f,this.collectedEnterElements),p=new Map,v=0;d.forEach(function(e,t){var n="ng-enter"+v++;p.set(t,n),e.forEach(function(e){return tS(e,n)})});for(var g=[],y=new Set,m=new Set,b=0;b<this.collectedLeaveElements.length;b++){var _=this.collectedLeaveElements[b],w=_.__ng_removed;w&&w.setForRemoval&&(g.push(_),y.add(_),w.hasAnimation?this.driver.query(_,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):m.add(_))}var k=new Map,C=eS(f,Array.from(y));C.forEach(function(e,t){var n="ng-leave"+v++;k.set(t,n),e.forEach(function(e){return tS(e,n)})}),e.push(function(){d.forEach(function(e,t){var n=p.get(t);e.forEach(function(e){return nS(e,n)})}),C.forEach(function(e,t){var n=k.get(t);e.forEach(function(e){return nS(e,n)})}),g.forEach(function(e){n.processLeaveNode(e)})});for(var E=[],O=[],S=this._namespaceList.length-1;S>=0;S--)this._namespaceList[S].drainQueuedTransitions(t).forEach(function(e){var t=e.player,o=e.element;if(E.push(t),n.collectedEnterElements.length){var l=o.__ng_removed;if(l&&l.setForMove)return void t.destroy()}var f=!h||!n.driver.containsElement(h,o),d=k.get(o),v=p.get(o),g=n._buildInstruction(e,r,v,d,f);if(g.errors&&g.errors.length)O.push(g);else{if(f)return t.onStart(function(){return KE(o,g.fromStyles)}),t.onDestroy(function(){return YE(o,g.toStyles)}),void i.push(t);if(e.isFallbackTransition)return t.onStart(function(){return KE(o,g.fromStyles)}),t.onDestroy(function(){return YE(o,g.toStyles)}),void i.push(t);g.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(o,g.timelines),a.push({instruction:g,player:t,element:o}),g.queriedElements.forEach(function(e){return PE(s,e,[]).push(t)}),g.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach(function(e){return r.add(e)})}}),g.postStyleProps.forEach(function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach(function(e){return r.add(e)})})}});if(O.length){var P=[];O.forEach(function(e){P.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return P.push("- ".concat(e,"\n"))})}),E.forEach(function(e){return e.destroy()}),this.reportError(P)}var I=new Map,T=new Map;a.forEach(function(e){var t=e.element;r.has(t)&&(T.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,I))}),i.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){PE(I,t,[]).push(e),e.destroy()})});var A=g.filter(function(e){return oS(e,u,c)}),N=new Map;XO(N,this.driver,m,c,"*").forEach(function(e){oS(e,u,c)&&A.push(e)});var x=new Map;d.forEach(function(e,t){XO(x,n.driver,new Set(e),u,"!")}),A.forEach(function(e){var t=N.get(e),n=x.get(e);N.set(e,Object.assign(Object.assign({},t),n))});var R=[],M=[],D={};a.forEach(function(e){var t=e.element,a=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return a.onDestroy(function(){return YE(t,s.toStyles)}),a.disabled=!0,a.overrideTotalTime(s.totalTime),void i.push(a);var u=D;if(T.size>1){for(var c=t,h=[];c=c.parentNode;){var f=T.get(c);if(f){u=f;break}h.push(c)}h.forEach(function(e){return T.set(e,u)})}var d=n._buildAnimation(a.namespaceId,s,I,o,x,N);if(a.setRealPlayer(d),u===D)R.push(a);else{var p=n.playersByElement.get(u);p&&p.length&&(a.parentPlayer=kE(p)),i.push(a)}}else KE(t,s.fromStyles),a.onDestroy(function(){return YE(t,s.toStyles)}),M.push(a),l.has(t)&&i.push(a)}),M.forEach(function(e){var t=o.get(e.element);if(t&&t.length){var n=kE(t);e.setRealPlayer(n)}}),i.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var L=0;L<g.length;L++){var B=g[L],F=B.__ng_removed;if(nS(B,"ng-leave"),!F||!F.hasAnimation){var j=[];if(s.size){var U=s.get(B);U&&U.length&&j.push.apply(j,Up(U));for(var V=this.driver.query(B,".ng-animating",!0),z=0;z<V.length;z++){var H=s.get(V[z]);H&&H.length&&j.push.apply(j,Up(H))}}var G=j.filter(function(e){return!e.destroyed});G.length?rS(this,B,G):this.processLeaveNode(B)}}return g.length=0,R.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),R}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t.__ng_removed;return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,i){var o=[];if(t){var a=this.playersByQueriedElement.get(e);a&&(o=a)}else{var s=this.playersByElement.get(e);if(s){var u=!i||"void"==i;s.forEach(function(e){e.queued||(u||e.triggerName==r)&&o.push(e)})}}return(n||r)&&(o=o.filter(function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)})),o}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,i=this,o=t.element,a=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=zp(t.timelines);try{var c=function(){var e=r.value.element,u=e!==o,c=PE(n,e,[]);i._getPreviousPlayers(e,u,a,s,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}KE(o,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,i,o){var a=this,s=t.triggerName,u=t.element,c=[],l=new Set,h=new Set,f=t.timelines.map(function(t){var f=t.element;l.add(f);var d=f.__ng_removed;if(d&&d.removedBeforeQueried)return new bE(t.duration,t.delay);var p,v,g=f!==u,y=(p=(n.get(f)||HO).map(function(e){return e.getRealPlayer()}),v=[],iS(p,v),v).filter(function(e){return!!e.element&&e.element===f}),m=i.get(f),b=o.get(f),_=CE(0,a._normalizer,0,t.keyframes,m,b),w=a._buildPlayer(t,_,y);if(t.subTimeline&&r&&h.add(f),g){var k=new YO(e,s,f);k.setRealPlayer(w),c.push(k)}return w});c.forEach(function(e){PE(a.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var o=r.indexOf(n);r.splice(o,1)}0==r.length&&delete e[t]}return r}(a.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return tS(e,"ng-animating")});var d=kE(f);return d.onDestroy(function(){l.forEach(function(e){return nS(e,"ng-animating")}),YE(u,t.toStyles)}),h.forEach(function(e){PE(r,e,[]).push(d)}),d}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new bE(e.duration,e.delay)}}]),e}(),YO=function(){function e(t,n,r){Qp(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new bE,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return Kp(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return EE(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){PE(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function KO(e){return e&&1===e.nodeType}function JO(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function XO(e,t,n,r,i){var o=[];n.forEach(function(e){return o.push(JO(e))});var a=[];r.forEach(function(n,r){var o={};n.forEach(function(e){var n=o[e]=t.computeStyle(r,e,i);n&&0!=n.length||(r.__ng_removed=qO,a.push(r))}),e.set(r,o)});var s=0;return n.forEach(function(e){return JO(e,o[s++])}),a}function eS(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var r=new Set(t),i=new Map;function o(e){if(!e)return 1;var t=i.get(e);if(t)return t;var a=e.parentNode;return t=n.has(a)?a:r.has(a)?1:o(a),i.set(e,t),t}return t.forEach(function(e){var t=o(e);1!==t&&n.get(t).push(e)}),n}function tS(e,t){if(e.classList)e.classList.add(t);else{var n=e.$$classes;n||(n=e.$$classes={}),n[t]=!0}}function nS(e,t){if(e.classList)e.classList.remove(t);else{var n=e.$$classes;n&&delete n[t]}}function rS(e,t,n){kE(n).onDone(function(){return e.processLeaveNode(t)})}function iS(e,t){for(var n=0;n<e.length;n++){var r=e[n];r instanceof _E?iS(r.players,t):t.push(r)}}function oS(e,t,n){var r=n.get(e);if(!r)return!1;var i=t.get(e);return i?r.forEach(function(e){return i.add(e)}):t.set(e,r),n.delete(e),!0}var aS=function(){function e(t,n,r){var i=this;Qp(this,e),this.bodyNode=t,this._driver=n,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new QO(t,n,r),this._timelineEngine=new zO(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return i.onRemovalComplete(e,t)}}return Kp(e,[{key:"registerTrigger",value:function(e,t,n,r,i){var o=e+"-"+r,a=this._triggerCache[o];if(!a){var s=[],u=dO(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));a=function(e,t){return new jO(e,t)}(r,u),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var i=Bp(IE(n),2),o=i[0],a=i[1];this._timelineEngine.command(o,t,a,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,i){if("@"==n.charAt(0)){var o=Bp(IE(n),2),a=o[0],s=o[1];return this._timelineEngine.listen(a,t,s,i)}return this._transitionEngine.listen(e,t,n,r,i)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function sS(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=cS(t[0]),t.length>1&&(r=cS(t[t.length-1]))):t&&(n=cS(t)),n||r?new uS(e,n,r):null}var uS=function(){var e=function(){function e(t,n,r){Qp(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}return Kp(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&YE(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(YE(this._element,this._initialStyles),this._endStyles&&(YE(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(KE(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(KE(this._element,this._endStyles),this._endStyles=null),YE(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function cS(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];lS(i)&&((t=t||{})[i]=e[i])}return t}function lS(e){return"display"===e||"position"===e}var hS=function(){function e(t,n,r,i,o,a,s){var u=this;Qp(this,e),this._element=t,this._name=n,this._duration=r,this._delay=i,this._easing=o,this._fillMode=a,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return Kp(e,[{key:"apply",value:function(){var e,t,n;e=this._element,t="".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name),(n=yS(e,"").trim()).length&&(function(e,t){for(var n=0;n<e.length;n++)e.charAt(n)}(n),t="".concat(n,", ").concat(t)),gS(e,"",t),vS(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){fS(this._element,this._name,"paused")}},{key:"resume",value:function(){fS(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=dS(this._element,this._name);this._position=e*this._duration,gS(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),vS(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){var e,t,n,r;this._destroyed||(this._destroyed=!0,this.finish(),e=this._element,t=this._name,n=yS(e,"").split(","),(r=pS(n,t))>=0&&(n.splice(r,1),gS(e,"",n.join(","))))}}]),e}();function fS(e,t,n){gS(e,"PlayState",n,dS(e,t))}function dS(e,t){var n=yS(e,"");return n.indexOf(",")>0?pS(n.split(","),t):pS([n],t)}function pS(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function vS(e,t,n){n?e.removeEventListener("animationend",t):e.addEventListener("animationend",t)}function gS(e,t,n,r){var i="animation"+t;if(null!=r){var o=e.style[i];if(o.length){var a=o.split(",");a[r]=n,n=a.join(",")}}e.style[i]=n}function yS(e,t){return e.style["animation"+t]||""}var mS=function(){function e(t,n,r,i,o,a,s,u){Qp(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=o,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=a||"linear",this.totalTime=i+o,this._buildStyler()}return Kp(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new hS(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:uO(e.element,r))})}this.currentSnapshot=t}}]),e}(),bS=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=jE(r),i}return Kp(n,[{key:"init",value:function(){var e=this;!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),$p(iv(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),$p(iv(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;this._startingStyles&&(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,$p(iv(n.prototype),"destroy",this).call(this))}}]),n}(bE),_S=function(){function e(){Qp(this,e),this._count=0,this._head=document.querySelector("head")}return Kp(e,[{key:"validateStyleProperty",value:function(e){return DE(e)}},{key:"matchesElement",value:function(e,t){return LE(e,t)}},{key:"containsElement",value:function(e,t){return BE(e,t)}},{key:"query",value:function(e,t,n){return FE(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return jE(e)});var r="@keyframes ".concat(t," {\n"),i="";n.forEach(function(e){i=" ";var t=parseFloat(e.offset);r+="".concat(i).concat(100*t,"% {\n"),i+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(t,": ").concat(n,";\n"))}}),r+="".concat(i,"}\n")}),r+="}\n";var o=document.createElement("style");return o.textContent=r,o}},{key:"animate",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=o.filter(function(e){return e instanceof mS}),s={};oO(n,r)&&a.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"!=n&&"easing"!=n&&(t[n]=e[n])})}),t}(t=aO(e,t,s));if(0==n)return new bS(e,u);var c="gen_css_kf_"+this._count++,l=this.buildKeyframeElement(e,c,t);document.querySelector("head").appendChild(l);var h=sS(e,t),f=new mS(e,t,c,n,r,i,u,h);return f.onDestroy(function(){var e;(e=l).parentNode.removeChild(e)}),f}}]),e}(),wS=function(){function e(t,n,r,i){Qp(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return Kp(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:uO(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),kS=function(){function e(){Qp(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(CS().toString()),this._cssKeyframesDriver=new _S}return Kp(e,[{key:"validateStyleProperty",value:function(e){return DE(e)}},{key:"matchesElement",value:function(e,t){return LE(e,t)}},{key:"containsElement",value:function(e,t){return BE(e,t)}},{key:"query",value:function(e,t,n){return FE(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=arguments.length>6?arguments[6]:void 0;if(!a&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,o);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=o.filter(function(e){return e instanceof wS});oO(n,r)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return u[e]=t[e]})});var l=sS(e,t=aO(e,t=t.map(function(e){return $E(e,!1)}),u));return new wS(e,t,s,l)}}]),e}();function CS(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}var ES,OS=((ES=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this))._nextAnimationId=0,i._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Vp.R.None,styles:[],data:{animation:[]}}),i}return Kp(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?gE(e):e;return IS(this._renderer,null,t,"register",[n]),new SS(t,this._renderer)}}]),n}(vE)).\u0275fac=function(e){return new(e||ES)(Vp.Zb(Vp.F),Vp.Zb(Zp))},ES.\u0275prov=Vp.Hb({token:ES,factory:ES.\u0275fac}),ES),SS=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this))._id=e,i._renderer=r,i}return Kp(n,[{key:"create",value:function(e,t){return new PS(this._id,e,t||{},this._renderer)}}]),n}(function(){return function e(){Qp(this,e)}}()),PS=function(){function e(t,n,r,i){Qp(this,e),this.id=t,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return Kp(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return IS(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset")}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function IS(e,t,n,r,i){return e.setProperty(t,"@@".concat(n,":").concat(r),i)}var TS,AS,NS,xS=((TS=function(){function e(t,n,r){Qp(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return Kp(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var i=this._rendererCache.get(r);return i||(i=new RS("",r,this.engine),this._rendererCache.set(r,i)),i}var o=t.id,a=t.id+"-"+this._currentId;return this._currentId++,this.engine.register(a,e),t.data.animation.forEach(function t(r){Array.isArray(r)?r.forEach(t):n.engine.registerTrigger(o,a,e,r.name,r)}),new MS(this,a,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return t(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var t=Bp(e,2);(0,t[0])(t[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}()).\u0275fac=function(e){return new(e||TS)(Vp.Zb(Vp.F),Vp.Zb(aS),Vp.Zb(Vp.A))},TS.\u0275prov=Vp.Hb({token:TS,factory:TS.\u0275fac}),TS),RS=function(){function e(t,n,r){Qp(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return Kp(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&"@.disabled"==t?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),MS=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this,r,i,o)).factory=e,a.namespaceId=r,a}return Kp(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&"@.disabled"==t?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r,i,o=this;if("@"==t.charAt(0)){var a,s=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),u=t.substr(1),c="";return"@"!=u.charAt(0)&&(i=(r=u).indexOf("."),u=(a=Bp([r.substring(0,i),r.substr(i+1)],2))[0],c=a[1]),this.engine.listen(this.namespaceId,s,u,c,function(e){o.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}]),n}(RS),DS=((AS=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){return Qp(this,n),t.call(this,e.body,r,i)}return n}(aS)).\u0275fac=function(e){return new(e||AS)(Vp.Zb(Zp),Vp.Zb(zE),Vp.Zb(xO))},AS.\u0275prov=Vp.Hb({token:AS,factory:AS.\u0275fac}),AS),LS=[{provide:zE,useFactory:function(){return"function"==typeof CS()?new kS:new _S}},{provide:new Vp.r("AnimationModuleType"),useValue:"BrowserAnimations"},{provide:vE,useClass:OS},{provide:xO,useFactory:function(){return new RO}},{provide:aS,useClass:DS},{provide:Vp.F,useFactory:function(e,t,n){return new xS(e,t,n)},deps:[ry,aS,Vp.A]}],BS=((NS=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||NS)},NS.\u0275mod=Vp.Jb({type:NS}),NS.\u0275inj=Vp.Ib({providers:LS,imports:[my]}),NS),FS=jp("Hfs6"),jS=jp.n(FS),US=jp("spgP"),VS=jp("D0XW");function zS(){return function(e){return e.lift(new HS)}}var HS=function(){function e(){Qp(this,e)}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new GS(e))}}]),e}(),GS=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).hasPrev=!1,r}return Kp(n,[{key:"_next",value:function(e){var t;this.hasPrev?t=[this.prev,e]:this.hasPrev=!0,this.prev=e,t&&this.destination.next(t)}}]),n}(Pb.a),qS=function(){function e(t,n){Qp(this,e),this.compare=t,this.keySelector=n}return Kp(e,[{key:"call",value:function(e,t){return t.subscribe(new WS(e,this.compare,this.keySelector))}}]),e}(),WS=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e)).keySelector=i,o.hasKey=!1,"function"==typeof r&&(o.compare=r),o}return Kp(n,[{key:"compare",value:function(e,t){return e===t}},{key:"_next",value:function(e){var t;try{var n=this.keySelector;t=n?n(e):e}catch(i){return this.destination.error(i)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,t)}catch(i){return this.destination.error(i)}else this.hasKey=!0;r||(this.key=t,this.destination.next(e))}}]),n}(Pb.a),$S=jp("pxpQ"),ZS=jp("Jgta"),QS=jp("zIRd"),YS=jp("mrSG"),KS=jp("qOnz"),JS=jp("q/0M"),XS=function(e,t){return(XS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function eP(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var tP,nP="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},rP=rP||{},iP=nP||self;function oP(){}function aP(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function sP(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var uP="closure_uid_"+(1e9*Math.random()>>>0),cP=0;function lP(e,t,n){return e.call.apply(e.bind,arguments)}function hP(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function fP(e,t,n){return(fP=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?lP:hP).apply(null,arguments)}function dP(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function pP(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function vP(){this.s=this.s,this.o=this.o}var gP={};vP.prototype.s=!1,vP.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,uP)&&e[uP]||(e[uP]=++cP)}(this);delete gP[e]}},vP.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var yP=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},mP=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function bP(e){return Array.prototype.concat.apply([],arguments)}function _P(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function wP(e){return/^[\s\xa0]*$/.test(e)}var kP,CP=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function EP(e,t){return-1!=e.indexOf(t)}function OP(e,t){return e<t?-1:e>t?1:0}e:{var SP=iP.navigator;if(SP){var PP=SP.userAgent;if(PP){kP=PP;break e}}kP=""}function IP(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function TP(e){var t={};for(var n in e)t[n]=e[n];return t}var AP="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function NP(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<AP.length;o++)n=AP[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function xP(e){return xP[" "](e),e}xP[" "]=oP;var RP,MP,DP=EP(kP,"Opera"),LP=EP(kP,"Trident")||EP(kP,"MSIE"),BP=EP(kP,"Edge"),FP=BP||LP,jP=EP(kP,"Gecko")&&!(EP(kP.toLowerCase(),"webkit")&&!EP(kP,"Edge"))&&!(EP(kP,"Trident")||EP(kP,"MSIE"))&&!EP(kP,"Edge"),UP=EP(kP.toLowerCase(),"webkit")&&!EP(kP,"Edge");function VP(){var e=iP.document;return e?e.documentMode:void 0}e:{var zP="",HP=(MP=kP,jP?/rv:([^\);]+)(\)|;)/.exec(MP):BP?/Edge\/([\d\.]+)/.exec(MP):LP?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(MP):UP?/WebKit\/(\S+)/.exec(MP):DP?/(?:Version)[ \/]?(\S+)/.exec(MP):void 0);if(HP&&(zP=HP?HP[1]:""),LP){var GP=VP();if(null!=GP&&GP>parseFloat(zP)){RP=String(GP);break e}}RP=zP}var qP={},WP=iP.document&&LP&&(VP()||parseInt(RP,10))||void 0,$P=function(){if(!iP.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{iP.addEventListener("test",oP,t),iP.removeEventListener("test",oP,t)}catch(n){}return e}();function ZP(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function QP(e,t){if(ZP.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(jP){e:{try{xP(t.nodeName);var i=!0;break e}catch(o){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:YP[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&QP.Z.h.call(this)}}ZP.prototype.h=function(){this.defaultPrevented=!0},pP(QP,ZP);var YP={2:"touch",3:"pen",4:"mouse"};QP.prototype.h=function(){QP.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var KP="closure_listenable_"+(1e6*Math.random()|0),JP=0;function XP(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++JP,this.ca=this.fa=!1}function eI(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function tI(e){this.src=e,this.g={},this.h=0}function nI(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],o=yP(i,t);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(eI(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function rI(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.ca&&o.listener==t&&o.capture==!!n&&o.ia==r)return i}return-1}tI.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.g[o])||(e=this.g[o]=[],this.h++);var a=rI(e,t,r,i);return-1<a?(t=e[a],n||(t.fa=!1)):((t=new XP(t,this.src,o,!!r,i)).fa=n,e.push(t)),t};var iI="closure_lm_"+(1e6*Math.random()|0),oI={};function aI(e,t,n,r,i){if(r&&r.once)return uI(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)aI(e,t[o],n,r,i);return null}return n=vI(n),e&&e[KP]?e.N(t,n,sP(r)?!!r.capture:!!r,i):sI(e,t,n,!1,r,i)}function sI(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=sP(i)?!!i.capture:!!i,s=dI(e);if(s||(e[iI]=s=new tI(e)),(n=s.add(t,n,r,a,o)).proxy)return n;if(r=function(){var e=fI;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)$P||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(hI(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function uI(e,t,n,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)uI(e,t[o],n,r,i);return null}return n=vI(n),e&&e[KP]?e.O(t,n,sP(r)?!!r.capture:!!r,i):sI(e,t,n,!0,r,i)}function cI(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)cI(e,t[o],n,r,i);else r=sP(r)?!!r.capture:!!r,n=vI(n),e&&e[KP]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=rI(o=e.g[t],n,r,i))&&(eI(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.g[t],e.h--))):e&&(e=dI(e))&&(t=e.g[t.toString()],e=-1,t&&(e=rI(t,n,r,i)),(n=-1<e?t[e]:null)&&lI(n))}function lI(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[KP])nI(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(hI(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=dI(t))?(nI(n,e),0==n.h&&(n.src=null,t[iI]=null)):eI(e)}}}function hI(e){return e in oI?oI[e]:oI[e]="on"+e}function fI(e,t){if(e.ca)e=!0;else{t=new QP(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&lI(e),e=n.call(r,t)}return e}function dI(e){return(e=e[iI])instanceof tI?e:null}var pI="__closure_events_fn_"+(1e9*Math.random()>>>0);function vI(e){return"function"==typeof e?e:(e[pI]||(e[pI]=function(t){return e.handleEvent(t)}),e[pI])}function gI(){vP.call(this),this.i=new tI(this),this.P=this,this.I=null}function yI(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new ZP(t,e);else if(t instanceof ZP)t.target=t.target||e;else{var i=t;NP(t=new ZP(r,e),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=t.g=n[o];i=mI(a,r,!0,t)&&i}if(i=mI(a=t.g=e,r,!0,t)&&i,i=mI(a,r,!1,t)&&i,n)for(o=0;o<n.length;o++)i=mI(a=t.g=n[o],r,!1,t)&&i}function mI(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.ca&&a.capture==n){var s=a.listener,u=a.ia||a.src;a.fa&&nI(e.i,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}pP(gI,vP),gI.prototype[KP]=!0,gI.prototype.removeEventListener=function(e,t,n,r){cI(this,e,t,n,r)},gI.prototype.M=function(){if(gI.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)eI(n[r]);delete t.g[e],t.h--}}this.I=null},gI.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},gI.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var bI=iP.JSON.stringify;function _I(){var e=II,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var wI,kI=function(){function e(){this.h=this.g=null}return e.prototype.add=function(e,t){var n=CI.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n},e}(),CI=new(function(){function e(e,t){this.i=e,this.j=t,this.h=0,this.g=null}return e.prototype.get=function(){var e;return 0<this.h?(this.h--,this.g=(e=this.g).next,e.next=null):e=this.i(),e},e}())(function(){return new EI},function(e){return e.reset()}),EI=function(){function e(){this.next=this.g=this.h=null}return e.prototype.set=function(e,t){this.h=e,this.g=t,this.next=null},e.prototype.reset=function(){this.next=this.g=this.h=null},e}();function OI(e){iP.setTimeout(function(){throw e},0)}function SI(e,t){wI||function(){var e=iP.Promise.resolve(void 0);wI=function(){e.then(TI)}}(),PI||(wI(),PI=!0),II.add(e,t)}var PI=!1,II=new kI;function TI(){for(var e;e=_I();){try{e.h.call(e.g)}catch(n){OI(n)}var t=CI;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}PI=!1}function AI(e,t){gI.call(this),this.h=e||1,this.g=t||iP,this.j=fP(this.kb,this),this.l=Date.now()}function NI(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function xI(e,t,n){if("function"==typeof e)n&&(e=fP(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=fP(e.handleEvent,e)}return 2147483647<Number(t)?-1:iP.setTimeout(e,t||0)}function RI(e){e.g=xI(function(){e.g=null,e.i&&(e.i=!1,RI(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}pP(AI,gI),(tP=AI.prototype).da=!1,tP.S=null,tP.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),yI(this,"tick"),this.da&&(NI(this),this.start()))}},tP.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},tP.M=function(){AI.Z.M.call(this),NI(this),delete this.g};var MI=function(e){function t(t,n){var r=e.call(this)||this;return r.m=t,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}XS(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.l=function(e){this.h=arguments,this.g?this.i=!0:RI(this)},t.prototype.M=function(){e.prototype.M.call(this),this.g&&(iP.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},t}(vP);function DI(e){vP.call(this),this.h=e,this.g={}}pP(DI,vP);var LI=[];function BI(e,t,n,r){Array.isArray(n)||(n&&(LI[0]=n.toString()),n=LI);for(var i=0;i<n.length;i++){var o=aI(t,n[i],r||e.handleEvent,!1,e.h||e);if(!o)break;e.g[o.key]=o}}function FI(e){IP(e.g,function(e,t){this.g.hasOwnProperty(t)&&lI(e)},e),e.g={}}function jI(){this.g=!0}function UI(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return bI(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}DI.prototype.M=function(){DI.Z.M.call(this),FI(this)},DI.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},jI.prototype.Aa=function(){this.g=!1},jI.prototype.info=function(){};var VI={},zI=null;function HI(){return zI=zI||new gI}function GI(e){ZP.call(this,VI.Ma,e)}function qI(e){var t=HI();yI(t,new GI(t,e))}function WI(e,t){ZP.call(this,VI.STAT_EVENT,e),this.stat=t}function $I(e){var t=HI();yI(t,new WI(t,e))}function ZI(e,t){ZP.call(this,VI.Na,e),this.size=t}function QI(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return iP.setTimeout(function(){e()},t)}VI.Ma="serverreachability",pP(GI,ZP),VI.STAT_EVENT="statevent",pP(WI,ZP),VI.Na="timingevent",pP(ZI,ZP);var YI={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},KI={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function JI(){}function XI(){}JI.prototype.h=null;var eT,tT={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function nT(){ZP.call(this,"d")}function rT(){ZP.call(this,"c")}function iT(){}function oT(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new DI(this),this.P=sT,this.W=new AI(e=FP?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new aT}function aT(){this.i=null,this.g="",this.h=!1}pP(nT,ZP),pP(rT,ZP),pP(iT,JI),iT.prototype.g=function(){return new XMLHttpRequest},iT.prototype.i=function(){return{}},eT=new iT;var sT=45e3,uT={},cT={};function lT(e,t,n){e.K=1,e.v=RT(PT(t)),e.s=n,e.U=!0,hT(e,null)}function hT(e,t){e.F=Date.now(),vT(e),e.A=PT(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),WT(n.h,"t",r),e.C=0,n=e.l.H,e.h=new aT,e.g=$A(e.l,n?t:null,!e.s),0<e.O&&(e.L=new MI(fP(e.Ia,e,e.g),e.O)),BI(e.V,e.g,"readystatechange",e.gb),t=e.H?TP(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),qI(1),function(e,t,n,r,i,o){e.info(function(){if(e.g)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");a=2<=h.length&&"type"==h[1]?a+(l+"=")+c+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a})}(e.j,e.u,e.A,e.m,e.X,e.s)}function fT(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function dT(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=pT(e,n))==cT){4==t&&(e.o=4,$I(14),i=!1),UI(e.j,e.m,null,"[Incomplete Response]");break}if(r==uT){e.o=4,$I(15),UI(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}UI(e.j,e.m,r,null),_T(e,r)}fT(e)&&r!=cT&&r!=uT&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,$I(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),jA(t),t.L=!0,$I(11))):(UI(e.j,e.m,n,"[Invalid Chunked Response]"),bT(e),mT(e))}function pT(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?cT:(n=Number(t.substring(n,r)),isNaN(n)?uT:(r+=1)+n>t.length?cT:(t=t.substr(r,n),e.C=r+n,t))}function vT(e){e.Y=Date.now()+e.P,gT(e,e.P)}function gT(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=QI(fP(e.eb,e),t)}function yT(e){e.B&&(iP.clearTimeout(e.B),e.B=null)}function mT(e){0==e.l.G||e.I||zA(e.l,e)}function bT(e){yT(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,NI(e.W),FI(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function _T(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||XT(n.i,e)))if(n.I=e.N,!e.J&&XT(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;VA(n),AA(n)}FA(n),$I(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=QI(fP(n.ab,n),6e3));if(1>=JT(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else GA(n,11)}else if((e.J||n.g==e)&&VA(n),!wP(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var o=i[t];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var a=o[3];null!=a&&(n.ma=a,n.h.info("VER="+n.ma));var s=o[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(EP(l,"spdy")||EP(l,"quic")||EP(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(eA(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,xT(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=WA(r,r.H?r.la:null,r.W),d.J){tA(r.i,d);var p=d,v=r.K;v&&p.setTimeout(v),p.B&&(yT(p),vT(p)),r.g=d}else BA(r);0<n.l.length&&RA(n)}else"stop"!=o[0]&&"close"!=o[0]||GA(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?GA(n,7):TA(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}qI(4)}catch(o){}}function wT(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(aP(e)||"string"==typeof e)mP(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(aP(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(aP(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function kT(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof kT)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function CT(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];ET(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)ET(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function ET(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(tP=oT.prototype).setTimeout=function(e){this.P=e},tP.gb=function(e){e=e.target;var t=this.L;t&&3==EA(e)?t.l():this.Ia(e)},tP.Ia=function(e){try{if(e==this.g)e:{var t=EA(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||FP||this.g&&(this.h.h||this.g.ga()||OA(this.g)))){this.I||4!=t||7==n||qI(8==n||0>=r?3:2),yT(this);var i=this.g.ba();this.N=i;t:if(fT(this)){var o=OA(this.g);e="";var a=o.length,s=4==EA(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){bT(this),mT(this);var u="";break t}this.h.i=new iP.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,e+=this.h.i.decode(o[n],{stream:s&&n==a-1});o.splice(0,a),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,o,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+a})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!wP(c)){var h=c;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,$I(12),bT(this),mT(this);break e}UI(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,_T(this,i)}this.U?(dT(this,t,u),FP&&this.i&&3==t&&(BI(this.V,this.W,"tick",this.fb),this.W.start())):(UI(this.j,this.m,u,null),_T(this,u)),4==t&&bT(this),this.i&&!this.I&&(4==t?zA(this.l,this):(this.i=!1,vT(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,$I(12)):(this.o=0,$I(13)),bT(this),mT(this)}}}catch(t){}},tP.fb=function(){if(this.g){var e=EA(this.g),t=this.g.ga();this.C<t.length&&(yT(this),dT(this,e,t),this.i&&4!=e&&vT(this))}},tP.cancel=function(){this.I=!0,bT(this)},tP.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(qI(3),$I(17)),bT(this),this.o=2,mT(this)):gT(this,this.Y-e)},(tP=kT.prototype).R=function(){CT(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},tP.T=function(){return CT(this),this.g.concat()},tP.get=function(e,t){return ET(this.h,e)?this.h[e]:t},tP.set=function(e,t){ET(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},tP.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var OT=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ST(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof ST){this.g=void 0!==t?t:e.g,IT(this,e.j),this.s=e.s,TT(this,e.i),AT(this,e.m),this.l=e.l,t=e.h;var n=new zT;n.i=t.i,t.g&&(n.g=new kT(t.g),n.h=t.h),NT(this,n),this.o=e.o}else e&&(n=String(e).match(OT))?(this.g=!!t,IT(this,n[1]||"",!0),this.s=MT(n[2]||""),TT(this,n[3]||"",!0),AT(this,n[4]),this.l=MT(n[5]||"",!0),NT(this,n[6]||"",!0),this.o=MT(n[7]||"")):(this.g=!!t,this.h=new zT(null,this.g))}function PT(e){return new ST(e)}function IT(e,t,n){e.j=n?MT(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function TT(e,t,n){e.i=n?MT(t,!0):t}function AT(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function NT(e,t,n){t instanceof zT?(e.h=t,function(e,t){t&&!e.j&&(HT(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(GT(this,t),WT(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=DT(t,UT)),e.h=new zT(t,e.g))}function xT(e,t,n){e.h.set(t,n)}function RT(e){return xT(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function MT(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function DT(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,LT),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function LT(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ST.prototype.toString=function(){var e=[],t=this.j;t&&e.push(DT(t,BT,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(DT(t,BT,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(DT(n,"/"==n.charAt(0)?jT:FT,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",DT(n,VT)),e.join("")};var BT=/[#\/\?@]/g,FT=/[#\?:]/g,jT=/[#\?]/g,UT=/[#\?@]/g,VT=/#/g;function zT(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function HT(e){e.g||(e.g=new kT,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function GT(e,t){HT(e),t=$T(e,t),ET(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,ET((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&CT(e)))}function qT(e,t){return HT(e),t=$T(e,t),ET(e.g.h,t)}function WT(e,t,n){GT(e,t),0<n.length&&(e.i=null,e.g.set($T(e,t),_P(n)),e.h+=n.length)}function $T(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(tP=zT.prototype).add=function(e,t){HT(this),this.i=null,e=$T(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},tP.forEach=function(e,t){HT(this),this.g.forEach(function(n,r){mP(n,function(n){e.call(t,n,r,this)},this)},this)},tP.T=function(){HT(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},tP.R=function(e){HT(this);var t=[];if("string"==typeof e)qT(this,e)&&(t=bP(t,this.g.get($T(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=bP(t,e[n])}return t},tP.set=function(e,t){return HT(this),this.i=null,qT(this,e=$T(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},tP.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},tP.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.i=e.join("&")};var ZT=function(e,t){this.h=e,this.g=t};function QT(e){this.l=e||YT,e=iP.PerformanceNavigationTiming?0<(e=iP.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(iP.g&&iP.g.Ea&&iP.g.Ea()&&iP.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var YT=10;function KT(e){return!!e.h||!!e.g&&e.g.size>=e.j}function JT(e){return e.h?1:e.g?e.g.size:0}function XT(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function eA(e,t){e.g?e.g.add(t):e.h=t}function tA(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nA(e){var t,n;if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var r=e.i;try{for(var i=eP(e.g.values()),o=i.next();!o.done;o=i.next())r=r.concat(o.value.D)}catch(a){t={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}return _P(e.i)}function rA(){}function iA(){this.g=new rA}function oA(e,t,n){var r=n||"";try{wT(e,function(e,n){var i=e;sP(e)&&(i=bI(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(fV){throw t.push(r+"type="+encodeURIComponent("_badmap")),fV}}function aA(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(o){}}function sA(e){this.l=e.$b||null,this.j=e.ib||!1}function uA(e,t){gI.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=cA,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}QT.prototype.cancel=function(){var e,t;if(this.i=nA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=eP(this.g.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(i){e={error:i}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.g.clear()}},rA.prototype.stringify=function(e){return iP.JSON.stringify(e,void 0)},rA.prototype.parse=function(e){return iP.JSON.parse(e,void 0)},pP(sA,JI),sA.prototype.g=function(){return new uA(this.l,this.j)},sA.prototype.i=function(e){return function(){return e}}({}),pP(uA,gI);var cA=0;function lA(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function hA(e){e.readyState=4,e.l=null,e.j=null,e.A=null,fA(e)}function fA(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(tP=uA.prototype).open=function(e,t){if(this.readyState!=cA)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,fA(this)},tP.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||iP).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},tP.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,hA(this)),this.readyState=cA},tP.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,fA(this)),this.g&&(this.readyState=3,fA(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==iP.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;lA(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},tP.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?hA(this):fA(this),3==this.readyState&&lA(this)}},tP.Ua=function(e){this.g&&(this.response=this.responseText=e,hA(this))},tP.Ta=function(e){this.g&&(this.response=e,hA(this))},tP.ha=function(){this.g&&hA(this)},tP.setRequestHeader=function(e,t){this.v.append(e,t)},tP.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},tP.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(uA.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var dA=iP.JSON.parse;function pA(e){gI.call(this),this.headers=new kT,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=vA,this.K=this.L=!1}pP(pA,gI);var vA="",gA=/^https?$/i,yA=["POST","PUT"];function mA(e){return"content-type"==e.toLowerCase()}function bA(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,_A(e),kA(e)}function _A(e){e.D||(e.D=!0,yI(e,"complete"),yI(e,"error"))}function wA(e){if(e.h&&void 0!==rP&&(!e.C[1]||4!=EA(e)||2!=e.ba()))if(e.v&&4==EA(e))xI(e.Fa,0,e);else if(yI(e,"readystatechange"),4==EA(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.H).match(OT)[1]||null;if(!o&&iP.self&&iP.self.location){var a=iP.self.location.protocol;o=a.substr(0,a.length-1)}i=!gA.test(o?o.toLowerCase():"")}t=i}if(t)yI(e,"complete"),yI(e,"success");else{e.m=6;try{var s=2<EA(e)?e.g.statusText:""}catch(u){s=""}e.j=s+" ["+e.ba()+"]",_A(e)}}finally{kA(e)}}}function kA(e,t){if(e.g){CA(e);var n=e.g,r=e.C[0]?oP:null;e.g=null,e.C=null,t||yI(e,"ready");try{n.onreadystatechange=r}catch(fV){}}}function CA(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(iP.clearTimeout(e.A),e.A=null)}function EA(e){return e.g?e.g.readyState:0}function OA(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case vA:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function SA(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return IP(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):xT(e,t,n))}function PA(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function IA(e){this.za=0,this.l=[],this.h=new jI,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=PA("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=PA("baseRetryDelayMs",5e3,e),this.$a=PA("retryDelaySeedMs",1e4,e),this.Ya=PA("forwardChannelMaxRetries",2,e),this.ra=PA("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new QT(e&&e.concurrentRequestLimit),this.Ca=new iA,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function TA(e){if(NA(e),3==e.G){var t=e.V++,n=PT(e.F);xT(n,"SID",e.J),xT(n,"RID",t),xT(n,"TYPE","terminate"),DA(e,n),(t=new oT(e,e.h,t,void 0)).K=2,t.v=RT(PT(n)),n=!1,iP.navigator&&iP.navigator.sendBeacon&&(n=iP.navigator.sendBeacon(t.v.toString(),"")),!n&&iP.Image&&((new Image).src=t.v,n=!0),n||(t.g=$A(t.l,null),t.g.ea(t.v)),t.F=Date.now(),vT(t)}qA(e)}function AA(e){e.g&&(jA(e),e.g.cancel(),e.g=null)}function NA(e){AA(e),e.u&&(iP.clearTimeout(e.u),e.u=null),VA(e),e.i.cancel(),e.m&&("number"==typeof e.m&&iP.clearTimeout(e.m),e.m=null)}function xA(e,t){e.l.push(new ZT(e.Za++,t)),3==e.G&&RA(e)}function RA(e){KT(e.i)||e.m||(e.m=!0,SI(e.Ha,e),e.C=0)}function MA(e,t){var n;n=t?t.m:e.V++;var r=PT(e.F);xT(r,"SID",e.J),xT(r,"RID",n),xT(r,"AID",e.U),DA(e,r),e.o&&e.s&&SA(r,e.o,e.s),n=new oT(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=LA(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),eA(e.i,n),lT(n,r,t)}function DA(e,t){e.j&&wT({},function(e,n){xT(t,n,e)})}function LA(e,t,n){n=Math.min(e.l.length,n);var r=e.j?fP(e.j.Oa,e.j,e):null;e:for(var i=e.l,o=-1;;){var a=["count="+n];-1==o?0<n?a.push("ofs="+(o=i[0].h)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),s=!1;else try{oA(l,a,"req"+c+"_")}catch(SN){r&&r(l)}}if(s){r=a.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function BA(e){e.g||e.u||(e.Y=1,SI(e.Ga,e),e.A=0)}function FA(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=QI(fP(e.Ga,e),HA(e,e.A)),e.A++,0))}function jA(e){null!=e.B&&(iP.clearTimeout(e.B),e.B=null)}function UA(e){e.g=new oT(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=PT(e.oa);xT(t,"RID","rpc"),xT(t,"SID",e.J),xT(t,"CI",e.N?"0":"1"),xT(t,"AID",e.U),DA(e,t),xT(t,"TYPE","xmlhttp"),e.o&&e.s&&SA(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=RT(PT(t)),n.s=null,n.U=!0,hT(n,e)}function VA(e){null!=e.v&&(iP.clearTimeout(e.v),e.v=null)}function zA(e,t){var n=null;if(e.g==t){VA(e),jA(e),e.g=null;var r=2}else{if(!XT(e.i,t))return;n=t.D,tA(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;yI(r=HI(),new ZI(r,n,t,i)),RA(e)}else BA(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(JT(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=QI(fP(e.Ha,e,t),HA(e,e.C)),e.C++,0)))}(e,t)||2==r&&FA(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:GA(e,5);break;case 4:GA(e,10);break;case 3:GA(e,6);break;default:GA(e,2)}}function HA(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function GA(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=fP(e.jb,e);n||(n=new ST("//www.google.com/images/cleardot.gif"),iP.location&&"http"==iP.location.protocol||IT(n,"https"),RT(n)),function(e,t){var n=new jI;if(iP.Image){var r=new Image;r.onload=dP(aA,n,r,"TestLoadImage: loaded",!0,t),r.onerror=dP(aA,n,r,"TestLoadImage: error",!1,t),r.onabort=dP(aA,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=dP(aA,n,r,"TestLoadImage: timeout",!1,t),iP.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else $I(2);e.G=0,e.j&&e.j.va(t),qA(e),NA(e)}function qA(e){e.G=0,e.I=-1,e.j&&(0==nA(e.i).length&&0==e.l.length||(e.i.i.length=0,_P(e.l),e.l.length=0),e.j.ua())}function WA(e,t,n){var r=function(e){return e instanceof ST?PT(e):new ST(e,void 0)}(n);if(""!=r.i)t&&TT(r,t+"."+r.i),AT(r,r.m);else{var i=iP.location;r=function(e,t,n,r){var i=new ST(null,void 0);return e&&IT(i,e),t&&TT(i,t),n&&AT(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&IP(e.aa,function(e,t){xT(r,t,e)}),n=e.sa,(t=e.D)&&n&&xT(r,t,n),xT(r,"VER",e.ma),DA(e,r),r}function $A(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new pA(n&&e.Ba&&!e.qa?new sA({ib:!0}):e.qa)).L=e.H,t}function ZA(){}function QA(){if(LP&&!(10<=Number(WP)))throw Error("Environmental error: no available transport.")}function YA(e,t){gI.call(this),this.g=new IA(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!wP(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!wP(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new XA(this)}function KA(e){nT.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function JA(){rT.call(this),this.status=1}function XA(e){this.g=e}(tP=pA.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():eT.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:eT),this.g.onreadystatechange=fP(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(o){return void bA(this,o)}e=n||"";var i=new kT(this.headers);r&&wT(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=mA,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=iP.FormData&&e instanceof iP.FormData,!(0<=yP(yA,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{CA(this),0<this.B&&((this.K=function(e){return LP&&function(){return e=qP,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=CP(String(RP)).split("."),n=CP("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var o=t[i]||"",a=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;e=OP(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||OP(0==o[2].length,0==a[2].length)||OP(o[2],a[2]),o=o[3],a=a[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=fP(this.pa,this)):this.A=xI(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(o){bA(this,o)}},tP.pa=function(){void 0!==rP&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,yI(this,"timeout"),this.abort(8))},tP.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,yI(this,"complete"),yI(this,"abort"),kA(this))},tP.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),kA(this,!0)),pA.Z.M.call(this)},tP.Fa=function(){this.s||(this.F||this.v||this.l?wA(this):this.cb())},tP.cb=function(){wA(this)},tP.ba=function(){try{return 2<EA(this)?this.g.status:-1}catch(MP){return-1}},tP.ga=function(){try{return this.g?this.g.responseText:""}catch(MP){return""}},tP.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),dA(t)}},tP.Da=function(){return this.m},tP.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(tP=IA.prototype).ma=8,tP.G=1,tP.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},tP.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new oT(this,this.h,e,void 0),n=this.s;if(this.P&&(n?NP(n=TP(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=LA(this,t,r),xT(i=PT(this.F),"RID",e),xT(i,"CVER",22),this.D&&xT(i,"X-HTTP-Session-Id",this.D),DA(this,i),this.o&&n&&SA(i,this.o,n),eA(this.i,t),this.Ra&&xT(i,"TYPE","init"),this.ja?(xT(i,"$req",r),xT(i,"SID","null"),t.$=!0,lT(t,i,null)):lT(t,i,r),this.G=2}}else 3==this.G&&(e?MA(this,e):0==this.l.length||KT(this.i)||MA(this))},tP.Ga=function(){if(this.u=null,UA(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=QI(fP(this.bb,this),e)}},tP.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,$I(10),AA(this),UA(this))},tP.ab=function(){null!=this.v&&(this.v=null,AA(this),FA(this),$I(19))},tP.jb=function(e){e?(this.h.info("Successfully pinged google.com"),$I(2)):(this.h.info("Failed to ping google.com"),$I(1))},(tP=ZA.prototype).xa=function(){},tP.wa=function(){},tP.va=function(){},tP.ua=function(){},tP.Oa=function(){},QA.prototype.g=function(e,t){return new YA(e,t)},pP(YA,gI),YA.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),SI(fP(e.hb,e,t))),$I(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=WA(e,null,e.W),RA(e)},YA.prototype.close=function(){TA(this.g)},YA.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,xA(this.g,t)}else this.v?((t={}).__data__=bI(e),xA(this.g,t)):xA(this.g,e)},YA.prototype.M=function(){this.g.j=null,delete this.j,TA(this.g),delete this.g,YA.Z.M.call(this)},pP(KA,nT),pP(JA,rT),pP(XA,ZA),XA.prototype.xa=function(){yI(this.g,"a")},XA.prototype.wa=function(e){yI(this.g,new KA(e))},XA.prototype.va=function(e){yI(this.g,new JA(e))},XA.prototype.ua=function(){yI(this.g,"b")},QA.prototype.createWebChannel=QA.prototype.g,YA.prototype.send=YA.prototype.u,YA.prototype.open=YA.prototype.m,YA.prototype.close=YA.prototype.close,YI.NO_ERROR=0,YI.TIMEOUT=8,YI.HTTP_ERROR=6,KI.COMPLETE="complete",XI.EventType=tT,tT.OPEN="a",tT.CLOSE="b",tT.ERROR="c",tT.MESSAGE="d",gI.prototype.listen=gI.prototype.N,pA.prototype.listenOnce=pA.prototype.O,pA.prototype.getLastError=pA.prototype.La,pA.prototype.getLastErrorCode=pA.prototype.Da,pA.prototype.getStatus=pA.prototype.ba,pA.prototype.getResponseJson=pA.prototype.Qa,pA.prototype.getResponseText=pA.prototype.ga,pA.prototype.send=pA.prototype.ea;var eN=YI,tN=KI,nN=VI,rN=sA,iN=XI,oN=pA,aN=function(){function e(e,t){var n=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return n.t(e)},this.i=function(e){return t.writeSequenceNumber(e)})}return e.prototype.t=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},e.prototype.next=function(){var e=++this.previousValue;return this.i&&this.i(e),e},e}();aN.o=-1;var sN={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},uN=function(e){function t(t,n){var r=this;return(r=e.call(this,n)||this).code=t,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(YS.c)(t,e),t}(Error),cN=new JS.b("@firebase/firestore");function lN(){return cN.logLevel}function hN(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(cN.logLevel<=JS.a.DEBUG){var r=t.map(pN);cN.debug.apply(cN,Object(YS.f)(["Firestore (8.10.0): "+e],r))}}function fN(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(cN.logLevel<=JS.a.ERROR){var r=t.map(pN);cN.error.apply(cN,Object(YS.f)(["Firestore (8.10.0): "+e],r))}}function dN(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(cN.logLevel<=JS.a.WARN){var r=t.map(pN);cN.warn.apply(cN,Object(YS.f)(["Firestore (8.10.0): "+e],r))}}function pN(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(fV){return e}}function vN(e){void 0===e&&(e="Unexpected state");var t="FIRESTORE (8.10.0) INTERNAL ASSERTION FAILED: "+e;throw fN(t),new Error(t)}function gN(e,t){e||vN()}function yN(e,t){return e}function mN(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var bN=function(){function e(){}return e.u=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=mN(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n},e}();function _N(e,t){return e<t?-1:e>t?1:0}function wN(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}function kN(e){return e+"\0"}var CN=function(){function e(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new uN(sN.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new uN(sN.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new uN(sN.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new uN(sN.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype._compareTo=function(e){return this.seconds===e.seconds?_N(this.nanoseconds,e.nanoseconds):_N(this.seconds,e.seconds)},e.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},e.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},e}(),EN=function(){function e(e){this.timestamp=e}return e.fromTimestamp=function(t){return new e(t)},e.min=function(){return new e(new CN(0,0))},e.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},e.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},e.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.toTimestamp=function(){return this.timestamp},e}();function ON(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function SN(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function PN(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var IN=function(){function e(e,t,n){void 0===t?t=0:t>e.length&&vN(),void 0===n?n=e.length-t:n>e.length-t&&vN(),this.segments=e,this.offset=t,this.len=n}return Object.defineProperty(e.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return 0===e.comparator(this,t)},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.popFirst=function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)},e.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},e.prototype.firstSegment=function(){return this.segments[this.offset]},e.prototype.lastSegment=function(){return this.get(this.length-1)},e.prototype.get=function(e){return this.segments[this.offset+e]},e.prototype.isEmpty=function(){return 0===this.length},e.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},e.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},e.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0},e}(),TN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(YS.c)(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r=[],i=0,o=e;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new uN(sN.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter(function(e){return e.length>0}))}return new t(r)},t.emptyPath=function(){return new t([])},t}(IN),AN=/^[_a-zA-Z][_a-zA-Z0-9]*$/,NN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(YS.c)(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.isValidIdentifier=function(e){return AN.test(e)},t.prototype.canonicalString=function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")},t.prototype.toString=function(){return this.canonicalString()},t.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},t.keyField=function(){return new t(["__name__"])},t.fromServerFormat=function(e){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new uN(sN.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new uN(sN.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new uN(sN.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new uN(sN.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)},t.emptyPath=function(){return new t([])},t}(IN),xN=function(){function e(e){this.fields=e,e.sort(NN.comparator)}return e.prototype.covers=function(e){for(var t=0,n=this.fields;t<n.length;t++)if(n[t].isPrefixOf(e))return!0;return!1},e.prototype.isEqual=function(e){return wN(this.fields,e.fields,function(e,t){return e.isEqual(t)})},e}(),RN=function(){function e(e){this.binaryString=e}return e.fromBase64String=function(t){return new e(atob(t))},e.fromUint8Array=function(t){return new e(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t))},e.prototype.toBase64=function(){return btoa(this.binaryString)},e.prototype.toUint8Array=function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)},e.prototype.approximateByteSize=function(){return 2*this.binaryString.length},e.prototype.compareTo=function(e){return _N(this.binaryString,e.binaryString)},e.prototype.isEqual=function(e){return this.binaryString===e.binaryString},e}();RN.EMPTY_BYTE_STRING=new RN("");var MN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function DN(e){if(gN(!!e),"string"==typeof e){var t=0,n=MN.exec(e);if(gN(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:LN(e.seconds),nanos:LN(e.nanos)}}function LN(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function BN(e){return"string"==typeof e?RN.fromBase64String(e):RN.fromUint8Array(e)}function FN(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function jN(e){var t=e.mapValue.fields.__previous_value__;return FN(t)?jN(t):t}function UN(e){var t=DN(e.mapValue.fields.__local_write_time__.timestampValue);return new CN(t.seconds,t.nanos)}function VN(e){return null==e}function zN(e){return 0===e&&1/e==-1/0}function HN(e){return"number"==typeof e&&Number.isInteger(e)&&!zN(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var GN=function(){function e(e){this.path=e}return e.fromPath=function(t){return new e(TN.fromString(t))},e.fromName=function(t){return new e(TN.fromString(t).popFirst(5))},e.prototype.hasCollectionId=function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e},e.prototype.isEqual=function(e){return null!==e&&0===TN.comparator(this.path,e.path)},e.prototype.toString=function(){return this.path.toString()},e.comparator=function(e,t){return TN.comparator(e.path,t.path)},e.isDocumentKey=function(e){return e.length%2==0},e.fromSegments=function(t){return new e(new TN(t.slice()))},e}();function qN(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?FN(e)?4:10:vN()}function WN(e,t){var n=qN(e);if(n!==qN(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return UN(e).isEqual(UN(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=DN(e.timestampValue),r=DN(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return BN(e.bytesValue).isEqual(BN(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return LN(e.geoPointValue.latitude)===LN(t.geoPointValue.latitude)&&LN(e.geoPointValue.longitude)===LN(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return LN(e.integerValue)===LN(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=LN(e.doubleValue),r=LN(t.doubleValue);return n===r?zN(n)===zN(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return wN(e.arrayValue.values||[],t.arrayValue.values||[],WN);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(ON(n)!==ON(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!WN(n[i],r[i])))return!1;return!0}(e,t);default:return vN()}}function $N(e,t){return void 0!==(e.values||[]).find(function(e){return WN(e,t)})}function ZN(e,t){var n=qN(e),r=qN(t);if(n!==r)return _N(n,r);switch(n){case 0:return 0;case 1:return _N(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=LN(e.integerValue||e.doubleValue),r=LN(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return QN(e.timestampValue,t.timestampValue);case 4:return QN(UN(e),UN(t));case 5:return _N(e.stringValue,t.stringValue);case 6:return function(e,t){var n=BN(e),r=BN(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var o=_N(n[i],r[i]);if(0!==o)return o}return _N(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=_N(LN(e.latitude),LN(t.latitude));return 0!==n?n:_N(LN(e.longitude),LN(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var o=ZN(n[i],r[i]);if(o)return o}return _N(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=_N(r[a],o[a]);if(0!==s)return s;var u=ZN(n[r[a]],i[o[a]]);if(0!==u)return u}return _N(r.length,o.length)}(e.mapValue,t.mapValue);default:throw vN()}}function QN(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return _N(e,t);var n=DN(e),r=DN(t),i=_N(n.seconds,r.seconds);return 0!==i?i:_N(n.nanos,r.nanos)}function YN(e){return KN(e)}function KN(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=DN(e);return"time("+t.seconds+","+t.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?BN(e.bytesValue).toBase64():"referenceValue"in e?GN.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo("+(t=e.geoPointValue).latitude+","+t.longitude+")":"arrayValue"in e?function(e){for(var t="[",n=!0,r=0,i=e.values||[];r<i.length;r++)n?n=!1:t+=",",t+=KN(i[r]);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var t="{",n=!0,r=0,i=Object.keys(e.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:t+=",",t+=o+":"+KN(e.fields[o])}return t+"}"}(e.mapValue):vN();var t}function JN(e,t){return{referenceValue:"projects/"+e.projectId+"/databases/"+e.database+"/documents/"+t.path.canonicalString()}}function XN(e){return!!e&&"integerValue"in e}function ex(e){return!!e&&"arrayValue"in e}function tx(e){return!!e&&"nullValue"in e}function nx(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function rx(e){return!!e&&"mapValue"in e}function ix(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return SN(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=ix(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=ix(e.arrayValue.values[r]);return n}return Object.assign({},e)}var ox=function(){function e(e){this.value=e}return e.empty=function(){return new e({mapValue:{}})},e.prototype.field=function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!rx(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null},e.prototype.set=function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ix(t)},e.prototype.setAll=function(e){var t=this,n=NN.emptyPath(),r={},i=[];e.forEach(function(e,o){if(!n.isImmediateParentOf(o)){var a=t.getFieldsMap(n);t.applyChanges(a,r,i),r={},i=[],n=o.popLast()}e?r[o.lastSegment()]=ix(e):i.push(o.lastSegment())});var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},e.prototype.delete=function(e){var t=this.field(e.popLast());rx(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]},e.prototype.isEqual=function(e){return WN(this.value,e.value)},e.prototype.getFieldsMap=function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];rx(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields},e.prototype.applyChanges=function(e,t,n){SN(t,function(t,n){return e[t]=n});for(var r=0,i=n;r<i.length;r++)delete e[i[r]]},e.prototype.clone=function(){return new e(ix(this.value))},e}();function ax(e){var t=[];return SN(e.fields,function(e,n){var r=new NN([e]);if(rx(n)){var i=ax(n.mapValue).fields;if(0===i.length)t.push(r);else for(var o=0,a=i;o<a.length;o++)t.push(r.child(a[o]))}else t.push(r)}),new xN(t)}var sx=function(){function e(e,t,n,r,i){this.key=e,this.documentType=t,this.version=n,this.data=r,this.documentState=i}return e.newInvalidDocument=function(t){return new e(t,0,EN.min(),ox.empty(),0)},e.newFoundDocument=function(t,n,r){return new e(t,1,n,r,0)},e.newNoDocument=function(t,n){return new e(t,2,n,ox.empty(),0)},e.newUnknownDocument=function(t,n){return new e(t,3,n,ox.empty(),2)},e.prototype.convertToFoundDocument=function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this},e.prototype.convertToNoDocument=function(e){return this.version=e,this.documentType=2,this.data=ox.empty(),this.documentState=0,this},e.prototype.convertToUnknownDocument=function(e){return this.version=e,this.documentType=3,this.data=ox.empty(),this.documentState=2,this},e.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},e.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(e.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isValidDocument=function(){return 0!==this.documentType},e.prototype.isFoundDocument=function(){return 1===this.documentType},e.prototype.isNoDocument=function(){return 2===this.documentType},e.prototype.isUnknownDocument=function(){return 3===this.documentType},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)},e.prototype.clone=function(){return new e(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},e}(),ux=function(e,t,n,r,i,o,a){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.h=null};function cx(e,t,n,r,i,o,a){return void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new ux(e,t,n,r,i,o,a)}function lx(e){var t=yN(e);if(null===t.h){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return function(e){return e.field.canonicalString()+e.op.toString()+YN(e.value)}(e)}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return function(e){return e.field.canonicalString()+e.dir}(e)}).join(","),VN(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=Cx(t.startAt)),t.endAt&&(n+="|ub:",n+=Cx(t.endAt)),t.h=n}return t.h}function hx(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!Ox(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(o=t.filters[r]).op||!i.field.isEqual(o.field)||!WN(i.value,o.value))return!1;var i,o;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Px(e.startAt,t.startAt)&&Px(e.endAt,t.endAt)}function fx(e){return GN.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var dx=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).field=t,i.op=n,i.value=r,i}return Object(YS.c)(t,e),t.create=function(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.l(e,n,r):new px(e,n,r):"array-contains"===n?new mx(e,r):"in"===n?new bx(e,r):"not-in"===n?new _x(e,r):"array-contains-any"===n?new wx(e,r):new t(e,n,r)},t.l=function(e,t,n){return"in"===t?new vx(e,n):new gx(e,n)},t.prototype.matches=function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.m(ZN(t,this.value)):null!==t&&qN(this.value)===qN(t)&&this.m(ZN(t,this.value))},t.prototype.m=function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return vN()}},t.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},t}(function(){}),px=function(e){function t(t,n,r){var i=this;return(i=e.call(this,t,n,r)||this).key=GN.fromName(r.referenceValue),i}return Object(YS.c)(t,e),t.prototype.matches=function(e){var t=GN.comparator(e.key,this.key);return this.m(t)},t}(dx),vx=function(e){function t(t,n){var r=this;return(r=e.call(this,t,"in",n)||this).keys=yx(0,n),r}return Object(YS.c)(t,e),t.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},t}(dx),gx=function(e){function t(t,n){var r=this;return(r=e.call(this,t,"not-in",n)||this).keys=yx(0,n),r}return Object(YS.c)(t,e),t.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},t}(dx);function yx(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return GN.fromName(e.referenceValue)})}var mx=function(e){function t(t,n){return e.call(this,t,"array-contains",n)||this}return Object(YS.c)(t,e),t.prototype.matches=function(e){var t=e.data.field(this.field);return ex(t)&&$N(t.arrayValue,this.value)},t}(dx),bx=function(e){function t(t,n){return e.call(this,t,"in",n)||this}return Object(YS.c)(t,e),t.prototype.matches=function(e){var t=e.data.field(this.field);return null!==t&&$N(this.value.arrayValue,t)},t}(dx),_x=function(e){function t(t,n){return e.call(this,t,"not-in",n)||this}return Object(YS.c)(t,e),t.prototype.matches=function(e){if($N(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!$N(this.value.arrayValue,t)},t}(dx),wx=function(e){function t(t,n){return e.call(this,t,"array-contains-any",n)||this}return Object(YS.c)(t,e),t.prototype.matches=function(e){var t=this,n=e.data.field(this.field);return!(!ex(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return $N(t.value.arrayValue,e)})},t}(dx),kx=function(e,t){this.position=e,this.before=t};function Cx(e){return(e.before?"b":"a")+":"+e.position.map(function(e){return YN(e)}).join(",")}var Ex=function(e,t){void 0===t&&(t="asc"),this.field=e,this.dir=t};function Ox(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Sx(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var o=t[i],a=e.position[i];if(r=o.field.isKeyField()?GN.comparator(GN.fromName(a.referenceValue),n.key):ZN(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function Px(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!WN(e.position[n],t.position[n]))return!1;return!0}var Ix=function(e,t,n,r,i,o,a,s){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.p=null,this.T=null};function Tx(e,t,n,r,i,o,a,s){return new Ix(e,t,n,r,i,o,a,s)}function Ax(e){return new Ix(e)}function Nx(e){return!VN(e.limit)&&"F"===e.limitType}function xx(e){return!VN(e.limit)&&"L"===e.limitType}function Rx(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Mx(e){for(var t=0,n=e.filters;t<n.length;t++){var r=n[t];if(r.g())return r.field}return null}function Dx(e){return null!==e.collectionGroup}function Lx(e){var t=yN(e);if(null===t.p){t.p=[];var n=Mx(t),r=Rx(t);if(null!==n&&null===r)n.isKeyField()||t.p.push(new Ex(n)),t.p.push(new Ex(NN.keyField(),"asc"));else{for(var i=!1,o=0,a=t.explicitOrderBy;o<a.length;o++){var s=a[o];t.p.push(s),s.field.isKeyField()&&(i=!0)}if(!i){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.p.push(new Ex(NN.keyField(),u))}}}return t.p}function Bx(e){var t=yN(e);if(!t.T)if("F"===t.limitType)t.T=cx(t.path,t.collectionGroup,Lx(t),t.filters,t.limit,t.startAt,t.endAt);else{for(var n=[],r=0,i=Lx(t);r<i.length;r++){var o=i[r];n.push(new Ex(o.field,"desc"===o.dir?"asc":"desc"))}var a=t.endAt?new kx(t.endAt.position,!t.endAt.before):null,s=t.startAt?new kx(t.startAt.position,!t.startAt.before):null;t.T=cx(t.path,t.collectionGroup,n,t.filters,t.limit,a,s)}return t.T}function Fx(e,t,n){return new Ix(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function jx(e,t){return hx(Bx(e),Bx(t))&&e.limitType===t.limitType}function Ux(e){return lx(Bx(e))+"|lt:"+e.limitType}function Vx(e){return"Query(target="+function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: ["+e.filters.map(function(e){return(t=e).field.canonicalString()+" "+t.op+" "+YN(t.value);var t}).join(", ")+"]"),VN(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: ["+e.orderBy.map(function(e){return function(e){return e.field.canonicalString()+" ("+e.dir+")"}(e)}).join(", ")+"]"),e.startAt&&(t+=", startAt: "+Cx(e.startAt)),e.endAt&&(t+=", endAt: "+Cx(e.endAt)),"Target("+t+")"}(Bx(e))+"; limitType="+e.limitType+")"}function zx(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):GN.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(var n=0,r=e.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}return!0}(e,t)&&function(e,t){for(var n=0,r=e.filters;n<r.length;n++)if(!r[n].matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!Sx(e.startAt,Lx(e),t)||e.endAt&&Sx(e.endAt,Lx(e),t))}(e,t)}function Hx(e){return function(t,n){for(var r=!1,i=0,o=Lx(e);i<o.length;i++){var a=o[i],s=Gx(a,t,n);if(0!==s)return s;r=r||a.field.isKeyField()}return 0}}function Gx(e,t,n){var r=e.field.isKeyField()?GN.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?ZN(r,i):vN()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return vN()}}function qx(e,t){if(e.I){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zN(t)?"-0":t}}function Wx(e){return{integerValue:""+e}}function $x(e,t){return HN(t)?Wx(t):qx(e,t)}var Zx=function(){this._=void 0};function Qx(e,t,n){return e instanceof Jx?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Xx?eR(e,t):e instanceof tR?nR(e,t):function(e,t){var n=Kx(e,t),r=iR(n)+iR(e.A);return XN(n)&&XN(e.A)?Wx(r):qx(e.R,r)}(e,t)}function Yx(e,t,n){return e instanceof Xx?eR(e,t):e instanceof tR?nR(e,t):n}function Kx(e,t){return e instanceof rR?XN(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var Jx=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(YS.c)(t,e),t}(Zx),Xx=function(e){function t(t){var n=this;return(n=e.call(this)||this).elements=t,n}return Object(YS.c)(t,e),t}(Zx);function eR(e,t){for(var n=oR(t),r=function(e){n.some(function(t){return WN(t,e)})||n.push(e)},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var tR=function(e){function t(t){var n=this;return(n=e.call(this)||this).elements=t,n}return Object(YS.c)(t,e),t}(Zx);function nR(e,t){for(var n=oR(t),r=function(e){n=n.filter(function(t){return!WN(t,e)})},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var rR=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).R=t,r.A=n,r}return Object(YS.c)(t,e),t}(Zx);function iR(e){return LN(e.integerValue||e.doubleValue)}function oR(e){return ex(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var aR=function(e,t){this.field=e,this.transform=t},sR=function(e,t){this.version=e,this.transformResults=t},uR=function(){function e(e,t){this.updateTime=e,this.exists=t}return e.none=function(){return new e},e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)},e}();function cR(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var lR=function(){};function hR(e,t,n){e instanceof gR?function(e,t,n){var r=e.value.clone(),i=bR(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof yR?function(e,t,n){if(cR(e.precondition,t)){var r=bR(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(mR(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function fR(e,t,n){e instanceof gR?function(e,t,n){if(cR(e.precondition,t)){var r=e.value.clone(),i=_R(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(vR(t),r).setHasLocalMutations()}}(e,t,n):e instanceof yR?function(e,t,n){if(cR(e.precondition,t)){var r=_R(e.fieldTransforms,n,t),i=t.data;i.setAll(mR(e)),i.setAll(r),t.convertToFoundDocument(vR(t),i).setHasLocalMutations()}}(e,t,n):function(e,t){cR(e.precondition,t)&&t.convertToNoDocument(EN.min())}(e,t)}function dR(e,t){for(var n=null,r=0,i=e.fieldTransforms;r<i.length;r++){var o=i[r],a=t.data.field(o.field),s=Kx(o.transform,a||null);null!=s&&(null==n&&(n=ox.empty()),n.set(o.field,s))}return n||null}function pR(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&wN(e,t,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Xx&&t instanceof Xx||e instanceof tR&&t instanceof tR?wN(e.elements,t.elements,WN):e instanceof rR&&t instanceof rR?WN(e.A,t.A):e instanceof Jx&&t instanceof Jx}(e.transform,t.transform)}(e,t)})}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function vR(e){return e.isFoundDocument()?e.version:EN.min()}var gR=function(e){function t(t,n,r,i){void 0===i&&(i=[]);var o=this;return(o=e.call(this)||this).key=t,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(YS.c)(t,e),t}(lR),yR=function(e){function t(t,n,r,i,o){void 0===o&&(o=[]);var a=this;return(a=e.call(this)||this).key=t,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=o,a.type=1,a}return Object(YS.c)(t,e),t}(lR);function mR(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function bR(e,t,n){var r=new Map;gN(e.length===n.length);for(var i=0;i<n.length;i++){var o=e[i],a=o.transform,s=t.data.field(o.field);r.set(o.field,Yx(a,s,n[i]))}return r}function _R(e,t,n){for(var r=new Map,i=0,o=e;i<o.length;i++){var a=o[i],s=a.transform,u=n.data.field(a.field);r.set(a.field,Qx(s,u,t))}return r}var wR,kR,CR=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).key=t,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(YS.c)(t,e),t}(lR),ER=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).key=t,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(YS.c)(t,e),t}(lR),OR=function(e){this.count=e};function SR(e){switch(e){case sN.OK:return vN();case sN.CANCELLED:case sN.UNKNOWN:case sN.DEADLINE_EXCEEDED:case sN.RESOURCE_EXHAUSTED:case sN.INTERNAL:case sN.UNAVAILABLE:case sN.UNAUTHENTICATED:return!1;case sN.INVALID_ARGUMENT:case sN.NOT_FOUND:case sN.ALREADY_EXISTS:case sN.PERMISSION_DENIED:case sN.FAILED_PRECONDITION:case sN.ABORTED:case sN.OUT_OF_RANGE:case sN.UNIMPLEMENTED:case sN.DATA_LOSS:return!0;default:return vN()}}function PR(e){if(void 0===e)return fN("GRPC error has no .code"),sN.UNKNOWN;switch(e){case wR.OK:return sN.OK;case wR.CANCELLED:return sN.CANCELLED;case wR.UNKNOWN:return sN.UNKNOWN;case wR.DEADLINE_EXCEEDED:return sN.DEADLINE_EXCEEDED;case wR.RESOURCE_EXHAUSTED:return sN.RESOURCE_EXHAUSTED;case wR.INTERNAL:return sN.INTERNAL;case wR.UNAVAILABLE:return sN.UNAVAILABLE;case wR.UNAUTHENTICATED:return sN.UNAUTHENTICATED;case wR.INVALID_ARGUMENT:return sN.INVALID_ARGUMENT;case wR.NOT_FOUND:return sN.NOT_FOUND;case wR.ALREADY_EXISTS:return sN.ALREADY_EXISTS;case wR.PERMISSION_DENIED:return sN.PERMISSION_DENIED;case wR.FAILED_PRECONDITION:return sN.FAILED_PRECONDITION;case wR.ABORTED:return sN.ABORTED;case wR.OUT_OF_RANGE:return sN.OUT_OF_RANGE;case wR.UNIMPLEMENTED:return sN.UNIMPLEMENTED;case wR.DATA_LOSS:return sN.DATA_LOSS;default:return vN()}}(kR=wR||(wR={}))[kR.OK=0]="OK",kR[kR.CANCELLED=1]="CANCELLED",kR[kR.UNKNOWN=2]="UNKNOWN",kR[kR.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",kR[kR.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",kR[kR.NOT_FOUND=5]="NOT_FOUND",kR[kR.ALREADY_EXISTS=6]="ALREADY_EXISTS",kR[kR.PERMISSION_DENIED=7]="PERMISSION_DENIED",kR[kR.UNAUTHENTICATED=16]="UNAUTHENTICATED",kR[kR.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",kR[kR.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",kR[kR.ABORTED=10]="ABORTED",kR[kR.OUT_OF_RANGE=11]="OUT_OF_RANGE",kR[kR.UNIMPLEMENTED=12]="UNIMPLEMENTED",kR[kR.INTERNAL=13]="INTERNAL",kR[kR.UNAVAILABLE=14]="UNAVAILABLE",kR[kR.DATA_LOSS=15]="DATA_LOSS";var IR=function(){function e(e,t){this.comparator=e,this.root=t||AR.EMPTY}return e.prototype.insert=function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,AR.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,AR.BLACK,null,null))},e.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null},e.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1},e.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),e.prototype.minKey=function(){return this.root.minKey()},e.prototype.maxKey=function(){return this.root.maxKey()},e.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},e.prototype.forEach=function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})},e.prototype.toString=function(){var e=[];return this.inorderTraversal(function(t,n){return e.push(t+":"+n),!1}),"{"+e.join(", ")+"}"},e.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},e.prototype.getIterator=function(){return new TR(this.root,null,this.comparator,!1)},e.prototype.getIteratorFrom=function(e){return new TR(this.root,e,this.comparator,!1)},e.prototype.getReverseIterator=function(){return new TR(this.root,null,this.comparator,!0)},e.prototype.getReverseIteratorFrom=function(e){return new TR(this.root,e,this.comparator,!0)},e}(),TR=function(){function e(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return e.prototype.getNext=function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},e.prototype.hasNext=function(){return this.nodeStack.length>0},e.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},e}(),AR=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=o?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},e.prototype.minKey=function(){return this.min().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},e.prototype.removeMin=function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},e.prototype.remove=function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()},e.prototype.isRed=function(){return this.color},e.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},e.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},e.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},e.prototype.rotateLeft=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},e.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw vN();if(this.right.isRed())throw vN();var e=this.left.check();if(e!==this.right.check())throw vN();return e+(this.isRed()?0:1)},e}();AR.EMPTY=null,AR.RED=!0,AR.BLACK=!1,AR.EMPTY=new(function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw vN()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw vN()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw vN()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw vN()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw vN()},enumerable:!1,configurable:!0}),e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new AR(e,t)},e.prototype.remove=function(e,t){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}());var NR=function(){function e(e){this.comparator=e,this.data=new IR(this.comparator)}return e.prototype.has=function(e){return null!==this.data.get(e)},e.prototype.first=function(){return this.data.minKey()},e.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),e.prototype.indexOf=function(e){return this.data.indexOf(e)},e.prototype.forEach=function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})},e.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}},e.prototype.forEachWhile=function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return},e.prototype.firstAfterOrEqual=function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null},e.prototype.getIterator=function(){return new xR(this.data.getIterator())},e.prototype.getIteratorFrom=function(e){return new xR(this.data.getIteratorFrom(e))},e.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},e.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},e.prototype.isEmpty=function(){return this.data.isEmpty()},e.prototype.unionWith=function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},e.prototype.toArray=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},e.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},e.prototype.copy=function(t){var n=new e(this.comparator);return n.data=t,n},e}(),xR=function(){function e(e){this.iter=e}return e.prototype.getNext=function(){return this.iter.getNext().key},e.prototype.hasNext=function(){return this.iter.hasNext()},e}(),RR=new IR(GN.comparator);function MR(){return RR}var DR=new IR(GN.comparator);function LR(){return DR}var BR=new IR(GN.comparator);function FR(){return BR}var jR=new NR(GN.comparator);function UR(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=jR,r=0,i=e;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var VR=new NR(_N);function zR(){return VR}var HR=function(){function e(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return e.createSynthesizedRemoteEventForCurrentChange=function(t,n){var r=new Map;return r.set(t,GR.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(EN.min(),r,zR(),MR(),UR())},e}(),GR=function(){function e(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return e.createSynthesizedTargetChangeForCurrentChange=function(t,n){return new e(RN.EMPTY_BYTE_STRING,n,UR(),UR(),UR())},e}(),qR=function(e,t,n,r){this.v=e,this.removedTargetIds=t,this.key=n,this.P=r},WR=function(e,t){this.targetId=e,this.V=t},$R=function(e,t,n,r){void 0===n&&(n=RN.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},ZR=function(){function e(){this.S=0,this.D=KR(),this.C=RN.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(e.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"F",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),e.prototype.O=function(e){e.approximateByteSize()>0&&(this.k=!0,this.C=e)},e.prototype.M=function(){var e=UR(),t=UR(),n=UR();return this.D.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:vN()}}),new GR(this.C,this.N,e,t,n)},e.prototype.L=function(){this.k=!1,this.D=KR()},e.prototype.B=function(e,t){this.k=!0,this.D=this.D.insert(e,t)},e.prototype.q=function(e){this.k=!0,this.D=this.D.remove(e)},e.prototype.U=function(){this.S+=1},e.prototype.K=function(){this.S-=1},e.prototype.j=function(){this.k=!0,this.N=!0},e}(),QR=function(){function e(e){this.W=e,this.G=new Map,this.H=MR(),this.J=YR(),this.Y=new NR(_N)}return e.prototype.X=function(e){for(var t=0,n=e.v;t<n.length;t++){var r=n[t];e.P&&e.P.isFoundDocument()?this.Z(r,e.P):this.tt(r,e.key,e.P)}for(var i=0,o=e.removedTargetIds;i<o.length;i++)this.tt(r=o[i],e.key,e.P)},e.prototype.et=function(e){var t=this;this.forEachTarget(e,function(n){var r=t.nt(n);switch(e.state){case 0:t.st(n)&&r.O(e.resumeToken);break;case 1:r.K(),r.F||r.L(),r.O(e.resumeToken);break;case 2:r.K(),r.F||t.removeTarget(n);break;case 3:t.st(n)&&(r.j(),r.O(e.resumeToken));break;case 4:t.st(n)&&(t.it(n),r.O(e.resumeToken));break;default:vN()}})},e.prototype.forEachTarget=function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.G.forEach(function(e,r){n.st(r)&&t(r)})},e.prototype.rt=function(e){var t=e.targetId,n=e.V.count,r=this.ot(t);if(r){var i=r.target;if(fx(i))if(0===n){var o=new GN(i.path);this.tt(t,o,sx.newNoDocument(o,EN.min()))}else gN(1===n);else this.ct(t)!==n&&(this.it(t),this.Y=this.Y.add(t))}},e.prototype.ut=function(e){var t=this,n=new Map;this.G.forEach(function(r,i){var o=t.ot(i);if(o){if(r.current&&fx(o.target)){var a=new GN(o.target.path);null!==t.H.get(a)||t.at(i,a)||t.tt(i,a,sx.newNoDocument(a,e))}r.$&&(n.set(i,r.M()),r.L())}});var r=UR();this.J.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.ot(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))});var i=new HR(e,n,this.Y,this.H,r);return this.H=MR(),this.J=YR(),this.Y=new NR(_N),i},e.prototype.Z=function(e,t){if(this.st(e)){var n=this.at(e,t.key)?2:0;this.nt(e).B(t.key,n),this.H=this.H.insert(t.key,t),this.J=this.J.insert(t.key,this.ht(t.key).add(e))}},e.prototype.tt=function(e,t,n){if(this.st(e)){var r=this.nt(e);this.at(e,t)?r.B(t,1):r.q(t),this.J=this.J.insert(t,this.ht(t).delete(e)),n&&(this.H=this.H.insert(t,n))}},e.prototype.removeTarget=function(e){this.G.delete(e)},e.prototype.ct=function(e){var t=this.nt(e).M();return this.W.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},e.prototype.U=function(e){this.nt(e).U()},e.prototype.nt=function(e){var t=this.G.get(e);return t||(t=new ZR,this.G.set(e,t)),t},e.prototype.ht=function(e){var t=this.J.get(e);return t||(t=new NR(_N),this.J=this.J.insert(e,t)),t},e.prototype.st=function(e){var t=null!==this.ot(e);return t||hN("WatchChangeAggregator","Detected inactive target",e),t},e.prototype.ot=function(e){var t=this.G.get(e);return t&&t.F?null:this.W.lt(e)},e.prototype.it=function(e){var t=this;this.G.set(e,new ZR),this.W.getRemoteKeysForTarget(e).forEach(function(n){t.tt(e,n,null)})},e.prototype.at=function(e,t){return this.W.getRemoteKeysForTarget(e).has(t)},e}();function YR(){return new IR(GN.comparator)}function KR(){return new IR(GN.comparator)}var JR={asc:"ASCENDING",desc:"DESCENDING"},XR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eM=function(e,t){this.databaseId=e,this.I=t};function tM(e,t){return e.I?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}}function nM(e,t){return e.I?t.toBase64():t.toUint8Array()}function rM(e,t){return tM(e,t.toTimestamp())}function iM(e){return gN(!!e),EN.fromTimestamp(function(e){var t=DN(e);return new CN(t.seconds,t.nanos)}(e))}function oM(e,t){return function(e){return new TN(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function aM(e){var t=TN.fromString(e);return gN(AM(t)),t}function sM(e,t){return oM(e.databaseId,t.path)}function uM(e,t){var n=aM(t);if(n.get(1)!==e.databaseId.projectId)throw new uN(sN.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new uN(sN.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new GN(fM(n))}function cM(e,t){return oM(e.databaseId,t)}function lM(e){var t=aM(e);return 4===t.length?TN.emptyPath():fM(t)}function hM(e){return new TN(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function fM(e){return gN(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function dM(e,t,n){return{name:sM(e,t),fields:n.value.mapValue.fields}}function pM(e,t,n){var r=uM(e,t.name),i=iM(t.updateTime),o=new ox({mapValue:{fields:t.fields}}),a=sx.newFoundDocument(r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function vM(e,t){var n;if(t instanceof gR)n={update:dM(e,t.key,t.value)};else if(t instanceof CR)n={delete:sM(e,t.key)};else if(t instanceof yR)n={update:dM(e,t.key,t.data),updateMask:TM(t.fieldMask)};else{if(!(t instanceof ER))return vN();n={verify:sM(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof Jx)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Xx)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof tR)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof rR)return{fieldPath:t.field.canonicalString(),increment:n.A};throw vN()}(0,e)})),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:rM(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:vN()}(e,t.precondition)),n}function gM(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?uR.updateTime(iM(e.updateTime)):void 0!==e.exists?uR.exists(e.exists):uR.none()}(t.currentDocument):uR.none(),r=t.updateTransforms?t.updateTransforms.map(function(t){return function(e,t){var n=null;"setToServerValue"in t?(gN("REQUEST_TIME"===t.setToServerValue),n=new Jx):"appendMissingElements"in t?n=new Xx(t.appendMissingElements.values||[]):"removeAllFromArray"in t?n=new tR(t.removeAllFromArray.values||[]):"increment"in t?n=new rR(e,t.increment):vN();var r=NN.fromServerFormat(t.fieldPath);return new aR(r,n)}(e,t)}):[];if(t.update){var i=uM(e,t.update.name),o=new ox({mapValue:{fields:t.update.fields}});if(t.updateMask){var a=function(e){return new xN((e.fieldPaths||[]).map(function(e){return NN.fromServerFormat(e)}))}(t.updateMask);return new yR(i,o,a,n,r)}return new gR(i,o,n,r)}if(t.delete){var s=uM(e,t.delete);return new CR(s,n)}if(t.verify){var u=uM(e,t.verify);return new ER(u,n)}return vN()}function yM(e,t){return{documents:[cM(e,t.path)]}}function mM(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=cM(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=cM(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(nx(e.value))return{unaryFilter:{field:OM(e.field),op:"IS_NAN"}};if(tx(e.value))return{unaryFilter:{field:OM(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(nx(e.value))return{unaryFilter:{field:OM(e.field),op:"IS_NOT_NAN"}};if(tx(e.value))return{unaryFilter:{field:OM(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:OM(e.field),op:EM(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var o=function(e){if(0!==e.length)return e.map(function(e){return function(e){return{field:OM(e.field),direction:CM(e.dir)}}(e)})}(t.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(e,t){return e.I||VN(t)?t:{value:t}}(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=wM(t.startAt)),t.endAt&&(n.structuredQuery.endAt=wM(t.endAt)),n}function bM(e){var t=lM(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){gN(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:t=t.child(o.collectionId)}var a=[];n.where&&(a=_M(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(e){return function(e){return new Ex(SM(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)}));var u=null;n.limit&&(u=function(e){var t;return VN(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=kM(n.startAt));var l=null;return n.endAt&&(l=kM(n.endAt)),Tx(t,i,s,a,u,"F",c,l)}function _M(e){return e?void 0!==e.unaryFilter?[IM(e)]:void 0!==e.fieldFilter?[PM(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return _M(e)}).reduce(function(e,t){return e.concat(t)}):vN():[]}function wM(e){return{before:e.before,values:e.position}}function kM(e){return new kx(e.values||[],!!e.before)}function CM(e){return JR[e]}function EM(e){return XR[e]}function OM(e){return{fieldPath:e.canonicalString()}}function SM(e){return NN.fromServerFormat(e.fieldPath)}function PM(e){return dx.create(SM(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return vN()}}(e.fieldFilter.op),e.fieldFilter.value)}function IM(e){switch(e.unaryFilter.op){case"IS_NAN":var t=SM(e.unaryFilter.field);return dx.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=SM(e.unaryFilter.field);return dx.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=SM(e.unaryFilter.field);return dx.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=SM(e.unaryFilter.field);return dx.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return vN()}}function TM(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function AM(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function NM(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=RM(t)),t=xM(e.get(n),t);return RM(t)}function xM(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function RM(e){return e+"\x01\x01"}function MM(e){var t=e.length;if(gN(t>=2),2===t)return gN("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),TN.emptyPath();for(var n=t-2,r=[],i="",o=0;o<t;){var a=e.indexOf("\x01",o);switch((a<0||a>n)&&vN(),e.charAt(a+1)){case"\x01":var s=e.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"\x10":i+=e.substring(o,a),i+="\0";break;case"\x11":i+=e.substring(o,a+1);break;default:vN()}o=a+2}return new TN(r)}var DM=function(e,t){this.seconds=e,this.nanoseconds=t},LM=function(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n};LM.store="owner",LM.key="owner";var BM=function(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n};BM.store="mutationQueues",BM.keyPath="userId";var FM=function(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};FM.store="mutations",FM.keyPath="batchId",FM.userMutationsIndex="userMutationsIndex",FM.userMutationsKeyPath=["userId","batchId"];var jM=function(){function e(){}return e.prefixForUser=function(e){return[e]},e.prefixForPath=function(e,t){return[e,NM(t)]},e.key=function(e,t,n){return[e,NM(t),n]},e}();jM.store="documentMutations",jM.PLACEHOLDER=new jM;var UM=function(e,t){this.path=e,this.readTime=t},VM=function(e,t){this.path=e,this.version=t},zM=function(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};zM.store="remoteDocuments",zM.readTimeIndex="readTimeIndex",zM.readTimeIndexPath="readTime",zM.collectionReadTimeIndex="collectionReadTimeIndex",zM.collectionReadTimeIndexPath=["parentPath","readTime"];var HM=function(e){this.byteSize=e};HM.store="remoteDocumentGlobal",HM.key="remoteDocumentGlobalKey";var GM=function(e,t,n,r,i,o,a){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};GM.store="targets",GM.keyPath="targetId",GM.queryTargetsIndexName="queryTargetsIndex",GM.queryTargetsKeyPath=["canonicalId","targetId"];var qM=function(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n};qM.store="targetDocuments",qM.keyPath=["targetId","path"],qM.documentTargetsIndex="documentTargetsIndex",qM.documentTargetsKeyPath=["path","targetId"];var WM=function(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r};WM.key="targetGlobalKey",WM.store="targetGlobal";var $M=function(e,t){this.collectionId=e,this.parent=t};$M.store="collectionParents",$M.keyPath=["collectionId","parent"];var ZM=function(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r};ZM.store="clientMetadata",ZM.keyPath="clientId";var QM=function(e,t,n){this.bundleId=e,this.createTime=t,this.version=n};QM.store="bundles",QM.keyPath="bundleId";var YM=function(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n};YM.store="namedQueries",YM.keyPath="name";var KM=Object(YS.f)(Object(YS.f)([],Object(YS.f)(Object(YS.f)([],Object(YS.f)(Object(YS.f)([],Object(YS.f)(Object(YS.f)([],[BM.store,FM.store,jM.store,zM.store,GM.store,LM.store,WM.store,qM.store]),[ZM.store])),[HM.store])),[$M.store])),[QM.store,YM.store]),JM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",XM=function(){function e(){this.onCommittedListeners=[]}return e.prototype.addOnCommittedListener=function(e){this.onCommittedListeners.push(e)},e.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(e){return e()})},e}(),eD=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})},tD=function(){function e(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)},function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)})}return e.prototype.catch=function(e){return this.next(void 0,e)},e.prototype.next=function(t,n){var r=this;return this.callbackAttached&&vN(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})},e.prototype.toPromise=function(){var e=this;return new Promise(function(t,n){e.next(t,n)})},e.prototype.wrapUserFunction=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}},e.prototype.wrapSuccess=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)},e.prototype.wrapFailure=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)},e.resolve=function(t){return new e(function(e,n){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.waitFor=function(t){return new e(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(e){return n(e)})}),o=!0,i===r&&e()})},e.or=function(t){for(var n=e.resolve(!1),r=function(t){n=n.next(function(n){return n?e.resolve(n):t()})},i=0,o=t;i<o.length;i++)r(o[i]);return n},e.forEach=function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)},e}(),nD=function(){function e(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ft=new eD,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){t.error?n.ft.reject(new oD(e,t.error)):n.ft.resolve()},this.transaction.onerror=function(t){var r=lD(t.target.error);n.ft.reject(new oD(e,r))}}return e.open=function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new oD(n,t)}},Object.defineProperty(e.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),e.prototype.abort=function(e){e&&this.ft.reject(e),this.aborted||(hN("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(e){var t=this.transaction.objectStore(e);return new sD(t)},e}(),rD=function(){function e(t,n,r){this.name=t,this.version=n,this.wt=r,12.2===e._t(Object(KS.o)())&&fN("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(e){return hN("SimpleDb","Removing database:",e),uD(window.indexedDB.deleteDatabase(e)).toPromise()},e.yt=function(){if("undefined"==typeof indexedDB)return!1;if(e.gt())return!0;var t=Object(KS.o)(),n=e._t(t),r=0<n&&n<10,i=e.Et(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.gt=function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Tt)},e.It=function(e,t){return e.store(t)},e._t=function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.Et=function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.At=function(e){return Object(YS.b)(this,void 0,void 0,function(){var t,n=this;return Object(YS.d)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(hN("SimpleDb","Opening database:",this.name),t=this,[4,new Promise(function(t,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(e){t(e.target.result)},i.onblocked=function(){r(new oD(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var n=t.target.error;r("VersionError"===n.name?new uN(sN.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new oD(e,n))},i.onupgradeneeded=function(e){hN("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion),n.wt.Rt(e.target.result,i.transaction,e.oldVersion,n.version).next(function(){hN("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:t.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(e){return n.bt(e)}),this.db)]}})})},e.prototype.vt=function(e){this.bt=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},e.prototype.runTransaction=function(e,t,n,r){return Object(YS.b)(this,void 0,void 0,function(){var i,o,a,s,u;return Object(YS.d)(this,function(c){switch(c.label){case 0:i="readonly"===t,o=0,a=function(){var t,a,u,c,l;return Object(YS.d)(this,function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,s.At(e)];case 2:return s.db=h.sent(),t=nD.open(s.db,e,i?"readonly":"readwrite",n),a=r(t).catch(function(e){return t.abort(e),tD.reject(e)}).toPromise(),u={},a.catch(function(){}),[4,t.dt];case 3:return[2,(u.value=(h.sent(),a),u)];case 4:return hN("SimpleDb","Transaction failed with error:",(c=h.sent()).message,"Retrying:",l="FirebaseError"!==c.name&&o<3),s.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},s=this,c.label=1;case 1:return[5,a()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),iD=function(){function e(e){this.Pt=e,this.Vt=!1,this.St=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(e){this.Pt=e},enumerable:!1,configurable:!0}),e.prototype.done=function(){this.Vt=!0},e.prototype.Ct=function(e){this.St=e},e.prototype.delete=function(){return uD(this.Pt.delete())},e}(),oD=function(e){function t(t,n){var r=this;return(r=e.call(this,sN.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(YS.c)(t,e),t}(uN);function aD(e){return"IndexedDbTransactionError"===e.name}var sD=function(){function e(e){this.store=e}return e.prototype.put=function(e,t){var n;return void 0!==t?(hN("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(hN("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),uD(n)},e.prototype.add=function(e){return hN("SimpleDb","ADD",this.store.name,e,e),uD(this.store.add(e))},e.prototype.get=function(e){var t=this;return uD(this.store.get(e)).next(function(n){return void 0===n&&(n=null),hN("SimpleDb","GET",t.store.name,e,n),n})},e.prototype.delete=function(e){return hN("SimpleDb","DELETE",this.store.name,e),uD(this.store.delete(e))},e.prototype.count=function(){return hN("SimpleDb","COUNT",this.store.name),uD(this.store.count())},e.prototype.Nt=function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.xt(n,function(e,t){r.push(t)}).next(function(){return r})},e.prototype.kt=function(e,t){hN("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.Ft=!1;var r=this.cursor(n);return this.xt(r,function(e,t,n){return n.delete()})},e.prototype.$t=function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.xt(r,t)},e.prototype.Ot=function(e){var t=this.cursor({});return new tD(function(n,r){t.onerror=function(e){var t=lD(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next(function(e){e?r.continue():n()}):n()}})},e.prototype.xt=function(e,t){var n=[];return new tD(function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var o=new iD(i),a=t(i.primaryKey,i.value,o);if(a instanceof tD){var s=a.catch(function(e){return o.done(),tD.reject(e)});n.push(s)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}}).next(function(){return tD.waitFor(n)})},e.prototype.options=function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}},e.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.Ft?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},e}();function uD(e){return new tD(function(t,n){e.onsuccess=function(e){t(e.target.result)},e.onerror=function(e){var t=lD(e.target.error);n(t)}})}var cD=!1;function lD(e){var t=rD._t(Object(KS.o)());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new uN("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return cD||(cD=!0,setTimeout(function(){throw r},0)),r}}return e}var hD=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).Mt=t,r.currentSequenceNumber=n,r}return Object(YS.c)(t,e),t}(XM);function fD(e,t){var n=yN(e);return rD.It(n.Mt,t)}var dD=function(){function e(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}return e.prototype.applyToRemoteDocument=function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&hR(i,e,n[r])}},e.prototype.applyToLocalView=function(e){for(var t=0,n=this.baseMutations;t<n.length;t++)(o=n[t]).key.isEqual(e.key)&&fR(o,e,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(e.key)&&fR(o,e,this.localWriteTime)}},e.prototype.applyToLocalDocumentSet=function(e){var t=this;this.mutations.forEach(function(n){var r=e.get(n.key),i=r;t.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(EN.min())})},e.prototype.keys=function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},UR())},e.prototype.isEqual=function(e){return this.batchId===e.batchId&&wN(this.mutations,e.mutations,function(e,t){return pR(e,t)})&&wN(this.baseMutations,e.baseMutations,function(e,t){return pR(e,t)})},e}(),pD=function(){function e(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}return e.from=function(t,n,r){gN(t.mutations.length===r.length);for(var i=FR(),o=t.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new e(t,n,r,i)},e}(),vD=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=EN.min()),void 0===o&&(o=EN.min()),void 0===a&&(a=RN.EMPTY_BYTE_STRING),this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return e.prototype.withSequenceNumber=function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},e.prototype.withResumeToken=function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)},e.prototype.withLastLimboFreeSnapshotVersion=function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},e}(),gD=function(e){this.Lt=e};function yD(e,t){if(t.document)return pM(e.Lt,t.document,!!t.hasCommittedMutations);if(t.noDocument){var n=GN.fromSegments(t.noDocument.path),r=kD(t.noDocument.readTime),i=sx.newNoDocument(n,r);return t.hasCommittedMutations?i.setHasCommittedMutations():i}if(t.unknownDocument){var o=GN.fromSegments(t.unknownDocument.path);return r=kD(t.unknownDocument.version),sx.newUnknownDocument(o,r)}return vN()}function mD(e,t,n){var r=bD(n),i=t.key.path.popLast().toArray();if(t.isFoundDocument()){var o=function(e,t){return{name:sM(e,t.key),fields:t.data.value.mapValue.fields,updateTime:tM(e,t.version.toTimestamp())}}(e.Lt,t),a=t.hasCommittedMutations;return new zM(null,null,o,a,r,i)}if(t.isNoDocument()){var s=t.key.path.toArray(),u=wD(t.version);return a=t.hasCommittedMutations,new zM(null,new UM(s,u),null,a,r,i)}if(t.isUnknownDocument()){var c=t.key.path.toArray(),l=wD(t.version);return new zM(new VM(c,l),null,null,!0,r,i)}return vN()}function bD(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function _D(e){var t=new CN(e[0],e[1]);return EN.fromTimestamp(t)}function wD(e){var t=e.toTimestamp();return new DM(t.seconds,t.nanoseconds)}function kD(e){var t=new CN(e.seconds,e.nanoseconds);return EN.fromTimestamp(t)}function CD(e,t){for(var n=(t.baseMutations||[]).map(function(t){return gM(e.Lt,t)}),r=0;r<t.mutations.length-1;++r)r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform&&(t.mutations[r].updateTransforms=t.mutations[r+1].transform.fieldTransforms,t.mutations.splice(r+1,1),++r);var i=t.mutations.map(function(t){return gM(e.Lt,t)}),o=CN.fromMillis(t.localWriteTimeMs);return new dD(t.batchId,o,n,i)}function ED(e){var t,n,r=kD(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?kD(e.lastLimboFreeSnapshotVersion):EN.min();return void 0!==e.query.documents?(gN(1===(n=e.query).documents.length),t=Bx(Ax(lM(n.documents[0])))):t=function(e){return Bx(bM(e))}(e.query),new vD(t,e.targetId,0,e.lastListenSequenceNumber,r,i,RN.fromBase64String(e.resumeToken))}function OD(e,t){var n,r=wD(t.snapshotVersion),i=wD(t.lastLimboFreeSnapshotVersion);n=fx(t.target)?yM(e.Lt,t.target):mM(e.Lt,t.target);var o=t.resumeToken.toBase64();return new GM(t.targetId,lx(t.target),r,o,t.sequenceNumber,i,n)}function SD(e){var t=bM({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Fx(t,t.limit,"L"):t}var PD=function(){function e(){}return e.prototype.getBundleMetadata=function(e,t){return ID(e).get(t).next(function(e){if(e)return{id:(t=e).bundleId,createTime:kD(t.createTime),version:t.version};var t})},e.prototype.saveBundleMetadata=function(e,t){return ID(e).put({bundleId:(n=t).id,createTime:wD(iM(n.createTime)),version:n.version});var n},e.prototype.getNamedQuery=function(e,t){return TD(e).get(t).next(function(e){if(e)return{name:(t=e).name,query:SD(t.bundledQuery),readTime:kD(t.readTime)};var t})},e.prototype.saveNamedQuery=function(e,t){return TD(e).put(function(e){return{name:e.name,readTime:wD(iM(e.readTime)),bundledQuery:e.bundledQuery}}(t))},e}();function ID(e){return fD(e,QM.store)}function TD(e){return fD(e,YM.store)}var AD=function(){function e(){this.Bt=new ND}return e.prototype.addToCollectionParentIndex=function(e,t){return this.Bt.add(t),tD.resolve()},e.prototype.getCollectionParents=function(e,t){return tD.resolve(this.Bt.getEntries(t))},e}(),ND=function(){function e(){this.index={}}return e.prototype.add=function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new NR(TN.comparator),i=!r.has(n);return this.index[t]=r.add(n),i},e.prototype.has=function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)},e.prototype.getEntries=function(e){return(this.index[e]||new NR(TN.comparator)).toArray()},e}(),xD=function(){function e(){this.qt=new ND}return e.prototype.addToCollectionParentIndex=function(e,t){var n=this;if(!this.qt.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(function(){n.qt.add(t)});var o={collectionId:r,parent:NM(i)};return RD(e).put(o)}return tD.resolve()},e.prototype.getCollectionParents=function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[kN(t),""],!1,!0);return RD(e).Nt(r).next(function(e){for(var r=0,i=e;r<i.length;r++){var o=i[r];if(o.collectionId!==t)break;n.push(MM(o.parent))}return n})},e}();function RD(e){return fD(e,$M.store)}var MD={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},DD=function(){function e(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}return e.withCacheSize=function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},e}();function LD(e,t,n){var r=e.store(FM.store),i=e.store(jM.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.$t({range:a},function(e,t,n){return s++,n.delete()});o.push(u.next(function(){gN(1===s)}));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=jM.key(t,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return tD.waitFor(o).next(function(){return c})}function BD(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw vN();t=e.noDocument}return JSON.stringify(t).length}DD.DEFAULT_COLLECTION_PERCENTILE=10,DD.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,DD.DEFAULT=new DD(41943040,DD.DEFAULT_COLLECTION_PERCENTILE,DD.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),DD.DISABLED=new DD(-1,0,0);var FD=function(){function e(e,t,n,r){this.userId=e,this.R=t,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return e.Qt=function(t,n,r,i){return gN(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)},e.prototype.checkEmpty=function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return UD(e).$t({index:FM.userMutationsIndex,range:n},function(e,n,r){t=!1,r.done()}).next(function(){return t})},e.prototype.addMutationBatch=function(e,t,n,r){var i=this,o=VD(e),a=UD(e);return a.add({}).next(function(s){gN("number"==typeof s);for(var u=new dD(s,t,n,r),c=function(e,t,n){var r=n.baseMutations.map(function(t){return vM(e.Lt,t)}),i=n.mutations.map(function(t){return vM(e.Lt,t)});return new FM(t,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new NR(function(e,t){return _N(e.canonicalString(),t.canonicalString())}),f=0,d=r;f<d.length;f++){var p=d[f],v=jM.key(i.userId,p.key.path,s);h=h.add(p.key.path.popLast()),l.push(a.put(c)),l.push(o.put(v,jM.PLACEHOLDER))}return h.forEach(function(t){l.push(i.Ut.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(function(){i.Kt[s]=u.keys()}),tD.waitFor(l).next(function(){return u})})},e.prototype.lookupMutationBatch=function(e,t){var n=this;return UD(e).get(t).next(function(e){return e?(gN(e.userId===n.userId),CD(n.R,e)):null})},e.prototype.jt=function(e,t){var n=this;return this.Kt[t]?tD.resolve(this.Kt[t]):this.lookupMutationBatch(e,t).next(function(e){if(e){var r=e.keys();return n.Kt[t]=r,r}return null})},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return UD(e).$t({index:FM.userMutationsIndex,range:i},function(e,t,i){t.userId===n.userId&&(gN(t.batchId>=r),o=CD(n.R,t)),i.done()}).next(function(){return o})},e.prototype.getHighestUnacknowledgedBatchId=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return UD(e).$t({index:FM.userMutationsIndex,range:t,reverse:!0},function(e,t,r){n=t.batchId,r.done()}).next(function(){return n})},e.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return UD(e).Nt(FM.userMutationsIndex,n).next(function(e){return e.map(function(e){return CD(t.R,e)})})},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=jM.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return VD(e).$t({range:i},function(r,i,a){var s=r[0],u=r[2],c=MM(r[1]);if(s===n.userId&&t.path.isEqual(c))return UD(e).get(u).next(function(e){if(!e)throw vN();gN(e.userId===n.userId),o.push(CD(n.R,e))});a.done()}).next(function(){return o})},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new NR(_N),i=[];return t.forEach(function(t){var o=jM.prefixForPath(n.userId,t.path),a=IDBKeyRange.lowerBound(o),s=VD(e).$t({range:a},function(e,i,o){var a=e[0],s=e[2],u=MM(e[1]);a===n.userId&&t.path.isEqual(u)?r=r.add(s):o.done()});i.push(s)}),tD.waitFor(i).next(function(){return n.Wt(e,r)})},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=this,r=t.path,i=r.length+1,o=jM.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new NR(_N);return VD(e).$t({range:a},function(e,t,o){var a=e[0],u=e[2],c=MM(e[1]);a===n.userId&&r.isPrefixOf(c)?c.length===i&&(s=s.add(u)):o.done()}).next(function(){return n.Wt(e,s)})},e.prototype.Wt=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(UD(e).get(t).next(function(e){if(null===e)throw vN();gN(e.userId===n.userId),r.push(CD(n.R,e))}))}),tD.waitFor(i).next(function(){return r})},e.prototype.removeMutationBatch=function(e,t){var n=this;return LD(e.Mt,this.userId,t).next(function(r){return e.addOnCommittedListener(function(){n.Gt(t.batchId)}),tD.forEach(r,function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)})})},e.prototype.Gt=function(e){delete this.Kt[e]},e.prototype.performConsistencyCheck=function(e){var t=this;return this.checkEmpty(e).next(function(n){if(!n)return tD.resolve();var r=IDBKeyRange.lowerBound(jM.prefixForUser(t.userId)),i=[];return VD(e).$t({range:r},function(e,n,r){if(e[0]===t.userId){var o=MM(e[1]);i.push(o)}else r.done()}).next(function(){gN(0===i.length)})})},e.prototype.containsKey=function(e,t){return jD(e,this.userId,t)},e.prototype.zt=function(e){var t=this;return zD(e).get(this.userId).next(function(e){return e||new BM(t.userId,-1,"")})},e}();function jD(e,t,n){var r=jM.prefixForPath(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return VD(e).$t({range:o,Ft:!0},function(e,n,r){e[0]===t&&e[1]===i&&(a=!0),r.done()}).next(function(){return a})}function UD(e){return fD(e,FM.store)}function VD(e){return fD(e,jM.store)}function zD(e){return fD(e,BM.store)}var HD=function(){function e(e){this.Ht=e}return e.prototype.next=function(){return this.Ht+=2,this.Ht},e.Jt=function(){return new e(0)},e.Yt=function(){return new e(-1)},e}(),GD=function(){function e(e,t){this.referenceDelegate=e,this.R=t}return e.prototype.allocateTargetId=function(e){var t=this;return this.Xt(e).next(function(n){var r=new HD(n.highestTargetId);return n.highestTargetId=r.next(),t.Zt(e,n).next(function(){return n.highestTargetId})})},e.prototype.getLastRemoteSnapshotVersion=function(e){return this.Xt(e).next(function(e){return EN.fromTimestamp(new CN(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))})},e.prototype.getHighestSequenceNumber=function(e){return this.Xt(e).next(function(e){return e.highestListenSequenceNumber})},e.prototype.setTargetsMetadata=function(e,t,n){var r=this;return this.Xt(e).next(function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Zt(e,i)})},e.prototype.addTargetData=function(e,t){var n=this;return this.te(e,t).next(function(){return n.Xt(e).next(function(r){return r.targetCount+=1,n.ee(t,r),n.Zt(e,r)})})},e.prototype.updateTargetData=function(e,t){return this.te(e,t)},e.prototype.removeTargetData=function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next(function(){return qD(e).delete(t.targetId)}).next(function(){return n.Xt(e)}).next(function(t){return gN(t.targetCount>0),t.targetCount-=1,n.Zt(e,t)})},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return qD(e).$t(function(a,s){var u=ED(s);u.sequenceNumber<=t&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(e,u)))}).next(function(){return tD.waitFor(o)}).next(function(){return i})},e.prototype.forEachTarget=function(e,t){return qD(e).$t(function(e,n){var r=ED(n);t(r)})},e.prototype.Xt=function(e){return WD(e).get(WM.key).next(function(e){return gN(null!==e),e})},e.prototype.Zt=function(e,t){return WD(e).put(WM.key,t)},e.prototype.te=function(e,t){return qD(e).put(OD(this.R,t))},e.prototype.ee=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},e.prototype.getTargetCount=function(e){return this.Xt(e).next(function(e){return e.targetCount})},e.prototype.getTargetData=function(e,t){var n=lx(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return qD(e).$t({range:r,index:GM.queryTargetsIndexName},function(e,n,r){var o=ED(n);hx(t,o.target)&&(i=o,r.done())}).next(function(){return i})},e.prototype.addMatchingKeys=function(e,t,n){var r=this,i=[],o=$D(e);return t.forEach(function(t){var a=NM(t.path);i.push(o.put(new qM(n,a))),i.push(r.referenceDelegate.addReference(e,n,t))}),tD.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,n){var r=this,i=$D(e);return tD.forEach(t,function(t){var o=NM(t.path);return tD.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(e,n,t)])})},e.prototype.removeMatchingKeysForTargetId=function(e,t){var n=$D(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=$D(e),i=UR();return r.$t({range:n,Ft:!0},function(e,t,n){var r=MM(e[1]),o=new GN(r);i=i.add(o)}).next(function(){return i})},e.prototype.containsKey=function(e,t){var n=NM(t.path),r=IDBKeyRange.bound([n],[kN(n)],!1,!0),i=0;return $D(e).$t({index:qM.documentTargetsIndex,Ft:!0,range:r},function(e,t,n){0!==e[0]&&(i++,n.done())}).next(function(){return i>0})},e.prototype.lt=function(e,t){return qD(e).get(t).next(function(e){return e?ED(e):null})},e}();function qD(e){return fD(e,GM.store)}function WD(e){return fD(e,WM.store)}function $D(e){return fD(e,qM.store)}function ZD(e){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(t){if(e.code!==sN.FAILED_PRECONDITION||e.message!==JM)throw e;return hN("LocalStore","Unexpectedly lost primary lease"),[2]})})}function QD(e,t){var n=e[1],r=t[1],i=_N(e[0],t[0]);return 0===i?_N(n,r):i}var YD=function(){function e(e){this.ne=e,this.buffer=new NR(QD),this.se=0}return e.prototype.ie=function(){return++this.se},e.prototype.re=function(e){var t=[e,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();QD(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),e}(),KD=function(){function e(e,t){this.garbageCollector=e,this.asyncQueue=t,this.oe=!1,this.ce=null}return e.prototype.start=function(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(e)},e.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(e.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),e.prototype.ue=function(e){var t=this,n=this.oe?3e5:6e4;hN("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,function(){return Object(YS.b)(t,void 0,void 0,function(){var t;return Object(YS.d)(this,function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,e.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return aD(t=n.sent())?(hN("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t),[3,6]):[3,4];case 4:return[4,ZD(t)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(e)];case 8:return n.sent(),[2]}})})})},e}(),JD=function(){function e(e,t){this.ae=e,this.params=t}return e.prototype.calculateTargetCount=function(e,t){return this.ae.he(e).next(function(e){return Math.floor(t/100*e)})},e.prototype.nthSequenceNumber=function(e,t){var n=this;if(0===t)return tD.resolve(aN.o);var r=new YD(t);return this.ae.forEachTarget(e,function(e){return r.re(e.sequenceNumber)}).next(function(){return n.ae.le(e,function(e){return r.re(e)})}).next(function(){return r.maxValue})},e.prototype.removeTargets=function(e,t,n){return this.ae.removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){return this.ae.removeOrphanedDocuments(e,t)},e.prototype.collect=function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(hN("LruGarbageCollector","Garbage collection skipped; disabled"),tD.resolve(MD)):this.getCacheSize(e).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(hN("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),MD):n.fe(e,t)})},e.prototype.getCacheSize=function(e){return this.ae.getCacheSize(e)},e.prototype.fe=function(e,t){var n,r,i,o,a,s,u,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(function(t){return t>c.params.maximumSequenceNumbersToCollect?(hN("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+t),r=c.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),c.nthSequenceNumber(e,r)}).next(function(r){return n=r,a=Date.now(),c.removeTargets(e,n,t)}).next(function(t){return i=t,s=Date.now(),c.removeOrphanedDocuments(e,n)}).next(function(e){return u=Date.now(),lN()<=JS.a.DEBUG&&hN("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+e+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-l)+"ms"),tD.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})})},e}(),XD=function(){function e(e,t){this.db=e,this.garbageCollector=function(e,t){return new JD(e,t)}(this,t)}return e.prototype.he=function(e){var t=this.de(e);return this.db.getTargetCache().getTargetCount(e).next(function(e){return t.next(function(t){return e+t})})},e.prototype.de=function(e){var t=0;return this.le(e,function(e){t++}).next(function(){return t})},e.prototype.forEachTarget=function(e,t){return this.db.getTargetCache().forEachTarget(e,t)},e.prototype.le=function(e,t){return this.we(e,function(e,n){return t(n)})},e.prototype.addReference=function(e,t,n){return eL(e,n)},e.prototype.removeReference=function(e,t,n){return eL(e,n)},e.prototype.removeTargets=function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)},e.prototype.markPotentiallyOrphaned=function(e,t){return eL(e,t)},e.prototype._e=function(e,t){return function(e,t){var n=!1;return zD(e).Ot(function(r){return jD(e,r,t).next(function(e){return e&&(n=!0),tD.resolve(!e)})}).next(function(){return n})}(e,t)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(e,function(a,s){if(s<=t){var u=n._e(e,a).next(function(t){if(!t)return o++,r.getEntry(e,a).next(function(){return r.removeEntry(a),$D(e).delete([0,NM(a.path)])})});i.push(u)}}).next(function(){return tD.waitFor(i)}).next(function(){return r.apply(e)}).next(function(){return o})},e.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)},e.prototype.updateLimboDocument=function(e,t){return eL(e,t)},e.prototype.we=function(e,t){var n,r=$D(e),i=aN.o;return r.$t({index:qM.documentTargetsIndex},function(e,r){var o=r.path,a=r.sequenceNumber;0===e[0]?(i!==aN.o&&t(new GN(MM(n)),i),i=a,n=o):i=aN.o}).next(function(){i!==aN.o&&t(new GN(MM(n)),i)})},e.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},e}();function eL(e,t){return $D(e).put(function(e,t){return new qM(0,NM(e.path),t)}(t,e.currentSequenceNumber))}var tL=function(){function e(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}return e.prototype.get=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[1];if(this.equalsFn(o[0],e))return a}},e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},e.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},e.prototype.forEach=function(e){SN(this.inner,function(t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];e(o[0],o[1])}})},e.prototype.isEmpty=function(){return PN(this.inner)},e}(),nL=function(){function e(){this.changes=new tL(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return e.prototype.getReadTime=function(e){var t=this.changes.get(e);return t?t.readTime:EN.min()},e.prototype.addEntry=function(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})},e.prototype.removeEntry=function(e,t){void 0===t&&(t=null),this.assertNotApplied(),this.changes.set(e,{document:sx.newInvalidDocument(e),readTime:t})},e.prototype.getEntry=function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?tD.resolve(n.document):this.getFromCache(e,t)},e.prototype.getEntries=function(e,t){return this.getAllFromCache(e,t)},e.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},e.prototype.assertNotApplied=function(){},e}(),rL=function(){function e(e,t){this.R=e,this.Ut=t}return e.prototype.addEntry=function(e,t,n){return aL(e).put(sL(t),n)},e.prototype.removeEntry=function(e,t){var n=aL(e),r=sL(t);return n.delete(r)},e.prototype.updateMetadata=function(e,t){var n=this;return this.getMetadata(e).next(function(r){return r.byteSize+=t,n.me(e,r)})},e.prototype.getEntry=function(e,t){var n=this;return aL(e).get(sL(t)).next(function(e){return n.ye(t,e)})},e.prototype.ge=function(e,t){var n=this;return aL(e).get(sL(t)).next(function(e){return{document:n.ye(t,e),size:BD(e)}})},e.prototype.getEntries=function(e,t){var n=this,r=MR();return this.pe(e,t,function(e,t){var i=n.ye(e,t);r=r.insert(e,i)}).next(function(){return r})},e.prototype.Ee=function(e,t){var n=this,r=MR(),i=new IR(GN.comparator);return this.pe(e,t,function(e,t){var o=n.ye(e,t);r=r.insert(e,o),i=i.insert(e,BD(t))}).next(function(){return{documents:r,Te:i}})},e.prototype.pe=function(e,t,n){if(t.isEmpty())return tD.resolve();var r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator(),o=i.getNext();return aL(e).$t({range:r},function(e,t,r){for(var a=GN.fromSegments(e);o&&GN.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,t),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},e.prototype.getDocumentsMatchingQuery=function(e,t,n){var r=this,i=MR(),o=t.path.length+1,a={};if(n.isEqual(EN.min())){var s=t.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=t.path.toArray(),c=bD(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=zM.collectionReadTimeIndex}return aL(e).$t(a,function(e,n,a){if(e.length===o){var s=yD(r.R,n);t.path.isPrefixOf(s.key.path)?zx(t,s)&&(i=i.insert(s.key,s)):a.done()}}).next(function(){return i})},e.prototype.newChangeBuffer=function(e){return new iL(this,!!e&&e.trackRemovals)},e.prototype.getSize=function(e){return this.getMetadata(e).next(function(e){return e.byteSize})},e.prototype.getMetadata=function(e){return oL(e).get(HM.key).next(function(e){return gN(!!e),e})},e.prototype.me=function(e,t){return oL(e).put(HM.key,t)},e.prototype.ye=function(e,t){if(t){var n=yD(this.R,t);if(!n.isNoDocument()||!n.version.isEqual(EN.min()))return n}return sx.newInvalidDocument(e)},e}(),iL=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).Ie=t,r.trackRemovals=n,r.Ae=new tL(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),r}return Object(YS.c)(t,e),t.prototype.applyChanges=function(e){var t=this,n=[],r=0,i=new NR(function(e,t){return _N(e.canonicalString(),t.canonicalString())});return this.changes.forEach(function(o,a){var s=t.Ae.get(o);if(a.document.isValidDocument()){var u=mD(t.Ie.R,a.document,t.getReadTime(o));i=i.add(o.path.popLast());var c=BD(u);r+=c-s,n.push(t.Ie.addEntry(e,o,u))}else if(r-=s,t.trackRemovals){var l=mD(t.Ie.R,sx.newNoDocument(o,EN.min()),t.getReadTime(o));n.push(t.Ie.addEntry(e,o,l))}else n.push(t.Ie.removeEntry(e,o))}),i.forEach(function(r){n.push(t.Ie.Ut.addToCollectionParentIndex(e,r))}),n.push(this.Ie.updateMetadata(e,r)),tD.waitFor(n)},t.prototype.getFromCache=function(e,t){var n=this;return this.Ie.ge(e,t).next(function(e){return n.Ae.set(t,e.size),e.document})},t.prototype.getAllFromCache=function(e,t){var n=this;return this.Ie.Ee(e,t).next(function(e){var t=e.documents;return e.Te.forEach(function(e,t){n.Ae.set(e,t)}),t})},t}(nL);function oL(e){return fD(e,HM.store)}function aL(e){return fD(e,zM.store)}function sL(e){return e.path.toArray()}var uL=function(){function e(e){this.R=e}return e.prototype.Rt=function(e,t,n,r){var i=this;gN(n<r&&n>=0&&r<=11);var o=new nD("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(LM.store)}(e),function(e){e.createObjectStore(BM.store,{keyPath:BM.keyPath}),e.createObjectStore(FM.store,{keyPath:FM.keyPath,autoIncrement:!0}).createIndex(FM.userMutationsIndex,FM.userMutationsKeyPath,{unique:!0}),e.createObjectStore(jM.store)}(e),cL(e),function(e){e.createObjectStore(zM.store)}(e));var a=tD.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(qM.store),e.deleteObjectStore(GM.store),e.deleteObjectStore(WM.store)}(e),cL(e)),a=a.next(function(){return function(e){var t=e.store(WM.store),n=new WM(0,0,EN.min().toTimestamp(),0);return t.put(WM.key,n)}(o)})),n<4&&r>=4&&(0!==n&&(a=a.next(function(){return function(e,t){return t.store(FM.store).Nt().next(function(n){e.deleteObjectStore(FM.store),e.createObjectStore(FM.store,{keyPath:FM.keyPath,autoIncrement:!0}).createIndex(FM.userMutationsIndex,FM.userMutationsKeyPath,{unique:!0});var r=t.store(FM.store),i=n.map(function(e){return r.put(e)});return tD.waitFor(i)})}(e,o)})),a=a.next(function(){!function(e){e.createObjectStore(ZM.store,{keyPath:ZM.keyPath})}(e)})),n<5&&r>=5&&(a=a.next(function(){return i.Re(o)})),n<6&&r>=6&&(a=a.next(function(){return function(e){e.createObjectStore(HM.store)}(e),i.be(o)})),n<7&&r>=7&&(a=a.next(function(){return i.ve(o)})),n<8&&r>=8&&(a=a.next(function(){return i.Pe(e,o)})),n<9&&r>=9&&(a=a.next(function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){var t=e.objectStore(zM.store);t.createIndex(zM.readTimeIndex,zM.readTimeIndexPath,{unique:!1}),t.createIndex(zM.collectionReadTimeIndex,zM.collectionReadTimeIndexPath,{unique:!1})}(t)})),n<10&&r>=10&&(a=a.next(function(){return i.Ve(o)})),n<11&&r>=11&&(a=a.next(function(){!function(e){e.createObjectStore(QM.store,{keyPath:QM.keyPath})}(e),function(e){e.createObjectStore(YM.store,{keyPath:YM.keyPath})}(e)})),a},e.prototype.be=function(e){var t=0;return e.store(zM.store).$t(function(e,n){t+=BD(n)}).next(function(){var n=new HM(t);return e.store(HM.store).put(HM.key,n)})},e.prototype.Re=function(e){var t=this,n=e.store(BM.store),r=e.store(FM.store);return n.Nt().next(function(n){return tD.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(FM.userMutationsIndex,i).next(function(r){return tD.forEach(r,function(r){gN(r.userId===n.userId);var i=CD(t.R,r);return LD(e,n.userId,i).next(function(){})})})})})},e.prototype.ve=function(e){var t=e.store(qM.store),n=e.store(zM.store);return e.store(WM.store).get(WM.key).next(function(e){var r=[];return n.$t(function(n,i){var o=new TN(n),a=function(e){return[0,NM(e)]}(o);r.push(t.get(a).next(function(n){return n?tD.resolve():function(n){return t.put(new qM(0,NM(n),e.highestListenSequenceNumber))}(o)}))}).next(function(){return tD.waitFor(r)})})},e.prototype.Pe=function(e,t){e.createObjectStore($M.store,{keyPath:$M.keyPath});var n=t.store($M.store),r=new ND,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:NM(i)})}};return t.store(zM.store).$t({Ft:!0},function(e,t){var n=new TN(e);return i(n.popLast())}).next(function(){return t.store(jM.store).$t({Ft:!0},function(e,t){var n=MM(e[1]);return i(n.popLast())})})},e.prototype.Ve=function(e){var t=this,n=e.store(GM.store);return n.$t(function(e,r){var i=ED(r),o=OD(t.R,i);return n.put(o)})},e}();function cL(e){e.createObjectStore(qM.store,{keyPath:qM.keyPath}).createIndex(qM.documentTargetsIndex,qM.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(GM.store,{keyPath:GM.keyPath}).createIndex(GM.queryTargetsIndexName,GM.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(WM.store)}var lL="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",hL=function(){function e(t,n,r,i,o,a,s,u,c,l){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=a,this.document=s,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(e){return Promise.resolve()},!e.yt())throw new uN(sN.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new XD(this,i),this.Le=n+"main",this.R=new gD(u),this.Be=new rD(this.Le,11,new uL(this.R)),this.qe=new GD(this.referenceDelegate,this.R),this.Ut=new xD,this.Ue=function(e,t){return new rL(e,t)}(this.R,this.Ut),this.Ke=new PD,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===l&&fN("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return e.prototype.start=function(){var e=this;return this.je().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new uN(sN.FAILED_PRECONDITION,lL);return e.We(),e.Ge(),e.ze(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.qe.getHighestSequenceNumber(t)})}).then(function(t){e.Ne=new aN(t,e.De)}).then(function(){e.xe=!0}).catch(function(t){return e.Be&&e.Be.close(),Promise.reject(t)})},e.prototype.He=function(e){var t=this;return this.Me=function(n){return Object(YS.b)(t,void 0,void 0,function(){return Object(YS.d)(this,function(t){return this.started?[2,e(n)]:[2]})})},e(this.isPrimary)},e.prototype.setDatabaseDeletedListener=function(e){var t=this;this.Be.vt(function(n){return Object(YS.b)(t,void 0,void 0,function(){return Object(YS.d)(this,function(t){switch(t.label){case 0:return null===n.newVersion?[4,e()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},e.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Se.enqueueAndForget(function(){return Object(YS.b)(t,void 0,void 0,function(){return Object(YS.d)(this,function(e){switch(e.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}))},e.prototype.je=function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(t){return dL(t).put(new ZM(e.clientId,Date.now(),e.networkEnabled,e.inForeground)).next(function(){if(e.isPrimary)return e.Je(t).next(function(t){t||(e.isPrimary=!1,e.Se.enqueueRetryable(function(){return e.Me(!1)}))})}).next(function(){return e.Ye(t)}).next(function(n){return e.isPrimary&&!n?e.Xe(t).next(function(){return!1}):!!n&&e.Ze(t).next(function(){return!0})})}).catch(function(t){if(aD(t))return hN("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return hN("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){e.isPrimary!==t&&e.Se.enqueueRetryable(function(){return e.Me(t)}),e.isPrimary=t})},e.prototype.Je=function(e){var t=this;return fL(e).get(LM.key).next(function(e){return tD.resolve(t.tn(e))})},e.prototype.en=function(e){return dL(e).delete(this.clientId)},e.prototype.nn=function(){return Object(YS.b)(this,void 0,void 0,function(){var e,t,n,r=this;return Object(YS.d)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var t=fD(e,ZM.store);return t.Nt().next(function(e){var n=r.rn(e,18e5),i=e.filter(function(e){return-1===n.indexOf(e)});return tD.forEach(i,function(e){return t.delete(e.clientId)}).next(function(){return i})})}).catch(function(){return[]})]);case 1:if(e=i.sent(),this.Qe)for(t=0,n=e;t<n.length;t++)this.Qe.removeItem(this.on(n[t].clientId));i.label=2;case 2:return[2]}})})},e.prototype.ze=function(){var e=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return e.je().then(function(){return e.nn()}).then(function(){return e.ze()})})},e.prototype.tn=function(e){return!!e&&e.ownerId===this.clientId},e.prototype.Ye=function(e){var t=this;return this.Ce?tD.resolve(!0):fL(e).get(LM.key).next(function(n){if(null!==n&&t.sn(n.leaseTimestampMs,5e3)&&!t.cn(n.ownerId)){if(t.tn(n)&&t.networkEnabled)return!0;if(!t.tn(n)){if(!n.allowTabSynchronization)throw new uN(sN.FAILED_PRECONDITION,lL);return!1}}return!(!t.networkEnabled||!t.inForeground)||dL(e).Nt().next(function(e){return void 0===t.rn(e,5e3).find(function(e){return!(t.clientId===e.clientId||!(!t.networkEnabled&&e.networkEnabled||!t.inForeground&&e.inForeground&&t.networkEnabled===e.networkEnabled))})})}).next(function(e){return t.isPrimary!==e&&hN("IndexedDbPersistence","Client "+(e?"is":"is not")+" eligible for a primary lease."),e})},e.prototype.shutdown=function(){return Object(YS.b)(this,void 0,void 0,function(){var e=this;return Object(YS.d)(this,function(t){switch(t.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[LM.store,ZM.store],function(t){var n=new hD(t,aN.o);return e.Xe(n).next(function(){return e.en(n)})})];case 1:return t.sent(),this.Be.close(),this.ln(),[2]}})})},e.prototype.rn=function(e,t){var n=this;return e.filter(function(e){return n.sn(e.updateTimeMs,t)&&!n.cn(e.clientId)})},e.prototype.fn=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return dL(t).Nt().next(function(t){return e.rn(t,18e5).map(function(e){return e.clientId})})})},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.getMutationQueue=function(e){return FD.Qt(e,this.R,this.Ut,this.referenceDelegate)},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getBundleCache=function(){return this.Ke},e.prototype.runTransaction=function(e,t,n){var r,i=this;return hN("IndexedDbPersistence","Starting transaction:",e),this.Be.runTransaction(e,"readonly"===t?"readonly":"readwrite",KM,function(o){return r=new hD(o,i.Ne?i.Ne.next():aN.o),"readwrite-primary"===t?i.Je(r).next(function(e){return!!e||i.Ye(r)}).next(function(t){if(!t)throw fN("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Se.enqueueRetryable(function(){return i.Me(!1)}),new uN(sN.FAILED_PRECONDITION,JM);return n(r)}).next(function(e){return i.Ze(r).next(function(){return e})}):i.dn(r).next(function(){return n(r)})}).then(function(e){return r.raiseOnCommittedEvent(),e})},e.prototype.dn=function(e){var t=this;return fL(e).get(LM.key).next(function(e){if(null!==e&&t.sn(e.leaseTimestampMs,5e3)&&!t.cn(e.ownerId)&&!t.tn(e)&&!(t.Ce||t.allowTabSynchronization&&e.allowTabSynchronization))throw new uN(sN.FAILED_PRECONDITION,lL)})},e.prototype.Ze=function(e){var t=new LM(this.clientId,this.allowTabSynchronization,Date.now());return fL(e).put(LM.key,t)},e.yt=function(){return rD.yt()},e.prototype.Xe=function(e){var t=this,n=fL(e);return n.get(LM.key).next(function(e){return t.tn(e)?(hN("IndexedDbPersistence","Releasing primary lease."),n.delete(LM.key)):tD.resolve()})},e.prototype.sn=function(e,t){var n=Date.now();return!(e<n-t||e>n&&(fN("Detected an update time that is in the future: "+e+" > "+n),1))},e.prototype.We=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fe=function(){e.Se.enqueueAndForget(function(){return e.inForeground="visible"===e.document.visibilityState,e.je()})},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground="visible"===this.document.visibilityState)},e.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},e.prototype.Ge=function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ke=function(){t.un(),Object(KS.z)()&&navigator.appVersion.match("Version/14")&&t.Se.enterRestrictedMode(!0),t.Se.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("pagehide",this.ke))},e.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},e.prototype.cn=function(e){var t;try{var n=null!==(null===(t=this.Qe)||void 0===t?void 0:t.getItem(this.on(e)));return hN("IndexedDbPersistence","Client '"+e+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(e){return fN("IndexedDbPersistence","Failed to get zombied client id.",e),!1}},e.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(e){fN("Failed to set zombie client id.",e)}},e.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(e){}},e.prototype.on=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},e}();function fL(e){return fD(e,LM.store)}function dL(e){return fD(e,ZM.store)}function pL(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var vL=function(e,t){this.progress=e,this.wn=t},gL=function(){function e(e,t,n){this.Ue=e,this._n=t,this.Ut=n}return e.prototype.mn=function(e,t){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(e,t).next(function(r){return n.yn(e,t,r)})},e.prototype.yn=function(e,t,n){return this.Ue.getEntry(e,t).next(function(e){for(var t=0,r=n;t<r.length;t++)r[t].applyToLocalView(e);return e})},e.prototype.gn=function(e,t){e.forEach(function(e,n){for(var r=0,i=t;r<i.length;r++)i[r].applyToLocalView(n)})},e.prototype.pn=function(e,t){var n=this;return this.Ue.getEntries(e,t).next(function(t){return n.En(e,t).next(function(){return t})})},e.prototype.En=function(e,t){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){return n.gn(t,e)})},e.prototype.getDocumentsMatchingQuery=function(e,t,n){return function(e){return GN.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Tn(e,t.path):Dx(t)?this.In(e,t,n):this.An(e,t,n)},e.prototype.Tn=function(e,t){return this.mn(e,new GN(t)).next(function(e){var t=LR();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})},e.prototype.In=function(e,t,n){var r=this,i=t.collectionGroup,o=LR();return this.Ut.getCollectionParents(e,i).next(function(a){return tD.forEach(a,function(a){var s=function(e,t){return new Ix(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(i));return r.An(e,s,n).next(function(e){e.forEach(function(e,t){o=o.insert(e,t)})})}).next(function(){return o})})},e.prototype.An=function(e,t,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(e,t,n).next(function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(e,t)}).next(function(t){return o.Rn(e,i=t,r).next(function(e){r=e;for(var t=0,n=i;t<n.length;t++)for(var o=n[t],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=r.get(c);null==l&&(l=sx.newInvalidDocument(c),r=r.insert(c,l)),fR(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}})}).next(function(){return r.forEach(function(e,n){zx(t,n)||(r=r.remove(e))}),r})},e.prototype.Rn=function(e,t,n){for(var r=UR(),i=0,o=t;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof yR&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(e,r).next(function(e){return e.forEach(function(e,t){t.isFoundDocument()&&(c=c.insert(e,t))}),c})},e}(),yL=function(){function e(e,t,n,r){this.targetId=e,this.fromCache=t,this.bn=n,this.vn=r}return e.Pn=function(t,n){for(var r=UR(),i=UR(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new e(t,n.fromCache,r,i)},e}(),mL=function(){function e(){}return e.prototype.Vn=function(e){this.Sn=e},e.prototype.getDocumentsMatchingQuery=function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(EN.min())?this.Dn(e,t):this.Sn.pn(e,r).next(function(o){var a=i.Cn(t,o);return(Nx(t)||xx(t))&&i.Nn(t.limitType,a,r,n)?i.Dn(e,t):(lN()<=JS.a.DEBUG&&hN("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Vx(t)),i.Sn.getDocumentsMatchingQuery(e,t,n).next(function(e){return a.forEach(function(t){e=e.insert(t.key,t)}),e}))})},e.prototype.Cn=function(e,t){var n=new NR(Hx(e));return t.forEach(function(t,r){zx(e,r)&&(n=n.add(r))}),n},e.prototype.Nn=function(e,t,n,r){if(n.size!==t.size)return!0;var i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},e.prototype.Dn=function(e,t){return lN()<=JS.a.DEBUG&&hN("QueryEngine","Using full collection scan to execute query:",Vx(t)),this.Sn.getDocumentsMatchingQuery(e,t,EN.min())},e}(),bL=function(){function e(e,t,n,r){this.persistence=e,this.xn=t,this.R=r,this.kn=new IR(_N),this.Fn=new tL(function(e){return lx(e)},hx),this.$n=EN.min(),this._n=e.getMutationQueue(n),this.On=e.getRemoteDocumentCache(),this.qe=e.getTargetCache(),this.Mn=new gL(this.On,this._n,this.persistence.getIndexManager()),this.Ke=e.getBundleCache(),this.xn.Vn(this.Mn)}return e.prototype.collectGarbage=function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.kn)})},e}();function _L(e,t,n,r){return new bL(e,t,n,r)}function wL(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(YS.d)(this,function(a){switch(a.label){case 0:return n=yN(e),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(e){var o;return n._n.getAllMutationBatches(e).next(function(a){return o=a,r=n.persistence.getMutationQueue(t),i=new gL(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(e)}).next(function(t){for(var n=[],r=[],a=UR(),s=0,u=o;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++)a=a.add(h[l].key)}for(var f=0,d=t;f<d.length;f++){var p=d[f];r.push(p.batchId);for(var v=0,g=p.mutations;v<g.length;v++)a=a.add(g[v].key)}return i.pn(e,a).next(function(e){return{Ln:e,removedBatchIds:n,addedBatchIds:r}})})})];case 1:return o=a.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}})})}function kL(e,t){var n=yN(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r=t.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,o=i.keys(),a=tD.resolve();return o.forEach(function(e){a=a.next(function(){return r.getEntry(t,e)}).next(function(t){var o=n.docVersions.get(e);gN(null!==o),t.version.compareTo(o)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))})}),a.next(function(){return e._n.removeMutationBatch(t,i)})}(n,e,t,i).next(function(){return i.apply(e)}).next(function(){return n._n.performConsistencyCheck(e)}).next(function(){return n.Mn.pn(e,r)})})}function CL(e){var t=yN(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.qe.getLastRemoteSnapshotVersion(e)})}function EL(e,t){var n=yN(e),r=t.snapshotVersion,i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.kn;var a=[];t.targetChanges.forEach(function(t,o){var s=i.get(o);if(s){a.push(n.qe.removeMatchingKeys(e,t.removedDocuments,o).next(function(){return n.qe.addMatchingKeys(e,t.addedDocuments,o)}));var u=t.resumeToken;if(u.approximateByteSize()>0){var c=s.withResumeToken(u,r).withSequenceNumber(e.currentSequenceNumber);i=i.insert(o,c),function(e,t,n){return gN(t.resumeToken.approximateByteSize()>0),0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,c,t)&&a.push(n.qe.updateTargetData(e,c))}}});var s=MR();if(t.documentUpdates.forEach(function(r,i){t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(OL(e,o,t.documentUpdates,r,void 0).next(function(e){s=e})),!r.isEqual(EN.min())){var u=n.qe.getLastRemoteSnapshotVersion(e).next(function(t){return n.qe.setTargetsMetadata(e,e.currentSequenceNumber,r)});a.push(u)}return tD.waitFor(a).next(function(){return o.apply(e)}).next(function(){return n.Mn.En(e,s)}).next(function(){return s})}).then(function(e){return n.kn=i,e})}function OL(e,t,n,r,i){var o=UR();return n.forEach(function(e){return o=o.add(e)}),t.getEntries(e,o).next(function(e){var o=MR();return n.forEach(function(n,a){var s=e.get(n),u=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(EN.min())?(t.removeEntry(n,u),o=o.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(a,u),o=o.insert(n,a)):hN("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)}),o})}function SL(e,t){var n=yN(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n._n.getNextMutationBatchAfterBatchId(e,t)})}function PL(e,t){var n=yN(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.qe.getTargetData(e,t).next(function(i){return i?tD.resolve(r=i):n.qe.allocateTargetId(e).next(function(i){return r=new vD(t,i,0,e.currentSequenceNumber),n.qe.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.kn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(e.targetId,e),n.Fn.set(t,e.targetId)),e})}function IL(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var r,i,o,a;return Object(YS.d)(this,function(s){switch(s.label){case 0:r=yN(e),i=r.kn.get(t),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(e){return r.persistence.referenceDelegate.removeTarget(e,i)})];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!aD(a=s.sent()))throw a;return hN("LocalStore","Failed to update sequence numbers for target "+t+": "+a),[3,5];case 5:return r.kn=r.kn.remove(t),r.Fn.delete(i.target),[2]}})})}function TL(e,t,n){var r=yN(e),i=EN.min(),o=UR();return r.persistence.runTransaction("Execute query","readonly",function(e){return function(e,t,n){var r=yN(e),i=r.Fn.get(n);return void 0!==i?tD.resolve(r.kn.get(i)):r.qe.getTargetData(t,n)}(r,e,Bx(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(e,t.targetId).next(function(e){o=e})}).next(function(){return r.xn.getDocumentsMatchingQuery(e,t,n?i:EN.min(),n?o:UR())}).next(function(e){return{documents:e,Bn:o}})})}function AL(e,t){var n=yN(e),r=yN(n.qe),i=n.kn.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(e){return r.lt(e,t).next(function(e){return e?e.target:null})})}function NL(e){var t=yN(e);return t.persistence.runTransaction("Get new document changes","readonly",function(e){return function(e,t,n){var r=yN(e),i=MR(),o=bD(n),a=aL(t),s=IDBKeyRange.lowerBound(o,!0);return a.$t({index:zM.readTimeIndex,range:s},function(e,t){var n=yD(r.R,t);i=i.insert(n.key,n),o=t.readTime}).next(function(){return{wn:i,readTime:_D(o)}})}(t.On,e,t.$n)}).then(function(e){var n=e.wn;return t.$n=e.readTime,n})}function xL(e){return Object(YS.b)(this,void 0,void 0,function(){var t;return Object(YS.d)(this,function(n){return[2,(t=yN(e)).persistence.runTransaction("Synchronize last document change read time","readonly",function(e){return function(e){var t=aL(e),n=EN.min();return t.$t({index:zM.readTimeIndex,reverse:!0},function(e,t,r){t.readTime&&(n=_D(t.readTime)),r.done()}).next(function(){return n})}(e)}).then(function(e){t.$n=e})]})})}function RL(e,t,n,r){return Object(YS.b)(this,void 0,void 0,function(){var i,o,a,s,u,c,l,h,f,d;return Object(YS.d)(this,function(p){switch(p.label){case 0:for(i=yN(e),o=UR(),a=MR(),s=FR(),u=0,c=n;u<c.length;u++)h=t.qn((l=c[u]).metadata.name),l.document&&(o=o.add(h)),a=a.insert(h,t.Un(l)),s=s.insert(h,t.Kn(l.metadata.readTime));return f=i.On.newChangeBuffer({trackRemovals:!0}),[4,PL(i,function(e){return Bx(Ax(TN.fromString("__bundle__/docs/"+e)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return OL(e,f,a,EN.min(),s).next(function(t){return f.apply(e),t}).next(function(t){return i.qe.removeMatchingKeysForTargetId(e,d.targetId).next(function(){return i.qe.addMatchingKeys(e,o,d.targetId)}).next(function(){return i.Mn.En(e,t)}).next(function(){return t})})})]}})})}function ML(e,t,n){return void 0===n&&(n=UR()),Object(YS.b)(this,void 0,void 0,function(){var r,i;return Object(YS.d)(this,function(o){switch(o.label){case 0:return[4,PL(e,Bx(SD(t.bundledQuery)))];case 1:return r=o.sent(),[2,(i=yN(e)).persistence.runTransaction("Save named query","readwrite",function(e){var o=iM(t.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ke.saveNamedQuery(e,t);var a=r.withResumeToken(RN.EMPTY_BYTE_STRING,o);return i.kn=i.kn.insert(a.targetId,a),i.qe.updateTargetData(e,a).next(function(){return i.qe.removeMatchingKeysForTargetId(e,r.targetId)}).next(function(){return i.qe.addMatchingKeys(e,n,r.targetId)}).next(function(){return i.Ke.saveNamedQuery(e,t)})})]}})})}var DL=function(){function e(e){this.R=e,this.Qn=new Map,this.jn=new Map}return e.prototype.getBundleMetadata=function(e,t){return tD.resolve(this.Qn.get(t))},e.prototype.saveBundleMetadata=function(e,t){var n;return this.Qn.set(t.id,{id:(n=t).id,version:n.version,createTime:iM(n.createTime)}),tD.resolve()},e.prototype.getNamedQuery=function(e,t){return tD.resolve(this.jn.get(t))},e.prototype.saveNamedQuery=function(e,t){return this.jn.set(t.name,function(e){return{name:e.name,query:SD(e.bundledQuery),readTime:iM(e.readTime)}}(t)),tD.resolve()},e}(),LL=function(){function e(){this.Wn=new NR(BL.Gn),this.zn=new NR(BL.Hn)}return e.prototype.isEmpty=function(){return this.Wn.isEmpty()},e.prototype.addReference=function(e,t){var n=new BL(e,t);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},e.prototype.Jn=function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})},e.prototype.removeReference=function(e,t){this.Yn(new BL(e,t))},e.prototype.Xn=function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})},e.prototype.Zn=function(e){var t=this,n=new GN(new TN([])),r=new BL(n,e),i=new BL(n,e+1),o=[];return this.zn.forEachInRange([r,i],function(e){t.Yn(e),o.push(e.key)}),o},e.prototype.ts=function(){var e=this;this.Wn.forEach(function(t){return e.Yn(t)})},e.prototype.Yn=function(e){this.Wn=this.Wn.delete(e),this.zn=this.zn.delete(e)},e.prototype.es=function(e){var t=new GN(new TN([])),n=new BL(t,e),r=new BL(t,e+1),i=UR();return this.zn.forEachInRange([n,r],function(e){i=i.add(e.key)}),i},e.prototype.containsKey=function(e){var t=new BL(e,0),n=this.Wn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)},e}(),BL=function(){function e(e,t){this.key=e,this.ns=t}return e.Gn=function(e,t){return GN.comparator(e.key,t.key)||_N(e.ns,t.ns)},e.Hn=function(e,t){return _N(e.ns,t.ns)||GN.comparator(e.key,t.key)},e}(),FL=function(){function e(e,t){this.Ut=e,this.referenceDelegate=t,this._n=[],this.ss=1,this.rs=new NR(BL.Gn)}return e.prototype.checkEmpty=function(e){return tD.resolve(0===this._n.length)},e.prototype.addMutationBatch=function(e,t,n,r){var i=this.ss;this.ss++;var o=new dD(i,t,n,r);this._n.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.rs=this.rs.add(new BL(u.key,i)),this.Ut.addToCollectionParentIndex(e,u.key.path.popLast())}return tD.resolve(o)},e.prototype.lookupMutationBatch=function(e,t){return tD.resolve(this.os(t))},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this.cs(t+1),r=n<0?0:n;return tD.resolve(this._n.length>r?this._n[r]:null)},e.prototype.getHighestUnacknowledgedBatchId=function(){return tD.resolve(0===this._n.length?-1:this.ss-1)},e.prototype.getAllMutationBatches=function(e){return tD.resolve(this._n.slice())},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=new BL(t,0),i=new BL(t,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],function(e){var t=n.os(e.ns);o.push(t)}),tD.resolve(o)},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new NR(_N);return t.forEach(function(e){var t=new BL(e,0),i=new BL(e,Number.POSITIVE_INFINITY);n.rs.forEachInRange([t,i],function(e){r=r.add(e.ns)})}),tD.resolve(this.us(r))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=t.path,r=n.length+1,i=n;GN.isDocumentKey(i)||(i=i.child(""));var o=new BL(new GN(i),0),a=new NR(_N);return this.rs.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.ns)),!0)},o),tD.resolve(this.us(a))},e.prototype.us=function(e){var t=this,n=[];return e.forEach(function(e){var r=t.os(e);null!==r&&n.push(r)}),n},e.prototype.removeMutationBatch=function(e,t){var n=this;gN(0===this.hs(t.batchId,"removed")),this._n.shift();var r=this.rs;return tD.forEach(t.mutations,function(i){var o=new BL(i.key,t.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.rs=r})},e.prototype.Gt=function(e){},e.prototype.containsKey=function(e,t){var n=new BL(t,0),r=this.rs.firstAfterOrEqual(n);return tD.resolve(t.isEqual(r&&r.key))},e.prototype.performConsistencyCheck=function(e){return tD.resolve()},e.prototype.hs=function(e,t){return this.cs(e)},e.prototype.cs=function(e){return 0===this._n.length?0:e-this._n[0].batchId},e.prototype.os=function(e){var t=this.cs(e);return t<0||t>=this._n.length?null:this._n[t]},e}(),jL=function(){function e(e,t){this.Ut=e,this.ls=t,this.docs=new IR(GN.comparator),this.size=0}return e.prototype.addEntry=function(e,t,n){var r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.ls(t);return this.docs=this.docs.insert(r,{document:t.clone(),size:a,readTime:n}),this.size+=a-o,this.Ut.addToCollectionParentIndex(e,r.path.popLast())},e.prototype.removeEntry=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},e.prototype.getEntry=function(e,t){var n=this.docs.get(t);return tD.resolve(n?n.document.clone():sx.newInvalidDocument(t))},e.prototype.getEntries=function(e,t){var n=this,r=MR();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.clone():sx.newInvalidDocument(e))}),tD.resolve(r)},e.prototype.getDocumentsMatchingQuery=function(e,t,n){for(var r=MR(),i=new GN(t.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.value,u=s.document,c=s.readTime;if(!t.path.isPrefixOf(a.key.path))break;c.compareTo(n)<=0||zx(t,u)&&(r=r.insert(u.key,u.clone()))}return tD.resolve(r)},e.prototype.fs=function(e,t){return tD.forEach(this.docs,function(e){return t(e)})},e.prototype.newChangeBuffer=function(e){return new UL(this)},e.prototype.getSize=function(e){return tD.resolve(this.size)},e}(),UL=function(e){function t(t){var n=this;return(n=e.call(this)||this).Ie=t,n}return Object(YS.c)(t,e),t.prototype.applyChanges=function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(t.Ie.addEntry(e,i.document,t.getReadTime(r))):t.Ie.removeEntry(r)}),tD.waitFor(n)},t.prototype.getFromCache=function(e,t){return this.Ie.getEntry(e,t)},t.prototype.getAllFromCache=function(e,t){return this.Ie.getEntries(e,t)},t}(nL),VL=function(){function e(e){this.persistence=e,this.ds=new tL(function(e){return lx(e)},hx),this.lastRemoteSnapshotVersion=EN.min(),this.highestTargetId=0,this.ws=0,this._s=new LL,this.targetCount=0,this.ys=HD.Jt()}return e.prototype.forEachTarget=function(e,t){return this.ds.forEach(function(e,n){return t(n)}),tD.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(e){return tD.resolve(this.lastRemoteSnapshotVersion)},e.prototype.getHighestSequenceNumber=function(e){return tD.resolve(this.ws)},e.prototype.allocateTargetId=function(e){return this.highestTargetId=this.ys.next(),tD.resolve(this.highestTargetId)},e.prototype.setTargetsMetadata=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ws&&(this.ws=t),tD.resolve()},e.prototype.te=function(e){this.ds.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.ys=new HD(t),this.highestTargetId=t),e.sequenceNumber>this.ws&&(this.ws=e.sequenceNumber)},e.prototype.addTargetData=function(e,t){return this.te(t),this.targetCount+=1,tD.resolve()},e.prototype.updateTargetData=function(e,t){return this.te(t),tD.resolve()},e.prototype.removeTargetData=function(e,t){return this.ds.delete(t.target),this._s.Zn(t.targetId),this.targetCount-=1,tD.resolve()},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return this.ds.forEach(function(a,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.ds.delete(a),o.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),tD.waitFor(o).next(function(){return i})},e.prototype.getTargetCount=function(e){return tD.resolve(this.targetCount)},e.prototype.getTargetData=function(e,t){var n=this.ds.get(t)||null;return tD.resolve(n)},e.prototype.addMatchingKeys=function(e,t,n){return this._s.Jn(t,n),tD.resolve()},e.prototype.removeMatchingKeys=function(e,t,n){this._s.Xn(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),tD.waitFor(i)},e.prototype.removeMatchingKeysForTargetId=function(e,t){return this._s.Zn(t),tD.resolve()},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=this._s.es(t);return tD.resolve(n)},e.prototype.containsKey=function(e,t){return tD.resolve(this._s.containsKey(t))},e}(),zL=function(){function e(e,t){var n=this;this.gs={},this.Ne=new aN(0),this.xe=!1,this.xe=!0,this.referenceDelegate=e(this),this.qe=new VL(this),this.Ut=new AD,this.Ue=function(e,t){return new jL(e,function(e){return n.referenceDelegate.ps(e)})}(this.Ut),this.R=new gD(t),this.Ke=new DL(this.R)}return e.prototype.start=function(){return Promise.resolve()},e.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.setDatabaseDeletedListener=function(){},e.prototype.setNetworkEnabled=function(){},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getMutationQueue=function(e){var t=this.gs[e.toKey()];return t||(t=new FL(this.Ut,this.referenceDelegate),this.gs[e.toKey()]=t),t},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getBundleCache=function(){return this.Ke},e.prototype.runTransaction=function(e,t,n){var r=this;hN("MemoryPersistence","Starting transaction:",e);var i=new HL(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(e){return r.referenceDelegate.Ts(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})},e.prototype.Is=function(e,t){return tD.or(Object.values(this.gs).map(function(n){return function(){return n.containsKey(e,t)}}))},e}(),HL=function(e){function t(t){var n=this;return(n=e.call(this)||this).currentSequenceNumber=t,n}return Object(YS.c)(t,e),t}(XM),GL=function(){function e(e){this.persistence=e,this.As=new LL,this.Rs=null}return e.bs=function(t){return new e(t)},Object.defineProperty(e.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw vN()},enumerable:!1,configurable:!0}),e.prototype.addReference=function(e,t,n){return this.As.addReference(n,t),this.vs.delete(n.toString()),tD.resolve()},e.prototype.removeReference=function(e,t,n){return this.As.removeReference(n,t),this.vs.add(n.toString()),tD.resolve()},e.prototype.markPotentiallyOrphaned=function(e,t){return this.vs.add(t.toString()),tD.resolve()},e.prototype.removeTarget=function(e,t){var n=this;this.As.Zn(t.targetId).forEach(function(e){return n.vs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.vs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})},e.prototype.Es=function(){this.Rs=new Set},e.prototype.Ts=function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return tD.forEach(this.vs,function(r){var i=GN.fromPath(r);return t.Ps(e,i).next(function(e){e||n.removeEntry(i)})}).next(function(){return t.Rs=null,n.apply(e)})},e.prototype.updateLimboDocument=function(e,t){var n=this;return this.Ps(e,t).next(function(e){e?n.vs.delete(t.toString()):n.vs.add(t.toString())})},e.prototype.ps=function(e){return 0},e.prototype.Ps=function(e,t){var n=this;return tD.or([function(){return tD.resolve(n.As.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Is(e,t)}])},e}(),qL=function(){function e(e){this.uid=e}return e.prototype.isAuthenticated=function(){return null!=this.uid},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(e){return e.uid===this.uid},e}();function WL(e,t){return"firestore_clients_"+e+"_"+t}function $L(e,t,n){var r="firestore_mutations_"+e+"_"+n;return t.isAuthenticated()&&(r+="_"+t.uid),r}function ZL(e,t){return"firestore_targets_"+e+"_"+t}qL.UNAUTHENTICATED=new qL(null),qL.GOOGLE_CREDENTIALS=new qL("google-credentials-uid"),qL.FIRST_PARTY=new qL("first-party-uid"),qL.MOCK_USER=new qL("mock-user");var QL=function(){function e(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}return e.Vs=function(t,n,r){var i,o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new uN(o.error.code,o.error.message)),a?new e(t,n,o.state,i):(fN("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.Ss=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),YL=function(){function e(e,t,n){this.targetId=e,this.state=t,this.error=n}return e.Vs=function(t,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new uN(i.error.code,i.error.message)),o?new e(t,i.state,r):(fN("SharedClientState","Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.Ss=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),KL=function(){function e(e,t){this.clientId=e,this.activeTargetIds=t}return e.Vs=function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=zR(),a=0;i&&a<r.activeTargetIds.length;++a)i=HN(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new e(t,o):(fN("SharedClientState","Failed to parse client data for instance '"+t+"': "+n),null)},e}(),JL=function(){function e(e,t){this.clientId=e,this.onlineState=t}return e.Vs=function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(fN("SharedClientState","Failed to parse online state: "+t),null)},e}(),XL=function(){function e(){this.activeTargetIds=zR()}return e.prototype.Ds=function(e){this.activeTargetIds=this.activeTargetIds.add(e)},e.prototype.Cs=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},e.prototype.Ss=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},e}(),eB=function(){function e(e,t,n,r,i){this.window=e,this.Se=t,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new IR(_N),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=WL(this.persistenceKey,this.Ns),this.Ms=function(e){return"firestore_sequence_number_"+e}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new XL),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(e){return"firestore_online_state_"+e}(this.persistenceKey),this.Ks=function(e){return"firestore_bundle_loaded_"+e}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return e.yt=function(e){return!(!e||!e.localStorage)},e.prototype.start=function(){return Object(YS.b)(this,void 0,void 0,function(){var e,t,n,r,i,o,a,s,u,c,l=this;return Object(YS.d)(this,function(h){switch(h.label){case 0:return[4,this.syncEngine.fn()];case 1:for(e=h.sent(),t=0,n=e;t<n.length;t++)(r=n[t])!==this.Ns&&(i=this.getItem(WL(this.persistenceKey,r)))&&(o=KL.Vs(r,i))&&(this.Fs=this.Fs.insert(o.clientId,o));for(this.Qs(),(a=this.storage.getItem(this.Us))&&(s=this.js(a))&&this.Ws(s),u=0,c=this.$s;u<c.length;u++)this.ks(c[u]);return this.$s=[],this.window.addEventListener("pagehide",function(){return l.shutdown()}),this.started=!0,[2]}})})},e.prototype.writeSequenceNumber=function(e){this.setItem(this.Ms,JSON.stringify(e))},e.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},e.prototype.isActiveQueryTarget=function(e){var t=!1;return this.Fs.forEach(function(n,r){r.activeTargetIds.has(e)&&(t=!0)}),t},e.prototype.addPendingMutation=function(e){this.zs(e,"pending")},e.prototype.updateMutationState=function(e,t,n){this.zs(e,t,n),this.Hs(e)},e.prototype.addLocalQueryTarget=function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(ZL(this.persistenceKey,e));if(n){var r=YL.Vs(e,n);r&&(t=r.state)}}return this.Js.Ds(e),this.Qs(),t},e.prototype.removeLocalQueryTarget=function(e){this.Js.Cs(e),this.Qs()},e.prototype.isLocalQueryTarget=function(e){return this.Js.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){this.removeItem(ZL(this.persistenceKey,e))},e.prototype.updateQueryState=function(e,t,n){this.Ys(e,t,n)},e.prototype.handleUserChange=function(e,t,n){var r=this;t.forEach(function(e){r.Hs(e)}),this.currentUser=e,n.forEach(function(e){r.addPendingMutation(e)})},e.prototype.setOnlineState=function(e){this.Xs(e)},e.prototype.notifyBundleLoaded=function(){this.Zs()},e.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},e.prototype.getItem=function(e){var t=this.storage.getItem(e);return hN("SharedClientState","READ",e,t),t},e.prototype.setItem=function(e,t){hN("SharedClientState","SET",e,t),this.storage.setItem(e,t)},e.prototype.removeItem=function(e){hN("SharedClientState","REMOVE",e),this.storage.removeItem(e)},e.prototype.ks=function(e){var t=this,n=e;if(n.storageArea===this.storage){if(hN("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void fN("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return Object(YS.b)(t,void 0,void 0,function(){var e,t,r,i,o,a;return Object(YS.d)(this,function(s){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return e=this.ti(n.key),[2,this.ei(e,null)];if(t=this.ni(n.key,n.newValue))return[2,this.ei(t.clientId,t)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(a=function(e){var t=aN.o;if(null!=e)try{var n=JSON.parse(e);gN("number"==typeof n),t=n}catch(e){fN("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue))!==aN.o&&this.sequenceNumberHandler(a);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]})})})}},Object.defineProperty(e.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),e.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},e.prototype.zs=function(e,t,n){var r=new QL(this.currentUser,e,t,n),i=$L(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Ss())},e.prototype.Hs=function(e){var t=$L(this.persistenceKey,this.currentUser,e);this.removeItem(t)},e.prototype.Xs=function(e){this.storage.setItem(this.Us,JSON.stringify({clientId:this.Ns,onlineState:e}))},e.prototype.Ys=function(e,t,n){var r=ZL(this.persistenceKey,e),i=new YL(e,t,n);this.setItem(r,i.Ss())},e.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},e.prototype.ti=function(e){var t=this.Ls.exec(e);return t?t[1]:null},e.prototype.ni=function(e,t){var n=this.ti(e);return KL.Vs(n,t)},e.prototype.si=function(e,t){var n=this.Bs.exec(e),r=Number(n[1]);return QL.Vs(new qL(void 0!==n[2]?n[2]:null),r,t)},e.prototype.ri=function(e,t){var n=this.qs.exec(e),r=Number(n[1]);return YL.Vs(r,t)},e.prototype.js=function(e){return JL.Vs(e)},e.prototype.ii=function(e){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(e.batchId,e.state,e.error)]:(hN("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},e.prototype.oi=function(e){return this.syncEngine.ai(e.targetId,e.state,e.error)},e.prototype.ei=function(e,t){var n=this,r=t?this.Fs.insert(e,t):this.Fs.remove(e),i=this.Gs(this.Fs),o=this.Gs(r),a=[],s=[];return o.forEach(function(e){i.has(e)||a.push(e)}),i.forEach(function(e){o.has(e)||s.push(e)}),this.syncEngine.hi(a,s).then(function(){n.Fs=r})},e.prototype.Ws=function(e){this.Fs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)},e.prototype.Gs=function(e){var t=zR();return e.forEach(function(e,n){t=t.unionWith(n.activeTargetIds)}),t},e}(),tB=function(){function e(){this.li=new XL,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e.prototype.addPendingMutation=function(e){},e.prototype.updateMutationState=function(e,t,n){},e.prototype.addLocalQueryTarget=function(e){return this.li.Ds(e),this.fi[e]||"not-current"},e.prototype.updateQueryState=function(e,t,n){this.fi[e]=t},e.prototype.removeLocalQueryTarget=function(e){this.li.Cs(e)},e.prototype.isLocalQueryTarget=function(e){return this.li.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){delete this.fi[e]},e.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},e.prototype.isActiveQueryTarget=function(e){return this.li.activeTargetIds.has(e)},e.prototype.start=function(){return this.li=new XL,Promise.resolve()},e.prototype.handleUserChange=function(e,t,n){},e.prototype.setOnlineState=function(e){},e.prototype.shutdown=function(){},e.prototype.writeSequenceNumber=function(e){},e.prototype.notifyBundleLoaded=function(){},e}(),nB=function(){function e(){}return e.prototype.di=function(e){},e.prototype.shutdown=function(){},e}(),rB=function(){function e(){var e=this;this.wi=function(){return e._i()},this.mi=function(){return e.yi()},this.gi=[],this.pi()}return e.prototype.di=function(e){this.gi.push(e)},e.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},e.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},e.prototype._i=function(){hN("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var e=0,t=this.gi;e<t.length;e++)(0,t[e])(0)},e.prototype.yi=function(){hN("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.gi;e<t.length;e++)(0,t[e])(1)},e.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},e}(),iB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},oB=function(){function e(e){this.Ei=e.Ei,this.Ti=e.Ti}return e.prototype.Ii=function(e){this.Ai=e},e.prototype.Ri=function(e){this.bi=e},e.prototype.onMessage=function(e){this.vi=e},e.prototype.close=function(){this.Ti()},e.prototype.send=function(e){this.Ei(e)},e.prototype.Pi=function(){this.Ai()},e.prototype.Vi=function(e){this.bi(e)},e.prototype.Si=function(e){this.vi(e)},e}(),aB=function(e){function t(t){var n=this;return(n=e.call(this,t)||this).forceLongPolling=t.forceLongPolling,n.autoDetectLongPolling=t.autoDetectLongPolling,n.useFetchStreams=t.useFetchStreams,n}return Object(YS.c)(t,e),t.prototype.Fi=function(e,t,n,r){return new Promise(function(i,o){var a=new oN;a.listenOnce(tN.COMPLETE,function(){try{switch(a.getLastErrorCode()){case eN.NO_ERROR:var t=a.getResponseJson();hN("Connection","XHR received:",JSON.stringify(t)),i(t);break;case eN.TIMEOUT:hN("Connection",'RPC "'+e+'" timed out'),o(new uN(sN.DEADLINE_EXCEEDED,"Request time out"));break;case eN.HTTP_ERROR:var n=a.getStatus();if(hN("Connection",'RPC "'+e+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var s=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(sN).indexOf(t)>=0?t:sN.UNKNOWN}(r.status);o(new uN(s,r.message))}else o(new uN(sN.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new uN(sN.UNAVAILABLE,"Connection failed."));break;default:vN()}}finally{hN("Connection",'RPC "'+e+'" completed.')}});var s=JSON.stringify(r);a.send(t,"POST",s,n,15)})},t.prototype.Oi=function(e,t){var n=[this.Di,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=new QA,i=HI(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new rN({})),this.ki(o.initMessageHeaders,t),Object(KS.v)()||Object(KS.y)()||Object(KS.s)()||Object(KS.u)()||Object(KS.A)()||Object(KS.r)()||(o.httpHeadersOverwriteParam="$httpHeaders");var a=n.join("");hN("Connection","Creating WebChannel: "+a,o);var s=r.createWebChannel(a,o),u=!1,c=!1,l=new oB({Ei:function(e){c?hN("Connection","Not sending because WebChannel is closed:",e):(u||(hN("Connection","Opening WebChannel transport."),s.open(),u=!0),hN("Connection","WebChannel sending:",e),s.send(e))},Ti:function(){return s.close()}}),h=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(e){setTimeout(function(){throw e},0)}})};return h(s,iN.EventType.OPEN,function(){c||hN("Connection","WebChannel transport opened.")}),h(s,iN.EventType.CLOSE,function(){c||(c=!0,hN("Connection","WebChannel transport closed"),l.Vi())}),h(s,iN.EventType.ERROR,function(e){c||(c=!0,dN("Connection","WebChannel transport errored:",e),l.Vi(new uN(sN.UNAVAILABLE,"The operation could not be completed")))}),h(s,iN.EventType.MESSAGE,function(e){var t;if(!c){var n=e.data[0];gN(!!n);var r=n.error||(null===(t=n[0])||void 0===t?void 0:t.error);if(r){hN("Connection","WebChannel received error:",r);var i=r.status,o=function(e){var t=wR[e];if(void 0!==t)return PR(t)}(i),a=r.message;void 0===o&&(o=sN.INTERNAL,a="Unknown error status: "+i+" with message "+r.message),c=!0,l.Vi(new uN(o,a)),s.close()}else hN("Connection","WebChannel received:",n),l.Si(n)}}),h(i,nN.STAT_EVENT,function(e){10===e.stat?hN("Connection","Detected buffering proxy"):11===e.stat&&hN("Connection","Detected no buffering proxy")}),setTimeout(function(){l.Pi()},0),l},t}(function(){function e(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.Di=(e.ssl?"https":"http")+"://"+e.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return e.prototype.Ni=function(e,t,n,r){var i=this.xi(e,t);hN("RestConnection","Sending: ",i,n);var o={};return this.ki(o,r),this.Fi(e,i,o,n).then(function(e){return hN("RestConnection","Received: ",e),e},function(t){throw dN("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},e.prototype.$i=function(e,t,n,r){return this.Ni(e,t,n,r)},e.prototype.ki=function(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/8.10.0",e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])},e.prototype.xi=function(e,t){return this.Di+"/v1/"+t+":"+iB[e]},e}());function sB(){return"undefined"!=typeof window?window:null}function uB(){return"undefined"!=typeof document?document:null}function cB(e){return new eM(e,!0)}var lB=function(){function e(e,t,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=e,this.timerId=t,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return e.prototype.reset=function(){this.qi=0},e.prototype.Qi=function(){this.qi=this.Bi},e.prototype.ji=function(e){var t=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&hN("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return t.Ki=Date.now(),e()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},e.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},e.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},e.prototype.Wi=function(){return(Math.random()-.5)*this.qi},e}(),hB=function(){function e(e,t,n,r,i,o){this.Se=e,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new lB(e,t)}return e.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},e.prototype.er=function(){return 2===this.state},e.prototype.start=function(){3!==this.state?this.auth():this.nr()},e.prototype.stop=function(){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(e){switch(e.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.sr=function(){this.state=0,this.Zi.reset()},e.prototype.ir=function(){var e=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return e.rr()}))},e.prototype.cr=function(e){this.ur(),this.stream.send(e)},e.prototype.rr=function(){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(e){return this.er()?[2,this.close(0)]:[2]})})},e.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},e.prototype.close=function(e,t){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==e?this.Zi.reset():t&&t.code===sN.RESOURCE_EXHAUSTED?(fN(t.toString()),fN("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):t&&t.code===sN.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ri(t)];case 1:return n.sent(),[2]}})})},e.prototype.ar=function(){},e.prototype.auth=function(){var e=this;this.state=1;var t=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then(function(t){e.Yi===n&&e.lr(t)},function(n){t(function(){var t=new uN(sN.UNKNOWN,"Fetching auth token failed: "+n.message);return e.dr(t)})})},e.prototype.lr=function(e){var t=this,n=this.hr(this.Yi);this.stream=this.wr(e),this.stream.Ii(function(){n(function(){return t.state=2,t.listener.Ii()})}),this.stream.Ri(function(e){n(function(){return t.dr(e)})}),this.stream.onMessage(function(e){n(function(){return t.onMessage(e)})})},e.prototype.nr=function(){var e=this;this.state=4,this.Zi.ji(function(){return Object(YS.b)(e,void 0,void 0,function(){return Object(YS.d)(this,function(e){return this.state=0,this.start(),[2]})})})},e.prototype.dr=function(e){return hN("PersistentStream","close with error: "+e),this.stream=null,this.close(3,e)},e.prototype.hr=function(e){var t=this;return function(n){t.Se.enqueueAndForget(function(){return t.Yi===e?n():(hN("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},e}(),fB=function(e){function t(t,n,r,i,o){var a=this;return(a=e.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,a}return Object(YS.c)(t,e),t.prototype.wr=function(e){return this.Hi.Oi("Listen",e)},t.prototype.onMessage=function(e){this.Zi.reset();var t=function(e,t){var n;if("targetChange"in t){var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:vN()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(e,t){return e.I?(gN(void 0===t||"string"==typeof t),RN.fromBase64String(t||"")):(gN(void 0===t||t instanceof Uint8Array),RN.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=(s=t.targetChange.cause)&&function(e){var t=void 0===e.code?sN.UNKNOWN:PR(e.code);return new uN(t,e.message||"")}(s);n=new $R(r,i,o,a||null)}else if("documentChange"in t){i=uM(e,(r=t.documentChange).document.name),o=iM(r.document.updateTime);var s=new ox({mapValue:{fields:r.document.fields}}),u=(a=sx.newFoundDocument(i,o,s),r.targetIds||[]);n=new qR(u,r.removedTargetIds||[],a.key,a)}else if("documentDelete"in t)i=uM(e,(r=t.documentDelete).document),o=r.readTime?iM(r.readTime):EN.min(),s=sx.newNoDocument(i,o),n=new qR([],a=r.removedTargetIds||[],s.key,s);else if("documentRemove"in t)i=uM(e,(r=t.documentRemove).document),n=new qR([],o=r.removedTargetIds||[],i,null);else{if(!("filter"in t))return vN();var c=t.filter;i=new OR(r=c.count||0),n=new WR(o=c.targetId,i)}return n}(this.R,e),n=function(e){if(!("targetChange"in e))return EN.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?EN.min():t.readTime?iM(t.readTime):EN.min()}(e);return this.listener._r(t,n)},t.prototype.mr=function(e){var t={};t.database=hM(this.R),t.addTarget=function(e,t){var n,r=t.target;return(n=fx(r)?{documents:yM(e,r)}:{query:mM(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=nM(e,t.resumeToken):t.snapshotVersion.compareTo(EN.min())>0&&(n.readTime=tM(e,t.snapshotVersion.toTimestamp())),n}(this.R,e);var n=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return vN()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);n&&(t.labels=n),this.cr(t)},t.prototype.yr=function(e){var t={};t.database=hM(this.R),t.removeTarget=e,this.cr(t)},t}(hB),dB=function(e){function t(t,n,r,i,o){var a=this;return(a=e.call(this,t,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,a.gr=!1,a}return Object(YS.c)(t,e),Object.defineProperty(t.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,e.prototype.start.call(this)},t.prototype.ar=function(){this.gr&&this.Er([])},t.prototype.wr=function(e){return this.Hi.Oi("Write",e)},t.prototype.onMessage=function(e){if(gN(!!e.streamToken),this.lastStreamToken=e.streamToken,this.gr){this.Zi.reset();var t=function(e,t){return e&&e.length>0?(gN(void 0!==t),e.map(function(e){return function(e,t){var n=iM(e.updateTime?e.updateTime:t);return n.isEqual(EN.min())&&(n=iM(t)),new sR(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=iM(e.commitTime);return this.listener.Tr(n,t)}return gN(!e.writeResults||0===e.writeResults.length),this.gr=!0,this.listener.Ir()},t.prototype.Ar=function(){var e={};e.database=hM(this.R),this.cr(e)},t.prototype.Er=function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return vM(t.R,e)})};this.cr(n)},t}(hB),pB=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).credentials=t,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(YS.c)(t,e),t.prototype.br=function(){if(this.Rr)throw new uN(sN.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.Ni=function(e,t,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.Ni(e,t,n,i)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===sN.UNAUTHENTICATED&&r.credentials.invalidateToken(),e):new uN(sN.UNKNOWN,e.toString())})},t.prototype.$i=function(e,t,n){var r=this;return this.br(),this.credentials.getToken().then(function(i){return r.Hi.$i(e,t,n,i)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===sN.UNAUTHENTICATED&&r.credentials.invalidateToken(),e):new uN(sN.UNKNOWN,e.toString())})},t.prototype.terminate=function(){this.Rr=!0},t}(function(){}),vB=function(){function e(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return e.prototype.Sr=function(){var e=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.Pr=null,e.Cr("Backend didn't respond within 10 seconds."),e.Dr("Offline"),Promise.resolve()}))},e.prototype.Nr=function(e){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+e.toString()),this.Dr("Offline")))},e.prototype.set=function(e){this.kr(),this.vr=0,"Online"===e&&(this.Vr=!1),this.Dr(e)},e.prototype.Dr=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},e.prototype.Cr=function(e){var t="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(fN(t),this.Vr=!1):hN("OnlineStateTracker",t)},e.prototype.kr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},e}(),gB=function(e,t,n,r,i){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(e){n.enqueueAndForget(function(){return Object(YS.b)(o,void 0,void 0,function(){return Object(YS.d)(this,function(e){switch(e.label){case 0:return OB(this)?(hN("RemoteStore","Restarting streams for network reachability change."),[4,function(e){return Object(YS.b)(this,void 0,void 0,function(){var t;return Object(YS.d)(this,function(n){switch(n.label){case 0:return(t=yN(e)).Or.add(4),[4,mB(t)];case 1:return n.sent(),t.Br.set("Unknown"),t.Or.delete(4),[4,yB(t)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})}),this.Br=new vB(n,r)};function yB(e){return Object(YS.b)(this,void 0,void 0,function(){var t,n;return Object(YS.d)(this,function(r){switch(r.label){case 0:if(!OB(e))return[3,4];t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function mB(e){return Object(YS.b)(this,void 0,void 0,function(){var t,n;return Object(YS.d)(this,function(r){switch(r.label){case 0:t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function bB(e,t){var n=yN(e);n.$r.has(t.targetId)||(n.$r.set(t.targetId,t),EB(n)?CB(n):UB(n).er()&&wB(n,t))}function _B(e,t){var n=yN(e),r=UB(n);n.$r.delete(t),r.er()&&kB(n,t),0===n.$r.size&&(r.er()?r.ir():OB(n)&&n.Br.set("Unknown"))}function wB(e,t){e.qr.U(t.targetId),UB(e).mr(t)}function kB(e,t){e.qr.U(t),UB(e).yr(t)}function CB(e){e.qr=new QR({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},lt:function(t){return e.$r.get(t)||null}}),UB(e).start(),e.Br.Sr()}function EB(e){return OB(e)&&!UB(e).tr()&&e.$r.size>0}function OB(e){return 0===yN(e).Or.size}function SB(e){e.qr=void 0}function PB(e){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(t){return e.$r.forEach(function(t,n){wB(e,t)}),[2]})})}function IB(e,t){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(n){return SB(e),EB(e)?(e.Br.Nr(t),CB(e)):e.Br.set("Unknown"),[2]})})}function TB(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var r,i,o;return Object(YS.d)(this,function(a){switch(a.label){case 0:if(e.Br.set("Online"),!(t instanceof $R&&2===t.state&&t.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i,o;return Object(YS.d)(this,function(a){switch(a.label){case 0:n=t.cause,r=0,i=t.targetIds,a.label=1;case 1:return r<i.length?e.$r.has(o=i[r])?[4,e.remoteSyncer.rejectListen(o,n)]:[3,3]:[3,5];case 2:a.sent(),e.$r.delete(o),e.qr.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(e,t)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),hN("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),[4,AB(e,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof qR?e.qr.X(t):t instanceof WR?e.qr.rt(t):e.qr.et(t),n.isEqual(EN.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,CL(e.localStore)];case 8:return i=a.sent(),n.compareTo(i)>=0?[4,function(e,t){var n=e.qr.ut(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.$r.get(r);i&&e.$r.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.$r.get(t);if(n){e.$r.set(t,n.withResumeToken(RN.EMPTY_BYTE_STRING,n.snapshotVersion)),kB(e,t);var r=new vD(n.target,t,1,n.sequenceNumber);wB(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return hN("RemoteStore","Failed to raise snapshot:",o=a.sent()),[4,AB(e,o)];case 12:return a.sent(),[3,13];case 13:return[2]}})})}function AB(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var r=this;return Object(YS.d)(this,function(i){switch(i.label){case 0:if(!aD(t))throw t;return e.Or.add(1),[4,mB(e)];case 1:return i.sent(),e.Br.set("Offline"),n||(n=function(){return CL(e.localStore)}),e.asyncQueue.enqueueRetryable(function(){return Object(YS.b)(r,void 0,void 0,function(){return Object(YS.d)(this,function(t){switch(t.label){case 0:return hN("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return t.sent(),e.Or.delete(1),[4,yB(e)];case 2:return t.sent(),[2]}})})}),[2]}})})}function NB(e,t){return t().catch(function(n){return AB(e,n,t)})}function xB(e){return Object(YS.b)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(YS.d)(this,function(a){switch(a.label){case 0:t=yN(e),n=VB(t),r=t.Fr.length>0?t.Fr[t.Fr.length-1].batchId:-1,a.label=1;case 1:if(!function(e){return OB(e)&&e.Fr.length<10}(t))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,SL(t.localStore,r)];case 3:return null===(i=a.sent())?(0===t.Fr.length&&n.ir(),[3,7]):(r=i.batchId,function(e,t){e.Fr.push(t);var n=VB(e);n.er()&&n.pr&&n.Er(t.mutations)}(t,i),[3,6]);case 4:return o=a.sent(),[4,AB(t,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return RB(t)&&MB(t),[2]}})})}function RB(e){return OB(e)&&!VB(e).tr()&&e.Fr.length>0}function MB(e){VB(e).start()}function DB(e){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(t){return VB(e).Ar(),[2]})})}function LB(e){return Object(YS.b)(this,void 0,void 0,function(){var t,n,r;return Object(YS.d)(this,function(i){for(t=VB(e),n=0,r=e.Fr;n<r.length;n++)t.Er(r[n].mutations);return[2]})})}function BB(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var r,i;return Object(YS.d)(this,function(o){switch(o.label){case 0:return r=e.Fr.shift(),i=pD.from(r,t,n),[4,NB(e,function(){return e.remoteSyncer.applySuccessfulWrite(i)})];case 1:return o.sent(),[4,xB(e)];case 2:return o.sent(),[2]}})})}function FB(e,t){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(n){switch(n.label){case 0:return t&&VB(e).pr?[4,function(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r;return Object(YS.d)(this,function(i){switch(i.label){case 0:return SR(r=t.code)&&r!==sN.ABORTED?(n=e.Fr.shift(),VB(e).sr(),[4,NB(e,function(){return e.remoteSyncer.rejectFailedWrite(n.batchId,t)})]):[3,3];case 1:return i.sent(),[4,xB(e)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(e,t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return RB(e)&&MB(e),[2]}})})}function jB(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n;return Object(YS.d)(this,function(r){switch(r.label){case 0:return n=yN(e),t?(n.Or.delete(2),[4,yB(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return t?[3,4]:(n.Or.add(2),[4,mB(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function UB(e){var t=this;return e.Ur||(e.Ur=function(e,t,n){var r=yN(e);return r.br(),new fB(t,r.Hi,r.credentials,r.R,n)}(e.datastore,e.asyncQueue,{Ii:PB.bind(null,e),Ri:IB.bind(null,e),_r:TB.bind(null,e)}),e.Mr.push(function(n){return Object(YS.b)(t,void 0,void 0,function(){return Object(YS.d)(this,function(t){switch(t.label){case 0:return n?(e.Ur.sr(),EB(e)?CB(e):e.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,e.Ur.stop()];case 2:t.sent(),SB(e),t.label=3;case 3:return[2]}})})})),e.Ur}function VB(e){var t=this;return e.Kr||(e.Kr=function(e,t,n){var r=yN(e);return r.br(),new dB(t,r.Hi,r.credentials,r.R,n)}(e.datastore,e.asyncQueue,{Ii:DB.bind(null,e),Ri:FB.bind(null,e),Ir:LB.bind(null,e),Tr:BB.bind(null,e)}),e.Mr.push(function(n){return Object(YS.b)(t,void 0,void 0,function(){return Object(YS.d)(this,function(t){switch(t.label){case 0:return n?(e.Kr.sr(),[4,xB(e)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,e.Kr.stop()];case 3:t.sent(),e.Fr.length>0&&(hN("RemoteStore","Stopping write stream with "+e.Fr.length+" pending writes"),e.Fr=[]),t.label=4;case 4:return[2]}})})})),e.Kr}var zB=function(){function e(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new eD,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return e.createAndSchedule=function(t,n,r,i,o){var a=new e(t,n,Date.now()+r,i,o);return a.start(r),a},e.prototype.start=function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)},e.prototype.skipDelay=function(){return this.handleDelayElapsed()},e.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new uN(sN.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},e.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})},e.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},e}();function HB(e,t){if(fN("AsyncQueue",t+": "+e),aD(e))return new uN(sN.UNAVAILABLE,t+": "+e);throw e}var GB=function(){function e(e){this.comparator=e?function(t,n){return e(t,n)||GN.comparator(t.key,n.key)}:function(e,t){return GN.comparator(e.key,t.key)},this.keyedMap=LR(),this.sortedSet=new IR(this.comparator)}return e.emptySet=function(t){return new e(t.comparator)},e.prototype.has=function(e){return null!=this.keyedMap.get(e)},e.prototype.get=function(e){return this.keyedMap.get(e)},e.prototype.first=function(){return this.sortedSet.minKey()},e.prototype.last=function(){return this.sortedSet.maxKey()},e.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},e.prototype.indexOf=function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})},e.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},e.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},e.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},e.prototype.copy=function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r},e}(),qB=function(){function e(){this.Qr=new IR(GN.comparator)}return e.prototype.track=function(e){var t=e.doc.key,n=this.Qr.get(t);n?0!==e.type&&3===n.type?this.Qr=this.Qr.insert(t,e):3===e.type&&1!==n.type?this.Qr=this.Qr.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Qr=this.Qr.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Qr=this.Qr.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Qr=this.Qr.remove(t):1===e.type&&2===n.type?this.Qr=this.Qr.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Qr=this.Qr.insert(t,{type:2,doc:e.doc}):vN():this.Qr=this.Qr.insert(t,e)},e.prototype.jr=function(){var e=[];return this.Qr.inorderTraversal(function(t,n){e.push(n)}),e},e}(),WB=function(){function e(e,t,n,r,i,o,a,s){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return e.fromInitialDocuments=function(t,n,r,i){var o=[];return n.forEach(function(e){o.push({type:0,doc:e})}),new e(t,n,GB.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&jx(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},e}(),$B=function(){this.Wr=void 0,this.listeners=[]},ZB=function(){this.queries=new tL(function(e){return Ux(e)},jx),this.onlineState="Unknown",this.Gr=new Set};function QB(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i,o,a,s,u;return Object(YS.d)(this,function(c){switch(c.label){case 0:if(n=yN(e),i=!1,(o=n.queries.get(r=t.query))||(i=!0,o=new $B),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),a=o,[4,n.onListen(r)];case 2:return a.Wr=c.sent(),[3,4];case 3:return s=c.sent(),u=HB(s,"Initialization of query '"+Vx(t.query)+"' failed"),[2,void t.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(t),t.zr(n.onlineState),o.Wr&&t.Hr(o.Wr)&&XB(n),[2]}})})}function YB(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i,o,a;return Object(YS.d)(this,function(s){return n=yN(e),i=!1,(o=n.queries.get(r=t.query))&&(a=o.listeners.indexOf(t))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function KB(e,t){for(var n=yN(e),r=!1,i=0,o=t;i<o.length;i++){var a=o[i],s=n.queries.get(a.query);if(s){for(var u=0,c=s.listeners;u<c.length;u++)c[u].Hr(a)&&(r=!0);s.Wr=a}}r&&XB(n)}function JB(e,t,n){var r=yN(e),i=r.queries.get(t);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.queries.delete(t)}function XB(e){e.Gr.forEach(function(e){e.next()})}var eF=function(){function e(e,t,n){this.query=e,this.Jr=t,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return e.prototype.Hr=function(e){if(!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&t.push(i)}e=new WB(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(e)&&(this.Jr.next(e),o=!0):this.eo(e,this.onlineState)&&(this.no(e),o=!0),this.Xr=e,o},e.prototype.onError=function(e){this.Jr.error(e)},e.prototype.zr=function(e){this.onlineState=e;var t=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,e)&&(this.no(this.Xr),t=!0),t},e.prototype.eo=function(e,t){return!e.fromCache||!(this.options.so&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)},e.prototype.Zr=function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Xr&&this.Xr.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges},e.prototype.no=function(e){e=WB.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Yr=!0,this.Jr.next(e)},e}(),tF=function(){function e(e,t){this.payload=e,this.byteLength=t}return e.prototype.io=function(){return"metadata"in this.payload},e}(),nF=function(){function e(e){this.R=e}return e.prototype.qn=function(e){return uM(this.R,e)},e.prototype.Un=function(e){return e.metadata.exists?pM(this.R,e.document,!1):sx.newNoDocument(this.qn(e.metadata.name),this.Kn(e.metadata.readTime))},e.prototype.Kn=function(e){return iM(e)},e}();!function(){function e(e,t,n){this.ro=e,this.localStore=t,this.R=n,this.queries=[],this.documents=[],this.progress=function(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(e)}e.prototype.oo=function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null},e.prototype.co=function(e){for(var t=new Map,n=new nF(this.R),r=0,i=e;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var a=n.qn(o.metadata.name),s=0,u=o.metadata.queries;s<u.length;s++){var c=u[s],l=(t.get(c)||UR()).add(a);t.set(c,l)}}return t},e.prototype.complete=function(){return Object(YS.b)(this,void 0,void 0,function(){var e,t,n,r,i;return Object(YS.d)(this,function(o){switch(o.label){case 0:return[4,RL(this.localStore,new nF(this.R),this.documents,this.ro.id)];case 1:e=o.sent(),t=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?[4,ML(this.localStore,i=r[n],t.get(i.name))]:[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new vL(Object.assign({},this.progress),e))]}})})}}();var rF=function(e){this.key=e},iF=function(e){this.key=e},oF=function(){function e(e,t){this.query=e,this.uo=t,this.ao=null,this.current=!1,this.ho=UR(),this.mutatedKeys=UR(),this.lo=Hx(e),this.fo=new GB(this.lo)}return Object.defineProperty(e.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),e.prototype._o=function(e,t){var n=this,r=t?t.mo:new qB,i=t?t.fo:this.fo,o=t?t.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=Nx(this.query)&&i.size===this.query.limit?i.last():null,c=xx(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),h=zx(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.yo(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(h?(a=a.add(h),o=d?o.add(e):o.delete(e)):(a=a.delete(e),o=o.delete(e)))}),Nx(this.query)||xx(this.query))for(;a.size>this.query.limit;){var l=Nx(this.query)?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:a,mo:r,Nn:s,mutatedKeys:o}},e.prototype.yo=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},e.prototype.applyChanges=function(e,t,n){var r=this,i=this.fo;this.fo=e.fo,this.mutatedKeys=e.mutatedKeys;var o=e.mo.jr();o.sort(function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return vN()}};return n(e)-n(t)}(e.type,t.type)||r.lo(e.doc,t.doc)}),this.po(n);var a=t?this.Eo():[],s=0===this.ho.size&&this.current?1:0,u=s!==this.ao;return this.ao=s,0!==o.length||u?{snapshot:new WB(this.query,e.fo,i,o,e.mutatedKeys,0===s,u,!1),To:a}:{To:a}},e.prototype.zr=function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({fo:this.fo,mo:new qB,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},e.prototype.Io=function(e){return!this.uo.has(e)&&!!this.fo.has(e)&&!this.fo.get(e).hasLocalMutations},e.prototype.po=function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.uo=t.uo.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.uo=t.uo.delete(e)}),this.current=e.current)},e.prototype.Eo=function(){var e=this;if(!this.current)return[];var t=this.ho;this.ho=UR(),this.fo.forEach(function(t){e.Io(t.key)&&(e.ho=e.ho.add(t.key))});var n=[];return t.forEach(function(t){e.ho.has(t)||n.push(new iF(t))}),this.ho.forEach(function(e){t.has(e)||n.push(new rF(e))}),n},e.prototype.Ao=function(e){this.uo=e.Bn,this.ho=UR();var t=this._o(e.documents);return this.applyChanges(t,!0)},e.prototype.Ro=function(){return WB.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},e}(),aF=function(e,t,n){this.query=e,this.targetId=t,this.view=n},sF=function(e){this.key=e,this.bo=!1},uF=function(){function e(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new tL(function(e){return Ux(e)},jx),this.Vo=new Map,this.So=new Set,this.Do=new IR(GN.comparator),this.Co=new Map,this.No=new LL,this.xo={},this.ko=new Map,this.Fo=HD.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(e.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),e}();function cF(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i,o,a;return Object(YS.d)(this,function(s){switch(s.label){case 0:return n=FF(e),(i=n.Po.get(t))?(n.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Ro(),[3,4]):[3,1];case 1:return[4,PL(n.localStore,Bx(t))];case 2:return o=s.sent(),a=n.sharedClientState.addLocalQueryTarget(o.targetId),[4,lF(n,t,o.targetId,"current"===a)];case 3:r=s.sent(),n.isPrimaryClient&&bB(n.remoteStore,o),s.label=4;case 4:return[2,r]}})})}function lF(e,t,n,r){return Object(YS.b)(this,void 0,void 0,function(){var i,o,a,s,u,c;return Object(YS.d)(this,function(l){switch(l.label){case 0:return e.Oo=function(t,n,r){return function(e,t,n,r){return Object(YS.b)(this,void 0,void 0,function(){var i,o,a;return Object(YS.d)(this,function(s){switch(s.label){case 0:return(i=t.view._o(n)).Nn?[4,TL(e.localStore,t.query,!1).then(function(e){return t.view._o(e.documents,i)})]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.targetChanges.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,o),[2,(CF(e,t.targetId,a.To),a.snapshot)]}})})}(e,t,n,r)},[4,TL(e.localStore,t,!0)];case 1:return i=l.sent(),o=new oF(t,i.Bn),a=o._o(i.documents),s=GR.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),u=o.applyChanges(a,e.isPrimaryClient,s),CF(e,n,u.To),c=new aF(t,n,o),[2,(e.Po.set(t,c),e.Vo.has(n)?e.Vo.get(n).push(t):e.Vo.set(n,[t]),u.snapshot)]}})})}function hF(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i;return Object(YS.d)(this,function(o){switch(o.label){case 0:return n=yN(e),r=n.Po.get(t),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter(function(e){return!jx(e,t)})),void n.Po.delete(t))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,IL(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),_B(n.remoteStore,r.targetId),wF(n,r.targetId)}).catch(ZD)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return wF(n,r.targetId),[4,IL(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function fF(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var r,i,o,a;return Object(YS.d)(this,function(s){switch(s.label){case 0:r=jF(e),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(e,t){var n,r=yN(e),i=CN.now(),o=t.reduce(function(e,t){return e.add(t.key)},UR());return r.persistence.runTransaction("Locally write mutations","readwrite",function(e){return r.Mn.pn(e,o).next(function(o){n=o;for(var a=[],s=0,u=t;s<u.length;s++){var c=u[s],l=dR(c,n.get(c.key));null!=l&&a.push(new yR(c.key,l,ax(l.value.mapValue),uR.exists(!0)))}return r._n.addMutationBatch(e,i,a,t)})}).then(function(e){return e.applyToLocalDocumentSet(n),{batchId:e.batchId,changes:n}})}(r.localStore,t)];case 2:return i=s.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(e,t,n){var r=e.xo[e.currentUser.toKey()];r||(r=new IR(_N)),r=r.insert(t,n),e.xo[e.currentUser.toKey()]=r}(r,i.batchId,n),[4,SF(r,i.changes)];case 3:return s.sent(),[4,xB(r.remoteStore)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=HB(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}})})}function dF(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r;return Object(YS.d)(this,function(i){switch(i.label){case 0:n=yN(e),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,EL(n.localStore,t)];case 2:return r=i.sent(),t.targetChanges.forEach(function(e,t){var r=n.Co.get(t);r&&(gN(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.bo=!0:e.modifiedDocuments.size>0?gN(r.bo):e.removedDocuments.size>0&&(gN(r.bo),r.bo=!1))}),[4,SF(n,r,t)];case 3:return i.sent(),[3,6];case 4:return[4,ZD(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function pF(e,t,n){var r=yN(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach(function(e,n){var r=n.view.zr(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=yN(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(t)&&(r=!0)}),r&&XB(n)}(r.eventManager,t),i.length&&r.vo._r(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function vF(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var r,i,o,a,s,u;return Object(YS.d)(this,function(c){switch(c.label){case 0:return(r=yN(e)).sharedClientState.updateQueryState(t,"rejected",n),i=r.Co.get(t),(o=i&&i.key)?(a=(a=new IR(GN.comparator)).insert(o,sx.newNoDocument(o,EN.min())),s=UR().add(o),u=new HR(EN.min(),new Map,new NR(_N),a,s),[4,dF(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(t),OF(r),[3,4];case 2:return[4,IL(r.localStore,t,!1).then(function(){return wF(r,t,n)}).catch(ZD)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function gF(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i;return Object(YS.d)(this,function(o){switch(o.label){case 0:n=yN(e),r=t.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,kL(n.localStore,t)];case 2:return i=o.sent(),_F(n,r,null),bF(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,SF(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,ZD(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function yF(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var r,i;return Object(YS.d)(this,function(o){switch(o.label){case 0:r=yN(e),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(e,t){var n=yN(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n._n.lookupMutationBatch(e,t).next(function(t){return gN(null!==t),r=t.keys(),n._n.removeMutationBatch(e,t)}).next(function(){return n._n.performConsistencyCheck(e)}).next(function(){return n.Mn.pn(e,r)})})}(r.localStore,t)];case 2:return i=o.sent(),_F(r,t,n),bF(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),[4,SF(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,ZD(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function mF(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i,o,a;return Object(YS.d)(this,function(s){switch(s.label){case 0:OB((n=yN(e)).remoteStore)||hN("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(e){var t=yN(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(e){return t._n.getHighestUnacknowledgedBatchId(e)})}(n.localStore)];case 2:return-1===(r=s.sent())?[2,void t.resolve()]:((i=n.ko.get(r)||[]).push(t),n.ko.set(r,i),[3,4]);case 3:return o=s.sent(),a=HB(o,"Initialization of waitForPendingWrites() operation failed"),t.reject(a),[3,4];case 4:return[2]}})})}function bF(e,t){(e.ko.get(t)||[]).forEach(function(e){e.resolve()}),e.ko.delete(t)}function _F(e,t,n){var r=yN(e),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(t);o&&(n?o.reject(n):o.resolve(),i=i.remove(t)),r.xo[r.currentUser.toKey()]=i}}function wF(e,t,n){void 0===n&&(n=null),e.sharedClientState.removeLocalQueryTarget(t);for(var r=0,i=e.Vo.get(t);r<i.length;r++){var o=i[r];e.Po.delete(o),n&&e.vo.Mo(o,n)}e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach(function(t){e.No.containsKey(t)||kF(e,t)})}function kF(e,t){e.So.delete(t.path.canonicalString());var n=e.Do.get(t);null!==n&&(_B(e.remoteStore,n),e.Do=e.Do.remove(t),e.Co.delete(n),OF(e))}function CF(e,t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof rF?(e.No.addReference(o.key,t),EF(e,o)):o instanceof iF?(hN("SyncEngine","Document no longer in limbo: "+o.key),e.No.removeReference(o.key,t),e.No.containsKey(o.key)||kF(e,o.key)):vN()}}function EF(e,t){var n=t.key,r=n.path.canonicalString();e.Do.get(n)||e.So.has(r)||(hN("SyncEngine","New document in limbo: "+n),e.So.add(r),OF(e))}function OF(e){for(;e.So.size>0&&e.Do.size<e.maxConcurrentLimboResolutions;){var t=e.So.values().next().value;e.So.delete(t);var n=new GN(TN.fromString(t)),r=e.Fo.next();e.Co.set(r,new sF(n)),e.Do=e.Do.insert(n,r),bB(e.remoteStore,new vD(Bx(Ax(n.path)),r,2,aN.o))}}function SF(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var r,i,o,a;return Object(YS.d)(this,function(s){switch(s.label){case 0:return r=yN(e),i=[],o=[],a=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(e,s){a.push(r.Oo(s,t,n).then(function(e){if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(s.targetId,e.fromCache?"not-current":"current"),i.push(e);var t=yL.Pn(s.targetId,e);o.push(t)}}))}),[4,Promise.all(a)]);case 1:return s.sent(),r.vo._r(i),[4,function(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c;return Object(YS.d)(this,function(l){switch(l.label){case 0:n=yN(e),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return tD.forEach(t,function(t){return tD.forEach(t.bn,function(r){return n.persistence.referenceDelegate.addReference(e,t.targetId,r)}).next(function(){return tD.forEach(t.vn,function(r){return n.persistence.referenceDelegate.removeReference(e,t.targetId,r)})})})})];case 2:return l.sent(),[3,4];case 3:if(!aD(r=l.sent()))throw r;return hN("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=t;i<o.length;i++)s=(a=o[i]).targetId,a.fromCache||(u=n.kn.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),n.kn=n.kn.insert(s,c));return[2]}})})}(r.localStore,o)];case 2:s.sent(),s.label=3;case 3:return[2]}})})}function PF(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r;return Object(YS.d)(this,function(i){switch(i.label){case 0:return(n=yN(e)).currentUser.isEqual(t)?[3,3]:(hN("SyncEngine","User change. New user:",t.toKey()),[4,wL(n.localStore,t)]);case 1:return r=i.sent(),n.currentUser=t,function(e,t){e.ko.forEach(function(e){e.forEach(function(e){e.reject(new uN(sN.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.ko.clear()}(n),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),[4,SF(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function IF(e,t){var n=yN(e),r=n.Co.get(t);if(r&&r.bo)return UR().add(r.key);var i=UR(),o=n.Vo.get(t);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=n.Po.get(s[a]);i=i.unionWith(u.view.wo)}return i}function TF(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i;return Object(YS.d)(this,function(o){switch(o.label){case 0:return[4,TL((n=yN(e)).localStore,t.query,!0)];case 1:return r=o.sent(),i=t.view.Ao(r),[2,(n.isPrimaryClient&&CF(n,t.targetId,i.To),i)]}})})}function AF(e){return Object(YS.b)(this,void 0,void 0,function(){var t;return Object(YS.d)(this,function(n){return[2,NL((t=yN(e)).localStore).then(function(e){return SF(t,e)})]})})}function NF(e,t,n,r){return Object(YS.b)(this,void 0,void 0,function(){var i,o;return Object(YS.d)(this,function(a){switch(a.label){case 0:return[4,function(e,t){var n=yN(e),r=yN(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return r.jt(e,t).next(function(t){return t?n.Mn.pn(e,t):tD.resolve(null)})})}((i=yN(e)).localStore,t)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,xB(i.remoteStore)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(_F(i,t,r||null),bF(i,t),function(e,t){yN(yN(e)._n).Gt(t)}(i.localStore,t)):vN(),a.label=4;case 4:return[4,SF(i,o)];case 5:return a.sent(),[3,7];case 6:hN("SyncEngine","Cannot apply mutation batch with id: "+t),a.label=7;case 7:return[2]}})})}function xF(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i,o,a,s,u;return Object(YS.d)(this,function(c){switch(c.label){case 0:return FF(n=yN(e)),jF(n),!0!==t||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,RF(n,r.toArray())]);case 1:return i=c.sent(),n.$o=!0,[4,jB(n.remoteStore,!0)];case 2:for(c.sent(),o=0,a=i;o<a.length;o++)bB(n.remoteStore,a[o]);return[3,7];case 3:return!1!==t||!1===n.$o?[3,7]:(s=[],u=Promise.resolve(),n.Vo.forEach(function(e,t){n.sharedClientState.isLocalQueryTarget(t)?s.push(t):u=u.then(function(){return wF(n,t),IL(n.localStore,t,!0)}),_B(n.remoteStore,t)}),[4,u]);case 4:return c.sent(),[4,RF(n,s)];case 5:return c.sent(),function(e){var t=yN(e);t.Co.forEach(function(e,n){_B(t.remoteStore,n)}),t.No.ts(),t.Co=new Map,t.Do=new IR(GN.comparator)}(n),n.$o=!1,[4,jB(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})}function RF(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,l,h,f,d,p;return Object(YS.d)(this,function(v){switch(v.label){case 0:n=yN(e),r=[],i=[],o=0,a=t,v.label=1;case 1:return o<a.length?(u=void 0,(c=n.Vo.get(s=a[o]))&&0!==c.length?[4,PL(n.localStore,Bx(c[0]))]:[3,7]):[3,13];case 2:u=v.sent(),l=0,h=c,v.label=3;case 3:return l<h.length?(f=n.Po.get(h[l]),[4,TF(n,f)]):[3,6];case 4:(d=v.sent()).snapshot&&i.push(d.snapshot),v.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,AL(n.localStore,s)];case 8:return p=v.sent(),[4,PL(n.localStore,p)];case 9:return u=v.sent(),[4,lF(n,MF(p),s,!1)];case 10:v.sent(),v.label=11;case 11:r.push(u),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}})})}function MF(e){return Tx(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function DF(e){var t=yN(e);return yN(yN(t.localStore).persistence).fn()}function LF(e,t,n,r){return Object(YS.b)(this,void 0,void 0,function(){var i,o,a;return Object(YS.d)(this,function(s){switch(s.label){case 0:return(i=yN(e)).$o?(hN("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(t))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,NL(i.localStore)];case 3:return o=s.sent(),a=HR.createSynthesizedRemoteEventForCurrentChange(t,"current"===n),[4,SF(i,o,a)];case 4:return s.sent(),[3,8];case 5:return[4,IL(i.localStore,t,!0)];case 6:return s.sent(),wF(i,t,r),[3,8];case 7:vN(),s.label=8;case 8:return[2]}})})}function BF(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var r,i,o,a,s,u,c,l,h;return Object(YS.d)(this,function(f){switch(f.label){case 0:if(!(r=FF(e)).$o)return[3,10];i=0,o=t,f.label=1;case 1:return i<o.length?r.Vo.has(a=o[i])?(hN("SyncEngine","Adding an already active target "+a),[3,5]):[4,AL(r.localStore,a)]:[3,6];case 2:return s=f.sent(),[4,PL(r.localStore,s)];case 3:return u=f.sent(),[4,lF(r,MF(s),u.targetId,!1)];case 4:f.sent(),bB(r.remoteStore,u),f.label=5;case 5:return i++,[3,1];case 6:c=function(e){return Object(YS.d)(this,function(t){switch(t.label){case 0:return r.Vo.has(e)?[4,IL(r.localStore,e,!1).then(function(){_B(r.remoteStore,e),wF(r,e)}).catch(ZD)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},l=0,h=n,f.label=7;case 7:return l<h.length?[5,c(h[l])]:[3,10];case 8:f.sent(),f.label=9;case 9:return l++,[3,7];case 10:return[2]}})})}function FF(e){var t=yN(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=dF.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=IF.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=vF.bind(null,t),t.vo._r=KB.bind(null,t.eventManager),t.vo.Mo=JB.bind(null,t.eventManager),t}function jF(e){var t=yN(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=gF.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=yF.bind(null,t),t}var UF=function(){function e(){this.synchronizeTabs=!1}return e.prototype.initialize=function(e){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(t){switch(t.label){case 0:return this.R=cB(e.databaseInfo.databaseId),this.sharedClientState=this.Bo(e),this.persistence=this.qo(e),[4,this.persistence.start()];case 1:return t.sent(),this.gcScheduler=this.Uo(e),this.localStore=this.Ko(e),[2]}})})},e.prototype.Uo=function(e){return null},e.prototype.Ko=function(e){return _L(this.persistence,new mL,e.initialUser,this.R)},e.prototype.qo=function(e){return new zL(GL.bs,this.R)},e.prototype.Bo=function(e){return new tB},e.prototype.terminate=function(){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(e){switch(e.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return e.sent(),[4,this.persistence.shutdown()];case 2:return e.sent(),[2]}})})},e}(),VF=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).Qo=t,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(YS.c)(t,e),t.prototype.initialize=function(t){return Object(YS.b)(this,void 0,void 0,function(){var n=this;return Object(YS.d)(this,function(r){switch(r.label){case 0:return[4,e.prototype.initialize.call(this,t)];case 1:return r.sent(),[4,xL(this.localStore)];case 2:return r.sent(),[4,this.Qo.initialize(this,t)];case 3:return r.sent(),[4,jF(this.Qo.syncEngine)];case 4:return r.sent(),[4,xB(this.Qo.remoteStore)];case 5:return r.sent(),[4,this.persistence.He(function(){return n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(n.localStore),Promise.resolve()})];case 6:return r.sent(),[2]}})})},t.prototype.Ko=function(e){return _L(this.persistence,new mL,e.initialUser,this.R)},t.prototype.Uo=function(e){return new KD(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue)},t.prototype.qo=function(e){var t=pL(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?DD.withCacheSize(this.cacheSizeBytes):DD.DEFAULT;return new hL(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,sB(),uB(),this.R,this.sharedClientState,!!this.forceOwnership)},t.prototype.Bo=function(e){return new tB},t}(UF),zF=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n,!1)||this).Qo=t,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(YS.c)(t,e),t.prototype.initialize=function(t){return Object(YS.b)(this,void 0,void 0,function(){var n,r=this;return Object(YS.d)(this,function(i){switch(i.label){case 0:return[4,e.prototype.initialize.call(this,t)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof eB?(this.sharedClientState.syncEngine={ui:NF.bind(null,n),ai:LF.bind(null,n),hi:BF.bind(null,n),fn:DF.bind(null,n),ci:AF.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He(function(e){return Object(YS.b)(r,void 0,void 0,function(){return Object(YS.d)(this,function(t){switch(t.label){case 0:return[4,xF(this.Qo.syncEngine,e)];case 1:return t.sent(),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},t.prototype.Bo=function(e){var t=sB();if(!eB.yt(t))throw new uN(sN.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=pL(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new eB(t,e.asyncQueue,n,e.clientId,e.initialUser)},t}(VF),HF=function(){function e(){}return e.prototype.initialize=function(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n=this;return Object(YS.d)(this,function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return pF(n.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=PF.bind(null,this.syncEngine),[4,jB(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},e.prototype.createEventManager=function(e){return new ZB},e.prototype.createDatastore=function(e){var t=cB(e.databaseInfo.databaseId),n=new aB(e.databaseInfo);return function(e,t,n){return new pB(e,t,n)}(e.credentials,n,t)},e.prototype.createRemoteStore=function(e){var t,n,r,i,o,a=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return pF(a.syncEngine,e,0)},o=rB.yt()?new rB:new nB,new gB(t,n,r,i,o)},e.prototype.createSyncEngine=function(e,t){return function(e,t,n,r,i,o,a){var s=new uF(e,t,n,r,i,o);return a&&(s.$o=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)},e.prototype.terminate=function(){return function(e){return Object(YS.b)(this,void 0,void 0,function(){var t;return Object(YS.d)(this,function(n){switch(n.label){case 0:return t=yN(e),hN("RemoteStore","RemoteStore shutting down."),t.Or.add(5),[4,mB(t)];case 1:return n.sent(),t.Lr.shutdown(),t.Br.set("Unknown"),[2]}})})}(this.remoteStore)},e}(),GF=function(){function e(e){this.observer=e,this.muted=!1}return e.prototype.next=function(e){this.observer.next&&this.jo(this.observer.next,e)},e.prototype.error=function(e){this.observer.error?this.jo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)},e.prototype.Wo=function(){this.muted=!0},e.prototype.jo=function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)},e}(),qF=(function(){function e(e,t){var n=this;this.Go=e,this.R=t,this.metadata=new eD,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(e){e&&e.io()?n.metadata.resolve(e.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==e?void 0:e.payload)))},function(e){return n.metadata.reject(e)})}e.prototype.close=function(){return this.Go.cancel()},e.prototype.getMetadata=function(){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(e){return[2,this.metadata.promise]})})},e.prototype.Lo=function(){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(e){switch(e.label){case 0:return[4,this.getMetadata()];case 1:return[2,(e.sent(),this.Ho())]}})})},e.prototype.Ho=function(){return Object(YS.b)(this,void 0,void 0,function(){var e,t,n,r;return Object(YS.d)(this,function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(e=i.sent())?[2,null]:(t=this.zo.decode(e),n=Number(t),isNaN(n)&&this.Yo("length string ("+t+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new tF(JSON.parse(r),e.length+n)]}})})},e.prototype.Zo=function(){return this.buffer.findIndex(function(e){return e==="{".charCodeAt(0)})},e.prototype.Jo=function(){return Object(YS.b)(this,void 0,void 0,function(){var e,t;return Object(YS.d)(this,function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),t=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),t)])}})})},e.prototype.Xo=function(e){return Object(YS.b)(this,void 0,void 0,function(){var t;return Object(YS.d)(this,function(n){switch(n.label){case 0:return this.buffer.length<e?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return t=this.zo.decode(this.buffer.slice(0,e)),[2,(this.buffer=this.buffer.slice(e),t)]}})})},e.prototype.Yo=function(e){throw this.Go.cancel(),new Error("Invalid bundle format: "+e)},e.prototype.tc=function(){return Object(YS.b)(this,void 0,void 0,function(){var e,t;return Object(YS.d)(this,function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(e=n.sent()).done||((t=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t),[2,e.done]}})})}}(),function(){function e(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e.prototype.lookup=function(e){return Object(YS.b)(this,void 0,void 0,function(){var t,n=this;return Object(YS.d)(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new uN(sN.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i,o,a,s;return Object(YS.d)(this,function(u){switch(u.label){case 0:return n=yN(e),r=hM(n.R)+"/documents",i={documents:t.map(function(e){return sM(n.R,e)})},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),a=new Map,o.forEach(function(e){var t=function(e,t){return"found"in t?function(e,t){gN(!!t.found);var n=uM(e,t.found.name),r=iM(t.found.updateTime),i=new ox({mapValue:{fields:t.found.fields}});return sx.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){gN(!!t.missing),gN(!!t.readTime);var n=uM(e,t.missing),r=iM(t.readTime);return sx.newNoDocument(n,r)}(e,t):vN()}(n.R,e);a.set(t.key.toString(),t)}),s=[],[2,(t.forEach(function(e){var t=a.get(e.toString());gN(!!t),s.push(t)}),s)]}})})}(this.datastore,e)];case 1:return[2,((t=r.sent()).forEach(function(e){return n.recordVersion(e)}),t)]}})})},e.prototype.set=function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())},e.prototype.update=function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())},e.prototype.delete=function(e){this.write(new CR(e,this.precondition(e))),this.writtenDocs.add(e.toString())},e.prototype.commit=function(){return Object(YS.b)(this,void 0,void 0,function(){var e,t=this;return Object(YS.d)(this,function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return e=this.readVersions,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(e,n){var r=GN.fromPath(n);t.mutations.push(new ER(r,t.precondition(r)))}),[4,function(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i;return Object(YS.d)(this,function(o){switch(o.label){case 0:return n=yN(e),r=hM(n.R)+"/documents",i={writes:t.map(function(e){return vM(n.R,e)})},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}})})},e.prototype.recordVersion=function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw vN();t=EN.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new uN(sN.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)},e.prototype.precondition=function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?uR.updateTime(t):uR.none()},e.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(EN.min()))throw new uN(sN.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return uR.updateTime(t)}return uR.exists(!0)},e.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations.push(e)},e.prototype.ensureCommitNotCalled=function(){},e}()),WF=function(){function e(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new lB(this.asyncQueue,"transaction_retry")}return e.prototype.run=function(){this.ec-=1,this.nc()},e.prototype.nc=function(){var e=this;this.Zi.ji(function(){return Object(YS.b)(e,void 0,void 0,function(){var e,t,n=this;return Object(YS.d)(this,function(r){return e=new qF(this.datastore),(t=this.sc(e))&&t.then(function(t){n.asyncQueue.enqueueAndForget(function(){return e.commit().then(function(){n.deferred.resolve(t)}).catch(function(e){n.ic(e)})})}).catch(function(e){n.ic(e)}),[2]})})})},e.prototype.sc=function(e){try{var t=this.updateFunction(e);return!VN(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}},e.prototype.ic=function(e){var t=this;this.ec>0&&this.rc(e)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return t.nc(),Promise.resolve()})):this.deferred.reject(e)},e.prototype.rc=function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!SR(t)}return!1},e}(),$F=function(){function e(e,t,n){var r=this;this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=qL.UNAUTHENTICATED,this.clientId=bN.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(t,function(e){return Object(YS.b)(r,void 0,void 0,function(){return Object(YS.d)(this,function(t){switch(t.label){case 0:return hN("FirestoreClient","Received user=",e.uid),[4,this.credentialListener(e)];case 1:return t.sent(),this.user=e,[2]}})})})}return e.prototype.getConfiguration=function(){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(e){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},e.prototype.setCredentialChangeListener=function(e){this.credentialListener=e},e.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new uN(sN.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.terminate=function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new eD;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return Object(YS.b)(e,void 0,void 0,function(){var e,n;return Object(YS.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),t.resolve(),[3,6];case 5:return e=r.sent(),n=HB(e,"Failed to shutdown persistence"),t.reject(n),[3,6];case 6:return[2]}})})}),t.promise},e}();function ZF(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r,i=this;return Object(YS.d)(this,function(o){switch(o.label){case 0:return e.asyncQueue.verifyOperationInProgress(),hN("FirestoreClient","Initializing OfflineComponentProvider"),[4,e.getConfiguration()];case 1:return n=o.sent(),[4,t.initialize(n)];case 2:return o.sent(),r=n.initialUser,e.setCredentialChangeListener(function(e){return Object(YS.b)(i,void 0,void 0,function(){return Object(YS.d)(this,function(n){switch(n.label){case 0:return r.isEqual(e)?[3,2]:[4,wL(t.localStore,e)];case 1:n.sent(),r=e,n.label=2;case 2:return[2]}})})}),t.persistence.setDatabaseDeletedListener(function(){return e.terminate()}),e.offlineComponents=t,[2]}})})}function QF(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r;return Object(YS.d)(this,function(i){switch(i.label){case 0:return e.asyncQueue.verifyOperationInProgress(),[4,YF(e)];case 1:return n=i.sent(),hN("FirestoreClient","Initializing OnlineComponentProvider"),[4,e.getConfiguration()];case 2:return r=i.sent(),[4,t.initialize(n,r)];case 3:return i.sent(),e.setCredentialChangeListener(function(e){return function(e,t){return Object(YS.b)(this,void 0,void 0,function(){var n,r;return Object(YS.d)(this,function(i){switch(i.label){case 0:return(n=yN(e)).asyncQueue.verifyOperationInProgress(),hN("RemoteStore","RemoteStore received new credentials"),r=OB(n),n.Or.add(3),[4,mB(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(t)];case 2:return i.sent(),n.Or.delete(3),[4,yB(n)];case 3:return i.sent(),[2]}})})}(t.remoteStore,e)}),e.onlineComponents=t,[2]}})})}function YF(e){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(t){switch(t.label){case 0:return e.offlineComponents?[3,2]:(hN("FirestoreClient","Using default OfflineComponentProvider"),[4,ZF(e,new UF)]);case 1:t.sent(),t.label=2;case 2:return[2,e.offlineComponents]}})})}function KF(e){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(t){switch(t.label){case 0:return e.onlineComponents?[3,2]:(hN("FirestoreClient","Using default OnlineComponentProvider"),[4,QF(e,new HF)]);case 1:t.sent(),t.label=2;case 2:return[2,e.onlineComponents]}})})}function JF(e){return YF(e).then(function(e){return e.persistence})}function XF(e){return YF(e).then(function(e){return e.localStore})}function ej(e){return KF(e).then(function(e){return e.remoteStore})}function tj(e){return KF(e).then(function(e){return e.syncEngine})}function nj(e){return Object(YS.b)(this,void 0,void 0,function(){var t,n;return Object(YS.d)(this,function(r){switch(r.label){case 0:return[4,KF(e)];case 1:return t=r.sent(),[2,((n=t.eventManager).onListen=cF.bind(null,t.syncEngine),n.onUnlisten=hF.bind(null,t.syncEngine),n)]}})})}function rj(e,t,n){var r=this;void 0===n&&(n={});var i=new eD;return e.asyncQueue.enqueueAndForget(function(){return Object(YS.b)(r,void 0,void 0,function(){var r;return Object(YS.d)(this,function(o){switch(o.label){case 0:return r=function(e,t,n,r,i){var o=new GF({next:function(o){t.enqueueAndForget(function(){return YB(e,a)});var s=o.docs.has(n);!s&&o.fromCache?i.reject(new uN(sN.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new uN(sN.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(e){return i.reject(e)}}),a=new eF(Ax(n.path),o,{includeMetadataChanges:!0,so:!0});return QB(e,a)},[4,nj(e)];case 1:return[2,r.apply(void 0,[o.sent(),e.asyncQueue,t,n,i])]}})})}),i.promise}function ij(e,t,n){var r=this;void 0===n&&(n={});var i=new eD;return e.asyncQueue.enqueueAndForget(function(){return Object(YS.b)(r,void 0,void 0,function(){var r;return Object(YS.d)(this,function(o){switch(o.label){case 0:return r=function(e,t,n,r,i){var o=new GF({next:function(n){t.enqueueAndForget(function(){return YB(e,a)}),n.fromCache&&"server"===r.source?i.reject(new uN(sN.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),a=new eF(n,o,{includeMetadataChanges:!0,so:!0});return QB(e,a)},[4,nj(e)];case 1:return[2,r.apply(void 0,[o.sent(),e.asyncQueue,t,n,i])]}})})}),i.promise}var oj=function(e,t,n,r,i,o,a,s){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=s},aj=function(){function e(e,t){this.projectId=e,this.database=t||"(default)"}return Object.defineProperty(e.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e}(),sj=new Map,uj=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e},cj=function(){function e(){this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e,t){this.changeListener=t,e.enqueueRetryable(function(){return t(qL.UNAUTHENTICATED)})},e.prototype.removeChangeListener=function(){this.changeListener=null},e}(),lj=function(){function e(e){this.token=e,this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(this.token)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable(function(){return t(n.token.user)})},e.prototype.removeChangeListener=function(){this.changeListener=null},e}(),hj=function(){function e(e){var t=this;this.currentUser=qL.UNAUTHENTICATED,this.oc=new eD,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){t.cc++,t.currentUser=t.ac(),t.oc.resolve(),t.changeListener&&t.asyncQueue.enqueueRetryable(function(){return t.changeListener(t.currentUser)})};var n=function(e){hN("FirebaseCredentialsProvider","Auth detected"),t.auth=e,t.auth.addAuthTokenListener(t.uc)};e.onInit(function(e){return n(e)}),setTimeout(function(){if(!t.auth){var r=e.getImmediate({optional:!0});r?n(r):(hN("FirebaseCredentialsProvider","Auth not yet detected"),t.oc.resolve())}},0)}return e.prototype.getToken=function(){var e=this,t=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.cc!==t?(hN("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(gN("string"==typeof n.accessToken),new uj(n.accessToken,e.currentUser)):null}):Promise.resolve(null)},e.prototype.invalidateToken=function(){this.forceRefresh=!0},e.prototype.setChangeListener=function(e,t){var n=this;this.asyncQueue=e,this.asyncQueue.enqueueRetryable(function(){return Object(YS.b)(n,void 0,void 0,function(){return Object(YS.d)(this,function(e){switch(e.label){case 0:return[4,this.oc.promise];case 1:return e.sent(),[4,t(this.currentUser)];case 2:return e.sent(),this.changeListener=t,[2]}})})})},e.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},e.prototype.ac=function(){var e=this.auth&&this.auth.getUid();return gN(null===e||"string"==typeof e),new qL(e)},e}(),fj=function(){function e(e,t,n){this.hc=e,this.lc=t,this.fc=n,this.type="FirstParty",this.user=qL.FIRST_PARTY}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.lc},t=this.hc.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.fc&&(e["X-Goog-Iam-Authorization-Token"]=this.fc),e},enumerable:!1,configurable:!0}),e}(),dj=function(){function e(e,t,n){this.hc=e,this.lc=t,this.fc=n}return e.prototype.getToken=function(){return Promise.resolve(new fj(this.hc,this.lc,this.fc))},e.prototype.setChangeListener=function(e,t){e.enqueueRetryable(function(){return t(qL.FIRST_PARTY)})},e.prototype.removeChangeListener=function(){},e.prototype.invalidateToken=function(){},e}();function pj(e,t,n){if(!n)throw new uN(sN.INVALID_ARGUMENT,"Function "+e+"() cannot be called with an empty "+t+".")}function vj(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new uN(sN.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function gj(e,t,n,r){if(!0===t&&!0===r)throw new uN(sN.INVALID_ARGUMENT,e+" and "+n+" cannot be used together.")}function yj(e){if(!GN.isDocumentKey(e))throw new uN(sN.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e+" has "+e.length+".")}function mj(e){if(GN.isDocumentKey(e))throw new uN(sN.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e+" has "+e.length+".")}function bj(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?"a custom "+t+" object":"an object"}return"function"==typeof e?"a function":vN()}function _j(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new uN(sN.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=bj(e);throw new uN(sN.INVALID_ARGUMENT,"Expected type '"+t.name+"', but it was: "+n)}return e}function wj(e,t){if(t<=0)throw new uN(sN.INVALID_ARGUMENT,"Function "+e+"() requires a positive number, but it was: "+t+".")}var kj=function(){function e(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new uN(sN.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new uN(sN.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,gj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}return e.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams},e}(),Cj=function(){function e(e,t){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kj({}),this._settingsFrozen=!1,e instanceof aj?(this._databaseId=e,this._credentials=new cj):(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new uN(sN.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new aj(e.options.projectId)}(e),this._credentials=new hj(t))}return Object.defineProperty(e.prototype,"app",{get:function(){if(!this._app)throw new uN(sN.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),e.prototype._setSettings=function(e){if(this._settingsFrozen)throw new uN(sN.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kj(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new cj;switch(e.type){case"gapi":var t=e.client;return gN(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new dj(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new uN(sN.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},e.prototype._getSettings=function(){return this._settings},e.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},e.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},e.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},e.prototype._terminate=function(){return(e=sj.get(this))&&(hN("ComponentProvider","Removing Datastore"),sj.delete(this),e.terminate()),Promise.resolve();var e},e}(),Ej=function(){function e(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}return Object.defineProperty(e.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Sj(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._key)},e}(),Oj=function(){function e(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}return e.prototype.withConverter=function(t){return new e(this.firestore,t,this._query)},e}(),Sj=function(e){function t(t,n,r){var i=this;return(i=e.call(this,t,n,Ax(r))||this)._path=r,i.type="collection",i}return Object(YS.c)(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._path.popLast();return e.isEmpty()?null:new Ej(this.firestore,null,new GN(e))},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._path)},t}(Oj);function Pj(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e=Object(KS.n)(e),pj("collection","path",t),e instanceof Cj)return mj(n=TN.fromString.apply(TN,Object(YS.f)([t],r))),new Sj(e,null,n);if(!(e instanceof Ej||e instanceof Sj))throw new uN(sN.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return mj(n=TN.fromString.apply(TN,Object(YS.f)([e.path],r)).child(TN.fromString(t))),new Sj(e.firestore,null,n)}function Ij(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e=Object(KS.n)(e),1===arguments.length&&(t=bN.u()),pj("doc","path",t),e instanceof Cj)return yj(n=TN.fromString.apply(TN,Object(YS.f)([t],r))),new Ej(e,null,new GN(n));if(!(e instanceof Ej||e instanceof Sj))throw new uN(sN.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return yj(n=e._path.child(TN.fromString.apply(TN,Object(YS.f)([t],r)))),new Ej(e.firestore,e instanceof Sj?e.converter:null,new GN(n))}function Tj(e,t){return e=Object(KS.n)(e),t=Object(KS.n)(t),(e instanceof Ej||e instanceof Sj)&&(t instanceof Ej||t instanceof Sj)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Aj(e,t){return e=Object(KS.n)(e),t=Object(KS.n)(t),e instanceof Oj&&t instanceof Oj&&e.firestore===t.firestore&&jx(e._query,t._query)&&e.converter===t.converter}var Nj=function(){function e(){var e=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new lB(this,"async_queue_retry"),this.Ic=function(){var t=uB();t&&hN("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Zi.Gi()};var t=uB();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(e.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),e.prototype.enqueueAndForget=function(e){this.enqueue(e)},e.prototype.enqueueAndForgetEvenWhileRestricted=function(e){this.Ac(),this.Rc(e)},e.prototype.enterRestrictedMode=function(e){if(!this._c){this._c=!0,this.Ec=e||!1;var t=uB();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ic)}},e.prototype.enqueue=function(e){var t=this;if(this.Ac(),this._c)return new Promise(function(){});var n=new eD;return this.Rc(function(){return t._c&&t.Ec?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})},e.prototype.enqueueRetryable=function(e){var t=this;this.enqueueAndForget(function(){return t.wc.push(e),t.bc()})},e.prototype.bc=function(){return Object(YS.b)(this,void 0,void 0,function(){var e,t=this;return Object(YS.d)(this,function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!aD(e=n.sent()))throw e;return hN("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return t.bc()}),n.label=5;case 5:return[2]}})})},e.prototype.Rc=function(e){var t=this,n=this.dc.then(function(){return t.gc=!0,e().catch(function(e){throw t.yc=e,t.gc=!1,fN("INTERNAL UNHANDLED ERROR: ",function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(function(e){return t.gc=!1,e})});return this.dc=n,n},e.prototype.enqueueAfterDelay=function(e,t,n){var r=this;this.Ac(),this.Tc.indexOf(e)>-1&&(t=0);var i=zB.createAndSchedule(this,e,t,n,function(e){return r.vc(e)});return this.mc.push(i),i},e.prototype.Ac=function(){this.yc&&vN()},e.prototype.verifyOperationInProgress=function(){},e.prototype.Pc=function(){return Object(YS.b)(this,void 0,void 0,function(){var e;return Object(YS.d)(this,function(t){switch(t.label){case 0:return[4,e=this.dc];case 1:t.sent(),t.label=2;case 2:if(e!==this.dc)return[3,0];t.label=3;case 3:return[2]}})})},e.prototype.Vc=function(e){for(var t=0,n=this.mc;t<n.length;t++)if(n[t].timerId===e)return!0;return!1},e.prototype.Sc=function(e){var t=this;return this.Pc().then(function(){t.mc.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});for(var n=0,r=t.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==e&&i.timerId===e)break}return t.Pc()})},e.prototype.Dc=function(e){this.Tc.push(e)},e.prototype.vc=function(e){var t=this.mc.indexOf(e);this.mc.splice(t,1)},e}();function xj(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(e)}!function(){function e(){this._progressObserver={},this._taskCompletionResolver=new eD,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}e.prototype.onProgress=function(e,t,n){this._progressObserver={next:e,error:t,complete:n}},e.prototype.catch=function(e){return this._taskCompletionResolver.promise.catch(e)},e.prototype.then=function(e,t){return this._taskCompletionResolver.promise.then(e,t)},e.prototype._completeWith=function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)},e.prototype._failWith=function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)},e.prototype._updateProgress=function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}();var Rj=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this).type="firestore",r._queue=new Nj,r._persistenceKey="name"in t?t.name:"[DEFAULT]",r}return Object(YS.c)(t,e),t.prototype._terminate=function(){return this._firestoreClient||Dj(this),this._firestoreClient.terminate()},t}(Cj);function Mj(e){return e._firestoreClient||Dj(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Dj(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new oj(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new $F(e._credentials,e._queue,r)}function Lj(e,t,n){var r=this,i=new eD;return e.asyncQueue.enqueue(function(){return Object(YS.b)(r,void 0,void 0,function(){var r;return Object(YS.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,ZF(e,n)];case 1:return o.sent(),[4,QF(e,t)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(e){return"FirebaseError"===e.name?e.code===sN.FAILED_PRECONDITION||e.code===sN.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Bj(e){if(e._initialized||e._terminated)throw new uN(sN.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Fj=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length;++n)if(0===e[n].length)throw new uN(sN.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new NN(e)}return e.prototype.isEqual=function(e){return this._internalPath.isEqual(e._internalPath)},e}(),jj=function(){function e(e){this._byteString=e}return e.fromBase64String=function(t){try{return new e(RN.fromBase64String(t))}catch(t){throw new uN(sN.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},e.fromUint8Array=function(t){return new e(RN.fromUint8Array(t))},e.prototype.toBase64=function(){return this._byteString.toBase64()},e.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},e.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(e){return this._byteString.isEqual(e._byteString)},e}(),Uj=function(e){this._methodName=e},Vj=function(){function e(e,t){if(!isFinite(e)||e<-90||e>90)throw new uN(sN.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new uN(sN.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},e.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},e.prototype._compareTo=function(e){return _N(this._lat,e._lat)||_N(this._long,e._long)},e}(),zj=/^__.*__$/,Hj=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutation=function(e,t){return null!==this.fieldMask?new yR(e,this.data,this.fieldMask,t,this.fieldTransforms):new gR(e,this.data,t,this.fieldTransforms)},e}(),Gj=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutation=function(e,t){return new yR(e,this.data,this.fieldMask,t,this.fieldTransforms)},e}();function qj(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw vN()}}var Wj=function(){function e(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(e.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),e.prototype.xc=function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},e.prototype.kc=function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.xc({path:n,Fc:!1});return r.$c(e),r},e.prototype.Oc=function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.xc({path:n,Fc:!1});return r.Cc(),r},e.prototype.Mc=function(e){return this.xc({path:void 0,Fc:!0})},e.prototype.Lc=function(e){return fU(e,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},e.prototype.contains=function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})},e.prototype.Cc=function(){if(this.path)for(var e=0;e<this.path.length;e++)this.$c(this.path.get(e))},e.prototype.$c=function(e){if(0===e.length)throw this.Lc("Document fields must not be empty");if(qj(this.Nc)&&zj.test(e))throw this.Lc('Document fields cannot begin and end with "__"')},e}(),$j=function(){function e(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.R=n||cB(e)}return e.prototype.Uc=function(e,t,n,r){return void 0===r&&(r=!1),new Wj({Nc:e,methodName:t,qc:n,path:NN.emptyPath(),Fc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},e}();function Zj(e){var t=e._freezeSettings(),n=cB(e._databaseId);return new $j(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Qj(e,t,n,r,i,o){void 0===o&&(o={});var a=e.Uc(o.merge||o.mergeFields?2:0,t,n,i);uU("Data must be an object, but it was:",a,r);var s,u,c=aU(r,a);if(o.merge)s=new xN(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var d=cU(t,f[h],n);if(!a.contains(d))throw new uN(sN.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");dU(l,d)||l.push(d)}s=new xN(l),u=a.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=a.fieldTransforms;return new Hj(new ox(c),s,u)}var Yj=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(YS.c)(t,e),t.prototype._toFieldTransform=function(e){if(2!==e.Nc)throw e.Lc(1===e.Nc?this._methodName+"() can only appear at the top level of your update data":this._methodName+"() cannot be used with set() unless you pass {merge:true}");return e.fieldMask.push(e.path),null},t.prototype.isEqual=function(e){return e instanceof t},t}(Uj);function Kj(e,t,n){return new Wj({Nc:3,qc:t.settings.qc,methodName:e._methodName,Fc:n},t.databaseId,t.R,t.ignoreUndefinedProperties)}var Jj=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(YS.c)(t,e),t.prototype._toFieldTransform=function(e){return new aR(e.path,new Jx)},t.prototype.isEqual=function(e){return e instanceof t},t}(Uj),Xj=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).Kc=n,r}return Object(YS.c)(t,e),t.prototype._toFieldTransform=function(e){var t=Kj(this,e,!0),n=this.Kc.map(function(e){return oU(e,t)}),r=new Xx(n);return new aR(e.path,r)},t.prototype.isEqual=function(e){return this===e},t}(Uj),eU=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).Kc=n,r}return Object(YS.c)(t,e),t.prototype._toFieldTransform=function(e){var t=Kj(this,e,!0),n=this.Kc.map(function(e){return oU(e,t)}),r=new tR(n);return new aR(e.path,r)},t.prototype.isEqual=function(e){return this===e},t}(Uj),tU=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).Qc=n,r}return Object(YS.c)(t,e),t.prototype._toFieldTransform=function(e){var t=new rR(e.R,$x(e.R,this.Qc));return new aR(e.path,t)},t.prototype.isEqual=function(e){return this===e},t}(Uj);function nU(e,t,n,r){var i=e.Uc(1,t,n);uU("Data must be an object, but it was:",i,r);var o=[],a=ox.empty();SN(r,function(e,r){var s=hU(t,e,n);r=Object(KS.n)(r);var u=i.Oc(s);if(r instanceof Yj)o.push(s);else{var c=oU(r,u);null!=c&&(o.push(s),a.set(s,c))}});var s=new xN(o);return new Gj(a,s,i.fieldTransforms)}function rU(e,t,n,r,i,o){var a=e.Uc(1,t,n),s=[cU(t,r,n)],u=[i];if(o.length%2!=0)throw new uN(sN.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(cU(t,o[c])),u.push(o[c+1]);for(var l=[],h=ox.empty(),f=s.length-1;f>=0;--f)if(!dU(l,s[f])){var d=s[f],p=u[f];p=Object(KS.n)(p);var v=a.Oc(d);if(p instanceof Yj)l.push(d);else{var g=oU(p,v);null!=g&&(l.push(d),h.set(d,g))}}var y=new xN(l);return new Gj(h,y,a.fieldTransforms)}function iU(e,t,n,r){return void 0===r&&(r=!1),oU(n,e.Uc(r?4:3,t))}function oU(e,t){if(sU(e=Object(KS.n)(e)))return uU("Unsupported field value:",t,e),aU(e,t);if(e instanceof Uj)return function(e,t){if(!qj(t.Nc))throw t.Lc(e._methodName+"() can only be used with update() and set()");if(!t.path)throw t.Lc(e._methodName+"() is not currently supported inside arrays");var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Fc&&4!==t.Nc)throw t.Lc("Nested arrays are not supported");return function(e,t){for(var n=[],r=0,i=0,o=e;i<o.length;i++){var a=oU(o[i],t.Mc(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Object(KS.n)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return $x(t.R,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=CN.fromDate(e);return{timestampValue:tM(t.R,n)}}if(e instanceof CN)return n=new CN(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)),{timestampValue:tM(t.R,n)};if(e instanceof Vj)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof jj)return{bytesValue:nM(t.R,e._byteString)};if(e instanceof Ej){var r=e.firestore._databaseId;if(!r.isEqual(n=t.databaseId))throw t.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:oM(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Lc("Unsupported field value: "+bj(e))}(e,t)}function aU(e,t){var n={};return PN(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):SN(e,function(e,r){var i=oU(r,t.kc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function sU(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof CN||e instanceof Vj||e instanceof jj||e instanceof Ej||e instanceof Uj)}function uU(e,t,n){if(!sU(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=bj(n);throw t.Lc("an object"===r?e+" a custom object":e+" "+r)}}function cU(e,t,n){if((t=Object(KS.n)(t))instanceof Fj)return t._internalPath;if("string"==typeof t)return hU(e,t);throw fU("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}var lU=new RegExp("[~\\*/\\[\\]]");function hU(e,t,n){if(t.search(lU)>=0)throw fU("Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,n);try{return(new(Fj.bind.apply(Fj,Object(YS.f)([void 0],t.split(".")))))._internalPath}catch(fV){throw fU("Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,n)}}function fU(e,t,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,s="Function "+t+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var u="";return(o||a)&&(u+=" (found",o&&(u+=" in field "+r),a&&(u+=" in document "+i),u+=")"),new uN(sN.INVALID_ARGUMENT,(s+=". ")+e+u)}function dU(e,t){return e.some(function(e){return e.isEqual(t)})}var pU=function(){function e(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new Ej(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),e.prototype.exists=function(){return null!==this._document},e.prototype.data=function(){if(this._document){if(this._converter){var e=new vU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}},e.prototype.get=function(e){if(this._document){var t=this._document.data.field(gU("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}},e}(),vU=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(YS.c)(t,e),t.prototype.data=function(){return e.prototype.data.call(this)},t}(pU);function gU(e,t){return"string"==typeof t?hU(e,t):t instanceof Fj?t._internalPath:t._delegate._internalPath}var yU=function(){function e(e,t){this.hasPendingWrites=e,this.fromCache=t}return e.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},e}(),mU=function(e){function t(t,n,r,i,o,a){var s=this;return(s=e.call(this,t,n,r,i,a)||this)._firestore=t,s._firestoreImpl=t,s.metadata=o,s}return Object(YS.c)(t,e),t.prototype.exists=function(){return e.prototype.exists.call(this)},t.prototype.data=function(e){if(void 0===e&&(e={}),this._document){if(this._converter){var t=new bU(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}},t.prototype.get=function(e,t){if(void 0===t&&(t={}),this._document){var n=this._document.data.field(gU("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}},t}(pU),bU=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(YS.c)(t,e),t.prototype.data=function(t){return void 0===t&&(t={}),e.prototype.data.call(this,t)},t}(mU),_U=function(){function e(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new yU(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(e.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new bU(n._firestore,n._userDataWriter,r.key,r,new yU(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})},e.prototype.docChanges=function(e){void 0===e&&(e={});var t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new uN(sN.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new bU(e._firestore,e._userDataWriter,t.doc.key,t.doc,new yU(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new bU(e._firestore,e._userDataWriter,t.doc.key,t.doc,new yU(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,o=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(o=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:wU(t.type),doc:n,oldIndex:i,newIndex:o}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},e}();function wU(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return vN()}}function kU(e,t){return e instanceof mU&&t instanceof mU?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof _U&&t instanceof _U&&e._firestore===t._firestore&&Aj(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function CU(e){if(xx(e)&&0===e.explicitOrderBy.length)throw new uN(sN.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var EU=function(){};function OU(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r];e=o._apply(e)}return e}var SU=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).jc=t,i.Wc=n,i.Gc=r,i.type="where",i}return Object(YS.c)(t,e),t.prototype._apply=function(e){var t=Zj(e.firestore),n=function(e,t,n,r,i,o,a){var s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new uN(sN.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){RU(a,o);for(var u=[],c=0,l=a;c<l.length;c++)u.push(xU(r,e,l[c]));s={arrayValue:{values:u}}}else s=xU(r,e,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||RU(a,o),s=iU(n,"where",a,"in"===o||"not-in"===o);var h=dx.create(i,o,s);return function(e,t){if(t.g()){var n=Mx(e);if(null!==n&&!n.isEqual(t.field))throw new uN(sN.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+t.field.toString()+"'");var r=Rx(e);null!==r&&MU(0,t.field,r)}var i=function(e,t){for(var n=0,r=e.filters;n<r.length;n++){var i=r[n];if(t.indexOf(i.op)>=0)return i.op}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new uN(sN.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter.":"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+i.toString()+"' filters.")}(e,h),h}(e._query,0,t,e.firestore._databaseId,this.jc,this.Wc,this.Gc);return new Oj(e.firestore,e.converter,function(e,t){var n=e.filters.concat([t]);return new Ix(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))},t}(EU),PU=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).jc=t,r.zc=n,r.type="orderBy",r}return Object(YS.c)(t,e),t.prototype._apply=function(e){var t=function(e,t,n){if(null!==e.startAt)throw new uN(sN.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new uN(sN.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ex(t,n);return function(e,t){if(null===Rx(e)){var n=Mx(e);null!==n&&MU(0,n,t.field)}}(e,r),r}(e._query,this.jc,this.zc);return new Oj(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new Ix(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))},t}(EU),IU=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.Hc=n,i.Jc=r,i}return Object(YS.c)(t,e),t.prototype._apply=function(e){return new Oj(e.firestore,e.converter,Fx(e._query,this.Hc,this.Jc))},t}(EU),TU=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.Yc=n,i.Xc=r,i}return Object(YS.c)(t,e),t.prototype._apply=function(e){var t=NU(e,this.type,this.Yc,this.Xc);return new Oj(e.firestore,e.converter,function(e,t){return new Ix(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))},t}(EU),AU=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.Yc=n,i.Xc=r,i}return Object(YS.c)(t,e),t.prototype._apply=function(e){var t=NU(e,this.type,this.Yc,this.Xc);return new Oj(e.firestore,e.converter,function(e,t){return new Ix(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))},t}(EU);function NU(e,t,n,r){if(n[0]=Object(KS.n)(n[0]),n[0]instanceof pU)return function(e,t,n,r,i){if(!r)throw new uN(sN.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=Lx(e);a<s.length;a++){var u=s[a];if(u.field.isKeyField())o.push(JN(t,r.key));else{var c=r.data.field(u.field);if(FN(c))throw new uN(sN.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new uN(sN.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new kx(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=Zj(e.firestore);return function(e,t,n,r,i,o){var a=e.explicitOrderBy;if(i.length>a.length)throw new uN(sN.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new uN(sN.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Dx(e)&&-1!==c.indexOf("/"))throw new uN(sN.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=e.path.child(TN.fromString(c));if(!GN.isDocumentKey(l))throw new uN(sN.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new GN(l);s.push(JN(t,h))}else{var f=iU(n,r,c);s.push(f)}}return new kx(s,o)}(e._query,e.firestore._databaseId,i,t,n,r)}function xU(e,t,n){if("string"==typeof(n=Object(KS.n)(n))){if(""===n)throw new uN(sN.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dx(t)&&-1!==n.indexOf("/"))throw new uN(sN.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=t.path.child(TN.fromString(n));if(!GN.isDocumentKey(r))throw new uN(sN.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return JN(e,new GN(r))}if(n instanceof Ej)return JN(e,n._key);throw new uN(sN.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+bj(n)+".")}function RU(e,t){if(!Array.isArray(e)||0===e.length)throw new uN(sN.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new uN(sN.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.")}function MU(e,t,n){if(!n.isEqual(t))throw new uN(sN.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var DU=function(){function e(){}return e.prototype.convertValue=function(e,t){switch(void 0===t&&(t="none"),qN(e)){case 0:return null;case 1:return e.booleanValue;case 2:return LN(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(BN(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw vN()}},e.prototype.convertObject=function(e,t){var n=this,r={};return SN(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r},e.prototype.convertGeoPoint=function(e){return new Vj(LN(e.latitude),LN(e.longitude))},e.prototype.convertArray=function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})},e.prototype.convertServerTimestamp=function(e,t){switch(t){case"previous":var n=jN(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(UN(e));default:return null}},e.prototype.convertTimestamp=function(e){var t=DN(e);return new CN(t.seconds,t.nanos)},e.prototype.convertDocumentKey=function(e,t){var n=TN.fromString(e);gN(AM(n));var r=new aj(n.get(1),n.get(3)),i=new GN(n.popFirst(5));return r.isEqual(t)||fN("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+t.projectId+"/"+t.database+") instead."),i},e}();function LU(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var BU=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Object(YS.c)(t,e),t.prototype.convertBytes=function(e){return new jj(e)},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ej(this.firestore,null,t)},t}(DU),FU=function(){function e(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Zj(e)}return e.prototype.set=function(e,t,n){this._verifyNotCommitted();var r=jU(e,this._firestore),i=LU(r.converter,t,n),o=Qj(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,uR.none())),this},e.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,a=jU(e,this._firestore);return o="string"==typeof(t=Object(KS.n)(t))||t instanceof Fj?rU(this._dataReader,"WriteBatch.update",a._key,t,n,r):nU(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(o.toMutation(a._key,uR.exists(!0))),this},e.prototype.delete=function(e){this._verifyNotCommitted();var t=jU(e,this._firestore);return this._mutations=this._mutations.concat(new CR(t._key,uR.none())),this},e.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},e.prototype._verifyNotCommitted=function(){if(this._committed)throw new uN(sN.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}();function jU(e,t){if((e=Object(KS.n)(e)).firestore!==t)throw new uN(sN.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}var UU=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Object(YS.c)(t,e),t.prototype.convertBytes=function(e){return new jj(e)},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ej(this.firestore,null,t)},t}(DU);function VU(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];e=_j(e,Ej);var o=_j(e.firestore,Rj),a=Zj(o);return HU(o,[("string"==typeof(t=Object(KS.n)(t))||t instanceof Fj?rU(a,"updateDoc",e._key,t,n,r):nU(a,"updateDoc",e._key,t)).toMutation(e._key,uR.exists(!0))])}function zU(e){for(var t,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];e=Object(KS.n)(e);var a={includeMetadataChanges:!1},s=0;"object"!=typeof i[s]||xj(i[s])||(a=i[s],s++);var u,c,l,h={includeMetadataChanges:a.includeMetadataChanges};if(xj(i[s])){var f=i[s];i[s]=null===(t=f.next)||void 0===t?void 0:t.bind(f),i[s+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[s+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(e instanceof Ej)c=_j(e.firestore,Rj),l=Ax(e._key.path),u={next:function(t){i[s]&&i[s](GU(c,e,t))},error:i[s+1],complete:i[s+2]};else{var d=_j(e,Oj);c=_j(d.firestore,Rj),l=d._query;var p=new UU(c);u={next:function(e){i[s]&&i[s](new _U(c,p,d,e))},error:i[s+1],complete:i[s+2]},CU(e._query)}return function(e,t,n,r){var i=this,o=new GF(r),a=new eF(t,o,n);return e.asyncQueue.enqueueAndForget(function(){return Object(YS.b)(i,void 0,void 0,function(){var t;return Object(YS.d)(this,function(n){switch(n.label){case 0:return t=QB,[4,nj(e)];case 1:return[2,t.apply(void 0,[n.sent(),a])]}})})}),function(){o.Wo(),e.asyncQueue.enqueueAndForget(function(){return Object(YS.b)(i,void 0,void 0,function(){var t;return Object(YS.d)(this,function(n){switch(n.label){case 0:return t=YB,[4,nj(e)];case 1:return[2,t.apply(void 0,[n.sent(),a])]}})})})}}(Mj(c),l,h,u)}function HU(e,t){return function(e,t){var n=this,r=new eD;return e.asyncQueue.enqueueAndForget(function(){return Object(YS.b)(n,void 0,void 0,function(){var n;return Object(YS.d)(this,function(i){switch(i.label){case 0:return n=fF,[4,tj(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}})})}),r.promise}(Mj(e),t)}function GU(e,t,n){var r=n.docs.get(t._key),i=new UU(e);return new mU(e,i,t._key,r,new yU(n.hasPendingWrites,n.fromCache),t.converter)}var qU=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this)._firestore=t,r}return Object(YS.c)(t,e),t.prototype.get=function(t){var n=this,r=jU(t,this._firestore),i=new UU(this._firestore);return e.prototype.get.call(this,t).then(function(e){return new mU(n._firestore,i,r._key,e._document,new yU(!1,!1),r.converter)})},t}(function(){function e(e,t){this._firestore=e,this._transaction=t,this._dataReader=Zj(e)}return e.prototype.get=function(e){var t=this,n=jU(e,this._firestore),r=new BU(this._firestore);return this._transaction.lookup([n._key]).then(function(e){if(!e||1!==e.length)return vN();var i=e[0];if(i.isFoundDocument())return new pU(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new pU(t._firestore,r,n._key,null,n.converter);throw vN()})},e.prototype.set=function(e,t,n){var r=jU(e,this._firestore),i=LU(r.converter,t,n),o=Qj(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},e.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a=jU(e,this._firestore);return o="string"==typeof(t=Object(KS.n)(t))||t instanceof Fj?rU(this._dataReader,"Transaction.update",a._key,t,n,r):nU(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,o),this},e.prototype.delete=function(e){var t=jU(e,this._firestore);return this._transaction.delete(t._key),this},e}());function WU(){if("undefined"==typeof Uint8Array)throw new uN(sN.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function $U(){if("undefined"==typeof atob)throw new uN(sN.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ZU=function(){function e(e){this._delegate=e}return e.fromBase64String=function(t){return $U(),new e(jj.fromBase64String(t))},e.fromUint8Array=function(t){return WU(),new e(jj.fromUint8Array(t))},e.prototype.toBase64=function(){return $U(),this._delegate.toBase64()},e.prototype.toUint8Array=function(){return WU(),this._delegate.toUint8Array()},e.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(),QU=function(){function e(){}return e.prototype.enableIndexedDbPersistence=function(e,t){return function(e,t){Bj(e=_j(e,Rj));var n=Mj(e),r=e._freezeSettings(),i=new HF;return Lj(n,i,new VF(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})},e.prototype.enableMultiTabIndexedDbPersistence=function(e){return function(e){Bj(e=_j(e,Rj));var t=Mj(e),n=e._freezeSettings(),r=new HF;return Lj(t,r,new zF(r,n.cacheSizeBytes))}(e._delegate)},e.prototype.clearIndexedDbPersistence=function(e){return function(e){var t=this;if(e._initialized&&!e._terminated)throw new uN(sN.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new eD;return e._queue.enqueueAndForgetEvenWhileRestricted(function(){return Object(YS.b)(t,void 0,void 0,function(){var t;return Object(YS.d)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(e){return Object(YS.b)(this,void 0,void 0,function(){return Object(YS.d)(this,function(t){switch(t.label){case 0:return rD.yt()?[4,rD.delete(e+"main")]:[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(pL(e._databaseId,e._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}})})}),n.promise}(e._delegate)},e}(),YU=function(){function e(e,t,n){var r=this;this._delegate=t,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},e instanceof aj||(this.tu=e)}return Object.defineProperty(e.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),e.prototype.settings=function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||dN("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)},e.prototype.useEmulator=function(e,t,n){void 0===n&&(n={}),function(e,t,n,r){var i;void 0===r&&(r={});var o=(e=_j(e,Cj))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==t&&dN("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},o),{host:t+":"+n,ssl:!1})),r.mockUserToken){var a,s;if("string"==typeof r.mockUserToken)a=r.mockUserToken,s=qL.MOCK_USER;else{a=Object(KS.i)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);var u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new uN(sN.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new qL(u)}e._credentials=new lj(new uj(a,s))}}(this._delegate,e,t,n)},e.prototype.enableNetwork=function(){return function(e){var t=this;return e.asyncQueue.enqueue(function(){return Object(YS.b)(t,void 0,void 0,function(){var t,n;return Object(YS.d)(this,function(r){switch(r.label){case 0:return[4,JF(e)];case 1:return t=r.sent(),[4,ej(e)];case 2:return n=r.sent(),[2,(t.setNetworkEnabled(!0),function(e){var t=yN(e);return t.Or.delete(0),yB(t)}(n))]}})})})}(Mj(_j(this._delegate,Rj)))},e.prototype.disableNetwork=function(){return function(e){var t=this;return e.asyncQueue.enqueue(function(){return Object(YS.b)(t,void 0,void 0,function(){var t,n;return Object(YS.d)(this,function(r){switch(r.label){case 0:return[4,JF(e)];case 1:return t=r.sent(),[4,ej(e)];case 2:return n=r.sent(),[2,(t.setNetworkEnabled(!1),function(e){return Object(YS.b)(this,void 0,void 0,function(){var t;return Object(YS.d)(this,function(n){switch(n.label){case 0:return(t=yN(e)).Or.add(0),[4,mB(t)];case 1:return n.sent(),t.Br.set("Offline"),[2]}})})}(n))]}})})})}(Mj(_j(this._delegate,Rj)))},e.prototype.enablePersistence=function(e){var t=!1,n=!1;return e&&gj("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},e.prototype.waitForPendingWrites=function(){return function(e){var t=this,n=new eD;return e.asyncQueue.enqueueAndForget(function(){return Object(YS.b)(t,void 0,void 0,function(){var t;return Object(YS.d)(this,function(r){switch(r.label){case 0:return t=mF,[4,tj(e)];case 1:return[2,t.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Mj(_j(this._delegate,Rj)))},e.prototype.onSnapshotsInSync=function(e){return function(e,t){return function(e,t){var n=this,r=new GF(t);return e.asyncQueue.enqueueAndForget(function(){return Object(YS.b)(n,void 0,void 0,function(){var t;return Object(YS.d)(this,function(n){switch(n.label){case 0:return t=function(e,t){yN(e).Gr.add(t),t.next()},[4,nj(e)];case 1:return[2,t.apply(void 0,[n.sent(),r])]}})})}),function(){r.Wo(),e.asyncQueue.enqueueAndForget(function(){return Object(YS.b)(n,void 0,void 0,function(){var t;return Object(YS.d)(this,function(n){switch(n.label){case 0:return t=function(e,t){yN(e).Gr.delete(t)},[4,nj(e)];case 1:return[2,t.apply(void 0,[n.sent(),r])]}})})})}}(Mj(e=_j(e,Rj)),xj(t)?t:{next:t})}(this._delegate,e)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.tu)throw new uN(sN.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),e.prototype.collection=function(e){try{return new lV(this,Pj(this._delegate,e))}catch(e){throw nV(e,"collection()","Firestore.collection()")}},e.prototype.doc=function(e){try{return new tV(this,Ij(this._delegate,e))}catch(e){throw nV(e,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(e){try{return new sV(this,function(e,t){if(e=_j(e,Cj),pj("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new uN(sN.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Oj(e,null,function(e){return new Ix(TN.emptyPath(),e)}(t))}(this._delegate,e))}catch(e){throw nV(e,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(e){var t=this;return function(e,t){return function(e,t){var n=this,r=new eD;return e.asyncQueue.enqueueAndForget(function(){return Object(YS.b)(n,void 0,void 0,function(){var n;return Object(YS.d)(this,function(i){switch(i.label){case 0:return[4,function(e){return KF(e).then(function(e){return e.datastore})}(e)];case 1:return n=i.sent(),new WF(e.asyncQueue,n,t,r).run(),[2]}})})}),r.promise}(Mj(e),function(n){return t(new qU(e,n))})}(this._delegate,function(n){return e(new JU(t,n))})},e.prototype.batch=function(){var e=this;return Mj(this._delegate),new XU(new FU(this._delegate,function(t){return HU(e._delegate,t)}))},e.prototype.loadBundle=function(e){throw new uN(sN.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(e){throw new uN(sN.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(),KU=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Object(YS.c)(t,e),t.prototype.convertBytes=function(e){return new ZU(new jj(e))},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return tV.eu(t,this.firestore,null)},t}(DU),JU=function(){function e(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new KU(e)}return e.prototype.get=function(e){var t=this,n=hV(e);return this._delegate.get(n).then(function(e){return new oV(t._firestore,new mU(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))})},e.prototype.set=function(e,t,n){var r=hV(e);return n?(vj("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this},e.prototype.update=function(e,t,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=hV(e);return 2===arguments.length?this._delegate.update(a,t):(r=this._delegate).update.apply(r,Object(YS.f)([a,t,n],i)),this},e.prototype.delete=function(e){var t=hV(e);return this._delegate.delete(t),this},e}(),XU=function(){function e(e){this._delegate=e}return e.prototype.set=function(e,t,n){var r=hV(e);return n?(vj("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this},e.prototype.update=function(e,t,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=hV(e);return 2===arguments.length?this._delegate.update(a,t):(r=this._delegate).update.apply(r,Object(YS.f)([a,t,n],i)),this},e.prototype.delete=function(e){var t=hV(e);return this._delegate.delete(t),this},e.prototype.commit=function(){return this._delegate.commit()},e}(),eV=function(){function e(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}return e.prototype.fromFirestore=function(e,t){var n=new bU(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new aV(this._firestore,n),null!=t?t:{})},e.prototype.toFirestore=function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)},e.nu=function(t,n){var r=e.su,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new KU(t),n),i.set(n,o)),o},e}();eV.su=new WeakMap;var tV=function(){function e(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new KU(e)}return e.iu=function(t,n,r){if(t.length%2!=0)throw new uN(sN.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(n,new Ej(n._delegate,r,new GN(t)))},e.eu=function(t,n,r){return new e(n,new Ej(n._delegate,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new lV(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(e){try{return new lV(this.firestore,Pj(this._delegate,e))}catch(e){throw nV(e,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(e){return(e=Object(KS.n)(e))instanceof Ej&&Tj(this._delegate,e)},e.prototype.set=function(e,t){t=vj("DocumentReference.set",t);try{return function(e,t,n){e=_j(e,Ej);var r=_j(e.firestore,Rj),i=LU(e.converter,t,n);return HU(r,[Qj(Zj(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,uR.none())])}(this._delegate,e,t)}catch(e){throw nV(e,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?VU(this._delegate,e):VU.apply(void 0,Object(YS.f)([this._delegate,e,t],n))}catch(e){throw nV(e,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return HU(_j((e=this._delegate).firestore,Rj),[new CR(e._key,uR.none())]);var e},e.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=rV(t),i=iV(t,function(t){return new oV(e.firestore,new mU(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))});return zU(this._delegate,r,i)},e.prototype.get=function(e){var t=this;return("cache"===(null==e?void 0:e.source)?function(e){e=_j(e,Ej);var t=_j(e.firestore,Rj),n=Mj(t),r=new UU(t);return function(e,t){var n=this,r=new eD;return e.asyncQueue.enqueueAndForget(function(){return Object(YS.b)(n,void 0,void 0,function(){var n;return Object(YS.d)(this,function(i){switch(i.label){case 0:return n=function(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var r,i;return Object(YS.d)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(e,t){var n=yN(e);return n.persistence.runTransaction("read document","readonly",function(e){return n.Mn.mn(e,t)})}(e,t)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new uN(sN.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=HB(r,"Failed to get document '"+t+" from cache"),n.reject(i),[3,3];case 3:return[2]}})})},[4,XF(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}})})}),r.promise}(n,e._key).then(function(n){return new mU(t,r,e._key,n,new yU(null!==n&&n.hasLocalMutations,!0),e.converter)})}(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=_j(e,Ej);var t=_j(e.firestore,Rj);return rj(Mj(t),e._key,{source:"server"}).then(function(n){return GU(t,e,n)})}(this._delegate):function(e){e=_j(e,Ej);var t=_j(e.firestore,Rj);return rj(Mj(t),e._key).then(function(n){return GU(t,e,n)})}(this._delegate)).then(function(e){return new oV(t.firestore,new mU(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))})},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?eV.nu(this.firestore,t):null))},e}();function nV(e,t,n){return e.message=e.message.replace(t,n),e}function rV(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if("object"==typeof r&&!xj(r))return r}return{}}function iV(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=xj(e[0])?e[0]:xj(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var oV=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"ref",{get:function(){return new tV(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(e){return this._delegate.data(e)},e.prototype.get=function(e,t){return this._delegate.get(e,t)},e.prototype.isEqual=function(e){return kU(this._delegate,e._delegate)},e}(),aV=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(YS.c)(t,e),t.prototype.data=function(e){return this._delegate.data(e)},t}(oV),sV=function(){function e(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new KU(e)}return e.prototype.where=function(t,n,r){try{return new e(this.firestore,OU(this._delegate,function(e,t,n){var r=t,i=gU("where",e);return new SU(i,r,n)}(t,n,r)))}catch(t){throw nV(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,OU(this._delegate,function(e,t){void 0===t&&(t="asc");var n=t,r=gU("orderBy",e);return new PU(r,n)}(t,n)))}catch(t){throw nV(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,OU(this._delegate,function(e){return wj("limit",e),new IU("limit",e,"F")}(t)))}catch(t){throw nV(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,OU(this._delegate,function(e){return wj("limitToLast",e),new IU("limitToLast",e,"L")}(t)))}catch(t){throw nV(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,OU(this._delegate,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new TU("startAt",e,!0)}).apply(void 0,t)))}catch(t){throw nV(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,OU(this._delegate,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new TU("startAfter",e,!1)}).apply(void 0,t)))}catch(t){throw nV(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,OU(this._delegate,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new AU("endBefore",e,!0)}).apply(void 0,t)))}catch(t){throw nV(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,OU(this._delegate,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new AU("endAt",e,!1)}).apply(void 0,t)))}catch(t){throw nV(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(e){return Aj(this._delegate,e._delegate)},e.prototype.get=function(e){var t=this;return("cache"===(null==e?void 0:e.source)?function(e){e=_j(e,Oj);var t=_j(e.firestore,Rj),n=Mj(t),r=new UU(t);return function(e,t){var n=this,r=new eD;return e.asyncQueue.enqueueAndForget(function(){return Object(YS.b)(n,void 0,void 0,function(){var n;return Object(YS.d)(this,function(i){switch(i.label){case 0:return n=function(e,t,n){return Object(YS.b)(this,void 0,void 0,function(){var r,i,o,a,s;return Object(YS.d)(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,TL(e,t,!0)];case 1:return s=u.sent(),r=new oF(t,s.Bn),i=r._o(s.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return a=u.sent(),s=HB(a,"Failed to execute query '"+t+" against cache"),n.reject(s),[3,3];case 3:return[2]}})})},[4,XF(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}})})}),r.promise}(n,e._query).then(function(n){return new _U(t,r,e,n)})}(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=_j(e,Oj);var t=_j(e.firestore,Rj),n=Mj(t),r=new UU(t);return ij(n,e._query,{source:"server"}).then(function(n){return new _U(t,r,e,n)})}(this._delegate):function(e){e=_j(e,Oj);var t=_j(e.firestore,Rj),n=Mj(t),r=new UU(t);return CU(e._query),ij(n,e._query).then(function(n){return new _U(t,r,e,n)})}(this._delegate)).then(function(e){return new cV(t.firestore,new _U(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))})},e.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=rV(t),i=iV(t,function(t){return new cV(e.firestore,new _U(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))});return zU(this._delegate,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._delegate.withConverter(t?eV.nu(this.firestore,t):null))},e}(),uV=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new aV(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),e}(),cV=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"query",{get:function(){return new sV(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var e=this;return this._delegate.docs.map(function(t){return new aV(e._firestore,t)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(e){var t=this;return this._delegate.docChanges(e).map(function(e){return new uV(t._firestore,e)})},e.prototype.forEach=function(e,t){var n=this;this._delegate.forEach(function(r){e.call(t,new aV(n._firestore,r))})},e.prototype.isEqual=function(e){return kU(this._delegate,e._delegate)},e}(),lV=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this).firestore=t,r._delegate=n,r}return Object(YS.c)(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return e?new tV(this.firestore,e):null},enumerable:!1,configurable:!0}),t.prototype.doc=function(e){try{return new tV(this.firestore,void 0===e?Ij(this._delegate):Ij(this._delegate,e))}catch(e){throw nV(e,"doc()","CollectionReference.doc()")}},t.prototype.add=function(e){var t=this;return function(e,t){var n=_j(e.firestore,Rj),r=Ij(e),i=LU(e.converter,t);return HU(n,[Qj(Zj(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,uR.exists(!1))]).then(function(){return r})}(this._delegate,e).then(function(e){return new tV(t.firestore,e)})},t.prototype.isEqual=function(e){return Tj(this._delegate,e._delegate)},t.prototype.withConverter=function(e){return new t(this.firestore,this._delegate.withConverter(e?eV.nu(this.firestore,e):null))},t}(sV);function hV(e){return _j(e,Ej)}var fV,dV=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._delegate=new(Fj.bind.apply(Fj,Object(YS.f)([void 0],e)))}return e.documentId=function(){return new e(NN.keyField().canonicalString())},e.prototype.isEqual=function(e){return(e=Object(KS.n)(e))instanceof Fj&&this._delegate._internalPath.isEqual(e._internalPath)},e}(),pV=function(){function e(e){this._delegate=e}return e.serverTimestamp=function(){var t=new Jj("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Yj("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new Xj("arrayUnion",e)}).apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new eU("arrayRemove",e)}).apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(e){return new tU("increment",e)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},e}(),vV=jp("/6Yf"),gV={Firestore:YU,GeoPoint:Vj,Timestamp:CN,Blob:ZU,Transaction:JU,WriteBatch:XU,DocumentReference:tV,DocumentSnapshot:oV,Query:sV,QueryDocumentSnapshot:aV,QuerySnapshot:cV,CollectionReference:lV,FieldPath:dV,FieldValue:pV,setLogLevel:function(e){cN.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(e,t){e.INTERNAL.registerComponent(new vV.a("firestore",function(e){return function(e,t){return new YU(e,new Rj(e,t),new QU)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},gV)))})(fV=QS.a),fV.registerVersion("@firebase/firestore","2.4.0");var yV=jp("VRyK"),mV=jp("qgXg"),bV=jp("Ylt2"),_V=function(e){Jp(n,e);var t=ev(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY,o=arguments.length>2?arguments[2]:void 0;return Qp(this,n),(e=t.call(this)).scheduler=o,e._events=[],e._infiniteTimeWindow=!1,e._bufferSize=r<1?1:r,e._windowTime=i<1?1:i,i===Number.POSITIVE_INFINITY?(e._infiniteTimeWindow=!0,e.next=e.nextInfiniteTimeWindow):e.next=e.nextTimeWindow,e}return Kp(n,[{key:"nextInfiniteTimeWindow",value:function(e){if(!this.isStopped){var t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}$p(iv(n.prototype),"next",this).call(this,e)}},{key:"nextTimeWindow",value:function(e){this.isStopped||(this._events.push(new wV(this._getNow(),e)),this._trimBufferThenGetEvents()),$p(iv(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new b_.a;if(this.isStopped||this.hasError?t=hw.a.EMPTY:(this.observers.push(e),t=new bV.a(this,e)),i&&e.add(e=new $S.a(e,i)),n)for(var a=0;a<o&&!e.closed;a++)e.next(r[a]);else for(var s=0;s<o&&!e.closed;s++)e.next(r[s].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t}},{key:"_getNow",value:function(){return(this.scheduler||mV.a).now()}},{key:"_trimBufferThenGetEvents",value:function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),o>0&&r.splice(0,o),r}}]),n}(m_.a),wV=function e(t,n){Qp(this,e),this.time=t,this.value=n};function kV(e,t,n){var r;return r=e&&"object"==typeof e?e:{bufferSize:e,windowTime:t,refCount:!1,scheduler:n},function(e){return e.lift(function(e){var t,n,r=e.bufferSize,i=void 0===r?Number.POSITIVE_INFINITY:r,o=e.windowTime,a=void 0===o?Number.POSITIVE_INFINITY:o,s=e.refCount,u=e.scheduler,c=0,l=!1,h=!1;return function(e){var r;c++,!t||l?(l=!1,t=new _V(i,a,u),r=t.subscribe(this),n=e.subscribe({next:function(e){t.next(e)},error:function(e){l=!0,t.error(e)},complete:function(){h=!0,n=void 0,t.complete()}}),h&&(n=void 0)):r=t.subscribe(this),this.add(function(){c--,r.unsubscribe(),r=void 0,n&&!h&&s&&0===c&&(n.unsubscribe(),n=void 0,t=void 0)})}}(r))}}function CV(e,t){return t?B_(function(){return e},t):B_(function(){return e})}var EV,OV=jp("tf+s"),SV=new Vp.r("angularfire2.auth.use-emulator"),PV=new Vp.r("angularfire2.auth.settings"),IV=new Vp.r("angularfire2.auth.tenant-id"),TV=new Vp.r("angularfire2.auth.langugage-code"),AV=new Vp.r("angularfire2.auth.use-device-language"),NV=new Vp.r("angularfire.auth.persistence"),xV=((EV=function e(t,n,r,i,o,a,s,u,c,l){Qp(this,e);var h=new US.d(i),f=Object(US.h)(h),d=new m_.a,p=Object(Eb.a)(void 0).pipe(Object($S.b)(h.outsideAngular),B_(function(){return i.runOutsideAngular(function(){return Promise.resolve().then(jp.bind(null,"6nsN"))})}),Object(ky.a)(function(){return Object(US.g)(t,i,n)}),Object(ky.a)(function(e){return i.runOutsideAngular(function(){var t=o,n=a;return Object(US.f)("".concat(e.name,".auth"),"AngularFireAuth",e,function(){var r=i.runOutsideAngular(function(){return e.auth()});if(t&&r.useEmulator("http://".concat(t.join(":"))),s&&(r.tenantId=s),r.languageCode=u,c&&r.useDeviceLanguage(),n)for(var o=0,a=Object.entries(n);o<a.length;o++){var h=Bp(a[o],2),f=h[0],d=h[1];r.settings[f]=d}return l&&r.setPersistence(l),r},[t,s,u,c,n,l])})}),kV({bufferSize:1,refCount:!1}));if(Pg(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Object(Eb.a)(null);else{p.pipe(uw()).subscribe();var v=p.pipe(B_(function(e){return e.getRedirectResult().then(function(e){return e},function(){return null})}),f,kV({bufferSize:1,refCount:!1})),g=function(e){return new _y.a(function(t){return{unsubscribe:i.runOutsideAngular(function(){return e(t)})}})},y=p.pipe(B_(function(e){return g(e.onAuthStateChanged.bind(e))})),m=p.pipe(B_(function(e){return g(e.onIdTokenChanged.bind(e))}));this.authState=v.pipe(CV(y),Object(OV.a)(h.outsideAngular),Object($S.b)(h.insideAngular)),this.user=v.pipe(CV(m),Object(OV.a)(h.outsideAngular),Object($S.b)(h.insideAngular)),this.idToken=this.user.pipe(B_(function(e){return e?Object(by.a)(e.getIdToken()):Object(Eb.a)(null)})),this.idTokenResult=this.user.pipe(B_(function(e){return e?Object(by.a)(e.getIdTokenResult()):Object(Eb.a)(null)})),this.credential=Object(yV.a)(v,d,this.authState.pipe(Ib(function(e){return!e}))).pipe(Object(ky.a)(function(e){return(null==e?void 0:e.user)?e:null}),Object(OV.a)(h.outsideAngular),Object($S.b)(h.insideAngular))}return Object(US.i)(this,p,i,{spy:{apply:function(e,t,n){(e.startsWith("signIn")||e.startsWith("createUser"))&&n.then(function(e){return d.next(e)})}}})}).\u0275fac=function(e){return new(e||EV)(Vp.Zb(US.c),Vp.Zb(US.b,8),Vp.Zb(Vp.C),Vp.Zb(Vp.A),Vp.Zb(SV,8),Vp.Zb(PV,8),Vp.Zb(IV,8),Vp.Zb(TV,8),Vp.Zb(AV,8),Vp.Zb(NV,8))},EV.\u0275prov=Vp.Hb({factory:function(){return new EV(Vp.Zb(US.c),Vp.Zb(US.b,8),Vp.Zb(Vp.C),Vp.Zb(Vp.A),Vp.Zb(SV,8),Vp.Zb(PV,8),Vp.Zb(IV,8),Vp.Zb(TV,8),Vp.Zb(AV,8),Vp.Zb(NV,8))},token:EV,providedIn:"any"}),EV);function RV(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:VS.a;return new _y.a(function(n){var r;return null!=t?t.schedule(function(){r=e.onSnapshot({includeMetadataChanges:!0},n)}):r=e.onSnapshot({includeMetadataChanges:!0},n),function(){null!=r&&r()}})}(e,t)}function MV(e,t){return RV(e,t).pipe(Object(ky.a)(function(e){return{payload:e,type:"query"}}))}function DV(e,t){return MV(e,t).pipe(G_(void 0),zS(),Object(ky.a)(function(e){var t=Bp(e,2),n=t[0],r=t[1],i=r.payload.docChanges(),o=i.map(function(e){return{type:e.type,payload:e}});return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach(function(e,t){var r=i.find(function(t){return t.doc.ref.isEqual(e.ref)}),a=null==n?void 0:n.payload.docs.find(function(t){return t.ref.isEqual(e.ref)});r&&JSON.stringify(r.doc.metadata)===JSON.stringify(e.metadata)||!r&&a&&JSON.stringify(a.metadata)===JSON.stringify(e.metadata)||o.push({type:"modified",payload:{oldIndex:t,newIndex:t,type:"modified",doc:e}})}),o}))}function LV(e,t,n){return DV(e,n).pipe(q_(function(e,n){return function(e,t,n){return t.forEach(function(t){n.indexOf(t.type)>-1&&(e=function(e,t){switch(t.type){case"added":if(!e[t.newIndex]||!e[t.newIndex].doc.ref.isEqual(t.doc.ref))return BV(e,t.newIndex,0,t);break;case"modified":if(null==e[t.oldIndex]||e[t.oldIndex].doc.ref.isEqual(t.doc.ref)){if(t.oldIndex!==t.newIndex){var n=e.slice();return n.splice(t.oldIndex,1),n.splice(t.newIndex,0,t),n}return BV(e,t.newIndex,1,t)}break;case"removed":if(e[t.oldIndex]&&e[t.oldIndex].doc.ref.isEqual(t.doc.ref))return BV(e,t.oldIndex,1)}return e}(e,t))}),e}(e,n.map(function(e){return e.payload}),t)},[]),function(e){return e.lift(new qS(void 0,void 0))},Object(ky.a)(function(e){return e.map(function(e){return{type:e.type,payload:e}})}))}function BV(e,t,n){for(var r=e.slice(),i=arguments.length,o=new Array(i>3?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];return r.splice.apply(r,[t,n].concat(o)),r}function FV(e){return e&&0!==e.length||(e=["added","removed","modified"]),e}Object(US.e)(xV,[{app:null,applyActionCode:null,checkActionCode:null,confirmPasswordReset:null,createUserWithEmailAndPassword:null,currentUser:null,fetchSignInMethodsForEmail:null,isSignInWithEmailLink:null,getRedirectResult:null,languageCode:null,settings:null,onAuthStateChanged:null,onIdTokenChanged:null,sendSignInLinkToEmail:null,sendPasswordResetEmail:null,setPersistence:null,signInAndRetrieveDataWithCredential:null,signInAnonymously:null,signInWithCredential:null,signInWithCustomToken:null,signInWithEmailAndPassword:null,signInWithPhoneNumber:null,signInWithEmailLink:null,signInWithPopup:null,signInWithRedirect:null,signOut:null,tenantId:null,updateCurrentUser:null,useDeviceLanguage:null,useEmulator:null,verifyPasswordResetCode:null}]);var jV=function(){function e(t,n,r){Qp(this,e),this.ref=t,this.query=n,this.afs=r}return Kp(e,[{key:"stateChanges",value:function(e){var t=DV(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(Object(ky.a)(function(t){return t.filter(function(t){return e.indexOf(t.type)>-1})}))),t.pipe(G_(void 0),zS(),Ib(function(e){var t=Bp(e,2),n=t[0];return t[1].length>0||!n}),Object(ky.a)(function(e){var t=Bp(e,2);t[0];return t[1]}),this.afs.keepUnstableUntilFirst)}},{key:"auditTrail",value:function(e){return this.stateChanges(e).pipe(q_(function(e,t){return[].concat(Up(e),Up(t))},[]))}},{key:"snapshotChanges",value:function(e){var t=FV(e);return LV(this.query,t,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return MV(this.query,this.afs.schedulers.outsideAngular).pipe(Object(ky.a)(function(t){return t.payload.docs.map(function(t){return e.idField?Object.assign(Object.assign({},t.data()),Dp({},e.idField,t.id)):t.data()})}),this.afs.keepUnstableUntilFirst)}},{key:"get",value:function(e){return Object(by.a)(this.query.get(e)).pipe(Object($S.b)(this.afs.schedulers.insideAngular))}},{key:"add",value:function(e){return this.ref.add(e)}},{key:"doc",value:function(e){return new UV(this.ref.doc(e),this.afs)}}]),e}(),UV=function(){function e(t,n){Qp(this,e),this.ref=t,this.afs=n}return Kp(e,[{key:"set",value:function(e,t){return this.ref.set(e,t)}},{key:"update",value:function(e){return this.ref.update(e)}},{key:"delete",value:function(){return this.ref.delete()}},{key:"collection",value:function(e,t){var n=WV(this.ref.collection(e),t),r=n.ref,i=n.query;return new jV(r,i,this.afs)}},{key:"snapshotChanges",value:function(){return RV(this.ref,this.afs.schedulers.outsideAngular).pipe(G_(void 0),zS(),Object(ky.a)(function(e){var t=Bp(e,2),n=t[0],r=t[1];return r.exists?(null==n?void 0:n.exists)?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}})).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.snapshotChanges().pipe(Object(ky.a)(function(t){var n=t.payload;return e.idField?Object.assign(Object.assign({},n.data()),Dp({},e.idField,n.id)):n.data()}))}},{key:"get",value:function(e){return Object(by.a)(this.ref.get(e)).pipe(Object($S.b)(this.afs.schedulers.insideAngular))}}]),e}(),VV=function(){function e(t,n){Qp(this,e),this.query=t,this.afs=n}return Kp(e,[{key:"stateChanges",value:function(e){return e&&0!==e.length?DV(this.query,this.afs.schedulers.outsideAngular).pipe(Object(ky.a)(function(t){return t.filter(function(t){return e.indexOf(t.type)>-1})}),Ib(function(e){return e.length>0}),this.afs.keepUnstableUntilFirst):DV(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"auditTrail",value:function(e){return this.stateChanges(e).pipe(q_(function(e,t){return[].concat(Up(e),Up(t))},[]))}},{key:"snapshotChanges",value:function(e){var t=FV(e);return LV(this.query,t,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}},{key:"valueChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return MV(this.query,this.afs.schedulers.outsideAngular).pipe(Object(ky.a)(function(t){return t.payload.docs.map(function(t){return e.idField?Object.assign(Dp({},e.idField,t.id),t.data()):t.data()})}),this.afs.keepUnstableUntilFirst)}},{key:"get",value:function(e){return Object(by.a)(this.query.get(e)).pipe(Object($S.b)(this.afs.schedulers.insideAngular))}}]),e}(),zV=new Vp.r("angularfire2.enableFirestorePersistence"),HV=new Vp.r("angularfire2.firestore.persistenceSettings"),GV=new Vp.r("angularfire2.firestore.settings"),qV=new Vp.r("angularfire2.firestore.use-emulator");function WV(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return{query:t(e),ref:e}}var $V,ZV,QV=((ZV=function(){function e(t,n,r,i,o,a,s,u,c){Qp(this,e),this.schedulers=new US.d(a),this.keepUnstableUntilFirst=Object(US.h)(this.schedulers);var l=Object(US.g)(t,a,n);!ZS.a.auth&&c&&Object(US.j)();var h=u,f=Bp(Object(US.f)("".concat(l.name,".firestore"),"AngularFirestore",l,function(){var e=a.runOutsideAngular(function(){return l.firestore()});return i&&e.settings(i),h&&e.useEmulator.apply(e,Up(h)),r&&!Pg(o)?[e,a.runOutsideAngular(function(){try{return Object(by.a)(e.enablePersistence(s||void 0).then(function(){return!0},function(){return!1}))}catch(fV){return"undefined"!=typeof console&&console.warn(fV),Object(Eb.a)(!1)}})]:[e,Object(Eb.a)(!1)]},[i,h,r]),2);this.firestore=f[0],this.persistenceEnabled$=f[1]}return Kp(e,[{key:"collection",value:function(e,t){var n=WV("string"==typeof e?this.firestore.collection(e):e,t),r=n.ref,i=n.query,o=this.schedulers.ngZone.run(function(){return r});return new jV(o,i,this)}},{key:"collectionGroup",value:function(e,t){var n=t||function(e){return e},r=this.firestore.collectionGroup(e);return new VV(n(r),this)}},{key:"doc",value:function(e){var t;t="string"==typeof e?this.firestore.doc(e):e;var n=this.schedulers.ngZone.run(function(){return t});return new UV(n,this)}},{key:"createId",value:function(){return this.firestore.collection("_").doc().id}}]),e}()).\u0275fac=function(e){return new(e||ZV)(Vp.Zb(US.c),Vp.Zb(US.b,8),Vp.Zb(zV,8),Vp.Zb(GV,8),Vp.Zb(Vp.C),Vp.Zb(Vp.A),Vp.Zb(HV,8),Vp.Zb(qV,8),Vp.Zb(SV,8))},ZV.\u0275prov=Vp.Hb({factory:function(){return new ZV(Vp.Zb(US.c),Vp.Zb(US.b,8),Vp.Zb(zV,8),Vp.Zb(GV,8),Vp.Zb(Vp.C),Vp.Zb(Vp.A),Vp.Zb(HV,8),Vp.Zb(qV,8),Vp.Zb(SV,8))},token:ZV,providedIn:"any"}),ZV),YV=(($V=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"enablePersistence",value:function(t){return{ngModule:e,providers:[{provide:zV,useValue:!0},{provide:HV,useValue:t}]}}}]),e}()).\u0275fac=function(e){return new(e||$V)},$V.\u0275mod=Vp.Jb({type:$V}),$V.\u0275inj=Vp.Ib({providers:[QV]}),$V);function KV(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function JV(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){KV(o,r,i,a,s,"next",e)}function s(e){KV(o,r,i,a,s,"throw",e)}a(void 0)})}}var XV,ez=((XV=function(){function e(t,n){Qp(this,e),this.collectionName=t,this.afs=n}return Kp(e,[{key:"create",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.afs.collection(t.collectionName).add(Mp({},e));case 2:return n.abrupt("return",n.sent.id);case 3:case"end":return n.stop()}},n)}))()}},{key:"read",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.afs.collection(t.collectionName).doc(e).ref.get();case 2:return r=n.sent,n.abrupt("return",r.exists?kz.of(dz.getNonNullable(r.data())):kz.empty());case 4:case"end":return n.stop()}},n)}))()}},{key:"exists",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.read(e);case 2:return n.abrupt("return",n.sent.isPresent());case 3:case"end":return n.stop()}},n)}))()}},{key:"update",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.afs.collection(n.collectionName).doc(e).ref.update(t));case 1:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){return this.afs.collection(this.collectionName).doc(e).ref.delete()}},{key:"set",value:function(t,n){return pz(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),this.afs.collection(this.collectionName).doc(t).set(n)}},{key:"getObsById",value:function(e){return this.afs.doc(this.collectionName+"/"+e).snapshotChanges().pipe(Object(ky.a)(function(e){return kz.ofNullable(e.payload.data())}))}},{key:"findWhere",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.constructQuery(e),n.next=3,r.get();case 3:return n.abrupt("return",n.sent.docs.map(function(e){return{id:e.id,data:e.data()}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"observingWhere",value:function(t,n){var r=this;return this.constructQuery(t).onSnapshot(function(t){var i=[],o=[],a=[];t.docChanges().forEach(function(e){var t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":i.push(t);break;case"modified":o.push(t);break;case"removed":a.push(t)}}),i.length>0&&(pz(e.VERBOSE,"firebase gave us "+i.length+" NEW "+r.collectionName),n.onDocumentCreated(i)),o.length>0&&(pz(e.VERBOSE,"firebase gave us "+o.length+" MODIFIED "+r.collectionName),n.onDocumentModified(o)),a.length>0&&(pz(e.VERBOSE,"firebase gave us "+a.length+" DELETED "+r.collectionName),n.onDocumentDeleted(a))})}},{key:"constructQuery",value:function(e){vz(e.length>=1,"constructQuery called without conditions");var t,n=null,r=zp(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n=null==n?this.afs.collection(this.collectionName).ref.where(i[0],i[1],i[2]):n.where(i[0],i[1],i[2])}}catch(o){r.e(o)}finally{r.f()}return dz.getNonNullable(n)}}]),e}()).VERBOSE=!1,XV);function tz(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);for(var n=e,r=t,i=0,o=Object.keys(n);i<o.length;i++){var a=o[i];if(!(a in r))return!1;if(!1===tz(n[a],r[a]))return!1}return!0}return e===t}function nz(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(var t in e)if(null!=e[t]&&!1===nz(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function rz(e,t){if(nz(e)&&nz(t))return tz(e,t);throw new Error("Comparing non comparable objects: ".concat(e.constructor.name," and ").concat(t.constructor.name))}var iz,oz,az,sz=function(){function e(){Qp(this,e)}return Kp(e,[{key:"equals",value:function(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&rz(this.get(),e.get())}}],[{key:"success",value:function(e){return new uz(e)}},{key:"failure",value:function(e){return new cz(e)}}]),e}(),uz=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this)).value=e,r}return Kp(n,[{key:"isSuccess",value:function(){return!0}},{key:"isFailure",value:function(){return!1}},{key:"get",value:function(){return this.value}},{key:"getReason",value:function(){throw new Error("Cannot get failure reason from a success")}},{key:"getReasonOr",value:function(e){return e}},{key:"toOptional",value:function(){return kz.of(this.value)}},{key:"toString",value:function(){return"MGPFallible.success(".concat(this.value,")")}}]),n}(sz),cz=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this)).reason=e,r}return Kp(n,[{key:"isSuccess",value:function(){return!1}},{key:"isFailure",value:function(){return!0}},{key:"get",value:function(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}},{key:"getReason",value:function(){return this.reason}},{key:"getReasonOr",value:function(e){return this.getReason()}},{key:"toOptional",value:function(){return kz.empty()}},{key:"toString",value:function(){return"MGPFallible.failure(".concat(this.reason,")")}}]),n}(sz),lz=((az=function(){function e(t){Qp(this,e),this.reason=t}return Kp(e,[{key:"isFailure",value:function(){return!1===this.isSuccess()}},{key:"isSuccess",value:function(){return null==this.reason}},{key:"getReason",value:function(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}},{key:"toFallible",value:function(e){return this.isSuccess()?sz.success(e):sz.failure(this.getReason())}},{key:"toFailedFallible",value:function(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return sz.failure(this.getReason())}}],[{key:"ofFallible",value:function(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}},{key:"failure",value:function(t){return new e(t)}}]),e}()).SUCCESS=new az(null),az),hz=((oz=function(e){Jp(n,e);var t=ev(n);function n(e){return Qp(this,n),t.call(this,"errors",e)}return n}(ez)).\u0275fac=function(e){return new(e||oz)(Vp.Zb(QV))},oz.\u0275prov=Vp.Hb({token:oz,factory:oz.\u0275fac,providedIn:"root"}),oz),fz=((iz=function(){function e(t,n){Qp(this,e),this.errorDAO=t,this.router=n,e.setSingletonInstance(this)}return Kp(e,[{key:"logError",value:function(e,t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){var o,a,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o=r.router.url,i.next=3,r.errorDAO.findWhere([["component","==",e],["route","==",o],["message","==",t],["data","==",n]]);case 3:if(0!==(a=i.sent).length){i.next=10;break}return s={component:e,route:o,message:t,data:n,firstEncounter:ZS.a.firestore.FieldValue.serverTimestamp(),lastEncounter:ZS.a.firestore.FieldValue.serverTimestamp(),occurences:1},i.next=8,r.errorDAO.create(s);case 8:i.next=13;break;case 10:return u=a[0].id,c=a[0].data,i.next=13,r.errorDAO.update(u,{lastEncounter:ZS.a.firestore.FieldValue.serverTimestamp(),occurences:c.occurences+1});case 13:case"end":return i.stop()}},i)}))()}}],[{key:"setSingletonInstance",value:function(t){e.singleton=kz.of(t)}},{key:"logError",value:function(e,t,n){if(this.singleton.isAbsent())throw new Error("".concat(e,": ").concat(t," (extra data: ").concat(n,")"));return this.singleton.get().logError(e,t,n),lz.failure(e+": "+t)}}]),e}()).singleton=kz.empty(),iz.\u0275fac=function(e){return new(e||iz)(Vp.Zb(hz),Vp.Zb(VC))},iz.\u0275prov=Vp.Hb({token:iz,factory:iz.\u0275fac,providedIn:"root"}),iz),dz=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"expectToBe",value:function(e,t,n){if(e!==t){if(void 0!==n)throw new Error(n);throw new Error("A default switch case did not observe the correct value, expected ".concat(t,", but got ").concat(e," instead."))}}},{key:"expectToBeMultiple",value:function(e,t){var n,r=!1,i=zp(t);try{for(i.s();!(n=i.n()).done;){if(e===n.value){r=!0;break}}}catch(o){i.e(o)}finally{i.f()}if(!1===r)throw new Error("A default switch case did not observe the correct value, expected a value among ".concat(t,", but got ").concat(e," instead."))}},{key:"getNonNullable",value:function(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}]),e}();function pz(e,t){e&&console.log(t)}function vz(e,t){if(!1===e)throw fz.logError("Assertion failure",t),new Error("Assertion failure: ".concat(t))}var gz,yz,mz,bz=function e(){Qp(this,e)},_z=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"encode",value:function(e){return this.encodeMove(e)}},{key:"decode",value:function(e){return vz(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}],[{key:"disjunction3",value:function(e,t,r,i,o){return new(function(n){Jp(s,n);var a=ev(s);function s(){return Qp(this,s),a.apply(this,arguments)}return Kp(s,[{key:"encodeMove",value:function(n){return i(n)?{type:"T1",encoded:e.encode(n)}:o(n)?{type:"T2",encoded:t.encode(n)}:{type:"T3",encoded:r.encode(n)}}},{key:"decodeMove",value:function(n){var i=dz.getNonNullable(n).type,o=dz.getNonNullable(n).encoded;return"T1"===i?e.decode(o):"T2"===i?t.decode(o):r.decode(o)}}]),s}(n))}}]),n}(bz),wz=((gz=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"shift",value:function(){return this.maxValue()+1}},{key:"encodeMove",value:function(e){return this.encodeNumber(e)}},{key:"decodeMove",value:function(e){return vz("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}],[{key:"ofN",value:function(e,t,r){return new(function(n){Jp(o,n);var i=ev(o);function o(){return Qp(this,o),i.apply(this,arguments)}return Kp(o,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(e){return t(e)}},{key:"decodeNumber",value:function(e){return r(e)}}]),o}(n))}},{key:"tuple",value:function(e,t,r){return new(function(n){Jp(o,n);var i=ev(o);function o(){return Qp(this,o),i.apply(this,arguments)}return Kp(o,[{key:"maxValue",value:function(){var t=0;return Object.keys(e).forEach(function(n){t=t*e[n].shift()+e[n].maxValue()}),t}},{key:"encodeNumber",value:function(n){var r=t(n),i=0;return Object.keys(r).forEach(function(t){i=i*e[t].shift()+e[t].encode(r[t])}),i}},{key:"decodeNumber",value:function(t){var n={},i=t;return Object.keys(e).reverse().forEach(function(t){var r=i%e[t].shift();i=(i-r)/e[t].shift(),n[t]=e[t].decode(r)}),r(n)}}]),o}(n))}},{key:"disjunction",value:function(e,t,r){return new(function(n){Jp(o,n);var i=ev(o);function o(){return Qp(this,o),i.apply(this,arguments)}return Kp(o,[{key:"maxValue",value:function(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}},{key:"encodeNumber",value:function(n){return r(n)?2*e.encodeNumber(n):2*t.encodeNumber(n)+1}},{key:"decodeNumber",value:function(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}]),o}(n))}},{key:"numberEncoder",value:function(e){return new(function(t){Jp(r,t);var n=ev(r);function r(){return Qp(this,r),n.apply(this,arguments)}return Kp(r,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}},{key:"decodeNumber",value:function(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}]),r}(n))}}]),n}(_z)).booleanEncoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 1}},{key:"encodeNumber",value:function(e){return e?1:0}},{key:"decodeNumber",value:function(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}}]),n}(gz)),gz),kz=function(){function e(t){Qp(this,e),this.value=t}return Kp(e,[{key:"isPresent",value:function(){return null!=this.value}},{key:"isAbsent",value:function(){return null==this.value}},{key:"get",value:function(){if(this.isPresent())return this.value;throw new Error("Value is absent")}},{key:"getOrElse",value:function(e){return this.isPresent()?this.value:e}},{key:"equals",value:function(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&rz(this.value,e.value)}},{key:"equalsValue",value:function(t){return this.equals(e.of(t))}},{key:"toString",value:function(){return this.isAbsent()?"MGPOptional.empty()":"MGPOptional.of(".concat(this.value,")")}},{key:"map",value:function(t){return this.isPresent()?e.of(t(this.get())):e.empty()}}],[{key:"encoder",value:function(t){return new(function(n){Jp(i,n);var r=ev(i);function i(){return Qp(this,i),r.apply(this,arguments)}return Kp(i,[{key:"encode",value:function(e){return e.isPresent()?t.encode(e.get()):null}},{key:"decode",value:function(n){return null===n?e.empty():e.of(t.decode(n))}}]),i}(bz))}},{key:"of",value:function(t){return new e(t)}},{key:"ofNullable",value:function(t){return null==t?e.empty():e.of(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),Cz=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"getNavigatorLanguage",value:function(){return navigator.language}},{key:"getLocale",value:function(){var t=(localStorage.getItem("locale")||e.getNavigatorLanguage()||"fr").slice(0,2).toLowerCase();return["en","fr"].some(function(e){return e===t})?t:"fr"}}]),e}(),Ez=((mz=function(){function e(){Qp(this,e)}return Kp(e,[{key:"changeTheme",value:function(e){localStorage.setItem("theme",e)}},{key:"getTheme",value:function(){return kz.ofNullable(localStorage.getItem("theme"))}},{key:"changeLanguage",value:function(e){localStorage.setItem("locale",e.toLowerCase())}},{key:"getLanguage",value:function(){return Cz.getLocale()}}]),e}()).\u0275fac=function(e){return new(e||mz)},mz.\u0275prov=Vp.Hb({token:mz,factory:mz.\u0275fac,providedIn:"root"}),mz),Oz=((yz=function(){function e(t,n){Qp(this,e),this.document=t,this.userSettingsService=n,this.availableThemes=["dark","light"];var r=this.getStoredTheme();r.isPresent()?this.loadTheme(r.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}return Kp(e,[{key:"getStoredTheme",value:function(){var e=this.userSettingsService.getTheme();if(e.isPresent()){var t=e.get();if(this.availableThemes.some(function(e){return e===t}))return kz.of(t)}return kz.empty()}},{key:"loadTheme",value:function(e){this.loadStyle(e+".css"),this.theme=e}},{key:"loadStyle",value:function(e){var t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{var r=this.document.createElement("link");r.id="theme",r.rel="stylesheet",r.href="".concat(e),t.appendChild(r)}}},{key:"getTheme",value:function(){return this.theme}}]),e}()).\u0275fac=function(e){return new(e||yz)(Vp.Zb(Zp),Vp.Zb(Ez))},yz.\u0275prov=Vp.Hb({token:yz,factory:yz.\u0275fac,providedIn:"root"}),yz),Sz={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},Pz={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},Iz={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},Tz={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},Az={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},Nz={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]};jp("6nsN"),jp("6Uf2");var xz,Rz,Mz,Dz,Lz=((Dz=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,n.COLLECTION_NAME,e)).afs=e,pz(n.VERBOSE,"JoueursDAO.constructor"),r}return Kp(n,[{key:"usernameIsAvailable",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.afs.collection(n.COLLECTION_NAME).ref.where("username","==",e).limit(1).get();case 2:return r.abrupt("return",r.sent.empty);case 3:case"end":return r.stop()}},r)}))()}},{key:"setUsername",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.update(e,{username:t});case 2:case"end":return r.stop()}},r)}))()}},{key:"markVerified",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.update(e,{verified:!0});case 2:case"end":return n.stop()}},n)}))()}},{key:"observeUserByUsername",value:function(e,t){return this.observingWhere([["username","==",e],["verified","==",!0]],t)}},{key:"observeActiveUsers",value:function(e){return this.observingWhere([["state","==","online"],["verified","==",!0]],e)}}]),n}(ez)).VERBOSE=!1,Dz.COLLECTION_NAME="joueurs",Dz.\u0275fac=function(e){return new(e||Dz)(Vp.Zb(QV))},Dz.\u0275prov=Vp.Hb({token:Dz,factory:Dz.\u0275fac,providedIn:"root"}),Dz),Bz=((Mz=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"setOffline",value:function(t){return ZS.a.database().ref("/status/"+t).set(e.OFFLINE)}},{key:"updatePresence",value:function(t){return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=ZS.a.database().ref("/status/"+t),ZS.a.database().ref(".info/connected").on("value",function(){var t=JV(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=!1!==n.val(),!t.t0){t.next=4;break}return t.next=4,r.onDisconnect().set(e.OFFLINE).then(JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.set(e.ONLINE);case 2:case"end":return t.stop()}},t)})));case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return n.stop()}},n)}))()}}]),e}()).OFFLINE={state:"offline",last_changed:ZS.a.database.ServerValue.TIMESTAMP},Mz.ONLINE={state:"online",last_changed:ZS.a.database.ServerValue.TIMESTAMP},Mz),Fz=((Rz=function(){function e(t,n,r){Qp(this,e),this.email=t,this.username=n,this.verified=r}return Kp(e,[{key:"isConnected",value:function(){return this.email.isPresent()}}]),e}()).NOT_CONNECTED=new Rz(kz.empty(),kz.empty(),!1),Rz),jz=((xz=function(){function l(e,t){Qp(this,l);var n,r=this;this.afAuth=e,this.userDAO=t,this.registrationInProgress=kz.empty(),pz(l.VERBOSE,"1 authService subscribe to Obs<User>"),this.userRS=new _V(1),this.userObs=this.userRS.asObservable(),this.authSub=this.afAuth.user.subscribe((n=JV(regeneratorRuntime.mark(function e(n){var i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=n){e.next=4;break}pz(l.VERBOSE,"User is not connected"),r.userRS.next(Fz.NOT_CONNECTED),e.next=22;break;case 4:if(e.t0=r.registrationInProgress.isPresent(),!e.t0){e.next=9;break}return e.next=8,r.registrationInProgress.get();case 8:r.registrationInProgress=kz.empty();case 9:return e.next=11,Bz.updatePresence(n.uid);case 11:return e.next=13,t.read(n.uid);case 13:if(i=e.sent.get(),pz(l.VERBOSE,"User ".concat(i.username," is connected, and the verified status is ").concat(r.emailVerified(n))),o=!0===r.emailVerified(n)&&null!=i.username,e.t1=!0===o&&!1===i.verified,!e.t1){e.next=20;break}return e.next=20,t.markVerified(n.uid);case 20:a=new Fz(kz.ofNullable(n.email),kz.ofNullable(i.username),o),r.user=kz.of(a),r.userRS.next(a);case 22:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}))}return Kp(l,[{key:"emailVerified",value:function(e){return e.emailVerified}},{key:"sendPasswordResetEmail",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ZS.a.auth().sendPasswordResetEmail(e);case 3:return n.abrupt("return",lz.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.t1=lz,n.next=11,t.mapFirebaseError(n.t0);case 11:return n.t2=n.sent,n.abrupt("return",n.t1.failure.call(n.t1,n.t2));case 13:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"doRegister",value:function(t,n,r){var i=this;return JV(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return pz(l.VERBOSE,"AuthenticationService.doRegister("+n+")"),o.next=3,i.userDAO.usernameIsAvailable(t);case 3:if(!o.sent){o.next=7;break}o.t0=(i.registrationInProgress=kz.of(i.registerAfterUsernameCheck(t,n,r)),i.registrationInProgress.get()),o.next=8;break;case 7:o.t0=sz.failure($localize(e||(e=xp(["This username is already in use."]))));case 8:return o.abrupt("return",o.t0);case 9:case"end":return o.stop()}},o)}))()}},{key:"registerAfterUsernameCheck",value:function(e,t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){var o,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,ZS.a.auth().createUserWithEmailAndPassword(t,n);case 3:return o=i.sent,a=dz.getNonNullable(o.user),i.next=7,r.createUser(a.uid,e);case 7:return i.abrupt("return",sz.success(a));case 10:return i.prev=10,i.t0=i.catch(0),i.t1=sz,i.next=15,r.mapFirebaseError(i.t0);case 15:return i.t2=i.sent,i.abrupt("return",i.t1.failure.call(i.t1,i.t2));case 17:case"end":return i.stop()}},i,null,[[0,10]])}))()}},{key:"mapFirebaseError",value:function(e){switch(e.code){case"auth/email-already-in-use":return $localize(t||(t=xp(["This email address is already in use."])));case"auth/invalid-email":return $localize(n||(n=xp(["This email address is invalid."])));case"auth/user-not-found":case"auth/wrong-password":return $localize(r||(r=xp(["You have entered invalid credentials."])));case"auth/invalid-credential":return $localize(i||(i=xp(["The credential is invalid or has expired, please try again."])));case"auth/weak-password":return $localize(o||(o=xp(["Your password is too weak, please use a stronger password."])));case"auth/too-many-requests":return $localize(a||(a=xp(["There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later."])));case"auth/popup-closed-by-user":return $localize(s||(s=xp(["You closed the authentication popup without finalizing your log in."])));default:return fz.logError("AuthenticationService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}},{key:"sendEmailVerification",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(pz(l.VERBOSE,"AuthenticationService.sendEmailVerification()"),(n=kz.ofNullable(ZS.a.auth().currentUser)).isPresent()){t.next=4;break}return t.abrupt("return",fz.logError("AuthenticationService","Unlogged users cannot request for email verification"));case 4:if(!e.emailVerified(n.get())){t.next=6;break}return t.abrupt("return",fz.logError("AuthenticationService","Verified users should not ask email verification after being verified"));case 6:return t.prev=6,t.next=9,n.get().sendEmailVerification();case 9:return t.abrupt("return",lz.SUCCESS);case 12:return t.prev=12,t.t0=t.catch(6),t.abrupt("return",lz.failure(e.mapFirebaseError(t.t0)));case 15:case"end":return t.stop()}},t,null,[[6,12]])}))()}},{key:"doEmailLogin",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return pz(l.VERBOSE,"AuthenticationService.doEmailLogin("+e+")"),r.prev=1,r.next=4,ZS.a.auth().signInWithEmailAndPassword(e,t);case 4:return r.abrupt("return",lz.SUCCESS);case 7:return r.prev=7,r.t0=r.catch(1),r.t1=lz,r.next=12,n.mapFirebaseError(r.t0);case 12:return r.t2=r.sent,r.abrupt("return",r.t1.failure.call(r.t1,r.t2));case 14:case"end":return r.stop()}},r,null,[[1,7]])}))()}},{key:"createUser",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=vz,r.t1=!1,r.next=4,n.userDAO.exists(e);case 4:if(r.t2=r.sent,r.t3=r.t1===r.t2,(0,r.t0)(r.t3,"createUser should only be called for new users"),null!=t){r.next=12;break}return r.next=10,n.userDAO.set(e,{verified:!1});case 10:r.next=14;break;case 12:return r.next=14,n.userDAO.set(e,{username:t,verified:!1});case 14:case"end":return r.stop()}},r)}))()}},{key:"doGoogleLogin",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.registrationInProgress=kz.of(e.registerOrLoginWithGoogle()),t.next=3,e.registrationInProgress.get();case 3:return n=t.sent,t.abrupt("return",lz.ofFallible(n));case 5:case"end":return t.stop()}},t)}))()}},{key:"registerOrLoginWithGoogle",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new ZS.a.auth.GoogleAuthProvider).addScope("profile"),n.addScope("email"),t.next=5,e.afAuth.signInWithPopup(n);case 5:return r=t.sent,i=dz.getNonNullable(r.user),t.next=9,e.createUser(i.uid);case 9:return t.abrupt("return",sz.success(i));case 12:return t.prev=12,t.t0=t.catch(0),t.t1=sz,t.next=17,e.mapFirebaseError(t.t0);case 17:return t.t2=t.sent,t.abrupt("return",t.t1.failure.call(t.t1,t.t2));case 19:case"end":return t.stop()}},t,null,[[0,12]])}))()}},{key:"disconnect",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=kz.ofNullable(ZS.a.auth().currentUser)).isPresent()){t.next=8;break}return r=n.get().uid,t.next=5,Bz.setOffline(r);case 5:return t.next=7,e.afAuth.signOut();case 7:return t.abrupt("return",lz.SUCCESS);case 8:return t.abrupt("return",lz.failure("Cannot disconnect a non-connected user"));case 9:case"end":return t.stop()}},t)}))()}},{key:"getUserObs",value:function(){return this.userObs}},{key:"setUsername",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e){n.next=2;break}return n.abrupt("return",lz.failure($localize(u||(u=xp(["Your username may not be empty."])))));case 2:return n.prev=2,n.t0=!1,n.next=6,t.userDAO.usernameIsAvailable(e);case 6:if(n.t1=n.sent,n.t0!==n.t1){n.next=9;break}return n.abrupt("return",lz.failure($localize(c||(c=xp(["This username is already in use, please select a different one."])))));case 9:return r=dz.getNonNullable(ZS.a.auth().currentUser),n.next=12,r.updateProfile({displayName:e});case 12:return n.next=14,t.userDAO.setUsername(r.uid,e);case 14:return n.next=16,t.userDAO.markVerified(r.uid);case 16:return n.next=18,t.reloadUser();case 18:return n.abrupt("return",lz.SUCCESS);case 21:return n.prev=21,n.t2=n.catch(2),n.t3=lz,n.next=26,t.mapFirebaseError(n.t2);case 26:return n.t4=n.sent,n.abrupt("return",n.t3.failure.call(n.t3,n.t4));case 28:case"end":return n.stop()}},n,null,[[2,21]])}))()}},{key:"setPicture",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,dz.getNonNullable(ZS.a.auth().currentUser).updateProfile({photoURL:e});case 3:return n.abrupt("return",lz.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.t1=lz,n.next=11,t.mapFirebaseError(n.t0);case 11:return n.t2=n.sent,n.abrupt("return",n.t1.failure.call(n.t1,n.t2));case 13:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"reloadUser",value:function(){return JV(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=dz.getNonNullable(ZS.a.auth().currentUser),e.next=3,t.getIdToken(!0);case 3:return e.next=5,t.reload();case 5:case"end":return e.stop()}},e)}))()}},{key:"ngOnDestroy",value:function(){this.authSub.unsubscribe()}}]),l}()).VERBOSE=!1,xz.\u0275fac=function(e){return new(e||xz)(Vp.Zb(xV),Vp.Zb(Lz))},xz.\u0275prov=Vp.Hb({token:xz,factory:xz.\u0275fac,providedIn:"root"}),xz);function Uz(e){return(Uz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vz(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zz(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Vz(e,t,n[t])})}return e}function Hz(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Gz={},qz={};try{"undefined"!=typeof window&&(Gz=window),"undefined"!=typeof document&&(qz=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(fV){}var Wz=(Gz.navigator||{}).userAgent,$z=void 0===Wz?"":Wz,Zz=Gz,Qz=qz,Yz=!!Qz.documentElement&&!!Qz.head&&"function"==typeof Qz.addEventListener&&"function"==typeof Qz.createElement,Kz=(~$z.indexOf("MSIE")||$z.indexOf("Trident/"),[1,2,3,4,5,6,7,8,9,10]),Jz=Kz.concat([11,12,13,14,15,16,17,18,19,20]),Xz={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},eH=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",Xz.GROUP,Xz.SWAP_OPACITY,Xz.PRIMARY,Xz.SECONDARY].concat(Kz.map(function(e){return"".concat(e,"x")})).concat(Jz.map(function(e){return"w-".concat(e)})),Zz.FontAwesomeConfig||{});Qz&&"function"==typeof Qz.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=Hz(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=Qz.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(eH[n]=r)});var tH=zz({},{familyPrefix:"fa",replacementClass:"svg-inline--fa",autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},eH);tH.autoReplaceSvg||(tH.observeMutations=!1);var nH=zz({},tH);Zz.FontAwesomeConfig=nH;var rH=Zz||{};rH.___FONT_AWESOME___||(rH.___FONT_AWESOME___={}),rH.___FONT_AWESOME___.styles||(rH.___FONT_AWESOME___.styles={}),rH.___FONT_AWESOME___.hooks||(rH.___FONT_AWESOME___.hooks={}),rH.___FONT_AWESOME___.shims||(rH.___FONT_AWESOME___.shims=[]);var iH=rH.___FONT_AWESOME___,oH=[];Yz&&((Qz.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Qz.readyState)||Qz.addEventListener("DOMContentLoaded",function e(){Qz.removeEventListener("DOMContentLoaded",e),oH.map(function(e){return e()})}));var aH,sH=function(){},uH="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,cH="undefined"==typeof setImmediate?setTimeout:setImmediate,lH=[];function hH(){for(var e=0;e<lH.length;e++)lH[e][0](lH[e][1]);lH=[],aH=!1}function fH(e,t){lH.push([e,t]),aH||(aH=!0,cH(hH,0))}function dH(e){var t=e.owner,n=t._state,r=t._data,i=e[n],o=e.then;if("function"==typeof i){n="fulfilled";try{r=i(r)}catch(fV){yH(o,fV)}}pH(o,r)||("fulfilled"===n&&vH(o,r),"rejected"===n&&yH(o,r))}function pH(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===Uz(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?gH(e,r):vH(e,r))},function(t){n||(n=!0,yH(e,t))}),!0}}catch(fV){return n||yH(e,fV),!0}return!1}function vH(e,t){e!==t&&pH(e,t)||gH(e,t)}function gH(e,t){"pending"===e._state&&(e._state="settled",e._data=t,fH(bH,e))}function yH(e,t){"pending"===e._state&&(e._state="settled",e._data=t,fH(_H,e))}function mH(e){e._then=e._then.forEach(dH)}function bH(e){e._state="fulfilled",mH(e)}function _H(e){e._state="rejected",mH(e),!e._handled&&uH&&global.process.emit("unhandledRejection",e._data,e)}function wH(e){global.process.emit("rejectionHandled",e)}function kH(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(this instanceof kH==0)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){yH(t,e)}try{e(function(e){vH(t,e)},n)}catch(fV){n(fV)}}(e,this)}kH.prototype={constructor:kH,_state:"pending",_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(sH),fulfilled:e,rejected:t};return!t&&!e||this._handled||(this._handled=!0,"rejected"===this._state&&uH&&fH(wH,this)),"fulfilled"===this._state||"rejected"===this._state?fH(dH,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},kH.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new kH(function(t,n){var r=[],i=0;function o(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var a,s=0;s<e.length;s++)(a=e[s])&&"function"==typeof a.then?a.then(o(s),n):r[s]=a;i||t(r)})},kH.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new kH(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},kH.resolve=function(e){return e&&"object"===Uz(e)&&e.constructor===kH?e:new kH(function(t){t(e)})},kH.reject=function(e){return new kH(function(t,n){n(e)})};var CH={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function EH(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function OH(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function SH(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function PH(e){return e.size!==CH.size||e.x!==CH.x||e.y!==CH.y||e.rotate!==CH.rotate||e.flipX||e.flipY}function IH(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),o="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),a="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(o," ").concat(a)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var TH={x:0,y:0,width:"100%",height:"100%"};function AH(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function NH(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,o=e.iconName,a=e.transform,s=e.symbol,u=e.title,c=e.maskId,l=e.titleId,h=e.extra,f=e.watchable,d=void 0!==f&&f,p=r.found?r:n,v=p.width,g=p.height,y="fak"===i,m=y?"":"fa-w-".concat(Math.ceil(v/g*16)),b=[nH.replacementClass,o?"".concat(nH.familyPrefix,"-").concat(o):"",m].filter(function(e){return-1===h.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(h.classes).join(" "),_={children:[],attributes:zz({},h.attributes,{"data-prefix":i,"data-icon":o,class:b,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(v," ").concat(g)})},w=y&&!~h.classes.indexOf("fa-fw")?{width:"".concat(v/g*16*.0625,"em")}:{};d&&(_.attributes["data-fa-i2svg"]=""),u&&_.children.push({tag:"title",attributes:{id:_.attributes["aria-labelledby"]||"title-".concat(l||EH())},children:[u]});var k=zz({},_,{prefix:i,iconName:o,main:n,mask:r,maskId:c,transform:a,symbol:s,styles:zz({},w,h.styles)}),C=r.found&&n.found?function(e){var t,n=e.children,r=e.attributes,i=e.main,o=e.mask,a=e.maskId,s=i.icon,u=o.icon,c=IH({transform:e.transform,containerWidth:o.width,iconWidth:i.width}),l={tag:"rect",attributes:zz({},TH,{fill:"white"})},h=s.children?{children:s.children.map(AH)}:{},f={tag:"g",attributes:zz({},c.inner),children:[AH(zz({tag:s.tag,attributes:zz({},s.attributes,c.path)},h))]},d={tag:"g",attributes:zz({},c.outer),children:[f]},p="mask-".concat(a||EH()),v="clip-".concat(a||EH()),g={tag:"mask",attributes:zz({},TH,{id:p,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[l,d]},y={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:(t=u,"g"===t.tag?t.children:[t])},g]};return n.push(y,{tag:"rect",attributes:zz({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(p,")")},TH)}),{children:n,attributes:r}}(k):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,o=SH(e.styles);if(o.length>0&&(n.style=o),PH(i)){var a=IH({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:zz({},a.outer),children:[{tag:"g",attributes:zz({},a.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:zz({},r.icon.attributes,a.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(k),E=C.attributes;return k.children=C.children,k.attributes=E,s?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:zz({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(nH.familyPrefix,"-").concat(t):r}),children:n}]}]}(k):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,o=e.styles,a=e.transform;if(PH(a)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=SH(zz({},o,{"transform-origin":"".concat(s.x+a.x/16,"em ").concat(s.y+a.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(k)}var xH=function(e,t,n,r){var i,o,a,s=Object.keys(e),u=s.length,c=void 0!==r?function(e,t){return function(n,r,i,o){return e.call(t,n,r,i,o)}}(t,r):t;for(void 0===n?(i=1,a=e[s[0]]):(i=0,a=n);i<u;i++)a=c(a,e[o=s[i]],o,e);return a};function RH(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,o=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof iH.hooks.addPack||i?iH.styles[e]=zz({},iH.styles[e]||{},o):iH.hooks.addPack(e,o),"fas"===e&&RH("fa",t)}var MH=iH.styles,DH=iH.shims,LH=function(){var e=function(e){return xH(MH,function(t,n,r){return t[r]=xH(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in MH;xH(DH,function(e,n){var r=n[1];return"far"!==r||t||(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function BH(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function FH(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,o=void 0===i?[]:i;return"string"==typeof e?OH(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(OH(e[n]),'" ')},"").trim()}(r),">").concat(o.map(FH).join(""),"</").concat(t,">")}function jH(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}LH(),(jH.prototype=Object.create(Error.prototype)).constructor=jH;var UH={fill:"currentColor"},VH={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},zH=(zz({},UH,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),zz({},VH,{attributeName:"opacity"}));function HH(e){var t=e[0],n=e[1],r=Hz(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(nH.familyPrefix,"-").concat(Xz.GROUP)},children:[{tag:"path",attributes:{class:"".concat(nH.familyPrefix,"-").concat(Xz.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(nH.familyPrefix,"-").concat(Xz.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}function GH(){nH.autoAddCss&&!tG&&(function(e){if(e&&Yz){var t=Qz.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=Qz.head.childNodes,r=null,i=n.length-1;i>-1;i--){var o=n[i],a=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(a)>-1&&(r=o)}Qz.head.insertBefore(t,r)}}(function(){var e="svg-inline--fa",t=nH.familyPrefix,n=nH.replacementClass,r='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if("fa"!==t||n!==e){var i=new RegExp("\\.".concat("fa","\\-"),"g"),o=new RegExp("\\--".concat("fa","\\-"),"g"),a=new RegExp("\\.".concat(e),"g");r=r.replace(i,".".concat(t,"-")).replace(o,"--".concat(t,"-")).replace(a,".".concat(n))}return r}()),tG=!0)}function qH(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return FH(e)})}}),Object.defineProperty(e,"node",{get:function(){if(Yz){var t=Qz.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function WH(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return BH(eG.definitions,n,r)||BH(iH.styles,n,r)}zz({},UH,{cx:"256",cy:"364",r:"28"}),zz({},VH,{attributeName:"r",values:"28;14;28;28;14;28;"}),zz({},zH,{values:"1;0;1;1;0;1;"}),zz({},UH,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),zz({},zH,{values:"1;0;0;0;0;1;"}),zz({},UH,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),zz({},zH,{values:"0;0;1;1;0;0;"});var $H,ZH,QH,YH,KH,JH,XH,eG=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.definitions={}}var t;return(t=[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=zz({},e.definitions[t]||{},i[t]),RH(t,i[t]),LH()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,o=r.iconName,a=r.icon;e[i]||(e[i]={}),e[i][o]=a}),e}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}()),tG=!1,nG=($H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?CH:n,i=t.symbol,o=void 0!==i&&i,a=t.mask,s=void 0===a?null:a,u=t.maskId,c=void 0===u?null:u,l=t.title,h=void 0===l?null:l,f=t.titleId,d=void 0===f?null:f,p=t.classes,v=void 0===p?[]:p,g=t.attributes,y=void 0===g?{}:g,m=t.styles,b=void 0===m?{}:m;if(e){var _=e.prefix,w=e.iconName,k=e.icon;return qH(zz({type:"icon"},e),function(){return GH(),nH.autoA11y&&(h?y["aria-labelledby"]="".concat(nH.replacementClass,"-title-").concat(d||EH()):(y["aria-hidden"]="true",y.focusable="false")),NH({icons:{main:HH(k),mask:s?HH(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:_,iconName:w,transform:zz({},CH,r),symbol:o,title:h,maskId:c,titleId:d,extra:{attributes:y,styles:b,classes:v}})})}},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e||{}).icon?e:WH(e||{}),r=t.mask;return r&&(r=(r||{}).icon?r:WH(r||{})),$H(n,zz({},t,{mask:r}))}),rG=["*"],iG=((QH=function e(){Qp(this,e),this.defaultPrefix="fas",this.fallbackIcon=null,this.globalLibrary=!1}).\u0275fac=function(e){return new(e||QH)},QH.\u0275prov=Object(Vp.Hb)({factory:function(){return new QH},token:QH,providedIn:"root"}),QH),oG=((ZH=function(){function e(){Qp(this,e),this.definitions={}}return Kp(e,[{key:"addIcons",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r];o.prefix in this.definitions||(this.definitions[o.prefix]={}),this.definitions[o.prefix][o.iconName]=o}}},{key:"addIconPacks",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=a[o],n=Object.keys(t).map(function(e){return t[e]});e.addIcons.apply(e,Up(n))},o=0,a=n;o<a.length;o++)i()}},{key:"getIconDefinition",value:function(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}]),e}()).\u0275fac=function(e){return new(e||ZH)},ZH.\u0275prov=Object(Vp.Hb)({factory:function(){return new ZH},token:ZH,providedIn:"root"}),ZH),aG=((XH=function(){function e(){Qp(this,e),this.stackItemSize="1x"}return Kp(e,[{key:"ngOnChanges",value:function(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}]),e}()).\u0275fac=function(e){return new(e||XH)},XH.\u0275dir=Vp.Gb({type:XH,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[Vp.zb]}),XH),sG=((JH=function(){function e(t,n){Qp(this,e),this.renderer=t,this.elementRef=n}return Kp(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}},{key:"ngOnChanges",value:function(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,"fa-".concat(e.size.currentValue)),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,"fa-".concat(e.size.previousValue)))}}]),e}()).\u0275fac=function(e){return new(e||JH)(Vp.Lb(Vp.E),Vp.Lb(Vp.l))},JH.\u0275cmp=Vp.Fb({type:JH,selectors:[["fa-stack"]],inputs:{size:"size"},features:[Vp.zb],ngContentSelectors:rG,decls:1,vars:0,template:function(e,t){1&e&&(Vp.lc(),Vp.kc(0))},encapsulation:2}),JH),uG=((KH=function(){function e(t,n,r,i,o){Qp(this,e),this.sanitizer=t,this.config=n,this.iconLibrary=r,this.stackItem=i,this.classes=[],null!=o&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}return Kp(e,[{key:"ngOnChanges",value:function(e){if(null==this.icon&&null==this.config.fallbackIcon)return function(){throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")}();var t;if(t=null==this.icon?this.config.fallbackIcon:this.icon,e){var n=this.findIconDefinition(t);if(null!=n){var r=this.buildParams();this.renderIcon(n,r)}}}},{key:"render",value:function(){this.ngOnChanges({})}},{key:"findIconDefinition",value:function(e){var t=function(e,t){return void 0!==(n=e).prefix&&void 0!==n.iconName?e:Array.isArray(e)&&2===e.length?{prefix:e[0],iconName:e[1]}:"string"==typeof e?{prefix:t,iconName:e}:void 0;var n}(e,this.config.defaultPrefix);if("icon"in t)return t;var n=this.iconLibrary.getIconDefinition(t.prefix,t.iconName);if(null!=n)return n;var r=WH(t);if(null!=r){var i="Global icon library is deprecated. Consult https://github.com/FortAwesome/angular-fontawesome/blob/master/UPGRADING.md for the migration instructions.";if("unset"===this.config.globalLibrary)console.error("FontAwesome: "+i);else if(!this.config.globalLibrary)throw new Error(i);return r}return function(e){throw new Error("Could not find icon with iconName=".concat(e.iconName," and prefix=").concat(e.prefix," in the icon library."))}(t),null}},{key:"buildParams",value:function(){var e,t,n,r,i,o={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},a="string"==typeof this.transform?(e=this.transform,t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0},e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t):this.transform;return{title:this.title,transform:a,classes:[].concat(Up((n=o,Dp(r={"fa-spin":n.spin,"fa-pulse":n.pulse,"fa-fw":n.fixedWidth,"fa-border":n.border,"fa-inverse":n.inverse,"fa-layers-counter":n.counter,"fa-flip-horizontal":"horizontal"===n.flip||"both"===n.flip,"fa-flip-vertical":"vertical"===n.flip||"both"===n.flip},"fa-".concat(n.size),null!==n.size),Dp(r,"fa-rotate-".concat(n.rotate),null!==n.rotate),Dp(r,"fa-pull-".concat(n.pull),null!==n.pull),Dp(r,"fa-stack-".concat(n.stackItemSize),null!=n.stackItemSize),i=r,Object.keys(i).map(function(e){return i[e]?e:null}).filter(function(e){return e}))),Up(this.classes)),mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}},{key:"renderIcon",value:function(e,t){var n=nG(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}]),e}()).\u0275fac=function(e){return new(e||KH)(Vp.Lb(dy),Vp.Lb(iG),Vp.Lb(oG),Vp.Lb(aG,8),Vp.Lb(sG,8))},KH.\u0275cmp=Vp.Fb({type:KH,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(Vp.Tb("innerHTML",t.renderedIconHTML,Vp.xc),Vp.Cb("title",t.title))},inputs:{classes:"classes",icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",transform:"transform",a11yRole:"a11yRole"},features:[Vp.zb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),KH),cG=((YH=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||YH)},YH.\u0275mod=Vp.Jb({type:YH}),YH.\u0275inj=Vp.Ib({}),YH);function lG(e,t){if(1&e){var n=Vp.Rb();Vp.Ob(0),Vp.Qb(1,"div",9),Vp.Qb(2,"a",10),Vp.Cc(3),Vp.Pb(),Vp.Qb(4,"div",12),Vp.Qb(5,"a",24),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().logout()}),Vp.Ub(6,25),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Nb()}if(2&e){var r=Vp.fc();Vp.Bb(3),Vp.Dc(r.username)}}var hG=function(){return["/register"]},fG=function(){return["/login"]};function dG(e,t){1&e&&(Vp.Qb(0,"div",26),Vp.Qb(1,"a",27),Vp.Qb(2,"strong"),Vp.Ub(3,28),Vp.Pb(),Vp.Pb(),Vp.Qb(4,"a",29),Vp.Ub(5,30),Vp.Pb(),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("routerLink",Vp.qc(2,hG)),Vp.Bb(3),Vp.mc("routerLink",Vp.qc(3,fG)))}var pG,vG,gG,yG,mG,bG,_G,wG,kG,CG,EG,OG,SG,PG=function(){return["/"]},IG=function(){return["/play"]},TG=function(){return["/lobby"]},AG=function(){return["/local"]},NG=function(){return["/tutorial"]},xG=function(){return["/settings"]},RG=((vG=function(){function e(t,n){Qp(this,e),this.router=t,this.authenticationService=n,this.username="connecting...",this.faCog=Pz,this.showMenu=!1}return Kp(e,[{key:"ngOnInit",value:function(){var e=this;this.userSub=this.authenticationService.getUserObs().subscribe(function(t){e.username=t.username.isPresent()?t.username.get():t.email.isPresent()?t.email.get():""})}},{key:"logout",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authenticationService.disconnect();case 2:return t.next=4,e.router.navigate(["/"]);case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||vG)(Vp.Lb(VC),Vp.Lb(jz))},vG.\u0275cmp=Vp.Fb({type:vG,selectors:[["app-header"]],decls:35,vars:19,consts:function(){return[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],$localize(l||(l=xp(["Home"]))),[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],$localize(h||(h=xp(["Play online"]))),[1,"navbar-dropdown"],$localize(f||(f=xp(["Create a game"]))),$localize(d||(d=xp(["Join a game"]))),$localize(p||(p=xp(["Play offline"]))),$localize(v||(v=xp(["Create a game"]))),$localize(g||(g=xp(["Learn the rules"]))),[1,"navbar-end"],["data-tooltip",$localize(y||(y=xp(["Settings"]))),1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["connect",""],["id","logout",1,"navbar-item",3,"click"],$localize(m||(m=xp(["Log out"]))),[1,"buttons"],[1,"button","is-primary",3,"routerLink"],$localize(b||(b=xp(["Register"]))),[1,"button","is-light",3,"routerLink"],$localize(_||(_=xp(["Log in"])))]},template:function(e,t){if(1&e&&(Vp.Qb(0,"nav",0),Vp.Qb(1,"div",1),Vp.Qb(2,"a",2),Vp.Mb(3,"img",3),Vp.Pb(),Vp.Qb(4,"a",4),Vp.cc("click",function(){return t.showMenu=!t.showMenu}),Vp.Mb(5,"span",5),Vp.Mb(6,"span",5),Vp.Mb(7,"span",5),Vp.Pb(),Vp.Pb(),Vp.Qb(8,"div",6),Vp.cc("click",function(){return t.showMenu=!t.showMenu}),Vp.Qb(9,"div",7),Vp.Qb(10,"a",2),Vp.Ub(11,8),Vp.Pb(),Vp.Qb(12,"div",9),Vp.Qb(13,"a",10),Vp.Ub(14,11),Vp.Pb(),Vp.Qb(15,"div",12),Vp.Qb(16,"a",2),Vp.Ub(17,13),Vp.Pb(),Vp.Qb(18,"a",2),Vp.Ub(19,14),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(20,"div",9),Vp.Qb(21,"a",10),Vp.Ub(22,15),Vp.Pb(),Vp.Qb(23,"div",12),Vp.Qb(24,"a",2),Vp.Ub(25,16),Vp.Pb(),Vp.Qb(26,"a",2),Vp.Ub(27,17),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(28,"div",18),Vp.Qb(29,"a",19),Vp.Mb(30,"fa-icon",20),Vp.Pb(),Vp.Qb(31,"div",21),Vp.Ac(32,lG,7,1,"ng-container",22),Vp.Ac(33,dG,6,4,"ng-template",null,23,Vp.Bc),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.vc(34);Vp.Bb(2),Vp.mc("routerLink",Vp.qc(12,PG)),Vp.Bb(2),Vp.mc("ngClass",t.showMenu?"is-active":""),Vp.Bb(4),Vp.mc("ngClass",t.showMenu?"is-active":""),Vp.Bb(2),Vp.mc("routerLink",Vp.qc(13,PG)),Vp.Bb(6),Vp.mc("routerLink",Vp.qc(14,IG)),Vp.Bb(2),Vp.mc("routerLink",Vp.qc(15,TG)),Vp.Bb(6),Vp.mc("routerLink",Vp.qc(16,AG)),Vp.Bb(2),Vp.mc("routerLink",Vp.qc(17,NG)),Vp.Bb(3),Vp.mc("routerLink",Vp.qc(18,xG)),Vp.Bb(1),Vp.mc("icon",t.faCog),Vp.Bb(2),Vp.mc("ngIf",t.username)("ngIfElse",n)}},directives:[HC,dg,uG,yg],encapsulation:2}),vG),MG=((pG=function e(t,n){Qp(this,e),this._themeService=t,this._errorLoggerService=n}).\u0275fac=function(e){return new(e||pG)(Vp.Lb(Oz),Vp.Lb(fz))},pG.\u0275cmp=Vp.Fb({type:pG,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"container","mt-2"]],template:function(e,t){1&e&&(Vp.Mb(0,"app-header"),Vp.Qb(1,"main",0),Vp.Mb(2,"router-outlet"),Vp.Pb())},directives:[RG,ZC],encapsulation:2}),pG),DG=function(){function e(t,n){Qp(this,e),this.x=t,this.y=n}return Kp(e,[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),LG=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"isDown",value:function(){return 1===this.y}},{key:"isUp",value:function(){return-1===this.y}},{key:"isLeft",value:function(){return-1===this.x}},{key:"isRight",value:function(){return 1===this.x}},{key:"toInt",value:function(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}},{key:"toString",value:function(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}]),n}(DG),BG=function(){function e(){Qp(this,e)}return Kp(e,[{key:"of",value:function(e,t){var n,r=zp(this.all);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.x===e&&i.y===t)return sz.success(i)}}catch(o){r.e(o)}finally{r.f()}return sz.failure("Invalid x and y in direction construction")}},{key:"fromDelta",value:function(e,t){return 0===e&&0===t?sz.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):sz.failure("Invalid delta for direction: ".concat(e,", ").concat(t))}},{key:"fromMove",value:function(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}},{key:"fromString",value:function(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return sz.failure("Invalid direction string ".concat(e))}}},{key:"fromInt",value:function(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return sz.failure("Invalid int direction: ".concat(e))}}}]),e}(),FG=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return vz("string"==typeof e,"Invalid encoded direction"),jG.factory.fromString(e).get()}}]),n}(bz),jG=function(){var e=function(e){Jp(n,e);var t=ev(n);function n(e,r){return Qp(this,n),t.call(this,e,r)}return Kp(n,[{key:"isDiagonal",value:function(){return 0!==this.x&&0!==this.y}},{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(LG);return e.UP=new e(0,-1),e.UP_RIGHT=new e(1,-1),e.RIGHT=new e(1,0),e.DOWN_RIGHT=new e(1,1),e.DOWN=new e(0,1),e.DOWN_LEFT=new e(-1,1),e.LEFT=new e(-1,0),e.UP_LEFT=new e(-1,-1),e.factory=new(function(t){Jp(r,t);var n=ev(r);function r(){var t;return Qp(this,r),(t=n.apply(this,arguments)).all=[e.UP,e.UP_RIGHT,e.RIGHT,e.DOWN_RIGHT,e.DOWN,e.DOWN_LEFT,e.LEFT,e.UP_LEFT],t}return r}(BG)),e.DIRECTIONS=e.factory.all,e.encoder=new FG,e}(),UG=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return vz("string"==typeof e,"Invalid encoded orthogonal"),VG.factory.fromString(e).get()}}]),n}(bz),VG=((mG=function(e){Jp(n,e);var t=ev(n);function n(e,r){return Qp(this,n),t.call(this,e,r)}return Kp(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(LG)).UP=new mG(0,-1),mG.RIGHT=new mG(1,0),mG.DOWN=new mG(0,1),mG.LEFT=new mG(-1,0),mG.factory=new(function(e){Jp(n,e);var t=ev(n);function n(){var e;return Qp(this,n),(e=t.apply(this,arguments)).all=[mG.UP,mG.RIGHT,mG.DOWN,mG.LEFT],e}return Kp(n,[{key:"of",value:function(e,t){return 0===e&&-1===t?sz.success(mG.UP):1===e&&0===t?sz.success(mG.RIGHT):0===e&&1===t?sz.success(mG.DOWN):-1===e&&0===t?sz.success(mG.LEFT):sz.failure("Invalid orthogonal from x and y")}}]),n}(BG)),mG.ORTHOGONALS=mG.factory.all,mG.encoder=new UG,mG),zG=((yG=function(){function e(t,n){Qp(this,e),this.x=t,this.y=n}return Kp(e,[{key:"getNext",value:function(t,n){return new e(this.x+(n=null==n?1:n)*t.x,this.y+n*t.y)}},{key:"getPrevious",value:function(e,t){return this.getNext(e,-(t=null==t?1:t))}},{key:"getLeft",value:function(t){return new e(this.x+t.y,this.y+-t.x)}},{key:"getRight",value:function(t){return new e(this.x+-t.y,this.y+t.x)}},{key:"getOpposite",value:function(){return new e(-this.x,-this.y)}},{key:"isInRange",value:function(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}},{key:"isNotInRange",value:function(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}},{key:"getDirectionToward",value:function(e){return jG.factory.fromMove(this,e)}},{key:"getOrthogonalDistance",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"getDistance",value:function(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}},{key:"isHexagonallyAlignedWith",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}},{key:"isAlignedWith",value:function(e){var t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}},{key:"getVectorToward",value:function(t){return new e(t.x-this.x,t.y-this.y)}},{key:"getMinimalVectorToward",value:function(e){return this.getVectorToward(e).toVector()}},{key:"getCoordsToward",value:function(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];for(var t=this.getDirectionToward(e).get(),n=this.getNext(t,1),r=[];!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}},{key:"toVector",value:function(){for(var t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n),i=this.x,o=this.y,a=2;a<=r;)i%a==0&&o%a==0?(i/=a,o/=a):a++;return new e(i,o)}},{key:"isBetween",value:function(e,t){var n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y}},{key:"compareTo",value:function(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}],[{key:"numberEncoder",value:function(t,n){return wz.tuple([wz.numberEncoder(t),wz.numberEncoder(n)],function(e){return[e.x,e.y]},function(t){return new e(t[0],t[1])})}}]),e}()).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"encode",value:function(e){return{x:e.x,y:e.y}}},{key:"decode",value:function(e){var t=e;return vz(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new yG(t.x,t.y)}}]),n}(bz)),yG),HG=((gG=function(){function e(t){Qp(this,e),this.value=t}return Kp(e,[{key:"toString",value:function(){return"Player "+this.value}},{key:"equals",value:function(e){return this===e}},{key:"getScoreModifier",value:function(){return 0===this.value?-1:1}},{key:"getPreVictory",value:function(){return this.getVictoryValue()-this.getScoreModifier()}},{key:"getDefeatValue",value:function(){return vz(this!==e.NONE,"Should not call getDefeatValue on Player.NONE!"),this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}},{key:"getVictoryValue",value:function(){return vz(this!==e.NONE,"Should not call getVictoryValue on Player.NONE!"),this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}},{key:"getOpponent",value:function(){switch(this){case e.ZERO:return e.ONE;case e.ONE:return e.ZERO;default:return dz.expectToBe(this,e.NONE),e.NONE}}}],[{key:"of",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;default:return dz.expectToBe(t,2),e.NONE}}},{key:"fromTurn",value:function(t){return t%2==0?e.ZERO:e.ONE}}]),e}()).numberEncoder=wz.ofN(2,function(e){return e.value},function(e){return gG.of(e)}),gG.ZERO=new gG(0),gG.ONE=new gG(1),gG.NONE=new gG(2),gG),GG=jp("S0Ta"),qG=((wG=function(){function e(){Qp(this,e)}return Kp(e,[{key:"infoMessage",value:function(e){this.message(e,"is-info")}},{key:"gameMessage",value:function(e){this.message(e,"is-warning")}},{key:"criticalMessage",value:function(e){this.message(e,"is-danger")}},{key:"message",value:function(e,t){Object(GG.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}]),e}()).\u0275fac=function(e){return new(e||wG)},wG.\u0275prov=Vp.Hb({token:wG,factory:wG.\u0275fac,providedIn:"root"}),wG),WG=((_G=function(){function e(t){Qp(this,e),this.messageDisplayer=t,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=kz.empty(),this.imagesLocation="assets/images/"}return Kp(e,[{key:"message",value:function(e){this.messageDisplayer.gameMessage(e)}},{key:"cancelMove",value:function(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?lz.SUCCESS:(this.messageDisplayer.gameMessage(e),lz.failure(e))}},{key:"cancelMoveAttempt",value:function(){}},{key:"getPlayerClass",value:function(e){switch(e){case HG.ZERO:return"player0";case HG.ONE:return"player1";default:return dz.expectToBe(e,HG.NONE),""}}},{key:"pass",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fz.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name}));case 1:case"end":return t.stop()}},t)}))()}},{key:"getTurn",value:function(){return this.rules.node.gameState.turn}},{key:"getCurrentPlayer",value:function(){return this.rules.node.gameState.getCurrentPlayer()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"range",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}}]),e}()).\u0275fac=function(e){return new(e||_G)(Vp.Lb(qG))},_G.\u0275cmp=Vp.Fb({type:_G,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),_G),$G=((bG=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getHexaCoordsBy",value:function(e,t){var n=new zG(e,t);return this.getHexaCoordsAt(n)}},{key:"getHexaCoordsAt",value:function(e){var t,n="",r=this.hexaLayout.getHexaCoordsAt(e),i=zp(r);try{for(i.s();!(t=i.n()).done;){var o=t.value;n+=o.x+" "+o.y+" "}}catch(a){i.e(a)}finally{i.f()}return n+=r[0].x+" "+r[0].y}},{key:"getCenterBy",value:function(e,t){var n=new zG(e,t);return this.getCenterAt(n)}},{key:"getCenterAt",value:function(e){return this.hexaLayout.getCenterAt(e)}}]),n}(WG)).\u0275fac=function(e){return ZG(e||bG)},bG.\u0275cmp=Vp.Fb({type:bG,selectors:[["ng-component"]],features:[Vp.yb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),bG),ZG=Vp.Sb($G),QG=((kG=function(){function e(t){Qp(this,e),this.value=t}return Kp(e,[{key:"equals",value:function(e){return this===e}},{key:"is",value:function(e){return this.value===e.value}},{key:"isPlayer",value:function(){return this===e.ZERO||this===e.ONE}}],[{key:"from",value:function(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.NONE.value:return e.NONE;default:throw new Error("FourStatePiece has no value matching "+t)}}},{key:"ofPlayer",value:function(t){switch(t){case HG.ZERO:return e.ZERO;case HG.ONE:return e.ONE;default:throw new Error("FourStatePiece.ofPlayer can only be called with Player.ZERO and Player.ONE.")}}}]),e}()).ZERO=new kG(HG.ZERO.value),kG.ONE=new kG(HG.ONE.value),kG.EMPTY=new kG(HG.NONE.value),kG.NONE=new kG(3),kG),YG=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){switch(e){case KG.UP:return 0;case KG.UP_RIGHT:return 1;case KG.RIGHT:return 2;case KG.DOWN:return 3;case KG.DOWN_LEFT:return 4;default:return 5}}},{key:"decodeNumber",value:function(e){return vz(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),KG.factory.all[e]}}]),n}(wz),KG=((CG=function(e){Jp(n,e);var t=ev(n);function n(e,r){return Qp(this,n),t.call(this,e,r)}return Kp(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}],[{key:"getAngle",value:function(e){switch(e){case n.UP:return 0;case n.UP_RIGHT:return 60;case n.RIGHT:return 120;case n.DOWN:return 180;case n.DOWN_LEFT:return 240;default:return dz.expectToBe(e,n.LEFT),300}}}]),n}(LG)).UP=new CG(0,-1),CG.LEFT=new CG(-1,0),CG.UP_RIGHT=new CG(1,-1),CG.DOWN_LEFT=new CG(-1,1),CG.RIGHT=new CG(1,0),CG.DOWN=new CG(0,1),CG.factory=new(function(e){Jp(n,e);var t=ev(n);function n(){var e;return Qp(this,n),(e=t.apply(this,arguments)).all=[CG.UP,CG.UP_RIGHT,CG.RIGHT,CG.DOWN,CG.DOWN_LEFT,CG.LEFT],e}return n}(BG)),CG.encoder=new YG,CG),JG=function(){function e(t,n,r){Qp(this,e),this.size=t,this.origin=n,this.orientation=r}return Kp(e,[{key:"getCenterAt",value:function(e){var t=this.orientation.conversionMatrix;return new zG(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}},{key:"getCornerOffset",value:function(e){var t=2*Math.PI*(this.orientation.startAngle+e)/6;return new zG(this.size*Math.cos(t),this.size*Math.sin(t))}},{key:"getHexaCoordsAt",value:function(e){for(var t=this.getCenterAt(e),n=[],r=0;r<6;r+=1){var i=this.getCornerOffset(r);n.push(new zG(t.x+i.x,t.y+i.y))}return n}}]),e}(),XG=function e(){Qp(this,e)},eq=function(){var e=function(e){Jp(n,e);var t=ev(n);function n(){var e;return Qp(this,n),(e=t.call(this)).startAngle=.5,e.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],e.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3],e}return n}(XG);return e.INSTANCE=new e,e}(),tq=function(){var e=function(e){Jp(n,e);var t=ev(n);function n(){var e;return Qp(this,n),(e=t.call(this)).startAngle=0,e.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],e.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3],e}return Kp(n,[{key:"isOnBorder",value:function(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}},{key:"isOnTopRightBorder",value:function(e,t){return 0===t.y}},{key:"isOnRightBorder",value:function(e,t){return t.x===e.width-1}},{key:"isOnLeftBorder",value:function(e,t){return 0===t.x}},{key:"isOnBottomLeftBorder",value:function(e,t){return t.y===e.height-1}},{key:"isOnTopLeftBorder",value:function(e,t){return null!=e.excludedCases[t.y]?t.x===e.excludedCases[t.y]:t.y===e.excludedCases.length&&0===t.x}},{key:"isOnBottomRightBorder",value:function(e,t){return null!=e.excludedCases[e.height-1-t.y]?e.width-1-t.x===e.excludedCases[e.height-1-t.y]:e.height-1-t.y===e.excludedCases.length&&t.x===e.width-1}},{key:"getAllBorders",value:function(e){var t=this,n=[];return e.forEachCoord(function(r,i){t.isOnBorder(e,r)&&n.push(r)}),n}},{key:"isTopCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}},{key:"isTopLeftCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isTopRightCorner",value:function(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}},{key:"isBottomCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}},{key:"isBottomLeftCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isBottomRightCorner",value:function(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}]),n}(XG);return e.INSTANCE=new e,e}(),nq=function(){var e=function e(){Qp(this,e)};return e.CANNOT_CHOOSE_OPPONENT_PIECE=function(){return $localize(w||(w=xp(["You cannot pick a piece of the opponent."])))},e.MUST_CLICK_ON_EMPTY_SPACE=function(){return $localize(k||(k=xp(["You must click on an empty space."])))},e.CANNOT_SELF_CAPTURE=function(){return $localize(C||(C=xp(["Your landing space should be empty or contain a piece of the opponent."])))},e.MUST_CHOOSE_PLAYER_PIECE=function(){return $localize(E||(E=xp(["You must pick one of your pieces."])))},e.CANNOT_PASS=function(){return $localize(O||(O=xp(["You cannot pass your turn."])))},e.MUST_LAND_ON_EMPTY_SPACE=function(){return $localize(S||(S=xp(["You must drop your piece on an empty space."])))},e.MUST_PASS=function(){return $localize(P||(P=xp(["You must pass your turn."])))},e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=function(){return $localize(I||(I=xp(["You have selected an empty space, you must select one of your own pieces."])))},e.MOVE_CANNOT_BE_STATIC=function(){return $localize(T||(T=xp(["You must choose different starting and ending coordinates."])))},e}(),rq=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"mapBiArray",value:function(e,t){for(var n=[],r=0;r<e.length;){n[r]=[];for(var i=0;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}},{key:"createTable",value:function(e,t,n){for(var r=[],i=t-1;i>=0;){r[i]=[];for(var o=e-1;o>=0;)r[i][o]=n,o--;i--}return r}},{key:"copyBiArray",value:function(t){for(var n=[],r=0;r<t.length;)n[r]=e.copyImmutableArray(t[r]),r++;return n}},{key:"copyImmutableArray",value:function(e){for(var t=[],n=0;n<e.length;)t[n]=e[n],n++;return t}},{key:"sortByDescending",value:function(e,t){e.sort(function(e,n){var r=t(e),i=t(n);return r<i?1:r>i?-1:0})}},{key:"compareArray",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!1===rz(e[n],t[n]))return!1;return!0}},{key:"compareTable",value:function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!1===e.compareArray(t[r],n[r]))return!1;return!0}}]),e}(),iq=function(){function e(t,n){Qp(this,e),this.ruler=t,this.name=n}return Kp(e,[{key:"toString",value:function(){return this.name}}]),e}(),oq=function(){function e(t){Qp(this,e),this.value=t}return Kp(e,[{key:"toString",value:function(){return""+this.value}}],[{key:"fromWinner",value:function(t){return new e(t===HG.NONE?0:t.getVictoryValue())}}]),e}(),aq=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"toComparableObjectSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return t.equals(e)})||t.push(e)}),t}},{key:"toComparableSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return rz(t,e)})||t.push(e)}),t}}]),e}(),sq=function(e){function t(e){Qp(this,t),this.values=void 0===e?[]:aq.toComparableSet(e)}return Kp(t,[{key:"equals",value:function(e){if(e.size()!==this.size())return!1;var t,n=zp(this);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===e.contains(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"toString",value:function(){var e,t="",n=zp(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=null==r?"null, ":r.toString()+", "}}catch(i){n.e(i)}finally{n.f()}return"["+t.slice(0,-2)+"]"}},{key:"add",value:function(e){return!this.contains(e)&&(this.values.push(e),!0)}},{key:"union",value:function(e){var t,n=zp(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"contains",value:function(e){var t,n=zp(this.values);try{for(n.s();!(t=n.n()).done;){if(rz(t.value,e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"size",value:function(){return this.values.length}},{key:"toList",value:function(){var e,t=[],n=zp(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getAnyElement",value:function(){return this.size()>0?kz.of(this.values[0]):kz.empty()}},{key:Symbol.iterator,value:function(){return this.values.values()}}]),t}(),uq=function(){function e(t){Qp(this,e),this.turn=t}return Kp(e,[{key:"getCurrentPlayer",value:function(){return HG.fromTurn(this.turn)}},{key:"getCurrentOpponent",value:function(){return this.turn%2==1?HG.ZERO:HG.ONE}}]),e}(),cq=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,r)).board=e,i}return Kp(n,[{key:"getPieceAt",value:function(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}},{key:"isOnBoard",value:function(e){return e.isInRange(this.board[0].length,this.board.length)}},{key:"getPieceAtXY",value:function(e,t){return this.getPieceAt(new zG(e,t))}},{key:"forEachCoord",value:function(e){var t,n=zp(this.getCoordsAndContents());try{for(n.s();!(t=n.n()).done;){var r=Bp(t.value,2);e(r[0],r[1])}}catch(i){n.e(i)}finally{n.f()}}},{key:"getCoordsAndContents",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new zG(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}},{key:"getCopiedBoard",value:function(){return rq.copyBiArray(this.board)}}]),n}(uq),lq=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"isInBoard",value:function(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==QG.NONE}},{key:"isPiece",value:function(e){return this.getPieceAt(e).isPlayer()}},{key:"getScores",value:function(){for(var e=[14,14],t=0;t<9;t++)for(var n=0;n<9;n++)this.getPieceAtXY(n,t)===QG.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===QG.ONE&&(e[0]=e[0]-1);return e}}],[{key:"getInitialState",value:function(){var e=QG.EMPTY,t=QG.NONE,r=QG.ZERO,i=QG.ONE;return new n([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}}]),n}(cq),hq=function e(){Qp(this,e)},fq=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this)).coord=new zG(e,r),i}return n}(hq),dq=((EG=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;if(Qp(this,n),(o=t.call(this,e.x,e.y)).dir=r,o.lastPiece=i,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!");return tv(o)}return Kp(n,[{key:"toString",value:function(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}},{key:"isSingleCoord",value:function(){return this.lastPiece.isAbsent()}},{key:"equals",value:function(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}],[{key:"fromSingleCoord",value:function(e,t){try{return sz.success(new n(e,t,kz.empty()))}catch(fV){return sz.failure(fV.message)}}},{key:"fromDoubleCoord",value:function(e,t,r){var i=[e,t];rq.sortByDescending(i,n.sortCoord);var o=i[1].getDirectionToward(i[0]).get(),a=KG.factory.fromDelta(o.x,o.y);if(a.isFailure())return sz.failure("Invalid direction");var s=a.get();return i[1].getDistance(i[0])>2?sz.failure("Distance between first coord and last coord is too great"):s.equals(r)?n.fromSingleCoord(i[1],r):s.getOpposite().equals(r)?n.fromSingleCoord(i[0],r):sz.success(new n(i[1],r,kz.of(i[0])))}},{key:"sortCoord",value:function(e){return 9*e.y+e.x}}]),n}(fq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 104831}},{key:"encodeNumber",value:function(e){var t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;var n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}},{key:"decodeNumber",value:function(e){var t=e%8;e=(e-t)/8;var n=KG.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;var o=new zG(i,r);if(0===e)return EG.fromSingleCoord(o,n).get();var a=(e=(e-1)/2)%9,s=(e=(e-a)/9)%9;e=(e-s)/9;var u=new zG(s,a);return EG.fromDoubleCoord(o,u,n).get()}}]),n}(wz)),EG),pq=function(e){return e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT",e}({}),vq=function(){function e(){Qp(this,e),this.map=[],this.isImmutable=!1}return Kp(e,[{key:"makeImmutable",value:function(){this.isImmutable=!0}},{key:"get",value:function(e){var t,n=zp(this.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(rz(r.key,e))return kz.of(r.value)}}catch(i){n.e(i)}finally{n.f()}return kz.empty()}},{key:"forEach",value:function(e){for(var t=0;t<this.map.length;t++)e(this.getByIndex(t))}},{key:"getByIndex",value:function(e){return this.map[e]}},{key:"putAll",value:function(e){this.checkImmutability("putAll");var t,n=zp(e.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r.key,r.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"checkImmutability",value:function(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}},{key:"put",value:function(e,t){this.checkImmutability("put");var n,r=zp(this.map);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(rz(i.key,e)){var o=i.value;return i.value=t,kz.of(o)}}}catch(a){r.e(a)}finally{r.f()}return this.map.push({key:e,value:t}),kz.empty()}},{key:"containsKey",value:function(e){return this.map.some(function(t){return rz(t.key,e)})}},{key:"size",value:function(){return this.map.length}},{key:"listKeys",value:function(){return this.map.map(function(e){return e.key})}},{key:"getKeySet",value:function(){return new sq(this.listKeys())}},{key:"filter",value:function(t){var n,r=new e,i=zp(this.map);try{for(i.s();!(n=i.n()).done;){var o=n.value;t(o.key,o.value)&&r.set(o.key,o.value)}}catch(a){i.e(a)}finally{i.f()}return r}},{key:"replace",value:function(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}},{key:"set",value:function(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}},{key:"delete",value:function(e){this.checkImmutability("delete");for(var t=0;t<this.map.length;t++)if(rz(this.map[t].key,e)){var n=this.map[t].value,r=this.map.slice(0,t),i=this.map.slice(t+1);return this.map=r.concat(i),n}throw new Error('No Value to delete for key "'+e.toString()+'"!')}},{key:"getCopy",value:function(){var e,t=new this.constructor,n=zp(this.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.set(r,this.get(r).get())}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"equals",value:function(e){var t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;var r,i=zp(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=this.get(o).get(),s=e.get(o);if(vz(s.isPresent(),"value is absent in a map even though its key is present!"),!1===rz(a,s.get()))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}}]),e}(),gq=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"reverse",value:function(){var e,t=new n,r=zp(this.listKeys());try{for(r.s();!(e=r.n()).done;){var i=e.value,o=this.get(i).get();if(t.containsKey(o))t.get(o).get().add(i);else{var a=new sq;a.add(i),t.set(o,a)}}}catch(s){r.e(s)}finally{r.f()}return t}}]),n}(vq),yq=function(){var e=function e(){Qp(this,e)};return e.createdNodes=0,e.minimaxTime=0,e}(),mq=((SG=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kz.empty(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kz.empty(),i=arguments.length>3?arguments[3]:void 0;if(Qp(this,e),this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=kz.empty(),this.hopedValue=new vq,this.ownValue=new vq,this.possibleMoves=new vq,this.ownValue=new vq,null!=i){var o=i.getBoardValue(this);this.ownValue.set(i.name,o),this.hopedValue.set(i.name,o.value)}yq.createdNodes++,pz(e.VERBOSE||!1,"creating "+this.myToString())}return Kp(e,[{key:"findBestMove",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(new Date).getTime(),o=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);o.gameState.turn>this.gameState.turn+1;)o=o.mother.get(),e--;return yq.minimaxTime+=(new Date).getTime()-i,o.move.get()}},{key:"alphaBeta",value:function(t,n,r,i,o,a){if(t<1)return pz(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return pz(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;var s=this.getPossibleMoves(i);vz(s.length>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=kz.of([]));var u,c,l=[],h=this.gameState.getCurrentPlayer(),f=h===HG.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,d=h===HG.ZERO?function(e,t){return e<t}:function(e,t){return e>t},p=zp(s);try{for(p.s();!(u=p.n()).done;){var v=u.value,g=this.getOrCreateChild(v,i).alphaBeta(t-1,n,r,i,o,a),y=g.getHopedValue(i);if(d(y,f)||0===l.length?(f=y,l=[g]):y===f&&l.push(g),a&&d(f,h===HG.ZERO?n:r))break;h===HG.ZERO?r=Math.min(f,r):n=Math.max(f,n)}}catch(b){p.e(b)}finally{p.f()}var m=(c=o?l[Math.floor(Math.random()*l.length)]:l[0]).hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),m),c}},{key:"getPossibleMoves",value:function(e){var t=this.possibleMoves.get(e.name);if(t.isAbsent()){var n=e.getListMoves(this);return this.possibleMoves.set(e.name,new sq(n)),n}return t.get().toList()}},{key:"getOrCreateChild",value:function(t,n){var r=this.getSonByMove(t);if(r.isAbsent()){var i=n.ruler.isLegal(t,this.gameState);vz(i.isSuccess(),"The minimax has accepted an illegal move, this should not happen.");var o=n.ruler.applyLegalMove(t,this.gameState,i.get());r=kz.of(new e(o,kz.of(this),kz.of(t),n)),this.childs.get().push(r.get())}return r.get()}},{key:"getSonByMove",value:function(e){vz(this.childs.isPresent(),"Cannot get son of uncalculated node");var t,n=zp(this.childs.get());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.move.isPresent()&&r.move.equalsValue(e))return kz.of(r)}}catch(i){n.e(i)}finally{n.f()}return kz.empty()}},{key:"getInitialNode",value:function(){for(var e=this;e.mother.isPresent();)e=e.mother.get();return e}},{key:"getHopedValue",value:function(e){return this.hopedValue.get(e.name).get()}},{key:"getOwnValue",value:function(e){var t=this.ownValue.get(e.name);if(t.isAbsent()){var n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}},{key:"myToString",value:function(){var e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}},{key:"hasMoves",value:function(){return this.childs.isPresent()}},{key:"countDescendants",value:function(){if(this.childs.isAbsent())return 0;var e,t=this.childs.get().length,n=zp(this.childs.get());try{for(n.s();!(e=n.n()).done;)t+=e.value.countDescendants()}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"getScoreStatus",value:function(t){return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(pz(e.VERBOSE||!1,"VICTORY"),pq.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(pz(e.VERBOSE||!1,"PRE_VICTORY_MIN"),pq.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(pz(e.VERBOSE||!1,"PRE_VICTORY_MAX"),pq.PRE_VICTORY):(pz(e.VERBOSE||!1,"DEFAULT"),pq.DEFAULT)}}]),e}()).VERBOSE=!1,SG.minimaxes=new vq,SG),bq=((OG=function(){function e(t,n){Qp(this,e),this.isEndGame=t,this.winner=n}return Kp(e,[{key:"toBoardValue",value:function(){return this.winner!==HG.NONE?this.winner.getVictoryValue():0}}],[{key:"getVictory",value:function(t){return vz(t!==HG.NONE,"getVictory called with Player.NONE"),t===HG.ZERO?e.ZERO_WON:e.ONE_WON}},{key:"getDefeat",value:function(t){return vz(t!==HG.NONE,"getVictory called with Player.NONE"),t===HG.ZERO?e.ONE_WON:e.ZERO_WON}}]),e}()).ZERO_WON=new OG(!0,HG.ZERO),OG.ONE_WON=new OG(!0,HG.ONE),OG.DRAW=new OG(!0,HG.NONE),OG.ONGOING=new OG(!1,HG.NONE),OG),_q=function(){function e(t){Qp(this,e),this.stateType=t,this.setInitialBoard()}return Kp(e,[{key:"choose",value:function(e){pz(!1,"Rules.choose: "+e.toString()+" was proposed");var t=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){pz(!1,"Rules.choose: current node has moves");var n=this.node.getSonByMove(e);if(n.isPresent())return vz(t.isSuccess(),"Rules.choose: Move is illegal: "+t.getReasonOr("")),pz(!1,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=n.get(),!0}if(pz(!1,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),t.isFailure())return pz(!1,"Rules.choose: Move is illegal: "+t.getReason()),!1;pz(!1,"Rules.choose: Move is legal, let's apply it");var r=this.applyLegalMove(e,this.node.gameState,t.get()),i=new mq(r,kz.of(this.node),kz.of(e));return this.node=i,!0}},{key:"setInitialBoard",value:function(){if(null==this.node){var e=this.stateType.getInitialState();mq.ruler=this,this.node=new mq(e)}else this.node=this.node.getInitialNode()}},{key:"applyMoves",value:function(e,t,n){var r,i=0,o=zp(e);try{for(o.s();!(r=o.n()).done;){var a=n(r.value),s=this.isLegal(a,t);vz(s.isSuccess(),"Can't create state from invalid moves ("+i+"): "+s.toString()+"."),t=this.applyLegalMove(a,t,s.get()),i++}}catch(u){o.e(u)}finally{o.f()}return t}}]),e}(),wq=function(){var e=function e(){Qp(this,e)};return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=function(){return $localize(A||(A=xp(["You cannot move more than 3 of your pieces!"])))},e.NOT_ENOUGH_PIECE_TO_PUSH=function(){return $localize(N||(N=xp(["You don't have enough pieces to push that group!"])))},e.CANNOT_PUSH_YOUR_OWN_PIECES=function(){return $localize(x||(x=xp(["You cannot push this piece because it is blocked by one of yours!"])))},e.MUST_ONLY_TRANSLATE_YOUR_PIECES=function(){return $localize(R||(R=xp(["This line contains pieces of your opponent or empty spaces, which is forbidden."])))},e.TRANSLATION_IMPOSSIBLE=function(){return $localize(M||(M=xp(["This move is impossible, some landing spaces are occupied."])))},e.LINE_AND_COORD_NOT_ALIGNED=function(){return $localize(D||(D=xp(["This space is not aligned with the current line."])))},e}(),kq=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){return new lq(n,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toFailedFallible():e.isSingleCoord()?n.isLegalPush(e,t):n.isLegalSideStep(e,t)}},{key:"getFirstPieceValidity",value:function(e,t){var n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?lz.failure(nq.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===QG.ofPlayer(t.getCurrentOpponent())?lz.failure(nq.CANNOT_CHOOSE_OPPONENT_PIECE()):lz.SUCCESS}},{key:"isLegalPush",value:function(e,t){var r=1,i=e.coord.getNext(e.dir),o=QG.ofPlayer(t.getCurrentPlayer()),a=QG.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=a;r<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===o;)r++,i=i.getNext(e.dir);return r>3?sz.failure(wq.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(i)?sz.success(s):(s[i.y][i.x]=o,t.getPieceAt(i)===a?sz.success(s):n.isLegalRealPush(i,e,t,r,s))}},{key:"isLegalRealPush",value:function(e,t,n,r,i){for(var o=0,a=QG.ofPlayer(n.getCurrentOpponent()),s=QG.ofPlayer(n.getCurrentPlayer());o<r&&n.isOnBoard(e)&&n.getPieceAt(e)===a;)o++,e=e.getNext(t.dir);return o>=r?sz.failure(wq.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===QG.EMPTY&&(i[e.y][e.x]=a),n.getPieceAt(e)===s)?sz.failure(wq.CANNOT_PUSH_YOUR_OWN_PIECES()):sz.success(i)}},{key:"isLegalSideStep",value:function(e,t){var n=e.lastPiece.get(),r=e.coord.getDirectionToward(n).get();n=n.getNext(r);for(var i=e.coord,o=QG.ofPlayer(t.getCurrentPlayer()),a=t.getCopiedBoard();!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==o)return sz.failure(wq.MUST_ONLY_TRANSLATE_YOUR_PIECES());var s=i.getNext(e.dir);if(a[i.y][i.x]=QG.EMPTY,s.isInRange(9,9)){if(t.isPiece(s))return sz.failure(wq.TRANSLATION_IMPOSSIBLE());t.getPieceAt(s)===QG.EMPTY&&(a[s.y][s.x]=o)}i=i.getNext(r)}return sz.success(a)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getScores();return t[0]>5?bq.ZERO_WON:t[1]>5?bq.ONE_WON:bq.ONGOING}}]),n}(_q),Cq=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<9;i++)for(var o=0;o<9;o++){var a=new zG(o,i);if(!1!==n.getPieceAt(a).is(r)){var s,u=zp(KG.factory.all);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=dq.fromSingleCoord(a,c).get();if(this.isAcceptablePush(l,n)){t.push(l);var h,f=zp(KG.factory.all);try{for(f.s();!(h=f.n()).done;)for(var d=h.value,p=1;p<=2&&!d.equals(c);p++){var v=a.getNext(d,p);if(!v.isInRange(9,9))break;var g=dq.fromDoubleCoord(a,v,c).get();kq.isLegal(g,n).isSuccess()&&t.push(g)}}catch(y){f.e(y)}finally{f.f()}}}}catch(y){u.e(y)}finally{u.f()}}}return new sq(t).toList()}},{key:"isAcceptablePush",value:function(e,t){var n=t.getScores(),r=kq.isLegal(e,t);if(r.isSuccess()){var i=t.getCurrentOpponent().value;return!(new lq(r.get(),t.turn+1).getScores()[i]>n[i])}return!1}},{key:"getBoardValue",value:function(e){var t=kq.getGameStatus(e);if(t.isEndGame)return new oq(t.toBoardValue());var n=e.gameState.getScores();return new oq(n[1]-n[0])}}]),n}(iq),Eq=function(){function e(t,n,r){Qp(this,e),this.title=t,this.instruction=n,this.state=r,this.previousMove=kz.empty()}return Kp(e,[{key:"isMove",value:function(){return!1}},{key:"isAnyMove",value:function(){return!1}},{key:"isClick",value:function(){return!1}},{key:"isPredicate",value:function(){return!1}},{key:"isInformation",value:function(){return!1}},{key:"hasSolution",value:function(){return!1}},{key:"withPreviousMove",value:function(e){return this.previousMove=kz.of(e),this}}],[{key:"fromMove",value:function(e,t,n,r,i,o){return new Sq(e,t,n,r,i,o)}},{key:"forClick",value:function(e,t,n,r,i,o){return new Iq(e,t,n,r,i,o)}},{key:"anyMove",value:function(e,t,n,r,i){return new Pq(e,t,n,r,i)}},{key:"fromPredicate",value:function(e,t,n,r,i,o){return new Tq(e,t,n,r,i,o)}},{key:"informational",value:function(e,t,n){return new Aq(e,t,n)}}]),e}(),Oq=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a){var s;return Qp(this,n),(s=t.call(this,e,r,i)).solution=o,s.successMessage=a,s}return Kp(n,[{key:"hasSolution",value:function(){return!0}},{key:"getSolution",value:function(){return this.solution}},{key:"getSuccessMessage",value:function(){return this.successMessage}}]),n}(Eq),Sq=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a,s){var u;return Qp(this,n),(u=t.call(this,e,r,i,o[0],a)).acceptedMoves=o,u.failureMessage=s,vz(o.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational"),u}return Kp(n,[{key:"isMove",value:function(){return!0}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Oq),Pq=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a){return Qp(this,n),t.call(this,e,r,i,o,a)}return Kp(n,[{key:"isAnyMove",value:function(){return!0}}]),n}(Oq),Iq=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a,s){var u;return Qp(this,n),(u=t.call(this,e,r,i)).acceptedClicks=o,u.successMessage=a,u.failureMessage=s,u}return Kp(n,[{key:"isClick",value:function(){return!0}},{key:"getSuccessMessage",value:function(){return this.successMessage}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Eq),Tq=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a,s){var u;return Qp(this,n),(u=t.call(this,e,r,i,o,s)).predicate=a,u}return Kp(n,[{key:"isPredicate",value:function(){return!0}}]),n}(Oq),Aq=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"isInformation",value:function(){return!0}}]),n}(Eq),Nq=QG.EMPTY,xq=QG.NONE,Rq=QG.ZERO,Mq=QG.ONE,Dq=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(L||(L=xp(["Initial board and goal of the game"]))),$localize(B||(B=xp(["At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!"]))),lq.getInitialState()),Eq.anyMove($localize(F||(F=xp(["Moving a piece"]))),$localize(j||(j=xp(["At each turn, move one, two, or three pieces either along their line, or on their side.\n        For your moves you can therefore choose between up to 6 directions.\n        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).\n        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>\n        You're playing Dark, make any move!"]))),lq.getInitialState(),dq.fromSingleCoord(new zG(2,6),KG.UP).get(),$localize(U||(U=xp(["Congratulations!"])))),Eq.fromMove($localize(V||(V=xp(["Pushing"]))),$localize(z||(z=xp(["To push one opponent piece, you must move at least two of your pieces.\n        To push two opponent pieces, you must move three of your pieces.\n        If one of your pieces is in the way, it will be impossible to push.\n        You cannot move more than three pieces.<br/><br/>\n        Only one push towards the right is possible here, find it. (You're playing Dark)."]))),new lq([[xq,xq,xq,xq,Nq,Rq,Rq,Mq,Mq],[xq,xq,xq,Nq,Nq,Nq,Nq,Nq,Nq],[xq,xq,Nq,Rq,Rq,Rq,Mq,Rq,Nq],[xq,Nq,Nq,Nq,Nq,Nq,Nq,Nq,Nq],[Nq,Nq,Nq,Nq,Rq,Rq,Rq,Mq,Mq],[Nq,Nq,Nq,Nq,Nq,Nq,Nq,Nq,xq],[Nq,Nq,Nq,Nq,Rq,Mq,Nq,xq,xq],[Nq,Nq,Nq,Rq,Nq,Nq,xq,xq,xq],[Nq,Nq,Rq,Nq,Nq,xq,xq,xq,xq]],0),[dq.fromSingleCoord(new zG(4,4),KG.RIGHT).get()],$localize(H||(H=xp(["Congratulations! You know everything you need to start a game!"]))),$localize(G||(G=xp(["Failed!"]))))]};function Lq(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"circle",6),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onPieceClick(e,t)}),Vp.Pb()}if(2&e){var r=Vp.fc(2).index,i=Vp.fc().index,o=Vp.fc();Vp.oc("id","piece_",r,"_",i,""),Vp.mc("ngClass",o.getPieceClasses(r,i)),Vp.Cb("cx",o.getCenterBy(r,i).x)("cy",o.getCenterBy(r,i).y)("r",.5*o.SPACE_SIZE)}}function Bq(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"polyline",4),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc().index;return Vp.fc().onCaseClick(e,t)}),Vp.Pb(),Vp.Ac(2,Lq,1,6,"circle",5),Vp.Pb()}if(2&e){var r=Vp.fc(),i=r.index,o=r.$implicit,a=Vp.fc().index,s=Vp.fc();Vp.Bb(1),Vp.oc("id","case_",i,"_",a,""),Vp.mc("ngClass",s.getSquareClasses(i,a)),Vp.Cb("points",s.getHexaCoordsBy(i,a)),Vp.Bb(1),Vp.mc("ngIf",s.isPiece(o))}}function Fq(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,Bq,3,5,"g",3),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc(2);Vp.Bb(1),Vp.mc("ngIf",r.isBoard(n))}}function jq(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,Fq,2,1,"g",1),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function Uq(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"marker",7),Vp.Mb(1,"polygon",8),Vp.Pb()),2&e&&Vp.nc("id","arrowhead_",t.$implicit.dir.toString(),"")}function Vq(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Mb(1,"line",9),Vp.Qb(2,"line",10),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().chooseDirection(e.dir)}),Vp.Pb(),Vp.Qb(3,"polygon",11),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().chooseDirection(e.dir)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit;Vp.Bb(1),Vp.nc("id","line_start_",r.dir.toString(),""),Vp.Cb("x1",r.startCenter.x)("y1",r.startCenter.y)("x2",r.middle.x)("y2",r.middle.y),Vp.Bb(1),Vp.nc("id","line_end_",r.dir.toString(),""),Vp.Cb("x1",r.middle.x)("y1",r.middle.y)("x2",r.landingCenter.x)("y2",r.landingCenter.y),Vp.Bb(1),Vp.nc("id","direction_",r.dir.toString(),""),Vp.Cb("transform",r.transformation)}}var zq,Hq,Gq,qq,Wq=function e(t,n,r,i,o,a){Qp(this,e),this.startCenter=t,this.middle=n,this.landingCenter=r,this.landing=i,this.dir=o,this.transformation=a},$q=((Gq=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).moveds=[],r.directions=[],r.selecteds=[],r.rules=new kq(lq),r.availableMinimaxes=[new Cq(r.rules,"Dummy")],r.encoder=dq.encoder,r.tutorial=(new Dq).tutorial,r.scores=kz.of([0,0]),r.SPACE_SIZE=30,r.hexaLayout=new JG(r.SPACE_SIZE,new zG(-8*r.SPACE_SIZE,2*r.SPACE_SIZE),eq.INSTANCE),r.updateBoard(),r}return Kp(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.rules.node.gameState.getCopiedBoard(),this.scores=kz.of(this.rules.node.gameState.getScores())}},{key:"hidePreviousMove",value:function(){this.moveds=[]}},{key:"cancelMoveAttempt",value:function(){this.directions=[],this.selecteds=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}},{key:"showPushingMove",value:function(e){var t=this.rules.node.mother.get().gameState,n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}},{key:"showSideStepMove",value:function(e){var t=e.lastPiece.get(),n=e.coord.getDirectionToward(t).get();t=t.getNext(n);for(var r=e.coord;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}},{key:"onPieceClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#piece_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return o=n.rules.node.gameState.getCurrentOpponent(),r.abrupt("return",n.hexaBoard[t][e].is(o)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"opponentClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.tryChoosingDirection(e,t);case 2:if(!r.sent.isSuccess()){r.next=6;break}r.t0=lz.SUCCESS,r.next=7;break;case 6:r.t0=n.cancelMove(nq.CANNOT_CHOOSE_OPPONENT_PIECE());case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.selecteds=[new zG(e,t)],n.showPossibleDirections(),lz.SUCCESS));case 1:case"end":return r.stop()}},r)}))()}},{key:"showPossibleDirections",value:function(){this.directions=[],this.showDirection(1===this.selecteds.length)}},{key:"showDirection",value:function(e){var t,n=this.rules.node.gameState,r=QG.ofPlayer(n.getCurrentPlayer()),i=this.selecteds[0],o=this.selecteds[this.selecteds.length-1],a=zp(KG.factory.all);try{for(a.s();!(t=a.n()).done;){var s,u=t.value,c=i.getNext(u,1);if(n.isOnBoard(c)&&n.getPieceAt(c)===r){if(e)continue;if(c=o.getNext(u,1),n.isOnBoard(c)&&n.getPieceAt(c)===r)continue}if(s=e?dq.fromSingleCoord(i,u).get():dq.fromDoubleCoord(i,o,u).get(),this.rules.isLegal(s,n).isSuccess()){var l=this.getCenterAt(i),h=this.getCenterAt(c),f=this.getMiddleOfArrow(u,c,h),d=h.x+" "+h.y,p=KG.getAngle(u)+150,v=new Wq(l,f,h,c,u,"rotate("+p+" "+d+") translate("+d+")");this.directions.push(v)}}}catch(g){a.e(g)}finally{a.f()}}},{key:"getMiddleOfArrow",value:function(e,t,n){var r=t.getPrevious(e),i=this.getCenterAt(r);return new zG(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}},{key:"isBoard",value:function(e){return e!==QG.NONE}},{key:"isPiece",value:function(e){return e!==QG.EMPTY}},{key:"secondClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.selecteds[0],!(o=new zG(e,t)).equals(i)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),lz.SUCCESS));case 3:if(!1!==o.isHexagonallyAlignedWith(i)){r.next=5;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 5:if(!((a=o.getDistance(i))>2)){r.next=8;break}return r.abrupt("return",n.cancelMove(wq.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 8:for(s=i.getDirectionToward(o).get(),n.selecteds=[i],u=0;u<a;u++)n.selecteds.push(i.getNext(s,u+1));if(3!==n.selecteds.length){r.next=15;break}if(c=n.selecteds[1],l=n.rules.node.gameState.getCurrentPlayer(),!1!==n.hexaBoard[c.y][c.x].is(l)){r.next=15;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 15:return r.abrupt("return",(n.showPossibleDirections(),lz.SUCCESS));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new zG(e,t),o=n.selecteds[0],!i.equals(o)){r.next=3;break}return r.abrupt("return",n.deselectExtremity(!0));case 3:return a=n.selecteds[n.selecteds.length-1],r.abrupt("return",i.equals(a)?n.deselectExtremity(!1):3===n.selecteds.length&&i.equals(n.selecteds[1])?(n.cancelMoveAttempt(),lz.SUCCESS):n.tryExtension(i,o,a));case 5:case"end":return r.stop()}},r)}))()}},{key:"tryExtension",value:function(e,t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){var o,a,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(o=jG.factory.fromMove(t,e)).isSuccess()){i.next=6;break}if(a=jG.factory.fromMove(n,e),!o.equals(a)){i.next=6;break}return s=t.getDistance(e),u=n.getDistance(e),i.abrupt("return",2===Math.max(s,u)?(r.selecteds.push(e),rq.sortByDescending(r.selecteds,dq.sortCoord),r.showPossibleDirections(),lz.SUCCESS):r.cancelMove(wq.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 6:return c=r.cancelMove(wq.LINE_AND_COORD_NOT_ALIGNED()),i.next=9,r.firstClick(e.x,e.y);case 9:return i.abrupt("return",c);case 10:case"end":return i.stop()}},i)}))()}},{key:"deselectExtremity",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),lz.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"chooseDirection",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#direction_"+e.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t._chooseDirection(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"_chooseDirection",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.node.gameState,o=t.selecteds[0],n.abrupt("return",(i=1===t.selecteds.length?dq.fromSingleCoord(o,e).get():dq.fromDoubleCoord(o,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(i,r,t.scores.get())));case 3:case"end":return n.stop()}},n)}))()}},{key:"onCaseClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#case_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.tryChoosingDirection(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"tryChoosingDirection",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new zG(e,t),o=zp(n.directions),r.prev=2,o.s();case 4:if((a=o.n()).done){r.next=10;break}if(!(s=a.value).landing.equals(i)){r.next=8;break}return r.abrupt("return",n._chooseDirection(s.dir));case 8:r.next=4;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),o.e(r.t0);case 15:return r.prev=15,o.f(),r.finish(15);case 18:return r.abrupt("return",lz.failure("not a direction"));case 19:case"end":return r.stop()}},r,null,[[2,12,15,18]])}))()}},{key:"getSquareClasses",value:function(e,t){var n=new zG(e,t),r=[];return this.moveds.some(function(e){return e.equals(n)})&&r.push("moved"),r}},{key:"getPieceClasses",value:function(e,t){var n=new zG(e,t),r=HG.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(function(e){return e.equals(n)})&&i.push("highlighted"),i}}]),n}($G)).\u0275fac=function(e){return new(e||Gq)(Vp.Lb(qG))},Gq.\u0275cmp=Vp.Fb({type:Gq,selectors:[["app-abalone"]],features:[Vp.yb],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,jq,2,1,"g",1),Vp.Qb(2,"defs"),Vp.Ac(3,Uq,2,1,"marker",2),Vp.Pb(),Vp.Ac(4,Vq,4,12,"g",1),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",t.hexaBoard),Vp.Bb(2),Vp.mc("ngForOf",t.directions),Vp.Bb(1),Vp.mc("ngForOf",t.directions))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),Gq),Zq=((Hq=function(){function e(t){Qp(this,e),this.x=t}return Kp(e,[{key:"equals",value:function(e){return this.x===e.x}}],[{key:"from",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return vz(3===t,"Invalid Apagos Coord "+t),e.THREE}}}]),e}()).ZERO=new Hq(0),Hq.ONE=new Hq(1),Hq.TWO=new Hq(2),Hq.THREE=new Hq(3),Hq),Qq=function(){var e=function e(){Qp(this,e)};return e.PIECE_SHOULD_MOVE_DOWNWARD=function(){return $localize(q||(q=xp(["Pieces should only move downward!"])))},e.CANNOT_LAND_ON_A_FULL_SQUARE=function(){return $localize(W||(W=xp(["That square is already full, you cannot put a piece in it!"])))},e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=function(){return $localize($||($=xp(["You have no pieces in that square, select one that contains at least one of your pieces!"])))},e.NO_PIECE_REMAINING_TO_DROP=function(){return $localize(Z||(Z=xp(["There are no remaining pieces of that color to drop!"])))},e.NO_POSSIBLE_TRANSFER_REMAINS=function(){return $localize(Q||(Q=xp(["There is no possible transfer from that square!"])))},e}(),Yq=((zq=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this)).landing=e,o.piece=r,o.starting=i,o}return Kp(n,[{key:"isDrop",value:function(){return this.piece.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}},{key:"equals",value:function(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}],[{key:"drop",value:function(e,t){return dz.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(kz.empty())}))}},{key:"transfer",value:function(e,t){if(e.x<=t.x)return sz.failure(Qq.PIECE_SHOULD_MOVE_DOWNWARD());var r=dz.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(t)&&n.piece.equals(kz.empty())&&n.starting.equals(kz.of(e))}));return sz.success(r)}}]),n}(hq)).ALL_MOVES=[new zq(Zq.ZERO,kz.of(HG.ZERO),kz.empty()),new zq(Zq.ONE,kz.of(HG.ZERO),kz.empty()),new zq(Zq.TWO,kz.of(HG.ZERO),kz.empty()),new zq(Zq.THREE,kz.of(HG.ZERO),kz.empty()),new zq(Zq.ZERO,kz.of(HG.ONE),kz.empty()),new zq(Zq.ONE,kz.of(HG.ONE),kz.empty()),new zq(Zq.TWO,kz.of(HG.ONE),kz.empty()),new zq(Zq.THREE,kz.of(HG.ONE),kz.empty()),new zq(Zq.TWO,kz.empty(),kz.of(Zq.THREE)),new zq(Zq.ONE,kz.empty(),kz.of(Zq.THREE)),new zq(Zq.ZERO,kz.empty(),kz.of(Zq.THREE)),new zq(Zq.ONE,kz.empty(),kz.of(Zq.TWO)),new zq(Zq.ZERO,kz.empty(),kz.of(Zq.TWO)),new zq(Zq.ZERO,kz.empty(),kz.of(Zq.ONE))],zq.encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return zq.ALL_MOVES.length}},{key:"encodeNumber",value:function(e){var t=zq.ALL_MOVES.findIndex(function(t){return t.equals(e)});return vz(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}},{key:"decodeNumber",value:function(e){return vz(e<zq.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),zq.ALL_MOVES[e]}}]),n}(wz)),zq),Kq=function(){function e(t){Qp(this,e),this.containing=t}return Kp(e,[{key:"isFull",value:function(){return this.count(HG.ZERO)+this.count(HG.ONE)>=this.count(HG.NONE)}},{key:"count",value:function(e){return this.containing.get(e).get()}},{key:"addPiece",value:function(t){vz(t!==HG.NONE,"should not call ApagosSquare.addPiece with Player.NONE");var n=this.count(HG.ZERO),r=this.count(HG.ONE),i=this.count(HG.NONE);return t===HG.ZERO?n++:r++,e.from(n,r,i).get()}},{key:"substractPiece",value:function(t){vz(t!==HG.NONE,"should not call ApagosSquare.addPiece with Player.NONE");var n=this.count(HG.ZERO),r=this.count(HG.ONE),i=this.count(HG.NONE);return t===HG.ZERO?n--:r--,e.from(n,r,i).get()}},{key:"getDominatingPlayer",value:function(){var e=this.count(HG.ZERO),t=this.count(HG.ONE);return e>t?HG.ZERO:t>e?HG.ONE:HG.NONE}},{key:"equals",value:function(e){return this.containing.equals(e.containing)}}],[{key:"from",value:function(t,n,r){if(t+n>r)return sz.failure("invalid starting space");var i=new vq;i.set(HG.ZERO,t),i.set(HG.ONE,n),i.set(HG.NONE,r),i.makeImmutable();var o=new e(i);return sz.success(o)}}]),e}(),Jq=((qq=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e)).board=r,o.remaining=i,o.remaining.makeImmutable(),o}return Kp(n,[{key:"getPieceAt",value:function(e){return this.board[e.x]}},{key:"updateAt",value:function(e,t){for(var r=[],i=0;i<4;i++)r.push(e.x===i?t:this.board[i]);var o=this.getRemainingCopy();return new n(this.turn,r,o)}},{key:"getRemainingCopy",value:function(){return this.remaining.getCopy()}},{key:"getRemaining",value:function(e){return this.remaining.get(e).get()}},{key:"equals",value:function(e){return this.turn===e.turn&&rq.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}},{key:"fromRepresentation",value:function(e,t,r,i){for(var o=[],a=0;a<4;a++){var s=Kq.from(t[0][a],t[1][a],t[2][a]).get();o.push(s)}var u=new vq;return u.set(HG.ZERO,r),u.set(HG.ONE,i),new n(e,o,u)}}]),n}(uq)).PIECES_PER_PLAYER=10,qq),Xq=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);var i=new Jq(t.turn+1,t.board,n),o=e.piece.get(),a=i.getPieceAt(e.landing).addPiece(o);if(e.landing===Zq.THREE)return i.updateAt(e.landing,a);var s=Zq.from(e.landing.x+1),u=i.getPieceAt(s);return i.updateAt(e.landing,u).updateAt(s,a)}},{key:"applyLegalTransfer",value:function(e,t){var n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),o=t.getPieceAt(e.landing).addPiece(n),a=t.updateAt(r,i);return a=a.updateAt(e.landing,o),new Jq(a.turn+1,a.board,a.remaining)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.landing).isFull()?sz.failure(Qq.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}},{key:"isLegalDrop",value:function(e,t){return t.getRemaining(e.piece.get())<=0?sz.failure(Qq.NO_PIECE_REMAINING_TO_DROP()):sz.success(void 0)}},{key:"isLegalSlideDown",value:function(e,t){var n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?sz.failure(Qq.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):sz.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=0;n<4;n++)if(!1===t.getPieceAt(Zq.from(n)).isFull())return bq.ONGOING;var r=t.getPieceAt(Zq.THREE).getDominatingPlayer();return bq.getVictory(r)}}],[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n(Jq)),mq.ruler=this.singleton,this.singleton}}]),n}(_q),eW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t=e.gameState;return Yq.ALL_MOVES.filter(function(e){return Xq.get().isLegal(e,t).isSuccess()})}},{key:"getBoardValue",value:function(e){var t=Xq.get().getGameStatus(e);if(t.isEndGame)return oq.fromWinner(t.winner);var n=e.gameState.board[3].getDominatingPlayer();return new oq(n.getScoreModifier())}}]),n}(iq),tW=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(Y||(Y=xp(["Initial board and goal of the game"]))),$localize(K||(K=xp(["At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!"]))),Jq.getInitialState()),Eq.anyMove($localize(J||(J=xp(["Drop"]))),$localize(X||(X=xp(["There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You play Light.<br/><br/>Drop a piece on one of those three squares."]))),Jq.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),Yq.drop(Zq.ZERO,HG.ZERO),$localize(ee||(ee=xp(["Congratulations!"])))),Eq.fromPredicate($localize(te||(te=xp(["Transfer"]))),$localize(ne||(ne=xp(["The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!"]))),Jq.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),Yq.transfer(Zq.TWO,Zq.ZERO).get(),function(e,t){return e.isDrop()?lz.failure($localize(re||(re=xp(["This move is a drop, please do a transfer!"])))):lz.SUCCESS},$localize(ie||(ie=xp(["Congratulations!"])))),Eq.fromPredicate($localize(oe||(oe=xp(["Victory"]))),$localize(ae||(ae=xp(["When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!"]))),Jq.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),Yq.drop(Zq.TWO,HG.ONE),function(e,t){return e.isDrop()?e.piece.equalsValue(HG.ONE)?lz.SUCCESS:lz.failure($localize(se||(se=xp(["You actively made your opponent win!"])))):lz.failure($localize(ue||(ue=xp(["Wrong choice, your opponent will win in the next turn no matter which piece is dropped!"]))))},$localize(ce||(ce=xp(["Congratulations!"]))))]};function nW(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",5)),2&e){var n=t.$implicit,r=Vp.fc();Vp.Cb("cx",(n+1)*r.PIECE_RADIUS)("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function rW(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polygon",7),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc();return t.onArrowClick(e,t.Player.ZERO)}),Vp.Pb()}if(2&e){var r=Vp.fc().index,i=Vp.fc();Vp.nc("id","dropArrow_zero_",r,""),Vp.mc("ngClass",i.getArrowClasses(r,i.Player.ZERO)),Vp.Cb("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.Player.ZERO))}}function iW(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polygon",7),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc();return t.onArrowClick(e,t.Player.ONE)}),Vp.Pb()}if(2&e){var r=Vp.fc().index,i=Vp.fc();Vp.nc("id","dropArrow_one_",r,""),Vp.mc("ngClass",i.getArrowClasses(r,i.Player.ONE)),Vp.Cb("points",i.ARROW_COORD)("transform",i.getArrowTransform(r,i.Player.ONE))}}function oW(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Ob(0),Vp.Qb(1,"circle",8),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index;return Vp.fc().onSquareClick(e)}),Vp.Pb(),Vp.Nb()}if(2&e){var r=t.$implicit,i=Vp.fc(),o=i.index,a=i.$implicit,s=Vp.fc();Vp.Bb(1),Vp.pc("id","square_",o,"_piece_",r,"_out_of_",a.count(s.Player.NONE),""),Vp.mc("ngClass",s.getPieceClasses(o,r,a)),Vp.Cb("cx",s.getCircleCenter(o,r,a).x)("cy",s.getCircleCenter(o,r,a).y)}}function aW(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Ob(0),Vp.Ac(1,rW,1,4,"polygon",6),Vp.Ac(2,iW,1,4,"polygon",6),Vp.Qb(3,"rect",7),Vp.cc("click",function(){Vp.wc(n);var e=t.index;return Vp.fc().onSquareClick(e)}),Vp.Pb(),Vp.Ac(4,oW,2,6,"ng-container",3),Vp.Nb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",o.canDisplayArrow(i,o.Player.ZERO)),Vp.Bb(1),Vp.mc("ngIf",o.canDisplayArrow(i,o.Player.ONE)),Vp.Bb(1),Vp.nc("id","square_",i,""),Vp.mc("ngClass",o.getSquareClasses(i)),Vp.Cb("x",i*o.SPACE_SIZE)("y",(5-i)*o.SPACE_SIZE*.25)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngForOf",o.range(r.count(o.Player.NONE)))}}function sW(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",9)),2&e){var n=t.$implicit,r=Vp.fc();Vp.Cb("cx",4*r.SPACE_SIZE-(n+1)*r.PIECE_RADIUS)("cy",2.25*r.SPACE_SIZE+3*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}var uW,cW,lW,hW,fW=((cW=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).Player=HG,r.ARROW_COORD=n.getArrowCoord(),r.PIECES_PER_PLAYER=Jq.PIECES_PER_PLAYER,r.selectedPiece=kz.empty(),r.leftPiece=kz.empty(),r.droppedPiece=kz.empty(),r.displayableArrow=[],r.rules=new Xq(Jq),r.availableMinimaxes=[new eW(r.rules,"ApagosDummyMinimax")],r.encoder=Yq.encoder,r.tutorial=(new tW).tutorial,r.PIECE_RADIUS=200/(r.PIECES_PER_PLAYER+1),r.updateBoard(),r}return Kp(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=kz.empty(),this.showPossibleDrops()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.board,this.remainingZero=e.remaining.get(HG.ZERO).get(),this.remainingOne=e.remaining.get(HG.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}},{key:"hideLastMove",value:function(){this.movedSquare=[],this.droppedPiece=kz.empty(),this.leftPiece=kz.empty(),this.selectedPiece=kz.empty()}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}},{key:"showLastDrop",value:function(e){var t=e.piece.get(),n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));var r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=kz.of({square:n,piece:r})}},{key:"getLowestPlayerPiece",value:function(e,t){var n=e.count(t);return t===HG.ZERO?n-1:e.count(HG.NONE)-n}},{key:"showLastTransfer",value:function(e){var t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=kz.of({square:r,piece:i});var o=e.landing.x,a=this.getLowestPlayerPiece(this.board[o],n);this.droppedPiece=kz.of({square:o,piece:a})}},{key:"showPossibleDrops",value:function(){this.displayableArrow=[];for(var e=this.rules.node.gameState,t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(HG.ZERO).get()>0&&this.displayableArrow.push({x:t,player:HG.ZERO}),e.remaining.get(HG.ONE).get()>0&&this.displayableArrow.push({x:t,player:HG.ONE}))}},{key:"getCircleCenter",value:function(e,t,n){var r=e*this.SPACE_SIZE+.5*this.SPACE_SIZE,i=(5-e)*this.SPACE_SIZE*.25+.5*this.SPACE_SIZE;if(1===n.count(HG.NONE))return new zG(r,i);var o=n.count(HG.NONE),a=2*t*Math.PI/o-Math.PI/2,s=.3*this.SPACE_SIZE,u=s*Math.cos(a),c=s*Math.sin(a);return new zG(r+u,i+c)}},{key:"canDisplayArrow",value:function(e,t){return this.displayableArrow.some(function(n){return n.x===e&&n.player.equals(t)})}},{key:"getArrowClasses",value:function(e,t){return[this.getPlayerClass(t)]}},{key:"getArrowTransform",value:function(e,t){var n=t===HG.ZERO?0:.5*this.SPACE_SIZE;return"translate("+(n+=e*this.SPACE_SIZE)+", "+(3-e)*this.SPACE_SIZE*.25+")"}},{key:"getSquareClasses",value:function(e){var t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected"):this.movedSquare.includes(e)&&t.push("last-move"),t}},{key:"onArrowClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#dropArrow_"+(t===HG.ZERO?"zero":"one")+"_"+e)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return o=Zq.from(e),n.selectedPiece.isPresent()?(s=n.selectedPiece.get().square,a=Yq.transfer(Zq.from(s),o).get()):a=Yq.drop(o,t),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 6:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e,t,n){var r={square:e,piece:t},i=[],o=n.count(HG.ZERO),a=n.count(HG.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected");else if(this.droppedPiece.equalsValue(r))i.push("last-move");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.rules.node.gameState.getCurrentOpponent()===HG.ZERO?o++:a++}var s=n.count(HG.NONE)-(a+o),u=this.getPieceColor(t,o,s);return""!==u&&i.push(u),i}},{key:"getPieceColor",value:function(e,t,n){return e<t?"player0":e>=t+n?"player1":""}},{key:"onSquareClick",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.selectedPiece.isPresent()||t.selectedPiece.get().square!==e){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),lz.SUCCESS));case 5:return i=t.rules.node.gameState.getCurrentPlayer(),o=t.board[e],n.abrupt("return",o.count(i)<=0?t.cancelMove(Qq.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=kz.of({square:e,piece:t.getLowestPlayerPiece(o,i)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(Qq.NO_POSSIBLE_TRANSFER_REMAINS()):lz.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"showAndGetPossibleTranfers",value:function(){this.displayableArrow=[];for(var e=this.selectedPiece.get().square-1,t=this.rules.node.gameState.getCurrentPlayer();0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}}],[{key:"getArrowCoord",value:function(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}}]),n}(WG)).\u0275fac=function(e){return new(e||cW)(Vp.Lb(qG))},cW.\u0275cmp=Vp.Fb({type:cW,selectors:[["app-apagos"]],features:[Vp.yb],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-8 -8 416 350","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player0",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],["class","base mid-stroke player1",4,"ngFor","ngForOf"],[1,"base","mid-stroke","player0"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","player1"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,nW,1,3,"circle",1),Vp.Qb(2,"g",2),Vp.Ac(3,aW,5,9,"ng-container",3),Vp.Pb(),Vp.Ac(4,sW,1,3,"circle",4),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",t.range(t.remainingZero)),Vp.Bb(1),Vp.Cb("transform","translate(0, "+2*t.PIECE_RADIUS+")"),Vp.Bb(1),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngForOf",t.range(t.remainingOne)))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),cW),dW=((uW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return n}(WG)).\u0275fac=function(e){return pW(e||uW)},uW.\u0275cmp=Vp.Fb({type:uW,selectors:[["ng-component"]],features:[Vp.yb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),uW),pW=Vp.Sb(dW),vW=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e,r)).captured=i,o}return Kp(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}}],[{key:"getInitialState",value:function(){return new n(rq.createTable(6,2,4),0,[0,0])}}]),n}(cq),gW=function(){var e=function e(){Qp(this,e)};return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=function(){return $localize(le||(le=xp(["You cannot distribute from the opponent's home."])))},e.MUST_CHOOSE_NONEMPTY_HOUSE=function(){return $localize(he||(he=xp(["You should choose a non-empty house to distribute."])))},e.SHOULD_DISTRIBUTE=function(){return $localize(fe||(fe=xp(["You should distribute but you do not."])))},e}(),yW=((hW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,r){pz(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:t});var i=e.x,o=t.getCurrentPlayer().value,a=t.getCurrentPlayer().getOpponent().value,s=t.getCopiedBoard(),u=n.distribute(i,o,s);if(u.y===o)return new vW(s,t.turn+1,t.captured);var c=[0,0],l=rq.copyBiArray(s);return c[o]=n.capture(u.x,a,o,s),c[o]>0&&n.isStarving(a,s)&&(s=l,c=[0,0]),n.isStarving(o,s)&&!1===n.canDistribute(a,s)&&(c[a]+=n.mansoon(a,s)),c[0]+=t.captured[0],c[1]+=t.captured[1],new vW(s,t.turn+1,c)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"mansoon",value:function(e,t){var n=0,r=0;do{n+=t[e][r],t[e][r]=0,r++}while(r<6);return n}},{key:"isLegal",value:function(e,t){var r=t.getCurrentPlayer().value,i=t.getCurrentPlayer().getOpponent().value,o=e.x;if(0===t.getPieceAtXY(o,r))return sz.failure(gW.MUST_CHOOSE_NONEMPTY_HOUSE());var a=n.isStarving(i,t.board),s=!1===n.doesDistribute(o,r,t.board);return a&&s?sz.failure(gW.SHOULD_DISTRIBUTE()):sz.success(void 0)}},{key:"doesDistribute",value:function(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}},{key:"canDistribute",value:function(e,t){for(var r=0;r<6;r++)if(n.doesDistribute(r++,e,t))return!0;return!1}},{key:"isStarving",value:function(e,t){var n=0;do{if(t[e][n++]>0)return!1}while(n<6);return!0}},{key:"distribute",value:function(e,t,n){var r=e,i=t,o=n[t][e];for(n[t][e]=0;o>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,e===r&&t===i||(n[t][e]+=1,o--);return new zG(e,t)}},{key:"capture",value:function(e,t,n,r){vz(t!==n,"AwaleRules.capture called with wrong values of x and player");var i=r[t][e];if(i<2||i>3)return 0;var o=0,a=-1,s=-1;0===n&&(a=1,s=6);do{o+=i,r[t][e]=0,i=r[t][e+=a]}while(e!==s&&(2===i||3===i));return o}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captured[0]>24?bq.ZERO_WON:t.captured[1]>24?bq.ONE_WON:24===t.captured[0]&&24===t.captured[1]?bq.DRAW:bq.ONGOING}}]),n}(_q)).VERBOSE=!1,hW),mW=((lW=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this)).x=e,r}return Kp(n,[{key:"equals",value:function(e){return e===this||e.x===this.x}},{key:"toString",value:function(){return"AwaleMove("+this.x+")"}}],[{key:"from",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;default:return vz(5===e,"Invalid x for AwaleMove: "+e),n.FIVE}}}]),n}(hq)).ZERO=new lW(0),lW.ONE=new lW(1),lW.TWO=new lW(2),lW.THREE=new lW(3),lW.FOUR=new lW(4),lW.FIVE=new lW(5),lW.encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return lW.from(e)}}]),n}(wz)),lW),bW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState,i=r.turn%2,o=0;do{0!==r.getPieceAtXY(o,i)&&(t=mW.from(o),yW.isLegal(t,r).isSuccess()&&(t=mW.from(o),n.push(t))),o++}while(o<6);return this.orderMoves(e,n)}},{key:"orderMoves",value:function(e,t){var n=e.gameState.getCurrentPlayer().value,r=e.gameState.getCurrentPlayer().getOpponent().value;return rq.sortByDescending(t,function(t){var i,o=e.gameState.getCopiedBoard(),a=o[n][t.x],s=yW.distribute(t.x,n,o),u=0;return s.y===n?(i=0,a<=6&&(u=10)):i=yW.capture(s.x,r,n,o),100*i+u-a}),t}},{key:"getBoardValue",value:function(e){var t=yW.getGameStatus(e);if(t.isEndGame)return oq.fromWinner(t.winner);var n=e.gameState.getCapturedCopy();return new oq(n[1]-n[0])}}]),n}(iq),_W=function e(){Qp(this,e),this.tutorial=[Eq.anyMove($localize(de||(de=xp(["Sowing"]))),$localize(pe||(pe=xp(["Awal\xe9 is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.\n         Let's see how seeds are sown.\n         As you're playing first, the 6 houses on the top are yours.<br/><br>\n         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house."]))),vW.getInitialState(),mW.ZERO,$localize(ve||(ve=xp(["Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.\n        This is how seeds are sown:\n        one by one from the house next to the one they come from, clockwise."])))),Eq.anyMove($localize(ge||(ge=xp(["Big sowing"]))),$localize(ye||(ye=xp(["You are now the second player (on the bottom).\n        When there are enough seeds to make a full turn, something else happens.<br/><br/>\n        Sow the house that contains 12 seeds."]))),new vW([[0,0,0,0,0,0],[0,12,0,0,0,0]],1,[0,0]),mW.ONE,$localize(me||(me=xp(["See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds)."])))),Eq.fromMove($localize(be||(be=xp(["Simple capture"]))),$localize(_e||(_e=xp(["After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.\n         Then, the player looks at the preceding house:\n         if it is still in the opponent's side and contains two or three seeds, they are also captured.\n         This continues until we reach either the player's side or a house containing neither two nor three seeds.<br/><br/>\n         You are the second player, try to capture some pieces!"]))),new vW([[1,0,0,0,1,0],[1,0,0,0,1,0]],1,[0,0]),[mW.ZERO],$localize(we||(we=xp(["Well done! This was a simple capture, now let us see how to make multiple captures."]))),$localize(ke||(ke=xp(["Failed. Try again and sow from the leftmost house."])))),Eq.fromMove($localize(Ce||(Ce=xp(["Multiple captures"]))),$localize(Ee||(Ee=xp(["By sowing from your leftmost house, you will change the number of seeds in a house from 2 to 3, and from the preceding house from 1 to 2.\n        As these are consecutive houses, all seeds in them will be captured.<br/><br/>\n        Capture them."]))),new vW([[2,1,0,0,1,0],[2,0,0,0,1,0]],1,[0,0]),[mW.ZERO],$localize(Oe||(Oe=xp(["Nice, you win 3 points from the first house, and 2 from the second!"]))),$localize(Se||(Se=xp(["Failed. Try again."])))),Eq.fromMove($localize(Pe||(Pe=xp(["Interrupted capture"]))),$localize(Ie||(Ie=xp(["By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>\n        Do it."]))),new vW([[1,0,1,0,0,1],[3,0,0,0,1,0]],1,[0,0]),[mW.ZERO],$localize(Te||(Te=xp(["Notice that because the second house was not capturable, the captured was interrupted and you have not captured the first house."]))),$localize(Ae||(Ae=xp(["Failed. Try again."])))),Eq.fromMove($localize(Ne||(Ne=xp(["Capture on the other side only"]))),$localize(xe||(xe=xp(["Try to capture the two leftmost houses of the opponent."]))),new vW([[2,2,0,0,1,0],[1,3,0,0,0,0]],1,[0,0]),[mW.ONE],$localize(Re||(Re=xp(["Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!"]))),$localize(Me||(Me=xp(["You have only captured one house, try again!"])))),Eq.fromMove($localize(De||(De=xp(["Do not starve"]))),$localize(Le||(Le=xp(["You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>\n        Try it."]))),new vW([[1,1,1,1,1,0],[5,0,0,1,0,0]],1,[0,0]),[mW.ZERO],$localize(Be||(Be=xp(["Sadly, you cannot capture here, otherwise the opponent could not play after you.\n        When this happens, the move can be made, but no capture takes place!"]))),$localize(Fe||(Fe=xp(["Failed. Try again."])))),Eq.anyMove($localize(je||(je=xp(["Feeding is mandatory"]))),$localize(Ue||(Ue=xp(["You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>\n        Go ahead!"]))),new vW([[0,0,0,0,0,0],[0,1,2,4,4,5]],1,[0,0]),mW.THREE,$localize(Ve||(Ve=xp(["Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.\n        It is often a good way to have easy captures!"])))),Eq.anyMove($localize(ze||(ze=xp(["End of the game"]))),$localize(He||(He=xp(["A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>\n         Sow the house on the top right."]))),new vW([[0,0,0,0,0,1],[0,1,2,3,4,4]],0,[0,0]),mW.FIVE,$localize(Ge||(Ge=xp(["Also, as soon as on player cannot play, the other player captures all the seeds in its own side.\n         Here, it was the first player's turn, and the second player has taken all the remaining seeds."]))))]};function wW(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"circle",4),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onClick(e,r)}),Vp.Pb(),Vp.Qb(2,"text",5),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onClick(e,r)}),Vp.Cc(3),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc().index,a=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",i,"_",o,""),Vp.mc("ngClass",a.getSquareClasses(i,o)),Vp.Cb("cx",50+100*i)("cy",50+120*o),Vp.Bb(1),Vp.Cb("x",50+100*i)("y",66+120*o),Vp.Bb(1),Vp.Ec(" ",r," ")}}function kW(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,wW,4,8,"g",2),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}var CW,EW,OW,SW,PW,IW,TW=((CW=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).last=kz.empty(),r.captured=[],r.moved=[],r.scores=kz.of([0,0]),r.rules=new yW(vW),r.availableMinimaxes=[new bW(r.rules,"AwaleMinimax")],r.encoder=mW.encoder,r.tutorial=(new _W).tutorial,r.updateBoard(),r}return Kp(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.scores=kz.of(e.getCapturedCopy()),this.hidePreviousMove();var t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){var n=e.getCurrentOpponent().value;this.last=kz.of(new zG(t.get().x,n)),this.showPreviousMove()}else this.last=kz.empty()}},{key:"hidePreviousMove",value:function(){this.captured=[],this.moved=[]}},{key:"showPreviousMove",value:function(){for(var e=this.rules.node.mother.get().gameState,t=0;t<=1;t++)for(var n=0;n<=5;n++){var r=new zG(n,t),i=this.board[t][n],o=e.getPieceAt(r);this.last.equalsValue(r)||(i<o?this.captured.push(r):i>o&&this.moved.push(r))}}},{key:"onClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(t===n.rules.node.gameState.getCurrentPlayer().value){r.next=5;break}return r.abrupt("return",n.cancelMove(gW.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME()));case 5:return n.last=kz.empty(),o=mW.from(e),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState,n.scores.get()));case 8:case"end":return r.stop()}},r)}))()}},{key:"getSquareClasses",value:function(e,t){var n=new zG(e,t);return this.captured.some(function(e){return e.equals(n)})?["captured"]:this.last.equalsValue(n)?["moved","highlighted"]:this.moved.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(dW)).\u0275fac=function(e){return new(e||CW)(Vp.Lb(qG))},CW.\u0275cmp=Vp.Fb({type:CW,selectors:[["app-awale-component"]],features:[Vp.yb],decls:4,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"click"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Mb(1,"rect",1),Vp.Ac(2,kW,2,1,"g",2),Vp.Mb(3,"line",3),Vp.Pb()),2&e&&(Vp.Bb(2),Vp.mc("ngForOf",t.board))},directives:[vg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),CW),AW=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;if(Qp(this,n),i=t.call(this,e.x,e.y),e.equals(r))throw new Error(nq.MOVE_CANNOT_BE_STATIC());return i.end=r,tv(i)}return Kp(n,[{key:"length",value:function(){return this.coord.getDistance(this.end)}},{key:"getDirection",value:function(){return jG.factory.fromMove(this.coord,this.end)}}],[{key:"getEncoder",value:function(e,t,n){return new(function(r){Jp(o,r);var i=ev(o);function o(){var n;return Qp(this,o),(n=i.apply(this,arguments)).shiftAX=t,n.shiftDY=n.shiftAX*e,n.shiftDX=n.shiftDY*t,n}return Kp(o,[{key:"maxValue",value:function(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var o=new zG((r-=r%1)%e,i);r/=e;var a=(r-=r%1)%t;r/=t;var s=new zG((r-=r%1)%e,a);return n(s,o)}}]),o}(wz))}}]),n}(fq),NW=function(){var e=function e(){Qp(this,e)};return e.LANDING_ON_OCCUPIED_CASE=function(){return $localize(qe||(qe=xp(["You cannot land on an occupied square."])))},e.THRONE_IS_LEFT_FOR_GOOD=function(){return $localize(We||(We=xp(["Once you left the central throne, you cannot return to it."])))},e.SOLDIERS_CANNOT_SIT_ON_THRONE=function(){return $localize($e||($e=xp(["Soldiers cannot sit on the throne."])))},e.SOMETHING_IN_THE_WAY=function(){return $localize(Ze||(Ze=xp(["Something is in the way."])))},e.MOVE_MUST_BE_ORTHOGONAL=function(){return $localize(Qe||(Qe=xp(["Tafl moves must be orthogonal."])))},e}(),xW=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;if(Qp(this,n),i=t.call(this,e,r),e.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(r.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+r.toString()+".");var o=e.getDirectionToward(r);if(o.isFailure()||o.get().isDiagonal())throw new Error(NW.MOVE_MUST_BE_ORTHOGONAL());return tv(i)}return Kp(n,[{key:"equals",value:function(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"TaflMove("+this.coord+"->"+this.end+")"}}]),n}(AW),RW=((EW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getMaximalDistance",value:function(){return 7}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return sz.success(r)}catch(fV){return sz.failure(fV.message)}}}]),n}(xW)).encoder=AW.getEncoder(7,7,EW.of),EW),MW={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:HG.ZERO},DW=((OW=function(){function e(t,n){Qp(this,e),this.owner=t,this.king=n}return Kp(e,[{key:"isKing",value:function(){return this.king}},{key:"getOwner",value:function(){return this.owner}}]),e}()).UNOCCUPIED=new OW(HG.NONE,!1),OW.PLAYER_ONE_KING=new OW(HG.ONE,!0),OW.INVADERS=new OW(HG.ZERO,!1),OW.DEFENDERS=new OW(HG.ONE,!1),OW),LW=function(){var e=function e(t){Qp(this,e),this.value=t};return e.NONE=new e("NONE"),e.OPPONENT=new e("OPPONENT"),e.PLAYER=new e("PLAYER"),e}(),BW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"isCentralThrone",value:function(e){return e.equals(this.getCentralThrone())}},{key:"getCentralThrone",value:function(){var e=(this.board.length-1)/2;return new zG(e,e)}},{key:"getRelativeOwner",value:function(e,t){var n=this.getAbsoluteOwner(t);return n===HG.NONE?LW.NONE:e===n?LW.PLAYER:LW.OPPONENT}},{key:"getAbsoluteOwner",value:function(e){return this.getPieceAt(e).getOwner()}}]),n}(cq),FW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=DW.UNOCCUPIED,t=DW.INVADERS,r=DW.DEFENDERS;return new n([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,DW.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}]),n}(BW),jW=((SW=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e)).config=r,o.generateMove=i,o}return Kp(n,[{key:"isLegal",value:function(e,t){pz(n.VERBOSE,{tablutRules_isLegal:{move:e,state:t}});var r=t.getCurrentPlayer(),i=this.getMoveValidity(r,e,t);return i.isFailure()?sz.failure(i.getReason()):sz.success(void 0)}},{key:"getMoveValidity",value:function(e,t,n){var r=n.getRelativeOwner(e,t.coord);if(r===LW.NONE)return lz.failure(nq.MUST_CHOOSE_PLAYER_PIECE());if(r===LW.OPPONENT)return lz.failure(nq.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==LW.NONE)return lz.failure(NW.LANDING_ON_OCCUPIED_CASE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return lz.failure(NW.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return lz.failure(NW.THRONE_IS_LEFT_FOR_GOOD())}for(var i=t.coord.getDirectionToward(t.end).get(),o=t.coord.getOrthogonalDistance(t.end),a=t.coord.getNext(i),s=1;s<o;s++){if(n.getPieceAt(a)!==DW.UNOCCUPIED)return lz.failure(NW.SOMETHING_IN_THE_WAY());a=a.getNext(i)}return lz.SUCCESS}},{key:"isThrone",value:function(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}},{key:"isExternalThrone",value:function(e){var t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}},{key:"tryCapture",value:function(e,t,n,r){var i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(e,i)!==LW.OPPONENT?kz.empty():r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):kz.empty()}},{key:"captureKing",value:function(e,t,n,r){var i=t.getNext(n),o=this.getSurroundings(i,n,e,r),a=o.backCoord,s=o.back,u=o.backInRange,c=o.left,l=o.leftCoord,h=o.right,f=o.rightCoord;return!1===u?this.captureKingAgainstTheWall(c,h,i):s===LW.NONE&&this.isThrone(r,a)?this.captureKingAgainstThrone(a,i,c,h):s===LW.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,h,f):kz.empty()}},{key:"getSurroundings",value:function(e,t,n,r){var i=e.getNext(t),o=i.isInRange(this.config.WIDTH,this.config.WIDTH),a=o?r.getRelativeOwner(n,i):LW.NONE,s=e.getLeft(t),u=s.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,s):LW.NONE,c=e.getRight(t),l=c.isInRange(this.config.WIDTH,this.config.WIDTH);return{backCoord:i,back:a,backInRange:o,leftCoord:s,left:u,rightCoord:c,right:l?r.getRelativeOwner(n,c):LW.NONE}}},{key:"captureKingAgainstTheWall",value:function(e,t,r){var i=e===LW.PLAYER?1:0;return 2===(i+=t===LW.PLAYER?1:0)&&this.config.BORDER_CAN_SURROUND_KING?(pz(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),kz.of(r)):kz.empty()}},{key:"captureKingAgainstThrone",value:function(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return kz.of(t)}else{var i=r===LW.PLAYER,o=n===LW.PLAYER||i;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&o)return kz.of(t)}return kz.empty()}},{key:"capturePawn",value:function(e,t,r,i){var o=t.getNext(r),a=o.getNext(r),s=LW.NONE;return a.isInRange(this.config.WIDTH,this.config.WIDTH)&&(s=i.getRelativeOwner(e,a)),s===LW.NONE?!1===this.isThrone(i,a)?(pz(n.VERBOSE||!1,"cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),kz.empty()):(pz(n.VERBOSE||!1,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),kz.of(o)):s===LW.PLAYER?(pz(n.VERBOSE||!1,"pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),kz.of(o)):(pz(n.VERBOSE||!1,"no captures; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),kz.empty())}},{key:"captureKingWithAtLeastASandwich",value:function(e,t,r,i,o,a){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return kz.of(t);var s=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,i),c=r===LW.PLAYER||u&&s,l=this.isThrone(e,a);return c&&(o===LW.PLAYER||l&&s)?(pz(n.VERBOSE||!1,"king captured by 4 invaders"),kz.of(t)):kz.empty()}},{key:"kingTouchCentralThrone",value:function(e,t){var n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}},{key:"applyLegalMove",value:function(e,t){pz(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:t}});var r=t.turn,i=t.getCopiedBoard(),o=t.getCurrentPlayer(),a=e.coord,s=e.end;i[s.y][s.x]=i[a.y][a.x],i[a.y][a.x]=DW.UNOCCUPIED;var u,c=zp(VG.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=this.tryCapture(o,e.end,l,t);h.isPresent()&&(i[h.get().y][h.get().x]=DW.UNOCCUPIED)}}catch(f){c.e(f)}finally{c.f()}return t.from(i,r+1)}},{key:"getGameStatus",value:function(e){var t=this.getWinner(e.gameState);return t.isPresent()?bq.getVictory(t.get()):bq.ONGOING}},{key:"getWinner",value:function(e){var t=this.getKingCoord(e);if(t.isAbsent())return pz(!1,"The king is dead, victory to invader"),kz.of(this.getInvader());var n=t.get();return this.isExternalThrone(n)?(pz(!1,"The king escape, victory to defender"),kz.of(this.getDefender())):this.isPlayerImmobilized(HG.ZERO,e)?(pz(!1,"Zero has no move, victory to one"),kz.of(HG.ONE)):this.isPlayerImmobilized(HG.ONE,e)?(pz(!1,"One has no move, victory to zero"),kz.of(HG.ZERO)):(pz(!1,"no victory"),kz.empty())}},{key:"getKingCoord",value:function(e){pz(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(var t=0;t<this.config.WIDTH;t++)for(var r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return kz.of(new zG(r,t));return kz.empty()}},{key:"getInvader",value:function(){return this.config.INVADER}},{key:"getDefender",value:function(){return this.config.INVADER.getOpponent()}},{key:"isPlayerImmobilized",value:function(e,t){return 0===this.getPlayerListMoves(e,t).length}},{key:"getPlayerListMoves",value:function(e,t){var r=[],i=this.getPlayerListPawns(e,t);pz(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:t}});var o,a=zp(i);try{for(a.s();!(o=a.n()).done;){var s,u=o.value,c=zp(this.getPossibleDestinations(u,t));try{for(c.s();!(s=c.n()).done;){var l=s.value,h=this.generateMove(u,l);r.push(h)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){a.e(f)}finally{a.f()}return r}},{key:"getPlayerListPawns",value:function(e,t){for(var n=[],r=0;r<this.config.WIDTH;r++)for(var i=0;i<this.config.WIDTH;i++){var o=new zG(i,r);t.getAbsoluteOwner(o)===e&&n.push(o)}return n}},{key:"getPossibleDestinations",value:function(e,t){var n,r,i=[],o=zp(VG.ORTHOGONALS);try{for(o.s();!(r=o.n()).done;){var a=r.value;n=e.getNext(a,1);for(var s=!1;n.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(n)===HG.NONE?this.isExternalThrone(n)?t.getPieceAt(e).isKing()&&i.push(n):t.isCentralThrone(n)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&i.push(n):i.push(n):s=!0,n=n.getNext(a,1)}}catch(u){o.e(u)}finally{o.f()}return i}}]),n}(_q)).VERBOSE=!1,SW),UW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.call(this,FW,MW,RW.of)}return Kp(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),mq.ruler=this.singleton,n.singleton}}]),n}(jW),VW=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e)).VERBOSE=r,o.generateMove=i,o.NONE=DW.UNOCCUPIED,o.captureds=[],o.chosen=new zG(-1,-1),o.lastMove=kz.empty(),o}return Kp(n,[{key:"getViewBox",value:function(){var e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}},{key:"updateBoard",value:function(){pz(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.rules.node.gameState.getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove()}},{key:"showPreviousMove",value:function(){var e,t=this.rules.node.mother.get().gameState,n=this.rules.node.gameState.getCurrentOpponent(),r=zp(VG.ORTHOGONALS);try{for(r.s();!(e=r.n()).done;){var i=e.value,o=this.lastMove.get().end.getNext(i,1);if(o.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){var a=t.getRelativeOwner(n,o)===LW.OPPONENT,s=this.rules.node.gameState.getPieceAt(o)===DW.UNOCCUPIED;a&&s&&this.captureds.push(o)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"onClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return pz(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")"),i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):-1===n.chosen.x?n.choosePiece(e,t):n.chooseDestination(e,t));case 3:case"end":return r.stop()}},r)}))()}},{key:"chooseDestination",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(pz(n.VERBOSE,"TaflComponent.chooseDestination"),i=n.chosen,o=new zG(e,t),!(a=n.generateMove(i,o)).isSuccess()){r.next=9;break}return n.cancelMove(),r.next=6,n.chooseMove(a.get(),n.rules.node.gameState);case 6:r.t0=r.sent,r.next=10;break;case 9:r.t0=n.cancelMove(a.getReason());case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return pz(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t][e]===DW.UNOCCUPIED?this.cancelMove(nq.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e,t)?(this.chosen=new zG(e,t),pz(this.VERBOSE,"selected piece = ("+e+", "+t+")"),lz.SUCCESS):this.cancelMove(nq.CANNOT_CHOOSE_OPPONENT_PIECE())}},{key:"pieceBelongToCurrentPlayer",value:function(e,t){var n=this.rules.node.gameState,r=n.getCurrentPlayer(),i=new zG(e,t);return n.getRelativeOwner(r,i)===LW.PLAYER}},{key:"cancelMoveAttempt",value:function(){this.chosen=new zG(-1,-1)}},{key:"isThrone",value:function(e,t){return this.rules.isThrone(this.rules.node.gameState,new zG(e,t))}},{key:"isCentralThrone",value:function(e,t){return!1===this.rules.node.gameState.isCentralThrone(new zG(e,t))}},{key:"getPieceClasses",value:function(e,t){var n=[],r=new zG(e,t),i=this.rules.node.gameState.getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equals(r)&&n.push("selected"),n}},{key:"getRectClasses",value:function(e,t){var n=[],r=new zG(e,t);if(this.captureds.some(function(e){return e.equals(r)}))n.push("captured");else if(this.lastMove.isPresent()){var i=this.lastMove.get().coord,o=this.lastMove.get().end;(r.equals(i)||r.equals(o))&&n.push("moved")}return n}},{key:"getClickables",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++)this.isClickable(n,t)&&e.push(new zG(n,t));return e}},{key:"isClickable",value:function(e,t){return this.pieceBelongToCurrentPlayer(e,t)}},{key:"isInvader",value:function(e,t){return this.board[t][e]===DW.INVADERS}},{key:"isKing",value:function(e,t){return this.board[t][e].isKing()}},{key:"getKingPolyline",value:function(e,t){return 85+100*e+" "+(85+100*t)+" "+(30+100*e)+" "+(30+100*t)+" "+(50+100*e)+" "+(10+100*t)+" "+(70+100*e)+" "+(30+100*t)+" "+(15+100*e)+" "+(85+100*t)}}]),n}(dW),zW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){pz(!1,{TaflMinimax_getListMoves:{node:e}});var t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}},{key:"orderMoves",value:function(e,t){var n=this,r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?rq.sortByDescending(t,function(e){return-e.end.getOrthogonalDistance(r)}):rq.sortByDescending(t,function(e){return e.coord.equals(r)?n.ruler.isExternalThrone(e.end)?2:1:0}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new oq(n.get().getVictoryValue());var r=this.ruler.getPlayerListPawns(HG.ZERO,t).length,i=this.ruler.getPlayerListPawns(HG.ONE,t).length,o=[1,2][this.ruler.config.INVADER.value];o*=HG.ZERO.getScoreModifier();var a=[2,1][this.ruler.config.INVADER.value];return a*=HG.ONE.getScoreModifier(),new oq(r*o+i*a)}}]),n}(iq),HW=function(){function e(t,n){Qp(this,e),this.directThreats=t,this.mover=n}return Kp(e,[{key:"equals",value:function(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}]),e}(),GW=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,new sq([e]),r)).directThreat=e,i.mover=r,i}return n}(HW),qW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"toFields",value:function(e){return[[e.y],e.x]}}]),n}(function(e,t){Jp(r,e);var n=ev(r);function r(e){var t;if(Qp(this,r),(t=n.call(this)).map=[],t.values=[],void 0!==e){var i,o=zp(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;t.add(a)}}catch(s){o.e(s)}finally{o.f()}}return tv(t)}return Kp(r,[{key:"add",value:function(e){var t,n=this.toFields(e),r=this.map,i=zp(n[0]);try{for(i.s();!(t=i.n()).done;){var o=t.value;void 0===r[o]&&(r[o]=[]),r=r[o]}}catch(s){i.e(s)}finally{i.f()}var a=n[1];return void 0===r[a]&&(r[a]=!0,this.values.push(e),!0)}},{key:"contains",value:function(e){var t,n=this.toFields(e),r=this.map,i=zp(n[0]);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(void 0===r[o])return!1;r=r[o]}}catch(a){i.e(a)}finally{i.f()}return void 0!==r[n[1]]}},{key:t,value:function(){return this.values.values()}}]),r}(sq,Symbol.iterator)),WW=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e,r)).width=i.ruler.config.WIDTH,i.maxInfluence=16*(2*i.width-2),i.scoreByThreatenedPiece=16*i.maxInfluence+1,i.scoreBySafePiece=16*i.scoreByThreatenedPiece+1,i}return Kp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new oq(t.toBoardValue());for(var n=e.gameState,r=DW.UNOCCUPIED,i=0,o=this.getPiecesMap(n),a=this.getThreatMap(n,o),s=this.filterThreatMap(a,n),u=0,c=[HG.ZERO,HG.ONE];u<c.length;u++){var l,h=c[u],f=zp(o.get(h).get());try{for(f.s();!(l=f.n()).done;){var d=l.value;if(s.get(d).isPresent())i+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=h.getScoreModifier()*this.scoreBySafePiece;var p,v=0,g=zp(VG.ORTHOGONALS);try{for(g.s();!(p=g.n()).done;)for(var y=p.value,m=d.getNext(y,1);m.isInRange(this.width,this.width)&&n.getPieceAt(m)===r;)v++,m=m.getNext(y,1)}catch(b){g.e(b)}finally{g.f()}i+=v*h.getScoreModifier()}}}catch(b){f.e(b)}finally{f.f()}}return new oq(i)}},{key:"getPiecesMap",value:function(e){for(var t=DW.UNOCCUPIED,n=new vq,r=[],i=[],o=0;o<this.width;o++)for(var a=0;a<this.width;a++){var s=new zG(a,o);e.getPieceAt(s)!==t&&(e.getAbsoluteOwner(s)===HG.ZERO?r.push(s):i.push(s))}return n.set(HG.ZERO,new qW(r)),n.set(HG.ONE,new qW(i)),n}},{key:"getThreatMap",value:function(e,t){for(var n=new vq,r=0,i=[HG.ZERO,HG.ONE];r<i.length;r++){var o,a=i[r],s=zp(t.get(a).get());try{for(s.s();!(o=s.n()).done;){var u=o.value,c=this.getThreats(u,e);this.isThreatReal(u,e,c)&&n.set(u,new sq(c))}}catch(l){s.e(l)}finally{s.f()}}return n}},{key:"getThreats",value:function(e,t){var n,r=t.getAbsoluteOwner(e).getOpponent(),i=[],o=zp(VG.ORTHOGONALS);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=e.getPrevious(a,1);if(this.isAThreat(s,t,r)){var u,c=[],l=zp(VG.ORTHOGONALS);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(h!==a.getOpposite()){for(var f=e.getNext(a,1);f.isInRange(this.width,this.width)&&t.getPieceAt(f)===DW.UNOCCUPIED;)f=f.getNext(h);f.isInRange(this.width,this.width)&&t.getAbsoluteOwner(f)===r&&!1===e.getNext(a,1).equals(f)&&c.push(f)}}}catch(d){l.e(d)}finally{l.f()}i.push(new GW(s,new qW(c)))}}}catch(d){o.e(d)}finally{o.f()}return i}},{key:"isAThreat",value:function(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==HG.ONE&&t.getPieceAt(e)!==DW.UNOCCUPIED))}},{key:"isThreatReal",value:function(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;var r,i=zp(n);try{for(i.s();!(r=i.n()).done;){if(r.value.mover.size()>0)return!0}}catch(o){i.e(o)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new vq,i=e.listKeys(),o=i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentPlayer()}),a=new qW(i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentOpponent()})),s=zp(o);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),h=[],f=zp(l);try{for(f.s();!(u=f.n()).done;){var d=u.value;if(!1===a.contains(d.directThreat)){var p,v=[],g=zp(d.mover);try{for(g.s();!(p=g.n()).done;){var y=p.value;!1===a.contains(y)&&v.push(y)}}catch(k){g.e(k)}finally{g.f()}v.length>0&&h.push(new GW(d.directThreat,new qW(v)))}}}catch(k){f.e(k)}finally{f.f()}h.length>0&&r.set(c,new sq(h))}}catch(k){s.e(k)}finally{s.f()}var m,b=zp(a);try{for(b.s();!(m=b.n()).done;){var _=m.value,w=e.get(_).get();r.set(_,w)}}catch(k){b.e(k)}finally{b.f()}return r}}]),n}(zW),$W=((IW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new oq(t.toBoardValue());for(var r=e.gameState,i=this.ruler.config.WIDTH,o=DW.UNOCCUPIED,a=0,s=this.getPiecesMap(r),u=this.getThreatMap(r,s),c=this.filterThreatMap(u,r),l=0,h=[HG.ZERO,HG.ONE];l<h.length;l++){var f,d=h[l],p=new qW,v=zp(s.get(d).get());try{for(v.s();!(f=v.n()).done;){var g=f.value;if(c.get(g).isPresent())a+=d.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE;else{a+=d.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;var y,m=zp(VG.ORTHOGONALS);try{for(m.s();!(y=m.n()).done;)for(var b=y.value,_=g.getNext(b,1);_.isInRange(i,i)&&r.getPieceAt(_)===o;)p.add(_),_=_.getNext(b,1)}catch(O){m.e(O)}finally{m.f()}}}}catch(O){v.e(O)}finally{v.f()}var w,k=zp(p);try{for(k.s();!(w=k.n()).done;){var C=w.value,E=n.CONTROL_VALUE[C.y][C.x];a+=d.getScoreModifier()*E}}catch(O){k.e(O)}finally{k.f()}}return new oq(a)}}]),n}(WW)).SCORE_BY_THREATENED_PIECE=530,IW.SCORE_BY_SAFE_PIECE=16*IW.SCORE_BY_THREATENED_PIECE+1,IW.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]],IW),ZW=((PW=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new oq(t.toBoardValue());for(var n=e.gameState,r=this.ruler.config.WIDTH,i=DW.UNOCCUPIED,o=0,a=0,s=0,u=this.getPiecesMap(n),c=this.getThreatMap(n,u),l=this.filterThreatMap(c,n),h=0,f=[HG.ZERO,HG.ONE];h<f.length;h++){var d,p=f[h],v=new qW,g=zp(u.get(p).get());try{for(g.s();!(d=g.n()).done;){var y=d.value;if(l.get(y).isPresent())a+=p.getScoreModifier();else{o+=p.getScoreModifier();var m,b=zp(VG.ORTHOGONALS);try{for(b.s();!(m=b.n()).done;)for(var _=m.value,w=y.getNext(_,1);w.isInRange(r,r)&&n.getPieceAt(w)===i;)v.add(w),w=w.getNext(_,1)}catch(P){b.e(P)}finally{b.f()}}}}catch(P){g.e(P)}finally{g.f()}var k,C=zp(v);try{for(C.s();!(k=C.n()).done;){var E=k.value,O=$W.CONTROL_VALUE[E.y][E.x];s+=p.getScoreModifier()*O}}catch(P){C.e(P)}finally{C.f()}}var S=this.getStepForEscape(n);return new oq(531*S*17*17+531*o*17+531*a+s)}},{key:"getStepForEscape",value:function(e){var t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}},{key:"_getStepForEscape",value:function(e,t,n,r){var i=this,o=this.getNextGen(e,n,r);return 0===o.length?kz.empty():o.some(function(e){return i.ruler.isExternalThrone(e)})?kz.of(t):(t++,r.push.apply(r,Up(o)),this._getStepForEscape(e,t,o,r))}},{key:"getNextGen",value:function(e,t,n){var r,i=this,o=[],a=zp(t);try{for(a.s();!(r=a.n()).done;){var s,u=r.value,c=zp(VG.ORTHOGONALS);try{var l=function(){for(var t=s.value,r=u.getNext(t,1);r.isInRange(i.ruler.config.WIDTH,i.ruler.config.WIDTH)&&e.getPieceAt(r)===DW.UNOCCUPIED;)n.every(function(e){return!1===e.equals(r)})&&o.push(r),r=r.getNext(t,1)};for(c.s();!(s=c.n()).done;)l()}catch(h){c.e(h)}finally{c.f()}}}catch(h){a.e(h)}finally{a.f()}return o}}]),n}($W)).SCORE_BY_THREATENED_PIECE=530,PW.SCORE_BY_SAFE_PIECE=16*$W.SCORE_BY_THREATENED_PIECE+1,PW.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]],PW),QW=DW.UNOCCUPIED,YW=DW.INVADERS,KW=DW.DEFENDERS,JW=DW.PLAYER_ONE_KING,XW=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(Ye||(Ye=xp(["Goal of the game"]))),$localize(Ke||(Ke=xp(["Brandhub is the Irish version of the family of viking strategy game called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),FW.getInitialState()),Eq.anyMove($localize(Je||(Je=xp(["Moving"]))),$localize(Xe||(Xe=xp(["All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, he can't go back on it, nor can the other pieces.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),FW.getInitialState(),RW.of(new zG(3,1),new zG(1,1)),$localize(et||(et=xp(["Congratulations!"])))),Eq.fromMove($localize(tt||(tt=xp(["Capturing a soldier (1/2)"]))),$localize(nt||(nt=xp(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new FW([[QW,QW,QW,YW,QW,QW,QW],[QW,QW,QW,YW,QW,QW,QW],[YW,QW,QW,KW,QW,QW,QW],[QW,QW,KW,JW,KW,YW,YW],[QW,QW,YW,QW,QW,QW,QW],[QW,QW,QW,KW,QW,YW,QW],[QW,QW,QW,YW,QW,QW,QW]],1),[RW.of(new zG(3,5),new zG(2,5))],$localize(rt||(rt=xp(["Congratulations, that will teach him a lesson!"]))),$localize(it||(it=xp(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Eq.fromMove($localize(ot||(ot=xp(["Capturing a soldier (2/2)"]))),$localize(at||(at=xp(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new FW([[QW,QW,QW,YW,QW,QW,QW],[QW,QW,YW,QW,QW,QW,QW],[QW,QW,QW,KW,QW,QW,QW],[YW,KW,QW,QW,KW,YW,YW],[QW,KW,QW,QW,QW,QW,QW],[QW,YW,QW,JW,QW,YW,QW],[QW,QW,QW,YW,QW,QW,QW]],12),[RW.of(new zG(2,1),new zG(3,1)),RW.of(new zG(3,0),new zG(3,1))],$localize(st||(st=xp(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(ut||(ut=xp(["Failed, you did not do the expected move."])))),Eq.fromMove($localize(ct||(ct=xp(["Capturing the king on his throne"]))),$localize(lt||(lt=xp(["To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king."]))),new FW([[QW,QW,QW,QW,QW,QW,QW],[QW,QW,QW,KW,QW,QW,QW],[QW,QW,QW,YW,QW,QW,QW],[QW,YW,QW,JW,YW,QW,QW],[QW,QW,QW,YW,QW,QW,QW],[QW,KW,QW,QW,QW,QW,QW],[QW,QW,QW,QW,QW,QW,QW]],72),[RW.of(new zG(1,3),new zG(2,3))],$localize(ht||(ht=xp(["Congratulations, you won!"]))),$localize(ft||(ft=xp(["Failed, you let the king run away."])))),Eq.fromMove($localize(dt||(dt=xp(["Capturing the king next to his throne"]))),$localize(pt||(pt=xp(["Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king."]))),new FW([[QW,QW,YW,QW,QW,QW,QW],[QW,QW,QW,YW,QW,QW,QW],[QW,QW,QW,JW,YW,QW,QW],[QW,YW,KW,QW,KW,QW,QW],[QW,QW,QW,YW,QW,QW,QW],[QW,QW,QW,QW,QW,QW,QW],[QW,QW,QW,QW,QW,QW,QW]],72),[RW.of(new zG(2,0),new zG(2,2))],$localize(vt||(vt=xp(["The king is dead, long live the king. Congratulations, you won."]))),$localize(gt||(gt=xp(["Failed!"])))),Eq.fromMove($localize(yt||(yt=xp(["Capturing the king far from his throne"]))),$localize(mt||(mt=xp(["When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king."]))),new FW([[QW,QW,QW,QW,QW,QW,QW],[QW,QW,QW,QW,QW,QW,QW],[QW,YW,QW,YW,QW,QW,QW],[YW,QW,QW,QW,KW,QW,QW],[QW,QW,QW,KW,QW,QW,QW],[QW,QW,QW,QW,QW,QW,QW],[QW,JW,QW,YW,QW,QW,QW]],72),[RW.of(new zG(3,6),new zG(2,6))],$localize(bt||(bt=xp(["The king is dead, long live the king. Congratulations, you won."]))),$localize(_t||(_t=xp(["Failed!"]))))]};function e$(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",6),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb()}if(2&e){var r=Vp.fc(2).index,i=Vp.fc().index,o=Vp.fc();Vp.Cb("transform","translate("+r*o.SPACE_SIZE+" "+i*o.SPACE_SIZE+")")}}function t$(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",7),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb()}if(2&e){var r=Vp.fc(2).index,i=Vp.fc().index,o=Vp.fc();Vp.Cb("transform","translate("+r*o.SPACE_SIZE+" "+i*o.SPACE_SIZE+")")}}function n$(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,e$,1,1,"polyline",4),Vp.Ac(2,t$,1,1,"ng-template",null,5,Vp.Bc),Vp.Pb()),2&e){var n=Vp.vc(3),r=Vp.fc().index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",o.isCentralThrone(r,i))("ngIfElse",n)}}function r$(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(2,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(3,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(4,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(5,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.fc(2).index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.04*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.96*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.2*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.05*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.65*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.2*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.95*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.65*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.4*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.15*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.75*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.4*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.85*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.75*o.SPACE_SIZE)}}function i$(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"polyline",13),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(3).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.fc(3).index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.Cb("points",o.getKingPolyline(r,i))}}function o$(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(3).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(1,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(3).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(2,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(3).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(3,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(3).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb()}if(2&e){var r=Vp.fc(3).index,i=Vp.fc().index,o=Vp.fc();Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.04*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.96*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.04*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.5*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.96*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.5*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.15*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.15*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.85*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.85*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.85*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.15*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.15*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.85*o.SPACE_SIZE)}}function a$(e,t){if(1&e&&(Vp.ec(),Vp.Ac(0,i$,2,1,"g",9),Vp.Ac(1,o$,4,16,"ng-template",null,12,Vp.Bc)),2&e){var n=Vp.vc(2),r=Vp.fc(2).index,i=Vp.fc().index,o=Vp.fc();Vp.mc("ngIf",o.isKing(r,i))("ngIfElse",n)}}function s$(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"circle",8),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Ac(2,r$,6,20,"g",9),Vp.Ac(3,a$,3,2,"ng-template",null,10,Vp.Bc),Vp.Pb()}if(2&e){var r=Vp.vc(4),i=Vp.fc().index,o=Vp.fc().index,a=Vp.fc();Vp.Bb(1),Vp.mc("ngClass",a.getPieceClasses(i,o)),Vp.Cb("r",(a.SPACE_SIZE-a.STROKE_WIDTH)/2)("cx",a.SPACE_SIZE*i+.5*a.SPACE_SIZE)("cy",a.SPACE_SIZE*o+.5*a.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",a.isInvader(i,o))("ngIfElse",r)}}function u$(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",2),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onClick(e,r)}),Vp.Pb(),Vp.Ac(2,n$,4,2,"g",3),Vp.Ac(3,s$,5,6,"g",3),Vp.Pb()}if(2&e){var r=t.index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",r,"_",i,""),Vp.mc("ngClass",o.getRectClasses(r,i)),Vp.Cb("x",o.SPACE_SIZE*r)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",o.board[i][r]===o.NONE&&o.isThrone(r,i)),Vp.Bb(1),Vp.mc("ngIf",o.board[i][r]!==o.NONE)}}function c$(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,u$,4,9,"g",1),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function l$(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",14),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onClick(e.x,e.y)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",r.x,"_",r.y,""),Vp.Cb("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var h$,f$,d$,p$,v$,g$,y$,m$=((f$=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e,!1,RW.from)).rules=UW.get(),r.availableMinimaxes=[new zW(r.rules,"DummyBot"),new WW(r.rules,"Piece > Influence"),new $W(r.rules,"Piece > Control"),new ZW(r.rules,"Escape > Piece > Control")],r.encoder=RW.encoder,r.tutorial=(new XW).tutorial,r}return Kp(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(VW)).\u0275fac=function(e){return new(e||f$)(Vp.Lb(qG))},f$.\u0275cmp=Vp.Fb({type:f$,selectors:[["app-brandhub"]],features:[Vp.yb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",3,"click",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base",3,"click"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base",3,"click"],[1,"base",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"click"],["soldierDefender",""],[1,"base","no-fill",3,"click"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,c$,2,1,"g",1),Vp.Ac(2,l$,2,6,"g",1),Vp.Pb()),2&e&&(Vp.Cb("viewBox",t.getViewBox()),Vp.Bb(1),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngForOf",t.getClickables()))},directives:[vg,dg,yg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),f$),b$=((h$=function(e){Jp(n,e);var t=ev(n);function n(){var e;return Qp(this,n),(e=t.apply(this,arguments)).SPACE_SIZE=50,e}return Kp(n,[{key:"getTriangleCornerCoords",value:function(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}},{key:"getTriangleCoordinate",value:function(e,t){return this.getTriangleCornerCoords(e,t).map(function(e){return e.x+","+e.y}).reduce(function(e,t){return e+","+t})}},{key:"getDownwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,o=this.SPACE_SIZE*(t+1),a=new zG(.5*this.SPACE_SIZE*e,i);return[a,new zG(n,o),new zG(r,i),a]}},{key:"getUpwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,o=this.SPACE_SIZE*(t+1),a=new zG(.5*this.SPACE_SIZE*e,o);return[a,new zG(n,i),new zG(r,o),a]}},{key:"getPyramidCoordinate",value:function(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}},{key:"getDownwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,o=n+this.SPACE_SIZE+", "+r,a=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+a+","+s+","+i+","+s+","+o+","+i+","+o+","+a+","+s+","+o}},{key:"getUpwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,o=n+this.SPACE_SIZE+", "+r,a=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+a+","+s+","+i+","+s+","+o+","+i+","+o+","+a+","+s+","+o}}]),n}(WG)).\u0275fac=function(e){return _$(e||h$)},h$.\u0275cmp=Vp.Fb({type:h$,selectors:[["ng-component"]],features:[Vp.yb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),h$),_$=Vp.Sb(b$),w$=function(){var e=function e(){Qp(this,e)};return e.INVALID_DISTANCE=function(){return $localize(wt||(wt=xp(["Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is."])))},e.NOT_ENOUGH_TILES_TO_EXCHANGE=function(){return $localize(kt||(kt=xp(["You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it."])))},e.FIRST_CLICK_SHOULD_NOT_BE_NULL=function(){return $localize(Ct||(Ct=xp(["Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles."])))},e.CANNOT_CAPTURE_FROM_EMPTY=function(){return $localize(Et||(Et=xp(["You cannot capture from an empty space."])))},e.CANNOT_CAPTURE_OWN_PIECES=function(){return $localize(Ot||(Ot=xp(["You cannot capture your own pieces."])))},e}(),k$=((p$=function(){function e(t,n){Qp(this,e),this.direction=t,this.str=n}return Kp(e,[{key:"toInt",value:function(){var t=this;return e.STEPS.findIndex(function(e){return e.direction.equals(t.direction)})}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return this.str}}],[{key:"fromCoords",value:function(t,n){var r=t.getVectorToward(n),i=e.STEPS.findIndex(function(e){return e.direction.equals(r)});if(-1===i)throw new Error(w$.INVALID_DISTANCE());return e.STEPS[i]}}]),e}()).LEFT=new p$(new DG(-2,0),"LEFT"),p$.UP_LEFT=new p$(jG.UP_LEFT,"UP_LEFT"),p$.UP_RIGHT=new p$(jG.UP_RIGHT,"UP_RIGHT"),p$.RIGHT=new p$(new DG(2,0),"RIGHT"),p$.DOWN_LEFT=new p$(jG.DOWN_LEFT,"DOWN_LEFT"),p$.DOWN_RIGHT=new p$(jG.DOWN_RIGHT,"DOWN_RIGHT"),p$.STEPS=[p$.LEFT,p$.UP_LEFT,p$.UP_RIGHT,p$.RIGHT,p$.DOWN_LEFT,p$.DOWN_RIGHT],p$),C$=((d$=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this)).start=e,a.step=r,a.landingCoord=i,a.capture=o,a}return Kp(n,[{key:"isTileExchange",value:function(){return this.capture.isPresent()}},{key:"toString",value:function(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}},{key:"equals",value:function(e){return!!this.capture.equals(e.capture)&&!!this.start.equals(e.start)&&!!this.step.equals(e.step)}}],[{key:"fromMovement",value:function(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");var r=new zG(e.x+t.direction.x,e.y+t.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new n(kz.of(e),kz.of(t),kz.of(r),kz.empty())}},{key:"fromTilesExchange",value:function(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new n(kz.empty(),kz.empty(),kz.empty(),kz.of(e))}},{key:"fromCoordToCoord",value:function(e,t){var r=k$.fromCoords(e,t);return n.fromMovement(e,r)}}]),n}(hq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 1035}},{key:"encodeNumber",value:function(e){if(e.isTileExchange()){var t=e.capture.get().y;return 10*e.capture.get().x+t}var n=e.start.get().y,r=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*r+n}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?d$.fromTilesExchange(new zG(n,t)):d$.fromMovement(new zG(n,t),k$.STEPS[e-1])}}]),n}(wz)),d$),E$=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"getNeighbors",value:function(e){var t=new zG(e.x-1,e.y),n=new zG(e.x+1,e.y);return(e.x+e.y)%2==1?[t,n,new zG(e.x,e.y-1)]:[t,n,new zG(e.x,e.y+1)]}},{key:"getFakeNeighbors",value:function(e){return new zG(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}},{key:"getCommonNeighbor",value:function(t,n){for(var r=e.getNeighbors(t),i=e.getNeighbors(n),o=0;o<r.length;){for(var a=r[o],s=0;s<i.length;){if(a.equals(i[s]))return kz.of(a);s++}o++}return kz.empty()}}]),e}(),O$=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getEmptyNeighboors",value:function(e,t){return n.getEmptyNeighbors(this.board,e,t)}}],[{key:"getEmptyNeighbors",value:function(e,t,n){var r,i=[],o=zp(E$.getNeighbors(t));try{for(o.s();!(r=o.n()).done;){var a=r.value;a.isInRange(e[0].length,e.length)&&e[a.y][a.x]===n&&i.push(a)}}catch(s){o.e(s)}finally{o.f()}return i}}]),n}(cq),S$=((g$=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this,e,r)).tiles=i,a.captures=o,a}return Kp(n,[{key:"applyLegalMovement",value:function(e){pz(n.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});var t=e.start.get(),r=e.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=QG.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=QG.EMPTY,new n(i,this.turn,this.tiles,this.captures)}},{key:"doMovementCaptures",value:function(e){pz(n.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});var t,r=this,i=zp(this.getCapturedNeighbors(e.landingCoord.get()));try{for(i.s();!(t=i.n()).done;){var o=t.value;r=r.capture(o)}}catch(a){i.e(a)}finally{i.f()}return r}},{key:"getCapturedNeighbors",value:function(e){var t=this,n=this.getCurrentOpponent();return E$.getNeighbors(e).filter(function(e){return!e.isNotInRange(15,10)&&!!t.getPieceAt(e).is(n)&&t.isSurrounded(e)})}},{key:"isSurrounded",value:function(e){return 0===this.getEmptyNeighboors(e,QG.EMPTY).length}},{key:"capture",value:function(e){pz(n.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});var t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return pz(n.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=QG.EMPTY,r[this.getCurrentPlayer().value]+=1,new n(t,this.turn,this.tiles,r)}},{key:"removeTilesIfNeeded",value:function(e,t){pz(n.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,tile:e,countTiles:t}});var r=this,i=n.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,t);var o,a=zp(n.getPresentNeighboorEntrances(i));try{for(a.s();!(o=a.n()).done;){var s=o.value,u=r.getPieceAt(s);u===QG.EMPTY?r=r.removeTilesIfNeeded(s,t):u.is(this.getCurrentOpponent())&&r.isSurrounded(s)&&(r=r.capture(s))}}catch(c){a.e(c)}finally{a.f()}}return r}},{key:"isTileEmpty",value:function(e){vz(this.getPieceAt(e)!==QG.NONE,"Should not call isTileEmpty on removed tile");for(var t=0;t<2;t++)for(var n=0;n<3;n++){var r=e.getNext(new DG(n,t),1);if(this.getPieceAt(r)!==QG.EMPTY)return!1}return!0}},{key:"isDeconnectable",value:function(e){var t=this.getPresentNeighboorTilesRelativeIndexes(e);if(t.length>3)return!1;for(var n=0,r=1;r<t.length;r++)!1===this.areNeighboor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighboor(t[0],t[t.length-1])&&(n+=1),n<=1}},{key:"areNeighboor",value:function(e,t){return e+1===t||0===e&&5===t}},{key:"getPresentNeighboorTilesRelativeIndexes",value:function(e){for(var t=[],r=kz.empty(),i=0;i<6;i++){var o=e.getNext(n.NEIGHBOORS_TILES_DIRECTIONS[i],1);o.isInRange(15,10)&&this.getPieceAt(o)!==QG.NONE&&(r.isAbsent()&&(r=kz.of(i)),t.push(i-r.get()))}return t}},{key:"deconnectTile",value:function(e,t){pz(n.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});for(var r=this.getCopiedBoard(),i=e.x,o=e.y,a=0;a<2;a++)for(var s=0;s<3;s++)r[o+a][i+s]=QG.NONE;var u=[this.tiles[0],this.tiles[1]];return t&&(u[this.getCurrentPlayer().value]+=1),new n(r,this.turn,u,this.captures)}},{key:"getLegalLandings",value:function(e){var t,n=[],r=zp(k$.STEPS);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=e.getNext(i.direction,1);this.isOnBoard(o)&&this.getPieceAt(o)===QG.EMPTY&&n.push(o)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getPiecesByFreedom",value:function(){for(var e=[[0,0,0,0],[0,0,0,0]],t=0;t<10;t++)for(var n=0;n<15;n++){var r=this.board[t][n];if(r.isPlayer()){var i=this.getEmptyNeighboors(new zG(n,t),QG.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}],[{key:"getTilesUpperLeftCoord",value:function(e){var t=e.x-e.x%3,n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new zG(t,n)}},{key:"getPresentNeighboorEntrances",value:function(e){return[new zG(e.x+1,e.y-1),new zG(e.x+3,e.y+0),new zG(e.x+3,e.y+1),new zG(e.x+1,e.y+2),new zG(e.x-1,e.y+1),new zG(e.x-1,e.y+0)].filter(n.isInRange)}},{key:"getInitialState",value:function(){var e=QG.EMPTY,t=QG.NONE,r=QG.ZERO,i=QG.ONE;return new n([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,i,e,i,e,e,r,e,r,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,i,e,i,e,e,r,e,r,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}}]),n}(O$)).VERBOSE=!1,g$.NEIGHBOORS_TILES_DIRECTIONS=[new DG(0,-2),new DG(3,-1),new DG(3,1),new DG(0,2),new DG(-3,1),new DG(-3,-1)],g$.isInRange=function(e){return e.isInRange(15,10)},g$),P$=((v$=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}},{key:"applyLegalTileExchange",value:function(e,t){var r=t.getCopiedBoard(),i=e.capture.get();r[i.y][i.x]=QG.EMPTY;var o=[t.captures[0],t.captures[1]];o[t.getCurrentPlayer().value]+=1;var a=[t.tiles[0],t.tiles[1]];a[t.getCurrentPlayer().value]-=2;var s=new S$(r,t.turn,a,o),u=s.removeTilesIfNeeded(i,!1),c=new S$(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return pz(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:t,afterCapture:s,afterTileRemoval:u,resultingState:c}}),c}},{key:"applyLegalMovement",value:function(e,t){var r=t.applyLegalMovement(e),i=r.removeTilesIfNeeded(e.start.get(),!0),o=i.doMovementCaptures(e),a=new S$(o.board,t.turn+1,o.tiles,o.captures);return pz(n.VERBOSE,{ab_state:t,afterMovement:r,afterTilesRemoved:i,afterCaptures:o,resultingState:a}),a}},{key:"isLegal",value:function(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}},{key:"isLegalTileExchange",value:function(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return sz.failure(w$.NOT_ENOUGH_TILES_TO_EXCHANGE());var n=t.getPieceAt(e.capture.get());return n===QG.NONE||n===QG.EMPTY?sz.failure(w$.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?sz.failure(w$.CANNOT_CAPTURE_OWN_PIECES()):sz.success(void 0)}},{key:"isLegalMovement",value:function(e,t){if(t.getPieceAt(e.start.get())===QG.NONE){var n="Cannot start with a coord outside the board "+e.start.get().toString()+".";return sz.failure(n)}if(t.getPieceAt(e.landingCoord.get())===QG.NONE){var r="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return sz.failure(r)}var i=t.getPieceAt(e.start.get());return i===QG.EMPTY?sz.failure(nq.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.is(t.getCurrentOpponent())?sz.failure(nq.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?sz.failure(nq.MUST_LAND_ON_EMPTY_SPACE()):sz.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captures[0]>=18?bq.ZERO_WON:t.captures[1]>=18?bq.ONE_WON:bq.ONGOING}}]),n}(_q)).VERBOSE=!1,v$),I$=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}},{key:"getListExchanges",value:function(e){var t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=QG.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(var o=0;o<10;o++)for(var a=0;a<15;a++){var s=new zG(a,o);if(n.getPieceAt(s)===i){var u=C$.fromTilesExchange(s);t.push(u)}}return t}},{key:"getListMovement",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<10;i++)for(var o=0;o<15;o++){var a=new zG(o,i);if(n.getPieceAt(a).is(r)){var s,u=zp(n.getLegalLandings(a));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=C$.fromCoordToCoord(a,c);t.push(l)}}catch(h){u.e(h)}finally{u.f()}}}return t}},{key:"getBoardValue",value:function(e){var t=P$.getGameStatus(e);if(t.isEndGame)return oq.fromWinner(t.winner);var n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new oq(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}},{key:"getPiecesScore",value:function(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}},{key:"getPlayerPiecesScore",value:function(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}},{key:"putCaptureFirst",value:function(e,t){var n=this;return rq.sortByDescending(t,function(t){return n.moveCapturesList(e,t).length}),t}},{key:"moveCapturesList",value:function(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}]),n}(iq),T$=((y$=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getBoardValue",value:function(e){var t=P$.getGameStatus(e);if(t.isEndGame)return oq.fromWinner(t.winner);for(var r=e.gameState,i=this.getPiecesMap(r),o=this.getThreatMap(r,i),a=this.filterThreatMap(o,r),s=0,u=0,c=[HG.ZERO,HG.ONE];u<c.length;u++){var l,h=c[u],f=zp(i.get(h).get());try{for(f.s();!(l=f.n()).done;){var d=l.value;a.get(d).isPresent()?s+=h.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:s+=h.getScoreModifier()*n.SCORE_BY_SAFE_PIECE}}catch(p){f.e(p)}finally{f.f()}}return s+=r.tiles[1]-r.tiles[0],new oq(s)}},{key:"getPiecesMap",value:function(e){for(var t=new vq,n=[],r=[],i=0;i<10;i++)for(var o=0;o<15;o++){var a=new zG(o,i),s=e.getPieceAt(a);s===QG.ZERO?n.push(a):s===QG.ONE&&r.push(a)}return t.set(HG.ZERO,new qW(n)),t.set(HG.ONE,new qW(r)),t}},{key:"getThreatMap",value:function(e,t){for(var n=new vq,r=0,i=[HG.ZERO,HG.ONE];r<i.length;r++){var o,a=i[r],s=zp(t.get(a).get());try{for(s.s();!(o=s.n()).done;){var u=o.value,c=this.getThreat(u,e);c.isPresent()&&n.set(u,c.get())}}catch(l){s.e(l)}finally{s.f()}}return n}},{key:"getThreat",value:function(e,t){var n,r=HG.of(t.getPieceAt(e).value).getOpponent(),i=kz.empty(),o=[],a=zp(E$.getNeighbors(e).filter(function(e){return e.isInRange(15,10)}));try{for(a.s();!(n=a.n()).done;){var s=n.value,u=t.getPieceAt(s);if(u.is(r))o.push(s);else if(u===QG.EMPTY){if(i.isPresent())return kz.empty();i=kz.of(s)}}}catch(d){a.e(d)}finally{a.f()}if(i.isPresent()){var c,l=[],h=zp(k$.STEPS);try{var f=function(){var e=c.value,n=i.get().getNext(e.direction,1);n.isInRange(15,10)&&t.getPieceAt(n).is(r)&&o.every(function(e){return!1===e.equals(n)})&&l.push(n)};for(h.s();!(c=h.n()).done;)f()}catch(d){h.e(d)}finally{h.f()}if(l.length>0)return kz.of(new HW(new qW(o),new qW(l)))}return kz.empty()}},{key:"filterThreatMap",value:function(e,t){var n,r=new vq,i=e.listKeys(),o=i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentPlayer())}),a=new qW(i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentOpponent())})),s=zp(o);try{for(s.s();!(n=s.n()).done;){var u=n.value,c=e.get(u).get();vz(1===c.directThreats.size(),"oldThreat must contain exactly one direct threat");var l=c.directThreats.getAnyElement().get(),h=kz.empty();if(!1===a.contains(l)){var f,d=[],p=zp(c.mover);try{for(p.s();!(f=p.n()).done;){var v=f.value;!1===a.contains(v)&&d.push(v)}}catch(_){p.e(_)}finally{p.f()}d.length>0&&(h=kz.of(new HW(c.directThreats,new qW(d))))}h.isPresent()&&r.set(u,h.get())}}catch(_){s.e(_)}finally{s.f()}var g,y=zp(a);try{for(y.s();!(g=y.n()).done;){var m=g.value,b=e.get(m).get();r.set(m,b)}}catch(_){y.e(_)}finally{y.f()}return r}}]),n}(I$)).SCORE_BY_THREATENED_PIECE=1e3,y$.SCORE_BY_SAFE_PIECE=1e6,y$),A$=QG.EMPTY,N$=QG.NONE,x$=QG.ZERO,R$=QG.ONE,M$=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(St||(St=xp(["Board and goal of the game"]))),$localize(Pt||(Pt=xp(["Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.\n         The triangles are the spaces on which pieces move during the game.\n         The tiles can be removed from the board (you will see how later).\n         The dark pieces belong to the first player and can only move on the dark spaces,\n         while the light pieces belong to the second player and can only move on the light spaces.\n         The goal of the game is to capture all of the opponent's pieces."]))),S$.getInitialState()),Eq.anyMove($localize(It||(It=xp(["Move"]))),$localize(Tt||(Tt=xp(["To move a piece, you need to:\n        <ol>\n          <li>Click on one of your pieces.</li>\n          <li>Click on one of the triangular space highlighted in yellow.</li>\n        </ol>\n        You can pass through the opponent's pieces.\n        You're playing first, hence you're playing Dark.<br/><br/>\n        Perform any move."]))),S$.getInitialState(),C$.fromCoordToCoord(new zG(3,5),new zG(5,5)),$localize(At||(At=xp(["Congratulations! Let's see captures now."])))),Eq.fromMove($localize(Nt||(Nt=xp(["Capture"]))),$localize(xt||(xt=xp(["Every piece has three neighboring triangular spaces (2 on the sides).\n        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!\n        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>\n        You're playing Light, make a capture."]))),new S$([[N$,N$,N$,N$,N$,N$,x$,A$,x$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,x$,A$,A$,A$,A$,A$,x$,A$,A$,N$,N$,N$],[A$,R$,A$,R$,x$,R$,A$,A$,x$,A$,A$,R$,A$,R$,A$],[R$,A$,A$,A$,A$,A$,A$,A$,A$,A$,R$,A$,A$,A$,R$],[A$,R$,A$,R$,A$,A$,A$,A$,A$,A$,A$,R$,A$,R$,A$],[A$,x$,A$,x$,A$,A$,A$,A$,A$,A$,A$,x$,A$,x$,A$],[x$,A$,A$,A$,x$,A$,A$,A$,A$,A$,x$,A$,A$,A$,x$],[A$,x$,A$,x$,A$,A$,R$,A$,R$,A$,A$,x$,A$,x$,A$],[N$,N$,N$,A$,A$,R$,A$,A$,A$,R$,A$,A$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,R$,A$,R$,N$,N$,N$,N$,N$,N$]],3,[0,0],[0,0]),[C$.fromCoordToCoord(new zG(5,2),new zG(4,1)),C$.fromCoordToCoord(new zG(3,4),new zG(4,3))],$localize(Rt||(Rt=xp(["Congratulations!"]))),$localize(Mt||(Mt=xp(["Failed, you have not captured any piece."])))),Eq.fromMove($localize(Dt||(Dt=xp(["Gain a tile"]))),$localize(Lt||(Lt=xp(["When a tile is empty, it can become removable from the board.\n        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.\n        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.\n        For example, here, the topmost dark piece will not disconnect its tile when leaving it.\n        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>\n        Perform a move that lets you gain two tiles."]))),new S$([[N$,N$,N$,N$,N$,N$,A$,A$,A$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,R$,A$,A$,N$,N$,N$,N$,N$,N$],[A$,A$,A$,N$,N$,N$,A$,A$,A$,N$,N$,N$,N$,N$,N$],[A$,A$,R$,A$,A$,A$,A$,x$,A$,N$,N$,N$,N$,N$,N$],[A$,A$,A$,R$,A$,A$,A$,A$,A$,N$,N$,N$,N$,N$,N$],[A$,A$,A$,A$,A$,A$,A$,A$,A$,A$,A$,x$,N$,N$,N$],[A$,A$,x$,A$,A$,R$,A$,A$,A$,A$,x$,A$,A$,A$,x$],[A$,A$,A$,A$,A$,A$,R$,A$,R$,A$,A$,x$,A$,x$,A$],[N$,N$,N$,A$,A$,R$,A$,A$,A$,R$,A$,A$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,R$,A$,R$,N$,N$,N$,N$,N$,N$]],2,[0,0],[0,0]),[C$.fromCoordToCoord(new zG(2,6),new zG(4,6)),C$.fromCoordToCoord(new zG(2,6),new zG(3,5)),C$.fromCoordToCoord(new zG(2,6),new zG(3,7))],$localize(Bt||(Bt=xp(["Congratulations!"]))),$localize(Ft||(Ft=xp(["Failed, you have not gained the two tiles that you could, try again!"])))),Eq.fromMove($localize(jt||(jt=xp(["Exchanging a tile"]))),$localize(Ut||(Ut=xp(["When you have a tile, you can see it on the left of the board.\n        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.\n        This will cost you two tiles.\n        If any tiles are removed during that turn, nobody will get them.<br/><br/>\n        Gain some time and capture the last piece!"]))),new S$([[N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,A$,A$,x$,N$,N$,N$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,A$,A$,A$,A$,A$,A$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,A$,A$,A$,R$,A$,R$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,A$,A$,R$,A$,A$,A$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,R$,A$,R$,N$,N$,N$,N$,N$,N$]],1,[0,2],[0,0]),[C$.fromTilesExchange(new zG(5,5))],$localize(Vt||(Vt=xp(["Congratulations!"]))),$localize(zt||(zt=xp(["It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!"])))),Eq.fromMove($localize(Ht||(Ht=xp(["Special capture"]))),$localize(Gt||(Gt=xp(["When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!\n        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>\n        A move that demonstrate both of these things can be done on this board by Light. Try it!"]))),new S$([[N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,A$,A$,x$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,A$,A$,x$,A$,A$,A$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,A$,x$,R$,A$,R$,A$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,A$,R$,x$,A$,A$,A$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,A$,A$,R$,N$,N$,N$,N$,N$,N$,N$,N$,N$],[N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$,N$]],1,[0,0],[0,0]),[C$.fromCoordToCoord(new zG(7,6),new zG(6,5)),C$.fromCoordToCoord(new zG(7,6),new zG(8,5))],$localize(qt||(qt=xp(["Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.\n        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space."]))),$localize(Wt||(Wt=xp(["Failed!"]))))]};function D$(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polygon",13)),2&e){var n=Vp.fc().index,r=Vp.fc().index,i=Vp.fc();Vp.mc("ngClass",i.getPyramidClass(n,r)),Vp.Cb("points",i.getPyramidCoordinate(n,r))}}function L$(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polygon",15)),2&e){var n=Vp.fc(2).index,r=Vp.fc().index,i=Vp.fc();Vp.mc("ngClass",i.getEmptyClass(n,r)),Vp.Cb("points",i.getTriangleCoordinate(n,r))}}function B$(e,t){if(1&e&&(Vp.ec(),Vp.Ac(0,L$,1,2,"polygon",14)),2&e){var n=Vp.fc().index,r=Vp.fc().index,i=Vp.fc();Vp.mc("ngIf",i.isEmptyCase(n,r))}}function F$(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polygon",16)),2&e){var n=Vp.fc().index,r=Vp.fc().index,i=Vp.fc();Vp.oc("id","dark_line_",n,"_",r,""),Vp.Cb("points",i.getLineCoordinate(n,r))}}function j$(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polygon",17)),2&e){var n=Vp.fc().index,r=Vp.fc().index,i=Vp.fc();Vp.oc("id","dark_line_",n,"_",r,""),Vp.Cb("points",i.getLineCoordinate(n,r))}}function U$(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g",8),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onClick(e,r)}),Vp.Ac(1,D$,1,2,"polygon",9),Vp.Ac(2,B$,1,1,"ng-template",null,10,Vp.Bc),Vp.Ac(4,F$,1,3,"polygon",11),Vp.Ac(5,j$,1,3,"polygon",12),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.vc(3),a=Vp.fc().index,s=Vp.fc();Vp.oc("id","click_",i,"_",a,""),Vp.Bb(1),Vp.mc("ngIf",s.isPyramid(i,a))("ngIfElse",o),Vp.Bb(3),Vp.mc("ngIf",r!==s.NONE),Vp.Bb(1),Vp.mc("ngIf",r!==s.NONE)}}function V$(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,U$,6,6,"g",7),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function z$(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polygon",18)),2&e){var n=t.$implicit,r=Vp.fc();Vp.Cb("points",r.getTriangleCoordinate(n.x,n.y))}}function H$(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polygon",19)),2&e){var n=Vp.fc();Vp.Cb("points",n.getTriangleCoordinate(n.lastStart.get().x,n.lastStart.get().y))}}function G$(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polygon",19)),2&e){var n=Vp.fc();Vp.Cb("points",n.getTriangleCoordinate(n.lastEnd.get().x,n.lastEnd.get().y))}}function q$(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polygon",20)),2&e){var n=Vp.fc();Vp.Cb("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function W$(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g",21),Vp.Mb(1,"polygon",22),Vp.Qb(2,"text",23),Vp.Cc(3),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(1),Vp.Cb("points",n.getTilesCountCoordinate(0,0))("stroke",n.lastTurnWasTilesExchange(0)?"yellow":"black"),Vp.Bb(1),Vp.Cb("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+0*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),Vp.Bb(1),Vp.Dc(n.tiles[0])}}function $$(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g",24),Vp.Mb(1,"polygon",25),Vp.Qb(2,"text",26),Vp.Cc(3),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(1),Vp.Cb("points",n.getTilesCountCoordinate(0,9))("stroke",n.lastTurnWasTilesExchange(1)?"yellow":"black"),Vp.Bb(1),Vp.Cb("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+9*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),Vp.Bb(1),Vp.Dc(n.tiles[1])}}var Z$,Q$,Y$,K$,J$,X$,eZ=((J$=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).tiles=[0,0],r.NONE=QG.NONE,r.chosenCoord=kz.empty(),r.lastStart=kz.empty(),r.lastEnd=kz.empty(),r.highlights=[],r.scores=kz.of([0,0]),r.rules=new P$(S$),r.availableMinimaxes=[new I$(r.rules,"Normal"),new T$(r.rules,"Piece > Threat > Tiles")],r.encoder=C$.encoder,r.tutorial=(new M$).tutorial,r.SPACE_SIZE=70,r.updateBoard(),r}return Kp(n,[{key:"updateBoard",value:function(){this.chosenCoord=kz.empty(),this.state=this.rules.node.gameState,this.scores=kz.of(this.state.captures),this.tiles=this.state.tiles;var e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=kz.empty(),this.lastEnd=kz.empty()),this.board=this.rules.node.gameState.board}},{key:"showHighlight",value:function(){this.highlights=this.state.getLegalLandings(this.chosenCoord.get())}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=kz.empty(),this.highlights=[]}},{key:"onClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return o=new zG(e,t),r.abrupt("return",n.chosenCoord.isAbsent()?n.firstClick(o):n.secondClick(o));case 5:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.state.getPieceAt(e)).is(t.state.getCurrentOpponent())){n.next=4;break}return i=C$.fromTilesExchange(e),n.abrupt("return",t.chooseMove(i,t.state,t.state.captures));case 4:return n.abrupt("return",r.is(t.state.getCurrentPlayer())?(t.chosenCoord=kz.of(e),t.showHighlight(),lz.SUCCESS):t.cancelMove(w$.FIRST_CLICK_SHOULD_NOT_BE_NULL()));case 5:case"end":return n.stop()}},n)}))()}},{key:"secondClick",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.equals(t.chosenCoord.get())){n.next=2;break}return n.abrupt("return",(t.cancelMoveAttempt(),lz.SUCCESS));case 2:if(!t.highlights.some(function(t){return t.equals(e)})){n.next=5;break}return r=C$.fromCoordToCoord(t.chosenCoord.get(),e),n.abrupt("return",t.chooseMove(r,t.state,t.state.captures));case 5:return n.abrupt("return",t.cancelMove(w$.INVALID_DISTANCE()));case 6:case"end":return n.stop()}},n)}))()}},{key:"isPyramid",value:function(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}},{key:"wasOpponent",value:function(e,t){var n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}},{key:"getPyramidClass",value:function(e,t){var n=this.board[t][e];return n===QG.ZERO?this.getPlayerClass(HG.ZERO):n===QG.ONE?this.getPlayerClass(HG.ONE):"captured"}},{key:"isEmptyCase",value:function(e,t){return this.board[t][e]===QG.EMPTY||this.wasRemoved(e,t)}},{key:"wasRemoved",value:function(e,t){var n=this.rules.node.mother;if(this.board[t][e]===QG.NONE&&n.isPresent()){var r=n.get().gameState.getPieceAtXY(e,t);return r===QG.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}},{key:"getEmptyClass",value:function(e,t){return this.board[t][e]===QG.EMPTY?(e+t)%2==1?"background":"background2":"captured2"}},{key:"getTilesCountCoordinate",value:function(e,t){var n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}},{key:"getLineCoordinate",value:function(e,t){var n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}},{key:"mustShowTilesOf",value:function(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}},{key:"lastTurnWasTilesExchange",value:function(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}]),n}(b$)).\u0275fac=function(e){return new(e||J$)(Vp.Lb(qG))},J$.\u0275cmp=Vp.Fb({type:J$,selectors:[["app-coerceo"]],features:[Vp.yb],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill highlighted",4,"ngFor","ngForOf"],["class","base no-fill last-move",4,"ngIf"],["class","base no-fill selected",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptyCase",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","last-move"],[1,"base","no-fill","selected"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,V$,2,1,"g",1),Vp.Ac(2,z$,1,1,"polygon",2),Vp.Ac(3,H$,1,1,"polygon",3),Vp.Ac(4,G$,1,1,"polygon",3),Vp.Ac(5,q$,1,1,"polygon",4),Vp.Ac(6,W$,4,6,"g",5),Vp.Ac(7,$$,4,6,"g",6),Vp.Pb()),2&e&&(Vp.Cb("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),Vp.Bb(1),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngForOf",t.highlights),Vp.Bb(1),Vp.mc("ngIf",t.lastStart.isPresent()),Vp.Bb(1),Vp.mc("ngIf",t.lastEnd.isPresent()),Vp.Bb(1),Vp.mc("ngIf",t.chosenCoord.isPresent()),Vp.Bb(1),Vp.mc("ngIf",t.mustShowTilesOf(0)),Vp.Bb(1),Vp.mc("ngIf",t.mustShowTilesOf(1)))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),J$),tZ=function(){var e=function e(){Qp(this,e)};return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=function(){return $localize($t||($t=xp(["Your piece should land on a neighboring square."])))},e.CANNOT_DROP_AFTER_TURN_40=function(){return $localize(Zt||(Zt=xp(["You cannot drop a piece during the moving phase."])))},e.CANNOT_MOVE_BEFORE_TURN_40=function(){return $localize(Qt||(Qt=xp(["You cannot move a piece before both players have dropped all of their pieces."])))},e.MUST_JUMP_OVER_PIECES=function(){return $localize(Yt||(Yt=xp(["A jump must be made over a piece, not over an empty square."])))},e.MUST_DROP_IN_CENTRAL_ZONE=function(){return $localize(Kt||(Kt=xp(["A drop must occur in the central zone of the board."])))},e.INVALID_JUMP=function(){return $localize(Jt||(Jt=xp(["A jump must land two squares from its original position, and be done in a straight line in any direction."])))},e.SAME_LOCATION_VISITED_IN_JUMP=function(){return $localize(Xt||(Xt=xp(["You are visiting the same location twice in a move, you are not allowed to do so."])))},e}(),nZ=((K$=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"isShelter",value:function(e){return 0===e.x||e.x===n.WIDTH-1?n.SHELTERS_INDICES.some(function(t){return e.y===t}):(0===e.y||e.y===n.HEIGHT-1)&&n.SHELTERS_INDICES.some(function(t){return e.x===t})}},{key:"isCentralZone",value:function(e){return e.x>=n.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=n.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=n.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=n.CENTRAL_ZONE_BOTTOM_RIGHT.y}},{key:"isDropPhase",value:function(){return this.turn<40}},{key:"getSidePieces",value:function(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}],[{key:"getInitialState",value:function(){return new n(rq.createTable(n.WIDTH,n.HEIGHT,HG.NONE),0)}}]),n}(cq)).WIDTH=17,K$.HEIGHT=17,K$.CENTRAL_ZONE_TOP_LEFT=new zG(4,6),K$.CENTRAL_ZONE_BOTTOM_RIGHT=new zG(12,10),K$.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],K$.ALL_SHELTERS=new sq(K$.SHELTERS_INDICES.flatMap(function(e){return[new zG(e,0),new zG(e,K$.HEIGHT-1),new zG(0,e),new zG(K$.WIDTH-1,e)]})).toList(),K$),rZ=((Y$=function(e){Jp(n,e);var t=ev(n);function n(e){return Qp(this,n),t.call(this,e.x,e.y)}return Kp(n,[{key:"toString",value:function(){return"ConspirateursMoveDrop(".concat(this.coord.toString(),")")}},{key:"equals",value:function(e){return!!e.isDrop()&&this.coord.equals(e.coord)}},{key:"isDrop",value:function(){return!0}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e){return e.isInRange(nZ.WIDTH,nZ.HEIGHT)?sz.success(new n(e)):sz.failure("Move out of board")}}]),n}(fq)).encoder=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"getEncoder",value:function(e,t,n){return new(function(r){Jp(o,r);var i=ev(o);function o(){var e;return Qp(this,o),(e=i.apply(this,arguments)).shiftX=t,e}return Kp(o,[{key:"maxValue",value:function(){return(e-1)*this.shiftX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftX+e.coord.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var o=new zG((r-=r%1)%e,i);return n(o)}}]),o}(wz))}}]),e}().getEncoder(nZ.WIDTH,nZ.HEIGHT,function(e){return Y$.of(e).get()}),Y$),iZ=((Q$=function(e){Jp(n,e);var t=ev(n);function n(e,r){return Qp(this,n),t.call(this,e,r)}return Kp(n,[{key:"toString",value:function(){return"ConspirateursMoveSimple(".concat(this.coord.toString()," -> ").concat(this.end.toString(),")")}},{key:"equals",value:function(e){return!!e.isSimple()&&(e===this||!1!==e.coord.equals(this.coord)&&!1!==e.end.equals(this.end))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!0}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e,t){return e.isInRange(nZ.WIDTH,nZ.HEIGHT)&&t.isInRange(nZ.WIDTH,nZ.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?sz.success(new n(e,t)):sz.failure(tZ.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):sz.failure("Move out of board")}}]),n}(AW)).encoder=AW.getEncoder(nZ.WIDTH,nZ.HEIGHT,function(e,t){return Q$.of(e,t).get()}),Q$),oZ=((Z$=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this)).coords=e,r}return Kp(n,[{key:"addJump",value:function(e){var t=rq.copyImmutableArray(this.coords);return t.push(e),n.of(t)}},{key:"getStartingCoord",value:function(){return this.coords[0]}},{key:"getEndingCoord",value:function(){return this.coords[this.coords.length-1]}},{key:"getLandingCoords",value:function(){return this.coords.slice(1)}},{key:"getJumpedOverCoords",value:function(){for(var e=[],t=1;t<this.coords.length;t++){var n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}},{key:"toString",value:function(){return"ConspirateursMoveJump(".concat(this.coords.map(function(e){return e.toString()}).reduce(function(e,t){return e+" -> "+t}),")")}},{key:"equals",value:function(e){return!e.isSimple()&&!e.isDrop()&&(e===this||!1!==this.getStartingCoord().equals(e.getStartingCoord())&&!1!==this.getEndingCoord().equals(e.getEndingCoord()))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!0}}],[{key:"of",value:function(e){if(e.length<2)return sz.failure("ConspirateursMoveJump requires at least one jump, so two coords");var t,r=zp(e);try{for(r.s();!(t=r.n()).done;)if(t.value.isNotInRange(nZ.WIDTH,nZ.HEIGHT))return sz.failure("Move out of board")}catch(o){r.e(o)}finally{r.f()}for(var i=1;i<e.length;i++){if(e[i-1].getDirectionToward(e[i]).isFailure())return sz.failure(tZ.INVALID_JUMP());if(2!==e[i-1].getDistance(e[i]))return sz.failure(tZ.INVALID_JUMP())}return new qW(e).size()===e.length?sz.success(new n(e)):sz.failure(tZ.SAME_LOCATION_VISITED_IN_JUMP())}}]),n}(hq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){var e;return Qp(this,n),(e=t.apply(this,arguments)).coordEncoder=zG.numberEncoder(nZ.WIDTH,nZ.HEIGHT),e}return Kp(n,[{key:"encodeMove",value:function(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}},{key:"decodeMove",value:function(e){vz(null!=dz.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");var t=dz.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return Z$.of(t).get()}}]),n}(_z)),Z$),aZ=_z.disjunction3(rZ.encoder,iZ.encoder,oZ.encoder,function(e){return e.isDrop()},function(e){return e.isSimple()}),sZ=((X$=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.call(this,nZ)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=HG.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{var i=e.getStartingCoord(),o=e.getEndingCoord();r[i.y][i.x]=HG.NONE,r[o.y][o.x]=t.getCurrentPlayer()}return new nZ(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}},{key:"dropLegality",value:function(e,t){return t.turn>=40?sz.failure(tZ.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord)!==HG.NONE?sz.failure(nq.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?sz.failure(tZ.MUST_DROP_IN_CENTRAL_ZONE()):sz.success(void 0)}},{key:"simpleMoveLegality",value:function(e,t){return t.turn<40?sz.failure(tZ.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?sz.failure(nq.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end)!==HG.NONE?sz.failure(nq.MUST_LAND_ON_EMPTY_SPACE()):sz.success(void 0)}},{key:"jumpLegality",value:function(e,t){if(t.turn<40)return sz.failure(tZ.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return sz.failure(nq.MUST_CHOOSE_PLAYER_PIECE());var n,r=zp(e.getJumpedOverCoords());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.getPieceAt(i)===HG.NONE)return sz.failure(tZ.MUST_JUMP_OVER_PIECES())}}catch(u){r.e(u)}finally{r.f()}var o,a=zp(e.getLandingCoords());try{for(a.s();!(o=a.n()).done;){var s=o.value;if(t.getPieceAt(s)!==HG.NONE)return sz.failure(nq.MUST_LAND_ON_EMPTY_SPACE())}}catch(u){a.e(u)}finally{a.f()}return sz.success(void 0)}},{key:"jumpTargetsFrom",value:function(e){for(var t=[],n=0,r=[new zG(e.x+2,e.y),new zG(e.x-2,e.y),new zG(e.x,e.y+2),new zG(e.x,e.y-2),new zG(e.x+2,e.y+2),new zG(e.x+2,e.y-2),new zG(e.x-2,e.y+2),new zG(e.x-2,e.y-2)];n<r.length;n++){var i=r[n];oZ.of([e,i]).isSuccess()&&t.push(i)}return t}},{key:"nextJumps",value:function(e,t){var n,r=e.getEndingCoord(),i=[],o=zp(this.jumpTargetsFrom(r));try{for(o.s();!(n=o.n()).done;){var a=n.value,s=e.addJump(a);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}}catch(u){o.e(u)}finally{o.f()}return i}},{key:"jumpHasPossibleNextTargets",value:function(e,t){return this.nextJumps(e,t).length>0}},{key:"getGameStatus",value:function(e){var t,n=e.gameState,r=[0,0],i=zp(nZ.ALL_SHELTERS);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=n.getPieceAt(o);if(a!==HG.NONE&&(r[a.value]+=1,20===r[a.value]))return bq.getVictory(a)}}catch(s){i.e(s)}finally{i.f()}return bq.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=kz.of(new n)),n.singleton.get()}}]),n}(_q)).singleton=kz.empty(),X$),uZ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}},{key:"getListMovesDrop",value:function(e){for(var t=[],n=nZ.CENTRAL_ZONE_TOP_LEFT,r=nZ.CENTRAL_ZONE_BOTTOM_RIGHT,i=n.y;i<=r.y;i++)for(var o=n.x;o<=r.x;o++)e.getPieceAtXY(o,i)===HG.NONE&&t.push(rZ.of(new zG(o,i)).get());return t}},{key:"getListMovesAfterDrop",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<nZ.HEIGHT;r++)for(var i=0;i<nZ.WIDTH;i++){var o=new zG(i,r);e.getPieceAt(o)===n&&(t=(t=t.concat(this.getListSimpleMoves(e,o))).concat(this.getListJumps(e,o)))}return t}},{key:"getListSimpleMoves",value:function(e,t){for(var n=[],r=0,i=[new zG(t.x+1,t.y),new zG(t.x-1,t.y),new zG(t.x,t.y+1),new zG(t.x,t.y-1),new zG(t.x+1,t.y+1),new zG(t.x+1,t.y-1),new zG(t.x-1,t.y+1),new zG(t.x-1,t.y-1)];r<i.length;r++){var o=i[r],a=iZ.of(t,o);a.isSuccess()&&sZ.get().simpleMoveLegality(a.get(),e).isSuccess()&&n.push(a.get())}return n}},{key:"getListJumps",value:function(e,t){var n,r=new sq,i=zp(sZ.get().jumpTargetsFrom(t));try{for(i.s();!(n=i.n()).done;){var o=n.value,a=oZ.of([t,o]).get();sZ.get().jumpLegality(a,e).isSuccess()&&(r.add(a),r.union(this.getListJumpStartingFrom(e,a)))}}catch(s){i.e(s)}finally{i.f()}return r.toList()}},{key:"getListJumpStartingFrom",value:function(e,t){var n,r=sZ.get().nextJumps(t,e),i=new sq(r),o=zp(r);try{for(o.s();!(n=o.n()).done;){var a=n.value;i.union(this.getListJumpStartingFrom(e,a))}}catch(s){o.e(s)}finally{o.f()}return i}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=0,r=new vq;r.set(HG.ZERO,0),r.set(HG.ONE,0);for(var i=0;i<nZ.HEIGHT;i++)for(var o=0;o<nZ.WIDTH;o++){var a=new zG(o,i),s=t.getPieceAt(a);if(s!==HG.NONE)if(t.isShelter(a)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new oq(s.getVictoryValue())}else{var u,c=100,l=zp(nZ.ALL_SHELTERS);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(t.getPieceAt(h)===HG.NONE){var f=a.getOrthogonalDistance(h);c=Math.min(c,f)}}}catch(d){l.e(d)}finally{l.f()}n-=s.getScoreModifier()*c}}return new oq(n)}}]),n}(iq),cZ=HG.NONE,lZ=HG.ZERO,hZ=HG.ONE,fZ=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(en||(en=xp(["Board and aim of the game"]))),$localize(tn||(tn=xp(["Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially."]))),nZ.getInitialState()),Eq.anyMove($localize(nn||(nn=xp(["Initial phase"]))),$localize(rn||(rn=xp(["In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone."]))),nZ.getInitialState(),rZ.of(new zG(7,7)).get(),$localize(on||(on=xp(["Congratulations!"])))),Eq.fromPredicate($localize(an||(an=xp(["Simple move"]))),$localize(sn||(sn=xp(["Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move."]))),new nZ([[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,lZ,lZ,hZ,hZ,lZ,lZ,hZ,lZ,hZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,lZ,hZ,lZ,hZ,lZ,lZ,lZ,lZ,hZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,lZ,hZ,cZ,cZ,cZ,cZ,cZ,hZ,lZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,hZ,lZ,lZ,hZ,hZ,hZ,lZ,lZ,lZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,hZ,lZ,hZ,hZ,hZ,hZ,hZ,hZ,lZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ]],40),iZ.of(new zG(4,6),new zG(3,5)).get(),function(e,t){return e.isSimple()?lz.SUCCESS:lz.failure($localize(un||(un=xp(["You have made a jump, not a simple move. Try again!"]))))},$localize(cn||(cn=xp(["Congratulations!"])))),Eq.fromPredicate($localize(ln||(ln=xp(["Jumps"]))),$localize(hn||(hn=xp(["The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful)."]))),new nZ([[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,lZ,lZ,hZ,hZ,lZ,lZ,hZ,lZ,hZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,lZ,hZ,lZ,hZ,lZ,lZ,lZ,lZ,hZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,lZ,hZ,cZ,cZ,cZ,cZ,cZ,hZ,lZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,hZ,lZ,lZ,hZ,hZ,hZ,lZ,lZ,lZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,hZ,lZ,hZ,hZ,hZ,hZ,hZ,hZ,lZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ]],40),oZ.of([new zG(6,7),new zG(6,5)]).get(),function(e,t){return e.isJump()?lz.SUCCESS:lz.failure($localize(fn||(fn=xp(["You have not performed a jump. Try again!"]))))},$localize(dn||(dn=xp(["Congratulations!"])))),Eq.fromMove($localize(pn||(pn=xp(["Chaining jumps in a single move"]))),$localize(vn||(vn=xp(["Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it."]))),new nZ([[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,hZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,hZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,hZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,lZ,lZ,cZ,hZ,lZ,lZ,hZ,lZ,hZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,lZ,cZ,lZ,hZ,lZ,lZ,lZ,lZ,hZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,lZ,hZ,cZ,cZ,cZ,cZ,cZ,hZ,lZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,hZ,lZ,lZ,hZ,hZ,hZ,lZ,lZ,lZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,hZ,lZ,hZ,hZ,hZ,hZ,hZ,hZ,lZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ],[cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ]],40),[oZ.of([new zG(8,6),new zG(6,4),new zG(6,2),new zG(6,0)]).get()],$localize(gn||(gn=xp(["Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does."]))),$localize(yn||(yn=xp(["You have not performed a triple jump. Try again!"]))))]};function dZ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"rect",9),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().$implicit;return Vp.fc(2).onClick(e.coord)}),Vp.Pb()}if(2&e){var r=Vp.fc().$implicit,i=Vp.fc(2);Vp.Cb("x",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.x+i.STROKE_WIDTH)("y",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE-3*i.STROKE_WIDTH)("height",i.SPACE_SIZE-3*i.STROKE_WIDTH)}}function pZ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"circle",6),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().$implicit;return Vp.fc(2).onClick(e.coord)}),Vp.Pb()}if(2&e){var r=Vp.fc(),i=r.index,o=r.$implicit,a=Vp.fc().index,s=Vp.fc();Vp.oc("id","piece_",i,"_",a,""),Vp.mc("ngClass",o.pieceClasses),Vp.Cb("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*a+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function vZ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",6),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(2).onClick(e.coord)}),Vp.Pb(),Vp.Ac(2,dZ,1,4,"rect",7),Vp.Ac(3,pZ,1,6,"circle",8),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc().index,a=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",i,"_",o,""),Vp.mc("ngClass",r.squareClasses),Vp.Cb("x",a.SPACE_SIZE*i+a.STROKE_WIDTH)("y",a.SPACE_SIZE*o+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",r.isShelter),Vp.Bb(1),Vp.mc("ngIf",r.hasPiece)}}function gZ(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,vZ,4,9,"g",1),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function yZ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",10),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onClick(e)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.Bb(1),Vp.mc("ngClass",i.viewInfo.boardInfo[r.y][r.x].shelterClasses),Vp.Cb("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function mZ(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",11)),2&e){var n=t.$implicit,r=Vp.fc();Vp.nc("id","sidePiece_0_",n,""),Vp.Cb("cx",-r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function bZ(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",12)),2&e){var n=t.$implicit,r=Vp.fc();Vp.nc("id","sidePiece_1_",n,""),Vp.Cb("cx",1715+r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function _Z(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"rect",13)),2&e){var n=Vp.fc();Vp.Cb("x",n.SPACE_SIZE*n.CENTRAL_ZONE_START.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.CENTRAL_ZONE_START.y+n.STROKE_WIDTH)("width",n.CENTRAL_ZONE_SIZE.x*n.SPACE_SIZE)("height",n.CENTRAL_ZONE_SIZE.y*n.SPACE_SIZE)}}var wZ,kZ,CZ,EZ,OZ,SZ,PZ=((EZ=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).ALL_SHELTERS=nZ.ALL_SHELTERS,r.CENTRAL_ZONE_START=nZ.CENTRAL_ZONE_TOP_LEFT,r.CENTRAL_ZONE_SIZE=new DG(nZ.CENTRAL_ZONE_BOTTOM_RIGHT.x-nZ.CENTRAL_ZONE_TOP_LEFT.x+1,nZ.CENTRAL_ZONE_BOTTOM_RIGHT.y-nZ.CENTRAL_ZONE_TOP_LEFT.y+1),r.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},r.selected=kz.empty(),r.jumpInConstruction=kz.empty(),r.PIECE_RADIUS=.5*(r.SPACE_SIZE-2*r.STROKE_WIDTH),r.rules=sZ.get(),r.availableMinimaxes=[new uZ(r.rules,"ConspirateursMinimax")],r.encoder=aZ,r.tutorial=(new fZ).tutorial,r}return Kp(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"updateViewInfo",value:function(){var e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(var t=0;t<nZ.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(var n=0;n<nZ.WIDTH;n++){var r=new zG(n,t),i=e.getPieceAt(r),o={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i!==HG.NONE,isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(o)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}},{key:"updateOccupiedShelters",value:function(){var e,t=zp(nZ.ALL_SHELTERS);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.viewInfo.boardInfo[n.y][n.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("highlighted")}}catch(i){t.e(i)}finally{t.f()}}},{key:"updateSelected",value:function(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){var e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;var r,i=zp(e.coords);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("moved")}}catch(s){i.e(s)}finally{i.f()}}else{var a=this.selected.get();this.viewInfo.boardInfo[a.y][a.x].pieceClasses.push("selected")}}},{key:"updateVictory",value:function(){var e=this.getState(),t=sZ.get().getGameStatus(this.rules.node);if(!0===t.isEndGame){var n,r=zp(nZ.ALL_SHELTERS);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.getPieceAt(i)===t.winner&&this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("victory")}}catch(o){r.e(o)}finally{r.f()}}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved");else{this.viewInfo.lastMoveArrow="";var t,n=zp(e.coords);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}catch(i){n.e(i)}finally{n.f()}}}},{key:"cancelMoveAttempt",value:function(){this.jumpInConstruction=kz.empty(),this.selected=kz.empty(),this.updateBoard()}},{key:"onClick",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if((i=t.getState()).getPieceAt(e)!==t.getCurrentPlayer()){n.next=6;break}return n.abrupt("return",(t.selected=kz.of(e),t.jumpInConstruction=kz.empty(),t.updateViewInfo(),lz.SUCCESS));case 6:if(!t.jumpInConstruction.isPresent()){n.next=8;break}return n.abrupt("return",t.constructJump(e));case 8:if(!t.selected.isPresent()){n.next=10;break}return n.abrupt("return",t.selectNextCoord(e));case 10:if(!i.isDropPhase()){n.next=13;break}return o=rZ.of(e),n.abrupt("return",(vz(o.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(o.get(),i)));case 13:return n.abrupt("return",t.cancelMove(nq.MUST_CHOOSE_PLAYER_PIECE()));case 14:case"end":return n.stop()}},n)}))()}},{key:"constructJump",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.jumpInConstruction.get(),i=t.getState(),!e.equals(r.getEndingCoord())){n.next=3;break}return n.abrupt("return",t.chooseMove(r,i));case 3:if(!(o=r.addJump(e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(o.getReason()));case 6:return a=t.rules.jumpLegality(o.get(),i),n.abrupt("return",a.isFailure()?t.cancelMove(a.getReason()):t.updateJump(o.get()));case 8:case"end":return n.stop()}},n)}))()}},{key:"updateJump",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),n.abrupt("return",t.rules.jumpHasPossibleNextTargets(e,r)?(t.jumpInConstruction=kz.of(e),t.updateViewInfo(),lz.SUCCESS):t.chooseMove(e,r));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectNextCoord",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.selected.get(),!(i=iZ.of(r,e)).isSuccess()){n.next=3;break}return n.abrupt("return",t.chooseMove(i.get(),t.getState()));case 3:return o=oZ.of([r,e]),n.abrupt("return",o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(o.get()));case 5:case"end":return n.stop()}},n)}))()}}]),n}(WG)).\u0275fac=function(e){return new(e||EZ)(Vp.Lb(qG))},EZ.\u0275cmp=Vp.Fb({type:EZ,selectors:[["app-conspirateurs"]],features:[Vp.yb],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1",3,"id",4,"ngFor","ngForOf"],["class","base no-fill highlighted mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0",3,"id"],[1,"base","mid-stroke","player1",3,"id"],[1,"base","no-fill","highlighted","mid-stroke"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,gZ,2,1,"g",1),Vp.Ac(2,yZ,2,5,"g",1),Vp.Ac(3,mZ,1,4,"circle",2),Vp.Ac(4,bZ,1,4,"circle",3),Vp.Ac(5,_Z,1,4,"rect",4),Vp.Mb(6,"polyline",5),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",t.viewInfo.boardInfo),Vp.Bb(1),Vp.mc("ngForOf",t.ALL_SHELTERS),Vp.Bb(1),Vp.mc("ngForOf",t.range(t.viewInfo.sidePieces[0])),Vp.Bb(1),Vp.mc("ngForOf",t.range(t.viewInfo.sidePieces[1])),Vp.Bb(1),Vp.mc("ngIf",t.viewInfo.dropPhase),Vp.Bb(1),Vp.Cb("points",t.viewInfo.lastMoveArrow))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),EZ),IZ=((CZ=function(){function e(t,n){Qp(this,e),this.owner=t,this.otherPieceType=n}return Kp(e,[{key:"toString",value:function(){return"DiamPiece(".concat(this.owner,", ").concat(this.otherPieceType,")")}}],[{key:"of",value:function(t,n){return t===HG.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===HG.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}}]),e}()).encoder=wz.tuple([HG.numberEncoder,wz.booleanEncoder],function(e){return[e.owner,e.otherPieceType]},function(e){return CZ.of(e[0],e[1])}),CZ.EMPTY=new CZ(HG.NONE,!1),CZ.ZERO_FIRST=new CZ(HG.ZERO,!1),CZ.ZERO_SECOND=new CZ(HG.ZERO,!0),CZ.ONE_FIRST=new CZ(HG.ONE,!1),CZ.ONE_SECOND=new CZ(HG.ONE,!0),CZ.PLAYER_PIECES=[CZ.ZERO_FIRST,CZ.ZERO_SECOND,CZ.ONE_FIRST,CZ.ONE_SECOND],CZ),TZ=((kZ=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;if(Qp(this,n),(i=t.call(this)).target=e,i.piece=r,r===IZ.EMPTY)throw new Error("Cannot drop an empty piece");return tv(i)}return Kp(n,[{key:"isDrop",value:function(){return!0}},{key:"getTarget",value:function(){return this.target}},{key:"equals",value:function(e){return this.target===e.target&&this.piece===e.piece}},{key:"toString",value:function(){return"DiamMoveDrop(".concat(this.target,", ").concat(this.piece,")")}}]),n}(hq)).encoder=wz.tuple([wz.numberEncoder(7),IZ.encoder],function(e){return[e.target,e.piece]},function(e){return new kZ(e[0],e[1])}),kZ),AZ=((wZ=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this)).start=e,i.moveDirection=r,i}return Kp(n,[{key:"isDrop",value:function(){return!1}},{key:"getTarget",value:function(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}},{key:"equals",value:function(e){return!1!==this.start.equals(e.start)&&this.moveDirection===e.moveDirection}},{key:"toString",value:function(){return"DiamMoveShift(".concat(this.start,", ").concat(this.moveDirection,")")}}],[{key:"fromRepresentation",value:function(e,t){return new n(new zG(e.x,3-e.y),t)}}]),n}(hq)).encoder=wz.tuple([zG.numberEncoder(8,4),wz.booleanEncoder],function(e){return[e.start,"clockwise"===e.moveDirection]},function(e){return new wZ(e[0],e[1]?"clockwise":"counterclockwise")}),wZ),NZ=wz.disjunction(TZ.encoder,AZ.encoder,function(e){return e.isDrop()}),xZ=function(){var e=function e(){Qp(this,e)};return e.NO_MORE_PIECES_OF_THIS_TYPE=function(){return $localize(mn||(mn=xp(["You do not have any pieces of this type anymore."])))},e.SPACE_IS_FULL=function(){return $localize(bn||(bn=xp(["You cannot play here: this space is already full."])))},e.TARGET_STACK_TOO_HIGH=function(){return $localize(_n||(_n=xp(["You cannot add more pieces to the target stack, as it will contain more than 4 pieces."])))},e.MUST_SHIFT_TO_NEIGHBOR=function(){return $localize(wn||(wn=xp(["To perform a shift, you must move the pieces to a neighboring space."])))},e.MUST_SELECT_PIECE_FIRST=function(){return $localize(kn||(kn=xp(["You must first select either a piece from the side, or a stack of pieces to shift on the board."])))},e}(),RZ=((SZ=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e,i)).remainingPieces=r,o}return Kp(n,[{key:"getRemainingPiecesOf",value:function(e){return this.remainingPieces[n.pieceIndex(e)]}},{key:"getStackHeight",value:function(e){for(var t=0,r=0;r<n.HEIGHT&&this.getPieceAtXY(e,r)!==IZ.EMPTY;r++)t++;return t}}],[{key:"getInitialState",value:function(){var e=IZ.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}},{key:"fromRepresentation",value:function(e,t){for(var r=e.reverse(),i=[4,4,4,4],o=0;o<n.HEIGHT;o++)for(var a=0;a<n.WIDTH;a++){var s=r[o][a];r[o][a]!==IZ.EMPTY&&i[n.pieceIndex(s)]--}return vz(i.every(function(e){return e>=0}),"Invalid DiamState representation uses too many pieces"),new n(r,i,t)}},{key:"pieceIndex",value:function(e){switch(e){case IZ.ZERO_FIRST:return 0;case IZ.ZERO_SECOND:return 1;case IZ.ONE_FIRST:return 2;default:return dz.expectToBe(e,IZ.ONE_SECOND),3}}}]),n}(cq)).WIDTH=8,SZ.HEIGHT=4,SZ),MZ=((OZ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.call(this,RZ)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=rq.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;var r=rq.copyImmutableArray(t.remainingPieces);return r[RZ.pieceIndex(e.piece)]-=1,new RZ(n,r,t.turn+1)}},{key:"applyLegalShift",value:function(e,t){for(var n=rq.copyBiArray(t.board),r=e.getTarget(),i=t.getStackHeight(r),o=e.start.y;o<RZ.HEIGHT&&t.getPieceAtXY(e.start.x,o)!==IZ.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,o),n[o][e.start.x]=IZ.EMPTY,i++,o++;return new RZ(n,t.remainingPieces,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}},{key:"isDropLegal",value:function(e,t){return e.piece.owner!==t.getCurrentPlayer()?sz.failure(nq.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?sz.failure(xZ.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}},{key:"dropHeightValidity",value:function(e,t){return t.getStackHeight(e.target)===RZ.HEIGHT?sz.failure(xZ.SPACE_IS_FULL()):sz.success(void 0)}},{key:"isShiftLegal",value:function(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?sz.failure(nq.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}},{key:"shiftHeightValidity",value:function(e,t){var n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>RZ.HEIGHT?sz.failure(xZ.TARGET_STACK_TOO_HIGH()):sz.success(void 0)}},{key:"getGameStatus",value:function(e){var t=this.findHighestAlignment(e.gameState);if(t.isPresent()){var n=e.gameState.getPieceAt(t.get());return bq.getVictory(n.owner)}return bq.ONGOING}},{key:"findHighestAlignment",value:function(e){for(var t=0;t<RZ.WIDTH/2;t++)for(var n=RZ.HEIGHT-1;n>0;n--){var r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+RZ.WIDTH/2,n);if(r!==IZ.EMPTY&&r===i)return kz.of(new zG(t,n))}return kz.empty()}},{key:"pieceCanMove",value:function(e,t){return!!this.isShiftLegal(new AZ(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new AZ(t,"counterclockwise"),e).isSuccess()}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=kz.of(new n)),n.singleton.get()}}]),n}(_q)).singleton=kz.empty(),OZ),DZ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}},{key:"getListShifts",value:function(e){var t,n=[],r=zp(this.getShiftSources(e));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,o=0,a=[new AZ(i,"clockwise"),new AZ(i,"counterclockwise")];o<a.length;o++){var s=a[o];MZ.get().shiftHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"getListDrops",value:function(e){for(var t=this.getRemainingPiecesForCurrentPlayer(e),n=[],r=0;r<RZ.WIDTH;r++){var i,o=zp(t);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=new TZ(r,a);MZ.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){o.e(u)}finally{o.f()}}return n}},{key:"getRemainingPiecesForCurrentPlayer",value:function(e){var t,n=[],r=zp(IZ.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.currentPlayerCanDropPiece(e,i)&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"currentPlayerCanDropPiece",value:function(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}},{key:"getShiftSources",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<RZ.HEIGHT;r++)for(var i=0;i<RZ.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new zG(i,r));return t}},{key:"getBoardValue",value:function(e){var t=MZ.get().getGameStatus(e);return new oq(t.isEndGame?t.toBoardValue():0)}}]),n}(iq),LZ=IZ.EMPTY,BZ=IZ.ZERO_FIRST,FZ=IZ.ZERO_SECOND,jZ=IZ.ONE_FIRST,UZ=IZ.ONE_SECOND,VZ=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(Cn||(Cn=xp(["Initial board and player pieces"]))),$localize(En||(En=xp(["Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right."]))),RZ.getInitialState()),Eq.fromMove($localize(On||(On=xp(["Goal of the game"]))),$localize(Sn||(Sn=xp(["At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!"]))),RZ.fromRepresentation([[LZ,LZ,LZ,LZ,LZ,LZ,LZ,LZ],[LZ,LZ,LZ,LZ,LZ,LZ,LZ,LZ],[LZ,LZ,LZ,LZ,jZ,LZ,LZ,LZ],[BZ,LZ,LZ,LZ,BZ,LZ,LZ,LZ]],3),[new TZ(0,IZ.ONE_FIRST)],$localize(Pn||(Pn=xp(["Congratulations, you won!"]))),$localize(In||(In=xp(["Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board."])))),Eq.fromMove($localize(Tn||(Tn=xp(["Types of move"]))),$localize(An||(An=xp(["You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more  than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board."]))),RZ.fromRepresentation([[LZ,LZ,LZ,LZ,LZ,LZ,LZ,LZ],[LZ,LZ,LZ,LZ,UZ,LZ,LZ,LZ],[LZ,LZ,LZ,LZ,BZ,LZ,LZ,LZ],[jZ,LZ,LZ,LZ,FZ,LZ,LZ,LZ]],4),[AZ.fromRepresentation(new zG(4,3),"counterclockwise"),AZ.fromRepresentation(new zG(4,3),"clockwise"),AZ.fromRepresentation(new zG(4,2),"counterclockwise"),AZ.fromRepresentation(new zG(4,2),"clockwise")],$localize(Nn||(Nn=xp(["Congratulations!"]))),$localize(xn||(xn=xp(["Failed, try to move one of your piece that is already on the board."])))),Eq.fromMove($localize(Rn||(Rn=xp(["Special case"]))),$localize(Mn||(Mn=xp(["It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!"]))),RZ.fromRepresentation([[LZ,LZ,LZ,LZ,BZ,LZ,LZ,LZ],[LZ,LZ,LZ,LZ,UZ,LZ,LZ,BZ],[LZ,LZ,LZ,LZ,BZ,LZ,LZ,UZ],[LZ,jZ,LZ,LZ,FZ,LZ,LZ,jZ]],8),[AZ.fromRepresentation(new zG(4,2),"counterclockwise")],$localize(Dn||(Dn=xp(["Congratulations!"]))),$localize(Ln||(Ln=xp(["Failed, try to shift a stack of pieces to the left."]))))]};function zZ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"path",6),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onSpaceClick(e)}),Vp.Pb(),Vp.Qb(2,"path",7),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onSpaceClick(e)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.Bb(1),Vp.nc("id","click_",r,""),Vp.mc("ngClass",i.viewInfo.boardInfo[r].spaceClasses),Vp.Cb("d",i.BOARD_PATHS[r]),Vp.Bb(1),Vp.mc("ngClass",i.viewInfo.boardInfo[r].spaceClasses),Vp.Cb("d",i.DECORATION_PATHS[r])}}function HZ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g",9),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit,r=Vp.fc().$implicit;return Vp.fc().onPieceInGameClick(r,e.y)}),Vp.Mb(1,"use",10),Vp.Mb(2,"use",11),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc().$implicit;Vp.oc("id","click_",i,"_",r.y,""),Vp.mc("ngClass",r.foregroundClasses),Vp.Bb(1),Vp.mc("ngClass",r.backgroundClasses),Vp.Cb("x",r.drawPosition.x)("y",r.drawPosition.y),Vp.Bb(1),Vp.Cb("x",r.drawPosition.x)("y",r.drawPosition.y)}}function GZ(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,HZ,3,8,"g",8),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc();Vp.Bb(1),Vp.mc("ngForOf",r.viewInfo.boardInfo[n].pieces)}}function qZ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g",12),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onRemainingPieceClick(e.actualPiece)}),Vp.Mb(1,"use",10),Vp.Mb(2,"use",11),Vp.Pb()}if(2&e){var r=t.$implicit;Vp.oc("id","piece_",r.actualPiece.owner.value,"_",r.actualPiece.otherPieceType?1:0,""),Vp.mc("ngClass",r.foregroundClasses),Vp.Bb(1),Vp.mc("ngClass",r.backgroundClasses),Vp.Cb("x",r.drawPosition.x)("y",r.drawPosition.y),Vp.Bb(1),Vp.Cb("x",r.drawPosition.x)("y",r.drawPosition.y)}}var WZ,$Z,ZZ,QZ,YZ=function(){return[0,1,2,3,4,5,6,7]},KZ=function(){return[2,1,3,0,4,7,5,6]},JZ=((WZ=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],r.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],r.selected=kz.empty(),r.viewInfo={boardInfo:[],remainingPieces:[]},r.rules=MZ.get(),r.availableMinimaxes=[new DZ(r.rules,"DiamDummyMinimax")],r.encoder=NZ,r.tutorial=(new VZ).tutorial,r}return Kp(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"onSpaceClick",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#click_"+e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClickAfterCheck",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selected.isPresent()){n.next=14;break}if("pieceFromReserve"!==(r=t.selected.get()).type){n.next=6;break}i=new TZ(e,r.piece),n.next=13;break;case 6:if((r.position.x+1)%RZ.WIDTH!==e){n.next=10;break}i=new AZ(r.position,"clockwise"),n.next=13;break;case 10:if((r.position.x+(RZ.WIDTH-1))%RZ.WIDTH===e){n.next=12;break}return n.abrupt("return",t.cancelMove(xZ.MUST_SHIFT_TO_NEIGHBOR()));case 12:i=new AZ(r.position,"counterclockwise");case 13:return n.abrupt("return",t.chooseMove(i,t.getState()));case 14:return n.abrupt("return",t.cancelMove(xZ.MUST_SELECT_PIECE_FIRST()));case 15:case"end":return n.stop()}},n)}))()}},{key:"onPieceInGameClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.getState().getPieceAtXY(e,t).owner===n.getCurrentPlayer()?(n.selected=kz.of({type:"pieceFromBoard",position:new zG(e,t)}),n.updateViewInfo(),lz.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(nq.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return r.stop()}},r)}))()}},{key:"onRemainingPieceClick",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay(t.getPieceId(e)),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):e.owner===t.getCurrentPlayer()?(t.selected=kz.of({type:"pieceFromReserve",piece:e}),t.updateViewInfo(),lz.SUCCESS):t.cancelMove(nq.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return n.stop()}},n)}))()}},{key:"getPieceId",value:function(e){return"#piece_"+e.owner.value+"_"+(e.otherPieceType?1:0)}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"getLastMovedFromDrop",value:function(e,t){var n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),o=this.getDrawPositionOnBoard(r,i),a=new zG(r,i);return[{start:kz.empty(),end:a,startDrawPosition:n,endDrawPosition:o}]}},{key:"getLastMovedFromShift",value:function(e,t){for(var n=e.start.x,r=e.getTarget(),i=t.getStackHeight(r),o=[],a=e.start.y;a<RZ.HEIGHT&&t.getPieceAtXY(n,a)!==IZ.EMPTY;a++,i++)o.push({start:kz.of(new zG(n,a)),end:new zG(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,a),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return o}},{key:"updateViewInfo",value:function(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}},{key:"updateBoardInfo",value:function(){for(var e=0;e<RZ.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}},{key:"showLastMove",value:function(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}},{key:"showLastMoveOnSpaces",value:function(){var e=this.rules.node.move;vz(e.isPresent(),"showLastMoveOnSpaces called without a last move");for(var t=e.get(),n=0;n<RZ.WIDTH;n++){var r=[];t.isDrop()?t.getTarget()===n&&r.push("moved"):t.getTarget()!==n&&t.start.x!==n||r.push("moved"),this.viewInfo.boardInfo[n].spaceClasses=r}}},{key:"showLastMoveOnPieces",value:function(){var e=this.rules.node.move;vz(e.isPresent(),"showLastMoveOnPieces called without a last move");var t,n=e.get(),r=this.getPreviousState(),i=zp(n.isDrop()?this.getLastMovedFromDrop(n,r):this.getLastMovedFromShift(n,r));try{for(i.s();!(t=i.n()).done;){var o=t.value;this.viewInfo.boardInfo[o.end.x].pieces[o.end.y].foregroundClasses.push("last-move")}}catch(a){i.e(a)}finally{i.f()}}},{key:"updateRemainingPiecesInfo",value:function(){var e=this.getCurrentPlayer();this.viewInfo.remainingPieces=[];var t,n=this.isPlayerTurn(),r=zp(IZ.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,o=this.getState().getRemainingPiecesOf(i),a=0;a<o;a++){var s=[];this.isTopPieceOfReserveAndSelected(a,o,i)&&s.push("selected"),n&&a===o-1&&i.owner===e&&s.push("clickable-hover"),this.viewInfo.remainingPieces.push({backgroundClasses:["player"+i.owner.value+(i.otherPieceType?"-alternate":"")],foregroundClasses:s,y:a,drawPosition:this.getDrawPositionRemainingPiece(i,a),actualPiece:i})}}catch(u){r.e(u)}finally{r.f()}}},{key:"isTopPieceOfReserveAndSelected",value:function(e,t,n){if(this.selected.isPresent()){var r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}},{key:"getDrawPositionRemainingPiece",value:function(e,t){var r,i;return r=e.owner===HG.ZERO?-100:600,i=e.otherPieceType?100:450,new zG(r,i).getNext(new DG(0,-t*n.PIECE_HEIGHT))}},{key:"getPieces",value:function(e){for(var t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[],i=0;i<RZ.HEIGHT;i++){var o=this.getState().getPieceAtXY(e,i),a=new zG(e,i);if(o!==IZ.EMPTY){var s=[];this.pieceFromBoardIsSelected(e,i)&&s.push("selected"),this.isVictory(e,i,t)&&s.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),a)&&s.push("clickable-hover"),r.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate":"")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:o})}}return r}},{key:"pieceFromBoardIsSelected",value:function(e,t){if(this.selected.isPresent()){var n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}},{key:"isVictory",value:function(e,t,n){if(n.isPresent()){var r=n.get();return r.x%4==e%4&&r.y===t}return!1}},{key:"getDrawPositionOnBoard",value:function(e,t){return n.CENTER[e].getNext(new DG(0,-t*n.PIECE_HEIGHT))}},{key:"cancelMoveAttempt",value:function(){this.selected=kz.empty(),this.updateBoard()}}]),n}(WG)).CENTER=[new zG(40,160),new zG(100,50),new zG(255,2),new zG(400,50),new zG(460,160),new zG(400,270),new zG(255,320),new zG(100,270)],WZ.PIECE_HEIGHT=36,WZ.\u0275fac=function(e){return new(e||WZ)(Vp.Lb(qG))},WZ.\u0275cmp=Vp.Fb({type:WZ,selectors:[["app-diam"]],features:[Vp.yb],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Qb(1,"defs"),Vp.Qb(2,"g",1),Vp.Mb(3,"path",2),Vp.Mb(4,"ellipse",3),Vp.Pb(),Vp.Pb(),Vp.Ac(5,zZ,3,5,"g",4),Vp.Ac(6,GZ,2,1,"g",4),Vp.Ac(7,qZ,3,8,"g",5),Vp.Pb()),2&e&&(Vp.Bb(5),Vp.mc("ngForOf",Vp.qc(3,YZ)),Vp.Bb(1),Vp.mc("ngForOf",Vp.qc(4,KZ)),Vp.Bb(1),Vp.mc("ngForOf",t.viewInfo.remainingPieces))},directives:[vg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),WZ),XZ=function(){function e(t,n){Qp(this,e),this.offset=t,this.constant=n}return Kp(e,[{key:"equals",value:function(e){return this===e||this.offset===e.offset&&this.constant===e.constant}},{key:"contains",value:function(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}},{key:"getDirection",value:function(){switch(this.constant){case"q":return KG.DOWN;case"r":return KG.RIGHT;case"s":return KG.DOWN_LEFT}}}],[{key:"fromTwoCoords",value:function(t,n){var r=t.x,i=n.x,o=t.y,a=n.y,s=r+o,u=i+a;return r===i&&o!==a&&s!==u?kz.of(e.constantQ(r)):r!==i&&o===a&&s!==u?kz.of(e.constantR(o)):r!==i&&o!==a&&s===u?kz.of(e.constantS(s)):kz.empty()}},{key:"constantQ",value:function(t){return new e(t,"q")}},{key:"constantR",value:function(t){return new e(t,"r")}},{key:"constantS",value:function(t){return new e(t,"s")}},{key:"areOnSameLine",value:function(t){if(t.length<2)return!0;var n=e.fromTwoCoords(t[0],t[1]);if(n.isAbsent())return!1;var r,i=n.get(),o=zp(t.slice(2));try{for(o.s();!(r=o.n()).done;){var a=r.value;if(!1===i.contains(a))return!1}}catch(s){o.e(s)}finally{o.f()}return!0}}]),e}(),eQ=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a,s){var u;if(Qp(this,n),(u=t.call(this,r,e)).board=r,u.width=i,u.height=o,u.excludedCases=a,u.empty=s,u.excludedCases.length>=u.height/2+1)throw new Error("Invalid excluded cases specification for HexagonalGameState.");return tv(u)}return Kp(n,[{key:"setAt",value:function(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}},{key:"equalsT",value:function(e,t){if(this===e)return!0;if(this.width!==e.width)return!1;if(this.height!==e.height)return!1;if(!1===t(this.empty,e.empty))return!1;if(this.excludedCases.length!==e.excludedCases.length)return!1;for(var n=0;n<this.excludedCases.length;n++)if(this.excludedCases[n]!==e.excludedCases[n])return!1;var r,i=zp(this.allCoords());try{for(i.s();!(r=i.n()).done;){var o=r.value;if(!1===t(this.getPieceAt(o),e.getPieceAt(o)))return!1}}catch(a){i.e(a)}finally{i.f()}return!0}},{key:"allCoords",value:function(){var e=[];return this.forEachCoord(function(t){e.push(t)}),e}},{key:"allLines",value:function(){for(var e=[],t=0;t<this.width;t++)e.push(XZ.constantQ(t));for(var n=0;n<this.height;n++)e.push(XZ.constantR(n));for(var r=this.excludedCases.length;r<this.height+this.excludedCases.length;r++)e.push(XZ.constantS(r));return e}},{key:"getEntranceOnLine",value:function(e){var t,n;switch(e.constant){case"q":return n=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new zG(e.offset,n));case"r":return t=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new zG(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new zG(e.offset,0):new zG(this.width-1,e.offset-this.width+1))}}},{key:"findEntranceFrom",value:function(e,t){for(var n=e.getDirection(),r=t,i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}return fz.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()}),new zG(-1,-1)}}],[{key:"neighbors",value:function(e,t){return[new zG(e.x+t,e.y-t),new zG(e.x+t,e.y),new zG(e.x-t,e.y+t),new zG(e.x-t,e.y),new zG(e.x,e.y+t),new zG(e.x,e.y-t)]}}]),n}(cq),tQ=((QZ=function(){function e(t,n,r){Qp(this,e),this.owner=t,this.size=n,this.source=r}return Kp(e,[{key:"getValue",value:function(){return e.encoder.encodeNumber(this)}},{key:"getOwner",value:function(){return this.owner}},{key:"belongsTo",value:function(e){return this.owner===e}},{key:"containsSource",value:function(){return this.source}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"getSize",value:function(){return this.size}},{key:"toString",value:function(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}],[{key:"append",value:function(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}}]),e}()).sizeEncoder=wz.numberEncoder(49),QZ.encoder=wz.tuple([wz.booleanEncoder,HG.numberEncoder,QZ.sizeEncoder],function(e){return[e.source,e.owner,e.size]},function(e){return new QZ(e[1],e[2],e[0])}),QZ.MAX_SIZE=49,QZ.EMPTY=new QZ(HG.NONE,0,!1),QZ.NONE=new QZ(HG.NONE,-1,!1),QZ.PLAYER_ZERO=new QZ(HG.ZERO,1,!1),QZ.PLAYER_ONE=new QZ(HG.ONE,1,!1),QZ.SOURCE=new QZ(HG.NONE,1,!0),QZ),nQ=((ZZ=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_CASES,tQ.EMPTY)).alreadyPassed=i,o}return Kp(n,[{key:"getAllPieces",value:function(){for(var e=[],t=0;t<n.HEIGHT;t++)for(var r=0;r<n.WIDTH;r++){var i=new zG(r,t);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}},{key:"numberOfNeighbors",value:function(e){var t=this;return eQ.neighbors(e,1).filter(function(e){return t.isOnBoard(e)&&!1===t.getPieceAt(e).isEmpty()}).length}},{key:"setAtUnsafe",value:function(e,t){var r=rq.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.alreadyPassed)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==tQ.NONE}}],[{key:"balancedBoard",value:function(){var e=tQ.NONE,t=tQ.PLAYER_ZERO,n=tQ.PLAYER_ONE,r=tQ.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==tQ.NONE}},{key:"getInitialState",value:function(){return new n(n.balancedBoard(),0,!1)}}]),n}(eQ)).WIDTH=11,ZZ.HEIGHT=5,ZZ.EXCLUDED_CASES=[2,1],ZZ),rQ=(($Z=function(e){Jp(n,e);var t=ev(n);function n(e,r){return Qp(this,n),t.call(this,e,r)}return Kp(n,[{key:"toString",value:function(){return this===n.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}},{key:"length",value:function(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}],[{key:"of",value:function(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return n.PASS;if(!nQ.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!nQ.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new n(e,t);if(e.x===t.x)return new n(e,t);if(e.x+e.y===t.x+t.y)return new n(e,t);throw new Error("Invalid move")}}]),n}(AW)).PASS=new $Z(new zG(-1,-1),new zG(-2,-2)),$Z.encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 42148}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return $Z.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new $Z(new zG((e=e/16|0)%16,r),new zG(n,t))}}]),n}(wz)),$Z),iQ=function(){var e=function e(){Qp(this,e)};return e.NOT_PLAYER_PIECE=function(){return $localize(Bn||(Bn=xp(["You must select a piece or a stack of your color."])))},e.EMPTY_STACK=function(){return $localize(Fn||(Fn=xp(["You must select a stack."])))},e.TOO_MANY_NEIGHBORS=function(){return $localize(jn||(jn=xp(["This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors."])))},e.CANT_REACH_TARGET=function(){return $localize(Un||(Un=xp(["This stack cannot move because it could never land on another piece."])))},e.INVALID_MOVE_LENGTH=function(){return $localize(Vn||(Vn=xp(["A stack must always be moved by as many spaces as there are pieces in the stack."])))},e.EMPTY_TARGET_STACK=function(){return $localize(zn||(zn=xp(["The stack must land on an occupied space."])))},e}(),oQ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"isMovablePiece",value:function(e,t){vz(e.isOnBoard(t),"piece is not on the board");var r=e.getPieceAt(t);return r.getSize()<1?lz.failure(iQ.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?lz.failure(iQ.TOO_MANY_NEIGHBORS()):n.pieceHasTarget(e,t)?lz.SUCCESS:lz.failure(iQ.CANT_REACH_TARGET()):lz.failure(iQ.NOT_PLAYER_PIECE())}},{key:"canOnlyPass",value:function(e){return 0===n.getMovablePieces(e).length}},{key:"sourceCoords",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).containsSource()})}},{key:"markPiecesConnectedTo",value:function(e,t,n){var r=this;eQ.neighbors(t,1).forEach(function(t){!e.isOnBoard(t)||n[t.y][t.x]||e.getPieceAt(t).isEmpty()||(n[t.y][t.x]=!0,r.markPiecesConnectedTo(e,t,n))})}},{key:"removeDisconnectedPieces",value:function(e){var t=this,n=rq.createTable(nQ.WIDTH,nQ.HEIGHT,!1);this.sourceCoords(e).forEach(function(r){n[r.y][r.x]=!0,t.markPiecesConnectedTo(e,r,n)});var r=e;return r.getAllPieces().forEach(function(e){n[e.y][e.x]||(r=r.setAt(e,tQ.EMPTY))}),r}},{key:"applyLegalMove",value:function(e,t,n){if(e===rQ.PASS)return new nQ(t.board,t.turn+1,!0);var r=t.getPieceAt(e.coord),i=t.getPieceAt(e.end),o=t.setAt(e.coord,tQ.EMPTY).setAt(e.end,tQ.append(r,i));return this.removeDisconnectedPieces(new nQ(o.board,t.turn+1,!1))}},{key:"isLegal",value:function(e,t){if(0===n.getMovablePieces(t).length)return e!==rQ.PASS||t.alreadyPassed?sz.failure(nq.MUST_PASS()):sz.success(void 0);if(e===rQ.PASS)return sz.failure(nq.CANNOT_PASS());var r=this.isMovablePiece(t,e.coord);if(r.isFailure())return r.toFailedFallible();var i=t.getPieceAt(e.coord);return e.length()!==i.getSize()?sz.failure(iQ.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?sz.failure(iQ.EMPTY_TARGET_STACK()):sz.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getScores(t);return 0===n.getMovablePieces(t).length?r[0]>r[1]?bq.ZERO_WON:r[0]<r[1]?bq.ONE_WON:bq.DRAW:bq.ONGOING}},{key:"getMovablePieces",value:function(e){return n.getFreePieces(e).filter(function(t){return n.pieceHasTarget(e,t)})}},{key:"getFreePieces",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6})}},{key:"pieceHasTarget",value:function(e,t){var n=e.getPieceAt(t).getSize();return void 0!==eQ.neighbors(t,n).find(function(t){return e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty()})}},{key:"pieceTargets",value:function(e,t){var n=e.getPieceAt(t).getSize();return eQ.neighbors(t,n).filter(function(t){return e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty()})}},{key:"getScores",value:function(e){var t=0,n=0;return e.getAllPieces().map(function(r){var i=e.getPieceAt(r);i.belongsTo(HG.ZERO)?t+=i.getSize():i.belongsTo(HG.ONE)&&(n+=i.getSize())}),[t,n]}}]),n}(_q),aQ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t=e.move,n=e.gameState,r=[];return oQ.getMovablePieces(n).forEach(function(e){return oQ.pieceTargets(n,e).forEach(function(t){var n=rQ.of(e,t);r.push(n)})}),0===r.length&&!1===t.equalsValue(rQ.PASS)&&r.push(rQ.PASS),r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=oQ.getScores(t);return 0===oQ.getMovablePieces(t).length?new oq(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new oq(n[0]-n[1])}}]),n}(iq),sQ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t=e.gameState,r=$p(iv(n.prototype),"getListMoves",this).call(this,e),i=t.getCurrentPlayer().getOpponent();return rq.sortByDescending(r,function(e){vz(e!==rQ.PASS,"Cannot sort with DvonnMove.PASS");var n=t.getPieceAt(e.end);return n.belongsTo(i)?n.getSize():0}),r}},{key:"getBoardValue",value:function(e){var t=oQ.getGameStatus(e);if(t.isEndGame)return new oq(t.toBoardValue());var n=e.gameState,r=oQ.getScores(n),i=n.getAllPieces(),o=i.length,a=i.filter(function(e){return n.getPieceAt(e).belongsTo(HG.ZERO)}).length,s=i.filter(function(e){return n.getPieceAt(e).belongsTo(HG.ONE)}).length;return new oq((s*r[1]-a*r[0])/o)}}]),n}(aQ),uQ=tQ.EMPTY,cQ=tQ.NONE,lQ=tQ.SOURCE,hQ=tQ.PLAYER_ZERO,fQ=tQ.PLAYER_ONE,dQ=new tQ(HG.ZERO,2,!1),pQ=new tQ(HG.ONE,2,!1),vQ=new tQ(HG.ZERO,4,!1),gQ=new tQ(HG.ONE,4,!1),yQ=function e(){Qp(this,e),this.tutorial=[Eq.anyMove($localize(Hn||(Hn=xp(["Moving"]))),$localize(Gn||(Gn=xp(["At Dvonn, each hexagonal space contains a stack of pieces.\n        If no number is indicated on a stack, it means that it only contains one piece.\n        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.\n        The owner of a stack is the one that has a piece at the top of the stack.\n        Only the owner of a stack can move it.\n        A stack cannot be moved if it is surrounded by 6 other stacks.\n        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.\n        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.\n        Therefore, there are six possible directions.\n        The player with dark pieces starts.<br/><br/>\n        You're playing Dark, click on a stack and move it by one space."]))),nQ.getInitialState(),rQ.of(new zG(2,0),new zG(3,0)),$localize(qn||(qn=xp(["Congratulations!"])))),Eq.fromPredicate($localize(Wn||(Wn=xp(["Disconnection"]))),$localize($n||($n=xp(['Pieces with a lightning strike are called "sources".\n        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>\n        You\'re playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!']))),new nQ([[cQ,cQ,fQ,lQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ],[cQ,uQ,hQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ],[uQ,uQ,gQ,uQ,uQ,uQ,uQ,fQ,lQ,uQ,uQ],[uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,cQ],[uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,cQ,cQ]],0,!1),rQ.of(new zG(2,1),new zG(2,0)),function(e,t){return e.end.equals(new zG(3,0))?lz.failure($localize(Zn||(Zn=xp(["You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it."])))):(vz(e.end.equals(new zG(2,0)),"player made an impossible move"),lz.SUCCESS)},$localize(Qn||(Qn=xp(["Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!\n        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.\n        Disconnected stacks will not be visible at the next turn."])))),Eq.fromPredicate($localize(Yn||(Yn=xp(["Moving on a source"]))),$localize(Kn||(Kn=xp(["You are allowed to move your stacks on any other stack.\n        This means that you can take control of a source by moving one of your stack on top of it.\n        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>\n        You're playing Dark and you can take control of a source, do it!"]))),new nQ([[cQ,cQ,lQ,fQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ],[cQ,hQ,hQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ],[uQ,fQ,hQ,fQ,uQ,uQ,hQ,pQ,lQ,uQ,uQ],[uQ,uQ,fQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,cQ],[uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,cQ,cQ]],0,!1),rQ.of(new zG(2,1),new zG(2,0)),function(e,t){return e.end.equals(new zG(2,0))?lz.SUCCESS:lz.failure($localize(Jn||(Jn=xp(["You have not taken possession of a source, try again."]))))},$localize(Xn||(Xn=xp(["Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!"])))),Eq.informational($localize(er||(er=xp(["Passing"]))),$localize(tr||(tr=xp(["It can happen that you have no possible move to make.\n        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>\n        This is a situation that occurs here for Dark."]))),new nQ([[cQ,cQ,lQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ],[cQ,uQ,dQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ],[uQ,uQ,pQ,uQ,uQ,uQ,uQ,pQ,lQ,vQ,uQ],[uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,cQ],[uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,cQ,cQ]],0,!1)),Eq.fromMove($localize(nr||(nr=xp(["End of the game"]))),$localize(rr||(rr=xp(["When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>\n        Make your last move."]))),new nQ([[cQ,cQ,lQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ],[cQ,uQ,hQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ],[uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,lQ,vQ,uQ],[uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,cQ],[uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,uQ,cQ,cQ]],0,!1),[rQ.of(new zG(2,1),new zG(2,0))],$localize(ir||(ir=xp(["Congratulations, you won 6 - 0!"]))),$localize(or||(or=xp(["Bad idea, by moving on the source you would have won a point."]))))]};function mQ(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",10)),2&e){var n=Vp.fc().$implicit,r=Vp.fc().$implicit,i=Vp.fc();Vp.mc("ngClass",i.getPieceClasses(n)),Vp.Cb("cx",i.getCenterAt(r).x)("cy",i.getCenterAt(r).y)("r",i.SPACE_SIZE)}}function bQ(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polygon",11)),2&e){var n=Vp.fc().$implicit,r=Vp.fc().$implicit,i=Vp.fc();Vp.Cb("transform",1===n.getSize()?"translate("+(i.getCenterAt(r).x-18)+" "+(i.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(r).x-3)+" "+(i.getCenterAt(r).y-12)+") scale(0.07)")}}function _Q(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"text",12),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).$implicit;return Vp.fc().onClick(e.x,e.y)}),Vp.Cc(1),Vp.Pb()}if(2&e){var r=Vp.fc().$implicit,i=Vp.fc().$implicit,o=Vp.fc();Vp.Cb("x",r.containsSource()?o.getCenterAt(i).x-7:o.getCenterAt(i).x)("y",o.getCenterAt(i).y),Vp.Bb(1),Vp.Dc(r.getSize())}}function wQ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g",5),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().$implicit;return Vp.fc().onClick(e.x,e.y)}),Vp.Mb(1,"polyline",6),Vp.Ac(2,mQ,1,4,"circle",7),Vp.Ac(3,bQ,1,1,"polygon",8),Vp.Ac(4,_Q,2,3,"text",9),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc().$implicit,o=Vp.fc();Vp.oc("id","click_",i.x,"_",i.y,""),Vp.Bb(1),Vp.Cb("points",o.getHexaCoordsAt(i)),Vp.Bb(1),Vp.mc("ngIf",r.getSize()>0),Vp.Bb(1),Vp.mc("ngIf",r.containsSource()),Vp.Bb(1),Vp.mc("ngIf",r.getSize()>1)}}var kQ=function(e){return[e]};function CQ(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,wQ,5,6,"g",4),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc();Vp.Bb(1),Vp.mc("ngForOf",Vp.rc(1,kQ,r.state.getPieceAt(n)))}}function EQ(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"text",16),Vp.Cc(1),Vp.Pb()),2&e){var n=Vp.fc().$implicit,r=Vp.fc();Vp.Cb("x",r.getCenterAt(n.coord).x)("y",r.getCenterAt(n.coord).y),Vp.Bb(1),Vp.Dc(n.caseContent.getSize())}}function OQ(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Mb(1,"polyline",13),Vp.Mb(2,"circle",14),Vp.Ac(3,EQ,2,3,"text",15),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc();Vp.Bb(1),Vp.Cb("points",r.getHexaCoordsAt(n.coord)),Vp.Bb(1),Vp.oc("id","captured_",n.coord.x,"_",n.coord.y,""),Vp.mc("ngClass",r.getPieceClasses(n.caseContent)),Vp.Cb("cx",r.getCenterAt(n.coord).x)("cy",r.getCenterAt(n.coord).y)("r",r.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",n.caseContent.getSize()>1)}}function SQ(e,t){if(1&e&&(Vp.ec(),Vp.Ob(0),Vp.Mb(1,"polyline",17),Vp.Mb(2,"polyline",17),Vp.Nb()),2&e){var n=Vp.fc();Vp.Bb(1),Vp.Cb("points",n.getHexaCoordsAt(n.lastMove.get().coord)),Vp.Bb(1),Vp.Cb("points",n.getHexaCoordsAt(n.lastMove.get().end))}}function PQ(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polyline",18)),2&e){var n=Vp.fc();Vp.Cb("points",n.getHexaCoordsAt(n.chosen.get()))}}var IQ,TQ,AQ,NQ,xQ,RQ=((IQ=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).lastMove=kz.empty(),r.chosen=kz.empty(),r.disconnecteds=[],r.rules=new oQ(nQ),r.availableMinimaxes=[new aQ(r.rules,"DvonnMinimax"),new sQ(r.rules,"DvonnMinimaxMaximizeStacks")],r.encoder=rQ.encoder,r.tutorial=(new yQ).tutorial,r.SPACE_SIZE=30,r.canPass=!1,r.scores=kz.of(oQ.getScores(r.rules.node.gameState)),r.hexaLayout=new JG(1.5*r.SPACE_SIZE,new zG(-r.SPACE_SIZE,2*r.SPACE_SIZE),eq.INSTANCE),r.state=r.rules.node.gameState,r.hexaBoard=r.rules.node.gameState.board,r}return Kp(n,[{key:"hideLastMove",value:function(){this.lastMove=kz.empty()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=kz.of(oQ.getScores(this.state))}},{key:"calculateDisconnecteds",value:function(){for(var e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState,n=0;n<t.board.length;n++)for(var r=0;r<t.board[n].length;r++){var i=new zG(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){var o=t.getPieceAt(i),a=e.getPieceAt(i);if(o.isEmpty()&&!a.isEmpty()){var s=new zG(r,n);this.disconnecteds.push({coord:s,caseContent:a})}}}}},{key:"cancelMoveAttempt",value:function(){this.chosen=kz.empty()}},{key:"pass",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return vz(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),t.next=3,e.chooseMove(rQ.PASS,e.rules.node.gameState);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=5;break}r.t0=n.cancelMove(i.getReason()),r.next=18;break;case 5:if(!n.chosen.isAbsent()){r.next=9;break}r.t1=n.choosePiece(e,t),r.next=17;break;case 9:if(!n.chosen.equalsValue(new zG(e,t))){r.next=13;break}r.t2=(n.cancelMoveAttempt(),lz.SUCCESS),r.next=16;break;case 13:return r.next=15,n.chooseDestination(e,t);case 15:r.t2=r.sent;case 16:r.t1=r.t2;case 17:r.t0=r.t1;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=new zG(e,t),r=this.rules.isMovablePiece(this.rules.node.gameState,n);return r.isSuccess()?(this.chosen=kz.of(n),lz.SUCCESS):this.cancelMove(r.getReason())}},{key:"chooseDestination",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),o=new zG(e,t),a=rQ.of(i,o),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e){if(e.containsSource()&&1===e.getSize())return["other-piece","dashed-stroke"];var t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"other-piece-stroke","dashed-stroke"]:[t]}}]),n}($G)).\u0275fac=function(e){return new(e||IQ)(Vp.Lb(qG))},IQ.\u0275cmp=Vp.Fb({type:IQ,selectors:[["app-dvonn"]],features:[Vp.yb],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","other-piece-light","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"other-piece-light"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured"],[1,"base","mid-stroke","transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","selected"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,CQ,2,3,"g",1),Vp.Ac(2,OQ,4,8,"g",1),Vp.Ac(3,SQ,3,2,"ng-container",2),Vp.Ac(4,PQ,1,1,"polyline",3),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",t.state.allCoords()),Vp.Bb(1),Vp.mc("ngForOf",t.disconnecteds),Vp.Bb(1),Vp.mc("ngIf",t.lastMove.isPresent()),Vp.Bb(1),Vp.mc("ngIf",t.chosen.isPresent()))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),IQ),MQ=function(e){return e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG",e}({}),DQ=((TQ=function(){function e(t){Qp(this,e),this.value=t}return Kp(e,[{key:"getPlayer",value:function(){switch(this){case e.SMALL_BLACK:case e.MEDIUM_BLACK:case e.BIG_BLACK:return HG.ZERO;case e.SMALL_WHITE:case e.MEDIUM_WHITE:case e.BIG_WHITE:return HG.ONE;default:return HG.NONE}}},{key:"getSize",value:function(){switch(this){case e.BIG_BLACK:case e.BIG_WHITE:return MQ.BIG;case e.MEDIUM_BLACK:case e.MEDIUM_WHITE:return MQ.MEDIUM;case e.SMALL_BLACK:case e.SMALL_WHITE:return MQ.SMALL;default:return dz.expectToBe(this,e.NONE),MQ.NONE}}},{key:"belongsTo",value:function(e){return this.getPlayer()===e}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){switch(this){case e.BIG_BLACK:return"BIG_BLACK";case e.BIG_WHITE:return"BIG_WHITE";case e.MEDIUM_BLACK:return"MEDIUM_BLACK";case e.MEDIUM_WHITE:return"MEDIUM_WHITE";case e.SMALL_BLACK:return"SMALL_BLACK";case e.SMALL_WHITE:return"SMALL_WHITE";default:return dz.expectToBe(this,e.NONE),"NONE"}}}],[{key:"of",value:function(e){switch(e){case 0:return this.SMALL_BLACK;case 1:return this.SMALL_WHITE;case 2:return this.MEDIUM_BLACK;case 3:return this.MEDIUM_WHITE;case 4:return this.BIG_BLACK;case 5:return this.BIG_WHITE;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}},{key:"ofSizeAndPlayer",value:function(t,n){return n===HG.ZERO&&t===MQ.BIG?e.BIG_BLACK:n===HG.ZERO&&t===MQ.MEDIUM?e.MEDIUM_BLACK:n===HG.ZERO&&t===MQ.SMALL?e.SMALL_BLACK:n===HG.ONE&&t===MQ.BIG?e.BIG_WHITE:n===HG.ONE&&t===MQ.MEDIUM?e.MEDIUM_WHITE:n===HG.ONE&&t===MQ.SMALL?e.SMALL_WHITE:e.NONE}}]),e}()).SMALL_BLACK=new TQ(0),TQ.SMALL_WHITE=new TQ(1),TQ.MEDIUM_BLACK=new TQ(2),TQ.MEDIUM_WHITE=new TQ(3),TQ.BIG_BLACK=new TQ(4),TQ.BIG_WHITE=new TQ(5),TQ.NONE=new TQ(6),TQ),LQ=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e,r)).remainingPieces=i,o}return Kp(n,[{key:"getRemainingPieces",value:function(){return rq.copyImmutableArray(this.remainingPieces)}},{key:"getRemainingPiecesOfPlayer",value:function(e){return this.getRemainingPieces().filter(function(t){return t.getPlayer()===e})}},{key:"pieceBelongsToCurrentPlayer",value:function(e){return e.belongsTo(this.getCurrentPlayer())}},{key:"isDroppable",value:function(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}},{key:"isInRemainingPieces",value:function(e){return this.remainingPieces.some(function(t){return t===e})}},{key:"getPlayerRemainingPieces",value:function(){var e=this;return this.remainingPieces.filter(function(t){return e.pieceBelongsToCurrentPlayer(t)})}}],[{key:"getInitialState",value:function(){var e=new BQ(HG.NONE,HG.NONE,HG.NONE).encode(),t=rq.createTable(3,3,e);return new n(rq.mapBiArray(t,function(e){return BQ.decode(e)}),0,[DQ.BIG_BLACK,DQ.BIG_BLACK,DQ.BIG_WHITE,DQ.BIG_WHITE,DQ.MEDIUM_BLACK,DQ.MEDIUM_BLACK,DQ.MEDIUM_WHITE,DQ.MEDIUM_WHITE,DQ.SMALL_BLACK,DQ.SMALL_BLACK,DQ.SMALL_WHITE,DQ.SMALL_WHITE])}}]),n}(cq),BQ=((xQ=function(){function e(t,n,r){Qp(this,e),this.small=t,this.medium=n,this.big=r}return Kp(e,[{key:"isEmpty",value:function(){return this.small===HG.NONE&&this.medium===HG.NONE&&this.big===HG.NONE}},{key:"toList",value:function(){var e=[];return this.small!==HG.NONE&&e.push(DQ.ofSizeAndPlayer(MQ.SMALL,this.small)),this.medium!==HG.NONE&&e.push(DQ.ofSizeAndPlayer(MQ.MEDIUM,this.medium)),this.big!==HG.NONE&&e.push(DQ.ofSizeAndPlayer(MQ.BIG,this.big)),e}},{key:"toOrderedPieceNames",value:function(){var e=DQ.ofSizeAndPlayer(MQ.SMALL,this.small),t=DQ.ofSizeAndPlayer(MQ.MEDIUM,this.medium),n=DQ.ofSizeAndPlayer(MQ.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}},{key:"getBiggest",value:function(){return this.big===HG.ZERO?DQ.BIG_BLACK:this.big===HG.ONE?DQ.BIG_WHITE:this.medium===HG.ZERO?DQ.MEDIUM_BLACK:this.medium===HG.ONE?DQ.MEDIUM_WHITE:this.small===HG.ZERO?DQ.SMALL_BLACK:this.small===HG.ONE?DQ.SMALL_WHITE:DQ.NONE}},{key:"tryToSuperposePiece",value:function(e){var t=this.getBiggest().getSize();if(e===DQ.NONE)throw new Error("Cannot move NONE on a space");return e.getSize()>t?kz.of(this.put(e)):kz.empty()}},{key:"removeBiggest",value:function(){var t,n=this.getBiggest();if(n===DQ.NONE)throw new Error("Cannot removed piece from empty space");var r=n.getSize();switch(r){case MQ.BIG:t=new e(this.small,this.medium,HG.NONE);break;case MQ.MEDIUM:t=new e(this.small,HG.NONE,HG.NONE);break;default:dz.expectToBe(r,MQ.SMALL),t=new e(HG.NONE,HG.NONE,HG.NONE)}return{removedCase:t,removedPiece:n}}},{key:"put",value:function(t){if(t===DQ.NONE)throw new Error("Cannot put NONE on space");var n=t.getPlayer(),r=t.getSize();switch(r){case MQ.BIG:return new e(this.small,this.medium,n);case MQ.MEDIUM:return vz(this.big===HG.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return dz.expectToBe(r,MQ.SMALL),vz(this.big===HG.NONE,"Cannot put a piece on top of a bigger one"),vz(this.medium===HG.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}},{key:"encode",value:function(){return this.small.value+3*this.medium.value+9*this.big.value}},{key:"belongsTo",value:function(e){return this.getBiggest().getPlayer()===e}},{key:"toString",value:function(){var e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}],[{key:"decode",value:function(t){vz(t%1==0,"EncapsuleCase must be encoded as integer: "+t),vz(t>=0,"To small representation for EncapsuleCase: "+t),vz(t<=26,"To big representation for EncapsuleCase: "+t);var n=HG.of(t%3);t-=n.value;var r=HG.of((t/=3)%3);return t-=r.value,new e(n,r,HG.of(t/=3))}}]),e}()).EMPTY=new xQ(HG.NONE,HG.NONE,HG.NONE),xQ),FQ=function(){var e=function e(){Qp(this,e)};return e.PIECE_OUT_OF_STOCK=function(){return $localize(ar||(ar=xp(["You do not have pieces of this type anymore."])))},e.INVALID_PLACEMENT=function(){return $localize(sr||(sr=xp(["You must put your piece on an empty square or on a smaller piece."])))},e.NOT_DROPPABLE=function(){return $localize(ur||(ur=xp(["You must pick your piece among the remaining ones."])))},e.INVALID_PIECE_SELECTED=function(){return $localize(cr||(cr=xp(["You must pick one of your remaining pieces or one piece on the board that is the biggest of its square."])))},e.SAME_DEST_AS_ORIGIN=function(){return $localize(lr||(lr=xp(["You must select a different landing square than the square where the move originates from."])))},e.END_YOUR_MOVE=function(){return $localize(hr||(hr=xp(["You are performing a move, you must select a landing square."])))},e}(),jQ=((NQ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){var r,i=t.getCopiedBoard(),o=t.getRemainingPieces(),a=t.turn+1;if(i[e.landingCoord.y][e.landingCoord.x]=BQ.decode(n.encode()),e.isDropping()){r=e.piece.get();var s=o.indexOf(r);o=o.slice(0,s).concat(o.slice(s+1))}else{var u=e.startingCoord.get(),c=i[u.y][u.x].encode(),l=BQ.decode(c).removeBiggest();i[u.y][u.x]=BQ.decode(l.removedCase.encode()),r=l.removedPiece}return new LQ(i,a,o)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isVictory",value:function(e){for(var t,r=e.getCopiedBoard(),i=kz.empty(),o=0;i.isAbsent()&&o<8;)t=n.LINES[o++],i=n.isVictoriousLine([r[t[0].y][t[0].x],r[t[1].y][t[1].x],r[t[2].y][t[2].x]]);return i}},{key:"isVictoriousLine",value:function(e){var t=e.map(function(e){return e.getBiggest()}).map(function(e){return e.getPlayer()});return t[0]===HG.NONE?kz.empty():t[0]===t[1]&&t[1]===t[2]?kz.of(t[0]):kz.empty()}},{key:"isLegal",value:function(e,t){var n;if(pz(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return sz.failure(nq.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return sz.failure(FQ.PIECE_OUT_OF_STOCK())}else{var r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return sz.failure(nq.MUST_CHOOSE_PLAYER_PIECE())}var i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return i.isPresent()?sz.success(i.get()):sz.failure(FQ.INVALID_PLACEMENT())}},{key:"getGameStatus",value:function(e){var t=n.isVictory(e.gameState);return t.isPresent()?bq.getVictory(t.get()):bq.ONGOING}}]),n}(_q)).LINES=[[new zG(0,0),new zG(0,1),new zG(0,2)],[new zG(1,0),new zG(1,1),new zG(1,2)],[new zG(2,0),new zG(2,1),new zG(2,2)],[new zG(0,0),new zG(1,0),new zG(2,0)],[new zG(0,1),new zG(1,1),new zG(2,1)],[new zG(0,2),new zG(1,2),new zG(2,2)],[new zG(0,0),new zG(1,1),new zG(2,2)],[new zG(0,2),new zG(1,1),new zG(2,0)]],NQ),UQ=((AQ=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this)).startingCoord=e,o.landingCoord=r,o.piece=i,o}return Kp(n,[{key:"isDropping",value:function(){return this.startingCoord.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}},{key:"toString",value:function(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}],[{key:"fromMove",value:function(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new n(kz.of(e),t,kz.empty())}},{key:"fromDrop",value:function(e,t){return new n(kz.empty(),t,kz.of(e))}}]),n}(hq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 161}},{key:"encodeNumber",value:function(e){var t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping())return 18*e.piece.get().value+6*t+2*n+0;var r=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*r+6*t+2*n+1}},{key:"decodeNumber",value:function(e){var t=e%2;e-=t;var n=(e/=2)%3;e-=n;var r=(e/=3)%3;e-=r,e/=3;var i=new zG(r,n);if(0===t){var o=DQ.of(e);return AQ.fromDrop(o,i)}var a=e%3;e-=a;var s=new zG((e/=3)%3,a);return AQ.fromMove(s,i)}}]),n}(wz)),AQ),VQ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getBoardValue",value:function(e){var t=jQ.getGameStatus(e);return new oq(t.toBoardValue())}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),o=aq.toComparableObjectSet(n.getPlayerRemainingPieces()),a=0;a<3;a++)for(var s=0;s<3;s++){var u,c=new zG(s,a),l=zp(o);try{for(l.s();!(u=l.n()).done;){var h=u.value,f=UQ.fromDrop(h,c);jQ.isLegal(f,n).isSuccess()&&t.push(f)}}catch(y){l.e(y)}finally{l.f()}if(r[a][s].belongsTo(i))for(var d=0;d<3;d++)for(var p=0;p<3;p++){var v=new zG(p,d);if(!v.equals(c)){var g=UQ.fromMove(c,v);jQ.isLegal(g,n).isSuccess()&&t.push(g)}}}return t}}]),n}(iq),zQ=new BQ(HG.NONE,HG.NONE,HG.NONE),HQ=new BQ(HG.ZERO,HG.NONE,HG.NONE),GQ=new BQ(HG.NONE,HG.ZERO,HG.NONE),qQ=new BQ(HG.NONE,HG.NONE,HG.ZERO),WQ=new BQ(HG.ONE,HG.NONE,HG.NONE),$Q=new BQ(HG.NONE,HG.NONE,HG.ONE),ZQ=new BQ(HG.ONE,HG.ZERO,HG.NONE),QQ=new BQ(HG.ZERO,HG.ZERO,HG.NONE),YQ=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(fr||(fr=xp(["Goal of the game"]))),$localize(dr||(dr=xp(["The goal of Encapsule is to align three of your pieces.\n        Here, we have a victory of the dark player."]))),new LQ([[HQ,WQ,$Q],[zQ,GQ,zQ],[zQ,zQ,qQ]],0,[DQ.SMALL_BLACK,DQ.MEDIUM_BLACK,DQ.BIG_BLACK,DQ.SMALL_WHITE,DQ.MEDIUM_WHITE,DQ.MEDIUM_WHITE,DQ.BIG_WHITE])),Eq.anyMove($localize(pr||(pr=xp(["Putting a piece"]))),$localize(vr||(vr=xp(["This is the initial board. You're playing Dark.<br/><br/>\n        Pick one of your piece on the side of the board and put it on the board."]))),LQ.getInitialState(),UQ.fromDrop(DQ.SMALL_BLACK,new zG(1,1)),$localize(gr||(gr=xp(["Congratulations!"])))),Eq.fromMove($localize(yr||(yr=xp(["Moving"]))),$localize(mr||(mr=xp(["Another possible action is to move one of your pieces that is already on the board.<br/><br/>\n        Click on your dark piece and then on any empty square of the board."]))),new LQ([[HQ,$Q,zQ],[zQ,zQ,zQ],[zQ,zQ,zQ]],0,[]),[UQ.fromMove(new zG(0,0),new zG(2,0)),UQ.fromMove(new zG(0,0),new zG(0,1)),UQ.fromMove(new zG(0,0),new zG(1,1)),UQ.fromMove(new zG(0,0),new zG(2,1)),UQ.fromMove(new zG(0,0),new zG(0,2)),UQ.fromMove(new zG(0,0),new zG(1,2)),UQ.fromMove(new zG(0,0),new zG(2,2))],$localize(br||(br=xp(["Congratulations!"]))),$localize(_r||(_r=xp(["Failed. Try again."])))),Eq.fromPredicate($localize(wr||(wr=xp(["Particularity"]))),$localize(kr||(kr=xp(['At Encapsule, pieces encapsulate each other.\n        It is therefore possible to have up to three pieces per square!\n        However, only the biggest piece of each square counts:\n        you cannot win with a piece that is "hidden" by a bigger piece.\n        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.\n        Finally, you cannot encapsulate a piece with a smaller piece.\n        You\'re playing Dark and you can win now in various ways.<br/><br/>\n        Try to win by making a move, and not by putting a new piece on the board.']))),new LQ([[ZQ,zQ,WQ],[QQ,$Q,$Q],[zQ,zQ,zQ]],0,[DQ.MEDIUM_BLACK,DQ.BIG_BLACK,DQ.MEDIUM_WHITE,DQ.MEDIUM_WHITE]),UQ.fromMove(new zG(0,1),new zG(0,2)),function(e,t){if(e.landingCoord.equals(new zG(0,2))){if(e.isDropping())return lz.failure($localize(Cr||(Cr=xp(["You won, but the exercise is to win while moving a piece!"]))));if(e.startingCoord.equalsValue(new zG(0,1)))return lz.SUCCESS}return lz.failure($localize(Er||(Er=xp(["Failed. Try again."]))))},$localize(Or||(Or=xp(["Congratulations!"]))))]};function KQ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"circle",5),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit,r=t.index;return Vp.fc().onPieceClick(0,e,r)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc();Vp.Bb(1),Vp.nc("id","piece_0_",r.toString(),""),Vp.mc("ngClass",o.getSidePieceClasses(r,i)),Vp.Cb("r",o.getPieceRadius(r))("cx",o.getPieceLeftX(0,i)+o.getPieceRadius(r))("cy",o.SPACE_SIZE/2)}}function JQ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"circle",8),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc().index;return Vp.fc().onBoardClick(e,t)}),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc().index,o=Vp.fc().index,a=Vp.fc();Vp.mc("ngClass",a.getPieceClasses(r)),Vp.Cb("r",a.getPieceRadius(r))("cx",a.SPACE_SIZE*i+a.STROKE_WIDTH+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*o+a.STROKE_WIDTH+a.SPACE_SIZE/2)}}function XQ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",6),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onBoardClick(e,r)}),Vp.Pb(),Vp.Ac(2,JQ,1,4,"circle",7),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc().index,a=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",i,"_",o,""),Vp.mc("ngClass",a.getRectClasses(i,o)),Vp.Cb("x",a.SPACE_SIZE*i+a.STROKE_WIDTH)("y",a.SPACE_SIZE*o+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngForOf",a.getListPieces(r))}}function eY(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,XQ,3,8,"g",2),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function tY(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",9),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onBoardClick(e.x,e.y)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.Bb(1),Vp.Cb("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function nY(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"circle",5),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit,r=t.index;return Vp.fc().onPieceClick(1,e,r)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc();Vp.Bb(1),Vp.nc("id","piece_1_",r.toString(),""),Vp.mc("ngClass",o.getSidePieceClasses(r,i)),Vp.Cb("r",o.getPieceRadius(r))("cx",o.getPieceLeftX(1,i)+o.getPieceRadius(r))("cy",o.SPACE_SIZE/2)}}var rY,iY,oY=((iY=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).INTER_PIECE_SPACE=20,r.lastLandingCoord=kz.empty(),r.lastStartingCoord=kz.empty(),r.chosenCoord=kz.empty(),r.chosenPiece=kz.empty(),r.remainingPieceLeftX=[],r.rules=new jQ(LQ),r.availableMinimaxes=[new VQ(r.rules,"EncapsuleMinimax")],r.encoder=UQ.encoder,r.tutorial=(new YQ).tutorial,r.updateBoard(),r}return Kp(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard();var e=this.rules.node.move;this.calculateLeftX(),e.isPresent()?(this.lastLandingCoord=kz.of(e.get().landingCoord),this.lastStartingCoord=e.get().startingCoord):(this.lastLandingCoord=kz.empty(),this.lastStartingCoord=kz.empty())}},{key:"getListPieces",value:function(e){return e.toList()}},{key:"getRemainingPieces",value:function(e){return this.rules.node.gameState.getRemainingPiecesOfPlayer(HG.of(e))}},{key:"onBoardClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(o=new zG(e,t),a=n.rules.node.gameState,!n.chosenCoord.isAbsent()){r.next=9;break}if(n.chosenCoord=kz.of(o),!n.chosenPiece.isPresent()){r.next=8;break}return s=UQ.fromDrop(n.chosenPiece.get(),o),r.abrupt("return",n.chooseMove(s,n.rules.node.gameState));case 8:return r.abrupt("return",!1===a.getPieceAt(o).belongsTo(a.getCurrentPlayer())?n.cancelMove(FQ.INVALID_PIECE_SELECTED()):lz.SUCCESS);case 9:if(!n.chosenCoord.equalsValue(o)){r.next=11;break}return r.abrupt("return",n.cancelMove(FQ.SAME_DEST_AS_ORIGIN()));case 11:return u=UQ.fromMove(n.chosenCoord.get(),o),r.abrupt("return",n.chooseMove(u,n.rules.node.gameState));case 13:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=kz.empty(),this.chosenPiece=kz.empty(),this.chosenPieceIndex=-1}},{key:"onPieceClick",value:function(e,t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){var o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o=r.canUserPlay("#piece_"+e+"_"+t.toString()),i.abrupt("return",o.isFailure()?r.cancelMove(o.getReason()):!1===r.rules.node.gameState.isDroppable(t)?r.cancelMove(FQ.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece=kz.of(t),r.chosenPieceIndex=n,lz.SUCCESS):r.cancelMove(FQ.END_YOUR_MOVE()));case 2:case"end":return i.stop()}},i)}))()}},{key:"getRectClasses",value:function(e,t){return this.isSelected(e,t)?"moved":""}},{key:"isSelected",value:function(e,t){var n=new zG(e,t);return!!this.lastStartingCoord.equalsValue(n)||!!this.lastLandingCoord.equalsValue(n)}},{key:"getPieceClasses",value:function(e){return[this.getPieceStrokeClass(e)]}},{key:"getPieceStrokeClass",value:function(e){return"player"+e.getPlayer().value+"-stroke"}},{key:"getPieceRadius",value:function(e){switch(e.getSize()){case MQ.BIG:return 40;case MQ.MEDIUM:return 30;default:return dz.expectToBe(e.getSize(),MQ.SMALL),20}}},{key:"getHighlightedCases",value:function(){var e=[];return this.chosenCoord.isPresent()&&e.push(this.chosenCoord.get()),e}},{key:"getSidePieceClasses",value:function(e,t){var n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex===t&&n.push("clickable "),n}},{key:"isSelectedPiece",value:function(e){return this.chosenPiece.equalsValue(e)}},{key:"calculateLeftX",value:function(){this.remainingPieceLeftX=[];for(var e=0;e<=1;e++){this.remainingPieceLeftX.push([]);for(var t=this.getRemainingPieces(e),n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{var r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}},{key:"getPieceLeftX",value:function(e,t){return this.remainingPieceLeftX[e][t]}}]),n}(dW)).\u0275fac=function(e){return new(e||iY)(Vp.Lb(qG))},iY.\u0275cmp=Vp.Fb({type:iY,selectors:[["app-encapsule"]],features:[Vp.yb],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingCasePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["remainingCasePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","highlighted",3,"click"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Qb(1,"g",null,1),Vp.Ac(3,KQ,2,5,"g",2),Vp.Pb(),Vp.Qb(4,"g",null,3),Vp.Ac(6,eY,2,1,"g",2),Vp.Ac(7,tY,2,4,"g",2),Vp.Pb(),Vp.Qb(8,"g",null,4),Vp.Ac(10,nY,2,5,"g",2),Vp.Pb(),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.Cb("transform","translate("+t.STROKE_WIDTH+", 0)"),Vp.Bb(2),Vp.mc("ngForOf",t.getRemainingPieces(0)),Vp.Bb(1),Vp.Cb("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),Vp.Bb(2),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngForOf",t.getHighlightedCases()),Vp.Bb(1),Vp.Cb("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),Vp.Bb(2),Vp.mc("ngForOf",t.getRemainingPieces(1)))},directives:[vg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),iY),aY=((rY=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a){var s;if(Qp(this,n),(s=t.call(this,e,r)).movedPieces=i,s.stepSize=o,s.direction=a,s.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+s.coord.toString()+".");if(i<1)throw new Error("Must select minimum one piece (got "+i+").");if(o<1)throw new Error("Step size must be minimum one (got "+o+").");if(o>i)throw new Error("Cannot move a phalanx further than its size (got step size "+o+" for "+i+" pieces).");return tv(s)}return Kp(n,[{key:"toString",value:function(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return this===e||!!this.coord.equals(e.coord)&&this.movedPieces===e.movedPieces&&this.stepSize===e.stepSize&&this.direction.equals(e.direction)}}]),n}(fq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 122303}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%8;e-=t;var n=(e/=8)%7;e-=n;var r=(e/=7)%13;e-=r;var i=(e/=13)%12;e-=i;var o=e/=12,a=jG.factory.fromInt(t);return new rY(o,i,r+1,n+1,a.get())}}]),n}(wz)),rY),sY=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"count",value:function(e,t){for(var n=0,r=0;r<14;r++)this.board[t][r]===e&&n++;return n}},{key:"doesOwnPiece",value:function(e){for(var t=0;t<12;t++)for(var n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}],[{key:"getInitialState",value:function(){var e=HG.NONE,t=HG.ONE,r=HG.ZERO;return new n([[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r]],0)}}]),n}(cq),uY=function(){var e=function e(){Qp(this,e)};return e.PHALANX_IS_LEAVING_BOARD=function(){return $localize(Sr||(Sr=xp(["The move distance of your phalanx puts it out of the board."])))},e.SOMETHING_IN_PHALANX_WAY=function(){return $localize(Pr||(Pr=xp(["There is something in the way of your phalanx."])))},e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=function(){return $localize(Ir||(Ir=xp(["Your phalanx must be bigger than the one you are capturing."])))},e.CASE_NOT_ALIGNED_WITH_SELECTED=function(){return $localize(Tr||(Tr=xp(["This square is not aligned with the selected piece."])))},e.SINGLE_PIECE_MUST_MOVE_BY_ONE=function(){return $localize(Ar||(Ar=xp(["A single piece can only move by one square."])))},e.SINGLE_PIECE_CANNOT_CAPTURE=function(){return $localize(Nr||(Nr=xp(["A single piece cannot make a capture."])))},e.CASE_NOT_ALIGNED_WITH_PHALANX=function(){return $localize(xr||(xr=xp(["This square is not aligned with the direction of the phalanx."])))},e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=function(){return $localize(Rr||(Rr=xp(["A phalanx can't contain pieces outside of the board."])))},e.PHALANX_CANNOT_CONTAIN_EMPTY_CASE=function(){return $localize(Mr||(Mr=xp(["A phalanx cannot contain an empty square."])))},e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=function(){return $localize(Dr||(Dr=xp(["A phalanx cannot contain a piece of the opponent."])))},e}(),cY=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){return new sY(n,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.count(HG.ZERO,0),r=t.count(HG.ONE,11);if(t.turn%2==0){if(n>r)return bq.ZERO_WON}else if(r>n)return bq.ONE_WON;return!1===t.doesOwnPiece(HG.ZERO)?bq.ONE_WON:!1===t.doesOwnPiece(HG.ONE)?bq.ZERO_WON:bq.ONGOING}}],[{key:"isLegal",value:function(e,t){var r=this.getPhalanxValidity(t,e);if(r.isFailure())return sz.failure(r.getReason());var i=this.getLandingStatus(t,e);if(i.isFailure())return i;var o=rq.copyBiArray(i.get()),a=t.getCurrentOpponent(),s=n.getCaptureValidity(t,o,e,a);return s.isFailure()?s:sz.success(s.get())}},{key:"getPhalanxValidity",value:function(e,t){for(var n,r=t.coord,i=0,o=e.getCurrentOpponent();i<t.movedPieces;){if(r.isNotInRange(14,12))return lz.failure(uY.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());if((n=e.getPieceAt(r))===HG.NONE)return lz.failure(uY.PHALANX_CANNOT_CONTAIN_EMPTY_CASE());if(n===o)return lz.failure(uY.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());r=r.getNext(t.direction,1),i++}return lz.SUCCESS}},{key:"getLandingStatus",value:function(e,t){for(var n=e.getCopiedBoard(),r=e.getCurrentPlayer(),i=t.coord,o=t.coord.getNext(t.direction,t.movedPieces),a=0;a+1<t.stepSize;){if(n[i.y][i.x]=HG.NONE,n[o.y][o.x]=r,o.isNotInRange(14,12))return sz.failure(uY.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(o)!==HG.NONE)return sz.failure(uY.SOMETHING_IN_PHALANX_WAY());a++,o=o.getNext(t.direction,1),i=i.getNext(t.direction,1)}return o.isNotInRange(14,12)?sz.failure(uY.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(o)===r?sz.failure(nq.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=HG.NONE,n[o.y][o.x]=r,sz.success(n))}},{key:"getCaptureValidity",value:function(e,t,n,r){for(var i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),o=HG.NONE,a=0;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(a>0&&(t[i.y][i.x]=o),++a>=n.movedPieces)return sz.failure(uY.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return sz.success(t)}}]),n}(_q),lY=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t=n.getListMoves(e);return rq.sortByDescending(t,function(e){return e.stepSize}),t}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new oq(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}},{key:"getPieceCountPlusRowDomination",value:function(e){for(var t=0,n=0;n<12;n++){for(var r=0,i=[0,0],o=0;o<14;o++){var a=new zG(o,n),s=e.getPieceAt(a);if(s!==HG.NONE){var u=s.getScoreModifier();t+=2002*u,i[s.value]=u,r+=u;for(var c=0,l=[jG.UP_LEFT,jG.UP,jG.UP_RIGHT];c<l.length;c++)for(var h=l[c],f=a.getNext(h,1);f.isInRange(14,12)&&e.getPieceAt(f)===s;)t+=1*u,f=f.getNext(h,1)}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce(function(e,t){return e+t})}return t}}],[{key:"getListMoves",value:function(e){for(var t,n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),i=HG.NONE,o=[],a=e.gameState,s=0;s<12;s++)for(var u=0;u<14;u++){var c=new zG(u,s);if(a.getPieceAt(c)===n){var l,h=zp(jG.DIRECTIONS);try{for(h.s();!(l=h.n()).done;){for(var f=l.value,d=1,p=c.getNext(f,1);p.isInRange(14,12)&&a.getPieceAt(p)===n;)d+=1,p=p.getNext(f,1);for(var v=1;p.isInRange(14,12)&&v<=d&&a.getPieceAt(p)===i;)t=new aY(u,s,d,v,f),o=this.addMove(o,t,a),v++,p=p.getNext(f,1);p.isInRange(14,12)&&v<=d&&a.getPieceAt(p)===r&&(t=new aY(u,s,d,v,f),o=this.addMove(o,t,a))}}catch(g){h.e(g)}finally{h.f()}}}return o}},{key:"addMove",value:function(e,t,n){return cY.isLegal(t,n).isSuccess()&&e.push(t),e}}]),n}(iq),hY=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t=lY.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}},{key:"orderMovesByPhalanxSizeAndFilter",value:function(e,t){var n=this;return rq.sortByDescending(e,function(e){return e.movedPieces}),e.length>40?e.filter(function(e){return!!n.moveIsCapture(e,t)||e.movedPieces*Math.random()>1}):e}},{key:"moveIsCapture",value:function(e,t){var n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new oq(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}},{key:"getPieceCountThenSupportThenAdvancement",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=new zG(r,n),o=e.getPieceAt(i);if(o!==HG.NONE){var a=void 0,s=void 0;o===HG.ZERO?(a=12-n,s=[jG.UP_LEFT,jG.UP,jG.UP_RIGHT]):(a=n+1,s=[jG.DOWN_LEFT,jG.DOWN,jG.DOWN_RIGHT]);var u=o.getScoreModifier();t+=a*u,t+=149629*u;var c,l=zp(s);try{for(l.s();!(c=l.n()).done;)for(var h=c.value,f=i.getNext(h,1);f.isInRange(14,12)&&e.getPieceAt(f)===o;)t+=337*u,f=f.getNext(h,1)}catch(d){l.e(d)}finally{l.f()}}}return t}}]),n}(iq),fY=function(e){Jp(n,e);var t=ev(n);function n(){var e;return Qp(this,n),(e=t.apply(this,arguments)).DOMINANCE_FACTOR=20,e.DEFENSE_FACTOR=5,e.TERRITORY_FACTOR=2,e.OFFENSE_FACTOR=10,e.CENTER_FACTOR=5,e.MOBILITY_FACTOR=.12,e}return Kp(n,[{key:"getDominance",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new zG(r,n));i!==HG.NONE&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}},{key:"getDefense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new zG(n,11))===HG.ZERO&&(t+=HG.ZERO.getScoreModifier()),e.getPieceAt(new zG(n,0))===HG.ONE&&(t+=HG.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}},{key:"getTerritory",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new zG(r,n));if(i!==HG.NONE){for(var o=-1;o<=1;o++)for(var a=-1;a<=1;a++){var s=new zG(r+o,n+a);if(s.isInRange(14,12)){var u=e.getPieceAt(s);(u===i||u===HG.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}},{key:"getOffense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new zG(n,0))===HG.ZERO&&(t+=HG.ZERO.getScoreModifier()),e.getPieceAt(new zG(n,11))===HG.ONE&&(t+=HG.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}},{key:"getCenter",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new zG(r,n));i!==HG.NONE&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}},{key:"getMobility",value:function(e){for(var t=0,n=0,r=0,i=0;i<12;i++)for(var o=0;o<14;o++){var a=new zG(o,i),s=e.getPieceAt(a);if(s!==HG.NONE){var u,c=zp(jG.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){for(var l=u.value,h=1,f=a.getNext(l,1);f.isInRange(14,12)&&e.getPieceAt(f)===s;)h+=1,f=f.getNext(l,1);for(var d=1;f.isInRange(14,12)&&d<=h&&e.getPieceAt(f)===HG.NONE;)d++,f=f.getNext(l,1);t+=d*d*s.getScoreModifier(),s===HG.ZERO?n=Math.max(n,d):s===HG.ONE&&(r=Math.max(r,d))}}catch(p){c.e(p)}finally{c.f()}}}return(t+n*HG.ZERO.getScoreModifier()+r*HG.ONE.getScoreModifier())*this.MOBILITY_FACTOR}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new oq(n.toBoardValue());var r=this.getDominance(t),i=this.getDefense(t),o=this.getTerritory(t),a=this.getCenter(t),s=this.getOffense(t),u=this.getMobility(t);return new oq(r+i+o+a+s+u)}}]),n}(lY),dY=HG.NONE,pY=HG.ZERO,vY=HG.ONE,gY=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(Lr||(Lr=xp(["Initial board"]))),$localize(Br||(Br=xp(["This is the initial board of Epaminondas.\n        The top line is the starting line of Light.\n        The bottom line is the starting line of Dark."]))),sY.getInitialState()),Eq.informational($localize(Fr||(Fr=xp(["Goal of the game (1/2)"]))),$localize(jr||(jr=xp(["After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line\n        than the number of pieces the opponent has on the player's starting line, the player wins.\n        Here, it's Dark's turn to play: Dark has therefore won."]))),new sY([[dY,dY,dY,dY,dY,pY,dY,dY,vY,vY,vY,vY,vY,vY],[dY,dY,dY,dY,dY,pY,dY,dY,dY,dY,dY,dY,vY,vY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,vY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,pY,pY,pY,pY,dY,dY,dY]],0)),Eq.informational($localize(Ur||(Ur=xp(["Goal of the game (2/2)"]))),$localize(Vr||(Vr=xp(["Here, it is Light's turn.\n        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line."]))),new sY([[dY,dY,dY,dY,dY,pY,dY,dY,dY,dY,vY,vY,vY,vY],[dY,dY,dY,dY,dY,pY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,vY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,vY,vY,dY,dY,dY,pY,pY,dY,pY,pY,pY,pY]],1)),Eq.fromPredicate($localize(zr||(zr=xp(["Moving a piece"]))),$localize(Hr||(Hr=xp(["Here is the starting board. Dark plays first.\n        Let's start with moving a single piece:\n        <ol>\n            <li>Click on a piece.</li>\n            <li>Click on a empty neighboring square.</li>\n        </ol>"]))),sY.getInitialState(),new aY(0,10,1,1,jG.UP),function(e,t){return 1===e.movedPieces?lz.SUCCESS:lz.failure($localize(Gr||(Gr=xp(["Congratulations, you are in advance. But this is not the exercise here, try again."]))))},$localize(qr||(qr=xp(["This is how you move a single piece."])))),Eq.fromPredicate($localize(Wr||(Wr=xp(["Moving a phalanx"]))),$localize($r||($r=xp(["Let us now see how to move multiple pieces along a line, which is called a phalanx:\n        <ol>\n            <li>Click on the first piece of the phalanx.</li>\n            <li>Click on the last piece of the phalanx.</li>\n            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>\n        </ol><br/>\n        Move a phalanx!"]))),sY.getInitialState(),new aY(0,11,2,1,jG.UP),function(e,t){return e.movedPieces>1?lz.SUCCESS:lz.failure($localize(Zr||(Zr=xp(["Failed! You moved only one piece."]))))},$localize(Qr||(Qr=xp(["Congratulations!\n        The moved pieces can be horizontally, vertically, or diagonally aligned.\n        The move should be made along this axis, forward or backwards.\n        There can be no opponent nor holes in the phalanx."])))),Eq.fromMove($localize(Yr||(Yr=xp(["Capture"]))),$localize(Kr||(Kr=xp(["In order to capture pieces of the opponent:\n        <ol>\n            <li>It must be aligned with the phalanx you are moving.</li>\n            <li>It must be strictly shorter than your phalanx.</li>\n            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>\n        </ol><br/>\n        Capture a phalanx."]))),new sY([[dY,dY,dY,dY,dY,dY,dY,dY,vY,vY,vY,vY,vY,vY],[dY,dY,dY,dY,dY,dY,vY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,vY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,vY,dY,vY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,vY,vY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,vY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,pY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,pY,dY,dY,dY,dY,vY,dY,dY,dY,dY,dY,dY],[dY,dY,pY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,pY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY,dY],[dY,dY,dY,dY,dY,dY,dY,pY,pY,pY,pY,pY,pY,pY]],0),[new aY(2,10,4,2,jG.UP)],$localize(Jr||(Jr=xp(["Congratulations, you made it!\n        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment."]))),$localize(Xr||(Xr=xp(["Failed, you have not captured the phalanx."]))))]};function yY(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"circle",4),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb()}if(2&e){var r=Vp.fc().index,i=Vp.fc().index,o=Vp.fc();Vp.mc("ngClass",o.getPieceClasses(r,i)),Vp.Cb("r",.5*(o.SPACE_SIZE-2*o.STROKE_WIDTH))("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function mY(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",2),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onClick(e,r)}),Vp.Pb(),Vp.Ac(2,yY,1,4,"circle",3),Vp.Pb()}if(2&e){var r=t.index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",r,"_",i,""),Vp.mc("ngClass",o.getRectClasses(r,i)),Vp.Cb("x",o.SPACE_SIZE*r+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",o.board[i][r]!==o.NONE)}}function bY(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,mY,3,8,"g",1),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function _Y(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",5),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onClick(e.x,e.y)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.Bb(1),Vp.Cb("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var wY,kY,CY,EY,OY=((EY=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).NONE=HG.NONE,r.firstPiece=kz.empty(),r.validExtensions=[],r.phalanxValidLandings=[],r.lastPiece=kz.empty(),r.phalanxDirection=kz.empty(),r.phalanxMiddles=[],r.moveds=[],r.captureds=[],r.rules=new cY(sY),r.availableMinimaxes=[new lY(r.rules,"Normal"),new hY(r.rules,"Positional"),new fY(r.rules,"Attack")],r.encoder=aY.encoder,r.tutorial=(new gY).tutorial,r.updateBoard(),r}return Kp(n,[{key:"updateBoard",value:function(){this.firstPiece=kz.empty(),this.lastPiece=kz.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.rules.node.gameState.getCopiedBoard()}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=e.coord;this.moveds=[t];for(var n=1;n<e.stepSize+e.movedPieces;n++)t=t.getNext(e.direction,1),this.moveds.push(t);for(var r=this.rules.node.mother.get(),i=r.gameState.getCurrentOpponent();t.isInRange(14,12)&&r.gameState.getPieceAt(t)===i;)this.captureds.push(t),t=t.getNext(e.direction,1)}},{key:"onClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=n.rules.node.gameState.getCurrentOpponent(),o=n.rules.node.gameState.getCurrentPlayer(),r.t0=n.board[t][e],r.next=r.t0===o?4:r.t0===i?5:6;break;case 4:return r.abrupt("return",(n.firstPiece=kz.of(new zG(e,t)),n.validExtensions=n.getValidExtensions(o),n.phalanxValidLandings=n.getPhalanxValidLandings(),lz.SUCCESS));case 5:return r.abrupt("return",n.cancelMove(nq.CANNOT_CHOOSE_OPPONENT_PIECE()));case 6:return r.abrupt("return",(dz.expectToBe(n.board[t][e],HG.NONE),n.cancelMove(nq.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())));case 7:case"end":return r.stop()}},r)}))()}},{key:"hidePreviousMove",value:function(){this.captureds=[],this.moveds=[]}},{key:"getValidExtensions",value:function(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}},{key:"getFirstPieceExtensions",value:function(e){var t,n=[],r=zp(jG.DIRECTIONS);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,o=this.firstPiece.get().getNext(i,1);o.isInRange(14,12)&&this.board[o.y][o.x]===e;)n.push(o),o=o.getNext(i,1)}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getPhalanxValidExtensions",value:function(e){var t=jG.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get(),n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();var i=this.firstPiece.get().getNext(t,1),o=this.getExtensionsToward(i,t,e);return r.concat(o)}},{key:"getExtensionsToward",value:function(e,t,n){for(var r=[];e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}},{key:"getPhalanxValidLandings",value:function(){if(this.lastPiece.isPresent()){var e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1,o=jG.factory.fromMove(e,t).get(),a=t.getNext(o,1),s=this.getLandingsToward(a,o,i);o=o.getOpposite();var u=e.getNext(o,1);return this.getLandingsToward(u,o,i).concat(s)}return this.getNeighbooringEmptyCases()}},{key:"getNeighbooringEmptyCases",value:function(){var e,t=[],n=zp(jG.DIRECTIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.firstPiece.get().getNext(r,1);i.isInRange(14,12)&&this.board[i.y][i.x]===HG.NONE&&t.push(i)}}catch(o){n.e(o)}finally{n.f()}return t}},{key:"getLandingsToward",value:function(e,t,n){for(var r=this.rules.node.gameState.getCurrentPlayer(),i=this.rules.node.gameState.getCurrentOpponent(),o=[];e.isInRange(14,12)&&o.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&o.push(e),o;o.push(e),e=e.getNext(t,1)}return o}},{key:"getPhalanxLength",value:function(e,t,n){for(var r=0;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}},{key:"cancelMoveAttempt",value:function(){this.firstPiece=kz.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=kz.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}},{key:"secondClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s,u,c,l,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new zG(e,t),o=n.firstPiece.get(),!i.equals(o)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),lz.SUCCESS));case 3:if(a=n.rules.node.gameState.getCurrentOpponent(),s=n.rules.node.gameState.getCurrentPlayer(),i.isAlignedWith(o)){r.next=6;break}return r.abrupt("return",n.cancelMove(uY.CASE_NOT_ALIGNED_WITH_SELECTED()));case 6:u=i.getDistance(o),c=o.getDirectionToward(i).get(),r.t0=n.board[t][e],r.next=r.t0===HG.NONE?10:r.t0===a?11:12;break;case 10:return r.abrupt("return",1===u?n.tryMove(new aY(o.x,o.y,1,1,c)):n.cancelMove(uY.SINGLE_PIECE_MUST_MOVE_BY_ONE()));case 11:return r.abrupt("return",n.cancelMove(uY.SINGLE_PIECE_CANNOT_CAPTURE()));case 12:return dz.expectToBe(n.board[t][e],s),l=new aY(o.x,o.y,u,1,c),h=cY.getPhalanxValidity(n.rules.node.gameState,l),r.abrupt("return",h.isFailure()?n.cancelMove(h.getReason()):(n.lastPiece=kz.of(i),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=o.getCoordsToward(i),n.phalanxDirection=kz.of(c),lz.SUCCESS));case 15:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s,u,c,l,h,f,d,p,v;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.rules.node.gameState.getCurrentPlayer(),o=new zG(e,t),!n.firstPiece.equalsValue(o)){r.next=3;break}return r.abrupt("return",n.moveFirstPiece(i));case 3:if(!n.lastPiece.equalsValue(o)){r.next=5;break}return r.abrupt("return",n.moveLastPiece(i));case 5:if(a=n.firstPiece.get(),s=n.lastPiece.get(),o.isAlignedWith(a)){r.next=8;break}return r.abrupt("return",n.cancelMove(uY.CASE_NOT_ALIGNED_WITH_PHALANX()));case 8:if(u=jG.factory.fromMove(a,s).get(),c=jG.factory.fromMove(a,o).get(),u===c.getOpposite()&&(n.firstPiece=kz.of(s),n.lastPiece=kz.of(a),u=c),u===c){r.next=12;break}return r.abrupt("return",n.cancelMove(uY.CASE_NOT_ALIGNED_WITH_PHALANX()));case 12:if(n.board[t][e]!==i){r.next=16;break}return n.lastPiece=kz.of(o),l=n.firstPiece.get().getDistance(o)+1,h=new aY(n.firstPiece.get().x,n.firstPiece.get().y,l,1,u),f=cY.getPhalanxValidity(n.rules.node.gameState,h),r.abrupt("return",f.isFailure()?n.cancelMove(f.getReason()):(n.phalanxMiddles=n.firstPiece.get().getCoordsToward(n.lastPiece.get()),n.validExtensions=n.getValidExtensions(i),n.phalanxValidLandings=n.getPhalanxValidLandings(),lz.SUCCESS));case 16:return d=n.firstPiece.get().getDistance(n.lastPiece.get())+1,p=n.lastPiece.get().getDistance(o),v=new aY(n.firstPiece.get().x,n.firstPiece.get().y,d,p,u),r.abrupt("return",n.tryMove(v));case 18:case"end":return r.stop()}},r)}))()}},{key:"moveFirstPiece",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.firstPiece=kz.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),!t.firstPiece.equals(t.lastPiece)){n.next=6;break}return n.next=4,t.moveOnlyPiece(e);case 4:n.next=7;break;case 6:t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e);case 7:return t.phalanxValidLandings=t.getPhalanxValidLandings(),n.abrupt("return",lz.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveLastPiece",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=kz.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),lz.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"moveOnlyPiece",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=kz.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=kz.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),lz.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e){var t=this.rules.node.gameState;return this.cancelMove(),this.chooseMove(e,t)}},{key:"getPieceClasses",value:function(e,t){var n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}},{key:"getPieceStrokeClasses",value:function(e,t){var n=new zG(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(function(e){return e.equals(n)})?["highlighted"]:[]}},{key:"getRectClasses",value:function(e,t){var n=new zG(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:this.moveds.some(function(e){return e.equals(n)})?["moved"]:[]}},{key:"getHighlightedCoords",value:function(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}},{key:"getCurrentPlayerPieces",value:function(){for(var e=[],t=this.rules.node.gameState.getCurrentPlayer(),n=0;n<this.board.length;n++)for(var r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new zG(r,n));return e}}]),n}(dW)).\u0275fac=function(e){return new(e||EY)(Vp.Lb(qG))},EY.\u0275cmp=Vp.Fb({type:EY,selectors:[["app-epaminondas"]],features:[Vp.yb],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable",3,"click"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,bY,2,1,"g",1),Vp.Ac(2,_Y,2,4,"g",1),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngForOf",t.getHighlightedCoords()))},directives:[vg,dg,yg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),EY),SY=((CY=function(){function e(t){if(Qp(this,e),t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===XZ.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=rq.copyImmutableArray(t).sort(function(e,t){if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate cases");return e.y>t.y?1:-1}return e.x>t.x?1:-1});var n,r=kz.empty(),i=zp(this.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(r.isPresent()&&1!==r.get().getDistance(o))throw new Error("Cannot create a GipfCapture with non-consecutive cases");r=kz.of(o)}}catch(a){i.e(a)}finally{i.f()}}return Kp(e,[{key:"toString",value:function(){var e,t="",n=zp(this.capturedSpaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;""!==t&&(t+=","),t+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"size",value:function(){return this.capturedSpaces.length}},{key:"forEach",value:function(e){this.capturedSpaces.forEach(e)}},{key:"contains",value:function(e){for(var t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}},{key:"intersectsWith",value:function(e){return this.capturedSpaces.some(function(t){return e.contains(t)})}},{key:"getLine",value:function(){return XZ.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}},{key:"equals",value:function(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(var t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}]),e}()).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"encode",value:function(e){return e.capturedSpaces.map(function(e){return zG.encoder.encode(e)})}},{key:"decode",value:function(e){return new CY(e.map(function(e){return zG.encoder.decode(e)}))}}]),n}(bz)),CY),PY=((kY=function(){function e(t,n){Qp(this,e),this.coord=t,this.direction=n}return Kp(e,[{key:"toString",value:function(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}},{key:"equals",value:function(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}]),e}()).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){var e;return Qp(this,n),(e=t.apply(this,arguments)).optionalDirectionEncoder=kz.encoder(KG.encoder),e}return Kp(n,[{key:"encode",value:function(e){return{coord:zG.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}},{key:"decode",value:function(e){var t=e;return vz(null!=t.coord,"Invalid encoded GipfPlacement"),new kY(zG.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}}]),n}(bz)),kY),IY=((wY=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this)).placement=e,o.initialCaptures=r,o.finalCaptures=i,o}return Kp(n,[{key:"toString",value:function(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=zp(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"equals",value:function(e){return this===e||!1!==this.placement.equals(e.placement)&&!1!==rq.compareArray(this.initialCaptures,e.initialCaptures)&&!1!==rq.compareArray(this.finalCaptures,e.finalCaptures)}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}]),n}(hq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"encodeMove",value:function(e){var t={placement:PY.encoder.encode(e.placement)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=SY.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=SY.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return vz(null!=t.placement,"Invalid encoded GipfMove"),new wY(PY.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",SY.encoder.decode),this.decodeArray(t,"finalCapture",SY.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(_z)),wY),TY=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this,r,e,7,7,[3,2,1],QG.EMPTY)).sidePieces=i,a.capturedPieces=o,a}return Kp(n,[{key:"equals",value:function(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&rq.compareTable(this.board,e.board)}},{key:"getNumberOfPiecesToPlace",value:function(e){return this.sidePieces[e.value]}},{key:"getNumberOfPiecesCaptured",value:function(e){return this.capturedPieces[e.value]}},{key:"setAtUnsafe",value:function(e,t){var r=rq.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.sidePieces,this.capturedPieces)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==QG.NONE}}],[{key:"getInitialState",value:function(){var e=QG.EMPTY,t=QG.NONE,r=QG.ZERO,i=QG.ONE;return new n([[t,t,t,i,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,r,t,t,t]],0,[12,12],[0,0])}}]),n}(eQ),AY=function(){var e=function e(){Qp(this,e)};return e.CAPTURE_MUST_BE_ALIGNED=function(){return $localize(ei||(ei=xp(["You can only capture when 4 or more of your pieces are aligned, and it is not the case."])))},e.INVALID_CAPTURED_PIECES=function(){return $localize(ti||(ti=xp(["You must select a valid capture that contains 4 pieces or more."])))},e.MISSING_CAPTURES=function(){return $localize(ni||(ni=xp(["There are still possible captures to be done."])))},e.PLACEMENT_NOT_ON_BORDER=function(){return $localize(ri||(ri=xp(["Pieces must be inserted in spaces on the edge of the board."])))},e.INVALID_PLACEMENT_DIRECTION=function(){return $localize(ii||(ii=xp(["You must select a valid placement direction."])))},e.PLACEMENT_WITHOUT_DIRECTION=function(){return $localize(oi||(oi=xp(["You must select a placement with a direction alongside the insertion space."])))},e.PLACEMENT_ON_COMPLETE_LINE=function(){return $localize(ai||(ai=xp(["You cannot place a piece on a complete line."])))},e.AMBIGUOUS_CAPTURE_COORD=function(){return $localize(si||(si=xp(["This piece belongs to two captures. Please select another piece in the capture you'd like to make."])))},e.CLICK_FURTHER_THAN_ONE_COORD=function(){return $localize(ui||(ui=xp(["You must click on an arrow to select your destination."])))},e.NO_DIRECTIONS_AVAILABLE=function(){return $localize(ci||(ci=xp(["You cannot insert a piece here, as all lines are full. Select another space."])))},e}(),NY=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){return new TY(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}},{key:"getPiecesMoved",value:function(e,t,r){var i=n.applyCaptures(e,t);if(r.direction.isAbsent())return[r.coord];var o=r.direction.get(),a=[];a.push(r.coord);for(var s=r.coord.getNext(o);i.isOnBoard(s)&&i.getPieceAt(s)!==QG.EMPTY;)a.push(s),s=s.getNext(o);return vz(i.isOnBoard(s)&&i.getPieceAt(s)===QG.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),a.push(s),a}},{key:"isLegal",value:function(e,t){var r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toFailedFallible();var i=n.applyCaptures(t,e.initialCaptures),o=this.noMoreCapturesValidity(i);if(o.isFailure())return o.toFailedFallible();var a=this.placementValidity(i,e.placement);if(a.isFailure())return a.toFailedFallible();var s=n.applyPlacement(i,e.placement),u=this.capturesValidity(s,e.finalCaptures);if(u.isFailure())return u.toFailedFallible();var c=n.applyCaptures(s,e.finalCaptures),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():sz.success(c)}},{key:"capturesValidity",value:function(e,t){var r,i=e,o=zp(t);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=this.captureValidity(i,a);if(s.isFailure())return s;i=n.applyCapture(i,a)}}catch(u){o.e(u)}finally{o.f()}return lz.SUCCESS}},{key:"captureValidity",value:function(e,t){var r=e.getCurrentPlayer(),i=n.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(i.isAbsent())return lz.failure(AY.CAPTURE_MUST_BE_ALIGNED());var o=i.get();return n.getCapturable(e,o).equals(t)?lz.SUCCESS:lz.failure(AY.INVALID_CAPTURED_PIECES())}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===n.getLinePortionsWithFourPiecesOfPlayer(e,t).length?lz.SUCCESS:lz.failure(AY.MISSING_CAPTURES())}},{key:"placementValidity",value:function(e,t){var r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==QG.EMPTY){if(t.direction.isAbsent())return lz.failure(AY.PLACEMENT_WITHOUT_DIRECTION());if(n.isLineComplete(e,t.coord,t.direction.get()))return lz.failure(AY.PLACEMENT_ON_COMPLETE_LINE());var i,o=zp(n.getAllDirectionsForEntrance(e,t.coord));try{for(o.s();!(i=o.n()).done;){if(i.value===t.direction.get())return lz.SUCCESS}}catch(a){o.e(a)}finally{o.f()}return lz.failure(AY.INVALID_PLACEMENT_DIRECTION())}return lz.SUCCESS}},{key:"placementCoordValidity",value:function(e,t){return tq.INSTANCE.isOnBorder(e,t)?lz.SUCCESS:lz.failure(AY.PLACEMENT_NOT_ON_BORDER())}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getPlayerScore(t,HG.ZERO),i=n.getPlayerScore(t,HG.ONE);return r.isAbsent()?bq.ONE_WON:i.isAbsent()?bq.ZERO_WON:bq.ONGOING}}],[{key:"applyCaptures",value:function(e,t){var r=e;return t.forEach(function(e){r=n.applyCapture(r,e)}),r}},{key:"applyCapture",value:function(e,t){var n=e.getCurrentPlayer(),r=e,i=[e.sidePieces[0],e.sidePieces[1]],o=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(function(t){var a=e.getPieceAt(t);r=r.setAt(t,QG.EMPTY),a.is(n)?i[n.value]+=1:o[n.value]+=1}),new TY(r.board,e.turn,i,o)}},{key:"getPlacements",value:function(e){var t=[];return tq.INSTANCE.getAllBorders(e).forEach(function(r){e.getPieceAt(r)===QG.EMPTY?t.push(new PY(r,kz.empty())):n.getAllDirectionsForEntrance(e,r).forEach(function(i){!1===n.isLineComplete(e,r,i)&&t.push(new PY(r,kz.of(i)))})}),t}},{key:"isLineComplete",value:function(e,t,r){return n.nextGapInLine(e,t,r).isAbsent()}},{key:"nextGapInLine",value:function(e,t,n){for(var r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===QG.EMPTY)return kz.of(r);return kz.empty()}},{key:"applyPlacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e,i=QG.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){var o=t.coord;if(e.getPieceAt(o)!==QG.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(o,i)}else for(var a=t.coord;r.isOnBoard(a)&&i!==QG.EMPTY;a=a.getNext(t.direction.get())){var s=e.getPieceAt(a);r=r.setAt(a,i),i=s}var u=[e.sidePieces[0],e.sidePieces[1]];return u[n.value]-=1,new TY(r.board,e.turn,u,e.capturedPieces)}},{key:"getAllDirectionsForEntrance",value:function(e,t){if(tq.INSTANCE.isTopLeftCorner(e,t))return[KG.RIGHT,KG.DOWN,KG.UP_RIGHT];if(tq.INSTANCE.isTopCorner(e,t))return[KG.DOWN,KG.DOWN_LEFT,KG.RIGHT];if(tq.INSTANCE.isTopRightCorner(e,t))return[KG.DOWN_LEFT,KG.DOWN,KG.LEFT];if(tq.INSTANCE.isBottomLeftCorner(e,t))return[KG.UP_RIGHT,KG.UP,KG.RIGHT];if(tq.INSTANCE.isBottomCorner(e,t))return[KG.UP,KG.LEFT,KG.UP_RIGHT];if(tq.INSTANCE.isBottomRightCorner(e,t))return[KG.LEFT,KG.UP,KG.DOWN_LEFT];if(tq.INSTANCE.isOnTopLeftBorder(e,t))return[KG.RIGHT,KG.DOWN];if(tq.INSTANCE.isOnLeftBorder(e,t))return[KG.UP_RIGHT,KG.RIGHT];if(tq.INSTANCE.isOnBottomLeftBorder(e,t))return[KG.UP,KG.UP_RIGHT];if(tq.INSTANCE.isOnBottomRightBorder(e,t))return[KG.LEFT,KG.UP];if(tq.INSTANCE.isOnRightBorder(e,t))return[KG.LEFT,KG.DOWN_LEFT];if(tq.INSTANCE.isOnTopRightBorder(e,t))return[KG.DOWN_LEFT,KG.DOWN];throw new Error("not a border")}},{key:"getLinePortionsWithFourPiecesOfPlayer",value:function(e,t){var r=[];return e.allLines().forEach(function(i){var o=n.getLinePortionWithFourPiecesOfPlayer(e,t,i);o.isPresent()&&r.push(o.get())}),r}},{key:"getLinePortionWithFourPiecesOfPlayer",value:function(e,t,n){for(var r=0,i=e.getEntranceOnLine(n),o=n.getDirection(),a=i,s=i;e.isOnBoard(s);s=s.getNext(o))if(e.getPieceAt(s).is(t)?(0===r&&(a=s),r+=1):r=0,4===r)return kz.of({0:a,1:s,2:o});return kz.empty()}},{key:"getCapturable",value:function(e,t){for(var n=[],r=t[0],i=t[1],o=t[2],a=o.getOpposite(),s=r.getNext(a);e.isOnBoard(s)&&e.getPieceAt(s)!==QG.EMPTY;)n.push(s),s=s.getNext(a);for(var u=r;!u.equals(i);u=u.getNext(o))n.push(u);for(var c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==QG.EMPTY;c=c.getNext(o))n.push(c);return new SY(n)}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),r=[];return n.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(function(t){r.push(n.getCapturable(e,t))}),r}},{key:"getPlayerScore",value:function(e,t){var r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===n.getPossibleCaptures(e).length)return kz.empty();var i=e.getNumberOfPiecesCaptured(t);return kz.of(r+3*i)}},{key:"isGameOver",value:function(e){var t=n.getPlayerScore(e,HG.ZERO),r=n.getPlayerScore(e,HG.ONE);return t.isAbsent()||r.isAbsent()}}]),n}(_q),xY=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getBoardValue",value:function(e){var t=e.gameState,n=NY.getPlayerScore(t,HG.ZERO),r=NY.getPlayerScore(t,HG.ONE);return n.isAbsent()?new oq(HG.ONE.getVictoryValue()):r.isAbsent()?new oq(HG.ZERO.getVictoryValue()):new oq(n.get()-r.get())}},{key:"getListMoves",value:function(e){return this.getListMoveFromState(e.gameState)}},{key:"getListMoveFromState",value:function(e){var t=this,n=[];return NY.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(function(r){var i=NY.applyCaptures(e,r);NY.getPlacements(i).forEach(function(e){var o=NY.applyPlacement(i,e);t.getPossibleCaptureCombinations(o).forEach(function(t){var i=new IY(e,r,t);n.push(i)})})}),n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=NY.getPossibleCaptures(e);return n.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}],[{key:"getPossibleCaptureCombinationsFromPossibleCaptures",value:function(e){var t=n.computeIntersections(e),r=[[]];return e.forEach(function(e,n){if(0===t[n].length)r.forEach(function(e){e.push(n)});else{var i,o=[],a=t[n].some(function(e){return e>n}),s=zp(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;!0===u.some(function(e){return t[n].some(function(t){return e===t})})?o.push(rq.copyImmutableArray(u)):a?(o.push(rq.copyImmutableArray(u)),u.push(n),o.push(rq.copyImmutableArray(u))):(u.push(n),o.push(rq.copyImmutableArray(u)))}}catch(c){s.e(c)}finally{s.f()}r=o}}),r.map(function(t){return t.map(function(t){return e[t]})})}},{key:"computeIntersections",value:function(e){var t=[];return e.forEach(function(n,r){t.push([]),e.forEach(function(e,i){r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}}]),n}(iq),RY=function e(t,n,r,i,o,a){Qp(this,e),this.source=t,this.destination=n,this.x1=r,this.y1=i,this.x2=o,this.y2=a},MY=QG.NONE,DY=QG.EMPTY,LY=QG.ZERO,BY=QG.ONE,FY=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(li||(li=xp(["Goal of the game"]))),$localize(hi||(hi=xp(["The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.\n        This is the initial board.\n        Each player has 12 pieces on the side and 3 pieces on the board.\n        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.\n        The first player plays with the dark pieces, the second player plays with the light pieces."]))),TY.getInitialState()),Eq.anyMove($localize(fi||(fi=xp(["Pushing"]))),$localize(di||(di=xp(["Pieces can only enter the board through the edges. To insert a new piece:\n        <ol>\n            <li>Click on a space on the edge of the board.</li>\n            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>\n        </ol>\n        You cannot push when a line is full.<br/><br/>\n        You're playing Dark, insert a piece."]))),TY.getInitialState(),new IY(new PY(new zG(3,0),kz.of(KG.DOWN)),[],[]),$localize(pi||(pi=xp(["Congratulations!"])))),Eq.fromMove($localize(vi||(vi=xp(["Capture (1/3)"]))),$localize(gi||(gi=xp(["To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.\n        There are multiple important aspects of a capture:\n        <ol>\n            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>\n            <li>As soon as there is an empty space on the line, the capture stops.</li>\n            <li>Your own pieces that are captured go back to your stock.\n                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>\n            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.\n                This means that a turn happens in three phases:\n                <ol type=\"A\">\n                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>\n                    <li>Make your insertion.</li>\n                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>\n                </ol>\n            </li>\n        </ol><br/>\n        You're playing Dark, you can make a capture, do it."]))),new TY([[MY,MY,MY,LY,BY,DY,DY],[MY,MY,DY,DY,DY,DY,DY],[MY,DY,DY,DY,DY,DY,DY],[LY,LY,LY,DY,DY,DY,DY],[BY,DY,DY,DY,DY,DY,MY],[DY,DY,DY,BY,DY,MY,MY],[DY,DY,DY,BY,MY,MY,MY]],42,[8,8],[0,0]),[new IY(new PY(new zG(0,3),kz.of(KG.RIGHT)),[],[new SY([new zG(0,3),new zG(1,3),new zG(2,3),new zG(3,3)])])],$localize(yi||(yi=xp(["Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.\n        Let's now see how captures can really be useful."]))),$localize(mi||(mi=xp(["Failed!"])))),Eq.fromMove($localize(bi||(bi=xp(["Capture (2/3)"]))),$localize(_i||(_i=xp(["Here, there are three different ways of capturing.\n        <ol>\n          <li>One way does not capture any of your opponent's pieces.</li>\n          <li>Another way captures one of your opponent's pieces.</li>\n          <li>The last way captures two of your opponent's pieces.</li>\n        </ol>\n        <br/><br/>\n        Pick the last one."]))),new TY([[MY,MY,MY,DY,DY,DY,DY],[MY,MY,DY,BY,DY,DY,DY],[MY,DY,DY,LY,DY,DY,DY],[LY,LY,LY,BY,DY,DY,DY],[DY,DY,DY,LY,DY,DY,MY],[DY,DY,DY,LY,DY,MY,MY],[DY,DY,DY,BY,MY,MY,MY]],42,[8,4],[2,3]),[new IY(new PY(new zG(0,3),kz.of(KG.RIGHT)),[],[new SY([new zG(3,1),new zG(3,2),new zG(3,3),new zG(3,4),new zG(3,5),new zG(3,6)])])],$localize(wi||(wi=xp(["Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.\n        The most you can get is 3 per capture."]))),$localize(ki||(ki=xp(["Failed, the best capture was taking 2 of your opponent's pieces"])))),Eq.fromMove($localize(Ci||(Ci=xp(["Capture (3/3)"]))),$localize(Ei||(Ei=xp(["Here, you must capture at the beginning of your turn.\n        This is due to a move of your opponent at the previous turn\n        (even though this is a fictitious board for pedagogical purpose).\n        After your capture, by performing the right move you can even capture two more of your opponent's pieces!\n        Keep it mind that the most useful in a capture is to take your opponent's pieces."]))),new TY([[MY,MY,MY,LY,DY,DY,LY],[MY,MY,DY,LY,DY,DY,LY],[MY,LY,LY,DY,LY,BY,LY],[DY,DY,DY,LY,DY,DY,LY],[DY,DY,DY,LY,DY,DY,MY],[LY,LY,LY,BY,BY,MY,MY],[DY,DY,DY,LY,MY,MY,MY]],42,[8,4],[2,3]),[new IY(new PY(new zG(3,6),kz.of(KG.UP)),[new SY([new zG(6,0),new zG(6,1),new zG(6,2),new zG(6,3)])],[new SY([new zG(0,5),new zG(1,5),new zG(2,5),new zG(3,5),new zG(4,5)]),new SY([new zG(1,2),new zG(2,2),new zG(3,2),new zG(4,2),new zG(5,2)])]),new IY(new PY(new zG(4,6),kz.of(KG.UP)),[new SY([new zG(6,0),new zG(6,1),new zG(6,2),new zG(6,3)])],[new SY([new zG(0,5),new zG(1,5),new zG(2,5),new zG(3,5),new zG(4,5)]),new SY([new zG(3,0),new zG(3,1),new zG(3,2),new zG(3,3),new zG(3,4)])]),new IY(new PY(new zG(3,6),kz.of(KG.UP)),[new SY([new zG(6,0),new zG(6,1),new zG(6,2),new zG(6,3)])],[new SY([new zG(1,2),new zG(2,2),new zG(3,2),new zG(4,2),new zG(5,2)]),new SY([new zG(0,5),new zG(1,5),new zG(2,5),new zG(3,5),new zG(4,5)])])],$localize(Oi||(Oi=xp(["Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces."]))),$localize(Si||(Si=xp(["Failed, the best capture takes 2 of your opponent's pieces."]))))]};function jY(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",11)),2&e){var n=Vp.fc().$implicit,r=Vp.fc();Vp.mc("ngClass",r.getPieceClass(n)),Vp.Cb("cx",r.getCenterAt(n).x)("cy",r.getCenterAt(n).y)("r",r.SPACE_SIZE)}}function UY(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"g",8),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onClick(e)}),Vp.Mb(2,"polyline",9),Vp.Ac(3,jY,1,4,"circle",10),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",r.x,"_",r.y,""),Vp.Bb(1),Vp.oc("id","case_",r.x,"_",r.y,""),Vp.mc("ngClass",i.getSpaceClass(r)),Vp.Cb("points",i.getHexaCoordsAt(r)),Vp.Bb(1),Vp.mc("ngIf",i.isPiece(r))}}function VY(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",14),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(2).onClick(e)}),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc(2);Vp.Cb("points",i.getHexaCoordsAt(r))}}function zY(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g",12),Vp.Ac(1,VY,1,1,"polyline",13),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n.capturedSpaces)}}function HY(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"line",15),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onClick(e.destination)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit;Vp.Bb(1),Vp.Cb("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)}}function GY(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Mb(1,"circle",16),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc().$implicit,i=Vp.fc();Vp.Bb(1),Vp.oc("id","piece_",r,"_",n,""),Vp.mc("ngClass",i.getSidePieceClass(r)),Vp.Cb("cx",10+n*i.SPACE_SIZE*.5)("cy",10+(i.SPACE_SIZE+10)*r)("r",.5*i.SPACE_SIZE)}}function qY(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,GY,2,6,"g",5),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc();Vp.Bb(1),Vp.mc("ngForOf",r.getPlayerSidePieces(n))}}function WY(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"line",17)),2&e){var n=Vp.fc();Vp.Cb("x1",n.inserted.get().x1)("y1",n.inserted.get().y1)("x2",n.inserted.get().x2)("y2",n.inserted.get().y2)}}var $Y,ZY,QY,YY,KY,JY=function(){return[0,1]},XY=((QY=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).inserted=kz.empty(),r.arrows=[],r.captured=[],r.moved=[],r.movePhase=n.PHASE_PLACEMENT_COORD,r.possibleCaptures=[],r.initialCaptures=[],r.placement=kz.empty(),r.placementEntrance=kz.empty(),r.finalCaptures=[],r.scores=kz.of([0,0]),r.rules=new NY(TY),r.availableMinimaxes=[new xY(r.rules,"GipfMinimax")],r.encoder=IY.encoder,r.tutorial=(new FY).tutorial,r.SPACE_SIZE=40,r.constructedState=r.rules.node.gameState,r.hexaLayout=new JG(1.5*r.SPACE_SIZE,new zG(2*r.SPACE_SIZE,0),tq.INSTANCE),r}return Kp(n,[{key:"updateBoard",value:function(){this.showLastMove(),this.cancelMoveAttempt(),this.moveToInitialCaptureOrPlacementPhase()}},{key:"showLastMove",value:function(){this.inserted=kz.empty();var e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){var t=e.get().placement;this.inserted=kz.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}},{key:"arrowTowards",value:function(e,t){var n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new RY(n,e,i.x,i.y,r.x,r.y)}},{key:"markCapture",value:function(e){var t=this;e.forEach(function(e){t.captured.push(e)})}},{key:"getAllCoords",value:function(){return this.constructedState.allCoords()}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.constructedState.getNumberOfPiecesToPlace(HG.of(e)),n=[],r=0;r<t;r+=1)n.push(r);return n}},{key:"isPiece",value:function(e){return this.getPiece(e)!==QG.EMPTY}},{key:"getPiece",value:function(e){return this.constructedState.getPieceAt(e)}},{key:"onClick",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){r.next=3;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 3:r.t0=t.movePhase,r.next=r.t0===n.PHASE_INITIAL_CAPTURE||r.t0===n.PHASE_FINAL_CAPTURE?6:r.t0===n.PHASE_PLACEMENT_COORD?7:8;break;case 6:return r.abrupt("return",t.selectCapture(e));case 7:return r.abrupt("return",t.selectPlacementCoord(e));case 8:if(dz.expectToBe(t.movePhase,n.PHASE_PLACEMENT_DIRECTION),!1!==(o=t.placementEntrance.get()).isAlignedWith(e)){r.next=12;break}return r.abrupt("return",t.cancelMove(AY.INVALID_PLACEMENT_DIRECTION()));case 12:if(1===o.getDistance(e)){r.next=14;break}return r.abrupt("return",t.cancelMove(AY.CLICK_FURTHER_THAN_ONE_COORD()));case 14:return a=KG.factory.fromMove(o,e),r.abrupt("return",t.selectPlacementDirection(a.toOptional()));case 16:case"end":return r.stop()}},r)}))()}},{key:"selectCapture",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function r(){var i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&i.push(t)}),!(i.length>1)){r.next=3;break}return r.abrupt("return",t.cancelMove(AY.AMBIGUOUS_CAPTURE_COORD()));case 3:if(0!==i.length){r.next=5;break}return r.abrupt("return",t.cancelMove(AY.MISSING_CAPTURES()));case 5:o=i[0],r.t0=(t.constructedState=NY.applyCapture(t.constructedState,o),t.markCapture(o),t.possibleCaptures=NY.getPossibleCaptures(t.constructedState),t.movePhase),r.next=r.t0===n.PHASE_INITIAL_CAPTURE?9:10;break;case 9:return r.abrupt("return",(t.initialCaptures.push(o),0===t.possibleCaptures.length?t.moveToPlacementPhase():lz.SUCCESS));case 10:return r.abrupt("return",(dz.expectToBe(t.movePhase,n.PHASE_FINAL_CAPTURE),t.finalCaptures.push(o),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):lz.SUCCESS));case 11:case"end":return r.stop()}},r)}))()}},{key:"moveToPlacementPhase",value:function(){return this.movePhase=n.PHASE_PLACEMENT_COORD,lz.SUCCESS}},{key:"moveToInitialCaptureOrPlacementPhase",value:function(){return this.possibleCaptures=NY.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,lz.SUCCESS}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=NY.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,lz.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}},{key:"computeArrows",value:function(e){this.arrows=[];var t,n=zp(NY.getAllDirectionsForEntrance(this.constructedState,e));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===NY.isLineComplete(this.constructedState,e,r)){var i=e.getNext(r),o=this.getCenterAt(e),a=this.getCenterAt(i);this.arrows.push(new RY(e,i,o.x,o.y,a.x,a.y))}}}catch(s){n.e(s)}finally{n.f()}}},{key:"selectPlacementCoord",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.rules.placementCoordValidity(t.constructedState,e),r.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):(t.placementEntrance=kz.of(e),t.constructedState.getPieceAt(e)===QG.EMPTY?t.selectPlacementDirection(kz.empty()):(t.movePhase=n.PHASE_PLACEMENT_DIRECTION,t.computeArrows(e),0===t.arrows.length&&t.cancelMove(AY.NO_DIRECTIONS_AVAILABLE()),lz.SUCCESS)));case 2:case"end":return r.stop()}},r)}))()}},{key:"selectPlacementDirection",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.placement=kz.of(new PY(t.placementEntrance.get(),e)),r=t.rules.placementValidity(t.constructedState,t.placement.get()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.arrows=[],t.constructedState=NY.applyPlacement(t.constructedState,t.placement.get()),t.moveToFinalCapturePhaseOrTryMove()));case 3:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){var o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o=new IY(t,e,n),i.next=3,r.chooseMove(o,r.rules.node.gameState,r.scores.get());case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"cancelMoveAttempt",value:function(){var e=this;this.constructedState=this.rules.node.gameState,this.captured=[],this.moved=[];var t=this.rules.node.move;if(t.isPresent()){var n=t.get(),r=this.rules.node.mother.get().gameState;n.initialCaptures.forEach(function(t){return e.markCapture(t)}),n.finalCaptures.forEach(function(t){return e.markCapture(t)}),this.moved=this.rules.getPiecesMoved(r,n.initialCaptures,n.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=kz.empty(),this.placement=kz.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}},{key:"getSpaceClass",value:function(e){return this.captured.some(function(t){return t.equals(e)})?"captured":this.moved.some(function(t){return t.equals(e)})?"moved":""}},{key:"getPieceClass",value:function(e){var t=this.getPiece(e);return this.getPlayerClass(HG.of(t.value))}},{key:"getSidePieceClass",value:function(e){return this.getPlayerClass(HG.of(e))}}]),n}($G)).PHASE_INITIAL_CAPTURE=0,QY.PHASE_PLACEMENT_COORD=1,QY.PHASE_PLACEMENT_DIRECTION=2,QY.PHASE_FINAL_CAPTURE=3,QY.\u0275fac=function(e){return new(e||QY)(Vp.Lb(qG))},QY.\u0275cmp=Vp.Fb({type:QY,selectors:[["app-gipf"]],features:[Vp.yb],decls:11,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -12 708 854","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved","moved-stroke"],[4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Qb(1,"defs"),Vp.Qb(2,"marker",1),Vp.Mb(3,"polygon",2),Vp.Pb(),Vp.Qb(4,"marker",3),Vp.Mb(5,"polygon",4),Vp.Pb(),Vp.Pb(),Vp.Ac(6,UY,4,7,"g",5),Vp.Ac(7,zY,2,1,"g",6),Vp.Ac(8,HY,2,4,"g",5),Vp.Ac(9,qY,2,1,"g",5),Vp.Ac(10,WY,1,4,"line",7),Vp.Pb()),2&e&&(Vp.Bb(6),Vp.mc("ngForOf",t.getAllCoords()),Vp.Bb(1),Vp.mc("ngForOf",t.possibleCaptures),Vp.Bb(1),Vp.mc("ngForOf",t.arrows),Vp.Bb(1),Vp.mc("ngForOf",Vp.qc(5,JY)),Vp.Bb(1),Vp.mc("ngIf",t.inserted.isPresent()))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),QY),eK=((ZY=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"equals",value:function(e){return this===e||this.coord.equals(e.coord)}},{key:"toString",value:function(){return this===n.PASS?"GoMove.PASS":this===n.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(fq)).PASS=new ZY(-1,0),ZY.ACCEPT=new ZY(-2,0),ZY.PASS_NUMBER=-1,ZY.ACCEPT_NUMBER=-2,ZY.encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 360}},{key:"encodeNumber",value:function(e){return 19*e.coord.y+e.coord.x}},{key:"decodeNumber",value:function(e){if(e===ZY.PASS_NUMBER)return ZY.PASS;var t=e%19;return new ZY(t,(e-t)/19)}}]),n}(wz)),ZY),tK=(($Y=function(){function e(t,n){Qp(this,e),this.player=t,this.type=n}return Kp(e,[{key:"equals",value:function(e){return e===this}},{key:"toString",value:function(){switch(this){case e.BLACK:return"GoPiece.BLACK";case e.WHITE:return"GoPiece.WHITE";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_BLACK:return"GoPiece.DEAD_BLACK";case e.DEAD_WHITE:return"GoPiece.DEAD_WHITE";case e.BLACK_TERRITORY:return"GoPiece.BLACK_TERRITORY";default:return vz(this===e.WHITE_TERRITORY,"Unexisting GoPiece"),"GoPiece.WHITE_TERRITORY"}}},{key:"isOccupied",value:function(){return[e.BLACK,e.WHITE,e.DEAD_BLACK,e.DEAD_WHITE].includes(this)}},{key:"isEmpty",value:function(){return[e.BLACK_TERRITORY,e.WHITE_TERRITORY,e.EMPTY].includes(this)}},{key:"isDead",value:function(){return[e.DEAD_BLACK,e.DEAD_WHITE].includes(this)}},{key:"isTerritory",value:function(){return[e.BLACK_TERRITORY,e.WHITE_TERRITORY].includes(this)}},{key:"getOwner",value:function(){return this.player}},{key:"nonTerritory",value:function(){return vz(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}],[{key:"pieceBelongTo",value:function(e,t){return vz(t!==HG.NONE,"Owner must be Player.ZERO or Player.ONE, got Player.NONE."),t===e.player&&"territory"!==e.type}},{key:"ofPlayer",value:function(t){if(t===HG.ZERO)return e.BLACK;if(t===HG.ONE)return e.WHITE;throw new Error("GoPiece.ofPlayer should only be called with Player.ZERO and Player.ONE.")}}]),e}()).BLACK=new $Y(HG.ZERO,"alive"),$Y.WHITE=new $Y(HG.ONE,"alive"),$Y.EMPTY=new $Y(HG.NONE,"empty"),$Y.DEAD_BLACK=new $Y(HG.ZERO,"dead"),$Y.DEAD_WHITE=new $Y(HG.ONE,"dead"),$Y.BLACK_TERRITORY=new $Y(HG.NONE,"territory"),$Y.WHITE_TERRITORY=new $Y(HG.NONE,"territory"),$Y),nK=function(e){return e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED",e}({}),rK=((YY=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a){var s;return Qp(this,n),(s=t.call(this,e,i)).captured=r,s.koCoord=o,s.phase=a,s}return Kp(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}},{key:"copy",value:function(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}},{key:"isDead",value:function(e){return this.getPieceAt(e).isDead()}},{key:"isTerritory",value:function(e){return this.getPieceAt(e).isTerritory()}}],[{key:"getInitialState",value:function(){var e=n.getStartingBoard();return new n(e,[0,0],0,kz.empty(),nK.PLAYING)}},{key:"getStartingBoard",value:function(){return rq.createTable(n.WIDTH,n.HEIGHT,tK.EMPTY)}}]),n}(cq)).WIDTH=13,YY.HEIGHT=13,YY),iK=function(){var e=function(){function e(t){Qp(this,e),this.color=t}return Kp(e,[{key:"selfContains",value:function(e){return this.getCoords().some(function(t){return t.equals(e)})}}],[{key:"insertAsEntryPoint",value:function(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}]),e}();return e.VERBOSE=!1,e}(),oK=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a,s){var u;return Qp(this,n),(u=t.call(this,e)).emptyCoords=r,u.blackCoords=i,u.whiteCoords=o,u.deadBlackCoords=a,u.deadWhiteCoords=s,u}return Kp(n,[{key:"getCoords",value:function(){return this.color===tK.BLACK?this.blackCoords:this.color===tK.WHITE?this.whiteCoords:this.color===tK.DEAD_BLACK?this.deadBlackCoords:this.color===tK.DEAD_WHITE?this.deadWhiteCoords:this.emptyCoords}},{key:"contains",value:function(e){return this.blackCoords.concat(this.whiteCoords.concat(this.emptyCoords.concat(this.deadBlackCoords.concat(this.deadWhiteCoords)))).some(function(t){return t.equals(e)})}},{key:"addPawn",value:function(e,t){if(this.contains(e))throw new Error("This group already contains "+e);switch(t){case tK.BLACK:this.blackCoords=iK.insertAsEntryPoint(this.blackCoords,e);break;case tK.WHITE:this.whiteCoords=iK.insertAsEntryPoint(this.whiteCoords,e);break;case tK.DEAD_BLACK:this.deadBlackCoords=iK.insertAsEntryPoint(this.deadBlackCoords,e);break;case tK.DEAD_WHITE:this.deadWhiteCoords=iK.insertAsEntryPoint(this.deadWhiteCoords,e);break;default:dz.expectToBeMultiple(t,[tK.EMPTY,tK.BLACK_TERRITORY,tK.WHITE_TERRITORY]),this.emptyCoords=iK.insertAsEntryPoint(this.emptyCoords,e)}}},{key:"isMonoWrapped",value:function(){return(0===this.emptyCoords.length?1:2)*(this.blackCoords.length+this.deadWhiteCoords.length===0?1:2)*(this.whiteCoords.length+this.deadBlackCoords.length===0?1:2)==4}},{key:"getWrapper",value:function(){var e=new vq;e.set(tK.EMPTY,this.emptyCoords.length),e.set(tK.BLACK,this.blackCoords.length+this.deadWhiteCoords.length),e.set(tK.WHITE,this.whiteCoords.length+this.deadBlackCoords.length),e.put(this.color.nonTerritory(),0);var t=e.filter(function(e,t){return t>0});if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}},{key:"getNeighboorsEntryPoint",value:function(){var e=[];return this.color!==tK.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==tK.BLACK&&this.blackCoords.length>0&&e.push(this.blackCoords[0]),this.color!==tK.WHITE&&this.whiteCoords.length>0&&e.push(this.whiteCoords[0]),this.color!==tK.DEAD_BLACK&&this.deadBlackCoords.length>0&&e.push(this.deadBlackCoords[0]),this.color!==tK.DEAD_WHITE&&this.deadWhiteCoords.length>0&&e.push(this.deadWhiteCoords[0]),e}}]),n}(iK),aK=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getNewInstance",value:function(e){return new oK(e,[],[],[],[],[])}},{key:"getDirections",value:function(){return VG.ORTHOGONALS}}]),n}(function(){function e(){Qp(this,e)}return Kp(e,[{key:"getGroupDatas",value:function(e,t){pz(iK.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");var n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}},{key:"_getGroupDatas",value:function(e,t,n){pz(iK.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});var r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color){var i,o=zp(this.getDirections());try{for(o.s();!(i=o.n()).done;){var a=i.value,s=e.getNext(a);s.isInRange(t[0].length,t.length)&&(n.contains(s)||(n=this._getGroupDatas(s,t,n)))}}catch(u){o.e(u)}finally{o.f()}}return n}}]),e}()),sK=function(){var e=function e(){Qp(this,e)};return e.ILLEGAL_KO=function(){return $localize(Pi||(Pi=xp(["This move is a ko, you must play somewhere else before you can play in this intersection again."])))},e.CANNOT_PASS_AFTER_PASSED_PHASE=function(){return $localize(Ii||(Ii=xp(["We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn."])))},e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=function(){return $localize(Ti||(Ti=xp(["You cannot accept before the counting phase."])))},e.OCCUPIED_INTERSECTION=function(){return $localize(Ai||(Ai=xp(["This intersection is already occupied."])))},e.CANNOT_COMMIT_SUICIDE=function(){return $localize(Ni||(Ni=xp(["You cannot commit suicide."])))},e}(),uK=((KY=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,r){return pz(n.VERBOSE,{applyLegalMove:{legalMove:e,state:t,status:r}}),n.isPass(e)?(pz(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(t)):n.isAccept(e)?(pz(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(t)):n.isLegalDeadMarking(e,t)?(pz(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,t)):(pz(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(t,e,r))}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){if(pz(n.VERBOSE||!1,{isLegal:{move:e,state:t}}),n.isPass(e)){var r=t.phase===nK.PLAYING,i=t.phase===nK.PASSED;return pz(n.VERBOSE||!1,"GoRules.isLegal at "+t.phase+(r||i?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),r||i?sz.success([]):sz.failure(sK.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){var o=t.phase===nK.ACCEPT;return t.phase===nK.COUNTING||o?sz.success([]):sz.failure(sK.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,t.getCopiedBoard())?(pz(n.VERBOSE||!1,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,t)?sz.success([]):sz.failure(sK.OCCUPIED_INTERSECTION())):(pz(n.VERBOSE||!1,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,t))}},{key:"getNewKo",value:function(e,t,n){if(1===n.length){var r=n[0],i=e.coord,o=t[i.y][i.x],a=(new aK).getGroupDatas(i,t),s=a.emptyCoords,u=tK.pieceBelongTo(o,HG.ZERO)?a.blackCoords:a.whiteCoords;if(1===s.length&&s[0].equals(r)&&1===u.length)return kz.of(r)}return kz.empty()}},{key:"markTerritoryAndCount",value:function(e){pz(n.VERBOSE,{markTerritoryAndCount:{state:e}});var t,r=e.getCopiedBoard(),i=n.getTerritoryLikeGroup(e),o=e.getCapturedCopy(),a=zp(i);try{for(a.s();!(t=a.n()).done;){var s=t.value,u=s.getWrapper();if(u===tK.WHITE){o[1]+=s.emptyCoords.length;var c,l=zp(s.getCoords());try{for(l.s();!(c=l.n()).done;){var h=c.value;r[h.y][h.x]=tK.WHITE_TERRITORY}}catch(v){l.e(v)}finally{l.f()}}else{vz(u===tK.BLACK,"territory should be wrapped by black or white, not by "+u.toString()),o[0]+=s.emptyCoords.length;var f,d=zp(s.getCoords());try{for(d.s();!(f=d.n()).done;){var p=f.value;r[p.y][p.x]=tK.BLACK_TERRITORY}}catch(v){d.e(v)}finally{d.f()}}}}catch(v){a.e(v)}finally{a.f()}return new rK(r,o,e.turn,e.koCoord,e.phase)}},{key:"removeAndSubstractTerritory",value:function(e){for(var t,n=e.getCopiedBoard(),r=e.getCapturedCopy(),i=0;i<e.board.length;i++)for(var o=0;o<e.board[0].length;o++)(t=n[i][o])===tK.BLACK_TERRITORY?(n[i][o]=tK.EMPTY,r[0]=r[0]-1):t===tK.WHITE_TERRITORY&&(n[i][o]=tK.EMPTY,r[1]=r[1]-1);return new rK(n,r,e.turn,e.koCoord,e.phase)}},{key:"getEmptyZones",value:function(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),function(e){return e.isEmpty()})}},{key:"getGroupsDatasWhere",value:function(e,t){for(var n,r,i=[],o=new aK,a=0;a<e.length;a++)for(var s=0;s<e[0].length;s++)n=new zG(s,a),t(e[a][s])&&(i.some(function(e){return e.selfContains(n)})||(r=o.getGroupDatas(n,e),i.push(r)));return i}},{key:"addDeadToScore",value:function(e){for(var t,n=e.getCapturedCopy(),r=n[1],i=n[0],o=0;o<e.board.length;o++)for(var a=0;a<e.board[0].length;a++)(t=e.getPieceAtXY(a,o))===tK.DEAD_BLACK?r++:t===tK.DEAD_WHITE&&i++;return[i,r]}},{key:"switchAliveness",value:function(e,t){var n=t.getCopiedBoard();vz(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");var r=(new aK).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case tK.DEAD_BLACK:i[1]-=2*r.deadBlackCoords.length;var o,a=zp(r.deadBlackCoords);try{for(a.s();!(o=a.n()).done;){var s=o.value;n[s.y][s.x]=tK.BLACK}}catch(y){a.e(y)}finally{a.f()}break;case tK.DEAD_WHITE:i[0]-=2*r.deadWhiteCoords.length;var u,c=zp(r.deadWhiteCoords);try{for(c.s();!(u=c.n()).done;){var l=u.value;n[l.y][l.x]=tK.WHITE}}catch(y){c.e(y)}finally{c.f()}break;case tK.WHITE:i[0]+=2*r.whiteCoords.length;var h,f=zp(r.whiteCoords);try{for(f.s();!(h=f.n()).done;){var d=h.value;n[d.y][d.x]=tK.DEAD_WHITE}}catch(y){f.e(y)}finally{f.f()}break;default:dz.expectToBe(r.color,tK.BLACK),i[1]+=2*r.blackCoords.length;var p,v=zp(r.blackCoords);try{for(v.s();!(p=v.n()).done;){var g=p.value;n[g.y][g.x]=tK.DEAD_BLACK}}catch(y){v.e(y)}finally{v.f()}}return new rK(n,i,t.turn,t.koCoord,t.phase)}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.phase===nK.FINISHED?t.captured[0]>t.captured[1]?bq.ZERO_WON:t.captured[1]>t.captured[0]?bq.ONE_WON:bq.DRAW:bq.ONGOING}},{key:"isPass",value:function(e){return e.equals(eK.PASS)}},{key:"isAccept",value:function(e){return e.equals(eK.ACCEPT)}},{key:"isLegalDeadMarking",value:function(e,t){return n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===nK.COUNTING||t.phase===nK.ACCEPT)}},{key:"isLegalNormalMove",value:function(e,t){var r=t.getCopiedBoard();if(n.isKo(e,t))return sz.failure(sK.ILLEGAL_KO());[nK.COUNTING,nK.ACCEPT].includes(t.phase)&&(t=n.resurrectStones(t));var i=n.getCaptureState(e,t);if(cK.isCapturing(i))return sz.success(i.capturedCoords);r[e.coord.y][e.coord.x]=t.turn%2==0?tK.BLACK:tK.WHITE;var o=0===(new aK).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=tK.EMPTY,o?sz.failure(sK.CANNOT_COMMIT_SUICIDE()):sz.success([])}},{key:"isOccupied",value:function(e,t){return t[e.y][e.x].isOccupied()}},{key:"isKo",value:function(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}},{key:"getCaptureState",value:function(e,t){pz(n.VERBOSE||!1,{getCaptureState:{move:e,state:t}});var r,i,o=new cK,a=zp(VG.ORTHOGONALS);try{for(a.s();!(i=a.n()).done;){var s=i.value;(r=n.getCapturedInDirection(e.coord,s,t)).length>0&&o.capturedCoords.every(function(e){return!r[0].equals(e)})&&(o.capturedCoords=o.capturedCoords.concat(r))}}catch(u){a.e(u)}finally{a.f()}return o}},{key:"getCapturedInDirection",value:function(e,t,r){var i=r.getCopiedBoard(),o=e.getNext(t);if(o.isInRange(r.board[0].length,r.board.length)&&i[o.y][o.x]===(r.turn%2==0?tK.WHITE:tK.BLACK)){pz(n.VERBOSE||!1,"a group could be captured");var a=(new aK).getGroupDatas(o,i);if(n.isCapturableGroup(a,r.koCoord))return pz(n.VERBOSE||!1,{neightbooringGroupCoord:a.getCoords(),message:"is capturable"}),a.getCoords()}return[]}},{key:"isCapturableGroup",value:function(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}},{key:"getTerritoryLikeGroup",value:function(e){return n.getEmptyZones(e).filter(function(e){return e.isMonoWrapped()})}},{key:"applyPass",value:function(e){var t,r,i=e.getCopiedBoard(),o=e.getCapturedCopy(),a=e.turn;return e.phase===nK.PASSED?(t=nK.COUNTING,r=new rK(i,o,a+1,kz.empty(),t),r=n.markTerritoryAndCount(r)):(vz(e.phase===nK.PLAYING,"Cannot pass in counting phase!"),t=nK.PASSED,r=new rK(i,o,a+1,kz.empty(),t)),r}},{key:"applyLegalAccept",value:function(e){var t,n=e.getCopiedBoard();return t=e.phase===nK.COUNTING?nK.ACCEPT:nK.FINISHED,new rK(n,e.getCapturedCopy(),e.turn+1,kz.empty(),t)}},{key:"applyNormalLegalMove",value:function(e,t,r){var i;pz(n.VERBOSE,{applyNormalLegal:{currentState:e,legalMove:t,status:status}}),i=[nK.COUNTING,nK.ACCEPT].includes(e.phase)?n.resurrectStones(e):e.copy();var o=t.coord.x,a=t.coord.y,s=i.getCopiedBoard(),u=i.turn,c=tK.ofPlayer(i.getCurrentPlayer()),l=u+1;s[a][o]=c;var h,f=zp(r);try{for(f.s();!(h=f.n()).done;){var d=h.value;s[d.y][d.x]=tK.EMPTY}}catch(g){f.e(g)}finally{f.f()}var p=n.getNewKo(t,s,r),v=i.getCapturedCopy();return v[c.player.value]+=r.length,new rK(s,v,l,p,nK.PLAYING)}},{key:"resurrectStones",value:function(e){for(var t=0;t<e.board.length;t++)for(var r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=n.switchAliveness(new zG(r,t),e));return n.removeAndSubstractTerritory(e)}},{key:"applyDeadMarkingMove",value:function(e,t){pz(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:t}});var r=n.removeAndSubstractTerritory(t),i=n.switchAliveness(e.coord,r),o=new rK(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,kz.empty(),nK.COUNTING);return n.markTerritoryAndCount(o)}}]),n}(_q)).VERBOSE=!1,KY),cK=function(){function e(){Qp(this,e),this.capturedCoords=[]}return Kp(e,null,[{key:"isCapturing",value:function(e){return e.capturedCoords.length>0}}]),e}(),lK=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){pz(uK.VERBOSE||!1,"GoRules.getListMoves");var t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===nK.PLAYING||t.phase===nK.PASSED)return n.push(eK.PASS),n;pz(uK.VERBOSE||!1,"GoRules.getListMoves in counting phase");var r=this.getCountingMovesList(t);return 0===r.length?[eK.ACCEPT]:r}},{key:"getPlayingMovesList",value:function(e){for(var t,n=[],r=0;r<e.board.length;r++)for(var i=0;i<e.board[0].length;i++)t=new eK(i,r),e.getPieceAt(t.coord)===tK.EMPTY&&uK.isLegal(t,e).isSuccess()&&n.push(t);return n}},{key:"getCountingMovesList",value:function(e){var t,n=[],r=this.getCorrectBoard(e).getCopiedBoard(),i=zp(uK.getGroupsDatasWhere(r,function(e){return e!==tK.EMPTY}));try{for(i.s();!(t=i.n()).done;){var o=t.value.getCoords()[0],a=r[o.y][o.x];if(e.getPieceAt(o)!==a){var s=new eK(o.x,o.y);return n.push(s),n}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getCorrectBoard",value:function(e){var t=this.mapBoard(e.getCopiedBoard(),function(e){return e===tK.BLACK?tK.DEAD_BLACK:e===tK.WHITE?tK.DEAD_WHITE:e.isTerritory()?tK.EMPTY:e}),n=new rK(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=uK.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}},{key:"mapBoard",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}},{key:"setAliveUniqueWrapper",value:function(e,t){var n,r=e.copy(),i=zp(t);try{for(i.s();!(n=i.n()).done;){var o,a=n.value,s=zp(a.deadBlackCoords.concat(a.deadWhiteCoords));try{for(s.s();!(o=s.n()).done;){var u=o.value;r.isDead(u)&&(r=uK.switchAliveness(u,r))}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=uK.getGameStatus(e);if(n.isEndGame)return new oq(n.toBoardValue());pz(uK.VERBOSE||!1,"GoRules.getBoardValue");var r=uK.markTerritoryAndCount(t),i=r.getCapturedCopy(),o=this.getDeadStones(r);return new oq(i[1]+2*o[0]-(i[0]+2*o[1]))}},{key:"getDeadStones",value:function(e){for(var t=[0,0],n=0;n<e.board.length;n++)for(var r=0;r<e.board[0].length;r++){var i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}]),n}(iq),hK=tK.WHITE,fK=tK.BLACK,dK=tK.DEAD_WHITE,pK=tK.WHITE_TERRITORY,vK=tK.BLACK_TERRITORY,gK=tK.EMPTY,yK=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(xi||(xi=xp(["Preliminary information"]))),$localize(Ri||(Ri=xp(["The game of Go is played on a board called a Goban, and the stones are placed on the intersections.\n        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.\n        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).\n        For this tutorial, we will use a smaller board for pedagogical purposes."]))),rK.getInitialState()),Eq.informational($localize(Mi||(Mi=xp(["Goal of the game"]))),$localize(Di||(Di=xp(["The goal of the game is to have the most points at the end of the game.\n        We call \"territories\" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.\n        Here, Dark has 9 territories on the left, and Light has 8 on the right.\n        The top part belongs to no one.\n        Each player's score at the end of the game is the sum of that player's territories and captures."]))),new rK([[gK,fK,gK,gK,hK,hK],[gK,fK,gK,gK,hK,gK],[gK,fK,fK,hK,hK,gK],[gK,gK,fK,hK,gK,gK],[gK,gK,fK,hK,gK,gK],[gK,gK,fK,hK,gK,gK]],[0,0],0,kz.empty(),nK.PLAYING)),Eq.fromMove($localize(Li||(Li=xp(["Simple capture"]))),$localize(Bi||(Bi=xp(["An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).\n        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.\n        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>\n        The light piece only has one liberty left, play there."]))),new rK([[gK,gK,gK,gK,gK],[gK,gK,fK,gK,gK],[gK,fK,hK,gK,gK],[gK,gK,fK,gK,gK],[gK,gK,gK,gK,gK]],[0,0],0,kz.empty(),nK.PLAYING),[new eK(3,2)],$localize(Fi||(Fi=xp(["Congratulations, you have earned one point."]))),$localize(ji||(ji=xp(["Failed, try again by playing on one of the intersections directly next to the light stone."])))),Eq.fromMove($localize(Ui||(Ui=xp(["Capturing multiple stones"]))),$localize(Vi||(Vi=xp(["Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>\n        The light group here only has one liberty left, capture it."]))),new rK([[gK,fK,gK,gK,gK],[fK,hK,gK,gK,gK],[fK,hK,hK,fK,gK],[gK,fK,fK,gK,gK],[gK,gK,gK,gK,gK]],[0,0],0,kz.empty(),nK.PLAYING),[new eK(2,1)],$localize(zi||(zi=xp(["Congratulations, you have earned three points and formed a territory."]))),$localize(Hi||(Hi=xp(["Failed, you have not captured the group. Play on the last liberty of that group."])))),Eq.informational($localize(Gi||(Gi=xp(["Suicide"]))),$localize(qi||(qi=xp(["In Go, suicide is forbidden.\n        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.\n        Here, the top left intersection is a suicide for Light.\n        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player."]))),new rK([[gK,fK,gK,gK,gK],[fK,gK,gK,gK,gK],[fK,gK,gK,gK,hK],[hK,fK,gK,hK,gK],[gK,hK,gK,hK,fK]],[0,0],0,kz.empty(),nK.PLAYING)),Eq.informational($localize(Wi||(Wi=xp(["Life and death (death)"]))),$localize($i||($i=xp(["From the capture rule follows the life and death notion:\n        dead stones are stones that are definitely capturable (without losing anything else).\n        Alive stones are stones that can never be captured.\n        From the capture rule, Dark can play inside Light's territory and make a capture.\n        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).\n        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories."]))),new rK([[gK,gK,gK,gK,gK],[fK,fK,fK,gK,gK],[hK,hK,fK,gK,gK],[gK,hK,fK,gK,gK],[hK,hK,fK,gK,gK]],[0,0],0,kz.empty(),nK.PLAYING)),Eq.informational($localize(Zi||(Zi=xp(["Life and death (eyes)"]))),$localize(Qi||(Qi=xp(["Here, Light cannot play on the top left, nor on the bottom left.\n        Light will never be able to capture Dark.\n        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive."]))),new rK([[gK,fK,hK,gK,gK],[hK,fK,hK,gK,gK],[fK,fK,hK,gK,gK],[hK,fK,hK,gK,gK],[gK,fK,hK,gK,gK]],[0,0],0,kz.empty(),nK.PLAYING)),Eq.informational($localize(Yi||(Yi=xp(["Seki"]))),$localize(Ki||(Ki=xp(["If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.\n        Similarly, if Light plays on the middle line, Dark will capture Light.\n        In other words, there is no point in playing on the middle line.\n        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral."]))),new rK([[gK,hK,fK,gK,hK,fK,gK],[gK,hK,fK,fK,hK,fK,gK],[gK,hK,fK,fK,hK,fK,gK],[gK,hK,fK,fK,hK,fK,gK],[gK,hK,fK,hK,hK,fK,gK],[gK,hK,fK,hK,hK,fK,gK],[gK,hK,fK,gK,hK,fK,gK]],[0,0],0,kz.empty(),nK.PLAYING)),Eq.fromMove($localize(Ji||(Ji=xp(["Ko"]))),$localize(Xi||(Xi=xp(["A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>\n        Capture the light stone."]))),new rK([[gK,gK,gK,gK,gK,gK,gK],[gK,gK,gK,gK,gK,gK,gK],[gK,gK,gK,fK,hK,gK,gK],[gK,gK,fK,hK,gK,hK,gK],[gK,gK,gK,fK,hK,gK,gK],[gK,gK,gK,gK,gK,gK,gK],[gK,gK,gK,gK,gK,gK,gK]],[0,0],0,kz.empty(),nK.PLAYING),[new eK(4,3)],$localize(eo||(eo=xp(["Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.\n        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.\n        This rule is called the Ko.\n        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after."]))),$localize(to||(to=xp(["Failed!"])))),Eq.fromMove($localize(no||(no=xp(["End of the game"]))),$localize(ro||(ro=xp(["When a player feels that there is no advantage to putting a new stone, that player can pass a turn.\n        The game phase stops when both players pass consecutively, and we move on to the counting phase.\n        The dead groups are then marked by clicking on them.\n        Every intersection in a player's territory earns that player a point.\n        The winner is the one with most points.<br/><br/>\n        A last stone is dead, mark it."]))),new rK([[hK,fK,fK,fK,fK,fK,vK,vK,vK],[hK,hK,hK,hK,fK,fK,fK,vK,vK],[hK,pK,hK,hK,fK,dK,dK,fK,vK],[fK,hK,hK,hK,hK,fK,vK,vK,vK],[gK,hK,pK,hK,fK,fK,dK,fK,vK],[hK,pK,hK,hK,fK,fK,fK,fK,fK],[hK,hK,fK,fK,fK,hK,hK,fK,hK],[fK,fK,fK,hK,hK,hK,pK,hK,hK],[vK,vK,fK,fK,fK,hK,hK,pK,pK]],[0,0],0,kz.empty(),nK.COUNTING),[new eK(0,3)],$localize(io||(io=xp(["Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.\n        The intersections where the prisoners are count as Dark's territory\n        Light has 8 territories and 1 prisoner.\n        The end result is therefore 18 - 9 for Dark."]))),$localize(oo||(oo=xp(["Failed, try again."]))))]};function mK(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",10)),2&e){var n=Vp.fc(2).index,r=Vp.fc().index;Vp.Cb("cx",25+50*n)("cy",25+50*r)("r",22)}}function bK(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb()}if(2&e){var r=Vp.fc(2).index,i=Vp.fc().index;Vp.Cb("x1",50*r)("y1",50*i)("x2",50+50*r)("y2",50+50*i)}}function _K(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"circle",7),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Ac(2,mK,1,3,"circle",8),Vp.Ac(3,bK,1,4,"line",9),Vp.Pb()}if(2&e){var r=Vp.fc().index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.mc("ngClass",o.getSpaceClass(r,i)),Vp.Cb("cx",25+50*r)("cy",25+50*i)("r",22),Vp.Bb(1),Vp.mc("ngIf",o.isLastCase(r,i)),Vp.Bb(1),Vp.mc("ngIf",o.isDead(r,i))}}function wK(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"circle",15),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb()}if(2&e){var r=Vp.fc(2),i=r.index,o=r.$implicit,a=Vp.fc().index,s=Vp.fc();Vp.Cb("cx",25+50*i)("cy",25+50*a)("r",10)("class",o===s.GoPiece.WHITE_TERRITORY?"player1":"player0")}}function kK(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"rect",12),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(1,"line",13),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(2,"line",13),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Ac(3,wK,1,4,"circle",14)}if(2&e){var r=Vp.fc().index,i=Vp.fc().index,o=Vp.fc();Vp.oc("id","click_",r,"_",i,""),Vp.Cb("x",50*r)("y",50*i),Vp.Bb(1),Vp.Cb("x1",50*r)("y1",25+50*i)("x2",50+50*r)("y2",25+50*i),Vp.Bb(1),Vp.Cb("x1",25+50*r)("y1",50*i)("x2",25+50*r)("y2",50+50*i),Vp.Bb(1),Vp.mc("ngIf",o.isTerritory(r,i))}}function CK(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,_K,4,6,"g",5),Vp.Ac(2,kK,4,13,"ng-template",null,6,Vp.Bc),Vp.Pb()),2&e){var n=t.index,r=Vp.vc(3),i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",o.caseIsFull(n,i))("ngIfElse",r)}}function EK(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,CK,4,2,"g",2),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function OK(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"rect",16)),2&e){var n=Vp.fc();Vp.Cb("x",12.5+50*n.ko.get().x)("y",12.5+50*n.ko.get().y)}}function SK(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"circle",17),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onClick(e.x,e.y)}),Vp.Pb()}if(2&e){var r=t.$implicit;Vp.Cb("cx",25+50*r.x)("cy",25+50*r.y)("r",7)}}var PK,IK,TK,AK,NK,xK=((NK=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).ko=kz.empty(),r.last=kz.empty(),r.captures=[],r.GoPiece=tK,r.scores=kz.of([0,0]),r.rules=new uK(rK),r.availableMinimaxes=[new lK(r.rules,"GoMinimax")],r.encoder=eK.encoder,r.tutorial=(new yK).tutorial,r.canPass=!0,r.updateBoard(),r}return Kp(n,[{key:"onClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.last=kz.empty(),o=new eK(e,t),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState,n.scores.get()));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){pz(n.VERBOSE,"updateBoard");var e=this.rules.node.gameState,t=this.rules.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=kz.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(function(e){return e.coord}),this.canPass=r!==nK.FINISHED}},{key:"showCaptures",value:function(){var e=this.rules.node.mother.get().gameState;this.captures=[];for(var t=0;t<this.board.length;t++)for(var n=0;n<this.board[0].length;n++){var r=new zG(n,t),i=!1===e.getPieceAt(r).isEmpty(),o=this.board[t][n]===tK.EMPTY,a=!1===this.ko.equalsValue(r);i&&o&&a&&this.captures.push(r)}}},{key:"pass",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.rules.node.gameState.phase,t.abrupt("return",n===nK.PLAYING||n===nK.PASSED?e.onClick(eK.PASS.coord.x,eK.PASS.coord.y):(vz(n===nK.COUNTING||n===nK.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(eK.ACCEPT.coord.x,eK.ACCEPT.coord.y)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getSpaceClass",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}},{key:"caseIsFull",value:function(e,t){return this.rules.node.gameState.getPieceAtXY(e,t)!==tK.EMPTY&&!this.isTerritory(e,t)}},{key:"isLastCase",value:function(e,t){if(this.last.isPresent()){var n=this.last.get();return e===n.x&&t===n.y}return!1}},{key:"isDead",value:function(e,t){return this.rules.node.gameState.isDead(new zG(e,t))}},{key:"isTerritory",value:function(e,t){return this.rules.node.gameState.isTerritory(new zG(e,t))}}]),n}(dW)).VERBOSE=!1,NK.\u0275fac=function(e){return new(e||NK)(Vp.Lb(qG))},NK.\u0275cmp=Vp.Fb({type:NK,selectors:[["app-go"]],features:[Vp.yb],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke highlighted",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","highlighted"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured",3,"click"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Mb(1,"rect",1),Vp.Ac(2,EK,2,1,"g",2),Vp.Ac(3,OK,1,2,"rect",3),Vp.Ac(4,SK,1,3,"circle",4),Vp.Pb()),2&e&&(Vp.Cb("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),Vp.Bb(1),Vp.Cb("width",50*t.board.length)("height",50*t.board.length),Vp.Bb(1),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngIf",t.ko.isPresent()),Vp.Bb(1),Vp.mc("ngForOf",t.captures))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),NK),RK=((AK=function(){function e(t,n,r){Qp(this,e),this.value=t,this.name=n,this.rgb=r}return Kp(e,null,[{key:"of",value:function(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return dz.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}]),e}()).ANY=new AK(0,"any","#000"),AK.ORANGE=new AK(1,"orange","#d67421"),AK.BLUE=new AK(2,"blue","#006bac"),AK.PURPLE=new AK(3,"purple","#6f3787"),AK.PINK=new AK(4,"pink","#d2719e"),AK.YELLOW=new AK(5,"yellow","#e2c200"),AK.RED=new AK(6,"red","#d23339"),AK.GREEN=new AK(7,"green","#009157"),AK.BROWN=new AK(8,"brown","#562500"),AK),MK=((TK=function(){function e(t,n){Qp(this,e),this.player=t,this.color=n}return Kp(e,[{key:"equals",value:function(e){return e.player===this.player&&e.color===this.color}},{key:"isEmpty",value:function(){return this.player.equals(HG.NONE)}},{key:"belongsTo",value:function(e){return this.player===e}}],[{key:"of",value:function(t,n){return new e(t,RK.of(n))}},{key:"createPlayerColors",value:function(t){return{ORANGE:new e(t,RK.ORANGE),BLUE:new e(t,RK.BLUE),PURPLE:new e(t,RK.PURPLE),PINK:new e(t,RK.PINK),YELLOW:new e(t,RK.YELLOW),RED:new e(t,RK.RED),GREEN:new e(t,RK.GREEN),BROWN:new e(t,RK.BROWN)}}}]),e}()).NONE=new TK(HG.NONE,RK.ANY),TK.ZERO=TK.createPlayerColors(HG.ZERO),TK.ONE=TK.createPlayerColors(HG.ONE),TK),DK=((IK=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"getColorAt",value:function(t,n){return e.COLORS[n][t]}},{key:"getInitialBoard",value:function(){var e=MK.NONE;return[[1,2,3,4,5,6,7,8].map(function(e){return MK.of(HG.ONE,e)}),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(function(e){return MK.of(HG.ZERO,e)})]}},{key:"isEmptyAt",value:function(e,t){return e[t.y][t.x].equals(MK.NONE)}},{key:"allPieceCoords",value:function(t){for(var n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){var o=new zG(i,r);e.isEmptyAt(t,o)||n.push(o)}return n}}]),e}()).INITIAL=IK.getInitialBoard(),IK.SIZE=8,IK.COLORS=rq.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],RK.of),IK),LK=((PK=function(e){Jp(n,e);var t=ev(n);function n(e,r){return Qp(this,n),t.call(this,e,r)}return Kp(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return this===n.PASS?"KamisadoMove(PASS)":"KamisadoMove("+this.coord+"->"+this.end+")"}}],[{key:"of",value:function(e,t){if(e.isNotInRange(DK.SIZE,DK.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(DK.SIZE,DK.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new n(e,t)}}]),n}(AW)).PASS=new PK(new zG(-2,-2),new zG(-3,-3)),PK.encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 34952}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return PK.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new PK(new zG((e=e/16|0)%16,r),new zG(n,t))}}]),n}(wz)),PK),BK=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a){var s;return Qp(this,n),(s=t.call(this,rq.copyBiArray(a),e)).colorToPlay=r,s.coordToPlay=i,s.alreadyPassed=o,s}return Kp(n,null,[{key:"getInitialState",value:function(){return new n(0,RK.ANY,kz.empty(),!1,DK.INITIAL)}}]),n}(cq),FK=function(){var e=function e(){Qp(this,e)};return e.NOT_RIGHT_COLOR=function(){return $localize(ao||(ao=xp(["This piece is not of the color you have to play."])))},e.DIRECTION_NOT_ALLOWED=function(){return $localize(so||(so=xp(["You can only move forward, orthogonally or diagonally."])))},e.MOVE_BLOCKED=function(){return $localize(uo||(uo=xp(["This move is blocked by another piece."])))},e.PLAY_WITH_SELECTED_PIECE=function(){return $localize(co||(co=xp(["You must play with the selected piece."])))},e}(),jK=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"nextCoordToPlay",value:function(e,t){return kz.ofNullable(DK.allPieceCoords(e.board).find(function(n){var r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}},{key:"applyLegalMove",value:function(e,t,n){if(e===LK.PASS){var r=this.nextCoordToPlay(t,t.colorToPlay);return new BK(t.turn+1,t.colorToPlay,r,!0,t.board)}var i=e.coord,o=e.end,a=t.getCopiedBoard();a[o.y][o.x]=a[i.y][i.x],a[i.y][i.x]=MK.NONE;var s=DK.getColorAt(o.x,o.y),u=this.nextCoordToPlay(t,s);return new BK(t.turn+1,s,u,!1,a)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=t.getCurrentPlayer();if(n.mustPass(t)&&t.alreadyPassed)return bq.getDefeat(r);var i=Bp(n.getFurthestPiecePositions(t),2),o=i[0];return 7===i[1]?bq.ONE_WON:0===o?bq.ZERO_WON:bq.ONGOING}}],[{key:"getColorMatchingPiece",value:function(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new zG(0,7),new zG(1,7),new zG(2,7),new zG(3,7),new zG(4,7),new zG(5,7),new zG(6,7),new zG(7,7)]}},{key:"getMovablePieces",value:function(e){var t=this;return n.getColorMatchingPiece(e).filter(function(n){var r,i=zp(t.playerDirections(e.getCurrentPlayer()));try{for(i.s();!(r=i.n()).done;){var o=r.value,a=n.getNext(o);if(e.isOnBoard(a)&&DK.isEmptyAt(e.board,a))return!0}}catch(s){i.e(s)}finally{i.f()}return!1})}},{key:"playerDirections",value:function(e){if(e===HG.ONE)return[jG.DOWN,jG.DOWN_LEFT,jG.DOWN_RIGHT];if(e===HG.ZERO)return[jG.UP,jG.UP_LEFT,jG.UP_RIGHT];throw new Error("Invalid player")}},{key:"directionAllowedForPlayer",value:function(e,t){if(t===HG.ZERO)return e.y<0;if(t===HG.ONE)return e.y>0;throw new Error("Invalid player")}},{key:"getListMovesFromState",value:function(e){var t=n.getMovablePieces(e);return 0===t.length?(vz(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[LK.PASS]):n.getListMovesFromNonBlockedState(e,t)}},{key:"getListMovesFromNonBlockedState",value:function(e,t){var r,i=[],o=e.getCurrentPlayer(),a=zp(t);try{for(a.s();!(r=a.n()).done;){var s,u=r.value,c=zp(n.playerDirections(o));try{for(c.s();!(s=c.n()).done;)for(var l=s.value,h=1;h<DK.SIZE;h++){var f=u.getNext(l,h);if(!e.isOnBoard(f)||!DK.isEmptyAt(e.board,f))break;var d=LK.of(u,f);i.push(d)}}catch(p){c.e(p)}finally{c.f()}}}catch(p){a.e(p)}finally{a.f()}return i}},{key:"mustPass",value:function(e){return 0===this.getMovablePieces(e).length}},{key:"getFurthestPiecePositions",value:function(e){var t=7,n=0;return DK.allPieceCoords(e.board).forEach(function(r){var i=e.getPieceAt(r);vz(i!==MK.NONE,"allPieceCoords failed to filter KamisadoPiece.NONE"),i.player===HG.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}},{key:"isLegal",value:function(e,t){var r=e.coord,i=e.end,o=t.colorToPlay;if(e===LK.PASS)return this.isLegalPass(t);if(n.isVictory(t))return sz.failure("You should never see this message");var a=t.getPieceAt(r);if(!a.belongsTo(t.getCurrentPlayer()))return sz.failure(nq.MUST_CHOOSE_PLAYER_PIECE());if(o!==RK.ANY&&a.color!==o)return sz.failure(FK.NOT_RIGHT_COLOR());if(!t.getPieceAt(i).isEmpty())return sz.failure(nq.MUST_CLICK_ON_EMPTY_SPACE());var s=jG.factory.fromMove(r,i);if(s.isFailure())return sz.failure(FK.DIRECTION_NOT_ALLOWED());var u=s.get();if(!n.directionAllowedForPlayer(u,t.getCurrentPlayer()))return sz.failure(FK.DIRECTION_NOT_ALLOWED());for(var c=r;!c.equals(i);)if(c=c.getNext(u),!t.getPieceAt(c).isEmpty())return sz.failure(FK.MOVE_BLOCKED());return sz.success(void 0)}},{key:"isLegalPass",value:function(e){return this.mustPass(e)&&!e.alreadyPassed?sz.success(void 0):sz.failure(nq.CANNOT_PASS())}},{key:"isVictory",value:function(e){var t=Bp(this.getFurthestPiecePositions(e),2),n=t[0],r=t[1];return 0===n||7===r}}]),n}(_q),UK=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t=jK.getListMovesFromState(e.gameState);return rq.sortByDescending(t,function(e){return e.length()}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=t.getCurrentPlayer();if(jK.mustPass(t)&&t.alreadyPassed)return new oq(n.getDefeatValue());var r=Bp(jK.getFurthestPiecePositions(t),2),i=r[0],o=r[1];return new oq(7===o?HG.ONE.getVictoryValue():0===i?HG.ZERO.getVictoryValue():o-(7-i))}}]),n}(iq),VK=MK.NONE,zK=MK.ZERO.ORANGE,HK=MK.ONE.ORANGE,GK=MK.ZERO.BLUE,qK=MK.ONE.BLUE,WK=MK.ZERO.PURPLE,$K=MK.ONE.PURPLE,ZK=MK.ZERO.PINK,QK=MK.ONE.PINK,YK=MK.ZERO.YELLOW,KK=MK.ONE.YELLOW,JK=MK.ZERO.RED,XK=MK.ONE.RED,eJ=MK.ZERO.GREEN,tJ=MK.ONE.GREEN,nJ=MK.ZERO.BROWN,rJ=MK.ONE.BROWN,iJ=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(lo||(lo=xp(["Goal of the game"]))),$localize(ho||(ho=xp(["At Kamisado, there are two ways to win the game:\n        either by moving one of your pieces on the opponent's starting line,\n        or by forcing the opponent to make a move that blocks the entire game.\n        Here, Dark wins because its brown piece is on Light's starting line, on the top left."]))),new BK(5,RK.ORANGE,kz.empty(),!1,[[nJ,qK,$K,QK,KK,XK,tJ,rJ],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,HK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,eJ,JK,YK,ZK,WK,GK,zK]])).withPreviousMove(LK.of(new zG(0,7),new zG(0,0))),Eq.anyMove($localize(fo||(fo=xp(["Initial board and initial move"]))),$localize(po||(po=xp(["Here is the initial board.\n        At Kamisado, pieces can only move forward, vertically or diagonally.\n        You're playing first, with dark pieces, you can make your first move.<br/><br/>\n        Click on the piece of your choice and click on the landing square."]))),BK.getInitialState(),LK.of(new zG(7,7),new zG(3,3)),$localize(vo||(vo=xp(["Perfect! Note that each of your piece has a different color."])))),Eq.fromMove($localize(go||(go=xp(["Moving"]))),$localize(yo||(yo=xp(["Let us now consider the move of Light, after the blue piece has been moved by Dark.\n        All moves after the initial move must be made from the piece that corresponds to the color\n        of the square upon which the last move ended.\n        Here, the last move ended on the pink square, hence the pink piece must move.\n        It is already selected, you do not have to click on it.<br/><br/>\n        Move it on a blue square."]))),new BK(1,RK.PINK,kz.of(new zG(3,0)),!1,[[HK,qK,$K,QK,KK,XK,tJ,rJ],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,GK,VK],[VK,VK,VK,VK,VK,VK,VK,VK],[nJ,eJ,JK,YK,ZK,WK,VK,zK]]),[LK.of(new zG(3,0),new zG(3,6)),LK.of(new zG(3,0),new zG(4,1))],$localize(mo||(mo=xp(["Congratulations!"]))),$localize(bo||(bo=xp(["You have not moved your pink piece on a blue square!"])))).withPreviousMove(LK.of(new zG(6,7),new zG(6,5))),Eq.informational($localize(_o||(_o=xp(["Stuck situation"]))),$localize(wo||(wo=xp(["Dark moved to another pink square, hence you have to move your pink piece again.\n        However, your pink piece is stuck! In this case, you must pass your turn.\n        Dark will now have to play by moving its pink piece."]))),new BK(1,RK.PINK,kz.of(new zG(3,6)),!1,[[HK,qK,$K,VK,KK,XK,tJ,rJ],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,VK,GK],[VK,VK,VK,VK,VK,VK,VK,VK],[VK,VK,VK,QK,VK,VK,VK,VK],[nJ,eJ,JK,YK,ZK,WK,VK,zK]])).withPreviousMove(LK.of(new zG(6,5),new zG(7,4))),Eq.fromMove($localize(ko||(ko=xp(["Victory by blocking"]))),$localize(Co||(Co=xp(["At any time, if a player blocks the entire game, that player loses.\n        In other words, if a player forces its opponent to move a piece that the opponent cannot move,\n        and the player cannot move its own piece of the same color, then that player loses.\n        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>\n        Try to make this move."]))),new BK(2,RK.RED,kz.of(new zG(2,4)),!1,[[VK,qK,$K,VK,VK,XK,VK,VK],[VK,VK,VK,KK,VK,VK,VK,VK],[VK,VK,VK,QK,VK,$K,VK,VK],[VK,VK,VK,YK,VK,VK,VK,VK],[VK,VK,JK,VK,VK,VK,VK,VK],[VK,VK,VK,VK,VK,VK,tJ,VK],[HK,VK,VK,VK,VK,ZK,VK,rJ],[nJ,eJ,VK,VK,VK,VK,GK,zK]]),[LK.of(new zG(2,4),new zG(0,2))],$localize(Eo||(Eo=xp(["Perfect!\n         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.\n         Your orange piece will be stuck and you will have to pass your turn.\n         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.\n         In this case, the last player to have moved a piece loses.\n         Here, your opponent will have moved its green piece last, you therefore win!"]))),$localize(Oo||(Oo=xp(["Failed!"])))).withPreviousMove(LK.of(new zG(4,0),new zG(3,1)))]};function oJ(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",8)),2&e){var n=Vp.fc(),r=n.index,i=n.$implicit,o=Vp.fc().index,a=Vp.fc();Vp.Cb("cx",a.SPACE_SIZE/2+r*a.SPACE_SIZE)("cy",a.SPACE_SIZE/2+o*a.SPACE_SIZE)("fill",a.pieceColor(i))("r",a.SPACE_SIZE/3)}}function aJ(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"rect",9)),2&e){var n=Vp.fc(),r=n.$implicit,i=n.index,o=Vp.fc().index,a=Vp.fc();Vp.mc("ngClass",a.piecePlayerClass(r)),Vp.Cb("x",a.SPACE_SIZE/2+i*a.SPACE_SIZE-a.SPACE_SIZE/8)("y",a.SPACE_SIZE/2+o*a.SPACE_SIZE-a.SPACE_SIZE/8)("rx",a.isPlayerZero(r)?a.SPACE_SIZE:0)("ry",a.isPlayerZero(r)?a.SPACE_SIZE:0)("width",a.SPACE_SIZE/4)("height",a.SPACE_SIZE/4)}}function sJ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"g",4),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onClick(e,r)}),Vp.Mb(2,"rect",5),Vp.Ac(3,oJ,1,4,"circle",6),Vp.Ac(4,aJ,1,7,"rect",7),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc().index,a=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",i,"_",o,""),Vp.Bb(1),Vp.Cb("x",i*a.SPACE_SIZE)("y",o*a.SPACE_SIZE)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE)("fill",a.backgroundColor(i,o)),Vp.Bb(1),Vp.mc("ngIf",r!==a.UNOCCUPIED),Vp.Bb(1),Vp.mc("ngIf",r!==a.UNOCCUPIED)}}function uJ(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,sJ,5,9,"g",1),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function cJ(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Mb(1,"rect",10),Vp.Mb(2,"rect",10),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(1),Vp.Cb("x",n.lastMove.get().coord.x*n.SPACE_SIZE)("y",n.lastMove.get().coord.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x",n.lastMove.get().end.x*n.SPACE_SIZE)("y",n.lastMove.get().end.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function lJ(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",11)),2&e){var n=Vp.fc();Vp.Cb("cx",n.SPACE_SIZE/2+n.chosen.get().x*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+n.chosen.get().y*n.SPACE_SIZE)}}var hJ,fJ,dJ,pJ=((dJ=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).UNOCCUPIED=MK.NONE,r.lastMove=kz.empty(),r.chosen=kz.empty(),r.chosenAutomatically=!1,r.rules=new jK(BK),r.availableMinimaxes=[new UK(r.rules,"KamisadoMinimax")],r.encoder=LK.encoder,r.tutorial=(new iJ).tutorial,r.canPass=!1,r.updateBoard(),r}return Kp(n,[{key:"backgroundColor",value:function(e,t){return DK.getColorAt(e,t).rgb}},{key:"isPlayerZero",value:function(e){return e.player===HG.ZERO}},{key:"pieceColor",value:function(e){return e.color.rgb}},{key:"piecePlayerClass",value:function(e){return this.getPlayerClass(e.player)}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.canPass=jK.mustPass(e),this.canPass||e.coordToPlay.isAbsent()?(this.chosenAutomatically=!1,this.chosen=kz.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}},{key:"pass",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(vz(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(LK.PASS,e.rules.node.gameState)));case 1:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(o=new zG(e,t),!n.canPass){r.next=6;break}return r.abrupt("return",n.cancelMove(nq.MUST_PASS()));case 6:if(!n.chosen.isAbsent()){r.next=8;break}return r.abrupt("return",n.choosePiece(e,t));case 8:if(!1!==n.chosenAutomatically||!n.chosen.equalsValue(o)){r.next=10;break}return r.abrupt("return",(n.cancelMoveAttempt(),lz.SUCCESS));case 10:if(a=n.rules.node.gameState.getPieceAtXY(e,t),s=n.rules.node.gameState.getCurrentPlayer(),!a.belongsTo(s)){r.next=15;break}r.t0=n.chosenAutomatically?n.cancelMove(FK.PLAY_WITH_SELECTED_PIECE()):(n.chosen=kz.of(o),lz.SUCCESS),r.next=18;break;case 15:return r.next=17,n.chooseDestination(e,t);case 17:r.t0=r.sent;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t),r=this.rules.node.gameState.getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(nq.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=kz.of(new zG(e,t)),lz.SUCCESS)}},{key:"chooseDestination",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),o=new zG(e,t),a=LK.of(i,o),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenAutomatically||(this.chosen=kz.empty())}}]),n}(dW)).\u0275fac=function(e){return new(e||dJ)(Vp.Lb(qG))},dJ.\u0275cmp=Vp.Fb({type:dJ,selectors:[["app-kamisado"]],features:[Vp.yb],decls:4,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","30","class","base mid-stroke no-fill highlighted",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",4,"ngIf"],["class","no-stroke",3,"ngClass",4,"ngIf"],[1,"base-no-fill"],[1,"no-stroke",3,"ngClass"],[1,"base","no-fill","mid-stroke","highlighted"],["r","30",1,"base","mid-stroke","no-fill","highlighted"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,uJ,2,1,"g",1),Vp.Ac(2,cJ,3,8,"g",2),Vp.Ac(3,lJ,1,2,"circle",3),Vp.Pb()),2&e&&(Vp.Cb("viewBox","-4 -4 "+8*t.SPACE_SIZE+" "+(8+8*t.SPACE_SIZE)),Vp.Bb(1),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngIf",t.lastMove.isPresent()),Vp.Bb(1),Vp.mc("ngIf",t.chosen.isPresent()))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),dJ),vJ=((fJ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,null,[{key:"getInitialState",value:function(){var e=HG.NONE,t=HG.ZERO,r=HG.ONE;return new n([[e,t,t,t,t,t,t,e],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[e,t,t,t,t,t,t,e]],0)}},{key:"isOnBoard",value:function(e){return e.isInRange(n.SIZE,n.SIZE)}}]),n}(cq)).SIZE=8,fJ),gJ=((hJ=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e,r)).direction=i,o.direction=jG.factory.fromMove(e,r).get(),o}return Kp(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}],[{key:"of",value:function(e,t){var r=jG.factory.fromMove(e,t);return r.isFailure()?sz.failure(r.getReason()):e.isNotInRange(vJ.SIZE,vJ.SIZE)?sz.failure("start coord is not in range"):t.isNotInRange(vJ.SIZE,vJ.SIZE)?sz.failure("end coord is not in range"):sz.success(new n(e,t,r.get()))}}]),n}(AW)).encoder=AW.getEncoder(vJ.SIZE,vJ.SIZE,function(e,t){return hJ.of(e,t).get()}),hJ),yJ=function(){var e=function e(){Qp(this,e)};return e.INVALID_MOVE_LENGTH=function(){return $localize(So||(So=xp(["Your move should have a length equal to the number of pieces that exist on the same line."])))},e.CANNOT_JUMP_OVER_OPPONENT=function(){return $localize(Po||(Po=xp(["You cannot jump over the opponent's pieces."])))},e.PIECE_CANNOT_MOVE=function(){return $localize(Io||(Io=xp(["This piece has no possible move, select another one."])))},e.INVALID_DIRECTION=function(){return $localize(To||(To=xp(["A move must be orthogonal or diagonal"])))},e}(),mJ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=HG.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new vJ(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=Bp(n.getNumberOfGroups(t),2),i=r[0],o=r[1];return 1===i&&o>1?bq.ZERO_WON:i>1&&1===o?bq.ONE_WON:bq.ONGOING}}],[{key:"getListMovesFromState",value:function(e){var t=[];if(n.getVictory(e).isPresent())return t;for(var r=0;r<vJ.SIZE;r++)for(var i=0;i<vJ.SIZE;i++){var o=new zG(i,r);if(e.getPieceAt(o)!==HG.NONE){var a,s=zp(n.possibleTargets(e,o));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=gJ.of(o,u).get();t.push(c)}}catch(l){s.e(l)}finally{s.f()}}}return t}},{key:"getNumberOfGroups",value:function(e){for(var t=rq.createTable(vJ.SIZE,vJ.SIZE,-1),r=[0,0],i=0,o=0;o<vJ.SIZE;o++)for(var a=0;a<vJ.SIZE;a++)if(-1===t[o][a]){var s=e.getPieceAt(new zG(a,o));s!==HG.NONE&&(i+=1,n.markGroupStartingAt(e,t,new zG(a,o),i),r[s.value]+=1)}return r}},{key:"markGroupStartingAt",value:function(e,t,n,r){for(var i=[n],o=e.getPieceAt(n);i.length>0;){var a=dz.getNonNullable(i.pop());if(-1===t[a.y][a.x]){var s=e.getPieceAt(a);if(s===o){t[a.y][a.x]=r;var u,c=zp(jG.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=a.getNext(l);e.isOnBoard(h)&&i.push(h)}}catch(f){c.e(f)}finally{c.f()}}else s===HG.NONE&&(t[a.y][a.x]=0)}}}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?sz.failure(nq.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?sz.failure(yJ.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(function(e){return t.getPieceAt(e)===t.getCurrentOpponent()})?sz.failure(yJ.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?sz.failure(nq.CANNOT_SELF_CAPTURE()):sz.success(void 0)}},{key:"numberOfPiecesOnLine",value:function(e,t,r){var i,o=0,a=zp(n.getLineCoords(t,r));try{for(a.s();!(i=a.n()).done;){var s=i.value;e.getPieceAt(s)!==HG.NONE&&(o+=1)}}catch(u){a.e(u)}finally{a.f()}return o}},{key:"getLineCoords",value:function(e,t){for(var r=n.getEntranceAndForwardDirection(e,t),i=r[0],o=r[1],a=[];vJ.isOnBoard(i);)a.push(i),i=i.getNext(o);return a}},{key:"getEntranceAndForwardDirection",value:function(e,t){switch(t){case jG.UP:case jG.DOWN:return[new zG(e.x,0),jG.DOWN];case jG.LEFT:case jG.RIGHT:return[new zG(0,e.y),jG.RIGHT];case jG.UP_RIGHT:case jG.DOWN_LEFT:return[new zG(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),jG.UP_RIGHT];default:return dz.expectToBeMultiple(t,[jG.UP_LEFT,jG.DOWN_RIGHT]),[new zG(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),jG.DOWN_RIGHT]}}},{key:"getVictory",value:function(e){var t=Bp(n.getNumberOfGroups(e),2),r=t[0],i=t[1];return 1===r&&1===i?kz.of(HG.NONE):1===r?kz.of(HG.ZERO):1===i?kz.of(HG.ONE):kz.empty()}},{key:"possibleTargets",value:function(e,t){var r,i=[],o=zp(jG.DIRECTIONS);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=n.numberOfPiecesOnLine(e,t,a),u=t.getNext(a,s);if(e.isOnBoard(u)){var c=gJ.of(t,u).get();n.isLegal(c,e).isSuccess()&&i.push(u)}}}catch(l){o.e(l)}finally{o.f()}return i}}]),n}(_q),bJ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){return mJ.getListMovesFromState(e.gameState)}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Bp(mJ.getNumberOfGroups(t),2),r=n[0],i=n[1];return new oq(1===r&&i>1?HG.ZERO.getVictoryValue():r>1&&1===i?HG.ONE.getVictoryValue():100/r*HG.ZERO.getScoreModifier()+100/i*HG.ONE.getScoreModifier())}}]),n}(iq),_J=HG.ZERO,wJ=HG.ONE,kJ=HG.NONE,CJ=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(Ao||(Ao=xp(["Goal of the game"]))),$localize(No||(No=xp(["At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.\n        Here, Dark wins the game:\n        Dark's pieces are forming a single group, while Light's pieces form three groups."]))),new vJ([[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ],[wJ,kJ,kJ,kJ,_J,kJ,kJ,wJ],[kJ,kJ,_J,_J,wJ,kJ,kJ,kJ],[kJ,kJ,kJ,_J,kJ,kJ,kJ,kJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ]],0)),Eq.anyMove($localize(xo||(xo=xp(["Initial board and initial move"]))),$localize(Ro||(Ro=xp(["Here is the initial board.\n         Moves can be made orthogonally or diagonally.\n         The length of a move is equal to the number of pieces that are on the line of the move.\n         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>\n         You're playing Dark, make the first move!"]))),vJ.getInitialState(),gJ.of(new zG(1,7),new zG(1,5)).get(),$localize(Mo||(Mo=xp(["Congratulations!"])))),Eq.fromMove($localize(Do||(Do=xp(["Jumping"]))),$localize(Lo||(Lo=xp(["During a move, it is possible to jump above your own pieces.\n        But it is forbidden to jump over the opponent's pieces.<br/><br/>\n        You're playing Dark, make a jump over one of your pieces on the following board."]))),new vJ([[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ],[kJ,kJ,wJ,_J,_J,kJ,kJ,kJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,wJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,_J]],0),[gJ.of(new zG(3,1),new zG(6,1)).get()],$localize(Bo||(Bo=xp(["Congratulations!"]))),$localize(Fo||(Fo=xp(["Failed. You did not jump over one of your pieces."])))),Eq.fromMove($localize(jo||(jo=xp(["Moving"]))),$localize(Uo||(Uo=xp(["Here is a different board. Pick the dark piece in the middle (line 4, column 4)\n        and observe its possible moves.\n        Horizontally, this piece can move only of one square because it is the only piece on this line.\n        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.\n        But it can only go up, as below it the landing square is occupied by one of your pieces.\n        Diagonally, only one move is possible: on the diagonal that contains three pieces,\n        only in the direction where it does not jump over one of the opponent's pieces.\n        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>\n        Make one of these moves."]))),new vJ([[kJ,kJ,kJ,kJ,kJ,kJ,wJ,kJ],[kJ,kJ,kJ,kJ,kJ,_J,kJ,kJ],[kJ,kJ,kJ,kJ,wJ,kJ,kJ,kJ],[kJ,kJ,kJ,_J,kJ,kJ,kJ,kJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,wJ],[kJ,kJ,kJ,kJ,kJ,wJ,kJ,wJ],[kJ,kJ,kJ,_J,kJ,kJ,wJ,wJ],[kJ,kJ,kJ,_J,kJ,kJ,kJ,kJ]],0),[gJ.of(new zG(3,3),new zG(3,0)).get(),gJ.of(new zG(3,3),new zG(0,0)).get(),gJ.of(new zG(3,3),new zG(2,3)).get(),gJ.of(new zG(3,3),new zG(4,3)).get()],$localize(Vo||(Vo=xp(["Congratulations!"]))),$localize(zo||(zo=xp(["Failed. This was not one of the expected moves."])))),Eq.fromMove($localize(Ho||(Ho=xp(["Capturing"]))),$localize(Go||(Go=xp(["If a move ends on an opponent's pieces, this one is captured and removed from the board.\n        However, a move cannot end on one of the player's pieces.\n        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!\n        If a player has only one piece, that player wins the game.<br/><br/>\n        On the following board, try to capture one piece with Dark."]))),new vJ([[kJ,_J,kJ,_J,_J,_J,_J,kJ],[wJ,kJ,kJ,kJ,kJ,kJ,kJ,wJ],[kJ,kJ,_J,kJ,wJ,kJ,kJ,kJ],[wJ,kJ,kJ,kJ,kJ,kJ,kJ,wJ],[wJ,kJ,kJ,kJ,kJ,kJ,kJ,wJ],[wJ,kJ,kJ,kJ,kJ,kJ,kJ,wJ],[wJ,kJ,kJ,kJ,kJ,kJ,kJ,wJ],[kJ,_J,_J,_J,_J,_J,_J,kJ]],0),[gJ.of(new zG(2,2),new zG(4,2)).get()],$localize(qo||(qo=xp(["Congratulations!"]))),$localize(Wo||(Wo=xp(["Failed!"])))),Eq.fromMove($localize($o||($o=xp(["Tie"]))),$localize(Zo||(Zo=xp(["In the special case where a move ends up connecting all pieces of both player, simultaneously,\n        then the game ends up with a tie.<br/><br/>\n        You're playing Dark, force the tie in one move."]))),new vJ([[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ],[_J,kJ,kJ,_J,wJ,_J,kJ,kJ],[kJ,kJ,kJ,_J,kJ,kJ,kJ,wJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,wJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,wJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,wJ],[kJ,kJ,kJ,kJ,kJ,kJ,kJ,kJ]],0),[gJ.of(new zG(0,2),new zG(4,2)).get()],$localize(Qo||(Qo=xp(["Congratulations!"]))),$localize(Yo||(Yo=xp(["Failed!"]))))]};function EJ(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",5)),2&e){var n=Vp.fc().index,r=Vp.fc().index,i=Vp.fc();Vp.mc("ngClass",i.getPieceClasses(n,r)),Vp.Cb("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)}}function OJ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"g",2),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onClick(e,r)}),Vp.Mb(2,"rect",3),Vp.Ac(3,EJ,1,3,"circle",4),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc().index,a=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",i,"_",o,""),Vp.Bb(1),Vp.mc("ngClass",a.getSquareClasses(i,o)),Vp.Cb("x",i*a.SPACE_SIZE)("y",o*a.SPACE_SIZE)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",r!==a.EMPTY)}}function SJ(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,OJ,4,8,"g",1),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function PJ(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",6),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onClick(e.x,e.y)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.Bb(1),Vp.Cb("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}var IJ,TJ,AJ,NJ=((IJ=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.EMPTY=HG.NONE,r.targets=[],r.selected=kz.empty(),r.lastMove=kz.empty(),r.captured=kz.empty(),r.rules=new mJ(vJ),r.availableMinimaxes=[new bJ(r.rules,"LinesOfActionMinimax")],r.encoder=gJ.encoder,r.tutorial=(new CJ).tutorial,r.updateBoard(),r}return Kp(n,[{key:"onClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(o=new zG(e,t),!n.selected.isPresent()){r.next=9;break}if(n.getState().getPieceAt(o)!==n.getState().getCurrentPlayer()){r.next=7;break}return r.abrupt("return",n.select(o));case 7:return a=gJ.of(n.selected.get(),new zG(e,t)),r.abrupt("return",a.isSuccess()?n.chooseMove(a.get(),n.rules.node.gameState):n.cancelMove(yJ.INVALID_DIRECTION()));case 9:return r.abrupt("return",n.select(o));case 10:case"end":return r.stop()}},r)}))()}},{key:"select",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(nq.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=kz.of(e),t.targets=mJ.possibleTargets(t.rules.node.gameState,t.selected.get()),0===t.targets.length?t.cancelMove(yJ.PIECE_CANNOT_MOVE()):lz.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"updateBoard",value:function(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end)!==HG.NONE?kz.of(e.end):kz.empty()}}},{key:"cancelMoveAttempt",value:function(){this.selected=kz.empty(),this.targets=[]}},{key:"getSquareClasses",value:function(e,t){var n=new zG(e,t);if(this.lastMove.isPresent()){var r=this.lastMove.get().coord,i=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured"];if(n.equals(r)||n.equals(i))return["moved"]}return[]}},{key:"getPieceClasses",value:function(e,t){var n=this.board[t][e],r=new zG(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected"),i}}]),n}(dW)).\u0275fac=function(e){return new(e||IJ)(Vp.Lb(qG))},IJ.\u0275cmp=Vp.Fb({type:IJ,selectors:[["app-linesofaction"]],features:[Vp.yb],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["r","40","class","base",3,"ngClass",4,"ngIf"],["r","40",1,"base",3,"ngClass"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,SJ,2,1,"g",1),Vp.Ac(2,PJ,2,4,"g",1),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngForOf",t.targets))},directives:[vg,dg,yg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),IJ),xJ=Number.MAX_SAFE_INTEGER,RJ=Number.MIN_SAFE_INTEGER,MJ=((TJ=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,rq.copyBiArray(n.initialBoard),e)).turn=e,i.location=r,i}return Kp(n,null,[{key:"getInitialState",value:function(){return new n(0,new zG(0,0))}}]),n}(cq)).BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],TJ.BOARD_1=[[0,+xJ,-1,-1],[1,2,+xJ,-1],[+RJ,3,4,-1],[-1,+RJ,+RJ,-1]],TJ.BOARD_2=[[0,+xJ,-1,-1],[+xJ,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],TJ.BOARD_3=[[0,1,+RJ,-1],[1,+RJ,-1,-1],[+RJ,-1,-1,-1],[-1,-1,-1,-1]],TJ.BOARD_4=[[0,1,+RJ,-1],[1,+RJ,-1,-1],[+RJ,-1,-1,-1],[-1,-1,-1,1]],TJ.initialBoard=TJ.BOARD_0,TJ),DJ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=new zG(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new MJ(t.turn+1,r)}},{key:"isLegal",value:function(e,t){var n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?sz.failure("incorrect move"):sz.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getPieceAt(t.location);return n===HG.ZERO.getVictoryValue()?bq.ZERO_WON:n===HG.ONE.getVictoryValue()?bq.ONE_WON:t.location.equals(new zG(3,3))?0===n?bq.DRAW:n>0?bq.ONE_WON:bq.ZERO_WON:bq.ONGOING}}]),n}(_q),LJ=((AJ=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this)).right=e,r}return Kp(n,[{key:"equals",value:function(e){return this===e||this.right===e.right}},{key:"toString",value:function(){return this.right?"Move RIGHT":"Move DOWN"}}]),n}(hq)).RIGHT=new AJ(!0),AJ.DOWN=new AJ(!1),AJ.encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 1}},{key:"decodeNumber",value:function(e){return 0===e?AJ.RIGHT:AJ.DOWN}},{key:"encodeNumber",value:function(e){return e.right?0:1}}]),n}(wz)),AJ),BJ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getBoardValue",value:function(e){var t=DJ.getGameStatus(e);if(t.isEndGame)return new oq(t.toBoardValue());var n=e.gameState;return new oq(n.getPieceAt(n.location))}},{key:"getListMoves",value:function(e){var t=[],n=e.gameState;return n.location.x<3&&t.push(LJ.RIGHT),n.location.y<3&&t.push(LJ.DOWN),t}}]),n}(iq);function FJ(e,t){1&e&&(Vp.Ob(0),Vp.Cc(1,"("),Vp.Nb())}function jJ(e,t){1&e&&(Vp.Ob(0),Vp.Cc(1,")"),Vp.Nb())}function UJ(e,t){if(1&e&&(Vp.Qb(0,"td"),Vp.Ac(1,FJ,2,0,"ng-container",3),Vp.Cc(2),Vp.Ac(3,jJ,2,0,"ng-container",3),Vp.Pb()),2&e){var n=t.$implicit,r=t.index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",o.coord.x===r&&o.coord.y===i),Vp.Bb(1),Vp.Ec(" ",n," "),Vp.Bb(1),Vp.mc("ngIf",o.coord.x===r&&o.coord.y===i)}}function VJ(e,t){if(1&e&&(Vp.Qb(0,"tr"),Vp.Ac(1,UJ,4,3,"td",0),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}var zJ,HJ,GJ,qJ=((zJ=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).coord=new zG(-1,-1),r.rules=new DJ(MJ),r.availableMinimaxes=[new BJ(r.rules,"MinimaxTestingMinimax")],r.encoder=LJ.encoder,r}return Kp(n,[{key:"chooseRight",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_right"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(LJ.RIGHT,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"chooseDown",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_down"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(LJ.DOWN,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.coord=e.location}}]),n}(dW)).\u0275fac=function(e){return new(e||zJ)(Vp.Lb(qG))},zJ.\u0275cmp=Vp.Fb({type:zJ,selectors:[["app-minimax-testing"]],features:[Vp.yb],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(Vp.Qb(0,"table"),Vp.Ac(1,VJ,2,1,"tr",0),Vp.Qb(2,"div",1),Vp.cc("click",function(){return t.chooseRight()}),Vp.Cc(3," goRight "),Vp.Pb(),Vp.Qb(4,"div",2),Vp.cc("click",function(){return t.chooseDown()}),Vp.Cc(5," goDown "),Vp.Pb(),Vp.Qb(6,"div"),Vp.Cc(7),Vp.Pb(),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",t.board),Vp.Bb(6),Vp.Ec(" ",t.coord," "))},directives:[vg,yg],encapsulation:2}),zJ),WJ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,null,[{key:"getInitialState",value:function(){return new n(rq.createTable(7,6,HG.NONE),0)}}]),n}(cq),$J=((GJ=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this)).x=e,r}return Kp(n,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"P4Move("+this.x+")"}}],[{key:"of",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;case 5:return n.FIVE;case 6:return n.SIX;default:throw new Error("Invalid P4Move")}}}]),n}(hq)).ZERO=new GJ(0),GJ.ONE=new GJ(1),GJ.TWO=new GJ(2),GJ.THREE=new GJ(3),GJ.FOUR=new GJ(4),GJ.FIVE=new GJ(5),GJ.SIX=new GJ(6),GJ.encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 6}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return GJ.of(e)}}]),n}(wz)),GJ),ZJ=function(){var e=function e(){Qp(this,e)};return e.COLUMN_IS_FULL=function(){return $localize(Ko||(Ko=xp(["Please put your piece in an incomplete column."])))},e}(),QJ=((HJ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,r){var i=e.x,o=t.getCopiedBoard(),a=n.getLowestUnoccupiedCase(o,i),s=t.turn;return o[a][i]=t.getCurrentPlayer(),new WJ(o,s+1)}},{key:"isLegal",value:function(e,t){return pz(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:t}),t.getPieceAtXY(e.x,0)!==HG.NONE?sz.failure(ZJ.COLUMN_IS_FULL()):sz.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,r=0;r<7;r++)for(var i=5;-1!==i&&t.board[i][r]!==HG.NONE;i--){var o=n.getSquareScore(t.board,new zG(r,i));if(mq.getScoreStatus(o)===pq.VICTORY)return bq.getVictory(t.getCurrentOpponent())}return 42===t.turn?bq.DRAW:bq.ONGOING}}],[{key:"getVictoriousCoords",value:function(e){for(var t=[],r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r]!==HG.NONE;i--){var o=n.getSquareScore(e.board,new zG(r,i));o!==HG.ZERO.getVictoryValue()&&o!==HG.ONE.getVictoryValue()||t.push(new zG(r,i))}return t}},{key:"getBoardValueFromScratch",value:function(e){pz(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});for(var t=0,r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r]!==HG.NONE;i--){var o=n.getSquareScore(e.board,new zG(r,i));if(mq.getScoreStatus(o)!==pq.DEFAULT)return pz(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:o,coord:{x:r,y:i}}}),new oq(o);t+=o}return new oq(t)}},{key:"getLowestUnoccupiedCase",value:function(e,t){for(var n=0;n<6&&e[n][t]===HG.NONE;)n++;return n-1}},{key:"getNumberOfFreeSpacesAndAllies",value:function(e,t,n,r,i){for(var o=0,a=0,s=!0,u=new zG(t.x+n.x,t.y+n.y);u.isInRange(7,6)&&3!==o;){var c=e[u.y][u.x];if(c===r)return[o,a];c===i&&s?a++:s=!1,c!==r&&c!==i&&o++,u=u.getNext(n)}return[o,a]}},{key:"getOpponent",value:function(e,t){var n=e[t.y][t.x];return vz(n!==HG.NONE,"getOpponent should not be called with Player.NONE"),n===HG.ONE?HG.ZERO:HG.ONE}},{key:"getSquareScore",value:function(e,t){pz(n.VERBOSE,"getSquareScore(board, "+t.x+", "+t.y+") called"),pz(n.VERBOSE,e),vz(e[t.y][t.x]!==HG.NONE,"getSquareScore should not be called on an empty space");var r,i=0,o=n.getOpponent(e,t),a=e[t.y][t.x],s=new vq,u=new vq,c=zp(jG.DIRECTIONS);try{for(c.s();!(r=c.n()).done;){var l=r.value,h=n.getNumberOfFreeSpacesAndAllies(e,t,l,o,a);s.set(l,h[0]),u.set(l,h[1])}}catch(y){c.e(y)}finally{c.f()}for(var f=0,d=[jG.UP,jG.UP_RIGHT,jG.RIGHT,jG.DOWN_RIGHT];f<d.length;f++){var p=d[f],v=u.get(p).get()+u.get(p.getOpposite()).get();if(v>2)return pz(n.VERBOSE,{text:"there is some kind of victory here ("+t.x+", "+t.y+")\nline allies : "+v+"\n",board:e}),a.getVictoryValue();var g=s.get(p).get()+s.get(p.getOpposite()).get();3===g?i+=2:g>3&&(i+=g-2)}return i*a.getScoreModifier()}},{key:"getListMoves",value:function(e){pz(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});for(var t=e.gameState,r=[],i=0;i<7;i++)if(t.getPieceAtXY(i,0)===HG.NONE){var o=$J.of(i);r.push(o)}return r}},{key:"getBoardValue",value:function(e){return pz(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}}]),n}(_q)).VERBOSE=!1,HJ),YJ=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){return QJ.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=e.gameState;return pz(QJ.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),QJ.getBoardValue(t)}}]),n}(iq),KJ=HG.ZERO,JJ=HG.ONE,XJ=HG.NONE,eX=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(Jo||(Jo=xp(["Goal of the game"]))),$localize(Xo||(Xo=xp(["The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.\n        The first player plays Dark, the second plays Light.\n        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally)."]))),WJ.getInitialState()),Eq.anyMove($localize(ea||(ea=xp(["Dropping a piece"]))),$localize(ta||(ta=xp(["Click on any space in any column."]))),WJ.getInitialState(),$J.THREE,$localize(na||(na=xp(["As you can see, the piece falls at the bottom of the column."])))),Eq.fromMove($localize(ra||(ra=xp(["Victory"]))),$localize(ia||(ia=xp(["You're playing Dark.\n        Place your piece so that you create a horizontal alignment of 4 of your pieces."]))),new WJ([[XJ,XJ,XJ,XJ,XJ,XJ,XJ],[XJ,XJ,XJ,XJ,XJ,XJ,XJ],[XJ,XJ,XJ,XJ,XJ,XJ,XJ],[XJ,XJ,XJ,JJ,XJ,XJ,XJ],[XJ,XJ,XJ,JJ,XJ,XJ,XJ],[XJ,XJ,KJ,KJ,KJ,JJ,XJ]],0),[$J.of(1)],$localize(oa||(oa=xp(["You won!"]))),$localize(aa||(aa=xp(["Failed, you have not aligned 4 pieces and missed an opportunity to win."])))),Eq.fromMove($localize(sa||(sa=xp(["Other victory"]))),$localize(ua||(ua=xp(["You can also align 4 pieces diagonally or vertically."]))),new WJ([[XJ,XJ,XJ,XJ,XJ,XJ,XJ],[XJ,XJ,XJ,XJ,XJ,XJ,XJ],[XJ,XJ,XJ,XJ,XJ,XJ,XJ],[XJ,XJ,XJ,KJ,JJ,XJ,XJ],[XJ,XJ,KJ,KJ,JJ,XJ,XJ],[XJ,KJ,JJ,KJ,KJ,XJ,XJ]],0),[$J.of(3),$J.of(4)],$localize(ca||(ca=xp(["You won!"]))),$localize(la||(la=xp(["Failed, you have not aligned 4 pieces and missed an opportunity to win."]))))]};function tX(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",6)),2&e){var n=Vp.fc().index,r=Vp.fc().index,i=Vp.fc();Vp.mc("ngClass",i.getSquareFillClass(n,r)),Vp.Cb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function nX(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",4),Vp.cc("click",function(){Vp.wc(n);var e=t.index;return Vp.fc(2).onClick(e)}),Vp.Pb(),Vp.Ac(2,tX,1,4,"circle",5),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc().index,a=Vp.fc();Vp.Bb(1),Vp.nc("id","click_",i,""),Vp.Cb("x",a.SPACE_SIZE*i)("y",a.SPACE_SIZE*o)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",r!=a.EMPTY_CASE)}}function rX(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,nX,3,6,"g",1),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function iX(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"rect",7)),2&e){var n=Vp.fc();Vp.Cb("x",n.SPACE_SIZE*n.last.get().x)("y",n.SPACE_SIZE*n.last.get().y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function oX(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"rect",8)),2&e){var n=t.$implicit,r=Vp.fc();Vp.oc("id","victory_coord_",n.x,"_",n.y,""),Vp.Cb("x",r.SPACE_SIZE*n.x)("y",r.SPACE_SIZE*n.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}var aX,sX,uX,cX,lX,hX=((lX=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).EMPTY_CASE=HG.NONE,r.victoryCoords=[],r.rules=new QJ(WJ),r.availableMinimaxes=[new YJ(r.rules,"P4Minimax")],r.encoder=$J.encoder,r.tutorial=(new eX).tutorial,r.updateBoard(),r}return Kp(n,[{key:"onClick",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=$J.of(e),n.next=6,t.chooseMove(i,t.rules.node.gameState);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.victoryCoords=QJ.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move,t=QJ.getLowestUnoccupiedCase(this.rules.node.gameState.board,e.get().x)+1;this.last=kz.of(new zG(e.get().x,t))}},{key:"hideLastMove",value:function(){this.last=kz.empty()}},{key:"getSquareFillClass",value:function(e,t){return[this.getPlayerClass(this.board[t][e])]}}]),n}(dW)).VERBOSE=!1,lX.\u0275fac=function(e){return new(e||lX)(Vp.Lb(qG))},lX.\u0275cmp=Vp.Fb({type:lX,selectors:[["app-p4"]],features:[Vp.yb],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[1,"base",3,"id","click"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,rX,2,1,"g",1),Vp.Ac(2,iX,1,4,"rect",2),Vp.Ac(3,oX,1,6,"rect",3),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngIf",t.last.isPresent()),Vp.Bb(1),Vp.mc("ngForOf",t.victoryCoords))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),lX),fX=((cX=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Qp(this,n),(o=t.call(this,e,r)).blockTurned=i,o.turnedClockwise=a,o.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+o.coord.toString());return tv(o)}return Kp(n,[{key:"toString",value:function(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}],[{key:"withRotation",value:function(e,t,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new n(e,t,kz.of(r),i)}},{key:"rotationless",value:function(e,t){return new n(e,t,kz.empty())}}]),n}(fq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"encodeMove",value:function(e){var t={coord:zG.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}},{key:"decodeMove",value:function(e){var t=e,n=zG.encoder.decode(t.coord),r=kz.ofNullable(t.blockTurned);if(r.isPresent()){var i=t.turnedClockwise;return cX.withRotation(n.x,n.y,r.get(),i)}return cX.rotationless(n.x,n.y)}}]),n}(_z)),cX),dX=function(){var e=function e(){Qp(this,e)};return e.CANNOT_ROTATE_NEUTRAL_BLOCK=function(){return $localize(ha||(ha=xp(["If the quadrant to turn is neutral, please just use move without rotation."])))},e.MUST_CHOOSE_BLOCK_TO_ROTATE=function(){return $localize(fa||(fa=xp(["No quadrant is neutral, you must pick a quadrant to rotate."])))},e}(),pX=((uX=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e,r)).neutralBlocks=i.getBlocksNeutralities(),i}return Kp(n,[{key:"getBlocksNeutralities",value:function(){for(var e=[],t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}},{key:"getBlockNeutrality",value:function(e){var t=n.getBlockCenter(e),r=this.getPieceAt(t.getNext(jG.UP,1)),i=this.getPieceAt(t.getNext(jG.UP_LEFT,1));return this.getPieceAt(t.getNext(jG.RIGHT,1))===r&&this.getPieceAt(t.getNext(jG.DOWN,1))===r&&this.getPieceAt(t.getNext(jG.LEFT,1))===r&&this.getPieceAt(t.getNext(jG.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(jG.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(jG.DOWN_LEFT,1))===i}},{key:"applyLegalDrop",value:function(e){var t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new n(t,this.turn)}},{key:"applyLegalMove",value:function(e){var t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){var i=n.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise){var o,a=zp(n.ROTATION_MAP);try{for(a.s();!(o=a.n()).done;){var s=o.value,u=s[0].getNext(i),c=s[1].getNext(i),l=t.getPieceAt(u);r[c.y][c.x]=l}}catch(y){a.e(y)}finally{a.f()}}else{var h,f=zp(n.ROTATION_MAP);try{for(f.s();!(h=f.n()).done;){var d=h.value,p=d[1].getNext(i),v=d[0].getNext(i),g=t.getPieceAt(p);r[v.y][v.x]=g}}catch(y){f.e(y)}finally{f.f()}}}return new n(r,this.turn+1)}},{key:"blockIsNeutral",value:function(e){return this.neutralBlocks.includes(e)}}],[{key:"getInitialState",value:function(){return new n(rq.createTable(6,6,HG.NONE),0)}},{key:"getBlockCenter",value:function(e){return new zG(1+(e%2==0?0:3),1+(e<2?0:3))}}]),n}(cq)).ROTATION_MAP=[[new zG(-1,-1),new zG(1,-1)],[new zG(0,-1),new zG(1,0)],[new zG(1,-1),new zG(1,1)],[new zG(1,0),new zG(0,1)],[new zG(1,1),new zG(-1,1)],[new zG(0,1),new zG(-1,0)],[new zG(-1,1),new zG(-1,-1)],[new zG(-1,0),new zG(0,-1)]],uX),vX=((sX=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord)!==HG.NONE)return sz.failure(nq.MUST_LAND_ON_EMPTY_SPACE());var n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return sz.failure(dX.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){var r=e.blockTurned.get();if(n.neutralBlocks.includes(r))return sz.failure(dX.CANNOT_ROTATE_NEUTRAL_BLOCK())}return sz.success(void 0)}},{key:"getVictoryCoords",value:function(e){var t,r=[],i=zp(n.VICTORY_SOURCE);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=e.getPieceAt(o[0]),s=[o[0]];if(a!==HG.NONE){for(var u=o[0].getNext(o[1]),c=!0,l=0;l<3&&c;l++)e.getPieceAt(u)!==a?c=!1:(s.push(u),u=u.getNext(o[1]));if(c&&(e.getPieceAt(u)===a&&(s.push(u),r=r.concat(s)),o[2])){var h=o[0].getPrevious(o[1],1);e.getPieceAt(h)===a&&(s.push(h),r=r.concat(s))}}}}catch(f){i.e(f)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1],i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?bq.DRAW:bq.ZERO_WON:!0===r[1]?bq.ONE_WON:36===t.turn?bq.DRAW:bq.ONGOING}}],[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n(pX)),mq.ruler=this.singleton,this.singleton}}]),n}(_q)).VICTORY_SOURCE=[[new zG(1,0),new DG(1,1),!1],[new zG(0,1),new DG(1,1),!1],[new zG(4,0),new DG(-1,1),!1],[new zG(5,1),new DG(-1,1),!1],[new zG(1,1),new DG(1,1),!0],[new zG(4,1),new DG(-1,1),!0],[new zG(0,1),new DG(0,1),!0],[new zG(1,1),new DG(0,1),!0],[new zG(2,1),new DG(0,1),!0],[new zG(3,1),new DG(0,1),!0],[new zG(4,1),new DG(0,1),!0],[new zG(5,1),new DG(0,1),!0],[new zG(1,0),new DG(1,0),!0],[new zG(1,1),new DG(1,0),!0],[new zG(1,2),new DG(1,0),!0],[new zG(1,3),new DG(1,0),!0],[new zG(1,4),new DG(1,0),!0],[new zG(1,5),new DG(1,0),!0]],sX),gX=((aX=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return n.FIRST_TURN_MOVES;var i,o=zp(this.getLegalDrops(e.gameState));try{for(o.s();!(i=o.n()).done;){var a,s=i.value,u=fX.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(u),l=zp(this.getLegalRotations(c,r));try{for(l.s();!(a=l.n()).done;){var h=a.value;t.push(fX.withRotation(s.x,s.y,h[0],h[1]))}}catch(f){l.e(f)}finally{l.f()}0==(0===c.neutralBlocks.length)&&t.push(u)}}catch(f){o.e(f)}finally{o.f()}return t}},{key:"getLegalDrops",value:function(e){for(var t=[],n=0;n<6;n++)for(var r=0;r<6;r++){var i=new zG(r,n);e.getPieceAt(i)===HG.NONE&&t.push(i)}return t}},{key:"getLegalRotations",value:function(e,t){for(var n=0===e.neutralBlocks.length,r=[],i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}},{key:"getBoardValue",value:function(e){return new oq(vX.get().getGameStatus(e).toBoardValue())}}]),n}(iq)).FIRST_TURN_MOVES=[fX.rotationless(0,0),fX.rotationless(1,0),fX.rotationless(2,0),fX.rotationless(0,1),fX.rotationless(1,1),fX.rotationless(0,2)],aX),yX=HG.NONE,mX=HG.ONE,bX=HG.ZERO,_X=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(da||(da=xp(["Initial board"]))),$localize(pa||(pa=xp(["The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate."]))),pX.getInitialState()),Eq.informational($localize(va||(va=xp(["Goal of the game"]))),$localize(ga||(ga=xp(["The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins."]))),new pX([[bX,yX,yX,bX,mX,yX],[bX,mX,yX,yX,yX,yX],[bX,yX,mX,yX,yX,yX],[bX,yX,yX,yX,yX,mX],[bX,yX,yX,yX,mX,yX],[yX,yX,yX,yX,yX,yX]],10)).withPreviousMove(fX.withRotation(0,0,0,!1)),Eq.fromPredicate($localize(ya||(ya=xp(["Simple move"]))),$localize(ma||(ma=xp(["At their turn, players put a piece on the board and possibly rotate one quadrant.\n        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.\n        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>\n        Do it."]))),new pX([[yX,yX,yX,yX,yX,yX],[yX,bX,yX,yX,mX,yX],[yX,yX,yX,yX,yX,yX],[yX,yX,yX,yX,yX,yX],[yX,mX,yX,yX,bX,yX],[yX,yX,yX,yX,yX,yX]],10),fX.rotationless(2,2),function(e,t){return e.blockTurned.isPresent()?lz.failure($localize(ba||(ba=xp(["You have made a move with a rotation. This tutorial step is about moves without rotations!"])))):lz.SUCCESS},$localize(_a||(_a=xp(["Congratulations!"])))),Eq.fromPredicate($localize(wa||(wa=xp(["Move with rotation"]))),$localize(ka||(ka=xp(["After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>\n        Click on one of them and see the rotation!"]))),new pX([[yX,yX,yX,yX,yX,yX],[yX,bX,yX,yX,mX,yX],[yX,yX,yX,yX,yX,yX],[yX,yX,yX,yX,yX,yX],[yX,mX,yX,yX,bX,yX],[yX,yX,yX,yX,yX,yX]],10),fX.withRotation(0,0,0,!0),function(e,t){return e.blockTurned.isPresent()?lz.SUCCESS:lz.failure($localize(Ca||(Ca=xp(["You made a move without rotation, try again!"]))))},$localize(Ea||(Ea=xp(["Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation."]))))]};function wX(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Ob(0),Vp.Qb(1,"circle",9),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit,r=Vp.fc().$implicit,i=Vp.fc().index,o=Vp.fc().index;return Vp.fc().onClick(3*i+e,3*o+r)}),Vp.Pb(),Vp.Nb()}if(2&e){var r=t.$implicit,i=Vp.fc().$implicit,o=Vp.fc(),a=o.index,s=o.$implicit,u=Vp.fc(),c=u.index,l=u.$implicit,h=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",3*a+r,"_",3*c+i,""),Vp.mc("ngClass",h.getSquareClasses(3*a+r,3*c+i)),Vp.Cb("cx",s+2*h.STROKE_WIDTH+(r+.5)*h.SPACE_SIZE)("cy",l+2*h.STROKE_WIDTH+(i+.5)*h.SPACE_SIZE)("r",(h.SPACE_SIZE-h.STROKE_WIDTH)/2)}}var kX=function(){return[0,1,2]};function CX(e,t){1&e&&(Vp.ec(),Vp.Ob(0),Vp.Ac(1,wX,2,6,"ng-container",3),Vp.Nb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",Vp.qc(1,kX)))}function EX(e,t){if(1&e&&(Vp.ec(),Vp.Ob(0),Vp.Mb(1,"rect",8),Vp.Ac(2,CX,2,2,"ng-container",3),Vp.Nb()),2&e){var n=t.$implicit,r=t.index,i=Vp.fc(),o=i.index,a=i.$implicit,s=Vp.fc();Vp.Bb(1),Vp.mc("ngClass",s.getBlockClasses(r,o)),Vp.Cb("x",s.STROKE_WIDTH+n)("y",s.STROKE_WIDTH+a)("rx",3*s.STROKE_WIDTH)("ry",3*s.STROKE_WIDTH)("width",s.BLOCK_WIDTH)("height",s.BLOCK_WIDTH),Vp.Bb(1),Vp.mc("ngForOf",Vp.qc(8,kX))}}var OX=function(e){return[0,e]};function SX(e,t){if(1&e&&(Vp.ec(),Vp.Ob(0),Vp.Ac(1,EX,3,9,"ng-container",3),Vp.Nb()),2&e){var n=Vp.fc();Vp.Bb(1),Vp.mc("ngForOf",Vp.rc(1,OX,n.BLOCK_SEPARATION))}}function PX(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",10)),2&e){var n=Vp.fc();Vp.oc("id","currentDrop_",n.currentDrop.get().x,"_",n.currentDrop.get().y,""),Vp.mc("ngClass",n.getPlayerClass(n.rules.node.gameState.getCurrentPlayer())),Vp.Cb("cx",n.getCenter(n.currentDrop.get().x))("cy",n.getCenter(n.currentDrop.get().y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)}}function IX(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"path",11),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().rotate(e)}),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.oc("id","rotate_",r[1],"_",r[2]?"clockwise":"counterclockwise",""),Vp.Cb("d",r[0])("stroke-width",2*i.STROKE_WIDTH)}}function TX(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",12)),2&e){var n=t.$implicit,r=Vp.fc();Vp.oc("id","victoryCoord_",n.x,"_",n.y,""),Vp.mc("ngClass",r.getSquareClasses(n.x,n.y)),Vp.Cb("cx",r.getCenter(n.x))("cy",r.getCenter(n.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function AX(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g",13),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().skipRotation()}),Vp.Mb(1,"circle",14),Vp.Mb(2,"line",15),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.Bb(1),Vp.Cb("cx",r.BLOCK_SEPARATION)("cy",r.BLOCK_SEPARATION)("r",.75*r.SPACE_SIZE)("stroke-width",2*r.STROKE_WIDTH),Vp.Bb(1),Vp.Cb("x1",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("y1",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("x2",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("y2",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("stroke-width",2*r.STROKE_WIDTH)}}var NX,xX,RX=((NX=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).arrows=[],r.victoryCoords=[],r.rules=new vX(pX),r.availableMinimaxes=[new gX(r.rules,"PentagoMinimax")],r.encoder=fX.encoder,r.tutorial=(new _X).tutorial,r.BLOCK_WIDTH=3*r.SPACE_SIZE+2*r.STROKE_WIDTH,r.BLOCK_SEPARATION=r.BLOCK_WIDTH+2*r.STROKE_WIDTH,r.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*r.SPACE_SIZE,r.ARROWS=r.generateArrowsCoord(),r.updateBoard(),r}return Kp(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.rules.node.gameState),this.showLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{var t=e.get();this.movedBlock=t.blockTurned;var n=new zG(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new zG(0,0))&&this.coordBelongToBlock(t)){var r;r=t.turnedClockwise?dz.getNonNullable(pX.ROTATION_MAP.find(function(e){return e[0].equals(n)}))[1]:dz.getNonNullable(pX.ROTATION_MAP.find(function(e){return e[1].equals(n)}))[0];var i=t.blockTurned.get();r=r.getNext(new DG(i%2==0?1:4,i<2?1:4),1),this.lastDrop=kz.of(r)}else this.lastDrop=kz.of(t.coord)}}},{key:"coordBelongToBlock",value:function(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}},{key:"hidePreviousMove",value:function(){this.lastDrop=kz.empty(),this.movedBlock=kz.empty(),this.victoryCoords=[]}},{key:"generateArrowsCoord",value:function(){var e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}},{key:"cancelMoveAttempt",value:function(){this.arrows=[],this.currentDrop=kz.empty(),this.canSkipRotation=!1}},{key:"onClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.board[t][e]===HG.NONE){r.next=5;break}return r.abrupt("return",n.cancelMove(nq.MUST_LAND_ON_EMPTY_SPACE()));case 5:if(o=fX.rotationless(e,t),a=n.rules.node.gameState,4!==(s=a.applyLegalDrop(o)).neutralBlocks.length){r.next=8;break}return r.abrupt("return",n.chooseMove(o,a));case 8:return u=n.rules.getGameStatus(n.rules.node),r.abrupt("return",(n.canSkipRotation=s.neutralBlocks.length>0&&!1===u.isEndGame,n.currentDrop=kz.of(new zG(e,t)),n.displayArrows(s.neutralBlocks),lz.SUCCESS));case 10:case"end":return r.stop()}},r)}))()}},{key:"getCenter",value:function(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}},{key:"displayArrows",value:function(e){var t=this;this.arrows=[];for(var n=function(n){if(!1===e.includes(n)){var r=t.ARROWS.filter(function(e){return e[1]===n});t.arrows=t.arrows.concat(r)}},r=0;r<4;r++)n(r)}},{key:"getBlockClasses",value:function(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved"]:[]}},{key:"getSquareClasses",value:function(e,t){var n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new zG(e,t))&&n.push("last-move"),n}},{key:"rotate",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"))).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=t.currentDrop.get(),o=fX.withRotation(i.x,i.y,e[1],e[2]),n.abrupt("return",t.chooseMove(o,t.rules.node.gameState));case 5:case"end":return n.stop()}},n)}))()}},{key:"skipRotation",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.canUserPlay("#skipRotation")).isFailure()){t.next=3;break}return t.abrupt("return",e.cancelMove(n.getReason()));case 3:return r=e.currentDrop.get(),i=fX.rotationless(r.x,r.y),t.abrupt("return",e.chooseMove(i,e.rules.node.gameState));case 5:case"end":return t.stop()}},t)}))()}}]),n}(dW)).\u0275fac=function(e){return new(e||NX)(Vp.Lb(qG))},NX.\u0275cmp=Vp.Fb({type:NX,selectors:[["app-pentago"]],features:[Vp.yb],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Qb(1,"defs"),Vp.Qb(2,"marker",1),Vp.Mb(3,"polygon",2),Vp.Pb(),Vp.Pb(),Vp.Ac(4,SX,2,3,"ng-container",3),Vp.Ac(5,PX,1,6,"circle",4),Vp.Ac(6,IX,1,4,"path",5),Vp.Ac(7,TX,1,7,"circle",6),Vp.Ac(8,AX,3,9,"g",7),Vp.Pb()),2&e&&(Vp.Bb(4),Vp.mc("ngForOf",Vp.rc(5,OX,t.BLOCK_SEPARATION)),Vp.Bb(1),Vp.mc("ngIf",t.currentDrop.isPresent()),Vp.Bb(1),Vp.mc("ngForOf",t.arrows),Vp.Bb(1),Vp.mc("ngForOf",t.victoryCoords),Vp.Bb(1),Vp.mc("ngIf",t.canSkipRotation))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),NX),MX=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;if(Qp(this,n),(o=t.call(this,e,r)).z=i,e<0||e>3)throw new Error("PylosCoord: Invalid X: ".concat(e,"."));if(r<0||r>3)throw new Error("PylosCoord: Invalid Y: ".concat(r,"."));if(i<0||i>3)throw new Error("PylosCoord: Invalid Z: ".concat(i,"."));var a=4-i;if(o.isNotInRange(a,a))throw new Error(o.toString()+" is not in range.");return tv(o)}return Kp(n,[{key:"toString",value:function(){return"PylosCoord"+this.toShortString()}},{key:"toShortString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"isUpperThan",value:function(e){return this.z>e.z}},{key:"getLowerPieces",value:function(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");var e=this.z-1;return[new n(this.x,this.y,e),new n(this.x+1,this.y,e),new n(this.x,this.y+1,e),new n(this.x+1,this.y+1,e)]}},{key:"getHigherPieces",value:function(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");var e=this.z+1,t=new zG(this.x-1,this.y-1),r=new zG(this.x,this.y-1),i=new zG(this.x-1,this.y),o=new zG(this.x,this.y),a=4-e;return[t,r,i,o].filter(function(e){return e.isInRange(a,a)}).map(function(t){return new n(t.x,t.y,e)})}},{key:"getNextValid",value:function(e){var t=new zG(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?kz.empty():kz.of(new n(t.x,t.y,this.z))}}],[{key:"encodeOptional",value:function(e){return e.isPresent()?n.encode(e.get())+1:0}},{key:"encode",value:function(e){return 16*e.x+4*e.y+e.z}},{key:"decodeToOptional",value:function(e){return 0===e?kz.empty():kz.of(n.decode(e-1))}},{key:"decode",value:function(e){var t=e%4;e-=t;var r=(e/=4)%4;return e-=r,new n(e/=4,r,t)}}]),n}(zG),DX=((xX=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this)).startingCoord=e,a.landingCoord=r,a.firstCapture=i,a.secondCapture=o,a}return Kp(n,[{key:"isClimb",value:function(){return this.startingCoord.isPresent()}},{key:"toString",value:function(){var e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}},{key:"equals",value:function(e){return e===this||!!this.startingCoord.equals(e.startingCoord)&&!!this.landingCoord.equals(e.landingCoord)&&!!this.firstCapture.equals(e.firstCapture)&&!!this.secondCapture.equals(e.secondCapture)}}],[{key:"fromClimb",value:function(e,t,r){var i=kz.of(e),o=n.checkCaptures(r),a=new n(i,t,o.firstCapture,o.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return a}},{key:"checkCaptures",value:function(e){var t=kz.empty(),n=kz.empty();if(e.length>0&&(t=kz.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=kz.of(e[1]),e[1].isUpperThan(e[0])&&(t=kz.of(e[1]),n=kz.of(e[0])),e.length>2)throw new Error("PylosMove: can't capture that much piece.")}return{firstCapture:t,secondCapture:n}}},{key:"fromDrop",value:function(e,t){var r=kz.empty(),i=n.checkCaptures(t);return new n(r,e,i.firstCapture,i.secondCapture)}},{key:"changeCapture",value:function(e,t){var r=n.checkCaptures(t);return new n(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}}]),n}(hq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 17575999}},{key:"encodeNumber",value:function(e){var t=MX.encode(e.landingCoord),n=MX.encodeOptional(e.startingCoord),r=MX.encodeOptional(e.firstCapture);return 270400*MX.encodeOptional(e.secondCapture)+4160*r+64*n+t}},{key:"decodeNumber",value:function(e){var t=MX.decode(e%64);e-=e%64;var n=MX.decodeToOptional((e/=64)%65);e-=e%65;var r=MX.decodeToOptional((e/=65)%65);e-=e%65;var i=MX.decodeToOptional(e/=65);return new xX(n,t,r,i)}}]),n}(wz)),xX),LX=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,r)).boards=e,i}return Kp(n,[{key:"getPieceAt",value:function(e){return this.boards[e.z][e.y][e.x]}},{key:"applyLegalMove",value:function(e){var t=[];return t.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&t.push({coord:e.startingCoord.get(),value:HG.NONE}),e.firstCapture.isPresent()&&t.push({coord:e.firstCapture.get(),value:HG.NONE}),e.secondCapture.isPresent()&&t.push({coord:e.secondCapture.get(),value:HG.NONE}),this.setBoardAts(t,this.turn+1)}},{key:"setBoardAts",value:function(e,t){var r,i=[rq.copyBiArray(this.boards[0]),rq.copyBiArray(this.boards[1]),rq.copyBiArray(this.boards[2]),rq.copyBiArray(this.boards[3])],o=zp(e);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=a.coord;i[s.z][s.y][s.x]=a.value}}catch(u){o.e(u)}finally{o.f()}return new n(i,t)}},{key:"isLandable",value:function(e){if(this.getPieceAt(e)!==HG.NONE)return!1;if(0===e.z)return!0;var t,n=zp(e.getLowerPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)===HG.NONE)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"isSupporting",value:function(e){if(3===e.z)return!1;var t,n=zp(e.getHigherPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)!==HG.NONE)return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getPiecesRepartition",value:function(){var e={};e[HG.NONE.value]=0,e[HG.ZERO.value]=0,e[HG.ONE.value]=0;for(var t=0;t<3;t++)for(var n=0;n<4-t;n++)for(var r=0;r<4-t;r++){var i=new MX(r,n,t),o=this.getPieceAt(i);e[o.value]=1+e[o.value]}return e}}],[{key:"getInitialState",value:function(){return new n([rq.createTable(4,4,HG.NONE),rq.createTable(3,3,HG.NONE),rq.createTable(2,2,HG.NONE),[[HG.NONE]]],0)}}]),n}(uq),BX=function(){var e=function e(){Qp(this,e)};return e.MUST_MOVE_UPWARD=function(){return $localize(Oa||(Oa=xp(["You must move your pieces upward."])))},e.SHOULD_HAVE_SUPPORTING_PIECES=function(){return $localize(Sa||(Sa=xp(["Your piece must land on the board or on 4 other pieces."])))},e.CANNOT_LAND=function(){return $localize(Pa||(Pa=xp(["You cannot land on this space."])))},e.CANNOT_CAPTURE=function(){return $localize(Ia||(Ia=xp(["You cannot capture."])))},e.INVALID_FIRST_CAPTURE=function(){return $localize(Ta||(Ta=xp(["Your first capture is invalid."])))},e.INVALID_SECOND_CAPTURE=function(){return $localize(Aa||(Aa=xp(["Your second capture is invalid."])))},e}(),FX=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.landingCoord)!==HG.NONE)return sz.failure(nq.MUST_LAND_ON_EMPTY_SPACE());var r=t.getCurrentOpponent();if(e.startingCoord.isPresent()){var i=e.startingCoord.get(),o=t.getPieceAt(i);if(o===r)return sz.failure(nq.CANNOT_CHOOSE_OPPONENT_PIECE());if(o===HG.NONE)return sz.failure(nq.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i.getHigherPieces().filter(function(n){return t.getPieceAt(n)!==HG.NONE||n.equals(e.landingCoord)}).length>0)return sz.failure(BX.SHOULD_HAVE_SUPPORTING_PIECES())}if(!t.isLandable(e.landingCoord))return sz.failure(BX.CANNOT_LAND());if(e.firstCapture.isPresent()){if(!1===n.canCapture(t,e.landingCoord))return sz.failure(BX.CANNOT_CAPTURE());if(!n.isValidCapture(t,e,e.firstCapture.get()))return sz.failure(BX.INVALID_FIRST_CAPTURE());if(e.secondCapture.isPresent()&&!n.isValidCapture(t,e,e.secondCapture.get()))return sz.failure(BX.INVALID_SECOND_CAPTURE())}return sz.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getStateInfo",value:function(e){for(var t=[],n=[],r=0;r<3;r++)for(var i=0;i<4-r;i++)for(var o=0;o<4-r;o++){var a=new MX(o,i,r);e.getPieceAt(a)===e.getCurrentPlayer()&&!1===e.isSupporting(a)&&t.push(a),e.isLandable(a)&&n.push(a)}return{freeToMove:t,landable:n}}},{key:"getClimbingMoves",value:function(e){var t,n=[],r=zp(e.freeToMove);try{var i=function(){var r,i=t.value,o=zp(e.landable);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(a.isUpperThan(i)&&!1===a.getLowerPieces().some(function(e){return i.equals(e)})){var s=DX.fromClimb(i,a,[]);n.push(s)}}}catch(u){o.e(u)}finally{o.f()}};for(r.s();!(t=r.n()).done;)i()}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getDropMoves",value:function(e){var t,n=[],r=zp(e.landable);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=DX.fromDrop(i,[]);n.push(o)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"canCapture",value:function(e,t){for(var n=e.getCurrentPlayer(),r=0,i=[VG.UP,VG.DOWN];r<i.length;r++){var o=i[r],a=t.getNextValid(o);if(a.isPresent()&&e.getPieceAt(a.get())===n)for(var s=0,u=[VG.LEFT,VG.RIGHT];s<u.length;s++){var c=u[s],l=a.get().getNextValid(c);if(l.isPresent()&&e.getPieceAt(l.get())===n){var h=o.getOpposite(),f=l.get().getNextValid(h).get();if(e.getPieceAt(f)===n)return!0}}}return!1}},{key:"getPossibleCaptures",value:function(e,t,n){for(var r=[],i=(e=e.filter(function(e){return!1===t.equalsValue(e)})).concat(n),o=0;o<i.length;o++){var a=i[o];r.push([a]);for(var s=o+1;s<i.length;s++)r.push([i[s],a])}return r}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isValidCapture",value:function(e,t,n){var r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r||n.getHigherPieces().filter(function(n){return e.getPieceAt(n)!==HG.NONE&&!1===n.equals(t.firstCapture.get())}).length>0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getPiecesRepartition();return 15===t[HG.ZERO.value]?bq.ONE_WON:15===t[HG.ONE.value]?bq.ZERO_WON:bq.ONGOING}}]),n}(_q),jX=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){return n.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=FX.getGameStatus(e);if(t.isEndGame)return new oq(t.toBoardValue());var n=e.gameState.getPiecesRepartition();return new oq(n[HG.ZERO.value]-n[HG.ONE.value])}}],[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=[],i=FX.getStateInfo(n),o=FX.getClimbingMoves(i),a=FX.getDropMoves(i),s=zp(o.concat(a));try{for(s.s();!(t=s.n()).done;){var u=t.value,c=[[]];FX.canCapture(n,u.landingCoord)&&(c=FX.getPossibleCaptures(i.freeToMove,u.startingCoord,u.landingCoord));var l,h=zp(c);try{for(h.s();!(l=h.n()).done;){var f=l.value,d=DX.changeCapture(u,f);r.push(d)}}catch(p){h.e(p)}finally{h.f()}}}catch(p){s.e(p)}finally{s.f()}return r}}]),n}(iq),UX=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t=jX.getListMoves(e);return this.orderMoves(t)}},{key:"orderMoves",value:function(e){return e.sort(function(e,t){var r=12*n.countStoneUsed(e),i=12*n.countStoneUsed(t);return r+n.sumMoveEmplacementByValue(e)-(i+n.sumMoveEmplacementByValue(t))})}}],[{key:"countStoneUsed",value:function(e){var t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}},{key:"sumMoveEmplacementByValue",value:function(e){var t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}]),n}(jX),VX=HG.NONE,zX=HG.ZERO,HX=HG.ONE,GX=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(Na||(Na=xp(["Goal of the game"]))),$localize(xa||(xa=xp(["At Pylos, the goal is to be the last to play.\n        To do this, you have to save up your pieces.\n        As soon as a player puts its last piece, that player loses the game immediately.\n        Here is what the initial board looks like, it is a board of 4 x 4 squares.\n        This board will become a pyramid, little by little.\n        It will be filled by the pieces of your stock. Each player has 15 pieces."]))),LX.getInitialState()),Eq.anyMove($localize(Ra||(Ra=xp(["Dropping a piece"]))),$localize(Ma||(Ma=xp(["When it is your turn, you can always drop one of your piece on an empty square.\n        The gray squares are where you can drop your pieces.<br/><br/>\n        Click on one of the squares to drop a piece there."]))),LX.getInitialState(),DX.fromDrop(new MX(1,1,0),[]),$localize(Da||(Da=xp(["There you go, as simple as that."])))),Eq.fromMove($localize(La||(La=xp(["Climbing"]))),$localize(Ba||(Ba=xp(["When 4 pieces form a square, it is possible to put a fifth piece on top.\n        However, when that happens, you can save a piece by climbing instead of dropping a piece.\n        To climb:\n        <ol>\n            <li>Click on one of your free pieces, which should be lower than the landing square.</li>\n            <li>Click on an empty landing square, higher than your selected piece.</li>\n        </ol><br/>\n        Go ahead, climb!"]))),new LX([[[zX,HX,VX,VX],[HX,zX,VX,VX],[VX,VX,VX,VX],[VX,VX,VX,zX]],[[VX,VX,VX],[VX,VX,VX],[VX,VX,VX]],[[VX,VX],[VX,VX]],[[VX]]],0),[DX.fromClimb(new MX(3,3,0),new MX(0,0,1),[])],$localize(Fa||(Fa=xp(["Congratulations!<br/>\n        Some important notes:\n        <ol>\n            <li>You cannot move a piece that is directly below another one.</li>\n            <li>Of course, you cannot move the opponent's pieces.</li>\n            <li>You can only climb when the landing square is higher than the starting square.</li>\n        </ol>"]))),$localize(ja||(ja=xp(["Failed!"])))),Eq.fromMove($localize(Ua||(Ua=xp(["Square (1/2)"]))),$localize(Va||(Va=xp(["When the piece you just moved or dropped is the fourth one of a square of your color,\n        you can choose anywhere on the board one or two of your pieces.\n        These pieces will be removed from the board, allowing you to save up one or two pieces.\n        A chosen piece must not be directly below another piece.\n        A chosen piece can be the piece you just placed.\n        You're playing Dark.<br/><br/>\n        Form a square, then click twice on one of the four pieces to remove only that one."]))),new LX([[[zX,zX,VX,VX],[VX,zX,VX,VX],[VX,VX,VX,VX],[VX,VX,VX,VX]],[[VX,VX,VX],[VX,VX,VX],[VX,VX,VX]],[[VX,VX],[VX,VX]],[[VX]]],0),[DX.fromDrop(new MX(0,1,0),[new MX(0,0,0)]),DX.fromDrop(new MX(0,1,0),[new MX(0,1,0)]),DX.fromDrop(new MX(0,1,0),[new MX(1,0,0)]),DX.fromDrop(new MX(0,1,0),[new MX(1,1,0)])],$localize(za||(za=xp(["Congratulations, you have saved up one piece."]))),$localize(Ha||(Ha=xp(["Failed!"])))),Eq.fromPredicate($localize(Ga||(Ga=xp(["Square (2/2)"]))),$localize(qa||(qa=xp(["You're playing Dark.<br/><br/>\n        Do like in the previous step, but this time click on two different pieces."]))),new LX([[[zX,zX,VX,VX],[VX,zX,VX,VX],[VX,VX,VX,VX],[VX,VX,VX,VX]],[[VX,VX,VX],[VX,VX,VX],[VX,VX,VX]],[[VX,VX],[VX,VX]],[[VX]]],0),DX.fromDrop(new MX(0,1,0),[new MX(0,0,0),new MX(1,0,0)]),function(e,t){return e.secondCapture.isPresent()?lz.SUCCESS:e.firstCapture.isPresent()?lz.failure($localize(Wa||(Wa=xp(["Failed, you only captured one piece."])))):lz.failure($localize($a||($a=xp(["Failed, you did not capture any piece."]))))},$localize(Za||(Za=xp(["Congratulations, you have saved up two pieces."]))))]};function qX(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Mb(1,"circle",4),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc().$implicit,i=Vp.fc();Vp.Bb(1),Vp.oc("id","piece_",r,"_",n,""),Vp.mc("ngClass",i.getPlayerPieceClass(r)),Vp.Cb("cx",.5*i.SPACE_SIZE+(800-i.SPACE_SIZE)/14*n)("cy",860+(i.SPACE_SIZE+10)*r)("r",.5*i.SPACE_SIZE)}}function WX(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,qX,2,6,"g",1),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc();Vp.Bb(1),Vp.mc("ngForOf",r.getPlayerSidePieces(n))}}function $X(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"circle",8),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).$implicit,t=Vp.fc().$implicit,r=Vp.fc().$implicit;return Vp.fc().onPieceClick(e,t,r)}),Vp.Pb()}if(2&e){var r=Vp.fc(2).$implicit,i=Vp.fc().$implicit,o=Vp.fc().$implicit,a=Vp.fc();Vp.pc("id","piece_",r,"_",i,"_",o,""),Vp.mc("ngClass",a.getPieceClasses(r,i,o)),Vp.Cb("r",a.getPieceRadius(o)-a.STROKE_WIDTH)("cx",a.getPieceCx(r,i,o))("cy",a.getPieceCy(r,i,o))}}function ZX(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"rect",8),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).$implicit,t=Vp.fc().$implicit,r=Vp.fc().$implicit;return Vp.fc().onDrop(e,t,r)}),Vp.Pb()}if(2&e){var r=Vp.fc(2).$implicit,i=Vp.fc().$implicit,o=Vp.fc().$implicit,a=Vp.fc();Vp.pc("id","drop_",r,"_",i,"_",o,""),Vp.mc("ngClass",a.getSquareClasses(r,i,o)),Vp.Cb("width",2*a.getPieceRadius(o))("height",2*a.getPieceRadius(o))("x",a.getPieceCx(r,i,o)-a.getPieceRadius(o))("y",a.getPieceCy(r,i,o)-a.getPieceRadius(o))}}function QX(e,t){if(1&e&&(Vp.ec(),Vp.Ob(0),Vp.Ac(1,$X,1,7,"circle",6),Vp.Ac(2,ZX,1,8,"ng-template",null,7,Vp.Bc),Vp.Nb()),2&e){var n=Vp.vc(3),r=Vp.fc().$implicit,i=Vp.fc().$implicit,o=Vp.fc().$implicit,a=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",a.isOccupied(r,i,o))("ngIfElse",n)}}function YX(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,QX,4,2,"ng-container",5),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc().$implicit,i=Vp.fc().$implicit,o=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",o.isDrawable(n,r,i))}}function KX(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,YX,2,1,"g",1),Vp.Pb()),2&e){var n=Vp.fc().$implicit,r=Vp.fc();Vp.Bb(1),Vp.mc("ngForOf",r.getLevelRange(n))}}function JX(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,KX,2,1,"g",1),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc();Vp.Bb(1),Vp.mc("ngForOf",r.getLevelRange(n))}}function XX(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"rect",9)),2&e){var n=Vp.fc();Vp.pc("id","highCapture_",n.highCapture.get().x,"_",n.highCapture.get().y,"_",n.highCapture.get().z,""),Vp.Cb("width",2*n.getPieceRadius(n.highCapture.get().z))("height",2*n.getPieceRadius(n.highCapture.get().z))("x",n.getPieceCx(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))("y",n.getPieceCy(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))}}var e0,t0,n0,r0=function(){return[0,1]},i0=function(){return[0,1,2]},o0=((t0=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).lastLandingCoord=kz.empty(),r.lastStartingCoord=kz.empty(),r.lastFirstCapture=kz.empty(),r.lastSecondCapture=kz.empty(),r.highCapture=kz.empty(),r.chosenStartingCoord=kz.empty(),r.chosenLandingCoord=kz.empty(),r.chosenFirstCapture=kz.empty(),r.lastMove=kz.empty(),r.remainingPieces={0:15,1:15},r.rules=new FX(LX),r.availableMinimaxes=[new jX(r.rules,"PylosMinimax"),new UX(r.rules,"PylosOrderedMinimax")],r.encoder=DX.encoder,r.tutorial=(new GX).tutorial,r.SPACE_SIZE=r.getPieceRadius(0),r.updateBoard(),r}return Kp(n,[{key:"getLevelRange",value:function(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return dz.expectToBe(e,2),[0,1]}}},{key:"isDrawable",value:function(e,t,n){var r=new MX(e,t,n);return this.state.getPieceAt(r)!==HG.NONE||this.state.isLandable(r)}},{key:"onPieceClick",value:function(e,t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){var o,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(o=r.canUserPlay("#piece_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(o.getReason()));case 3:return a=new MX(e,t,n),i.abrupt("return",r.state.getPieceAt(a)===r.state.getCurrentOpponent()?r.cancelMove(nq.CANNOT_CHOOSE_OPPONENT_PIECE()):r.chosenLandingCoord.isAbsent()?(r.chosenStartingCoord=kz.of(a),lz.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=kz.of(a),lz.SUCCESS):r.chosenFirstCapture.equalsValue(a)?r.concludeMoveWithCapture([r.chosenFirstCapture.get()]):r.concludeMoveWithCapture([r.chosenFirstCapture.get(),a]));case 5:case"end":return i.stop()}},i)}))()}},{key:"concludeMoveWithCapture",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(r=t.chosenStartingCoord.isAbsent()?DX.fromDrop(t.chosenLandingCoord.get(),e):DX.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(r,t.state)));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.cancelMove(),n.chooseMove(e,t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenStartingCoord=kz.empty(),this.chosenLandingCoord=kz.empty(),this.chosenFirstCapture=kz.empty()}},{key:"onDrop",value:function(e,t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){var o,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(o=r.canUserPlay("#drop_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(o.getReason()));case 3:return a=new MX(e,t,n),i.abrupt("return",FX.canCapture(r.state,a)?(r.chosenLandingCoord=kz.of(a),lz.SUCCESS):r.isCapturelessMoveFinished(a)?(r.chosenLandingCoord=kz.of(a),r.concludeMoveWithCapture([])):r.cancelMove(BX.MUST_MOVE_UPWARD()));case 5:case"end":return i.stop()}},i)}))()}},{key:"isCapturelessMoveFinished",value:function(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}},{key:"getSquareClasses",value:function(e,t,n){var r=new MX(e,t,n);if(this.lastMove.isPresent()){var i=this.lastMove.get();if(i.firstCapture.equalsValue(r)||i.secondCapture.equalsValue(r))return["captured"];if(r.equals(i.landingCoord)||i.startingCoord.equalsValue(r))return["moved"]}return[]}},{key:"getPieceRadius",value:function(e){return 90+5*e}},{key:"getPieceCx",value:function(e,t,n){return 100+100*n+200*e}},{key:"getPieceCy",value:function(e,t,n){return 100+100*n+200*t}},{key:"isOccupied",value:function(e,t,n){var r=new MX(e,t,n),i=this.rules.node.gameState.getPieceAt(r)!==HG.NONE,o=this.chosenLandingCoord.equalsValue(r);return i||o}},{key:"getPieceClasses",value:function(e,t,n){var r=new MX(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("highlighted"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected"),this.chosenFirstCapture.equalsValue(r)&&i.push("pre-captured"),i}},{key:"getPieceFillClass",value:function(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerPieceClass(this.state.getPieceAt(e).value)}},{key:"getPlayerPieceClass",value:function(e){return this.getPlayerClass(HG.of(e))}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.remainingPieces[e],n=[],r=0;r<t;r++)n.push(r);return n}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move;var e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=kz.empty(),this.lastMove.isPresent()?this.showLastMove():(this.lastLandingCoord=kz.empty(),this.lastStartingCoord=kz.empty(),this.lastFirstCapture=kz.empty(),this.lastSecondCapture=kz.empty(),this.chosenFirstCapture=kz.empty(),this.chosenStartingCoord=kz.empty(),this.chosenLandingCoord=kz.empty())}},{key:"showLastMove",value:function(){var e=this.lastMove.get();this.lastLandingCoord=kz.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.isDrawableCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}},{key:"isDrawableCoord",value:function(e){return this.isDrawable(e.x,e.y,e.z)}}]),n}(WG)).VERBOSE=!1,t0.\u0275fac=function(e){return new(e||t0)(Vp.Lb(qG))},t0.\u0275cmp=Vp.Fb({type:t0,selectors:[["app-pylos"]],features:[Vp.yb],decls:5,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 1021","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["x","0","y","0","width","800","height","800",1,"base"],["class","base captured",3,"id",4,"ngIf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base",3,"id","ngClass","click"],[1,"base","captured",3,"id"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,WX,2,1,"g",1),Vp.Mb(2,"rect",2),Vp.Ac(3,JX,2,1,"g",1),Vp.Ac(4,XX,1,7,"rect",3),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",Vp.qc(3,r0)),Vp.Bb(2),Vp.mc("ngForOf",Vp.qc(4,i0)),Vp.Bb(1),Vp.mc("ngIf",t.highCapture.isPresent()))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),t0),a0=function(){var e=function(){function e(t){Qp(this,e),this.value=t}return Kp(e,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"QuartoPiece("+this.value+")"}},{key:"isRectangle",value:function(){return this.value%4<2}}],[{key:"fromInt",value:function(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.NONE;throw new Error("Invalid piece ("+t+")")}}]),e}();return e.AAAA=new e(0),e.AAAB=new e(1),e.AABA=new e(2),e.AABB=new e(3),e.ABAA=new e(4),e.ABAB=new e(5),e.ABBA=new e(6),e.ABBB=new e(7),e.BAAA=new e(8),e.BAAB=new e(9),e.BABA=new e(10),e.BABB=new e(11),e.BBAA=new e(12),e.BBAB=new e(13),e.BBBA=new e(14),e.BBBB=new e(15),e.NONE=new e(16),e.pieces=[e.AAAA,e.AAAB,e.AABA,e.AABB,e.ABAA,e.ABAB,e.ABBA,e.ABBB,e.BAAA,e.BAAB,e.BABA,e.BABB,e.BBAA,e.BBAB,e.BBBA,e.BBBB],e}(),s0=((e0=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e,r)).piece=i,o}return Kp(n,[{key:"toString",value:function(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}},{key:"equals",value:function(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}]),n}(fq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 496}},{key:"encodeNumber",value:function(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}},{key:"decodeNumber",value:function(e){var t=e%32;e-=t;var n=(e/=32)%4;return e-=n,new e0(e/=4,n,a0.fromInt(t))}}]),n}(wz)),e0),u0=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,e,r)).pieceInHand=i,o}return Kp(n,[{key:"getRemainingPieces",value:function(){var e,t=[],r=zp(a0.pieces);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.isGivable(i,this.board,this.pieceInHand)&&t.push(i)}}catch(o){r.e(o)}finally{r.f()}return t}}],[{key:"getInitialState",value:function(){return new n(rq.createTable(4,4,a0.NONE),0,a0.AAAA)}},{key:"isGivable",value:function(e,t,r){return e!==r&&!1===n.isAlreadyOnBoard(e,t)}},{key:"isAlreadyOnBoard",value:function(e,t){for(var n=0;n<4;n++)for(var r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}}]),n}(cq),c0=function(){var e=function e(){Qp(this,e)};return e.MUST_GIVE_A_PIECE=function(){return $localize(Qa||(Qa=xp(["You must give a piece."])))},e.PIECE_ALREADY_ON_BOARD=function(){return $localize(Ya||(Ya=xp(["That piece is already on the board."])))},e.CANNOT_GIVE_PIECE_IN_HAND=function(){return $localize(Ka||(Ka=xp(["You cannot give the piece that was in your hands."])))},e}(),l0=function(){function e(t){Qp(this,e),this.subCriterion=[kz.empty(),kz.empty(),kz.empty(),kz.empty()],this.subCriterion[0]=kz.of(8==(8&t.value)),this.subCriterion[1]=kz.of(4==(4&t.value)),this.subCriterion[2]=kz.of(2==(2&t.value)),this.subCriterion[3]=kz.of(1==(1&t.value))}return Kp(e,[{key:"mergeWith",value:function(e){for(var t=4,n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=kz.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}},{key:"mergeWithQuartoPiece",value:function(t){var n=new e(t);return this.mergeWith(n)}},{key:"areAllAbsent",value:function(){for(var e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}},{key:"match",value:function(e){for(var t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}},{key:"matchPiece",value:function(t){return this.match(new e(t))}},{key:"toString",value:function(){return"Criterion{"+this.subCriterion.map(function(e){return e.isPresent()?e.get()?"1":"0":"x"}).join(" ")+"}"}}]),e}(),h0=function(){function e(t,n){Qp(this,e),this.initialCoord=t,this.direction=n}return Kp(e,[{key:"allCoords",value:function(){for(var e=[],t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}]),e}(),f0=((n0=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t).toFallible(void 0)}},{key:"applyLegalMove",value:function(e,t){var n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new u0(n,t.turn+1,e.piece)}},{key:"getGameStatus",value:function(e){var t,r=e.gameState,i={score:pq.DEFAULT,sensitiveSquares:new qW},o=zp(n.lines);try{for(o.s();!(t=o.n()).done;){var a=t.value;if((i=n.updateBoardStatus(a,r,i)).score===pq.VICTORY)return n.scoreToGameStatus(i.score,r.turn)}}catch(s){o.e(s)}finally{o.f()}return n.scoreToGameStatus(i.score,r.turn)}},{key:"getVictoriousCoords",value:function(e){var t,r=zp(n.lines);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.isThereAVictoriousLine(i,e))return i.allCoords()}}catch(o){r.e(o)}finally{r.f()}return[]}}],[{key:"isOccupied",value:function(e){return e!==a0.NONE}},{key:"isLegal",value:function(e,t){var r=e.coord.x,i=e.coord.y,o=e.piece,a=t.getCopiedBoard(),s=t.pieceInHand;return n.isOccupied(a[i][r])?lz.failure(nq.MUST_LAND_ON_EMPTY_SPACE()):o===a0.NONE?15===t.turn?lz.SUCCESS:lz.failure(c0.MUST_GIVE_A_PIECE()):u0.isAlreadyOnBoard(o,a)?lz.failure(c0.PIECE_ALREADY_ON_BOARD()):s===o?lz.failure(c0.CANNOT_GIVE_PIECE_IN_HAND()):lz.SUCCESS}},{key:"updateBoardStatus",value:function(e,t,n){return n.score===pq.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:pq.VICTORY,sensitiveSquares:new qW}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}},{key:"isThereAVictoriousLine",value:function(e,t){for(var r=e.initialCoord,i=t.getPieceAt(r),o=new l0(i),a=0;a<3&&!1!==n.isOccupied(i)&&!o.areAllAbsent();a++)r=r.getNext(e.direction,1),i=t.getPieceAt(r),o.mergeWithQuartoPiece(i);return!(!n.isOccupied(i)||o.areAllAbsent())}},{key:"searchForVictoryOrPreVictoryInLine",value:function(e,t,r){var i=n.getLineInfos(e,t,r);if(i.boardStatus.isPresent())return i.boardStatus.get();var o=i.commonCriterion,a=i.sensitiveCoord;if(o.isPresent()&&!1===o.get().areAllAbsent()){if(a.isAbsent())return{score:pq.VICTORY,sensitiveSquares:new qW};o.get().matchPiece(t.pieceInHand)&&(r.score=pq.PRE_VICTORY);var s=a.get();r.sensitiveSquares.add(s)}return r}},{key:"getLineInfos",value:function(e,t,r){for(var i=kz.empty(),o=kz.empty(),a=e.initialCoord,s=0;s<4;s++){var u=t.getPieceAt(a);if(u===a0.NONE){if(!i.isAbsent())return{sensitiveCoord:kz.of(a),commonCriterion:o,boardStatus:kz.of(r)};i=kz.of(a)}else o.isAbsent()?(o=kz.of(new l0(u)),pz(n.VERBOSE,"set commonCrit to "+o.toString())):(o.get().mergeWithQuartoPiece(u),pz(n.VERBOSE,"update commonCrit: "+o.toString()));a=a.getNext(e.direction,1)}return{commonCriterion:o,sensitiveCoord:i,boardStatus:kz.empty()}}},{key:"scoreToGameStatus",value:function(e,t){var n=HG.of(t%2);return e===pq.VICTORY?bq.getDefeat(n):16===t?bq.DRAW:bq.ONGOING}}]),n}(_q)).VERBOSE=!1,n0.lines=[new h0(new zG(0,0),jG.DOWN),new h0(new zG(1,0),jG.DOWN),new h0(new zG(2,0),jG.DOWN),new h0(new zG(3,0),jG.DOWN),new h0(new zG(0,0),jG.RIGHT),new h0(new zG(0,1),jG.RIGHT),new h0(new zG(0,2),jG.RIGHT),new h0(new zG(0,3),jG.RIGHT),new h0(new zG(0,0),jG.DOWN_RIGHT),new h0(new zG(0,3),jG.UP_RIGHT)],n0),d0=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),o=n.pieceInHand,a=0;a<4;a++)for(var s=0;s<4;s++)if(r[a][s]===a0.NONE){if(n.getCopiedBoard()[a][s]=o,15===n.turn){var u=new s0(s,a,a0.NONE);return t.push(u),t}var c,l=zp(i);try{for(l.s();!(c=l.n()).done;){var h=c.value,f=new s0(s,a,h);t.push(f)}}catch(d){l.e(d)}finally{l.f()}}return t}},{key:"getBoardValue",value:function(e){var t,r=e.gameState,i={score:pq.DEFAULT,sensitiveSquares:new qW},o=zp(f0.lines);try{for(o.s();!(t=o.n()).done;){var a=t.value;if((i=f0.updateBoardStatus(a,r,i)).score===pq.VICTORY)break}}catch(s){o.e(s)}finally{o.f()}return n.scoreToBoardValue(i.score,r.turn)}}],[{key:"scoreToBoardValue",value:function(e,t){if(e===pq.DEFAULT)return new oq(0);var n=HG.of(t%2);return new oq(e===pq.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}]),n}(iq),p0=a0.AABA,v0=a0.AABB,g0=a0.ABAA,y0=a0.ABAB,m0=a0.ABBA,b0=a0.BAAA,_0=a0.BAAB,w0=a0.BABB,k0=a0.BBAA,C0=a0.BBAB,E0=a0.BBBA,O0=a0.BBBB,S0=a0.NONE,P0=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(Ja||(Ja=xp(["Goal of the game"]))),$localize(Xa||(Xa=xp(["Quarto is an alignment game.\n        The goal is to align four pieces that have at least one common aspect:\n        <ul>\n          <li>their color (light or dark),</li>\n          <li>their size (big or small),</li>\n          <li>their pattern (empty or dotted),</li>\n          <li>their shape (round or square).</li>\n        </ul>\n        Here, we have a board with a victory by an alignment of dark pieces."]))),new u0([[E0,k0,g0,p0],[S0,S0,S0,S0],[S0,S0,S0,S0],[S0,S0,S0,S0]],7,a0.ABAB)),Eq.anyMove($localize(es||(es=xp(["Placement"]))),$localize(ts||(ts=xp(["Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,\n        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.\n        If you prefer, the order of these two steps can be reversed.\n        Keep in mind that the second click confirms the move.<br/><br/>\n        Make a move."]))),new u0([[E0,v0,m0,S0],[S0,S0,S0,S0],[S0,b0,S0,S0],[S0,S0,S0,S0]],7,a0.ABAA),new s0(2,2,a0.BAAB),$localize(ns||(ns=xp(["Perfect!"])))),Eq.fromMove($localize(rs||(rs=xp(["Situation"]))),$localize(is||(is=xp(["We have here a tricky situation.<br/><br/>\n        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move."]))),new u0([[O0,E0,C0,S0],[g0,w0,k0,S0],[y0,b0,_0,S0],[S0,S0,S0,S0]],7,a0.AABA),[new s0(3,3,a0.AABB)],$localize(os||(os=xp(["Well done!"]))),$localize(as||(as=xp(["Failed!"]))))]};function I0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"rect",11)),2&e){var n=Vp.fc(2),r=n.$implicit,i=n.index,o=Vp.fc().index,a=Vp.fc();Vp.mc("ngClass",a.getPieceClasses(r.value)),Vp.Cb("x",a.SPACE_SIZE*i+(a.SPACE_SIZE/2-a.getPieceSize(r.value)))("y",a.SPACE_SIZE*o+(a.SPACE_SIZE/2-a.getPieceSize(r.value)))("width",2*a.getPieceSize(r.value))("height",2*a.getPieceSize(r.value))}}function T0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",11)),2&e){var n=Vp.fc(2),r=n.$implicit,i=n.index,o=Vp.fc().index,a=Vp.fc();Vp.mc("ngClass",a.getPieceClasses(r.value)),Vp.Cb("cx",a.SPACE_SIZE*i+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*o+a.SPACE_SIZE/2)("r",a.getPieceSize(r.value))}}function A0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle")),2&e){var n=Vp.fc(2).index,r=Vp.fc().index,i=Vp.fc();Vp.Cb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function N0(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,I0,1,5,"rect",9),Vp.Ac(2,T0,1,4,"ng-template",null,10,Vp.Bc),Vp.Ac(4,A0,1,3,"circle",3),Vp.Pb()),2&e){var n=Vp.vc(3),r=Vp.fc().$implicit,i=Vp.fc(2);Vp.Bb(1),Vp.mc("ngIf",r.isRectangle())("ngIfElse",n),Vp.Bb(3),Vp.mc("ngIf",i.pieceHasDot(r.value))}}function x0(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",8),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().chooseCoord(e,r)}),Vp.Pb(),Vp.Ac(2,N0,5,3,"g",3),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc().index,a=Vp.fc();Vp.Bb(1),Vp.oc("id","chooseCoord_",i,"_",o,""),Vp.mc("ngClass",a.getSquareClasses(i,o)),Vp.Cb("x",a.SPACE_SIZE*i)("y",a.SPACE_SIZE*o)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",r!==a.EMPTY)}}function R0(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g",null,7),Vp.Ac(2,x0,3,8,"g",2),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(2),Vp.mc("ngForOf",n)}}function M0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"rect",15)),2&e){var n=Vp.fc(2);Vp.mc("ngClass",n.getPieceClasses(n.pieceInHand.value)),Vp.Cb("x",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("y",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function D0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",11)),2&e){var n=Vp.fc(2);Vp.mc("ngClass",n.getPieceClasses(n.pieceInHand.value)),Vp.Cb("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",n.getPieceSize(n.pieceInHand.value))}}function L0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle")),2&e){var n=Vp.fc(2);Vp.Cb("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",10)}}function B0(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g",null,12),Vp.Mb(2,"rect",13),Vp.Ac(3,M0,1,5,"rect",14),Vp.Ac(4,D0,1,4,"ng-template",null,10,Vp.Bc),Vp.Ac(6,L0,1,3,"circle",3),Vp.Pb()),2&e){var n=Vp.vc(5),r=Vp.fc();Vp.Cb("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),Vp.Bb(2),Vp.Cb("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),Vp.Bb(3),Vp.mc("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function F0(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g",null,16),Vp.Mb(2,"rect",17),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc();Vp.Bb(2),Vp.Cb("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+n.x*r.SPACE_SIZE+" "+n.y*r.SPACE_SIZE+")")}}function j0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"rect",11)),2&e){var n=Vp.fc(2);Vp.mc("ngClass",n.getPieceClasses(n.pieceInHand.value)),Vp.Cb("x",0)("y",.75*n.SPACE_SIZE)("transform","translate("+-n.getPieceSize(n.pieceInHand.value)+", "+-n.getPieceSize(n.pieceInHand.value)+")")("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function U0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",19)),2&e){var n=Vp.fc(2);Vp.mc("ngClass",n.getPieceClasses(n.pieceInHand.value)),Vp.Cb("cy",.75*n.SPACE_SIZE)("r",n.getPieceSize(n.pieceInHand.value))}}function V0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",20)),2&e){var n=Vp.fc(2);Vp.Cb("cy",.75*n.SPACE_SIZE)("r",10)}}function z0(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,j0,1,6,"rect",9),Vp.Ac(2,U0,1,3,"ng-template",null,10,Vp.Bc),Vp.Ac(4,V0,1,2,"circle",18),Vp.Pb()),2&e){var n=Vp.vc(3),r=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),Vp.Bb(3),Vp.mc("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function H0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"rect",27)),2&e){var n=Vp.fc(2).index,r=Vp.fc().index,i=Vp.fc();Vp.Cb("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function G0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"rect",11)),2&e){var n=Vp.fc(2).index,r=Vp.fc().index,i=Vp.fc();Vp.mc("ngClass",i.getPieceClasses(4*r+n)),Vp.Cb("x",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("y",i.SPACE_SIZE*r+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("width",2*i.getPieceSize(4*r+n))("height",2*i.getPieceSize(4*r+n))}}function q0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",11)),2&e){var n=Vp.fc(2).index,r=Vp.fc().index,i=Vp.fc();Vp.mc("ngClass",i.getPieceClasses(4*r+n)),Vp.Cb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(4*r+n))}}function W0(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle")),2&e){var n=Vp.fc(2).index,r=Vp.fc().index,i=Vp.fc();Vp.Cb("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function $0(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g",25),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc().index;return Vp.fc().choosePiece(4*t+e)}),Vp.Ac(1,H0,1,4,"rect",26),Vp.Ac(2,G0,1,5,"rect",9),Vp.Ac(3,q0,1,4,"ng-template",null,10,Vp.Bc),Vp.Ac(5,W0,1,3,"circle",3),Vp.Pb()}if(2&e){var r=Vp.vc(4),i=Vp.fc().index,o=Vp.fc().index,a=Vp.fc();Vp.nc("id","choosePiece_",4*o+i,""),Vp.Bb(1),Vp.mc("ngIf",a.pieceToGive.value===4*o+i),Vp.Bb(1),Vp.mc("ngIf",(4*o+i)%4<2)("ngIfElse",r),Vp.Bb(3),Vp.mc("ngIf",a.pieceHasDot(4*o+i))}}function Z0(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,$0,6,5,"g",24),Vp.Pb()),2&e){var n=t.index,r=Vp.fc().index,i=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",i.isRemaining(4*r+n))}}function Q0(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g",null,21),Vp.Mb(2,"rect",22,23),Vp.Ac(4,Z0,2,1,"g",2),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc();Vp.Cb("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),Vp.Bb(2),Vp.Cb("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),Vp.Bb(2),Vp.mc("ngForOf",n)}}var Y0,K0,J0=((K0=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).EMPTY=a0.NONE,r.chosen=kz.empty(),r.lastMove=kz.empty(),r.pieceInHand=a0.NONE,r.pieceToGive=a0.NONE,r.victoriousCoords=[],r.rules=new f0(u0),r.availableMinimaxes=[new d0(r.rules,"QuartoMinimax")],r.encoder=s0.encoder,r.tutorial=(new P0).tutorial,r.pieceInHand=r.rules.node.gameState.pieceInHand,r.updateBoard(),r}return Kp(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=kz.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(function(e){return e.coord})}},{key:"chooseCoord",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#chooseCoord_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.hideLastMove(),n.board[t][e]!==a0.NONE){r.next=11;break}if(n.showPieceInHandOnBoard(e,t),15!==n.rules.node.gameState.turn){r.next=7;break}return o=new s0(e,t,a0.NONE),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 7:if(n.pieceToGive!==a0.NONE){r.next=9;break}return r.abrupt("return",lz.SUCCESS);case 9:return a=new s0(e,t,n.pieceToGive),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 11:return r.abrupt("return",n.cancelMove(nq.MUST_CLICK_ON_EMPTY_SPACE()));case 12:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#choosePiece_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(t.hideLastMove(),t.pieceToGive=a0.fromInt(e),!t.chosen.isAbsent()){n.next=5;break}return n.abrupt("return",lz.SUCCESS);case 5:return i=t.chosen.get(),o=new s0(i.x,i.y,t.pieceToGive),n.abrupt("return",t.chooseMove(o,t.rules.node.gameState));case 7:case"end":return n.stop()}},n)}))()}},{key:"hideLastMove",value:function(){this.lastMove=kz.empty()}},{key:"cancelMoveAttempt",value:function(){this.hideLastMove(),this.pieceToGive=a0.NONE}},{key:"showPieceInHandOnBoard",value:function(e,t){this.chosen=kz.of(new zG(e,t))}},{key:"isRemaining",value:function(e){return u0.isGivable(a0.fromInt(e),this.board,this.pieceInHand)}},{key:"getSquareClasses",value:function(e,t){var n=new zG(e,t);return this.lastMove.equalsValue(n)?["moved"]:[]}},{key:"getPieceClasses",value:function(e){var t=[];return t.push(e%2==0?"player0":"player1"),t}},{key:"getPieceSize",value:function(e){return e<8?40:25}},{key:"pieceHasDot",value:function(e){return e!==a0.NONE.value&&e%8<4}}]),n}(dW)).\u0275fac=function(e){return new(e||K0)(Vp.Lb(qG))},K0.\u0275cmp=Vp.Fb({type:K0,selectors:[["app-quarto"]],features:[Vp.yb],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],["chosenPiece",""],["id","highlight","x","0","y","0",1,"base","highlighted","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],[3,"id","click",4,"ngIf"],[3,"id","click"],["class","base highlighted",4,"ngIf"],[1,"base","highlighted"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Qb(1,"g",1),Vp.Ac(2,R0,3,1,"g",2),Vp.Ac(3,B0,7,6,"g",3),Vp.Ac(4,F0,3,3,"g",2),Vp.Qb(5,"g",null,4),Vp.Mb(7,"rect",5,6),Vp.Ac(9,z0,5,3,"g",3),Vp.Pb(),Vp.Ac(10,Q0,5,6,"g",2),Vp.Pb(),Vp.Pb()),2&e&&(Vp.Cb("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),Vp.Bb(2),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngIf",t.chosen.isPresent()),Vp.Bb(1),Vp.mc("ngForOf",t.victoriousCoords),Vp.Bb(1),Vp.Cb("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),Vp.Bb(2),Vp.Cb("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),Vp.Bb(2),Vp.mc("ngIf",t.chosen.isAbsent()),Vp.Bb(1),Vp.mc("ngForOf",t.board))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),K0),X0=function(){var e=function e(){Qp(this,e)};return e.NO_INSIDE_CLICK=function(){return $localize(ss||(ss=xp(["You must pick a space from the edge of the board."])))},e}(),e1=((Y0=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;Qp(this,n),(o=t.call(this,e,r)).direction=i;var a=n.isValidCoord(o.coord);if(a.isFailure())throw new Error(a.getReason());if(0===e&&i===VG.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&i===VG.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===r&&i===VG.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===r&&i===VG.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.");return o}return Kp(n,[{key:"toString",value:function(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}],[{key:"isValidCoord",value:function(e){return e.isNotInRange(5,5)?lz.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?lz.failure(X0.NO_INSIDE_CLICK()):lz.SUCCESS}}]),n}(fq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 128}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}},{key:"decodeNumber",value:function(e){var t=VG.factory.fromInt(e%4).get();e-=e%4;var n=(e/=4)%5;return e-=e%5,new Y0(e/=5,n,t)}}]),n}(wz)),Y0),t1=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e){for(var t=this.getCopiedBoard(),r=this.turn+1,i=e.coord,o=e.coord.getNext(e.direction);o.isInRange(5,5);)t[i.y][i.x]=t[o.y][o.x],i=i.getNext(e.direction),o=o.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new n(t,r)}}],[{key:"getInitialState",value:function(){return new n(rq.createTable(5,5,HG.NONE),0)}}]),n}(cq),n1=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?sz.failure(nq.CANNOT_CHOOSE_OPPONENT_PIECE()):sz.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getLinesSums(t),i=n.getFullestLine(r[HG.ZERO.value]),o=n.getFullestLine(r[HG.ONE.value]),a=t.getCurrentPlayer();return 5===i&&(a===HG.ZERO||o<5)?bq.ZERO_WON:5===o?bq.ONE_WON:bq.ONGOING}}],[{key:"getVerticalCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new zG(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new zG(4,r));return n}},{key:"getHorizontalCenterCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new zG(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new zG(r,4));return n}},{key:"getPossibleDirections",value:function(e){var t=[];return 0!==e.x&&t.push(VG.LEFT),0!==e.y&&t.push(VG.UP),4!==e.x&&t.push(VG.RIGHT),4!==e.y&&t.push(VG.DOWN),t}},{key:"getLinesSums",value:function(e){var t={};t[HG.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[HG.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(var n=0;n<5;n++)for(var r=0;r<5;r++){var i=e.getPieceAtXY(r,n).value;i!==HG.NONE.value&&(t[i].columns[r]=t[i].columns[r]+1,t[i].rows[n]=t[i].rows[n]+1,r===n&&(t[i].diagonals[0]=t[i].diagonals[0]+1),r+n===4&&(t[i].diagonals[1]=t[i].diagonals[1]+1))}return t}},{key:"getVictoriousCoords",value:function(e){for(var t=n.getLinesSums(e),r=[],i=0;i<2;i++){for(var o=0;o<5;o++){if(5===t[i].columns[o])for(var a=0;a<5;a++)r.push(new zG(o,a));if(5===t[i].rows[o])for(var s=0;s<5;s++)r.push(new zG(s,o))}if(5===t[i].diagonals[0])for(var u=0;u<5;u++)r.push(new zG(u,u));if(5===t[i].diagonals[1])for(var c=0;c<5;c++)r.push(new zG(c,4-c))}return r}},{key:"getFullestLine",value:function(e){var t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max.apply(Math,Up(t))}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}}]),n}(_q),r1=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t,n=[],r=n1.getVerticalCoords(e),i=zp(n1.getHorizontalCenterCoords(e).concat(r));try{for(i.s();!(t=i.n()).done;){var o,a=t.value,s=zp(n1.getPossibleDirections(a));try{for(s.s();!(o=s.n()).done;){var u=o.value,c=new e1(a.x,a.y,u);n.push(c)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=n1.getLinesSums(t),r=n1.getFullestLine(n[HG.ZERO.value]),i=n1.getFullestLine(n[HG.ONE.value]),o=t.getCurrentPlayer();return new oq(5===r&&(o===HG.ZERO||i<5)?HG.ZERO.getVictoryValue():5===i?HG.ONE.getVictoryValue():i-r)}}]),n}(iq),i1=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"getArrowTransform",value:function(e,t,n){var r,i,o;switch(n){case VG.UP:r=0,i=-1,o=-90;break;case VG.DOWN:r=0,i=1,o=90;break;case VG.LEFT:r=-1,i=0,o=180;break;default:dz.expectToBe(n,VG.RIGHT),r=1,i=0,o=0}return["translate(".concat(t.x*e+e/2+r*e/4," ").concat(t.y*e+e/2+i*e/4,")"),"scale(2.5)","rotate(".concat(o,")")].join(" ")}}]),e}(),o1=HG.NONE,a1=HG.ZERO,s1=HG.ONE,u1=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(us||(us=xp(["Goal of the game."]))),$localize(cs||(cs=xp(["At Quixo, the goal is to align 5 of your pieces.\n        The first player plays with dark pieces, the second with light pieces.\n        The board is made of 25 spaces spread over a 5x5 square.\n        Every piece has a neutral side, a light side, and a dark side."]))),t1.getInitialState()),Eq.fromMove($localize(ls||(ls=xp(["What a move looks like (without animation)"]))),$localize(hs||(hs=xp(["When it is your turn:\n        <ol>\n            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.\n                You can only choose a piece from the edge of the board.</li>\n            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>\n        </ol>\n        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.\n        Once on the other side, all pieces will move by one space in the opposing direction.\n        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>\n        For example, take the bottom right neutral piece, and move it to the left (you're playing Light)."]))),new t1([[o1,o1,o1,o1,o1],[o1,o1,o1,o1,o1],[o1,o1,o1,o1,o1],[o1,o1,o1,o1,o1],[a1,a1,a1,a1,o1]],1),[new e1(4,4,VG.LEFT)],$localize(fs||(fs=xp(["See how the four dark pieces have been moved one space to the right.\n        The neutral piece has been move 4 pieces to the left and has become light."]))),$localize(ds||(ds=xp(["Failed!"])))),Eq.fromMove($localize(ps||(ps=xp(["Victory"]))),$localize(vs||(vs=xp(["You already know everything you need in order to play, but there is one last particularity.\n        If you create a line of 5 of your pieces, you win.\n        If you create a line of 5 of your opponent's pieces, you lose.\n        If you create both, you lose too!<br/><br/>\n        You can win with this board, try it.\n        You're playing Light."]))),new t1([[o1,s1,o1,s1,s1],[o1,a1,a1,o1,a1],[s1,s1,s1,a1,s1],[a1,o1,a1,s1,s1],[s1,a1,o1,s1,a1]],31),[new e1(3,0,VG.DOWN)],$localize(gs||(gs=xp(["Congratulations, you won!"]))),$localize(ys||(ys=xp(["Failed!"]))))]};function c1(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"circle",4),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onBoardClick(e,r)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",r,"_",i,""),Vp.mc("ngClass",o.getPieceClasses(r,i)),Vp.Cb("cx",50+100*r)("cy",50+100*i)}}function l1(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,c1,2,5,"g",2),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function h1(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"use",6),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(2).chooseDirection(e)}),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc(2);Vp.nc("id","chooseDirection_",r,""),Vp.Cb("transform",i.getArrowTransform(i.chosenCoord.get(),r))}}function f1(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,h1,1,2,"use",5),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(1),Vp.mc("ngForOf",n.getPossiblesDirections())}}var d1,p1,v1,g1,y1,m1=((v1=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).lastMoveCoord=kz.empty(),r.chosenCoord=kz.empty(),r.victoriousCoords=[],r.rules=new n1(t1),r.availableMinimaxes=[new r1(r.rules,"QuixoMinimax")],r.encoder=e1.encoder,r.tutorial=(new u1).tutorial,r.updateBoard(),r}return Kp(n,[{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(function(e){return e.coord}),this.victoriousCoords=n1.getVictoriousCoords(this.state)}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=kz.empty()}},{key:"getPieceClasses",value:function(e,t){var n=new zG(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move"),this.victoriousCoords.some(function(e){return e.equals(n)})&&r.push("victory-stroke"),r}},{key:"onBoardClick",value:function(e,t){var n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=new zG(e,t),i=e1.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(nq.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord=kz.of(r),lz.SUCCESS)}},{key:"getPossiblesDirections",value:function(){var e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push("RIGHT"),0!==t.x&&e.push("LEFT"),4!==t.y&&e.push("DOWN"),0!==t.y&&e.push("UP"),e}},{key:"chooseDirection",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#chooseDirection_"+e)).isFailure()){n.next=5;break}n.t0=t.cancelMove(r.getReason()),n.next=9;break;case 5:return t.chosenDirection=VG.factory.fromString(e).get(),n.next=8,t.tryMove();case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new e1(n.x,n.y,e.chosenDirection),t.abrupt("return",(e.cancelMove(),e.chooseMove(r,e.rules.node.gameState)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getArrowTransform",value:function(e,t){return i1.getArrowTransform(this.SPACE_SIZE,e,VG.factory.fromString(t).get())}}]),n}(dW)).VERBOSE=!1,v1.\u0275fac=function(e){return new(e||v1)(Vp.Lb(qG))},v1.\u0275cmp=Vp.Fb({type:v1,selectors:[["app-quixo"]],features:[Vp.yb],decls:5,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 500 500","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -3.5, 10 0, 0 3.5"],[4,"ngFor","ngForOf"],[4,"ngIf"],["r","45",1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",3,"id","click"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Qb(1,"defs"),Vp.Mb(2,"polygon",1),Vp.Pb(),Vp.Ac(3,l1,2,1,"g",2),Vp.Ac(4,f1,2,1,"g",3),Vp.Pb()),2&e&&(Vp.Bb(3),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngIf",t.chosenCoord.isPresent()))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),v1),b1=((p1=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"countScore",value:function(){for(var e=[0,0],t=0;t<n.BOARD_HEIGHT;t++)for(var r=0;r<n.BOARD_WIDTH;r++){var i=this.board[t][r];i!==HG.NONE&&(e[i.value]+=1)}return e}}],[{key:"getInitialState",value:function(){var e=rq.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,HG.NONE);return e[3][3]=HG.ZERO,e[4][4]=HG.ZERO,e[3][4]=HG.ONE,e[4][3]=HG.ONE,new n(e,0)}},{key:"getNeighbooringPawnLike",value:function(e,t,n,r){for(var i,o=[],a=-1;a<2;a++)for(var s=-1;s<2;s++)(i=new zG(n+s,r+a)).isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&o.push(i);return o}}]),n}(cq)).BOARD_WIDTH=8,p1.BOARD_HEIGHT=8,p1),_1=((d1=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"equals",value:function(e){return e===this||e.coord.equals(this.coord)}},{key:"toString",value:function(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(fq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return(b1.BOARD_HEIGHT-1)*b1.BOARD_WIDTH+(b1.BOARD_WIDTH-1)}},{key:"encodeNumber",value:function(e){return e.coord.y*b1.BOARD_WIDTH+e.coord.x}},{key:"decodeNumber",value:function(e){var t=e%b1.BOARD_WIDTH;return new d1(t,(e-t)/b1.BOARD_WIDTH)}}]),n}(wz)),d1.PASS=new d1(-1,-1),d1.PASS_NUMBER=d1.encoder.encodeNumber(d1.PASS),d1),w1=function(){var e=function e(){Qp(this,e)};return e.NO_ELEMENT_SWITCHED=function(){return $localize(ms||(ms=xp(["Your move should switch at least one piece."])))},e}(),k1=function e(t,n){Qp(this,e),this.move=t,this.switched=n},C1=((y1=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.turn,i=t.getCurrentPlayer(),o=t.getCopiedBoard();if(e.equals(_1.PASS))return new b1(o,r+1);var a,s=zp(n);try{for(s.s();!(a=s.n()).done;){var u=a.value;o[u.y][u.x]=i}}catch(c){s.e(c)}finally{s.f()}return o[e.coord.y][e.coord.x]=i,new b1(o,r+1)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}},{key:"isLegal",value:function(e,t){var r=t.getCopiedBoard();if(e.equals(_1.PASS))return n.playerCanOnlyPass(t)?sz.success([]):sz.failure(nq.MUST_PASS());if(r[e.coord.y][e.coord.x]!==HG.NONE)return pz(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),sz.failure(nq.MUST_CLICK_ON_EMPTY_SPACE());var i=n.getAllSwitcheds(e,t.getCurrentPlayer(),r);return pz(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?sz.failure(w1.NO_ELEMENT_SWITCHED()):sz.success(i)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;if(!1===n.isGameEnded(t))return bq.ONGOING;var r=t.countScore(),i=r[1]-r[0];return i<0?bq.ZERO_WON:i>0?bq.ONE_WON:bq.DRAW}},{key:"getAllSwitcheds",value:function(e,t,r){var i,o=[],a=t.getOpponent(),s=zp(jG.DIRECTIONS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=e.coord.getNext(u);if(c.isInRange(b1.BOARD_WIDTH,b1.BOARD_HEIGHT)&&r[c.y][c.x]===a){var l,h=zp(n.getSandwicheds(t,u,c,r));try{for(h.s();!(l=h.n()).done;){var f=l.value;o.push(f)}}catch(d){h.e(d)}finally{h.f()}}}}catch(d){s.e(d)}finally{s.f()}return o}},{key:"getSandwicheds",value:function(e,t,n,r){for(var i=[n],o=n.getNext(t);o.isInRange(b1.BOARD_WIDTH,b1.BOARD_HEIGHT);){var a=r[o.y][o.x];if(a===e)return i;if(a===HG.NONE)return[];i.push(o),o=o.getNext(t)}return[]}},{key:"isGameEnded",value:function(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}},{key:"playerCanOnlyPass",value:function(e){var t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(_1.PASS)}},{key:"nextPlayerCantOnlyPass",value:function(e){var t=e.getCopiedBoard(),n=new b1(t,e.turn+1);return this.playerCanOnlyPass(n)}},{key:"getListMoves",value:function(e){for(var t,r=[],i=e.getCurrentPlayer(),o=e.getCurrentOpponent(),a=0;a<8;a++)for(var s=0;s<8;s++)if(e.getPieceAtXY(s,a)===HG.NONE&&(t=e.getCopiedBoard(),b1.getNeighbooringPawnLike(t,o,s,a).length>0)){var u=new _1(s,a),c=n.getAllSwitcheds(u,i,t);if(c.length>0){var l,h=zp(c);try{for(h.s();!(l=h.n()).done;){var f=l.value;vz(i!==e.getPieceAt(f),f+"was already switched!"),t[f.y][f.x]=i}}catch(d){h.e(d)}finally{h.f()}t[a][s]=i,r.push(new k1(u,c.length))}}return 0===r.length&&r.push(new k1(_1.PASS,0)),r}}]),n}(_q)).VERBOSE=!1,y1),E1=((g1=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getBoardValue",value:function(e){var t=C1.getGameStatus(e);if(t.isEndGame)return oq.fromWinner(t.winner);for(var n=e.gameState.getCopiedBoard(),r=0,i=0,o=0;o<b1.BOARD_HEIGHT;o++)for(var a=0;a<b1.BOARD_WIDTH;a++){var s=(0===a||a===b1.BOARD_WIDTH-1?4:1)*(0===o||o===b1.BOARD_HEIGHT-1?4:1);n[o][a]===HG.ZERO&&(r+=s),n[o][a]===HG.ONE&&(i+=s)}return r*=HG.ZERO.getScoreModifier(),i*=HG.ONE.getScoreModifier(),new oq(i+r)}},{key:"getListMoves",value:function(e){var t=C1.getListMoves(e.gameState);return rq.sortByDescending(t,function(e){return n.bestCoords.some(function(t){return e.move.coord.equals(t)})?100:e.switched}),t.map(function(e){return e.move})}}]),n}(iq)).bestCoords=[new zG(0,0),new zG(0,b1.BOARD_HEIGHT-1),new zG(b1.BOARD_WIDTH-1,0),new zG(b1.BOARD_WIDTH-1,b1.BOARD_HEIGHT-1)],g1),O1=HG.NONE,S1=HG.ZERO,P1=HG.ONE,I1=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(bs||(bs=xp(["Goal of the game"]))),$localize(_s||(_s=xp(["At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.\n        When one piece is flipped, its owner changes.\n        The player owning the most pieces at the end of the game wins.\n        Here, Dark has 28 points and Light has 36, hence Light wins."]))),new b1([[S1,S1,S1,S1,S1,S1,S1,S1],[S1,P1,P1,P1,P1,P1,P1,S1],[S1,P1,P1,P1,P1,P1,P1,S1],[S1,P1,P1,P1,P1,P1,P1,S1],[S1,P1,P1,P1,P1,P1,P1,S1],[S1,P1,P1,P1,P1,P1,P1,S1],[S1,P1,P1,P1,P1,P1,P1,S1],[S1,S1,S1,S1,S1,S1,S1,S1]],60)),Eq.anyMove($localize(ws||(ws=xp(["Capture (1/2)"]))),$localize(ks||(ks=xp(["At the beginning of the game, pieces are placed as shown here.\n        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>\n        Do any move by clicking to put your piece\n        Dark plays first."]))),b1.getInitialState(),new _1(2,4),$localize(Cs||(Cs=xp(["Congratulations!"])))),Eq.fromMove($localize(Es||(Es=xp(["Capture (2/2)"]))),$localize(Os||(Os=xp(["A move can also capture a bigger line, and more than one lines at a time\n        You're playing light here.<br/><br/>\n        Play on the bottom left to see an example."]))),new b1([[O1,O1,O1,O1,O1,O1,O1,O1],[O1,O1,O1,O1,O1,O1,O1,O1],[O1,O1,O1,O1,O1,O1,O1,O1],[O1,O1,O1,O1,P1,O1,O1,O1],[O1,O1,O1,S1,O1,O1,O1,O1],[O1,O1,S1,O1,O1,O1,O1,O1],[S1,S1,O1,O1,O1,O1,O1,O1],[O1,S1,P1,S1,P1,S1,O1,O1]],1),[new _1(0,7)],$localize(Ss||(Ss=xp(["Congratulations!"]))),$localize(Ps||(Ps=xp(["Lower and more to the left, please."])))),Eq.informational($localize(Is||(Is=xp(["Passing a turn"]))),$localize(Ts||(Ts=xp(["If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass\n        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way."]))),new b1([[P1,S1,S1,S1,S1,S1,P1,S1],[S1,P1,P1,P1,P1,P1,P1,S1],[S1,P1,P1,P1,P1,P1,P1,S1],[S1,P1,P1,P1,P1,P1,P1,S1],[S1,P1,P1,P1,P1,P1,P1,S1],[S1,P1,P1,P1,P1,P1,P1,S1],[P1,P1,P1,P1,P1,P1,O1,O1],[S1,S1,S1,S1,S1,S1,O1,O1]],60))]};function T1(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",4)),2&e){var n=Vp.fc().index,r=Vp.fc().index,i=Vp.fc();Vp.mc("ngClass",i.getPieceClass(n,r)),Vp.Cb("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)}}function A1(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",2),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onClick(e,r)}),Vp.Pb(),Vp.Ac(2,T1,1,4,"circle",3),Vp.Pb()}if(2&e){var r=t.index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",r,"_",i,""),Vp.mc("ngClass",o.getRectClasses(r,i)),Vp.Cb("x",o.SPACE_SIZE*r)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",o.board[i][r]!==o.NONE)}}function N1(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,A1,3,8,"g",1),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}var x1,R1,M1,D1,L1=((D1=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).NONE=HG.NONE,r.lastMove=new zG(-2,-2),r.captureds=[],r.scores=kz.of([2,2]),r.rules=new C1(b1),r.availableMinimaxes=[new E1(r.rules,"ReversiMinimax")],r.encoder=_1.encoder,r.tutorial=(new I1).tutorial,r.canPass=!1,r.updateBoard(),r}return Kp(n,[{key:"onClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return o=new _1(e,t),r.next=6,n.chooseMove(o,n.rules.node.gameState,n.scores.get());case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new zG(-2,-2),this.scores=kz.of(e.countScore()),this.canPass=C1.playerCanOnlyPass(e)}},{key:"showPreviousMove",value:function(){this.lastMove=this.rules.node.move.get().coord;var e,t=this.rules.node.gameState.getCurrentPlayer(),n=this.rules.node.gameState.getCurrentOpponent(),r=zp(jG.DIRECTIONS);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,o=this.lastMove.getNext(i,1);o.isInRange(b1.BOARD_WIDTH,b1.BOARD_HEIGHT)&&this.rules.node.gameState.getPieceAt(o)===n&&this.rules.node.mother.get().gameState.getPieceAt(o)===t;)this.captureds.push(o),o=o.getNext(i,1)}catch(a){r.e(a)}finally{r.f()}}},{key:"getRectClasses",value:function(e,t){var n=new zG(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:n.equals(this.lastMove)?["moved"]:[]}},{key:"getPieceClass",value:function(e,t){return this.getPlayerClass(this.board[t][e])}},{key:"pass",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(vz(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(_1.PASS.coord.x,_1.PASS.coord.y)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(dW)).\u0275fac=function(e){return new(e||D1)(Vp.Lb(qG))},D1.\u0275cmp=Vp.Fb({type:D1,selectors:[["app-reversi"]],features:[Vp.yb],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,N1,2,1,"g",1),Vp.Pb()),2&e&&(Vp.Cb("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),Vp.Bb(1),Vp.mc("ngForOf",t.board))},directives:[vg,dg,yg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),D1),B1=((M1=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,null,[{key:"getInitialState",value:function(){var e=QG.NONE,t=QG.ZERO,r=QG.ONE,i=QG.EMPTY;return new n([[e,e,t,r,i,i,i,t,r,e,e],[e,i,i,i,i,i,i,i,i,i,e],[r,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,r],[e,i,i,i,i,i,i,i,i,i,e],[e,e,r,t,i,i,i,r,t,e,e]],0)}}]),n}(O$)).HEIGHT=6,M1.WIDTH=11,M1),F1=function(){var e=function e(){Qp(this,e)};return e.CAN_ONLY_REBOUND_ON_BLACK=function(){return $localize(As||(As=xp(["You can only rebound on dark spaces."])))},e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=function(){return $localize(Ns||(Ns=xp(["You can only rebound on empty spaces."])))},e.MUST_CHOOSE_PYRAMID_FIRST=function(){return $localize(xs||(xs=xp(["You must pick one of your pyramids first."])))},e.MUST_CHOOSE_OWN_PYRAMID=function(){return $localize(Rs||(Rs=xp(["You must pick one of your pyramids."])))},e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=function(){return $localize(Ms||(Ms=xp(["Those two spaces are not neighbors."])))},e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=function(){return $localize(Ds||(Ds=xp(["Those two spaces have no intermediary neighbor."])))},e}(),j1=((R1=function(e){Jp(n,e);var t=ev(n);function n(e,r){return Qp(this,n),t.call(this,e,r)}return Kp(n,[{key:"isSimpleStep",value:function(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"SaharaMove("+this.coord+"->"+this.end+")"}}],[{key:"checkDistanceAndLocation",value:function(e,t){var n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return lz.failure(nq.MOVE_CANNOT_BE_STATIC());if(1===n){var r=E$.getFakeNeighbors(e);if(t.equals(r))return lz.failure(F1.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return lz.failure($localize(Ls||(Ls=xp(["You can move one or two spaces, not ","."])),n));if((e.x+e.y)%2==0)return lz.failure(F1.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return lz.failure(F1.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return lz.SUCCESS}},{key:"from",value:function(e,t){if(!e.isInRange(B1.WIDTH,B1.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(B1.WIDTH,B1.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");var r=n.checkDistanceAndLocation(e,t);return r.isFailure()?r.toFailedFallible():sz.success(new n(e,t))}}]),n}(AW)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 396*B1.WIDTH+66*B1.HEIGHT+6*B1.WIDTH+B1.HEIGHT}},{key:"encodeNumber",value:function(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){var t=e%6;e-=t;var n=(e/=6)%11;e-=n;var r=(e/=11)%6;return e-=r,R1.from(new zG(e/=6,r),new zG(n,t)).get()}}]),n}(wz)),R1),U1=((x1=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,r){pz(n.VERBOSE,"Legal move "+e.toString()+" applied");var i=t.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=QG.EMPTY,new B1(i,t.turn+1)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return sz.failure(nq.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==QG.EMPTY)return sz.failure(nq.MUST_LAND_ON_EMPTY_SPACE());var n=E$.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===QG.EMPTY?sz.success(void 0):sz.failure(F1.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):sz.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getCopiedBoard(),r=n.getBoardValuesFor(t,HG.ZERO),i=n.getBoardValuesFor(t,HG.ONE);return n.getGameStatusFromFreedoms(r,i)}}],[{key:"getStartingCoords",value:function(e,t){for(var n=[],r=0;r<B1.HEIGHT;r++)for(var i=0;i<B1.WIDTH;i++)e[r][i].is(t)&&n.push(new zG(i,r));return n}},{key:"getBoardValuesFor",value:function(e,t){var r,i=[],o=zp(n.getStartingCoords(e,t));try{for(o.s();!(r=o.n()).done;){var a=r.value,s=O$.getEmptyNeighbors(e,a,QG.EMPTY).length;if(0===s)return[0];i.push(s)}}catch(u){o.e(u)}finally{o.f()}return i.sort(function(e,t){return e-t})}},{key:"getGameStatusFromFreedoms",value:function(e,t){return 0===e[0]?bq.ONE_WON:0===t[0]?bq.ZERO_WON:bq.ONGOING}}]),n}(_q)).VERBOSE=!1,x1),V1=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),o=zp(U1.getStartingCoords(r,i));try{for(o.s();!(t=o.n()).done;){var a,s=t.value,u=zp(O$.getEmptyNeighbors(r,s,QG.EMPTY));try{for(u.s();!(a=u.n()).done;){var c=a.value,l=j1.from(s,c).get();if(r[c.y][c.x]=r[s.y][s.x],r[s.y][s.x]=QG.EMPTY,n.push(l),(c.y+c.x)%2==0){var h,f=zp(O$.getEmptyNeighbors(r,c,QG.EMPTY));try{for(f.s();!(h=f.n()).done;){var d=h.value;if(!d.equals(s)){var p=j1.from(s,d).get();r[d.y][d.x]=r[c.y][c.x],r[c.y][c.x]=QG.EMPTY,n.push(p),r[c.y][c.x]=r[d.y][d.x],r[d.y][d.x]=QG.EMPTY}}}catch(v){f.e(v)}finally{f.f()}}r[s.y][s.x]=r[c.y][c.x],r[c.y][c.x]=QG.EMPTY}}catch(v){u.e(v)}finally{u.f()}}}catch(v){o.e(v)}finally{o.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState.getCopiedBoard(),n=U1.getBoardValuesFor(t,HG.ZERO),r=U1.getBoardValuesFor(t,HG.ONE),i=U1.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return oq.fromWinner(i.winner);for(var o=0;o<6&&n[o]===r[o];)o++;return new oq(r[o%6]-n[o%6])}}]),n}(iq),z1=QG.NONE,H1=QG.ZERO,G1=QG.ONE,q1=QG.EMPTY,W1=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(Bs||(Bs=xp(["Initial board"]))),$localize(Fs||(Fs=xp(["S\xe2h\xe2r\xe2 is played on a board where each space is a triangle.\n        Each player has six pyramids."]))),B1.getInitialState()),Eq.informational($localize(js||(js=xp(["Goal of the game"]))),$localize(Us||(Us=xp(["At S\xe2h\xe2r\xe2, the goal of the game is to immobilize one of the opponent's pyramids.\n        To do so, you have to occupy all neighboring space of that pyramid.\n        Here, Light has lost because its leftmost pyramid is immobilized."]))),new B1([[z1,z1,q1,q1,G1,q1,q1,H1,G1,z1,z1],[z1,q1,q1,q1,q1,q1,q1,q1,q1,q1,z1],[G1,H1,q1,q1,q1,q1,q1,q1,q1,q1,H1],[H1,q1,q1,q1,q1,q1,q1,q1,q1,q1,G1],[z1,q1,q1,q1,q1,q1,q1,q1,q1,q1,z1],[z1,z1,G1,H1,q1,q1,q1,G1,H1,z1,z1]],3)),Eq.fromPredicate($localize(Vs||(Vs=xp(["Simple step"]))),$localize(zs||(zs=xp(["To immobilize your opponent, you have to move your pyramids.\n        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).\n        You're the first player, playing with the dark pyramids.\n        <ol>\n            <li>Click on one of your pyramids.</li>\n            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>\n        </ol><br/>\n        Do any simple step."]))),B1.getInitialState(),j1.from(new zG(2,0),new zG(2,1)).get(),function(e,t){return e.isSimpleStep()?lz.SUCCESS:lz.failure($localize(Hs||(Hs=xp(["You have made a double step, which is good but it is the next exercise!"]))))},$localize(Gs||(Gs=xp(["Congratulations!"])))),Eq.fromPredicate($localize(qs||(qs=xp(["Double step"]))),$localize(Ws||(Ws=xp(["When a pyramid shares its vertices with dark spaces, it can move one or two steps.\n        To do so:\n        <ol>\n            <li>Click on the pyramid to move.</li>\n            <li>Click on one of the 6 destinations that you can reach in two steps:\n                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.\n        </ol>"]))),B1.getInitialState(),j1.from(new zG(7,0),new zG(5,0)).get(),function(e,t){return e.isSimpleStep()?lz.failure($localize($s||($s=xp(["Failed! You have made a single step."])))):lz.SUCCESS},$localize(Zs||(Zs=xp(["Congratulations!"]))))]};function $1(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Mb(1,"polyline",6),Vp.Pb()),2&e){var n=Vp.fc().index,r=Vp.fc().index,i=Vp.fc();Vp.Bb(1),Vp.mc("ngClass",i.getPlayerClassFor(n,r)),Vp.Cb("points",i.getPyramidCoordinate(n,r))}}function Z1(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polyline",9)),2&e){var n=Vp.fc(2).index,r=Vp.fc().index,i=Vp.fc();Vp.Cb("points",i.getTriangleCoordinate(n,r))}}function Q1(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polyline",10)),2&e){var n=Vp.fc(2).index,r=Vp.fc().index,i=Vp.fc();Vp.Cb("points",i.getTriangleCoordinate(n,r))}}function Y1(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,Z1,1,1,"polyline",7),Vp.Ac(2,Q1,1,1,"polyline",8),Vp.Pb()),2&e){var n=Vp.fc().index,r=Vp.fc().index;Vp.Bb(1),Vp.mc("ngIf",(n+r)%2==1),Vp.Bb(1),Vp.mc("ngIf",(n+r)%2==0)}}function K1(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g",5),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onClick(e,r)}),Vp.Ac(1,$1,2,2,"g",2),Vp.Ac(2,Y1,3,2,"g",2),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc().index;Vp.oc("id","click_",i,"_",o,""),Vp.Bb(1),Vp.mc("ngIf",r.isPlayer()),Vp.Bb(1),Vp.mc("ngIf",2===r.value)}}function J1(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,K1,3,4,"g",4),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function X1(e,t){if(1&e&&(Vp.ec(),Vp.Ob(0),Vp.Mb(1,"polyline",11),Vp.Mb(2,"polyline",11),Vp.Nb()),2&e){var n=Vp.fc();Vp.Bb(1),Vp.Cb("points",n.getTriangleCoordinate(n.lastCoord.get().x,n.lastCoord.get().y)),Vp.Bb(1),Vp.Cb("points",n.getTriangleCoordinate(n.lastMoved.get().x,n.lastMoved.get().y))}}function e2(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polyline",12)),2&e){var n=Vp.fc();Vp.Cb("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}var t2,n2,r2,i2,o2=((r2=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).lastCoord=kz.empty(),r.lastMoved=kz.empty(),r.chosenCoord=kz.empty(),r.rules=new U1(B1),r.availableMinimaxes=[new V1(r.rules,"SaharaMinimax")],r.encoder=j1.encoder,r.tutorial=(new W1).tutorial,r.updateBoard(),r}return Kp(n,[{key:"cancelMoveAttempt",value:function(){this.chosenCoord=kz.empty()}},{key:"onClick",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.chosenCoord.isAbsent()?n.choosePiece(e,t):n.chooseLandingCoord(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){return this.board[t][e]===QG.EMPTY?this.cancelMove(F1.MUST_CHOOSE_PYRAMID_FIRST()):this.board[t][e].value===this.getTurn()%2?(this.chosenCoord=kz.of(new zG(e,t)),lz.SUCCESS):this.cancelMove(F1.MUST_CHOOSE_OWN_PYRAMID())}},{key:"chooseLandingCoord",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new zG(e,t),o=n.rules.node.gameState.getCurrentPlayer(),a=QG.ofPlayer(o),n.board[t][e]!==a){r.next=3;break}return r.abrupt("return",(n.chosenCoord=kz.of(new zG(e,t)),lz.SUCCESS));case 3:if(!(s=j1.from(n.chosenCoord.get(),i)).isFailure()){r.next=8;break}r.t0=n.cancelMove(s.getReason()),r.next=11;break;case 8:return r.next=10,n.chooseMove(s.get(),n.rules.node.gameState);case 10:r.t0=r.sent;case 11:return r.abrupt("return",r.t0);case 12:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.chosenCoord=kz.empty();var e=this.rules.node.move;this.lastCoord=e.map(function(e){return e.coord}),this.lastMoved=e.map(function(e){return e.end}),this.board=this.rules.node.gameState.board}},{key:"getPlayerClassFor",value:function(e,t){return this.getPlayerClass(HG.of(this.board[t][e].value))}}]),n}(b$)).VERBOSE=!1,r2.\u0275fac=function(e){return new(e||r2)(Vp.Lb(qG))},r2.\u0275cmp=Vp.Fb({type:r2,selectors:[["app-sahara"]],features:[Vp.yb],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill small-stroke selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],[1,"base","no-fill","small-stroke","highlighted"],[1,"base","no-fill","small-stroke","selected"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,J1,2,1,"g",1),Vp.Ac(2,X1,3,2,"ng-container",2),Vp.Ac(3,e2,1,1,"polyline",3),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngIf",t.lastMoved.isPresent()),Vp.Bb(1),Vp.mc("ngIf",t.chosenCoord.isPresent()))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),r2),a2=((n2=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this,e,r)).x=e,a.y=r,a.moveDirection=i,a.landingOrientation=o,a.checkValidity(),a}return Kp(n,[{key:"checkValidity",value:function(){var e=this.coord.isInRange(5,5);if(this.isRotation()){if(!e)throw new Error("Cannot rotate piece outside the board: "+this.toString()+".")}else if(this.coord.getNext(this.moveDirection.get()).isNotInRange(5,5)){if(!e)throw new Error("SiamMove should end or start on the board: "+this.toString()+".");if(this.moveDirection.get()!==this.landingOrientation)throw new Error("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+this.toString()+".")}}},{key:"isRotation",value:function(){return this.moveDirection.isAbsent()}},{key:"equals",value:function(e){return this===e||!!this.coord.equals(e.coord)&&!1!==this.moveDirection.equals(e.moveDirection)&&this.landingOrientation===e.landingOrientation}},{key:"toString",value:function(){var e=this.moveDirection.isAbsent()?"-":this.moveDirection.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}},{key:"isInsertion",value:function(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}]),n}(fq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"maxValue",value:function(){return 2408}},{key:"encodeNumber",value:function(e){var t=e.coord.y+1,n=e.coord.x+1,r=e.moveDirection.isAbsent()?4:e.moveDirection.get().toInt();return 245*e.landingOrientation.toInt()+49*r+7*n+t}},{key:"decodeNumber",value:function(e){var t=e%7;e-=t;var n=(e/=7)%7;e-=n;var r=(e/=7)%5,i=4===r?kz.empty():VG.factory.fromInt(r).toOptional();e-=r;var o=VG.factory.fromInt(e/=5).get();return new n2(n-1,t-1,i,o)}}]),n}(wz)),n2),s2=((t2=function(){function e(t){Qp(this,e),this.value=t}return Kp(e,[{key:"belongTo",value:function(e){return e===HG.ZERO?1<=this.value&&this.value<=4:e===HG.ONE&&5<=this.value&&this.value<=8}},{key:"isEmptyOrMountain",value:function(){return 0===this.value||9===this.value}},{key:"isPiece",value:function(){return!this.isEmptyOrMountain()}},{key:"getOwner",value:function(){return 1<=this.value&&this.value<=4?HG.ZERO:5<=this.value&&this.value<=8?HG.ONE:HG.NONE}},{key:"getOptionalDirection",value:function(){switch(this.value){case 0:return kz.empty();case 1:case 5:return kz.of(VG.UP);case 2:case 6:return kz.of(VG.RIGHT);case 3:case 7:return kz.of(VG.DOWN);case 4:case 8:return kz.of(VG.LEFT);default:return dz.expectToBe(this.value,9),kz.empty()}}},{key:"getDirection",value:function(){return this.getOptionalDirection().get()}},{key:"toString",value:function(){switch(this.value){case 0:return"EMPTY";case 1:return"WHITE_UP";case 2:return"WHITE_RIGHT";case 3:return"WHITE_DOWN";case 4:return"WHITE_LEFT";case 5:return"BLACK_UP";case 6:return"BLACK_RIGHT";case 7:return"BLACK_DOWN";case 8:return"BLACK_LEFT";default:return dz.expectToBe(this.value,9),"MOUNTAIN"}}}],[{key:"decode",value:function(t){switch(t){case 0:return e.EMPTY;case 1:return e.WHITE_UP;case 2:return e.WHITE_RIGHT;case 3:return e.WHITE_DOWN;case 4:return e.WHITE_LEFT;case 5:return e.BLACK_UP;case 6:return e.BLACK_RIGHT;case 7:return e.BLACK_DOWN;case 8:return e.BLACK_LEFT;case 9:return e.MOUNTAIN}}},{key:"of",value:function(t,n){if(n===HG.NONE)throw new Error("Player None does not have any pieces.");return n===HG.ZERO?t===VG.UP?e.WHITE_UP:t===VG.RIGHT?e.WHITE_RIGHT:t===VG.DOWN?e.WHITE_DOWN:e.WHITE_LEFT:t===VG.UP?e.BLACK_UP:t===VG.RIGHT?e.BLACK_RIGHT:t===VG.DOWN?e.BLACK_DOWN:e.BLACK_LEFT}}]),e}()).EMPTY=new t2(0),t2.WHITE_UP=new t2(1),t2.WHITE_RIGHT=new t2(2),t2.WHITE_DOWN=new t2(3),t2.WHITE_LEFT=new t2(4),t2.BLACK_UP=new t2(5),t2.BLACK_RIGHT=new t2(6),t2.BLACK_DOWN=new t2(7),t2.BLACK_LEFT=new t2(8),t2.MOUNTAIN=new t2(9),t2),u2=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"countPlayerPawn",value:function(){for(var e=0,t=0;t<5;t++)for(var n=0;n<5;n++)this.board[t][n].belongTo(this.getCurrentPlayer())&&e++;return e}}],[{key:"getInitialState",value:function(){var e=rq.createTable(5,5,s2.EMPTY);return e[2][1]=s2.MOUNTAIN,e[2][2]=s2.MOUNTAIN,e[2][3]=s2.MOUNTAIN,new n(e,0)}}]),n}(cq),c2=function(){var e=function e(){Qp(this,e)};return e.CANNOT_INSERT_WHEN_SELECTED=function(){return $localize(Qs||(Qs=xp(["You cannot insert a piece when you have already selected a piece."])))},e.NO_REMAINING_PIECE_TO_INSERT=function(){return $localize(Ys||(Ys=xp(["You cannot insert a piece, all your pieces are already on the board."])))},e.NOT_ENOUGH_FORCE_TO_PUSH=function(){return $localize(Ks||(Ks=xp(["You do not have enough strength to push."])))},e.ILLEGAL_ROTATION=function(){return $localize(Js||(Js=xp(["You cannot push and turn at the same time."])))},e.ILLEGAL_PUSH=function(){return $localize(Xs||(Xs=xp(["Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board."])))},e}(),l2=function e(t,n){Qp(this,e),this.resultingBoard=t,this.moved=n},h2=((i2=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"isLegal",value:function(e,t){if(pz(n.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return sz.failure(nq.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return pz(n.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);var r;if(e.isInsertion()){pz(n.VERBOSE,"Move is insertion");var i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return sz.failure(i.legal.getReason());r=i.insertedPiece}else pz(n.VERBOSE,"Move is forward"),r=t.getPieceAt(e.coord);return n.isLegalForwarding(e,t,r)}},{key:"isLegalInsertion",value:function(e,t){var r=t.countPlayerPawn(),i=t.getCurrentPlayer(),o=r<5?lz.SUCCESS:lz.failure(c2.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:n.getInsertedPiece(e,i),legal:o}}},{key:"isLegalRotation",value:function(e,t){pz(n.VERBOSE,{isLegalRotation:{rotation:e,state:t}});var r=e.coord,i=t.getPieceAt(r),o=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return sz.failure(c2.ILLEGAL_ROTATION());var a=t.getCopiedBoard();return a[r.y][r.x]=s2.of(e.landingOrientation,o),sz.success(new l2(a,[r]))}},{key:"applyLegalMove",value:function(e,t,n){var r=rq.copyBiArray(n.resultingBoard);return new u2(r,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=n.getMountainsRowsAndColumns(e.gameState),r=n.getWinner(e.gameState,e.move,t.nbMountain);return r===HG.NONE?bq.ONGOING:bq.getVictory(r)}}],[{key:"getInsertedPiece",value:function(e,t){return s2.of(-1===e.x?VG.RIGHT:-1===e.y?VG.DOWN:5===e.x?VG.LEFT:VG.UP,t)}},{key:"isLegalForwarding",value:function(e,t,r){pz(n.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:r}});var i=[],o=s2.of(e.landingOrientation,t.getCurrentPlayer()),a=e.moveDirection.get(),s=e.coord.getNext(a);if(s.isInRange(5,5)&&t.getPieceAt(s)!==s2.EMPTY&&!1===n.isStraight(r,e))return pz(n.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),sz.failure(c2.ILLEGAL_PUSH());var u=kz.of(a),c=a.getOpposite(),l=0,h=t.getCopiedBoard();e.coord.isInRange(5,5)&&(h[e.coord.y][e.coord.x]=s2.EMPTY,i.push(e.coord));for(var f=s.isInRange(5,5)&&o!==s2.EMPTY;f;){u.equalsValue(a)?l++:u.equalsValue(c)&&l--,pz(n.VERBOSE,{totalForce:l,movingPiece:o,landingCoord:s});var d=h[s.y][s.x];d===s2.MOUNTAIN&&(l-=.9),h[s.y][s.x]=o,i.push(s),o=d,s=s.getNext(a),u=o.getOptionalDirection(),f=s.isInRange(5,5)&&o!==s2.EMPTY&&l>0}return s.isNotInRange(5,5)&&(pz(n.VERBOSE,"This movement would push "+o+" outside the board"),u.equalsValue(a)?l++:u.equalsValue(c)&&l--),l<=0?(pz(n.VERBOSE,"This move is an illegal push: "+h),sz.failure(c2.NOT_ENOUGH_FORCE_TO_PUSH())):(pz(n.VERBOSE,"This move is a legal push: "+h),sz.success(new l2(h,i)))}},{key:"isStraight",value:function(e,t){var n=e.getDirection();return t.moveDirection.equalsValue(n)&&n===t.landingOrientation}},{key:"getBoardValueInfo",value:function(e,t){var r=n.getMountainsRowsAndColumns(t),i=r.rows,o=r.columns,a=n.getWinner(t,e,r.nbMountain);if(a===HG.NONE){var s,u=n.getPushers(t,o,i),c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,h=t.getCurrentPlayer(),f=zp(u);try{for(f.s();!(s=f.n()).done;){var d=s.value;d.coord.isInRange(5,5)?t.getPieceAt(d.coord).belongTo(HG.ZERO)?c=Math.min(c,d.distance):l=Math.min(l,d.distance):h===HG.ZERO?c=Math.min(c,d.distance):l=Math.min(l,d.distance)}}catch(p){f.e(p)}finally{f.f()}return{shortestZero:c,shortestOne:l,boardValue:n.getScoreFromShortestDistances(c,l,h)}}return a===HG.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER}}},{key:"getScoreFromShortestDistances",value:function(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);var r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}},{key:"getMountainsRowsAndColumns",value:function(e){for(var t=[],n=[],r=0,i=0;i<5;i++)for(var o=0;o<5;o++)e.getPieceAtXY(o,i)===s2.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(o)||n.push(o),r++);return{rows:t,columns:n,nbMountain:r}}},{key:"getWinner",value:function(e,t,r){return 2===r?n.getPusher(e,t.get()):HG.NONE}},{key:"getPusher",value:function(e,t){var r=t.coord,i=(r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):n.getInsertedPiece(r,e.getCurrentOpponent())).getDirection(),o=n.getPusherCoord(e,i,r),a=e.getPieceAt(o).getOwner();return pz(n.VERBOSE,r.toString()+" belong to "+e.getCurrentOpponent().value+", "+o.toString()+" belong to "+a.value+", "+a.value+" win"),a}},{key:"getPusherCoord",value:function(e,t,n){for(var r=n.getNext(t),i=n;r.isInRange(5,5);){n=r,r=r.getNext(t);var o=e.getPieceAt(n);o!==s2.MOUNTAIN&&o.getDirection()===t&&(i=n)}return i}},{key:"getPushers",value:function(e,t,r){pz(n.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:r}});var i,o=[],a=[],s=zp(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=VG.DOWN,l=new zG(u,4);a.push({direction:c,fallingCoord:l}),c=VG.UP,l=new zG(u,0),a.push({direction:c,fallingCoord:l})}}catch(b){s.e(b)}finally{s.f()}var h,f=zp(r);try{for(f.s();!(h=f.n()).done;){var d=h.value,p=VG.LEFT,v=new zG(0,d);a.push({direction:p,fallingCoord:v}),p=VG.RIGHT,v=new zG(4,d),a.push({direction:p,fallingCoord:v})}}catch(b){f.e(b)}finally{f.f()}for(var g=0,y=a;g<y.length;g++){var m=y[g];o=n.addPotentialDirectionPusher(e,m.fallingCoord,m.direction,o)}return o}},{key:"addPotentialDirectionPusher",value:function(e,t,r,i){var o=n.getLineClosestPusher(e,t,r);if(o.isAbsent())return i;var a=o.get(),s=a.distance;return pz(n.VERBOSE,"new closest challenger"),i.push({coord:a.coord,distance:s}),i}},{key:"getLineClosestPusher",value:function(e,t,r){pz(n.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:r.toString()}});for(var i=r.getOpposite(),o=1,a=e.getPieceAt(t),s=t,u=kz.empty(),c=!1,l=!1,h=0;s.isInRange(5,5)&&!1===c;){var f=e.getPieceAt(s);if(f.isEmptyOrMountain())f===s2.MOUNTAIN?(h+=.9,l=!0):o++;else{var d=f.getDirection();d===r?l&&(h-=1)<=0&&(c=!0,s=s.getNext(r)):d===i?(h+=1,l||o++):l?(u=kz.of(s),a!==s2.EMPTY&&o++):o++}a=f,s=s.getPrevious(r)}if(!1===c&&u.isPresent())for(o++,h-=1;!1===s.equals(u.get());)s=s.getNext(r),o--;return s.isNotInRange(5,5)&&(h-=1,5===e.countPlayerPawn())||h>0?kz.empty():kz.of({distance:o,coord:s})}},{key:"getPushingInsertions",value:function(e){for(var t=[],n=e.gameState.getCurrentPlayer(),r=[],i=[],o=0;o<5;o++)r.push(new a2(-1,o,kz.of(VG.RIGHT),VG.RIGHT)),i.push(s2.of(VG.RIGHT,n)),r.push(new a2(5,o,kz.of(VG.LEFT),VG.LEFT)),i.push(s2.of(VG.LEFT,n)),r.push(new a2(o,-1,kz.of(VG.DOWN),VG.DOWN)),i.push(s2.of(VG.DOWN,n)),r.push(new a2(o,5,kz.of(VG.UP),VG.UP)),i.push(s2.of(VG.UP,n));for(var a=0;a<r.length;a++)this.isLegalForwarding(r[a],e.gameState,i[a]).isSuccess()&&t.push(r[a]);return t}},{key:"getDerapingInsertions",value:function(e){for(var t,n,r=[],i=e.gameState.getCurrentPlayer(),o=1;o<=3;o++)t=new a2(-1,o,kz.of(VG.RIGHT),VG.UP),n=s2.of(VG.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new a2(-1,o,kz.of(VG.RIGHT),VG.DOWN),n=s2.of(VG.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new a2(5,o,kz.of(VG.LEFT),VG.UP),n=s2.of(VG.UP,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new a2(5,o,kz.of(VG.LEFT),VG.DOWN),n=s2.of(VG.DOWN,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));for(var a=1;a<=3;a++)t=new a2(a,-1,kz.of(VG.DOWN),VG.LEFT),n=s2.of(VG.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new a2(a,-1,kz.of(VG.DOWN),VG.RIGHT),n=s2.of(VG.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t)),t=new a2(a,5,kz.of(VG.UP),VG.LEFT),n=s2.of(VG.LEFT,i),this.isLegalForwarding(t,e.gameState,n).isSuccess()&&(r.push(t),t=new a2(a,5,kz.of(VG.UP),VG.RIGHT),n=s2.of(VG.RIGHT,i),this.isLegalForwarding(t,e.gameState,n),r.push(t));return r}},{key:"getCoordDirection",value:function(e,t,n){var r=new zG(e,t);return this.getInsertedPiece(r,n.getCurrentPlayer()).getDirection()}}]),n}(_q)).VERBOSE=!1,i2),f2=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getBoardValue",value:function(e){return new oq(h2.getBoardValueInfo(e.move,e.gameState).boardValue)}},{key:"getListMoves",value:function(e){for(var t,n=[],r=e.gameState.getCurrentPlayer(),i=0;i<5;i++)for(var o=0;o<5;o++)if((t=e.gameState.getPieceAtXY(o,i)).belongTo(r)){var a,s=t.getDirection(),u=zp(VG.ORTHOGONALS);try{for(u.s();!(a=u.n()).done;){var c=a.value;if(c!==s){var l=e.gameState.getCopiedBoard(),h=new a2(o,i,kz.empty(),c);l[i][o]=s2.of(c,r),n.push(h)}var f,d=zp(new zG(o+c.x,i+c.y).isInRange(5,5)?VG.ORTHOGONALS:[c]);try{for(d.s();!(f=d.n()).done;){var p=f.value,v=new a2(o,i,kz.of(c),p);h2.isLegalForwarding(v,e.gameState,t).isSuccess()&&n.push(v)}}catch(g){d.e(g)}finally{d.f()}}}catch(g){u.e(g)}finally{u.f()}}return e.gameState.countPlayerPawn()<5&&(n=(n=n.concat(h2.getPushingInsertions(e))).concat(h2.getDerapingInsertions(e))),pz(h2.VERBOSE,{getListMovesResult:n}),n}}]),n}(iq),d2=s2.EMPTY,p2=s2.MOUNTAIN,v2=s2.WHITE_UP,g2=s2.WHITE_LEFT,y2=s2.WHITE_RIGHT,m2=s2.WHITE_DOWN,b2=s2.BLACK_UP,_2=s2.BLACK_LEFT,w2=s2.BLACK_RIGHT,k2=s2.BLACK_DOWN,C2=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(eu||(eu=xp(["Goal of the game"]))),$localize(tu||(tu=xp(["The goal at Siam is to be the first to push a mountain out of the board.\n        The initial board contains three mountains, and no pieces are initially on the board.\n        During its turn, a player can do one of the following three actions:\n        <ol>\n            <li>Put a new piece on the board.</li>\n            <li>Change the orientation of one of its piece, and optionally move it.</li>\n            <li>Take one of its pieces out of the board.</li>\n        </ol>"]))),u2.getInitialState()),Eq.anyMove($localize(nu||(nu=xp(["Inserting a piece"]))),$localize(ru||(ru=xp(["Each player has 5 pieces in total.\n        As long as you do not have 5 pieces on the board, you can insert new pieces. To do so:\n        <ol>\n            <li>Click on one of the big arrows alongside the board.</li>\n            <li>Click on one of the small arrows that appeared on the landing square of your piece.\n                This is the direction in which your piece will be oriented.</li>\n        </ol><br/>\n        Insert a piece on the board."]))),u2.getInitialState(),new a2(2,-1,kz.of(VG.DOWN),VG.DOWN),$localize(iu||(iu=xp(["Congratulations!"])))),Eq.fromMove($localize(ou||(ou=xp(["Moving a piece"]))),$localize(au||(au=xp(['We will distinguish here "moving" and "pushing".\n        A move is made from a piece\'s square to an empty neighboring square, horizontally or vertically.\n        During that move, you can also move the piece out of the board.\n        To move a piece:\n        <ol>\n            <li>Click on it.</li>\n            <li>Click on one of the 4 arrows to pick the direction in which it will move.\n                You can also click on the middle dot to change the piece\'s orientation without moving it.</li>\n            <li>Click on one of the 4 arrows on the landing square to pick its orientation.</li>\n        </ol><br/>\n        Try to move the piece that is on the board one square upwards and to orient it downwards.']))),new u2([[d2,d2,d2,d2,d2],[d2,d2,d2,d2,d2],[d2,p2,p2,p2,d2],[d2,d2,d2,d2,d2],[d2,d2,v2,d2,d2]],0),[new a2(2,4,kz.of(VG.UP),VG.DOWN)],$localize(su||(su=xp(["Congratulations, you made a side-slip!"]))),$localize(uu||(uu=xp(["Failed!"])))),Eq.fromMove($localize(cu||(cu=xp(["Moving a piece out of the board"]))),$localize(lu||(lu=xp(["To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>\n        Get that piece out of the board!"]))),new u2([[d2,d2,d2,d2,d2],[d2,d2,d2,d2,d2],[d2,p2,p2,p2,d2],[d2,d2,d2,d2,d2],[d2,d2,v2,d2,d2]],0),[new a2(2,4,kz.of(VG.DOWN),VG.DOWN)],$localize(hu||(hu=xp(["Congratulations, even if in this context it was not a useful move."]))),$localize(fu||(fu=xp(["Failed, the piece is still on the board."])))),Eq.fromMove($localize(du||(du=xp(["Pushing"]))),$localize(pu||(pu=xp(['When the landing square of your move is occupied, we use the term "push".\n        In order to push, multiple conditions must hold:\n        <ol>\n            <li>Your piece must already be oriented in the direction of the push.</li>\n            <li>The number of the pieces (opponent\'s or not) that are facing yours (called the resistants)\n                must be smaller than the number of pieces that are oriented in the same direction as the push, yourself included (the pushers).</li>\n            <li>The number of mountains on that line must be smaller or equal to the difference between the pushers and the resistants.</li>\n        </ol>\n        Your piece on the top right cannot push because there is one mountain too much.\n        Your piece on the bottom right can push.<br/><br/>\n        Do it.']))),new u2([[y2,p2,p2,_2,g2],[d2,d2,d2,d2,d2],[d2,d2,d2,p2,d2],[d2,d2,d2,d2,d2],[d2,d2,w2,_2,g2]],0),[new a2(4,4,kz.of(VG.LEFT),VG.LEFT)],$localize(vu||(vu=xp(["Congratulations!"]))),$localize(gu||(gu=xp(["Failed!"])))),Eq.fromMove($localize(yu||(yu=xp(["Victory"]))),$localize(mu||(mu=xp(["The game ends when a mountain is pushed out of the board.\n        If you pushed it and nobody is in front of you, you're the winner.\n        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.\n        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>\n        You have two ways of ending the game here: you can either win, or lose. Choose correctly!"]))),new u2([[d2,d2,d2,d2,d2],[d2,d2,d2,d2,d2],[p2,b2,g2,d2,m2],[d2,d2,d2,d2,k2],[d2,d2,d2,d2,p2]],0),[new a2(2,2,kz.of(VG.LEFT),VG.LEFT)],$localize(bu||(bu=xp(["Congratulations, you won!"]))),$localize(_u||(_u=xp(["Failed, you lost."]))))]};function E2(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"use",7),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(3).insertAt(e.x,e.y)}),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc(3);Vp.oc("id","insertAt_",r.x,"_",r.y,""),Vp.Cb("transform",i.getInsertionArrowTransform(r.x+1,r.y+1,r.dir))}}var O2=function(e,t){return{dir:"DOWN",x:e,y:t}},S2=function(e){return{dir:"UP",x:e,y:5}},P2=function(e,t){return{dir:"RIGHT",x:e,y:t}},I2=function(e){return{dir:"LEFT",x:5,y:e}},T2=function(e,t,n,r){return[e,t,n,r]};function A2(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,E2,1,3,"use",6),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",Vp.tc(11,T2,Vp.sc(1,O2,n,-1),Vp.rc(4,S2,n),Vp.sc(6,P2,-1,n),Vp.rc(9,I2,n)))}}var N2=function(){return[0,1,2,3,4]};function x2(e,t){1&e&&(Vp.ec(),Vp.Ob(0),Vp.Ac(1,A2,2,16,"g",5),Vp.Nb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",Vp.qc(1,N2)))}function R2(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"use",13),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(5).chooseDirection(e)}),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc(3).index,o=Vp.fc().index,a=Vp.fc();Vp.nc("id","chooseDirection_",r,""),Vp.Cb("transform",a.getArrowTransform(i+1,o+1,r))}}var M2=function(){return["RIGHT","DOWN","LEFT","UP"]};function D2(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"circle",11),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(4).chooseDirection("")}),Vp.Pb(),Vp.Ac(2,R2,1,2,"use",12),Vp.Pb()}if(2&e){var r=Vp.fc(2).index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.Cb("cx",(r+1)*o.SPACE_SIZE+o.SPACE_SIZE/2)("cy",(i+1)*o.SPACE_SIZE+o.SPACE_SIZE/2),Vp.Bb(1),Vp.mc("ngForOf",Vp.qc(3,M2))}}function L2(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"use",10),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc().index;return Vp.fc().clickPiece(e,t)}),Vp.Pb(),Vp.Ac(2,D2,3,4,"g",4),Vp.Pb()}if(2&e){var r=Vp.fc(),i=r.index,o=r.$implicit,a=Vp.fc().index,s=Vp.fc();Vp.Bb(1),Vp.oc("id","clickPiece_",i,"_",a,""),Vp.mc("ngClass",s.getPieceClasses(o)),Vp.Cb("transform",s.getPieceTransform(i,a)),Vp.Bb(1),Vp.mc("ngIf",s.choosingDirection(i,a))}}function B2(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"use",14)),2&e){var n=Vp.fc().index,r=Vp.fc().index,i=Vp.fc();Vp.Cb("transform","translate("+(n+1)*i.SPACE_SIZE+" "+(r+1)*i.SPACE_SIZE+")")}}function F2(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"use",13),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(4).chooseOrientation(e)}),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc(2).index,o=Vp.fc().index,a=Vp.fc();Vp.nc("id","chooseOrientation_",r,""),Vp.Cb("transform",a.getArrowTransform(i+1,o+1,r))}}function j2(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,F2,1,2,"use",12),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",Vp.qc(1,M2)))}function U2(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",8),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().insertAt(e,r)}),Vp.Pb(),Vp.Ac(2,L2,3,5,"g",4),Vp.Ac(3,B2,1,1,"use",9),Vp.Ac(4,j2,2,2,"g",4),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.fc().index,a=Vp.fc();Vp.Bb(1),Vp.oc("id","insertAt_",i,"_",o,""),Vp.mc("ngClass",a.getSquareClasses(i,o)),Vp.Cb("x",a.SPACE_SIZE*(i+1))("y",a.SPACE_SIZE*(o+1))("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",r.isPiece()),Vp.Bb(1),Vp.mc("ngIf",a.isMountain(r)),Vp.Bb(1),Vp.mc("ngIf",a.choosingOrientation(i,o))}}function V2(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,U2,5,10,"g",5),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}var z2,H2,G2=((z2=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).lastMove=kz.empty(),r.chosenCoord=kz.empty(),r.landingCoord=kz.empty(),r.chosenDirection=kz.empty(),r.chosenOrientation=kz.empty(),r.movedPieces=[],r.rules=new h2(u2),r.availableMinimaxes=[new f2(r.rules,"SiamMinimax")],r.encoder=a2.encoder,r.tutorial=(new C2).tutorial,r.updateBoard(),r}return Kp(n,[{key:"updateBoard",value:function(){if(pz(n.VERBOSE,"updateBoard"),this.board=this.rules.node.gameState.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=kz.empty(),this.chosenDirection=kz.empty(),this.landingCoord=kz.empty(),this.chosenOrientation=kz.empty()}},{key:"clickPiece",value:function(e,t){var n=this.canUserPlay("#clickPiece_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=this.board[t][e],i=this.rules.node.gameState.getCurrentOpponent();return r.getOwner()===i?this.cancelMove(nq.MUST_CHOOSE_PLAYER_PIECE()):(this.chosenCoord=kz.of(new zG(e,t)),lz.SUCCESS)}},{key:"chooseDirection",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function r(){var i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(pz(n.VERBOSE,"SiamComponent.chooseDirection("+e+")"),!(i=t.canUserPlay("#chooseDirection_"+e)).isFailure()){r.next=4;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 4:if(""!==e){r.next=8;break}t.chosenDirection=kz.empty(),t.landingCoord=t.chosenCoord,r.next=15;break;case 8:if(o=VG.factory.fromString(e).get(),t.chosenDirection=kz.of(o),t.landingCoord=kz.of(t.chosenCoord.get().getNext(o)),!t.landingCoord.get().isNotInRange(5,5)){r.next=15;break}return pz(n.VERBOSE,"orientation and direction should be the same: "+o),t.chosenOrientation=kz.of(o),r.next=14,t.tryMove();case 14:return r.abrupt("return",r.sent);case 15:return r.abrupt("return",lz.SUCCESS);case 16:case"end":return r.stop()}},r)}))()}},{key:"chooseOrientation",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(pz(n.VERBOSE,"SiamComponent.chooseOrientation("+e+")"),!(i=t.canUserPlay("#chooseOrientation_"+e)).isFailure()){r.next=6;break}r.t0=t.cancelMove(i.getReason()),r.next=10;break;case 6:return t.chosenOrientation=kz.of(VG.factory.fromString(e).get()),r.next=9,t.tryMove();case 9:r.t0=r.sent;case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"insertAt",value:function(e,t){var r=this;return JV(regeneratorRuntime.mark(function i(){var o,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(pz(n.VERBOSE,"SiamComponent.insertAt("+e+", "+t+")"),!(o=r.canUserPlay("#insertAt_"+e+"_"+t)).isFailure()){i.next=4;break}return i.abrupt("return",r.cancelMove(o.getReason()));case 4:if(!r.chosenCoord.isPresent()){i.next=6;break}return i.abrupt("return",r.cancelMove(c2.CANNOT_INSERT_WHEN_SELECTED()));case 6:return r.chosenCoord=kz.of(new zG(e,t)),a=h2.getCoordDirection(e,t,r.rules.node.gameState),i.abrupt("return",(r.chosenDirection=kz.of(a),r.landingCoord=kz.of(r.chosenCoord.get().getNext(a)),lz.SUCCESS));case 9:case"end":return i.stop()}},i)}))()}},{key:"tryMove",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new a2(n.x,n.y,e.chosenDirection,e.chosenOrientation.get()),e.cancelMove(),t.next=4,e.chooseMove(r,e.rules.node.gameState);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}))()}},{key:"isMountain",value:function(e){return e===s2.MOUNTAIN}},{key:"choosingOrientation",value:function(e,t){var r=new zG(e,t);return!!(this.chosenCoord.isPresent()&&this.landingCoord.equalsValue(r)&&this.chosenOrientation.isAbsent())&&(pz(n.VERBOSE,"choosing orientation now"),!0)}},{key:"choosingDirection",value:function(e,t){var r=new zG(e,t);return!!(this.chosenCoord.equalsValue(r)&&this.chosenDirection.isAbsent()&&this.landingCoord.isAbsent()&&this.chosenOrientation.isAbsent())&&(pz(n.VERBOSE,"choosing direction now"),!0)}},{key:"getInsertionArrowTransform",value:function(e,t,n){var r=VG.factory.fromString(n).get().toInt()-2;return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")","rotate(".concat(90*r," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")")].join(" ")}},{key:"getPieceTransform",value:function(e,t){var n=this.board[t][e].getDirection().toInt()-2;return["translate("+(e+1)*this.SPACE_SIZE+", "+(t+1)*this.SPACE_SIZE+")","rotate(".concat(90*n," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")")].join(" ")}},{key:"getArrowTransform",value:function(e,t,n){return i1.getArrowTransform(this.SPACE_SIZE,new zG(e,t),VG.factory.fromString(n).get())}},{key:"getPieceClasses",value:function(e){return[this.getPlayerClass(e.getOwner())]}},{key:"getSquareClasses",value:function(e,t){var n=new zG(e,t);return this.movedPieces.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(dW)).VERBOSE=!1,z2.\u0275fac=function(e){return new(e||z2)(Vp.Lb(qG))},z2.\u0275cmp=Vp.Fb({type:z2,selectors:[["app-siam"]],features:[Vp.yb],decls:7,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 700 700","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 93, 90 50, 70 50, 70 7, 27.5 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngIf"],[4,"ngFor","ngForOf"],[0,"xlink","href","#arrow","class","base mid-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","click"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#mountain","fill","brown",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],["id","chooseDirection_","r","8",1,"arrow","selected-fill","no-stroke",3,"click"],[0,"xlink","href","#triangle","class","arrow selected-fill no-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"arrow","selected-fill","no-stroke",3,"id","click"],[0,"xlink","href","#mountain","fill","brown"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Qb(1,"defs"),Vp.Mb(2,"polygon",1),Vp.Mb(3,"polygon",2),Vp.Mb(4,"polygon",3),Vp.Pb(),Vp.Ac(5,x2,2,2,"ng-container",4),Vp.Ac(6,V2,2,1,"g",5),Vp.Pb()),2&e&&(Vp.Bb(5),Vp.mc("ngIf",t.isPlayerTurn()),Vp.Bb(1),Vp.mc("ngForOf",t.board))},directives:[yg,vg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),z2),q2=function(){var e=function e(){Qp(this,e)};return e.NO_MOVEMENT_BEFORE_TURN_40=function(){return $localize(wu||(wu=xp(["You cannot move yet. Pick a space where you will put a new piece."])))},e.MUST_CUT=function(){return $localize(ku||(ku=xp(["Several groups are of the same size, you must pick the one to keep."])))},e.CANNOT_CHOOSE_TO_KEEP=function(){return $localize(Cu||(Cu=xp(["You cannot choose which part to keep when one is smaller than the other."])))},e.CAN_NO_LONGER_DROP=function(){return $localize(Eu||(Eu=xp(["You cannot put new pieces anymore. Pick a piece to move."])))},e.MUST_CAPTURE_BIGGEST_GROUPS=function(){return $localize(Ou||(Ou=xp(["You must choose one of the biggest groups to keep it."])))},e.CANNOT_KEEP_EMPTY_COORD=function(){return $localize(Su||(Su=xp(["You cannot pick an empty space. Pick one of the biggest groups."])))},e.MUST_DROP_NEXT_TO_OTHER_PIECE=function(){return $localize(Pu||(Pu=xp(["You must put this piece next to another piece."])))},e}(),W2=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;Qp(this,n),(o=t.call(this,r)).pieces=e;var a=o.getCalculatedScale();return o.pieces=a.pieces,o.width=a.width,o.height=a.height,o.offset=i||a.offset,o.pieces.makeImmutable(),o}return Kp(n,[{key:"getCalculatedScale",value:function(){var e,t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,o=zp(this.pieces.listKeys());try{for(o.s();!(e=o.n()).done;){var a=e.value;t=Math.min(a.x,t),n=Math.max(a.x,n),r=Math.min(a.y,r),i=Math.max(a.y,i)}}catch(p){o.e(p)}finally{o.f()}var s=new gq,u=new DG(-t,-r);if(0!==t||0!==r){var c,l=zp(this.pieces.listKeys());try{for(l.s();!(c=l.n()).done;){var h=c.value,f=this.pieces.delete(h),d=h.getNext(u);s.set(d,f)}}catch(p){l.e(p)}finally{l.f()}}else s=this.pieces;return{width:n+1-t,height:i+1-r,pieces:s,offset:u}}},{key:"toRepresentation",value:function(){var e,t=rq.createTable(this.width,this.height,HG.NONE.value),n=zp(this.pieces.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.getPieceAt(r).value;t[r.y][r.x]=i}}catch(o){n.e(o)}finally{n.f()}return t}},{key:"isIllegalLandingZone",value:function(e,t){return this.pieces.containsKey(e)?lz.failure(nq.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?lz.SUCCESS:lz.failure(q2.MUST_DROP_NEXT_TO_OTHER_PIECE())}},{key:"isCoordConnected",value:function(e,t){var n,r=zp(KG.factory.all);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=e.getNext(i,1);if(this.pieces.containsKey(o)&&!1===t.equalsValue(o))return!0}}catch(a){r.e(a)}finally{r.f()}return!1}},{key:"isOnBoard",value:function(e){return this.pieces.containsKey(e)}},{key:"getPieceAt",value:function(e){return this.isOnBoard(e)?this.pieces.get(e).get():HG.NONE}},{key:"applyLegalDrop",value:function(e){var t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new n(t,this.turn+1)}},{key:"applyLegalDeplacement",value:function(e,t){var r=n.deplacePiece(this,e),i=new gq;if(t.size()>0){i=new gq;var o,a=zp(t);try{for(a.s();!(o=a.n()).done;){var s=o.value;i.set(s,r.get(s).get())}}catch(u){a.e(u)}finally{a.f()}}else i=r.getCopy();return new n(i,this.turn+1)}},{key:"countPieces",value:function(){var e=this.pieces.reverse(),t=e.get(HG.ZERO).getOrElse(new qW),n=e.get(HG.ONE).getOrElse(new qW);return[t.size(),n.size()]}},{key:"switchPiece",value:function(e){var t=this.pieces.getCopy(),r=this.getPieceAt(e);return t.replace(e,r.getOpponent()),new n(t,this.turn,this.offset)}},{key:"equals",value:function(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation([[HG.ZERO.value],[HG.ONE.value]],0)}},{key:"fromRepresentation",value:function(e,t,r){for(var i=new gq,o=0;o<e.length;o++)for(var a=0;a<e[0].length;a++)e[o][a]!==HG.NONE.value&&i.set(new zG(a,o),HG.of(e[o][a]));return new n(i,t,r)}},{key:"deplacePiece",value:function(e,t){var n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}},{key:"getGroups",value:function(e,t){var r,i=new gq,o=0,a=zp(KG.factory.all);try{for(a.s();!(r=a.n()).done;){var s=r.value,u=t.getNext(s,1);i=n.putCoordInGroup(e,u,i,""+o),o++}}catch(f){a.e(f)}finally{a.f()}for(var c=i.reverse(),l=new sq,h=0;h<c.size();h++)l.add(c.getByIndex(h).value);return l}},{key:"putCoordInGroup",value:function(e,t,r,i){if(e.get(t).isPresent()&&r.get(t).isAbsent()){r.set(t,i);var o,a=zp(KG.factory.all);try{for(a.s();!(o=a.n()).done;){var s=o.value,u=t.getNext(s,1);r=n.putCoordInGroup(e,u,r,i)}}catch(c){a.e(c)}finally{a.f()}}return r}}]),n}(uq),$2=((H2=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;if(Qp(this,n),(o=t.call(this)).start=e,o.landing=r,o.keep=i,e.equalsValue(r))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(i))throw new Error("Cannot keep starting coord, since it will always be empty after move!");return tv(o)}return Kp(n,[{key:"isDrop",value:function(){return this.start.isAbsent()}},{key:"isCut",value:function(){return this.keep.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}},{key:"equals",value:function(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}],[{key:"fromDrop",value:function(e){return new n(kz.empty(),e,kz.empty())}},{key:"fromMovement",value:function(e,t){return new n(kz.of(e),t,kz.empty())}},{key:"fromCut",value:function(e,t,r){return new n(kz.of(e),t,kz.of(r))}}]),n}(hq)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"encodeMove",value:function(e){return{start:e.start.isPresent()?zG.encoder.encode(e.start.get()):null,landing:zG.encoder.encode(e.landing),keep:e.keep.isPresent()?zG.encoder.encode(e.keep.get()):null}}},{key:"decodeMove",value:function(e){var t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");var n=zG.encoder.decode(t.landing);if(null==t.start)return H2.fromDrop(n);var r=zG.encoder.decode(t.start);if(null==t.keep)return H2.fromMovement(r,n);var i=zG.encoder.decode(t.keep);return H2.fromCut(r,n,i)}}]),n}(_z)),H2),Z2=function(e){Jp(n,e);var t=ev(n);function n(){var e;return Qp(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}},{key:"isLegal",value:function(e,t){pz(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});var r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):n.isLegalPhaseTwoMove(e,t)}},{key:"isLegalDrop",value:function(e,t){return!1===e.isDrop()?sz.failure(q2.NO_MOVEMENT_BEFORE_TURN_40()):sz.success(t.pieces.getKeySet())}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getCurrentOpponent(),r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return bq.getVictory(n);if(t.turn>39){var i=t.countPieces(),o=i[0],a=i[1];return o<6&&a<6?o<a?bq.ONE_WON:a<o?bq.ZERO_WON:bq.DRAW:o<6?bq.getDefeat(HG.ZERO):a<6?bq.getDefeat(HG.ONE):bq.ONGOING}return bq.ONGOING}},{key:"startSearchingVictorySources",value:function(){pz(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"getShapeVictory",value:function(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();var n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(pz(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){pz(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],o=t.getNext(KG.factory.all[e],1);i.length<6;){if(n.getPieceAt(o)!==r)return[];var a=(e+i.length)%6;i.push(o),o=o.getNext(KG.factory.all[a],1)}return i}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=KG.factory.all[e],o=t.getNext(i,1),a=[t],s=!1;a.length<6;){if(n.getPieceAt(o)===r)a.push(o);else{if(s)return[];s=!0,i=i.getOpposite(),o=o.getNext(i,a.length)}o=o.getNext(i,1)}return a}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){pz(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=KG.factory.all[e],o=[t],a=t.getNext(i,1);o.length<6;){if(n.getPieceAt(a)!==r)return[];o.length%2==0&&(i=KG.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(i,1)}return o}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){pz(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=KG.factory.all[e],o=[t],a=t.getNext(i,1);o.length<6;){if(n.getPieceAt(a)!==r)return[];o.push(a),o.length%2==0&&(i=KG.factory.all[(e+o.length)%6]),a=a.getNext(i,1)}return o}}],[{key:"getLegalLandings",value:function(e){var t,n=new qW,r=zp(e.pieces.listKeys());try{for(r.s();!(t=r.n()).done;){var i,o=t.value,a=zp(KG.factory.all);try{for(a.s();!(i=a.n()).done;){var s=i.value,u=o.getNext(s,1);e.getPieceAt(u)===HG.NONE&&n.add(u)}}catch(c){a.e(c)}finally{a.f()}}}catch(c){r.e(c)}finally{r.f()}return n.toList()}},{key:"isLegalPhaseTwoMove",value:function(e,t){if(e.isDrop())return sz.failure(q2.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case HG.NONE:return sz.failure(nq.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return sz.failure(nq.CANNOT_CHOOSE_OPPONENT_PIECE())}var r=W2.deplacePiece(t,e),i=W2.getGroups(r,e.start.get());if(n.isSplit(i)){var o=this.getBiggerGroups(i);return 1===o.size()?e.keep.isPresent()?sz.failure(q2.CANNOT_CHOOSE_TO_KEEP()):sz.success(o.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,o,r)}return sz.success(new qW)}},{key:"isSplit",value:function(e){return e.size()>1}},{key:"getBiggerGroups",value:function(e){var t,n=0,r=new sq,i=zp(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=o.size();a>n?(n=a,r=new sq([o])):a===n&&r.add(o)}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"moveKeepBiggerGroup",value:function(e,t,n){if(e.isAbsent())return sz.failure(q2.MUST_CUT());if(n.get(e.get()).isAbsent())return sz.failure(q2.CANNOT_KEEP_EMPTY_COORD());var r,i=e.get(),o=zp(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;if(a.contains(i))return sz.success(a)}}catch(s){o.e(s)}finally{o.f()}return sz.failure(q2.MUST_CAPTURE_BIGGEST_GROUPS())}}]),n}(_q),Q2=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"calculateBoardValue",value:function(e,t){this.startSearchingVictorySources();for(var n={status:pq.DEFAULT,victory:kz.empty(),preVictory:kz.empty(),sum:0};this.hasNextVictorySource();){var r,i=this.getNextVictorySource();if((r=n.status===pq.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n)).status===pq.VICTORY)return r;n={status:r.status,victory:kz.empty(),preVictory:r.preVictory,sum:n.sum+r.sum}}return n}}]),n}(iq),Y2=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).value=e,i.preVictory=r,i}return n}(oq),K2=function(e){Jp(n,e);var t=ev(n);function n(){var e;return Qp(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return Kp(n,[{key:"getListMoves",value:function(e){var t=n.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(e,r);var i=Z2.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getListDeplacement(e.gameState,i)}},{key:"createForcedDrop",value:function(e){pz(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});var t=[],n=$2.fromDrop(e.preVictory.get());return t.push(n),t}},{key:"createForcedDeplacement",value:function(e,t){pz(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});var n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}},{key:"getDeplacementFrom",value:function(e,t,n){var r,i=[],o=zp(t);try{for(o.s();!(r=o.n()).done;){var a,s=r.value,u=zp(n);try{for(u.s();!(a=u.n()).done;){var c=a.value,l=$2.fromMovement(s,c);if(e.isCoordConnected(c,kz.of(s))){var h=W2.deplacePiece(e,l),f=W2.getGroups(h,l.start.get());if(Z2.isSplit(f)){var d,p=zp(f);try{for(p.s();!(d=p.n()).done;){var v=d.value.getAnyElement().get(),g=$2.fromCut(s,c,v);i.push(g)}}catch(y){p.e(y)}finally{p.f()}}else i.push(l)}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){o.e(y)}finally{o.f()}return i}},{key:"getSafelyMovablePieceOrFirstOne",value:function(e){var t,n=e.gameState,r=n.pieces.reverse(),i=n.getCurrentPlayer(),o=r.get(i).get(),a=o.getAnyElement().get(),s=[],u=zp(o);try{for(u.s();!(t=u.n()).done;){var c=t.value;!1===this.isPieceBlockingAVictory(n,c)&&s.push(c)}}catch(l){u.e(l)}finally{u.f()}return new qW(0===s.length?[a]:s)}},{key:"isPieceBlockingAVictory",value:function(e,t){var n=e.switchPiece(t),r=$2.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===pq.VICTORY)return!0;return!1}},{key:"getListDrop",value:function(e){var t,n=[],r=zp(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=$2.fromDrop(i);n.push(o)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getListDeplacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}},{key:"getBoardValue",value:function(e){var t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue(),o={status:pq.DEFAULT,victory:kz.empty(),preVictory:kz.empty(),sum:0};t.isPresent()&&(o=this.calculateBoardValue(t.get(),n));var a=kz.empty();if(o.status===pq.DEFAULT&&o.preVictory.isPresent()&&(a=kz.of(o.preVictory.get())),o.status===pq.VICTORY)return new Y2(i,kz.empty());if(n.turn>39){var s=n.countPieces(),u=s[0],c=s[1];return u<6&&c<6?new Y2(u<c?HG.ONE.getVictoryValue():c<u?HG.ZERO.getVictoryValue():0,kz.empty()):u<6?new Y2(HG.ZERO.getDefeatValue(),kz.empty()):c<6?new Y2(HG.ONE.getDefeatValue(),kz.empty()):new Y2(u-c,a)}return new Y2(o.status===pq.PRE_VICTORY?r.getPreVictory():o.sum*r.getScoreModifier(),a)}},{key:"startSearchingVictorySources",value:function(){pz(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(pz(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){pz(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],o=t.getNext(KG.factory.all[e],1);i.length<6;){if(n.getPieceAt(o)!==r)return{status:pq.PRE_VICTORY,victory:kz.empty(),preVictory:kz.empty(),sum:0};var a=(e+i.length)%6;i.push(o),o=o.getNext(KG.factory.all[a],1)}return{status:pq.VICTORY,victory:kz.of(i),preVictory:kz.empty(),sum:0}}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=KG.factory.all[e],o=t.getNext(i,1),a=[t],s=!1;a.length<6;){if(n.getPieceAt(o)===r)a.push(o);else{if(s)return{status:pq.PRE_VICTORY,victory:kz.empty(),preVictory:kz.empty(),sum:0};s=!0,i=i.getOpposite(),o=o.getNext(i,a.length-1)}o=o.getNext(i,1)}return{status:pq.VICTORY,victory:kz.of(a),preVictory:kz.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){pz(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=KG.factory.all[e],o=[t],a=t.getNext(i,1);o.length<6;){if(n.getPieceAt(a)!==r)return{status:pq.PRE_VICTORY,victory:kz.empty(),preVictory:kz.empty(),sum:0};o.length%2==0&&(i=KG.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(i,1)}return{status:pq.VICTORY,victory:kz.of(o),preVictory:kz.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){pz(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=KG.factory.all[e],o=[t],a=t.getNext(i,1);o.length<6;){if(n.getPieceAt(a)!==r)return{status:pq.PRE_VICTORY,victory:kz.empty(),preVictory:kz.empty(),sum:0};o.push(a),o.length%2==0&&(i=KG.factory.all[(e+o.length)%6]),a=a.getNext(i,1)}return{status:pq.VICTORY,victory:kz.of(o),preVictory:kz.empty(),sum:0}}},{key:"getBoardInfo",value:function(e,t,n,r){pz(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});var i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}},{key:"getBoardInfoForCircle",value:function(e,t,n,r){pz(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),o=[t],a=t.getNext(KG.factory.all[e],1),s=0,u=kz.empty();o.length<6;){var c=n.getPieceAt(a);if(c===i)return r;var l=(e+o.length)%6;o.push(a);var h=KG.factory.all[l];c===HG.NONE?(s+=.16,u=kz.of(a)):s++,a=a.getNext(h,1)}return this.getBoardInfoResult(s,u,o,r)}},{key:"getBoardInfoResult",value:function(e,t,n,r){var i=r.preVictory;if(4.16===e){if(pz(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:pq.PRE_VICTORY,victory:kz.empty(),preVictory:kz.empty(),sum:0};i=t}else if(5===e)return{status:pq.VICTORY,victory:kz.of(n),preVictory:kz.empty(),sum:0};return{status:r.status,victory:kz.empty(),preVictory:i,sum:r.sum+e}}},{key:"getBoardInfoForLine",value:function(e,t,n,r){pz(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=KG.factory.all[e],o=t.getPrevious(i,5),a=[],s=[],u=kz.empty(),c=0;c<6;c++){var l=this.updateEncounterAndReturnLastEmpty(n,o,s);l.isPresent()&&(u=l),a.push(o),o=o.getNext(i,1)}for(var h=r.status,f=r.preVictory,d=0,p=0;d<6;){var v=s.reduce(function(e,t){return e+t});if(6===v)return{status:pq.VICTORY,victory:kz.of(a),preVictory:kz.empty(),sum:0};5.16===v&&h===pq.DEFAULT&&(f.isPresent()?(vz(!1===f.equals(u),"Impossible to have point aligned with differents line to a same point"),h=pq.PRE_VICTORY):f=u),p=Math.max(p,v),(a=a.slice(1,6)).push(o),s=s.slice(1,6);var g=this.updateEncounterAndReturnLastEmpty(n,o,s);g.isPresent()&&(u=g),d++,o=o.getNext(i,1)}var y={status:h,victory:kz.of(a),preVictory:f,sum:p};return this.getBoardInfoResult(p,u,a,y)}},{key:"updateEncounterAndReturnLastEmpty",value:function(e,t,n){var r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),kz.empty();case HG.NONE:return n.push(.16),kz.of(t);default:return n.push(1),kz.empty()}}},{key:"getBoardInfoForTriangleCorner",value:function(e,t,n,r){pz(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),o=KG.factory.all[e],a=[t],s=t.getNext(o,1),u=0,c=kz.empty();a.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===HG.NONE?(u+=.16,c=kz.of(s)):u++,a.length%2==0&&(o=KG.factory.all[(e+a.length)%6]),a.push(s),s=s.getNext(o,1)}return this.getBoardInfoResult(u,c,a,r)}},{key:"getBoardInfoForTriangleEdge",value:function(e,t,n,r){pz(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),o=KG.factory.all[e],a=[t],s=t.getNext(o,1),u=0,c=kz.empty();a.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===HG.NONE?(u+=.16,c=kz.of(s)):u++,a.push(s),a.length%2==0&&(o=KG.factory.all[(e+a.length)%6]),s=s.getNext(o,1)}return this.getBoardInfoResult(u,c,a,r)}}],[{key:"get",value:function(){if(null==n.INSTANCE){var e=new Z2(W2);n.INSTANCE=new n(e,"SixMinimax")}return n.INSTANCE}}]),n}(Q2),J2=HG.NONE.value,X2=HG.ZERO.value,e3=HG.ONE.value,t3=function(){var e=function e(){Qp(this,e)};return e.MOVEMENT_NOT_DISCONNECTING=function(){return $localize(Iu||(Iu=xp(["This move does not disconnect your opponent's pieces. Try again with another piece."])))},e.MOVEMENT_SELF_DISCONNECTING=function(){return $localize(Tu||(Tu=xp(["You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!"])))},e}(),n3=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(Au||(Au=xp(["Six"]))),$localize(Nu||(Nu=xp(["Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.\n        Each player has 21 pieces, with one for each player already on the board.\n        The goal of the game is to form one of the three winning shapes with your pieces."]))),W2.getInitialState()),Eq.fromMove($localize(xu||(xu=xp(["Victory (line)"]))),$localize(Ru||(Ru=xp(["On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>\n        Find the victory. You're playing Dark."]))),W2.fromRepresentation([[X2,e3,e3,e3,e3,X2],[J2,X2,e3,J2,X2,J2],[e3,e3,X2,J2,J2,J2],[J2,J2,X2,J2,J2,J2],[J2,X2,J2,J2,J2,J2],[X2,J2,J2,J2,J2,J2]],0),[$2.fromDrop(new zG(3,2))],$localize(Mu||(Mu=xp(["Congratulations!"]))),$localize(Du||(Du=xp(["Failed!"])))),Eq.fromMove($localize(Lu||(Lu=xp(["Victory (circle)"]))),$localize(Bu||(Bu=xp(["On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),W2.fromRepresentation([[J2,J2,J2,e3,J2,J2],[J2,J2,e3,e3,X2,X2],[J2,e3,J2,X2,e3,J2],[e3,X2,X2,X2,X2,e3]],0),[$2.fromDrop(new zG(5,2))],$localize(Fu||(Fu=xp(["Congratulations! Note that if a piece is inside the circle, it does not change anything."]))),$localize(ju||(ju=xp(["Failed!"])))),Eq.fromMove($localize(Uu||(Uu=xp(["Victory (triangle)"]))),$localize(Vu||(Vu=xp(["On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),W2.fromRepresentation([[J2,J2,J2,e3,J2,J2],[J2,X2,e3,X2,X2,X2],[J2,X2,J2,X2,X2,J2],[e3,e3,e3,J2,e3,J2]],0),[$2.fromDrop(new zG(3,3))],$localize(zu||(zu=xp(["Congratulations!"]))),$localize(Hu||(Hu=xp(["Failed!"])))),Eq.fromPredicate($localize(Gu||(Gu=xp(["Second phase"]))),$localize(qu||(qu=xp(["After 40 turns, your pieces have all been placed and we move on to the second phase of the game.\n        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.\n        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>\n        You're playing Dark. Make a move that disconnects one of your opponent's pieces."]))),W2.fromRepresentation([[J2,J2,J2,J2,J2,J2,J2,e3,J2],[J2,J2,J2,J2,J2,J2,X2,J2,J2],[J2,J2,J2,J2,X2,X2,X2,J2,J2],[J2,J2,J2,J2,e3,e3,J2,e3,X2],[J2,X2,e3,e3,X2,X2,e3,J2,J2],[X2,X2,X2,X2,e3,e3,e3,X2,J2],[e3,e3,X2,J2,e3,e3,X2,J2,J2],[J2,X2,J2,X2,X2,J2,J2,J2,J2],[e3,e3,e3,e3,J2,J2,J2,J2,J2],[J2,X2,J2,e3,J2,J2,J2,J2,J2]],40),$2.fromMovement(new zG(6,1),new zG(5,1)),function(e,t){var n=t.countPieces();return 19===n[0]?18===n[1]?lz.SUCCESS:lz.failure(t3.MOVEMENT_NOT_DISCONNECTING()):lz.failure(t3.MOVEMENT_SELF_DISCONNECTING())},$localize(Wu||(Wu=xp(["Congratulations, your opponent now has one piece less and you're closer to victory!"])))),Eq.fromPredicate($localize($u||($u=xp(["Victory by disconnection"]))),$localize(Zu||(Zu=xp(["During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.\n        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.\n        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>\n        Here, you're playing Dark and you can win. Do it!"]))),W2.fromRepresentation([[J2,J2,J2,J2,J2,e3],[J2,J2,J2,J2,X2,e3],[J2,J2,J2,e3,X2,X2],[J2,J2,X2,J2,e3,X2],[e3,e3,J2,J2,J2,X2],[X2,e3,J2,J2,J2,J2],[X2,J2,J2,J2,J2,J2]],40),$2.fromMovement(new zG(2,3),new zG(3,3)),function(e,t){return e.start.equalsValue(new zG(2,3))?lz.SUCCESS:lz.failure(t3.MOVEMENT_NOT_DISCONNECTING())},$localize(Qu||(Qu=xp(["Congratulations, you won!"])))),Eq.fromPredicate($localize(Yu||(Yu=xp(["Special disconnection"]))),$localize(Ku||(Ku=xp(["During a disconnection, two or more groups could have the same size,\n        in which case you will have to click on the group you wish to keep.<br/><br/>\n        You're playing Dark, play such a move!"]))),W2.fromRepresentation([[J2,J2,J2,J2,J2,e3],[J2,J2,J2,J2,X2,e3],[J2,J2,J2,e3,X2,X2],[X2,J2,X2,J2,J2,e3],[e3,e3,J2,J2,J2,J2],[X2,X2,J2,J2,J2,J2],[X2,J2,J2,J2,J2,J2]],40),$2.fromCut(new zG(2,3),new zG(2,5),new zG(2,5)),function(e,t){return e.keep.isAbsent()?lz.failure($localize(Ju||(Ju=xp(["This move has not cut the board in two equal halves."])))):t.getPieceAt(e.landing.getNext(t.offset))===HG.NONE?lz.failure($localize(Xu||(Xu=xp(["Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again."])))):lz.SUCCESS},$localize(ec||(ec=xp(["Congratulations, you won!"]))))]};function r3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",10),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onPieceClick(e)}),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.oc("id","piece_",r.x,"_",r.y,""),Vp.mc("ngClass",i.getPieceClass(r)),Vp.Cb("points",i.getHexaCoordsAt(r))}}function i3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",11),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onNeighborClick(e)}),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.oc("id","neighbor_",r.x,"_",r.y,""),Vp.Cb("points",i.getHexaCoordsAt(r))}}function o3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",10),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc();return e.onPieceClick(e.chosenLanding.get())}),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.oc("id","chosenLanding_",r.chosenLanding.get().x,"_",r.chosenLanding.get().y,""),Vp.mc("ngClass",r.getPlayerClass(r.state.getCurrentPlayer())),Vp.Cb("points",r.getHexaCoordsAt(r.chosenLanding.get()))}}function a3(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polyline",12)),2&e){var n=t.$implicit,r=Vp.fc();Vp.oc("id","disconnected_",n.x,"_",n.y,""),Vp.Cb("points",r.getHexaCoordsAt(n))}}function s3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",13),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc();return e.onNeighborClick(e.leftCoord.get())}),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.oc("id","leftCoord_",r.leftCoord.get().x,"_",r.leftCoord.get().y,""),Vp.Cb("points",r.getHexaCoordsAt(r.leftCoord.get()))}}function u3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",14),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc();return e.onPieceClick(e.lastDrop.get())}),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.oc("id","lastDrop_",r.lastDrop.get().x,"_",r.lastDrop.get().y,""),Vp.Cb("points",r.getHexaCoordsAt(r.lastDrop.get()))}}function c3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",15),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc();return e.onPieceClick(e.selectedPiece.get())}),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.oc("id","selectedPiece_",r.selectedPiece.get().x,"_",r.selectedPiece.get().y,""),Vp.mc("ngClass",r.getSelectedPieceClass()),Vp.Cb("points",r.getHexaCoordsAt(r.selectedPiece.get()))}}function l3(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"polyline",16)),2&e){var n=t.$implicit,r=Vp.fc();Vp.oc("id","victoryCoord_",n.x,"_",n.y,""),Vp.Cb("points",r.getHexaCoordsAt(n))}}function h3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g",19),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(2).onPieceClick(e)}),Vp.Mb(1,"polyline",20),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc(2);Vp.Bb(1),Vp.oc("id","cuttable_",r.x,"_",r.y,""),Vp.Cb("points",i.getHexaCoordsAt(r))}}function f3(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g",17),Vp.Ac(1,h3,2,3,"g",18),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}var d3,p3,v3=((p3=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).disconnecteds=[],r.cuttableGroups=[],r.leftCoord=kz.empty(),r.lastDrop=kz.empty(),r.selectedPiece=kz.empty(),r.chosenLanding=kz.empty(),r.nextClickShouldSelectGroup=!1,r.rules=new Z2(W2),r.availableMinimaxes=[new K2(r.rules,"SixMinimax")],r.encoder=$2.encoder,r.tutorial=(new n3).tutorial,r.SPACE_SIZE=30,r.hexaLayout=new JG(1.5*r.SPACE_SIZE,new zG(2*r.SPACE_SIZE,0),tq.INSTANCE),r.updateBoard(),r}return Kp(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=kz.empty(),this.chosenLanding=kz.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=kz.empty(),this.lastDrop=kz.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}},{key:"getViewBox",value:function(){var e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}},{key:"mapAbstractCoordToCornerCoords",value:function(){var e,t=this,n=[],r=zp(this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(function(e){return t.hexaLayout.getHexaCoordsAt(e)}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getLimits",value:function(e){var t,n=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,a=zp(e);try{for(a.s();!(t=a.n()).done;){var s=t.value;s.x<i&&(i=s.x),s.y<o&&(o=s.y),n=Math.max(n,s.x),r=Math.max(r,s.y)}}catch(u){a.e(u)}finally{a.f()}return{minX:i,minY:o,maxX:n,maxY:r}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();this.lastDrop=kz.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?kz.of(e.start.get().getNext(this.state.offset,1)):kz.empty();var t=this.rules.node.gameState;this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}},{key:"getDisconnected",value:function(){var e,t=this,n=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.rules.node.gameState.pieces.listKeys(),i=[],o=zp(n);try{var a=function(){var n=e.value;!1===t.rules.node.move.get().start.equalsValue(n)&&!1===r.some(function(e){return e.equals(n.getNext(t.state.offset,1))})&&i.push(n.getNext(t.state.offset,1))};for(o.s();!(e=o.n()).done;)a()}catch(u){o.e(u)}finally{o.f()}var s=this.lastDrop.get();return!1===this.pieces.some(function(e){return e.equals(s)})&&!1===r.some(function(e){return e.equals(s)})&&i.push(s),i}},{key:"getEmptyNeighbors",value:function(){var e=Z2.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){var t=this.chosenLanding.get();e=e.filter(function(e){return!1===e.equals(t)})}return e}},{key:"getPieceClass",value:function(e){var t=this.rules.node.gameState.getPieceAt(e);return this.getPlayerClass(t)}},{key:"onPieceClick",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#piece_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.state.turn<40)){n.next=5;break}return n.abrupt("return",t.cancelMove(q2.NO_MOVEMENT_BEFORE_TURN_40()));case 5:if(!t.chosenLanding.isAbsent()){n.next=7;break}return n.abrupt("return",t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(nq.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=kz.of(e),lz.SUCCESS));case 7:return i=$2.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e),n.abrupt("return",t.chooseMove(i,t.state));case 9:case"end":return n.stop()}},n)}))()}},{key:"onNeighborClick",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#neighbor_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.nextClickShouldSelectGroup){n.next=5;break}return n.abrupt("return",t.cancelMove(q2.MUST_CUT()));case 5:if(!(t.state.turn<40)){n.next=7;break}return n.abrupt("return",t.chooseMove($2.fromDrop(e),t.state));case 7:if(!t.selectedPiece.isAbsent()){n.next=9;break}return n.abrupt("return",t.cancelMove(q2.CAN_NO_LONGER_DROP()));case 9:return i=$2.fromMovement(t.selectedPiece.get(),e),o=Z2.isLegalPhaseTwoMove(i,t.state),n.abrupt("return",t.neededCutting(o)?(t.chosenLanding=kz.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,lz.SUCCESS):t.chooseMove(i,t.state));case 11:case"end":return n.stop()}},n)}))()}},{key:"neededCutting",value:function(e){return e.isFailure()&&e.getReason()===q2.MUST_CUT()}},{key:"moveVirtuallyPiece",value:function(){var e=this.selectedPiece.get();this.pieces=this.pieces.filter(function(t){return!1===t.equals(e)}),this.neighbors=this.getEmptyNeighbors()}},{key:"showCuttable",value:function(){var e=$2.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=W2.deplacePiece(this.state,e),n=W2.getGroups(t,e.start.get()),r=Z2.getBiggerGroups(n);this.cuttableGroups=[];var i,o=zp(r);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.cuttableGroups.push(a.toList())}}catch(s){o.e(s)}finally{o.f()}}},{key:"getSelectedPieceClass",value:function(){return this.chosenLanding.isPresent()?"moved":"selected"}}]),n}($G)).\u0275fac=function(e){return new(e||p3)(Vp.Lb(qG))},p3.\u0275cmp=Vp.Fb({type:p3,selectors:[["app-six"]],features:[Vp.yb],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured",3,"id",4,"ngFor","ngForOf"],["class","base round moved mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round highlighted mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured",3,"id"],[1,"base","round","moved","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","highlighted","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["stroke-linecap","round",1,"no-fill",3,"id"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,r3,1,4,"polyline",1),Vp.Ac(2,i3,1,3,"polyline",2),Vp.Ac(3,o3,1,4,"polyline",3),Vp.Ac(4,a3,1,3,"polyline",4),Vp.Ac(5,s3,1,3,"polyline",5),Vp.Ac(6,u3,1,3,"polyline",6),Vp.Ac(7,c3,1,4,"polyline",7),Vp.Ac(8,l3,1,3,"polyline",8),Vp.Ac(9,f3,2,1,"g",9),Vp.Pb()),2&e&&(Vp.Cb("viewBox",t.viewBox),Vp.Bb(1),Vp.mc("ngForOf",t.pieces),Vp.Bb(1),Vp.mc("ngForOf",t.neighbors),Vp.Bb(1),Vp.mc("ngIf",t.chosenLanding.isPresent()),Vp.Bb(1),Vp.mc("ngForOf",t.disconnecteds),Vp.Bb(1),Vp.mc("ngIf",t.leftCoord.isPresent()),Vp.Bb(1),Vp.mc("ngIf",t.lastDrop.isPresent()),Vp.Bb(1),Vp.mc("ngIf",t.selectedPiece.isPresent()),Vp.Bb(1),Vp.mc("ngForOf",t.victoryCoords),Vp.Bb(1),Vp.mc("ngForOf",t.cuttableGroups))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),p3),g3=((d3=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getMaximalDistance",value:function(){return 9}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return sz.success(r)}catch(fV){return sz.failure(fV.message)}}}]),n}(xW)).encoder=AW.getEncoder(9,9,d3.of),d3),y3={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:HG.ZERO},m3=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=DW.UNOCCUPIED,t=DW.INVADERS,r=DW.DEFENDERS;return new n([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,DW.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}]),n}(BW),b3=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.call(this,m3,y3,g3.of)}return Kp(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),mq.ruler=this.singleton,n.singleton}}]),n}(jW),_3=DW.UNOCCUPIED,w3=DW.INVADERS,k3=DW.DEFENDERS,C3=DW.PLAYER_ONE_KING,E3=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(tc||(tc=xp(["Goal of the game"]))),$localize(nc||(nc=xp(["Tablut is a strategy game that was played by the Vikings.\n        The goal of the game is different for each player.\n        The attacker plays first. Its pieces (dark) are close to the edges.\n        Its goal is to capture the king, which is in the center of the board.\n        The defender plays second. Its pieces (light) are in the middle.\n        Its goal is to move the king on one of the 4 thrones in the corners.\n        Note that the square in which the king starts, in the center of the board, is also a throne."]))),m3.getInitialState()),Eq.anyMove($localize(rc||(rc=xp(["Moving"]))),$localize(ic||(ic=xp(["All pieces move the same way.\n        Similarly to a rook in chess, a piece can move:\n        <ol>\n            <li>By as many squares as you want.</li>\n            <li>Without going over another piece or stopping on another piece.</li>\n            <li>Horizontally or vertically.</li>\n            <li>Only the king can land on a throne.</li>\n        </ol>\n        To move a piece, click on it and then on its landing square.<br/><br/>\n        You're playing Dark, do the first move."]))),m3.getInitialState(),g3.of(new zG(4,1),new zG(1,1)),$localize(oc||(oc=xp(["Congratulations!"])))),Eq.fromMove($localize(ac||(ac=xp(["Capturing a soldier (1/2)"]))),$localize(sc||(sc=xp(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new m3([[_3,_3,_3,w3,w3,w3,_3,_3,_3],[_3,_3,_3,_3,w3,_3,_3,_3,_3],[_3,_3,_3,_3,k3,_3,_3,_3,_3],[_3,_3,_3,w3,k3,_3,_3,_3,w3],[w3,w3,k3,k3,C3,k3,k3,w3,w3],[_3,_3,_3,_3,k3,_3,_3,_3,w3],[_3,_3,_3,_3,k3,_3,_3,_3,_3],[_3,_3,_3,_3,w3,_3,_3,_3,_3],[_3,_3,_3,w3,w3,w3,_3,_3,_3]],1),[g3.of(new zG(2,4),new zG(2,3)),g3.of(new zG(4,2),new zG(3,2))],$localize(uc||(uc=xp(["Congratulations, that will teach him a lesson!"]))),$localize(cc||(cc=xp(["Failed, you missed an opportunity to capture a piece of the opponent."])))),Eq.fromMove($localize(lc||(lc=xp(["Capturing a soldier (2/2)"]))),$localize(hc||(hc=xp(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new m3([[_3,_3,_3,w3,w3,w3,_3,_3,_3],[_3,_3,_3,_3,w3,_3,_3,_3,_3],[_3,_3,_3,_3,k3,_3,_3,_3,_3],[_3,_3,k3,_3,C3,_3,k3,_3,w3],[w3,w3,_3,k3,_3,k3,k3,w3,w3],[_3,_3,_3,_3,k3,_3,_3,_3,w3],[_3,_3,_3,_3,k3,_3,_3,_3,_3],[_3,_3,_3,_3,w3,_3,_3,_3,_3],[_3,_3,_3,w3,w3,w3,_3,_3,_3]],12),[g3.of(new zG(1,4),new zG(2,4))],$localize(fc||(fc=xp(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(dc||(dc=xp(["Failed, you did not do the expected move."])))),Eq.fromMove($localize(pc||(pc=xp(["Capturing the king (1/2)"]))),$localize(vc||(vc=xp(["To capture the king, two soldiers are not enough.\n        For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.\n        This also works if the king is on the throne.<br/><br/>\n        Capture the king."]))),new m3([[_3,_3,_3,_3,_3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3],[_3,w3,_3,_3,_3,_3,_3,_3,_3],[w3,C3,_3,w3,_3,_3,_3,_3,_3],[_3,w3,_3,_3,_3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3]],72),[g3.of(new zG(3,4),new zG(2,4))],$localize(gc||(gc=xp(["Congratulations, you won!"]))),$localize(yc||(yc=xp(["Failed, you let the king run away."])))),Eq.fromMove($localize(mc||(mc=xp(["Capturing the king (2/2)"]))),$localize(bc||(bc=xp(["Another way to capture the king is to immobilize it against an edge of the board.\n        Note that the king cannot be captured next to a throne.<br/><br/>\n        Capture the king."]))),new m3([[_3,_3,w3,C3,w3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3],[_3,_3,_3,w3,_3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3],[_3,_3,_3,_3,_3,_3,_3,_3,_3]],72),[g3.of(new zG(3,3),new zG(3,1))],$localize(_c||(_c=xp(["The king is dead, long live the king. Congratulations, you won."]))),$localize(wc||(wc=xp(["Failed!"]))))]};function O3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",6),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb()}if(2&e){var r=Vp.fc(2).index,i=Vp.fc().index,o=Vp.fc();Vp.Cb("transform","translate("+r*o.SPACE_SIZE+" "+i*o.SPACE_SIZE+")")}}function S3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",7),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb()}if(2&e){var r=Vp.fc(2).index,i=Vp.fc().index,o=Vp.fc();Vp.Cb("transform","translate("+r*o.SPACE_SIZE+" "+i*o.SPACE_SIZE+")")}}function P3(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,O3,1,1,"polyline",4),Vp.Ac(2,S3,1,1,"ng-template",null,5,Vp.Bc),Vp.Pb()),2&e){var n=Vp.vc(3),r=Vp.fc().index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",o.isCentralThrone(r,i))("ngIfElse",n)}}function I3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(2,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(3,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(4,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(5,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.fc(2).index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.04*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.96*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.2*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.05*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.65*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.2*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.95*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.65*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.4*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.15*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.75*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.4*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.85*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.75*o.SPACE_SIZE)}}function T3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"polyline",13),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(3).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.fc(3).index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.Cb("points",o.getKingPolyline(r,i))}}function A3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(3).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(1,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(3).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(2,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(3).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Qb(3,"line",11),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(3).index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb()}if(2&e){var r=Vp.fc(3).index,i=Vp.fc().index,o=Vp.fc();Vp.Cb("x1",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.04*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.5*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.96*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.04*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.5*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.96*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.5*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.15*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.15*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.85*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.85*o.SPACE_SIZE),Vp.Bb(1),Vp.Cb("x1",o.SPACE_SIZE*r+.85*o.SPACE_SIZE)("y1",o.SPACE_SIZE*i+.15*o.SPACE_SIZE)("x2",o.SPACE_SIZE*r+.15*o.SPACE_SIZE)("y2",o.SPACE_SIZE*i+.85*o.SPACE_SIZE)}}function N3(e,t){if(1&e&&(Vp.ec(),Vp.Ac(0,T3,2,1,"g",9),Vp.Ac(1,A3,4,16,"ng-template",null,12,Vp.Bc)),2&e){var n=Vp.vc(2),r=Vp.fc(2).index,i=Vp.fc().index,o=Vp.fc();Vp.mc("ngIf",o.isKing(r,i))("ngIfElse",n)}}function x3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"circle",8),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().index,t=Vp.fc().index;return Vp.fc().onClick(e,t)}),Vp.Pb(),Vp.Ac(2,I3,6,20,"g",9),Vp.Ac(3,N3,3,2,"ng-template",null,10,Vp.Bc),Vp.Pb()}if(2&e){var r=Vp.vc(4),i=Vp.fc().index,o=Vp.fc().index,a=Vp.fc();Vp.Bb(1),Vp.mc("ngClass",a.getPieceClasses(i,o)),Vp.Cb("r",(a.SPACE_SIZE-a.STROKE_WIDTH)/2)("cx",a.SPACE_SIZE*i+.5*a.SPACE_SIZE)("cy",a.SPACE_SIZE*o+.5*a.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",a.isInvader(i,o))("ngIfElse",r)}}function R3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",2),Vp.cc("click",function(){Vp.wc(n);var e=t.index,r=Vp.fc().index;return Vp.fc().onClick(e,r)}),Vp.Pb(),Vp.Ac(2,P3,4,2,"g",3),Vp.Ac(3,x3,5,6,"g",3),Vp.Pb()}if(2&e){var r=t.index,i=Vp.fc().index,o=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",r,"_",i,""),Vp.mc("ngClass",o.getRectClasses(r,i)),Vp.Cb("x",o.SPACE_SIZE*r)("y",o.SPACE_SIZE*i)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),Vp.Bb(1),Vp.mc("ngIf",o.board[i][r]===o.NONE&&o.isThrone(r,i)),Vp.Bb(1),Vp.mc("ngIf",o.board[i][r]!==o.NONE)}}function M3(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,R3,4,9,"g",1),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function D3(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",14),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onClick(e.x,e.y)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.Bb(1),Vp.oc("id","click_",r.x,"_",r.y,""),Vp.Cb("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var L3,B3,F3,j3,U3,V3,z3=((V3=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e,!1,g3.from)).rules=b3.get(),r.availableMinimaxes=[new zW(r.rules,"DummyBot"),new WW(r.rules,"Piece > Influence"),new $W(r.rules,"Piece > Control"),new ZW(r.rules,"Escape > Piece > Control")],r.encoder=g3.encoder,r.tutorial=(new E3).tutorial,r.updateBoard(),r}return n}(VW)).\u0275fac=function(e){return new(e||V3)(Vp.Lb(qG))},V3.\u0275cmp=Vp.Fb({type:V3,selectors:[["app-tablut"]],features:[Vp.yb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],[4,"ngIf"],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15","class","base",3,"click",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","15 15, 85 15, 85 85, 15 85, 15 15, 85 15",1,"base",3,"click"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60, 10 20",1,"base",3,"click"],[1,"base",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"click"],["soldierDefender",""],[1,"base","no-fill",3,"click"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,M3,2,1,"g",1),Vp.Ac(2,D3,2,6,"g",1),Vp.Pb()),2&e&&(Vp.Cb("viewBox",t.getViewBox()),Vp.Bb(1),Vp.mc("ngForOf",t.board),Vp.Bb(1),Vp.mc("ngForOf",t.getClickables()))},directives:[vg,dg,yg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),V3),H3=((U3=function e(){Qp(this,e)}).PLACEMENT_AFTER_INITIAL_PHASE=function(){return $localize(kc||(kc=xp(["You cannot put a new ring after the tenth turn."])))},U3.NO_MARKERS_IN_INITIAL_PHASE=function(){return $localize(Cc||(Cc=xp(["You cannot put a marker in a ring before placing all of your rings."])))},U3.MISSING_CAPTURES=AY.MISSING_CAPTURES,U3.MOVE_DIRECTION_INVALID=function(){return $localize(Ec||(Ec=xp(["The direction of your move is invalid: a move is made along a straight line."])))},U3.CAN_ONLY_CAPTURE_YOUR_MARKERS=function(){return $localize(Oc||(Oc=xp(["You can only capture your own markers."])))},U3.SHOULD_SELECT_PLAYER_RING=function(){return $localize(Sc||(Sc=xp(["You must pick one of your own rings to move."])))},U3.SHOULD_END_MOVE_ON_EMPTY_SPACE=function(){return $localize(Pc||(Pc=xp(["Your ring must land on an empty space."])))},U3.MOVE_SHOULD_NOT_PASS_ABOVE_RING=function(){return $localize(Ic||(Ic=xp(["A ring can only jump over markers or empty spaces, not over another ring."])))},U3.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=function(){return $localize(Tc||(Tc=xp(["Your ring must land on the first empty space after a group of markers."])))},U3.AMBIGUOUS_CAPTURE_COORD=AY.AMBIGUOUS_CAPTURE_COORD,U3.CAPTURE_SHOULD_TAKE_RING=function(){return $localize(Ac||(Ac=xp(["When you capture markers, you must take one of your ring as well by clicking on it."])))},U3),G3=((j3=function(){function e(t,n){Qp(this,e),this.player=t,this.isRing=n}return Kp(e,[{key:"equals",value:function(e){return this===e}},{key:"flip",value:function(){return vz(!1===this.isRing,"cannot flip a ring (it should never happen)"),vz(this.player!==HG.NONE,"cannot flip a non-piece (it should never happen)"),e.of(this.player.getOpponent(),this.isRing)}},{key:"toString",value:function(){switch(this){case e.NONE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return dz.expectToBe(this,e.RING_ONE),"RING_ONE"}}}],[{key:"of",value:function(t,n){return t===HG.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}}]),e}()).encoder=wz.tuple([HG.numberEncoder,wz.booleanEncoder],function(e){return[e.player,e.isRing]},function(e){return j3.of(e[0],e[1])}),j3.NONE=new j3(HG.NONE,!1),j3.EMPTY=new j3(HG.NONE,!1),j3.MARKER_ZERO=new j3(HG.ZERO,!1),j3.MARKER_ONE=new j3(HG.ONE,!1),j3.MARKERS=[j3.MARKER_ZERO,j3.MARKER_ONE],j3.RING_ZERO=new j3(HG.ZERO,!0),j3.RING_ONE=new j3(HG.ONE,!0),j3.RINGS=[j3.RING_ZERO,j3.RING_ONE],j3),q3=((F3=function(e){Jp(n,e);var t=ev(n);function n(e,r,i){var o;return Qp(this,n),(o=t.call(this,i,e,n.SIZE,n.SIZE,[6,4,3,2,1],G3.EMPTY)).sideRings=r,o}return Kp(n,[{key:"isInitialPlacementPhase",value:function(){return this.turn<10}},{key:"countScores",value:function(){return this.turn<10?[0,0]:this.sideRings}},{key:"equals",value:function(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&rq.compareTable(this.board,e.board)}},{key:"getRingCoords",value:function(e){var t=[];return this.forEachCoord(function(n,r){r.isRing&&r.player===e&&t.push(n)}),t}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==G3.NONE}},{key:"setAtUnsafe",value:function(e,t){var r=rq.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.sideRings,this.turn)}}],[{key:"getInitialState",value:function(){var e=G3.EMPTY,t=G3.NONE;return new n([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}}]),n}(eQ)).SIZE=11,F3),W3=((B3=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;if(Qp(this,n),i=t.call(this,e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");return i.ringTaken=kz.ofNullable(r),tv(i)}return Kp(n,[{key:"setRingTaken",value:function(e){return new n(this.capturedSpaces,e)}},{key:"equals",value:function(e){return!1!==$p(iv(n.prototype),"equals",this).call(this,e)&&!1!==this.ringTaken.equals(e.ringTaken)}}],[{key:"of",value:function(e,t,r){for(var i=[],o=KG.factory.fromMove(e,t).get(),a=e;!1===a.equals(t);a=a.getNext(o))i.push(a);return i.push(t),new n(i,r)}}]),n}(SY)).encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"encode",value:function(e){return{captured:e.capturedSpaces.map(function(e){return zG.encoder.encode(e)}),ringTaken:zG.encoder.encode(e.ringTaken.get())}}},{key:"decode",value:function(e){var t=e;return vz(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new B3(t.captured.map(function(e){return zG.encoder.decode(e)}),zG.encoder.decode(t.ringTaken))}}]),n}(bz)),B3),$3=((L3=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o){var a;return Qp(this,n),(a=t.call(this)).initialCaptures=e,a.start=r,a.end=i,a.finalCaptures=o,a}return Kp(n,[{key:"isInitialPlacement",value:function(){return this.end.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==this.start.equals(e.start)&&!1!==this.end.equals(e.end)&&!1!==rq.compareArray(this.initialCaptures,e.initialCaptures)&&!1!==rq.compareArray(this.finalCaptures,e.finalCaptures)}},{key:"toString",value:function(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=zp(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(o){r.e(o)}finally{r.f()}return n}}]),n}(hq)).coordOptionalEncoder=kz.encoder(zG.encoder),L3.encoder=new(function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"encodeMove",value:function(e){var t={moveStart:zG.encoder.encode(e.start),moveEnd:L3.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=W3.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=W3.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return vz(null!=t.moveStart,"Invalid encoded YinshMove"),new L3(this.decodeArray(t,"initialCapture",W3.encoder.decode),zG.encoder.decode(t.moveStart),L3.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",W3.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(_z)),L3),Z3=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return t.isEndGame?oq.fromWinner(t.winner):new oq(e.gameState.sideRings[0]*HG.ZERO.getScoreModifier()+e.gameState.sideRings[1]*HG.ONE.getScoreModifier())}},{key:"getListMoves",value:function(e){var t=this,n=[],r=e.gameState;if(r.isInitialPlacementPhase()){var i,o=zp(r.getCoordsAndContents());try{for(o.s();!(i=o.n()).done;){var a=Bp(i.value,2),s=a[0];a[1]===G3.EMPTY&&n.push(new $3([],s,kz.empty(),[]))}}catch(c){o.e(c)}finally{o.f()}}else{var u=this.ruler;this.getPossibleCaptureCombinations(r).forEach(function(e){var i=u.applyCaptures(r,e);t.getRingMoves(i).forEach(function(r){var o=u.applyRingMoveAndFlip(i,r.start,r.end);t.getPossibleCaptureCombinations(o).forEach(function(t){var i=new $3(e,r.start,kz.of(r.end),t);n.push(i)})})})}return n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return xY.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(function(e){return function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"getCombinations",value:function(e,t){var n=this;return vz(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(function(e){return n.getPermutations(e)}).reduce(function(e,t){return e.concat(t)})}},{key:"getPermutations",value:function(e){for(var t=e.length,n=[e.slice()],r=new Array(t).fill(0),i=1;i<t;)if(r[i]<i){var o=i%2&&r[i],a=e[i];e[i]=e[o],e[o]=a,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}},{key:"getSubsetsOfSize",value:function(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];for(var i=[];r<=e.length-n;){var o,a=e[r],s=zp(t(n-1,r+1));try{for(s.s();!(o=s.n()).done;){var u=o.value;u.push(a),i.push(u)}}catch(c){s.e(c)}finally{s.f()}++r}return i}(t,0)}}]),e}().getCombinations(n,e.length).map(function(t){return e.map(function(e,n){return new W3(e.capturedSpaces,t[n])})})}).reduce(function(e,t){return e.concat(t)},[])}},{key:"getRingMoves",value:function(e){var t,n=this.ruler,r=[],i=zp(this.getRingCoords(e));try{for(i.s();!(t=i.n()).done;){var o,a=t.value,s=zp(n.getRingTargets(e,a));try{for(s.s();!(o=s.n()).done;){var u=o.value;r.push({start:a,end:u})}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getRingCoords",value:function(e){var t=e.getCurrentPlayer().value,n=[];return e.forEachCoord(function(e,r){r===G3.RINGS[t]&&n.push(e)}),n}}]),n}(iq),Q3=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"applyLegalMove",value:function(e,t,n){return new q3(n.board,n.sideRings,n.turn+1)}},{key:"applyCaptures",value:function(e,t){var n=this,r=e;return t.forEach(function(e){r=n.applyCapture(r,e)}),r}},{key:"applyCapture",value:function(e,t){var n=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new q3(n,e.sideRings,e.turn),t.ringTaken.get())}},{key:"takeRing",value:function(e,t){var n=e.getCurrentPlayer().value,r=e.setAt(t,G3.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new q3(r,i,e.turn)}},{key:"applyCaptureWithoutTakingRing",value:function(e,t){return t.forEach(function(t){e=e.setAt(t,G3.EMPTY)}),e.board}},{key:"ringSelectionValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)===G3.RINGS[n]?lz.SUCCESS:lz.failure(H3.CAPTURE_SHOULD_TAKE_RING())}},{key:"applyRingMoveAndFlip",value:function(e,t,n){var r=e.getCurrentPlayer().value,i=e.setAt(t,G3.MARKERS[r]);i=i.setAt(n,G3.RINGS[r]);for(var o=KG.factory.fromMove(t,n).get(),a=t.getNext(o);!1===a.equals(n);a=a.getNext(o)){var s=i.getPieceAt(a);s!==G3.EMPTY&&(i=i.setAt(a,s.flip()))}return i}},{key:"isLegal",value:function(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return sz.failure(H3.NO_MARKERS_IN_INITIAL_PHASE());var n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();var r=this.applyCaptures(t,e.initialCaptures),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();var o=this.applyRingMoveAndFlip(r,e.start,e.end.get()),a=this.capturesValidity(o,e.finalCaptures);if(a.isFailure())return a.toFailedFallible();var s=this.applyCaptures(o,e.finalCaptures),u=this.noMoreCapturesValidity(s);return u.isFailure()?u.toFailedFallible():sz.success(s)}},{key:"initialPlacementValidity",value:function(e,t){if(!0!==e.isInitialPlacementPhase())return sz.failure(H3.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==G3.EMPTY)return sz.failure(nq.MUST_CLICK_ON_EMPTY_SPACE());var n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;var i=e.setAt(t,G3.of(n,!0)).board,o=new q3(i,r,e.turn);return sz.success(o)}},{key:"moveStartValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==G3.RINGS[n]?lz.failure(H3.SHOULD_SELECT_PLAYER_RING()):lz.SUCCESS}},{key:"moveValidity",value:function(e,t,n){var r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==G3.EMPTY)return lz.failure(H3.SHOULD_END_MOVE_ON_EMPTY_SPACE());var i=KG.factory.fromMove(t,n);if(i.isFailure())return lz.failure(H3.MOVE_DIRECTION_INVALID());for(var o=i.get(),a=!1,s=t.getNext(o);!1===s.equals(n);s=s.getNext(o)){var u=e.getPieceAt(s);if(u===G3.EMPTY){if(a)return lz.failure(H3.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(u.isRing)return lz.failure(H3.MOVE_SHOULD_NOT_PASS_ABOVE_RING());a=!0}}return lz.SUCCESS}},{key:"capturesValidity",value:function(e,t){var n,r=e,i=zp(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=this.captureValidity(r,o);if(a.isFailure())return a;r=this.applyCapture(r,o)}}catch(s){i.e(s)}finally{i.f()}return lz.SUCCESS}},{key:"captureValidity",value:function(e,t){var n,r=e.getCurrentPlayer().value,i=zp(t.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(e.getPieceAt(o)!==G3.MARKERS[r])return lz.failure(H3.CAN_ONLY_CAPTURE_YOUR_MARKERS())}}catch(a){i.e(a)}finally{i.f()}return e.getPieceAt(t.ringTaken.get())!==G3.RINGS[r]?lz.failure(H3.CAPTURE_SHOULD_TAKE_RING()):lz.SUCCESS}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?lz.SUCCESS:lz.failure(H3.MISSING_CAPTURES())}},{key:"getLinePortionsWithAtLeastFivePiecesOfPlayer",value:function(e,t){var n=this,r=[];return e.allLines().forEach(function(i){var o=n.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);o.isPresent()&&r.push(o.get())}),r}},{key:"getLinePortionWithAtLeastFivePiecesOfPlayer",value:function(e,t,n){var r,i=0,o=e.getEntranceOnLine(n),a=n.getDirection(),s=o;for(r=o;e.isOnBoard(r);r=r.getNext(a)){var u=e.getPieceAt(r);if(u.player===t&&!1===u.isRing)0===i&&(s=r),i+=1;else{if(i>=5)break;i=0}}return i>=5?kz.of({start:s,end:r,dir:a}):kz.empty()}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(function(e){for(var t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(W3.of(t,t.getNext(e.dir,4)))}),n}},{key:"getRingTargets",value:function(e,t){var n,r=[],i=zp(KG.factory.all);try{for(i.s();!(n=i.n()).done;)for(var o=n.value,a=!1,s=t.getNext(o);e.isOnBoard(s);s=s.getNext(o)){var u=e.getPieceAt(s);if(u===G3.EMPTY){if(r.push(s),a)break}else{if(u.isRing)break;a=!0}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){return e.gameState.isInitialPlacementPhase()?bq.ONGOING:e.gameState.sideRings[0]>=3?bq.ZERO_WON:e.gameState.sideRings[1]>=3?bq.ONE_WON:bq.ONGOING}}]),n}(_q),Y3=G3.EMPTY,K3=G3.NONE,J3=G3.MARKER_ZERO,X3=G3.RING_ZERO,e4=G3.MARKER_ONE,t4=G3.RING_ONE,n4=function(){var e=function e(){Qp(this,e)};return e.MUST_ALIGN_FIVE=function(){return $localize(Nc||(Nc=xp(["Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time."])))},e.MUST_CAPTURE_TWO=function(){return $localize(xc||(xc=xp(["Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again."])))},e}(),r4=function e(){Qp(this,e),this.tutorial=[Eq.informational($localize(Rc||(Rc=xp(["Goal of the game"]))),$localize(Mc||(Mc=xp(["The goal at Yinsh is to capture three rings in total.\n        The rings taken are shown on the top left for the dark player,\n        and on the bottom right for the light player. Here, Dark won the game.\n        Note that on the board you have two types of pieces for each player:\n        rings (empty circles) and markers (full circles)."]))),new q3([[K3,K3,K3,K3,K3,K3,Y3,Y3,Y3,Y3,K3],[K3,K3,K3,K3,Y3,Y3,Y3,Y3,Y3,Y3,Y3],[K3,K3,K3,J3,t4,Y3,Y3,Y3,Y3,Y3,Y3],[K3,K3,Y3,J3,Y3,t4,Y3,e4,Y3,Y3,Y3],[K3,Y3,X3,e4,Y3,Y3,t4,J3,Y3,Y3,Y3],[K3,Y3,Y3,J3,e4,Y3,Y3,Y3,Y3,Y3,K3],[Y3,Y3,Y3,J3,Y3,Y3,Y3,t4,Y3,Y3,K3],[Y3,Y3,Y3,e4,J3,X3,Y3,Y3,Y3,K3,K3],[Y3,Y3,Y3,Y3,Y3,Y3,Y3,Y3,K3,K3,K3],[Y3,Y3,Y3,Y3,Y3,Y3,Y3,K3,K3,K3,K3],[K3,Y3,Y3,Y3,Y3,K3,K3,K3,K3,K3,K3]],[3,1],20)),Eq.anyMove($localize(Dc||(Dc=xp(["Initial board and placement phase"]))),$localize(Lc||(Lc=xp(["The initial board is empty.\n        At the beginning of the game, each player puts one of its ring on the board at their turn.\n        This phase stops when all rings have been placed on the board.\n        Put one of your ring on the board by clicking the space where you want to place it."]))),new q3(q3.getInitialState().board,[5,5],0),new $3([],new zG(5,5),kz.empty(),[]),$localize(Bc||(Bc=xp(["Congratulations!"])))),Eq.anyMove($localize(Fc||(Fc=xp(["Putting a marker"]))),$localize(jc||(jc=xp(["Once the initial phase is done and all rings are on the board, you need to place markers on the board.\n        To do so, put a marker in a ring by clicking on that ring.\n        Then, the ring must be moved in a straight line, in any direction.\n        A ring cannot pass through other rings during its move.\n        If it goes over a group of markers, your move must stop at the first empty space after that group.\n        All markers in the group are then flipped and their color change.<br/><br/>\n        You're playing Dark, do a move."]))),new q3([[K3,K3,K3,K3,K3,K3,Y3,Y3,Y3,Y3,K3],[K3,K3,K3,K3,Y3,Y3,Y3,Y3,Y3,Y3,Y3],[K3,K3,K3,t4,Y3,Y3,Y3,Y3,Y3,Y3,Y3],[K3,K3,t4,Y3,Y3,t4,Y3,Y3,Y3,Y3,Y3],[K3,Y3,X3,e4,Y3,Y3,t4,Y3,Y3,Y3,Y3],[K3,Y3,Y3,e4,Y3,Y3,Y3,Y3,Y3,Y3,K3],[Y3,Y3,Y3,Y3,X3,Y3,Y3,t4,Y3,Y3,K3],[Y3,Y3,Y3,Y3,Y3,X3,Y3,Y3,Y3,K3,K3],[Y3,Y3,Y3,X3,Y3,Y3,Y3,K3,K3,K3,K3],[Y3,Y3,Y3,Y3,Y3,Y3,Y3,K3,K3,K3,K3],[K3,Y3,Y3,Y3,Y3,K3,K3,K3,K3,K3,K3]],[0,0],20),new $3([],new zG(2,4),kz.of(new zG(4,4)),[]),$localize(Uc||(Uc=xp(["Congratulations!"])))),Eq.fromPredicate($localize(Vc||(Vc=xp(["Getting a ring by aligning 5 markers"]))),$localize(zc||(zc=xp(["Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.\n        To do so, you need to align 5 markers of your color.\n        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.\n        You will then have one more point.\n        You must capture when you can.<br/><br/>\n        You're playing Dark, perform a capture!"]))),new q3([[K3,K3,K3,K3,K3,K3,Y3,Y3,Y3,Y3,K3],[K3,K3,K3,K3,Y3,Y3,Y3,Y3,Y3,Y3,Y3],[K3,K3,K3,t4,Y3,Y3,Y3,Y3,Y3,Y3,Y3],[K3,K3,t4,Y3,Y3,t4,Y3,Y3,Y3,Y3,Y3],[K3,Y3,J3,J3,X3,e4,e4,Y3,Y3,Y3,Y3],[K3,Y3,Y3,t4,Y3,Y3,Y3,Y3,Y3,Y3,K3],[Y3,Y3,Y3,Y3,X3,Y3,Y3,t4,Y3,Y3,K3],[Y3,Y3,Y3,Y3,Y3,X3,Y3,Y3,Y3,K3,K3],[Y3,Y3,Y3,X3,Y3,Y3,Y3,X3,K3,K3,K3],[Y3,Y3,Y3,Y3,Y3,Y3,Y3,K3,K3,K3,K3],[K3,Y3,Y3,Y3,Y3,K3,K3,K3,K3,K3,K3]],[0,0],20),new $3([],new zG(4,4),kz.of(new zG(7,4)),[W3.of(new zG(2,4),new zG(6,4),new zG(7,4))]),function(e,t){return 1===t.sideRings[HG.ZERO.value]?lz.SUCCESS:lz.failure(n4.MUST_ALIGN_FIVE())},$localize(Hc||(Hc=xp(["Congratulations!"])))),Eq.fromPredicate($localize(Gc||(Gc=xp(["Compound captures"]))),$localize(qc||(qc=xp(["During a turn, you could have to choose between multiple captures,\n        or you could even capture multiple times!\n        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>\n        Here, you can capture two rings, do it!"]))),new q3([[K3,K3,K3,K3,K3,K3,Y3,Y3,Y3,Y3,K3],[K3,K3,K3,K3,X3,Y3,Y3,t4,t4,X3,Y3],[K3,K3,K3,X3,Y3,Y3,e4,t4,Y3,X3,Y3],[K3,K3,Y3,X3,Y3,Y3,Y3,Y3,Y3,t4,Y3],[K3,Y3,Y3,Y3,Y3,J3,Y3,Y3,t4,Y3,Y3],[K3,Y3,Y3,Y3,J3,J3,Y3,e4,Y3,Y3,K3],[Y3,Y3,Y3,J3,Y3,J3,Y3,Y3,Y3,Y3,K3],[Y3,Y3,J3,Y3,Y3,J3,Y3,Y3,Y3,K3,K3],[Y3,J3,Y3,Y3,Y3,J3,Y3,Y3,K3,K3,K3],[Y3,Y3,Y3,Y3,Y3,J3,Y3,K3,K3,K3,K3],[K3,Y3,Y3,Y3,Y3,K3,K3,K3,K3,K3,K3]],[0,0],10),new $3([W3.of(new zG(5,4),new zG(1,8),new zG(3,2)),W3.of(new zG(5,9),new zG(5,5),new zG(3,3))],new zG(4,1),kz.of(new zG(4,2)),[]),function(e,t){return 2===t.sideRings[HG.ZERO.value]?lz.SUCCESS:lz.failure(n4.MUST_CAPTURE_TWO())},$localize(Wc||(Wc=xp(["Congratulations!"]))))]};function i4(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",9)),2&e){var n=Vp.fc(2).$implicit,r=Vp.fc(2);Vp.Cb("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringOuterSize)}}function o4(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",10)),2&e){var n=Vp.fc(2),r=n.index,i=n.$implicit,o=Vp.fc().index,a=Vp.fc();Vp.oc("id","ring_",r,"_",o,""),Vp.mc("ngClass",i.ringClasses),Vp.Cb("cx",i.center.x)("cy",i.center.y)("r",a.viewInfo.ringMidSize)}}function a4(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",9)),2&e){var n=Vp.fc(2).$implicit,r=Vp.fc(2);Vp.Cb("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringInnerSize)}}function s4(e,t){if(1&e&&(Vp.ec(),Vp.Mb(0,"circle",11)),2&e){var n=Vp.fc(2),r=n.index,i=n.$implicit,o=Vp.fc().index,a=Vp.fc();Vp.oc("id","marker_",r,"_",o,""),Vp.mc("ngClass",i.markerClasses),Vp.Cb("cx",i.center.x)("cy",i.center.y)("r",a.viewInfo.markerSize)}}function u4(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g",3),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().$implicit;return Vp.fc(2).onClick(e.coord)}),Vp.Mb(1,"polyline",4),Vp.Qb(2,"g",5),Vp.Ac(3,i4,1,3,"circle",6),Vp.Ac(4,o4,1,6,"circle",7),Vp.Ac(5,a4,1,3,"circle",6),Vp.Ac(6,s4,1,6,"circle",8),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.fc(),i=r.index,o=r.$implicit,a=Vp.fc().index;Vp.oc("id","click_",i,"_",a,""),Vp.Bb(1),Vp.oc("id","space_",i,"_",a,""),Vp.mc("ngClass",o.spaceClasses),Vp.Cb("points",o.coordinates),Vp.Bb(1),Vp.oc("id","pieceGroup_",i,"_",a,""),Vp.mc("ngClass",o.removedClass),Vp.Bb(1),Vp.mc("ngIf",o.isRing),Vp.Bb(1),Vp.mc("ngIf",o.isRing),Vp.Bb(1),Vp.mc("ngIf",o.isRing),Vp.Bb(1),Vp.mc("ngIf",o.isMarker)}}function c4(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,u4,7,13,"g",2),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngIf",null!=n)}}function l4(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,c4,2,1,"g",1),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}function h4(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"polyline",12),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onClick(e)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.Bb(1),Vp.oc("id","selected_",r.x,"_",r.y,""),Vp.Cb("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function f4(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"polyline",14),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc().$implicit;return Vp.fc().onClick(e)}),Vp.Pb()}if(2&e){var r=Vp.fc().$implicit,i=Vp.fc();Vp.oc("id","selectable_",r.x,"_",r.y,""),Vp.Cb("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function d4(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,f4,1,3,"polyline",13),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",n.isPlayerTurn())}}function p4(e,t){if(1&e){var n=Vp.Rb();Vp.ec(),Vp.Qb(0,"g"),Vp.Qb(1,"rect",15),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc().onClick(e)}),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc();Vp.Bb(1),Vp.Cb("x",i.viewInfo.spaceInfo[r.y][r.x].center.x-i.viewInfo.indicatorSize/2)("y",i.viewInfo.spaceInfo[r.y][r.x].center.y-i.viewInfo.indicatorSize/2)("width",i.viewInfo.indicatorSize)("height",i.viewInfo.indicatorSize)}}function v4(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Mb(1,"circle",16),Vp.Mb(2,"circle",9),Vp.Mb(3,"circle",17),Vp.Pb()),2&e){var n=t.index,r=Vp.fc().$implicit,i=Vp.fc();Vp.Bb(1),Vp.oc("id","player_",r,"_sideRing_",n+1,""),Vp.Cb("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringOuterSize),Vp.Bb(1),Vp.Cb("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringInnerSize),Vp.Bb(1),Vp.mc("ngClass",i.viewInfo.sideRingClass[r]),Vp.Cb("cx",(0===r?0:1050)+1.2*(0===r?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r?300:1260)("r",i.viewInfo.ringMidSize)}}var g4=function(){return[]};function y4(e,t){if(1&e&&(Vp.ec(),Vp.Qb(0,"g"),Vp.Ac(1,v4,4,12,"g",1),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc();Vp.Bb(1),Vp.mc("ngForOf",Vp.qc(1,g4).constructor(r.viewInfo.sideRings[n]))}}var m4,b4=function(){return[0,1]},_4=((m4=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).movePhase="MOVE_START",r.moveStart=kz.empty(),r.moveEnd=kz.empty(),r.currentlyMoved=[],r.currentCapture=kz.empty(),r.initialCaptures=[],r.finalCaptures=[],r.possibleCaptures=[],r.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:n.MARKER_SIZE,ringOuterSize:n.RING_OUTER_SIZE,ringMidSize:n.RING_MID_SIZE,ringInnerSize:n.RING_INNER_SIZE,indicatorSize:n.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},r.scores=kz.of([0,0]),r.rules=new Q3(q3),r.availableMinimaxes=[new Z3(r.rules,"YinshMinimax")],r.encoder=$3.encoder,r.tutorial=(new r4).tutorial,r.hexaLayout=new JG(1.5*n.RING_OUTER_SIZE,new zG(2*n.RING_OUTER_SIZE,0),tq.INSTANCE),r.constructedState=r.rules.node.gameState,r.constructedState.allCoords().forEach(function(e){null==r.viewInfo.spaceInfo[e.y]&&(r.viewInfo.spaceInfo[e.y]=[]),r.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:r.getHexaCoordsAt(e),center:r.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}}),r}return Kp(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.scores=kz.of(this.rules.node.gameState.countScores())}},{key:"updateViewInfo",value:function(){var e=this;this.constructedState.allCoords().forEach(function(t){e.viewInfo.spaceInfo[t.y][t.x].spaceClasses=e.getSpaceClasses(t);var n=e.constructedState.getPieceAt(t);e.viewInfo.spaceInfo[t.y][t.x].removedClass="",e.setRingInfo(t,n),e.setMarkerInfo(t,n)});for(var t=0,n=[HG.ZERO,HG.ONE];t<n.length;t++){var r=n[t];this.viewInfo.sideRings[r.value]=this.constructedState.sideRings[r.value]}switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];var i,o=zp(this.possibleCaptures);try{for(o.s();!(i=o.n()).done;){var a,s=zp(i.value.capturedSpaces);try{for(s.s();!(a=s.n()).done;){var u=a.value;this.viewInfo.selectableCoords.push(u)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){o.e(c)}finally{o.f()}break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.rules.node.gameState.isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}},{key:"showCurrentMoveCaptures",value:function(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());var e,t=zp(this.initialCaptures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.markCurrentCapture(n)}}catch(a){t.e(a)}finally{t.f()}var r,i=zp(this.finalCaptures);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.markCurrentCapture(o)}}catch(a){i.e(a)}finally{i.f()}}},{key:"getSpaceClasses",value:function(e){return this.currentlyMoved.some(function(t){return t.equals(e)})?["moved"]:[]}},{key:"setRingInfo",value:function(e,t){if(t.isRing){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[n+"-stroke"]}else this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[]}},{key:"setMarkerInfo",value:function(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==G3.EMPTY&&(!t.isRing||t.isRing&&this.moveStart.equalsValue(e))){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.rules.node.gameState,this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=kz.empty(),this.moveStart=kz.empty(),this.moveEnd=kz.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}},{key:"showLastMove",value:function(){var e=this,t=this.rules.node.move;if(t.isPresent()){var n=t.get();if(n.isInitialPlacement())this.viewInfo.spaceInfo[n.start.y][n.start.x].spaceClasses=["moved"];else{var r,i=zp(this.coordsBetween(n.start,n.end.get()));try{for(i.s();!(r=i.n()).done;){var o=r.value;this.viewInfo.spaceInfo[o.y][o.x].spaceClasses=["moved"]}}catch(s){i.e(s)}finally{i.f()}var a=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();n.initialCaptures.forEach(function(t){return e.showLastMoveCapture(t,a)}),n.finalCaptures.forEach(function(t){return e.showLastMoveCapture(t,a)})}}}},{key:"coordsBetween",value:function(e,t){for(var n=[],r=KG.factory.fromMove(e,t).get(),i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==G3.EMPTY&&n.push(i),n.push(t);return n}},{key:"showLastMoveCapture",value:function(e,t){var n,r=zp(e.capturedSpaces);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["captured"],t&&this.markRemovedMarker(i,this.rules.node.gameState.getCurrentPlayer().getOpponent())}}catch(o){r.e(o)}finally{r.f()}this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured"],t&&this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer().getOpponent())}},{key:"moveToInitialCaptureOrMovePhase",value:function(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),lz.SUCCESS}},{key:"onClick",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:n.t0=t.movePhase,n.next="INITIAL_CAPTURE_SELECT_FIRST"===n.t0||"FINAL_CAPTURE_SELECT_FIRST"===n.t0?6:"INITIAL_CAPTURE_SELECT_LAST"===n.t0||"FINAL_CAPTURE_SELECT_LAST"===n.t0?7:"INITIAL_CAPTURE_SELECT_RING"===n.t0||"FINAL_CAPTURE_SELECT_RING"===n.t0?8:"MOVE_START"===n.t0?9:"MOVE_END"===n.t0?10:11;break;case 6:return n.abrupt("return",t.selectCaptureFirstCoord(e));case 7:return n.abrupt("return",t.selectCaptureLastCoord(e));case 8:return n.abrupt("return",t.selectRing(e));case 9:return n.abrupt("return",t.selectMoveStart(e));case 10:return n.abrupt("return",t.selectMoveEnd(e));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectCaptureFirstCoord",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),!(r.length>1)){n.next=5;break}t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r),n.next=8;break;case 5:if(0!==r.length){n.next=7;break}return n.abrupt("return",t.cancelMove(H3.MISSING_CAPTURES()));case 7:t.selectCapture(r[0]);case 8:return n.abrupt("return",lz.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveToCaptureSelectLast",value:function(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;var t,n=zp(e);try{for(n.s();!(t=n.n()).done;){var r,i=zp(t.value.capturedSpaces);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.viewInfo.selectableCoords.push(o)}}catch(a){i.e(a)}finally{i.f()}}}catch(a){n.e(a)}finally{n.f()}switch(this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":this.movePhase="INITIAL_CAPTURE_SELECT_LAST";break;case"FINAL_CAPTURE_SELECT_FIRST":this.movePhase="FINAL_CAPTURE_SELECT_LAST"}}},{key:"selectCaptureLastCoord",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.abrupt("return",(t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),r.length>1?t.cancelMove(H3.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(H3.MISSING_CAPTURES()):t.selectCapture(r[0])));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectCapture",value:function(e){switch(this.currentCapture=kz.of(e),this.constructedState=new q3(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":this.movePhase="INITIAL_CAPTURE_SELECT_RING";break;case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.movePhase="FINAL_CAPTURE_SELECT_RING"}return this.updateViewInfo(),lz.SUCCESS}},{key:"markCurrentCapture",value:function(e){var t,n=zp(e.capturedSpaces);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.selectedCoords.push(r),this.markRemovedMarker(r,this.rules.node.gameState.getCurrentPlayer())}}catch(i){n.e(i)}finally{n.f()}e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer()))}},{key:"markRemovedMarker",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="transparent",this.setMarkerInfo(e,G3.MARKERS[t.value])}},{key:"markRemovedRing",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="transparent",this.setRingInfo(e,G3.RINGS[t.value])}},{key:"selectRing",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.rules.ringSelectionValidity(t.constructedState,e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:t.constructedState=t.rules.takeRing(t.constructedState,e),i=t.currentCapture.get().setRingTaken(e),n.t0=(t.currentCapture=kz.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase),n.next="INITIAL_CAPTURE_SELECT_RING"===n.t0?8:9;break;case 8:return n.abrupt("return",(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),lz.SUCCESS)));case 9:return n.abrupt("return",(dz.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),lz.SUCCESS)));case 10:case"end":return n.stop()}},n)}))()}},{key:"moveToMovePhase",value:function(){return this.movePhase="MOVE_START",this.updateViewInfo(),lz.SUCCESS}},{key:"tryMove",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new $3(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures),t.next=3,e.chooseMove(n,e.rules.node.gameState,e.scores.get());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"selectMoveStart",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.constructedState.isInitialPlacementPhase()){n.next=3;break}return r=t.rules.initialPlacementValidity(t.constructedState,e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=kz.of(e),t.tryMove()));case 3:if(!(i=t.rules.moveStartValidity(t.constructedState,e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(i.getReason()));case 6:return t.moveStart=kz.of(e),t.movePhase="MOVE_END",t.updateViewInfo(),n.abrupt("return",lz.SUCCESS);case 8:case"end":return n.stop()}},n)}))()}},{key:"selectMoveEnd",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveEnd=kz.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.constructedState,t.moveStart.get(),e),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove()));case 2:case"end":return n.stop()}},n)}))()}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),lz.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}}]),n}($G)).RING_OUTER_SIZE=40,m4.RING_MID_SIZE=34,m4.RING_INNER_SIZE=28,m4.MARKER_SIZE=m4.RING_INNER_SIZE,m4.INDICATOR_SIZE=10,m4.\u0275fac=function(e){return new(e||m4)(Vp.Lb(qG))},m4.\u0275cmp=Vp.Fb({type:m4,selectors:[["app-yinsh"]],features:[Vp.yb],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected",3,"id","click"],["pointer-events","fill","class","base no-fill capturable","stroke-linecap","round",3,"id","click",4,"ngIf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable",3,"id","click"],[1,"indicator",3,"click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(Vp.ec(),Vp.Qb(0,"svg",0),Vp.Ac(1,l4,2,1,"g",1),Vp.Ac(2,h4,2,3,"g",1),Vp.Ac(3,d4,2,1,"g",1),Vp.Ac(4,p4,2,4,"g",1),Vp.Ac(5,y4,2,2,"g",1),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngForOf",t.viewInfo.spaceInfo),Vp.Bb(1),Vp.mc("ngForOf",t.viewInfo.selectedCoords),Vp.Bb(1),Vp.mc("ngForOf",t.viewInfo.selectableCoords),Vp.Bb(1),Vp.mc("ngForOf",t.viewInfo.targets),Vp.Bb(1),Vp.mc("ngForOf",Vp.qc(5,b4)))},directives:[vg,yg,dg],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--background-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--background-fill)}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%], .clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-big-vcenter[_ngcontent-%COMP%]{dy:17}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-small[_ngcontent-%COMP%]{font:20 sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),m4);function w4(e,t){if(1&e&&(Vp.Qb(0,"option",5),Vp.Cc(1),Vp.Pb()),2&e){var n=t.$implicit;Vp.mc("value",n),Vp.Bb(1),Vp.Dc(n)}}var k4,C4,E4=function(){var e=function e(){Qp(this,e)};return e.ABALONE=function(){return $localize($c||($c=xp(["Use simple mechanics to push 6 of the opponent's pieces out of the board!"])))},e.APAGOS=function(){return $localize(Zc||(Zc=xp(["Very simple game, but, will you be able to win everytime?"])))},e.AWALE=function(){return $localize(Qc||(Qc=xp(["The international version of the famous African strategy game!"])))},e.BRANDHUB=function(){return $localize(Yc||(Yc=xp(["The Irish version of the Tafl game family!"])))},e.COERCEO=function(){return $localize(Kc||(Kc=xp(["Get rid of all of your opponent's pieces on a board that shrinks little by little!"])))},e.CONSPIRATEURS=function(){return $localize(Jc||(Jc=xp(["Hide all of your pieces before your opponent does, or risk to be discovered!"])))},e.DIAM=function(){return $localize(Xc||(Xc=xp(["Drop your pieces and move them around to align two pieces of the same color across the board to win!"])))},e.DVONN=function(){return $localize(el||(el=xp(["Stack your pieces and control as many stacks as you can to win!"])))},e.ENCAPSULE=function(){return $localize(tl||(tl=xp(["An enhanced tic-tac-toe where piece can encapsule other and prevent them to win."])))},e.EPAMINONDAS=function(){return $localize(nl||(nl=xp(["An antiquity-war inspired game. Be the first to pierce your opponent's lines!"])))},e.GIPF=function(){return $localize(rl||(rl=xp(["A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!"])))},e.GO=function(){return $localize(il||(il=xp(["The oldest strategy game still practiced widely. A territory control game."])))},e.KAMISADO=function(){return $localize(ol||(ol=xp(["Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!"])))},e.LINES_OF_ACTION=function(){return $localize(al||(al=xp(["Regroup your pieces to win. But your possible moves will often change!"])))},e.P4=function(){return $localize(sl||(sl=xp(["The classical 4 in a row game!"])))},e.PENTAGO=function(){return $localize(ul||(ul=xp(["Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!"])))},e.PYLOS=function(){return $localize(cl||(cl=xp(["Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!"])))},e.QUARTO=function(){return $localize(ll||(ll=xp(["Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!"])))},e.QUIXO=function(){return $localize(hl||(hl=xp(["Align 5 of your pieces on a board where pieces slide!"])))},e.REVERSI=function(){return $localize(fl||(fl=xp(["Sandwich your opponent's pieces to dominate the board!"])))},e.SAHARA=function(){return $localize(dl||(dl=xp(["Immobilize one of your opponent's pyramids before your opponent does!"])))},e.SIAM=function(){return $localize(pl||(pl=xp(["Be the first to push a mountain out of the board!"])))},e.SIX=function(){return $localize(vl||(vl=xp(["Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!"])))},e.TABLUT=function(){return $localize(gl||(gl=xp(["The Viking board game! Invaders must capture the king, defender must make him escape!"])))},e.YINSH=function(){return $localize(yl||(yl=xp(["Align your pieces to score points, but beware, pieces can flip!"])))},e}(),O4=((C4=function e(t,n,r,i,o){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];Qp(this,e),this.name=t,this.urlName=n,this.component=r,this.creationDate=i,this.description=o,this.display=a}).ALL_GAMES=function(){return[new C4("MinimaxTesting","MinimaxTesting",qJ,new Date("1970-01-01"),"",!1),new C4($localize(ml||(ml=xp(["Four in a Row"]))),"P4",hX,new Date("2018-08-28"),E4.P4()),new C4($localize(bl||(bl=xp(["Awal\xe9"]))),"Awale",TW,new Date("2018-11-29"),E4.AWALE()),new C4($localize(_l||(_l=xp(["Quarto"]))),"Quarto",J0,new Date("2018-12-09"),E4.QUARTO()),new C4($localize(wl||(wl=xp(["Tablut"]))),"Tablut",z3,new Date("2018-12-27"),E4.TABLUT()),new C4($localize(kl||(kl=xp(["Reversi"]))),"Reversi",L1,new Date("2019-01-16"),E4.REVERSI()),new C4($localize(Cl||(Cl=xp(["Go"]))),"Go",xK,new Date("2019-12-21"),E4.GO()),new C4($localize(El||(El=xp(["Encapsule"]))),"Encapsule",oY,new Date("2019-12-30"),E4.ENCAPSULE()),new C4($localize(Ol||(Ol=xp(["Siam"]))),"Siam",G2,new Date("2020-01-11"),E4.SIAM()),new C4($localize(Sl||(Sl=xp(["Sahara"]))),"Sahara",o2,new Date("2020-02-29"),E4.SAHARA()),new C4($localize(Pl||(Pl=xp(["Pylos"]))),"Pylos",o0,new Date("2020-10-02"),E4.PYLOS()),new C4($localize(Il||(Il=xp(["Kamisado"]))),"Kamisado",pJ,new Date("2020-10-03"),E4.KAMISADO()),new C4($localize(Tl||(Tl=xp(["Quixo"]))),"Quixo",m1,new Date("2020-10-15"),E4.QUIXO()),new C4($localize(Al||(Al=xp(["Dvonn"]))),"Dvonn",RQ,new Date("2020-10-21"),E4.DVONN()),new C4($localize(Nl||(Nl=xp(["Epaminondas"]))),"Epaminondas",OY,new Date("2021-01-16"),E4.EPAMINONDAS()),new C4($localize(xl||(xl=xp(["Gipf"]))),"Gipf",XY,new Date("2021-02-22"),E4.GIPF()),new C4($localize(Rl||(Rl=xp(["Coerceo"]))),"Coerceo",eZ,new Date("2021-03-21"),E4.COERCEO()),new C4($localize(Ml||(Ml=xp(["Six"]))),"Six",v3,new Date("2021-04-08"),E4.SIX()),new C4($localize(Dl||(Dl=xp(["Lines of Action"]))),"LinesOfAction",NJ,new Date("2021-04-28"),E4.LINES_OF_ACTION()),new C4($localize(Ll||(Ll=xp(["Pentago"]))),"Pentago",RX,new Date("2021-05-23"),E4.PENTAGO()),new C4($localize(Bl||(Bl=xp(["Abalone"]))),"Abalone",$q,new Date("2021-07-13"),E4.ABALONE()),new C4($localize(Fl||(Fl=xp(["Yinsh"]))),"Yinsh",_4,new Date("2021-07-31"),E4.YINSH()),new C4($localize(jl||(jl=xp(["Apagos"]))),"Apagos",fW,new Date("2021-11-04"),E4.APAGOS()),new C4($localize(Ul||(Ul=xp(["Diam"]))),"Diam",JZ,new Date("2021-11-30"),E4.DIAM()),new C4($localize(Vl||(Vl=xp(["Brandhub"]))),"Brandhub",m$,new Date("2021-12-07"),E4.BRANDHUB()),new C4($localize(zl||(zl=xp(["Conspirateurs"]))),"Conspirateurs",PZ,new Date("2021-12-30"),E4.CONSPIRATEURS())].sort(function(e,t){return e.name.localeCompare(t.name)})},C4),S4=((k4=function(){function e(){Qp(this,e),this.gameNameList=O4.ALL_GAMES().filter(function(e){return!0===e.display}).map(function(e){return e.urlName}),this.pickGame=new Vp.n}return Kp(e,[{key:"onChange",value:function(e){this.pickGame.emit(e.target.value)}}]),e}()).\u0275fac=function(e){return new(e||k4)},k4.\u0275cmp=Vp.Fb({type:k4,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){return[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],$localize(Hl||(Hl=xp(["Pick a game"]))),[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(Vp.Qb(0,"div",0),Vp.Qb(1,"select",1),Vp.cc("change",function(e){return t.onChange(e)}),Vp.Qb(2,"option",2),Vp.Ub(3,3),Vp.Pb(),Vp.Ac(4,w4,2,2,"option",4),Vp.Pb(),Vp.Pb()),2&e&&(Vp.Bb(4),Vp.mc("ngForOf",t.gameNameList))},directives:[rb,vb,vg],encapsulation:2}),k4);function P4(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"div",25),Vp.Qb(1,"div",26),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().closeInfo()}),Vp.Pb(),Vp.Qb(2,"div",27),Vp.Qb(3,"header",28),Vp.Qb(4,"p",29),Vp.Cc(5),Vp.Pb(),Vp.Qb(6,"button",30),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().closeInfo()}),Vp.Pb(),Vp.Pb(),Vp.Qb(7,"section",31),Vp.Qb(8,"div",6),Vp.Qb(9,"div",32),Vp.Qb(10,"p",33),Vp.Mb(11,"img",34),Vp.Pb(),Vp.Pb(),Vp.Qb(12,"div",7),Vp.Qb(13,"div",13),Vp.Cc(14),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(15,"div",6),Vp.Qb(16,"div",32),Vp.Qb(17,"a",35),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc();return e.createGame(e.gameInfoDetails.get().urlName)}),Vp.Mb(18,"fa-icon",36),Vp.Cc(19,"\xa0"),Vp.Qb(20,"span"),Vp.Ub(21,37),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(22,"div",32),Vp.Qb(23,"a",35),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc();return e.createLocalGame(e.gameInfoDetails.get().urlName)}),Vp.Mb(24,"fa-icon",36),Vp.Cc(25,"\xa0"),Vp.Qb(26,"span"),Vp.Ub(27,38),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(28,"div",32),Vp.Qb(29,"a",35),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc();return e.createTutorial(e.gameInfoDetails.get().urlName)}),Vp.Mb(30,"fa-icon",36),Vp.Cc(31,"\xa0"),Vp.Qb(32,"span"),Vp.Ub(33,39),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.Bb(5),Vp.Dc(r.gameInfoDetails.get().name),Vp.Bb(6),Vp.oc("src","assets/images/",r.theme,"/",r.gameInfoDetails.get().urlName,".png",Vp.yc),Vp.Bb(3),Vp.Ec(" ",r.gameInfoDetails.get().description," "),Vp.Bb(4),Vp.mc("icon",r.iconOnlineGame),Vp.Bb(6),Vp.mc("icon",r.iconLocalGame),Vp.Bb(6),Vp.mc("icon",r.iconTutorial)}}function I4(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"div",8),Vp.Qb(1,"div",9),Vp.Qb(2,"p",10),Vp.Cc(3),Vp.Pb(),Vp.Pb(),Vp.Qb(4,"div",41),Vp.Qb(5,"figure",33),Vp.Qb(6,"img",42),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(2).openInfo(e)}),Vp.Pb(),Vp.Qb(7,"figcaption",43),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(2).openInfo(e)}),Vp.Qb(8,"div",44),Vp.Cc(9,"?"),Vp.Pb(),Vp.Pb(),Vp.Qb(10,"figcaption",45),Vp.Qb(11,"a",46),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(2).createGame(e.urlName)}),Vp.Mb(12,"fa-icon",36),Vp.Pb(),Vp.Qb(13,"a",47),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(2).createLocalGame(e.urlName)}),Vp.Mb(14,"fa-icon",36),Vp.Pb(),Vp.Qb(15,"a",48),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(2).createTutorial(e.urlName)}),Vp.Mb(16,"fa-icon",36),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(17,"div",49),Vp.Cc(18),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc(2);Vp.Bb(3),Vp.Dc(r.name),Vp.Bb(3),Vp.nc("id","image_",r.urlName,""),Vp.oc("src","assets/images/",i.theme,"/",r.urlName,".png",Vp.yc),Vp.Bb(5),Vp.nc("id","playOnline_",r.urlName,""),Vp.Bb(1),Vp.mc("icon",i.iconOnlineGame),Vp.Bb(1),Vp.nc("id","playLocally_",r.urlName,""),Vp.Bb(1),Vp.mc("icon",i.iconLocalGame),Vp.Bb(1),Vp.nc("id","startTutorial_",r.urlName,""),Vp.Bb(1),Vp.mc("icon",i.iconTutorial),Vp.Bb(2),Vp.Ec(" ",r.description," ")}}function T4(e,t){if(1&e&&(Vp.Qb(0,"div",7),Vp.Ac(1,I4,19,11,"div",40),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngForOf",n)}}var A4,N4,x4,R4=((x4=function(){function e(t,n){Qp(this,e),this.router=t,this.numberOfColumns=4,this.games=[],this.iconOnlineGame=Az,this.iconLocalGame=Iz,this.iconTutorial=Sz,this.gameInfoDetails=kz.empty(),this.theme=n.getTheme();for(var r=O4.ALL_GAMES().filter(function(e){return!0===e.display}),i=0,o=0;o<r.length;o++)o<this.numberOfColumns&&this.games.push([]),this.games[i].push(r[o]),i=(i+1)%this.numberOfColumns}return Kp(e,[{key:"createGame",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/play",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createLocalGame",value:function(e){return this.router.navigate(["/local",e])}},{key:"createTutorial",value:function(e){return this.router.navigate(["/tutorial",e])}},{key:"openInfo",value:function(e){this.gameInfoDetails=kz.of(e)}},{key:"closeInfo",value:function(){this.gameInfoDetails=kz.empty()}}]),e}()).\u0275fac=function(e){return new(e||x4)(Vp.Lb(VC),Vp.Lb(Oz))},x4.\u0275cmp=Vp.Fb({type:x4,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){return[[1,"hero"],[1,"hero-body"],[1,"title"],$localize(Gl||(Gl=xp(["EveryBoard"]))),[1,"subtitle"],$localize(ql||(ql=xp(["EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.",":LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn."])),"\ufffd#6\ufffd\ufffd/#6\ufffd"),[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],$localize(Wl||(Wl=xp(["Play online"]))),[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize($l||($l=xp(["Create an online game"]))),["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Zl||(Zl=xp(["See the game list"]))),$localize(Ql||(Ql=xp(["Play offline"]))),["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(Yl||(Yl=xp(["Play"]))),["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],$localize(Kl||(Kl=xp(["Learn"]))),["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],$localize(Jl||(Jl=xp(["Play online"]))),$localize(Xl||(Xl=xp(["Play offline"]))),$localize(eh||(eh=xp(["Learn the rules"]))),["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",$localize(th||(th=xp(["Play online"]))),1,"button",3,"id","click"],["data-tooltip",$localize(nh||(nh=xp(["Play offline"]))),1,"button",3,"id","click"],["data-tooltip",$localize(rh||(rh=xp(["Learn the rules"]))),1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(Vp.Qb(0,"section",0),Vp.Qb(1,"div",1),Vp.Qb(2,"p",2),Vp.Ub(3,3),Vp.Pb(),Vp.Qb(4,"p",4),Vp.Yb(5,5),Vp.Mb(6,"br"),Vp.Wb(),Vp.Pb(),Vp.Pb(),Vp.Qb(7,"div",6),Vp.Qb(8,"div",7),Vp.Qb(9,"div",8),Vp.Qb(10,"header",9),Vp.Qb(11,"p",10),Vp.Ub(12,11),Vp.Pb(),Vp.Pb(),Vp.Qb(13,"div",12),Vp.Qb(14,"div",13),Vp.Qb(15,"button",14),Vp.Ub(16,15),Vp.Pb(),Vp.Qb(17,"button",16),Vp.Ub(18,17),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(19,"div",7),Vp.Qb(20,"div",8),Vp.Qb(21,"header",9),Vp.Qb(22,"p",10),Vp.Ub(23,18),Vp.Pb(),Vp.Pb(),Vp.Qb(24,"div",12),Vp.Qb(25,"div",13),Vp.Qb(26,"button",19),Vp.Ub(27,20),Vp.Pb(),Vp.Qb(28,"button",21),Vp.Ub(29,22),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Ac(30,P4,34,7,"div",23),Vp.Qb(31,"div",6),Vp.Ac(32,T4,2,1,"div",24),Vp.Pb(),Vp.Pb()),2&e&&(Vp.Bb(30),Vp.mc("ngIf",t.gameInfoDetails.isPresent()),Vp.Bb(2),Vp.mc("ngForOf",t.games))},directives:[zC,yg,vg,uG],encapsulation:2}),x4),M4=((N4=function(){function e(t){Qp(this,e),this.element=t}return Kp(e,[{key:"ngAfterViewInit",value:function(){this.element.nativeElement.focus()}}]),e}()).\u0275fac=function(e){return new(e||N4)(Vp.Lb(Vp.l))},N4.\u0275dir=Vp.Gb({type:N4,selectors:[["","autofocus",""]]}),N4),D4=((A4=function(){function e(t){var n=this;Qp(this,e),this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",function(e){n.toggle()})}return Kp(e,[{key:"toggle",value:function(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}]),e}()).\u0275fac=function(e){return new(e||A4)(Vp.Lb(Vp.l))},A4.\u0275dir=Vp.Gb({type:A4,selectors:[["","toggleVisibility",""]]}),A4);function L4(e,t){if(1&e&&(Vp.Qb(0,"div",29),Vp.Qb(1,"div",30),Vp.Ub(2,31),Vp.Pb(),Vp.Qb(3,"div",32),Vp.Cc(4),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(4),Vp.Dc(n.errorMessage)}}var B4,F4,j4,U4,V4,z4,H4,G4,q4=function(){return["/register"]},W4=function(){return["/reset-password"]},$4=((B4=function(){function e(t,n){Qp(this,e),this.router=t,this.authenticationService=n,this.faEye=Tz,this.loginForm=new Dm({email:new Mm,password:new Mm})}return Kp(e,[{key:"ngOnInit",value:function(){var e,t=this;this.authenticationService.getUserObs().subscribe((e=JV(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n!==Fz.NOT_CONNECTED,!e.t0){e.next=4;break}return e.next=4,t.redirect();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"loginWithEmail",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authenticationService.doEmailLogin(e.email,e.password);case 2:(r=n.sent).isFailure()&&(t.errorMessage=r.getReason());case 4:case"end":return n.stop()}},n)}))()}},{key:"loginWithGoogle",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authenticationService.doGoogleLogin();case 2:(n=t.sent).isFailure()&&(e.errorMessage=n.getReason());case 4:case"end":return t.stop()}},t)}))()}},{key:"redirect",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/lobby"]));case 1:case"end":return t.stop()}},t)}))()}},{key:"canLogin",value:function(){return""!==(this.loginForm.value.email||"")&&""!==(this.loginForm.value.password||"")}}]),e}()).\u0275fac=function(e){return new(e||B4)(Vp.Lb(VC),Vp.Lb(jz))},B4.\u0275cmp=Vp.Fb({type:B4,selectors:[["app-login"]],decls:49,vars:8,consts:function(){return[[1,"box"],[1,"title"],$localize(ih||(ih=xp(["Log in"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(oh||(oh=xp(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",$localize(ah||(ah=xp(["Email"]))),"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],$localize(sh||(sh=xp(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",$localize(uh||(uh=xp(["Password"]))),"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(ch||(ch=xp(["Log in"]))),["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(lh||(lh=xp(["Log in with Google"]))),["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],$localize(hh||(hh=xp(["No account?"]))),[3,"routerLink"],$localize(fh||(fh=xp(["Register"]))),$localize(dh||(dh=xp(["Forgot your password?"]))),$localize(ph||(ph=xp(["Reset your password"]))),["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(vh||(vh=xp(["Connection error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(Vp.Qb(0,"div",0),Vp.Qb(1,"p",1),Vp.Ub(2,2),Vp.Pb(),Vp.Qb(3,"form",3),Vp.Qb(4,"div",4),Vp.Qb(5,"div",5),Vp.Qb(6,"label",6),Vp.Ub(7,7),Vp.Pb(),Vp.Pb(),Vp.Qb(8,"div",8),Vp.Qb(9,"div",9),Vp.Qb(10,"div",10),Vp.Mb(11,"input",11),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(12,"div",4),Vp.Qb(13,"div",5),Vp.Qb(14,"label",12),Vp.Ub(15,13),Vp.Pb(),Vp.Pb(),Vp.Qb(16,"div",8),Vp.Qb(17,"div",9),Vp.Qb(18,"div",14),Vp.Mb(19,"input",15),Vp.Qb(20,"span",16),Vp.Mb(21,"fa-icon",17),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(22,"div",4),Vp.Mb(23,"div",5),Vp.Qb(24,"div",8),Vp.Qb(25,"div",9),Vp.Qb(26,"div",10),Vp.Qb(27,"button",18),Vp.cc("click",function(){return t.loginWithEmail(t.loginForm.value)}),Vp.Ub(28,19),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(29,"div",4),Vp.Mb(30,"div",5),Vp.Qb(31,"div",8),Vp.Qb(32,"div",9),Vp.Qb(33,"div",10),Vp.Qb(34,"button",20),Vp.cc("click",function(){return t.loginWithGoogle()}),Vp.Ub(35,21),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Ac(36,L4,5,1,"div",22),Vp.Qb(37,"p",23),Vp.Ob(38),Vp.Ub(39,24),Vp.Nb(),Vp.Cc(40,"\xa0 "),Vp.Qb(41,"a",25),Vp.Ub(42,26),Vp.Pb(),Vp.Pb(),Vp.Qb(43,"p",23),Vp.Ob(44),Vp.Ub(45,27),Vp.Nb(),Vp.Cc(46,"\xa0 "),Vp.Qb(47,"a",25),Vp.Ub(48,28),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e&&(Vp.Bb(3),Vp.mc("formGroup",t.loginForm),Vp.Bb(18),Vp.mc("icon",t.faEye),Vp.Bb(6),Vp.mc("disabled",!t.canLogin()),Vp.Bb(9),Vp.mc("ngIf",t.errorMessage),Vp.Bb(5),Vp.mc("routerLink",Vp.qc(6,q4)),Vp.Bb(6),Vp.mc("routerLink",Vp.qc(7,W4)))},directives:[Hm,um,Qm,Ay,sm,Km,M4,yb,uG,D4,yg,HC],encapsulation:2}),B4),Z4=function e(t,n,r){Qp(this,e),this.onDocumentCreated=t,this.onDocumentModified=n,this.onDocumentDeleted=r},Q4=((j4=function(){function e(t){Qp(this,e),this.userDAO=t,this.activeUsersBS=new __([]),this.activeUsersObs=this.activeUsersBS.asObservable()}return Kp(e,[{key:"startObserving",value:function(){var t=this;pz(e.VERBOSE,"ActiveUsersService.startObservingActiveUsers");var n=new Z4(function(n){var r;pz(e.VERBOSE,"our DAO gave us "+n.length+" new user(s)");var i=(r=t.activeUsersBS.value).concat.apply(r,Up(n));t.activeUsersBS.next(t.sort(i))},function(n){var r=t.activeUsersBS.value;pz(e.VERBOSE,"our DAO updated "+n.length+" user(s)");var i,o=zp(n);try{var a=function(){var e=i.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)}),r=t.sort(r)};for(o.s();!(i=o.n()).done;)a()}catch(s){o.e(s)}finally{o.f()}t.activeUsersBS.next(r)},function(e){var n=t.activeUsersBS.value.filter(function(t){return!e.some(function(e){return e.id===t.id})});t.activeUsersBS.next(t.sort(n))});this.unsubscribe=this.userDAO.observeActiveUsers(n)}},{key:"stopObserving",value:function(){this.unsubscribe(),this.activeUsersBS.next([])}},{key:"sort",value:function(e){return e.sort(function(e,t){return dz.getNonNullable(dz.getNonNullable(e.data).last_changed).seconds-dz.getNonNullable(dz.getNonNullable(t.data).last_changed).seconds})}}]),e}()).VERBOSE=!1,j4.\u0275fac=function(e){return new(e||j4)(Vp.Zb(Lz))},j4.\u0275prov=Vp.Hb({token:j4,factory:j4.\u0275fac,providedIn:"root"}),j4),Y4=((F4=function(){function e(t,n){Qp(this,e),this.activeUsersService=t,this.joueursDAO=n}return Kp(e,[{key:"getActiveUsersObs",value:function(){return this.activeUsersService.startObserving(),this.activeUsersService.activeUsersObs}},{key:"unSubFromActiveUsersObs",value:function(){this.activeUsersService.stopObserving()}},{key:"observeUserByUsername",value:function(e,t){return this.joueursDAO.observeUserByUsername(e,t)}}]),e}()).\u0275fac=function(e){return new(e||F4)(Vp.Zb(Q4),Vp.Zb(Lz))},F4.\u0275prov=Vp.Hb({token:F4,factory:F4.\u0275fac,providedIn:"root"}),F4),K4=function(){var e=function e(t){Qp(this,e),this.value=t};return e.HARD_DRAW=new e(0),e.RESIGN=new e(1),e.ESCAPE=new e(2),e.VICTORY=new e(3),e.TIMEOUT=new e(4),e.UNACHIEVED=new e(5),e.AGREED_DRAW_BY_ZERO=new e(6),e.AGREED_DRAW_BY_ONE=new e(7),e}(),J4=function(){function e(t,n){Qp(this,e),this.id=t,this.data=n}return Kp(e,[{key:"getTurn",value:function(){return this.data.turn}},{key:"isHardDraw",value:function(){return this.data.result===K4.HARD_DRAW.value}},{key:"isAgreedDraw",value:function(){return this.data.result===K4.AGREED_DRAW_BY_ZERO.value||this.data.result===K4.AGREED_DRAW_BY_ONE.value}},{key:"getDrawAccepter",value:function(){return this.data.result===K4.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(vz(this.data.result===K4.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),dz.getNonNullable(this.data.playerOne))}},{key:"isWin",value:function(){return this.data.result===K4.VICTORY.value}},{key:"isTimeout",value:function(){return this.data.result===K4.TIMEOUT.value}},{key:"isResign",value:function(){return this.data.result===K4.RESIGN.value}},{key:"getWinner",value:function(){return kz.ofNullable(this.data.winner)}},{key:"getLoser",value:function(){return kz.ofNullable(this.data.loser)}},{key:"setWinnerAndLoser",value:function(t,n){return new e(this.id,Mp(Mp({},this.data),{},{winner:t,loser:n}))}}]),e}(),X4=((G4=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,"parties",e)).afs=e,pz(n.VERBOSE,"PartDAO.constructor"),r}return Kp(n,[{key:"updateAndBumpIndex",value:function(e,t,n,r){var i=this;return JV(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(r=Mp(Mp({},r),{},{lastUpdate:{index:n+1,player:t.value}}),i.update(e,r)));case 1:case"end":return o.stop()}},o)}))()}},{key:"observeActiveParts",value:function(e){return this.observingWhere([["result","==",K4.UNACHIEVED.value]],e)}},{key:"userHasActivePart",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.findWhere([["playerZero","==",e],["result","==",K4.UNACHIEVED.value]]);case 2:return r=n.sent,n.next=5,t.findWhere([["playerOne","==",e],["result","==",K4.UNACHIEVED.value]]);case 5:return i=n.sent,n.abrupt("return",r.length>0||i.length>0);case 7:case"end":return n.stop()}},n)}))()}}]),n}(ez)).VERBOSE=!1,G4.\u0275fac=function(e){return new(e||G4)(Vp.Zb(QV))},G4.\u0275prov=Vp.Hb({token:G4,factory:G4.\u0275fac,providedIn:"root"}),G4),e5=((H4=function(){function e(t){Qp(this,e),this.partDAO=t,this.unsubscribe=kz.empty(),this.activePartsBS=new __([]),this.activePartsObs=this.activePartsBS.asObservable()}return Kp(e,[{key:"getActivePartsObs",value:function(){return this.activePartsObs}},{key:"startObserving",value:function(){var e=this;vz(this.unsubscribe.isAbsent(),"ActivePartsService: already observing");var t=new Z4(function(t){var n,r=(n=e.activePartsBS.value).concat.apply(n,Up(t));e.activePartsBS.next(r)},function(t){var n,r=e.activePartsBS.value,i=zp(t);try{var o=function(){var e=n.value;r.forEach(function(t){t.id===e.id&&(t.data=e.data)})};for(i.s();!(n=i.n()).done;)o()}catch(a){i.e(a)}finally{i.f()}e.activePartsBS.next(r)},function(t){var n,r=[],i=zp(e.activePartsBS.value);try{var o=function(){var e=n.value;t.some(function(t){return t.id===e.id})||r.push(e)};for(i.s();!(n=i.n()).done;)o()}catch(a){i.e(a)}finally{i.f()}e.activePartsBS.next(r)});this.unsubscribe=kz.of(this.partDAO.observeActiveParts(t))}},{key:"stopObserving",value:function(){vz(this.unsubscribe.isPresent(),"Cannot stop observing active parts when you have not started observing"),this.activePartsBS.next([]),this.unsubscribe.get()(),this.unsubscribe=kz.empty()}}]),e}()).\u0275fac=function(e){return new(e||H4)(Vp.Zb(X4))},H4.\u0275prov=Vp.Hb({token:H4,factory:H4.\u0275fac,providedIn:"any"}),H4),t5=((z4=function(){function e(t){Qp(this,e),this.router=t}return Kp(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"navigateToOnlineGameCreation",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/play",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}()).\u0275fac=function(e){return new(e||z4)(Vp.Lb(VC))},z4.\u0275cmp=Vp.Fb({type:z4,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(gh||(gh=xp(["Create an online game"])))]},template:function(e,t){1&e&&(Vp.Qb(0,"app-pick-game",0),Vp.cc("pickGame",function(e){return t.pickGame(e)}),Vp.Pb(),Vp.Qb(1,"button",1),Vp.cc("click",function(){return t.navigateToOnlineGameCreation()}),Vp.Ub(2,2),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("disabled",!t.selectedGame))},directives:[S4],encapsulation:2}),z4),n5=((V4=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,"chats",e)).afs=e,pz(n.VERBOSE,"ChatDAO.constructor"),r}return n}(ez)).VERBOSE=!1,V4.\u0275fac=function(e){return new(e||V4)(Vp.Zb(QV))},V4.\u0275prov=Vp.Hb({token:V4,factory:V4.\u0275fac,providedIn:"root"}),V4),r5=function(){var e=function e(){Qp(this,e)};return e.CANNOT_SEND_MESSAGE=function(){return $localize(yh||(yh=xp(["You're not allowed to send a message here."])))},e.FORBIDDEN_MESSAGE=function(){return $localize(mh||(mh=xp(["This message is forbidden."])))},e}(),i5=((U4=function(){function e(t){Qp(this,e),this.chatDAO=t,this.followedChatId=kz.empty(),this.followedChatObs=kz.empty(),pz(e.VERBOSE,"ChatService.constructor")}return Kp(e,[{key:"startObserving",value:function(t,n){if(pz(e.VERBOSE,"ChatService.startObserving "+t),!this.followedChatId.isAbsent())throw this.followedChatId.equalsValue(t)?new Error("WTF :: Already observing chat '".concat(t,"'")):new Error("Cannot ask to watch '".concat(t,"' while watching '").concat(this.followedChatId.get(),"'"));pz(e.VERBOSE,"[start watching chat "+t),this.followedChatId=kz.of(t),this.followedChatObs=kz.of(this.chatDAO.getObsById(t)),this.followedChatSub=this.followedChatObs.get().subscribe(n)}},{key:"stopObserving",value:function(){if(!this.isObserving())throw new Error("ChatService.stopObserving should not be called if not observing");pz(e.VERBOSE,"stopped watching chat "+this.followedChatId+"]"),this.followedChatId=kz.empty(),this.followedChatSub.unsubscribe(),this.followedChatObs=kz.empty()}},{key:"isObserving",value:function(){return this.followedChatId.isPresent()}},{key:"deleteChat",value:function(t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(pz(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"createNewChat",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chatDAO.set(e,{messages:[]}));case 1:case"end":return n.stop()}},n)}))()}},{key:"sendMessage",value:function(e,t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){var o,a,s,u;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!r.followedChatId.isAbsent()){i.next=2;break}return i.abrupt("return",lz.failure("Cannot send message if not observing chat"));case 2:if(o=r.followedChatId.get(),!1!==r.userCanSendMessage(e,o)){i.next=5;break}return i.abrupt("return",lz.failure(r5.CANNOT_SEND_MESSAGE()));case 5:if(!r.isForbiddenMessage(t)){i.next=7;break}return i.abrupt("return",lz.failure(r5.FORBIDDEN_MESSAGE()));case 7:return i.next=9,r.chatDAO.read(o);case 9:return a=i.sent.get(),s=rq.copyImmutableArray(a.messages),u={content:t,sender:e,postedTime:Date.now(),currentTurn:n},s.push(u),i.next=15,r.chatDAO.update(o,{messages:s});case 15:return i.abrupt("return",lz.SUCCESS);case 16:case"end":return i.stop()}},i)}))()}},{key:"userCanSendMessage",value:function(e,t){return""!==e}},{key:"isForbiddenMessage",value:function(e){return""===e}},{key:"ngOnDestroy",value:function(){this.isObserving()&&this.stopObserving()}}]),e}()).VERBOSE=!1,U4.\u0275fac=function(e){return new(e||U4)(Vp.Zb(n5))},U4.\u0275prov=Vp.Hb({token:U4,factory:U4.\u0275fac,providedIn:"root"}),U4),o5=["chatDiv"];function a5(e,t){1&e&&(Vp.Ob(0),Vp.Ub(1,8),Vp.Nb())}function s5(e,t){if(1&e&&Vp.Ub(0,9),2&e){var n=Vp.fc(2);Vp.Xb(n.unreadMessagesText),Vp.Vb(0)}}function u5(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",14),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(3).scrollToBottom()}),Vp.Cc(1),Vp.Pb()}if(2&e){var r=Vp.fc(3);Vp.Bb(1),Vp.Ec("",r.unreadMessagesText," \u2193")}}function c5(e,t){if(1&e&&(Vp.Qb(0,"p"),Vp.Cc(1),Vp.gc(2,"date"),Vp.Qb(3,"b"),Vp.Cc(4),Vp.Pb(),Vp.Cc(5),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.Ec(" [",Vp.jc(2,3,n.postedTime,"HH:mm:ss","+0100"),"] "),Vp.Bb(3),Vp.Ec("",n.sender," :"),Vp.Bb(1),Vp.Ec(" ",n.content," ")}}function l5(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"div"),Vp.Ac(1,u5,2,1,"button",10),Vp.Qb(2,"div",11,12),Vp.cc("scroll",function(){return Vp.wc(n),Vp.fc(2).updateCurrentScrollPosition()}),Vp.Ac(4,c5,6,7,"p",13),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.fc(2);Vp.Bb(1),Vp.mc("ngIf",r.showUnreadMessagesButton),Vp.Bb(3),Vp.mc("ngForOf",r.chat)}}var h5=function(){return{standalone:!0}};function f5(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"form",15),Vp.cc("onSubmit",function(){return Vp.wc(n),Vp.fc(2).sendMessage()}),Vp.Qb(1,"div",16),Vp.Qb(2,"div",17),Vp.Qb(3,"input",18,19),Vp.cc("ngModelChange",function(e){return Vp.wc(n),Vp.fc(2).userMessage=e}),Vp.Pb(),Vp.Qb(5,"p",20),Vp.Cc(6),Vp.Pb(),Vp.Pb(),Vp.Qb(7,"div",21),Vp.Qb(8,"button",22),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).sendMessage()}),Vp.Mb(9,"fa-icon",23),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(10,"div",24),Vp.Qb(11,"p"),Vp.Qb(12,"strong"),Vp.Ub(13,25),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.vc(4),i=Vp.fc(2);Vp.Bb(3),Vp.mc("ngModel",i.userMessage)("ngModelOptions",Vp.qc(4,h5)),Vp.Bb(3),Vp.Ec("",r.value.length,"/128"),Vp.Bb(3),Vp.mc("icon",i.faReply)}}function d5(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"div",2),Vp.Qb(1,"button",3),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().switchChatVisibility()}),Vp.Ac(2,a5,2,0,"ng-container",4),Vp.Ac(3,s5,1,1,"ng-template",null,5,Vp.Bc),Vp.Pb(),Vp.Ac(5,l5,5,2,"div",6),Vp.Ac(6,f5,14,5,"form",7),Vp.Pb()}if(2&e){var r=Vp.vc(4),i=Vp.fc();Vp.Bb(2),Vp.mc("ngIf",i.visible)("ngIfElse",r),Vp.Bb(3),Vp.mc("ngIf",i.visible),Vp.Bb(1),Vp.mc("ngIf",i.visible)}}function p5(e,t){1&e&&(Vp.Qb(0,"div",26),Vp.Qb(1,"div",27),Vp.Qb(2,"p"),Vp.Ub(3,28),Vp.Pb(),Vp.Pb(),Vp.Pb())}var v5,g5=((v5=function(){function e(t,n){Qp(this,e),this.chatService=t,this.authenticationService=n,this.userMessage="",this.username=kz.empty(),this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=Nz,this.isNearBottom=!0,this.notYetScrolled=!0,pz(e.VERBOSE,"ChatComponent constructor")}return Kp(e,[{key:"ngOnInit",value:function(){var t=this;pz(e.VERBOSE,"ChatComponent.ngOnInit for chat ".concat(this.chatId)),vz(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.authSubscription=this.authenticationService.getUserObs().subscribe(function(n){t.isConnectedUser(n)?(pz(e.VERBOSE,JSON.stringify(n)+" just connected"),t.username=n.username,t.connected=!0,t.loadChatContent()):(pz(e.VERBOSE,"No User Logged"),t.username=kz.empty(),t.connected=!1)})}},{key:"ngAfterViewChecked",value:function(){this.scrollToBottomIfNeeded()}},{key:"isConnectedUser",value:function(e){return e.username.isPresent()&&""!==e.username.get()}},{key:"loadChatContent",value:function(){var t=this;pz(e.VERBOSE,"User '".concat(this.username,"' logged, loading chat content")),this.chatService.startObserving(this.chatId,function(e){vz(e.isPresent(),"ChatComponent observed a chat being deleted, this should not happen"),t.updateMessages(e.get())})}},{key:"updateMessages",value:function(e){this.chat=e.messages;var t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}},{key:"updateUnreadMessagesText",value:function(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize(bh||(bh=xp(["no new message"]))),this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize(_h||(_h=xp(["1 new message"]))):$localize(wh||(wh=xp([""," new messages"])),e)}},{key:"scrollToBottomIfNeeded",value:function(){this.connected&&this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}},{key:"updateCurrentScrollPosition",value:function(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}},{key:"scrollToBottom",value:function(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}},{key:"scrollTo",value:function(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}},{key:"sendMessage",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return vz(e.username.isPresent(),"disconnected user is not able to send a message"),n=e.userMessage,e.userMessage="",t.next=5,e.chatService.sendMessage(e.username.get(),n,e.turn);case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.authSubscription.unsubscribe(),this.chatService.isObserving()&&this.chatService.stopObserving()}},{key:"switchChatVisibility",value:function(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}]),e}()).VERBOSE=!1,v5.\u0275fac=function(e){return new(e||v5)(Vp.Lb(i5),Vp.Lb(jz))},v5.\u0275cmp=Vp.Fb({type:v5,selectors:[["app-chat"]],viewQuery:function(e,t){var n;1&e&&Vp.Hc(o5,1),2&e&&Vp.uc(n=Vp.dc())&&(t.chatDiv=n.first)},inputs:{chatId:"chatId",turn:"turn"},decls:3,vars:2,consts:function(){return[["class","block",4,"ngIf"],["id","disconnected-chat","class","message is-primary is-light",4,"ngIf"],[1,"block"],["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],$localize(kh||(kh=xp(["Hide chat"]))),$localize(Ch||(Ch=xp(["Show chat (",":INTERPOLATION:)"])),"\ufffd0\ufffd"),["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",$localize(Eh||(Eh=xp(["Type your message here"]))),"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],["toggleVisibility","",1,"clickable-icon",3,"icon"],[1,"content","is-small"],$localize(Oh||(Oh=xp(["Be polite"]))),["id","disconnected-chat",1,"message","is-primary","is-light"],[1,"message-body"],$localize(Sh||(Sh=xp(["Only connected users can see the chat."])))]},template:function(e,t){1&e&&(Vp.Qb(0,"div"),Vp.Ac(1,d5,7,4,"div",0),Vp.Ac(2,p5,4,0,"div",1),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("ngIf",t.connected),Vp.Bb(1),Vp.mc("ngIf",!1===t.connected))},directives:[yg,vg,Hm,um,jm,Ay,bb,sm,zm,uG,D4],pipes:[Eg],encapsulation:2}),v5);function y5(e,t){if(1&e&&(Vp.Ob(0),Vp.Cc(1),Vp.Nb()),2&e){var n=Vp.fc().$implicit;Vp.Bb(1),Vp.Dc(n.data.playerOne)}}function m5(e,t){1&e&&Vp.Ub(0,26)}function b5(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"tr",22),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(2).joinGame(e.id,e.data.typeGame)}),Vp.Qb(1,"td",23),Vp.Cc(2),Vp.Pb(),Vp.Qb(3,"td",23),Vp.Cc(4),Vp.Pb(),Vp.Qb(5,"td",23),Vp.Ac(6,y5,2,1,"ng-container",24),Vp.Ac(7,m5,1,0,"ng-template",null,25,Vp.Bc),Vp.Pb(),Vp.Qb(9,"td",23),Vp.Cc(10),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=t.index,o=Vp.vc(8);Vp.nc("id","part_",i,""),Vp.Bb(2),Vp.Dc(r.data.typeGame),Vp.Bb(2),Vp.Dc(r.data.playerZero),Vp.Bb(2),Vp.mc("ngIf",r.data.playerOne)("ngIfElse",o),Vp.Bb(4),Vp.Dc(r.data.turn)}}function _5(e,t){if(1&e&&(Vp.Qb(0,"div",13),Vp.Qb(1,"div",14),Vp.Qb(2,"table",15),Vp.Qb(3,"thead"),Vp.Qb(4,"tr"),Vp.Qb(5,"th",16),Vp.Ub(6,17),Vp.Pb(),Vp.Qb(7,"th",16),Vp.Ub(8,18),Vp.Pb(),Vp.Qb(9,"th",16),Vp.Ub(10,19),Vp.Pb(),Vp.Qb(11,"th",16),Vp.Ub(12,20),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(13,"tbody"),Vp.Ac(14,b5,11,6,"tr",21),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(14),Vp.mc("ngForOf",n.activeParts)}}function w5(e,t){1&e&&(Vp.Qb(0,"div",27),Vp.Mb(1,"app-online-game-selection",28),Vp.Pb())}function k5(e,t){if(1&e&&(Vp.Ob(0),Vp.Cc(1),Vp.gc(2,"date"),Vp.Nb()),2&e){var n=Vp.fc().$implicit;Vp.Bb(1),Vp.Fc(" ",n.data.username,": ",Vp.jc(2,2,1e3*n.data.last_changed.seconds,"HH:mm:ss","+0100")," ")}}function C5(e,t){if(1&e&&(Vp.Qb(0,"li"),Vp.Ac(1,k5,3,6,"ng-container",37),Vp.Pb()),2&e){var n=t.$implicit;Vp.Bb(1),Vp.mc("ngIf",n.data.last_changed)}}function E5(e,t){if(1&e&&(Vp.Qb(0,"div",29),Vp.Qb(1,"div",30),Vp.Qb(2,"div",31),Vp.Mb(3,"app-chat",32),Vp.Pb(),Vp.Pb(),Vp.Qb(4,"div",33),Vp.Qb(5,"div",34),Vp.Qb(6,"p"),Vp.Ub(7,35),Vp.Pb(),Vp.Qb(8,"ul"),Vp.Ac(9,C5,2,1,"li",36),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(3),Vp.mc("turn",-1),Vp.Bb(6),Vp.mc("ngForOf",n.activeUsers)}}var O5,S5,P5=((S5=function(){function e(t,n,r){Qp(this,e),this.router=t,this.userService=n,this.activePartsService=r,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}return Kp(e,[{key:"ngOnInit",value:function(){var t=this;pz(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSub=this.userService.getActiveUsersObs().subscribe(function(e){t.activeUsers=e}),this.activePartsService.startObserving(),this.activePartsSub=this.activePartsService.getActivePartsObs().subscribe(function(e){t.activeParts=e})}},{key:"ngOnDestroy",value:function(){pz(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSub.unsubscribe(),this.activePartsService.stopObserving(),this.activePartsSub.unsubscribe(),this.userService.unSubFromActiveUsersObs()}},{key:"joinGame",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.router.navigate(["/play",t,e]);case 2:case"end":return r.stop()}},r)}))()}},{key:"selectTab",value:function(e){this.currentTab=e}}]),e}()).VERBOSE=!1,S5.\u0275fac=function(e){return new(e||S5)(Vp.Lb(VC),Vp.Lb(Y4),Vp.Lb(e5))},S5.\u0275cmp=Vp.Fb({type:S5,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){return[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],$localize(Ph||(Ph=xp(["Games"]))),["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],$localize(Ih||(Ih=xp(["Create"]))),["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],$localize(Th||(Th=xp(["Chat"]))),["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Ah||(Ah=xp(["Game"]))),$localize(Nh||(Nh=xp(["First player"]))),$localize(xh||(xh=xp(["Second player"]))),$localize(Rh||(Rh=xp(["Turn"]))),[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],$localize(Mh||(Mh=xp(["Waiting for opponent"]))),["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-9"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3"],["id","onlineUser",1,"box"],$localize(Dh||(Dh=xp(["Connected users:"]))),[4,"ngFor","ngForOf"],[4,"ngIf"]]},template:function(e,t){1&e&&(Vp.Qb(0,"div",0),Vp.Qb(1,"ul"),Vp.Qb(2,"li",1),Vp.Qb(3,"a",2),Vp.cc("click",function(){return t.selectTab("games")}),Vp.Ub(4,3),Vp.Pb(),Vp.Pb(),Vp.Qb(5,"li",4),Vp.Qb(6,"a",5),Vp.cc("click",function(){return t.selectTab("create")}),Vp.Ub(7,6),Vp.Pb(),Vp.Pb(),Vp.Qb(8,"li",7),Vp.Qb(9,"a",8),Vp.cc("click",function(){return t.selectTab("chat")}),Vp.Ub(10,9),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Ac(11,_5,15,1,"div",10),Vp.Ac(12,w5,2,0,"div",11),Vp.Ac(13,E5,10,2,"div",12)),2&e&&(Vp.Bb(11),Vp.mc("ngIf","games"===t.currentTab),Vp.Bb(1),Vp.mc("ngIf","create"===t.currentTab),Vp.Bb(1),Vp.mc("ngIf","chat"===t.currentTab))},directives:[dg,yg,vg,t5,g5],pipes:[Eg],encapsulation:2}),S5),I5=((O5=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||O5)},O5.\u0275cmp=Vp.Fb({type:O5,selectors:[["app-not-found"]],decls:5,vars:0,consts:function(){return[[1,"message","is-danger"],[1,"message-header"],$localize(Lh||(Lh=xp(["Game does not exist"]))),[1,"message-body"],$localize(Bh||(Bh=xp(["The game you tried to join does not exist anymore."])))]},template:function(e,t){1&e&&(Vp.Qb(0,"div",0),Vp.Qb(1,"div",1),Vp.Ub(2,2),Vp.Pb(),Vp.Qb(3,"div",3),Vp.Ub(4,4),Vp.Pb(),Vp.Pb())},encapsulation:2}),O5),T5=function(){var e=function(){function e(){Qp(this,e)}return Kp(e,null,[{key:"rematchAccepted",value:function(e,t){return A5("RematchAccepted",{typeGame:e,partId:t})}},{key:"getPlayer",value:function(e){return HG.of(dz.getNonNullable(e.data).player)}},{key:"getTypeGame",value:function(e){return dz.getNonNullable(e.data).typeGame}},{key:"getPartId",value:function(e){return dz.getNonNullable(e.data).partId}}]),e}();return e.drawProposed=N5("DrawProposed"),e.drawAccepted=A5("DrawAccepted",{}),e.drawRefused=N5("DrawRefused"),e.takeBackAsked=N5("TakeBackAsked"),e.takeBackRefused=N5("TakeBackRefused"),e.takeBackAccepted=N5("TakeBackAccepted"),e.rematchProposed=N5("RematchProposed"),e.addTurnTime=N5("AddTurnTime"),e.addGlobalTime=N5("AddGlobalTime"),e}();function A5(e,t){return{code:e,data:t}}function N5(e){return function(t){return A5(e,{player:t.value})}}function x5(e,t){}var R5,M5,D5,L5=((M5=function e(t){Qp(this,e),this.viewContainerRef=t,pz(e.VERBOSE,"GameIncluderComponent constructor")}).VERBOSE=!1,M5.\u0275fac=function(e){return new(e||M5)(Vp.Lb(Vp.Q))},M5.\u0275cmp=Vp.Fb({type:M5,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&Vp.Ac(0,x5,0,0,"ng-template")},encapsulation:2}),M5),B5=function(){var e=function e(){Qp(this,e)};return e.NOT_YOUR_TURN=function(){return $localize(Fh||(Fh=xp(["It is not your turn!"])))},e.NO_CLONING_FEATURE=function(){return $localize(jh||(jh=xp(["You cannot clone a game. This feature might be implemented later."])))},e}(),F5=((R5=function(){function e(t,n,r){Qp(this,e),this.componentFactoryResolver=t,this.actRoute=n,this.authenticationService=r,this.players=[kz.empty(),kz.empty()],this.endGame=!1,pz(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}return Kp(e,[{key:"getMatchingComponent",value:function(t){pz(e.VERBOSE,"GameWrapper.getMatchingComponent");var n=kz.ofNullable(O4.ALL_GAMES().find(function(e){return e.urlName===t}));return vz(n.isPresent(),"Unknown Games are unwrappable"),n.get().component}},{key:"afterGameIncluderViewInit",value:function(){pz(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),this.createGameComponent(),this.gameComponent.rules.setInitialBoard()}},{key:"createGameComponent",value:function(){var t=this;pz(e.VERBOSE,"GameWrapper.createGameComponent"),vz(null!=this.gameIncluder,"GameIncluder should be present");var n=dz.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),r=this.getMatchingComponent(n),i=this.componentFactoryResolver.resolveComponentFactory(r),o=this.gameIncluder.viewContainerRef.createComponent(i);this.gameComponent=o.instance,this.gameComponent.chooseMove=function(e,n,r){return t.receiveValidMove(e,n,r)},this.gameComponent.canUserPlay=function(e){return t.onUserClick(e)},this.gameComponent.isPlayerTurn=function(){return t.isPlayerTurn()},this.gameComponent.cancelMoveOnWrapper=function(e){t.onCancelMove(e)},this.gameComponent.observerRole=this.observerRole,this.canPass=this.gameComponent.canPass}},{key:"receiveValidMove",value:function(t,n,r){var i=this;return JV(regeneratorRuntime.mark(function o(){var a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(pz(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),i.isPlayerTurn()){o.next=2;break}return o.abrupt("return",lz.failure(B5.NOT_YOUR_TURN()));case 2:if(!i.endGame){o.next=4;break}return o.abrupt("return",lz.failure($localize(Uh||(Uh=xp(["The game has ended."])))));case 4:if(!(a=i.gameComponent.rules.isLegal(t,n)).isFailure()){o.next=9;break}o.t0=(i.gameComponent.cancelMove(a.getReason()),lz.ofFallible(a)),o.next=14;break;case 9:return i.gameComponent.cancelMoveAttempt(),o.next=12,i.onLegalUserMove(t,r);case 12:pz(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),o.t0=lz.SUCCESS;case 14:return o.abrupt("return",o.t0);case 15:case"end":return o.stop()}},o)}))()}},{key:"onUserClick",value:function(e){if(this.observerRole===HG.NONE.value){var t=B5.NO_CLONING_FEATURE();return lz.failure(t)}return this.isPlayerTurn()?lz.SUCCESS:lz.failure(B5.NOT_YOUR_TURN())}},{key:"onCancelMove",value:function(e){}},{key:"isPlayerTurn",value:function(){if(this.observerRole===HG.NONE.value)return!1;if(null==this.gameComponent)return!1;var t=this.gameComponent.rules.node.gameState.turn,n=t%2,r=this.getPlayerName();return pz(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,username:r,observer:this.observerRole,areYouPlayer:this.players[n].equalsValue(r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}},{key:"getBoardHighlight",value:function(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.rules.node.gameState.turn%2+"-bg"]:[]}}]),e}()).VERBOSE=!1,R5.\u0275fac=function(e){return new(e||R5)(Vp.Lb(Vp.j),Vp.Lb(mk),Vp.Lb(jz))},R5.\u0275cmp=Vp.Fb({type:R5,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&Vp.Hc(L5,1),2&e&&Vp.uc(n=Vp.dc())&&(t.gameIncluder=n.first)},decls:0,vars:0,template:function(e,t){},encapsulation:2}),R5),j5=function(){function e(t,n,r){Qp(this,e),this.added=t,this.modified=n,this.removed=r}return Kp(e,[{key:"addNewKeys",value:function(e,t){var n,r=zp(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!=t[i]&&(this.added[i]=t[i])}}catch(o){r.e(o)}finally{r.f()}}},{key:"addCommonKey",value:function(t,n,r){var i,o=zp(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(null==n[a])null!=r[a]&&(this.removed[a]=r[a]);else if(null==r[a])null!=n[a]&&(this.added[a]=n[a]);else{if(["function","symbol","bigint"].includes(typeof r[a]))throw new Error("Not implemented yet");if(void 0===r[a])throw new Error("YOU RE NOT A REAL VALUE "+a);if(["string","boolean","number"].includes(typeof r[a]))r[a]!==n[a]&&(this.modified[a]=n[a]);else if("number"==typeof r[a].length){if("number"!=typeof n[a].length)throw new Error("Thing should not change type");if(r[a].length===n[a].length)for(var s=!0,u=0;s&&u<r[a].length;u++)e.from(r[a][u],n[a][u]).countChanges()>0&&(s=!1,this.modified[a]=n[a]);else this.modified[a]=n[a]}else{var c=e.from(r[a],n[a]);c.countChanges()>0&&(this.modified[a]=c)}}}}catch(l){o.e(l)}finally{o.f()}}},{key:"countChanges",value:function(){var e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}},{key:"addRemovedKeys",value:function(e,t){var n,r=zp(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.removed[i]=t[i]}}catch(o){r.e(o)}finally{r.f()}}},{key:"isPresent",value:function(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}],[{key:"from",value:function(t,n){var r=new e({},{},{});if(null==t)return r.added=Mp({},n),r;if(null==n)return r.removed=Mp({},t),r;var i=Object.keys(t),o=Object.keys(n),a=i.filter(function(e){return!1===o.includes(e)}),s=i.filter(function(e){return o.includes(e)}),u=o.filter(function(e){return!1===i.includes(e)});return r.addNewKeys(u,n),r.addCommonKey(s,n,t),r.addRemovedKeys(a,t),r}}]),e}(),U5=((D5=function(){function e(){Qp(this,e)}return Kp(e,[{key:"transform",value:function(e){var t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize(Vh||(Vh=xp([""," hours"])),r)):1===r&&i.push($localize(zh||(zh=xp(["1 hour"])))),n>1?i.push($localize(Hh||(Hh=xp([""," minutes"])),n)):1===n&&i.push($localize(Gh||(Gh=xp(["1 minute"])))),t>1?i.push($localize(qh||(qh=xp([""," seconds"])),t)):1===t&&i.push($localize(Wh||(Wh=xp(["1 second"])))),0===i.length)return $localize($h||($h=xp(["0 seconds"])));if(1===i.length)return i[0];var o=i.slice(0,-1).join(", "),a=i.slice(-1)[0];return $localize(Zh||(Zh=xp([""," and ",""])),o,a)}}]),e}()).\u0275fac=function(e){return new(e||D5)},D5.\u0275pipe=Vp.Kb({name:"humanDuration",type:D5,pure:!0}),D5);function V5(e){return 1e3*e.seconds+e.nanoseconds/1e6}var z5,H5,G5,q5,W5=((q5=function(){function e(t){Qp(this,e),this.value=t}return Kp(e,null,[{key:"of",value:function(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return vz("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}]),e}()).CREATOR=new q5("CREATOR"),q5.RANDOM=new q5("RANDOM"),q5.CHOSEN_PLAYER=new q5("CHOSEN_PLAYER"),q5),$5=function(){var e=function(){function e(t){Qp(this,e),this.value=t}return Kp(e,null,[{key:"of",value:function(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}]),e}();return e.STANDARD=new e("STANDARD"),e.BLITZ=new e("BLITZ"),e.CUSTOM=new e("CUSTOM"),e.NORMAL_MOVE_DURATION=120,e.NORMAL_PART_DURATION=1800,e.BLITZ_MOVE_DURATION=30,e.BLITZ_PART_DURATION=900,e}(),Z5=function(){var e=function e(t){Qp(this,e),this.value=t};return e.PART_CREATED=new e(0),e.CONFIG_PROPOSED=new e(2),e.PART_STARTED=new e(3),e.PART_FINISHED=new e(4),e}(),Q5=((G5=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,"joiners",e)).afs=e,pz(n.VERBOSE,"JoinerDAO.constructor"),r}return n}(ez)).VERBOSE=!1,G5.\u0275fac=function(e){return new(e||G5)(Vp.Zb(QV))},G5.\u0275prov=Vp.Hb({token:G5,factory:G5.\u0275fac,providedIn:"root"}),G5),Y5=((H5=function(){function e(t){Qp(this,e),this.joinerDAO=t,pz(e.VERBOSE,"JoinerService.constructor")}return Kp(e,[{key:"observe",value:function(e){return this.observedJoinerId=e,this.joinerDAO.getObsById(e)}},{key:"createInitialJoiner",value:function(t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(pz(e.VERBOSE,"JoinerService.createInitialJoiner("+t+", "+n+")"),r.set(n,{candidates:[],chosenPlayer:null,firstPlayer:W5.RANDOM.value,partType:$5.STANDARD.value,partStatus:Z5.PART_CREATED.value,maximalMoveDuration:$5.NORMAL_MOVE_DURATION,totalPartDuration:$5.NORMAL_PART_DURATION,creator:t})));case 1:case"end":return i.stop()}},i)}))()}},{key:"joinGame",value:function(t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){var o,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return pz(e.VERBOSE,"JoinerService.joinGame("+t+", "+n+")"),i.next=3,r.joinerDAO.read(t);case 3:if(!(o=i.sent).isAbsent()){i.next=6;break}return i.abrupt("return",lz.failure("Game does not exist"));case 6:if(!(a=rq.copyImmutableArray(o.get().candidates)).includes(n)){i.next=11;break}i.t0=lz.failure("User already in the game"),i.next=17;break;case 11:if(i.t1=n===o.get().creator,i.t1){i.next=16;break}return a[a.length]=n,i.next=16,r.joinerDAO.update(t,{candidates:a});case 16:i.t0=lz.SUCCESS;case 17:return i.abrupt("return",i.t0);case 18:case"end":return i.stop()}},i)}))()}},{key:"cancelJoining",value:function(t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(pz(e.VERBOSE,"JoinerService.cancelJoining("+t+"); this.observedJoinerId = "+n.observedJoinerId),null!=n.observedJoinerId){r.next=2;break}throw new Error("cannot cancel joining when not observing a joiner");case 2:return r.next=4,n.joinerDAO.read(n.observedJoinerId);case 4:if((i=r.sent).isAbsent()){r.next=15;break}if(o=i.get(),a=rq.copyImmutableArray(o.candidates),s=a.indexOf(t),u=o.chosenPlayer,c=o.partStatus,a.splice(s,1),u!==t){r.next=12;break}u=null,c=Z5.PART_CREATED.value,r.next=14;break;case 12:if(-1!==s){r.next=14;break}throw new Error("someone that was not candidate nor chosenPlayer just left the chat: "+t);case 14:return r.abrupt("return",n.joinerDAO.update(n.observedJoinerId,{chosenPlayer:u,partStatus:c,candidates:a}));case 15:case"end":return r.stop()}},r)}))()}},{key:"updateCandidates",value:function(t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(pz(e.VERBOSE,"JoinerService.reviewConfig"),vz(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),n.joinerDAO.update(n.observedJoinerId,{candidates:t})));case 1:case"end":return r.stop()}},r)}))()}},{key:"deleteJoiner",value:function(){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(pz(e.VERBOSE,"JoinerService.deleteJoiner(); this.observedJoinerId = "+t.observedJoinerId),vz(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.delete(t.observedJoinerId)));case 1:case"end":return n.stop()}},n)}))()}},{key:"proposeConfig",value:function(t,n,r,i,o){var a=this;return JV(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(pz(e.VERBOSE,{joinerService_proposeConfig:{maximalMoveDuration:r,firstPlayer:i,totalPartDuration:o}}),pz(e.VERBOSE,"this.followedJoinerId: "+a.observedJoinerId),vz(null!=a.observedJoinerId,"JoinerService is not observing a joiner"),a.joinerDAO.update(a.observedJoinerId,{partStatus:Z5.CONFIG_PROPOSED.value,chosenPlayer:t,partType:n.value,maximalMoveDuration:r,totalPartDuration:o,firstPlayer:i.value})));case 1:case"end":return s.stop()}},s)}))()}},{key:"setChosenPlayer",value:function(t){return pz(e.VERBOSE,"JoinerService.setChosenPlayer(".concat(t,")")),vz(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(this.observedJoinerId,{chosenPlayer:t})}},{key:"reviewConfig",value:function(){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(pz(e.VERBOSE,"JoinerService.reviewConfig"),vz(null!=t.observedJoinerId,"JoinerService is not observing a joiner"),t.joinerDAO.update(t.observedJoinerId,{partStatus:Z5.PART_CREATED.value})));case 1:case"end":return n.stop()}},n)}))()}},{key:"reviewConfigRemoveChosenPlayerAndUpdateCandidates",value:function(t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(pz(e.VERBOSE,"JoinerService.reviewConfig"),vz(null!=n.observedJoinerId,"JoinerService is not observing a joiner"),n.joinerDAO.update(n.observedJoinerId,{partStatus:Z5.PART_CREATED.value,chosenPlayer:null,candidates:t})));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(){return pz(e.VERBOSE,"JoinerService.acceptConfig"),vz(null!=this.observedJoinerId,"JoinerService is not observing a joiner"),this.joinerDAO.update(this.observedJoinerId,{partStatus:Z5.PART_STARTED.value})}},{key:"createJoiner",value:function(t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(pz(e.VERBOSE,"JoinerService.create("+JSON.stringify(t)+")"),n.joinerDAO.create(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"readJoinerById",value:function(t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return pz(e.VERBOSE,"JoinerService.readJoinerById("+t+")"),r.next=3,n.joinerDAO.read(t);case 3:return r.abrupt("return",r.sent.get());case 4:case"end":return r.stop()}},r)}))()}},{key:"set",value:function(t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(pz(e.VERBOSE,"JoinerService.set("+t+", "+JSON.stringify(n)+")"),r.joinerDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"updateJoinerById",value:function(t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(pz(e.VERBOSE,{joinerService_updateJoinerById:{partId:t,update:n}}),r.joinerDAO.update(t,n)));case 1:case"end":return i.stop()}},i)}))()}}]),e}()).VERBOSE=!1,H5.\u0275fac=function(e){return new(e||H5)(Vp.Zb(Q5))},H5.\u0275prov=Vp.Hb({token:H5,factory:H5.\u0275fac,providedIn:"root"}),H5),K5=((z5=function(){function e(t,n,r){Qp(this,e),this.partDAO=t,this.joinerService=n,this.chatService=r,this.followedPartId=kz.empty(),this.followedPartObs=kz.empty(),pz(e.VERBOSE,"GameService.constructor")}return Kp(e,[{key:"getPartValidity",value:function(e,t){var n=this;return JV(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.partDAO.read(e);case 2:return i=r.sent,r.abrupt("return",i.isAbsent()?lz.failure("NONEXISTENT_PART"):i.get().typeGame===t?lz.SUCCESS:lz.failure("WRONG_GAME_TYPE"));case 4:case"end":return r.stop()}},r)}))()}},{key:"createUnstartedPart",value:function(t,n){return pz(e.VERBOSE,"GameService.createPart("+t+", "+n+")"),this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:n,playerZero:t,turn:-1,result:K4.UNACHIEVED.value,listMoves:[]})}},{key:"createChat",value:function(t){return pz(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}},{key:"createPartJoinerAndChat",value:function(t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){var o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return pz(e.VERBOSE,"GameService.createGame("+t+", "+n+")"),i.next=3,r.createUnstartedPart(t,n);case 3:return o=i.sent,i.next=6,r.joinerService.createInitialJoiner(t,o);case 6:return i.next=8,r.createChat(o);case 8:return i.abrupt("return",o);case 9:case"end":return i.stop()}},i)}))()}},{key:"startGameWithConfig",value:function(t,n,r,i){pz(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));var o=this.getStartingConfig(i);return this.partDAO.updateAndBumpIndex(t,n,r,o)}},{key:"getStartingConfig",value:function(e){var t,n,r=W5.of(e.firstPlayer);return r===W5.RANDOM&&(r=Math.random()<.5?W5.CREATOR:W5.CHOSEN_PLAYER),r===W5.CREATOR?(t=e.creator,n=dz.getNonNullable(e.chosenPlayer)):(t=dz.getNonNullable(e.chosenPlayer),n=e.creator),{playerZero:t,playerOne:n,turn:0,beginning:ZS.a.firestore.FieldValue.serverTimestamp(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}},{key:"deletePart",value:function(t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(pz(e.VERBOSE,"GameService.deletePart("+t+")"),n.partDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return pz(e.VERBOSE,{gameService_acceptConfig:{partId:t,joiner:n}}),i.next=3,r.joinerService.acceptConfig();case 3:return i.abrupt("return",r.startGameWithConfig(t,HG.ONE,0,n));case 4:case"end":return i.stop()}},i)}))()}},{key:"startObserving",value:function(t,n){if(!this.followedPartId.isAbsent())throw new Error("GameService.startObserving should not be called while already observing a game");pz(e.VERBOSE,"[start watching part "+t),this.followedPartId=kz.of(t),this.followedPartObs=kz.of(this.partDAO.getObsById(t)),this.followedPartSub=this.followedPartObs.get().subscribe(n)}},{key:"resign",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:K4.RESIGN.value,request:null})}},{key:"notifyTimeout",value:function(e,t,n,r,i){return this.partDAO.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:K4.TIMEOUT.value,request:null})}},{key:"sendRequest",value:function(e,t,n,r){return this.partDAO.updateAndBumpIndex(e,t,n,{request:r})}},{key:"proposeDraw",value:function(e,t,n){return this.sendRequest(e,n,t,T5.drawProposed(n))}},{key:"acceptDraw",value:function(e,t,n){return this.partDAO.updateAndBumpIndex(e,n,t,{result:(n===HG.ZERO?K4.AGREED_DRAW_BY_ZERO:K4.AGREED_DRAW_BY_ONE).value,request:null})}},{key:"refuseDraw",value:function(e,t,n){return this.sendRequest(e,n,t,T5.drawRefused(n))}},{key:"proposeRematch",value:function(e,t,n){return this.sendRequest(e,n,t,T5.rematchProposed(n))}},{key:"acceptRematch",value:function(t,n,r){var i=this;return JV(regeneratorRuntime.mark(function o(){var a,s,u,c,l,h,f;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return pz(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t}),a=dz.getNonNullable(t.data),o.next=4,i.joinerService.readJoinerById(t.id);case 4:return s=o.sent,u=a.playerZero===s.creator?W5.CHOSEN_PLAYER:W5.CREATOR,c=Mp(Mp({},s),{},{candidates:[],firstPlayer:u.value,partStatus:Z5.PART_STARTED.value}),o.next=9,i.joinerService.createJoiner(c);case 9:return l=o.sent,h=i.getStartingConfig(c),f=Mp({lastUpdate:{index:0,player:r.value},typeGame:a.typeGame,result:K4.UNACHIEVED.value,listMoves:[]},h),o.next=14,i.partDAO.set(l,f);case 14:return o.next=16,i.createChat(l);case 16:return o.abrupt("return",i.sendRequest(t.id,r,n,T5.rematchAccepted(a.typeGame,l)));case 17:case"end":return o.stop()}},o)}))()}},{key:"askTakeBack",value:function(e,t,n){return this.sendRequest(e,n,t,T5.takeBackAsked(n))}},{key:"acceptTakeBack",value:function(e,t,n,r){var i=this;return JV(regeneratorRuntime.mark(function o(){var a,s,u,c;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return vz(n!==HG.NONE,"Illegal for observer to make request"),vz(T5.getPlayer(dz.getNonNullable(t.data.request))!==n,"Illegal to accept your own request"),a=T5.takeBackAccepted(n),(s=t.data.listMoves.slice(0,t.data.listMoves.length-1)).length%2===n.value&&(s=s.slice(0,s.length-1)),u={request:a,listMoves:s,turn:s.length,lastUpdateTime:ZS.a.firestore.FieldValue.serverTimestamp(),remainingMsForZero:dz.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:dz.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index,o.next=7,i.partDAO.updateAndBumpIndex(e,n,c,u);case 7:return o.abrupt("return",o.sent);case 8:case"end":return o.stop()}},o)}))()}},{key:"refuseTakeBack",value:function(e,t,n){vz(n!==HG.NONE,"Illegal for observer to make request");var r=T5.takeBackRefused(n);return this.partDAO.updateAndBumpIndex(e,n,t,{request:r})}},{key:"addGlobalTime",value:function(e,t,n,r){var i=this;return JV(regeneratorRuntime.mark(function o(){var a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return vz(r!==HG.NONE,"Illegal for observer to make request"),a={request:T5.addGlobalTime(r.getOpponent())},a=r===HG.ZERO?Mp(Mp({},a),{},{remainingMsForOne:dz.getNonNullable(n.remainingMsForOne)+3e5}):Mp(Mp({},a),{},{remainingMsForZero:dz.getNonNullable(n.remainingMsForZero)+3e5}),o.next=5,i.partDAO.updateAndBumpIndex(e,r,t,a);case 5:return o.abrupt("return",o.sent);case 6:case"end":return o.stop()}},o)}))()}},{key:"addTurnTime",value:function(e,t,n){var r=this;return JV(regeneratorRuntime.mark(function i(){var o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o={request:T5.addTurnTime(e.getOpponent())},i.next=3,r.partDAO.updateAndBumpIndex(n,e,t,o);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"stopObserving",value:function(){pz(e.VERBOSE,"GameService.stopObserving();"),vz(this.followedPartId.isPresent(),"!!! GameService.stopObserving: we already stop watching doc"),pz(e.VERBOSE,"stopped watching joiner "+this.followedPartId+"]"),this.followedPartId=kz.empty(),this.followedPartSub.unsubscribe(),this.followedPartObs=kz.empty()}},{key:"updateDBBoard",value:function(t,n,r,i,o,a,s,u){var c=this;return JV(regeneratorRuntime.mark(function l(){var h,f,d,p,v;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return pz(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:o,msToSubstract:i,notifyDraw:a,winner:s,loser:u}}),l.next=3,c.partDAO.read(t);case 3:return h=l.sent.get(),f=h.lastUpdate.index,d=h.turn+1,(p=rq.copyImmutableArray(h.listMoves))[p.length]=r,v={listMoves:p,turn:d,request:null,lastUpdateTime:ZS.a.firestore.FieldValue.serverTimestamp()},v=c.updateScore(v,o),v=c.substractMs(v,h,i),null!=s?v=Mp(Mp({},v),{},{winner:s,loser:u,result:K4.VICTORY.value}):!0===a&&(v=Mp(Mp({},v),{},{result:K4.HARD_DRAW.value})),l.next=14,c.partDAO.updateAndBumpIndex(t,n,f,v);case 14:return l.abrupt("return",l.sent);case 15:case"end":return l.stop()}},l)}))()}},{key:"updateScore",value:function(e,t){return void 0!==t?Mp(Mp({},e),{},{scorePlayerZero:t[0],scorePlayerOne:t[1]}):e}},{key:"substractMs",value:function(e,t,n){return n[0]>0?Mp(Mp({},e),{},{remainingMsForZero:dz.getNonNullable(t.remainingMsForZero)-n[0]}):n[1]>0?Mp(Mp({},e),{},{remainingMsForOne:dz.getNonNullable(t.remainingMsForOne)-n[1]}):e}}]),e}()).VERBOSE=!1,z5.\u0275fac=function(e){return new(e||z5)(Vp.Zb(X4),Vp.Zb(Y5),Vp.Zb(i5))},z5.\u0275prov=Vp.Hb({token:z5,factory:z5.\u0275fac,providedIn:"root"}),z5);function J5(e){return function(t){return t.lift(new X5(e))}}var X5=function(){function e(t){Qp(this,e),this.notifier=t}return Kp(e,[{key:"call",value:function(e,t){var n=new e6(e),r=Object(L_.c)(this.notifier,new L_.a(n));return r&&!n.seenValue?(n.add(r),t.subscribe(n)):n}}]),e}(),e6=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,e)).seenValue=!1,r}return Kp(n,[{key:"notifyNext",value:function(){this.seenValue=!0,this.complete()}},{key:"notifyComplete",value:function(){}}]),n}(L_.b);function t6(e,t){if(1&e&&(Vp.Ob(0),Vp.Cc(1),Vp.Nb()),2&e){var n=Vp.fc(3);Vp.Bb(1),Vp.Dc(n.viewInfo.chosenOpponent)}}function n6(e,t){1&e&&Vp.Ub(0,44)}function r6(e,t){if(1&e&&(Vp.Qb(0,"div",45),Vp.Qb(1,"div",8),Vp.Qb(2,"label",46),Vp.Ob(3),Vp.Ub(4,47),Vp.Nb(),Vp.Qb(5,"output"),Vp.Cc(6),Vp.gc(7,"humanDuration"),Vp.Pb(),Vp.Pb(),Vp.Qb(8,"div",37),Vp.Mb(9,"input",48),Vp.Pb(),Vp.Pb(),Vp.Qb(10,"div",8),Vp.Qb(11,"label",49),Vp.Yb(12,50),Vp.Mb(13,"output"),Vp.gc(14,"humanDuration"),Vp.Wb(),Vp.Pb(),Vp.Qb(15,"div",37),Vp.Mb(16,"input",51),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc(3);Vp.Bb(6),Vp.Dc(Vp.hc(7,2,n.viewInfo.maximalMoveDuration||0)),Vp.Bb(8),Vp.Xb(Vp.hc(14,4,n.viewInfo.totalPartDuration||0)),Vp.Vb(12)}}function i6(e,t){1&e&&(Vp.Qb(0,"div"),Vp.Yb(1,52),Vp.Mb(2,"br"),Vp.Wb(),Vp.Pb())}function o6(e,t){1&e&&(Vp.Qb(0,"button",64),Vp.Ub(1,65),Vp.Pb())}function a6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"tr",60),Vp.cc("click",function(){Vp.wc(n);var e=t.$implicit;return Vp.fc(4).selectOpponent(e)}),Vp.Qb(1,"td",61),Vp.Cc(2),Vp.Pb(),Vp.Qb(3,"td",62),Vp.Ac(4,o6,2,0,"button",63),Vp.Pb(),Vp.Pb()}if(2&e){var r=t.$implicit,i=Vp.fc(4);Vp.nc("id","presenceOf_",r,""),Vp.mc("ngClass",i.viewInfo.candidateClasses[r]),Vp.Bb(1),Vp.mc("id",i.viewInfo.chosenOpponent===r&&"selected_"+r||"candidate_"+r),Vp.Bb(1),Vp.Dc(r),Vp.Bb(2),Vp.mc("ngIf",i.viewInfo.chosenOpponent!==r)}}function s6(e,t){if(1&e&&(Vp.Ob(0),Vp.Ub(1,53),Vp.Nb(),Vp.Qb(2,"div",54),Vp.Qb(3,"table",55),Vp.Qb(4,"thead"),Vp.Qb(5,"tr"),Vp.Qb(6,"th",56),Vp.Ub(7,57),Vp.Pb(),Vp.Qb(8,"th",56),Vp.Ub(9,58),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(10,"tbody"),Vp.Ac(11,a6,5,5,"tr",59),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc(3);Vp.Bb(11),Vp.mc("ngForOf",n.viewInfo.candidates)}}function u6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",66),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(3).changeConfig()}),Vp.Ub(1,67),Vp.Pb()}}function c6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"div"),Vp.Qb(1,"h1",4),Vp.Ub(2,5),Vp.Pb(),Vp.Qb(3,"form",6),Vp.Qb(4,"fieldset",7),Vp.Qb(5,"div",8),Vp.Qb(6,"label",9),Vp.Ub(7,10),Vp.Pb(),Vp.Qb(8,"div",11),Vp.Qb(9,"button",12),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).selectFirstPlayer("RANDOM")}),Vp.Ub(10,13),Vp.Pb(),Vp.Qb(11,"button",14),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).selectFirstPlayer("CREATOR")}),Vp.Ub(12,15),Vp.Pb(),Vp.Qb(13,"button",16),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).selectFirstPlayer("CHOSEN_PLAYER")}),Vp.Ac(14,t6,2,1,"ng-container",17),Vp.Ac(15,n6,1,0,"ng-template",null,18,Vp.Bc),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(17,"div",8),Vp.Qb(18,"label",9),Vp.Ub(19,19),Vp.Pb(),Vp.Qb(20,"div",11),Vp.Qb(21,"div",20),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).selectPartType("STANDARD")}),Vp.Qb(22,"div",21),Vp.Qb(23,"span"),Vp.Ub(24,22),Vp.Pb(),Vp.Pb(),Vp.Qb(25,"div",23),Vp.Qb(26,"div",24),Vp.Qb(27,"div",25),Vp.Qb(28,"p"),Vp.Ob(29),Vp.Ub(30,26),Vp.Nb(),Vp.Qb(31,"strong"),Vp.Cc(32),Vp.gc(33,"humanDuration"),Vp.Pb(),Vp.Mb(34,"br"),Vp.Ob(35),Vp.Yb(36,27),Vp.Mb(37,"strong"),Vp.gc(38,"humanDuration"),Vp.Wb(),Vp.Nb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(39,"div",28),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).selectPartType("BLITZ")}),Vp.Qb(40,"div",21),Vp.Qb(41,"span"),Vp.Ub(42,29),Vp.Pb(),Vp.Pb(),Vp.Qb(43,"div",23),Vp.Qb(44,"div",24),Vp.Qb(45,"div",25),Vp.Qb(46,"p"),Vp.Ob(47),Vp.Ub(48,30),Vp.Nb(),Vp.Qb(49,"strong"),Vp.Cc(50),Vp.gc(51,"humanDuration"),Vp.Pb(),Vp.Mb(52,"br"),Vp.Ob(53),Vp.Yb(54,31),Vp.Mb(55,"strong"),Vp.gc(56,"humanDuration"),Vp.Wb(),Vp.Nb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(57,"button",32),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).selectPartType("CUSTOM")}),Vp.Ub(58,33),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Ac(59,r6,17,6,"div",34),Vp.Qb(60,"div",8),Vp.Qb(61,"label",35),Vp.Ub(62,36),Vp.Pb(),Vp.Qb(63,"div",37),Vp.Ac(64,i6,3,0,"div",17),Vp.Ac(65,s6,12,1,"ng-template",null,38,Vp.Bc),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(67,"div",8),Vp.Qb(68,"div",11),Vp.Qb(69,"button",39),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).proposeConfig()}),Vp.Ub(70,40),Vp.Pb(),Vp.Ac(71,u6,2,0,"button",41),Vp.Qb(72,"button",42),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).cancelGameCreation()}),Vp.Ub(73,43),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.vc(16),i=Vp.vc(66),o=Vp.fc(2);Vp.Bb(3),Vp.mc("formGroup",o.configFormGroup),Vp.Bb(1),Vp.mc("disabled",!o.viewInfo.canEditConfig),Vp.Bb(5),Vp.mc("ngClass",o.viewInfo.firstPlayerClasses.RANDOM),Vp.Bb(2),Vp.mc("ngClass",o.viewInfo.firstPlayerClasses.CREATOR),Vp.Bb(2),Vp.mc("ngClass",o.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),Vp.Bb(1),Vp.mc("ngIf",o.viewInfo.chosenOpponent)("ngIfElse",r),Vp.Bb(7),Vp.mc("ngClass",o.viewInfo.partTypeClasses.STANDARD),Vp.Bb(11),Vp.Dc(Vp.hc(33,19,o.partType.NORMAL_MOVE_DURATION)),Vp.Bb(6),Vp.Xb(Vp.hc(38,21,o.partType.NORMAL_PART_DURATION)),Vp.Vb(36),Vp.Bb(1),Vp.mc("ngClass",o.viewInfo.partTypeClasses.BLITZ),Vp.Bb(11),Vp.Dc(Vp.hc(51,23,o.partType.BLITZ_MOVE_DURATION)),Vp.Bb(6),Vp.Xb(Vp.hc(56,25,o.partType.BLITZ_PART_DURATION)),Vp.Vb(54),Vp.Bb(1),Vp.mc("ngClass",o.viewInfo.partTypeClasses.CUSTOM),Vp.Bb(2),Vp.mc("ngIf",o.viewInfo.showCustomTime),Vp.Bb(5),Vp.mc("ngIf",0===o.viewInfo.candidates.length)("ngIfElse",i),Vp.Bb(5),Vp.mc("disabled",!o.viewInfo.canProposeConfig),Vp.Bb(2),Vp.mc("ngIf",o.viewInfo.canReviewConfig)}}function l6(e,t){if(1&e&&(Vp.Qb(0,"div",74),Vp.Qb(1,"p"),Vp.Yb(2,75),Vp.Mb(3,"br"),Vp.Wb(),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc(3);Vp.Bb(3),Vp.Xb(n.viewInfo.creator),Vp.Vb(2)}}function h6(e,t){if(1&e&&(Vp.Qb(0,"span"),Vp.Ub(1,81),Vp.Pb()),2&e){var n=Vp.fc(4);Vp.Bb(1),Vp.Xb(n.viewInfo.creator),Vp.Vb(1)}}function f6(e,t){1&e&&(Vp.Qb(0,"span"),Vp.Ub(1,82),Vp.Pb())}function d6(e,t){1&e&&(Vp.Qb(0,"span"),Vp.Ub(1,83),Vp.Pb())}function p6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"div",74),Vp.Qb(1,"p"),Vp.Ub(2,76),Vp.Pb(),Vp.Qb(3,"ul"),Vp.Qb(4,"li"),Vp.Ac(5,h6,2,1,"span",2),Vp.Ac(6,f6,2,0,"span",2),Vp.Ac(7,d6,2,0,"span",2),Vp.Pb(),Vp.Qb(8,"li"),Vp.Yb(9,77),Vp.Mb(10,"strong"),Vp.gc(11,"humanDuration"),Vp.Wb(),Vp.Pb(),Vp.Qb(12,"li"),Vp.Yb(13,78),Vp.Mb(14,"strong"),Vp.gc(15,"humanDuration"),Vp.Wb(),Vp.Pb(),Vp.Pb(),Vp.Qb(16,"button",79),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(3).acceptConfig()}),Vp.Ub(17,80),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.fc(3);Vp.Bb(2),Vp.Xb(r.viewInfo.creator)(r.viewInfo.partTypeName),Vp.Vb(2),Vp.Bb(3),Vp.mc("ngIf","CREATOR"===r.viewInfo.firstPlayer),Vp.Bb(1),Vp.mc("ngIf","CHOSEN_PLAYER"===r.viewInfo.firstPlayer),Vp.Bb(1),Vp.mc("ngIf","RANDOM"===r.viewInfo.firstPlayer),Vp.Bb(4),Vp.Xb(Vp.hc(11,7,r.viewInfo.maximalMoveDuration||0)),Vp.Vb(9),Vp.Bb(4),Vp.Xb(Vp.hc(15,9,r.viewInfo.totalPartDuration||0)),Vp.Vb(13)}}function v6(e,t){if(1&e&&(Vp.Qb(0,"div"),Vp.Qb(1,"div",68),Vp.Qb(2,"div",69),Vp.Qb(3,"p"),Vp.Ub(4,70),Vp.Pb(),Vp.Pb(),Vp.Qb(5,"div",71),Vp.Ac(6,l6,4,1,"div",72),Vp.Ac(7,p6,18,11,"ng-template",null,73,Vp.Bc),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.vc(8),r=Vp.fc(2);Vp.Bb(6),Vp.mc("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function g6(e,t){if(1&e&&(Vp.Ob(0),Vp.Ub(1,86),Vp.Nb()),2&e){var n=Vp.fc(3);Vp.Bb(1),Vp.Xb(n.viewInfo.creator),Vp.Vb(1)}}function y6(e,t){if(1&e&&Vp.Ub(0,87),2&e){var n=Vp.fc(3);Vp.Xb(n.viewInfo.creator)(n.viewInfo.chosenOpponent),Vp.Vb(0)}}function m6(e,t){if(1&e&&(Vp.Qb(0,"div",68),Vp.Qb(1,"div",69),Vp.Qb(2,"p"),Vp.Ub(3,84),Vp.Pb(),Vp.Pb(),Vp.Qb(4,"div",71),Vp.Qb(5,"p"),Vp.Ac(6,g6,2,1,"ng-container",17),Vp.Ac(7,y6,1,2,"ng-template",null,85,Vp.Bc),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.vc(8),r=Vp.fc(2);Vp.Bb(6),Vp.mc("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function b6(e,t){if(1&e&&(Vp.Qb(0,"div",1),Vp.Ac(1,c6,74,27,"div",2),Vp.Ac(2,v6,9,2,"div",2),Vp.Ac(3,m6,9,2,"div",3),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",n.viewInfo.userIsCreator),Vp.Bb(1),Vp.mc("ngIf",n.viewInfo.userIsChosenOpponent),Vp.Bb(1),Vp.mc("ngIf",n.viewInfo.userIsObserver)}}var _6,w6=((_6=function(){function e(t,n,r,i,o,a,s){Qp(this,e),this.router=t,this.gameService=n,this.joinerService=r,this.chatService=i,this.userService=o,this.formBuilder=a,this.messageDisplayer=s,this.partType=$5,this.gameStartNotification=new Vp.n,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentJoiner=null,this.candidateSubscription=new vq,this.creatorSubscription=null,this.ngUnsubscribe=new m_.a,this.allDocDeleted=!1,pz(e.VERBOSE,"PartCreationComponent constructed for "+this.userName)}return Kp(e,[{key:"ngOnInit",value:function(){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return pz(e.VERBOSE,"PartCreationComponent.ngOnInit for "+t.userName),t.checkInputs(),t.createForms(),n.next=5,t.joinerService.joinGame(t.partId,t.userName);case 5:if(n.t0=n.sent.isFailure(),n.t0){n.next=8;break}t.subscribeToJoinerDoc(),t.subscribeToFormElements(),pz(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds");case 8:case"end":return n.stop()}},n)}))()}},{key:"checkInputs",value:function(){vz(null!=this.userName&&""!==this.userName,"PartCreationComponent should not be created with an empty userName"),vz(null!=this.partId&&""!==this.partId,"PartCreationComponent should not be created with an empty partId")}},{key:"createForms",value:function(){this.configFormGroup=this.formBuilder.group({firstPlayer:[W5.RANDOM.value,Ly.required],maximalMoveDuration:[$5.NORMAL_MOVE_DURATION,Ly.required],partType:["STANDARD",Ly.required],totalPartDuration:[$5.NORMAL_PART_DURATION,Ly.required],chosenOpponent:["",Ly.required]})}},{key:"subscribeToJoinerDoc",value:function(){var e,t=this;this.joinerService.observe(this.partId).pipe(J5(this.ngUnsubscribe)).subscribe((e=JV(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCurrentJoinerUpdate(n);case 2:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"getForm",value:function(e){return dz.getNonNullable(this.configFormGroup.get(e))}},{key:"subscribeToFormElements",value:function(){var e=this;this.getForm("chosenOpponent").valueChanges.pipe(J5(this.ngUnsubscribe)).subscribe(function(t){void 0!==e.viewInfo.chosenOpponent&&(e.viewInfo.candidateClasses[e.viewInfo.chosenOpponent]=[]),e.viewInfo.candidateClasses[t]=["is-selected"],e.viewInfo.chosenOpponent=t,e.viewInfo.canProposeConfig=dz.getNonNullable(e.currentJoiner).partStatus!==Z5.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(J5(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.partTypeClasses[e.viewInfo.partType]=[],e.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],e.viewInfo.partType=t,e.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(J5(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(J5(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(J5(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.firstPlayerClasses[e.viewInfo.firstPlayer]=[],e.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],e.viewInfo.firstPlayer=t})}},{key:"updateViewInfo",value:function(){var e=dz.getNonNullable(this.currentJoiner);switch(this.viewInfo.canReviewConfig=e.partStatus===Z5.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==Z5.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userName===e.creator,this.viewInfo.userIsChosenOpponent=this.userName===e.chosenPlayer,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==Z5.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator,this.viewInfo.candidates=e.candidates,this.userName===e.creator?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenPlayer||void 0,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize(Qh||(Qh=xp(["custom"])));break;case"BLITZ":this.viewInfo.partTypeName=$localize(Yh||(Yh=xp(["blitz"])));break;case"STANDARD":this.viewInfo.partTypeName=$localize(Kh||(Kh=xp(["standard"])))}}},{key:"setDataForCreator",value:function(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration||e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration||e.totalPartDuration;var t=this.viewInfo.chosenOpponent;t?-1===e.candidates.indexOf(t)&&(t=""):t=e.chosenPlayer||"",this.getForm("chosenOpponent").setValue(t)}},{key:"selectFirstPlayer",value:function(e){this.getForm("firstPlayer").setValue(e)}},{key:"selectPartType",value:function(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue($5.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue($5.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue($5.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue($5.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}},{key:"selectOpponent",value:function(t){var n=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(pz(e.VERBOSE,"PartCreationComponent.setChosenPlayer("+t+")"),n.joinerService.setChosenPlayer(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"changeConfig",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.joinerService.reviewConfig());case 1:case"end":return t.stop()}},t)}))()}},{key:"proposeConfig",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n,r,i,o,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,o=e.getForm("firstPlayer").value,a=e.getForm("totalPartDuration").value,t.abrupt("return",e.joinerService.proposeConfig(n,$5.of(r),i,W5.of(o),a));case 2:case"end":return t.stop()}},t)}))()}},{key:"cancelGameCreation",value:function(){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.allDocDeleted=!0,pz(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),n.next=4,t.gameService.deletePart(t.partId);case 4:return pz(e.VERBOSE,"PartCreationComponent.cancelGameCreation: game deleted"),n.next=7,t.joinerService.deleteJoiner();case 7:return pz(e.VERBOSE,"PartCreationComponent.cancelGameCreation: game and joiner deleted"),n.next=10,t.chatService.deleteChat(t.partId);case 10:pz(e.VERBOSE,"PartCreationComponent.cancelGameCreation: game and joiner and chat deleted");case 11:case"end":return n.stop()}},n)}))()}},{key:"onCurrentJoinerUpdate",value:function(t){if(pz(e.VERBOSE,{PartCreationComponent_onCurrentJoinerUpdate:{before:JSON.stringify(this.currentJoiner),then:JSON.stringify(t)}}),t.isAbsent())return pz(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: LAST UPDATE : the game is cancelled"),this.onGameCancelled();this.currentJoiner=t.get(),this.observeNeededPlayers(),this.updateViewInfo(),this.isGameStarted()&&(pz(e.VERBOSE,"PartCreationComponent.onCurrentJoinerUpdate: the game has started"),this.onGameStarted())}},{key:"onGameCancelled",value:function(){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return pz(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize(Jh||(Jh=xp(["The game has been canceled!"])))),n.next=4,t.router.navigate(["/lobby"]);case 4:case"end":return n.stop()}},n)}))()}},{key:"isGameStarted",value:function(){var e=dz.getNonNullable(this.currentJoiner);return null!=e&&e.partStatus===Z5.PART_STARTED.value}},{key:"onGameStarted",value:function(){var t=dz.getNonNullable(this.currentJoiner);pz(e.VERBOSE,{partCreationComponent_onGameStarted:{joiner:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,pz(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}},{key:"observeNeededPlayers",value:function(){var t=dz.getNonNullable(this.currentJoiner);pz(e.VERBOSE,{PartCreationComponent_updateJoiner:{joiner:t}}),this.userName===t.creator?this.observeCandidates():this.observeCreator()}},{key:"observeCreator",value:function(){var e=this,t=dz.getNonNullable(this.currentJoiner);if(null==this.creatorSubscription){var n,r=(n=JV(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.destroyDocIfCreatorOffline(n);case 2:case"end":return t.stop()}},t)})),function(e){return n.apply(this,arguments)}),i=new Z4(r,r,r);this.creatorSubscription=this.userService.observeUserByUsername(t.creator,i)}}},{key:"destroyDocIfCreatorOffline",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=dz.getNonNullable(t.currentJoiner),i=zp(e),n.prev=2,i.s();case 4:if((o=i.n()).done){n.next=13;break}if(vz((a=o.value).data.username===r.creator,"found non creator while observing creator!"),n.t0="offline"===a.data.state&&!1===t.allDocDeleted&&r.partStatus!==Z5.PART_STARTED.value,!n.t0){n.next=11;break}return n.next=11,t.cancelGameCreation();case 11:n.next=4;break;case 13:n.next=18;break;case 15:n.prev=15,n.t1=n.catch(2),i.e(n.t1);case 18:return n.prev=18,i.f(),n.finish(18);case 21:case"end":return n.stop()}},n,null,[[2,15,18,21]])}))()}},{key:"observeCandidates",value:function(){var t=this,n=dz.getNonNullable(this.currentJoiner);pz(e.VERBOSE,{PartCreation_observeCandidates:n});var r,i,o,a,s=new Z4((o=JV(regeneratorRuntime.mark(function e(n){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=zp(n),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=13;break}if(o=i.value,e.t0="offline"===o.data.state,!e.t0){e.next=11;break}return e.next=9,t.removeUserFromLobby(dz.getNonNullable(o.data.username));case 9:return e.next=11,fz.logError("PartCreationComponent","user is already offline",{username:o.data.username,userId:o.id});case 11:e.next=3;break;case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(1),r.e(e.t1);case 18:return e.prev=18,r.f(),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[1,15,18,21]])})),function(e){return o.apply(this,arguments)}),(i=JV(regeneratorRuntime.mark(function e(n){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=zp(n),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=11;break}if(o=i.value,e.t0="offline"===o.data.state,!e.t0){e.next=9;break}return e.next=9,t.removeUserFromLobby(dz.getNonNullable(o.data.username));case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(1),r.e(e.t1);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[1,13,16,19]])})),function(e){return i.apply(this,arguments)}),(r=JV(regeneratorRuntime.mark(function e(n){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=zp(n),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=11;break}return o=i.value,e.next=7,t.removeUserFromLobby(dz.getNonNullable(o.data.username));case 7:return e.next=9,fz.logError("PartCreationComponent","user was deleted",{username:o.data.username,userId:o.id});case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[1,13,16,19]])})),function(e){return r.apply(this,arguments)})),u=zp(n.candidates);try{for(u.s();!(a=u.n()).done;){var c=a.value;if(this.candidateSubscription.get(c).isAbsent()){var l=this.userService.observeUserByUsername(c,s);this.candidateSubscription.set(c,l)}}}catch(p){u.e(p)}finally{u.f()}var h,f=zp(this.candidateSubscription.listKeys());try{for(f.s();!(h=f.n()).done;){var d=h.value;d!==n.chosenPlayer&&!1===n.candidates.includes(d)&&this.unsubscribeFrom(d)}}catch(p){f.e(p)}finally{f.f()}}},{key:"removeUserFromLobby",value:function(e){var t=dz.getNonNullable(this.currentJoiner),n=t.candidates.indexOf(e);vz(-1!==n,"PartCreationComponent: attempting to remove a user not in the lobby");var r=t.candidates.slice(0,n),i=t.candidates.slice(n+1),o=r.concat(i);return e===t.chosenPlayer?(this.messageDisplayer.infoMessage($localize(Xh||(Xh=xp([""," left the game, please pick another opponent."])),e)),this.joinerService.reviewConfigRemoveChosenPlayerAndUpdateCandidates(o)):this.joinerService.updateCandidates(o)}},{key:"unsubscribeFrom",value:function(e){this.candidateSubscription.delete(e)()}},{key:"acceptConfig",value:function(){return pz(e.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,dz.getNonNullable(this.currentJoiner))}},{key:"ngOnDestroy",value:function(){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:pz(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),r=zp(t.candidateSubscription.listKeys());try{for(r.s();!(i=r.n()).done;)o=i.value,t.unsubscribeFrom(o)}catch(a){r.e(a)}finally{r.f()}if(!1!==t.gameStarted){n.next=17;break}if(null!==t.currentJoiner){n.next=6;break}return n.abrupt("return",void pz(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"));case 6:if(t.userName!==t.currentJoiner.creator){n.next=12;break}return pz(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),n.next=10,t.cancelGameCreation();case 10:n.next=17;break;case 12:if(n.t0=!1===t.allDocDeleted,!n.t0){n.next=17;break}return pz(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(joiner) about to cancel game joining"),n.next=17,t.joinerService.cancelJoining(t.userName);case 17:case"end":return n.stop()}},n)}))()}}]),e}()).VERBOSE=!1,_6.\u0275fac=function(e){return new(e||_6)(Vp.Lb(VC),Vp.Lb(K5),Vp.Lb(Y5),Vp.Lb(i5),Vp.Lb(Y4),Vp.Lb(Cb),Vp.Lb(qG))},_6.\u0275cmp=Vp.Fb({type:_6,selectors:[["app-part-creation"]],inputs:{partId:"partId",userName:"userName"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){return[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],$localize(ef||(ef=xp(["Game creation"]))),[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],$localize(tf||(tf=xp(["First player"]))),[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],$localize(nf||(nf=xp(["Random"]))),["id","firstPlayerCreator",1,"button",3,"ngClass","click"],$localize(rf||(rf=xp(["You"]))),["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],$localize(of||(of=xp(["Game type"]))),["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],$localize(af||(af=xp(["Standard"]))),["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],$localize(sf||(sf=xp(["Maximal turn duration: "]))),$localize(uf||(uf=xp(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#37\ufffd","\ufffd0\ufffd","\ufffd/#37\ufffd"),["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],$localize(cf||(cf=xp(["Blitz"]))),$localize(lf||(lf=xp(["Maximal turn duration: "]))),$localize(hf||(hf=xp(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#55\ufffd","\ufffd0\ufffd","\ufffd/#55\ufffd"),["id","partTypeCustom",1,"button",3,"ngClass","click"],$localize(ff||(ff=xp(["Custom"]))),["id","customTime",4,"ngIf"],[1,"label"],$localize(df||(df=xp(["Opponents"]))),[1,"control"],["chooseCandidate",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],$localize(pf||(pf=xp(["Propose configuration"]))),["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],$localize(vf||(vf=xp(["Cancel game"]))),$localize(gf||(gf=xp(["The opponent"]))),["id","customTime"],["for","maximalMoveDuration",1,"label"],$localize(yf||(yf=xp(["Maximal turn duration: "]))),["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$localize(mf||(mf=xp(["Maximal game duration: ",":START_TAG_OUTPUT:",":INTERPOLATION: per player",":CLOSE_TAG_OUTPUT:"])),"\ufffd#13\ufffd","\ufffd0\ufffd","\ufffd/#13\ufffd"),["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],$localize(bf||(bf=xp(["Potential opponents that join the game will appear here.",":LINE_BREAK:Wait for an opponent to join, so that you can pick one."])),"\ufffd#2\ufffd\ufffd/#2\ufffd"),$localize(_f||(_f=xp(["Click on the opponent against which you would like to play."]))),["id","chooseCandidate",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(wf||(wf=xp(["Name"]))),$localize(kf||(kf=xp(["Actions"]))),[3,"ngClass","id","click",4,"ngFor","ngForOf"],[3,"ngClass","id","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],$localize(Cf||(Cf=xp(["Pick"]))),["id","reviewConfig",1,"button",3,"click"],$localize(Ef||(Ef=xp(["Change configuration"]))),[1,"message","is-primary"],[1,"message-header"],$localize(Of||(Of=xp(["Configuration proposal"]))),[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],$localize(Sf||(Sf=xp(["You have been selected as the opponent.",":LINE_BREAK: ",":INTERPOLATION: is modifying the configuration."])),"\ufffd#3\ufffd\ufffd/#3\ufffd","\ufffd0\ufffd"),$localize(Pf||(Pf=xp(["",":INTERPOLATION: proposes to play a ",":INTERPOLATION_1: game"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(If||(If=xp(["a turn lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: ",":CLOSE_TAG_STRONG:"])),"\ufffd#10\ufffd","\ufffd0\ufffd","\ufffd/#10\ufffd"),$localize(Tf||(Tf=xp(["the game lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#14\ufffd","\ufffd0\ufffd","\ufffd/#14\ufffd"),["id","acceptConfig",1,"button","is-primary",3,"click"],$localize(Af||(Af=xp(["Accept and start"]))),$localize(Nf||(Nf=xp(["",":INTERPOLATION: plays first"])),"\ufffd0\ufffd"),$localize(xf||(xf=xp(["you play first"]))),$localize(Rf||(Rf=xp(["the first player is selected randomly"]))),$localize(Mf||(Mf=xp(["One moment..."]))),["proposalSent",""],$localize(Df||(Df=xp(["",":INTERPOLATION: is configuring the game."])),"\ufffd0\ufffd"),$localize(Lf||(Lf=xp(["",":INTERPOLATION: has proposed a configuration to ",":INTERPOLATION_1:."])),"\ufffd0\ufffd","\ufffd1\ufffd")]},template:function(e,t){1&e&&Vp.Ac(0,b6,4,3,"div",0),2&e&&Vp.mc("ngIf",t.viewInfo)},directives:[yg,Hm,um,Qm,dg,Ay,Wm,sm,Km,vg],pipes:[U5],encapsulation:2}),_6);function k6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",3),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().addTime()}),Vp.Ub(1,4),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.Bb(1),Vp.Xb(r.timeToAdd),Vp.Vb(1)}}var C6,E6=((C6=function(){function e(){Qp(this,e),this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new Vp.n,this.addTimeToOpponent=new Vp.n,this.cssClasses=e.SAFE_TIME}return Kp(e,[{key:"ngOnInit",value:function(){pz(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}},{key:"setDuration",value:function(t){if(pz(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}},{key:"changeDuration",value:function(e){var t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}},{key:"displayDuration",value:function(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}},{key:"start",value:function(){if(pz(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}},{key:"resume",value:function(){var t=this;if(pz(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();var n=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(function(){t.onEndReached()},n),this.countSeconds()}},{key:"onEndReached",value:function(){pz(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}},{key:"countSeconds",value:function(){var e=this;this.timeoutHandleSec=window.setTimeout(function(){e.updateShownTime()},1e3)}},{key:"isIdle",value:function(){return!1===this.started||this.isPaused}},{key:"pause",value:function(){if(pz(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}},{key:"stop",value:function(){if(pz(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}},{key:"isStarted",value:function(){return this.started}},{key:"getTimeClass",value:function(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}},{key:"updateShownTime",value:function(){var e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}},{key:"clearTimeouts",value:function(){pz(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}},{key:"addTime",value:function(){this.addTimeToOpponent.emit()}},{key:"ngOnDestroy",value:function(){this.clearTimeouts()}}]),e}()).VERBOSE=!1,C6.DANGER_TIME_EVEN="has-background-danger has-text-white",C6.DANGER_TIME_ODD="has-background-warning has-text-white",C6.PASSIVE_STYLE="has-text-passive is-italic",C6.SAFE_TIME="",C6.\u0275fac=function(e){return new(e||C6)},C6.\u0275cmp=Vp.Fb({type:C6,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){return[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],$localize(Bf||(Bf=xp(["Add ",":INTERPOLATION:"])),"\ufffd0\ufffd")]},template:function(e,t){1&e&&(Vp.Qb(0,"div",0),Vp.Qb(1,"p",1),Vp.Cc(2),Vp.gc(3,"number"),Vp.Pb(),Vp.Ac(4,k6,2,1,"button",2),Vp.Pb()),2&e&&(Vp.mc("ngClass",t.getTimeClass()),Vp.Bb(2),Vp.Fc("",t.displayedMinute,":",Vp.ic(3,4,t.displayedSec,"2.0-0"),""),Vp.Bb(2),Vp.mc("ngIf",t.canAddTime))},directives:[dg,yg],pipes:[Og],encapsulation:2}),C6),O6=["partCreation"],S6=["chatComponent"],P6=["chronoZeroGlobal"],I6=["chronoOneGlobal"],T6=["chronoZeroTurn"],A6=["chronoOneTurn"];function N6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"app-part-creation",5,6),Vp.cc("gameStartNotification",function(e){return Vp.wc(n),Vp.fc().startGame(e)}),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.mc("partId",r.currentPartId)("userName",r.getPlayerName())}}function x6(e,t){1&e&&(Vp.Ob(0),Vp.Ub(1,40),Vp.Nb())}function R6(e,t){if(1&e&&Vp.Ub(0,41),2&e){var n=Vp.fc(4);Vp.Xb(n.currentPlayer),Vp.Vb(0)}}function M6(e,t){if(1&e&&(Vp.Qb(0,"p",37),Vp.Ac(1,x6,2,0,"ng-container",38),Vp.Ac(2,R6,1,1,"ng-template",null,39,Vp.Bc),Vp.Pb()),2&e){var n=Vp.vc(3),r=Vp.fc(3);Vp.Bb(1),Vp.mc("ngIf",r.currentPlayer===r.getPlayerName())("ngIfElse",n)}}function D6(e,t){if(1&e&&(Vp.Qb(0,"div",33),Vp.Qb(1,"p",34),Vp.Ub(2,35),Vp.Pb(),Vp.Ac(3,M6,4,2,"p",36),Vp.Pb()),2&e){var n=Vp.fc(2);Vp.Bb(2),Vp.Xb(n.currentPart.getTurn()+1),Vp.Vb(2),Vp.Bb(1),Vp.mc("ngIf",!1===n.endGame)}}function L6(e,t){if(1&e&&(Vp.Qb(0,"p",42),Vp.Cc(1),Vp.Pb()),2&e){var n=Vp.fc(2);Vp.mc("ngClass",n.getPlayerNameClass(0)),Vp.Bb(1),Vp.Dc(n.players[0].get())}}function B6(e,t){if(1&e&&(Vp.Qb(0,"p",43),Vp.Ub(1,44),Vp.Pb()),2&e){var n=Vp.fc(2);Vp.Bb(1),Vp.Xb(n.gameComponent.scores.get()[0]),Vp.Vb(1)}}function F6(e,t){if(1&e&&(Vp.Qb(0,"p",45),Vp.Cc(1),Vp.Pb()),2&e){var n=Vp.fc(2);Vp.mc("ngClass",n.getPlayerNameClass(1)),Vp.Bb(1),Vp.Dc(n.players[1].get())}}function j6(e,t){if(1&e&&(Vp.Qb(0,"p",46),Vp.Ub(1,47),Vp.Pb()),2&e){var n=Vp.fc(2);Vp.Bb(1),Vp.Xb(n.gameComponent.scores.get()[1]),Vp.Vb(1)}}function U6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",56),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(3).resign()}),Vp.Ub(1,57),Vp.Pb()}}function V6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",58),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(3).proposeDraw()}),Vp.Ub(1,59),Vp.Pb()}}function z6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",60),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(3).acceptDraw()}),Vp.Ub(1,61),Vp.Pb()}}function H6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",62),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(3).refuseDraw()}),Vp.Ub(1,63),Vp.Pb()}}function G6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",64),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(3).gameComponent.pass()}),Vp.Ub(1,65),Vp.Pb()}}function q6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",66),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(3).acceptTakeBack()}),Vp.Ub(1,67),Vp.Pb()}}function W6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",68),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(3).refuseTakeBack()}),Vp.Ub(1,69),Vp.Pb()}}function $6(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",70),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(3).askTakeBack()}),Vp.Ub(1,71),Vp.Pb()}}function Z6(e,t){if(1&e&&(Vp.Ob(0),Vp.Ac(1,U6,2,0,"button",48),Vp.Ac(2,V6,2,0,"button",49),Vp.Ac(3,z6,2,0,"button",50),Vp.Ac(4,H6,2,0,"button",51),Vp.Ac(5,G6,2,0,"button",52),Vp.Ac(6,q6,2,0,"button",53),Vp.Ac(7,W6,2,0,"button",54),Vp.Ac(8,$6,2,0,"button",55),Vp.Nb()),2&e){var n=Vp.fc(2);Vp.Bb(1),Vp.mc("ngIf",n.canResign()),Vp.Bb(1),Vp.mc("ngIf",n.canProposeDraw()),Vp.Bb(1),Vp.mc("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),Vp.Bb(1),Vp.mc("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),Vp.Bb(1),Vp.mc("ngIf",!1===n.endGame&&n.isPlaying()&&n.gameComponent.canPass&&n.currentPlayer===n.getPlayerName()),Vp.Bb(1),Vp.mc("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),Vp.Bb(1),Vp.mc("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),Vp.Bb(1),Vp.mc("ngIf",!1===n.endGame&&!1===n.isOpponentWaitingForTakeBackResponse()&&n.canAskTakeBack())}}function Q6(e,t){1&e&&(Vp.Qb(0,"div"),Vp.Qb(1,"p",73),Vp.Ub(2,74),Vp.Pb(),Vp.Pb())}function Y6(e,t){1&e&&(Vp.Qb(0,"p",78),Vp.Ub(1,79),Vp.Pb())}function K6(e,t){1&e&&(Vp.Qb(0,"p",80),Vp.Ub(1,81),Vp.Pb())}function J6(e,t){1&e&&(Vp.Qb(0,"p",82),Vp.Ub(1,83),Vp.Pb())}function X6(e,t){if(1&e&&(Vp.Qb(0,"div"),Vp.Ac(1,Y6,2,0,"p",75),Vp.Ac(2,K6,2,0,"p",76),Vp.Ac(3,J6,2,0,"p",77),Vp.Pb()),2&e){var n=Vp.fc(3);Vp.Bb(1),Vp.mc("ngIf",n.currentPart.getDrawAccepter()===n.getPlayerName()),Vp.Bb(1),Vp.mc("ngIf",n.currentPart.getDrawAccepter()!==n.getPlayerName()&&n.isPlaying()),Vp.Bb(1),Vp.mc("ngIf",!1===n.isPlaying())}}function e8(e,t){1&e&&(Vp.Qb(0,"p",86),Vp.Ub(1,87),Vp.Pb())}function t8(e,t){1&e&&(Vp.Qb(0,"p",88),Vp.Ub(1,89),Vp.Pb())}function n8(e,t){if(1&e&&(Vp.Qb(0,"p",88),Vp.Ub(1,90),Vp.Pb()),2&e){var n=Vp.fc(4);Vp.Bb(1),Vp.Xb(n.currentPart.getWinner().get()),Vp.Vb(1)}}function r8(e,t){if(1&e&&(Vp.Qb(0,"div"),Vp.Ac(1,e8,2,0,"p",84),Vp.Ac(2,t8,2,0,"p",85),Vp.Ac(3,n8,2,1,"p",85),Vp.Pb()),2&e){var n=Vp.fc(3);Vp.Bb(1),Vp.mc("ngIf",n.currentPart.getWinner().get()===n.getPlayerName()),Vp.Bb(1),Vp.mc("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Vp.Bb(1),Vp.mc("ngIf",!1===n.isPlaying())}}function i8(e,t){if(1&e&&(Vp.Qb(0,"p",86),Vp.Ub(1,91),Vp.Pb()),2&e){var n=Vp.fc(4);Vp.Bb(1),Vp.Xb(n.currentPart.getLoser().get()),Vp.Vb(1)}}function o8(e,t){1&e&&(Vp.Qb(0,"p",88),Vp.Ub(1,92),Vp.Pb())}function a8(e,t){if(1&e&&(Vp.Qb(0,"p",88),Vp.Ub(1,93),Vp.Pb()),2&e){var n=Vp.fc(4);Vp.Bb(1),Vp.Xb(n.currentPart.getLoser().get()),Vp.Vb(1)}}function s8(e,t){if(1&e&&(Vp.Qb(0,"div"),Vp.Ac(1,i8,2,1,"p",84),Vp.Ac(2,o8,2,0,"p",85),Vp.Ac(3,a8,2,1,"p",85),Vp.Pb()),2&e){var n=Vp.fc(3);Vp.Bb(1),Vp.mc("ngIf",n.currentPart.getWinner().get()===n.getPlayerName()),Vp.Bb(1),Vp.mc("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Vp.Bb(1),Vp.mc("ngIf",!1===n.isPlaying())}}function u8(e,t){1&e&&(Vp.Qb(0,"p",95),Vp.Ub(1,96),Vp.Pb())}function c8(e,t){if(1&e&&(Vp.Qb(0,"p",95),Vp.Ub(1,97),Vp.Pb()),2&e){var n=Vp.fc(4);Vp.Bb(1),Vp.Xb(n.currentPart.getLoser().get()),Vp.Vb(1)}}function l8(e,t){if(1&e&&(Vp.Qb(0,"div"),Vp.Ac(1,u8,2,0,"p",94),Vp.Ac(2,c8,2,1,"p",94),Vp.Pb()),2&e){var n=Vp.fc(3);Vp.Bb(1),Vp.mc("ngIf",n.currentPart.getWinner().get()!==n.getPlayerName()&&n.isPlaying()),Vp.Bb(1),Vp.mc("ngIf",!1===n.isPlaying()||n.currentPart.getWinner().get()===n.getPlayerName())}}function h8(e,t){if(1&e&&(Vp.Qb(0,"div",72),Vp.Mb(1,"hr"),Vp.Ac(2,Q6,3,0,"div",26),Vp.Ac(3,X6,4,3,"div",26),Vp.Ac(4,r8,4,3,"div",26),Vp.Ac(5,s8,4,3,"div",26),Vp.Ac(6,l8,3,2,"div",26),Vp.Pb()),2&e){var n=Vp.fc(2);Vp.Bb(2),Vp.mc("ngIf",n.currentPart.isHardDraw()),Vp.Bb(1),Vp.mc("ngIf",n.currentPart.isAgreedDraw()),Vp.Bb(1),Vp.mc("ngIf",n.currentPart.isWin()),Vp.Bb(1),Vp.mc("ngIf",n.currentPart.isTimeout()),Vp.Bb(1),Vp.mc("ngIf",n.currentPart.isResign())}}function f8(e,t){1&e&&(Vp.Qb(0,"button",98),Vp.Ub(1,99),Vp.Pb())}function d8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",100),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).proposeRematch()}),Vp.Ub(1,101),Vp.Pb()}}function p8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",102),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).acceptRematch()}),Vp.Ub(1,103),Vp.Pb()}}function v8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"div",7),Vp.Qb(1,"div",8),Vp.Qb(2,"div",9),Vp.Ac(3,D6,4,2,"div",10),Vp.Qb(4,"div",11),Vp.Ac(5,L6,2,2,"p",12),Vp.Ac(6,B6,2,1,"p",13),Vp.Qb(7,"app-count-down",14,15),Vp.cc("outOfTimeAction",function(){return Vp.wc(n),Vp.fc().reachedOutOfTime(0)})("addTimeToOpponent",function(){return Vp.wc(n),Vp.fc().addGlobalTime()}),Vp.Pb(),Vp.Qb(9,"app-count-down",16,17),Vp.cc("outOfTimeAction",function(){return Vp.wc(n),Vp.fc().reachedOutOfTime(0)})("addTimeToOpponent",function(){return Vp.wc(n),Vp.fc().addTurnTime()}),Vp.Pb(),Vp.Pb(),Vp.Qb(11,"p",18),Vp.Ub(12,19),Vp.Pb(),Vp.Qb(13,"div",11),Vp.Ac(14,F6,2,2,"p",20),Vp.Ac(15,j6,2,1,"p",21),Vp.Qb(16,"app-count-down",22,23),Vp.cc("outOfTimeAction",function(){return Vp.wc(n),Vp.fc().reachedOutOfTime(1)})("addTimeToOpponent",function(){return Vp.wc(n),Vp.fc().addGlobalTime()}),Vp.Pb(),Vp.Qb(18,"app-count-down",24,25),Vp.cc("outOfTimeAction",function(){return Vp.wc(n),Vp.fc().reachedOutOfTime(1)})("addTimeToOpponent",function(){return Vp.wc(n),Vp.fc().addTurnTime()}),Vp.Pb(),Vp.Pb(),Vp.Mb(20,"hr"),Vp.Ac(21,Z6,9,8,"ng-container",26),Vp.Ac(22,h8,7,5,"div",27),Vp.Ac(23,f8,2,0,"button",28),Vp.Ac(24,d8,2,0,"button",29),Vp.Ac(25,p8,2,0,"button",30),Vp.Pb(),Vp.Pb(),Vp.Qb(26,"div",31),Vp.Qb(27,"div",32),Vp.Mb(28,"app-game-includer"),Vp.Pb(),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.Bb(3),Vp.mc("ngIf",r.currentPart),Vp.Bb(2),Vp.mc("ngIf",r.players[0].isPresent()),Vp.Bb(1),Vp.mc("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),Vp.Bb(1),Vp.mc("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",1===r.observerRole&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),Vp.Bb(2),Vp.mc("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",1===r.observerRole&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),Vp.Bb(5),Vp.mc("ngIf",r.players[1].isPresent()),Vp.Bb(1),Vp.mc("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),Vp.Bb(1),Vp.mc("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",0===r.observerRole&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),Vp.Bb(2),Vp.mc("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",0===r.observerRole&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),Vp.Bb(3),Vp.mc("ngIf",r.isPlaying()),Vp.Bb(1),Vp.mc("ngIf",r.endGame),Vp.Bb(1),Vp.mc("ngIf",r.endGame),Vp.Bb(1),Vp.mc("ngIf",r.endGame&&r.isPlaying()&&!1===r.rematchProposed),Vp.Bb(1),Vp.mc("ngIf",r.endGame&&r.isPlaying()&&r.rematchProposed&&r.opponentProposedRematch),Vp.Bb(1),Vp.mc("ngClass",r.getBoardHighlight())}}var g8,y8=function(){var e=function e(t){Qp(this,e),this.value=t};return e.PRE_START_DOC=new e("PRE_START_DOC"),e.STARTING_DOC=new e("STARTING_DOC"),e.DUPLICATE=new e("DUPLICATE"),e.MOVE_WITHOUT_TIME=new e("MOVE_WITHOUT_TIME"),e.MOVE=new e("MOVE"),e.REQUEST=new e("REQUEST"),e.END_GAME=new e("END_GAME"),e.END_GAME_WITHOUT_TIME=new e("END_GAME_WITHOUT_TIME"),e.ACCEPT_TAKE_BACK_WITHOUT_TIME=new e("ACCEPT_TAKE_BACK_WITHOUT_TIME"),e}(),m8=((g8=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a,s){var u;return Qp(this,n),(u=t.call(this,e,r,a)).router=i,u.userService=o,u.gameService=s,u.gameStarted=!1,u.opponent=null,u.playerName=null,u.rematchProposed=!1,u.opponentProposedRematch=!1,u.hasUserPlayed=[!1,!1],u.msToSubstract=[0,0],u.opponentSubscription=kz.empty(),u.OFFLINE_FONT_COLOR={color:"lightgrey"},u.globalTimeMessage=$localize(Ff||(Ff=xp(["5 minutes"]))),u.turnTimeMessage=$localize(jf||(jf=xp(["30 seconds"]))),pz(n.VERBOSE,"OnlineGameWrapperComponent constructed"),u}return Kp(n,[{key:"extractPartIdFromURL",value:function(){return dz.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}},{key:"extractGameTypeFromURL",value:function(){return dz.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}},{key:"isPlaying",value:function(){return this.observerRole===HG.ZERO.value||this.observerRole===HG.ONE.value}},{key:"getPlayer",value:function(){return HG.of(this.observerRole)}},{key:"getPlayerName",value:function(){return dz.getNonNullable(this.playerName)}},{key:"isPlayer",value:function(e){return this.observerRole===e.value}},{key:"isOpponent",value:function(e){return this.observerRole!==e.value}},{key:"redirectIfPartIsInvalid",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.extractGameTypeFromURL(),t.next=3,e.gameService.getPartValidity(e.currentPartId,n);case 3:if(!t.sent.isFailure()){t.next=8;break}return e.routerEventsSub.unsubscribe(),t.next=8,e.router.navigate(["/notFound"]);case 8:case"end":return t.stop()}},t)}))()}},{key:"setCurrentPartIdOrRedirect",value:function(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartIsInvalid()}},{key:"ngOnInit",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return pz(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSub=e.router.events.subscribe(function(){var t=JV(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n instanceof gw,!t.t0){t.next=4;break}return t.next=4,e.setCurrentPartIdOrRedirect();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.userSub=e.authenticationService.getUserObs().subscribe(function(t){e.playerName=t.username.get()}),t.next=5,e.setCurrentPartIdOrRedirect();case 5:case"end":return t.stop()}},t)}))()}},{key:"startGame",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:pz(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),vz(!1===t.gameStarted,"Should not start already started game"),t.joiner=e,t.gameStarted=!0,setTimeout(JV(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.afterGameIncluderViewInit(),e.next=3,t.startPart();case 3:case"end":return e.stop()}},e)})),1);case 1:case"end":return r.stop()}},r)}))()}},{key:"startPart",value:function(){var e,t=this;pz(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.gameService.startObserving(this.currentPartId,(e=JV(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return vz(n.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.next=3,t.onCurrentPartUpdate(n.get());case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"onCurrentPartUpdate",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new J4(t.currentPartId,e),pz(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:t.currentPart,then:e.data,before_part_turn:i.data.turn,before_state_turn:t.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),o=t.getUpdateType(i),a=e.turn,pz(n.VERBOSE,o===y8.REQUEST?"UpdateType: Request("+dz.getNonNullable(i.data.request).code+") ("+a+")":"UpdateType: "+o.value+"("+a+")"),s=t.currentPart,r.t0=(t.currentPart=i,o),r.next=r.t0===y8.REQUEST?8:r.t0===y8.ACCEPT_TAKE_BACK_WITHOUT_TIME?11:r.t0===y8.DUPLICATE?12:r.t0===y8.END_GAME_WITHOUT_TIME?13:r.t0===y8.END_GAME?14:r.t0===y8.MOVE_WITHOUT_TIME?15:r.t0===y8.MOVE?16:r.t0===y8.PRE_START_DOC?17:19;break;case 8:return r.next=10,t.onRequest(dz.getNonNullable(i.data.request),s);case 10:return r.abrupt("return",r.sent);case 11:return r.abrupt("return",void(t.currentPart=s));case 12:return r.abrupt("return");case 13:return r.abrupt("return",void(t.currentPart=s));case 14:return r.abrupt("return",t.applyEndGame());case 15:return r.abrupt("return",void(t.currentPart=s));case 16:return r.abrupt("return",(t.msToSubstract=t.getLastUpdateTime(s,i,o),t.doNewMoves(i)));case 17:return u=null==t.currentPart||null!=t.currentPart.data.beginning,r.abrupt("return",void vz(null==s||null==s.data.beginning||u,"old part had no beginning time or new part has, we did not expect this!"));case 19:return r.abrupt("return",(vz(o===y8.STARTING_DOC,"Unexpected update type "+o),t.setChronos(),t.setPlayersDatas(i),t.startCountDownFor(HG.ZERO)));case 20:case"end":return r.stop()}},r)}))()}},{key:"getUpdateType",value:function(e){var t=j5.from(null!=this.currentPart?this.currentPart.data:null,e.data);pz(n.VERBOSE,{diff:t});var r=t.countChanges();if(0===r)return y8.DUPLICATE;if(e.data.request){var i=null!=t.removed.lastUpdateTime;return"TakeBackAccepted"===e.data.request.code&&i?y8.ACCEPT_TAKE_BACK_WITHOUT_TIME:y8.REQUEST}if(this.isMove(t,r))return 1===e.data.turn?null==e.data.lastUpdateTime?y8.MOVE_WITHOUT_TIME:y8.MOVE:null==t.modified.lastUpdateTime?y8.MOVE_WITHOUT_TIME:y8.MOVE;if(null==e.data.beginning)return y8.PRE_START_DOC;if(e.data.result!==K4.UNACHIEVED.value){var o=null==t.modified.lastUpdateTime;return null!=t.modified.turn&&o?y8.END_GAME_WITHOUT_TIME:y8.END_GAME}return vz(null!=e.data.beginning&&0===e.data.listMoves.length,"Unexpected update: "+JSON.stringify(t)),y8.STARTING_DOC}},{key:"isMove",value:function(e,t){return null!=e.modified.listMoves&&null!=e.modified.turn&&t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+3}},{key:"getLastUpdateTime",value:function(e,t,n){var r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);vz(null!=r,"TODO: OLD_TIME WAS NULL, UNDO COMMENT AND TEST!"),vz(null!=i,"TODO UPDATE_TIME WAS NULL, UNDO COMMENT AND TEST!");var o=HG.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(dz.getNonNullable(r),dz.getNonNullable(i),n,o)}},{key:"getMoreRecentTime",value:function(e){return null==e.data.lastUpdateTime?e.data.beginning:e.data.lastUpdateTime}},{key:"getTimeUsedForLastTurn",value:function(e,t,n,r){var i,o=(i=e,V5(t)-V5(i)),a=[0,0];return a[r.value]=o,a}},{key:"setChronos",value:function(){pz(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.joiner.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.joiner.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.joiner.maximalMoveDuration)}},{key:"didUserPlay",value:function(e){return this.hasUserPlayed[e.value]}},{key:"doNewMoves",value:function(e){this.switchPlayer();for(var t=rq.copyImmutableArray(e.data.listMoves),n=this.gameComponent.rules;n.node.gameState.turn<t.length;){var r=n.node.gameState.turn,i=this.gameComponent.encoder.decode(t[r]),o=n.isLegal(i,n.node.gameState),a="We received an incorrect db move: "+i.toString()+" in "+t+" at turn "+r+'because "'+o.getReasonOr("")+'"';vz(o.isSuccess(),a),n.choose(i)}this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get(),this.gameComponent.updateBoard()}},{key:"switchPlayer",value:function(){pz(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");var e=HG.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get();var t=e.getOpponent();this.didUserPlay(t)&&this.pauseCountDownsFor(t),this.didUserPlay(e)?(pz(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(e)):this.startCountDownFor(e)}},{key:"resetChronoFor",value:function(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}},{key:"applyEndGame",value:function(){var e=this.currentPart,t=HG.fromTurn(e.data.turn);this.endGame=!0,[K4.VICTORY,K4.HARD_DRAW].some(function(t){return t.value===e.data.result})?this.doNewMoves(this.currentPart):(vz(!0===[K4.RESIGN,K4.TIMEOUT,K4.HARD_DRAW,K4.AGREED_DRAW_BY_ZERO,K4.AGREED_DRAW_BY_ONE].some(function(t){return t.value===e.data.result}),"Unknown type of end game ("+e.data.result+")"),pz(n.VERBOSE,"endGame est true et winner est "+e.getWinner())),this.stopCountdownsFor(t)}},{key:"notifyDraw",value:function(e,t){this.endGame=!0;var n=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,n,e,[0,0],t,!0)}},{key:"notifyTimeoutVictory",value:function(e,t,n,r){var i=this;return JV(regeneratorRuntime.mark(function o(){var a;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i.endGame=!0,a=i.currentPart.setWinnerAndLoser(e,r),i.currentPart=a,o.next=5,i.gameService.notifyTimeout(i.currentPartId,t,n,e,r);case 5:case"end":return o.stop()}},o)}))()}},{key:"notifyVictory",value:function(e,t){pz(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");var r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);r===bq.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(vz(r===bq.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0;var i=this.getPlayer();return this.gameService.updateDBBoard(this.currentPartId,i,e,[0,0],t,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}},{key:"canAskTakeBack",value:function(){return vz(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.observerRole||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.currentPart.data.request.data.player===this.getPlayer().getOpponent().value||this.getTakeBackRequester()!==HG.NONE)}},{key:"isOpponentWaitingForTakeBackResponse",value:function(){var e=this.getTakeBackRequester();return e!==HG.NONE&&this.isOpponent(e)}},{key:"getTakeBackRequester",value:function(){if(null==this.currentPart)return HG.NONE;var e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?T5.getPlayer(e):HG.NONE}},{key:"canProposeDraw",value:function(){return vz(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&T5.getPlayer(this.currentPart.data.request)===this.getPlayer().getOpponent()||this.isOpponentWaitingForDrawResponse()||this.getDrawRequester()!==HG.NONE)}},{key:"isOpponentWaitingForDrawResponse",value:function(){var e=this.getDrawRequester();return e!==HG.NONE&&this.isOpponent(e)}},{key:"getDrawRequester",value:function(){if(null==this.currentPart)return HG.NONE;var e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?T5.getPlayer(e):HG.NONE}},{key:"onRequest",value:function(e,t){var r=this;return JV(regeneratorRuntime.mark(function i(){var o,a,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=(pz(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:t}),e.code),i.next="TakeBackAsked"===i.t0||"TakeBackRefused"===i.t0?3:"TakeBackAccepted"===i.t0?4:"RematchProposed"===i.t0?6:"RematchAccepted"===i.t0?10:"DrawProposed"===i.t0||"DrawRefused"===i.t0?15:"AddTurnTime"===i.t0?16:"AddGlobalTime"===i.t0?19:22;break;case 3:return i.abrupt("break",25);case 4:return r.takeBackTo(r.currentPart.data.turn),i.abrupt("break",25);case 6:return r.rematchProposed=!0,o=T5.getPlayer(e).getOpponent(),r.isPlayer(o)&&(pz(n.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0),i.abrupt("break",25);case 10:return i.next=12,r.router.navigate(["/nextGameLoading"]);case 12:return i.next=14,r.router.navigate(["/play",T5.getTypeGame(e),T5.getPartId(e)]);case 14:case 15:return i.abrupt("break",25);case 16:return a=HG.of(e.data.player),r.addTurnTimeTo(a,3e4),i.abrupt("break",25);case 19:return s=HG.of(e.data.player),r.addGlobalTimeTo(s,3e5),i.abrupt("break",25);case 22:return dz.expectToBe(e.code,"DrawAccepted","Unknown RequestType : "+e.code+" for "+JSON.stringify(e)),i.next=25,r.acceptDraw();case 25:case"end":return i.stop()}},i)}))()}},{key:"takeBackTo",value:function(e){if(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.rules.node.gameState.turn===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();var t=HG.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}},{key:"setPlayersDatas",value:function(e){var t=this;pz(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),this.players=[kz.of(e.data.playerZero),kz.ofNullable(e.data.playerOne)],vz(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[e.data.turn%2].get();var r=kz.empty();if(this.players[0].equalsValue(this.getPlayerName())?(this.observerRole=HG.ZERO.value,r=this.players[1]):this.players[1].equalsValue(this.getPlayerName())?(this.observerRole=HG.ONE.value,r=this.players[0]):this.observerRole=HG.NONE.value,r.isPresent()){var i=new Z4(function(e){t.opponent=e[0].data},function(e){t.opponent=e[0].data},function(e){throw new Error("OnlineGameWrapper: Opponent was deleted, what sorcery is this: "+JSON.stringify(e))});this.opponentSubscription=kz.of(this.userService.observeUserByUsername(r.get(),i))}}},{key:"onLegalUserMove",value:function(e,t){var r=this;return JV(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(pz(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),r.isOpponentWaitingForTakeBackResponse()){i.next=2;break}return i.abrupt("return",r.updateDBBoard(e,r.msToSubstract,t));case 2:r.gameComponent.message("You must answer to take back request");case 3:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(e,t,r){var i=this;return JV(regeneratorRuntime.mark(function o(){var a,s,u;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(a=i.gameComponent.encoder.encodeMove(e),pz(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+r+")"),i.gameComponent.rules.choose(e),!(s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node)).isEndGame){o.next=5;break}return o.abrupt("return",s===bq.DRAW?i.notifyDraw(a,r):i.notifyVictory(a,r));case 5:return u=i.getPlayer(),o.abrupt("return",i.gameService.updateDBBoard(i.currentPartId,u,a,t,r));case 7:case"end":return o.stop()}},o)}))()}},{key:"resign",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n,r,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getLastIndex(),r=e.getPlayer(),i=e.players[e.observerRole%2].get(),o=e.players[(e.observerRole+1)%2].get(),t.next=3,e.gameService.resign(e.currentPartId,n,r,o,i);case 3:case"end":return t.stop()}},t)}))()}},{key:"getLastIndex",value:function(){return this.currentPart.data.lastUpdate.index}},{key:"reachedOutOfTime",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(pz(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),i=t.getLastIndex(),o=t.getPlayer(),t.stopCountdownsFor(HG.of(e)),a=dz.getNonNullable(t.opponent),e!==t.observerRole){r.next=10;break}return s=dz.getNonNullable(a.username),r.next=8,t.notifyTimeoutVictory(s,o,i,t.getPlayerName());case 8:r.next=19;break;case 10:if(!t.endGame){r.next=14;break}pz(!0,"time might be better handled in the future"),r.next=19;break;case 14:if(!t.opponentIsOffline()){r.next=19;break}return u=dz.getNonNullable(a.username),r.next=18,t.notifyTimeoutVictory(t.getPlayerName(),o,e,u);case 18:t.endGame=!0;case 19:case"end":return r.stop()}},r)}))()}},{key:"acceptRematch",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return vz(e.isPlaying(),"Non playing should not call acceptRematch"),n=new J4(e.currentPartId,e.currentPart.data),t.next=4,e.gameService.acceptRematch(n,e.getLastIndex(),e.getPlayer());case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}},t)}))()}},{key:"proposeRematch",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return vz(e.isPlaying(),"Non playing should not call proposeRematch"),t.next=3,e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.getPlayer());case 3:return t.abrupt("return",!0);case 4:case"end":return t.stop()}},t)}))()}},{key:"proposeDraw",value:function(){return this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"acceptDraw",value:function(){return this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"refuseDraw",value:function(){return this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"askTakeBack",value:function(){return this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"acceptTakeBack",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getPlayer(),t.next=3,e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,n,e.msToSubstract);case 3:e.msToSubstract=[0,0];case 4:case"end":return t.stop()}},t)}))()}},{key:"refuseTakeBack",value:function(){return this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.getPlayer())}},{key:"startCountDownFor",value:function(e){pz(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[e.value]=!0,e===HG.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}},{key:"resumeCountDownFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];pz(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===HG.ZERO?(this.chronoZeroGlobal.changeDuration(dz.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),t=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(dz.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),t=this.chronoOneTurn),r?(t.setDuration(1e3*this.joiner.maximalMoveDuration),t.start()):t.resume()}},{key:"pauseCountDownsFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];pz(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart.data.turn+")"),e===HG.ZERO?(this.chronoZeroGlobal.pause(),t=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),t=this.chronoOneTurn),r?t.stop():t.pause()}},{key:"stopCountdownsFor",value:function(e){pz(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===HG.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}},{key:"getPlayerNameClass",value:function(e){return this.opponentIsOffline()?"has-text-grey-light":0===e?"has-text-white":"has-text-black"}},{key:"opponentIsOffline",value:function(){return null!=this.opponent&&"offline"===this.opponent.state}},{key:"canResign",value:function(){return vz(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}},{key:"addGlobalTime",value:function(){var e=this.getPlayer(),t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}},{key:"addTurnTime",value:function(){var e=this.getPlayer();return this.gameService.addTurnTime(e,this.getLastIndex(),this.currentPartId)}},{key:"addTurnTimeTo",value:function(e,t){var n=HG.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===HG.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}},{key:"addGlobalTimeTo",value:function(e,t){e===HG.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}},{key:"ngOnDestroy",value:function(){null!=this.routerEventsSub&&null!=this.routerEventsSub.unsubscribe&&this.routerEventsSub.unsubscribe(),null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.isPresent()&&this.opponentSubscription.get()(),this.gameService.stopObserving())}}]),n}(F5)).VERBOSE=!1,g8.\u0275fac=function(e){return new(e||g8)(Vp.Lb(Vp.j),Vp.Lb(mk),Vp.Lb(VC),Vp.Lb(Y4),Vp.Lb(jz),Vp.Lb(K5))},g8.\u0275cmp=Vp.Fb({type:g8,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){var n;1&e&&(Vp.Hc(O6,1),Vp.Hc(S6,1),Vp.Hc(P6,1),Vp.Hc(I6,1),Vp.Hc(T6,1),Vp.Hc(A6,1)),2&e&&(Vp.uc(n=Vp.dc())&&(t.partCreation=n.first),Vp.uc(n=Vp.dc())&&(t.chatComponent=n.first),Vp.uc(n=Vp.dc())&&(t.chronoZeroGlobal=n.first),Vp.uc(n=Vp.dc())&&(t.chronoOneGlobal=n.first),Vp.uc(n=Vp.dc())&&(t.chronoZeroTurn=n.first),Vp.uc(n=Vp.dc())&&(t.chronoOneTurn=n.first))},features:[Vp.yb],decls:5,vars:4,consts:function(){return[["id","partCreation",3,"partId","userName","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","userName","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],$localize(Uf||(Uf=xp(["vs."]))),["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Vf||(Vf=xp(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],$localize(zf||(zf=xp(["It is your turn."]))),$localize(Hf||(Hf=xp(["It is ",":INTERPOLATION:'s turn."])),"\ufffd0\ufffd"),["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],$localize(Gf||(Gf=xp(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],$localize(qf||(qf=xp(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Wf||(Wf=xp(["Resign"]))),["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize($f||($f=xp(["Propose a draw"]))),["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Zf||(Zf=xp(["Accept draw"]))),["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Qf||(Qf=xp(["Reject draw"]))),["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Yf||(Yf=xp(["Pass a turn"]))),["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Kf||(Kf=xp(["Accept take back"]))),["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(Jf||(Jf=xp(["Reject take back"]))),["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],$localize(Xf||(Xf=xp(["Ask to take back one move"]))),["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$localize(ed||(ed=xp(["Draw"]))),["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],$localize(td||(td=xp(["You agreed to draw."]))),["id","yourOpponentAgreedToDrawIndicator",1,"title"],$localize(nd||(nd=xp(["Your draw proposal has been accepted."]))),["id","playersAgreedToDraw",1,"title"],$localize(rd||(rd=xp(["Players agreed to draw."]))),["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],$localize(id||(id=xp(["You won."]))),[1,"title"],$localize(od||(od=xp(["You lost."]))),$localize(ad||(ad=xp(["",":INTERPOLATION: won."])),"\ufffd0\ufffd"),$localize(sd||(sd=xp(["",":INTERPOLATION: has reached their time limit. You won."])),"\ufffd0\ufffd"),$localize(ud||(ud=xp(["You reached your time limit."]))),$localize(cd||(cd=xp(["",":INTERPOLATION: has reached their time limit."])),"\ufffd0\ufffd"),["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],$localize(ld||(ld=xp(["You resigned."]))),$localize(hd||(hd=xp(["",":INTERPOLATION: has resigned."])),"\ufffd0\ufffd"),["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],$localize(fd||(fd=xp(["Go back to the game list"]))),["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(dd||(dd=xp(["Propose to play again"]))),["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],$localize(pd||(pd=xp(["Accept to play again"])))]},template:function(e,t){1&e&&(Vp.Ac(0,N6,2,2,"app-part-creation",0),Vp.Ac(1,v8,29,27,"div",1),Vp.Qb(2,"div",2),Vp.Qb(3,"div",3),Vp.Mb(4,"app-chat",4),Vp.Pb(),Vp.Pb()),2&e&&(Vp.mc("ngIf",!1===t.gameStarted),Vp.Bb(1),Vp.mc("ngIf",t.gameStarted),Vp.Bb(3),Vp.mc("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[yg,g5,w6,E6,dg,L5,zC],encapsulation:2}),g8);function b8(e,t){if(1&e&&(Vp.Qb(0,"option",25),Vp.Cc(1),Vp.Pb()),2&e){var n=t.$implicit;Vp.mc("value",n.name),Vp.Bb(1),Vp.Dc(n.name)}}function _8(e,t){if(1&e&&(Vp.Qb(0,"option",25),Vp.Ub(1,29),Vp.Pb()),2&e){var n=t.$implicit;Vp.mc("value",n),Vp.Bb(1),Vp.Xb(n),Vp.Vb(1)}}var w8=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function k8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"select",26),Vp.cc("ngModelChange",function(e){return Vp.wc(n),Vp.fc(2).aiDepths[0]=e})("change",function(){return Vp.wc(n),Vp.fc(2).updatePlayer(0)}),Vp.Qb(1,"option",27),Vp.Ub(2,28),Vp.Pb(),Vp.Ac(3,_8,2,2,"option",16),Vp.Pb()}if(2&e){var r=Vp.fc(2);Vp.mc("ngModel",r.aiDepths[0]),Vp.Bb(3),Vp.mc("ngForOf",Vp.qc(2,w8))}}function C8(e,t){if(1&e&&(Vp.Qb(0,"p",30),Vp.Ub(1,31),Vp.Pb()),2&e){var n=Vp.fc(2);Vp.Bb(1),Vp.Xb(n.gameComponent.scores.get()[0]),Vp.Vb(1)}}function E8(e,t){if(1&e&&(Vp.Qb(0,"option",25),Vp.Cc(1),Vp.Pb()),2&e){var n=t.$implicit;Vp.mc("value",n.name),Vp.Bb(1),Vp.Dc(n.name)}}function O8(e,t){if(1&e&&(Vp.Qb(0,"option",25),Vp.Ub(1,34),Vp.Pb()),2&e){var n=t.$implicit;Vp.mc("value",n),Vp.Bb(1),Vp.Xb(n),Vp.Vb(1)}}function S8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"select",32),Vp.cc("ngModelChange",function(e){return Vp.wc(n),Vp.fc(2).aiDepths[1]=e})("change",function(){return Vp.wc(n),Vp.fc(2).updatePlayer(1)}),Vp.Qb(1,"option",27),Vp.Ub(2,33),Vp.Pb(),Vp.Ac(3,O8,2,2,"option",16),Vp.Pb()}if(2&e){var r=Vp.fc(2);Vp.mc("ngModel",r.aiDepths[1]),Vp.Bb(3),Vp.mc("ngForOf",Vp.qc(2,w8))}}function P8(e,t){if(1&e&&(Vp.Qb(0,"p",35),Vp.Ub(1,36),Vp.Pb()),2&e){var n=Vp.fc(2);Vp.Bb(1),Vp.Xb(n.gameComponent.scores.get()[1]),Vp.Vb(1)}}function I8(e,t){if(1&e&&(Vp.Qb(0,"h4"),Vp.Ub(1,40),Vp.Pb()),2&e){var n=Vp.fc(3);Vp.Bb(1),Vp.Xb(n.winner.get()),Vp.Vb(1)}}function T8(e,t){1&e&&(Vp.Qb(0,"h4",41),Vp.Ub(1,42),Vp.Pb())}function A8(e,t){if(1&e&&(Vp.Qb(0,"div",37),Vp.Ac(1,I8,2,1,"h4",38),Vp.Ac(2,T8,2,0,"h4",39),Vp.Pb()),2&e){var n=Vp.fc(2);Vp.Bb(1),Vp.mc("ngIf",n.winner.isPresent()),Vp.Bb(1),Vp.mc("ngIf",n.winner.isAbsent())}}function N8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"div",6),Vp.Qb(1,"div",7),Vp.Qb(2,"p",8),Vp.Ub(3,9),Vp.Pb(),Vp.Pb(),Vp.Qb(4,"div",10),Vp.Qb(5,"div",11),Vp.Qb(6,"div",12),Vp.Qb(7,"select",13),Vp.cc("change",function(){return Vp.wc(n),Vp.fc().updatePlayer(0)})("ngModelChange",function(e){return Vp.wc(n),Vp.fc().playerSelection[0]=e}),Vp.Qb(8,"option",14),Vp.Ub(9,15),Vp.Pb(),Vp.Ac(10,b8,2,2,"option",16),Vp.Pb(),Vp.Pb(),Vp.Qb(11,"div",12),Vp.Ac(12,k8,4,3,"select",17),Vp.Pb(),Vp.Ac(13,C8,2,1,"p",18),Vp.Pb(),Vp.Qb(14,"div",19),Vp.Qb(15,"div",12),Vp.Qb(16,"select",20),Vp.cc("change",function(){return Vp.wc(n),Vp.fc().updatePlayer(1)})("ngModelChange",function(e){return Vp.wc(n),Vp.fc().playerSelection[1]=e}),Vp.Qb(17,"option",14),Vp.Ub(18,21),Vp.Pb(),Vp.Ac(19,E8,2,2,"option",16),Vp.Pb(),Vp.Pb(),Vp.Qb(20,"div",12),Vp.Ac(21,S8,4,3,"select",22),Vp.Pb(),Vp.Ac(22,P8,2,1,"p",23),Vp.Pb(),Vp.Pb(),Vp.Ac(23,A8,3,2,"div",24),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.Bb(3),Vp.Xb(r.gameComponent.rules.node.gameState.turn+1),Vp.Vb(3),Vp.Bb(4),Vp.mc("ngModel",r.playerSelection[0]),Vp.Bb(3),Vp.mc("ngForOf",r.gameComponent.availableMinimaxes),Vp.Bb(2),Vp.mc("ngIf",!1===r.players[0].equalsValue("human")),Vp.Bb(1),Vp.mc("ngIf",r.gameComponent.scores.isPresent()),Vp.Bb(3),Vp.mc("ngModel",r.playerSelection[1]),Vp.Bb(3),Vp.mc("ngForOf",r.gameComponent.availableMinimaxes),Vp.Bb(2),Vp.mc("ngIf",!1===r.players[1].equalsValue("human")),Vp.Bb(1),Vp.mc("ngIf",r.gameComponent.scores.isPresent()),Vp.Bb(1),Vp.mc("ngIf",r.endGame)}}function x8(e,t){if(1&e&&(Vp.Ob(0),Vp.Cc(1),Vp.Mb(2,"br"),Vp.Nb()),2&e){var n=t.$implicit,r=Vp.fc(3);Vp.Bb(1),Vp.Ec(" ",n.name+": "+n.getBoardValue(r.gameComponent.rules.node)," ")}}function R8(e,t){if(1&e&&(Vp.Ob(0),Vp.Ac(1,x8,3,1,"ng-container",48),Vp.Cc(2),Vp.Mb(3,"br"),Vp.Cc(4),Vp.Mb(5,"br"),Vp.Nb()),2&e){var n=Vp.fc(2);Vp.Bb(1),Vp.mc("ngForOf",n.gameComponent.availableMinimaxes),Vp.Bb(1),Vp.Ec(" Created ",n.getCreatedNodes()," nodes."),Vp.Bb(2),Vp.Ec(" Minimax time: ",n.getMinimaxTime(),"ms.")}}function M8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",49),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).gameComponent.pass()}),Vp.Ub(1,50),Vp.Pb()}}function D8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",51),Vp.cc("click",function(){return Vp.wc(n),Vp.fc(2).takeBack()}),Vp.Ub(1,52),Vp.Pb()}}function L8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"div",43),Vp.Ac(1,R8,6,3,"ng-container",38),Vp.Ac(2,M8,2,0,"button",44),Vp.Ac(3,D8,2,0,"button",45),Vp.Qb(4,"button",46),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().restartGame()}),Vp.Ub(5,47),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",r.gameComponent.rules.node.move),Vp.Bb(1),Vp.mc("ngIf",!1===r.endGame&&r.gameComponent.canPass),Vp.Bb(1),Vp.mc("ngIf",r.canTakeBack())}}var B8,F8=((B8=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a){var s;return Qp(this,n),(s=t.call(this,e,r,i)).cdr=o,s.messageDisplayer=a,s.aiDepths=["0","0"],s.playerSelection=["human","human"],s.winner=kz.empty(),s.botTimeOut=1e3,s.players=[kz.of(s.playerSelection[0]),kz.of(s.playerSelection[1])],pz(n.VERBOSE,"LocalGameWrapper.constructor"),s}return Kp(n,[{key:"getCreatedNodes",value:function(){return yq.createdNodes}},{key:"getMinimaxTime",value:function(){return yq.minimaxTime}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(function(){e.afterGameIncluderViewInit(),e.restartGame(),e.cdr.detectChanges()},1)}},{key:"updatePlayer",value:function(e){this.players[e]=kz.of(this.playerSelection[e]),this.proposeAIToPlay()}},{key:"onLegalUserMove",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:pz(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),t.gameComponent.rules.choose(e),t.updateBoard(),t.proposeAIToPlay();case 1:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.gameComponent.updateBoard();var e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner!==HG.NONE&&(this.winner=kz.of($localize(vd||(vd=xp(["Player ",""])),e.winner.value+1))))}},{key:"proposeAIToPlay",value:function(){var e=this,t=this.getPlayingAI();t.isPresent()&&setTimeout(JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.doAIMove(t.get());case 2:case"end":return n.stop()}},n)})),this.botTimeOut)}},{key:"getPlayingAI",value:function(){var e=this;if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return kz.empty();var t=this.gameComponent.rules.node.gameState.turn%2;return"0"===this.aiDepths[t]?kz.empty():kz.ofNullable(this.gameComponent.availableMinimaxes.find(function(n){return e.players[t].equalsValue(n.name)}))}},{key:"doAIMove",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return vz((r=t.gameComponent.rules).getGameStatus(r.node)===bq.ONGOING,"IA should not try to play when game is over!"),i=Number.parseInt(t.aiDepths[r.node.gameState.turn%2%2]),o=r.node.findBestMove(i,e,!0),n.abrupt("return",r.choose(o)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),lz.SUCCESS):(t.messageDisplayer.criticalMessage($localize(gd||(gd=xp(["The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!"])))),fz.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:o.toString()})));case 4:case"end":return n.stop()}},n)}))()}},{key:"canTakeBack",value:function(){return this.gameComponent.rules.node.gameState.turn>0}},{key:"takeBack",value:function(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}},{key:"isAITurn",value:function(){return this.getPlayingAI().isPresent()}},{key:"restartGame",value:function(){var e=this.gameComponent.rules.stateType.getInitialState();this.gameComponent.rules.node=new mq(e),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=kz.empty(),this.proposeAIToPlay()}},{key:"getPlayerName",value:function(){return"human"}}]),n}(F5)).VERBOSE=!1,B8.\u0275fac=function(e){return new(e||B8)(Vp.Lb(Vp.j),Vp.Lb(mk),Vp.Lb(jz),Vp.Lb(Vp.h),Vp.Lb(qG))},B8.\u0275cmp=Vp.Fb({type:B8,selectors:[["app-local-game-wrapper"]],features:[Vp.yb],decls:7,vars:3,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(yd||(yd=xp(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],$localize(md||(md=xp(["Human"]))),[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],$localize(bd||(bd=xp(["Human"]))),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],$localize(_d||(_d=xp(["Pick the level"]))),$localize(wd||(wd=xp(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreOne",1,"block"],$localize(kd||(kd=xp(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],$localize(Cd||(Cd=xp(["Pick the level"]))),$localize(Ed||(Ed=xp(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreZero",1,"block"],$localize(Od||(Od=xp(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],$localize(Sd||(Sd=xp(["",":INTERPOLATION: won"])),"\ufffd0\ufffd"),["id","draw"],$localize(Pd||(Pd=xp(["Draw"]))),[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],$localize(Id||(Id=xp(["Start a new game"]))),[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],$localize(Td||(Td=xp(["Pass a turn"]))),["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Ad||(Ad=xp(["Take back move"])))]},template:function(e,t){1&e&&(Vp.Qb(0,"div",0),Vp.Qb(1,"div",1),Vp.Ac(2,N8,24,10,"div",2),Vp.Ac(3,L8,6,3,"div",3),Vp.Pb(),Vp.Qb(4,"div",4),Vp.Qb(5,"div",5),Vp.Mb(6,"app-game-includer"),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e&&(Vp.Bb(2),Vp.mc("ngIf",t.gameComponent),Vp.Bb(1),Vp.mc("ngIf",t.gameComponent),Vp.Bb(1),Vp.mc("ngClass",t.getBoardHighlight()))},directives:[yg,dg,L5,nb,sm,zm,rb,vb,vg],encapsulation:2,changeDetection:0}),B8),j8=function(){var e=function e(){Qp(this,e)};return e.STEP_FINISHED=function(){return $localize(Nd||(Nd=xp(["Step finished!"])))},e.INFORMATIONAL_STEP=function(){return $localize(xd||(xd=xp(["This step is not expecting any move from your part."])))},e}();function U8(e,t){if(1&e&&(Vp.Qb(0,"div",20),Vp.Qb(1,"div",21),Vp.Ub(2,22),Vp.Pb(),Vp.Qb(3,"div",23),Vp.Cc(4),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(4),Vp.Dc(n.currentReason.get())}}function V8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",24),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().retry()}),Vp.Ub(1,25),Vp.Pb()}}function z8(e,t){1&e&&(Vp.Ob(0),Vp.Ub(1,30),Vp.Nb())}function H8(e,t){1&e&&(Vp.Ob(0),Vp.Ub(1,31),Vp.Nb())}function G8(e,t){if(1&e&&Vp.Ac(0,H8,2,0,"ng-container",27),2&e){Vp.fc();var n=Vp.vc(5),r=Vp.fc();Vp.mc("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",n)}}function q8(e,t){1&e&&(Vp.Ob(0),Vp.Ub(1,32),Vp.Nb())}function W8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",26),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().next()}),Vp.Ac(1,z8,2,0,"ng-container",27),Vp.Ac(2,G8,1,2,"ng-template",null,28,Vp.Bc),Vp.Ac(4,q8,2,0,"ng-template",null,29,Vp.Bc),Vp.Pb()}if(2&e){var r=Vp.vc(3),i=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",i.steps[i.stepIndex]&&i.steps[i.stepIndex].isInformation())("ngIfElse",r)}}function $8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",33),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().start()}),Vp.Ub(1,34),Vp.Pb()}}function Z8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",35),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().playLocally()}),Vp.Ub(1,36),Vp.Pb()}}function Q8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",37),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().createGame()}),Vp.Ub(1,38),Vp.Pb()}}function Y8(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"button",39),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().showSolution()}),Vp.Ub(1,40),Vp.Pb()}}function K8(e,t){if(1&e&&(Vp.Ob(0),Vp.Qb(1,"option",42),Vp.Cc(2),Vp.Pb(),Vp.Nb()),2&e){var n=Vp.fc(),r=n.index,i=n.$implicit;Vp.Bb(1),Vp.nc("id","step_",r,""),Vp.mc("value",r),Vp.Bb(1),Vp.Dc(i.title)}}function J8(e,t){1&e&&(Vp.Ob(0),Vp.Cc(1,"v "),Vp.Nb())}function X8(e,t){1&e&&Vp.Cc(0,"x ")}function e7(e,t){if(1&e&&(Vp.Qb(0,"option",43),Vp.Ac(1,J8,2,0,"ng-container",27),Vp.Ac(2,X8,1,0,"ng-template",null,44,Vp.Bc),Vp.Qb(4,"span",45),Vp.Cc(5),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.vc(3),r=Vp.fc(),i=r.index,o=r.$implicit,a=Vp.fc();Vp.mc("value",i),Vp.Bb(1),Vp.mc("ngIf",a.stepFinished[i])("ngIfElse",n),Vp.Bb(3),Vp.nc("id","step_",i,""),Vp.Bb(1),Vp.Dc(o.title)}}function t7(e,t){if(1&e&&(Vp.Ob(0),Vp.Ac(1,K8,3,3,"ng-container",27),Vp.Ac(2,e7,6,5,"ng-template",null,41,Vp.Bc),Vp.Nb()),2&e){var n=t.index,r=Vp.vc(3),i=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",n===i.stepIndex)("ngIfElse",r)}}var n7,r7=((n7=function(e){Jp(n,e);var t=ev(n);function n(e,r,i,o,a){var s;return Qp(this,n),(s=t.call(this,e,r,o)).router=i,s.cdr=a,s.COMPLETED_TUTORIAL_MESSAGE=$localize(Rd||(Rd=xp(["Congratulations, you completed the tutorial."]))),s.steps=[],s.successfulSteps=0,s.stepIndex=-1,s.currentMessage="",s.currentReason=kz.empty(),s.moveAttemptMade=!1,s.stepFinished=[],s.tutorialOver=!1,pz(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),s}return Kp(n,[{key:"getNumberOfSteps",value:function(){return this.steps.length}},{key:"getCurrentStepTitle",value:function(){return this.steps.length>0?this.steps[this.stepIndex].title:""}},{key:"ngAfterViewInit",value:function(){pz(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),this.afterGameIncluderViewInit(),this.start()}},{key:"start",value:function(){this.startTutorial(this.gameComponent.tutorial)}},{key:"startTutorial",value:function(e){pz(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}},{key:"getCompletionArray",value:function(){return this.steps.map(function(){return!1})}},{key:"changeStep",value:function(e){this.showStep(Number.parseInt(e.target.value,10))}},{key:"showStep",value:function(e){pz(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;var t=this.steps[this.stepIndex];this.currentMessage=t.instruction,this.currentReason=kz.empty(),this.gameComponent.rules.node=new mq(t.state,kz.empty(),t.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}},{key:"onLegalUserMove",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function r(){var i,o,a,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:pz(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}}),i=t.steps[t.stepIndex],vz(t.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),pz(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,i.isPredicate()?(o=t.gameComponent.rules.node.gameState,(a=dz.getNonNullable(i.predicate)(e,o)).isSuccess()?t.showStepSuccess(i.getSuccessMessage()):t.currentReason=kz.of(a.getReason())):i.isAnyMove()?(pz(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(i.getSuccessMessage())):(vz(i.isMove(),"cannot reach here with a click step"),(s=i).acceptedMoves.some(function(t){return t.equals(e)})?(pz(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(pz(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),t.currentReason=kz.of(s.getFailureMessage()))),t.cdr.detectChanges();case 4:case"end":return r.stop()}},r)}))()}},{key:"retry",value:function(){pz(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}},{key:"onUserClick",value:function(e){var t=this;if(pz(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=kz.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return lz.failure(j8.STEP_FINISHED());var r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),dz.getNonNullable(r.acceptedClicks).some(function(t){return t===e})?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),lz.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(setTimeout(function(){t.cdr.detectChanges()},10),lz.SUCCESS):lz.failure(j8.INFORMATIONAL_STEP())}},{key:"onCancelMove",value:function(e){pz(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=kz.of(e)),this.cdr.detectChanges()}},{key:"showStepSuccess",value:function(e){pz(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}},{key:"updateSuccessCount",value:function(){var e,t=0,n=zp(this.stepFinished);try{for(n.s();!(e=n.n()).done;)e.value&&t++}catch(r){n.e(r)}finally{n.f()}this.successfulSteps=t}},{key:"next",value:function(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{for(var e=(this.stepIndex+1)%this.steps.length;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}},{key:"showSolution",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var r,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:pz(n.VERBOSE,"tutorialGameWrapper.showSolution()"),vz((r=e.steps[e.stepIndex]).hasSolution(),"showSolution called on a step with no solution, this should not be reachable"),o=(i=r).getSolution(),e.showStep(e.stepIndex),e.gameComponent.rules.choose(o),e.gameComponent.updateBoard(),e.moveAttemptMade=!0,e.currentMessage=i.getSuccessMessage(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)}))()}},{key:"playLocally",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=dz.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/local",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"createGame",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=dz.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/play",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"getPlayerName",value:function(){return""}}]),n}(F5)).VERBOSE=!1,n7.\u0275fac=function(e){return new(e||n7)(Vp.Lb(Vp.j),Vp.Lb(mk),Vp.Lb(VC),Vp.Lb(jz),Vp.Lb(Vp.h))},n7.\u0275cmp=Vp.Fb({type:n7,selectors:[["app-tutorial-game-wrapper"]],features:[Vp.yb],decls:22,vars:15,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(Md||(Md=xp(["Failure"]))),["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],$localize(Dd||(Dd=xp(["Try again"]))),["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],$localize(Ld||(Ld=xp(["Ok"]))),$localize(Bd||(Bd=xp(["Continue"]))),$localize(Fd||(Fd=xp(["Skip"]))),["id","restartButton",1,"button",3,"click"],$localize(jd||(jd=xp(["Try again"]))),["id","playLocallyButton",1,"button",3,"click"],$localize(Ud||(Ud=xp(["Play locally"]))),["id","playOnlineButton",1,"button",3,"click"],$localize(Vd||(Vd=xp(["Create an online game"]))),["id","showSolutionButton",1,"button",3,"click"],$localize(zd||(zd=xp(["See solution"]))),["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(Vp.Qb(0,"div",0),Vp.Qb(1,"div",1),Vp.Qb(2,"div",2),Vp.Mb(3,"progress",3),Vp.Qb(4,"div",4),Vp.Qb(5,"p",5),Vp.Cc(6),Vp.Pb(),Vp.Mb(7,"p",6),Vp.Pb(),Vp.Ac(8,U8,5,1,"div",7),Vp.Qb(9,"div",8),Vp.Ac(10,V8,2,0,"button",9),Vp.Ac(11,W8,6,2,"button",10),Vp.Ac(12,$8,2,0,"button",11),Vp.Ac(13,Z8,2,0,"button",12),Vp.Ac(14,Q8,2,0,"button",13),Vp.Ac(15,Y8,2,0,"button",14),Vp.Qb(16,"div",15),Vp.Qb(17,"select",16),Vp.cc("change",function(e){return t.changeStep(e)}),Vp.Ac(18,t7,4,2,"ng-container",17),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(19,"div",18),Vp.Qb(20,"div",19),Vp.Mb(21,"app-game-includer"),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e&&(Vp.Bb(3),Vp.Cb("value",t.successfulSteps)("max",t.getNumberOfSteps()),Vp.Bb(3),Vp.Gc("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),Vp.Bb(1),Vp.mc("innerHTML",t.currentMessage,Vp.xc),Vp.Bb(1),Vp.mc("ngIf",t.currentReason.isPresent()),Vp.Bb(2),Vp.mc("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),Vp.Bb(1),Vp.mc("ngIf",!1===t.tutorialOver),Vp.Bb(1),Vp.mc("ngIf",t.tutorialOver),Vp.Bb(1),Vp.mc("ngIf",t.tutorialOver),Vp.Bb(1),Vp.mc("ngIf",t.tutorialOver),Vp.Bb(1),Vp.mc("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),Vp.Bb(3),Vp.mc("ngForOf",t.steps),Vp.Bb(1),Vp.mc("ngClass",t.getBoardHighlight()))},directives:[yg,vg,dg,L5,rb,vb],encapsulation:2,changeDetection:0}),n7);function i7(e,t){if(1&e&&(Vp.Qb(0,"div",35),Vp.Qb(1,"div",36),Vp.Ub(2,37),Vp.Pb(),Vp.Qb(3,"div",38),Vp.Cc(4),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(4),Vp.Dc(n.errorMessage)}}var o7,a7,s7,u7,c7=function(){return["/login"]},l7=((u7=function(){function e(t,n){Qp(this,e),this.authService=t,this.router=n,this.faEye=Tz,this.registrationForm=new Dm({email:new Mm,username:new Mm,password:new Mm})}return Kp(e,[{key:"registerWithEmail",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n,r,i,o,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.registrationForm.value.username,r=e.registrationForm.value.email,i=e.registrationForm.value.password,null!=n&&null!=r&&null!=i){t.next=5;break}e.errorMessage=$localize(Hd||(Hd=xp(["There are missing fields in the registration form, please check that you filled in all fields."]))),t.next=21;break;case 5:return t.next=7,e.authService.doRegister(n,r,i);case 7:if(!(o=t.sent).isSuccess()){t.next=20;break}return t.next=11,e.authService.sendEmailVerification();case 11:if(!(a=t.sent).isSuccess()){t.next=17;break}return t.next=15,e.router.navigate(["/verify-account"]);case 15:t.next=18;break;case 17:e.errorMessage=a.getReason();case 18:t.next=21;break;case 20:e.errorMessage=o.getReason();case 21:case"end":return t.stop()}},t)}))()}},{key:"registerWithGoogle",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.doGoogleLogin();case 2:if(!(n=t.sent).isSuccess()){t.next=8;break}return t.next=6,e.router.navigate(["/verify-account"]);case 6:t.next=9;break;case 8:e.errorMessage=n.getReason();case 9:case"end":return t.stop()}},t)}))()}},{key:"getPasswordHelpClass",value:function(){var e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}},{key:"canRegister",value:function(){var e=this.registrationForm.value.password||"";return!(""===(this.registrationForm.value.email||"")||""===(this.registrationForm.value.username||"")||""===e||e.length<6)}}]),e}()).\u0275fac=function(e){return new(e||u7)(Vp.Lb(jz),Vp.Lb(VC))},u7.\u0275cmp=Vp.Fb({type:u7,selectors:[["app-register"]],decls:56,vars:7,consts:function(){return[[1,"box"],[1,"title"],$localize(Gd||(Gd=xp(["Registering"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(qd||(qd=xp(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",$localize(Wd||(Wd=xp(["Email"]))),"type","email","autofocus","","required","",1,"input"],[1,"help"],$localize($d||($d=xp(["A confirmation email will be sent to validate your account."]))),["for","username",1,"label"],$localize(Zd||(Zd=xp(["Username"]))),["id","username","formControlName","username","name","username","placeholder",$localize(Qd||(Qd=xp(["Username"]))),"type","text","required","",1,"input"],["for","password",1,"label"],$localize(Yd||(Yd=xp(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",$localize(Kd||(Kd=xp(["Password"]))),"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],$localize(Jd||(Jd=xp(["The password should be at least 6 characters long"]))),["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Xd||(Xd=xp(["Register"]))),[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(ep||(ep=xp(["Register with Google"]))),[1,"help","level-right"],$localize(tp||(tp=xp(["Have an account?"]))),[3,"routerLink"],$localize(np||(np=xp(["Log in"]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(rp||(rp=xp(["Registration error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(Vp.Qb(0,"div",0),Vp.Qb(1,"p",1),Vp.Ub(2,2),Vp.Pb(),Vp.Qb(3,"form",3),Vp.Qb(4,"div",4),Vp.Qb(5,"div",5),Vp.Qb(6,"label",6),Vp.Ub(7,7),Vp.Pb(),Vp.Pb(),Vp.Qb(8,"div",8),Vp.Qb(9,"div",9),Vp.Qb(10,"div",10),Vp.Mb(11,"input",11),Vp.Qb(12,"p",12),Vp.Ub(13,13),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(14,"div",4),Vp.Qb(15,"div",5),Vp.Qb(16,"label",14),Vp.Ub(17,15),Vp.Pb(),Vp.Pb(),Vp.Qb(18,"div",8),Vp.Qb(19,"div",9),Vp.Qb(20,"div",10),Vp.Mb(21,"input",16),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(22,"div",4),Vp.Qb(23,"div",5),Vp.Qb(24,"label",17),Vp.Ub(25,18),Vp.Pb(),Vp.Pb(),Vp.Qb(26,"div",8),Vp.Qb(27,"div",9),Vp.Qb(28,"div",19),Vp.Mb(29,"input",20),Vp.Qb(30,"span",21),Vp.Mb(31,"fa-icon",22),Vp.Pb(),Vp.Qb(32,"p",23),Vp.Ub(33,24),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(34,"div",4),Vp.Mb(35,"div",5),Vp.Qb(36,"div",8),Vp.Qb(37,"div",9),Vp.Qb(38,"div",10),Vp.Qb(39,"button",25),Vp.cc("click",function(){return t.registerWithEmail()}),Vp.Ub(40,26),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(41,"div",4),Vp.Mb(42,"div",5),Vp.Qb(43,"div",27),Vp.Ac(44,i7,5,1,"div",28),Vp.Pb(),Vp.Pb(),Vp.Qb(45,"div",4),Vp.Mb(46,"div",5),Vp.Qb(47,"div",8),Vp.Qb(48,"button",29),Vp.cc("click",function(){return t.registerWithGoogle()}),Vp.Ub(49,30),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(50,"p",31),Vp.Ob(51),Vp.Ub(52,32),Vp.Nb(),Vp.Cc(53,"\xa0 "),Vp.Qb(54,"a",33),Vp.Ub(55,34),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e&&(Vp.Bb(3),Vp.mc("formGroup",t.registrationForm),Vp.Bb(28),Vp.mc("icon",t.faEye),Vp.Bb(1),Vp.mc("ngClass",t.getPasswordHelpClass()),Vp.Bb(7),Vp.mc("disabled",!t.canRegister()),Vp.Bb(5),Vp.mc("ngIf",t.errorMessage),Vp.Bb(10),Vp.mc("routerLink",Vp.qc(6,c7)))},directives:[Hm,um,Qm,Ay,sm,Km,M4,yb,uG,D4,dg,yg,HC],encapsulation:2}),u7),h7=((s7=function(){function e(t){Qp(this,e),this.router=t}return Kp(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"playLocally",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["local/"+e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}()).\u0275fac=function(e){return new(e||s7)(Vp.Lb(VC))},s7.\u0275cmp=Vp.Fb({type:s7,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(ip||(ip=xp(["Play offline"])))]},template:function(e,t){1&e&&(Vp.Qb(0,"app-pick-game",0),Vp.cc("pickGame",function(e){return t.pickGame(e)}),Vp.Pb(),Vp.Qb(1,"button",1),Vp.cc("click",function(){return t.playLocally()}),Vp.Ub(2,2),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("disabled",!t.selectedGame))},directives:[S4],encapsulation:2}),s7),f7=((a7=function(){function e(t){Qp(this,e),this.router=t}return Kp(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"launchTutorial",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/tutorial/",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}()).\u0275fac=function(e){return new(e||a7)(Vp.Lb(VC))},a7.\u0275cmp=Vp.Fb({type:a7,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(op||(op=xp(["Learn the rules"])))]},template:function(e,t){1&e&&(Vp.Qb(0,"app-pick-game",0),Vp.cc("pickGame",function(e){return t.pickGame(e)}),Vp.Pb(),Vp.Qb(1,"button",1),Vp.cc("click",function(){return t.launchTutorial()}),Vp.Ub(2,2),Vp.Pb()),2&e&&(Vp.Bb(1),Vp.mc("disabled",!t.selectedGame))},directives:[S4],encapsulation:2}),a7),d7=((o7=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||o7)},o7.\u0275cmp=Vp.Fb({type:o7,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){return[$localize(ap||(ap=xp(["The replay game is loading, please wait, it should not take long."])))]},template:function(e,t){1&e&&(Vp.Qb(0,"p"),Vp.Ub(1,0),Vp.Pb())},encapsulation:2}),o7),p7={apiKey:"AIzaSyAt5QHXLnm2Uf9X7VN6XPPiSaipoh3oRHo",authDomain:"firestore-c9d47.firebaseapp.com",databaseURL:"https://firestore-c9d47.firebaseio.com",projectId:"firestore-c9d47",storageBucket:"firestore-c9d47.appspot.com",messagingSenderId:"936588361631"};jp("w1tV"),new Vp.r("angularfire2.realtimeDatabaseURL");var v7,g7=new Vp.r("angularfire2.database.use-emulator"),y7=new Vp.r("angularfire2.functions.origin"),m7=new Vp.r("angularfire2.functions.region"),b7=new Vp.r("angularfire2.functions.new-origin-behavior"),_7=new Vp.r("angularfire2.functions.use-emulator"),w7=((v7=function e(t,n,r,i,o,a,s){Qp(this,e);var u=new US.d(r),c=s,l=Object(Eb.a)(void 0).pipe(Object($S.b)(u.outsideAngular),B_(function(){return jp.e(6).then(jp.bind(null,"iTTW"))}),Object(ky.a)(function(){return Object(US.g)(t,r,n)}),Object(ky.a)(function(e){return Object(US.f)("".concat(e.name,".functions.").concat(i||o),"AngularFireFunctions",e,function(){var t,n;if(a){if(i&&o)throw new Error("REGION and ORIGIN can't be used at the same time.");n=e.functions(i||o||void 0)}else n=e.functions(i||void 0);return a||c||!o||n.useFunctionsEmulator(o),c&&(t=n).useEmulator.apply(t,Up(c)),n},[i,o,c])}),kV({bufferSize:1,refCount:!1}));return this.httpsCallable=function(e,t){return function(n){return Object(by.a)(l).pipe(Object($S.b)(u.insideAngular),B_(function(r){return r.httpsCallable(e,t)(n)}),Object(ky.a)(function(e){return e.data}))}},Object(US.i)(this,l,r)}).\u0275fac=function(e){return new(e||v7)(Vp.Zb(US.c),Vp.Zb(US.b,8),Vp.Zb(Vp.A),Vp.Zb(m7,8),Vp.Zb(y7,8),Vp.Zb(b7,8),Vp.Zb(_7,8))},v7.\u0275prov=Vp.Hb({factory:function(){return new v7(Vp.Zb(US.c),Vp.Zb(US.b,8),Vp.Zb(Vp.A),Vp.Zb(m7,8),Vp.Zb(y7,8),Vp.Zb(b7,8),Vp.Zb(_7,8))},token:v7,providedIn:"any"}),v7);Object(US.e)(w7,[{useEmulator:null,useFunctionsEmulator:null,httpsCallable:null}]);var k7,C7,E7=((C7=function(){function e(t){Qp(this,e),this.authService=t}return Kp(e,[{key:"canActivate",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){var n;e.userSub=e.authService.getUserObs().subscribe((n=JV(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.evaluateUserPermission(r).then(t);case 2:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}))}));case 1:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||C7)(Vp.Zb(jz))},C7.\u0275prov=Vp.Hb({token:C7,factory:C7.\u0275fac,providedIn:"root"}),C7),O7=((k7=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).router=r,i}return Kp(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(E7)).\u0275fac=function(e){return new(e||k7)(Vp.Zb(jz),Vp.Zb(VC))},k7.\u0275prov=Vp.Hb({token:k7,factory:k7.\u0275fac,providedIn:"root"}),k7);function S7(e,t){1&e&&(Vp.Qb(0,"p",20),Vp.Ub(1,21),Vp.Pb())}function P7(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"div",7),Vp.Qb(1,"p",8),Vp.Ub(2,9),Vp.Pb(),Vp.Qb(3,"div",10),Vp.Qb(4,"p",11),Vp.Ub(5,12),Vp.Pb(),Vp.Qb(6,"button",13),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().finalizeEmailVerification()}),Vp.Ub(7,14),Vp.Pb(),Vp.Pb(),Vp.Qb(8,"div",15),Vp.Qb(9,"p",11),Vp.Ub(10,16),Vp.Pb(),Vp.Qb(11,"button",17),Vp.cc("click",function(){return Vp.wc(n),Vp.fc().sendEmailVerification()}),Vp.Ub(12,18),Vp.Pb(),Vp.Pb(),Vp.Ac(13,S7,2,0,"p",19),Vp.Pb()}if(2&e){var r=Vp.fc();Vp.Bb(2),Vp.Xb(r.emailAddress),Vp.Vb(2),Vp.Bb(11),Vp.mc("ngIf",r.success)}}function I7(e,t){if(1&e){var n=Vp.Rb();Vp.Qb(0,"div",24),Vp.Qb(1,"div",8),Vp.Ub(2,25),Vp.Pb(),Vp.Qb(3,"form",26),Vp.Qb(4,"div",27),Vp.Qb(5,"div",28),Vp.Mb(6,"input",29),Vp.Pb(),Vp.Qb(7,"div",28),Vp.Qb(8,"button",30),Vp.cc("click",function(){Vp.wc(n);var e=Vp.fc(2);return e.pickUsername(e.usernameForm.value)}),Vp.Ub(9,31),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb()}if(2&e){var r=Vp.fc(2);Vp.Bb(3),Vp.mc("formGroup",r.usernameForm)}}var T7=function(){return["/lobby"]};function A7(e,t){1&e&&(Vp.Qb(0,"div",32),Vp.Yb(1,33),Vp.Mb(2,"a",34),Vp.Wb(),Vp.Pb()),2&e&&(Vp.Bb(2),Vp.mc("routerLink",Vp.qc(1,T7)))}function N7(e,t){if(1&e&&(Vp.Ob(0),Vp.Ac(1,I7,10,1,"div",22),Vp.Ac(2,A7,3,2,"div",23),Vp.Nb()),2&e){var n=Vp.fc();Vp.Bb(1),Vp.mc("ngIf",!n.success),Vp.Bb(1),Vp.mc("ngIf",n.success)}}function x7(e,t){if(1&e&&(Vp.Qb(0,"div",35),Vp.Qb(1,"div",36),Vp.Cc(2),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(2),Vp.Dc(n.errorMessage)}}var R7,M7,D7,L7=((D7=function(){function e(t,n){Qp(this,e),this.authService=t,this.router=n,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new Dm({username:new Mm})}return Kp(e,[{key:"ngOnInit",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.userSub=e.authService.getUserObs().subscribe(function(){var t=JV(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.emailAddress=n.email.get(),!n.username.isAbsent()){t.next=5;break}e.verificationType="enter-username",t.next=11;break;case 5:if(e.verificationType="send-email",!0===e.triedToFinalize&&!1===n.verified&&(e.errorMessage=$localize(sp||(sp=xp(["You have not verified your email! Click on the link in the verification email."])))),t.t0=!0===n.verified,!t.t0){t.next=11;break}return t.next=11,e.router.navigate(["/lobby"]);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"pickUsername",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authService.setUsername(e.username);case 2:(r=n.sent).isSuccess()?t.success=!0:t.errorMessage=r.getReason();case 4:case"end":return n.stop()}},n)}))()}},{key:"sendEmailVerification",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.sendEmailVerification();case 2:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=n.getReason();case 4:case"end":return t.stop()}},t)}))()}},{key:"finalizeEmailVerification",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.triedToFinalize=!0,t.next=3,e.authService.reloadUser();case 3:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||D7)(Vp.Lb(jz),Vp.Lb(VC))},D7.\u0275cmp=Vp.Fb({type:D7,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){return[[1,"box"],[1,"message","is-info"],[1,"message-header"],$localize(up||(up=xp(["Account verification"]))),["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],$localize(cp||(cp=xp(["In order to finalize your account, you must click on the link that you should have received on your email address (",":INTERPOLATION:). The email could be in your spam folder."])),"\ufffd0\ufffd"),[1,"block","level-left"],[1,"level-item"],$localize(lp||(lp=xp(["Once you have verified your email, click on the following button:"]))),["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],$localize(hp||(hp=xp(["Finalize email verification"]))),[1,"level-left"],$localize(fp||(fp=xp(["If you have not received the verification email, click on the following button:"]))),["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],$localize(dp||(dp=xp(["Send verification email again"]))),["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],$localize(pp||(pp=xp(["The email has been sent"]))),["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],$localize(vp||(vp=xp(["In order to finalize your account, you must choose a username."]))),[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",$localize(gp||(gp=xp(["Username"]))),"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],$localize(yp||(yp=xp(["Pick username"]))),["id","success",1,"message-body"],$localize(mp||(mp=xp(["Your account has now been finalized, you can go back to the ",":START_LINK:list of games",":CLOSE_LINK:."])),"\ufffd#2\ufffd","\ufffd/#2\ufffd"),[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(Vp.Qb(0,"div",0),Vp.Qb(1,"div",1),Vp.Qb(2,"div",2),Vp.Ub(3,3),Vp.Pb(),Vp.Ac(4,P7,14,2,"div",4),Vp.Ac(5,N7,3,2,"ng-container",5),Vp.Pb(),Vp.Ac(6,x7,3,1,"div",6),Vp.Pb()),2&e&&(Vp.Bb(4),Vp.mc("ngIf","send-email"===t.verificationType),Vp.Bb(1),Vp.mc("ngIf","enter-username"===t.verificationType),Vp.Bb(1),Vp.mc("ngIf",t.errorMessage))},directives:[yg,Hm,um,Qm,Ay,yb,sm,Km,HC],encapsulation:2}),D7),B7=((M7=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).router=r,i}return Kp(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(E7)).\u0275fac=function(e){return new(e||M7)(Vp.Zb(jz),Vp.Zb(VC))},M7.\u0275prov=Vp.Hb({token:M7,factory:M7.\u0275fac,providedIn:"root"}),M7),F7=((R7=function(e){Jp(n,e);var t=ev(n);function n(e,r){var i;return Qp(this,n),(i=t.call(this,e)).router=r,i}return Kp(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(E7)).\u0275fac=function(e){return new(e||R7)(Vp.Zb(jz),Vp.Zb(VC))},R7.\u0275prov=Vp.Hb({token:R7,factory:R7.\u0275fac,providedIn:"root"}),R7);function j7(e,t){1&e&&(Vp.Qb(0,"p",12),Vp.Ub(1,13),Vp.Pb())}function U7(e,t){if(1&e&&(Vp.Qb(0,"div",14),Vp.Qb(1,"div",15),Vp.Ub(2,16),Vp.Pb(),Vp.Qb(3,"div",17),Vp.Cc(4),Vp.Pb(),Vp.Pb()),2&e){var n=Vp.fc();Vp.Bb(4),Vp.Dc(n.errorMessage.get())}}var V7,z7=function(){return{standalone:!0}},H7=((V7=function(){function e(t){Qp(this,e),this.authService=t,this.success=!1,this.errorMessage=kz.empty(),this.email=""}return Kp(e,[{key:"resetPassword",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return vz(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=kz.empty(),e.success=!1,t.next=3,e.authService.sendPasswordResetEmail(e.email);case 3:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=kz.of(n.getReason());case 5:case"end":return t.stop()}},t)}))()}}]),e}()).\u0275fac=function(e){return new(e||V7)(Vp.Lb(jz))},V7.\u0275cmp=Vp.Fb({type:V7,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){return[[1,"box"],[1,"title"],$localize(bp||(bp=xp(["Password reset"]))),[1,"field"],[1,"control"],["id","email","name","email","placeholder",$localize(_p||(_p=xp(["Email"]))),"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],$localize(wp||(wp=xp(["An email will be sent with instruction to reset your password."]))),["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],$localize(kp||(kp=xp(["Reset password"]))),["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],$localize(Cp||(Cp=xp(["The email has been sent, please follow the instructions from that email."]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(Ep||(Ep=xp(["Error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(Vp.Qb(0,"div",0),Vp.Qb(1,"p",1),Vp.Ub(2,2),Vp.Pb(),Vp.Qb(3,"div",3),Vp.Qb(4,"div",4),Vp.Qb(5,"input",5),Vp.cc("ngModelChange",function(e){return t.email=e}),Vp.Pb(),Vp.Qb(6,"p",6),Vp.Ub(7,7),Vp.Pb(),Vp.Ac(8,j7,2,0,"p",8),Vp.Pb(),Vp.Pb(),Vp.Qb(9,"button",9),Vp.cc("click",function(){return t.resetPassword()}),Vp.Ub(10,10),Vp.Pb(),Vp.Ac(11,U7,5,1,"div",11),Vp.Pb()),2&e&&(Vp.Bb(5),Vp.mc("ngModel",t.email)("ngModelOptions",Vp.qc(5,z7)),Vp.Bb(3),Vp.mc("ngIf",t.success),Vp.Bb(1),Vp.mc("disabled",""===t.email),Vp.Bb(2),Vp.mc("ngIf",t.errorMessage.isPresent()))},directives:[Ay,M4,yb,sm,zm,yg],encapsulation:2}),V7);function G7(e,t){if(1&e&&(Vp.Qb(0,"option",13),Vp.Cc(1),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc();Vp.mc("value",n.value)("selected",n.value===r.currentTheme),Vp.Bb(1),Vp.Ec(" ",n.name," ")}}function q7(e,t){if(1&e&&(Vp.Qb(0,"option",13),Vp.Cc(1),Vp.Pb()),2&e){var n=t.$implicit,r=Vp.fc();Vp.mc("value",n.value)("selected",n.value===r.currentLanguage),Vp.Bb(1),Vp.Ec(" ",n.name," ")}}var W7,$7,Z7,Q7=(($7=function(){function e(t,n){Qp(this,e),this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize(Op||(Op=xp(["Light"])))},{value:"dark",name:$localize(Sp||(Sp=xp(["Dark"])))}],this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}return Kp(e,[{key:"changeLanguage",value:function(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}},{key:"changeTheme",value:function(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}},{key:"reload",value:function(){window.open(window.location.href,"_self")}}]),e}()).\u0275fac=function(e){return new(e||$7)(Vp.Lb(Ez),Vp.Lb(Oz))},$7.\u0275cmp=Vp.Fb({type:$7,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){return[[1,"box"],[1,"title"],$localize(Pp||(Pp=xp(["User settings"]))),[1,"field"],["for","theme",1,"label"],$localize(Ip||(Ip=xp(["Theme"]))),[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],$localize(Tp||(Tp=xp(["Language"]))),["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(Vp.Qb(0,"div",0),Vp.Qb(1,"p",1),Vp.Ub(2,2),Vp.Pb(),Vp.Qb(3,"div",3),Vp.Qb(4,"label",4),Vp.Ub(5,5),Vp.Pb(),Vp.Qb(6,"div",6),Vp.Qb(7,"div",7),Vp.Qb(8,"select",8),Vp.cc("change",function(e){return t.changeTheme(e)}),Vp.Ac(9,G7,2,3,"option",9),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Qb(10,"div",3),Vp.Qb(11,"label",10),Vp.Ub(12,11),Vp.Pb(),Vp.Qb(13,"div",6),Vp.Qb(14,"div",7),Vp.Qb(15,"select",12),Vp.cc("change",function(e){return t.changeLanguage(e)}),Vp.Ac(16,q7,2,3,"option",9),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb(),Vp.Pb()),2&e&&(Vp.Bb(9),Vp.mc("ngForOf",t.availableThemes),Vp.Bb(7),Vp.mc("ngForOf",t.availableLanguages))},directives:[vg,rb,vb],encapsulation:2}),$7),Y7=function(){var e=function e(){Qp(this,e)};return e.ALREADY_INGAME=function(){return $localize(Ap||(Ap=xp(["You are already in a game. Finish it or cancel it first."])))},e}(),K7=((W7=function(){function e(t,n,r,i,o,a){Qp(this,e),this.route=t,this.router=n,this.authenticationService=r,this.messageDisplayer=i,this.partDAO=o,this.gameService=a}return Kp(e,[{key:"ngOnInit",value:function(){var e=this;return JV(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameAndRedirectOrShowError(e.extractGameFromURL());case 2:case"end":return t.stop()}},t)}))()}},{key:"extractGameFromURL",value:function(){return dz.getNonNullable(this.route.snapshot.paramMap.get("compo"))}},{key:"createGameAndRedirectOrShowError",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){var r,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return vz((r=t.authenticationService.user.get()).isConnected(),"User must be connected and have a username to reach this page"),i=r.username.get(),n.next=5,t.canCreateOnlineGame(i);case 5:if(!n.sent){n.next=12;break}return n.next=8,t.gameService.createPartJoinerAndChat(i,e);case 8:return o=n.sent,n.next=11,t.router.navigate(["/play",e,o]);case 11:return n.abrupt("return",!0);case 12:return t.messageDisplayer.infoMessage(Y7.ALREADY_INGAME()),n.next=15,t.router.navigate(["/lobby"]);case 15:return n.abrupt("return",!1);case 16:case"end":return n.stop()}},n)}))()}},{key:"canCreateOnlineGame",value:function(e){var t=this;return JV(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=!1,n.next=3,t.partDAO.userHasActivePart(e);case 3:return n.t1=n.sent,n.abrupt("return",n.t0===n.t1);case 5:case"end":return n.stop()}},n)}))()}}]),e}()).\u0275fac=function(e){return new(e||W7)(Vp.Lb(mk),Vp.Lb(VC),Vp.Lb(jz),Vp.Lb(qG),Vp.Lb(X4),Vp.Lb(K5))},W7.\u0275cmp=Vp.Fb({type:W7,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){return[$localize(Np||(Np=xp(["Creating online game, please wait, it should not take long."])))]},template:function(e,t){1&e&&(Vp.Qb(0,"p"),Vp.Ub(1,0),Vp.Pb())},encapsulation:2}),W7);Z7=jS.a,Object(Vp.ub)(Z7,void 0,void 0);var J7,X7=[{path:"login",component:$4},{path:"lobby",component:P5,canActivate:[O7]},{path:"settings",component:Q7},{path:"register",component:l7,canActivate:[F7]},{path:"reset-password",component:H7,canActivate:[F7]},{path:"notFound",component:I5},{path:"nextGameLoading",component:d7,canActivate:[O7]},{path:"verify-account",component:L7,canActivate:[B7]},{path:"play",component:t5,canActivate:[O7]},{path:"play/:compo",component:K7,canActivate:[O7]},{path:"play/:compo/:id",component:m8,canActivate:[O7]},{path:"local",component:h7},{path:"local/:compo",component:F8},{path:"tutorial",component:f7},{path:"tutorial/:compo",component:r7},{path:"",component:R4},{path:"**",component:R4}],e9=((J7=function e(){Qp(this,e)}).\u0275fac=function(e){return new(e||J7)},J7.\u0275mod=Vp.Jb({type:J7,bootstrap:[MG]}),J7.\u0275inj=Vp.Ib({providers:[{provide:SV,useValue:void 0},{provide:g7,useValue:void 0},{provide:qV,useValue:void 0},{provide:_7,useValue:void 0},{provide:Vp.v,useValue:Cz.getLocale()},xV],imports:[[my,y_,oE.forRoot(X7,{useHash:!1}),kb,wb,US.a.initializeApp(p7),YV,BS,cG]]}),J7);"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;var t9=function(){function e(t){Qp(this,e),this.digits=t}return Kp(e,[{key:"clone",value:function(){return new e(this.digits.slice())}},{key:"add",value:function(e){var t=this.clone();return t.addToSelf(e),t}},{key:"addToSelf",value:function(e){for(var t=Math.max(this.digits.length,e.digits.length),n=0,r=0;r<t;r++){var i=n;r<this.digits.length&&(i+=this.digits[r]),r<e.digits.length&&(i+=e.digits[r]),i>=10?(this.digits[r]=i-10,n=1):(this.digits[r]=i,n=0)}n>0&&(this.digits[t]=1)}},{key:"toString",value:function(){for(var e="",t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}],[{key:"zero",value:function(){return new e([0])}},{key:"one",value:function(){return new e([1])}}]),e}(),n9=function(){function e(t){Qp(this,e),this.powerOfTwos=[t]}return Kp(e,[{key:"getValue",value:function(){return this.powerOfTwos[0]}},{key:"multiplyBy",value:function(e){var t=t9.zero();return this.multiplyByAndAddTo(e,t),t}},{key:"multiplyByAndAddTo",value:function(e,t){for(var n=0;0!==e;e>>>=1,n++)if(1&e){var r=this.getMultipliedByPowerOfTwo(n);t.addToSelf(r)}}},{key:"getMultipliedByPowerOfTwo",value:function(e){for(var t=this.powerOfTwos.length;t<=e;t++){var n=this.powerOfTwos[t-1];this.powerOfTwos[t]=n.add(n)}return this.powerOfTwos[e]}}]),e}(),r9=function(){function e(t){Qp(this,e),this.base=t,this.exponents=[new n9(t9.one())]}return Kp(e,[{key:"toThePowerOf",value:function(e){for(var t=this.exponents.length;t<=e;t++){var n=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new n9(n)}return this.exponents[e]}}]),e}();function i9(e){var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){var i=e.charCodeAt(n+1);i>=56320&&i<=57343&&(n++,r=(r-55296<<10)+i-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e),n=o9(t,0),r=o9(t,102072);return 0!=n||0!=r&&1!=r||(n^=319790063,r^=-1801410264),[n,r]}function o9(e,t){var n,r=2654435769,i=2654435769,o=e.length;for(n=0;n+12<=o;n+=12){var a=a9(r=u9(r,f9(e,n,s9.Little)),i=u9(i,f9(e,n+4,s9.Little)),t=u9(t,f9(e,n+8,s9.Little)));r=a[0],i=a[1],t=a[2]}return r=u9(r,f9(e,n,s9.Little)),i=u9(i,f9(e,n+4,s9.Little)),t=u9(t,o),a9(r,i,t=u9(t,f9(e,n+8,s9.Little)<<8))[2]}function a9(e,t,n){return e=l9(e,t),e=l9(e,n),e^=n>>>13,t=l9(t,n),t=l9(t,e),t^=e<<8,n=l9(n,e),n=l9(n,t),n^=t>>>13,e=l9(e,t),e=l9(e,n),e^=n>>>12,t=l9(t,n),t=l9(t,e),t^=e<<16,n=l9(n,e),n=l9(n,t),n^=t>>>5,e=l9(e,t),e=l9(e,n),e^=n>>>3,t=l9(t,n),t=l9(t,e),t^=e<<10,n=l9(n,e),n=l9(n,t),[e,t,n^=t>>>15]}var s9=function(e){return e[e.Little=0]="Little",e[e.Big=1]="Big",e}({});function u9(e,t){return c9(e,t)[1]}function c9(e,t){var n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function l9(e,t){var n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function h9(e,t){return t>=e.length?0:e[t]}function f9(e,t,n){var r=0;if(n===s9.Big)for(var i=0;i<4;i++)r+=h9(e,t+i)<<24-8*i;else for(var o=0;o<4;o++)r+=h9(e,t+o)<<8*o;return r}var d9=new r9(256);function p9(e,t){if(":"!==t.charAt(0))return{text:e};var n=function(e,t){for(var n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error('Unterminated $localize metadata block in "'.concat(t,'".'))}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}function v9(e){return 1===e?"PH":"PH_"+(e-1)}var g9=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this,"No translation found for ".concat(y9(e),"."))).parsedMessage=e,r.type="MissingTranslationError",r}return n}(qp(Error));function y9(e){var t=e.meaning&&' - "'.concat(e.meaning,'"'),n=e.legacyIds&&e.legacyIds.length>0?" [".concat(e.legacyIds.map(function(e){return'"'.concat(e,'"')}).join(", "),"]"):"";return'"'.concat(e.id,'"').concat(n,' ("').concat(e.text,'"').concat(t,")")}function m9(e,t){try{return function(e,t,n){var r=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o={},a={},s=function(e,t){var n=p9(e,t),r=n.text,i=n.block;if(void 0===i)return{text:r};var o=Lp(i.split("\u241f")),a=o[0],s=o.slice(1),u=Bp(a.split("@@",2),2),c=u[0],l=u[1],h=Bp(c.split("|",2),2),f=h[0],d=h[1];return void 0===d&&(d=f,f=void 0),""===d&&(d=void 0),{text:r,meaning:f,description:d,customId:l,legacyIds:s}}(e[0],e.raw[0]),u=[s.text],c=[],l=s.text,h=1;h<e.length;h++){var f=p9(e[h],e.raw[h]),d=f.text,p=f.block,v=void 0===p?v9(h):p;l+="{$".concat(v,"}").concat(d),void 0!==t&&(o[v]=t[h-1],a[v]=i[h-1]),c.push(v),u.push(d)}var g=s.customId||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=i9(e);if(t){var r=i9(t);n=function(e,t){var n=e[0],r=t[0],i=c9(e[1],t[1]),o=i[0],a=i[1];return[u9(u9(n,r),o),a]}(function(e,t){var n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),r)}return function(e,t){var n=d9.toThePowerOf(0).multiplyBy(t);return d9.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(l,s.meaning||""),y=s.legacyIds?s.legacyIds.filter(function(e){return e!==g}):[];return{id:g,legacyIds:y,substitutions:o,substitutionLocations:a,text:l,customId:s.customId,meaning:s.meaning||"",description:s.description||"",messageParts:u,messagePartLocations:r,placeholderNames:c,location:n}}(t,n),i=e[r.id];if(void 0!==r.legacyIds)for(var o=0;o<r.legacyIds.length&&void 0===i;o++)i=e[r.legacyIds[o]];if(void 0===i)throw new g9(r);return[i.messageParts,i.placeholderNames.map(function(e){if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error("There is a placeholder name mismatch with the translation provided for the message ".concat(y9(r),".\nThe translation contains a placeholder with name ").concat(e,", which does not exist in the message."))})]}($localize.TRANSLATIONS,e,t)}catch(fV){return console.warn(fV.message),[e,t]}}function b9(){Object(Vp.T)(),gy().bootstrapModule(e9).catch(function(e){return console.error(e)})}var _9=Cz.getLocale();"en"!==_9?fetch("/assets/"+_9+".json").then(function(e){return e.ok?e.json():{locale:"en",translations:{}}}).then(function(e){var t;t=e.translations,$localize.translate||($localize.translate=m9),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(t).forEach(function(e){$localize.TRANSLATIONS[e]=function(e){for(var t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[],i=1;i<t.length-1;i+=2)r.push(t[i]),n.push("".concat(t[i+1]));var o,a,s=n.map(function(e){return":"===e.charAt(0)?"\\"+e:e});return{text:e,messageParts:(o=n,a=s,Object.defineProperty(o,"raw",{value:a}),o),placeholderNames:r}}(t[e])}),$localize.locale=e.locale,b9()}).catch(function(e){console.log(e)}):b9()},zn8P:function(e,t){function n(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"},zx2A:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return u});var r=n("7o/Q"),i=n("HDdC"),o=n("SeVD"),a=function(e){Jp(n,e);var t=ev(n);function n(e){var r;return Qp(this,n),(r=t.call(this)).parent=e,r}return Kp(n,[{key:"_next",value:function(e){this.parent.notifyNext(e)}},{key:"_error",value:function(e){this.parent.notifyError(e),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(),this.unsubscribe()}}]),n}(r.a),s=function(e){Jp(n,e);var t=ev(n);function n(){return Qp(this,n),t.apply(this,arguments)}return Kp(n,[{key:"notifyNext",value:function(e){this.destination.next(e)}},{key:"notifyError",value:function(e){this.destination.error(e)}},{key:"notifyComplete",value:function(){this.destination.complete()}}]),n}(r.a);function u(e,t){if(!t.closed){if(e instanceof i.a)return e.subscribe(t);var n;try{n=Object(o.a)(e)(t)}catch(r){t.error(r)}return n}}}},[[0,0]]])}();